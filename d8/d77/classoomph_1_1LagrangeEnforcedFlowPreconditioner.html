<!-- HTML header for doxygen 1.8.18-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MercuryDPM: oomph::LagrangeEnforcedFlowPreconditioner Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../MDPM.css" rel="stylesheet" type="text/css"/>
<link href="../../codeLabels.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-fork-corner.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-dropdown-version.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../MDPM-fragment-copy-button.js"></script>
<script type="text/javascript">
DoxygenAwesomeFragmentCopyButton.init()
</script>
<script type="text/javascript" src="../../MDPM-paragraph-link.js"></script>
<script type="text/javascript">
DoxygenAwesomeParagraphLink.init()
</script>
<script type="text/javascript" src="../../MDPM-interactive-toc.js"></script>
<script type="text/javascript">
DoxygenAwesomeInteractiveToc.init()
</script>
<script type="text/javascript" src="../../MDPM-darkmode-toggle.js"></script>
<script type="text/javascript">
DoxygenAwesomeDarkModeToggle.init()
</script>
</head>
<body>
  <div id="bitbucket-corner">
   <a href="https://bitbucket.org/mercurydpm/mercurydpm/src/master/" target="_blank" id="fork-corner" class="fork-corner fc-pos-tr fc-animate fc-theme-bitbucket"></a>
  </div>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../mercury-logo-chosen-light-slogan.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"> <!--MercuryDPM--!>
   <!-- BEGIN version select -->
   <div class="dropdown" id="projectnumber">
    <button class="dropbtn">v1.0</button>
    <div class="dropdown-content">
    </div>
   </div>
   <script type="text/javascript" src="../../MDPM-dropdown-version.js"></script>
<!-- END version select -->
   <!--&#160;<span id="projectnumber">revision: v1.0</span>-->
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<script type="text/javascript" src="../../MDPM-fork-corner.js"></script>
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="../../de/d2d/classoomph_1_1LagrangeEnforcedFlowPreconditioner-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">oomph::LagrangeEnforcedFlowPreconditioner Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="../../d8/d09/lagrange__enforced__flow__preconditioner_8h_source.html">lagrange_enforced_flow_preconditioner.h</a>&gt;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Inheritance diagram for oomph::LagrangeEnforcedFlowPreconditioner:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
 <div class="center">
  <img src="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.png" usemap="#oomph::LagrangeEnforcedFlowPreconditioner_map" alt=""/>
  <map id="oomph::LagrangeEnforcedFlowPreconditioner_map" name="oomph::LagrangeEnforcedFlowPreconditioner_map">
<area href="../../dd/d57/classoomph_1_1BlockPreconditioner.html" alt="oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;" shape="rect" coords="0,112,285,136"/>
<area href="../../db/d9e/classoomph_1_1Preconditioner.html" alt="oomph::Preconditioner" shape="rect" coords="0,56,285,80"/>
<area href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html" alt="oomph::DistributableLinearAlgebraObject" shape="rect" coords="0,0,285,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a080854ab4a9c4d1f8abca5121433b1d9"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html">Preconditioner</a> *(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a080854ab4a9c4d1f8abca5121433b1d9">SubsidiaryPreconditionerFctPt</a>) ()</td></tr>
<tr class="separator:a080854ab4a9c4d1f8abca5121433b1d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a807a1c5694e8b2114e0da3702db00d68"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a807a1c5694e8b2114e0da3702db00d68">LagrangeEnforcedFlowPreconditioner</a> ()</td></tr>
<tr class="memdesc:a807a1c5694e8b2114e0da3702db00d68"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor - initialise variables.  <a href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a807a1c5694e8b2114e0da3702db00d68">More...</a><br /></td></tr>
<tr class="separator:a807a1c5694e8b2114e0da3702db00d68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9958f85a43c683c5a97b449faa35ca74"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a9958f85a43c683c5a97b449faa35ca74">~LagrangeEnforcedFlowPreconditioner</a> ()</td></tr>
<tr class="memdesc:a9958f85a43c683c5a97b449faa35ca74"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <a href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a9958f85a43c683c5a97b449faa35ca74">More...</a><br /></td></tr>
<tr class="separator:a9958f85a43c683c5a97b449faa35ca74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42c105fbbbacfa736650bfb9ebb36db4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a42c105fbbbacfa736650bfb9ebb36db4">LagrangeEnforcedFlowPreconditioner</a> (const <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html">LagrangeEnforcedFlowPreconditioner</a> &amp;)=delete</td></tr>
<tr class="memdesc:a42c105fbbbacfa736650bfb9ebb36db4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken copy constructor.  <a href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a42c105fbbbacfa736650bfb9ebb36db4">More...</a><br /></td></tr>
<tr class="separator:a42c105fbbbacfa736650bfb9ebb36db4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e4241546e226e835631c1d1ddb6da0f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a9e4241546e226e835631c1d1ddb6da0f">operator=</a> (const <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html">LagrangeEnforcedFlowPreconditioner</a> &amp;)=delete</td></tr>
<tr class="memdesc:a9e4241546e226e835631c1d1ddb6da0f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken assignment operator.  <a href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a9e4241546e226e835631c1d1ddb6da0f">More...</a><br /></td></tr>
<tr class="separator:a9e4241546e226e835631c1d1ddb6da0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadcbdb5af92d7889c956098cb86dee87"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#aadcbdb5af92d7889c956098cb86dee87">setup</a> ()</td></tr>
<tr class="memdesc:aadcbdb5af92d7889c956098cb86dee87"><td class="mdescLeft">&#160;</td><td class="mdescRight">Setup method for the LagrangeEnforcedFlowPreconditioner.  <a href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#aadcbdb5af92d7889c956098cb86dee87">More...</a><br /></td></tr>
<tr class="separator:aadcbdb5af92d7889c956098cb86dee87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a519940fc2faee5faac00b80004f3edea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a519940fc2faee5faac00b80004f3edea">preconditioner_solve</a> (const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;r, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;z)</td></tr>
<tr class="separator:a519940fc2faee5faac00b80004f3edea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84cbce901e94c3ea53a92638ea928bf3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a84cbce901e94c3ea53a92638ea928bf3">set_meshes</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> * &gt; &amp;<a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a3c0e92cb77c3e3179007fe9fd99b6428">mesh_pt</a>)</td></tr>
<tr class="separator:a84cbce901e94c3ea53a92638ea928bf3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a0db8be07c39ebb30f02e4461658efd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a9a0db8be07c39ebb30f02e4461658efd">use_norm_f_for_scaling_sigma</a> ()</td></tr>
<tr class="separator:a9a0db8be07c39ebb30f02e4461658efd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14023f7ee6150f3b2ebdb0eab534242d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a14023f7ee6150f3b2ebdb0eab534242d">set_scaling_sigma</a> (const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;<a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a63ef6de02fbf4486ca99d2a560ff47a4">scaling_sigma</a>)</td></tr>
<tr class="separator:a14023f7ee6150f3b2ebdb0eab534242d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63ef6de02fbf4486ca99d2a560ff47a4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a63ef6de02fbf4486ca99d2a560ff47a4">scaling_sigma</a> () const</td></tr>
<tr class="memdesc:a63ef6de02fbf4486ca99d2a560ff47a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read (const) function to get the scaling sigma.  <a href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a63ef6de02fbf4486ca99d2a560ff47a4">More...</a><br /></td></tr>
<tr class="separator:a63ef6de02fbf4486ca99d2a560ff47a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3512f2a0c6b03977590591a81846c50d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a3512f2a0c6b03977590591a81846c50d">set_navier_stokes_preconditioner</a> (<a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html">Preconditioner</a> *new_ns_preconditioner_pt=0)</td></tr>
<tr class="separator:a3512f2a0c6b03977590591a81846c50d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad523330041a714da26bc4931995023b8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#ad523330041a714da26bc4931995023b8">set_superlu_for_navier_stokes_preconditioner</a> ()</td></tr>
<tr class="separator:ad523330041a714da26bc4931995023b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace8141de668eb2a172ef9a25c932134a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#ace8141de668eb2a172ef9a25c932134a">clean_up_memory</a> ()</td></tr>
<tr class="memdesc:ace8141de668eb2a172ef9a25c932134a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clears the memory.  <a href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#ace8141de668eb2a172ef9a25c932134a">More...</a><br /></td></tr>
<tr class="separator:ace8141de668eb2a172ef9a25c932134a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classoomph_1_1BlockPreconditioner"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classoomph_1_1BlockPreconditioner')"><img src="../../closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;</a></td></tr>
<tr class="memitem:a74c4b4bef4371b72816631445689a2e6 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a74c4b4bef4371b72816631445689a2e6">BlockPreconditioner</a> ()</td></tr>
<tr class="memdesc:a74c4b4bef4371b72816631445689a2e6 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a74c4b4bef4371b72816631445689a2e6">More...</a><br /></td></tr>
<tr class="separator:a74c4b4bef4371b72816631445689a2e6 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0634f494e1284446512560cb1dc73a32 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a0634f494e1284446512560cb1dc73a32">BlockPreconditioner</a> (const <a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html">BlockPreconditioner</a> &amp;)=delete</td></tr>
<tr class="memdesc:a0634f494e1284446512560cb1dc73a32 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken copy constructor.  <a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a0634f494e1284446512560cb1dc73a32">More...</a><br /></td></tr>
<tr class="separator:a0634f494e1284446512560cb1dc73a32 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78c33fc6f29101f027e22d64d158d567 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a78c33fc6f29101f027e22d64d158d567">~BlockPreconditioner</a> ()</td></tr>
<tr class="memdesc:a78c33fc6f29101f027e22d64d158d567 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a78c33fc6f29101f027e22d64d158d567">More...</a><br /></td></tr>
<tr class="separator:a78c33fc6f29101f027e22d64d158d567 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f07557542d4ebeba0e5a2307c7a7d48 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a8f07557542d4ebeba0e5a2307c7a7d48">operator=</a> (const <a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html">BlockPreconditioner</a> &amp;)=delete</td></tr>
<tr class="memdesc:a8f07557542d4ebeba0e5a2307c7a7d48 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken assignment operator.  <a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a8f07557542d4ebeba0e5a2307c7a7d48">More...</a><br /></td></tr>
<tr class="separator:a8f07557542d4ebeba0e5a2307c7a7d48 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9aac48fd53e579e6db8eeed58933a14b inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a9aac48fd53e579e6db8eeed58933a14b">matrix_pt</a> () const</td></tr>
<tr class="separator:a9aac48fd53e579e6db8eeed58933a14b inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d977a81515458e59b94438a215e93e1 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a0d977a81515458e59b94438a215e93e1">turn_on_recursive_debug_flag</a> ()</td></tr>
<tr class="separator:a0d977a81515458e59b94438a215e93e1 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ed741a5fbf514fc29f0a332a211255f inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a8ed741a5fbf514fc29f0a332a211255f">turn_off_recursive_debug_flag</a> ()</td></tr>
<tr class="separator:a8ed741a5fbf514fc29f0a332a211255f inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a271bf5ea70579e43797187498d98f9a9 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a271bf5ea70579e43797187498d98f9a9">turn_on_debug_flag</a> ()</td></tr>
<tr class="memdesc:a271bf5ea70579e43797187498d98f9a9 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Toggles on the debug flag.  <a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a271bf5ea70579e43797187498d98f9a9">More...</a><br /></td></tr>
<tr class="separator:a271bf5ea70579e43797187498d98f9a9 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46c57c6a2f4b54e27d2aaccc4ec90665 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a46c57c6a2f4b54e27d2aaccc4ec90665">turn_off_debug_flag</a> ()</td></tr>
<tr class="memdesc:a46c57c6a2f4b54e27d2aaccc4ec90665 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Toggles off the debug flag.  <a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a46c57c6a2f4b54e27d2aaccc4ec90665">More...</a><br /></td></tr>
<tr class="separator:a46c57c6a2f4b54e27d2aaccc4ec90665 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8e2478caa8370dd12462f17e1cc8082 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ab8e2478caa8370dd12462f17e1cc8082">turn_into_subsidiary_block_preconditioner</a> (<a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html">BlockPreconditioner</a>&lt; <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> &gt; *master_block_prec_pt, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;doftype_in_master_preconditioner_coarse)</td></tr>
<tr class="separator:ab8e2478caa8370dd12462f17e1cc8082 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0d2887082cf856b680b4ae61b510d29 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ac0d2887082cf856b680b4ae61b510d29">turn_into_subsidiary_block_preconditioner</a> (<a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html">BlockPreconditioner</a>&lt; <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> &gt; *master_block_prec_pt, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;doftype_in_master_preconditioner_coarse, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt;&gt; &amp;doftype_coarsen_map_coarse)</td></tr>
<tr class="separator:ac0d2887082cf856b680b4ae61b510d29 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af704c4816469cef4fed9d35a9ad651ec inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#af704c4816469cef4fed9d35a9ad651ec">block_setup</a> ()</td></tr>
<tr class="separator:af704c4816469cef4fed9d35a9ad651ec inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b70b51b533002ff33a09013aa084e54 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a6b70b51b533002ff33a09013aa084e54">block_setup</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;dof_to_block_map)</td></tr>
<tr class="separator:a6b70b51b533002ff33a09013aa084e54 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72b4dbe167da59d9ba12c7eff97d77e6 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a72b4dbe167da59d9ba12c7eff97d77e6">get_block</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> &amp;output_matrix, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;ignore_replacement_block=false) const</td></tr>
<tr class="separator:a72b4dbe167da59d9ba12c7eff97d77e6 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c37f469646c689b5f1e79d0953bd588 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a4c37f469646c689b5f1e79d0953bd588">get_block</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;ignore_replacement_block=false) const</td></tr>
<tr class="separator:a4c37f469646c689b5f1e79d0953bd588 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a748e2ad8836bc8edf5b9a42373a7ad61 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a748e2ad8836bc8edf5b9a42373a7ad61">set_master_matrix_pt</a> (<a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> *in_matrix_pt)</td></tr>
<tr class="memdesc:a748e2ad8836bc8edf5b9a42373a7ad61 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the matrix_pt in the upper-most master preconditioner.  <a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a748e2ad8836bc8edf5b9a42373a7ad61">More...</a><br /></td></tr>
<tr class="separator:a748e2ad8836bc8edf5b9a42373a7ad61 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9dae351352d344321ea82999d7003e17 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a9dae351352d344321ea82999d7003e17">get_block_other_matrix</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> *in_matrix_pt, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> &amp;output_matrix)</td></tr>
<tr class="separator:a9dae351352d344321ea82999d7003e17 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69fa79db7073f39a1ac5333c8bd9c1d5 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a69fa79db7073f39a1ac5333c8bd9c1d5">get_blocks</a> (<a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../d9/db9/classbool.html">bool</a> &gt; &amp;required_blocks, <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> * &gt; &amp;block_matrix_pt) const</td></tr>
<tr class="separator:a69fa79db7073f39a1ac5333c8bd9c1d5 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a314fc14d95f2833be66067cd5b45e093 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a314fc14d95f2833be66067cd5b45e093">get_dof_level_block</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> &amp;output_block, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;ignore_replacement_block=false) const</td></tr>
<tr class="separator:a314fc14d95f2833be66067cd5b45e093 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1df550d281ec99914115edfa1a40b982 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a1df550d281ec99914115edfa1a40b982">get_dof_level_block</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;block_i, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;block_j, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> &amp;output_block, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;ignore_replacement_block) const</td></tr>
<tr class="separator:a1df550d281ec99914115edfa1a40b982 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51636746e5921ee2845daf60b1c322dc inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a51636746e5921ee2845daf60b1c322dc">get_concatenated_block</a> (const <a class="el" href="../../d0/dea/classoomph_1_1VectorMatrix.html">VectorMatrix</a>&lt; <a class="el" href="../../dd/da7/classoomph_1_1BlockSelector.html">BlockSelector</a> &gt; &amp;selected_block)</td></tr>
<tr class="separator:a51636746e5921ee2845daf60b1c322dc inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9321cdab3f506ab95fe51cd9b93deab inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#af9321cdab3f506ab95fe51cd9b93deab">get_concatenated_block_vector</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;block_vec_number, const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../df/d7a/MatrixBase__isOrthogonal_8cpp.html#a6ee409cfdca8577a72873ce7105dfce7">v</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#a9d82f3af1459c1efc910b77f3ccd3180">b</a>)</td></tr>
<tr class="separator:af9321cdab3f506ab95fe51cd9b93deab inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d5106c0b9dca23aa1cc7f7fd8e696cb inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a6d5106c0b9dca23aa1cc7f7fd8e696cb">return_concatenated_block_vector</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;block_vec_number, const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#a9d82f3af1459c1efc910b77f3ccd3180">b</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../df/d7a/MatrixBase__isOrthogonal_8cpp.html#a6ee409cfdca8577a72873ce7105dfce7">v</a>) const</td></tr>
<tr class="memdesc:a6d5106c0b9dca23aa1cc7f7fd8e696cb inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Takes concatenated block ordered vector, b, and copies its.  <a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a6d5106c0b9dca23aa1cc7f7fd8e696cb">More...</a><br /></td></tr>
<tr class="separator:a6d5106c0b9dca23aa1cc7f7fd8e696cb inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad356946d5de4f0817cdf8793fa3cdc74 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ad356946d5de4f0817cdf8793fa3cdc74">get_block_vectors</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;block_vec_number, const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../df/d7a/MatrixBase__isOrthogonal_8cpp.html#a6ee409cfdca8577a72873ce7105dfce7">v</a>, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &gt; &amp;<a class="el" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>) const</td></tr>
<tr class="separator:ad356946d5de4f0817cdf8793fa3cdc74 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0517a3678def8b89ae69840345a8f838 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a0517a3678def8b89ae69840345a8f838">get_block_vectors</a> (const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../df/d7a/MatrixBase__isOrthogonal_8cpp.html#a6ee409cfdca8577a72873ce7105dfce7">v</a>, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &gt; &amp;<a class="el" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>) const</td></tr>
<tr class="separator:a0517a3678def8b89ae69840345a8f838 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71d48d8a70151ef0febd4537a2214c53 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a71d48d8a70151ef0febd4537a2214c53">return_block_vectors</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;block_vec_number, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &gt; &amp;<a class="el" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../df/d7a/MatrixBase__isOrthogonal_8cpp.html#a6ee409cfdca8577a72873ce7105dfce7">v</a>) const</td></tr>
<tr class="separator:a71d48d8a70151ef0febd4537a2214c53 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a628f3ab6c3c41ccb449da642fb7e1feb inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a628f3ab6c3c41ccb449da642fb7e1feb">return_block_vectors</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &gt; &amp;<a class="el" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../df/d7a/MatrixBase__isOrthogonal_8cpp.html#a6ee409cfdca8577a72873ce7105dfce7">v</a>) const</td></tr>
<tr class="separator:a628f3ab6c3c41ccb449da642fb7e1feb inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7efc9f2f0209764902e4e45fcb2556d1 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a7efc9f2f0209764902e4e45fcb2556d1">get_block_vector</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d5/d24/level2__real__impl_8h.html#a1224f27e9a621d957f8124bcade25bed">n</a>, const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../df/d7a/MatrixBase__isOrthogonal_8cpp.html#a6ee409cfdca8577a72873ce7105dfce7">v</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#a9d82f3af1459c1efc910b77f3ccd3180">b</a>) const</td></tr>
<tr class="separator:a7efc9f2f0209764902e4e45fcb2556d1 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1dd4d3cd6b64fa64e1ff6730b0deecc7 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a1dd4d3cd6b64fa64e1ff6730b0deecc7">return_block_vector</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d5/d24/level2__real__impl_8h.html#a1224f27e9a621d957f8124bcade25bed">n</a>, const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#a9d82f3af1459c1efc910b77f3ccd3180">b</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../df/d7a/MatrixBase__isOrthogonal_8cpp.html#a6ee409cfdca8577a72873ce7105dfce7">v</a>) const</td></tr>
<tr class="separator:a1dd4d3cd6b64fa64e1ff6730b0deecc7 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd37323d2b5ba31e2d14f3ce8e6e474d inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#afd37323d2b5ba31e2d14f3ce8e6e474d">get_block_ordered_preconditioner_vector</a> (const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../df/d7a/MatrixBase__isOrthogonal_8cpp.html#a6ee409cfdca8577a72873ce7105dfce7">v</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../df/d7a/MatrixBase__isOrthogonal_8cpp.html#a080d348cd3ec0d6b60a118c00929effe">w</a>)</td></tr>
<tr class="separator:afd37323d2b5ba31e2d14f3ce8e6e474d inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98e920e003f085b02dbb30510fb23a0f inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a98e920e003f085b02dbb30510fb23a0f">return_block_ordered_preconditioner_vector</a> (const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../df/d7a/MatrixBase__isOrthogonal_8cpp.html#a080d348cd3ec0d6b60a118c00929effe">w</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../df/d7a/MatrixBase__isOrthogonal_8cpp.html#a6ee409cfdca8577a72873ce7105dfce7">v</a>) const</td></tr>
<tr class="separator:a98e920e003f085b02dbb30510fb23a0f inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80808d42be8db74fd58af80b019bf317 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a80808d42be8db74fd58af80b019bf317">nblock_types</a> () const</td></tr>
<tr class="memdesc:a80808d42be8db74fd58af80b019bf317 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the number of block types.  <a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a80808d42be8db74fd58af80b019bf317">More...</a><br /></td></tr>
<tr class="separator:a80808d42be8db74fd58af80b019bf317 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6cca480686ea8e44244ac60a0db23ba inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ab6cca480686ea8e44244ac60a0db23ba">ndof_types</a> () const</td></tr>
<tr class="memdesc:ab6cca480686ea8e44244ac60a0db23ba inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the total number of DOF types.  <a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ab6cca480686ea8e44244ac60a0db23ba">More...</a><br /></td></tr>
<tr class="separator:ab6cca480686ea8e44244ac60a0db23ba inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c0e92cb77c3e3179007fe9fd99b6428 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a3c0e92cb77c3e3179007fe9fd99b6428">mesh_pt</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>) const</td></tr>
<tr class="separator:a3c0e92cb77c3e3179007fe9fd99b6428 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a193776a271f7c23d20d2102de0ff1cb9 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a193776a271f7c23d20d2102de0ff1cb9">nmesh</a> () const</td></tr>
<tr class="separator:a193776a271f7c23d20d2102de0ff1cb9 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a64cfc57ffd16b92ac78499de515138 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a8a64cfc57ffd16b92ac78499de515138">block_number</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;i_dof) const</td></tr>
<tr class="memdesc:a8a64cfc57ffd16b92ac78499de515138 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the block number corresponding to a global index i_dof.  <a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a8a64cfc57ffd16b92ac78499de515138">More...</a><br /></td></tr>
<tr class="separator:a8a64cfc57ffd16b92ac78499de515138 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75742d54177935fb22e59d045209b11e inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a75742d54177935fb22e59d045209b11e">index_in_block</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;i_dof) const</td></tr>
<tr class="separator:a75742d54177935fb22e59d045209b11e inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77ac0b71404620e7be8b15ac2d588495 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a77ac0b71404620e7be8b15ac2d588495">block_distribution_pt</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#a9d82f3af1459c1efc910b77f3ccd3180">b</a>) const</td></tr>
<tr class="memdesc:a77ac0b71404620e7be8b15ac2d588495 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access function to the block distributions (const version).  <a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a77ac0b71404620e7be8b15ac2d588495">More...</a><br /></td></tr>
<tr class="separator:a77ac0b71404620e7be8b15ac2d588495 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace28659098240524c431a41cf419d4ba inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ace28659098240524c431a41cf419d4ba">block_distribution_pt</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#a9d82f3af1459c1efc910b77f3ccd3180">b</a>)</td></tr>
<tr class="memdesc:ace28659098240524c431a41cf419d4ba inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access function to the block distributions (non-const version).  <a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ace28659098240524c431a41cf419d4ba">More...</a><br /></td></tr>
<tr class="separator:ace28659098240524c431a41cf419d4ba inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ee4a9fcf226e8c4438fb25747cb6e93 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a1ee4a9fcf226e8c4438fb25747cb6e93">dof_block_distribution_pt</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#a9d82f3af1459c1efc910b77f3ccd3180">b</a>)</td></tr>
<tr class="memdesc:a1ee4a9fcf226e8c4438fb25747cb6e93 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access function to the dof-level block distributions.  <a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a1ee4a9fcf226e8c4438fb25747cb6e93">More...</a><br /></td></tr>
<tr class="separator:a1ee4a9fcf226e8c4438fb25747cb6e93 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a005d978655022d1a04da7397cf5d0e83 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a005d978655022d1a04da7397cf5d0e83">master_distribution_pt</a> () const</td></tr>
<tr class="separator:a005d978655022d1a04da7397cf5d0e83 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45509677ccef78be13b5e4485312ddc1 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a45509677ccef78be13b5e4485312ddc1">ndof_types_in_mesh</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>) const</td></tr>
<tr class="separator:a45509677ccef78be13b5e4485312ddc1 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ac4335ec07fc13f7bf1093fd0489c52 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a9ac4335ec07fc13f7bf1093fd0489c52">is_subsidiary_block_preconditioner</a> () const</td></tr>
<tr class="separator:a9ac4335ec07fc13f7bf1093fd0489c52 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a804e1975f170d2ad941b3b7d2dd50407 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a804e1975f170d2ad941b3b7d2dd50407">is_master_block_preconditioner</a> () const</td></tr>
<tr class="separator:a804e1975f170d2ad941b3b7d2dd50407 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab36e905f7da268328709d62951d64ace inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ab36e905f7da268328709d62951d64ace">set_block_output_to_files</a> (const std::string &amp;basefilename)</td></tr>
<tr class="separator:ab36e905f7da268328709d62951d64ace inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45b37f1934144d882831bf354f35d035 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a45b37f1934144d882831bf354f35d035">disable_block_output_to_files</a> ()</td></tr>
<tr class="memdesc:a45b37f1934144d882831bf354f35d035 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Turn off output of blocks (by clearing the basefilename string).  <a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a45b37f1934144d882831bf354f35d035">More...</a><br /></td></tr>
<tr class="separator:a45b37f1934144d882831bf354f35d035 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bd0ab19a7501b79c16c1283766f0abb inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a0bd0ab19a7501b79c16c1283766f0abb">block_output_on</a> () const</td></tr>
<tr class="memdesc:a0bd0ab19a7501b79c16c1283766f0abb inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test if output of blocks is on or not.  <a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a0bd0ab19a7501b79c16c1283766f0abb">More...</a><br /></td></tr>
<tr class="separator:a0bd0ab19a7501b79c16c1283766f0abb inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adec848504d36ebcd8e27ec60f52f75a6 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#adec848504d36ebcd8e27ec60f52f75a6">output_blocks_to_files</a> (const std::string &amp;basefilename, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;precision=8) const</td></tr>
<tr class="separator:adec848504d36ebcd8e27ec60f52f75a6 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa760ae71a5aae488547ccf721d412b1e inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#aa760ae71a5aae488547ccf721d412b1e">post_block_matrix_assembly_partial_clear</a> ()</td></tr>
<tr class="separator:aa760ae71a5aae488547ccf721d412b1e inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab84701c65bdfd8d2c14611176e5e6209 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html">BlockPreconditioner</a>&lt; <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ab84701c65bdfd8d2c14611176e5e6209">master_block_preconditioner_pt</a> () const</td></tr>
<tr class="memdesc:ab84701c65bdfd8d2c14611176e5e6209 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access function to the master block preconditioner pt.  <a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ab84701c65bdfd8d2c14611176e5e6209">More...</a><br /></td></tr>
<tr class="separator:ab84701c65bdfd8d2c14611176e5e6209 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7845d9301918e3f5cbecd729ec1e309b inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a7845d9301918e3f5cbecd729ec1e309b">clear_block_preconditioner_base</a> ()</td></tr>
<tr class="separator:a7845d9301918e3f5cbecd729ec1e309b inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a289db176ccafcc3719367fa98340f94d inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a289db176ccafcc3719367fa98340f94d">document</a> ()</td></tr>
<tr class="separator:a289db176ccafcc3719367fa98340f94d inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a39411824a744d4569fe835dec13047 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a3a39411824a744d4569fe835dec13047">doftype_coarsen_map_fine</a> () const</td></tr>
<tr class="separator:a3a39411824a744d4569fe835dec13047 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a433adda4f658cc7880121bf9ca4293c4 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a433adda4f658cc7880121bf9ca4293c4">get_fine_grain_dof_types_in</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>) const</td></tr>
<tr class="separator:a433adda4f658cc7880121bf9ca4293c4 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50b76a374797805f64e2af34d581cdc2 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a50b76a374797805f64e2af34d581cdc2">nfine_grain_dof_types_in</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>) const</td></tr>
<tr class="separator:a50b76a374797805f64e2af34d581cdc2 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a571824cedc7e458a612111b51f20e5fb inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d2/d3a/classoomph_1_1MapMatrix.html">MapMatrix</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a571824cedc7e458a612111b51f20e5fb">replacement_dof_block_pt</a> () const</td></tr>
<tr class="memdesc:a571824cedc7e458a612111b51f20e5fb inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access function to the replaced dof-level blocks.  <a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a571824cedc7e458a612111b51f20e5fb">More...</a><br /></td></tr>
<tr class="separator:a571824cedc7e458a612111b51f20e5fb inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbe1ae854ee9831649249d50162bb6a9 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#adbe1ae854ee9831649249d50162bb6a9">setup_matrix_vector_product</a> (<a class="el" href="../../d1/dac/classoomph_1_1MatrixVectorProduct.html">MatrixVectorProduct</a> *matvec_prod_pt, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> *block_pt, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;block_col_indices)</td></tr>
<tr class="separator:adbe1ae854ee9831649249d50162bb6a9 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65059c036724814a0e490716fa6eaf0a inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a65059c036724814a0e490716fa6eaf0a">setup_matrix_vector_product</a> (<a class="el" href="../../d1/dac/classoomph_1_1MatrixVectorProduct.html">MatrixVectorProduct</a> *matvec_prod_pt, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> *block_pt, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;block_col_index)</td></tr>
<tr class="separator:a65059c036724814a0e490716fa6eaf0a inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afba1bef13cebdce65a0a49ff3381269a inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#afba1bef13cebdce65a0a49ff3381269a">internal_get_block_ordered_preconditioner_vector</a> (const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../df/d7a/MatrixBase__isOrthogonal_8cpp.html#a6ee409cfdca8577a72873ce7105dfce7">v</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../df/d7a/MatrixBase__isOrthogonal_8cpp.html#a080d348cd3ec0d6b60a118c00929effe">w</a>) const</td></tr>
<tr class="separator:afba1bef13cebdce65a0a49ff3381269a inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a679a82067056628cc4bbc8bb68d088f2 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a679a82067056628cc4bbc8bb68d088f2">internal_return_block_ordered_preconditioner_vector</a> (const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../df/d7a/MatrixBase__isOrthogonal_8cpp.html#a080d348cd3ec0d6b60a118c00929effe">w</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../df/d7a/MatrixBase__isOrthogonal_8cpp.html#a6ee409cfdca8577a72873ce7105dfce7">v</a>) const</td></tr>
<tr class="separator:a679a82067056628cc4bbc8bb68d088f2 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c2b9ed482db072b0cabe5a51eb76efa inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a7c2b9ed482db072b0cabe5a51eb76efa">internal_nblock_types</a> () const</td></tr>
<tr class="separator:a7c2b9ed482db072b0cabe5a51eb76efa inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f3efe468cd6e133d6840ede8c3687b5 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a4f3efe468cd6e133d6840ede8c3687b5">internal_ndof_types</a> () const</td></tr>
<tr class="separator:a4f3efe468cd6e133d6840ede8c3687b5 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04e260cc4160a952db2d410109fb2684 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a04e260cc4160a952db2d410109fb2684">internal_return_block_vector</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d5/d24/level2__real__impl_8h.html#a1224f27e9a621d957f8124bcade25bed">n</a>, const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#a9d82f3af1459c1efc910b77f3ccd3180">b</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../df/d7a/MatrixBase__isOrthogonal_8cpp.html#a6ee409cfdca8577a72873ce7105dfce7">v</a>) const</td></tr>
<tr class="separator:a04e260cc4160a952db2d410109fb2684 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3cf61f61e1aa50e2315e999827e7d59 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ae3cf61f61e1aa50e2315e999827e7d59">internal_get_block_vector</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d5/d24/level2__real__impl_8h.html#a1224f27e9a621d957f8124bcade25bed">n</a>, const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../df/d7a/MatrixBase__isOrthogonal_8cpp.html#a6ee409cfdca8577a72873ce7105dfce7">v</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#a9d82f3af1459c1efc910b77f3ccd3180">b</a>) const</td></tr>
<tr class="separator:ae3cf61f61e1aa50e2315e999827e7d59 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace6e9dbdfe9a1c3571452e2cd6ec9780 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ace6e9dbdfe9a1c3571452e2cd6ec9780">internal_get_block_vectors</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;block_vec_number, const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../df/d7a/MatrixBase__isOrthogonal_8cpp.html#a6ee409cfdca8577a72873ce7105dfce7">v</a>, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &gt; &amp;<a class="el" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>) const</td></tr>
<tr class="separator:ace6e9dbdfe9a1c3571452e2cd6ec9780 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cde8af922cd8054dbf352527dd682b1 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a0cde8af922cd8054dbf352527dd682b1">internal_get_block_vectors</a> (const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../df/d7a/MatrixBase__isOrthogonal_8cpp.html#a6ee409cfdca8577a72873ce7105dfce7">v</a>, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &gt; &amp;<a class="el" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>) const</td></tr>
<tr class="separator:a0cde8af922cd8054dbf352527dd682b1 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ca7f125e50493073d116ba8da271af5 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a2ca7f125e50493073d116ba8da271af5">internal_return_block_vectors</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;block_vec_number, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &gt; &amp;<a class="el" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../df/d7a/MatrixBase__isOrthogonal_8cpp.html#a6ee409cfdca8577a72873ce7105dfce7">v</a>) const</td></tr>
<tr class="separator:a2ca7f125e50493073d116ba8da271af5 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e2ce77e3efbcdd465f7ad7252936dfd inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a9e2ce77e3efbcdd465f7ad7252936dfd">internal_return_block_vectors</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &gt; &amp;<a class="el" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../df/d7a/MatrixBase__isOrthogonal_8cpp.html#a6ee409cfdca8577a72873ce7105dfce7">v</a>) const</td></tr>
<tr class="separator:a9e2ce77e3efbcdd465f7ad7252936dfd inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe001ffe270c96e761ec5205364976a7 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#abe001ffe270c96e761ec5205364976a7">internal_get_block</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> &amp;output_block) const</td></tr>
<tr class="separator:abe001ffe270c96e761ec5205364976a7 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f714d01cd2fdb791aa0795f34b9610a inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a4f714d01cd2fdb791aa0795f34b9610a">internal_get_block</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;block_i, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;block_j, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> &amp;output_block) const</td></tr>
<tr class="separator:a4f714d01cd2fdb791aa0795f34b9610a inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3eadb5d8d36200c4738537eac1647a6 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#af3eadb5d8d36200c4738537eac1647a6">internal_block_number</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;i_dof) const</td></tr>
<tr class="separator:af3eadb5d8d36200c4738537eac1647a6 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affcfd24c1ba15bf9cac712ffd46dc283 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#affcfd24c1ba15bf9cac712ffd46dc283">internal_index_in_block</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;i_dof) const</td></tr>
<tr class="separator:affcfd24c1ba15bf9cac712ffd46dc283 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19f8ca9f40ab804262cf95c1d5eb598c inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a19f8ca9f40ab804262cf95c1d5eb598c">internal_block_distribution_pt</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#a9d82f3af1459c1efc910b77f3ccd3180">b</a>) const</td></tr>
<tr class="memdesc:a19f8ca9f40ab804262cf95c1d5eb598c inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access function to the internal block distributions.  <a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a19f8ca9f40ab804262cf95c1d5eb598c">More...</a><br /></td></tr>
<tr class="separator:a19f8ca9f40ab804262cf95c1d5eb598c inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b3c4072be2bf4f0dfdd18f56a5d51bf inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a9b3c4072be2bf4f0dfdd18f56a5d51bf">insert_auxiliary_block_distribution</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;block_vec_number, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> *dist_pt)</td></tr>
<tr class="separator:a9b3c4072be2bf4f0dfdd18f56a5d51bf inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d8ff67e34e85a71c0f9bb68c0b10496 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a4d8ff67e34e85a71c0f9bb68c0b10496">block_matrix_test</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, const <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> *block_matrix_pt) const</td></tr>
<tr class="separator:a4d8ff67e34e85a71c0f9bb68c0b10496 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acac55e8dea1a0f63fcf32b7b058b0979 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#acac55e8dea1a0f63fcf32b7b058b0979">get_index_of_value</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; myType &gt; &amp;vec, const myType val, const <a class="el" href="../../d9/db9/classbool.html">bool</a> sorted=false) const</td></tr>
<tr class="separator:acac55e8dea1a0f63fcf32b7b058b0979 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classoomph_1_1Preconditioner"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classoomph_1_1Preconditioner')"><img src="../../closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html">oomph::Preconditioner</a></td></tr>
<tr class="memitem:a7bd8801e4395ccb88fe1f4296e77e9ab inherit pub_methods_classoomph_1_1Preconditioner"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#a7bd8801e4395ccb88fe1f4296e77e9ab">Preconditioner</a> ()</td></tr>
<tr class="memdesc:a7bd8801e4395ccb88fe1f4296e77e9ab inherit pub_methods_classoomph_1_1Preconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="../../db/d9e/classoomph_1_1Preconditioner.html#a7bd8801e4395ccb88fe1f4296e77e9ab">More...</a><br /></td></tr>
<tr class="separator:a7bd8801e4395ccb88fe1f4296e77e9ab inherit pub_methods_classoomph_1_1Preconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6e58c82c3cc4f4e44434a7d92d8e776 inherit pub_methods_classoomph_1_1Preconditioner"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#ab6e58c82c3cc4f4e44434a7d92d8e776">Preconditioner</a> (const <a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html">Preconditioner</a> &amp;)=delete</td></tr>
<tr class="memdesc:ab6e58c82c3cc4f4e44434a7d92d8e776 inherit pub_methods_classoomph_1_1Preconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken copy constructor.  <a href="../../db/d9e/classoomph_1_1Preconditioner.html#ab6e58c82c3cc4f4e44434a7d92d8e776">More...</a><br /></td></tr>
<tr class="separator:ab6e58c82c3cc4f4e44434a7d92d8e776 inherit pub_methods_classoomph_1_1Preconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63fefcfb21ae1c2a3b4232d2dfbb6340 inherit pub_methods_classoomph_1_1Preconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#a63fefcfb21ae1c2a3b4232d2dfbb6340">operator=</a> (const <a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html">Preconditioner</a> &amp;)=delete</td></tr>
<tr class="memdesc:a63fefcfb21ae1c2a3b4232d2dfbb6340 inherit pub_methods_classoomph_1_1Preconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken assignment operator.  <a href="../../db/d9e/classoomph_1_1Preconditioner.html#a63fefcfb21ae1c2a3b4232d2dfbb6340">More...</a><br /></td></tr>
<tr class="separator:a63fefcfb21ae1c2a3b4232d2dfbb6340 inherit pub_methods_classoomph_1_1Preconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab60952a82cc1b6b91fff5924eaa62c0e inherit pub_methods_classoomph_1_1Preconditioner"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#ab60952a82cc1b6b91fff5924eaa62c0e">~Preconditioner</a> ()</td></tr>
<tr class="memdesc:ab60952a82cc1b6b91fff5924eaa62c0e inherit pub_methods_classoomph_1_1Preconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor (empty)  <a href="../../db/d9e/classoomph_1_1Preconditioner.html#ab60952a82cc1b6b91fff5924eaa62c0e">More...</a><br /></td></tr>
<tr class="separator:ab60952a82cc1b6b91fff5924eaa62c0e inherit pub_methods_classoomph_1_1Preconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e469ffc87f31f6f2eebbe5ccf03d78b inherit pub_methods_classoomph_1_1Preconditioner"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#a1e469ffc87f31f6f2eebbe5ccf03d78b">preconditioner_solve_transpose</a> (const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;r, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;z)</td></tr>
<tr class="separator:a1e469ffc87f31f6f2eebbe5ccf03d78b inherit pub_methods_classoomph_1_1Preconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b95e7159585b5151f9e5dc1d1713655 inherit pub_methods_classoomph_1_1Preconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#a0b95e7159585b5151f9e5dc1d1713655">setup</a> (<a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html">DoubleMatrixBase</a> *<a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#a66726e9df31365df646cdf83a975aa26">matrix_pt</a>)</td></tr>
<tr class="separator:a0b95e7159585b5151f9e5dc1d1713655 inherit pub_methods_classoomph_1_1Preconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a783fae97e4b898f8de72b504a4f4bec6 inherit pub_methods_classoomph_1_1Preconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#a783fae97e4b898f8de72b504a4f4bec6">setup</a> (const <a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *problem_pt, <a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html">DoubleMatrixBase</a> *<a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#a66726e9df31365df646cdf83a975aa26">matrix_pt</a>)</td></tr>
<tr class="separator:a783fae97e4b898f8de72b504a4f4bec6 inherit pub_methods_classoomph_1_1Preconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad84467ec9243138945c4d5bbca8fa6c inherit pub_methods_classoomph_1_1Preconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#aad84467ec9243138945c4d5bbca8fa6c">enable_silent_preconditioner_setup</a> ()</td></tr>
<tr class="memdesc:aad84467ec9243138945c4d5bbca8fa6c inherit pub_methods_classoomph_1_1Preconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set up the block preconditioner quietly!  <a href="../../db/d9e/classoomph_1_1Preconditioner.html#aad84467ec9243138945c4d5bbca8fa6c">More...</a><br /></td></tr>
<tr class="separator:aad84467ec9243138945c4d5bbca8fa6c inherit pub_methods_classoomph_1_1Preconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a221f120f734fd3ca851db42b8defb53d inherit pub_methods_classoomph_1_1Preconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#a221f120f734fd3ca851db42b8defb53d">disable_silent_preconditioner_setup</a> ()</td></tr>
<tr class="memdesc:a221f120f734fd3ca851db42b8defb53d inherit pub_methods_classoomph_1_1Preconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Be verbose in the block preconditioner setup.  <a href="../../db/d9e/classoomph_1_1Preconditioner.html#a221f120f734fd3ca851db42b8defb53d">More...</a><br /></td></tr>
<tr class="separator:a221f120f734fd3ca851db42b8defb53d inherit pub_methods_classoomph_1_1Preconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af459b7333c4c64435fd8fa933535901f inherit pub_methods_classoomph_1_1Preconditioner"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#af459b7333c4c64435fd8fa933535901f">set_matrix_pt</a> (<a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html">DoubleMatrixBase</a> *<a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#a66726e9df31365df646cdf83a975aa26">matrix_pt</a>)</td></tr>
<tr class="memdesc:af459b7333c4c64435fd8fa933535901f inherit pub_methods_classoomph_1_1Preconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the matrix pointer.  <a href="../../db/d9e/classoomph_1_1Preconditioner.html#af459b7333c4c64435fd8fa933535901f">More...</a><br /></td></tr>
<tr class="separator:af459b7333c4c64435fd8fa933535901f inherit pub_methods_classoomph_1_1Preconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada7219933e05d94f39a46a8ddb4c749a inherit pub_methods_classoomph_1_1Preconditioner"><td class="memItemLeft" align="right" valign="top">virtual const <a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html">OomphCommunicator</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#ada7219933e05d94f39a46a8ddb4c749a">comm_pt</a> () const</td></tr>
<tr class="memdesc:ada7219933e05d94f39a46a8ddb4c749a inherit pub_methods_classoomph_1_1Preconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get function for comm pointer.  <a href="../../db/d9e/classoomph_1_1Preconditioner.html#ada7219933e05d94f39a46a8ddb4c749a">More...</a><br /></td></tr>
<tr class="separator:ada7219933e05d94f39a46a8ddb4c749a inherit pub_methods_classoomph_1_1Preconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a306f5a52f493816fcfda2dc9b2ee1dbf inherit pub_methods_classoomph_1_1Preconditioner"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#a306f5a52f493816fcfda2dc9b2ee1dbf">set_comm_pt</a> (const <a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html">OomphCommunicator</a> *const <a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#ada7219933e05d94f39a46a8ddb4c749a">comm_pt</a>)</td></tr>
<tr class="memdesc:a306f5a52f493816fcfda2dc9b2ee1dbf inherit pub_methods_classoomph_1_1Preconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the communicator pointer.  <a href="../../db/d9e/classoomph_1_1Preconditioner.html#a306f5a52f493816fcfda2dc9b2ee1dbf">More...</a><br /></td></tr>
<tr class="separator:a306f5a52f493816fcfda2dc9b2ee1dbf inherit pub_methods_classoomph_1_1Preconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9202e15534f063a8e21a8a60623eac9f inherit pub_methods_classoomph_1_1Preconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#a9202e15534f063a8e21a8a60623eac9f">setup_time</a> () const</td></tr>
<tr class="memdesc:a9202e15534f063a8e21a8a60623eac9f inherit pub_methods_classoomph_1_1Preconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the time to setup the preconditioner.  <a href="../../db/d9e/classoomph_1_1Preconditioner.html#a9202e15534f063a8e21a8a60623eac9f">More...</a><br /></td></tr>
<tr class="separator:a9202e15534f063a8e21a8a60623eac9f inherit pub_methods_classoomph_1_1Preconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1183f65956ef8a5b332a1246f418e907 inherit pub_methods_classoomph_1_1Preconditioner"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#a1183f65956ef8a5b332a1246f418e907">turn_into_subsidiary_block_preconditioner</a> (<a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html">BlockPreconditioner</a>&lt; <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> &gt; *master_block_prec_pt, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;doftype_in_master_preconditioner_coarse)</td></tr>
<tr class="separator:a1183f65956ef8a5b332a1246f418e907 inherit pub_methods_classoomph_1_1Preconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad565e8036a34a48259aed3ce91f821ef inherit pub_methods_classoomph_1_1Preconditioner"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#ad565e8036a34a48259aed3ce91f821ef">turn_into_subsidiary_block_preconditioner</a> (<a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html">BlockPreconditioner</a>&lt; <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> &gt; *master_block_prec_pt, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;doftype_in_master_preconditioner_coarse, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt;&gt; &amp;doftype_coarsen_map_coarse)</td></tr>
<tr class="separator:ad565e8036a34a48259aed3ce91f821ef inherit pub_methods_classoomph_1_1Preconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classoomph_1_1DistributableLinearAlgebraObject')"><img src="../../closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html">oomph::DistributableLinearAlgebraObject</a></td></tr>
<tr class="memitem:ac9492d59cff9d9b0098712ae72989cd3 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ac9492d59cff9d9b0098712ae72989cd3">DistributableLinearAlgebraObject</a> ()</td></tr>
<tr class="memdesc:ac9492d59cff9d9b0098712ae72989cd3 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default constructor - create a distribution.  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ac9492d59cff9d9b0098712ae72989cd3">More...</a><br /></td></tr>
<tr class="separator:ac9492d59cff9d9b0098712ae72989cd3 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7522391265c46e6c748fd660eae66f5e inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a7522391265c46e6c748fd660eae66f5e">DistributableLinearAlgebraObject</a> (const <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html">DistributableLinearAlgebraObject</a> &amp;<a class="el" href="../../da/d67/level3__impl_8h.html#a21849b14ce38b5bc40d43a5782d89138">matrix</a>)=delete</td></tr>
<tr class="memdesc:a7522391265c46e6c748fd660eae66f5e inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken copy constructor.  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a7522391265c46e6c748fd660eae66f5e">More...</a><br /></td></tr>
<tr class="separator:a7522391265c46e6c748fd660eae66f5e inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada5f539f36451c06e69de79bb129521b inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ada5f539f36451c06e69de79bb129521b">operator=</a> (const <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html">DistributableLinearAlgebraObject</a> &amp;)=delete</td></tr>
<tr class="memdesc:ada5f539f36451c06e69de79bb129521b inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken assignment operator.  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ada5f539f36451c06e69de79bb129521b">More...</a><br /></td></tr>
<tr class="separator:ada5f539f36451c06e69de79bb129521b inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4038de53b5737dc625411e7848d21dad inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a4038de53b5737dc625411e7848d21dad">~DistributableLinearAlgebraObject</a> ()</td></tr>
<tr class="memdesc:a4038de53b5737dc625411e7848d21dad inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a4038de53b5737dc625411e7848d21dad">More...</a><br /></td></tr>
<tr class="separator:a4038de53b5737dc625411e7848d21dad inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a603105384d60c9a3710378af39f538b9 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a> () const</td></tr>
<tr class="memdesc:a603105384d60c9a3710378af39f538b9 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">access to the LinearAlgebraDistribution  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">More...</a><br /></td></tr>
<tr class="separator:a603105384d60c9a3710378af39f538b9 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7569556f14fd68b28508920e89bd5eee inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a7569556f14fd68b28508920e89bd5eee">nrow</a> () const</td></tr>
<tr class="memdesc:a7569556f14fd68b28508920e89bd5eee inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">access function to the number of global rows.  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a7569556f14fd68b28508920e89bd5eee">More...</a><br /></td></tr>
<tr class="separator:a7569556f14fd68b28508920e89bd5eee inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bd7e1d242c69a28da85a804a7717fce inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">nrow_local</a> () const</td></tr>
<tr class="memdesc:a9bd7e1d242c69a28da85a804a7717fce inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">access function for the num of local rows on this processor.  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">More...</a><br /></td></tr>
<tr class="separator:a9bd7e1d242c69a28da85a804a7717fce inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21e966b025edec79067b41d7f1f25220 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a21e966b025edec79067b41d7f1f25220">nrow_local</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>) const</td></tr>
<tr class="memdesc:a21e966b025edec79067b41d7f1f25220 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">access function for the num of local rows on this processor.  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a21e966b025edec79067b41d7f1f25220">More...</a><br /></td></tr>
<tr class="separator:a21e966b025edec79067b41d7f1f25220 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab00a3919b8634c698749f14a4d92947d inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ab00a3919b8634c698749f14a4d92947d">first_row</a> () const</td></tr>
<tr class="memdesc:ab00a3919b8634c698749f14a4d92947d inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">access function for the first row on this processor  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ab00a3919b8634c698749f14a4d92947d">More...</a><br /></td></tr>
<tr class="separator:ab00a3919b8634c698749f14a4d92947d inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4266c1d18d8e102bad3f4aec26c9b7cf inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a4266c1d18d8e102bad3f4aec26c9b7cf">first_row</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>) const</td></tr>
<tr class="memdesc:a4266c1d18d8e102bad3f4aec26c9b7cf inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">access function for the first row on this processor  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a4266c1d18d8e102bad3f4aec26c9b7cf">More...</a><br /></td></tr>
<tr class="separator:a4266c1d18d8e102bad3f4aec26c9b7cf inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5505731e7e73d7e4251c67c7adec6bf5 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a5505731e7e73d7e4251c67c7adec6bf5">distributed</a> () const</td></tr>
<tr class="memdesc:a5505731e7e73d7e4251c67c7adec6bf5 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">distribution is serial or distributed  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a5505731e7e73d7e4251c67c7adec6bf5">More...</a><br /></td></tr>
<tr class="separator:a5505731e7e73d7e4251c67c7adec6bf5 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c35baa65e335043f62954c92c090a5a inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a8c35baa65e335043f62954c92c090a5a">distribution_built</a> () const</td></tr>
<tr class="separator:a8c35baa65e335043f62954c92c090a5a inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5340bac40b9559b0378037b57005203 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ac5340bac40b9559b0378037b57005203">build_distribution</a> (const <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> *const dist_pt)</td></tr>
<tr class="separator:ac5340bac40b9559b0378037b57005203 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adad20ac61a61d907f823da7694b50616 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#adad20ac61a61d907f823da7694b50616">build_distribution</a> (const <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> &amp;dist)</td></tr>
<tr class="separator:adad20ac61a61d907f823da7694b50616 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a4a886ec6c0ec223b5f24e27efcc9584b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a4a886ec6c0ec223b5f24e27efcc9584b">Preconditioner_has_been_setup</a></td></tr>
<tr class="separator:a4a886ec6c0ec223b5f24e27efcc9584b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa555c464abd2ac23045a52336123c0a2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#aa555c464abd2ac23045a52336123c0a2">Scaling_sigma</a></td></tr>
<tr class="memdesc:aa555c464abd2ac23045a52336123c0a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Scaling for the augmentation: Scaling_sigma*(LL^T)  <a href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#aa555c464abd2ac23045a52336123c0a2">More...</a><br /></td></tr>
<tr class="separator:aa555c464abd2ac23045a52336123c0a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4da1aa7fd0b1a4f9d8eef074f4d1ed81"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a4da1aa7fd0b1a4f9d8eef074f4d1ed81">Use_norm_f_for_scaling_sigma</a></td></tr>
<tr class="separator:a4da1aa7fd0b1a4f9d8eef074f4d1ed81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82c70d4dd69f67181ae6c4c93b4e284f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a82c70d4dd69f67181ae6c4c93b4e284f">Inv_w_diag_values</a></td></tr>
<tr class="memdesc:a82c70d4dd69f67181ae6c4c93b4e284f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inverse W values.  <a href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a82c70d4dd69f67181ae6c4c93b4e284f">More...</a><br /></td></tr>
<tr class="separator:a82c70d4dd69f67181ae6c4c93b4e284f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03e1316c85ca538a3b6912154e57fd42"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html">Preconditioner</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a03e1316c85ca538a3b6912154e57fd42">Navier_stokes_preconditioner_pt</a></td></tr>
<tr class="memdesc:a03e1316c85ca538a3b6912154e57fd42"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to the 'preconditioner' for the Navier-Stokes block.  <a href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a03e1316c85ca538a3b6912154e57fd42">More...</a><br /></td></tr>
<tr class="separator:a03e1316c85ca538a3b6912154e57fd42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd83bbbc271df1e5d5f5a96054b0742a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#abd83bbbc271df1e5d5f5a96054b0742a">Navier_stokes_preconditioner_is_block_preconditioner</a></td></tr>
<tr class="separator:abd83bbbc271df1e5d5f5a96054b0742a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab447b9d1830e1b470e090efa13201844"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#ab447b9d1830e1b470e090efa13201844">Using_superlu_ns_preconditioner</a></td></tr>
<tr class="memdesc:ab447b9d1830e1b470e090efa13201844"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag to indicate whether the default NS preconditioner is used.  <a href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#ab447b9d1830e1b470e090efa13201844">More...</a><br /></td></tr>
<tr class="separator:ab447b9d1830e1b470e090efa13201844"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9f26444d532bd55864f3d38bf369108"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#ae9f26444d532bd55864f3d38bf369108">My_mesh_pt</a></td></tr>
<tr class="separator:ae9f26444d532bd55864f3d38bf369108"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bbfdf74c3cdc461831f03858f9cb1b7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a6bbfdf74c3cdc461831f03858f9cb1b7">My_ndof_types_in_mesh</a></td></tr>
<tr class="separator:a6bbfdf74c3cdc461831f03858f9cb1b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a862f54ac1db0001ebcd205b1ecc8ad08"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a862f54ac1db0001ebcd205b1ecc8ad08">My_nmesh</a></td></tr>
<tr class="separator:a862f54ac1db0001ebcd205b1ecc8ad08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d62cc72563ff5a2feae895d91ebca1e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a0d62cc72563ff5a2feae895d91ebca1e">N_lagrange_doftypes</a></td></tr>
<tr class="memdesc:a0d62cc72563ff5a2feae895d91ebca1e"><td class="mdescLeft">&#160;</td><td class="mdescRight">The number of Lagrange multiplier DOF types.  <a href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a0d62cc72563ff5a2feae895d91ebca1e">More...</a><br /></td></tr>
<tr class="separator:a0d62cc72563ff5a2feae895d91ebca1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c3f53129425f029bf918f33430c0635"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a1c3f53129425f029bf918f33430c0635">N_fluid_doftypes</a></td></tr>
<tr class="memdesc:a1c3f53129425f029bf918f33430c0635"><td class="mdescLeft">&#160;</td><td class="mdescRight">The number of fluid DOF types (including pressure).  <a href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a1c3f53129425f029bf918f33430c0635">More...</a><br /></td></tr>
<tr class="separator:a1c3f53129425f029bf918f33430c0635"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afdf4577b51473f146c55cb6016b11797"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#afdf4577b51473f146c55cb6016b11797">N_velocity_doftypes</a></td></tr>
<tr class="memdesc:afdf4577b51473f146c55cb6016b11797"><td class="mdescLeft">&#160;</td><td class="mdescRight">The number of velocity DOF types.  <a href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#afdf4577b51473f146c55cb6016b11797">More...</a><br /></td></tr>
<tr class="separator:afdf4577b51473f146c55cb6016b11797"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_methods_classoomph_1_1BlockPreconditioner"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classoomph_1_1BlockPreconditioner')"><img src="../../closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;</a></td></tr>
<tr class="memitem:ae055f998f6145656352aacac22e545ad inherit pro_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ae055f998f6145656352aacac22e545ad">set_nmesh</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d5/d24/level2__real__impl_8h.html#a1224f27e9a621d957f8124bcade25bed">n</a>)</td></tr>
<tr class="separator:ae055f998f6145656352aacac22e545ad inherit pro_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af97821621b570d409e6662939e5f818d inherit pro_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#af97821621b570d409e6662939e5f818d">set_mesh</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>, const <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const <a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a3c0e92cb77c3e3179007fe9fd99b6428">mesh_pt</a>, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;allow_multiple_element_type_in_mesh=false)</td></tr>
<tr class="separator:af97821621b570d409e6662939e5f818d inherit pro_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a0ae880f098d5b1e9df78fc74c31dbf inherit pro_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a8a0ae880f098d5b1e9df78fc74c31dbf">set_replacement_dof_block</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;block_i, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;block_j, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> *<a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a571824cedc7e458a612111b51f20e5fb">replacement_dof_block_pt</a>)</td></tr>
<tr class="separator:a8a0ae880f098d5b1e9df78fc74c31dbf inherit pro_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6fb68db9e79048615984b005f8aa43b3 inherit pro_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a6fb68db9e79048615984b005f8aa43b3">any_mesh_distributed</a> () const</td></tr>
<tr class="separator:a6fb68db9e79048615984b005f8aa43b3 inherit pro_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb4dff3469cc6718103fddfdf3f3a7bb inherit pro_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#abb4dff3469cc6718103fddfdf3f3a7bb">internal_dof_number</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;i_dof) const</td></tr>
<tr class="separator:abb4dff3469cc6718103fddfdf3f3a7bb inherit pro_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e0a33327b5042dfba04baf46c045373 inherit pro_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a1e0a33327b5042dfba04baf46c045373">internal_index_in_dof</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;i_dof) const</td></tr>
<tr class="separator:a1e0a33327b5042dfba04baf46c045373 inherit pro_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac460225afc092cc5ed9d77acc6316536 inherit pro_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ac460225afc092cc5ed9d77acc6316536">internal_block_dimension</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#a9d82f3af1459c1efc910b77f3ccd3180">b</a>) const</td></tr>
<tr class="separator:ac460225afc092cc5ed9d77acc6316536 inherit pro_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe03c970690224b46a29e55e16992dd7 inherit pro_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#abe03c970690224b46a29e55e16992dd7">internal_dof_block_dimension</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>) const</td></tr>
<tr class="separator:abe03c970690224b46a29e55e16992dd7 inherit pro_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e5b553f65e6c25354a5c908d507e8ee inherit pro_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a3e5b553f65e6c25354a5c908d507e8ee">master_nrow</a> () const</td></tr>
<tr class="separator:a3e5b553f65e6c25354a5c908d507e8ee inherit pro_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7297e4d24c2c7ae7af6a9ad009669928 inherit pro_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a7297e4d24c2c7ae7af6a9ad009669928">internal_master_dof_number</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#a9d82f3af1459c1efc910b77f3ccd3180">b</a>) const</td></tr>
<tr class="separator:a7297e4d24c2c7ae7af6a9ad009669928 inherit pro_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a16de88bd5369e729d761a6498fdd3f inherit pro_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a3a16de88bd5369e729d761a6498fdd3f">internal_preconditioner_matrix_distribution_pt</a> () const</td></tr>
<tr class="separator:a3a16de88bd5369e729d761a6498fdd3f inherit pro_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74eeff188f842dd8abdff1b7d9801d44 inherit pro_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a74eeff188f842dd8abdff1b7d9801d44">preconditioner_matrix_distribution_pt</a> () const</td></tr>
<tr class="separator:a74eeff188f842dd8abdff1b7d9801d44 inherit pro_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_classoomph_1_1DistributableLinearAlgebraObject"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classoomph_1_1DistributableLinearAlgebraObject')"><img src="../../closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html">oomph::DistributableLinearAlgebraObject</a></td></tr>
<tr class="memitem:a30742aa2ac9abcfa037179f2d28ff43a inherit pro_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a30742aa2ac9abcfa037179f2d28ff43a">clear_distribution</a> ()</td></tr>
<tr class="separator:a30742aa2ac9abcfa037179f2d28ff43a inherit pro_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classoomph_1_1BlockPreconditioner"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classoomph_1_1BlockPreconditioner')"><img src="../../closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;</a></td></tr>
<tr class="memitem:ad2cd49c5c823c4202046e97038f6e080 inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d2/d3a/classoomph_1_1MapMatrix.html">MapMatrix</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ad2cd49c5c823c4202046e97038f6e080">Replacement_dof_block_pt</a></td></tr>
<tr class="memdesc:ad2cd49c5c823c4202046e97038f6e080 inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">The replacement dof-level blocks.  <a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ad2cd49c5c823c4202046e97038f6e080">More...</a><br /></td></tr>
<tr class="separator:ad2cd49c5c823c4202046e97038f6e080 inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59e83eca59e3cdc41a93668539e138f1 inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a59e83eca59e3cdc41a93668539e138f1">Block_distribution_pt</a></td></tr>
<tr class="memdesc:a59e83eca59e3cdc41a93668539e138f1 inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">The distribution for the blocks.  <a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a59e83eca59e3cdc41a93668539e138f1">More...</a><br /></td></tr>
<tr class="separator:a59e83eca59e3cdc41a93668539e138f1 inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae047d81b8179dfd09b70cf35f40f62ca inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ae047d81b8179dfd09b70cf35f40f62ca">Block_to_dof_map_coarse</a></td></tr>
<tr class="separator:ae047d81b8179dfd09b70cf35f40f62ca inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a278946969944848b12bdc2ceaed91a07 inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a278946969944848b12bdc2ceaed91a07">Block_to_dof_map_fine</a></td></tr>
<tr class="memdesc:a278946969944848b12bdc2ceaed91a07 inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mapping for the block types to the most fine grain dof types.  <a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a278946969944848b12bdc2ceaed91a07">More...</a><br /></td></tr>
<tr class="separator:a278946969944848b12bdc2ceaed91a07 inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a015ba85d839a80512c6c4065e39a3d4a inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a015ba85d839a80512c6c4065e39a3d4a">Doftype_coarsen_map_coarse</a></td></tr>
<tr class="separator:a015ba85d839a80512c6c4065e39a3d4a inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4e2e47f537f9b6b4deae5792c493d65 inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#aa4e2e47f537f9b6b4deae5792c493d65">Doftype_coarsen_map_fine</a></td></tr>
<tr class="separator:aa4e2e47f537f9b6b4deae5792c493d65 inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38de6514d7065086335e0e6f60dc77a9 inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a38de6514d7065086335e0e6f60dc77a9">Internal_block_distribution_pt</a></td></tr>
<tr class="memdesc:a38de6514d7065086335e0e6f60dc77a9 inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Storage for the default distribution for each internal block.  <a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a38de6514d7065086335e0e6f60dc77a9">More...</a><br /></td></tr>
<tr class="separator:a38de6514d7065086335e0e6f60dc77a9 inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21867eb330dd1177c530a590ad1fa571 inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a21867eb330dd1177c530a590ad1fa571">Dof_block_distribution_pt</a></td></tr>
<tr class="separator:a21867eb330dd1177c530a590ad1fa571 inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f3a3ac8c192a83facd5b560f017413e inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a2f3a3ac8c192a83facd5b560f017413e">Allow_multiple_element_type_in_mesh</a></td></tr>
<tr class="separator:a2f3a3ac8c192a83facd5b560f017413e inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89adb506e8f9103c80b4b36cc309f536 inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; const <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a89adb506e8f9103c80b4b36cc309f536">Mesh_pt</a></td></tr>
<tr class="separator:a89adb506e8f9103c80b4b36cc309f536 inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43e9d73ff61daa00aea4e4deff0d6aff inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a43e9d73ff61daa00aea4e4deff0d6aff">Ndof_types_in_mesh</a></td></tr>
<tr class="separator:a43e9d73ff61daa00aea4e4deff0d6aff inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06c7426a2c8c096c8f4dc583444e0e0e inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a06c7426a2c8c096c8f4dc583444e0e0e">Internal_nblock_types</a></td></tr>
<tr class="separator:a06c7426a2c8c096c8f4dc583444e0e0e inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3985436e4645c202eadd47a4f4f466e2 inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a3985436e4645c202eadd47a4f4f466e2">Internal_ndof_types</a></td></tr>
<tr class="separator:a3985436e4645c202eadd47a4f4f466e2 inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classoomph_1_1Preconditioner"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classoomph_1_1Preconditioner')"><img src="../../closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html">oomph::Preconditioner</a></td></tr>
<tr class="memitem:ad191d6be6caf8875700f54c939ec33e6 inherit pro_attribs_classoomph_1_1Preconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#ad191d6be6caf8875700f54c939ec33e6">Silent_preconditioner_setup</a></td></tr>
<tr class="memdesc:ad191d6be6caf8875700f54c939ec33e6 inherit pro_attribs_classoomph_1_1Preconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Boolean to indicate whether or not the build should be done silently.  <a href="../../db/d9e/classoomph_1_1Preconditioner.html#ad191d6be6caf8875700f54c939ec33e6">More...</a><br /></td></tr>
<tr class="separator:ad191d6be6caf8875700f54c939ec33e6 inherit pro_attribs_classoomph_1_1Preconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a6b2f6cd34495167ea766b47f055a7d inherit pro_attribs_classoomph_1_1Preconditioner"><td class="memItemLeft" align="right" valign="top">std::ostream *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#a2a6b2f6cd34495167ea766b47f055a7d">Stream_pt</a></td></tr>
<tr class="memdesc:a2a6b2f6cd34495167ea766b47f055a7d inherit pro_attribs_classoomph_1_1Preconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to the output stream &ndash; defaults to std::cout.  <a href="../../db/d9e/classoomph_1_1Preconditioner.html#a2a6b2f6cd34495167ea766b47f055a7d">More...</a><br /></td></tr>
<tr class="separator:a2a6b2f6cd34495167ea766b47f055a7d inherit pro_attribs_classoomph_1_1Preconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The preconditioner for the Lagrange multiplier constrained Navier-Stokes equations. The velocity components are constrained by Lagrange multiplier, which are applied via OOMPH-LIB's FACE elements.</p>
<p>The linearised Jacobian takes the block form:</p>
<p>| F_ns | L^T | |---------&mdash;| | L | 0 |</p>
<p>where L correspond to the constrained block, F_ns is the Navier-Stokes block with the following block structure</p>
<p>| F | G^T | |-------&mdash;| | D | 0 |</p>
<p>Here F is the momentum block, G the discrete gradient operator, and D the discrete divergence operator. For unstabilised elements, we have D = G^T and in much of the literature the divergence matrix is denoted by B.</p>
<p>The Lagrange enforced flow preconditioner takes the form: </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">F_aug   </th><th class="markdownTableHeadNone"></th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Wd   </td></tr>
</table>
<p>where F_aug = F_ns + L^T*inv(Wd)*L is an augmented Navier-Stokes block and Wd=(1/Scaling_sigma)*diag(LL^T).</p>
<p>In our implementation of the preconditioner, the linear systems associated with the (1,1) block can either be solved "exactly", using SuperLU (in its incarnation as an exact preconditioner; this is the default) or by any other Preconditioner (inexact solver) specified via the access functions</p>
<p>LagrangeEnforcedFlowPreconditioner::set_navier_stokes_preconditioner(...)</p>
<p>Access to the elements is provided via meshes. However, a Vector of meshes is taken, each mesh contains a different type of block preconditionable element. This allows the (re-)classification of the constrained velocity DOF types.</p>
<p>The first mesh in the Vector Mesh_pt must be the 'bulk' mesh. The rest are assumed to contain FACEELMENTS.</p>
<p>Thus, the most general block structure (in 3D) is:</p>
<p>0 1 2 3 4 5 6 7 8 ..x x+0 x+1 x+2 x+3 x+4 [u v w p] [u v w l1 l2 ...] [u v w l1 l2 ...] ... Bulk Surface 1 Surface 2 ...</p>
<p>where the DOF types in [] are the DOF types associated with each mesh.</p>
<p>For example, consider a unit cube domain [0,1]^3 with parallel outflow imposed (in mesh 0) and tangential flow imposed (in mesh 1), then there are 13 DOF types and our implementation respects the following (natural) DOF type order:</p>
<p>bulk mesh 0 mesh 1 [0 1 2 3] [4 5 6 7 8 ] [9 10 11 12 ] [u v w p] [up vp wp Lp1 Lp2] [ut vt wt Lt1]</p>
<p>Via the appropriate mapping, the block_setup(...) function will re-order the DOF types into the following block types:</p>
<p>0 1 2 3 4 5 6 7 8 9 10 11 12 &lt;- Block type 0 4 9 1 5 10 2 6 11 3 7 8 12 &lt;- DOF type [u up ut v vp vt w wp wt ] [p] [Lp1 Lp2 Lt1] </p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a id="a080854ab4a9c4d1f8abca5121433b1d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a080854ab4a9c4d1f8abca5121433b1d9">&#9670;&nbsp;</a></span>SubsidiaryPreconditionerFctPt</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html">Preconditioner</a>*(* oomph::LagrangeEnforcedFlowPreconditioner::SubsidiaryPreconditionerFctPt) ()</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This preconditioner includes the option to use subsidiary operators other than SuperLUPreconditioner for this problem. This is the typedef of a function that should return an instance of a subsidiary preconditioning operator. This preconditioner is responsible for the destruction of the subsidiary preconditioners. </p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a807a1c5694e8b2114e0da3702db00d68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a807a1c5694e8b2114e0da3702db00d68">&#9670;&nbsp;</a></span>LagrangeEnforcedFlowPreconditioner() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">oomph::LagrangeEnforcedFlowPreconditioner::LagrangeEnforcedFlowPreconditioner </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructor - initialise variables. </p>
<div class="fragment"><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                                         : BlockPreconditioner&lt;CRDoubleMatrix&gt;()</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <span class="comment">// The null pointer.</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a03e1316c85ca538a3b6912154e57fd42">Navier_stokes_preconditioner_pt</a> = 0;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      <span class="comment">// By default, the linear systems associated with the diagonal blocks</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      <span class="comment">// are solved &quot;exactly&quot; using SuperLU (in its incarnation as an exact</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      <span class="comment">// preconditioner. This is not a block preconditioner.</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#abd83bbbc271df1e5d5f5a96054b0742a">Navier_stokes_preconditioner_is_block_preconditioner</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="comment">// Flag to indicate to use SuperLU or not.</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#ab447b9d1830e1b470e090efa13201844">Using_superlu_ns_preconditioner</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <span class="comment">// Empty vector of meshes and set the number of meshes to zero.</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#ae9f26444d532bd55864f3d38bf369108">My_mesh_pt</a>.resize(0, 0);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a862f54ac1db0001ebcd205b1ecc8ad08">My_nmesh</a> = 0;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <span class="comment">// The number of DOF types within the meshes.</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a6bbfdf74c3cdc461831f03858f9cb1b7">My_ndof_types_in_mesh</a>.resize(0, 0);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      <span class="comment">// Initialise other variables.</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a4da1aa7fd0b1a4f9d8eef074f4d1ed81">Use_norm_f_for_scaling_sigma</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#aa555c464abd2ac23045a52336123c0a2">Scaling_sigma</a> = 0.0;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a0d62cc72563ff5a2feae895d91ebca1e">N_lagrange_doftypes</a> = 0;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a1c3f53129425f029bf918f33430c0635">N_fluid_doftypes</a> = 0;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#afdf4577b51473f146c55cb6016b11797">N_velocity_doftypes</a> = 0;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a4a886ec6c0ec223b5f24e27efcc9584b">Preconditioner_has_been_setup</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    } <span class="comment">// constructor</span></div>
<div class="ttc" id="aclassoomph_1_1LagrangeEnforcedFlowPreconditioner_html_a03e1316c85ca538a3b6912154e57fd42"><div class="ttname"><a href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a03e1316c85ca538a3b6912154e57fd42">oomph::LagrangeEnforcedFlowPreconditioner::Navier_stokes_preconditioner_pt</a></div><div class="ttdeci">Preconditioner * Navier_stokes_preconditioner_pt</div><div class="ttdoc">Pointer to the 'preconditioner' for the Navier-Stokes block.</div><div class="ttdef"><b>Definition:</b> lagrange_enforced_flow_preconditioner.h:319</div></div>
<div class="ttc" id="aclassoomph_1_1LagrangeEnforcedFlowPreconditioner_html_a0d62cc72563ff5a2feae895d91ebca1e"><div class="ttname"><a href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a0d62cc72563ff5a2feae895d91ebca1e">oomph::LagrangeEnforcedFlowPreconditioner::N_lagrange_doftypes</a></div><div class="ttdeci">unsigned N_lagrange_doftypes</div><div class="ttdoc">The number of Lagrange multiplier DOF types.</div><div class="ttdef"><b>Definition:</b> lagrange_enforced_flow_preconditioner.h:342</div></div>
<div class="ttc" id="aclassoomph_1_1LagrangeEnforcedFlowPreconditioner_html_a1c3f53129425f029bf918f33430c0635"><div class="ttname"><a href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a1c3f53129425f029bf918f33430c0635">oomph::LagrangeEnforcedFlowPreconditioner::N_fluid_doftypes</a></div><div class="ttdeci">unsigned N_fluid_doftypes</div><div class="ttdoc">The number of fluid DOF types (including pressure).</div><div class="ttdef"><b>Definition:</b> lagrange_enforced_flow_preconditioner.h:345</div></div>
<div class="ttc" id="aclassoomph_1_1LagrangeEnforcedFlowPreconditioner_html_a4a886ec6c0ec223b5f24e27efcc9584b"><div class="ttname"><a href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a4a886ec6c0ec223b5f24e27efcc9584b">oomph::LagrangeEnforcedFlowPreconditioner::Preconditioner_has_been_setup</a></div><div class="ttdeci">bool Preconditioner_has_been_setup</div><div class="ttdef"><b>Definition:</b> lagrange_enforced_flow_preconditioner.h:306</div></div>
<div class="ttc" id="aclassoomph_1_1LagrangeEnforcedFlowPreconditioner_html_a4da1aa7fd0b1a4f9d8eef074f4d1ed81"><div class="ttname"><a href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a4da1aa7fd0b1a4f9d8eef074f4d1ed81">oomph::LagrangeEnforcedFlowPreconditioner::Use_norm_f_for_scaling_sigma</a></div><div class="ttdeci">bool Use_norm_f_for_scaling_sigma</div><div class="ttdef"><b>Definition:</b> lagrange_enforced_flow_preconditioner.h:313</div></div>
<div class="ttc" id="aclassoomph_1_1LagrangeEnforcedFlowPreconditioner_html_a6bbfdf74c3cdc461831f03858f9cb1b7"><div class="ttname"><a href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a6bbfdf74c3cdc461831f03858f9cb1b7">oomph::LagrangeEnforcedFlowPreconditioner::My_ndof_types_in_mesh</a></div><div class="ttdeci">Vector&lt; unsigned &gt; My_ndof_types_in_mesh</div><div class="ttdef"><b>Definition:</b> lagrange_enforced_flow_preconditioner.h:335</div></div>
<div class="ttc" id="aclassoomph_1_1LagrangeEnforcedFlowPreconditioner_html_a862f54ac1db0001ebcd205b1ecc8ad08"><div class="ttname"><a href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a862f54ac1db0001ebcd205b1ecc8ad08">oomph::LagrangeEnforcedFlowPreconditioner::My_nmesh</a></div><div class="ttdeci">unsigned My_nmesh</div><div class="ttdef"><b>Definition:</b> lagrange_enforced_flow_preconditioner.h:339</div></div>
<div class="ttc" id="aclassoomph_1_1LagrangeEnforcedFlowPreconditioner_html_aa555c464abd2ac23045a52336123c0a2"><div class="ttname"><a href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#aa555c464abd2ac23045a52336123c0a2">oomph::LagrangeEnforcedFlowPreconditioner::Scaling_sigma</a></div><div class="ttdeci">double Scaling_sigma</div><div class="ttdoc">Scaling for the augmentation: Scaling_sigma*(LL^T)</div><div class="ttdef"><b>Definition:</b> lagrange_enforced_flow_preconditioner.h:309</div></div>
<div class="ttc" id="aclassoomph_1_1LagrangeEnforcedFlowPreconditioner_html_ab447b9d1830e1b470e090efa13201844"><div class="ttname"><a href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#ab447b9d1830e1b470e090efa13201844">oomph::LagrangeEnforcedFlowPreconditioner::Using_superlu_ns_preconditioner</a></div><div class="ttdeci">bool Using_superlu_ns_preconditioner</div><div class="ttdoc">Flag to indicate whether the default NS preconditioner is used.</div><div class="ttdef"><b>Definition:</b> lagrange_enforced_flow_preconditioner.h:326</div></div>
<div class="ttc" id="aclassoomph_1_1LagrangeEnforcedFlowPreconditioner_html_abd83bbbc271df1e5d5f5a96054b0742a"><div class="ttname"><a href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#abd83bbbc271df1e5d5f5a96054b0742a">oomph::LagrangeEnforcedFlowPreconditioner::Navier_stokes_preconditioner_is_block_preconditioner</a></div><div class="ttdeci">bool Navier_stokes_preconditioner_is_block_preconditioner</div><div class="ttdef"><b>Definition:</b> lagrange_enforced_flow_preconditioner.h:323</div></div>
<div class="ttc" id="aclassoomph_1_1LagrangeEnforcedFlowPreconditioner_html_ae9f26444d532bd55864f3d38bf369108"><div class="ttname"><a href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#ae9f26444d532bd55864f3d38bf369108">oomph::LagrangeEnforcedFlowPreconditioner::My_mesh_pt</a></div><div class="ttdeci">Vector&lt; Mesh * &gt; My_mesh_pt</div><div class="ttdef"><b>Definition:</b> lagrange_enforced_flow_preconditioner.h:331</div></div>
<div class="ttc" id="aclassoomph_1_1LagrangeEnforcedFlowPreconditioner_html_afdf4577b51473f146c55cb6016b11797"><div class="ttname"><a href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#afdf4577b51473f146c55cb6016b11797">oomph::LagrangeEnforcedFlowPreconditioner::N_velocity_doftypes</a></div><div class="ttdeci">unsigned N_velocity_doftypes</div><div class="ttdoc">The number of velocity DOF types.</div><div class="ttdef"><b>Definition:</b> lagrange_enforced_flow_preconditioner.h:348</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#ae9f26444d532bd55864f3d38bf369108">My_mesh_pt</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a6bbfdf74c3cdc461831f03858f9cb1b7">My_ndof_types_in_mesh</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a862f54ac1db0001ebcd205b1ecc8ad08">My_nmesh</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a1c3f53129425f029bf918f33430c0635">N_fluid_doftypes</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a0d62cc72563ff5a2feae895d91ebca1e">N_lagrange_doftypes</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#afdf4577b51473f146c55cb6016b11797">N_velocity_doftypes</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#abd83bbbc271df1e5d5f5a96054b0742a">Navier_stokes_preconditioner_is_block_preconditioner</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a03e1316c85ca538a3b6912154e57fd42">Navier_stokes_preconditioner_pt</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a4a886ec6c0ec223b5f24e27efcc9584b">Preconditioner_has_been_setup</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#aa555c464abd2ac23045a52336123c0a2">Scaling_sigma</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a4da1aa7fd0b1a4f9d8eef074f4d1ed81">Use_norm_f_for_scaling_sigma</a>, and <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#ab447b9d1830e1b470e090efa13201844">Using_superlu_ns_preconditioner</a>.</p>

</div>
</div>
<a id="a9958f85a43c683c5a97b449faa35ca74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9958f85a43c683c5a97b449faa35ca74">&#9670;&nbsp;</a></span>~LagrangeEnforcedFlowPreconditioner()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual oomph::LagrangeEnforcedFlowPreconditioner::~LagrangeEnforcedFlowPreconditioner </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destructor. </p>
<div class="fragment"><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      this-&gt;<a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#ace8141de668eb2a172ef9a25c932134a">clean_up_memory</a>();</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1LagrangeEnforcedFlowPreconditioner_html_ace8141de668eb2a172ef9a25c932134a"><div class="ttname"><a href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#ace8141de668eb2a172ef9a25c932134a">oomph::LagrangeEnforcedFlowPreconditioner::clean_up_memory</a></div><div class="ttdeci">void clean_up_memory()</div><div class="ttdoc">Clears the memory.</div><div class="ttdef"><b>Definition:</b> lagrange_enforced_flow_preconditioner.cc:1250</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#ace8141de668eb2a172ef9a25c932134a">clean_up_memory()</a>.</p>

</div>
</div>
<a id="a42c105fbbbacfa736650bfb9ebb36db4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42c105fbbbacfa736650bfb9ebb36db4">&#9670;&nbsp;</a></span>LagrangeEnforcedFlowPreconditioner() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">oomph::LagrangeEnforcedFlowPreconditioner::LagrangeEnforcedFlowPreconditioner </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html">LagrangeEnforcedFlowPreconditioner</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Broken copy constructor. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ace8141de668eb2a172ef9a25c932134a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace8141de668eb2a172ef9a25c932134a">&#9670;&nbsp;</a></span>clean_up_memory()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::LagrangeEnforcedFlowPreconditioner::clean_up_memory </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Clears the memory. </p>

<p>Reimplemented from <a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#a46c31c416829bedcd9db238431262027">oomph::Preconditioner</a>.</p>
<div class="fragment"><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;  {</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    <span class="comment">// clean the block preconditioner base class memory</span></div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a7845d9301918e3f5cbecd729ec1e309b">clear_block_preconditioner_base</a>();</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160; </div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;    <span class="comment">// Delete the Navier-Stokes preconditioner pointer if we have created it.</span></div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#ab447b9d1830e1b470e090efa13201844">Using_superlu_ns_preconditioner</a> &amp;&amp; <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a03e1316c85ca538a3b6912154e57fd42">Navier_stokes_preconditioner_pt</a> != 0)</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;    {</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;      <span class="keyword">delete</span> <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a03e1316c85ca538a3b6912154e57fd42">Navier_stokes_preconditioner_pt</a>;</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;      <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a03e1316c85ca538a3b6912154e57fd42">Navier_stokes_preconditioner_pt</a> = 0;</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;    }</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160; </div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;    <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a4a886ec6c0ec223b5f24e27efcc9584b">Preconditioner_has_been_setup</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;  } <span class="comment">// func LagrangeEnforcedFlowPreconditioner::clean_up_memory</span></div>
<div class="ttc" id="aclassoomph_1_1BlockPreconditioner_html_a7845d9301918e3f5cbecd729ec1e309b"><div class="ttname"><a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a7845d9301918e3f5cbecd729ec1e309b">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::clear_block_preconditioner_base</a></div><div class="ttdeci">void clear_block_preconditioner_base()</div><div class="ttdef"><b>Definition:</b> block_preconditioner.h:2159</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a7845d9301918e3f5cbecd729ec1e309b">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::clear_block_preconditioner_base()</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a03e1316c85ca538a3b6912154e57fd42">Navier_stokes_preconditioner_pt</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a4a886ec6c0ec223b5f24e27efcc9584b">Preconditioner_has_been_setup</a>, and <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#ab447b9d1830e1b470e090efa13201844">Using_superlu_ns_preconditioner</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#aadcbdb5af92d7889c956098cb86dee87">setup()</a>, and <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a9958f85a43c683c5a97b449faa35ca74">~LagrangeEnforcedFlowPreconditioner()</a>.</p>

</div>
</div>
<a id="a9e4241546e226e835631c1d1ddb6da0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e4241546e226e835631c1d1ddb6da0f">&#9670;&nbsp;</a></span>operator=()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::LagrangeEnforcedFlowPreconditioner::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html">LagrangeEnforcedFlowPreconditioner</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Broken assignment operator. </p>

</div>
</div>
<a id="a519940fc2faee5faac00b80004f3edea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a519940fc2faee5faac00b80004f3edea">&#9670;&nbsp;</a></span>preconditioner_solve()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::LagrangeEnforcedFlowPreconditioner::preconditioner_solve </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;&#160;</td>
          <td class="paramname"><em>z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Apply the preconditioner. r is the residual (rhs), z will contain the solution.</p>
<p>///////////////////////////////////////////////////////////////////////// ///////////////////////////////////////////////////////////////////////// ///////////////////////////////////////////////////////////////////////// Apply the preconditioner. r is the residual (rhs), z will contain the solution. </p>

<p>Implements <a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#ace1199369e4465cd2b9a34884bb64ec8">oomph::Preconditioner</a>.</p>
<div class="fragment"><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  {</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a4a886ec6c0ec223b5f24e27efcc9584b">Preconditioner_has_been_setup</a> == <span class="keyword">false</span>)</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    {</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      std::ostringstream error_message;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      error_message &lt;&lt; <span class="stringliteral">&quot;setup() must be called before using &quot;</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;preconditioner_solve()&quot;</span>;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        error_message.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    }</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="keywordflow">if</span> (z.built())</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    {</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      <span class="keywordflow">if</span> (z.nrow() != <a class="code" href="../../de/d6c/namespaceUniformPSDSelfTest.html#a9ef26be0d5673c9bb0c2bb8bce5229d8">r</a>.nrow())</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      {</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        std::ostringstream error_message;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        error_message &lt;&lt; <span class="stringliteral">&quot;The vectors z and r must have the same number of &quot;</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;of global rows&quot;</span>;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(error_message.str(),</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      }</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    }</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160; </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="comment">// if z is not setup then give it the same distribution</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordflow">if</span> (!z.distribution_pt()-&gt;built())</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    {</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      z.build(<a class="code" href="../../de/d6c/namespaceUniformPSDSelfTest.html#a9ef26be0d5673c9bb0c2bb8bce5229d8">r</a>.distribution_pt(), 0.0);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    }</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160; </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="comment">// Working vectors.</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <a class="code" href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a> temp_vec;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <a class="code" href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a> another_temp_vec;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <a class="code" href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a> yet_another_temp_vec;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160; </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="comment">// -----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="comment">// Step 1 - apply approximate W block inverse to Lagrange multiplier</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="comment">// unknowns</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="comment">// -----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="comment">// For each subsystem associated with each Lagrange multiplier, we loop</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="comment">// through and:</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="comment">// 1) extract the block entries from r</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="comment">// 2) apply the inverse</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="comment">// 3) return the entries to z.</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> l_i = 0; l_i &lt; <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a0d62cc72563ff5a2feae895d91ebca1e">N_lagrange_doftypes</a>; l_i++)</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      <span class="comment">// The Lagrange multiplier block type.</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> l_ii = <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a1c3f53129425f029bf918f33430c0635">N_fluid_doftypes</a> + l_i;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160; </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      <span class="comment">// Extract the block</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a7efc9f2f0209764902e4e45fcb2556d1">get_block_vector</a>(l_ii, <a class="code" href="../../de/d6c/namespaceUniformPSDSelfTest.html#a9ef26be0d5673c9bb0c2bb8bce5229d8">r</a>, temp_vec);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      <span class="comment">// Apply the inverse.</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> vec_nrow_local = temp_vec.nrow_local();</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      <span class="keywordtype">double</span>* vec_values_pt = temp_vec.values_pt();</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; vec_nrow_local; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      {</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        vec_values_pt[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = vec_values_pt[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] * <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a82c70d4dd69f67181ae6c4c93b4e284f">Inv_w_diag_values</a>[l_i][<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      } <span class="comment">// for</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160; </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      <span class="comment">// Return the unknowns</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a1dd4d3cd6b64fa64e1ff6730b0deecc7">return_block_vector</a>(l_ii, temp_vec, z);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160; </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      <span class="comment">// Clear vectors.</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      temp_vec.clear();</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    } <span class="comment">// for</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160; </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="comment">// -----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="comment">// Step 2 - apply the augmented Navier-Stokes matrix inverse to the</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="comment">// velocity and pressure unknowns</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="comment">// -----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160; </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="comment">// At this point, all vectors are cleared.</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#ab447b9d1830e1b470e090efa13201844">Using_superlu_ns_preconditioner</a>)</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    {</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      <span class="comment">// Which block types corresponds to the fluid block types.</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      Vector&lt;unsigned&gt; fluid_block_indices(<a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a1c3f53129425f029bf918f33430c0635">N_fluid_doftypes</a>, 0);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a> = 0; <a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a> &lt; <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a1c3f53129425f029bf918f33430c0635">N_fluid_doftypes</a>; <a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a>++)</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      {</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        fluid_block_indices[<a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a>] = <a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a>;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      }</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160; </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#af9321cdab3f506ab95fe51cd9b93deab">get_concatenated_block_vector</a>(fluid_block_indices, <a class="code" href="../../de/d6c/namespaceUniformPSDSelfTest.html#a9ef26be0d5673c9bb0c2bb8bce5229d8">r</a>, temp_vec);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160; </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      <span class="comment">// temp_vec contains the (concatenated) fluid rhs.</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a03e1316c85ca538a3b6912154e57fd42">Navier_stokes_preconditioner_pt</a>-&gt;<a class="code" href="../../db/d9e/classoomph_1_1Preconditioner.html#ace1199369e4465cd2b9a34884bb64ec8">preconditioner_solve</a>(temp_vec,</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                                                            another_temp_vec);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160; </div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      temp_vec.clear();</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160; </div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;      <span class="comment">// Return it to the unknowns.</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a6d5106c0b9dca23aa1cc7f7fd8e696cb">return_concatenated_block_vector</a>(</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        fluid_block_indices, another_temp_vec, z);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      another_temp_vec.clear();</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    }</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    {</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      <span class="comment">// The Navier-Stokes preconditioner is a block preconditioner.</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      <span class="comment">// Thus is handles all of the block vector extraction and returns.</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a03e1316c85ca538a3b6912154e57fd42">Navier_stokes_preconditioner_pt</a>-&gt;<a class="code" href="../../db/d9e/classoomph_1_1Preconditioner.html#ace1199369e4465cd2b9a34884bb64ec8">preconditioner_solve</a>(<a class="code" href="../../de/d6c/namespaceUniformPSDSelfTest.html#a9ef26be0d5673c9bb0c2bb8bce5229d8">r</a>, z);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    }</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  } <span class="comment">// end of preconditioner_solve</span></div>
<div class="ttc" id="aBiCGSTAB__step__by__step_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> BiCGSTAB_step_by_step.cpp:9</div></div>
<div class="ttc" id="aClumpInput_8h_html_a82f6bc76e1c7a0f51bf3e95ad5d3c590"><div class="ttname"><a href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a></div><div class="ttdeci">std::vector&lt; double &gt; DoubleVector</div><div class="ttdoc">loads clump configuration</div><div class="ttdef"><b>Definition:</b> ClumpInput.h:26</div></div>
<div class="ttc" id="abenchVecAdd_8cpp_html_af9816f50f32fc22762a8289c3cc44f22"><div class="ttname"><a href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a></div><div class="ttdeci">Scalar * b</div><div class="ttdef"><b>Definition:</b> benchVecAdd.cpp:17</div></div>
<div class="ttc" id="aclassoomph_1_1BlockPreconditioner_html_a1dd4d3cd6b64fa64e1ff6730b0deecc7"><div class="ttname"><a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a1dd4d3cd6b64fa64e1ff6730b0deecc7">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::return_block_vector</a></div><div class="ttdeci">void return_block_vector(const unsigned &amp;n, const DoubleVector &amp;b, DoubleVector &amp;v) const</div><div class="ttdef"><b>Definition:</b> block_preconditioner.cc:4489</div></div>
<div class="ttc" id="aclassoomph_1_1BlockPreconditioner_html_a6d5106c0b9dca23aa1cc7f7fd8e696cb"><div class="ttname"><a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a6d5106c0b9dca23aa1cc7f7fd8e696cb">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::return_concatenated_block_vector</a></div><div class="ttdeci">void return_concatenated_block_vector(const Vector&lt; unsigned &gt; &amp;block_vec_number, const DoubleVector &amp;b, DoubleVector &amp;v) const</div><div class="ttdoc">Takes concatenated block ordered vector, b, and copies its.</div><div class="ttdef"><b>Definition:</b> block_preconditioner.cc:2774</div></div>
<div class="ttc" id="aclassoomph_1_1BlockPreconditioner_html_a7efc9f2f0209764902e4e45fcb2556d1"><div class="ttname"><a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a7efc9f2f0209764902e4e45fcb2556d1">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::get_block_vector</a></div><div class="ttdeci">void get_block_vector(const unsigned &amp;n, const DoubleVector &amp;v, DoubleVector &amp;b) const</div><div class="ttdef"><b>Definition:</b> block_preconditioner.cc:4186</div></div>
<div class="ttc" id="aclassoomph_1_1BlockPreconditioner_html_af9321cdab3f506ab95fe51cd9b93deab"><div class="ttname"><a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#af9321cdab3f506ab95fe51cd9b93deab">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::get_concatenated_block_vector</a></div><div class="ttdeci">void get_concatenated_block_vector(const Vector&lt; unsigned &gt; &amp;block_vec_number, const DoubleVector &amp;v, DoubleVector &amp;b)</div><div class="ttdef"><b>Definition:</b> block_preconditioner.cc:2608</div></div>
<div class="ttc" id="aclassoomph_1_1LagrangeEnforcedFlowPreconditioner_html_a82c70d4dd69f67181ae6c4c93b4e284f"><div class="ttname"><a href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a82c70d4dd69f67181ae6c4c93b4e284f">oomph::LagrangeEnforcedFlowPreconditioner::Inv_w_diag_values</a></div><div class="ttdeci">Vector&lt; Vector&lt; double &gt; &gt; Inv_w_diag_values</div><div class="ttdoc">Inverse W values.</div><div class="ttdef"><b>Definition:</b> lagrange_enforced_flow_preconditioner.h:316</div></div>
<div class="ttc" id="aclassoomph_1_1Preconditioner_html_ace1199369e4465cd2b9a34884bb64ec8"><div class="ttname"><a href="../../db/d9e/classoomph_1_1Preconditioner.html#ace1199369e4465cd2b9a34884bb64ec8">oomph::Preconditioner::preconditioner_solve</a></div><div class="ttdeci">virtual void preconditioner_solve(const DoubleVector &amp;r, DoubleVector &amp;z)=0</div></div>
<div class="ttc" id="anamespaceUniformPSDSelfTest_html_a9ef26be0d5673c9bb0c2bb8bce5229d8"><div class="ttname"><a href="../../de/d6c/namespaceUniformPSDSelfTest.html#a9ef26be0d5673c9bb0c2bb8bce5229d8">UniformPSDSelfTest.r</a></div><div class="ttdeci">r</div><div class="ttdef"><b>Definition:</b> UniformPSDSelfTest.py:20</div></div>
<div class="ttc" id="aoomph__definitions_8h_html_a25c6813cc7341d125e2502f8923fb6c4"><div class="ttname"><a href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a></div><div class="ttdeci">#define OOMPH_EXCEPTION_LOCATION</div><div class="ttdef"><b>Definition:</b> oomph_definitions.h:61</div></div>
<div class="ttc" id="aoomph__definitions_8h_html_aa260cc4af589e30cea7fde997ae16667"><div class="ttname"><a href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a></div><div class="ttdeci">#define OOMPH_CURRENT_FUNCTION</div><div class="ttdef"><b>Definition:</b> oomph_definitions.h:86</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#a7bcc94c157d6853a0f0502e8a76ed380">oomph::DoubleVector::build()</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#aae402d422ec4344a4a45cdb7659b7161">oomph::DoubleVector::built()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a92bfff97fd228b9c528922c39ab563b2">oomph::LinearAlgebraDistribution::built()</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#af1677445056759263b1b076966e7bfae">oomph::DoubleVector::clear()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">oomph::DistributableLinearAlgebraObject::distribution_pt()</a>, <a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a7efc9f2f0209764902e4e45fcb2556d1">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::get_block_vector()</a>, <a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#af9321cdab3f506ab95fe51cd9b93deab">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::get_concatenated_block_vector()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a82c70d4dd69f67181ae6c4c93b4e284f">Inv_w_diag_values</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a1c3f53129425f029bf918f33430c0635">N_fluid_doftypes</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a0d62cc72563ff5a2feae895d91ebca1e">N_lagrange_doftypes</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a03e1316c85ca538a3b6912154e57fd42">Navier_stokes_preconditioner_pt</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a7569556f14fd68b28508920e89bd5eee">oomph::DistributableLinearAlgebraObject::nrow()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">oomph::DistributableLinearAlgebraObject::nrow_local()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a4a886ec6c0ec223b5f24e27efcc9584b">Preconditioner_has_been_setup</a>, <a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#ace1199369e4465cd2b9a34884bb64ec8">oomph::Preconditioner::preconditioner_solve()</a>, <a class="el" href="../../de/d6c/namespaceUniformPSDSelfTest.html#a9ef26be0d5673c9bb0c2bb8bce5229d8">UniformPSDSelfTest::r</a>, <a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a1dd4d3cd6b64fa64e1ff6730b0deecc7">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::return_block_vector()</a>, <a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a6d5106c0b9dca23aa1cc7f7fd8e696cb">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::return_concatenated_block_vector()</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#ab447b9d1830e1b470e090efa13201844">Using_superlu_ns_preconditioner</a>, and <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#a8c3dcdf8a602a1f266bbe72d98fde2e7">oomph::DoubleVector::values_pt()</a>.</p>

</div>
</div>
<a id="a63ef6de02fbf4486ca99d2a560ff47a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63ef6de02fbf4486ca99d2a560ff47a4">&#9670;&nbsp;</a></span>scaling_sigma()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> oomph::LagrangeEnforcedFlowPreconditioner::scaling_sigma </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Read (const) function to get the scaling sigma. </p>
<div class="fragment"><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#aa555c464abd2ac23045a52336123c0a2">Scaling_sigma</a>;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#aa555c464abd2ac23045a52336123c0a2">Scaling_sigma</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a14023f7ee6150f3b2ebdb0eab534242d">set_scaling_sigma()</a>.</p>

</div>
</div>
<a id="a84cbce901e94c3ea53a92638ea928bf3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84cbce901e94c3ea53a92638ea928bf3">&#9670;&nbsp;</a></span>set_meshes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::LagrangeEnforcedFlowPreconditioner::set_meshes </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>mesh_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the meshes, the first mesh in the vector must be the bulk mesh. </p>
<div class="fragment"><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  {</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="comment">// There should be at least two meshes passed to this preconditioner.</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a193776a271f7c23d20d2102de0ff1cb9">nmesh</a> = <a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a3c0e92cb77c3e3179007fe9fd99b6428">mesh_pt</a>.size();</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160; </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a193776a271f7c23d20d2102de0ff1cb9">nmesh</a> &lt; 2)</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    {</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      std::ostringstream err_msg;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      err_msg &lt;&lt; <span class="stringliteral">&quot;There should be at least two meshes.\n&quot;</span>;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        err_msg.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    }</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160; </div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="comment">// Check that all pointers are not null</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> mesh_i = 0; mesh_i &lt; <a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a193776a271f7c23d20d2102de0ff1cb9">nmesh</a>; mesh_i++)</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    {</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a3c0e92cb77c3e3179007fe9fd99b6428">mesh_pt</a>[mesh_i] == 0)</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      {</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        std::ostringstream err_msg;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        err_msg &lt;&lt; <span class="stringliteral">&quot;The pointer mesh_pt[&quot;</span> &lt;&lt; mesh_i &lt;&lt; <span class="stringliteral">&quot;] is null.\n&quot;</span>;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;          err_msg.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;      }</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    }</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="comment">// We assume that the first mesh is the Navier-Stokes &quot;bulk&quot; mesh.</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="comment">// To check this, the elemental dimension must be the same as the</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="comment">// nodal (spatial) dimension.</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="comment">// We store the elemental dimension i.e. the number of local coordinates</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="comment">// required to parametrise its geometry.</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> elemental_dim = <a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a3c0e92cb77c3e3179007fe9fd99b6428">mesh_pt</a>[0]-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a700a3c461df1c52534d7f6e303a0ebb6">elemental_dimension</a>();</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160; </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="comment">// The dimension of the nodes in the first element in the (supposedly)</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="comment">// bulk mesh.</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> nodal_dim = <a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a3c0e92cb77c3e3179007fe9fd99b6428">mesh_pt</a>[0]-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a32c8d3d454d3ba912b04985cb63e6a3c">nodal_dimension</a>();</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160; </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="comment">// Check if the first mesh is the &quot;bulk&quot; mesh.</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="comment">// Here we assume only one mesh contains &quot;bulk&quot; elements.</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="comment">// All subsequent meshes contain block preconditionable elements which</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="comment">// re-classify the bulk velocity DOFs to constrained velocity DOFs.</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="keywordflow">if</span> (elemental_dim != nodal_dim)</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    {</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;      std::ostringstream err_msg;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      err_msg &lt;&lt; <span class="stringliteral">&quot;In the first mesh, the elements have elemental dimension &quot;</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;of &quot;</span> &lt;&lt; elemental_dim &lt;&lt; <span class="stringliteral">&quot;,\n&quot;</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;with a nodal dimension of &quot;</span> &lt;&lt; nodal_dim &lt;&lt; <span class="stringliteral">&quot;.\n&quot;</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;The first mesh does not contain &#39;bulk&#39; elements.\n&quot;</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;Please re-order your mesh_pt vector.\n&quot;</span>;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160; </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        err_msg.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    }</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160; </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="comment">// Set the number of meshes</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ae055f998f6145656352aacac22e545ad">set_nmesh</a>(nmesh);</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160; </div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="comment">// Set the meshes</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> mesh_i = 0; mesh_i &lt; <a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a193776a271f7c23d20d2102de0ff1cb9">nmesh</a>; mesh_i++)</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    {</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#af97821621b570d409e6662939e5f818d">set_mesh</a>(mesh_i, <a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a3c0e92cb77c3e3179007fe9fd99b6428">mesh_pt</a>[mesh_i]);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    }</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160; </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="comment">// We also store the meshes and number of meshes locally in this class.</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="comment">// This may seem slightly redundant, since we always have all the meshes</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="comment">// stored in the upper most master block preconditioner.</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="comment">// But at the moment there is no mapping/look up scheme between</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="comment">// master and subsidiary block preconditioners for meshes.</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="comment">// If this is a subsidiary block preconditioner, we don&#39;t know which of</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="comment">// the master&#39;s meshes belong to us. We need this information to set up</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="comment">// look up lists in the function setup(...).</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="comment">// Thus we store them local to this class.</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#ae9f26444d532bd55864f3d38bf369108">My_mesh_pt</a> = <a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a3c0e92cb77c3e3179007fe9fd99b6428">mesh_pt</a>;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a862f54ac1db0001ebcd205b1ecc8ad08">My_nmesh</a> = <a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a193776a271f7c23d20d2102de0ff1cb9">nmesh</a>;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  } <span class="comment">// function set_meshes</span></div>
<div class="ttc" id="aclassoomph_1_1BlockPreconditioner_html_a193776a271f7c23d20d2102de0ff1cb9"><div class="ttname"><a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a193776a271f7c23d20d2102de0ff1cb9">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::nmesh</a></div><div class="ttdeci">unsigned nmesh() const</div><div class="ttdef"><b>Definition:</b> block_preconditioner.h:1816</div></div>
<div class="ttc" id="aclassoomph_1_1BlockPreconditioner_html_a3c0e92cb77c3e3179007fe9fd99b6428"><div class="ttname"><a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a3c0e92cb77c3e3179007fe9fd99b6428">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::mesh_pt</a></div><div class="ttdeci">const Mesh * mesh_pt(const unsigned &amp;i) const</div><div class="ttdef"><b>Definition:</b> block_preconditioner.h:1782</div></div>
<div class="ttc" id="aclassoomph_1_1BlockPreconditioner_html_ae055f998f6145656352aacac22e545ad"><div class="ttname"><a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ae055f998f6145656352aacac22e545ad">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::set_nmesh</a></div><div class="ttdeci">void set_nmesh(const unsigned &amp;n)</div><div class="ttdef"><b>Definition:</b> block_preconditioner.h:2851</div></div>
<div class="ttc" id="aclassoomph_1_1BlockPreconditioner_html_af97821621b570d409e6662939e5f818d"><div class="ttname"><a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#af97821621b570d409e6662939e5f818d">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::set_mesh</a></div><div class="ttdeci">void set_mesh(const unsigned &amp;i, const Mesh *const mesh_pt, const bool &amp;allow_multiple_element_type_in_mesh=false)</div><div class="ttdef"><b>Definition:</b> block_preconditioner.h:2866</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_a32c8d3d454d3ba912b04985cb63e6a3c"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#a32c8d3d454d3ba912b04985cb63e6a3c">oomph::Mesh::nodal_dimension</a></div><div class="ttdeci">unsigned nodal_dimension() const</div><div class="ttdoc">Return number of nodal dimension in mesh.</div><div class="ttdef"><b>Definition:</b> mesh.cc:9055</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_a700a3c461df1c52534d7f6e303a0ebb6"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#a700a3c461df1c52534d7f6e303a0ebb6">oomph::Mesh::elemental_dimension</a></div><div class="ttdeci">unsigned elemental_dimension() const</div><div class="ttdoc">Return number of elemental dimension in mesh.</div><div class="ttdef"><b>Definition:</b> mesh.cc:8917</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a700a3c461df1c52534d7f6e303a0ebb6">oomph::Mesh::elemental_dimension()</a>, <a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a3c0e92cb77c3e3179007fe9fd99b6428">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::mesh_pt()</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#ae9f26444d532bd55864f3d38bf369108">My_mesh_pt</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a862f54ac1db0001ebcd205b1ecc8ad08">My_nmesh</a>, <a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a193776a271f7c23d20d2102de0ff1cb9">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::nmesh()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a32c8d3d454d3ba912b04985cb63e6a3c">oomph::Mesh::nodal_dimension()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#af97821621b570d409e6662939e5f818d">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::set_mesh()</a>, and <a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ae055f998f6145656352aacac22e545ad">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::set_nmesh()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/d16/classTiltedCavityProblem.html#a77b22e4024cfaed06ebf6ec69d56e669">TiltedCavityProblem&lt; ELEMENT &gt;::TiltedCavityProblem()</a>.</p>

</div>
</div>
<a id="a3512f2a0c6b03977590591a81846c50d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3512f2a0c6b03977590591a81846c50d">&#9670;&nbsp;</a></span>set_navier_stokes_preconditioner()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::LagrangeEnforcedFlowPreconditioner::set_navier_stokes_preconditioner </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html">Preconditioner</a> *&#160;</td>
          <td class="paramname"><em>new_ns_preconditioner_pt</em> = <code>0</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set a new Navier-Stokes matrix preconditioner (inexact solver)</p>
<p>Function to set a new momentum matrix preconditioner (inexact solver) </p>
<div class="fragment"><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;  {</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    <span class="comment">// Check if pointer is non-zero.</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    <span class="keywordflow">if</span> (new_ns_preconditioner_pt == 0)</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    {</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;      std::ostringstream warning_stream;</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;      warning_stream &lt;&lt; <span class="stringliteral">&quot;WARNING: \n&quot;</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;The LSC preconditioner point is null.\n&quot;</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;Using default (SuperLU) preconditioner.\n&quot;</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;                     &lt;&lt; std::endl;</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;      OomphLibWarning(</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;        warning_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160; </div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;      <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a03e1316c85ca538a3b6912154e57fd42">Navier_stokes_preconditioner_pt</a> = 0;</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;      <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#ab447b9d1830e1b470e090efa13201844">Using_superlu_ns_preconditioner</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    }</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    {</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;      <span class="comment">// If the default SuperLU preconditioner has been used</span></div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;      <span class="comment">// clean it up now...</span></div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#ab447b9d1830e1b470e090efa13201844">Using_superlu_ns_preconditioner</a> &amp;&amp;</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;          <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a03e1316c85ca538a3b6912154e57fd42">Navier_stokes_preconditioner_pt</a> != 0)</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;      {</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;        <span class="keyword">delete</span> <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a03e1316c85ca538a3b6912154e57fd42">Navier_stokes_preconditioner_pt</a>;</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;        <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a03e1316c85ca538a3b6912154e57fd42">Navier_stokes_preconditioner_pt</a> = 0;</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;      }</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160; </div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;      <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a03e1316c85ca538a3b6912154e57fd42">Navier_stokes_preconditioner_pt</a> = new_ns_preconditioner_pt;</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;      <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#ab447b9d1830e1b470e090efa13201844">Using_superlu_ns_preconditioner</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    }</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;  } <span class="comment">// func set_navier_stokes_preconditioner</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a03e1316c85ca538a3b6912154e57fd42">Navier_stokes_preconditioner_pt</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, and <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#ab447b9d1830e1b470e090efa13201844">Using_superlu_ns_preconditioner</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/d16/classTiltedCavityProblem.html#a77b22e4024cfaed06ebf6ec69d56e669">TiltedCavityProblem&lt; ELEMENT &gt;::TiltedCavityProblem()</a>.</p>

</div>
</div>
<a id="a14023f7ee6150f3b2ebdb0eab534242d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14023f7ee6150f3b2ebdb0eab534242d">&#9670;&nbsp;</a></span>set_scaling_sigma()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::LagrangeEnforcedFlowPreconditioner::set_scaling_sigma </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>scaling_sigma</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Access function to set the scaling sigma. Note: this also sets the flag to use the infinite norm of the Navier-Stokes F matrix as the scaling sigma to false. Warning is given if trying to set scaling sigma to be equal to or greater than zero. </p>
<div class="fragment"><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    {</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      <span class="comment">// Check if scaling sigma is zero or positive.</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a63ef6de02fbf4486ca99d2a560ff47a4">scaling_sigma</a> == 0.0)</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      {</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        std::ostringstream warning_stream;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        warning_stream &lt;&lt; <span class="stringliteral">&quot;WARNING: \n&quot;</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot;Setting scaling_sigma = 0.0 may cause values.\n&quot;</span>;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        OomphLibWarning(warning_stream.str(),</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                        <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                        <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      }</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a63ef6de02fbf4486ca99d2a560ff47a4">scaling_sigma</a> &gt; 0.0)</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      {</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        std::ostringstream warning_stream;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        warning_stream &lt;&lt; <span class="stringliteral">&quot;WARNING: &quot;</span> &lt;&lt; std::endl</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot;The scaling (scaling_sigma) is positive: &quot;</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                       &lt;&lt; <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#aa555c464abd2ac23045a52336123c0a2">Scaling_sigma</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot;Performance may be degraded.\n&quot;</span>;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        OomphLibWarning(warning_stream.str(),</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                        <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                        <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      }</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#aa555c464abd2ac23045a52336123c0a2">Scaling_sigma</a> = <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a63ef6de02fbf4486ca99d2a560ff47a4">scaling_sigma</a>;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a4da1aa7fd0b1a4f9d8eef074f4d1ed81">Use_norm_f_for_scaling_sigma</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1LagrangeEnforcedFlowPreconditioner_html_a63ef6de02fbf4486ca99d2a560ff47a4"><div class="ttname"><a href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a63ef6de02fbf4486ca99d2a560ff47a4">oomph::LagrangeEnforcedFlowPreconditioner::scaling_sigma</a></div><div class="ttdeci">double scaling_sigma() const</div><div class="ttdoc">Read (const) function to get the scaling sigma.</div><div class="ttdef"><b>Definition:</b> lagrange_enforced_flow_preconditioner.h:277</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a63ef6de02fbf4486ca99d2a560ff47a4">scaling_sigma()</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#aa555c464abd2ac23045a52336123c0a2">Scaling_sigma</a>, and <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a4da1aa7fd0b1a4f9d8eef074f4d1ed81">Use_norm_f_for_scaling_sigma</a>.</p>

</div>
</div>
<a id="ad523330041a714da26bc4931995023b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad523330041a714da26bc4931995023b8">&#9670;&nbsp;</a></span>set_superlu_for_navier_stokes_preconditioner()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::LagrangeEnforcedFlowPreconditioner::set_superlu_for_navier_stokes_preconditioner </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Set Navier-Stokes matrix preconditioner (inexact solver) to SuperLU </p>
<div class="fragment"><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    {</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#ab447b9d1830e1b470e090efa13201844">Using_superlu_ns_preconditioner</a>)</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      {</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <span class="keyword">delete</span> <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a03e1316c85ca538a3b6912154e57fd42">Navier_stokes_preconditioner_pt</a>;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a03e1316c85ca538a3b6912154e57fd42">Navier_stokes_preconditioner_pt</a> = <span class="keyword">new</span> SuperLUPreconditioner;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#ab447b9d1830e1b470e090efa13201844">Using_superlu_ns_preconditioner</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      }</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a03e1316c85ca538a3b6912154e57fd42">Navier_stokes_preconditioner_pt</a>, and <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#ab447b9d1830e1b470e090efa13201844">Using_superlu_ns_preconditioner</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/d16/classTiltedCavityProblem.html#a77b22e4024cfaed06ebf6ec69d56e669">TiltedCavityProblem&lt; ELEMENT &gt;::TiltedCavityProblem()</a>.</p>

</div>
</div>
<a id="aadcbdb5af92d7889c956098cb86dee87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aadcbdb5af92d7889c956098cb86dee87">&#9670;&nbsp;</a></span>setup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::LagrangeEnforcedFlowPreconditioner::setup </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Setup method for the LagrangeEnforcedFlowPreconditioner. </p>
<p>Setup the Lagrange enforced flow preconditioner. This extracts blocks corresponding to the velocity and Lagrange multiplier unknowns, creates the matrices actually needed in the application of the preconditioner and deletes what can be deleted... Note that this preconditioner needs a CRDoubleMatrix. </p>

<p>Implements <a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#af4886f4efe510e5c9b0eb19422943588">oomph::Preconditioner</a>.</p>
<div class="fragment"><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  {</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="comment">// clean</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    this-&gt;<a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#ace8141de668eb2a172ef9a25c932134a">clean_up_memory</a>();</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160; </div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="comment">// Paranoid check that meshes have been set. In this preconditioner, we</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="comment">// always have to set meshes.</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a862f54ac1db0001ebcd205b1ecc8ad08">My_nmesh</a> == 0)</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    {</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;      std::ostringstream err_msg;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;      err_msg &lt;&lt; <span class="stringliteral">&quot;There are no meshes set. Please call set_meshes(...)\n&quot;</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;with at least two mesh.&quot;</span>;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        err_msg.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    }</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160; </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="comment">// -----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="comment">// Step 1 - Construct the dof_to_block_map vector.</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="comment">// -----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="comment">// Assumption: The first mesh is always the &quot;bulk&quot; mesh</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="comment">// (Navier-Stokes mesh), which contains block preconditionable</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="comment">// Navier-Stokes elements. Thus the bulk elements classify the velocity</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="comment">// and pressure degrees of freedom (ndof_types = 3(4) in 2(3)D).</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="comment">// All subsequent meshes contain the constrained velocity DOF types,</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <span class="comment">// then the Lagrange multiplier DOF types.</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="comment">// Thus, a general ordering of DOF types (in 3D) follows the ordering:</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="comment">//  0 1 2 3   4 5 6 7  8  ..x   x+0 x+1 x+2 x+3 x+4</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="comment">// [u v w p] [u v w l1 l2 ...] [u   v   w   l1  l2 ...] ...</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="comment">// where the square brackets [] represent the DOF types in each mesh.</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="comment">// Example:</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="comment">// Consider the case of imposing parallel outflow (3 constrained velocity</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="comment">// DOF types and 2 Lagrange multiplier DOF types) and tangential flow (3</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="comment">// constrained velocity DOF types and 1 Lagrange multiplier DOF type)</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="comment">// along two different boundaries in 3D. The resulting natural ordering of</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="comment">// the DOF types is:</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <span class="comment">// [0 1 2 3] [4  5  6   7   8 ] [9  10 11 12 ]</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <span class="comment">// [u v w p] [up vp wp Lp1 Lp2] [ut vt wt Lt1]</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="comment">// In our implementation, the desired block structure is:</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="comment">// | u v w | up vp wp | ut vt wt | p | Lp1 Lp2 Lt1 |</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="comment">// The dof_to_block_map should have the following construction:</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="comment">//    dof_to_block_map[$dof_number] = $block_number</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="comment">// Thus, the dof_to_block_map for the example above should be:</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <span class="comment">// To achieve this, we use the dof_to_block_map:</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="comment">// dof_to_block_map = [0 1 2 9 3  4  5  10  11  6  7  8  12]</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="comment">// To generalise the construction of the dof_to_block_map vector</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="comment">// (to work for any number of meshes), we first require some auxiliary</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <span class="comment">// variables to aid us in this endeavour.</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="comment">// -----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160; </div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="comment">// Set up the My_ndof_types_in_mesh vector.</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="comment">// If this is already constructed, we reuse it instead.</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a6bbfdf74c3cdc461831f03858f9cb1b7">My_ndof_types_in_mesh</a>.size() == 0)</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    {</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> mesh_i = 0; mesh_i &lt; <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a862f54ac1db0001ebcd205b1ecc8ad08">My_nmesh</a>; mesh_i++)</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;      {</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a6bbfdf74c3cdc461831f03858f9cb1b7">My_ndof_types_in_mesh</a>.push_back(<a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#ae9f26444d532bd55864f3d38bf369108">My_mesh_pt</a>[mesh_i]-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ab6cca480686ea8e44244ac60a0db23ba">ndof_types</a>());</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      }</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    }</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160; </div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="comment">// Get the spatial dimension of the problem.</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="keywordtype">unsigned</span> spatial_dim = <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#ae9f26444d532bd55864f3d38bf369108">My_mesh_pt</a>[0]-&gt;nodal_dimension();</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160; </div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="comment">// Get the number of DOF types.</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <span class="keywordtype">unsigned</span> n_dof_types = <a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ab6cca480686ea8e44244ac60a0db23ba">ndof_types</a>();</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160; </div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="comment">// We cannot check which DOF types are &quot;correct&quot; in the sense that there</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="comment">// is a distinction between bulk and constrained velocity DOF tyoes.</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="comment">// But we can at least check if the ndof_types matches the total number</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <span class="comment">// of DOF types from the meshes.</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <span class="comment">// This check is not necessary for the upper most master block</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <span class="comment">// preconditioner since the ndof_types() is calculated by looping</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="comment">// through the meshes!</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="comment">// This check is useful if this is a subsidiary block preconditioner and</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="comment">// incorrect DOF type merging has taken place.</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a9ac4335ec07fc13f7bf1093fd0489c52">is_subsidiary_block_preconditioner</a>())</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    {</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;      <span class="keywordtype">unsigned</span> tmp_ndof_types = 0;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> mesh_i = 0; mesh_i &lt; <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a862f54ac1db0001ebcd205b1ecc8ad08">My_nmesh</a>; mesh_i++)</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;      {</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        tmp_ndof_types += <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a6bbfdf74c3cdc461831f03858f9cb1b7">My_ndof_types_in_mesh</a>[mesh_i];</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;      }</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160; </div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;      <span class="keywordflow">if</span> (tmp_ndof_types != n_dof_types)</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;      {</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        std::ostringstream err_msg;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        err_msg &lt;&lt; <span class="stringliteral">&quot;The number of DOF types are incorrect.\n&quot;</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;The total DOF types from the meshes is: &quot;</span> &lt;&lt; tmp_ndof_types</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;.\n&quot;</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;The number of DOF types from &quot;</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;BlockPreconditioner::ndof_types() is &quot;</span> &lt;&lt; n_dof_types</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;.\n&quot;</span>;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;          err_msg.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;      }</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    }</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160; </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="comment">// The number of velocity DOF types: We assume that all meshes classify</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="comment">// at least some of the velocity DOF types (bulk/constrained), thus the</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <span class="comment">// total number of velocity DOF types is the spatial dimension multiplied</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <span class="comment">// by the number of meshes.</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#afdf4577b51473f146c55cb6016b11797">N_velocity_doftypes</a> = <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a862f54ac1db0001ebcd205b1ecc8ad08">My_nmesh</a> * spatial_dim;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160; </div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="comment">// Fluid has +1 for the pressure.</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a1c3f53129425f029bf918f33430c0635">N_fluid_doftypes</a> = <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#afdf4577b51473f146c55cb6016b11797">N_velocity_doftypes</a> + 1;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160; </div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <span class="comment">// The rest are Lagrange multiplier DOF types.</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a0d62cc72563ff5a2feae895d91ebca1e">N_lagrange_doftypes</a> = n_dof_types - <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a1c3f53129425f029bf918f33430c0635">N_fluid_doftypes</a>;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160; </div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="comment">//   Now construct the DOF to block map for block_setup()   //</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <span class="comment">// Now that we have</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <span class="comment">// (1) spatial dimension of the problem and</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <span class="comment">// (2) the number of DOF types in each of the meshes.</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <span class="comment">// We observe that the problem dimension is 3 and</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <span class="comment">// My_ndof_type_in_mesh = [4, 5, 4].</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <span class="comment">// With these information we can construct the desired block structure:</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <span class="comment">// | u v w | up vp wp | ut vt wt | p | Lp1 Lp2 Lt1 |</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <span class="comment">// The block structure is determined by the vector dof_to_block_map we</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <span class="comment">// give to the function block_setup(...).</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160; </div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <span class="comment">// This preconditioner permutes the DOF numbers to get the block numbers.</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <span class="comment">// I.e. nblock_types = ndof_types, but they are re-ordered</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <span class="comment">// so that we have (in order):</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="comment">// 1) bulk velocity DOF types</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <span class="comment">// 2) constrained velocity DOF types</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="comment">// 3) pressure DOF type</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <span class="comment">// 4) Lagrange multiplier DOF types</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    <span class="comment">// Recall that the natural ordering of the DOF types are ordered first by</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <span class="comment">// their meshes, then the elemental DOF type as described by the</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <span class="comment">// function get_dof_numbers_for_unknowns().</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <span class="comment">// Also recall that (for this problem), we assume/require that every mesh</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <span class="comment">// (re-)classify at least some of the velocity DOF types, furthermore,</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <span class="comment">// the velocity DOF type classification comes before the</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <span class="comment">// pressure / Lagrange multiplier DOF types.</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <span class="comment">// Consider the same example as shown previously, repeated here for your</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <span class="comment">// convenience:</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <span class="comment">// Natural DOF type ordering:</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <span class="comment">//  0 1 2 3   4  5  6   7   8    9  10 11 12   &lt;- DOF number.</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <span class="comment">// [u v w p] [up vp wp Lp1 Lp2] [ut vt wt Lt1] &lt;- DOF type.</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <span class="comment">// Desired block structure:</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <span class="comment">//  0 1 2   3  4  5    6  7  8     9   10  11  12   &lt;- block number</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="comment">// [u v w | up vp wp | ut vt wt ] [p | Lp1 Lp2 Lt1] &lt;- DOF type</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    <span class="comment">// dof_to_block_map[$dof_number] = $block_number</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <span class="comment">// Required dof_to_block_map:</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <span class="comment">//  0 1 2 9 3  4  5  10  11  6  7  8  12   &lt;- block number</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    <span class="comment">// [u v w p up vp wp Lp1 Lp2 ut vt wt Lt1] &lt;- DOF type</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <span class="comment">// Consider the 4th entry of the dof_to_block_map, this represents the</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="comment">// pressure DOF type, from the desired block structure we see this takes</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="comment">// the block number 9.</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <span class="comment">// One way to generalise the construction of the dof_to_block_map  is to</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    <span class="comment">// lump the first $spatial_dimension number of DOF types</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <span class="comment">// from each mesh together, then lump the remaining DOF types together.</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <span class="comment">// Notice that the values in the velocity DOF types of the</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <span class="comment">// dof_to_block_map vector increases sequentially, from 0 to 8. The values</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="comment">// of the Lagrange multiplier DOF types follow the same pattern, from 9 to</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="comment">// 12. We follow this construction.</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160; </div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <span class="comment">// Storage for the dof_to_block_map vector.</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    Vector&lt;unsigned&gt; dof_to_block_map(n_dof_types, 0);</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160; </div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <span class="comment">// Index for the dof_to_block_map vector.</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="keywordtype">unsigned</span> temp_index = 0;</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160; </div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="comment">// Value for the velocity DOF type.</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <span class="keywordtype">unsigned</span> velocity_number = 0;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160; </div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <span class="comment">// Value for the pressure/Lagrange multiplier DOF type.</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <span class="keywordtype">unsigned</span> pres_lgr_number = <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#afdf4577b51473f146c55cb6016b11797">N_velocity_doftypes</a>;</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160; </div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <span class="comment">// Loop through the number of meshes.</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> mesh_i = 0; mesh_i &lt; <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a862f54ac1db0001ebcd205b1ecc8ad08">My_nmesh</a>; mesh_i++)</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    {</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;      <span class="comment">// Fill in the velocity DOF types.</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> dim_i = 0; dim_i &lt; spatial_dim; dim_i++)</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      {</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        dof_to_block_map[temp_index++] = velocity_number++;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;      } <span class="comment">// for</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160; </div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;      <span class="comment">// Loop through the pressure/Lagrange multiplier DOF types.</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;      <span class="keywordtype">unsigned</span> ndof_type_in_mesh_i = <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a6bbfdf74c3cdc461831f03858f9cb1b7">My_ndof_types_in_mesh</a>[mesh_i];</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> doftype_i = spatial_dim; doftype_i &lt; ndof_type_in_mesh_i;</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;           doftype_i++)</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;      {</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        dof_to_block_map[temp_index++] = pres_lgr_number++;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;      } <span class="comment">// for</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    } <span class="comment">// for</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160; </div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <span class="comment">// Call the block setup</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#af704c4816469cef4fed9d35a9ad651ec">block_setup</a>(dof_to_block_map);</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160; </div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160; </div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    <span class="comment">// -----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <span class="comment">// Step 2 - Get the infinite norm of Navier-Stokes F block.</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <span class="comment">// -----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160; </div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    <span class="comment">// Extract the velocity blocks.</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    <a class="code" href="../../dc/d34/classEigen_1_1Matrix.html">DenseMatrix&lt;CRDoubleMatrix*&gt;</a> v_aug_pt(</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;      <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#afdf4577b51473f146c55cb6016b11797">N_velocity_doftypes</a>, <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#afdf4577b51473f146c55cb6016b11797">N_velocity_doftypes</a>, 0);</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160; </div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> row_i = 0; row_i &lt; <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#afdf4577b51473f146c55cb6016b11797">N_velocity_doftypes</a>; row_i++)</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    {</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> col_i = 0; col_i &lt; <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#afdf4577b51473f146c55cb6016b11797">N_velocity_doftypes</a>; col_i++)</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;      {</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;        v_aug_pt(row_i, col_i) = <span class="keyword">new</span> CRDoubleMatrix;</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a72b4dbe167da59d9ba12c7eff97d77e6">get_block</a>(row_i, col_i, *v_aug_pt(row_i, col_i));</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;      } <span class="comment">// for</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    } <span class="comment">// for</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160; </div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    <span class="comment">// Now get the infinite norm.</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a4da1aa7fd0b1a4f9d8eef074f4d1ed81">Use_norm_f_for_scaling_sigma</a>)</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    {</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;      <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#aa555c464abd2ac23045a52336123c0a2">Scaling_sigma</a> = -<a class="code" href="../../dd/d95/namespaceoomph_1_1CRDoubleMatrixHelpers.html#ab17222c9461096e3d5b8cf6250524644">CRDoubleMatrixHelpers::inf_norm</a>(v_aug_pt);</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    } <span class="comment">// if</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160; </div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    <span class="comment">// Warning for division by zero.</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#aa555c464abd2ac23045a52336123c0a2">Scaling_sigma</a> == 0.0)</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    {</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;      std::ostringstream warning_stream;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;      warning_stream &lt;&lt; <span class="stringliteral">&quot;WARNING: &quot;</span> &lt;&lt; std::endl</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;The scaling (Scaling_sigma) is &quot;</span> &lt;&lt; <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#aa555c464abd2ac23045a52336123c0a2">Scaling_sigma</a></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;.\n&quot;</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;Division by 0 will occur.&quot;</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;      OomphLibWarning(</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        warning_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    }</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#aa555c464abd2ac23045a52336123c0a2">Scaling_sigma</a> &gt; 0.0)</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    {</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;      std::ostringstream warning_stream;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;      warning_stream &lt;&lt; <span class="stringliteral">&quot;WARNING: &quot;</span> &lt;&lt; std::endl</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;The scaling (Scaling_sigma) is positive: &quot;</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                     &lt;&lt; <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#aa555c464abd2ac23045a52336123c0a2">Scaling_sigma</a> &lt;&lt; std::endl</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;Performance may be degraded.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;      OomphLibWarning(</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;        warning_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    }</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160; </div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    <span class="comment">// -----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <span class="comment">// Step 3 - Augment the constrained fluid blocks.</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    <span class="comment">// -----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    <span class="comment">// Loop through the Lagrange multipliers and do three things:</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    <span class="comment">// For each Lagrange block:</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <span class="comment">//   3.1) Extract the mass matrices and store the location of non-zero mass</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    <span class="comment">//        matrices.</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    <span class="comment">//   3.2) a) Create inv_w (for the augmentation)</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <span class="comment">//        b) Store the diagonal values of inv_w (for preconditioner solve)</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <span class="comment">//   3.3) Perform the augmentation: v_aug + m_i * inv(w_i) * m_j</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    <span class="comment">//   3.4) Clean up memory.</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160; </div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    <span class="comment">// Storage for the inv w diag values.</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a82c70d4dd69f67181ae6c4c93b4e284f">Inv_w_diag_values</a>.clear();</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> l_i = 0; l_i &lt; <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a0d62cc72563ff5a2feae895d91ebca1e">N_lagrange_doftypes</a>; l_i++)</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    {</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;      <span class="comment">// Step 3.1: Location and extraction of non-zero mass matrices.</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160; </div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;      <span class="comment">// Storage for the current Lagrange block mass matrices.</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;      Vector&lt;CRDoubleMatrix*&gt; mm_pt;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;      Vector&lt;CRDoubleMatrix*&gt; mmt_pt;</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160; </div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;      <span class="comment">// Block type for the Lagrange multiplier.</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> lgr_block_num = <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a1c3f53129425f029bf918f33430c0635">N_fluid_doftypes</a> + l_i;</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160; </div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;      <span class="comment">// Store the mass matrix locations for the current Lagrange block.</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;      Vector&lt;unsigned&gt; mm_locations;</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160; </div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;      <span class="comment">// Store the number of mass matrices.</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;      <span class="keywordtype">unsigned</span> n_mm = 0;</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160; </div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;      <span class="comment">// Go along the block columns for the current Lagrange block ROW.</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> col_i = 0; col_i &lt; <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#afdf4577b51473f146c55cb6016b11797">N_velocity_doftypes</a>; col_i++)</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;      {</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        <span class="comment">// Get the block matrix for this block column.</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;        CRDoubleMatrix* mm_temp_pt = <span class="keyword">new</span> CRDoubleMatrix;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a72b4dbe167da59d9ba12c7eff97d77e6">get_block</a>(lgr_block_num, col_i, *mm_temp_pt);</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160; </div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        <span class="comment">// Check if this is non-zero</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        <span class="keywordflow">if</span> (mm_temp_pt-&gt;nnz() &gt; 0)</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        {</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;          mm_locations.push_back(col_i);</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;          mm_pt.push_back(mm_temp_pt);</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;          n_mm++;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;        }</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;        {</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;          <span class="comment">// This is just an empty matrix. No need to keep this.</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;          <span class="keyword">delete</span> mm_temp_pt;</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        }</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;      } <span class="comment">// loop through the columns of the Lagrange row.</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160; </div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;      <span class="keywordflow">if</span> (n_mm == 0)</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;      {</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        std::ostringstream warning_stream;</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        warning_stream &lt;&lt; <span class="stringliteral">&quot;WARNING:\n&quot;</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot;There are no mass matrices on Lagrange block row &quot;</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                       &lt;&lt; l_i &lt;&lt; <span class="stringliteral">&quot;.\n&quot;</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot;Perhaps the problem setup is incorrect.&quot;</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                       &lt;&lt; std::endl;</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        OomphLibWarning(warning_stream.str(),</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                        <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                        <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;      }</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160; </div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;      <span class="comment">// Get the transpose of the mass matrices.</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> mm_i = 0; mm_i &lt; n_mm; mm_i++)</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;      {</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;        <span class="comment">// Get the block matrix for this block column.</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;        CRDoubleMatrix* mm_temp_pt = <span class="keyword">new</span> CRDoubleMatrix;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;        this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a72b4dbe167da59d9ba12c7eff97d77e6">get_block</a>(mm_locations[mm_i], lgr_block_num, *mm_temp_pt);</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160; </div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        <span class="keywordflow">if</span> (mm_temp_pt-&gt;nnz() &gt; 0)</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        {</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;          mmt_pt.push_back(mm_temp_pt);</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;        }</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;        {</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;          <span class="comment">// There should be a non-zero mass matrix here, since L=(L^T)^T</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;          {</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;            std::ostringstream warning_stream;</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;            warning_stream &lt;&lt; <span class="stringliteral">&quot;WARNING:\n&quot;</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                           &lt;&lt; <span class="stringliteral">&quot;The mass matrix block &quot;</span> &lt;&lt; mm_locations[mm_i]</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                           &lt;&lt; <span class="stringliteral">&quot; in L^T block &quot;</span> &lt;&lt; l_i &lt;&lt; <span class="stringliteral">&quot; is zero.\n&quot;</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                           &lt;&lt; <span class="stringliteral">&quot;Perhaps the problem setup is incorrect.&quot;</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                           &lt;&lt; std::endl;</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;            OomphLibWarning(warning_stream.str(),</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;          }</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;        }</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;      } <span class="comment">// loop through the ROW of the Lagrange COLUMN.</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160; </div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;      <span class="comment">//  Step 3.2: Create inv_w and store its diagonal entries.</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160; </div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;      <span class="comment">// Storage for inv_w</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;      CRDoubleMatrix* inv_w_pt =</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;        <span class="keyword">new</span> CRDoubleMatrix(this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a59e83eca59e3cdc41a93668539e138f1">Block_distribution_pt</a>[lgr_block_num]);</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160; </div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;      <span class="comment">// Get the number of local rows for this Lagrange block.</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l_i_nrow_local =</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a59e83eca59e3cdc41a93668539e138f1">Block_distribution_pt</a>[lgr_block_num]-&gt;nrow_local();</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160; </div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;      <span class="comment">// The first row, for the column offset (required in parallel).</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;      <span class="keywordtype">unsigned</span> l_i_first_row =</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;        this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a59e83eca59e3cdc41a93668539e138f1">Block_distribution_pt</a>[lgr_block_num]-&gt;first_row();</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160; </div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;      <span class="comment">// A vector to contain the results of mass matrices squared.</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;      Vector&lt;double&gt; w_i_diag_values(l_i_nrow_local, 0);</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160; </div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;      <span class="comment">// Create mm*mm^T, and component-wise add the mass matrices</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> m_i = 0; m_i &lt; n_mm; m_i++)</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;      {</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        <span class="comment">// Create mm*mm^T</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;        CRDoubleMatrix temp_mm_sqrd;</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        temp_mm_sqrd.build(mm_pt[m_i]-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>());</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;        mm_pt[m_i]-&gt;multiply(*mmt_pt[m_i], temp_mm_sqrd);</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160; </div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;        <span class="comment">// Extract diagonal entries</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;        Vector&lt;double&gt; m_diag = temp_mm_sqrd.diagonal_entries();</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160; </div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        <span class="comment">// Loop through the entries, add them.</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> row_i = 0; row_i &lt; l_i_nrow_local; row_i++)</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        {</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;          w_i_diag_values[row_i] += m_diag[row_i];</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;        }</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;      }</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160; </div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;      <span class="comment">// Storage for inv_w matrix vectors</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;      Vector&lt;double&gt; invw_i_diag_values(l_i_nrow_local, 0);</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;      Vector&lt;int&gt; w_i_column_indices(l_i_nrow_local);</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;      Vector&lt;int&gt; w_i_row_start(l_i_nrow_local + 1);</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160; </div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;      <span class="comment">// Divide by Scaling_sigma and create the inverse of w.</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> row_i = 0; row_i &lt; l_i_nrow_local; row_i++)</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;      {</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        invw_i_diag_values[row_i] = <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#aa555c464abd2ac23045a52336123c0a2">Scaling_sigma</a> / w_i_diag_values[row_i];</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160; </div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        w_i_column_indices[row_i] = row_i + l_i_first_row;</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;        w_i_row_start[row_i] = row_i;</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;      }</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160; </div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;      w_i_row_start[l_i_nrow_local] = l_i_nrow_local;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160; </div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;      <span class="comment">// Theses are square matrices. So we can use the l_i_nrow_global for the</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;      <span class="comment">// number of columns.</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l_i_nrow_global =</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;        this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a59e83eca59e3cdc41a93668539e138f1">Block_distribution_pt</a>[lgr_block_num]-&gt;nrow();</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;      inv_w_pt-&gt;build(</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;        l_i_nrow_global, invw_i_diag_values, w_i_column_indices, w_i_row_start);</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160; </div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;      <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a82c70d4dd69f67181ae6c4c93b4e284f">Inv_w_diag_values</a>.push_back(invw_i_diag_values);</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160; </div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160; </div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;      <span class="comment">// Step 3.3: Perform the augmentation: v_aug + m_i * inv(w_i) * m_j</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160; </div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;      <span class="comment">// Now we create the augmented matrix in v_aug_pt.</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;      <span class="comment">// v_aug_pt is already re-ordered</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;      <span class="comment">// Loop through the mm_locations</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ii = 0; ii &lt; n_mm; ii++)</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;      {</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;        <span class="comment">// Location of the mass matrix</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;        <span class="keywordtype">unsigned</span> aug_i = mm_locations[ii];</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160; </div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> jj = 0; jj &lt; n_mm; jj++)</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;        {</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;          <span class="comment">// Location of the mass matrix</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;          <span class="keywordtype">unsigned</span> aug_j = mm_locations[jj];</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160; </div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;          <span class="comment">// Storage for intermediate results.</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;          CRDoubleMatrix aug_block;</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;          CRDoubleMatrix another_aug_block;</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160; </div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;          <span class="comment">// aug_block = mmt*inv_w</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;          mmt_pt[ii]-&gt;multiply((*inv_w_pt), (aug_block));</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160; </div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;          <span class="comment">// another_aug_block = aug_block*mm = mmt*inv_w*mm</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;          aug_block.multiply(*mm_pt[jj], another_aug_block);</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160; </div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;          <span class="comment">// Add the augmentation.</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;          v_aug_pt(aug_i, aug_j)</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;            -&gt;add(another_aug_block, *v_aug_pt(aug_i, aug_j));</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        } <span class="comment">// loop jj</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;      } <span class="comment">// loop ii</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160; </div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;      <span class="comment">// Step 3.4: Clean up memory.</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;      <span class="keyword">delete</span> inv_w_pt;</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;      inv_w_pt = 0;</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> m_i = 0; m_i &lt; n_mm; m_i++)</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;      {</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;        <span class="keyword">delete</span> mm_pt[m_i];</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;        mm_pt[m_i] = 0;</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;        <span class="keyword">delete</span> mmt_pt[m_i];</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        mmt_pt[m_i] = 0;</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;      }</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    } <span class="comment">// loop through Lagrange multipliers.</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160; </div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    <span class="comment">// -----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <span class="comment">// Step 4 - Replace all the velocity blocks</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    <span class="comment">// -----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    <span class="comment">// When we replace (DOF) blocks, the indices have to respect the DOF type</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    <span class="comment">// ordering. This is because only DOF type information is passed between</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    <span class="comment">// preconditioners. So we need to create the inverse of the</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    <span class="comment">// dof_to_block_map... a block_to_dof_map!</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <span class="comment">// Note: Once the DOF blocks have been replaced, further calls to</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    <span class="comment">// get_block at this preconditioning hierarchy level and/or lower will use</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    <span class="comment">// the (nearest) replaced blocks.</span></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    Vector&lt;unsigned&gt; block_to_dof_map(n_dof_types, 0);</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> dof_i = 0; dof_i &lt; n_dof_types; dof_i++)</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    {</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;      block_to_dof_map[dof_to_block_map[dof_i]] = dof_i;</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    }</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160; </div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    <span class="comment">// Now do the replacement of all blocks in v_aug_pt</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> block_row_i = 0; block_row_i &lt; <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#afdf4577b51473f146c55cb6016b11797">N_velocity_doftypes</a>;</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;         block_row_i++)</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    {</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;      <span class="keywordtype">unsigned</span> temp_dof_row_i = block_to_dof_map[block_row_i];</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> block_col_i = 0; block_col_i &lt; <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#afdf4577b51473f146c55cb6016b11797">N_velocity_doftypes</a>;</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;           block_col_i++)</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;      {</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;        <span class="keywordtype">unsigned</span> temp_dof_col_i = block_to_dof_map[block_col_i];</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;        this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a8a0ae880f098d5b1e9df78fc74c31dbf">set_replacement_dof_block</a>(</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;          temp_dof_row_i, temp_dof_col_i, v_aug_pt(block_row_i, block_col_i));</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;      }</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    }</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160; </div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    <span class="comment">// -----------------------------------------------------------------------</span></div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    <span class="comment">// Step 5 - Set up Navier-Stokes preconditioner</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    <span class="comment">// If the subsidiary fluid preconditioner is a block preconditioner:</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    <span class="comment">//   5.1) Set up the dof_number_in_master_map</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    <span class="comment">//   5.2) Set up the doftype_coarsen_map</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    <span class="comment">// otherwise:</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    <span class="comment">//   5.3) Concatenate the fluid matrices into one big matrix and pass it</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    <span class="comment">//        to the solver.</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    <span class="comment">// -----------------------------------------------------------------------</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160; </div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    <span class="comment">// First we determine if we&#39;re using a block preconditioner or not.</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    BlockPreconditioner&lt;CRDoubleMatrix&gt;* navier_stokes_block_preconditioner_pt =</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;      <span class="keyword">dynamic_cast&lt;</span>BlockPreconditioner&lt;CRDoubleMatrix&gt;*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;        <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a03e1316c85ca538a3b6912154e57fd42">Navier_stokes_preconditioner_pt</a>);</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#abd83bbbc271df1e5d5f5a96054b0742a">Navier_stokes_preconditioner_is_block_preconditioner</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    <span class="keywordflow">if</span> (navier_stokes_block_preconditioner_pt == 0)</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    {</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;      <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#abd83bbbc271df1e5d5f5a96054b0742a">Navier_stokes_preconditioner_is_block_preconditioner</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    }</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160; </div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    <span class="comment">// If the Navier-Stokes preconditioner is a block preconditioner, then we</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    <span class="comment">// need to turn it into a subsidiary block preconditioner.</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#abd83bbbc271df1e5d5f5a96054b0742a">Navier_stokes_preconditioner_is_block_preconditioner</a>)</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    {</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;      <span class="comment">// Assumption: All Navier-Stokes block preconditioners take $dim</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;      <span class="comment">// number of velocity DOF types and 1 pressure DOF type.</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160; </div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;      <span class="comment">// Step 5.1: Set up the dof_number_in_master_map</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160; </div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;      <span class="comment">// First we create the dof_number_in_master_map vector to pass to the</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;      <span class="comment">// subsidiary preconditioner&#39;s</span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;      <span class="comment">// turn_into_subsidiary_block_preconditioner(...) function.</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;      <span class="comment">// This vector maps the subsidiary DOF numbers and the master DOF</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;      <span class="comment">// numbers and has the construction:</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;      <span class="comment">//   dof_number_in_master_map[subsidiary DOF number] = master DOF number</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;      <span class="comment">// Example: Using the example above, our problem has the natural</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;      <span class="comment">// DOF type ordering:</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;      <span class="comment">//  0 1 2 3   4  5  6   7   8    9  10 11 12   &lt;- DOF number in master</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;      <span class="comment">// [u v w p] [up vp wp Lp1 Lp2] [ut vt wt Lt1] &lt;- DOF type</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;      <span class="comment">// For now, we ignore the fact that this preconditioner&#39;s number of</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;      <span class="comment">// DOF types may be more fine grain than what is assumed by the</span></div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;      <span class="comment">// subsidiary block preconditioner. Normally, the order of the values in</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;      <span class="comment">// dof_number_in_master_map matters, since the indices must match the</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;      <span class="comment">// DOF type in the subsidiary block preconditioner (see the assumption</span></div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;      <span class="comment">// above). For example, if the (subsidiary) LSC block preconditioner</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;      <span class="comment">// requires the DOF type ordering:</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;      <span class="comment">// [0 1 2 3]</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;      <span class="comment">//  u v w p</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;      <span class="comment">// Then the dof_number_in_master_map vector must match the u velocity</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;      <span class="comment">// DOF type in the subsidiary preconditioner with the u velocity in the</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;      <span class="comment">// master preconditioner, etc...</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;      <span class="comment">// However, we shall see (later) that it does not matter in this</span></div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;      <span class="comment">// instance because the DOF type coarsening feature overrides the</span></div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;      <span class="comment">// ordering provided here.</span></div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;      <span class="comment">// For now, we only need to ensure that the subsidiary preconditioner</span></div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;      <span class="comment">// knows about 10 master DOF types (9 velocity and 1 pressure), the</span></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;      <span class="comment">// ordering does not matter.</span></div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;      <span class="comment">// We pass to the subsidiary block preconditioner the following</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;      <span class="comment">// dof_number_in_master_map:</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;      <span class="comment">// [0 1 2 4  5  6  9  10 11 3] &lt;- DOF number in master</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;      <span class="comment">//  u v w up vp wp ut vt wt p  &lt;- corresponding DOF type</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160; </div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;      <span class="comment">// Variable to keep track of the DOF number.</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;      <span class="keywordtype">unsigned</span> temp_dof_number = 0;</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160; </div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;      <span class="comment">// Storage for the dof_number_in_master_map</span></div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;      Vector&lt;unsigned&gt; dof_number_in_master_map;</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> mesh_i = 0; mesh_i &lt; <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a862f54ac1db0001ebcd205b1ecc8ad08">My_nmesh</a>; mesh_i++)</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;      {</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;        <span class="comment">// Store the velocity dof types.</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> dim_i = 0; dim_i &lt; spatial_dim; dim_i++)</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;        {</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;          dof_number_in_master_map.push_back(temp_dof_number + dim_i);</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;        } <span class="comment">// for spatial_dim</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160; </div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;        <span class="comment">// Update the DOF index</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;        temp_dof_number += <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a6bbfdf74c3cdc461831f03858f9cb1b7">My_ndof_types_in_mesh</a>[mesh_i];</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;      } <span class="comment">// for My_nmesh</span></div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160; </div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;      <span class="comment">// Push back the pressure DOF type</span></div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;      dof_number_in_master_map.push_back(spatial_dim);</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160; </div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160; </div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;      <span class="comment">// Step 5.2 DOF type coarsening.</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160; </div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;      <span class="comment">// Since this preconditioner works with more fine grained DOF types than</span></div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;      <span class="comment">// the subsidiary block preconditioner, we need to tell the subsidiary</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;      <span class="comment">// preconditioner which DOF types to coarsen together.</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;      <span class="comment">// The LSC preconditioner expects 2(3) velocity dof types, and 1</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;      <span class="comment">// pressure DOF types. Thus, we give it this list:</span></div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;      <span class="comment">// u [0, 3, 6]</span></div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;      <span class="comment">// v [1, 4, 7]</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;      <span class="comment">// w [2, 5, 8]</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;      <span class="comment">// p [9]</span></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;      <span class="comment">// See how the ordering of dof_number_in_master_map (constructed above)</span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;      <span class="comment">// does not matter as long as we construct the doftype_coarsen_map</span></div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;      <span class="comment">// correctly.</span></div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160; </div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;      <span class="comment">// Storage for which subsidiary DOF types to coarsen</span></div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;      Vector&lt;Vector&lt;unsigned&gt;&gt; doftype_coarsen_map;</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> direction = 0; direction &lt; spatial_dim; direction++)</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;      {</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;        Vector&lt;unsigned&gt; dir_doftypes_vec(<a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a862f54ac1db0001ebcd205b1ecc8ad08">My_nmesh</a>, 0);</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> mesh_i = 0; mesh_i &lt; <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a862f54ac1db0001ebcd205b1ecc8ad08">My_nmesh</a>; mesh_i++)</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;        {</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;          dir_doftypes_vec[mesh_i] = spatial_dim * mesh_i + direction;</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;        }</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;        doftype_coarsen_map.push_back(dir_doftypes_vec);</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;      }</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160; </div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;      Vector&lt;unsigned&gt; ns_p_vec(1, 0);</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160; </div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;      <span class="comment">// This is simply the number of velocity dof types,</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;      ns_p_vec[0] = <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a862f54ac1db0001ebcd205b1ecc8ad08">My_nmesh</a> * spatial_dim;</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160; </div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;      doftype_coarsen_map.push_back(ns_p_vec);</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160; </div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;      <span class="comment">// Turn the Navier-Stokes block preconditioner into a subsidiary block</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;      <span class="comment">// preconditioner.</span></div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;      navier_stokes_block_preconditioner_pt</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;        -&gt;turn_into_subsidiary_block_preconditioner(</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;          <span class="keyword">this</span>, dof_number_in_master_map, doftype_coarsen_map);</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160; </div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;      <span class="comment">// Call the setup function</span></div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;      navier_stokes_block_preconditioner_pt-&gt;setup(<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a9aac48fd53e579e6db8eeed58933a14b">matrix_pt</a>());</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    }</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    {</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;      <span class="comment">// Step 5.3: This is not a block preconditioner, thus we need to</span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;      <span class="comment">// concatenate all the fluid matrices and pass them to the solver.</span></div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160; </div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;      <span class="comment">// Select all the fluid blocks (velocity and pressure)</span></div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;      VectorMatrix&lt;BlockSelector&gt; f_aug_blocks(<a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a1c3f53129425f029bf918f33430c0635">N_fluid_doftypes</a>,</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;                                               <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a1c3f53129425f029bf918f33430c0635">N_fluid_doftypes</a>);</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> block_i = 0; block_i &lt; <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a1c3f53129425f029bf918f33430c0635">N_fluid_doftypes</a>; block_i++)</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;      {</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> block_j = 0; block_j &lt; <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a1c3f53129425f029bf918f33430c0635">N_fluid_doftypes</a>; block_j++)</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;        {</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;          f_aug_blocks[block_i][block_j].select_block(block_i, block_j, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;        }</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;      }</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160; </div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;      <span class="comment">// Note: This will use the replaced blocks.</span></div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;      CRDoubleMatrix f_aug_block = this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a51636746e5921ee2845daf60b1c322dc">get_concatenated_block</a>(f_aug_blocks);</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160; </div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#ab447b9d1830e1b470e090efa13201844">Using_superlu_ns_preconditioner</a>)</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;      {</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a03e1316c85ca538a3b6912154e57fd42">Navier_stokes_preconditioner_pt</a> == 0)</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;        {</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;          <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a03e1316c85ca538a3b6912154e57fd42">Navier_stokes_preconditioner_pt</a> = <span class="keyword">new</span> SuperLUPreconditioner;</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;        }</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;      }</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;      {</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a03e1316c85ca538a3b6912154e57fd42">Navier_stokes_preconditioner_pt</a> == 0)</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;        {</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;          std::ostringstream err_msg;</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;          err_msg &lt;&lt; <span class="stringliteral">&quot;Not using SuperLUPreconditioner for NS block,\n&quot;</span></div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;but the Navier_stokes_preconditioner_pt is null.\n&quot;</span>;</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;          <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;            err_msg.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;        }</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;      }</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160; </div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;      <span class="comment">// Setup the solver.</span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;      <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a03e1316c85ca538a3b6912154e57fd42">Navier_stokes_preconditioner_pt</a>-&gt;<a class="code" href="../../db/d9e/classoomph_1_1Preconditioner.html#a0b95e7159585b5151f9e5dc1d1713655">setup</a>(&amp;f_aug_block);</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160; </div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    } <span class="comment">// else</span></div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160; </div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    <span class="comment">// Clean up memory</span></div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> v_aug_nrow = v_aug_pt.nrow();</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> v_aug_ncol = v_aug_pt.ncol();</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> v_row = 0; v_row &lt; v_aug_nrow; v_row++)</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    {</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> v_col = 0; v_col &lt; v_aug_ncol; v_col++)</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;      {</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;        <span class="keyword">delete</span> v_aug_pt(v_row, v_col);</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;        v_aug_pt(v_row, v_col) = 0;</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;      }</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    }</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160; </div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a4a886ec6c0ec223b5f24e27efcc9584b">Preconditioner_has_been_setup</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;  } <span class="comment">// func setup</span></div>
<div class="ttc" id="aclassEigen_1_1Matrix_html"><div class="ttname"><a href="../../dc/d34/classEigen_1_1Matrix.html">Eigen::Matrix&lt; Scalar, Dynamic, Dynamic &gt;</a></div></div>
<div class="ttc" id="aclassoomph_1_1BlockPreconditioner_html_a51636746e5921ee2845daf60b1c322dc"><div class="ttname"><a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a51636746e5921ee2845daf60b1c322dc">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::get_concatenated_block</a></div><div class="ttdeci">CRDoubleMatrix get_concatenated_block(const VectorMatrix&lt; BlockSelector &gt; &amp;selected_block)</div><div class="ttdef"><b>Definition:</b> block_preconditioner.h:1134</div></div>
<div class="ttc" id="aclassoomph_1_1BlockPreconditioner_html_a59e83eca59e3cdc41a93668539e138f1"><div class="ttname"><a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a59e83eca59e3cdc41a93668539e138f1">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::Block_distribution_pt</a></div><div class="ttdeci">Vector&lt; LinearAlgebraDistribution * &gt; Block_distribution_pt</div><div class="ttdoc">The distribution for the blocks.</div><div class="ttdef"><b>Definition:</b> block_preconditioner.h:3277</div></div>
<div class="ttc" id="aclassoomph_1_1BlockPreconditioner_html_a72b4dbe167da59d9ba12c7eff97d77e6"><div class="ttname"><a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a72b4dbe167da59d9ba12c7eff97d77e6">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::get_block</a></div><div class="ttdeci">void get_block(const unsigned &amp;i, const unsigned &amp;j, CRDoubleMatrix &amp;output_matrix, const bool &amp;ignore_replacement_block=false) const</div><div class="ttdef"><b>Definition:</b> block_preconditioner.h:673</div></div>
<div class="ttc" id="aclassoomph_1_1BlockPreconditioner_html_a8a0ae880f098d5b1e9df78fc74c31dbf"><div class="ttname"><a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a8a0ae880f098d5b1e9df78fc74c31dbf">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::set_replacement_dof_block</a></div><div class="ttdeci">void set_replacement_dof_block(const unsigned &amp;block_i, const unsigned &amp;block_j, CRDoubleMatrix *replacement_dof_block_pt)</div><div class="ttdef"><b>Definition:</b> block_preconditioner.h:2911</div></div>
<div class="ttc" id="aclassoomph_1_1BlockPreconditioner_html_a9aac48fd53e579e6db8eeed58933a14b"><div class="ttname"><a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a9aac48fd53e579e6db8eeed58933a14b">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::matrix_pt</a></div><div class="ttdeci">CRDoubleMatrix * matrix_pt() const</div><div class="ttdef"><b>Definition:</b> block_preconditioner.h:520</div></div>
<div class="ttc" id="aclassoomph_1_1BlockPreconditioner_html_a9ac4335ec07fc13f7bf1093fd0489c52"><div class="ttname"><a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a9ac4335ec07fc13f7bf1093fd0489c52">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::is_subsidiary_block_preconditioner</a></div><div class="ttdeci">bool is_subsidiary_block_preconditioner() const</div><div class="ttdef"><b>Definition:</b> block_preconditioner.h:2061</div></div>
<div class="ttc" id="aclassoomph_1_1BlockPreconditioner_html_ab6cca480686ea8e44244ac60a0db23ba"><div class="ttname"><a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ab6cca480686ea8e44244ac60a0db23ba">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::ndof_types</a></div><div class="ttdeci">unsigned ndof_types() const</div><div class="ttdoc">Return the total number of DOF types.</div><div class="ttdef"><b>Definition:</b> block_preconditioner.h:1694</div></div>
<div class="ttc" id="aclassoomph_1_1BlockPreconditioner_html_af704c4816469cef4fed9d35a9ad651ec"><div class="ttname"><a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#af704c4816469cef4fed9d35a9ad651ec">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::block_setup</a></div><div class="ttdeci">virtual void block_setup()</div><div class="ttdef"><b>Definition:</b> block_preconditioner.cc:2483</div></div>
<div class="ttc" id="aclassoomph_1_1DistributableLinearAlgebraObject_html_a603105384d60c9a3710378af39f538b9"><div class="ttname"><a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">oomph::DistributableLinearAlgebraObject::distribution_pt</a></div><div class="ttdeci">LinearAlgebraDistribution * distribution_pt() const</div><div class="ttdoc">access to the LinearAlgebraDistribution</div><div class="ttdef"><b>Definition:</b> linear_algebra_distribution.h:457</div></div>
<div class="ttc" id="aclassoomph_1_1Preconditioner_html_a0b95e7159585b5151f9e5dc1d1713655"><div class="ttname"><a href="../../db/d9e/classoomph_1_1Preconditioner.html#a0b95e7159585b5151f9e5dc1d1713655">oomph::Preconditioner::setup</a></div><div class="ttdeci">void setup(DoubleMatrixBase *matrix_pt)</div><div class="ttdef"><b>Definition:</b> preconditioner.h:94</div></div>
<div class="ttc" id="anamespaceoomph_1_1CRDoubleMatrixHelpers_html_ab17222c9461096e3d5b8cf6250524644"><div class="ttname"><a href="../../dd/d95/namespaceoomph_1_1CRDoubleMatrixHelpers.html#ab17222c9461096e3d5b8cf6250524644">oomph::CRDoubleMatrixHelpers::inf_norm</a></div><div class="ttdeci">double inf_norm(const DenseMatrix&lt; CRDoubleMatrix * &gt; &amp;matrix_pt)</div><div class="ttdoc">Compute infinity (maximum) norm of sub blocks as if it was one matrix.</div><div class="ttdef"><b>Definition:</b> matrices.cc:3731</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a59e83eca59e3cdc41a93668539e138f1">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::Block_distribution_pt</a>, <a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#af704c4816469cef4fed9d35a9ad651ec">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::block_setup()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#af44bac2acd071317f96dae49cbb0d977">oomph::CRDoubleMatrix::build()</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#ace8141de668eb2a172ef9a25c932134a">clean_up_memory()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ad438e693468cd0ae179460eafcaab038">oomph::CRDoubleMatrix::diagonal_entries()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">oomph::DistributableLinearAlgebraObject::distribution_pt()</a>, <a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a72b4dbe167da59d9ba12c7eff97d77e6">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::get_block()</a>, <a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a51636746e5921ee2845daf60b1c322dc">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::get_concatenated_block()</a>, <a class="el" href="../../dd/d95/namespaceoomph_1_1CRDoubleMatrixHelpers.html#ab17222c9461096e3d5b8cf6250524644">oomph::CRDoubleMatrixHelpers::inf_norm()</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a82c70d4dd69f67181ae6c4c93b4e284f">Inv_w_diag_values</a>, <a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a9ac4335ec07fc13f7bf1093fd0489c52">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::is_subsidiary_block_preconditioner()</a>, <a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a9aac48fd53e579e6db8eeed58933a14b">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::matrix_pt()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a54b75960df52e3aebd21aaab20e9869d">oomph::CRDoubleMatrix::multiply()</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#ae9f26444d532bd55864f3d38bf369108">My_mesh_pt</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a6bbfdf74c3cdc461831f03858f9cb1b7">My_ndof_types_in_mesh</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a862f54ac1db0001ebcd205b1ecc8ad08">My_nmesh</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a1c3f53129425f029bf918f33430c0635">N_fluid_doftypes</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a0d62cc72563ff5a2feae895d91ebca1e">N_lagrange_doftypes</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#afdf4577b51473f146c55cb6016b11797">N_velocity_doftypes</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#abd83bbbc271df1e5d5f5a96054b0742a">Navier_stokes_preconditioner_is_block_preconditioner</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a03e1316c85ca538a3b6912154e57fd42">Navier_stokes_preconditioner_pt</a>, <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html#a9937181f1cb4cfaed7aaf3b483c42456">oomph::DenseMatrix&lt; T &gt;::ncol()</a>, <a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ab6cca480686ea8e44244ac60a0db23ba">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::ndof_types()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a9482dafc0a17ebc5b7431369d8d07565">oomph::CRDoubleMatrix::nnz()</a>, <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html#a1b425094510d833ffe91920747a0a962">oomph::DenseMatrix&lt; T &gt;::nrow()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a4a886ec6c0ec223b5f24e27efcc9584b">Preconditioner_has_been_setup</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#aa555c464abd2ac23045a52336123c0a2">Scaling_sigma</a>, <a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a8a0ae880f098d5b1e9df78fc74c31dbf">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::set_replacement_dof_block()</a>, <a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#a0b95e7159585b5151f9e5dc1d1713655">oomph::Preconditioner::setup()</a>, <a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ab8e2478caa8370dd12462f17e1cc8082">oomph::BlockPreconditioner&lt; MATRIX &gt;::turn_into_subsidiary_block_preconditioner()</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a4da1aa7fd0b1a4f9d8eef074f4d1ed81">Use_norm_f_for_scaling_sigma</a>, and <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#ab447b9d1830e1b470e090efa13201844">Using_superlu_ns_preconditioner</a>.</p>

</div>
</div>
<a id="a9a0db8be07c39ebb30f02e4461658efd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a0db8be07c39ebb30f02e4461658efd">&#9670;&nbsp;</a></span>use_norm_f_for_scaling_sigma()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::LagrangeEnforcedFlowPreconditioner::use_norm_f_for_scaling_sigma </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Set flag to use the infinite norm of the Navier-Stokes F matrix as the scaling sigma. This is the default behaviour. Note: the norm of the NS F matrix positive, however, we actually use the negative of the norm. This is because the underlying Navier-Stokes Jacobian is multiplied by -1. Ask Andrew/Matthias for more detail. </p>
<div class="fragment"><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      <a class="code" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a4da1aa7fd0b1a4f9d8eef074f4d1ed81">Use_norm_f_for_scaling_sigma</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a4da1aa7fd0b1a4f9d8eef074f4d1ed81">Use_norm_f_for_scaling_sigma</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a82c70d4dd69f67181ae6c4c93b4e284f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82c70d4dd69f67181ae6c4c93b4e284f">&#9670;&nbsp;</a></span>Inv_w_diag_values</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt;<a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt;<a class="el" href="../../df/de6/classdouble.html">double</a>&gt; &gt; oomph::LagrangeEnforcedFlowPreconditioner::Inv_w_diag_values</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Inverse W values. </p>

<p class="reference">Referenced by <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a519940fc2faee5faac00b80004f3edea">preconditioner_solve()</a>, and <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#aadcbdb5af92d7889c956098cb86dee87">setup()</a>.</p>

</div>
</div>
<a id="ae9f26444d532bd55864f3d38bf369108"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9f26444d532bd55864f3d38bf369108">&#9670;&nbsp;</a></span>My_mesh_pt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt;<a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a>*&gt; oomph::LagrangeEnforcedFlowPreconditioner::My_mesh_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Storage for the meshes. In our implementation, the first mesh must always be the Navier-Stokes (bulk) mesh, followed by surface meshes. </p>

<p class="reference">Referenced by <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a807a1c5694e8b2114e0da3702db00d68">LagrangeEnforcedFlowPreconditioner()</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a84cbce901e94c3ea53a92638ea928bf3">set_meshes()</a>, and <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#aadcbdb5af92d7889c956098cb86dee87">setup()</a>.</p>

</div>
</div>
<a id="a6bbfdf74c3cdc461831f03858f9cb1b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6bbfdf74c3cdc461831f03858f9cb1b7">&#9670;&nbsp;</a></span>My_ndof_types_in_mesh</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt;<a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&gt; oomph::LagrangeEnforcedFlowPreconditioner::My_ndof_types_in_mesh</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The number of DOF types in each mesh. This is used create various lookup lists. </p>

<p class="reference">Referenced by <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a807a1c5694e8b2114e0da3702db00d68">LagrangeEnforcedFlowPreconditioner()</a>, and <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#aadcbdb5af92d7889c956098cb86dee87">setup()</a>.</p>

</div>
</div>
<a id="a862f54ac1db0001ebcd205b1ecc8ad08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a862f54ac1db0001ebcd205b1ecc8ad08">&#9670;&nbsp;</a></span>My_nmesh</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> oomph::LagrangeEnforcedFlowPreconditioner::My_nmesh</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The number of meshes. This is used to create various lookup lists. </p>

<p class="reference">Referenced by <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a807a1c5694e8b2114e0da3702db00d68">LagrangeEnforcedFlowPreconditioner()</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a84cbce901e94c3ea53a92638ea928bf3">set_meshes()</a>, and <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#aadcbdb5af92d7889c956098cb86dee87">setup()</a>.</p>

</div>
</div>
<a id="a1c3f53129425f029bf918f33430c0635"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c3f53129425f029bf918f33430c0635">&#9670;&nbsp;</a></span>N_fluid_doftypes</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> oomph::LagrangeEnforcedFlowPreconditioner::N_fluid_doftypes</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The number of fluid DOF types (including pressure). </p>

<p class="reference">Referenced by <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a807a1c5694e8b2114e0da3702db00d68">LagrangeEnforcedFlowPreconditioner()</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a519940fc2faee5faac00b80004f3edea">preconditioner_solve()</a>, and <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#aadcbdb5af92d7889c956098cb86dee87">setup()</a>.</p>

</div>
</div>
<a id="a0d62cc72563ff5a2feae895d91ebca1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d62cc72563ff5a2feae895d91ebca1e">&#9670;&nbsp;</a></span>N_lagrange_doftypes</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> oomph::LagrangeEnforcedFlowPreconditioner::N_lagrange_doftypes</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The number of Lagrange multiplier DOF types. </p>

<p class="reference">Referenced by <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a807a1c5694e8b2114e0da3702db00d68">LagrangeEnforcedFlowPreconditioner()</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a519940fc2faee5faac00b80004f3edea">preconditioner_solve()</a>, and <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#aadcbdb5af92d7889c956098cb86dee87">setup()</a>.</p>

</div>
</div>
<a id="afdf4577b51473f146c55cb6016b11797"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afdf4577b51473f146c55cb6016b11797">&#9670;&nbsp;</a></span>N_velocity_doftypes</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> oomph::LagrangeEnforcedFlowPreconditioner::N_velocity_doftypes</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The number of velocity DOF types. </p>

<p class="reference">Referenced by <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a807a1c5694e8b2114e0da3702db00d68">LagrangeEnforcedFlowPreconditioner()</a>, and <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#aadcbdb5af92d7889c956098cb86dee87">setup()</a>.</p>

</div>
</div>
<a id="abd83bbbc271df1e5d5f5a96054b0742a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd83bbbc271df1e5d5f5a96054b0742a">&#9670;&nbsp;</a></span>Navier_stokes_preconditioner_is_block_preconditioner</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::LagrangeEnforcedFlowPreconditioner::Navier_stokes_preconditioner_is_block_preconditioner</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Flag to indicate if the preconditioner for the Navier-Stokes block is a block preconditioner or not. </p>

<p class="reference">Referenced by <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a807a1c5694e8b2114e0da3702db00d68">LagrangeEnforcedFlowPreconditioner()</a>, and <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#aadcbdb5af92d7889c956098cb86dee87">setup()</a>.</p>

</div>
</div>
<a id="a03e1316c85ca538a3b6912154e57fd42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03e1316c85ca538a3b6912154e57fd42">&#9670;&nbsp;</a></span>Navier_stokes_preconditioner_pt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html">Preconditioner</a>* oomph::LagrangeEnforcedFlowPreconditioner::Navier_stokes_preconditioner_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pointer to the 'preconditioner' for the Navier-Stokes block. </p>

<p class="reference">Referenced by <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#ace8141de668eb2a172ef9a25c932134a">clean_up_memory()</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a807a1c5694e8b2114e0da3702db00d68">LagrangeEnforcedFlowPreconditioner()</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a519940fc2faee5faac00b80004f3edea">preconditioner_solve()</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a3512f2a0c6b03977590591a81846c50d">set_navier_stokes_preconditioner()</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#ad523330041a714da26bc4931995023b8">set_superlu_for_navier_stokes_preconditioner()</a>, and <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#aadcbdb5af92d7889c956098cb86dee87">setup()</a>.</p>

</div>
</div>
<a id="a4a886ec6c0ec223b5f24e27efcc9584b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a886ec6c0ec223b5f24e27efcc9584b">&#9670;&nbsp;</a></span>Preconditioner_has_been_setup</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::LagrangeEnforcedFlowPreconditioner::Preconditioner_has_been_setup</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Control flag is true if the preconditioner has been setup (used so we can wipe the data when the preconditioner is called again) </p>

<p class="reference">Referenced by <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#ace8141de668eb2a172ef9a25c932134a">clean_up_memory()</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a807a1c5694e8b2114e0da3702db00d68">LagrangeEnforcedFlowPreconditioner()</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a519940fc2faee5faac00b80004f3edea">preconditioner_solve()</a>, and <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#aadcbdb5af92d7889c956098cb86dee87">setup()</a>.</p>

</div>
</div>
<a id="aa555c464abd2ac23045a52336123c0a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa555c464abd2ac23045a52336123c0a2">&#9670;&nbsp;</a></span>Scaling_sigma</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> oomph::LagrangeEnforcedFlowPreconditioner::Scaling_sigma</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Scaling for the augmentation: Scaling_sigma*(LL^T) </p>

<p class="reference">Referenced by <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a807a1c5694e8b2114e0da3702db00d68">LagrangeEnforcedFlowPreconditioner()</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a63ef6de02fbf4486ca99d2a560ff47a4">scaling_sigma()</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a14023f7ee6150f3b2ebdb0eab534242d">set_scaling_sigma()</a>, and <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#aadcbdb5af92d7889c956098cb86dee87">setup()</a>.</p>

</div>
</div>
<a id="a4da1aa7fd0b1a4f9d8eef074f4d1ed81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4da1aa7fd0b1a4f9d8eef074f4d1ed81">&#9670;&nbsp;</a></span>Use_norm_f_for_scaling_sigma</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::LagrangeEnforcedFlowPreconditioner::Use_norm_f_for_scaling_sigma</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Flag to indicate if we want to use the infinite norm of the Navier-Stokes momentum block for the scaling sigma. </p>

<p class="reference">Referenced by <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a807a1c5694e8b2114e0da3702db00d68">LagrangeEnforcedFlowPreconditioner()</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a14023f7ee6150f3b2ebdb0eab534242d">set_scaling_sigma()</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#aadcbdb5af92d7889c956098cb86dee87">setup()</a>, and <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a9a0db8be07c39ebb30f02e4461658efd">use_norm_f_for_scaling_sigma()</a>.</p>

</div>
</div>
<a id="ab447b9d1830e1b470e090efa13201844"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab447b9d1830e1b470e090efa13201844">&#9670;&nbsp;</a></span>Using_superlu_ns_preconditioner</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::LagrangeEnforcedFlowPreconditioner::Using_superlu_ns_preconditioner</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Flag to indicate whether the default NS preconditioner is used. </p>

<p class="reference">Referenced by <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#ace8141de668eb2a172ef9a25c932134a">clean_up_memory()</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a807a1c5694e8b2114e0da3702db00d68">LagrangeEnforcedFlowPreconditioner()</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a519940fc2faee5faac00b80004f3edea">preconditioner_solve()</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#a3512f2a0c6b03977590591a81846c50d">set_navier_stokes_preconditioner()</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#ad523330041a714da26bc4931995023b8">set_superlu_for_navier_stokes_preconditioner()</a>, and <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#aadcbdb5af92d7889c956098cb86dee87">setup()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="../../d8/d09/lagrange__enforced__flow__preconditioner_8h_source.html">lagrange_enforced_flow_preconditioner.h</a></li>
<li><a class="el" href="../../d1/dcc/lagrange__enforced__flow__preconditioner_8cc.html">lagrange_enforced_flow_preconditioner.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../da/ddf/namespaceoomph.html">oomph</a></li><li class="navelem"><a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html">LagrangeEnforcedFlowPreconditioner</a></li>
    <li class="footer">Generated on Wed Aug 27 2025 17:09:23 for MercuryDPM by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
