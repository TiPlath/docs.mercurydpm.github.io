<!-- HTML header for doxygen 1.8.18-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MercuryDPM: PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt; Class Template Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../MDPM.css" rel="stylesheet" type="text/css"/>
<link href="../../codeLabels.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-fork-corner.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-dropdown-version.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../MDPM-fragment-copy-button.js"></script>
<script type="text/javascript">
DoxygenAwesomeFragmentCopyButton.init()
</script>
<script type="text/javascript" src="../../MDPM-paragraph-link.js"></script>
<script type="text/javascript">
DoxygenAwesomeParagraphLink.init()
</script>
<script type="text/javascript" src="../../MDPM-interactive-toc.js"></script>
<script type="text/javascript">
DoxygenAwesomeInteractiveToc.init()
</script>
<script type="text/javascript" src="../../MDPM-darkmode-toggle.js"></script>
<script type="text/javascript">
DoxygenAwesomeDarkModeToggle.init()
</script>
</head>
<body>
  <div id="bitbucket-corner">
   <a href="https://bitbucket.org/mercurydpm/mercurydpm/src/master/" target="_blank" id="fork-corner" class="fork-corner fc-pos-tr fc-animate fc-theme-bitbucket"></a>
  </div>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../mercury-logo-chosen-light-slogan.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"> <!--MercuryDPM--!>
   <!-- BEGIN version select -->
   <div class="dropdown" id="projectnumber">
    <button class="dropbtn">v1.0</button>
    <div class="dropdown-content">
    </div>
   </div>
   <script type="text/javascript" src="../../MDPM-dropdown-version.js"></script>
<!-- END version select -->
   <!--&#160;<span id="projectnumber">revision: v1.0</span>-->
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<script type="text/javascript" src="../../MDPM-fork-corner.js"></script>
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d8/db6/classPoissonElementWithSingularity.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="../../d3/d4d/classPoissonElementWithSingularity-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt; Class Template Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="../../d2/d58/poisson__elements__with__singularity_8h_source.html">poisson_elements_with_singularity.h</a>&gt;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Inheritance diagram for PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
 <div class="center">
  <img src="../../d8/db6/classPoissonElementWithSingularity.png" usemap="#PoissonElementWithSingularity_3C_20BASIC_5FPOISSON_5FELEMENT_20_3E_map" alt=""/>
  <map id="PoissonElementWithSingularity_3C_20BASIC_5FPOISSON_5FELEMENT_20_3E_map" name="PoissonElementWithSingularity_3C_20BASIC_5FPOISSON_5FELEMENT_20_3E_map">
<area href="../../d2/d0a/classBASIC__POISSON__ELEMENT.html" alt="BASIC_POISSON_ELEMENT" shape="rect" coords="0,0,373,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a6bda910e96c7296cdf81ec22154acaa1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#a6bda910e96c7296cdf81ec22154acaa1">PoissonElementWithSingularity</a> ()</td></tr>
<tr class="memdesc:a6bda910e96c7296cdf81ec22154acaa1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="../../d8/db6/classPoissonElementWithSingularity.html#a6bda910e96c7296cdf81ec22154acaa1">More...</a><br /></td></tr>
<tr class="separator:a6bda910e96c7296cdf81ec22154acaa1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acee90933d719ca2d9807f81be46008aa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#acee90933d719ca2d9807f81be46008aa">impose_dirichlet_bc_on_node</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>)</td></tr>
<tr class="separator:acee90933d719ca2d9807f81be46008aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4c67306e1e58b8d3d1789a9439ac2c1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#aa4c67306e1e58b8d3d1789a9439ac2c1">undo_dirichlet_bc_on_node</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>)</td></tr>
<tr class="memdesc:aa4c67306e1e58b8d3d1789a9439ac2c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Undo Dirichlet BCs on jth node.  <a href="../../d8/db6/classPoissonElementWithSingularity.html#aa4c67306e1e58b8d3d1789a9439ac2c1">More...</a><br /></td></tr>
<tr class="separator:aa4c67306e1e58b8d3d1789a9439ac2c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ede36561509e5b0a5fa890b13e40275"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#a4ede36561509e5b0a5fa890b13e40275">undo_dirichlet_bc_on_all_nodes</a> ()</td></tr>
<tr class="memdesc:a4ede36561509e5b0a5fa890b13e40275"><td class="mdescLeft">&#160;</td><td class="mdescRight">Undo Dirichlet BCs on all nodes.  <a href="../../d8/db6/classPoissonElementWithSingularity.html#a4ede36561509e5b0a5fa890b13e40275">More...</a><br /></td></tr>
<tr class="separator:a4ede36561509e5b0a5fa890b13e40275"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f55f626c9d117d05a3f313ae6628459"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#a8f55f626c9d117d05a3f313ae6628459">set_dirichlet_value_on_node</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;value)</td></tr>
<tr class="memdesc:a8f55f626c9d117d05a3f313ae6628459"><td class="mdescLeft">&#160;</td><td class="mdescRight">Specify Dirichlet boundary value for j-th local node.  <a href="../../d8/db6/classPoissonElementWithSingularity.html#a8f55f626c9d117d05a3f313ae6628459">More...</a><br /></td></tr>
<tr class="separator:a8f55f626c9d117d05a3f313ae6628459"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae23e1c8879b4a4e9f3e32b85493cf80"><td class="memItemLeft" align="right" valign="top">Vector&lt; <a class="el" href="../../da/d17/classSingularPoissonSolutionElement.html">SingularPoissonSolutionElement</a>&lt; <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html">PoissonElementWithSingularity</a>&lt; <a class="el" href="../../d2/d0a/classBASIC__POISSON__ELEMENT.html">BASIC_POISSON_ELEMENT</a> &gt; &gt; * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#aae23e1c8879b4a4e9f3e32b85493cf80">c_equation_elements_pt</a> ()</td></tr>
<tr class="separator:aae23e1c8879b4a4e9f3e32b85493cf80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60989f3b18af6c40fefd958c8f0fe994"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#a60989f3b18af6c40fefd958c8f0fe994">add_c_equation_element_pt</a> (<a class="el" href="../../da/d17/classSingularPoissonSolutionElement.html">SingularPoissonSolutionElement</a>&lt; <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html">PoissonElementWithSingularity</a>&lt; <a class="el" href="../../d2/d0a/classBASIC__POISSON__ELEMENT.html">BASIC_POISSON_ELEMENT</a> &gt; &gt; *c_pt)</td></tr>
<tr class="separator:a60989f3b18af6c40fefd958c8f0fe994"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add71781fd885d3692f4c7893684f3b82"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#add71781fd885d3692f4c7893684f3b82">u_bar</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>, const Vector&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a61b7da262276970831d88a2f37dbe509">x</a>) const</td></tr>
<tr class="separator:add71781fd885d3692f4c7893684f3b82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27854d2d8566d67cf00efad078133949"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#a27854d2d8566d67cf00efad078133949">singular_function</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>, const Vector&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a61b7da262276970831d88a2f37dbe509">x</a>) const</td></tr>
<tr class="memdesc:a27854d2d8566d67cf00efad078133949"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate i-th "raw" singular function at Eulerian position x.  <a href="../../d8/db6/classPoissonElementWithSingularity.html#a27854d2d8566d67cf00efad078133949">More...</a><br /></td></tr>
<tr class="separator:a27854d2d8566d67cf00efad078133949"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a468249b66dfb40fda1cf03797746a0ba"><td class="memItemLeft" align="right" valign="top">Vector&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#a468249b66dfb40fda1cf03797746a0ba">grad_u_bar</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>, const Vector&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a61b7da262276970831d88a2f37dbe509">x</a>) const</td></tr>
<tr class="separator:a468249b66dfb40fda1cf03797746a0ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afed94940e5be522f7d39d030f9e2d106"><td class="memItemLeft" align="right" valign="top">Vector&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#afed94940e5be522f7d39d030f9e2d106">grad_singular_function</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>, const Vector&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a61b7da262276970831d88a2f37dbe509">x</a>) const</td></tr>
<tr class="memdesc:afed94940e5be522f7d39d030f9e2d106"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate the gradient of the i-th "raw" singular at Eulerian position x.  <a href="../../d8/db6/classPoissonElementWithSingularity.html#afed94940e5be522f7d39d030f9e2d106">More...</a><br /></td></tr>
<tr class="separator:afed94940e5be522f7d39d030f9e2d106"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1f6a821acb69c656618578e54b29401"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#ad1f6a821acb69c656618578e54b29401">interpolated_u_poisson_fe_only</a> (const Vector&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>) const</td></tr>
<tr class="separator:ad1f6a821acb69c656618578e54b29401"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5dc62fc40b8ea5c195e7983180104fe6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#a5dc62fc40b8ea5c195e7983180104fe6">interpolated_u_poisson</a> (const Vector&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>) const</td></tr>
<tr class="memdesc:a5dc62fc40b8ea5c195e7983180104fe6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Overloaded version including the singular contributions.  <a href="../../d8/db6/classPoissonElementWithSingularity.html#a5dc62fc40b8ea5c195e7983180104fe6">More...</a><br /></td></tr>
<tr class="separator:a5dc62fc40b8ea5c195e7983180104fe6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54a13ba968a10b764b3b3fe1c282cb7e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#a54a13ba968a10b764b3b3fe1c282cb7e">fill_in_contribution_to_residuals</a> (Vector&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;residuals)</td></tr>
<tr class="memdesc:a54a13ba968a10b764b3b3fe1c282cb7e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add the element's contribution to its residual vector (wrapper)  <a href="../../d8/db6/classPoissonElementWithSingularity.html#a54a13ba968a10b764b3b3fe1c282cb7e">More...</a><br /></td></tr>
<tr class="separator:a54a13ba968a10b764b3b3fe1c282cb7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22416de25b1a702e3303ee892782332c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#a22416de25b1a702e3303ee892782332c">fill_in_contribution_to_jacobian</a> (Vector&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;residuals, <a class="el" href="../../d2/dbf/BenchSparseUtil_8h.html#aa5fbb9f8287afd9550c07e51340b8b49">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;jacobian)</td></tr>
<tr class="separator:a22416de25b1a702e3303ee892782332c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef5e585bc1042cde68d2d4a8ef99a5b2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#aef5e585bc1042cde68d2d4a8ef99a5b2">output</a> (std::ostream &amp;outfile, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;nplot)</td></tr>
<tr class="memdesc:aef5e585bc1042cde68d2d4a8ef99a5b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Overloaded output fct: x, y [,z], u, u_fe_only, u-u_fe_only.  <a href="../../d8/db6/classPoissonElementWithSingularity.html#aef5e585bc1042cde68d2d4a8ef99a5b2">More...</a><br /></td></tr>
<tr class="separator:aef5e585bc1042cde68d2d4a8ef99a5b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbb71ceae9bfbb41043bb2db37228c1c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#acbb71ceae9bfbb41043bb2db37228c1c">compute_error</a> (std::ostream &amp;outfile, FiniteElement::SteadyExactSolutionFctPt exact_soln_pt, <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;error, <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;norm)</td></tr>
<tr class="memdesc:acbb71ceae9bfbb41043bb2db37228c1c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute error.  <a href="../../d8/db6/classPoissonElementWithSingularity.html#acbb71ceae9bfbb41043bb2db37228c1c">More...</a><br /></td></tr>
<tr class="separator:acbb71ceae9bfbb41043bb2db37228c1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a35c37bfba86d40af0bfd3220b4fea968"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#a35c37bfba86d40af0bfd3220b4fea968">fill_in_generic_residual_contribution_wrapped_poisson</a> (Vector&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;residuals, <a class="el" href="../../d2/dbf/BenchSparseUtil_8h.html#aa5fbb9f8287afd9550c07e51340b8b49">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;jacobian, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;flag)</td></tr>
<tr class="memdesc:a35c37bfba86d40af0bfd3220b4fea968"><td class="mdescLeft">&#160;</td><td class="mdescRight">Overloaded fill-in function.  <a href="../../d8/db6/classPoissonElementWithSingularity.html#a35c37bfba86d40af0bfd3220b4fea968">More...</a><br /></td></tr>
<tr class="separator:a35c37bfba86d40af0bfd3220b4fea968"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a9ecf0fc68a5677c41e950298c5cbf804"><td class="memItemLeft" align="right" valign="top">Vector&lt; <a class="el" href="../../da/d17/classSingularPoissonSolutionElement.html">SingularPoissonSolutionElement</a>&lt; <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html">PoissonElementWithSingularity</a>&lt; <a class="el" href="../../d2/d0a/classBASIC__POISSON__ELEMENT.html">BASIC_POISSON_ELEMENT</a> &gt; &gt; * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#a9ecf0fc68a5677c41e950298c5cbf804">C_equation_elements_pt</a></td></tr>
<tr class="memdesc:a9ecf0fc68a5677c41e950298c5cbf804"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector of pointers to SingularPoissonSolutionElement objects.  <a href="../../d8/db6/classPoissonElementWithSingularity.html#a9ecf0fc68a5677c41e950298c5cbf804">More...</a><br /></td></tr>
<tr class="separator:a9ecf0fc68a5677c41e950298c5cbf804"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a883ac0f06f723647aa578269bebe7c69"><td class="memItemLeft" align="right" valign="top">vector&lt; <a class="el" href="../../d9/db9/classbool.html">bool</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#a883ac0f06f723647aa578269bebe7c69">Node_is_subject_to_dirichlet_bc</a></td></tr>
<tr class="separator:a883ac0f06f723647aa578269bebe7c69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adee3596c14fcbdfe051941c47cc537ea"><td class="memItemLeft" align="right" valign="top">Vector&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#adee3596c14fcbdfe051941c47cc537ea">Imposed_value_at_node</a></td></tr>
<tr class="separator:adee3596c14fcbdfe051941c47cc537ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;class BASIC_POISSON_ELEMENT&gt;<br />
class PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;</h3>

<p>///////////////////////////////////////////////////////////////// ///////////////////////////////////////////////////////////////// ///////////////////////////////////////////////////////////////// Templated wrapper to add handling of singularities to the underlying Poisson element (specified via the template argument). Slightly inefficient because the integration loop is repeated here. The only alternative is to add the additional functionality into the Poisson elements. Not pretty either!</p>
<p>Dirichlet BCs are applied in hijacking manner and must be imposed from each element that shares a boundary node that is subject to a Dirichlet condition. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a6bda910e96c7296cdf81ec22154acaa1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6bda910e96c7296cdf81ec22154acaa1">&#9670;&nbsp;</a></span>PoissonElementWithSingularity()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_POISSON_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html">PoissonElementWithSingularity</a>&lt; <a class="el" href="../../d2/d0a/classBASIC__POISSON__ELEMENT.html">BASIC_POISSON_ELEMENT</a> &gt;::<a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html">PoissonElementWithSingularity</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructor. </p>
<div class="fragment"><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  {</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;   <span class="comment">// Find the number of nodes in the element</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;   <span class="keywordtype">unsigned</span> n_node = this-&gt;nnode();</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;   </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;   <span class="comment">// Initialise the vector of booleans indicating which</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;   <span class="comment">// node is subject to Dirichlet BC. The size of the</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;   <span class="comment">// vector is equal to the number</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;   <span class="comment">// of nodes in the element. By default, no node is subject</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;   <span class="comment">// to Dirichlet BC, so the vector is full of false. </span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;   <a class="code" href="../../d8/db6/classPoissonElementWithSingularity.html#a883ac0f06f723647aa578269bebe7c69">Node_is_subject_to_dirichlet_bc</a>.resize(n_node);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>=0;<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>&lt;n_node;<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    {</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;     <a class="code" href="../../d8/db6/classPoissonElementWithSingularity.html#a883ac0f06f723647aa578269bebe7c69">Node_is_subject_to_dirichlet_bc</a>[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    }</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;   </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;   <span class="comment">// Initialise the vector of imposed values on the nodes subject</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;   <span class="comment">// to Dirichlet BC. The size of the vector is equal to the number</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;   <span class="comment">// of nodes in the element. If a node is not subject to Dirichlet</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;   <span class="comment">// BC, its imposed value is zero. By default, no node is subject</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;   <span class="comment">// to Dirichlet BC so the vector is full of zeros</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;   <a class="code" href="../../d8/db6/classPoissonElementWithSingularity.html#adee3596c14fcbdfe051941c47cc537ea">Imposed_value_at_node</a>.resize(n_node);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>=0;<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>&lt;n_node;<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    {</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;     <a class="code" href="../../d8/db6/classPoissonElementWithSingularity.html#adee3596c14fcbdfe051941c47cc537ea">Imposed_value_at_node</a>[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>] = 0.0;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    }</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;   </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  } <span class="comment">// End of constructor</span></div>
<div class="ttc" id="aclassPoissonElementWithSingularity_html_a883ac0f06f723647aa578269bebe7c69"><div class="ttname"><a href="../../d8/db6/classPoissonElementWithSingularity.html#a883ac0f06f723647aa578269bebe7c69">PoissonElementWithSingularity::Node_is_subject_to_dirichlet_bc</a></div><div class="ttdeci">vector&lt; bool &gt; Node_is_subject_to_dirichlet_bc</div><div class="ttdef"><b>Definition:</b> poisson_elements_with_singularity.h:894</div></div>
<div class="ttc" id="aclassPoissonElementWithSingularity_html_adee3596c14fcbdfe051941c47cc537ea"><div class="ttname"><a href="../../d8/db6/classPoissonElementWithSingularity.html#adee3596c14fcbdfe051941c47cc537ea">PoissonElementWithSingularity::Imposed_value_at_node</a></div><div class="ttdeci">Vector&lt; double &gt; Imposed_value_at_node</div><div class="ttdef"><b>Definition:</b> poisson_elements_with_singularity.h:898</div></div>
<div class="ttc" id="atut__arithmetic__redux__minmax_8cpp_html_a39513f0f8d942bf9ef17b2e87ac6d34e"><div class="ttname"><a href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a></div><div class="ttdeci">std::ptrdiff_t j</div><div class="ttdef"><b>Definition:</b> tut_arithmetic_redux_minmax.cpp:2</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#adee3596c14fcbdfe051941c47cc537ea">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::Imposed_value_at_node</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, and <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#a883ac0f06f723647aa578269bebe7c69">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::Node_is_subject_to_dirichlet_bc</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a60989f3b18af6c40fefd958c8f0fe994"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60989f3b18af6c40fefd958c8f0fe994">&#9670;&nbsp;</a></span>add_c_equation_element_pt()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_POISSON_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html">PoissonElementWithSingularity</a>&lt; <a class="el" href="../../d2/d0a/classBASIC__POISSON__ELEMENT.html">BASIC_POISSON_ELEMENT</a> &gt;::add_c_equation_element_pt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../da/d17/classSingularPoissonSolutionElement.html">SingularPoissonSolutionElement</a>&lt; <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html">PoissonElementWithSingularity</a>&lt; <a class="el" href="../../d2/d0a/classBASIC__POISSON__ELEMENT.html">BASIC_POISSON_ELEMENT</a> &gt; &gt; *&#160;</td>
          <td class="paramname"><em>c_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Add pointer to associated SingularPoissonSolutionElement that determines the value of the amplitude of the singular function (and gives access to the singular function). The unknown amplitude becomes external Data for this element so assign_eqn_numbers() must be called after this function has been called. <br  />
 </p>
<div class="fragment"><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160; {</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  <span class="comment">// Add the element</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <a class="code" href="../../d8/db6/classPoissonElementWithSingularity.html#a9ecf0fc68a5677c41e950298c5cbf804">C_equation_elements_pt</a>.push_back(c_pt);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="comment">// Add the additional unknown of this object as external data in the</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="comment">// Poisson element</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  this-&gt;add_external_data(c_pt-&gt;internal_data_pt(0));</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160; }</div>
<div class="ttc" id="aclassPoissonElementWithSingularity_html_a9ecf0fc68a5677c41e950298c5cbf804"><div class="ttname"><a href="../../d8/db6/classPoissonElementWithSingularity.html#a9ecf0fc68a5677c41e950298c5cbf804">PoissonElementWithSingularity::C_equation_elements_pt</a></div><div class="ttdeci">Vector&lt; SingularPoissonSolutionElement&lt; PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt; &gt; * &gt; C_equation_elements_pt</div><div class="ttdoc">Vector of pointers to SingularPoissonSolutionElement objects.</div><div class="ttdef"><b>Definition:</b> poisson_elements_with_singularity.h:890</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#a9ecf0fc68a5677c41e950298c5cbf804">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::C_equation_elements_pt</a>.</p>

</div>
</div>
<a id="aae23e1c8879b4a4e9f3e32b85493cf80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae23e1c8879b4a4e9f3e32b85493cf80">&#9670;&nbsp;</a></span>c_equation_elements_pt()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_POISSON_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Vector&lt;<a class="el" href="../../da/d17/classSingularPoissonSolutionElement.html">SingularPoissonSolutionElement</a>&lt;<a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html">PoissonElementWithSingularity</a> &lt;<a class="el" href="../../d2/d0a/classBASIC__POISSON__ELEMENT.html">BASIC_POISSON_ELEMENT</a>&gt; &gt;*&gt; <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html">PoissonElementWithSingularity</a>&lt; <a class="el" href="../../d2/d0a/classBASIC__POISSON__ELEMENT.html">BASIC_POISSON_ELEMENT</a> &gt;::c_equation_elements_pt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Access function to pointer of vector of SingularPoissonSolutionElements. These specify the singular functions that are added to the (regular) FE solution </p>
<div class="fragment"><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  {</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d8/db6/classPoissonElementWithSingularity.html#a9ecf0fc68a5677c41e950298c5cbf804">C_equation_elements_pt</a>;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#a9ecf0fc68a5677c41e950298c5cbf804">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::C_equation_elements_pt</a>.</p>

</div>
</div>
<a id="acbb71ceae9bfbb41043bb2db37228c1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acbb71ceae9bfbb41043bb2db37228c1c">&#9670;&nbsp;</a></span>compute_error()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_POISSON_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html">PoissonElementWithSingularity</a>&lt; <a class="el" href="../../d2/d0a/classBASIC__POISSON__ELEMENT.html">BASIC_POISSON_ELEMENT</a> &gt;::compute_error </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>outfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FiniteElement::SteadyExactSolutionFctPt&#160;</td>
          <td class="paramname"><em>exact_soln_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>error</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>norm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute error. </p>
<div class="fragment"><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160; { </div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160; </div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  <span class="comment">// Initialise</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  <a class="code" href="../../d9/d33/namespacecalibrate.html#a4dbebf21da853ac368a3a9af2fbab442">error</a>=0.0;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  norm=0.0;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160; </div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  <span class="comment">// Find the dimension of the problem</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <span class="keywordtype">unsigned</span> cached_dim = this-&gt;dim();</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160; </div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  <span class="comment">//Vector of local coordinates</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  Vector&lt;double&gt; <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>(cached_dim);</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160; </div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  <span class="comment">// Vector for coordintes</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  Vector&lt;double&gt; <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>(cached_dim);</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160; </div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  <span class="comment">//Find out how many nodes there are in the element</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  <span class="keywordtype">unsigned</span> n_node = this-&gt;nnode();</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160; </div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  Shape psi(n_node);</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160; </div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  <span class="comment">//Set the value of n_intpt</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  <span class="keywordtype">unsigned</span> n_intpt = this-&gt;integral_pt()-&gt;nweight();</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  </div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  <span class="comment">// Tecplot </span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  outfile &lt;&lt; <span class="stringliteral">&quot;ZONE&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160; </div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  <span class="comment">// Exact solution Vector (here a scalar)</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  Vector&lt;double&gt; <a class="code" href="../../d6/d6d/namespaceProblemParameters.html#a36e4b27a055339709d0f982d004b622a">exact_soln</a>(1);</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160; </div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  <span class="comment">//Loop over the integration points</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ipt=0;ipt&lt;n_intpt;ipt++)</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;   {</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;   </div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <span class="comment">//Assign values of s</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;cached_dim;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;     {</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;      <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = this-&gt;integral_pt()-&gt;knot(ipt,<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;     }</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;   </div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="comment">//Get the integral weight</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a> = this-&gt;integral_pt()-&gt;weight(ipt);</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;   </div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <span class="comment">// Get jacobian of mapping</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../dc/da8/Jacobi__makeJacobi_8cpp.html#a4804f9d1c212b9655934738d0ae395ab">J</a>=this-&gt;J_eulerian(<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>);</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;   </div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="comment">//Premultiply the weights and the Jacobian</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../dc/d00/namespaceoomph_1_1QuadTreeNames.html#a9ac199adb82120cbaa47bf2365918ab9aabab2a070c062503375f8264f1b6d7d6">W</a> = <a class="code" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a>*<a class="code" href="../../dc/da8/Jacobi__makeJacobi_8cpp.html#a4804f9d1c212b9655934738d0ae395ab">J</a>;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;   </div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <span class="comment">// Get x position as Vector</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    this-&gt;interpolated_x(<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>,<a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>);</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;   </div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="comment">// Get FE function value</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <span class="keywordtype">double</span> u_fe=<a class="code" href="../../d8/db6/classPoissonElementWithSingularity.html#a5dc62fc40b8ea5c195e7983180104fe6">interpolated_u_poisson</a>(<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>);</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;   </div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <span class="comment">// Get exact solution at this point</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    (*exact_soln_pt)(<a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>,<a class="code" href="../../d6/d6d/namespaceProblemParameters.html#a36e4b27a055339709d0f982d004b622a">exact_soln</a>);</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;   </div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <span class="comment">//Output x,y,...,error</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;cached_dim;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;     {</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;      outfile &lt;&lt; <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;     }</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    outfile &lt;&lt; <a class="code" href="../../d6/d6d/namespaceProblemParameters.html#a36e4b27a055339709d0f982d004b622a">exact_soln</a>[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="../../d6/d6d/namespaceProblemParameters.html#a36e4b27a055339709d0f982d004b622a">exact_soln</a>[0]-u_fe &lt;&lt; std::endl;  </div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;   </div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <span class="comment">// Add to error and norm</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    norm+=<a class="code" href="../../d6/d6d/namespaceProblemParameters.html#a36e4b27a055339709d0f982d004b622a">exact_soln</a>[0]*<a class="code" href="../../d6/d6d/namespaceProblemParameters.html#a36e4b27a055339709d0f982d004b622a">exact_soln</a>[0]*<a class="code" href="../../dc/d00/namespaceoomph_1_1QuadTreeNames.html#a9ac199adb82120cbaa47bf2365918ab9aabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <a class="code" href="../../d9/d33/namespacecalibrate.html#a4dbebf21da853ac368a3a9af2fbab442">error</a>+=(<a class="code" href="../../d6/d6d/namespaceProblemParameters.html#a36e4b27a055339709d0f982d004b622a">exact_soln</a>[0]-u_fe)*(<a class="code" href="../../d6/d6d/namespaceProblemParameters.html#a36e4b27a055339709d0f982d004b622a">exact_soln</a>[0]-u_fe)*<a class="code" href="../../dc/d00/namespaceoomph_1_1QuadTreeNames.html#a9ac199adb82120cbaa47bf2365918ab9aabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;   }</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160; }</div>
<div class="ttc" id="aBiCGSTAB__step__by__step_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> BiCGSTAB_step_by_step.cpp:9</div></div>
<div class="ttc" id="aJacobi__makeJacobi_8cpp_html_a4804f9d1c212b9655934738d0ae395ab"><div class="ttname"><a href="../../dc/da8/Jacobi__makeJacobi_8cpp.html#a4804f9d1c212b9655934738d0ae395ab">J</a></div><div class="ttdeci">JacobiRotation&lt; float &gt; J</div><div class="ttdef"><b>Definition:</b> Jacobi_makeJacobi.cpp:3</div></div>
<div class="ttc" id="aMatrix__resize__int_8cpp_html_aab236ce080522c9832217fd5f157541b"><div class="ttname"><a href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a></div><div class="ttdeci">RowVector3d w</div><div class="ttdef"><b>Definition:</b> Matrix_resize_int.cpp:3</div></div>
<div class="ttc" id="aclassPoissonElementWithSingularity_html_a5dc62fc40b8ea5c195e7983180104fe6"><div class="ttname"><a href="../../d8/db6/classPoissonElementWithSingularity.html#a5dc62fc40b8ea5c195e7983180104fe6">PoissonElementWithSingularity::interpolated_u_poisson</a></div><div class="ttdeci">double interpolated_u_poisson(const Vector&lt; double &gt; &amp;s) const</div><div class="ttdoc">Overloaded version including the singular contributions.</div><div class="ttdef"><b>Definition:</b> poisson_elements_with_singularity.h:478</div></div>
<div class="ttc" id="alevel1__cplx__impl_8h_html_a462761ca92ad97a9a705cb875828b0b8"><div class="ttname"><a href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a></div><div class="ttdeci">RealScalar s</div><div class="ttdef"><b>Definition:</b> level1_cplx_impl.h:130</div></div>
<div class="ttc" id="anamespaceProblemParameters_html_a36e4b27a055339709d0f982d004b622a"><div class="ttname"><a href="../../d6/d6d/namespaceProblemParameters.html#a36e4b27a055339709d0f982d004b622a">ProblemParameters::exact_soln</a></div><div class="ttdeci">void exact_soln(const double &amp;time, const Vector&lt; double &gt; &amp;x, Vector&lt; double &gt; &amp;soln)</div><div class="ttdef"><b>Definition:</b> unstructured_two_d_curved.cc:301</div></div>
<div class="ttc" id="anamespacecalibrate_html_a4dbebf21da853ac368a3a9af2fbab442"><div class="ttname"><a href="../../d9/d33/namespacecalibrate.html#a4dbebf21da853ac368a3a9af2fbab442">calibrate.error</a></div><div class="ttdeci">int error</div><div class="ttdef"><b>Definition:</b> calibrate.py:297</div></div>
<div class="ttc" id="anamespaceoomph_1_1QuadTreeNames_html_a9ac199adb82120cbaa47bf2365918ab9aabab2a070c062503375f8264f1b6d7d6"><div class="ttname"><a href="../../dc/d00/namespaceoomph_1_1QuadTreeNames.html#a9ac199adb82120cbaa47bf2365918ab9aabab2a070c062503375f8264f1b6d7d6">oomph::QuadTreeNames::W</a></div><div class="ttdeci">@ W</div><div class="ttdef"><b>Definition:</b> quadtree.h:63</div></div>
<div class="ttc" id="anamespaceplotDoE_html_a4758fc6194247f040938f29c863d21ee"><div class="ttname"><a href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">plotDoE.x</a></div><div class="ttdeci">list x</div><div class="ttdef"><b>Definition:</b> plotDoE.py:28</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d9/d33/namespacecalibrate.html#a4dbebf21da853ac368a3a9af2fbab442">calibrate::error</a>, <a class="el" href="../../d6/d6d/namespaceProblemParameters.html#a36e4b27a055339709d0f982d004b622a">ProblemParameters::exact_soln()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#a5dc62fc40b8ea5c195e7983180104fe6">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::interpolated_u_poisson()</a>, <a class="el" href="../../dc/da8/Jacobi__makeJacobi_8cpp.html#a4804f9d1c212b9655934738d0ae395ab">J</a>, <a class="el" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>, <a class="el" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a>, <a class="el" href="../../dc/d00/namespaceoomph_1_1QuadTreeNames.html#a9ac199adb82120cbaa47bf2365918ab9aabab2a070c062503375f8264f1b6d7d6">oomph::QuadTreeNames::W</a>, and <a class="el" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">plotDoE::x</a>.</p>

</div>
</div>
<a id="a22416de25b1a702e3303ee892782332c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22416de25b1a702e3303ee892782332c">&#9670;&nbsp;</a></span>fill_in_contribution_to_jacobian()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_POISSON_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html">PoissonElementWithSingularity</a>&lt; <a class="el" href="../../d2/d0a/classBASIC__POISSON__ELEMENT.html">BASIC_POISSON_ELEMENT</a> &gt;::fill_in_contribution_to_jacobian </td>
          <td>(</td>
          <td class="paramtype">Vector&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>residuals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d2/dbf/BenchSparseUtil_8h.html#aa5fbb9f8287afd9550c07e51340b8b49">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>jacobian</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Add the element's contribution to its residual vector and element Jacobian matrix (wrapper) </p>
<div class="fragment"><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160; {  </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  <span class="comment">//Call the generic routine with the flag set to 1</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  <a class="code" href="../../d8/db6/classPoissonElementWithSingularity.html#a35c37bfba86d40af0bfd3220b4fea968">fill_in_generic_residual_contribution_wrapped_poisson</a>(residuals,jacobian,1);</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160; }</div>
<div class="ttc" id="aclassPoissonElementWithSingularity_html_a35c37bfba86d40af0bfd3220b4fea968"><div class="ttname"><a href="../../d8/db6/classPoissonElementWithSingularity.html#a35c37bfba86d40af0bfd3220b4fea968">PoissonElementWithSingularity::fill_in_generic_residual_contribution_wrapped_poisson</a></div><div class="ttdeci">void fill_in_generic_residual_contribution_wrapped_poisson(Vector&lt; double &gt; &amp;residuals, DenseMatrix&lt; double &gt; &amp;jacobian, const unsigned &amp;flag)</div><div class="ttdoc">Overloaded fill-in function.</div><div class="ttdef"><b>Definition:</b> poisson_elements_with_singularity.h:657</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#a35c37bfba86d40af0bfd3220b4fea968">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::fill_in_generic_residual_contribution_wrapped_poisson()</a>.</p>

</div>
</div>
<a id="a54a13ba968a10b764b3b3fe1c282cb7e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54a13ba968a10b764b3b3fe1c282cb7e">&#9670;&nbsp;</a></span>fill_in_contribution_to_residuals()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_POISSON_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html">PoissonElementWithSingularity</a>&lt; <a class="el" href="../../d2/d0a/classBASIC__POISSON__ELEMENT.html">BASIC_POISSON_ELEMENT</a> &gt;::fill_in_contribution_to_residuals </td>
          <td>(</td>
          <td class="paramtype">Vector&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>residuals</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Add the element's contribution to its residual vector (wrapper) </p>
<div class="fragment"><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160; {</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  <span class="comment">//Call the generic residuals function with flag set to 0</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  <span class="comment">//using a dummy matrix argument</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  this-&gt;<a class="code" href="../../d8/db6/classPoissonElementWithSingularity.html#a35c37bfba86d40af0bfd3220b4fea968">fill_in_generic_residual_contribution_wrapped_poisson</a>(</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;   residuals,GeneralisedElement::Dummy_matrix,0);</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160; }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#a35c37bfba86d40af0bfd3220b4fea968">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::fill_in_generic_residual_contribution_wrapped_poisson()</a>.</p>

</div>
</div>
<a id="a35c37bfba86d40af0bfd3220b4fea968"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35c37bfba86d40af0bfd3220b4fea968">&#9670;&nbsp;</a></span>fill_in_generic_residual_contribution_wrapped_poisson()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_POISSON_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html">PoissonElementWithSingularity</a>&lt; <a class="el" href="../../d2/d0a/classBASIC__POISSON__ELEMENT.html">BASIC_POISSON_ELEMENT</a> &gt;::fill_in_generic_residual_contribution_wrapped_poisson </td>
          <td>(</td>
          <td class="paramtype">Vector&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>residuals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d2/dbf/BenchSparseUtil_8h.html#aa5fbb9f8287afd9550c07e51340b8b49">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>jacobian</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Overloaded fill-in function. </p>
<div class="fragment"><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160; {</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  <span class="comment">// Get the contribution from the underlying wrapped element first</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  BASIC_POISSON_ELEMENT::fill_in_generic_residual_contribution_poisson</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;   (residuals,jacobian,flag);</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160; </div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  <span class="comment">// Do all the singular functions satisfy laplace&#39;s eqn?</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  <span class="keywordtype">bool</span> all_singular_functions_satisfy_laplace_equation=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  </div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  <span class="comment">// Find the number of singularities</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  <span class="keywordtype">unsigned</span> n_sing = <a class="code" href="../../d8/db6/classPoissonElementWithSingularity.html#a9ecf0fc68a5677c41e950298c5cbf804">C_equation_elements_pt</a>.size();</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  </div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;  <span class="comment">//Index at which the poisson unknown is stored</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> u_nodal_index = this-&gt;u_index_poisson();</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160; </div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;  <span class="comment">// Find the dimension of the problem</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  <span class="keywordtype">unsigned</span> cached_dim=this-&gt;dim();</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  </div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  <span class="comment">//Find out how many nodes there are</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_node = this-&gt;nnode();</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  </div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  <span class="comment">// Find the local equation number of the additional unknowns</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  Vector&lt;int&gt; local_equation_number_C(n_sing);</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;n_sing;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;   {</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    local_equation_number_C[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] =</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;     this-&gt;external_local_eqn(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,0);</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="keywordflow">if</span> (!(<a class="code" href="../../d8/db6/classPoissonElementWithSingularity.html#a9ecf0fc68a5677c41e950298c5cbf804">C_equation_elements_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;          singular_function_satisfies_laplace_equation()))</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;     {</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;      all_singular_functions_satisfy_laplace_equation=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;     }</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;   }</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160; </div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;  <span class="comment">// Do we need to add the singular function&#39;s contribution to the</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  <span class="comment">// residuals or do they vanish by themselves (mathematically)</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  <span class="keywordflow">if</span> (!all_singular_functions_satisfy_laplace_equation)</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;   {</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    </div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <span class="comment">//Set up memory for the shape and test functions</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    Shape psi(n_node), <a class="code" href="../../d1/d62/namespaceEigen.html#ab92f68c35918b3afc48e0056a81ac1b3">test</a>(n_node);</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    DShape dpsidx(n_node,cached_dim), dtestdx(n_node,cached_dim);</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    </div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <span class="comment">//Set the value of n_intpt</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_intpt = this-&gt;integral_pt()-&gt;nweight();</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    </div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <span class="comment">//Integers to store the local equation and unknown numbers</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <span class="keywordtype">int</span> local_eqn=0;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    </div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <span class="comment">//Loop over the integration points</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ipt=0;ipt&lt;n_intpt;ipt++)</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;     </div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;     {</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;      <span class="comment">//Get the integral weight</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a> = this-&gt;integral_pt()-&gt;weight(ipt);</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      </div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;      <span class="comment">//Call the derivatives of the shape and test functions</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="../../dc/da8/Jacobi__makeJacobi_8cpp.html#a4804f9d1c212b9655934738d0ae395ab">J</a> = this-&gt;dshape_and_dtest_eulerian_at_knot_poisson(ipt,psi,dpsidx,</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                                                                 <a class="code" href="../../df/d04/namespacetest.html">test</a>,dtestdx);</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;      </div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;      <span class="comment">//Premultiply the weights and the Jacobian</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="../../dc/d00/namespaceoomph_1_1QuadTreeNames.html#a9ac199adb82120cbaa47bf2365918ab9aabab2a070c062503375f8264f1b6d7d6">W</a> = <a class="code" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a>*<a class="code" href="../../dc/da8/Jacobi__makeJacobi_8cpp.html#a4804f9d1c212b9655934738d0ae395ab">J</a>;</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;      </div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;      <span class="comment">//Calculate the global coordinate of the integration point</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;      Vector&lt;double&gt; interpolated_x(cached_dim,0.0);</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;      <span class="comment">// Loop over nodes</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++) </div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;       {</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;        <span class="comment">// Loop over directions</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>=0;<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>&lt;cached_dim;<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;         {</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;          interpolated_x[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>] += this-&gt;raw_nodal_position(l,<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>)*psi(l);</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;         }</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;       }</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160; </div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;      <span class="comment">// Precompute singular fcts</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;      Vector&lt;Vector&lt;double&gt; &gt; grad_u_bar_local(n_sing);</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;n_sing;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;       {</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;        grad_u_bar_local[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]=<a class="code" href="../../d8/db6/classPoissonElementWithSingularity.html#a468249b66dfb40fda1cf03797746a0ba">grad_u_bar</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,interpolated_x);</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;       }</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;      Vector&lt;Vector&lt;double&gt; &gt; grad_singular_function_local(n_sing);</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;n_sing;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;       {</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;        grad_singular_function_local[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]=<a class="code" href="../../d8/db6/classPoissonElementWithSingularity.html#afed94940e5be522f7d39d030f9e2d106">grad_singular_function</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,interpolated_x);</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;       }</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;      </div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;      <span class="comment">// Assemble residuals and Jacobian</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;      <span class="comment">//--------------------------------</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;      </div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;      <span class="comment">// The interior nodes</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;      <span class="comment">//-------------------</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;      </div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;      <span class="comment">// Loop over the test functions</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++)</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;       {</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        <span class="comment">//Get the local equation number</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        local_eqn = this-&gt;nodal_local_eqn(l,u_nodal_index);</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        </div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        <span class="comment">// If it is not pinned</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        <span class="keywordflow">if</span> (local_eqn &gt;= 0)</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;         {</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;          <span class="comment">// IF it&#39;s not a boundary condition</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;          <span class="keywordflow">if</span>(not(<a class="code" href="../../d8/db6/classPoissonElementWithSingularity.html#a883ac0f06f723647aa578269bebe7c69">Node_is_subject_to_dirichlet_bc</a>[l]))</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;           {</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;            <span class="comment">// Add the contribution of the additional unknowns to the residual</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;n_sing;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;             {</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;              <span class="keywordflow">if</span> (!(<a class="code" href="../../d8/db6/classPoissonElementWithSingularity.html#a9ecf0fc68a5677c41e950298c5cbf804">C_equation_elements_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                    singular_function_satisfies_laplace_equation()))</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;               {</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>=0;<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>&lt;cached_dim;<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>++)</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                 {</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                  residuals[local_eqn] += </div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                   grad_u_bar_local[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>]*dtestdx(l,<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>)*<a class="code" href="../../dc/d00/namespaceoomph_1_1QuadTreeNames.html#a9ac199adb82120cbaa47bf2365918ab9aabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                 }</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;               }</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;             }</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;            </div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;            <span class="comment">// Calculate the jacobian</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;            <span class="comment">//-----------------------</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;            <span class="keywordflow">if</span>(flag)</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;             {</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;              <span class="comment">// Loop over the singularities and add the </span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;              <span class="comment">// contributions of the additional </span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;              <span class="comment">// unknowns associated with them to the </span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;              <span class="comment">// jacobian if they are not pinned</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;n_sing;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;               {</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                <span class="keywordflow">if</span> (!(<a class="code" href="../../d8/db6/classPoissonElementWithSingularity.html#a9ecf0fc68a5677c41e950298c5cbf804">C_equation_elements_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                      singular_function_satisfies_laplace_equation()))</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                 {</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                  <span class="keywordflow">if</span> (local_equation_number_C[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]&gt;=0)</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                   {</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> d=0;d&lt;cached_dim;d++)</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                     {</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                      jacobian(local_eqn,local_equation_number_C[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                       += grad_singular_function_local[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>][d]*</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                       dtestdx(l,d)*<a class="code" href="../../dc/d00/namespaceoomph_1_1QuadTreeNames.html#a9ac199adb82120cbaa47bf2365918ab9aabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                     }</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                   }</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                 }</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;               }</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;             }</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;           }</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;         }</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;       } <span class="comment">// end of loop over shape functions</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;      </div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;     } <span class="comment">// End of loop over integration points</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    </div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;   }</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;  </div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  <span class="comment">// The Dirichlet nodes</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;  <span class="comment">//--------------------</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;  </div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;  <span class="comment">// Loop over the nodes to see if there is a node subject to</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;  <span class="comment">// Dirichlet BC</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>=0;<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>&lt;n_node;<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;   {</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    <span class="comment">// If it is a dirichlet boundary condition</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d8/db6/classPoissonElementWithSingularity.html#a883ac0f06f723647aa578269bebe7c69">Node_is_subject_to_dirichlet_bc</a>[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>])</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;     {</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;      <span class="comment">// Find the global coordinate of the node</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;      Vector&lt;double&gt; global_coordinate_boundary_node(cached_dim);</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> d=0;d&lt;cached_dim;d++)</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;       {</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;        global_coordinate_boundary_node[d] = this-&gt;raw_nodal_position(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>,d);</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;       }</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;      </div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;      <span class="comment">// If it is not pinned</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;      <span class="keywordtype">int</span> local_eqn_number_boundary_node = </div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;       this-&gt;nodal_local_eqn(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>,u_nodal_index);</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;      <span class="keywordflow">if</span> (local_eqn_number_boundary_node &gt;= 0)</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;       {</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        <span class="comment">// Add the contribution of the node unknown to the residual</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        residuals[local_eqn_number_boundary_node] = </div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        this-&gt;raw_nodal_value(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>,u_nodal_index);</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        </div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        <span class="comment">// Add the contribution of the additional unknowns to the residual</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;n_sing;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;         {</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;          residuals[local_eqn_number_boundary_node] += </div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;           <a class="code" href="../../d8/db6/classPoissonElementWithSingularity.html#add71781fd885d3692f4c7893684f3b82">u_bar</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,global_coordinate_boundary_node);</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;         }</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        </div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;        <span class="comment">// Substract the value imposed by the Dirichlet BC from the residual</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;        residuals[local_eqn_number_boundary_node] -= <a class="code" href="../../d8/db6/classPoissonElementWithSingularity.html#adee3596c14fcbdfe051941c47cc537ea">Imposed_value_at_node</a>[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>];</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        </div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;        <span class="keywordflow">if</span> (flag)</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;         {</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;          <span class="comment">// Loop over the nodes</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++)</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;           {</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;            <span class="comment">// Find the equation number of the node</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;            <span class="keywordtype">int</span> local_unknown = this-&gt;nodal_local_eqn(l,u_nodal_index);</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160; </div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;            <span class="comment">// If it is not pinned</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;            <span class="keywordflow">if</span> (local_unknown &gt;=0)</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;             {</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;              <span class="comment">// Put to 0 the corresponding jacobian component</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;              jacobian(local_eqn_number_boundary_node,local_unknown)=0.0;</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;             }</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;           }</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;            </div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;          <span class="comment">// Find the contribution of the node to the local jacobian</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;          jacobian(local_eqn_number_boundary_node,</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                   local_eqn_number_boundary_node) += 1.0;</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160; </div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;          <span class="comment">// Loop over the singularities</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;n_sing;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;           {</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;            <span class="comment">// Find the contribution of the additional unknowns to the jacobian</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;            <span class="keywordtype">int</span> local_unknown=local_equation_number_C[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;            <span class="keywordflow">if</span> (local_unknown&gt;=0)</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;             {</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;              jacobian(local_eqn_number_boundary_node,</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                       local_unknown) += </div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;               <a class="code" href="../../d8/db6/classPoissonElementWithSingularity.html#a27854d2d8566d67cf00efad078133949">singular_function</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,global_coordinate_boundary_node);</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;             }</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;           }</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;             </div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;         }</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;       } <span class="comment">// End of check of the pin status of the node</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;     } <span class="comment">// End of check if the node is subject to Dirichlet BC-</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;   } <span class="comment">// End of loop over the nodes</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160; } <span class="comment">// End of function</span></div>
<div class="ttc" id="aclassPoissonElementWithSingularity_html_a27854d2d8566d67cf00efad078133949"><div class="ttname"><a href="../../d8/db6/classPoissonElementWithSingularity.html#a27854d2d8566d67cf00efad078133949">PoissonElementWithSingularity::singular_function</a></div><div class="ttdeci">double singular_function(const unsigned &amp;i, const Vector&lt; double &gt; &amp;x) const</div><div class="ttdoc">Evaluate i-th &quot;raw&quot; singular function at Eulerian position x.</div><div class="ttdef"><b>Definition:</b> poisson_elements_with_singularity.h:428</div></div>
<div class="ttc" id="aclassPoissonElementWithSingularity_html_a468249b66dfb40fda1cf03797746a0ba"><div class="ttname"><a href="../../d8/db6/classPoissonElementWithSingularity.html#a468249b66dfb40fda1cf03797746a0ba">PoissonElementWithSingularity::grad_u_bar</a></div><div class="ttdeci">Vector&lt; double &gt; grad_u_bar(const unsigned i, const Vector&lt; double &gt; &amp;x) const</div><div class="ttdef"><b>Definition:</b> poisson_elements_with_singularity.h:435</div></div>
<div class="ttc" id="aclassPoissonElementWithSingularity_html_add71781fd885d3692f4c7893684f3b82"><div class="ttname"><a href="../../d8/db6/classPoissonElementWithSingularity.html#add71781fd885d3692f4c7893684f3b82">PoissonElementWithSingularity::u_bar</a></div><div class="ttdeci">double u_bar(const unsigned &amp;i, const Vector&lt; double &gt; &amp;x) const</div><div class="ttdef"><b>Definition:</b> poisson_elements_with_singularity.h:422</div></div>
<div class="ttc" id="aclassPoissonElementWithSingularity_html_afed94940e5be522f7d39d030f9e2d106"><div class="ttname"><a href="../../d8/db6/classPoissonElementWithSingularity.html#afed94940e5be522f7d39d030f9e2d106">PoissonElementWithSingularity::grad_singular_function</a></div><div class="ttdeci">Vector&lt; double &gt; grad_singular_function(const unsigned &amp;i, const Vector&lt; double &gt; &amp;x) const</div><div class="ttdoc">Evaluate the gradient of the i-th &quot;raw&quot; singular at Eulerian position x.</div><div class="ttdef"><b>Definition:</b> poisson_elements_with_singularity.h:441</div></div>
<div class="ttc" id="alevel2__impl_8h_html_ad46ea6bf5745e72b985b11878e46a45d"><div class="ttname"><a href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a></div><div class="ttdeci">char char char int int * k</div><div class="ttdef"><b>Definition:</b> level2_impl.h:374</div></div>
<div class="ttc" id="anamespaceEigen_html_ab92f68c35918b3afc48e0056a81ac1b3"><div class="ttname"><a href="../../d1/d62/namespaceEigen.html#ab92f68c35918b3afc48e0056a81ac1b3">Eigen::test</a></div><div class="ttdeci">squared absolute sa ArrayBase::abs2 DOXCOMMA MatrixBase::cwiseAbs2 sa Eigen::abs2 DOXCOMMA Eigen::pow DOXCOMMA ArrayBase::square nearest sa Eigen::floor DOXCOMMA Eigen::ceil DOXCOMMA ArrayBase::round nearest integer not less than the given sa Eigen::floor DOXCOMMA ArrayBase::ceil not a number test</div><div class="ttdef"><b>Definition:</b> GlobalFunctions.h:109</div></div>
<div class="ttc" id="anamespacetest_html"><div class="ttname"><a href="../../df/d04/namespacetest.html">test</a></div><div class="ttdef"><b>Definition:</b> indexed_view.cpp:20</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#a9ecf0fc68a5677c41e950298c5cbf804">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::C_equation_elements_pt</a>, <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#afed94940e5be522f7d39d030f9e2d106">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::grad_singular_function()</a>, <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#a468249b66dfb40fda1cf03797746a0ba">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::grad_u_bar()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#adee3596c14fcbdfe051941c47cc537ea">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::Imposed_value_at_node</a>, <a class="el" href="../../dc/da8/Jacobi__makeJacobi_8cpp.html#a4804f9d1c212b9655934738d0ae395ab">J</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>, <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#a883ac0f06f723647aa578269bebe7c69">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::Node_is_subject_to_dirichlet_bc</a>, <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#a27854d2d8566d67cf00efad078133949">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::singular_function()</a>, <a class="el" href="../../d1/d62/namespaceEigen.html#ab92f68c35918b3afc48e0056a81ac1b3">Eigen::test</a>, <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#add71781fd885d3692f4c7893684f3b82">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::u_bar()</a>, <a class="el" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a>, and <a class="el" href="../../dc/d00/namespaceoomph_1_1QuadTreeNames.html#a9ac199adb82120cbaa47bf2365918ab9aabab2a070c062503375f8264f1b6d7d6">oomph::QuadTreeNames::W</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#a22416de25b1a702e3303ee892782332c">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::fill_in_contribution_to_jacobian()</a>, and <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#a54a13ba968a10b764b3b3fe1c282cb7e">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::fill_in_contribution_to_residuals()</a>.</p>

</div>
</div>
<a id="afed94940e5be522f7d39d030f9e2d106"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afed94940e5be522f7d39d030f9e2d106">&#9670;&nbsp;</a></span>grad_singular_function()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_POISSON_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Vector&lt;<a class="el" href="../../df/de6/classdouble.html">double</a>&gt; <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html">PoissonElementWithSingularity</a>&lt; <a class="el" href="../../d2/d0a/classBASIC__POISSON__ELEMENT.html">BASIC_POISSON_ELEMENT</a> &gt;::grad_singular_function </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Vector&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Evaluate the gradient of the i-th "raw" singular at Eulerian position x. </p>
<div class="fragment"><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  {</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d8/db6/classPoissonElementWithSingularity.html#a9ecf0fc68a5677c41e950298c5cbf804">C_equation_elements_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;grad_singular_function(<a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>);</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#a9ecf0fc68a5677c41e950298c5cbf804">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::C_equation_elements_pt</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, and <a class="el" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">plotDoE::x</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#a35c37bfba86d40af0bfd3220b4fea968">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::fill_in_generic_residual_contribution_wrapped_poisson()</a>.</p>

</div>
</div>
<a id="a468249b66dfb40fda1cf03797746a0ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a468249b66dfb40fda1cf03797746a0ba">&#9670;&nbsp;</a></span>grad_u_bar()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_POISSON_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Vector&lt;<a class="el" href="../../df/de6/classdouble.html">double</a>&gt; <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html">PoissonElementWithSingularity</a>&lt; <a class="el" href="../../d2/d0a/classBASIC__POISSON__ELEMENT.html">BASIC_POISSON_ELEMENT</a> &gt;::grad_u_bar </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Vector&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Evaluate the gradient the i-th singular (incl. the amplitude ) at Eulerian position x </p>
<div class="fragment"><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  {</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d8/db6/classPoissonElementWithSingularity.html#a9ecf0fc68a5677c41e950298c5cbf804">C_equation_elements_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;grad_u_bar(<a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>);</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#a9ecf0fc68a5677c41e950298c5cbf804">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::C_equation_elements_pt</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, and <a class="el" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">plotDoE::x</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#a35c37bfba86d40af0bfd3220b4fea968">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::fill_in_generic_residual_contribution_wrapped_poisson()</a>.</p>

</div>
</div>
<a id="acee90933d719ca2d9807f81be46008aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acee90933d719ca2d9807f81be46008aa">&#9670;&nbsp;</a></span>impose_dirichlet_bc_on_node()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_POISSON_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html">PoissonElementWithSingularity</a>&lt; <a class="el" href="../../d2/d0a/classBASIC__POISSON__ELEMENT.html">BASIC_POISSON_ELEMENT</a> &gt;::impose_dirichlet_bc_on_node </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>j</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Impose Dirichlet BC on sum of FE solution and u_bar on j-th local node </p>
<div class="fragment"><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; {</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <a class="code" href="../../d8/db6/classPoissonElementWithSingularity.html#a883ac0f06f723647aa578269bebe7c69">Node_is_subject_to_dirichlet_bc</a>[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160; }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, and <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#a883ac0f06f723647aa578269bebe7c69">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::Node_is_subject_to_dirichlet_bc</a>.</p>

</div>
</div>
<a id="a5dc62fc40b8ea5c195e7983180104fe6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5dc62fc40b8ea5c195e7983180104fe6">&#9670;&nbsp;</a></span>interpolated_u_poisson()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_POISSON_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html">PoissonElementWithSingularity</a>&lt; <a class="el" href="../../d2/d0a/classBASIC__POISSON__ELEMENT.html">BASIC_POISSON_ELEMENT</a> &gt;::interpolated_u_poisson </td>
          <td>(</td>
          <td class="paramtype">const Vector&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Overloaded version including the singular contributions. </p>
<div class="fragment"><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160; {</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  <span class="comment">//Find number of nodes</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_node = this-&gt;nnode();</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  <span class="comment">//Get the index at which the poisson unknown is stored</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> u_nodal_index = this-&gt;u_index_poisson();</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <span class="comment">//Local shape function</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  Shape psi(n_node);</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  </div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <span class="comment">//Find values of shape function</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  this-&gt;<a class="code" href="../../d6/d53/namespaceoomph_1_1OneDimLagrange.html#a117f8b892dc89989ecdad99ff261e120">shape</a>(s,psi);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  </div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  <span class="comment">//Initialise value of u</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  <span class="keywordtype">double</span> interpolated_u = 0.0;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <span class="comment">// Calculate the global coordinate associated to s</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  <span class="keywordtype">unsigned</span> cached_dim=this-&gt;dim();</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  Vector&lt;double&gt; <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>(cached_dim,0.0);</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160; </div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  <span class="comment">// Add the contribution of u_FE</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <span class="comment">//Loop over the local nodes and sum</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++) </div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;   {</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    interpolated_u += this-&gt;nodal_value(l,u_nodal_index)*psi[l];</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;cached_dim;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;     {</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]+=this-&gt;raw_nodal_position(l,<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)*psi(l);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;     }</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;   }</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    </div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  <span class="comment">// Loop over the singularities</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <span class="keywordtype">unsigned</span> n_sing=<a class="code" href="../../d8/db6/classPoissonElementWithSingularity.html#a9ecf0fc68a5677c41e950298c5cbf804">C_equation_elements_pt</a>.size();</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;n_sing;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;   {</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="comment">// Add the contribution of ubari</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    interpolated_u += <a class="code" href="../../d8/db6/classPoissonElementWithSingularity.html#add71781fd885d3692f4c7893684f3b82">u_bar</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>);</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;   }</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  <span class="keywordflow">return</span>(interpolated_u);</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160; }</div>
<div class="ttc" id="anamespaceoomph_1_1OneDimLagrange_html_a117f8b892dc89989ecdad99ff261e120"><div class="ttname"><a href="../../d6/d53/namespaceoomph_1_1OneDimLagrange.html#a117f8b892dc89989ecdad99ff261e120">oomph::OneDimLagrange::shape</a></div><div class="ttdeci">void shape(const double &amp;s, double *Psi)</div><div class="ttdef"><b>Definition:</b> shape.h:564</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#a9ecf0fc68a5677c41e950298c5cbf804">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::C_equation_elements_pt</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../d6/d53/namespaceoomph_1_1OneDimLagrange.html#a117f8b892dc89989ecdad99ff261e120">oomph::OneDimLagrange::shape()</a>, <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#add71781fd885d3692f4c7893684f3b82">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::u_bar()</a>, and <a class="el" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">plotDoE::x</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#acbb71ceae9bfbb41043bb2db37228c1c">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::compute_error()</a>, and <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#aef5e585bc1042cde68d2d4a8ef99a5b2">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::output()</a>.</p>

</div>
</div>
<a id="ad1f6a821acb69c656618578e54b29401"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1f6a821acb69c656618578e54b29401">&#9670;&nbsp;</a></span>interpolated_u_poisson_fe_only()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_POISSON_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html">PoissonElementWithSingularity</a>&lt; <a class="el" href="../../d2/d0a/classBASIC__POISSON__ELEMENT.html">BASIC_POISSON_ELEMENT</a> &gt;::interpolated_u_poisson_fe_only </td>
          <td>(</td>
          <td class="paramtype">const Vector&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Return FE representation of solution WITHOUT singular contributions at local coordinate s </p>
<div class="fragment"><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160; {</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  <span class="comment">//Find number of nodes</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_node = this-&gt;nnode();</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  <span class="comment">//Get the index at which the poisson unknown is stored</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> u_nodal_index = this-&gt;u_index_poisson();</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  <span class="comment">//Local shape function</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  Shape psi(n_node);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  <span class="comment">//Find values of shape function</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  this-&gt;<a class="code" href="../../d6/d53/namespaceoomph_1_1OneDimLagrange.html#a117f8b892dc89989ecdad99ff261e120">shape</a>(s,psi);</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  <span class="comment">//Initialise value of u</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <span class="keywordtype">double</span> interpolated_u = 0.0;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  </div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  <span class="comment">// Add the contribution of u_FE</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  <span class="comment">//Loop over the local nodes and sum</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++) </div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;   {</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    interpolated_u += this-&gt;nodal_value(l,u_nodal_index)*psi[l];</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;   }</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  </div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  <span class="keywordflow">return</span> interpolated_u;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160; }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/d53/namespaceoomph_1_1OneDimLagrange.html#a117f8b892dc89989ecdad99ff261e120">oomph::OneDimLagrange::shape()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#aef5e585bc1042cde68d2d4a8ef99a5b2">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::output()</a>.</p>

</div>
</div>
<a id="aef5e585bc1042cde68d2d4a8ef99a5b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef5e585bc1042cde68d2d4a8ef99a5b2">&#9670;&nbsp;</a></span>output()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_POISSON_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html">PoissonElementWithSingularity</a>&lt; <a class="el" href="../../d2/d0a/classBASIC__POISSON__ELEMENT.html">BASIC_POISSON_ELEMENT</a> &gt;::output </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>outfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>nplot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Overloaded output fct: x, y [,z], u, u_fe_only, u-u_fe_only. </p>
<div class="fragment"><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160; {</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  <span class="comment">// Find the dimension of the problem</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  <span class="keywordtype">unsigned</span> cached_dim = this-&gt;dim();</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160; </div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  <span class="comment">//Vector of local coordinates</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  Vector&lt;double&gt; <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>(cached_dim);</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160; </div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  <span class="comment">// Tecplot header info</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  outfile &lt;&lt; this-&gt;tecplot_zone_string(nplot);</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160; </div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <span class="comment">// Loop over plot points</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  <span class="keywordtype">unsigned</span> num_plot_points=this-&gt;nplot_points(nplot);</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> iplot=0;iplot&lt;num_plot_points;iplot++)</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;   {</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;   </div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="comment">// Get local coordinates of plot point</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    this-&gt;get_s_plot(iplot,nplot,<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>);</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160; </div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    Vector&lt;double&gt; <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>(cached_dim);</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;cached_dim;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++) </div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;     {</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;      outfile &lt;&lt; this-&gt;interpolated_x(<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>,<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;      <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = this-&gt;interpolated_x(<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>,<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;     }</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    </div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    outfile &lt;&lt; <a class="code" href="../../d8/db6/classPoissonElementWithSingularity.html#a5dc62fc40b8ea5c195e7983180104fe6">interpolated_u_poisson</a>(<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;            &lt;&lt; <a class="code" href="../../d8/db6/classPoissonElementWithSingularity.html#ad1f6a821acb69c656618578e54b29401">interpolated_u_poisson_fe_only</a>(<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;            &lt;&lt; <a class="code" href="../../d8/db6/classPoissonElementWithSingularity.html#a5dc62fc40b8ea5c195e7983180104fe6">interpolated_u_poisson</a>(<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>)-<a class="code" href="../../d8/db6/classPoissonElementWithSingularity.html#ad1f6a821acb69c656618578e54b29401">interpolated_u_poisson_fe_only</a>(<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>)</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;            &lt;&lt; std::endl;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;   </div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;   }</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160; </div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  <span class="comment">// Write tecplot footer (e.g. FE connectivity lists)</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  this-&gt;write_tecplot_zone_footer(outfile,nplot);</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160; }</div>
<div class="ttc" id="aclassPoissonElementWithSingularity_html_ad1f6a821acb69c656618578e54b29401"><div class="ttname"><a href="../../d8/db6/classPoissonElementWithSingularity.html#ad1f6a821acb69c656618578e54b29401">PoissonElementWithSingularity::interpolated_u_poisson_fe_only</a></div><div class="ttdeci">double interpolated_u_poisson_fe_only(const Vector&lt; double &gt; &amp;s) const</div><div class="ttdef"><b>Definition:</b> poisson_elements_with_singularity.h:450</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#a5dc62fc40b8ea5c195e7983180104fe6">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::interpolated_u_poisson()</a>, <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#ad1f6a821acb69c656618578e54b29401">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::interpolated_u_poisson_fe_only()</a>, <a class="el" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>, and <a class="el" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">plotDoE::x</a>.</p>

</div>
</div>
<a id="a8f55f626c9d117d05a3f313ae6628459"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f55f626c9d117d05a3f313ae6628459">&#9670;&nbsp;</a></span>set_dirichlet_value_on_node()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_POISSON_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html">PoissonElementWithSingularity</a>&lt; <a class="el" href="../../d2/d0a/classBASIC__POISSON__ELEMENT.html">BASIC_POISSON_ELEMENT</a> &gt;::set_dirichlet_value_on_node </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Specify Dirichlet boundary value for j-th local node. </p>
<div class="fragment"><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160; {</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <a class="code" href="../../d8/db6/classPoissonElementWithSingularity.html#adee3596c14fcbdfe051941c47cc537ea">Imposed_value_at_node</a>[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>] = <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; }</div>
<div class="ttc" id="anamespaceEigen_html_a242ccf5e6e80154bbf36d63acf6e458a"><div class="ttname"><a href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">Eigen::value</a></div><div class="ttdeci">squared absolute value</div><div class="ttdef"><b>Definition:</b> GlobalFunctions.h:87</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#adee3596c14fcbdfe051941c47cc537ea">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::Imposed_value_at_node</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, and <a class="el" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">Eigen::value</a>.</p>

</div>
</div>
<a id="a27854d2d8566d67cf00efad078133949"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27854d2d8566d67cf00efad078133949">&#9670;&nbsp;</a></span>singular_function()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_POISSON_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html">PoissonElementWithSingularity</a>&lt; <a class="el" href="../../d2/d0a/classBASIC__POISSON__ELEMENT.html">BASIC_POISSON_ELEMENT</a> &gt;::singular_function </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Vector&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Evaluate i-th "raw" singular function at Eulerian position x. </p>
<div class="fragment"><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160; {</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d8/db6/classPoissonElementWithSingularity.html#a9ecf0fc68a5677c41e950298c5cbf804">C_equation_elements_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;singular_function(<a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>);</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160; }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#a9ecf0fc68a5677c41e950298c5cbf804">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::C_equation_elements_pt</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, and <a class="el" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">plotDoE::x</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#a35c37bfba86d40af0bfd3220b4fea968">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::fill_in_generic_residual_contribution_wrapped_poisson()</a>.</p>

</div>
</div>
<a id="add71781fd885d3692f4c7893684f3b82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add71781fd885d3692f4c7893684f3b82">&#9670;&nbsp;</a></span>u_bar()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_POISSON_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html">PoissonElementWithSingularity</a>&lt; <a class="el" href="../../d2/d0a/classBASIC__POISSON__ELEMENT.html">BASIC_POISSON_ELEMENT</a> &gt;::u_bar </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Vector&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Evaluate i-th u_bar function (i.e. i-th singular incl. the amplitude) function at Eulerian position x </p>
<div class="fragment"><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160; {</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d8/db6/classPoissonElementWithSingularity.html#a9ecf0fc68a5677c41e950298c5cbf804">C_equation_elements_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;u_bar(<a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160; }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#a9ecf0fc68a5677c41e950298c5cbf804">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::C_equation_elements_pt</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, and <a class="el" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">plotDoE::x</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#a35c37bfba86d40af0bfd3220b4fea968">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::fill_in_generic_residual_contribution_wrapped_poisson()</a>, and <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#a5dc62fc40b8ea5c195e7983180104fe6">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::interpolated_u_poisson()</a>.</p>

</div>
</div>
<a id="a4ede36561509e5b0a5fa890b13e40275"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ede36561509e5b0a5fa890b13e40275">&#9670;&nbsp;</a></span>undo_dirichlet_bc_on_all_nodes()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_POISSON_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html">PoissonElementWithSingularity</a>&lt; <a class="el" href="../../d2/d0a/classBASIC__POISSON__ELEMENT.html">BASIC_POISSON_ELEMENT</a> &gt;::undo_dirichlet_bc_on_all_nodes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Undo Dirichlet BCs on all nodes. </p>
<div class="fragment"><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; {</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <span class="keywordtype">unsigned</span> n_node = this-&gt;nnode();</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>=0;<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>&lt;n_node;<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;   {</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <a class="code" href="../../d8/db6/classPoissonElementWithSingularity.html#aa4c67306e1e58b8d3d1789a9439ac2c1">undo_dirichlet_bc_on_node</a>(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;   }</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160; }</div>
<div class="ttc" id="aclassPoissonElementWithSingularity_html_aa4c67306e1e58b8d3d1789a9439ac2c1"><div class="ttname"><a href="../../d8/db6/classPoissonElementWithSingularity.html#aa4c67306e1e58b8d3d1789a9439ac2c1">PoissonElementWithSingularity::undo_dirichlet_bc_on_node</a></div><div class="ttdeci">void undo_dirichlet_bc_on_node(const unsigned &amp;j)</div><div class="ttdoc">Undo Dirichlet BCs on jth node.</div><div class="ttdef"><b>Definition:</b> poisson_elements_with_singularity.h:369</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, and <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#aa4c67306e1e58b8d3d1789a9439ac2c1">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::undo_dirichlet_bc_on_node()</a>.</p>

</div>
</div>
<a id="aa4c67306e1e58b8d3d1789a9439ac2c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4c67306e1e58b8d3d1789a9439ac2c1">&#9670;&nbsp;</a></span>undo_dirichlet_bc_on_node()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_POISSON_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html">PoissonElementWithSingularity</a>&lt; <a class="el" href="../../d2/d0a/classBASIC__POISSON__ELEMENT.html">BASIC_POISSON_ELEMENT</a> &gt;::undo_dirichlet_bc_on_node </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>j</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Undo Dirichlet BCs on jth node. </p>
<div class="fragment"><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160; {</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <a class="code" href="../../d8/db6/classPoissonElementWithSingularity.html#a883ac0f06f723647aa578269bebe7c69">Node_is_subject_to_dirichlet_bc</a>[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160; }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, and <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#a883ac0f06f723647aa578269bebe7c69">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::Node_is_subject_to_dirichlet_bc</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#a4ede36561509e5b0a5fa890b13e40275">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::undo_dirichlet_bc_on_all_nodes()</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a9ecf0fc68a5677c41e950298c5cbf804"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ecf0fc68a5677c41e950298c5cbf804">&#9670;&nbsp;</a></span>C_equation_elements_pt</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_POISSON_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Vector&lt;<a class="el" href="../../da/d17/classSingularPoissonSolutionElement.html">SingularPoissonSolutionElement</a>&lt;<a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html">PoissonElementWithSingularity</a> &lt;<a class="el" href="../../d2/d0a/classBASIC__POISSON__ELEMENT.html">BASIC_POISSON_ELEMENT</a>&gt; &gt;*&gt; <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html">PoissonElementWithSingularity</a>&lt; <a class="el" href="../../d2/d0a/classBASIC__POISSON__ELEMENT.html">BASIC_POISSON_ELEMENT</a> &gt;::C_equation_elements_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Vector of pointers to SingularPoissonSolutionElement objects. </p>

<p class="reference">Referenced by <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#a60989f3b18af6c40fefd958c8f0fe994">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::add_c_equation_element_pt()</a>, <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#aae23e1c8879b4a4e9f3e32b85493cf80">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::c_equation_elements_pt()</a>, <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#a35c37bfba86d40af0bfd3220b4fea968">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::fill_in_generic_residual_contribution_wrapped_poisson()</a>, <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#afed94940e5be522f7d39d030f9e2d106">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::grad_singular_function()</a>, <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#a468249b66dfb40fda1cf03797746a0ba">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::grad_u_bar()</a>, <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#a5dc62fc40b8ea5c195e7983180104fe6">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::interpolated_u_poisson()</a>, <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#a27854d2d8566d67cf00efad078133949">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::singular_function()</a>, and <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#add71781fd885d3692f4c7893684f3b82">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::u_bar()</a>.</p>

</div>
</div>
<a id="adee3596c14fcbdfe051941c47cc537ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adee3596c14fcbdfe051941c47cc537ea">&#9670;&nbsp;</a></span>Imposed_value_at_node</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_POISSON_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Vector&lt;<a class="el" href="../../df/de6/classdouble.html">double</a>&gt; <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html">PoissonElementWithSingularity</a>&lt; <a class="el" href="../../d2/d0a/classBASIC__POISSON__ELEMENT.html">BASIC_POISSON_ELEMENT</a> &gt;::Imposed_value_at_node</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Imposed value at nodes that are subject to Dirichlet BC [size = number of nodes; initialised to zero] </p>

<p class="reference">Referenced by <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#a35c37bfba86d40af0bfd3220b4fea968">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::fill_in_generic_residual_contribution_wrapped_poisson()</a>, <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#a6bda910e96c7296cdf81ec22154acaa1">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::PoissonElementWithSingularity()</a>, and <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#a8f55f626c9d117d05a3f313ae6628459">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::set_dirichlet_value_on_node()</a>.</p>

</div>
</div>
<a id="a883ac0f06f723647aa578269bebe7c69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a883ac0f06f723647aa578269bebe7c69">&#9670;&nbsp;</a></span>Node_is_subject_to_dirichlet_bc</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_POISSON_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt;<a class="el" href="../../d9/db9/classbool.html">bool</a>&gt; <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html">PoissonElementWithSingularity</a>&lt; <a class="el" href="../../d2/d0a/classBASIC__POISSON__ELEMENT.html">BASIC_POISSON_ELEMENT</a> &gt;::Node_is_subject_to_dirichlet_bc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Boolean indicating which node is subject to Dirichlet BC [size = number of nodes; initialised to false] </p>

<p class="reference">Referenced by <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#a35c37bfba86d40af0bfd3220b4fea968">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::fill_in_generic_residual_contribution_wrapped_poisson()</a>, <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#acee90933d719ca2d9807f81be46008aa">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::impose_dirichlet_bc_on_node()</a>, <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#a6bda910e96c7296cdf81ec22154acaa1">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::PoissonElementWithSingularity()</a>, and <a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html#aa4c67306e1e58b8d3d1789a9439ac2c1">PoissonElementWithSingularity&lt; BASIC_POISSON_ELEMENT &gt;::undo_dirichlet_bc_on_node()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="../../d2/d58/poisson__elements__with__singularity_8h_source.html">poisson_elements_with_singularity.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../d8/db6/classPoissonElementWithSingularity.html">PoissonElementWithSingularity</a></li>
    <li class="footer">Generated on Wed Aug 27 2025 17:05:36 for MercuryDPM by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
