<!-- HTML header for doxygen 1.8.18-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MercuryDPM: Basic classes in MercuryDPM</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../MDPM.css" rel="stylesheet" type="text/css"/>
<link href="../../codeLabels.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-fork-corner.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-dropdown-version.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../MDPM-fragment-copy-button.js"></script>
<script type="text/javascript">
DoxygenAwesomeFragmentCopyButton.init()
</script>
<script type="text/javascript" src="../../MDPM-paragraph-link.js"></script>
<script type="text/javascript">
DoxygenAwesomeParagraphLink.init()
</script>
<script type="text/javascript" src="../../MDPM-interactive-toc.js"></script>
<script type="text/javascript">
DoxygenAwesomeInteractiveToc.init()
</script>
<script type="text/javascript" src="../../MDPM-darkmode-toggle.js"></script>
<script type="text/javascript">
DoxygenAwesomeDarkModeToggle.init()
</script>
</head>
<body>
  <div id="bitbucket-corner">
   <a href="https://bitbucket.org/mercurydpm/mercurydpm/src/master/" target="_blank" id="fork-corner" class="fork-corner fc-pos-tr fc-animate fc-theme-bitbucket"></a>
  </div>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../mercury-logo-chosen-light-slogan.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"> <!--MercuryDPM--!>
   <!-- BEGIN version select -->
   <div class="dropdown" id="projectnumber">
    <button class="dropbtn">v1.0</button>
    <div class="dropdown-content">
    </div>
   </div>
   <script type="text/javascript" src="../../MDPM-dropdown-version.js"></script>
<!-- END version select -->
   <!--&#160;<span id="projectnumber">revision: v1.0</span>-->
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<script type="text/javascript" src="../../MDPM-fork-corner.js"></script>
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d8/d3a/Basics.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Basic classes in MercuryDPM </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md4">Basic components of a DPM simulation</a><ul><li class="level2"><a href="#autotoc_md5">Variables</a><ul><li class="level3"><a href="#autotoc_md6">Global variables</a></li>
<li class="level3"><a href="#autotoc_md7">Particles</a></li>
<li class="level3"><a href="#autotoc_md8">Walls</a></li>
<li class="level3"><a href="#autotoc_md9">Boundaries</a></li>
<li class="level3"><a href="#autotoc_md10">Species</a></li>
<li class="level3"><a href="#autotoc_md11">Interactions</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p>This page provides a short overview of the mathematics and models used in the code. We first introduce the basic components of a DPM simulation (global parameters and variables, properties of particles, walls, boundaries, force laws and interactions), and provide the notation used henceforth. Then we explain the basic steps taken in each simulation (setting initial conditions, looping through time, writing data). The document is structured similarly to the code, so the user can easily relate the relevant classes with their purpose. Throughout this text, we include references to the relevant classes and functions, so the user can view the implementation.</p>
<h1><a class="anchor" id="autotoc_md4"></a>
Basic components of a DPM simulation</h1>
<p>In its most basic implementation, a DPM simulation simulates the movement of a set of particles \(P_i,\ \ i=1,\dots,N\), each of which is subject to body forces \(\vec f_i^\mathrm{body}\) and interacts with other particles via interaction forces \(\vec f_{ij}\), and torques \(\vec t_{ij},\ \ i=1,\dots,N_\mathrm{interaction}\).</p>
<p>While the body forces are assumed to act in the particle's center of mass \(\vec r_i\), the interaction forces act at the contact point \(\vec c_{ij}\) between the particles. Thus, each particle is subjected to the total force and torque </p><p class="formulaDsp">
\[\vec f_i = \vec f_i^\mathrm{body}+\sum_{j=1}^N \vec f_{ij},\quad \vec t_i = \sum_{j=1}^N \vec t_{ij} + (\vec{c}_{ij}-\vec{r}_i)\times \vec f_{ij}.\]
</p>
 <div class="image">
<img src="../../PointsAndForces.png" alt=""/>
<div class="caption">
Sketch of two contacting particles, showing body and interaction forces.</div></div>
<p>To simulate the movement of each particle, the particles' initial properties are defined, then Newton's laws are applied, resulting in the equations of motion, <br  />
 </p><p class="formulaDsp">
\[m_i \ddot{\vec{r_i}} = \vec f_i,\quad I_i \dot{\vec{\omega_i}} = \vec t_i,\]
</p>
<p> where \(m_i\), \(I_i\), \(\omega_i\) are the mass, moment of inertia and angular velocity of each particle (we currently do not use the particles' orientation, as all particles are spherical).</p>
<p>The default body force applied to a particle is due to gravity, \(\vec f_i^\mathrm{body}=m_i \vec{g}\), with \(\vec g\) the gravitational acceleration. The interaction forces can be quite varied, but usually consist of a repulsive normal force due to the physical deformation when two particles are in contact, and possibly an adhesive normal force </p><p class="formulaDsp">
\[\vec f_{ij} = (f_{ij}^{n,rep}-f_{ij}^{n,rep})\vec n_{ij} + \vec f_{ij}^{t},\]
</p>
<p> with \(\vec n_{ij}\) the normal direction at the contact point, which for spherical particles is given by \(\vec n_{ij}=\frac{\vec r_j-\vec r_i}{|\vec r_j-\vec r_i|}\).</p>
<p>Further, a set of walls \(W_j,\ \ j=1,\dots,N\) can be implemented, which can apply an additional force \(\vec f_{ij}\) and torque \(\vec t_{ij}\) to each particle \(P_i\). A typical, flat wall is defined by </p><p class="formulaDsp">
\[\mathrm{W}_j = \{\vec{r}:\ \vec{n}_j \cdot (\vec{r} - \vec{r}_j) \leq 0 \},\]
</p>
<p> with \( \vec{n}_j\) the unit vector pointing into the wall and \(\vec{r}_j\) a point on the wall. However, many other wall types are possible, such as intersections of planar walls (e.g. polyhedral walls), axisymmetric walls (e.g., cylinders or funnels), or even complex shapes (coils and helical walls).</p>
<p>More complex simulations include further boundary conditions \(B_j,\ \ j=1,\dots,N\), such as periodic walls and regions where particles get destroyed or added.</p>
<p>Time integration is done using Velocity Verlet, see <a href="http://en.wikipedia.org/wiki/Verlet_integration#Velocity_Verlet">http://en.wikipedia.org/wiki/Verlet_integration#Velocity_Verlet</a> for details. The implementation can be found in DPMBase::solve.</p>
<h2><a class="anchor" id="autotoc_md5"></a>
Variables</h2>
<p>In the following sections, we give a short overview over the parameters that can be specified in MercuryDPM, and introduce the variable names which are used throughout this documentation. We also include links to the implementation of each object/parameter. For the more complex type of objects (particles, species, interactions, walls, and boundaries), where multiple implementation exist, we give an overview of the common parameters and discuss the most common types.</p>
<h3><a class="anchor" id="autotoc_md6"></a>
Global variables</h3>
<p>Each simulation has the following global parameters:</p><ul>
<li>A time variable \(t\).</li>
<li>A time domain \([0,t_\mathrm{max}]\).</li>
<li>A time step \( dt \).</li>
<li>A spatial domain \([x_\mathrm{min},x_\mathrm{max}] \times [y_\mathrm{min},y_\mathrm{max}] \times [z_\mathrm{min},z_\mathrm{max}]\).</li>
<li>A set of particles \(P_i,\ \ i=1,\dots,N\).</li>
<li>A set of walls \(W_i,\ \ i=1,\dots,N_\mathrm{wall}\).</li>
<li>A set of boundaries \(B_i,\ \ i=1,\dots,N_\mathrm{boundary}\), such as periodic walls and regions where particles get destroyed or added.</li>
<li>A set of species \(S_i,\ \ i=1,\dots,N_\mathrm{species}\), each of which is a description of a particular force law.</li>
<li>A set of interactions \(C_i,\ \ i=1,\dots,N_\mathrm{interaction}\), a list of all interactions between particle pairs.</li>
<li>The gravitational acceleration, \( \vec{g}\) (can be zero).</li>
<li>Six output files (the .data, .fstat, .ene, .restart and the .stat file).</li>
</ul>
<p>These variables are all implemented in the class DPMBase. This class is a base class of Mercury3D, which is the typical class used in Driver code, such as the tutorials [add link]. The sets of particles, species, walls ... mentioned above are implemented as handlers, which contain a vector of pointers (=links) to objects. E.g., WallHandler contains a set of pointers to walls, which are possibly of different type (flat, cylindrical, polyhedral, ...). The same is true for the ParticleHandler, SpeciesHandler, InteractionHandler, and BoundaryHandler. Next, we introduce the basic types of objects these handlers can contain.</p>
<h3><a class="anchor" id="autotoc_md7"></a>
Particles</h3>
<p>Currently, only one type of particle exists, the BaseParticle. Each BaseParticle \(P_i\) has the following properties:</p><ul>
<li>Position \( \vec{r}_i(t)\),</li>
<li>Velocity \( \vec{v}_i(t)\),</li>
<li>Orientation \( \vec{\alpha}_i(t)\) (currently only valid for 2D objects),</li>
<li>Angular velocity \( \vec{\omega}_i(t)\).</li>
<li>Radius \( a_i \),</li>
<li>Mass \( m_i = \frac{4}{3} \pi a_i^3 \) for 3D spheres, \(\pi a_i^2 \) for 2D circles,</li>
<li>Inertia \( I_i = \frac{2}{5} m_i a_i^2 \) for 3D spheres, \( \frac{1}{2} m_i a_i \) for 2D circles.</li>
</ul>
<h3><a class="anchor" id="autotoc_md8"></a>
Walls</h3>
<p>There are several wall types: InfiniteWall, IntersectionOfWalls, AxisymmetricIntersectionOfWalls, Screw, and Coil. All these wall types are derived from a common class, BaseWall, which has the following properties:</p><ul>
<li>Position \( \vec{r}_i(t)\).</li>
<li>Velocity \( \vec{v}_i(t)\).</li>
<li>Orientation \( \vec{\alpha}_i(t)\) (currently only valid for 2D objects).</li>
<li>Angular velocity \( \vec{\omega}_i(t)\). The most common wall type, InfiniteWalls, defines planar walls, which are defined as \( \mathrm{w} = \{\vec{r}:\ \vec{n} \cdot (\vec{r} - \vec{r}_i) \leq 0 \}\), with \( \vec{n}\) the unit vector pointing into the wall.</li>
</ul>
<h3><a class="anchor" id="autotoc_md9"></a>
Boundaries</h3>
<p>There are several boundaries, which can be categorized into three types:</p><ul>
<li>periodic boundary conditions, which move particles when they reach certain regions:<ul>
<li>PeriodicBoundary,</li>
<li>AngledPeriodicBoundary,</li>
<li>LeesEdwardsBoundary,</li>
<li>ConstantMassFlowMaserBoundary,</li>
<li>CircularPeriodicBoundary.</li>
</ul>
</li>
<li>insertion regions, that specify where particles should be created:<ul>
<li>InsertionBoundary,</li>
<li>CubeInsertionBoundary,</li>
<li>ChuteInsertionBoundary,</li>
<li>HopperInsertionBoundary.</li>
</ul>
</li>
<li>deletion regions, that specify where particles should be deleted:<ul>
<li>DeletionBoundary</li>
</ul>
</li>
</ul>
<h3><a class="anchor" id="autotoc_md10"></a>
Species</h3>
<p>There are several species, which are built up from four building blocks (see Species for more details):</p>
<ol type="1">
<li>ParticleSpecies: Contains material properties like<ul>
<li>density \(\rho\).</li>
</ul>
</li>
<li>NormalForceSpecies: Describes the normal contact force \(f^{n,c}\). Several normal forces are implemented:<ul>
<li>HertzianViscoelasticNormalSpecies,</li>
<li>LinearViscoelasticNormalSpecies, and</li>
<li>LinearPlasticViscoelasticNormalSpecies. The most commonly used normal force species, LinearViscoelasticNormalSpecies contains</li>
<li>stiffness \(k\) and</li>
<li>dissipation \(\gamma\).</li>
</ul>
</li>
<li><p class="startli">AdhesiveForceSpecies: Describes the short-range, adhesive normal contact force \(f^{n,ad}\), which is added to the normal contact force. Several adhesive forces are implemented:</p><ul>
<li>ReversibleAdhesiveSpecies,</li>
<li>IrreversibleAdhesiveSpecies, and</li>
<li>LiquidBridgeWilletSpecies.</li>
</ul>
<p class="startli">If no adhesive force is required, the default EmptyAdhesiveSpecies is used. The most commonly used adhesive force species, ReversibleAdhesiveSpecies contains</p><ul>
<li>the adhesive stiffness \(k^{ad}\),</li>
<li>the maximum adhesive force \(f^{ad,max}\).</li>
</ul>
</li>
<li><p class="startli">FrictionForceSpecies: Describes the tangential frictional contact force. Several normal forces are implemented:</p><ul>
<li>SlidingFrictionSpecies and</li>
<li>FrictionSpecies.</li>
</ul>
<p class="startli">If no friction force is required, the EmptyFrictionSpecies is used. The most commonly used friction force species, SlidingFrictionSpecies contains:</p><ul>
<li>the sliding friction coefficient \(\mu^\mathrm{sl}\),</li>
<li>the sliding dissipation \(\gamma^\mathrm{sl}\).</li>
</ul>
<p class="startli">Note that in the Coulomb friction model, the frictional yield force only depends on the contact force, e.g. \(|f^{sl}|\leq\mu^{sl}|f^{n,c}|\), which is why the two normal forces are split.</p>
</li>
</ol>
<h3><a class="anchor" id="autotoc_md11"></a>
Interactions</h3>
<p>There are several Interaction types, one for each Species. While the Species contain the parameters of the contact model, the Interaction contains the variables stored for an individual interaction between a particle (or particle-wall) pair. All interaction types have the following common properties:</p><ul>
<li>relative position \( \vec{r}_{ij} = \vec{r}_i - \vec{r}_j \),</li>
<li>normal direction \( \vec{n}_{ij} = \frac{\vec{r}_{ij}}{\|\vec{r}_{ij}\|}\),</li>
<li>overlap \( \delta_{ij} = (\vec{a}_i - \vec{a}_j) - \vec{r}_{ij}\),</li>
<li>relative velocity \( \vec{v}_{ij}=\vec{v}_i-\vec{v}_j + (a_i-\frac{\delta_{ij}}{2}) \vec{n}_{ij} \times \vec{\omega}_i + (a_j-\frac{\delta_{ij}}{2}) \vec{n}_{ij} \times \vec{\omega}_j \)</li>
<li>relative normal velocity \( v_{ij}^n = - \vec{v}_{ij} \cdot \vec{n}_{ij}$ ($= \dot{\delta}_{ij} \)),</li>
<li>normal force (for the linear viscoelastic spring-dashpot model) \( f_{ij}^n = k \delta_{ij} + \gamma v_{ij}^n \),</li>
<li>relative tangential velocity \( \vec{v}_{ij}^t = \vec{v}_{ij} - v_{ij}^n \vec{n}_{ij} \),</li>
<li>tangential direction \( \vec{t}_{ij} = \frac{\vec{v}_{ij}^t}{\|\vec{v}_{ij}^t\|}\),</li>
<li>tangential force (for sliding friction) \( f_{ij}^t = - \max( \gamma^t v_{ij}^t,\ \mu f_{ij}^n)\),</li>
<li>collision force \( \vec{f}_{ij} = f_{ij}^n \vec{n}_{ij} + f_{ij}^t \vec{t}_{ij},\ \mathrm{if } \delta_{ij}\leq 0,\ 0\ \mathrm{else} \).</li>
</ul>
<p>For collisions between particle \( \mathrm{P}_i \) and wall \( \mathrm{w}_j \), some variables are defined differently:</p><ul>
<li>normal direction \( \vec{n}_{ij}^{wall} = - \vec{n}_{\mathrm{w}_j}\),</li>
<li>overlap \( \delta_{ij}^{wall} = \vec{a}_i - (p_{\mathrm{w}_j} - n_{\mathrm{w}_j} \cdot x)\),</li>
<li>relative velocity \( \vec{v}_{ij}^{wall}=\vec{v}_i + (a_i-\frac{\delta_{ij}}{2}) \vec{n}_{ij} \times \vec{\omega}_i \),</li>
<li>All else is the same as for particle collisions </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dd/d62/UnclassifiedPages.html">Unclassified pages</a></li><li class="navelem"><a class="el" href="../../d8/d51/GettingStarted.html">Getting started</a></li>
    <li class="footer">Generated on Wed Aug 27 2025 17:05:12 for MercuryDPM by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
