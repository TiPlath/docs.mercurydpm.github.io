<!-- HTML header for doxygen 1.8.18-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MercuryDPM: CGHandler: Live coarse-graining during a discrete particle simulation</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../MDPM.css" rel="stylesheet" type="text/css"/>
<link href="../../codeLabels.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-fork-corner.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-dropdown-version.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../MDPM-fragment-copy-button.js"></script>
<script type="text/javascript">
DoxygenAwesomeFragmentCopyButton.init()
</script>
<script type="text/javascript" src="../../MDPM-paragraph-link.js"></script>
<script type="text/javascript">
DoxygenAwesomeParagraphLink.init()
</script>
<script type="text/javascript" src="../../MDPM-interactive-toc.js"></script>
<script type="text/javascript">
DoxygenAwesomeInteractiveToc.init()
</script>
<script type="text/javascript" src="../../MDPM-darkmode-toggle.js"></script>
<script type="text/javascript">
DoxygenAwesomeDarkModeToggle.init()
</script>
</head>
<body>
  <div id="bitbucket-corner">
   <a href="https://bitbucket.org/mercurydpm/mercurydpm/src/master/" target="_blank" id="fork-corner" class="fork-corner fc-pos-tr fc-animate fc-theme-bitbucket"></a>
  </div>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../mercury-logo-chosen-light-slogan.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"> <!--MercuryDPM--!>
   <!-- BEGIN version select -->
   <div class="dropdown" id="projectnumber">
    <button class="dropbtn">v1.0</button>
    <div class="dropdown-content">
    </div>
   </div>
   <script type="text/javascript" src="../../MDPM-dropdown-version.js"></script>
<!-- END version select -->
   <!--&#160;<span id="projectnumber">revision: v1.0</span>-->
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<script type="text/javascript" src="../../MDPM-fork-corner.js"></script>
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('dd/d11/CGHandler.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">CGHandler: Live coarse-graining during a discrete particle simulation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The old fstatistics tool was based on the templated StatisticsVector class. It added functionality to DPMBase that allowed the evaluation of continuum fields, either during a simulation or as a post-processing step. For example, to add global statistical output to your simulation, you had to derive your Driver class from both Mercury3D and StatisticsVector&lt;O&gt;: </p><div class="fragment"><div class="line"><span class="keyword">class </span>DriverClass : <span class="keyword">public</span> <a class="code" href="../../d3/db1/classMercury3D.html">Mercury3D</a>, <span class="keyword">public</span> <a class="code" href="../../de/db2/classStatisticsVector.html">StatisticsVector</a>&lt;O&gt; {</div>
<div class="line">    <span class="comment">// .. class definition</span></div>
<div class="line">}</div>
<div class="ttc" id="aclassMercury3D_html"><div class="ttname"><a href="../../d3/db1/classMercury3D.html">Mercury3D</a></div><div class="ttdoc">This adds on the hierarchical grid code for 3D problems.</div><div class="ttdef"><b>Definition:</b> Mercury3D.h:16</div></div>
<div class="ttc" id="aclassStatisticsVector_html"><div class="ttname"><a href="../../de/db2/classStatisticsVector.html">StatisticsVector</a></div><div class="ttdoc">This class is used to extract statistical data from MD simulations.</div><div class="ttdef"><b>Definition:</b> StatisticsVector.h:41</div></div>
</div><!-- fragment --><p>This setup was inflexible, however, as it allowed only the evaluation of one type of coarse-graining. This was replaced in MercuryCG by the cgHandler, which can contain several CG objects if desired: </p><div class="fragment"><div class="line"><span class="keyword">class </span>DriverClass : <span class="keyword">public</span> <a class="code" href="../../d3/db1/classMercury3D.html">Mercury3D</a> {</div>
<div class="line">    <span class="comment">// .. class definition</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="../../d9/d18/T__protectiveWall_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a> () {</div>
<div class="line">    DriverClass dpm; <span class="comment">//declare your DPM class</span></div>
<div class="line">    <a class="code" href="../../db/d56/classCG.html">CG&lt;CGCoordinates::O&gt;</a> cg; <span class="comment">//declare a cg object</span></div>
<div class="line">    cg.<a class="code" href="../../d4/d13/classBaseCG.html#a5ff9ea02604b7adb80cbf6d409c5f6c0">statFile</a>.<a class="code" href="../../db/d30/classFile.html#a40502d7fb886c8b5d00d7cf05efc4aa6">setSaveCount</a>(50); <span class="comment">//set parameters such as the output frequency</span></div>
<div class="line">    dpm.cgHandler.copyAndAddObject(cg); <span class="comment">// add the CG object to the cgHandler</span></div>
<div class="line">    dpm.solve(); <span class="comment">//run your DPM simulation</span></div>
<div class="line">}</div>
<div class="ttc" id="aT__protectiveWall_8cpp_html_a0ddf1224851353fc92bfbff6f499fa97"><div class="ttname"><a href="../../d9/d18/T__protectiveWall_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a></div><div class="ttdeci">int main(int argc, char *argv[])</div><div class="ttdef"><b>Definition:</b> T_protectiveWall.cpp:194</div></div>
<div class="ttc" id="aclassBaseCG_html_a5ff9ea02604b7adb80cbf6d409c5f6c0"><div class="ttname"><a href="../../d4/d13/classBaseCG.html#a5ff9ea02604b7adb80cbf6d409c5f6c0">BaseCG::statFile</a></div><div class="ttdeci">File statFile</div><div class="ttdoc">File class to handle the output into a .stat file.</div><div class="ttdef"><b>Definition:</b> BaseCG.h:363</div></div>
<div class="ttc" id="aclassCG_html"><div class="ttname"><a href="../../db/d56/classCG.html">CG</a></div><div class="ttdoc">Evaluates time-resolved continuum fields and writes the data into a stat file.</div><div class="ttdef"><b>Definition:</b> CG.h:55</div></div>
<div class="ttc" id="aclassFile_html_a40502d7fb886c8b5d00d7cf05efc4aa6"><div class="ttname"><a href="../../db/d30/classFile.html#a40502d7fb886c8b5d00d7cf05efc4aa6">File::setSaveCount</a></div><div class="ttdeci">void setSaveCount(unsigned int saveCount)</div><div class="ttdoc">Sets File::saveCount_.</div><div class="ttdef"><b>Definition:</b> File.cc:251</div></div>
</div><!-- fragment --><h1><a class="anchor" id="OutputStat"></a>
Output to stat-files</h1>
<p>If a cg object is added to the cgHandler, it will produce analytical data while the simulation is running. This data is stored in a file named <code>$name.$n.stat</code>, where <code>$name</code> is the problem name specified by setName, and <code>$n</code> is the index of the cg object in the cgHandler. A basic example is shown in TutorialCG0.cpp. It produces spatially averaged statistics at every 50-th time step, resulting in the following output: </p><div class="fragment"><div class="line">::::::::::::::</div>
<div class="line">TutorialCG0.0.stat</div>
<div class="line">::::::::::::<a class="code" href="../../db/d56/classCG.html">::</a></div>
<div class="line"><a class="code" href="../../db/d56/classCG.html">CG</a> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> 1 1 1 width 1 timeMin 0.1601 <a class="code" href="../../dc/d51/datatypes_8h.html#ac6afabdc09a49a433ee19d8a9486056d">min</a> 0 0 0 <a class="code" href="../../dc/d51/datatypes_8h.html#affe776513b24d84b39af8ab0930fef7f">max</a> 9.92738 9.92738 9.92738 Lucy cutoff 1</div>
<div class="line">time 2:volumeFraction 3:<a class="code" href="../../de/d6c/namespaceUniformPSDSelfTest.html#a3ac20b253bbadc71e305cbbeabd87435">density</a> 4-6:momentum 7-12:momentumFlux 13-21:contactStress 22-24:interactionForceDensity</div>
<div class="line">0.1601 0.535174 1.02211 3.11529e-17 6.62723e-17 -1.38841e-17 0.000348305 9.52371e-06 -6.18274e-06 0.000314944 -1.0499</div>
<div class="line">8<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>-05 0.000332432 583.523 -93.4013 -191.383 -56.5639 1100.79 -52.4474 -192.268 -48.4432 853.035 0 0 0</div>
<div class="line">0.1651 0.535174 1.02211 1.19044e-17 4.79952e-16 1.43027e-15 75.5124 -29.6753 -15.9208 212.387 10.134 93.6674 1019.24</div>
<div class="line">-2.79241 5.15266 1.58597 1525.6 9.29084 12.7538 -0.135959 956.726 0 0 0</div>
<div class="line">...</div>
<div class="ttc" id="aCG3DPackingUnitTest_8cpp_html_a7026fd16370249ce97cb3d062326baf9"><div class="ttname"><a href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a></div><div class="ttdeci">const unsigned n</div><div class="ttdef"><b>Definition:</b> CG3DPackingUnitTest.cpp:11</div></div>
<div class="ttc" id="aCwise__array__power__array_8cpp_html_a9eb5e92d9d691c1393e5e7c914731dbf"><div class="ttname"><a href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a></div><div class="ttdeci">Array&lt; double, 1, 3 &gt; e(1./3., 0.5, 2.)</div></div>
<div class="ttc" id="adatatypes_8h_html_ac6afabdc09a49a433ee19d8a9486056d"><div class="ttname"><a href="../../dc/d51/datatypes_8h.html#ac6afabdc09a49a433ee19d8a9486056d">min</a></div><div class="ttdeci">#define min(a, b)</div><div class="ttdef"><b>Definition:</b> datatypes.h:22</div></div>
<div class="ttc" id="adatatypes_8h_html_affe776513b24d84b39af8ab0930fef7f"><div class="ttname"><a href="../../dc/d51/datatypes_8h.html#affe776513b24d84b39af8ab0930fef7f">max</a></div><div class="ttdeci">#define max(a, b)</div><div class="ttdef"><b>Definition:</b> datatypes.h:23</div></div>
<div class="ttc" id="anamespaceUniformPSDSelfTest_html_a3ac20b253bbadc71e305cbbeabd87435"><div class="ttname"><a href="../../de/d6c/namespaceUniformPSDSelfTest.html#a3ac20b253bbadc71e305cbbeabd87435">UniformPSDSelfTest.density</a></div><div class="ttdeci">density</div><div class="ttdef"><b>Definition:</b> UniformPSDSelfTest.py:19</div></div>
</div><!-- fragment --><p>The first header line gives the user information about the type of coarse-graining applied; in this case, the coordinate type is O, which denotes globally-averaged statistics. <br  />
 The second header line denotes the column numbers of the coordinates (time) and the fields (volume fraction, etc) evaluated at the coordinates. <br  />
 All other lines contain coordinate and field values; e.g. the third line tells you that the volume fraction at time 0 was 0.6. <br  />
 The simple file format allow easy plotting of the data in gnuplot, e.g. </p><div class="fragment"><div class="line">&gt;&gt; <a class="code" href="../../d9/d41/namespacehelpers.html#af9bb1d3c7148970d7c1c9c2cf2646e35">gnuplot</a></div>
<div class="line">&gt; <a class="code" href="../../d3/db3/stdlist__overload_8cpp.html#a69b63b72995af592c652824ddc454356">set</a> xlabel <span class="stringliteral">&#39;volume fraction&#39;</span></div>
<div class="line">&gt; <a class="code" href="../../d3/db3/stdlist__overload_8cpp.html#a69b63b72995af592c652824ddc454356">set</a> ylabel <span class="stringliteral">&#39;confining pressure&#39;</span></div>
<div class="line">&gt; <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> <span class="stringliteral">&#39;TutorialCG0.0.stat&#39;</span> u 2:13</div>
<div class="ttc" id="aTutorial__Map__using_8cpp_html_a7fe964f6b1afd4591f637999272ab9a2"><div class="ttname"><a href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a></div><div class="ttdeci">float * p</div><div class="ttdef"><b>Definition:</b> Tutorial_Map_using.cpp:9</div></div>
<div class="ttc" id="anamespacehelpers_html_af9bb1d3c7148970d7c1c9c2cf2646e35"><div class="ttname"><a href="../../d9/d41/namespacehelpers.html#af9bb1d3c7148970d7c1c9c2cf2646e35">helpers::gnuplot</a></div><div class="ttdeci">void gnuplot(std::string command)</div><div class="ttdoc">Plots to a gnuplot window.</div><div class="ttdef"><b>Definition:</b> MiscHelpers.cc:17</div></div>
<div class="ttc" id="astdlist__overload_8cpp_html_a69b63b72995af592c652824ddc454356"><div class="ttname"><a href="../../d3/db3/stdlist__overload_8cpp.html#a69b63b72995af592c652824ddc454356">set</a></div><div class="ttdeci">void set(Container &amp;c, Position position, const Value &amp;value)</div><div class="ttdef"><b>Definition:</b> stdlist_overload.cpp:36</div></div>
</div><!-- fragment --><p> <img src="../../TutorialCG0A.png" alt="" width="400" class="inline"/></p>
<p>One can also plot the same data in Matlab using loadStatistics.m provided in the Matlab folder </p><div class="fragment"><div class="line">&gt;&gt; cd ~/MercuryDPM/MercuryBuild/Drivers/Tutorials/</div>
<div class="line">&gt;&gt; addpath(<span class="stringliteral">&quot;~/MercuryDPM/MercurySource/Matlab&quot;</span>)</div>
<div class="line">&gt;&gt; <a class="code" href="../../d5/d3b/Map__placement__new_8cpp.html#abe49a82806b5db2e012bc33839af03e6">data</a> = loadStatistics(<span class="stringliteral">&quot;TutorialCG0.0.stat&quot;</span>);</div>
<div class="line">&gt;&gt; <a class="code" href="../../d3/d17/namespacePlanarWave.html#afe1e9812d1b1dc40a89f7a1f18d1165f">plot</a>(<a class="code" href="../../d5/d3b/Map__placement__new_8cpp.html#abe49a82806b5db2e012bc33839af03e6">data</a>.VolumeFraction,<a class="code" href="../../d5/d3b/Map__placement__new_8cpp.html#abe49a82806b5db2e012bc33839af03e6">data</a>.ContactStressXX);</div>
<div class="line">&gt;&gt; xlabel(<span class="stringliteral">&#39;volume fraction&#39;</span>), ylabel(<span class="stringliteral">&#39;confining pressure&#39;</span>);</div>
<div class="ttc" id="aMap__placement__new_8cpp_html_abe49a82806b5db2e012bc33839af03e6"><div class="ttname"><a href="../../d5/d3b/Map__placement__new_8cpp.html#abe49a82806b5db2e012bc33839af03e6">data</a></div><div class="ttdeci">int data[]</div><div class="ttdef"><b>Definition:</b> Map_placement_new.cpp:1</div></div>
<div class="ttc" id="anamespacePlanarWave_html_afe1e9812d1b1dc40a89f7a1f18d1165f"><div class="ttname"><a href="../../d3/d17/namespacePlanarWave.html#afe1e9812d1b1dc40a89f7a1f18d1165f">PlanarWave::plot</a></div><div class="ttdeci">void plot()</div><div class="ttdoc">Plot.</div><div class="ttdef"><b>Definition:</b> sphere_scattering.cc:180</div></div>
</div><!-- fragment --><p> <img src="../../TutorialCG0B.png" alt="" width="400" class="inline"/></p>
<h1><a class="anchor" id="CGCoordinates"></a>
CGCoordinates</h1>
<p>The example above produced globally averaged statistics. However, usually coarse-graining is used to extract spatially dependent continuum fields. This can be done by changing the CGCoordinate type: </p><div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code" href="../../d9/d18/T__protectiveWall_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a> () {</div>
<div class="line">  DriverClass dpm;</div>
<div class="line">  dpm.setName(<span class="stringliteral">&quot;Test&quot;</span>)</div>
<div class="line">  <a class="code" href="../../db/d56/classCG.html">CG&lt;CGCoordinates::O&gt;</a> cgO;</div>
<div class="line">  dpm.cgHandler.copyAndAddObject(cgO); <span class="comment">// produces globally averaged statistics</span></div>
<div class="line">  <a class="code" href="../../db/d56/classCG.html">CG&lt;CGCoordinates::XYZ&gt;</a> cgXYZ;</div>
<div class="line">  cgXYZ.<a class="code" href="../../db/d56/classCG.html#ac5c8bccd521af9aae36e8ce3a7344cf4">setWidth</a>(1); <span class="comment">//set cg width</span></div>
<div class="line">  cgXYZ.<a class="code" href="../../d4/d13/classBaseCG.html#ada1092041d5404475136de2da4d0beac">setN</a>(20); <span class="comment">//set number of mesh points in each spatial direction</span></div>
<div class="line">  dpm.cgHandler.copyAndAddObject(cgXYZ); <span class="comment">// produces spatially resolved statistics</span></div>
<div class="line">  dpm.solve();</div>
<div class="line">}</div>
<div class="ttc" id="aclassBaseCG_html_ada1092041d5404475136de2da4d0beac"><div class="ttname"><a href="../../d4/d13/classBaseCG.html#ada1092041d5404475136de2da4d0beac">BaseCG::setN</a></div><div class="ttdeci">void setN(std::size_t n)</div><div class="ttdoc">Sets nX_, nY_, nZ_, the number of spatial mesh points in each cartesian direction.</div><div class="ttdef"><b>Definition:</b> BaseCG.cc:111</div></div>
<div class="ttc" id="aclassCG_html_ac5c8bccd521af9aae36e8ce3a7344cf4"><div class="ttname"><a href="../../db/d56/classCG.html#ac5c8bccd521af9aae36e8ce3a7344cf4">CG::setWidth</a></div><div class="ttdeci">void setWidth(Mdouble width) override</div><div class="ttdef"><b>Definition:</b> CG.h:199</div></div>
</div><!-- fragment --><p>The code above produces two sets of output: <code>Test.0.stat</code> contains globally averaged data, <code>Test.1.stat</code> contains spatially resolved data. In the latter case, the number of evaluation points and the coarse-graining width has to be specified &ndash; in this case, a Gaussian of width (standard deviation) 1 and a 20x20x20 mesh of evaluation points will be used. <br  />
Note that the latter statistics will produce huge amounts of data (8000 times more than the globally averaged statistics), even though we have not chosen a particularly high resolution. The data will further be highly fluctuating, as the continuum fields only depend on the small amount of data in the sphere around the evaluation point. <br  />
Thus, it is advisable to average in space when ever possible, i.e. if the data is homogeneous in space. Often the data is not homogeneous in all spatial directions, but in some. In that case, spatial averaging can be applied in specific directions only. This is done by using partially resolved CGCoordinates: X, Y, Z, XY, XZ, or YZ. For example, <code>CG&lt;CGCoordinates::Z&gt;</code> averages over the yz-plane, but resolves the fields in z-direction. This is shown exemplary in <code>TutorialCG1.1.stat</code>: </p><div class="fragment"><div class="line">::::::::::::::</div>
<div class="line">TutorialCG1.1.stat</div>
<div class="line">::::::::::::::</div>
<div class="line">...</div>
</div><!-- fragment --><p> A simple matlab plot reveals that the confining stress increases in the z-direction. </p><div class="fragment"><div class="line">&gt;&gt; cd ~/MercuryDPM/MercuryBuild/Drivers/Tutorials/</div>
<div class="line">&gt;&gt; addpath(<span class="stringliteral">&quot;~/MercuryDPM/MercurySource/Matlab&quot;</span>)</div>
<div class="line">&gt;&gt; <a class="code" href="../../d5/d3b/Map__placement__new_8cpp.html#abe49a82806b5db2e012bc33839af03e6">data</a> = loadStatistics(<span class="stringliteral">&quot;TutorialCG1.1.stat&quot;</span>);</div>
<div class="line">&gt;&gt; <a class="code" href="../../d3/d17/namespacePlanarWave.html#afe1e9812d1b1dc40a89f7a1f18d1165f">plot</a>(<a class="code" href="../../d5/d3b/Map__placement__new_8cpp.html#abe49a82806b5db2e012bc33839af03e6">data</a>.z,<a class="code" href="../../d5/d3b/Map__placement__new_8cpp.html#abe49a82806b5db2e012bc33839af03e6">data</a>.ContactStressZZ);</div>
<div class="line">&gt;&gt; xlabel(<span class="charliteral">&#39;z&#39;</span>), ylabel(<span class="stringliteral">&#39;confining pressure&#39;</span>);</div>
</div><!-- fragment --><p> <img src="../../TutorialCG1.png" alt="" width="400" class="inline"/></p>
<ul>
<li>Coarse-graining function: The default cg function is a cutoff Gaussian, but it can be changed to other functions, such as polynomial radial basis functions (a Heaviside, Linear, or a Lucy polynomial). ...</li>
</ul>
<h1><a class="anchor" id="temporal"></a>
Temporal averaging</h1>
<p>Coarse-graining can also be applied in the time dimension. This can be done in MercuryCG by using a TimeAveragedCG or TimeSmoothedCG object: </p><div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code" href="../../d9/d18/T__protectiveWall_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a> () {</div>
<div class="line">    DriverClass dpm;</div>
<div class="line">    dpm.setName(<span class="stringliteral">&quot;Test&quot;</span>)</div>
<div class="line">    <a class="code" href="../../db/d56/classCG.html">CG&lt;CGCoordinates::O&gt;</a> cg;</div>
<div class="line">    dpm.cgHandler.copyAndAddObject(cgO); <span class="comment">// produces time-resolved statistics</span></div>
<div class="line">    <a class="code" href="../../d1/d43/classTimeSmoothedCG.html">TimeSmoothedCG&lt;CGCoordinates::O&gt;</a> cgTS;</div>
<div class="line">    dpm.cgHandler.copyAndAddObject(cgTS); <span class="comment">// produces time-smoothed statistics</span></div>
<div class="line">    <a class="code" href="../../d6/d31/classTimeAveragedCG.html">TimeAveragedCG&lt;CGCoordinates::O&gt;</a> cgTA;</div>
<div class="line">    dpm.cgHandler.copyAndAddObject(cgTA); <span class="comment">// produces fully time-averaged statistics</span></div>
<div class="line">    dpm.solve();</div>
<div class="line">}</div>
<div class="ttc" id="aclassTimeAveragedCG_html"><div class="ttname"><a href="../../d6/d31/classTimeAveragedCG.html">TimeAveragedCG</a></div><div class="ttdoc">Evaluates time-averaged continuum fields and writes the data into a stat file.</div><div class="ttdef"><b>Definition:</b> TimeAveragedCG.h:39</div></div>
<div class="ttc" id="aclassTimeSmoothedCG_html"><div class="ttname"><a href="../../d1/d43/classTimeSmoothedCG.html">TimeSmoothedCG</a></div><div class="ttdoc">Evaluates time-smoothed continuum fields and writes the data into a stat file.</div><div class="ttdef"><b>Definition:</b> TimeSmoothedCG.h:40</div></div>
</div><!-- fragment --><p> This can best be studied by looking at a time-dependent problem, such as a slowly sheared Lees-Edwards-style simulation: The friction in this system initially builds up until it reaches a maximum, then decreases towards a smaller, critical value.</p>
<p>If your DPM problem is steady, it is not necessary to resolve the continuum fields in time. This can be done in Mercury by using time-averaging cg, e.g. </p><blockquote class="doxtable">
<p>TimeAveragedCG&lt;CGFunctions::GaussZ&gt; cg; <br  />
cg.setNZ(10); <br  />
cg.setWidth(0.15); <br  />
cg.statFile.setSaveCount(20000); <br  />
problem.cgHandler.copyAndAddObject(cg); </p>
</blockquote>
<p>To limit the time interval over which the continuum fields are evaluated to e.g. \([10,20]\), use </p><blockquote class="doxtable">
<p>cg.setTimeMin(10); <br  />
cg.setTimeMax(20); </p>
</blockquote>
<h1><a class="anchor" id="postprocess"></a>
Post-processing</h1>
<p>Processing restart files</p>
<h1><a class="anchor" id="code"></a>
Documentation of MercuryCG</h1>
<p>The list below links to the documentation of the different classes that comprise MercuryCG.</p><ul>
<li>class CGHandler:<br  />
Handler that stores all CG objects.</li>
<li>classes CG, TimeSmoothedCG, TimeAveragedCG:<br  />
The three available CG classes, used to obtain time-resolved, time smoothed, and time-averaged continuum fields. Contains a vector of CGPoints.</li>
<li>templated class CGPoint:<br  />
Derived from a CGFields and a CGFunctions class. Does the main work of evaluating the continuum fields at a given position.</li>
<li>namespace CGFields:<br  />
Contains the classes StandardFields etc.</li>
<li>namespace CGFunctions: <br  />
Contains the templated classes Gauss, Heaviside, Linear, Lucy (the latter three are derived from Polynomial). Contains the definition of the cg function used. Derived from a CGCoordinates class.</li>
<li>namespace CGCoordinates: <br  />
Contains the classes O, X, Y, Z, XY, XZ, YZ, XYZ: Contains the position of the CGPoint. </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../index.html">MercuryDPM Reference Manual</a></li><li class="navelem"><a class="el" href="../../d9/d5c/MercuryDPM_CG.html">Coarse graining: From discrete particles to continuum fields</a></li>
    <li class="footer">Generated on Wed Aug 27 2025 17:05:12 for MercuryDPM by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
