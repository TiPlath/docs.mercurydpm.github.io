<!-- HTML header for doxygen 1.8.18-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MercuryDPM: oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt; Class Template Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../MDPM.css" rel="stylesheet" type="text/css"/>
<link href="../../codeLabels.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-fork-corner.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-dropdown-version.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../MDPM-fragment-copy-button.js"></script>
<script type="text/javascript">
DoxygenAwesomeFragmentCopyButton.init()
</script>
<script type="text/javascript" src="../../MDPM-paragraph-link.js"></script>
<script type="text/javascript">
DoxygenAwesomeParagraphLink.init()
</script>
<script type="text/javascript" src="../../MDPM-interactive-toc.js"></script>
<script type="text/javascript">
DoxygenAwesomeInteractiveToc.init()
</script>
<script type="text/javascript" src="../../MDPM-darkmode-toggle.js"></script>
<script type="text/javascript">
DoxygenAwesomeDarkModeToggle.init()
</script>
</head>
<body>
  <div id="bitbucket-corner">
   <a href="https://bitbucket.org/mercurydpm/mercurydpm/src/master/" target="_blank" id="fork-corner" class="fork-corner fc-pos-tr fc-animate fc-theme-bitbucket"></a>
  </div>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../mercury-logo-chosen-light-slogan.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"> <!--MercuryDPM--!>
   <!-- BEGIN version select -->
   <div class="dropdown" id="projectnumber">
    <button class="dropbtn">v1.0</button>
    <div class="dropdown-content">
    </div>
   </div>
   <script type="text/javascript" src="../../MDPM-dropdown-version.js"></script>
<!-- END version select -->
   <!--&#160;<span id="projectnumber">revision: v1.0</span>-->
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<script type="text/javascript" src="../../MDPM-fork-corner.js"></script>
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="../../d5/dc3/classoomph_1_1NavierStokesElementWithSingularity-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt; Class Template Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="../../dd/d03/navier__stokes__elements__with__singularity_8h_source.html">navier_stokes_elements_with_singularity.h</a>&gt;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Inheritance diagram for oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
 <div class="center">
  <img src="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.png" usemap="#oomph::NavierStokesElementWithSingularity_3C_20BASIC_5FNAVIER_5FSTOKES_5FELEMENT_20_3E_map" alt=""/>
  <map id="oomph::NavierStokesElementWithSingularity_3C_20BASIC_5FNAVIER_5FSTOKES_5FELEMENT_20_3E_map" name="oomph::NavierStokesElementWithSingularity_3C_20BASIC_5FNAVIER_5FSTOKES_5FELEMENT_20_3E_map">
<area href="../../d2/d41/classBASIC__NAVIER__STOKES__ELEMENT.html" alt="BASIC_NAVIER_STOKES_ELEMENT" shape="rect" coords="0,0,493,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:adbcdcd25211d50ffd002868a63d28008"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#adbcdcd25211d50ffd002868a63d28008">NavierStokesElementWithSingularity</a> ()</td></tr>
<tr class="memdesc:adbcdcd25211d50ffd002868a63d28008"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#adbcdcd25211d50ffd002868a63d28008">More...</a><br /></td></tr>
<tr class="separator:adbcdcd25211d50ffd002868a63d28008"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adab71c6a0279c1051a75dc28a782419d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#adab71c6a0279c1051a75dc28a782419d">impose_velocity_dirichlet_bc_on_node</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;d)</td></tr>
<tr class="separator:adab71c6a0279c1051a75dc28a782419d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f8083648d80c1555e795e426c29cc0b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a9f8083648d80c1555e795e426c29cc0b">undo_velocity_dirichlet_bc_on_node</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;d)</td></tr>
<tr class="separator:a9f8083648d80c1555e795e426c29cc0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f523c672c3b37b06fec89ef112e7849"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a4f523c672c3b37b06fec89ef112e7849">set_velocity_dirichlet_value_on_node</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;d, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;value)</td></tr>
<tr class="separator:a4f523c672c3b37b06fec89ef112e7849"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72dc34cd610715b35813dfd7d7f00f26"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a72dc34cd610715b35813dfd7d7f00f26">impose_dirichlet_bc_on_pressure_dof</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>)</td></tr>
<tr class="memdesc:a72dc34cd610715b35813dfd7d7f00f26"><td class="mdescLeft">&#160;</td><td class="mdescRight">Impose Dirichlet BC at the j-th pressure dof.  <a href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a72dc34cd610715b35813dfd7d7f00f26">More...</a><br /></td></tr>
<tr class="separator:a72dc34cd610715b35813dfd7d7f00f26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d66ba2ee335de530ca4b367df082c98"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a0d66ba2ee335de530ca4b367df082c98">undo_dirichlet_bc_on_pressure_dof</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>)</td></tr>
<tr class="memdesc:a0d66ba2ee335de530ca4b367df082c98"><td class="mdescLeft">&#160;</td><td class="mdescRight">Undo Dirichlet BC at the j-th pressure dof.  <a href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a0d66ba2ee335de530ca4b367df082c98">More...</a><br /></td></tr>
<tr class="separator:a0d66ba2ee335de530ca4b367df082c98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d8d730940b13382838c19c7d999a75d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a1d8d730940b13382838c19c7d999a75d">set_dirichlet_value_on_pressure_dof</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;value)</td></tr>
<tr class="memdesc:a1d8d730940b13382838c19c7d999a75d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Specify Dirichlet boundary value for the j-th pressure dof.  <a href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a1d8d730940b13382838c19c7d999a75d">More...</a><br /></td></tr>
<tr class="separator:a1d8d730940b13382838c19c7d999a75d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a404c8928ad32707621aea949314f78e3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d2/d38/classoomph_1_1SingularNavierStokesSolutionElement.html">SingularNavierStokesSolutionElement</a>&lt; <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html">NavierStokesElementWithSingularity</a>&lt; <a class="el" href="../../d2/d41/classBASIC__NAVIER__STOKES__ELEMENT.html">BASIC_NAVIER_STOKES_ELEMENT</a> &gt; &gt; * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a404c8928ad32707621aea949314f78e3">c_equation_elements_pt</a> ()</td></tr>
<tr class="memdesc:a404c8928ad32707621aea949314f78e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access function to vector of pointers to SingularNavierStokesSolutionElements.  <a href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a404c8928ad32707621aea949314f78e3">More...</a><br /></td></tr>
<tr class="separator:a404c8928ad32707621aea949314f78e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12391fa78c148c3d2f35217891c95333"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a12391fa78c148c3d2f35217891c95333">add_c_equation_element_pt</a> (<a class="el" href="../../d2/d38/classoomph_1_1SingularNavierStokesSolutionElement.html">SingularNavierStokesSolutionElement</a>&lt; <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html">NavierStokesElementWithSingularity</a>&lt; <a class="el" href="../../d2/d41/classBASIC__NAVIER__STOKES__ELEMENT.html">BASIC_NAVIER_STOKES_ELEMENT</a> &gt; &gt; *c_pt)</td></tr>
<tr class="separator:a12391fa78c148c3d2f35217891c95333"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0831a3f22e63f10e1263855d10a13d7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#ab0831a3f22e63f10e1263855d10a13d7">dpdx_fe_only</a> (<a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; <a class="el" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> *direction_pt)</td></tr>
<tr class="memdesc:ab0831a3f22e63f10e1263855d10a13d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Derivative of pressure in direction indicated by pointer to unsigned.  <a href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#ab0831a3f22e63f10e1263855d10a13d7">More...</a><br /></td></tr>
<tr class="separator:ab0831a3f22e63f10e1263855d10a13d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29a143e415d539fae575f87fa18accc4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a29a143e415d539fae575f87fa18accc4">fill_in_contribution_to_residuals</a> (<a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;residuals)</td></tr>
<tr class="memdesc:a29a143e415d539fae575f87fa18accc4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add the element's contribution to its residual vector (wrapper)  <a href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a29a143e415d539fae575f87fa18accc4">More...</a><br /></td></tr>
<tr class="separator:a29a143e415d539fae575f87fa18accc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37e1e854434870f29d919be64da5ea35"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a37e1e854434870f29d919be64da5ea35">fill_in_contribution_to_jacobian</a> (<a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;residuals, <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;jacobian)</td></tr>
<tr class="separator:a37e1e854434870f29d919be64da5ea35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a761bc0ae9bed2102b8019b5c95e04b9c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a761bc0ae9bed2102b8019b5c95e04b9c">output</a> (std::ostream &amp;outfile, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;nplot)</td></tr>
<tr class="separator:a761bc0ae9bed2102b8019b5c95e04b9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9e17bf51b565d0b893c4383d8a27160"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#aa9e17bf51b565d0b893c4383d8a27160">compute_error</a> (std::ostream &amp;outfile, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a690fd33af26cc3e84f39bba6d5a85202">FiniteElement::SteadyExactSolutionFctPt</a> exact_soln_pt, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;include_pressure, <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;error, <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;norm)</td></tr>
<tr class="memdesc:aa9e17bf51b565d0b893c4383d8a27160"><td class="mdescLeft">&#160;</td><td class="mdescRight">Overloaded compute error function; uses FE+singular parts.  <a href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#aa9e17bf51b565d0b893c4383d8a27160">More...</a><br /></td></tr>
<tr class="separator:aa9e17bf51b565d0b893c4383d8a27160"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7b2def1d994ce11abfec7ffc06b9316"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#aa7b2def1d994ce11abfec7ffc06b9316">interpolated_u_nst</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>) const</td></tr>
<tr class="separator:aa7b2def1d994ce11abfec7ffc06b9316"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44747a2e23d6d50df204e7ba15e944d7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a44747a2e23d6d50df204e7ba15e944d7">interpolated_p_nst</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>) const</td></tr>
<tr class="memdesc:a44747a2e23d6d50df204e7ba15e944d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Version of interpolated pressure including the singular contributions.  <a href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a44747a2e23d6d50df204e7ba15e944d7">More...</a><br /></td></tr>
<tr class="separator:a44747a2e23d6d50df204e7ba15e944d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:af9dc732aa08f0d6d9c8150dae69997d5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#af9dc732aa08f0d6d9c8150dae69997d5">u_bar</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a61b7da262276970831d88a2f37dbe509">x</a>) const</td></tr>
<tr class="separator:af9dc732aa08f0d6d9c8150dae69997d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a714b50ba73a6f6ddeec2b3a4b3aedd2a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a714b50ba73a6f6ddeec2b3a4b3aedd2a">u_bar</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a61b7da262276970831d88a2f37dbe509">x</a>) const</td></tr>
<tr class="separator:a714b50ba73a6f6ddeec2b3a4b3aedd2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97093004bb204ccbce7378a922fed90f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a97093004bb204ccbce7378a922fed90f">grad_u_bar</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a61b7da262276970831d88a2f37dbe509">x</a>) const</td></tr>
<tr class="separator:a97093004bb204ccbce7378a922fed90f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79f4f2c1d75c1242a3e4a0d38b836bd1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a79f4f2c1d75c1242a3e4a0d38b836bd1">grad_u_bar</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a61b7da262276970831d88a2f37dbe509">x</a>) const</td></tr>
<tr class="separator:a79f4f2c1d75c1242a3e4a0d38b836bd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb5f01f67f37d039b5ac23235a8b8068"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#abb5f01f67f37d039b5ac23235a8b8068">velocity_singular_function</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a61b7da262276970831d88a2f37dbe509">x</a>) const</td></tr>
<tr class="memdesc:abb5f01f67f37d039b5ac23235a8b8068"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate i-th "raw" velocity singular function at Eulerian position x.  <a href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#abb5f01f67f37d039b5ac23235a8b8068">More...</a><br /></td></tr>
<tr class="separator:abb5f01f67f37d039b5ac23235a8b8068"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f9c4cb837e755c1bc58b23337948686"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a2f9c4cb837e755c1bc58b23337948686">grad_velocity_singular_function</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a61b7da262276970831d88a2f37dbe509">x</a>) const</td></tr>
<tr class="separator:a2f9c4cb837e755c1bc58b23337948686"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1389196153bcd2226f0d152b934616a7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a1389196153bcd2226f0d152b934616a7">pressure_singular_function</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a61b7da262276970831d88a2f37dbe509">x</a>) const</td></tr>
<tr class="separator:a1389196153bcd2226f0d152b934616a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ccff7d1ace73d2a5a55a667fbb9f0fc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a5ccff7d1ace73d2a5a55a667fbb9f0fc">p_bar</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a61b7da262276970831d88a2f37dbe509">x</a>) const</td></tr>
<tr class="separator:a5ccff7d1ace73d2a5a55a667fbb9f0fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39b31b71c18f4af12bca11822c94eb1c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a39b31b71c18f4af12bca11822c94eb1c">p_bar</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a61b7da262276970831d88a2f37dbe509">x</a>) const</td></tr>
<tr class="separator:a39b31b71c18f4af12bca11822c94eb1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06a52e85914108f2d1a15e7cdd32f6ce"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a06a52e85914108f2d1a15e7cdd32f6ce">interpolated_u_nst_fe_only</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>) const</td></tr>
<tr class="separator:a06a52e85914108f2d1a15e7cdd32f6ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c82dadf6222573db57658dd7a07814d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a3c82dadf6222573db57658dd7a07814d">interpolated_p_nst_fe_only</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>) const</td></tr>
<tr class="separator:a3c82dadf6222573db57658dd7a07814d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a642a15e66dc365e263282ee55c97d865"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a642a15e66dc365e263282ee55c97d865">fill_in_generic_residual_contribution_wrapped_nst</a> (<a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;residuals, <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;jacobian, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;flag)</td></tr>
<tr class="memdesc:a642a15e66dc365e263282ee55c97d865"><td class="mdescLeft">&#160;</td><td class="mdescRight">Overloaded fill-in function.  <a href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a642a15e66dc365e263282ee55c97d865">More...</a><br /></td></tr>
<tr class="separator:a642a15e66dc365e263282ee55c97d865"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:ade8e0319c2406edbde788d76f838fdb2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d2/d38/classoomph_1_1SingularNavierStokesSolutionElement.html">SingularNavierStokesSolutionElement</a>&lt; <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html">NavierStokesElementWithSingularity</a>&lt; <a class="el" href="../../d2/d41/classBASIC__NAVIER__STOKES__ELEMENT.html">BASIC_NAVIER_STOKES_ELEMENT</a> &gt; &gt; * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#ade8e0319c2406edbde788d76f838fdb2">C_equation_elements_pt</a></td></tr>
<tr class="memdesc:ade8e0319c2406edbde788d76f838fdb2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector of pointers to SingularNavierStokesSolutionElement objects.  <a href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#ade8e0319c2406edbde788d76f838fdb2">More...</a><br /></td></tr>
<tr class="separator:ade8e0319c2406edbde788d76f838fdb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf0d4a9df3144e6398b651edaf1b1c06"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; std::vector&lt; <a class="el" href="../../d9/db9/classbool.html">bool</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#acf0d4a9df3144e6398b651edaf1b1c06">Node_is_subject_to_velocity_dirichlet_bcs</a></td></tr>
<tr class="separator:acf0d4a9df3144e6398b651edaf1b1c06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29259e92474af81a7fced94e1b6ab71e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a29259e92474af81a7fced94e1b6ab71e">Imposed_velocity_values_at_node</a></td></tr>
<tr class="separator:a29259e92474af81a7fced94e1b6ab71e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bed60435675e93b3c2f64e0b6a62bab"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="../../d9/db9/classbool.html">bool</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a4bed60435675e93b3c2f64e0b6a62bab">Pressure_dof_is_subject_to_dirichlet_bc</a></td></tr>
<tr class="separator:a4bed60435675e93b3c2f64e0b6a62bab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3226a346cc3eb121b2e6ebdd33c87400"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a3226a346cc3eb121b2e6ebdd33c87400">Imposed_value_at_pressure_dof</a></td></tr>
<tr class="separator:a3226a346cc3eb121b2e6ebdd33c87400"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;class BASIC_NAVIER_STOKES_ELEMENT&gt;<br />
class oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;</h3>

<p>///////////////////////////////////////////////////////////////// ///////////////////////////////////////////////////////////////// ///////////////////////////////////////////////////////////////// Templated wrapper to add handling of singularities to the underlying Navier-Stokes element (specified via the template argument). Slightly inefficient because the integration loop is repeated here. The only alternative is to add the additional functionality into the Navier-Stokes elements. Not pretty either! NOTE Element ia assumed to be of Taylor Hood type with pressures stored at nodes.</p>
<p>Dirichlet BCs are applied in hijacking manner and must be imposed from each element that shares a boundary node that is subject to a Dirichlet condition. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="adbcdcd25211d50ffd002868a63d28008"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adbcdcd25211d50ffd002868a63d28008">&#9670;&nbsp;</a></span>NavierStokesElementWithSingularity()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_NAVIER_STOKES_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html">oomph::NavierStokesElementWithSingularity</a>&lt; <a class="el" href="../../d2/d41/classBASIC__NAVIER__STOKES__ELEMENT.html">BASIC_NAVIER_STOKES_ELEMENT</a> &gt;::<a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html">NavierStokesElementWithSingularity</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructor. </p>
<div class="fragment"><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  {</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160; </div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;   <span class="comment">// Find the number of nodes in the element</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;   <span class="keywordtype">unsigned</span> n_node = this-&gt;nnode();</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160; </div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;   <span class="comment">// Find the dimension of the problem</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;   <span class="keywordtype">unsigned</span> cached_dim = this-&gt;dim();</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160; </div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;   <span class="comment">// Initialise the vector indicating which node is subject to velocity</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;   <span class="comment">// Dirichlet BCs. The size of the vector is equal to the number of nodes</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;   <span class="comment">// in the element. Each component of the vector is a vector of booleans</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;   <span class="comment">// indicating if the velocity components at the corresponding node are</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;   <span class="comment">// subject to Dirichlet BC. By default, no node is subject to Dirichlet BC,</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;   <span class="comment">// so the vector is full of false. </span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;   <a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#acf0d4a9df3144e6398b651edaf1b1c06">Node_is_subject_to_velocity_dirichlet_bcs</a>.resize(n_node);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>=0;<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>&lt;n_node;<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    {</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;     <a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#acf0d4a9df3144e6398b651edaf1b1c06">Node_is_subject_to_velocity_dirichlet_bcs</a>[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>].resize(cached_dim);</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> d=0;d&lt;cached_dim;d++)</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;      {</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;       <a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#acf0d4a9df3144e6398b651edaf1b1c06">Node_is_subject_to_velocity_dirichlet_bcs</a>[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>][d] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;      }</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    }</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160; </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;   <span class="comment">// Initialise the vector of imposed velocity values on the nodes</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;   <span class="comment">// subject to Dirichlet BC. The size of the vector is equal to the</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;   <span class="comment">// number of nodes in the element. Each component of the vector is</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;   <span class="comment">// a vector of length the dimension of the problem. This vector contains</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;   <span class="comment">// the imposed values of the velocity vector at the corresponding node.</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;   <span class="comment">// If a node is not subject to Dirichlet BC, its imposed values are zero.</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;   <span class="comment">// By default, no node is subject to Dirichlet BC so the vector is full</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;   <span class="comment">// of zeros</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;   <a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a29259e92474af81a7fced94e1b6ab71e">Imposed_velocity_values_at_node</a>.resize(n_node);</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>=0;<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>&lt;n_node;<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    {</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;     <a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a29259e92474af81a7fced94e1b6ab71e">Imposed_velocity_values_at_node</a>[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>].resize(cached_dim);</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> d=0;d&lt;cached_dim;d++)</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;      {</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;       <a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a29259e92474af81a7fced94e1b6ab71e">Imposed_velocity_values_at_node</a>[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>][d] = 0.0;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      }</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    }</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160; </div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;   <span class="comment">// Find the number of pressure dofs</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;   <span class="keywordtype">unsigned</span> n_pres = this-&gt;npres_nst();</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160; </div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;   <span class="comment">// Initialise the vector indicating which pressure dof is subject to</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;   <span class="comment">// Dirichlet BCs. The size of the vector is equal to the number of pressure</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;   <span class="comment">// dofs in the element. Each component of the vector is a boolean</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;   <span class="comment">// indicating if the corresponding pressure unknown is subject to Dirichlet</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;   <span class="comment">// BC. By default, no pressure dof is subject to Dirichlet BC, so the vector</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;   <span class="comment">// is full of false. </span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;   <a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a4bed60435675e93b3c2f64e0b6a62bab">Pressure_dof_is_subject_to_dirichlet_bc</a>.resize(n_pres);</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> l=0;l&lt;n_pres;l++)</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    {</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;     <a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a4bed60435675e93b3c2f64e0b6a62bab">Pressure_dof_is_subject_to_dirichlet_bc</a>[l] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    }</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160; </div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;   <span class="comment">// Initialise the vector of imposed values on the pressure dofs</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;   <span class="comment">// subject to Dirichlet BC. The size of the vector is equal to the</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;   <span class="comment">// number of pressure dofs in the element. Each component of </span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;   <span class="comment">// the vector contains the imposed value at the corresponding pressure dof.</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;   <span class="comment">// If a pressure dof is not subject to Dirichlet BC, its imposed value </span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;   <span class="comment">// is zero. By default, no pressure dof is subject to Dirichlet BC </span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;   <span class="comment">// so the vector is full of zeros</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;   <a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a3226a346cc3eb121b2e6ebdd33c87400">Imposed_value_at_pressure_dof</a>.resize(n_node);</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> l=0;l&lt;n_pres;l++)</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    {</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;     <a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a3226a346cc3eb121b2e6ebdd33c87400">Imposed_value_at_pressure_dof</a>[l] = 0.0;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    }</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;   </div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  } <span class="comment">// End of constructor</span></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesElementWithSingularity_html_a29259e92474af81a7fced94e1b6ab71e"><div class="ttname"><a href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a29259e92474af81a7fced94e1b6ab71e">oomph::NavierStokesElementWithSingularity::Imposed_velocity_values_at_node</a></div><div class="ttdeci">Vector&lt; Vector&lt; double &gt; &gt; Imposed_velocity_values_at_node</div><div class="ttdef"><b>Definition:</b> navier_stokes_elements_with_singularity.h:1643</div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesElementWithSingularity_html_a3226a346cc3eb121b2e6ebdd33c87400"><div class="ttname"><a href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a3226a346cc3eb121b2e6ebdd33c87400">oomph::NavierStokesElementWithSingularity::Imposed_value_at_pressure_dof</a></div><div class="ttdeci">Vector&lt; double &gt; Imposed_value_at_pressure_dof</div><div class="ttdef"><b>Definition:</b> navier_stokes_elements_with_singularity.h:1652</div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesElementWithSingularity_html_a4bed60435675e93b3c2f64e0b6a62bab"><div class="ttname"><a href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a4bed60435675e93b3c2f64e0b6a62bab">oomph::NavierStokesElementWithSingularity::Pressure_dof_is_subject_to_dirichlet_bc</a></div><div class="ttdeci">std::vector&lt; bool &gt; Pressure_dof_is_subject_to_dirichlet_bc</div><div class="ttdef"><b>Definition:</b> navier_stokes_elements_with_singularity.h:1647</div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesElementWithSingularity_html_acf0d4a9df3144e6398b651edaf1b1c06"><div class="ttname"><a href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#acf0d4a9df3144e6398b651edaf1b1c06">oomph::NavierStokesElementWithSingularity::Node_is_subject_to_velocity_dirichlet_bcs</a></div><div class="ttdeci">Vector&lt; std::vector&lt; bool &gt; &gt; Node_is_subject_to_velocity_dirichlet_bcs</div><div class="ttdef"><b>Definition:</b> navier_stokes_elements_with_singularity.h:1638</div></div>
<div class="ttc" id="atut__arithmetic__redux__minmax_8cpp_html_a39513f0f8d942bf9ef17b2e87ac6d34e"><div class="ttname"><a href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a></div><div class="ttdeci">std::ptrdiff_t j</div><div class="ttdef"><b>Definition:</b> tut_arithmetic_redux_minmax.cpp:2</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a3226a346cc3eb121b2e6ebdd33c87400">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::Imposed_value_at_pressure_dof</a>, <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a29259e92474af81a7fced94e1b6ab71e">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::Imposed_velocity_values_at_node</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#acf0d4a9df3144e6398b651edaf1b1c06">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::Node_is_subject_to_velocity_dirichlet_bcs</a>, and <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a4bed60435675e93b3c2f64e0b6a62bab">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::Pressure_dof_is_subject_to_dirichlet_bc</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a12391fa78c148c3d2f35217891c95333"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12391fa78c148c3d2f35217891c95333">&#9670;&nbsp;</a></span>add_c_equation_element_pt()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_NAVIER_STOKES_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html">oomph::NavierStokesElementWithSingularity</a>&lt; <a class="el" href="../../d2/d41/classBASIC__NAVIER__STOKES__ELEMENT.html">BASIC_NAVIER_STOKES_ELEMENT</a> &gt;::add_c_equation_element_pt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d38/classoomph_1_1SingularNavierStokesSolutionElement.html">SingularNavierStokesSolutionElement</a>&lt; <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html">NavierStokesElementWithSingularity</a>&lt; <a class="el" href="../../d2/d41/classBASIC__NAVIER__STOKES__ELEMENT.html">BASIC_NAVIER_STOKES_ELEMENT</a> &gt; &gt; *&#160;</td>
          <td class="paramname"><em>c_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Add pointer to associated SingularNavierStokesSolutionElement that determines the value of the amplitude of the singular functions (and gives access to the singular functions). The unknown amplitude becomes external Data for this element so assign_eqn_numbers() must be called after this function has been called. <br  />
 </p>
<div class="fragment"><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160; {</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  <span class="comment">// Add the element</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  <a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#ade8e0319c2406edbde788d76f838fdb2">C_equation_elements_pt</a>.push_back(c_pt);</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  </div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  <span class="comment">// Add the additional unknown of this object as external data in the</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  <span class="comment">// Navier-Stokes element</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  this-&gt;add_external_data(c_pt-&gt;internal_data_pt(0));</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160; }</div>
<div class="ttc" id="aclassoomph_1_1NavierStokesElementWithSingularity_html_ade8e0319c2406edbde788d76f838fdb2"><div class="ttname"><a href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#ade8e0319c2406edbde788d76f838fdb2">oomph::NavierStokesElementWithSingularity::C_equation_elements_pt</a></div><div class="ttdeci">Vector&lt; SingularNavierStokesSolutionElement&lt; NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt; &gt; * &gt; C_equation_elements_pt</div><div class="ttdoc">Vector of pointers to SingularNavierStokesSolutionElement objects.</div><div class="ttdef"><b>Definition:</b> navier_stokes_elements_with_singularity.h:1633</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#ade8e0319c2406edbde788d76f838fdb2">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::C_equation_elements_pt</a>.</p>

</div>
</div>
<a id="a404c8928ad32707621aea949314f78e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a404c8928ad32707621aea949314f78e3">&#9670;&nbsp;</a></span>c_equation_elements_pt()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_NAVIER_STOKES_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt;<a class="el" href="../../d2/d38/classoomph_1_1SingularNavierStokesSolutionElement.html">SingularNavierStokesSolutionElement</a>&lt;<a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html">NavierStokesElementWithSingularity</a> &lt;<a class="el" href="../../d2/d41/classBASIC__NAVIER__STOKES__ELEMENT.html">BASIC_NAVIER_STOKES_ELEMENT</a>&gt; &gt;*&gt; <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html">oomph::NavierStokesElementWithSingularity</a>&lt; <a class="el" href="../../d2/d41/classBASIC__NAVIER__STOKES__ELEMENT.html">BASIC_NAVIER_STOKES_ELEMENT</a> &gt;::c_equation_elements_pt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Access function to vector of pointers to SingularNavierStokesSolutionElements. </p>
<div class="fragment"><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  {<span class="keywordflow">return</span> <a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#ade8e0319c2406edbde788d76f838fdb2">C_equation_elements_pt</a>;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#ade8e0319c2406edbde788d76f838fdb2">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::C_equation_elements_pt</a>.</p>

</div>
</div>
<a id="aa9e17bf51b565d0b893c4383d8a27160"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9e17bf51b565d0b893c4383d8a27160">&#9670;&nbsp;</a></span>compute_error()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_NAVIER_STOKES_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html">oomph::NavierStokesElementWithSingularity</a>&lt; <a class="el" href="../../d2/d41/classBASIC__NAVIER__STOKES__ELEMENT.html">BASIC_NAVIER_STOKES_ELEMENT</a> &gt;::compute_error </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>outfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a690fd33af26cc3e84f39bba6d5a85202">FiniteElement::SteadyExactSolutionFctPt</a>&#160;</td>
          <td class="paramname"><em>exact_soln_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;&#160;</td>
          <td class="paramname"><em>include_pressure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>error</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>norm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Overloaded compute error function; uses FE+singular parts. </p>
<div class="fragment"><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;{</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160; </div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160; <span class="keywordtype">unsigned</span> cached_dim=this-&gt;dim();</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160; </div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160; <a class="code" href="../../d9/d33/namespacecalibrate.html#a4dbebf21da853ac368a3a9af2fbab442">error</a>=0.0;</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160; norm=0.0;</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160; </div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160; <span class="comment">//Vector of local coordinates</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160; Vector&lt;double&gt; <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>(cached_dim);</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160; </div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160; <span class="comment">// Vector for coordintes</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160; Vector&lt;double&gt; <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>(cached_dim);</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160; </div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160; <span class="comment">//Set the value of n_intpt</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160; <span class="keywordtype">unsigned</span> n_intpt = this-&gt;integral_pt()-&gt;nweight();</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;   </div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160; </div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160; outfile &lt;&lt; <span class="stringliteral">&quot;ZONE&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160; </div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160; <span class="comment">// Exact solution Vector (u,v,[w],p)</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160; Vector&lt;double&gt; <a class="code" href="../../d6/d6d/namespaceProblemParameters.html#a36e4b27a055339709d0f982d004b622a">exact_soln</a>(cached_dim+1);</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160; Vector&lt;double&gt; computed_soln(cached_dim+1);</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;   </div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160; <span class="comment">//Loop over the integration points</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ipt=0;ipt&lt;n_intpt;ipt++)</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;  {</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160; </div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;   <span class="comment">//Assign values of s</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;cached_dim;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    {</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;     <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = this-&gt;integral_pt()-&gt;knot(ipt,<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    }</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160; </div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;   <span class="comment">//Get the integral weight</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;   <span class="keywordtype">double</span> <a class="code" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a> = this-&gt;integral_pt()-&gt;weight(ipt);</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160; </div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;   <span class="comment">// Get jacobian of mapping</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;   <span class="keywordtype">double</span> <a class="code" href="../../dc/da8/Jacobi__makeJacobi_8cpp.html#a4804f9d1c212b9655934738d0ae395ab">J</a>=this-&gt;J_eulerian(<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>);</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160; </div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;   <span class="comment">//Premultiply the weights and the Jacobian</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;   <span class="keywordtype">double</span> <a class="code" href="../../dc/d00/namespaceoomph_1_1QuadTreeNames.html#a9ac199adb82120cbaa47bf2365918ab9aabab2a070c062503375f8264f1b6d7d6">W</a> = <a class="code" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a>*<a class="code" href="../../dc/da8/Jacobi__makeJacobi_8cpp.html#a4804f9d1c212b9655934738d0ae395ab">J</a>;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160; </div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;   <span class="comment">// Get x position as Vector</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;   this-&gt;interpolated_x(<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>,<a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>);</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160; </div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;   <span class="comment">// Get exact solution at this point</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;   (*exact_soln_pt)(<a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>,<a class="code" href="../../d6/d6d/namespaceProblemParameters.html#a36e4b27a055339709d0f982d004b622a">exact_soln</a>);</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;   Vector&lt;double&gt; u_comp=<a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#aa7b2def1d994ce11abfec7ffc06b9316">interpolated_u_nst</a>(<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>);</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;cached_dim;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    {</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;     computed_soln[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]=u_comp[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    }</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;   <span class="keywordtype">unsigned</span> hi_limit=cached_dim;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;   <span class="keywordflow">if</span> (include_pressure)</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    {</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;     computed_soln[cached_dim]=<a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a44747a2e23d6d50df204e7ba15e944d7">interpolated_p_nst</a>(<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>); </div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;     hi_limit=cached_dim+1;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    }</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160; </div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160; </div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;   <span class="comment">// Velocity error</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;hi_limit;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    {</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;     norm+=<a class="code" href="../../d6/d6d/namespaceProblemParameters.html#a36e4b27a055339709d0f982d004b622a">exact_soln</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]*<a class="code" href="../../d6/d6d/namespaceProblemParameters.html#a36e4b27a055339709d0f982d004b622a">exact_soln</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]*<a class="code" href="../../dc/d00/namespaceoomph_1_1QuadTreeNames.html#a9ac199adb82120cbaa47bf2365918ab9aabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;     <a class="code" href="../../d9/d33/namespacecalibrate.html#a4dbebf21da853ac368a3a9af2fbab442">error</a>+=(<a class="code" href="../../d6/d6d/namespaceProblemParameters.html#a36e4b27a055339709d0f982d004b622a">exact_soln</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-computed_soln[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>])*</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;      (<a class="code" href="../../d6/d6d/namespaceProblemParameters.html#a36e4b27a055339709d0f982d004b622a">exact_soln</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-computed_soln[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>])*<a class="code" href="../../dc/d00/namespaceoomph_1_1QuadTreeNames.html#a9ac199adb82120cbaa47bf2365918ab9aabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    }</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160; </div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;   <span class="comment">//Output x,y,...,u_exact,...]</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;cached_dim;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    {</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;     outfile &lt;&lt; <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    }</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160; </div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;   <span class="comment">//Output x,y,[z],u_error,v_error,[w_error], [p_error]</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;hi_limit;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    {</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;     outfile &lt;&lt; <a class="code" href="../../d6/d6d/namespaceProblemParameters.html#a36e4b27a055339709d0f982d004b622a">exact_soln</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-computed_soln[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    }</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;   outfile &lt;&lt; std::endl;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;  }</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;}</div>
<div class="ttc" id="aBiCGSTAB__step__by__step_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> BiCGSTAB_step_by_step.cpp:9</div></div>
<div class="ttc" id="aJacobi__makeJacobi_8cpp_html_a4804f9d1c212b9655934738d0ae395ab"><div class="ttname"><a href="../../dc/da8/Jacobi__makeJacobi_8cpp.html#a4804f9d1c212b9655934738d0ae395ab">J</a></div><div class="ttdeci">JacobiRotation&lt; float &gt; J</div><div class="ttdef"><b>Definition:</b> Jacobi_makeJacobi.cpp:3</div></div>
<div class="ttc" id="aMatrix__resize__int_8cpp_html_aab236ce080522c9832217fd5f157541b"><div class="ttname"><a href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a></div><div class="ttdeci">RowVector3d w</div><div class="ttdef"><b>Definition:</b> Matrix_resize_int.cpp:3</div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesElementWithSingularity_html_a44747a2e23d6d50df204e7ba15e944d7"><div class="ttname"><a href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a44747a2e23d6d50df204e7ba15e944d7">oomph::NavierStokesElementWithSingularity::interpolated_p_nst</a></div><div class="ttdeci">double interpolated_p_nst(const Vector&lt; double &gt; &amp;s) const</div><div class="ttdoc">Version of interpolated pressure including the singular contributions.</div><div class="ttdef"><b>Definition:</b> navier_stokes_elements_with_singularity.h:893</div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesElementWithSingularity_html_aa7b2def1d994ce11abfec7ffc06b9316"><div class="ttname"><a href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#aa7b2def1d994ce11abfec7ffc06b9316">oomph::NavierStokesElementWithSingularity::interpolated_u_nst</a></div><div class="ttdeci">Vector&lt; double &gt; interpolated_u_nst(const Vector&lt; double &gt; &amp;s) const</div><div class="ttdef"><b>Definition:</b> navier_stokes_elements_with_singularity.h:848</div></div>
<div class="ttc" id="alevel1__cplx__impl_8h_html_a462761ca92ad97a9a705cb875828b0b8"><div class="ttname"><a href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a></div><div class="ttdeci">RealScalar s</div><div class="ttdef"><b>Definition:</b> level1_cplx_impl.h:130</div></div>
<div class="ttc" id="anamespaceProblemParameters_html_a36e4b27a055339709d0f982d004b622a"><div class="ttname"><a href="../../d6/d6d/namespaceProblemParameters.html#a36e4b27a055339709d0f982d004b622a">ProblemParameters::exact_soln</a></div><div class="ttdeci">void exact_soln(const double &amp;time, const Vector&lt; double &gt; &amp;x, Vector&lt; double &gt; &amp;soln)</div><div class="ttdef"><b>Definition:</b> unstructured_two_d_curved.cc:301</div></div>
<div class="ttc" id="anamespacecalibrate_html_a4dbebf21da853ac368a3a9af2fbab442"><div class="ttname"><a href="../../d9/d33/namespacecalibrate.html#a4dbebf21da853ac368a3a9af2fbab442">calibrate.error</a></div><div class="ttdeci">int error</div><div class="ttdef"><b>Definition:</b> calibrate.py:297</div></div>
<div class="ttc" id="anamespaceoomph_1_1QuadTreeNames_html_a9ac199adb82120cbaa47bf2365918ab9aabab2a070c062503375f8264f1b6d7d6"><div class="ttname"><a href="../../dc/d00/namespaceoomph_1_1QuadTreeNames.html#a9ac199adb82120cbaa47bf2365918ab9aabab2a070c062503375f8264f1b6d7d6">oomph::QuadTreeNames::W</a></div><div class="ttdeci">@ W</div><div class="ttdef"><b>Definition:</b> quadtree.h:63</div></div>
<div class="ttc" id="anamespaceplotDoE_html_a4758fc6194247f040938f29c863d21ee"><div class="ttname"><a href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">plotDoE.x</a></div><div class="ttdeci">list x</div><div class="ttdef"><b>Definition:</b> plotDoE.py:28</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d9/d33/namespacecalibrate.html#a4dbebf21da853ac368a3a9af2fbab442">calibrate::error</a>, <a class="el" href="../../d6/d6d/namespaceProblemParameters.html#a36e4b27a055339709d0f982d004b622a">ProblemParameters::exact_soln()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a44747a2e23d6d50df204e7ba15e944d7">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::interpolated_p_nst()</a>, <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#aa7b2def1d994ce11abfec7ffc06b9316">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::interpolated_u_nst()</a>, <a class="el" href="../../dc/da8/Jacobi__makeJacobi_8cpp.html#a4804f9d1c212b9655934738d0ae395ab">J</a>, <a class="el" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>, <a class="el" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a>, <a class="el" href="../../dc/d00/namespaceoomph_1_1QuadTreeNames.html#a9ac199adb82120cbaa47bf2365918ab9aabab2a070c062503375f8264f1b6d7d6">oomph::QuadTreeNames::W</a>, and <a class="el" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">plotDoE::x</a>.</p>

</div>
</div>
<a id="ab0831a3f22e63f10e1263855d10a13d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0831a3f22e63f10e1263855d10a13d7">&#9670;&nbsp;</a></span>dpdx_fe_only()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_NAVIER_STOKES_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html">oomph::NavierStokesElementWithSingularity</a>&lt; <a class="el" href="../../d2/d41/classBASIC__NAVIER__STOKES__ELEMENT.html">BASIC_NAVIER_STOKES_ELEMENT</a> &gt;::dpdx_fe_only </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt;&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> *&#160;</td>
          <td class="paramname"><em>direction_pt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Derivative of pressure in direction indicated by pointer to unsigned. </p>
<div class="fragment"><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160; {</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  <span class="comment">// Find the number of pressure dofs in the wrapped Navier-Stokes </span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  <span class="comment">// element pointed by</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  <span class="comment">// the SingularNavierStokesSolutionElement class</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  <span class="keywordtype">unsigned</span> n_pres = this-&gt;npres_nst();</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160; </div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  <span class="comment">// Find the dimension of the problem</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  <span class="keywordtype">unsigned</span> cached_dim=this-&gt;dim();</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160; </div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  <span class="comment">// Set up memory for the pressure shape functions and their derivatives</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  Shape psip(n_pres), testp(n_pres);</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  DShape dpsipdx(n_pres,cached_dim), dtestpdx(n_pres,cached_dim);</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160; </div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  <span class="comment">// Compute the pressure shape functions and their derivatives</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  <span class="comment">// at the local coordinate S_in_wrapped_navier_stokes_element</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  <span class="comment">// (Test fcts not really needed but nobody&#39;s got around to writing</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  <span class="comment">// a fct that only picks out the basis fcts.</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  this-&gt;dpshape_and_dptest_eulerian_nst</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;   (<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>,psip,dpsipdx,testp,dtestpdx);</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  </div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  <span class="comment">// Initialise the derivative used for the residual</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;  <span class="keywordtype">double</span> interpolated_dpdx_fe_only=0.0;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160; </div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  <span class="comment">// Compute the derivative used for the residual. The direction of the</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  <span class="comment">// derivative is given by *Direction_pt</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>=0;<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>&lt;n_pres;<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;   {</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    interpolated_dpdx_fe_only +=</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;     this-&gt;p_nst(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>)*dpsipdx(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>,*direction_pt);</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;   }</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160; </div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  <span class="keywordflow">return</span> interpolated_dpdx_fe_only;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160; }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, and <a class="el" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>.</p>

</div>
</div>
<a id="a37e1e854434870f29d919be64da5ea35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37e1e854434870f29d919be64da5ea35">&#9670;&nbsp;</a></span>fill_in_contribution_to_jacobian()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_NAVIER_STOKES_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html">oomph::NavierStokesElementWithSingularity</a>&lt; <a class="el" href="../../d2/d41/classBASIC__NAVIER__STOKES__ELEMENT.html">BASIC_NAVIER_STOKES_ELEMENT</a> &gt;::fill_in_contribution_to_jacobian </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>residuals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>jacobian</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Add the element's contribution to its residual vector and element Jacobian matrix (wrapper) </p>
<div class="fragment"><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160; {  </div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  <span class="comment">// Call the generic routine with the flag set to 1 and dummy mass matrix</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  <a class="code" href="../../dc/d34/classEigen_1_1Matrix.html">DenseMatrix&lt;double&gt;</a> mass_matrix;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  this-&gt;<a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a642a15e66dc365e263282ee55c97d865">fill_in_generic_residual_contribution_wrapped_nst</a>(residuals,</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                                                          jacobian,</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                                                          1);</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160; </div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  <span class="comment">/* // FD version if you want to mess around with anything...*/</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;  <span class="comment">/* FiniteElement::fill_in_contribution_to_jacobian(residuals,jacobian); */</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160; }</div>
<div class="ttc" id="aclassEigen_1_1Matrix_html"><div class="ttname"><a href="../../dc/d34/classEigen_1_1Matrix.html">Eigen::Matrix&lt; Scalar, Dynamic, Dynamic &gt;</a></div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesElementWithSingularity_html_a642a15e66dc365e263282ee55c97d865"><div class="ttname"><a href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a642a15e66dc365e263282ee55c97d865">oomph::NavierStokesElementWithSingularity::fill_in_generic_residual_contribution_wrapped_nst</a></div><div class="ttdeci">void fill_in_generic_residual_contribution_wrapped_nst(Vector&lt; double &gt; &amp;residuals, DenseMatrix&lt; double &gt; &amp;jacobian, const unsigned &amp;flag)</div><div class="ttdoc">Overloaded fill-in function.</div><div class="ttdef"><b>Definition:</b> navier_stokes_elements_with_singularity.h:1111</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a642a15e66dc365e263282ee55c97d865">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::fill_in_generic_residual_contribution_wrapped_nst()</a>.</p>

</div>
</div>
<a id="a29a143e415d539fae575f87fa18accc4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29a143e415d539fae575f87fa18accc4">&#9670;&nbsp;</a></span>fill_in_contribution_to_residuals()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_NAVIER_STOKES_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html">oomph::NavierStokesElementWithSingularity</a>&lt; <a class="el" href="../../d2/d41/classBASIC__NAVIER__STOKES__ELEMENT.html">BASIC_NAVIER_STOKES_ELEMENT</a> &gt;::fill_in_contribution_to_residuals </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>residuals</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Add the element's contribution to its residual vector (wrapper) </p>
<div class="fragment"><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160; {</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  <span class="comment">// Call the generic residuals function with flag set to 0</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  <span class="comment">// using a dummy matrix argument</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  this-&gt;<a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a642a15e66dc365e263282ee55c97d865">fill_in_generic_residual_contribution_wrapped_nst</a>(</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;   residuals, </div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;   <a class="code" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#aaaf2daa9ff49f296c1fa72a1819a5659">GeneralisedElement::Dummy_matrix</a>,</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;   0);</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160; }</div>
<div class="ttc" id="aclassoomph_1_1GeneralisedElement_html_aaaf2daa9ff49f296c1fa72a1819a5659"><div class="ttname"><a href="../../dd/d46/classoomph_1_1GeneralisedElement.html#aaaf2daa9ff49f296c1fa72a1819a5659">oomph::GeneralisedElement::Dummy_matrix</a></div><div class="ttdeci">static DenseMatrix&lt; double &gt; Dummy_matrix</div><div class="ttdef"><b>Definition:</b> elements.h:227</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#aaaf2daa9ff49f296c1fa72a1819a5659">oomph::GeneralisedElement::Dummy_matrix</a>, and <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a642a15e66dc365e263282ee55c97d865">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::fill_in_generic_residual_contribution_wrapped_nst()</a>.</p>

</div>
</div>
<a id="a642a15e66dc365e263282ee55c97d865"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a642a15e66dc365e263282ee55c97d865">&#9670;&nbsp;</a></span>fill_in_generic_residual_contribution_wrapped_nst()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_NAVIER_STOKES_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html">oomph::NavierStokesElementWithSingularity</a>&lt; <a class="el" href="../../d2/d41/classBASIC__NAVIER__STOKES__ELEMENT.html">BASIC_NAVIER_STOKES_ELEMENT</a> &gt;::fill_in_generic_residual_contribution_wrapped_nst </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>residuals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>jacobian</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Overloaded fill-in function. </p>
<div class="fragment"><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;{</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160; <span class="comment">// Get the contribution from the underlying wrapped element first</span></div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160; BASIC_NAVIER_STOKES_ELEMENT::fill_in_generic_residual_contribution_nst</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;  (residuals,jacobian,<a class="code" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#aaaf2daa9ff49f296c1fa72a1819a5659">GeneralisedElement::Dummy_matrix</a>,flag);</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160; </div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160; <span class="comment">// Find the dimension of the problem</span></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160; <span class="keywordtype">unsigned</span> cached_dim = this-&gt;dim();</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160; </div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;  <span class="comment">// Do all the singular functions satisfy the Stokes eqn?</span></div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160; <span class="keywordtype">bool</span> all_singular_functions_satisfy_stokes_equation=<span class="keyword">true</span>;</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160; </div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160; <span class="comment">// Find the number of singularities</span></div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160; <span class="keywordtype">unsigned</span> n_sing = <a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#ade8e0319c2406edbde788d76f838fdb2">C_equation_elements_pt</a>.size();</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160; </div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160; <span class="comment">// Find the local equation number of the additional unknowns</span></div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160; Vector&lt;int&gt; local_equation_number_C(n_sing);</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;n_sing;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;  {</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;   local_equation_number_C[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = this-&gt;external_local_eqn(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,0);</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;   <span class="keywordflow">if</span> (!(<a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#ade8e0319c2406edbde788d76f838fdb2">C_equation_elements_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;         singular_function_satisfies_stokes_equation()))</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    {</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;     all_singular_functions_satisfy_stokes_equation=<span class="keyword">false</span>;</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    }</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;  }</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160; </div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160; <span class="comment">// Find out how many nodes there are</span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160; <span class="keywordtype">unsigned</span> n_node = this-&gt;nnode();</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160; </div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160; <span class="comment">// Find out how many pressure dofs there are</span></div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160; <span class="keywordtype">unsigned</span> n_pres = this-&gt;npres_nst();</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160; </div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160; <span class="comment">// Find the indices at which the local velocities are stored</span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160; Vector&lt;unsigned&gt; u_nodal_index(cached_dim);</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> d=0;d&lt;cached_dim;d++)</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;  {</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;   u_nodal_index[d] = this-&gt;u_index_nst(d);</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;  }</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160; </div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160; <span class="comment">// integer to store the local equations</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160; <span class="keywordtype">int</span> local_eqn=0, local_unknown=0;</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160; </div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160; <span class="comment">// Check that there&#39;s no time-dependence</span></div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>=0;<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>&lt;n_node;<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;  {</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;   <span class="keywordflow">if</span> (!(this-&gt;node_pt(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>)-&gt;time_stepper_pt()-&gt;is_steady()))</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    {</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;     std::stringstream error_stream;</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;     error_stream </div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;Currently, the NavierStokesElementWithSingularity elements\n&quot;</span></div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;only work for steady problems, but we have detected a\n&quot;</span></div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;non-steady time-stepper for node &quot;</span> &lt;&lt; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt;&lt; <span class="stringliteral">&quot;.\n&quot;</span></div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;If your problem is time-dependent you&#39;re welcome to \n&quot;</span></div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;volunteer and implement the required functionality in \n\n&quot;</span></div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;   NavierStokesElementWithSingularity::fill_in_generic_residual_contribution_wrapped_nst()\n\n&quot;</span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;      &lt;&lt; std::endl;</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;     <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;      error_stream.str(),</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;      <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;      <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    }</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;  }</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160; </div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160; </div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160; </div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160; <span class="comment">// Check that ALE is disabled</span></div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160; <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="../../da/ddf/namespaceoomph.html#ae5302eaf07e49e53147c42e2e6450eff">ALE_is_disabled</a>)</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;  {</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;   std::stringstream error_stream;</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;   error_stream </div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;Currently, the NavierStokesElementWithSingularity elements\n&quot;</span></div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;only work on fixed meshes, and to check this we require\n&quot;</span></div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;that you assert that this is the case by calling \n\n&quot;</span></div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;   NavierStokesElementWithSingularity::disable_ALE()&quot;</span></div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;\n\n\n&quot;</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;for all bulk Navier-Stokes elements.\n&quot;</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;If your mesh is moving you&#39;re welcome to volunteer and implement\n&quot;</span></div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;the required functionality in \n\n&quot;</span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;   NavierStokesElementWithSingularity::fill_in_generic_residual_contribution_wrapped_nst()\n\n&quot;</span></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;      &lt;&lt; std::endl;</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;     <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;      error_stream.str(),</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;      <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;      <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;  }</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160; </div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160; </div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160; <span class="comment">// Throw an error for now...</span></div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160; <span class="keywordflow">if</span> ((!all_singular_functions_satisfy_stokes_equation)&amp;&amp;(flag==1))</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;  {</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;     std::stringstream error_stream;</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;     error_stream</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;Currently, the analytical computation of the Jacobian for the\n&quot;</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;NavierStokesElementWithSingularity elements\n&quot;</span></div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;only work with singular solutions that satisfy the Stokes eqns.\n&quot;</span></div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;Of course, there&#39;s no way of checking this, so you&#39;ll have to\n&quot;</span></div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;assert that this is the case by calling \n\n&quot;</span></div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;  SingularNavierStokesSolutionElement::singular_function_satisfies_stokes_equation()&quot;</span></div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;\n\n\n&quot;</span></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;for the SingularNavierStokesSolutionElement that specifies the singular functions.\n&quot;</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;If your singular functions do not satisfy the Stokes equations\n&quot;</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;you&#39;re welcome to volunteer and implement the required \n&quot;</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;functionality in \n\n&quot;</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;   NavierStokesElementWithSingularity::fill_in_generic_residual_contribution_wrapped_nst()\n\n&quot;</span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;Fragments of code are already there...\n&quot;</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;Alternatively, use FD-based setup of Jacobian (still there, commented out, in code).\n&quot;</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;The reason this never got implemented is because this case typically only arises\n&quot;</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;when trying to \&quot;blend\&quot; solutions (to give them finite support) and this didn&#39;t\n&quot;</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;seem to work too well and was sort of abandoned. Next person to look at this\n&quot;</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;should consider only adding the non-integrated by parts (source-fct-like) terms\n&quot;</span></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;arising from the singular functions...\n&quot;</span></div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;      &lt;&lt; std::endl;</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;     <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;      error_stream.str(),</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;      <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;      <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;  }</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160; </div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160; <span class="comment">// Get Physical Variables from Element</span></div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160; <span class="comment">// Reynolds number must be multiplied by the density ratio</span></div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160; <span class="keywordtype">double</span> scaled_re = this-&gt;re()*this-&gt;density_ratio();</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160; </div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160; <span class="comment">// Do we need extra bulk terms?</span></div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160; <span class="keywordflow">if</span> ((scaled_re&gt;0.0)||(!all_singular_functions_satisfy_stokes_equation))</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;  {</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;   </div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;   <span class="comment">// Set up memory for the velocity shape and test functions</span></div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;   Shape psif(n_node), testf(n_node);</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;   DShape dpsifdx(n_node,cached_dim), dtestfdx(n_node,cached_dim);</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;   </div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;   <span class="comment">// Set up memory for pressure shape and test functions</span></div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;   Shape psip(n_pres), testp(n_pres);</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;   </div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;   <span class="comment">// Number of integration points</span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;   <span class="keywordtype">unsigned</span> n_intpt = this-&gt;integral_pt()-&gt;nweight();</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;   </div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;   <span class="comment">// Set the vector to hold local coordinates</span></div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;   Vector&lt;double&gt; <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>(cached_dim);</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;   </div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;   <span class="comment">// Cachec viscosity ratio</span></div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;   <span class="keywordtype">double</span> visc_ratio = this-&gt;viscosity_ratio();</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;   </div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;   <span class="comment">// Loop over the integration points</span></div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ipt=0;ipt&lt;n_intpt;ipt++)</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    {</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;     <span class="comment">// Assign values of s</span></div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> d=0;d&lt;cached_dim;d++)</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;      {</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;       <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>[d] = this-&gt;integral_pt()-&gt;knot(ipt,d);</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;      }</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;     </div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;     <span class="comment">// Get the integral weight</span></div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;     <span class="keywordtype">double</span> <a class="code" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a> = this-&gt;integral_pt()-&gt;weight(ipt);</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;     </div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;     <span class="comment">// Call the derivatives of the velocity shape and test functions</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;     <span class="keywordtype">double</span> <a class="code" href="../../dc/da8/Jacobi__makeJacobi_8cpp.html#a4804f9d1c212b9655934738d0ae395ab">J</a> =</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;      this-&gt;dshape_and_dtest_eulerian_at_knot_nst(ipt,psif,dpsifdx,</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                                                  testf,dtestfdx);</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;     </div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;     <span class="comment">// Call the pressure shape and test functions</span></div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;     this-&gt;pshape_nst(<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>,psip,testp);</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;     </div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;     <span class="comment">// Premultiply the weights and the Jacobian</span></div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;     <span class="keywordtype">double</span> <a class="code" href="../../dc/d00/namespaceoomph_1_1QuadTreeNames.html#a9ac199adb82120cbaa47bf2365918ab9aabab2a070c062503375f8264f1b6d7d6">W</a> = <a class="code" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a>*<a class="code" href="../../dc/da8/Jacobi__makeJacobi_8cpp.html#a4804f9d1c212b9655934738d0ae395ab">J</a>;</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;     </div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;     <span class="comment">// Initialise the global coordinate and velocity</span></div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;     Vector&lt;double&gt; interpolated_x(cached_dim,0.0);</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;     Vector&lt;double&gt; interpolated_u(cached_dim,0.0);</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;     <a class="code" href="../../dc/d34/classEigen_1_1Matrix.html">DenseMatrix&lt;double&gt;</a> interpolated_dudx(cached_dim,cached_dim,0.0);    </div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160; </div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;     <span class="comment">// Calculate the global coordinate associated with s</span></div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;     <span class="comment">// Loop over nodes</span></div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++)</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;      {</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;       <span class="comment">// Loop over directions</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;       <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;cached_dim;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;        {</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;         <span class="keywordtype">double</span> u_value = this-&gt;raw_nodal_value(l,u_nodal_index[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;         interpolated_u[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] += u_value*psif[l];</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;         interpolated_x[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] += this-&gt;raw_nodal_position(l,<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)*psif(l);</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>=0;<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>&lt;cached_dim;<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;          {                               </div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;           interpolated_dudx(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) += u_value*dpsifdx(l,<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;          }</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;        }</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;      }</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;     </div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;     <span class="comment">// Get sum of singular functions</span></div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;     Vector&lt;double&gt; u_bar_local=this-&gt;<a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#af9dc732aa08f0d6d9c8150dae69997d5">u_bar</a>(interpolated_x);</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;     Vector&lt;Vector&lt;double&gt; &gt; grad_u_bar_local=this-&gt;<a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a97093004bb204ccbce7378a922fed90f">grad_u_bar</a>(interpolated_x);</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;     <span class="keywordtype">double</span> p_bar_local=this-&gt;<a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a5ccff7d1ace73d2a5a55a667fbb9f0fc">p_bar</a>(interpolated_x);</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160; </div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;     <span class="comment">// Singular functions</span></div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;     Vector&lt;Vector&lt;double&gt; &gt; u_hat_local(n_sing);</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>=0;<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>&lt;n_sing;<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>++)</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;      {</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;       u_hat_local[<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>]=this-&gt;<a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#abb5f01f67f37d039b5ac23235a8b8068">velocity_singular_function</a>(<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>,interpolated_x);</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;      }</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;     Vector&lt;Vector&lt;Vector&lt;double&gt; &gt; &gt; grad_u_hat_local(n_sing);</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>=0;<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>&lt;n_sing;<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>++)</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;      {</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;       grad_u_hat_local[<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>]=</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;        this-&gt;<a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a2f9c4cb837e755c1bc58b23337948686">grad_velocity_singular_function</a>(<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>,interpolated_x);</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;      }</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160; </div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;     <span class="comment">// MOMENTUM EQUATIONS</span></div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;     <span class="comment">//-------------------</span></div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;     </div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;     <span class="comment">// Loop over the velocity test functions</span></div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++)</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;      {</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;       <span class="comment">// Loop over the velocity components</span></div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;       <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;cached_dim;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;        {</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;         <span class="comment">// Find its local equation number</span></div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;         local_eqn = this-&gt;nodal_local_eqn(l,u_nodal_index[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;         </div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;         <span class="comment">// If it is not pinned</span></div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;         <span class="keywordflow">if</span> (local_eqn &gt;= 0)</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;          {</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;           <span class="comment">// If it is not a Dirichlet BC</span></div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;           <span class="keywordflow">if</span> (not(<a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#acf0d4a9df3144e6398b651edaf1b1c06">Node_is_subject_to_velocity_dirichlet_bcs</a>[l][<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]))</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;            {</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160; </div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160; </div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;             <span class="comment">// Linear terms only needed if singular solution doesn&#39;t satisfy</span></div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;             <span class="comment">//--------------------------------------------------------------</span></div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;             <span class="comment">// Stokes eqn</span></div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;             <span class="comment">//-----------</span></div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;             <span class="keywordflow">if</span> (!all_singular_functions_satisfy_stokes_equation)</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;              {</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;               residuals[local_eqn]+=p_bar_local*dtestfdx(l,<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)*<a class="code" href="../../dc/d00/namespaceoomph_1_1QuadTreeNames.html#a9ac199adb82120cbaa47bf2365918ab9aabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>=0;<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>&lt;cached_dim;<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>++)</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;               {</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                residuals[local_eqn] -= visc_ratio*</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;                 (grad_u_bar_local[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>]+this-&gt;<a class="code" href="../../da/d9b/namespaceGlobalPhysicalVariables.html#aa3a738ddb9a50824f9a47b77118cfccc">Gamma</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]*grad_u_bar_local[<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>][<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;                 *dtestfdx(l,<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>)*<a class="code" href="../../dc/d00/namespaceoomph_1_1QuadTreeNames.html#a9ac199adb82120cbaa47bf2365918ab9aabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;               }</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;              }</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;             </div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;             </div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;             <span class="comment">// Nonlinear term. Always add (unless Re=0)</span></div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;             <span class="comment">//-----------------------------------------</span></div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;             <span class="keywordflow">if</span> (scaled_re&gt;0.0)</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;              {</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;               <span class="comment">// Add singular convective terms</span></div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;               <span class="keywordtype">double</span> sum = 0.0;</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;               <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>=0;<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>&lt;cached_dim;<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>++)</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;                {</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;                 sum+=u_bar_local[<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>]*(grad_u_bar_local[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>]+interpolated_dudx(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>))</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;                  +interpolated_u[<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>]*grad_u_bar_local[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>];</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;                }</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;               residuals[local_eqn] -= scaled_re*sum*testf[l]*<a class="code" href="../../dc/d00/namespaceoomph_1_1QuadTreeNames.html#a9ac199adb82120cbaa47bf2365918ab9aabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;               </div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;              }</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160; </div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;             <span class="comment">// Calculate the jacobian</span></div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;             <span class="comment">//-----------------------</span></div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;             <span class="keywordflow">if</span>(flag)</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;              {</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160; </div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;               <span class="keywordflow">if</span> (scaled_re&gt;0.0)</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;                {</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;                 <span class="comment">// Loop over the singularities and add the </span></div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;                 <span class="comment">// contributions of the additional </span></div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;                 <span class="comment">// unknowns associated with them to the </span></div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;                 <span class="comment">// jacobian if they are not pinned</span></div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;                 <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ss=0;ss&lt;n_sing;ss++)</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;                  {</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;                   local_unknown=local_equation_number_C[ss];</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;                   <span class="keywordflow">if</span> (local_unknown&gt;=0)</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;                    {</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;                     <span class="keywordtype">double</span> sum=0.0;</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;                     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>=0;<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>&lt;cached_dim;<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>++)</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;                      {</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;                       sum+=u_hat_local[ss][<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>]*(grad_u_bar_local[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>]+</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;                                                interpolated_dudx(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>))+</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;                        grad_u_hat_local[ss][<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>]*</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;                        (u_bar_local[<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>]+interpolated_u[<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>]);</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;                      }</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;                     jacobian(local_eqn,local_unknown)-=scaled_re*sum*testf[l]*<a class="code" href="../../dc/d00/namespaceoomph_1_1QuadTreeNames.html#a9ac199adb82120cbaa47bf2365918ab9aabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;                    }</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;                  }</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;                 </div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;                 </div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;                 <span class="comment">//Loop over the velocity shape functions again</span></div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;                 <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l2=0;l2&lt;n_node;l2++)</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;                  { </div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;                   <span class="comment">//Loop over the velocity components again</span></div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;                   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i2=0;i2&lt;cached_dim;i2++)</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;                    {</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;                     <span class="comment">//If at a non-zero degree of freedom add in the entry</span></div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;                     local_unknown = this-&gt;nodal_local_eqn(l2,u_nodal_index[i2]);</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;                     <span class="keywordflow">if</span>(local_unknown &gt;= 0)</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;                      {</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;                       <span class="keywordtype">double</span> sum=0.0;</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;                       <span class="keywordflow">if</span> (<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>==i2)</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;                        {</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;                         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>=0;<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>&lt;cached_dim;<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>++)</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;                          {</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;                           sum+=u_bar_local[<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>]*dpsifdx(l2,<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>);</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;                          }</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;                        }</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;                       sum+=psif(l2)*grad_u_bar_local[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>][i2];</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;                       </div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;                       <span class="comment">//Add contribution to Elemental Matrix</span></div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;                       jacobian(local_eqn,local_unknown) -=</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;                        scaled_re*sum*testf[l]*<a class="code" href="../../dc/d00/namespaceoomph_1_1QuadTreeNames.html#a9ac199adb82120cbaa47bf2365918ab9aabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;                      }</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;                    }</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;                  }</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;                }</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;              }</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;            } <span class="comment">// End of check of the Dirichlet status</span></div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;          } <span class="comment">// End of check of the pin status</span></div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;        } <span class="comment">// End of loop over velocity components</span></div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;      } <span class="comment">// End of loop over test functions</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;     </div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160; </div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;     </div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;     <span class="comment">// Linear terms only needed if singular solution doesn&#39;t satisfy</span></div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;     <span class="comment">//--------------------------------------------------------------</span></div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;     <span class="comment">// Stokes eqn</span></div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;     <span class="comment">//-----------</span></div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;     <span class="keywordflow">if</span> (!all_singular_functions_satisfy_stokes_equation)</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;     {</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;      <span class="comment">// Loop over the pressure test functions</span></div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> l=0;l&lt;n_pres;l++)</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;       {</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;        local_eqn = this-&gt;p_local_eqn(l);</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;        </div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;        <span class="comment">// If not pinned</span></div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;        <span class="keywordflow">if</span> (local_eqn &gt;= 0)</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;         {</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;          <span class="comment">// If not subject to Dirichlet BC</span></div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;          <span class="keywordflow">if</span> (not(<a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a4bed60435675e93b3c2f64e0b6a62bab">Pressure_dof_is_subject_to_dirichlet_bc</a>[l]))</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;           {</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;            <span class="keywordtype">double</span> aux = 0.0;</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;            <span class="comment">// Loop over velocity components</span></div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>=0;<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>&lt;cached_dim;<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>++)</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;             {</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;              aux += grad_u_bar_local[<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>][<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>];</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;             }</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;            residuals[local_eqn] += aux*testp[l]*<a class="code" href="../../dc/d00/namespaceoomph_1_1QuadTreeNames.html#a9ac199adb82120cbaa47bf2365918ab9aabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;           }</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;         }</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;       }</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;     }</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;     </div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;    } <span class="comment">// End of loop over integration points</span></div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;   </div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;   </div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;  }</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160; </div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;  <span class="comment">// VELOCITY DIRICHLET BCS</span></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;  <span class="comment">//-----------------------</span></div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;  Vector&lt;double&gt; u_bar_at_node(cached_dim);</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;  Vector&lt;Vector&lt;double&gt; &gt; u_hat_at_node(n_sing);</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;n_sing;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;   {</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;    u_hat_at_node[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].resize(cached_dim);</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;   }</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160; </div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;  <span class="comment">// Loop over the nodes</span></div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++)</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;   {</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;    <span class="comment">// Find the global coordinate of the node</span></div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    Vector&lt;double&gt; global_coordinate(cached_dim);</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> d=0;d&lt;cached_dim;d++)</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;     {</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;      global_coordinate[d] = this-&gt;raw_nodal_position(l,d);</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;     }</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;    </div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    <span class="comment">// Get singular velocity at node</span></div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;    u_bar_at_node=this-&gt;<a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#af9dc732aa08f0d6d9c8150dae69997d5">u_bar</a>(global_coordinate); </div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;n_sing;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;     {</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;      u_hat_at_node[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]=<a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#abb5f01f67f37d039b5ac23235a8b8068">velocity_singular_function</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,global_coordinate);</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;     }</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160; </div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;    <span class="comment">// Loop over the velocity components</span></div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> d=0;d&lt;cached_dim;d++)</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;     {</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;      <span class="comment">// Find its local equation number</span></div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;      local_eqn = this-&gt;nodal_local_eqn(l,u_nodal_index[d]);</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;      </div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;      <span class="comment">// If it is not pinned</span></div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;      <span class="keywordflow">if</span> (local_eqn &gt;= 0)</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;       {</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;        <span class="comment">// If it is a Dirichlet boundary condition</span></div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#acf0d4a9df3144e6398b651edaf1b1c06">Node_is_subject_to_velocity_dirichlet_bcs</a>[l][d])</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;         {</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;          <span class="comment">// Initialise the residual</span></div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;          residuals[local_eqn] = 0.0;</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;          </div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;          <span class="comment">// Add the contribution of the nodal value</span></div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;          residuals[local_eqn] += this-&gt;raw_nodal_value(l,u_nodal_index[d]);</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;          </div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;          <span class="comment">// Add the contribution of the singularities (all of them, summed)</span></div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;          residuals[local_eqn] += u_bar_at_node[d];</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160; </div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;          <span class="comment">// Substract the imposed Dirichlet value</span></div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;          residuals[local_eqn] -= <a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a29259e92474af81a7fced94e1b6ab71e">Imposed_velocity_values_at_node</a>[l][d];</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160; </div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;          <span class="keywordflow">if</span> (flag)</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;           {</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160; </div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;            <span class="comment">// Wipe the existing entries</span></div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;            <span class="keywordtype">unsigned</span> n_dof=this-&gt;ndof();</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>=0;<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>&lt;n_dof;<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;             {</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;              jacobian(local_eqn,<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>)=0.0;</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;             }</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160; </div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;            <span class="comment">// Add diagonal entry</span></div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;            jacobian(local_eqn,local_eqn) += 1.0;</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160; </div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160; </div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;            <span class="comment">// Add derivative w.r.t. the Cs</span></div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;n_sing;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;             {</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;              <span class="comment">// Find the contribution of the additional unknowns to </span></div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;              <span class="comment">// the jacobian</span></div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;              local_unknown=local_equation_number_C[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;              <span class="keywordflow">if</span> (local_unknown&gt;=0)</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;               {</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;                jacobian(local_eqn,local_unknown) += </div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;                 u_hat_at_node[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>][d]; </div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;               }</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;             }</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;             </div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;           }</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;         }</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;       }</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;     }</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;   }</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160; </div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160; </div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;  <span class="comment">// PRESSURE DIRICHLET BCS</span></div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;  <span class="comment">//-----------------------</span></div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;  </div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;  <span class="comment">// Loop over the pressure dofs</span></div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> l=0;l&lt;n_pres;l++)</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;   {</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;    <span class="comment">// Find its local equation number</span></div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;    local_eqn = this-&gt;p_local_eqn(l);</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160; </div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;    <span class="comment">// If it is not pinned</span></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;    <span class="keywordflow">if</span> (local_eqn &gt;= 0)</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;     {</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;      <span class="comment">// If it is subject to a Dirichlet BC</span></div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a4bed60435675e93b3c2f64e0b6a62bab">Pressure_dof_is_subject_to_dirichlet_bc</a>[l])</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;       {</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;        <span class="comment">// Find its global coordinate</span></div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;        <span class="comment">// This conversionly works for Taylor Hood type elements</span></div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;        <span class="comment">// but there&#39;s not much point assigning pressure dofs</span></div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;        Node* p_nod_pt=this-&gt;node_pt(this-&gt;Pconv[l]);</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;        </div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Constrained pressure node: &quot;</span> </div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;                   &lt;&lt; this-&gt;Pconv[l] &lt;&lt; <span class="stringliteral">&quot; at: &quot;</span>; </div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;        </div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;        Vector&lt;double&gt; global_coordinate(cached_dim,0.0);</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> d=0;d&lt;cached_dim;d++)</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;         {</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;          global_coordinate[d] = p_nod_pt-&gt;x(d);</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; global_coordinate[d] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;         }</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160; </div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;        <span class="comment">// Initialise its residual component</span></div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;        residuals[local_eqn] = 0.0;</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160; </div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;        <span class="comment">// Add the contribution of the pressure unknown</span></div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;        residuals[local_eqn] += this-&gt;p_nst(l);</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160; </div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;        <span class="comment">// Add singular contributions</span></div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;        residuals[local_eqn] += <a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a5ccff7d1ace73d2a5a55a667fbb9f0fc">p_bar</a>(global_coordinate);</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160; </div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;        <span class="comment">// Substract the imposed pressure value</span></div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;        residuals[local_eqn] -= <a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a3226a346cc3eb121b2e6ebdd33c87400">Imposed_value_at_pressure_dof</a>[l];</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160; </div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;        <span class="keywordflow">if</span> (flag)</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;         {</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;          </div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;          <span class="comment">// Wipe the existing entries</span></div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;          <span class="keywordtype">unsigned</span> n_dof=this-&gt;ndof();</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>=0;<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>&lt;n_dof;<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;           {</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;            jacobian(local_eqn,<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>)=0.0;</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;           }</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;          </div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;          <span class="comment">// Add diagonal entry</span></div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;          jacobian(local_eqn,local_eqn) += 1.0;</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;          </div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;          <span class="comment">// Add derivative w.r.t. the Cs</span></div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;n_sing;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;           {</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;            <span class="comment">// Find the contribution of the additional unknowns to </span></div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;            <span class="comment">// the jacobian</span></div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;            local_unknown=local_equation_number_C[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;            <span class="keywordflow">if</span> (local_unknown&gt;=0)</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;             {</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;              jacobian(local_eqn,local_unknown) += </div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;               <a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a1389196153bcd2226f0d152b934616a7">pressure_singular_function</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,global_coordinate); </div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;             }</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;           }</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;         }</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;       }</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;     }</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;   }</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;  </div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;  </div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160; } <span class="comment">// End of function</span></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesElementWithSingularity_html_a1389196153bcd2226f0d152b934616a7"><div class="ttname"><a href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a1389196153bcd2226f0d152b934616a7">oomph::NavierStokesElementWithSingularity::pressure_singular_function</a></div><div class="ttdeci">double pressure_singular_function(const unsigned &amp;i, const Vector&lt; double &gt; &amp;x) const</div><div class="ttdef"><b>Definition:</b> navier_stokes_elements_with_singularity.h:1015</div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesElementWithSingularity_html_a2f9c4cb837e755c1bc58b23337948686"><div class="ttname"><a href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a2f9c4cb837e755c1bc58b23337948686">oomph::NavierStokesElementWithSingularity::grad_velocity_singular_function</a></div><div class="ttdeci">Vector&lt; Vector&lt; double &gt; &gt; grad_velocity_singular_function(const unsigned &amp;i, const Vector&lt; double &gt; &amp;x) const</div><div class="ttdef"><b>Definition:</b> navier_stokes_elements_with_singularity.h:1007</div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesElementWithSingularity_html_a5ccff7d1ace73d2a5a55a667fbb9f0fc"><div class="ttname"><a href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a5ccff7d1ace73d2a5a55a667fbb9f0fc">oomph::NavierStokesElementWithSingularity::p_bar</a></div><div class="ttdeci">double p_bar(const unsigned &amp;i, const Vector&lt; double &gt; &amp;x) const</div><div class="ttdef"><b>Definition:</b> navier_stokes_elements_with_singularity.h:1024</div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesElementWithSingularity_html_a97093004bb204ccbce7378a922fed90f"><div class="ttname"><a href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a97093004bb204ccbce7378a922fed90f">oomph::NavierStokesElementWithSingularity::grad_u_bar</a></div><div class="ttdeci">Vector&lt; Vector&lt; double &gt; &gt; grad_u_bar(const unsigned &amp;i, const Vector&lt; double &gt; &amp;x) const</div><div class="ttdef"><b>Definition:</b> navier_stokes_elements_with_singularity.h:961</div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesElementWithSingularity_html_abb5f01f67f37d039b5ac23235a8b8068"><div class="ttname"><a href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#abb5f01f67f37d039b5ac23235a8b8068">oomph::NavierStokesElementWithSingularity::velocity_singular_function</a></div><div class="ttdeci">Vector&lt; double &gt; velocity_singular_function(const unsigned &amp;i, const Vector&lt; double &gt; &amp;x) const</div><div class="ttdoc">Evaluate i-th &quot;raw&quot; velocity singular function at Eulerian position x.</div><div class="ttdef"><b>Definition:</b> navier_stokes_elements_with_singularity.h:998</div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesElementWithSingularity_html_af9dc732aa08f0d6d9c8150dae69997d5"><div class="ttname"><a href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#af9dc732aa08f0d6d9c8150dae69997d5">oomph::NavierStokesElementWithSingularity::u_bar</a></div><div class="ttdeci">Vector&lt; double &gt; u_bar(const unsigned &amp;i, const Vector&lt; double &gt; &amp;x) const</div><div class="ttdef"><b>Definition:</b> navier_stokes_elements_with_singularity.h:931</div></div>
<div class="ttc" id="alevel2__impl_8h_html_ad46ea6bf5745e72b985b11878e46a45d"><div class="ttname"><a href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a></div><div class="ttdeci">char char char int int * k</div><div class="ttdef"><b>Definition:</b> level2_impl.h:374</div></div>
<div class="ttc" id="anamespaceGlobalPhysicalVariables_html_aa3a738ddb9a50824f9a47b77118cfccc"><div class="ttname"><a href="../../da/d9b/namespaceGlobalPhysicalVariables.html#aa3a738ddb9a50824f9a47b77118cfccc">GlobalPhysicalVariables::Gamma</a></div><div class="ttdeci">double Gamma</div><div class="ttdoc">Aspect ratio (cylinder height / cylinder radius)</div><div class="ttdef"><b>Definition:</b> axisym_navier_stokes/counter_rotating_disks/counter_rotating_disks.cc:70</div></div>
<div class="ttc" id="anamespaceoomph_html_ae5302eaf07e49e53147c42e2e6450eff"><div class="ttname"><a href="../../da/ddf/namespaceoomph.html#ae5302eaf07e49e53147c42e2e6450eff">oomph::ALE_is_disabled</a></div><div class="ttdeci">bool ALE_is_disabled</div><div class="ttdef"><b>Definition:</b> gen_axisym_advection_diffusion_elements.h:638</div></div>
<div class="ttc" id="anamespaceoomph_html_aec474227917784dc0a255faf289cfc16"><div class="ttname"><a href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a></div><div class="ttdeci">OomphInfo oomph_info</div><div class="ttdef"><b>Definition:</b> oomph_definitions.cc:319</div></div>
<div class="ttc" id="aoomph__definitions_8h_html_a25c6813cc7341d125e2502f8923fb6c4"><div class="ttname"><a href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a></div><div class="ttdeci">#define OOMPH_EXCEPTION_LOCATION</div><div class="ttdef"><b>Definition:</b> oomph_definitions.h:61</div></div>
<div class="ttc" id="aoomph__definitions_8h_html_aa260cc4af589e30cea7fde997ae16667"><div class="ttname"><a href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a></div><div class="ttdeci">#define OOMPH_CURRENT_FUNCTION</div><div class="ttdef"><b>Definition:</b> oomph_definitions.h:86</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../da/ddf/namespaceoomph.html#ae5302eaf07e49e53147c42e2e6450eff">oomph::ALE_is_disabled</a>, <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#ade8e0319c2406edbde788d76f838fdb2">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::C_equation_elements_pt</a>, <a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#aaaf2daa9ff49f296c1fa72a1819a5659">oomph::GeneralisedElement::Dummy_matrix</a>, <a class="el" href="../../da/d9b/namespaceGlobalPhysicalVariables.html#aa3a738ddb9a50824f9a47b77118cfccc">GlobalPhysicalVariables::Gamma</a>, <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a97093004bb204ccbce7378a922fed90f">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::grad_u_bar()</a>, <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a2f9c4cb837e755c1bc58b23337948686">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::grad_velocity_singular_function()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a3226a346cc3eb121b2e6ebdd33c87400">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::Imposed_value_at_pressure_dof</a>, <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a29259e92474af81a7fced94e1b6ab71e">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::Imposed_velocity_values_at_node</a>, <a class="el" href="../../dc/da8/Jacobi__makeJacobi_8cpp.html#a4804f9d1c212b9655934738d0ae395ab">J</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>, <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#acf0d4a9df3144e6398b651edaf1b1c06">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::Node_is_subject_to_velocity_dirichlet_bcs</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a5ccff7d1ace73d2a5a55a667fbb9f0fc">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::p_bar()</a>, <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a4bed60435675e93b3c2f64e0b6a62bab">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::Pressure_dof_is_subject_to_dirichlet_bc</a>, <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a1389196153bcd2226f0d152b934616a7">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::pressure_singular_function()</a>, <a class="el" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>, <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#af9dc732aa08f0d6d9c8150dae69997d5">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::u_bar()</a>, <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#abb5f01f67f37d039b5ac23235a8b8068">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::velocity_singular_function()</a>, <a class="el" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a>, <a class="el" href="../../dc/d00/namespaceoomph_1_1QuadTreeNames.html#a9ac199adb82120cbaa47bf2365918ab9aabab2a070c062503375f8264f1b6d7d6">oomph::QuadTreeNames::W</a>, and <a class="el" href="../../dc/db7/classoomph_1_1Node.html#a056f8e82da938369cd38541c5cdc598a">oomph::Node::x()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a37e1e854434870f29d919be64da5ea35">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::fill_in_contribution_to_jacobian()</a>, and <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a29a143e415d539fae575f87fa18accc4">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::fill_in_contribution_to_residuals()</a>.</p>

</div>
</div>
<a id="a97093004bb204ccbce7378a922fed90f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97093004bb204ccbce7378a922fed90f">&#9670;&nbsp;</a></span>grad_u_bar() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_NAVIER_STOKES_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt;<a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt;<a class="el" href="../../df/de6/classdouble.html">double</a>&gt; &gt; <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html">oomph::NavierStokesElementWithSingularity</a>&lt; <a class="el" href="../../d2/d41/classBASIC__NAVIER__STOKES__ELEMENT.html">BASIC_NAVIER_STOKES_ELEMENT</a> &gt;::grad_u_bar </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Evaluate i-th grad_u_bar (i-th gradient of velocity singular fct incl. the amplitude) function at Eulerian position x; grad[i][j] = du_i/dx_j </p>
<div class="fragment"><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;  {</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#ade8e0319c2406edbde788d76f838fdb2">C_equation_elements_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;grad_u_bar(<a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>);</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#ade8e0319c2406edbde788d76f838fdb2">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::C_equation_elements_pt</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, and <a class="el" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">plotDoE::x</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a642a15e66dc365e263282ee55c97d865">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::fill_in_generic_residual_contribution_wrapped_nst()</a>.</p>

</div>
</div>
<a id="a79f4f2c1d75c1242a3e4a0d38b836bd1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79f4f2c1d75c1242a3e4a0d38b836bd1">&#9670;&nbsp;</a></span>grad_u_bar() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_NAVIER_STOKES_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt;<a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt;<a class="el" href="../../df/de6/classdouble.html">double</a>&gt; &gt; <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html">oomph::NavierStokesElementWithSingularity</a>&lt; <a class="el" href="../../d2/d41/classBASIC__NAVIER__STOKES__ELEMENT.html">BASIC_NAVIER_STOKES_ELEMENT</a> &gt;::grad_u_bar </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Evaluate gradient of sum of all velocity singular fcts (incl. the amplitudes) at Eulerian position x: grad[i][j] = du_i/dx_j </p>
<div class="fragment"><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;  {</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;   <span class="comment">// Find the number of singularities</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;   <span class="keywordtype">unsigned</span> n_sing = <a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#ade8e0319c2406edbde788d76f838fdb2">C_equation_elements_pt</a>.size();</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;   </div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;   <span class="comment">// Find the dimension of the problem</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;   <span class="keywordtype">unsigned</span> cached_dim=this-&gt;dim();  </div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;   Vector&lt;Vector&lt;double&gt; &gt; sum(cached_dim);</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;cached_dim;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    {</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;     sum[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].resize(cached_dim,0.0);</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    }</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>=0;<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>&lt;n_sing;<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>++)</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    {</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;     Vector&lt;Vector&lt;double&gt; &gt; grad_u_bar_local=</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;      <a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#ade8e0319c2406edbde788d76f838fdb2">C_equation_elements_pt</a>[<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>]-&gt;grad_u_bar(<a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>);</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;cached_dim;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;      {</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;       <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>=0;<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>&lt;cached_dim;<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;        {</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;         sum[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>]+=grad_u_bar_local[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>];</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        }</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;      }</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    }</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;   <span class="keywordflow">return</span> sum;</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160; }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#ade8e0319c2406edbde788d76f838fdb2">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::C_equation_elements_pt</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>, and <a class="el" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">plotDoE::x</a>.</p>

</div>
</div>
<a id="a2f9c4cb837e755c1bc58b23337948686"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f9c4cb837e755c1bc58b23337948686">&#9670;&nbsp;</a></span>grad_velocity_singular_function()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_NAVIER_STOKES_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt;<a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt;<a class="el" href="../../df/de6/classdouble.html">double</a>&gt; &gt; <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html">oomph::NavierStokesElementWithSingularity</a>&lt; <a class="el" href="../../d2/d41/classBASIC__NAVIER__STOKES__ELEMENT.html">BASIC_NAVIER_STOKES_ELEMENT</a> &gt;::grad_velocity_singular_function </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Evaluate gradient of i-th "raw" velocity singular function at Eulerian position x </p>
<div class="fragment"><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160; {</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#ade8e0319c2406edbde788d76f838fdb2">C_equation_elements_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;grad_velocity_singular_function(<a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>);</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160; }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#ade8e0319c2406edbde788d76f838fdb2">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::C_equation_elements_pt</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, and <a class="el" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">plotDoE::x</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a642a15e66dc365e263282ee55c97d865">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::fill_in_generic_residual_contribution_wrapped_nst()</a>.</p>

</div>
</div>
<a id="a72dc34cd610715b35813dfd7d7f00f26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72dc34cd610715b35813dfd7d7f00f26">&#9670;&nbsp;</a></span>impose_dirichlet_bc_on_pressure_dof()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_NAVIER_STOKES_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html">oomph::NavierStokesElementWithSingularity</a>&lt; <a class="el" href="../../d2/d41/classBASIC__NAVIER__STOKES__ELEMENT.html">BASIC_NAVIER_STOKES_ELEMENT</a> &gt;::impose_dirichlet_bc_on_pressure_dof </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>j</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Impose Dirichlet BC at the j-th pressure dof. </p>
<div class="fragment"><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160; {</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  <a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a4bed60435675e93b3c2f64e0b6a62bab">Pressure_dof_is_subject_to_dirichlet_bc</a>[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160; }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, and <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a4bed60435675e93b3c2f64e0b6a62bab">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::Pressure_dof_is_subject_to_dirichlet_bc</a>.</p>

</div>
</div>
<a id="adab71c6a0279c1051a75dc28a782419d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adab71c6a0279c1051a75dc28a782419d">&#9670;&nbsp;</a></span>impose_velocity_dirichlet_bc_on_node()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_NAVIER_STOKES_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html">oomph::NavierStokesElementWithSingularity</a>&lt; <a class="el" href="../../d2/d41/classBASIC__NAVIER__STOKES__ELEMENT.html">BASIC_NAVIER_STOKES_ELEMENT</a> &gt;::impose_velocity_dirichlet_bc_on_node </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>d</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Impose Dirichlet BC on the d-th component of the velocity (including the singular contribution) at the j-th node </p>
<div class="fragment"><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160; {</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  <a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#acf0d4a9df3144e6398b651edaf1b1c06">Node_is_subject_to_velocity_dirichlet_bcs</a>[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>][d] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160; }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, and <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#acf0d4a9df3144e6398b651edaf1b1c06">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::Node_is_subject_to_velocity_dirichlet_bcs</a>.</p>

</div>
</div>
<a id="a44747a2e23d6d50df204e7ba15e944d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44747a2e23d6d50df204e7ba15e944d7">&#9670;&nbsp;</a></span>interpolated_p_nst()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_NAVIER_STOKES_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html">oomph::NavierStokesElementWithSingularity</a>&lt; <a class="el" href="../../d2/d41/classBASIC__NAVIER__STOKES__ELEMENT.html">BASIC_NAVIER_STOKES_ELEMENT</a> &gt;::interpolated_p_nst </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Version of interpolated pressure including the singular contributions. </p>
<div class="fragment"><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160; {</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;  <span class="comment">// Initialise pressure value with fe part</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;  <span class="keywordtype">double</span> interpolated_p = <a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a3c82dadf6222573db57658dd7a07814d">interpolated_p_nst_fe_only</a>(<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>);</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160; </div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;  <span class="comment">// Calculate the global coordinate associated with s</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;  <span class="keywordtype">unsigned</span> cached_dim = this-&gt;dim();</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;  Vector&lt;double&gt; <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>(cached_dim,0.0);</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160; </div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;  <span class="comment">//Find number of nodes</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_node = this-&gt;nnode();</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;  </div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  <span class="comment">//Local shape function</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;  Shape psif(n_node);</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;  </div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;  <span class="comment">//Find values of shape function</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;  this-&gt;<a class="code" href="../../d6/d53/namespaceoomph_1_1OneDimLagrange.html#a117f8b892dc89989ecdad99ff261e120">shape</a>(s,psif);</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;  </div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;  <span class="comment">//Loop over the local nodes and sum</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>=0;<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>&lt;n_node;<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++) </div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;   {</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> d=0;d&lt;cached_dim;d++)</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;     {</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;      <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>[d]+=this-&gt;raw_nodal_position(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>,d)*psif(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;     }</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;   }</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160; </div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;  <span class="comment">// Add the singularities contribution (all of them, summed)</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;  interpolated_p+=<a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a5ccff7d1ace73d2a5a55a667fbb9f0fc">p_bar</a>(<a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>);</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;  </div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;  <span class="keywordflow">return</span> interpolated_p;</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;}</div>
<div class="ttc" id="aclassoomph_1_1NavierStokesElementWithSingularity_html_a3c82dadf6222573db57658dd7a07814d"><div class="ttname"><a href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a3c82dadf6222573db57658dd7a07814d">oomph::NavierStokesElementWithSingularity::interpolated_p_nst_fe_only</a></div><div class="ttdeci">double interpolated_p_nst_fe_only(const Vector&lt; double &gt; &amp;s) const</div><div class="ttdef"><b>Definition:</b> navier_stokes_elements_with_singularity.h:1084</div></div>
<div class="ttc" id="anamespaceoomph_1_1OneDimLagrange_html_a117f8b892dc89989ecdad99ff261e120"><div class="ttname"><a href="../../d6/d53/namespaceoomph_1_1OneDimLagrange.html#a117f8b892dc89989ecdad99ff261e120">oomph::OneDimLagrange::shape</a></div><div class="ttdeci">void shape(const double &amp;s, double *Psi)</div><div class="ttdef"><b>Definition:</b> shape.h:564</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a3c82dadf6222573db57658dd7a07814d">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::interpolated_p_nst_fe_only()</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a5ccff7d1ace73d2a5a55a667fbb9f0fc">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::p_bar()</a>, <a class="el" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>, <a class="el" href="../../d6/d53/namespaceoomph_1_1OneDimLagrange.html#a117f8b892dc89989ecdad99ff261e120">oomph::OneDimLagrange::shape()</a>, and <a class="el" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">plotDoE::x</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#aa9e17bf51b565d0b893c4383d8a27160">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::compute_error()</a>, and <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a761bc0ae9bed2102b8019b5c95e04b9c">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::output()</a>.</p>

</div>
</div>
<a id="a3c82dadf6222573db57658dd7a07814d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c82dadf6222573db57658dd7a07814d">&#9670;&nbsp;</a></span>interpolated_p_nst_fe_only()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_NAVIER_STOKES_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html">oomph::NavierStokesElementWithSingularity</a>&lt; <a class="el" href="../../d2/d41/classBASIC__NAVIER__STOKES__ELEMENT.html">BASIC_NAVIER_STOKES_ELEMENT</a> &gt;::interpolated_p_nst_fe_only </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Return FE representation of pressure solution WITHOUT singular contributions at local coordinate s </p>
<div class="fragment"><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160; {</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;  <span class="comment">// Find number of pressure degrees of freedom</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;  <span class="keywordtype">unsigned</span> n_pres = this-&gt;npres_nst();</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160; </div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;  <span class="comment">// Set up memory for pressure shape and test functions</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;  Shape psip(n_pres), testp(n_pres);</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160; </div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;  <span class="comment">// Compute the values of the pressure shape and test functions at the</span></div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;  <span class="comment">// local coordinate s</span></div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;  this-&gt;pshape_nst(<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>,psip,testp);</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160; </div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;  <span class="comment">// Initialise pressure value</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;  <span class="keywordtype">double</span> interpolated_p = 0.0;</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160; </div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;  <span class="comment">// Add the contribution of p_FE</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;  <span class="comment">// Loop over the pressure dof and sum</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> l=0;l&lt;n_pres;l++)</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;   {</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    interpolated_p += this-&gt;p_nst(l)*psip[l];</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;   }</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160; </div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;  <span class="keywordflow">return</span> interpolated_p;</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160; }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a44747a2e23d6d50df204e7ba15e944d7">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::interpolated_p_nst()</a>, and <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a761bc0ae9bed2102b8019b5c95e04b9c">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::output()</a>.</p>

</div>
</div>
<a id="aa7b2def1d994ce11abfec7ffc06b9316"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7b2def1d994ce11abfec7ffc06b9316">&#9670;&nbsp;</a></span>interpolated_u_nst()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_NAVIER_STOKES_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt;<a class="el" href="../../df/de6/classdouble.html">double</a>&gt; <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html">oomph::NavierStokesElementWithSingularity</a>&lt; <a class="el" href="../../d2/d41/classBASIC__NAVIER__STOKES__ELEMENT.html">BASIC_NAVIER_STOKES_ELEMENT</a> &gt;::interpolated_u_nst </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Overloaded version of the interpolated velocity solution including the singular contributions </p>
<div class="fragment"><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160; {</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;  <span class="comment">// Find the dimension of the problem</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  <span class="keywordtype">unsigned</span> cached_dim=this-&gt;dim();</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  </div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;  <span class="comment">//Find number of nodes</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_node = this-&gt;nnode();</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  </div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;  <span class="comment">//Initialise value of u</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;  Vector&lt;double&gt; interpolated_u(cached_dim,0.0);</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;  </div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;  <span class="comment">// Calculate the global coordinate associated with s</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;  Vector&lt;double&gt; <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>(cached_dim,0.0);</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;  </div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;  <span class="comment">//Local shape function</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;  Shape psif(n_node);</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;  </div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;  <span class="comment">//Find values of shape function</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;  this-&gt;<a class="code" href="../../d6/d53/namespaceoomph_1_1OneDimLagrange.html#a117f8b892dc89989ecdad99ff261e120">shape</a>(s,psif);</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;  </div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;  <span class="comment">//Loop over the spatial directions</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> d=0;d&lt;cached_dim;d++)</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;   {</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    <span class="comment">//Get the index at which the unknown is stored</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> u_nodal_index = this-&gt;u_index_nst(d);</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    </div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    <span class="comment">//Loop over the local nodes and sum</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>=0;<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>&lt;n_node;<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++) </div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;     {</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;      interpolated_u[d] += this-&gt;nodal_value(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>,u_nodal_index)*psif[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>];</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;      <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>[d]+=this-&gt;raw_nodal_position(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>,d)*psif(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;     }</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;   }</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160; </div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;  <span class="comment">// Add the contribution of the singularities (all of them, summed)</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;  Vector&lt;double&gt; u_bar_local=<a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#af9dc732aa08f0d6d9c8150dae69997d5">u_bar</a>(<a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>);</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> d=0;d&lt;cached_dim;d++)</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;   {</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    interpolated_u[d] += u_bar_local[d]; </div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;   }</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;  <span class="keywordflow">return</span>(interpolated_u);</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160; }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../d6/d53/namespaceoomph_1_1OneDimLagrange.html#a117f8b892dc89989ecdad99ff261e120">oomph::OneDimLagrange::shape()</a>, <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#af9dc732aa08f0d6d9c8150dae69997d5">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::u_bar()</a>, and <a class="el" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">plotDoE::x</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#aa9e17bf51b565d0b893c4383d8a27160">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::compute_error()</a>, and <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a761bc0ae9bed2102b8019b5c95e04b9c">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::output()</a>.</p>

</div>
</div>
<a id="a06a52e85914108f2d1a15e7cdd32f6ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06a52e85914108f2d1a15e7cdd32f6ce">&#9670;&nbsp;</a></span>interpolated_u_nst_fe_only()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_NAVIER_STOKES_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt;<a class="el" href="../../df/de6/classdouble.html">double</a>&gt; <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html">oomph::NavierStokesElementWithSingularity</a>&lt; <a class="el" href="../../d2/d41/classBASIC__NAVIER__STOKES__ELEMENT.html">BASIC_NAVIER_STOKES_ELEMENT</a> &gt;::interpolated_u_nst_fe_only </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Return FE representation of velocity solution WITHOUT singular contributions at local coordinate s </p>
<div class="fragment"><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;  {</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;   <span class="comment">// Find number of nodes</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_node = this-&gt;nnode();</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;   </div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;   <span class="comment">// Find the dimension of the problem</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;   <span class="keywordtype">unsigned</span> cached_dim = this-&gt;dim();</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;   </div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;   <span class="comment">//Initialise value of u</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;   Vector&lt;double&gt; interpolated_u(cached_dim,0.0);</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;   </div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;   <span class="comment">//Local shape function</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;   Shape psif(n_node);</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;   </div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;   <span class="comment">//Find values of shape function</span></div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;   this-&gt;<a class="code" href="../../d6/d53/namespaceoomph_1_1OneDimLagrange.html#a117f8b892dc89989ecdad99ff261e120">shape</a>(s,psif);</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;   </div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;   <span class="comment">//Loop over the velocity components</span></div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> d=0;d&lt;cached_dim;d++)</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    {</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;     <span class="comment">//Get the index at which the unknown is stored</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> u_nodal_index = this-&gt;u_index_nst(d);</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;     </div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;     <span class="comment">// Add the contribution of u_FE</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;     <span class="comment">//Loop over the local nodes and sum</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>=0;<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>&lt;n_node;<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++) </div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;      {</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;       interpolated_u[d] += this-&gt;nodal_value(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>,u_nodal_index)*psif[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>];</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;      }</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    }</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;   </div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;   <span class="keywordflow">return</span> interpolated_u;</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, and <a class="el" href="../../d6/d53/namespaceoomph_1_1OneDimLagrange.html#a117f8b892dc89989ecdad99ff261e120">oomph::OneDimLagrange::shape()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a761bc0ae9bed2102b8019b5c95e04b9c">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::output()</a>.</p>

</div>
</div>
<a id="a761bc0ae9bed2102b8019b5c95e04b9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a761bc0ae9bed2102b8019b5c95e04b9c">&#9670;&nbsp;</a></span>output()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_NAVIER_STOKES_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html">oomph::NavierStokesElementWithSingularity</a>&lt; <a class="el" href="../../d2/d41/classBASIC__NAVIER__STOKES__ELEMENT.html">BASIC_NAVIER_STOKES_ELEMENT</a> &gt;::output </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>outfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>nplot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Overload the output function x, y, [z,] u, v, [w], p, u_fe, v_fe, [w_fe], p_fe, </p>
<div class="fragment"><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160; {</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  <span class="comment">// Find the dimension of the problem</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;  <span class="keywordtype">unsigned</span> cached_dim = this-&gt;dim();</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160; </div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  <span class="comment">//Vector of local coordinates</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  Vector&lt;double&gt; <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>(cached_dim);</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160; </div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  <span class="comment">// Tecplot header info</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;  outfile &lt;&lt; this-&gt;tecplot_zone_string(nplot);</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160; </div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  <span class="comment">// Loop over plot points</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  <span class="keywordtype">unsigned</span> num_plot_points=this-&gt;nplot_points(nplot);</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> iplot=0;iplot&lt;num_plot_points;iplot++)</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;   {   </div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <span class="comment">// Get local coordinates of plot point</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    this-&gt;get_s_plot(iplot,nplot,<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>);</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160; </div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    Vector&lt;double&gt; <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>(cached_dim);</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;cached_dim;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++) </div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;     {</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;      outfile &lt;&lt; this-&gt;interpolated_x(<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>,<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;      <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = this-&gt;interpolated_x(<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>,<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;     }</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160; </div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    Vector&lt;double&gt; <a class="code" href="../../de/d8e/namespaceJeffery__Solution.html#acf35d547e7d28609a17c66c9a191090b">velocity</a> = <a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#aa7b2def1d994ce11abfec7ffc06b9316">interpolated_u_nst</a>(<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>);</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    Vector&lt;double&gt; velocity_fe_only = <a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a06a52e85914108f2d1a15e7cdd32f6ce">interpolated_u_nst_fe_only</a>(<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>);</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;cached_dim;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++) </div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;     {</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;      outfile &lt;&lt; <a class="code" href="../../de/d8e/namespaceJeffery__Solution.html#acf35d547e7d28609a17c66c9a191090b">velocity</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;     }</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    outfile &lt;&lt; this-&gt;<a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a44747a2e23d6d50df204e7ba15e944d7">interpolated_p_nst</a>(<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;cached_dim;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++) </div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;     {</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;      outfile &lt;&lt; velocity_fe_only[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;     }</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    outfile &lt;&lt; this-&gt;<a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a3c82dadf6222573db57658dd7a07814d">interpolated_p_nst_fe_only</a>(<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;cached_dim;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++) </div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;     {</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;      outfile &lt;&lt; <a class="code" href="../../de/d8e/namespaceJeffery__Solution.html#acf35d547e7d28609a17c66c9a191090b">velocity</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] - velocity_fe_only[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;     }</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    outfile </div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;     &lt;&lt; this-&gt;<a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a44747a2e23d6d50df204e7ba15e944d7">interpolated_p_nst</a>(<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>)-</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;     this-&gt;<a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a3c82dadf6222573db57658dd7a07814d">interpolated_p_nst_fe_only</a>(<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>) </div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    </div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;   }</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160; </div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;  <span class="comment">// Write tecplot footer (e.g. FE connectivity lists)</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  this-&gt;write_tecplot_zone_footer(outfile,nplot);</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160; </div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160; }</div>
<div class="ttc" id="aclassoomph_1_1NavierStokesElementWithSingularity_html_a06a52e85914108f2d1a15e7cdd32f6ce"><div class="ttname"><a href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a06a52e85914108f2d1a15e7cdd32f6ce">oomph::NavierStokesElementWithSingularity::interpolated_u_nst_fe_only</a></div><div class="ttdeci">Vector&lt; double &gt; interpolated_u_nst_fe_only(const Vector&lt; double &gt; &amp;s) const</div><div class="ttdef"><b>Definition:</b> navier_stokes_elements_with_singularity.h:1047</div></div>
<div class="ttc" id="anamespaceJeffery__Solution_html_acf35d547e7d28609a17c66c9a191090b"><div class="ttname"><a href="../../de/d8e/namespaceJeffery__Solution.html#acf35d547e7d28609a17c66c9a191090b">Jeffery_Solution::velocity</a></div><div class="ttdeci">double velocity(const double &amp;t)</div><div class="ttdoc">Angular velocity as function of time t.</div><div class="ttdef"><b>Definition:</b> jeffery_orbit.cc:107</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a44747a2e23d6d50df204e7ba15e944d7">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::interpolated_p_nst()</a>, <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a3c82dadf6222573db57658dd7a07814d">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::interpolated_p_nst_fe_only()</a>, <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#aa7b2def1d994ce11abfec7ffc06b9316">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::interpolated_u_nst()</a>, <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a06a52e85914108f2d1a15e7cdd32f6ce">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::interpolated_u_nst_fe_only()</a>, <a class="el" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>, <a class="el" href="../../de/d8e/namespaceJeffery__Solution.html#acf35d547e7d28609a17c66c9a191090b">Jeffery_Solution::velocity()</a>, and <a class="el" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">plotDoE::x</a>.</p>

</div>
</div>
<a id="a5ccff7d1ace73d2a5a55a667fbb9f0fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ccff7d1ace73d2a5a55a667fbb9f0fc">&#9670;&nbsp;</a></span>p_bar() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_NAVIER_STOKES_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html">oomph::NavierStokesElementWithSingularity</a>&lt; <a class="el" href="../../d2/d41/classBASIC__NAVIER__STOKES__ELEMENT.html">BASIC_NAVIER_STOKES_ELEMENT</a> &gt;::p_bar </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Evaluate i-th p_bar (i-th pressure singular fct (incl. the amplitude) at Eulerian position x </p>
<div class="fragment"><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160; {</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#ade8e0319c2406edbde788d76f838fdb2">C_equation_elements_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;p_bar(<a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>);</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160; }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#ade8e0319c2406edbde788d76f838fdb2">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::C_equation_elements_pt</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, and <a class="el" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">plotDoE::x</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a642a15e66dc365e263282ee55c97d865">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::fill_in_generic_residual_contribution_wrapped_nst()</a>, and <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a44747a2e23d6d50df204e7ba15e944d7">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::interpolated_p_nst()</a>.</p>

</div>
</div>
<a id="a39b31b71c18f4af12bca11822c94eb1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39b31b71c18f4af12bca11822c94eb1c">&#9670;&nbsp;</a></span>p_bar() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_NAVIER_STOKES_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html">oomph::NavierStokesElementWithSingularity</a>&lt; <a class="el" href="../../d2/d41/classBASIC__NAVIER__STOKES__ELEMENT.html">BASIC_NAVIER_STOKES_ELEMENT</a> &gt;::p_bar </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Evaluate sum of all pressure singular fcts (incl. the amplitudes) at Eulerian position x </p>
<div class="fragment"><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160; {</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;  <span class="comment">// Find the number of singularities</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;  <span class="keywordtype">unsigned</span> n_sing = <a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#ade8e0319c2406edbde788d76f838fdb2">C_equation_elements_pt</a>.size();</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;  </div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;  <span class="keywordtype">double</span> sum=0.0;</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;n_sing;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;   {</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    sum+=<a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#ade8e0319c2406edbde788d76f838fdb2">C_equation_elements_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;p_bar(<a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>);</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;   }</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;  <span class="keywordflow">return</span> sum;</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160; }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#ade8e0319c2406edbde788d76f838fdb2">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::C_equation_elements_pt</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, and <a class="el" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">plotDoE::x</a>.</p>

</div>
</div>
<a id="a1389196153bcd2226f0d152b934616a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1389196153bcd2226f0d152b934616a7">&#9670;&nbsp;</a></span>pressure_singular_function()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_NAVIER_STOKES_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html">oomph::NavierStokesElementWithSingularity</a>&lt; <a class="el" href="../../d2/d41/classBASIC__NAVIER__STOKES__ELEMENT.html">BASIC_NAVIER_STOKES_ELEMENT</a> &gt;::pressure_singular_function </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Evaluate i-th pressure singular fct (without the amplitude) at Eulerian position x </p>
<div class="fragment"><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160; {</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#ade8e0319c2406edbde788d76f838fdb2">C_equation_elements_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;pressure_singular_function(<a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>);</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160; }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#ade8e0319c2406edbde788d76f838fdb2">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::C_equation_elements_pt</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, and <a class="el" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">plotDoE::x</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a642a15e66dc365e263282ee55c97d865">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::fill_in_generic_residual_contribution_wrapped_nst()</a>.</p>

</div>
</div>
<a id="a1d8d730940b13382838c19c7d999a75d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d8d730940b13382838c19c7d999a75d">&#9670;&nbsp;</a></span>set_dirichlet_value_on_pressure_dof()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_NAVIER_STOKES_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html">oomph::NavierStokesElementWithSingularity</a>&lt; <a class="el" href="../../d2/d41/classBASIC__NAVIER__STOKES__ELEMENT.html">BASIC_NAVIER_STOKES_ELEMENT</a> &gt;::set_dirichlet_value_on_pressure_dof </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Specify Dirichlet boundary value for the j-th pressure dof. </p>
<div class="fragment"><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160; {</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  <a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a3226a346cc3eb121b2e6ebdd33c87400">Imposed_value_at_pressure_dof</a>[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>] = <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160; }</div>
<div class="ttc" id="anamespaceEigen_html_a242ccf5e6e80154bbf36d63acf6e458a"><div class="ttname"><a href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">Eigen::value</a></div><div class="ttdeci">squared absolute value</div><div class="ttdef"><b>Definition:</b> GlobalFunctions.h:87</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a3226a346cc3eb121b2e6ebdd33c87400">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::Imposed_value_at_pressure_dof</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, and <a class="el" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">Eigen::value</a>.</p>

</div>
</div>
<a id="a4f523c672c3b37b06fec89ef112e7849"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f523c672c3b37b06fec89ef112e7849">&#9670;&nbsp;</a></span>set_velocity_dirichlet_value_on_node()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_NAVIER_STOKES_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html">oomph::NavierStokesElementWithSingularity</a>&lt; <a class="el" href="../../d2/d41/classBASIC__NAVIER__STOKES__ELEMENT.html">BASIC_NAVIER_STOKES_ELEMENT</a> &gt;::set_velocity_dirichlet_value_on_node </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Specify Dirichlet boundary value for the d-th velocity component (including the singular contribution) at the j-th local node </p>
<div class="fragment"><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160; {</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  <a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a29259e92474af81a7fced94e1b6ab71e">Imposed_velocity_values_at_node</a>[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>][d] = <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160; }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a29259e92474af81a7fced94e1b6ab71e">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::Imposed_velocity_values_at_node</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, and <a class="el" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">Eigen::value</a>.</p>

</div>
</div>
<a id="af9dc732aa08f0d6d9c8150dae69997d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9dc732aa08f0d6d9c8150dae69997d5">&#9670;&nbsp;</a></span>u_bar() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_NAVIER_STOKES_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt;<a class="el" href="../../df/de6/classdouble.html">double</a>&gt; <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html">oomph::NavierStokesElementWithSingularity</a>&lt; <a class="el" href="../../d2/d41/classBASIC__NAVIER__STOKES__ELEMENT.html">BASIC_NAVIER_STOKES_ELEMENT</a> &gt;::u_bar </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Evaluate i-th u_bar (i-th velocity singular function incl. the amplitudes) function at Eulerian position x </p>
<div class="fragment"><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;  {</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#ade8e0319c2406edbde788d76f838fdb2">C_equation_elements_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;u_bar(<a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>);</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#ade8e0319c2406edbde788d76f838fdb2">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::C_equation_elements_pt</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, and <a class="el" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">plotDoE::x</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a642a15e66dc365e263282ee55c97d865">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::fill_in_generic_residual_contribution_wrapped_nst()</a>, and <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#aa7b2def1d994ce11abfec7ffc06b9316">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::interpolated_u_nst()</a>.</p>

</div>
</div>
<a id="a714b50ba73a6f6ddeec2b3a4b3aedd2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a714b50ba73a6f6ddeec2b3a4b3aedd2a">&#9670;&nbsp;</a></span>u_bar() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_NAVIER_STOKES_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt;<a class="el" href="../../df/de6/classdouble.html">double</a>&gt; <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html">oomph::NavierStokesElementWithSingularity</a>&lt; <a class="el" href="../../d2/d41/classBASIC__NAVIER__STOKES__ELEMENT.html">BASIC_NAVIER_STOKES_ELEMENT</a> &gt;::u_bar </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Evaluate sum of all velocity singular fcts (incl. the amplitude) at Eulerian position x </p>
<div class="fragment"><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;  {</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;   <span class="comment">// Find the number of singularities</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;   <span class="keywordtype">unsigned</span> n_sing = <a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#ade8e0319c2406edbde788d76f838fdb2">C_equation_elements_pt</a>.size();</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;   </div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;   <span class="comment">// Find the dimension of the problem</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;   <span class="keywordtype">unsigned</span> cached_dim=this-&gt;dim();  </div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;   Vector&lt;double&gt; sum(cached_dim,0.0);</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>=0;<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>&lt;n_sing;<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>++)</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    {</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;     Vector&lt;double&gt; u_bar_local=</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;      <a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#ade8e0319c2406edbde788d76f838fdb2">C_equation_elements_pt</a>[<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>]-&gt;u_bar(<a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>);</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;cached_dim;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;      {</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;       sum[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]+=u_bar_local[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;      }</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    }</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;   <span class="keywordflow">return</span> sum;</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160; }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#ade8e0319c2406edbde788d76f838fdb2">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::C_equation_elements_pt</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>, and <a class="el" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">plotDoE::x</a>.</p>

</div>
</div>
<a id="a0d66ba2ee335de530ca4b367df082c98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d66ba2ee335de530ca4b367df082c98">&#9670;&nbsp;</a></span>undo_dirichlet_bc_on_pressure_dof()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_NAVIER_STOKES_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html">oomph::NavierStokesElementWithSingularity</a>&lt; <a class="el" href="../../d2/d41/classBASIC__NAVIER__STOKES__ELEMENT.html">BASIC_NAVIER_STOKES_ELEMENT</a> &gt;::undo_dirichlet_bc_on_pressure_dof </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>j</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Undo Dirichlet BC at the j-th pressure dof. </p>
<div class="fragment"><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160; {</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  <a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a4bed60435675e93b3c2f64e0b6a62bab">Pressure_dof_is_subject_to_dirichlet_bc</a>[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160; }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, and <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a4bed60435675e93b3c2f64e0b6a62bab">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::Pressure_dof_is_subject_to_dirichlet_bc</a>.</p>

</div>
</div>
<a id="a9f8083648d80c1555e795e426c29cc0b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f8083648d80c1555e795e426c29cc0b">&#9670;&nbsp;</a></span>undo_velocity_dirichlet_bc_on_node()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_NAVIER_STOKES_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html">oomph::NavierStokesElementWithSingularity</a>&lt; <a class="el" href="../../d2/d41/classBASIC__NAVIER__STOKES__ELEMENT.html">BASIC_NAVIER_STOKES_ELEMENT</a> &gt;::undo_velocity_dirichlet_bc_on_node </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>d</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Undo Dirichlet BC on the d-th velocity component (including the singular contribution) of the jth node </p>
<div class="fragment"><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160; {</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  <a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#acf0d4a9df3144e6398b651edaf1b1c06">Node_is_subject_to_velocity_dirichlet_bcs</a>[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>][d] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160; }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, and <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#acf0d4a9df3144e6398b651edaf1b1c06">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::Node_is_subject_to_velocity_dirichlet_bcs</a>.</p>

</div>
</div>
<a id="abb5f01f67f37d039b5ac23235a8b8068"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb5f01f67f37d039b5ac23235a8b8068">&#9670;&nbsp;</a></span>velocity_singular_function()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_NAVIER_STOKES_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt;<a class="el" href="../../df/de6/classdouble.html">double</a>&gt; <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html">oomph::NavierStokesElementWithSingularity</a>&lt; <a class="el" href="../../d2/d41/classBASIC__NAVIER__STOKES__ELEMENT.html">BASIC_NAVIER_STOKES_ELEMENT</a> &gt;::velocity_singular_function </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Evaluate i-th "raw" velocity singular function at Eulerian position x. </p>
<div class="fragment"><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160; {</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#ade8e0319c2406edbde788d76f838fdb2">C_equation_elements_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;velocity_singular_function(<a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>);</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160; }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#ade8e0319c2406edbde788d76f838fdb2">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::C_equation_elements_pt</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, and <a class="el" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">plotDoE::x</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a642a15e66dc365e263282ee55c97d865">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::fill_in_generic_residual_contribution_wrapped_nst()</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="ade8e0319c2406edbde788d76f838fdb2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade8e0319c2406edbde788d76f838fdb2">&#9670;&nbsp;</a></span>C_equation_elements_pt</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_NAVIER_STOKES_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt;<a class="el" href="../../d2/d38/classoomph_1_1SingularNavierStokesSolutionElement.html">SingularNavierStokesSolutionElement</a>&lt;<a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html">NavierStokesElementWithSingularity</a>&lt;<a class="el" href="../../d2/d41/classBASIC__NAVIER__STOKES__ELEMENT.html">BASIC_NAVIER_STOKES_ELEMENT</a>&gt; &gt;*&gt; <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html">oomph::NavierStokesElementWithSingularity</a>&lt; <a class="el" href="../../d2/d41/classBASIC__NAVIER__STOKES__ELEMENT.html">BASIC_NAVIER_STOKES_ELEMENT</a> &gt;::C_equation_elements_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Vector of pointers to SingularNavierStokesSolutionElement objects. </p>

<p class="reference">Referenced by <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a12391fa78c148c3d2f35217891c95333">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::add_c_equation_element_pt()</a>, <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a404c8928ad32707621aea949314f78e3">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::c_equation_elements_pt()</a>, <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a642a15e66dc365e263282ee55c97d865">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::fill_in_generic_residual_contribution_wrapped_nst()</a>, <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a97093004bb204ccbce7378a922fed90f">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::grad_u_bar()</a>, <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a2f9c4cb837e755c1bc58b23337948686">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::grad_velocity_singular_function()</a>, <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a5ccff7d1ace73d2a5a55a667fbb9f0fc">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::p_bar()</a>, <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a1389196153bcd2226f0d152b934616a7">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::pressure_singular_function()</a>, <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#af9dc732aa08f0d6d9c8150dae69997d5">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::u_bar()</a>, and <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#abb5f01f67f37d039b5ac23235a8b8068">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::velocity_singular_function()</a>.</p>

</div>
</div>
<a id="a3226a346cc3eb121b2e6ebdd33c87400"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3226a346cc3eb121b2e6ebdd33c87400">&#9670;&nbsp;</a></span>Imposed_value_at_pressure_dof</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_NAVIER_STOKES_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt;<a class="el" href="../../df/de6/classdouble.html">double</a>&gt; <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html">oomph::NavierStokesElementWithSingularity</a>&lt; <a class="el" href="../../d2/d41/classBASIC__NAVIER__STOKES__ELEMENT.html">BASIC_NAVIER_STOKES_ELEMENT</a> &gt;::Imposed_value_at_pressure_dof</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Imposed value at pressure dofs that are subject to Dirichlet BC [size = number of pressure dof; initialised to zero] </p>

<p class="reference">Referenced by <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a642a15e66dc365e263282ee55c97d865">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::fill_in_generic_residual_contribution_wrapped_nst()</a>, <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#adbcdcd25211d50ffd002868a63d28008">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::NavierStokesElementWithSingularity()</a>, and <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a1d8d730940b13382838c19c7d999a75d">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::set_dirichlet_value_on_pressure_dof()</a>.</p>

</div>
</div>
<a id="a29259e92474af81a7fced94e1b6ab71e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29259e92474af81a7fced94e1b6ab71e">&#9670;&nbsp;</a></span>Imposed_velocity_values_at_node</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_NAVIER_STOKES_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt;<a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt;<a class="el" href="../../df/de6/classdouble.html">double</a>&gt; &gt; <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html">oomph::NavierStokesElementWithSingularity</a>&lt; <a class="el" href="../../d2/d41/classBASIC__NAVIER__STOKES__ELEMENT.html">BASIC_NAVIER_STOKES_ELEMENT</a> &gt;::Imposed_velocity_values_at_node</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Imposed values of velocity component at nodes that are subject to Dirichlet BC [size = number of nodes; initialised to zero] </p>

<p class="reference">Referenced by <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a642a15e66dc365e263282ee55c97d865">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::fill_in_generic_residual_contribution_wrapped_nst()</a>, <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#adbcdcd25211d50ffd002868a63d28008">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::NavierStokesElementWithSingularity()</a>, and <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a4f523c672c3b37b06fec89ef112e7849">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::set_velocity_dirichlet_value_on_node()</a>.</p>

</div>
</div>
<a id="acf0d4a9df3144e6398b651edaf1b1c06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf0d4a9df3144e6398b651edaf1b1c06">&#9670;&nbsp;</a></span>Node_is_subject_to_velocity_dirichlet_bcs</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_NAVIER_STOKES_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt;std::vector&lt;<a class="el" href="../../d9/db9/classbool.html">bool</a>&gt; &gt; <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html">oomph::NavierStokesElementWithSingularity</a>&lt; <a class="el" href="../../d2/d41/classBASIC__NAVIER__STOKES__ELEMENT.html">BASIC_NAVIER_STOKES_ELEMENT</a> &gt;::Node_is_subject_to_velocity_dirichlet_bcs</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Vector indicating which velocity component of which node is subject to Dirichlet BC [size = number of nodes; initialised to false] </p>

<p class="reference">Referenced by <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a642a15e66dc365e263282ee55c97d865">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::fill_in_generic_residual_contribution_wrapped_nst()</a>, <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#adab71c6a0279c1051a75dc28a782419d">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::impose_velocity_dirichlet_bc_on_node()</a>, <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#adbcdcd25211d50ffd002868a63d28008">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::NavierStokesElementWithSingularity()</a>, and <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a9f8083648d80c1555e795e426c29cc0b">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::undo_velocity_dirichlet_bc_on_node()</a>.</p>

</div>
</div>
<a id="a4bed60435675e93b3c2f64e0b6a62bab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4bed60435675e93b3c2f64e0b6a62bab">&#9670;&nbsp;</a></span>Pressure_dof_is_subject_to_dirichlet_bc</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BASIC_NAVIER_STOKES_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="../../d9/db9/classbool.html">bool</a>&gt; <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html">oomph::NavierStokesElementWithSingularity</a>&lt; <a class="el" href="../../d2/d41/classBASIC__NAVIER__STOKES__ELEMENT.html">BASIC_NAVIER_STOKES_ELEMENT</a> &gt;::Pressure_dof_is_subject_to_dirichlet_bc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Vector indicating which pressure dof is subject to Dirichlet BC [size = number of pressure dofs; initialised to false] </p>

<p class="reference">Referenced by <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a642a15e66dc365e263282ee55c97d865">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::fill_in_generic_residual_contribution_wrapped_nst()</a>, <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a72dc34cd610715b35813dfd7d7f00f26">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::impose_dirichlet_bc_on_pressure_dof()</a>, <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#adbcdcd25211d50ffd002868a63d28008">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::NavierStokesElementWithSingularity()</a>, and <a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html#a0d66ba2ee335de530ca4b367df082c98">oomph::NavierStokesElementWithSingularity&lt; BASIC_NAVIER_STOKES_ELEMENT &gt;::undo_dirichlet_bc_on_pressure_dof()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="../../dd/d03/navier__stokes__elements__with__singularity_8h_source.html">navier_stokes_elements_with_singularity.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../da/ddf/namespaceoomph.html">oomph</a></li><li class="navelem"><a class="el" href="../../dd/d05/classoomph_1_1NavierStokesElementWithSingularity.html">NavierStokesElementWithSingularity</a></li>
    <li class="footer">Generated on Wed Aug 27 2025 17:08:48 for MercuryDPM by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
