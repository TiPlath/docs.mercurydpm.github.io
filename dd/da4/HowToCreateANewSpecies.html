<!-- HTML header for doxygen 1.8.18-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MercuryDPM: Implementing a new contact law</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../MDPM.css" rel="stylesheet" type="text/css"/>
<link href="../../codeLabels.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-fork-corner.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-dropdown-version.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../MDPM-fragment-copy-button.js"></script>
<script type="text/javascript">
DoxygenAwesomeFragmentCopyButton.init()
</script>
<script type="text/javascript" src="../../MDPM-paragraph-link.js"></script>
<script type="text/javascript">
DoxygenAwesomeParagraphLink.init()
</script>
<script type="text/javascript" src="../../MDPM-interactive-toc.js"></script>
<script type="text/javascript">
DoxygenAwesomeInteractiveToc.init()
</script>
<script type="text/javascript" src="../../MDPM-darkmode-toggle.js"></script>
<script type="text/javascript">
DoxygenAwesomeDarkModeToggle.init()
</script>
</head>
<body>
  <div id="bitbucket-corner">
   <a href="https://bitbucket.org/mercurydpm/mercurydpm/src/master/" target="_blank" id="fork-corner" class="fork-corner fc-pos-tr fc-animate fc-theme-bitbucket"></a>
  </div>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../mercury-logo-chosen-light-slogan.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"> <!--MercuryDPM--!>
   <!-- BEGIN version select -->
   <div class="dropdown" id="projectnumber">
    <button class="dropbtn">v1.0</button>
    <div class="dropdown-content">
    </div>
   </div>
   <script type="text/javascript" src="../../MDPM-dropdown-version.js"></script>
<!-- END version select -->
   <!--&#160;<span id="projectnumber">revision: v1.0</span>-->
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<script type="text/javascript" src="../../MDPM-fork-corner.js"></script>
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('dd/da4/HowToCreateANewSpecies.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Implementing a new contact law </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#background">Background</a><ul><li class="level2"><a href="#species">Species</a></li>
<li class="level2"><a href="#interaction">Interaction</a></li>
<li class="level2"><a href="#inheritance">Inheritance structure</a></li>
</ul>
</li>
<li class="level1"><a href="#new">Creating a new contact law</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="background"></a>
Background</h1>
<p>Contact laws in MercuryDPM are described by the Species and Interaction classes. Species contains the <em>parameters</em> of the contact law (plus the particle property density), while Interaction class contains the <em>functions to compute the forces</em>.</p>
<h2><a class="anchor" id="species"></a>
Species</h2>
<p>To <em>use</em> a contact law, you only need to get familiar with the Species class, you only need to set the parameters. For example, if you want to use a the Hertz-Mindlin force law, then you have to create a Species of type HertzianViscoelasticMindlinSpecies and set its parameters: </p><div class="fragment"><div class="line"><span class="comment">//defines a new species</span></div>
<div class="line"><a class="code" href="../../d9/d0c/classSpecies.html">HertzianViscoelasticMindlinSpecies</a> species;</div>
<div class="line">species.<a class="code" href="../../dc/d02/classParticleSpecies.html#a274df9fa08ef5580e54f8e9301f1b348">setDensity</a>(<a class="code" href="../../de/d6c/namespaceUniformPSDSelfTest.html#a3ac20b253bbadc71e305cbbeabd87435">density</a>);</div>
<div class="line">species.setEffectiveElasticModulusAndRestitutionCoefficient(elasticModulus, restitution);</div>
<div class="line">species.setEffectiveShearModulus(0.5*elasticModulus/(1+poissonRatio));</div>
<div class="line">species.setSlidingFrictionCoefficient(frictionCoefficient);</div>
<div class="line"> </div>
<div class="line"><a class="code" href="../../d3/db1/classMercury3D.html">Mercury3D</a> dpm;</div>
<div class="line"><span class="comment">//adds the new species to the speciesHandler of the simulation</span></div>
<div class="line">dpm.<a class="code" href="../../d5/d89/classDPMBase.html#a1b7e235821697ce3f5680b6482ee784b">speciesHandler</a>.<a class="code" href="../../d2/dcc/classBaseHandler.html#a754b1413287a1c07e42bc2096e62ce6e">copyAndAddObject</a>(species);</div>
<div class="ttc" id="aclassBaseHandler_html_a754b1413287a1c07e42bc2096e62ce6e"><div class="ttname"><a href="../../d2/dcc/classBaseHandler.html#a754b1413287a1c07e42bc2096e62ce6e">BaseHandler::copyAndAddObject</a></div><div class="ttdeci">std::enable_if&lt;!std::is_pointer&lt; U &gt;::value, U * &gt;::type copyAndAddObject(const U &amp;object)</div><div class="ttdoc">Creates a copy of a Object and adds it to the BaseHandler.</div><div class="ttdef"><b>Definition:</b> BaseHandler.h:360</div></div>
<div class="ttc" id="aclassDPMBase_html_a1b7e235821697ce3f5680b6482ee784b"><div class="ttname"><a href="../../d5/d89/classDPMBase.html#a1b7e235821697ce3f5680b6482ee784b">DPMBase::speciesHandler</a></div><div class="ttdeci">SpeciesHandler speciesHandler</div><div class="ttdoc">A handler to that stores the species type i.e. LinearViscoelasticSpecies, etc.</div><div class="ttdef"><b>Definition:</b> DPMBase.h:1433</div></div>
<div class="ttc" id="aclassMercury3D_html"><div class="ttname"><a href="../../d3/db1/classMercury3D.html">Mercury3D</a></div><div class="ttdoc">This adds on the hierarchical grid code for 3D problems.</div><div class="ttdef"><b>Definition:</b> Mercury3D.h:16</div></div>
<div class="ttc" id="aclassParticleSpecies_html_a274df9fa08ef5580e54f8e9301f1b348"><div class="ttname"><a href="../../dc/d02/classParticleSpecies.html#a274df9fa08ef5580e54f8e9301f1b348">ParticleSpecies::setDensity</a></div><div class="ttdeci">void setDensity(Mdouble density)</div><div class="ttdef"><b>Definition:</b> ParticleSpecies.cc:88</div></div>
<div class="ttc" id="aclassSpecies_html"><div class="ttname"><a href="../../d9/d0c/classSpecies.html">Species</a></div><div class="ttdoc">Contains material and contact force properties.</div><div class="ttdef"><b>Definition:</b> Species.h:14</div></div>
<div class="ttc" id="anamespaceUniformPSDSelfTest_html_a3ac20b253bbadc71e305cbbeabd87435"><div class="ttname"><a href="../../de/d6c/namespaceUniformPSDSelfTest.html#a3ac20b253bbadc71e305cbbeabd87435">UniformPSDSelfTest.density</a></div><div class="ttdeci">density</div><div class="ttdef"><b>Definition:</b> UniformPSDSelfTest.py:19</div></div>
</div><!-- fragment --><p>Then you need to assign a species to each particle. The species added to speciesHandler can be retrieved by their index, with index 0 being the first inserted species, index 1 the second, etc: </p><div class="fragment"><div class="line"><a class="code" href="../../d7/d41/classSphericalParticle.html">SphericalParticle</a> <a class="code" href="../../db/d01/MatrixBase__all_8cpp.html#a9b22b0b79984d73a58b20bc0c88a7c5f">p0</a>;</div>
<div class="line"><span class="comment">//defines this particle to be of Species 0</span></div>
<div class="line"><a class="code" href="../../db/d01/MatrixBase__all_8cpp.html#a9b22b0b79984d73a58b20bc0c88a7c5f">p0</a>.setSpecies(speciesHandler.getObject(0));</div>
<div class="line"><a class="code" href="../../db/d01/MatrixBase__all_8cpp.html#a9b22b0b79984d73a58b20bc0c88a7c5f">p0</a>.setPosition(position);</div>
<div class="line"><a class="code" href="../../db/d01/MatrixBase__all_8cpp.html#a9b22b0b79984d73a58b20bc0c88a7c5f">p0</a>.setRadius(<a class="code" href="../../de/d6c/namespaceUniformPSDSelfTest.html#ab2a01330429b8f42b72cc01f29f1beeb">radius</a>);</div>
<div class="line">particleHandler.copyAndAddObject(<a class="code" href="../../db/d01/MatrixBase__all_8cpp.html#a9b22b0b79984d73a58b20bc0c88a7c5f">p0</a>);</div>
<div class="ttc" id="aMatrixBase__all_8cpp_html_a9b22b0b79984d73a58b20bc0c88a7c5f"><div class="ttname"><a href="../../db/d01/MatrixBase__all_8cpp.html#a9b22b0b79984d73a58b20bc0c88a7c5f">p0</a></div><div class="ttdeci">Vector3f p0</div><div class="ttdef"><b>Definition:</b> MatrixBase_all.cpp:2</div></div>
<div class="ttc" id="aclassSphericalParticle_html"><div class="ttname"><a href="../../d7/d41/classSphericalParticle.html">SphericalParticle</a></div><div class="ttdoc">A spherical particle is the most simple particle used in MercuryDPM.</div><div class="ttdef"><b>Definition:</b> SphericalParticle.h:16</div></div>
<div class="ttc" id="anamespaceUniformPSDSelfTest_html_ab2a01330429b8f42b72cc01f29f1beeb"><div class="ttname"><a href="../../de/d6c/namespaceUniformPSDSelfTest.html#ab2a01330429b8f42b72cc01f29f1beeb">UniformPSDSelfTest.radius</a></div><div class="ttdeci">radius</div><div class="ttdef"><b>Definition:</b> UniformPSDSelfTest.py:15</div></div>
</div><!-- fragment --><p>For particles of the same species, the parameters of that species is used to compute interaction forces. If there is more than one species defined, then MercuryDPM automatically creates MixedSpecies that contains the parameters for a collision between particles of different species. By default, the parameters of the MixedSpecies are set to the harmonic mean of the parameters of the Species' parameters, i.e. the Elastic modulus for a contact between two particles of different species is computed as \(E_{12}=2(E_1^{-1}+E_2^{-1})^{-1}\). If you wish to change the behaviour of the mixed contacts, you do this as follows:</p>
<div class="fragment"><div class="line"><span class="comment">//retrieves a pointer to the MixedSpecies containing the parameters for collisions between particles of species 0 and 1</span></div>
<div class="line"><span class="keyword">auto</span> mixedSpecies = dpm.<a class="code" href="../../d5/d89/classDPMBase.html#a1b7e235821697ce3f5680b6482ee784b">speciesHandler</a>.<a class="code" href="../../d6/df6/classSpeciesHandler.html#af7d86f20247eed13ecd352c0236fcd34">getMixedObject</a>(0,1);</div>
<div class="line"><span class="comment">//redefines the contact law parameters</span></div>
<div class="line">mixedSpecies-&gt;setEffectiveElasticModulusAndRestitutionCoefficient(elasticModulus, restitution);</div>
<div class="line">mixedSpecies-&gt;setEffectiveShearModulus(0.5*elasticModulus/(1+poissonRatio));</div>
<div class="line">mixedSpecies-&gt;setSlidingFrictionCoefficient(frictionCoefficient);</div>
<div class="ttc" id="aclassSpeciesHandler_html_af7d86f20247eed13ecd352c0236fcd34"><div class="ttname"><a href="../../d6/df6/classSpeciesHandler.html#af7d86f20247eed13ecd352c0236fcd34">SpeciesHandler::getMixedObject</a></div><div class="ttdeci">std::enable_if&lt;!std::is_pointer&lt; typename U::MixedSpeciesType &gt;::value, typename U::MixedSpeciesType * &gt;::type getMixedObject(const U *S, const U *T)</div><div class="ttdef"><b>Definition:</b> SpeciesHandler.h:52</div></div>
</div><!-- fragment --><p>Note, MixedSpecies have no particle properties (density), as no particle can be of a MixedSpecies type.</p>
<h2><a class="anchor" id="interaction"></a>
Interaction</h2>
<p>The Interaction class is hidden from the user, and only used internally by MercuryDPM. Every time MercuryDPM detects a collision between two particles, it will create an Interaction of the right type (HertzianViscoelasticMindlinInteraction in our example), and execute the Interaction::computeForce function, which computes the interaction forces.</p>
<h2><a class="anchor" id="inheritance"></a>
Inheritance structure</h2>
<p>There are more than 30 different contact laws available in MercuryDPM, each described by one Species and one Interaction class. There are so many, because each contact law is a combination of three different contact forces: a normal force \(f^n\), a friction force \(f^t\), and an adhesive force \(f^a\); the forces are computed in this order, as the friction and adhesion forces often depend on the normal force (as in Hertz-Mindlin). Therefore, we use diamond inheritance to define the Species. For example, HertzianViscoelasticMindlinSpecies is simply a short name (typedef) for a Species class templated with three different interaction forces, Species&lt;HertzianViscoelasticNormalSpecies, MindlinSpecies, EmptyAdhesiveSpecies&gt;. See Species for more details.</p>
<h1><a class="anchor" id="new"></a>
Creating a new contact law</h1>
<p>To create a new contact law, it's easiest to start by modifying an existing one. For example, the Mindlin contact law for friction (see MindlinSpecies) was created by modifying the linear sliding friction force (see SlidingFrictionSpecies).</p>
<p>In the following, I will describe how MindlinSpecies was created, so developers can follow the same steps to create new contact laws. I will assume that you have installed the Trunk version of MercuryDPM in <code>MercurySource</code> and your build directory is <code>MercuryBuild</code>.</p>
<ol type="1">
<li>The first step is to create a new Species and Interaction class for your new contact force. You can do this by copying an existing one: <div class="fragment"><div class="line">$ cd MercurySource/Kernel/Interactions/FrictionForceInteractions/</div>
<div class="line">$ cp SlidingFrictionInteraction.h MindlinInteraction.h</div>
<div class="line">$ cp SlidingFrictionInteraction.cc MindlinInteraction.cc</div>
<div class="line">$ git add .</div>
<div class="line">$ cd ../../Species/FrictionalForceSpecies/</div>
<div class="line">$ cp SlidingFrictionSpecies.h MindlinSpecies.h</div>
<div class="line">$ cp SlidingFrictionSpecies.cc MindlinSpecies.cc</div>
<div class="line">$ git add .</div>
</div><!-- fragment --> Note in the above example we copied a frictional species; however, if you want a normal only species e.g. create the SPH species you should replace the septs with the following <div class="fragment"><div class="line">$ cd MercurySource/Kernel/Interactions/NormalForceInteractions</div>
<div class="line">$ cp LinearViscoelasticInteraction.h SPHInteraction.h</div>
<div class="line">$ cp LinearViscoelasticInteraction.cc SPHInteraction.cc</div>
<div class="line">$ git add .</div>
<div class="line">$ cd ../../Species/NormalForceSpecies</div>
<div class="line">$ cp LinearViscoelasticNormalSpecies.cc SPHSpecies.cc</div>
<div class="line">$ cp LinearViscoelasticNormalSpecies.h SPHSpecies.h </div>
<div class="line">$ git add .</div>
</div><!-- fragment --></li>
<li>Rename the class SlidingFrictionInteraction and SlidingFrictionSpecies to MindlinInteraction and MindlinSpecies, respectively. This requires also changes to the header inclusion guards and typedefs. You can see the changes to the header files below: <br  />
<code>MercurySource/Kernel/Interactions/FrictionForceInteractions/SlidingFrictionInteraction.h</code> <div class="fragment"><div class="line">#ifndef SLIDINGFRICTIONINTERACTION_H</div>
<div class="line">#define SLIDINGFRICTIONINTERACTION_H</div>
<div class="line"> </div>
<div class="line">class SlidingFrictionSpecies;</div>
<div class="line"> </div>
<div class="line">class SlidingFrictionInteraction : public virtual BaseInteraction</div>
<div class="line">{</div>
<div class="line">public:</div>
<div class="line"> </div>
<div class="line">    typedef SlidingFrictionSpecies SpeciesType;</div>
<div class="line"> </div>
<div class="line">    SlidingFrictionInteraction(BaseInteractable* P, BaseInteractable* I, unsigned timeStamp);</div>
</div><!-- fragment --> <code>MercurySource/Kernel/Interactions/FrictionForceInteractions/MindlinInteraction.h</code> <div class="fragment"><div class="line">#ifndef MINDLININTERACTION_H</div>
<div class="line">#define MINDLININTERACTION_H</div>
<div class="line"> </div>
<div class="line">class MindlinSpecies;</div>
<div class="line"> </div>
<div class="line">class MindlinInteraction : public virtual BaseInteraction</div>
<div class="line">{</div>
<div class="line">public:</div>
<div class="line"> </div>
<div class="line">    typedef MindlinSpecies SpeciesType;</div>
<div class="line"> </div>
<div class="line">    MindlinInteraction(BaseInteractable* P, BaseInteractable* I, unsigned timeStamp);</div>
</div><!-- fragment --> <code>MercurySource/Kernel/Species/FrictionForceSpecies/SlidingFrictionSpecies.h</code> <div class="fragment"><div class="line">#ifndef SLIDINGFRICTIONSPECIES_H</div>
<div class="line">#define SLIDINGFRICTIONSPECIES_H</div>
<div class="line"> </div>
<div class="line">#include &quot;Interactions/FrictionForceInteractions/SlidingFrictionInteraction.h&quot;</div>
<div class="line"> </div>
<div class="line">class SlidingFrictionSpecies : public BaseNormalForce</div>
<div class="line">{</div>
<div class="line">public:</div>
<div class="line">    typedef SlidingFrictionInteraction InteractionType;</div>
<div class="line"> </div>
<div class="line">    SlidingFrictionSpecies();</div>
</div><!-- fragment --> Please also correct the copy constructor, the empty constructor and destructor which are needed for MPI and other functions not shown here. <code>MercurySource/Kernel/Species/FrictionForceSpecies/MindlinSpecies.h</code> <div class="fragment"><div class="line">#ifndef MINDLINSPECIES_H</div>
<div class="line">#define MINDLINSPECIES_H</div>
<div class="line"> </div>
<div class="line">#include &quot;Interactions/FrictionForceInteractions/MindlinInteraction.h&quot;</div>
<div class="line"> </div>
<div class="line">class MindlinSpecies : public BaseNormalForce</div>
<div class="line">{</div>
<div class="line">public:</div>
<div class="line">    typedef MindlinInteraction InteractionType;</div>
<div class="line"> </div>
<div class="line">    MindlinSpecies();</div>
</div><!-- fragment --> Please also correct the copy constructor and the empty constructor which are needed for MPI and other functions not shown here. Also there are various other places you need to make the same correct but this should be clear, so not fully documented here.</li>
<li>You do not need to add the new Species and Interaction to the CMakeList as this is built automatically; however, you do need to type 'make rebuild_cache', to rebuild these lists. Finally, it is advisable to run 'make fullTest' at the end to clear and rebuild these list and everything else from scratch.</li>
<li>Create a new typedef for the new Hertz-Mindlin contact law in <br  />
<code>MercurySource/Kernel/Species/HertzianViscoelasticMindlinSpecies.h</code> <div class="fragment"><div class="line"><span class="preprocessor">#ifndef HERTZIANVISCOELASTICMINDLINSPECIES_H</span></div>
<div class="line"><span class="preprocessor">#define HERTZIANVISCOELASTICMINDLINSPECIES_H</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../d7/dd9/Species_8h.html">Species.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../de/d6f/HertzianViscoelasticNormalSpecies_8h.html">NormalForceSpecies/HertzianViscoelasticNormalSpecies.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../de/d7b/MindlinSpecies_8h.html">FrictionForceSpecies/MindlinSpecies.h</a>&quot;</span></div>
<div class="line"><span class="keyword">typedef</span> <a class="code" href="../../d9/d0c/classSpecies.html">Species&lt;HertzianViscoelasticNormalSpecies,MindlinSpecies&gt;</a> <a class="code" href="../../d7/dab/HertzianViscoelasticMindlinSpecies_8h.html#a999db0dab3a90ff46508b7bdeaf0750b">HertzianViscoelasticMindlinSpecies</a>;</div>
<div class="line"><span class="keyword">typedef</span> <a class="code" href="../../d1/d43/classMixedSpecies.html">MixedSpecies&lt;HertzianViscoelasticNormalSpecies,MindlinSpecies&gt;</a> <a class="code" href="../../d7/dab/HertzianViscoelasticMindlinSpecies_8h.html#a05e9f5a0e511f191146bbac8ac9f2fdd">HertzianViscoelasticMindlinMixedSpecies</a>;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="ttc" id="aHertzianViscoelasticMindlinSpecies_8h_html_a05e9f5a0e511f191146bbac8ac9f2fdd"><div class="ttname"><a href="../../d7/dab/HertzianViscoelasticMindlinSpecies_8h.html#a05e9f5a0e511f191146bbac8ac9f2fdd">HertzianViscoelasticMindlinMixedSpecies</a></div><div class="ttdeci">MixedSpecies&lt; HertzianViscoelasticNormalSpecies, MindlinSpecies &gt; HertzianViscoelasticMindlinMixedSpecies</div><div class="ttdef"><b>Definition:</b> HertzianViscoelasticMindlinSpecies.h:13</div></div>
<div class="ttc" id="aHertzianViscoelasticMindlinSpecies_8h_html_a999db0dab3a90ff46508b7bdeaf0750b"><div class="ttname"><a href="../../d7/dab/HertzianViscoelasticMindlinSpecies_8h.html#a999db0dab3a90ff46508b7bdeaf0750b">HertzianViscoelasticMindlinSpecies</a></div><div class="ttdeci">Species&lt; HertzianViscoelasticNormalSpecies, MindlinSpecies &gt; HertzianViscoelasticMindlinSpecies</div><div class="ttdef"><b>Definition:</b> HertzianViscoelasticMindlinSpecies.h:12</div></div>
<div class="ttc" id="aHertzianViscoelasticNormalSpecies_8h_html"><div class="ttname"><a href="../../de/d6f/HertzianViscoelasticNormalSpecies_8h.html">HertzianViscoelasticNormalSpecies.h</a></div></div>
<div class="ttc" id="aMindlinSpecies_8h_html"><div class="ttname"><a href="../../de/d7b/MindlinSpecies_8h.html">MindlinSpecies.h</a></div></div>
<div class="ttc" id="aSpecies_8h_html"><div class="ttname"><a href="../../d7/dd9/Species_8h.html">Species.h</a></div></div>
<div class="ttc" id="aclassMixedSpecies_html"><div class="ttname"><a href="../../d1/d43/classMixedSpecies.html">MixedSpecies</a></div><div class="ttdoc">Contains contact force properties for contacts between particles with two different species.</div><div class="ttdef"><b>Definition:</b> MixedSpecies.h:22</div></div>
</div><!-- fragment --> and add it to the git repository <div class="fragment"><div class="line">$ git add MercurySource/<a class="code" href="../../d1/db8/classKernel.html">Kernel</a>/<a class="code" href="../../d9/d0c/classSpecies.html">Species</a>/<a class="code" href="../../d9/d0c/classSpecies.html">HertzianViscoelasticMindlinSpecies</a>.h</div>
<div class="ttc" id="aclassKernel_html"><div class="ttname"><a href="../../d1/db8/classKernel.html">Kernel</a></div></div>
</div><!-- fragment --></li>
<li>Add the new species to the SpeciesHandler::readAndAddObject and SpeciesHandler::readMixedObject, so restart files can read in the new species information <div class="fragment"><div class="line">$ git diff -r1587:1588 MercurySource/Kernel/SpeciesHandler.cc</div>
<div class="line">@@ -33,6 +33,7 @@</div>
<div class="line">+#include &quot;Species/HertzianViscoelasticMindlinSpecies.h&quot;</div>
<div class="line"> </div>
<div class="line">@@ -261,6 +262,12 @@</div>
<div class="line">+    else if (type == &quot;HertzianViscoelasticMindlinSpecies&quot;)</div>
<div class="line">+    {</div>
<div class="line">+        HertzianViscoelasticMindlinSpecies species;</div>
<div class="line">+        is &gt;&gt; species;</div>
<div class="line">+        copyAndAddObject(species);</div>
<div class="line">+    }</div>
<div class="line"> </div>
<div class="line">@@ -412,6 +419,11 @@</div>
<div class="line">+        else if (type == &quot;HertzianViscoelasticMindlinMixedSpecies&quot;)</div>
<div class="line">+        {</div>
<div class="line">+            HertzianViscoelasticMindlinMixedSpecies species;</div>
<div class="line">+            is &gt;&gt; species;</div>
<div class="line">+        }</div>
<div class="line"> </div>
<div class="line">@@ -696,3 +708,4 @@</div>
<div class="line">+template HertzianViscoelasticMindlinSpecies::MixedSpeciesType* SpeciesHandler::getMixedObject(const HertzianViscoelasticMindlinSpecies*,const HertzianViscoelasticMindlinSpecies*);</div>
</div><!-- fragment --> Do not forget to include the new species type to the species handler includes i.e add <div class="fragment"></div><!-- fragment --></li>
<li>Now try out if your new contact law is ready to compile: <div class="fragment"><div class="line">$ cd MercuryBuild</div>
<div class="line">$ make fullTest</div>
</div><!-- fragment --></li>
</ol>
<p>Your new contact law still does the same as the original contact law, but you have created all the new classes you need to define new behaviour. Take a look and compare the files SlidingFrictionSpecies.* and SlidingFrictionInteraction.* with MindlinSpecies.* and MindlinInteraction.* to see how the parameters and the force law definitions have changed.</p>
<p>Once your new species works you should add a new unit test to MercuryDPM to test the species behavior. For the Mindlin Species, this is done in <code>Drivers/UnitTests/MindlinUnitTest.cpp</code>. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dd/d62/UnclassifiedPages.html">Unclassified pages</a></li><li class="navelem"><a class="el" href="../../d8/d51/GettingStarted.html">Getting started</a></li><li class="navelem"><a class="el" href="../../df/d1c/IntroductionToTheCode.html">Introduction to the Code</a></li><li class="navelem"><a class="el" href="../../dc/d32/DevelopersGuide.html">Guidelines for Users and Developers</a></li><li class="navelem"><a class="el" href="../../d3/da2/DevelopersGuideKernel.html">Developing a kernel feature</a></li>
    <li class="footer">Generated on Wed Aug 27 2025 17:05:12 for MercuryDPM by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
