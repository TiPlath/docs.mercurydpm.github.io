<!-- HTML header for doxygen 1.8.18-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MercuryDPM: oomph::MeshHelper Namespace Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../MDPM.css" rel="stylesheet" type="text/css"/>
<link href="../../codeLabels.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-fork-corner.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-dropdown-version.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../MDPM-fragment-copy-button.js"></script>
<script type="text/javascript">
DoxygenAwesomeFragmentCopyButton.init()
</script>
<script type="text/javascript" src="../../MDPM-paragraph-link.js"></script>
<script type="text/javascript">
DoxygenAwesomeParagraphLink.init()
</script>
<script type="text/javascript" src="../../MDPM-interactive-toc.js"></script>
<script type="text/javascript">
DoxygenAwesomeInteractiveToc.init()
</script>
<script type="text/javascript" src="../../MDPM-darkmode-toggle.js"></script>
<script type="text/javascript">
DoxygenAwesomeDarkModeToggle.init()
</script>
</head>
<body>
  <div id="bitbucket-corner">
   <a href="https://bitbucket.org/mercurydpm/mercurydpm/src/master/" target="_blank" id="fork-corner" class="fork-corner fc-pos-tr fc-animate fc-theme-bitbucket"></a>
  </div>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../mercury-logo-chosen-light-slogan.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"> <!--MercuryDPM--!>
   <!-- BEGIN version select -->
   <div class="dropdown" id="projectnumber">
    <button class="dropbtn">v1.0</button>
    <div class="dropdown-content">
    </div>
   </div>
   <script type="text/javascript" src="../../MDPM-dropdown-version.js"></script>
<!-- END version select -->
   <!--&#160;<span id="projectnumber">revision: v1.0</span>-->
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<script type="text/javascript" src="../../MDPM-fork-corner.js"></script>
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('de/d86/namespaceoomph_1_1MeshHelper.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">oomph::MeshHelper Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab8ab6ab2458ecf06ad20dbf9b87a4e25"><td class="memTemplParams" colspan="2">template&lt;class MESH1 , class MESH2 &gt; </td></tr>
<tr class="memitem:ab8ab6ab2458ecf06ad20dbf9b87a4e25"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../de/d86/namespaceoomph_1_1MeshHelper.html#ab8ab6ab2458ecf06ad20dbf9b87a4e25">merge_spine_meshes</a> (MESH1 *mesh_pt, <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> bound1, MESH2 *addmesh_pt, <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> *addmesh_map_boundary, <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> total_boundaries, <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> spine_flag)</td></tr>
<tr class="separator:ab8ab6ab2458ecf06ad20dbf9b87a4e25"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="ab8ab6ab2458ecf06ad20dbf9b87a4e25"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8ab6ab2458ecf06ad20dbf9b87a4e25">&#9670;&nbsp;</a></span>merge_spine_meshes()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class MESH1 , class MESH2 &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void oomph::MeshHelper::merge_spine_meshes </td>
          <td>(</td>
          <td class="paramtype">MESH1 *&#160;</td>
          <td class="paramname"><em>mesh_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td>
          <td class="paramname"><em>bound1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MESH2 *&#160;</td>
          <td class="paramname"><em>addmesh_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> *&#160;</td>
          <td class="paramname"><em>addmesh_map_boundary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a>&#160;</td>
          <td class="paramname"><em>total_boundaries</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td>
          <td class="paramname"><em>spine_flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Now the surface elements</p>
<div class="fragment"><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    {   </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;     <span class="keywordtype">int</span> bound2 = -1;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">//Map of the commom nodes from the nodes in the added mesh to the old mesh (It is needed for the added elements to point to the old nodes and not duplicate this nodes) </span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;     std::map&lt;Node*,Node*&gt; map_bound_node;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;     </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;     std::map&lt;Spine*, Spine*&gt; map_spines;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;     </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">// We have to look for the shared boundary of the second mwsh. We identify it giving a value of -1 in the mappring of the old to the new boundary conditions</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;addmesh_pt-&gt;nboundary(); <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;       <span class="keywordflow">if</span>(addmesh_map_boundary[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] == -1)</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        bound2 = <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      }</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;     </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;     </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;     <span class="keywordflow">if</span>(bound2 == -1) </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;       <span class="keywordflow">throw</span> OomphLibError(<span class="stringliteral">&quot;Error setting the shared boundary conditions&quot;</span>,</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                           <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                           <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      }</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;     </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;     </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;     </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">// Another control. Test that the two shared boundaries have the same number of nodes</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;     <span class="keywordflow">if</span>(addmesh_pt-&gt;nboundary_node(bound2) != mesh_pt-&gt;nboundary_node(bound1) ) </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;       std::ostringstream error_stream;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;       error_stream </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;Error: different number of nodes in the shared boundaries:&quot;</span> </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;Boundary &quot;</span>&lt;&lt;bound1&lt;&lt;<span class="stringliteral">&quot; in the original mesh has &quot;</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        &lt;&lt;mesh_pt-&gt;nboundary_node(bound1)&lt;&lt;<span class="stringliteral">&quot; nodes &quot;</span>&lt;&lt;std::endl&lt;&lt;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <span class="stringliteral">&quot;and Boundary &quot;</span>&lt;&lt;bound2&lt;&lt;<span class="stringliteral">&quot; in the added mesh has &quot;</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        &lt;&lt;addmesh_pt-&gt;nboundary_node(bound2)&lt;&lt;<span class="stringliteral">&quot; nodes.&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;       </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keywordflow">throw</span> OomphLibError(error_stream.str(),</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                        <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                        <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      }</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">//We create the mappping</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;   </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="comment">//square distance between two nodes</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="keywordtype">double</span> d;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">// Minimun distance between two nodes (only useful in case of error)</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="../../dc/d51/datatypes_8h.html#a0978a1b8e1dc8878376a50a88725223d">dmin</a>;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="comment">//Dimession of the space</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordtype">unsigned</span> dim = addmesh_pt-&gt;node_pt(0)-&gt;ndim();</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nodecounter;  </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt; addmesh_pt-&gt;nboundary_node(bound2);<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;   {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;     nodecounter =0;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;     <a class="code" href="../../dc/d51/datatypes_8h.html#a0978a1b8e1dc8878376a50a88725223d">dmin</a> = 100.0;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;     <span class="keywordflow">do</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;     {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      d = 0.0;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>=0;<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>&lt;dim;<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>++)</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;       {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;         d += (addmesh_pt-&gt;boundary_node_pt(bound2,<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)-&gt;x(<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>) -  mesh_pt-&gt;boundary_node_pt(bound1,nodecounter)-&gt;x(<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>) )* </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;              (addmesh_pt-&gt;boundary_node_pt(bound2,<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)-&gt;x(<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>) -  mesh_pt-&gt;boundary_node_pt(bound1,nodecounter)-&gt;x(<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>) );        </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;       }</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      nodecounter++;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="../../dc/d51/datatypes_8h.html#a0978a1b8e1dc8878376a50a88725223d">dmin</a>&gt;d) <a class="code" href="../../dc/d51/datatypes_8h.html#a0978a1b8e1dc8878376a50a88725223d">dmin</a> = d;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;     }<span class="keywordflow">while</span>((nodecounter &lt; mesh_pt-&gt;nboundary_node(bound1)) &amp;&amp; (d&gt;1<a class="code" href="../../de/dbd/namespaceGlobal__Physical__Variables.html#a09a019474b7405b35da2437f7779bc7e">E</a>-10));</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;     </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;     <span class="keywordflow">if</span>((nodecounter == mesh_pt-&gt;nboundary_node(bound1)) &amp;&amp; (d&gt;1<a class="code" href="../../de/dbd/namespaceGlobal__Physical__Variables.html#a09a019474b7405b35da2437f7779bc7e">E</a>-10))</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;     {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      std::ostringstream error_stream;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      error_stream </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;       &lt;&lt;<span class="stringliteral">&quot;Error doing the mapping between shared boundaries:\n&quot;</span>&lt;&lt; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;       <span class="stringliteral">&quot;it could not be found minimum distance in node &quot;</span>&lt;&lt;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;       &lt;&lt;<span class="stringliteral">&quot;Minimum found distance = &quot;</span>&lt;&lt;<a class="code" href="../../d8/de9/AnnoyingScalar_8h.html#abe7b2405f1f05f9997193c680e8e2fe0">sqrt</a>(<a class="code" href="../../dc/d51/datatypes_8h.html#a0978a1b8e1dc8878376a50a88725223d">dmin</a>)&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;       &lt;&lt;<span class="stringliteral">&quot;Position in the added mesh  = &quot;</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;       &lt;&lt;addmesh_pt-&gt;boundary_node_pt(bound2,<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)-&gt;x(0)</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;       &lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;addmesh_pt-&gt;boundary_node_pt(bound2,<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)-&gt;x(1)&lt;&lt;<span class="stringliteral">&quot;   &quot;</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;       &lt;&lt;addmesh_pt-&gt;boundary_node_pt(bound2,<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)-&gt;x(2)&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(error_stream.str(),</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;     }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;     <span class="keywordflow">else</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      { </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;       <span class="comment">// Creating the nodes map</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        map_bound_node[addmesh_pt-&gt;boundary_node_pt(bound2,<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)] =  mesh_pt-&gt;boundary_node_pt(bound1,nodecounter-1);       </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;         <span class="comment">// Once we have indentified the corresponding nodes we map the spines</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        SpineNode *add_spinenode = <span class="keyword">dynamic_cast&lt;</span>SpineNode*<span class="keyword">&gt;</span>(addmesh_pt-&gt;boundary_node_pt(bound2,<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        SpineNode *org_spinenode = <span class="keyword">dynamic_cast&lt;</span>SpineNode*<span class="keyword">&gt;</span>( mesh_pt-&gt;boundary_node_pt(bound1,nodecounter-1) );</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;       </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="keywordflow">if</span>(add_spinenode ==0)</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;         <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;          <span class="stringliteral">&quot;There are nodes on the shared boundary of the added mesh which are not Spine Nodes\n&quot;</span>,</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;         }</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;         <span class="keywordflow">if</span>(org_spinenode ==0)</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;         {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;          <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;           <span class="stringliteral">&quot;There are nodes on the shared boundary of the original mesh which are not Spine Nodes\n&quot;</span>,</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;           <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;           <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;         } <span class="comment">//mesh3_pt</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;         Spine *add_spine = add_spinenode-&gt;spine_pt();</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;         Spine *org_spine = org_spinenode-&gt;spine_pt();</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;         </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="comment">//we check the map from this  spine has not been before asigned  (one spine is pointed by many nodes)</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;         <span class="keywordflow">if</span>(map_spines[add_spine] == 0)</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;          {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;             map_spines[add_spine] = org_spine;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;          }</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;         <span class="keywordflow">else</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;          {</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">//We assure that the nodes that belong to  one spine in one mesh are as well belonging to only one spine in the other mesh</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;             <span class="keywordflow">if</span>( map_spines[add_spine] != org_spine )</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;              {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;               <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                <span class="stringliteral">&quot;The spines map could not be performed because the shared spines are pointing to different nodes\n&quot;</span>,</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;              }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;          }</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      }</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;   </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  }</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="comment">//Now we loop over the elements of the added mesh on the shared boundary and reasign the node and spine pointers to the ones </span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="comment">// of the original mesh. We need to do a distition between ELMENTS and SURFACE ELEMENT</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">// REMARCK!!!!!  the boundary_element scheme was not implemented in the mesh design, so that we have to loop over all the elements</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt; addmesh_pt-&gt;nbulk(); <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++ )</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;   {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="comment">//Pointer to the element</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    FiniteElement* el_pt = addmesh_pt-&gt;bulk_element_pt(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="comment">// Loop over the nodes in the element</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> =0;<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>&lt; el_pt-&gt;nnode();<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;     {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <span class="comment">//In case the node is in the boundary (and therefore in the map), </span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      <span class="comment">//we reasign the node</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      <span class="keywordflow">if</span>(map_bound_node[ el_pt-&gt;node_pt(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) ] != 0)</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;       { </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        el_pt-&gt;node_pt(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) = map_bound_node[ el_pt-&gt;node_pt(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>)];   </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;       }</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;     }</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;   }</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt; addmesh_pt-&gt;ninterface_element(); <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++ )</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;   {    </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">//Pointer to the element</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    FiniteElement* surfel_pt = addmesh_pt-&gt;interface_element_pt(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;   </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="comment">// Loop over the nodes in the element</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> =0;<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>&lt; surfel_pt-&gt;nnode();<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;     {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      <span class="comment">//In case the node is in the boundary (and therefore in the map), </span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      <span class="comment">//we reasign the node</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="keywordflow">if</span>(map_bound_node[ surfel_pt-&gt;node_pt(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) ] != 0)</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;       { </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        surfel_pt-&gt;node_pt(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) = map_bound_node[ surfel_pt-&gt;node_pt(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>)];   </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;       }</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;     }</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;   }</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">//We add the nodes which are not in the shared boundary</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">// and set the spine flag and the mesh for a later update</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n_nodes_addmesh = addmesh_pt-&gt;nnode();</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> zaehler = 0;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>=0;<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>&lt;n_nodes_addmesh;<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;   <span class="keywordflow">if</span>( map_bound_node[ addmesh_pt-&gt;node_pt(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>)] == 0)</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    { </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        addmesh_pt-&gt;node_pt(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>)-&gt;node_update_fct_id() = spine_flag;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        addmesh_pt-&gt;node_pt(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>)-&gt;spine_mesh_pt() = mesh_pt;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        mesh_pt-&gt;add_node_pt( addmesh_pt-&gt;node_pt(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) );       </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    }</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;       zaehler++;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    }</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">//We add the spines which are not in the shared boundary</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">//The ones in the shared boundary will be deleted</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n_spines_addmesh = addmesh_pt-&gt;nspine();</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>=0;<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>&lt;n_spines_addmesh;<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  {</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;   <span class="keywordflow">if</span>( map_spines[ addmesh_pt-&gt;spine_pt(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>)] == 0)</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;       mesh_pt-&gt;add_spine_pt(addmesh_pt-&gt;spine_pt(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>));   </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  }</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">// Another control</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="keywordflow">if</span>(zaehler != addmesh_pt-&gt;nboundary_node(bound2))</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;   {</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    std::ostringstream error_stream;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    error_stream</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;     &lt;&lt;<span class="stringliteral">&quot;Error: you have added &quot;</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;     &lt;&lt;(zaehler-addmesh_pt-&gt;nboundary_node(bound2))</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;     &lt;&lt;<span class="stringliteral">&quot; nodes too much to the mesh.\n&quot;</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;     &lt;&lt;<span class="stringliteral">&quot;(This control should be removed in case we do not want to copy all the nodes of the shared boundaries)\n&quot;</span>;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keywordflow">throw</span> OomphLibError(error_stream.str(),</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                        <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                        <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);                        </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;   }</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; <span class="comment">//We add the elements to the mesh</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;   </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">// add all the elements to the mesh</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt; addmesh_pt-&gt;nelement(); <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  {</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    mesh_pt-&gt;add_element_pt(addmesh_pt-&gt;element_pt(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  }</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">//We reset the boundary conditions of the old mesh (the shared boundary is not more in a boundary)</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    mesh_pt-&gt;remove_boundary_nodes(bound1); </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; <span class="comment">// We reset the number of boundaries</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  mesh_pt-&gt;set_nboundary(total_boundaries);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160; </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="comment">//We reset the boundary conditions of the new nodes</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;(<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a>)(addmesh_pt-&gt;nboundary());<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;   {</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="comment">//Loop over the boundary nodes</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> =0;<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>&lt;addmesh_pt-&gt;nboundary_node(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;     {</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;         <span class="comment">//We do not reset the commom boundary,whose nodes will be deleted  at the end</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;       <span class="keywordflow">if</span>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>!=bound2)</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;          <span class="comment">//Create a pointer to the node</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;          Node* node_pt =  addmesh_pt-&gt;boundary_node_pt(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;          </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;          <span class="comment">// We remove the old boundaries in case it is not yet included in a new boundary</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;           <span class="keywordtype">bool</span> alr_included = 0;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;           <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> =0;<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>&lt;mesh_pt-&gt;nboundary_node(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>++)</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;           {</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;             <span class="keywordflow">if</span>(node_pt == mesh_pt-&gt;boundary_node_pt(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>) )</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                   alr_included = 1;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;           }</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;           <span class="keywordflow">if</span>(!alr_included)</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;             node_pt-&gt;remove_from_boundary(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;          </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;          <span class="comment">// We test again not to include the nodes which will be deleted</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;           <span class="keywordflow">if</span>( map_bound_node[node_pt] == 0)</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;           { </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;              mesh_pt-&gt;add_boundary_node( addmesh_map_boundary[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>], node_pt ); </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;           }</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;            <span class="comment">// if not we have to include to the boundarie (in the case that they were not included before)the maped nodes</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;           <span class="keywordflow">else</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            {</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;             Node* map_node_pt =  map_bound_node[node_pt];</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;             <span class="keywordflow">if</span>(!map_node_pt-&gt;is_on_boundary(addmesh_map_boundary[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]) )</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                  mesh_pt-&gt;add_boundary_node(addmesh_map_boundary[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>], map_node_pt ); </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            }</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;         }</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;       }</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;   }</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160; </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160; </div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">// We remove the shared spines of the second mesh</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>=0;<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>&lt;n_spines_addmesh;<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  {</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;   <span class="keywordflow">if</span>( map_spines[ addmesh_pt-&gt;spine_pt(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>)] != 0)</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      <span class="keyword">delete</span> addmesh_pt-&gt;spine_pt(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  }</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160; </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">// At the end we remove the shared nodes of the second mesh for avoiding problems with memory leaking</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> =0;<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>&lt;addmesh_pt-&gt;nboundary_node(bound2);<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;     <span class="keyword">delete</span> addmesh_pt-&gt;boundary_node_pt(bound2,<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160; </div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160; </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160; </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">// Small control</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;mesh_pt-&gt;nboundary(); <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> ++)</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;   {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    std::cout&lt;&lt;<span class="stringliteral">&quot;Boundary &quot;</span>&lt;&lt;<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;&lt;<span class="stringliteral">&quot; has &quot;</span>&lt;&lt;mesh_pt-&gt;nboundary_node(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)&lt;&lt;<span class="stringliteral">&quot; nodes.&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;   }</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    }</div>
<div class="ttc" id="aAnnoyingScalar_8h_html_abe7b2405f1f05f9997193c680e8e2fe0"><div class="ttname"><a href="../../d8/de9/AnnoyingScalar_8h.html#abe7b2405f1f05f9997193c680e8e2fe0">sqrt</a></div><div class="ttdeci">AnnoyingScalar sqrt(const AnnoyingScalar &amp;x)</div><div class="ttdef"><b>Definition:</b> AnnoyingScalar.h:134</div></div>
<div class="ttc" id="aBiCGSTAB__step__by__step_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> BiCGSTAB_step_by_step.cpp:9</div></div>
<div class="ttc" id="adatatypes_8h_html_a0978a1b8e1dc8878376a50a88725223d"><div class="ttname"><a href="../../dc/d51/datatypes_8h.html#a0978a1b8e1dc8878376a50a88725223d">dmin</a></div><div class="ttdeci">#define dmin(a, b)</div><div class="ttdef"><b>Definition:</b> datatypes.h:24</div></div>
<div class="ttc" id="alevel1__cplx__impl_8h_html_a4e8e1c1bb9d4e05fc671fc133ec9dc9b"><div class="ttname"><a href="../../d2/d2e/level1__cplx__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a></div><div class="ttdeci">return int(ret)+1</div></div>
<div class="ttc" id="alevel2__impl_8h_html_ad46ea6bf5745e72b985b11878e46a45d"><div class="ttname"><a href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a></div><div class="ttdeci">char char char int int * k</div><div class="ttdef"><b>Definition:</b> level2_impl.h:374</div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a09a019474b7405b35da2437f7779bc7e"><div class="ttname"><a href="../../de/dbd/namespaceGlobal__Physical__Variables.html#a09a019474b7405b35da2437f7779bc7e">Global_Physical_Variables::E</a></div><div class="ttdeci">double E</div><div class="ttdoc">Elastic modulus.</div><div class="ttdef"><b>Definition:</b> TwenteMeshGluing.cpp:68</div></div>
<div class="ttc" id="aoomph__definitions_8h_html_a25c6813cc7341d125e2502f8923fb6c4"><div class="ttname"><a href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a></div><div class="ttdeci">#define OOMPH_EXCEPTION_LOCATION</div><div class="ttdef"><b>Definition:</b> oomph_definitions.h:61</div></div>
<div class="ttc" id="aoomph__definitions_8h_html_aa260cc4af589e30cea7fde997ae16667"><div class="ttname"><a href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a></div><div class="ttdeci">#define OOMPH_CURRENT_FUNCTION</div><div class="ttdef"><b>Definition:</b> oomph_definitions.h:86</div></div>
<div class="ttc" id="atut__arithmetic__redux__minmax_8cpp_html_a39513f0f8d942bf9ef17b2e87ac6d34e"><div class="ttname"><a href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a></div><div class="ttdeci">std::ptrdiff_t j</div><div class="ttdef"><b>Definition:</b> tut_arithmetic_redux_minmax.cpp:2</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d51/datatypes_8h.html#a0978a1b8e1dc8878376a50a88725223d">dmin</a>, <a class="el" href="../../de/dbd/namespaceGlobal__Physical__Variables.html#a09a019474b7405b35da2437f7779bc7e">Global_Physical_Variables::E</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../d2/d2e/level1__cplx__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int()</a>, <a class="el" href="../../dc/db7/classoomph_1_1Node.html#a2ca215e42116ee8a2acc7d6a35e37788">oomph::Node::is_on_boundary()</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">oomph::FiniteElement::nnode()</a>, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a28ae3eb7760edc5c9d6427611d8e6fb6">oomph::FiniteElement::node_pt()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../dc/db7/classoomph_1_1Node.html#a68d4703f8c8aa9f504ec2111dc1908f4">oomph::Node::remove_from_boundary()</a>, <a class="el" href="../../dd/d78/classoomph_1_1SpineNode.html#acb15e93d53f62e899a3c126736b41079">oomph::SpineNode::spine_pt()</a>, and <a class="el" href="../../d8/de9/AnnoyingScalar_8h.html#abe7b2405f1f05f9997193c680e8e2fe0">sqrt()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/dac/classSTSpineMesh.html#a9b7b23a9a8f8a1d1fa5f2c8894eb9567">STSpineMesh&lt; ELEMENT, INTERFACE_ELEMENT &gt;::add_side_spinemesh()</a>, <a class="el" href="../../d6/dc3/classCombCanSpineMesh.html#a221770773f251528bd21d8b8cfbc1cc2">CombCanSpineMesh&lt; ELEMENT, INTERFACE_ELEMENT &gt;::add_side_spinemesh()</a>, and <a class="el" href="../../dc/d2d/classCombTipSpineMesh.html#a0cb2d57855891e20ad008c268f0569c4">CombTipSpineMesh&lt; ELEMENT, INTERFACE_ELEMENT &gt;::add_side_spinemesh()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../da/ddf/namespaceoomph.html">oomph</a></li><li class="navelem"><a class="el" href="../../de/d86/namespaceoomph_1_1MeshHelper.html">MeshHelper</a></li>
    <li class="footer">Generated on Wed Aug 27 2025 17:09:39 for MercuryDPM by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
