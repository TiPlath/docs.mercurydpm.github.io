<!-- HTML header for doxygen 1.8.18-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MercuryDPM: oomph::BrethertonSpineMesh&lt; ELEMENT, INTERFACE_ELEMENT &gt; Class Template Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../MDPM.css" rel="stylesheet" type="text/css"/>
<link href="../../codeLabels.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-fork-corner.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-dropdown-version.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../MDPM-fragment-copy-button.js"></script>
<script type="text/javascript">
DoxygenAwesomeFragmentCopyButton.init()
</script>
<script type="text/javascript" src="../../MDPM-paragraph-link.js"></script>
<script type="text/javascript">
DoxygenAwesomeParagraphLink.init()
</script>
<script type="text/javascript" src="../../MDPM-interactive-toc.js"></script>
<script type="text/javascript">
DoxygenAwesomeInteractiveToc.init()
</script>
<script type="text/javascript" src="../../MDPM-darkmode-toggle.js"></script>
<script type="text/javascript">
DoxygenAwesomeDarkModeToggle.init()
</script>
</head>
<body>
  <div id="bitbucket-corner">
   <a href="https://bitbucket.org/mercurydpm/mercurydpm/src/master/" target="_blank" id="fork-corner" class="fork-corner fc-pos-tr fc-animate fc-theme-bitbucket"></a>
  </div>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../mercury-logo-chosen-light-slogan.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"> <!--MercuryDPM--!>
   <!-- BEGIN version select -->
   <div class="dropdown" id="projectnumber">
    <button class="dropbtn">v1.0</button>
    <div class="dropdown-content">
    </div>
   </div>
   <script type="text/javascript" src="../../MDPM-dropdown-version.js"></script>
<!-- END version select -->
   <!--&#160;<span id="projectnumber">revision: v1.0</span>-->
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<script type="text/javascript" src="../../MDPM-fork-corner.js"></script>
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d5/dba/classoomph_1_1BrethertonSpineMesh.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="../../d6/d24/classoomph_1_1BrethertonSpineMesh-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">oomph::BrethertonSpineMesh&lt; ELEMENT, INTERFACE_ELEMENT &gt; Class Template Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="../../da/db0/bretherton__spine__mesh_8template_8h_source.html">bretherton_spine_mesh.template.h</a>&gt;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Inheritance diagram for oomph::BrethertonSpineMesh&lt; ELEMENT, INTERFACE_ELEMENT &gt;:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
 <div class="center">
  <img src="../../d5/dba/classoomph_1_1BrethertonSpineMesh.png" usemap="#oomph::BrethertonSpineMesh_3C_20ELEMENT_2C_20INTERFACE_5FELEMENT_20_3E_map" alt=""/>
  <map id="oomph::BrethertonSpineMesh_3C_20ELEMENT_2C_20INTERFACE_5FELEMENT_20_3E_map" name="oomph::BrethertonSpineMesh_3C_20ELEMENT_2C_20INTERFACE_5FELEMENT_20_3E_map">
<area href="../../df/da5/classoomph_1_1SingleLayerSpineMesh.html" alt="oomph::SingleLayerSpineMesh&lt; ELEMENT &gt;" shape="rect" coords="206,168,608,192"/>
<area href="../../da/db8/classoomph_1_1RectangularQuadMesh.html" alt="oomph::RectangularQuadMesh&lt; ELEMENT &gt;" shape="rect" coords="0,112,402,136"/>
<area href="../../d6/d74/classoomph_1_1SpineMesh.html" alt="oomph::SpineMesh" shape="rect" coords="412,112,814,136"/>
<area href="../../dc/d50/classoomph_1_1QuadMeshBase.html" title="Base class for quad meshes (meshes made of 2D quad elements)." alt="oomph::QuadMeshBase" shape="rect" coords="0,56,402,80"/>
<area href="../../d6/db8/classoomph_1_1Mesh.html" alt="oomph::Mesh" shape="rect" coords="412,56,814,80"/>
<area href="../../d6/db8/classoomph_1_1Mesh.html" alt="oomph::Mesh" shape="rect" coords="0,0,402,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a0e9c404141ee65b000ab4d1fdc4f11da"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a0e9c404141ee65b000ab4d1fdc4f11da">BrethertonSpineMesh</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;nx1, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;nx2, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;nx3, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;nh, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;nhalf, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;h, <a class="el" href="../../da/ddd/classoomph_1_1GeomObject.html">GeomObject</a> *lower_wall_pt, <a class="el" href="../../da/ddd/classoomph_1_1GeomObject.html">GeomObject</a> *upper_wall_pt, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;zeta_start, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;zeta_transition_start, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;zeta_transition_end, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;zeta_end, <a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html">TimeStepper</a> *time_stepper_pt=&amp;<a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a12243d0fee2b1fcee729ee5a4777ea10">Mesh::Default_TimeStepper</a>)</td></tr>
<tr class="separator:a0e9c404141ee65b000ab4d1fdc4f11da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ecc86c4477f498db8fa3d265baa6088"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html">FiniteElement</a> *&amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a8ecc86c4477f498db8fa3d265baa6088">interface_element_pt</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>)</td></tr>
<tr class="memdesc:a8ecc86c4477f498db8fa3d265baa6088"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access functions for pointers to interface elements.  <a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a8ecc86c4477f498db8fa3d265baa6088">More...</a><br /></td></tr>
<tr class="separator:a8ecc86c4477f498db8fa3d265baa6088"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1ecd7c00fe1032e1ee16d7a98156d5c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#ae1ecd7c00fe1032e1ee16d7a98156d5c">ninterface_element</a> () const</td></tr>
<tr class="memdesc:ae1ecd7c00fe1032e1ee16d7a98156d5c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of elements on interface.  <a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#ae1ecd7c00fe1032e1ee16d7a98156d5c">More...</a><br /></td></tr>
<tr class="separator:ae1ecd7c00fe1032e1ee16d7a98156d5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93770708eb4769c481d2f811f18f005c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html">FiniteElement</a> *&amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a93770708eb4769c481d2f811f18f005c">bulk_element_pt</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>)</td></tr>
<tr class="memdesc:a93770708eb4769c481d2f811f18f005c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access functions for pointers to elements in bulk.  <a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a93770708eb4769c481d2f811f18f005c">More...</a><br /></td></tr>
<tr class="separator:a93770708eb4769c481d2f811f18f005c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47184866746a1fce6dd0ca27ab7e17ce"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a47184866746a1fce6dd0ca27ab7e17ce">nbulk</a> () const</td></tr>
<tr class="memdesc:a47184866746a1fce6dd0ca27ab7e17ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of elements in bulk.  <a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a47184866746a1fce6dd0ca27ab7e17ce">More...</a><br /></td></tr>
<tr class="separator:a47184866746a1fce6dd0ca27ab7e17ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade4d0f2933beddda517b949d80928a18"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#ade4d0f2933beddda517b949d80928a18">nfree_surface_spines</a> ()</td></tr>
<tr class="separator:ade4d0f2933beddda517b949d80928a18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac80488ae4db2da00e1b38f6f07e0ff9d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#ac80488ae4db2da00e1b38f6f07e0ff9d">find_distance_to_free_surface</a> (<a class="el" href="../../da/ddd/classoomph_1_1GeomObject.html">GeomObject</a> *const &amp;fs_geom_object_pt, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;initial_zeta, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;spine_base, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;spine_end)</td></tr>
<tr class="memdesc:ac80488ae4db2da00e1b38f6f07e0ff9d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Recalculate the spine lengths after repositioning.  <a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#ac80488ae4db2da00e1b38f6f07e0ff9d">More...</a><br /></td></tr>
<tr class="separator:ac80488ae4db2da00e1b38f6f07e0ff9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0dfeac5bc9a4fa4bfdcd443def30dcdb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a0dfeac5bc9a4fa4bfdcd443def30dcdb">reposition_spines</a> (const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;zeta_lo_transition_start, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;zeta_lo_transition_end, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;zeta_up_transition_start, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;zeta_up_transition_end)</td></tr>
<tr class="memdesc:a0dfeac5bc9a4fa4bfdcd443def30dcdb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reposition the spines in response to changes in geometry.  <a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a0dfeac5bc9a4fa4bfdcd443def30dcdb">More...</a><br /></td></tr>
<tr class="separator:a0dfeac5bc9a4fa4bfdcd443def30dcdb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a507ea97977b837f2f0d9647407d770cd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a507ea97977b837f2f0d9647407d770cd">pin_all_spines</a> ()</td></tr>
<tr class="separator:a507ea97977b837f2f0d9647407d770cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a981301706d4940cfb24d3d769a7a523b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a981301706d4940cfb24d3d769a7a523b">spine_node_update</a> (<a class="el" href="../../dd/d78/classoomph_1_1SpineNode.html">SpineNode</a> *spine_node_pt)</td></tr>
<tr class="separator:a981301706d4940cfb24d3d769a7a523b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b02893724c76098f75d9285e9985f4b"><td class="memItemLeft" align="right" valign="top">ELEMENT *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a9b02893724c76098f75d9285e9985f4b">control_element_pt</a> ()</td></tr>
<tr class="separator:a9b02893724c76098f75d9285e9985f4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67f784e7b3a898af6c60515042c3ea73"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a67f784e7b3a898af6c60515042c3ea73">spine_centre_fraction</a> () const</td></tr>
<tr class="memdesc:a67f784e7b3a898af6c60515042c3ea73"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read the value of the spine centre's vertical fraction.  <a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a67f784e7b3a898af6c60515042c3ea73">More...</a><br /></td></tr>
<tr class="separator:a67f784e7b3a898af6c60515042c3ea73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33c3ed5af92e7b22a22615f42c34c387"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a33c3ed5af92e7b22a22615f42c34c387">set_spine_centre_fraction_pt</a> (<a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;fraction_pt)</td></tr>
<tr class="memdesc:a33c3ed5af92e7b22a22615f42c34c387"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the pointer to the spine centre's vertial fraction.  <a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a33c3ed5af92e7b22a22615f42c34c387">More...</a><br /></td></tr>
<tr class="separator:a33c3ed5af92e7b22a22615f42c34c387"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classoomph_1_1SingleLayerSpineMesh"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classoomph_1_1SingleLayerSpineMesh')"><img src="../../closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="../../df/da5/classoomph_1_1SingleLayerSpineMesh.html">oomph::SingleLayerSpineMesh&lt; ELEMENT &gt;</a></td></tr>
<tr class="memitem:a2cdbf36114a4da773fb7d659218d09cb inherit pub_methods_classoomph_1_1SingleLayerSpineMesh"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/da5/classoomph_1_1SingleLayerSpineMesh.html#a2cdbf36114a4da773fb7d659218d09cb">SingleLayerSpineMesh</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#abfef93d6322886cdce14a437186e4821">nx</a>, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#a86d76a55eb7c4e8bca9b74d23c8b0412">ny</a>, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;lx, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;h, <a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html">TimeStepper</a> *time_stepper_pt=&amp;<a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a12243d0fee2b1fcee729ee5a4777ea10">Mesh::Default_TimeStepper</a>)</td></tr>
<tr class="separator:a2cdbf36114a4da773fb7d659218d09cb inherit pub_methods_classoomph_1_1SingleLayerSpineMesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb908e31d988eaa930e949a54eeea37f inherit pub_methods_classoomph_1_1SingleLayerSpineMesh"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/da5/classoomph_1_1SingleLayerSpineMesh.html#afb908e31d988eaa930e949a54eeea37f">SingleLayerSpineMesh</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#abfef93d6322886cdce14a437186e4821">nx</a>, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#a86d76a55eb7c4e8bca9b74d23c8b0412">ny</a>, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;lx, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;h, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;periodic_in_x, <a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html">TimeStepper</a> *time_stepper_pt=&amp;<a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a12243d0fee2b1fcee729ee5a4777ea10">Mesh::Default_TimeStepper</a>)</td></tr>
<tr class="separator:afb908e31d988eaa930e949a54eeea37f inherit pub_methods_classoomph_1_1SingleLayerSpineMesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classoomph_1_1RectangularQuadMesh"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classoomph_1_1RectangularQuadMesh')"><img src="../../closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="../../da/db8/classoomph_1_1RectangularQuadMesh.html">oomph::RectangularQuadMesh&lt; ELEMENT &gt;</a></td></tr>
<tr class="memitem:a1f906bca42da3d44765382013667e40d inherit pub_methods_classoomph_1_1RectangularQuadMesh"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#a1f906bca42da3d44765382013667e40d">RectangularQuadMesh</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#abfef93d6322886cdce14a437186e4821">nx</a>, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#a86d76a55eb7c4e8bca9b74d23c8b0412">ny</a>, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;lx, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;ly, <a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html">TimeStepper</a> *time_stepper_pt=&amp;<a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a12243d0fee2b1fcee729ee5a4777ea10">Mesh::Default_TimeStepper</a>)</td></tr>
<tr class="separator:a1f906bca42da3d44765382013667e40d inherit pub_methods_classoomph_1_1RectangularQuadMesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea506679674e4fc5c43b62a53798d0be inherit pub_methods_classoomph_1_1RectangularQuadMesh"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#aea506679674e4fc5c43b62a53798d0be">RectangularQuadMesh</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#abfef93d6322886cdce14a437186e4821">nx</a>, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#a86d76a55eb7c4e8bca9b74d23c8b0412">ny</a>, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;xmin, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;xmax, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;ymin, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;ymax, <a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html">TimeStepper</a> *time_stepper_pt=&amp;<a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a12243d0fee2b1fcee729ee5a4777ea10">Mesh::Default_TimeStepper</a>)</td></tr>
<tr class="separator:aea506679674e4fc5c43b62a53798d0be inherit pub_methods_classoomph_1_1RectangularQuadMesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40f120e00d682026e54593ca0f823535 inherit pub_methods_classoomph_1_1RectangularQuadMesh"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#a40f120e00d682026e54593ca0f823535">RectangularQuadMesh</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#abfef93d6322886cdce14a437186e4821">nx</a>, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#a86d76a55eb7c4e8bca9b74d23c8b0412">ny</a>, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;lx, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;ly, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;periodic_in_x, <a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html">TimeStepper</a> *time_stepper_pt=&amp;<a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a12243d0fee2b1fcee729ee5a4777ea10">Mesh::Default_TimeStepper</a>)</td></tr>
<tr class="separator:a40f120e00d682026e54593ca0f823535 inherit pub_methods_classoomph_1_1RectangularQuadMesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac36869a7d72ec7524b18272657cb6167 inherit pub_methods_classoomph_1_1RectangularQuadMesh"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#ac36869a7d72ec7524b18272657cb6167">RectangularQuadMesh</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#abfef93d6322886cdce14a437186e4821">nx</a>, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#a86d76a55eb7c4e8bca9b74d23c8b0412">ny</a>, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;xmin, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;xmax, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;ymin, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;ymax, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;periodic_in_x, <a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html">TimeStepper</a> *time_stepper_pt=&amp;<a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a12243d0fee2b1fcee729ee5a4777ea10">Mesh::Default_TimeStepper</a>)</td></tr>
<tr class="separator:ac36869a7d72ec7524b18272657cb6167 inherit pub_methods_classoomph_1_1RectangularQuadMesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfef93d6322886cdce14a437186e4821 inherit pub_methods_classoomph_1_1RectangularQuadMesh"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#abfef93d6322886cdce14a437186e4821">nx</a> () const</td></tr>
<tr class="memdesc:abfef93d6322886cdce14a437186e4821 inherit pub_methods_classoomph_1_1RectangularQuadMesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return number of elements in x direction.  <a href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#abfef93d6322886cdce14a437186e4821">More...</a><br /></td></tr>
<tr class="separator:abfef93d6322886cdce14a437186e4821 inherit pub_methods_classoomph_1_1RectangularQuadMesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86d76a55eb7c4e8bca9b74d23c8b0412 inherit pub_methods_classoomph_1_1RectangularQuadMesh"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#a86d76a55eb7c4e8bca9b74d23c8b0412">ny</a> () const</td></tr>
<tr class="memdesc:a86d76a55eb7c4e8bca9b74d23c8b0412 inherit pub_methods_classoomph_1_1RectangularQuadMesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return number of elements in y direction.  <a href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#a86d76a55eb7c4e8bca9b74d23c8b0412">More...</a><br /></td></tr>
<tr class="separator:a86d76a55eb7c4e8bca9b74d23c8b0412 inherit pub_methods_classoomph_1_1RectangularQuadMesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab311c3bec7f9f721bae1f93e0798ab2c inherit pub_methods_classoomph_1_1RectangularQuadMesh"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#ab311c3bec7f9f721bae1f93e0798ab2c">x_min</a> () const</td></tr>
<tr class="memdesc:ab311c3bec7f9f721bae1f93e0798ab2c inherit pub_methods_classoomph_1_1RectangularQuadMesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the minimum value of x coordinate.  <a href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#ab311c3bec7f9f721bae1f93e0798ab2c">More...</a><br /></td></tr>
<tr class="separator:ab311c3bec7f9f721bae1f93e0798ab2c inherit pub_methods_classoomph_1_1RectangularQuadMesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3449b36a5e4fc4728e517bd38d7b0cc6 inherit pub_methods_classoomph_1_1RectangularQuadMesh"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#a3449b36a5e4fc4728e517bd38d7b0cc6">x_max</a> () const</td></tr>
<tr class="memdesc:a3449b36a5e4fc4728e517bd38d7b0cc6 inherit pub_methods_classoomph_1_1RectangularQuadMesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the maximum value of x coordinate.  <a href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#a3449b36a5e4fc4728e517bd38d7b0cc6">More...</a><br /></td></tr>
<tr class="separator:a3449b36a5e4fc4728e517bd38d7b0cc6 inherit pub_methods_classoomph_1_1RectangularQuadMesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c493af1dae35746bed7a31e61b46c5b inherit pub_methods_classoomph_1_1RectangularQuadMesh"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#a1c493af1dae35746bed7a31e61b46c5b">y_min</a> () const</td></tr>
<tr class="memdesc:a1c493af1dae35746bed7a31e61b46c5b inherit pub_methods_classoomph_1_1RectangularQuadMesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the minimum value of y coordinate.  <a href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#a1c493af1dae35746bed7a31e61b46c5b">More...</a><br /></td></tr>
<tr class="separator:a1c493af1dae35746bed7a31e61b46c5b inherit pub_methods_classoomph_1_1RectangularQuadMesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d4a00a545efc20451b00a9b8ad1e17d inherit pub_methods_classoomph_1_1RectangularQuadMesh"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#a7d4a00a545efc20451b00a9b8ad1e17d">y_max</a> () const</td></tr>
<tr class="memdesc:a7d4a00a545efc20451b00a9b8ad1e17d inherit pub_methods_classoomph_1_1RectangularQuadMesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the maximum value of y coordinate.  <a href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#a7d4a00a545efc20451b00a9b8ad1e17d">More...</a><br /></td></tr>
<tr class="separator:a7d4a00a545efc20451b00a9b8ad1e17d inherit pub_methods_classoomph_1_1RectangularQuadMesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1e1d67808d4efb6e16a3835162a4504 inherit pub_methods_classoomph_1_1RectangularQuadMesh"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#ae1e1d67808d4efb6e16a3835162a4504">element_reorder</a> ()</td></tr>
<tr class="separator:ae1e1d67808d4efb6e16a3835162a4504 inherit pub_methods_classoomph_1_1RectangularQuadMesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4c2f349cf201cb3107f0a4e5447c16f inherit pub_methods_classoomph_1_1RectangularQuadMesh"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#ad4c2f349cf201cb3107f0a4e5447c16f">x_spacing_function</a> (<a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> xelement, <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> xnode, <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> yelement, <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> ynode)</td></tr>
<tr class="separator:ad4c2f349cf201cb3107f0a4e5447c16f inherit pub_methods_classoomph_1_1RectangularQuadMesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae78204de1f176cdf2e819673bd34e78a inherit pub_methods_classoomph_1_1RectangularQuadMesh"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#ae78204de1f176cdf2e819673bd34e78a">y_spacing_function</a> (<a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> xelement, <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> xnode, <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> yelement, <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> ynode)</td></tr>
<tr class="separator:ae78204de1f176cdf2e819673bd34e78a inherit pub_methods_classoomph_1_1RectangularQuadMesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classoomph_1_1QuadMeshBase"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classoomph_1_1QuadMeshBase')"><img src="../../closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="../../dc/d50/classoomph_1_1QuadMeshBase.html">oomph::QuadMeshBase</a></td></tr>
<tr class="memitem:a56c68363a134866e636f8aa4a8a29de9 inherit pub_methods_classoomph_1_1QuadMeshBase"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d50/classoomph_1_1QuadMeshBase.html#a56c68363a134866e636f8aa4a8a29de9">QuadMeshBase</a> ()</td></tr>
<tr class="memdesc:a56c68363a134866e636f8aa4a8a29de9 inherit pub_methods_classoomph_1_1QuadMeshBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor (empty)  <a href="../../dc/d50/classoomph_1_1QuadMeshBase.html#a56c68363a134866e636f8aa4a8a29de9">More...</a><br /></td></tr>
<tr class="separator:a56c68363a134866e636f8aa4a8a29de9 inherit pub_methods_classoomph_1_1QuadMeshBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ab7186bebce61ff1a9fe031e464e671 inherit pub_methods_classoomph_1_1QuadMeshBase"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d50/classoomph_1_1QuadMeshBase.html#a5ab7186bebce61ff1a9fe031e464e671">QuadMeshBase</a> (const <a class="el" href="../../dc/d50/classoomph_1_1QuadMeshBase.html">QuadMeshBase</a> &amp;node)=delete</td></tr>
<tr class="memdesc:a5ab7186bebce61ff1a9fe031e464e671 inherit pub_methods_classoomph_1_1QuadMeshBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken copy constructor.  <a href="../../dc/d50/classoomph_1_1QuadMeshBase.html#a5ab7186bebce61ff1a9fe031e464e671">More...</a><br /></td></tr>
<tr class="separator:a5ab7186bebce61ff1a9fe031e464e671 inherit pub_methods_classoomph_1_1QuadMeshBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02f5fb6139fb0bb02ebd951df8b65076 inherit pub_methods_classoomph_1_1QuadMeshBase"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d50/classoomph_1_1QuadMeshBase.html#a02f5fb6139fb0bb02ebd951df8b65076">operator=</a> (const <a class="el" href="../../dc/d50/classoomph_1_1QuadMeshBase.html">QuadMeshBase</a> &amp;)=delete</td></tr>
<tr class="memdesc:a02f5fb6139fb0bb02ebd951df8b65076 inherit pub_methods_classoomph_1_1QuadMeshBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken assignment operator.  <a href="../../dc/d50/classoomph_1_1QuadMeshBase.html#a02f5fb6139fb0bb02ebd951df8b65076">More...</a><br /></td></tr>
<tr class="separator:a02f5fb6139fb0bb02ebd951df8b65076 inherit pub_methods_classoomph_1_1QuadMeshBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abffed544c2e94b255a5a69e66c13b4a0 inherit pub_methods_classoomph_1_1QuadMeshBase"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d50/classoomph_1_1QuadMeshBase.html#abffed544c2e94b255a5a69e66c13b4a0">~QuadMeshBase</a> ()</td></tr>
<tr class="memdesc:abffed544c2e94b255a5a69e66c13b4a0 inherit pub_methods_classoomph_1_1QuadMeshBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor (empty)  <a href="../../dc/d50/classoomph_1_1QuadMeshBase.html#abffed544c2e94b255a5a69e66c13b4a0">More...</a><br /></td></tr>
<tr class="separator:abffed544c2e94b255a5a69e66c13b4a0 inherit pub_methods_classoomph_1_1QuadMeshBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1e5291285fbf34c62cbd45156dded2d inherit pub_methods_classoomph_1_1QuadMeshBase"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d50/classoomph_1_1QuadMeshBase.html#ad1e5291285fbf34c62cbd45156dded2d">setup_boundary_element_info</a> ()</td></tr>
<tr class="separator:ad1e5291285fbf34c62cbd45156dded2d inherit pub_methods_classoomph_1_1QuadMeshBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac61bda5612c87848bb640c8e24371a54 inherit pub_methods_classoomph_1_1QuadMeshBase"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d50/classoomph_1_1QuadMeshBase.html#ac61bda5612c87848bb640c8e24371a54">setup_boundary_element_info</a> (std::ostream &amp;outfile)</td></tr>
<tr class="separator:ac61bda5612c87848bb640c8e24371a54 inherit pub_methods_classoomph_1_1QuadMeshBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classoomph_1_1Mesh"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classoomph_1_1Mesh')"><img src="../../closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">oomph::Mesh</a></td></tr>
<tr class="memitem:aa4a64cb23aa881dbd67c1b633173494f inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#aa4a64cb23aa881dbd67c1b633173494f">Mesh</a> ()</td></tr>
<tr class="memdesc:aa4a64cb23aa881dbd67c1b633173494f inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default constructor.  <a href="../../d6/db8/classoomph_1_1Mesh.html#aa4a64cb23aa881dbd67c1b633173494f">More...</a><br /></td></tr>
<tr class="separator:aa4a64cb23aa881dbd67c1b633173494f inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc3c2f1fe3de3b6e7484eb65eb03efa3 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#afc3c2f1fe3de3b6e7484eb65eb03efa3">Mesh</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> * &gt; &amp;sub_mesh_pt)</td></tr>
<tr class="separator:afc3c2f1fe3de3b6e7484eb65eb03efa3 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4e77a5529b2aabfed8289e313c1c8d9 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af4e77a5529b2aabfed8289e313c1c8d9">merge_meshes</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> * &gt; &amp;sub_mesh_pt)</td></tr>
<tr class="separator:af4e77a5529b2aabfed8289e313c1c8d9 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac481de51900d57248dd601b53816891f inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ac481de51900d57248dd601b53816891f">reset_boundary_element_info</a> (<a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;ntmp_boundary_elements, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt;&gt; &amp;ntmp_boundary_elements_in_region, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html">FiniteElement</a> * &gt; &amp;deleted_elements)</td></tr>
<tr class="memdesc:ac481de51900d57248dd601b53816891f inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Virtual function to perform the reset boundary elements info rutines.  <a href="../../d6/db8/classoomph_1_1Mesh.html#ac481de51900d57248dd601b53816891f">More...</a><br /></td></tr>
<tr class="separator:ac481de51900d57248dd601b53816891f inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68cad622b3fe39d306fe367d0fdf4083 inherit pub_methods_classoomph_1_1Mesh"><td class="memTemplParams" colspan="2">template&lt;class BULK_ELEMENT &gt; </td></tr>
<tr class="memitem:a68cad622b3fe39d306fe367d0fdf4083 inherit pub_methods_classoomph_1_1Mesh"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a68cad622b3fe39d306fe367d0fdf4083">doc_boundary_coordinates</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#a9d82f3af1459c1efc910b77f3ccd3180">b</a>, std::ofstream &amp;the_file)</td></tr>
<tr class="separator:a68cad622b3fe39d306fe367d0fdf4083 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e0d761fca70b856185b7b9b2168663d inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a7e0d761fca70b856185b7b9b2168663d">scale_mesh</a> (const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;factor)</td></tr>
<tr class="separator:a7e0d761fca70b856185b7b9b2168663d inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9e74914296faa6a2d1a2a03503eee2e inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ae9e74914296faa6a2d1a2a03503eee2e">Mesh</a> (const <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> &amp;dummy)=delete</td></tr>
<tr class="memdesc:ae9e74914296faa6a2d1a2a03503eee2e inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken copy constructor.  <a href="../../d6/db8/classoomph_1_1Mesh.html#ae9e74914296faa6a2d1a2a03503eee2e">More...</a><br /></td></tr>
<tr class="separator:ae9e74914296faa6a2d1a2a03503eee2e inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1247fdbb0529b36de0ace7f16b4e70a inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ab1247fdbb0529b36de0ace7f16b4e70a">operator=</a> (const <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> &amp;)=delete</td></tr>
<tr class="memdesc:ab1247fdbb0529b36de0ace7f16b4e70a inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken assignment operator.  <a href="../../d6/db8/classoomph_1_1Mesh.html#ab1247fdbb0529b36de0ace7f16b4e70a">More...</a><br /></td></tr>
<tr class="separator:ab1247fdbb0529b36de0ace7f16b4e70a inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc071afb5c34ca6ced42734030f81353 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#abc071afb5c34ca6ced42734030f81353">~Mesh</a> ()</td></tr>
<tr class="memdesc:abc071afb5c34ca6ced42734030f81353 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Virtual Destructor to clean up all memory.  <a href="../../d6/db8/classoomph_1_1Mesh.html#abc071afb5c34ca6ced42734030f81353">More...</a><br /></td></tr>
<tr class="separator:abc071afb5c34ca6ced42734030f81353 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38446e721be2f75a64fdaa025b7c23ad inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a38446e721be2f75a64fdaa025b7c23ad">flush_element_and_node_storage</a> ()</td></tr>
<tr class="separator:a38446e721be2f75a64fdaa025b7c23ad inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3def47aa1e0028970a250d9c534e93b2 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a3def47aa1e0028970a250d9c534e93b2">flush_element_storage</a> ()</td></tr>
<tr class="separator:a3def47aa1e0028970a250d9c534e93b2 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4773924237488f46fe5ad3fe49138f0 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ab4773924237488f46fe5ad3fe49138f0">flush_node_storage</a> ()</td></tr>
<tr class="separator:ab4773924237488f46fe5ad3fe49138f0 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3c2b72c8ef4e9fd35f5998a5e7dc93b inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/db7/classoomph_1_1Node.html">Node</a> *&amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">node_pt</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long &amp;<a class="el" href="../../d5/d24/level2__real__impl_8h.html#a1224f27e9a621d957f8124bcade25bed">n</a>)</td></tr>
<tr class="memdesc:ab3c2b72c8ef4e9fd35f5998a5e7dc93b inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return pointer to global node n.  <a href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">More...</a><br /></td></tr>
<tr class="separator:ab3c2b72c8ef4e9fd35f5998a5e7dc93b inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a468ab976a9df7c1eb5bade6405a96a72 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/db7/classoomph_1_1Node.html">Node</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a468ab976a9df7c1eb5bade6405a96a72">node_pt</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long &amp;<a class="el" href="../../d5/d24/level2__real__impl_8h.html#a1224f27e9a621d957f8124bcade25bed">n</a>) const</td></tr>
<tr class="memdesc:a468ab976a9df7c1eb5bade6405a96a72 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return pointer to global node n (const version)  <a href="../../d6/db8/classoomph_1_1Mesh.html#a468ab976a9df7c1eb5bade6405a96a72">More...</a><br /></td></tr>
<tr class="separator:a468ab976a9df7c1eb5bade6405a96a72 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a876faf1f87b24b220ea21a38d6adde5b inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html">GeneralisedElement</a> *&amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">element_pt</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long &amp;<a class="el" href="../../db/de3/Cwise__scalar__power__array_8cpp.html#abfa88ee95cd5e1c8d923f1b21740ece4">e</a>)</td></tr>
<tr class="memdesc:a876faf1f87b24b220ea21a38d6adde5b inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return pointer to element e.  <a href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">More...</a><br /></td></tr>
<tr class="separator:a876faf1f87b24b220ea21a38d6adde5b inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f6428fbd6cb234d04bcef7f1e4fd703 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html">GeneralisedElement</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a3f6428fbd6cb234d04bcef7f1e4fd703">element_pt</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long &amp;<a class="el" href="../../db/de3/Cwise__scalar__power__array_8cpp.html#abfa88ee95cd5e1c8d923f1b21740ece4">e</a>) const</td></tr>
<tr class="memdesc:a3f6428fbd6cb234d04bcef7f1e4fd703 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return pointer to element e (const version)  <a href="../../d6/db8/classoomph_1_1Mesh.html#a3f6428fbd6cb234d04bcef7f1e4fd703">More...</a><br /></td></tr>
<tr class="separator:a3f6428fbd6cb234d04bcef7f1e4fd703 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab28b03dabf4e247c4a25f834eb11b339 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html">GeneralisedElement</a> * &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ab28b03dabf4e247c4a25f834eb11b339">element_pt</a> () const</td></tr>
<tr class="memdesc:ab28b03dabf4e247c4a25f834eb11b339 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return reference to the Vector of elements.  <a href="../../d6/db8/classoomph_1_1Mesh.html#ab28b03dabf4e247c4a25f834eb11b339">More...</a><br /></td></tr>
<tr class="separator:ab28b03dabf4e247c4a25f834eb11b339 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a669f0cea59f1b60a5e59176c91340ed9 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html">GeneralisedElement</a> * &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a669f0cea59f1b60a5e59176c91340ed9">element_pt</a> ()</td></tr>
<tr class="memdesc:a669f0cea59f1b60a5e59176c91340ed9 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return reference to the Vector of elements.  <a href="../../d6/db8/classoomph_1_1Mesh.html#a669f0cea59f1b60a5e59176c91340ed9">More...</a><br /></td></tr>
<tr class="separator:a669f0cea59f1b60a5e59176c91340ed9 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f274774435e9454bf77bf70de69367a inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html">FiniteElement</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a4f274774435e9454bf77bf70de69367a">finite_element_pt</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../db/de3/Cwise__scalar__power__array_8cpp.html#abfa88ee95cd5e1c8d923f1b21740ece4">e</a>) const</td></tr>
<tr class="separator:a4f274774435e9454bf77bf70de69367a inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca0a21f4eab2d6fe8c7fa011b5c33c3c inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/db7/classoomph_1_1Node.html">Node</a> *&amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#aca0a21f4eab2d6fe8c7fa011b5c33c3c">boundary_node_pt</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#a9d82f3af1459c1efc910b77f3ccd3180">b</a>, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d5/d24/level2__real__impl_8h.html#a1224f27e9a621d957f8124bcade25bed">n</a>)</td></tr>
<tr class="memdesc:aca0a21f4eab2d6fe8c7fa011b5c33c3c inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return pointer to node n on boundary b.  <a href="../../d6/db8/classoomph_1_1Mesh.html#aca0a21f4eab2d6fe8c7fa011b5c33c3c">More...</a><br /></td></tr>
<tr class="separator:aca0a21f4eab2d6fe8c7fa011b5c33c3c inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ab2bf2cf4cca88b7a972d1a659c7e5a inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/db7/classoomph_1_1Node.html">Node</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a0ab2bf2cf4cca88b7a972d1a659c7e5a">boundary_node_pt</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#a9d82f3af1459c1efc910b77f3ccd3180">b</a>, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d5/d24/level2__real__impl_8h.html#a1224f27e9a621d957f8124bcade25bed">n</a>) const</td></tr>
<tr class="memdesc:a0ab2bf2cf4cca88b7a972d1a659c7e5a inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return pointer to node n on boundary b.  <a href="../../d6/db8/classoomph_1_1Mesh.html#a0ab2bf2cf4cca88b7a972d1a659c7e5a">More...</a><br /></td></tr>
<tr class="separator:a0ab2bf2cf4cca88b7a972d1a659c7e5a inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6667f4ddc6e9357a9a7d53160db8161e inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a6667f4ddc6e9357a9a7d53160db8161e">set_nboundary</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;nbound)</td></tr>
<tr class="memdesc:a6667f4ddc6e9357a9a7d53160db8161e inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the number of boundaries in the mesh.  <a href="../../d6/db8/classoomph_1_1Mesh.html#a6667f4ddc6e9357a9a7d53160db8161e">More...</a><br /></td></tr>
<tr class="separator:a6667f4ddc6e9357a9a7d53160db8161e inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d86e14d55a1162e184bd7fac4630904 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a8d86e14d55a1162e184bd7fac4630904">remove_boundary_nodes</a> ()</td></tr>
<tr class="memdesc:a8d86e14d55a1162e184bd7fac4630904 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clear all pointers to boundary nodes.  <a href="../../d6/db8/classoomph_1_1Mesh.html#a8d86e14d55a1162e184bd7fac4630904">More...</a><br /></td></tr>
<tr class="separator:a8d86e14d55a1162e184bd7fac4630904 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bf720135d0728907b98c5d31157f569 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a5bf720135d0728907b98c5d31157f569">remove_boundary_nodes</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#a9d82f3af1459c1efc910b77f3ccd3180">b</a>)</td></tr>
<tr class="separator:a5bf720135d0728907b98c5d31157f569 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1690e5351ff05b5e47db184f64b1edc4 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a1690e5351ff05b5e47db184f64b1edc4">remove_boundary_node</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#a9d82f3af1459c1efc910b77f3ccd3180">b</a>, <a class="el" href="../../dc/db7/classoomph_1_1Node.html">Node</a> *const &amp;<a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">node_pt</a>)</td></tr>
<tr class="memdesc:a1690e5351ff05b5e47db184f64b1edc4 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove a node from the boundary b.  <a href="../../d6/db8/classoomph_1_1Mesh.html#a1690e5351ff05b5e47db184f64b1edc4">More...</a><br /></td></tr>
<tr class="separator:a1690e5351ff05b5e47db184f64b1edc4 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a007b102ac8e42328872ad658d7110bfc inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a007b102ac8e42328872ad658d7110bfc">add_boundary_node</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#a9d82f3af1459c1efc910b77f3ccd3180">b</a>, <a class="el" href="../../dc/db7/classoomph_1_1Node.html">Node</a> *const &amp;<a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">node_pt</a>)</td></tr>
<tr class="memdesc:a007b102ac8e42328872ad658d7110bfc inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a (pointer to) a node to the b-th boundary.  <a href="../../d6/db8/classoomph_1_1Mesh.html#a007b102ac8e42328872ad658d7110bfc">More...</a><br /></td></tr>
<tr class="separator:a007b102ac8e42328872ad658d7110bfc inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67b93ac3809bcc1fe3220c46f417682f inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a67b93ac3809bcc1fe3220c46f417682f">copy_boundary_node_data_from_nodes</a> ()</td></tr>
<tr class="separator:a67b93ac3809bcc1fe3220c46f417682f inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1b124a959628aba00162b89617b3a62 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ad1b124a959628aba00162b89617b3a62">boundary_coordinate_exists</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>) const</td></tr>
<tr class="memdesc:ad1b124a959628aba00162b89617b3a62 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Indicate whether the i-th boundary has an intrinsic coordinate.  <a href="../../d6/db8/classoomph_1_1Mesh.html#ad1b124a959628aba00162b89617b3a62">More...</a><br /></td></tr>
<tr class="separator:ad1b124a959628aba00162b89617b3a62 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af01dfefb66c15579b540be62999d93ee inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">nelement</a> () const</td></tr>
<tr class="memdesc:af01dfefb66c15579b540be62999d93ee inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return number of elements in the mesh.  <a href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">More...</a><br /></td></tr>
<tr class="separator:af01dfefb66c15579b540be62999d93ee inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a945e7823d1a2af243b5b7f7866aaff5e inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a945e7823d1a2af243b5b7f7866aaff5e">nnode</a> () const</td></tr>
<tr class="memdesc:a945e7823d1a2af243b5b7f7866aaff5e inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return number of nodes in the mesh.  <a href="../../d6/db8/classoomph_1_1Mesh.html#a945e7823d1a2af243b5b7f7866aaff5e">More...</a><br /></td></tr>
<tr class="separator:a945e7823d1a2af243b5b7f7866aaff5e inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16225f0094eeb234460f6cf963099c85 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a16225f0094eeb234460f6cf963099c85">ndof_types</a> () const</td></tr>
<tr class="memdesc:a16225f0094eeb234460f6cf963099c85 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return number of dof types in mesh.  <a href="../../d6/db8/classoomph_1_1Mesh.html#a16225f0094eeb234460f6cf963099c85">More...</a><br /></td></tr>
<tr class="separator:a16225f0094eeb234460f6cf963099c85 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a700a3c461df1c52534d7f6e303a0ebb6 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a700a3c461df1c52534d7f6e303a0ebb6">elemental_dimension</a> () const</td></tr>
<tr class="memdesc:a700a3c461df1c52534d7f6e303a0ebb6 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return number of elemental dimension in mesh.  <a href="../../d6/db8/classoomph_1_1Mesh.html#a700a3c461df1c52534d7f6e303a0ebb6">More...</a><br /></td></tr>
<tr class="separator:a700a3c461df1c52534d7f6e303a0ebb6 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32c8d3d454d3ba912b04985cb63e6a3c inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a32c8d3d454d3ba912b04985cb63e6a3c">nodal_dimension</a> () const</td></tr>
<tr class="memdesc:a32c8d3d454d3ba912b04985cb63e6a3c inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return number of nodal dimension in mesh.  <a href="../../d6/db8/classoomph_1_1Mesh.html#a32c8d3d454d3ba912b04985cb63e6a3c">More...</a><br /></td></tr>
<tr class="separator:a32c8d3d454d3ba912b04985cb63e6a3c inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac09a9bfeb6d70d8bbefe13c86948a6fc inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ac09a9bfeb6d70d8bbefe13c86948a6fc">add_node_pt</a> (<a class="el" href="../../dc/db7/classoomph_1_1Node.html">Node</a> *const &amp;<a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">node_pt</a>)</td></tr>
<tr class="memdesc:ac09a9bfeb6d70d8bbefe13c86948a6fc inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a (pointer to a) node to the mesh.  <a href="../../d6/db8/classoomph_1_1Mesh.html#ac09a9bfeb6d70d8bbefe13c86948a6fc">More...</a><br /></td></tr>
<tr class="separator:ac09a9bfeb6d70d8bbefe13c86948a6fc inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafc35b5df26c448b5d5ab26a793eee35 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#aafc35b5df26c448b5d5ab26a793eee35">add_element_pt</a> (<a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html">GeneralisedElement</a> *const &amp;<a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">element_pt</a>)</td></tr>
<tr class="memdesc:aafc35b5df26c448b5d5ab26a793eee35 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a (pointer to) an element to the mesh.  <a href="../../d6/db8/classoomph_1_1Mesh.html#aafc35b5df26c448b5d5ab26a793eee35">More...</a><br /></td></tr>
<tr class="separator:aafc35b5df26c448b5d5ab26a793eee35 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a801e77424d1bf8a35c9bba055230f1e3 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a801e77424d1bf8a35c9bba055230f1e3">reorder_nodes</a> (const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;use_old_ordering=true)</td></tr>
<tr class="separator:a801e77424d1bf8a35c9bba055230f1e3 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af191bd67272f0ca8ec389bdc233140fd inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af191bd67272f0ca8ec389bdc233140fd">get_node_reordering</a> (<a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../dc/db7/classoomph_1_1Node.html">Node</a> * &gt; &amp;reordering, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;use_old_ordering=true) const</td></tr>
<tr class="separator:af191bd67272f0ca8ec389bdc233140fd inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93e1758501aeea3328291571ce501029 inherit pub_methods_classoomph_1_1Mesh"><td class="memTemplParams" colspan="2">template&lt;class BULK_ELEMENT , template&lt; class &gt; class FACE_ELEMENT&gt; </td></tr>
<tr class="memitem:a93e1758501aeea3328291571ce501029 inherit pub_methods_classoomph_1_1Mesh"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a93e1758501aeea3328291571ce501029">build_face_mesh</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#a9d82f3af1459c1efc910b77f3ccd3180">b</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;face_mesh_pt)</td></tr>
<tr class="separator:a93e1758501aeea3328291571ce501029 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac713e5a9cbd8b21907d39df493d6bfc9 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ac713e5a9cbd8b21907d39df493d6bfc9">self_test</a> ()</td></tr>
<tr class="memdesc:ac713e5a9cbd8b21907d39df493d6bfc9 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Self-test: Check elements and nodes. Return 0 for OK.  <a href="../../d6/db8/classoomph_1_1Mesh.html#ac713e5a9cbd8b21907d39df493d6bfc9">More...</a><br /></td></tr>
<tr class="separator:ac713e5a9cbd8b21907d39df493d6bfc9 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20579c8d8f8b6e6ca2d2e897a67fda68 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a20579c8d8f8b6e6ca2d2e897a67fda68">max_and_min_element_size</a> (<a class="el" href="../../df/de6/classdouble.html">double</a> &amp;max_size, <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;min_size)</td></tr>
<tr class="separator:a20579c8d8f8b6e6ca2d2e897a67fda68 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa4aa3d2d41bd2a5a40ce4cffc9e2952 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#afa4aa3d2d41bd2a5a40ce4cffc9e2952">total_size</a> ()</td></tr>
<tr class="separator:afa4aa3d2d41bd2a5a40ce4cffc9e2952 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76adc3fcd3e49d3bd2e3b9d92c854430 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a76adc3fcd3e49d3bd2e3b9d92c854430">check_inverted_elements</a> (<a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;mesh_has_inverted_elements, std::ofstream &amp;inverted_element_file)</td></tr>
<tr class="separator:a76adc3fcd3e49d3bd2e3b9d92c854430 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c95ee63b466247e6c57c38fb59c577c inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a5c95ee63b466247e6c57c38fb59c577c">check_inverted_elements</a> (<a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;mesh_has_inverted_elements)</td></tr>
<tr class="separator:a5c95ee63b466247e6c57c38fb59c577c inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8229e193565c8de821170d482dfcee2 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#aa8229e193565c8de821170d482dfcee2">check_for_repeated_nodes</a> (const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;epsilon=1.0e-12)</td></tr>
<tr class="separator:aa8229e193565c8de821170d482dfcee2 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9f58929371a3f39dd646d2756547ad2 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../dc/db7/classoomph_1_1Node.html">Node</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ac9f58929371a3f39dd646d2756547ad2">prune_dead_nodes</a> ()</td></tr>
<tr class="separator:ac9f58929371a3f39dd646d2756547ad2 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84543564d6babe4faacbb9d87043fc19 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a84543564d6babe4faacbb9d87043fc19">nboundary</a> () const</td></tr>
<tr class="memdesc:a84543564d6babe4faacbb9d87043fc19 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return number of boundaries.  <a href="../../d6/db8/classoomph_1_1Mesh.html#a84543564d6babe4faacbb9d87043fc19">More...</a><br /></td></tr>
<tr class="separator:a84543564d6babe4faacbb9d87043fc19 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a034677ceb48c67769acb83f304c84f7d inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a034677ceb48c67769acb83f304c84f7d">nboundary_node</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;ibound) const</td></tr>
<tr class="memdesc:a034677ceb48c67769acb83f304c84f7d inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return number of nodes on a particular boundary.  <a href="../../d6/db8/classoomph_1_1Mesh.html#a034677ceb48c67769acb83f304c84f7d">More...</a><br /></td></tr>
<tr class="separator:a034677ceb48c67769acb83f304c84f7d inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a875271b6f162ddc5685a2511b35e75ec inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html">FiniteElement</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a875271b6f162ddc5685a2511b35e75ec">boundary_element_pt</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#a9d82f3af1459c1efc910b77f3ccd3180">b</a>, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../db/de3/Cwise__scalar__power__array_8cpp.html#abfa88ee95cd5e1c8d923f1b21740ece4">e</a>) const</td></tr>
<tr class="memdesc:a875271b6f162ddc5685a2511b35e75ec inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return pointer to e-th finite element on boundary b.  <a href="../../d6/db8/classoomph_1_1Mesh.html#a875271b6f162ddc5685a2511b35e75ec">More...</a><br /></td></tr>
<tr class="separator:a875271b6f162ddc5685a2511b35e75ec inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada7a88cfce20feae01e6841bf4375228 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/db7/classoomph_1_1Node.html">Node</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ada7a88cfce20feae01e6841bf4375228">get_some_non_boundary_node</a> () const</td></tr>
<tr class="separator:ada7a88cfce20feae01e6841bf4375228 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68e04b3b70cff70d53d75f66661555e8 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a68e04b3b70cff70d53d75f66661555e8">nboundary_element</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#a9d82f3af1459c1efc910b77f3ccd3180">b</a>) const</td></tr>
<tr class="memdesc:a68e04b3b70cff70d53d75f66661555e8 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return number of finite elements that are adjacent to boundary b.  <a href="../../d6/db8/classoomph_1_1Mesh.html#a68e04b3b70cff70d53d75f66661555e8">More...</a><br /></td></tr>
<tr class="separator:a68e04b3b70cff70d53d75f66661555e8 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6095e417593de6136d248ab08823f453 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a6095e417593de6136d248ab08823f453">face_index_at_boundary</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#a9d82f3af1459c1efc910b77f3ccd3180">b</a>, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../db/de3/Cwise__scalar__power__array_8cpp.html#abfa88ee95cd5e1c8d923f1b21740ece4">e</a>) const</td></tr>
<tr class="separator:a6095e417593de6136d248ab08823f453 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af821b936768868ea5dd91495e9ae3bc0 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af821b936768868ea5dd91495e9ae3bc0">dump</a> (std::ofstream &amp;dump_file, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;use_old_ordering=true) const</td></tr>
<tr class="memdesc:af821b936768868ea5dd91495e9ae3bc0 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dump the data in the mesh into a file for restart.  <a href="../../d6/db8/classoomph_1_1Mesh.html#af821b936768868ea5dd91495e9ae3bc0">More...</a><br /></td></tr>
<tr class="separator:af821b936768868ea5dd91495e9ae3bc0 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa8d0d8b55c1bb10982fe5449fd6389e inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#afa8d0d8b55c1bb10982fe5449fd6389e">dump</a> (const std::string &amp;dump_file_name, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;use_old_ordering=true) const</td></tr>
<tr class="memdesc:afa8d0d8b55c1bb10982fe5449fd6389e inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dump the data in the mesh into a file for restart.  <a href="../../d6/db8/classoomph_1_1Mesh.html#afa8d0d8b55c1bb10982fe5449fd6389e">More...</a><br /></td></tr>
<tr class="separator:afa8d0d8b55c1bb10982fe5449fd6389e inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af62d80c53dc07390d8f62ed180ab6d3a inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af62d80c53dc07390d8f62ed180ab6d3a">output_paraview</a> (std::ofstream &amp;file_out, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;nplot) const</td></tr>
<tr class="separator:af62d80c53dc07390d8f62ed180ab6d3a inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bba347dea4098f0bf7142db582adc38 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a8bba347dea4098f0bf7142db582adc38">output_fct_paraview</a> (std::ofstream &amp;file_out, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;nplot, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a690fd33af26cc3e84f39bba6d5a85202">FiniteElement::SteadyExactSolutionFctPt</a> exact_soln_pt) const</td></tr>
<tr class="separator:a8bba347dea4098f0bf7142db582adc38 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16157f769019724da979e47445e6c2d2 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a16157f769019724da979e47445e6c2d2">output_fct_paraview</a> (std::ofstream &amp;file_out, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;nplot, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;time, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#ad4ecf2b61b158a4b4d351a60d23c633e">FiniteElement::UnsteadyExactSolutionFctPt</a> exact_soln_pt) const</td></tr>
<tr class="separator:a16157f769019724da979e47445e6c2d2 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab74388e8e21325f3ca26f1bd99c26f7 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#aab74388e8e21325f3ca26f1bd99c26f7">output</a> (std::ostream &amp;outfile)</td></tr>
<tr class="memdesc:aab74388e8e21325f3ca26f1bd99c26f7 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output for all elements.  <a href="../../d6/db8/classoomph_1_1Mesh.html#aab74388e8e21325f3ca26f1bd99c26f7">More...</a><br /></td></tr>
<tr class="separator:aab74388e8e21325f3ca26f1bd99c26f7 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdd7ba97e7b862988955fd0c4766ba4d inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#acdd7ba97e7b862988955fd0c4766ba4d">output</a> (std::ostream &amp;outfile, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;n_plot)</td></tr>
<tr class="memdesc:acdd7ba97e7b862988955fd0c4766ba4d inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output at f(n_plot) points in each element.  <a href="../../d6/db8/classoomph_1_1Mesh.html#acdd7ba97e7b862988955fd0c4766ba4d">More...</a><br /></td></tr>
<tr class="separator:acdd7ba97e7b862988955fd0c4766ba4d inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d2a1aa08f3a7912c5e3f2d5f30e0110 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a8d2a1aa08f3a7912c5e3f2d5f30e0110">output</a> (FILE *file_pt)</td></tr>
<tr class="memdesc:a8d2a1aa08f3a7912c5e3f2d5f30e0110 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output for all elements (C-style output)  <a href="../../d6/db8/classoomph_1_1Mesh.html#a8d2a1aa08f3a7912c5e3f2d5f30e0110">More...</a><br /></td></tr>
<tr class="separator:a8d2a1aa08f3a7912c5e3f2d5f30e0110 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a926a1595fd8e9932e8c87a58a7ae23e1 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a926a1595fd8e9932e8c87a58a7ae23e1">output</a> (FILE *file_pt, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;nplot)</td></tr>
<tr class="memdesc:a926a1595fd8e9932e8c87a58a7ae23e1 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output at f(n_plot) points in each element (C-style output)  <a href="../../d6/db8/classoomph_1_1Mesh.html#a926a1595fd8e9932e8c87a58a7ae23e1">More...</a><br /></td></tr>
<tr class="separator:a926a1595fd8e9932e8c87a58a7ae23e1 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a411332db681ec982e88f60c40b3b648d inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a411332db681ec982e88f60c40b3b648d">output</a> (const std::string &amp;output_filename)</td></tr>
<tr class="memdesc:a411332db681ec982e88f60c40b3b648d inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output for all elements.  <a href="../../d6/db8/classoomph_1_1Mesh.html#a411332db681ec982e88f60c40b3b648d">More...</a><br /></td></tr>
<tr class="separator:a411332db681ec982e88f60c40b3b648d inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9f8eb8a56f81fe525a36157bd166ea0 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ac9f8eb8a56f81fe525a36157bd166ea0">output</a> (const std::string &amp;output_filename, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;n_plot)</td></tr>
<tr class="memdesc:ac9f8eb8a56f81fe525a36157bd166ea0 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output at f(n_plot) points in each element.  <a href="../../d6/db8/classoomph_1_1Mesh.html#ac9f8eb8a56f81fe525a36157bd166ea0">More...</a><br /></td></tr>
<tr class="separator:ac9f8eb8a56f81fe525a36157bd166ea0 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c5d6492f33fcd0dc7a65b7bc2a2dde2 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a7c5d6492f33fcd0dc7a65b7bc2a2dde2">output_fct</a> (std::ostream &amp;outfile, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;n_plot, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a690fd33af26cc3e84f39bba6d5a85202">FiniteElement::SteadyExactSolutionFctPt</a>)</td></tr>
<tr class="memdesc:a7c5d6492f33fcd0dc7a65b7bc2a2dde2 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output a given Vector function at f(n_plot) points in each element.  <a href="../../d6/db8/classoomph_1_1Mesh.html#a7c5d6492f33fcd0dc7a65b7bc2a2dde2">More...</a><br /></td></tr>
<tr class="separator:a7c5d6492f33fcd0dc7a65b7bc2a2dde2 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56d3007b3d8a11c8f5852bcfcc1d195d inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a56d3007b3d8a11c8f5852bcfcc1d195d">output_fct</a> (std::ostream &amp;outfile, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;n_plot, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;time, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#ad4ecf2b61b158a4b4d351a60d23c633e">FiniteElement::UnsteadyExactSolutionFctPt</a>)</td></tr>
<tr class="separator:a56d3007b3d8a11c8f5852bcfcc1d195d inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6effab50e32290d4d8066440b9b3e37 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af6effab50e32290d4d8066440b9b3e37">output_boundaries</a> (std::ostream &amp;outfile)</td></tr>
<tr class="memdesc:af6effab50e32290d4d8066440b9b3e37 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output the nodes on the boundaries (into separate tecplot zones)  <a href="../../d6/db8/classoomph_1_1Mesh.html#af6effab50e32290d4d8066440b9b3e37">More...</a><br /></td></tr>
<tr class="separator:af6effab50e32290d4d8066440b9b3e37 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82c291df31d4b6400004ede7c0973106 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a82c291df31d4b6400004ede7c0973106">output_boundaries</a> (const std::string &amp;output_filename)</td></tr>
<tr class="separator:a82c291df31d4b6400004ede7c0973106 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1ceceaadc7114773f5a70cb52e67081 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ab1ceceaadc7114773f5a70cb52e67081">assign_initial_values_impulsive</a> ()</td></tr>
<tr class="memdesc:ab1ceceaadc7114773f5a70cb52e67081 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assign initial values for an impulsive start.  <a href="../../d6/db8/classoomph_1_1Mesh.html#ab1ceceaadc7114773f5a70cb52e67081">More...</a><br /></td></tr>
<tr class="separator:ab1ceceaadc7114773f5a70cb52e67081 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f097aaa854ac697f8016ba3b7e6c982 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a7f097aaa854ac697f8016ba3b7e6c982">shift_time_values</a> ()</td></tr>
<tr class="separator:a7f097aaa854ac697f8016ba3b7e6c982 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a823b11b11e6a0c3c22ea86dc60a3da65 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a823b11b11e6a0c3c22ea86dc60a3da65">calculate_predictions</a> ()</td></tr>
<tr class="separator:a823b11b11e6a0c3c22ea86dc60a3da65 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c9a84e7e912c2fef3f513bfcd50fc70 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a6c9a84e7e912c2fef3f513bfcd50fc70">set_nodal_and_elemental_time_stepper</a> (<a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html">TimeStepper</a> *const &amp;time_stepper_pt, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;preserve_existing_data)</td></tr>
<tr class="separator:a6c9a84e7e912c2fef3f513bfcd50fc70 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8d6a5dcf3af2df66625079975d84c19 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ac8d6a5dcf3af2df66625079975d84c19">set_consistent_pinned_values_for_continuation</a> (<a class="el" href="../../d1/daa/classoomph_1_1ContinuationStorageScheme.html">ContinuationStorageScheme</a> *const &amp;continuation_stepper_pt)</td></tr>
<tr class="memdesc:ac8d6a5dcf3af2df66625079975d84c19 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set consistent values for pinned data in continuation.  <a href="../../d6/db8/classoomph_1_1Mesh.html#ac8d6a5dcf3af2df66625079975d84c19">More...</a><br /></td></tr>
<tr class="separator:ac8d6a5dcf3af2df66625079975d84c19 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13712b3fb8f01107772db51e01dbeee0 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a13712b3fb8f01107772db51e01dbeee0">does_pointer_correspond_to_mesh_data</a> (<a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;parameter_pt)</td></tr>
<tr class="memdesc:a13712b3fb8f01107772db51e01dbeee0 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Does the double pointer correspond to any mesh data.  <a href="../../d6/db8/classoomph_1_1Mesh.html#a13712b3fb8f01107772db51e01dbeee0">More...</a><br /></td></tr>
<tr class="separator:a13712b3fb8f01107772db51e01dbeee0 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac40c947d8ffe5b14aa6ac77fc398f3ec inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ac40c947d8ffe5b14aa6ac77fc398f3ec">set_nodal_time_stepper</a> (<a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html">TimeStepper</a> *const &amp;time_stepper_pt, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;preserve_existing_data)</td></tr>
<tr class="memdesc:ac40c947d8ffe5b14aa6ac77fc398f3ec inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the timestepper associated with the nodal data in the mesh.  <a href="../../d6/db8/classoomph_1_1Mesh.html#ac40c947d8ffe5b14aa6ac77fc398f3ec">More...</a><br /></td></tr>
<tr class="separator:ac40c947d8ffe5b14aa6ac77fc398f3ec inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a681b7531f2c90ea88c8a5ff4df7bce59 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a681b7531f2c90ea88c8a5ff4df7bce59">set_elemental_internal_time_stepper</a> (<a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html">TimeStepper</a> *const &amp;time_stepper_pt, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;preserve_existing_data)</td></tr>
<tr class="separator:a681b7531f2c90ea88c8a5ff4df7bce59 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36ceaaaa59093ae61393a3fd9090469e inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a36ceaaaa59093ae61393a3fd9090469e">compute_norm</a> (<a class="el" href="../../df/de6/classdouble.html">double</a> &amp;norm)</td></tr>
<tr class="separator:a36ceaaaa59093ae61393a3fd9090469e inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79ad604c845a2925fa661395987c79ed inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a79ad604c845a2925fa661395987c79ed">compute_norm</a> (<a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;norm)</td></tr>
<tr class="separator:a79ad604c845a2925fa661395987c79ed inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ccc8ea627c4aaeace90c78365b7ea30 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a7ccc8ea627c4aaeace90c78365b7ea30">compute_error</a> (std::ostream &amp;outfile, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#ad4ecf2b61b158a4b4d351a60d23c633e">FiniteElement::UnsteadyExactSolutionFctPt</a> exact_soln_pt, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;time, <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;error, <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;norm)</td></tr>
<tr class="separator:a7ccc8ea627c4aaeace90c78365b7ea30 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9488e849a82ef1fc4971013e3661a1ce inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a9488e849a82ef1fc4971013e3661a1ce">compute_error</a> (std::ostream &amp;outfile, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a690fd33af26cc3e84f39bba6d5a85202">FiniteElement::SteadyExactSolutionFctPt</a> exact_soln_pt, <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;error, <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;norm)</td></tr>
<tr class="separator:a9488e849a82ef1fc4971013e3661a1ce inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adea276fc0a96372cb5970e19dd2e4e09 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#adea276fc0a96372cb5970e19dd2e4e09">compute_error</a> (<a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a690fd33af26cc3e84f39bba6d5a85202">FiniteElement::SteadyExactSolutionFctPt</a> exact_soln_pt, <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;error, <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;norm)</td></tr>
<tr class="separator:adea276fc0a96372cb5970e19dd2e4e09 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca979a01748a6a53c31a0f3f44d37527 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#aca979a01748a6a53c31a0f3f44d37527">compute_error</a> (<a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a690fd33af26cc3e84f39bba6d5a85202">FiniteElement::SteadyExactSolutionFctPt</a> exact_soln_pt, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;error, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;norm)</td></tr>
<tr class="separator:aca979a01748a6a53c31a0f3f44d37527 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13e54320a2c859f9085a8ecd01cc72f0 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a13e54320a2c859f9085a8ecd01cc72f0">compute_error</a> (std::ostream &amp;outfile, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#ad4ecf2b61b158a4b4d351a60d23c633e">FiniteElement::UnsteadyExactSolutionFctPt</a> exact_soln_pt, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;time, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;error, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;norm)</td></tr>
<tr class="separator:a13e54320a2c859f9085a8ecd01cc72f0 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf01468aaed8c208faa4bdb474b9519e inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#aaf01468aaed8c208faa4bdb474b9519e">compute_error</a> (std::ostream &amp;outfile, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a690fd33af26cc3e84f39bba6d5a85202">FiniteElement::SteadyExactSolutionFctPt</a> exact_soln_pt, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;error, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;norm)</td></tr>
<tr class="separator:aaf01468aaed8c208faa4bdb474b9519e inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedf8ec7f1156031bf9d5a24d1c908b7c inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#aedf8ec7f1156031bf9d5a24d1c908b7c">compute_error</a> (<a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#ad4ecf2b61b158a4b4d351a60d23c633e">FiniteElement::UnsteadyExactSolutionFctPt</a> exact_soln_pt, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;time, <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;error, <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;norm)</td></tr>
<tr class="memdesc:aedf8ec7f1156031bf9d5a24d1c908b7c inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the norm of the error and that of the exact solution.  <a href="../../d6/db8/classoomph_1_1Mesh.html#aedf8ec7f1156031bf9d5a24d1c908b7c">More...</a><br /></td></tr>
<tr class="separator:aedf8ec7f1156031bf9d5a24d1c908b7c inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e84d922027f5860b272df48d2efe312 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a9e84d922027f5860b272df48d2efe312">compute_error</a> (<a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#ad4ecf2b61b158a4b4d351a60d23c633e">FiniteElement::UnsteadyExactSolutionFctPt</a> exact_soln_pt, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;time, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;error, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;norm)</td></tr>
<tr class="separator:a9e84d922027f5860b272df48d2efe312 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ab35b022b95f2d28c53aa58859bd6b5 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a1ab35b022b95f2d28c53aa58859bd6b5">is_mesh_distributed</a> () const</td></tr>
<tr class="memdesc:a1ab35b022b95f2d28c53aa58859bd6b5 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Boolean to indicate if Mesh has been distributed.  <a href="../../d6/db8/classoomph_1_1Mesh.html#a1ab35b022b95f2d28c53aa58859bd6b5">More...</a><br /></td></tr>
<tr class="separator:a1ab35b022b95f2d28c53aa58859bd6b5 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b2c1aba0f9cb4e1767c65f9a3162577 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html">OomphCommunicator</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a3b2c1aba0f9cb4e1767c65f9a3162577">communicator_pt</a> () const</td></tr>
<tr class="separator:a3b2c1aba0f9cb4e1767c65f9a3162577 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e3ecb07dc622cf37ce0085446ff9aa6 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a9e3ecb07dc622cf37ce0085446ff9aa6">delete_all_external_storage</a> ()</td></tr>
<tr class="memdesc:a9e3ecb07dc622cf37ce0085446ff9aa6 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wipe the storage for all externally-based elements.  <a href="../../d6/db8/classoomph_1_1Mesh.html#a9e3ecb07dc622cf37ce0085446ff9aa6">More...</a><br /></td></tr>
<tr class="separator:a9e3ecb07dc622cf37ce0085446ff9aa6 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classoomph_1_1SpineMesh"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classoomph_1_1SpineMesh')"><img src="../../closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="../../d6/d74/classoomph_1_1SpineMesh.html">oomph::SpineMesh</a></td></tr>
<tr class="memitem:ade44548bc0935505b9fa316d8365cb59 inherit pub_methods_classoomph_1_1SpineMesh"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d74/classoomph_1_1SpineMesh.html#ade44548bc0935505b9fa316d8365cb59">~SpineMesh</a> ()</td></tr>
<tr class="memdesc:ade44548bc0935505b9fa316d8365cb59 inherit pub_methods_classoomph_1_1SpineMesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor to clean up the memory allocated to the spines.  <a href="../../d6/d74/classoomph_1_1SpineMesh.html#ade44548bc0935505b9fa316d8365cb59">More...</a><br /></td></tr>
<tr class="separator:ade44548bc0935505b9fa316d8365cb59 inherit pub_methods_classoomph_1_1SpineMesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8a4afbc37ff7f4c19e44c28c1d7552a inherit pub_methods_classoomph_1_1SpineMesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d4c/classoomph_1_1Spine.html">Spine</a> *&amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d74/classoomph_1_1SpineMesh.html#aa8a4afbc37ff7f4c19e44c28c1d7552a">spine_pt</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>)</td></tr>
<tr class="memdesc:aa8a4afbc37ff7f4c19e44c28c1d7552a inherit pub_methods_classoomph_1_1SpineMesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the i-th spine in the mesh.  <a href="../../d6/d74/classoomph_1_1SpineMesh.html#aa8a4afbc37ff7f4c19e44c28c1d7552a">More...</a><br /></td></tr>
<tr class="separator:aa8a4afbc37ff7f4c19e44c28c1d7552a inherit pub_methods_classoomph_1_1SpineMesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13ad12ffbc4d5880aebdfbabc01755e1 inherit pub_methods_classoomph_1_1SpineMesh"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../dc/d4c/classoomph_1_1Spine.html">Spine</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d74/classoomph_1_1SpineMesh.html#a13ad12ffbc4d5880aebdfbabc01755e1">spine_pt</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>) const</td></tr>
<tr class="memdesc:a13ad12ffbc4d5880aebdfbabc01755e1 inherit pub_methods_classoomph_1_1SpineMesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the i-th spine in the mesh (const version)  <a href="../../d6/d74/classoomph_1_1SpineMesh.html#a13ad12ffbc4d5880aebdfbabc01755e1">More...</a><br /></td></tr>
<tr class="separator:a13ad12ffbc4d5880aebdfbabc01755e1 inherit pub_methods_classoomph_1_1SpineMesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8aa10bf71f0d0126e2cdb98a4a4ae264 inherit pub_methods_classoomph_1_1SpineMesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d74/classoomph_1_1SpineMesh.html#a8aa10bf71f0d0126e2cdb98a4a4ae264">nspine</a> () const</td></tr>
<tr class="memdesc:a8aa10bf71f0d0126e2cdb98a4a4ae264 inherit pub_methods_classoomph_1_1SpineMesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the number of spines in the mesh.  <a href="../../d6/d74/classoomph_1_1SpineMesh.html#a8aa10bf71f0d0126e2cdb98a4a4ae264">More...</a><br /></td></tr>
<tr class="separator:a8aa10bf71f0d0126e2cdb98a4a4ae264 inherit pub_methods_classoomph_1_1SpineMesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bd8248041f7ed8337d65ce763afa8ee inherit pub_methods_classoomph_1_1SpineMesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d74/classoomph_1_1SpineMesh.html#a4bd8248041f7ed8337d65ce763afa8ee">add_spine_pt</a> (<a class="el" href="../../dc/d4c/classoomph_1_1Spine.html">Spine</a> *const &amp;<a class="el" href="../../d6/d74/classoomph_1_1SpineMesh.html#aa8a4afbc37ff7f4c19e44c28c1d7552a">spine_pt</a>)</td></tr>
<tr class="memdesc:a4bd8248041f7ed8337d65ce763afa8ee inherit pub_methods_classoomph_1_1SpineMesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a spine to the mesh.  <a href="../../d6/d74/classoomph_1_1SpineMesh.html#a4bd8248041f7ed8337d65ce763afa8ee">More...</a><br /></td></tr>
<tr class="separator:a4bd8248041f7ed8337d65ce763afa8ee inherit pub_methods_classoomph_1_1SpineMesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55bfdb79c8cf307c1b36e4948e5dc298 inherit pub_methods_classoomph_1_1SpineMesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/d78/classoomph_1_1SpineNode.html">SpineNode</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d74/classoomph_1_1SpineMesh.html#a55bfdb79c8cf307c1b36e4948e5dc298">node_pt</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long &amp;<a class="el" href="../../d5/d24/level2__real__impl_8h.html#a1224f27e9a621d957f8124bcade25bed">n</a>)</td></tr>
<tr class="memdesc:a55bfdb79c8cf307c1b36e4948e5dc298 inherit pub_methods_classoomph_1_1SpineMesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return a pointer to the n-th global SpineNode.  <a href="../../d6/d74/classoomph_1_1SpineMesh.html#a55bfdb79c8cf307c1b36e4948e5dc298">More...</a><br /></td></tr>
<tr class="separator:a55bfdb79c8cf307c1b36e4948e5dc298 inherit pub_methods_classoomph_1_1SpineMesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea36e8d0454965f9f96a3adc4a5a9371 inherit pub_methods_classoomph_1_1SpineMesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/d78/classoomph_1_1SpineNode.html">SpineNode</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d74/classoomph_1_1SpineMesh.html#aea36e8d0454965f9f96a3adc4a5a9371">element_node_pt</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long &amp;<a class="el" href="../../db/de3/Cwise__scalar__power__array_8cpp.html#abfa88ee95cd5e1c8d923f1b21740ece4">e</a>, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d5/d24/level2__real__impl_8h.html#a1224f27e9a621d957f8124bcade25bed">n</a>)</td></tr>
<tr class="separator:aea36e8d0454965f9f96a3adc4a5a9371 inherit pub_methods_classoomph_1_1SpineMesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8cf3d6f17df714dfe0fadb95424d134c inherit pub_methods_classoomph_1_1SpineMesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d74/classoomph_1_1SpineMesh.html#a8cf3d6f17df714dfe0fadb95424d134c">assign_global_spine_eqn_numbers</a> (<a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> * &gt; &amp;Dof_pt)</td></tr>
<tr class="memdesc:a8cf3d6f17df714dfe0fadb95424d134c inherit pub_methods_classoomph_1_1SpineMesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assign spines to Spine_pt vector of element.  <a href="../../d6/d74/classoomph_1_1SpineMesh.html#a8cf3d6f17df714dfe0fadb95424d134c">More...</a><br /></td></tr>
<tr class="separator:a8cf3d6f17df714dfe0fadb95424d134c inherit pub_methods_classoomph_1_1SpineMesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a8bcf9a53e8da7a23dbb7aa7c837f1d inherit pub_methods_classoomph_1_1SpineMesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d74/classoomph_1_1SpineMesh.html#a7a8bcf9a53e8da7a23dbb7aa7c837f1d">describe_spine_dofs</a> (std::ostream &amp;<a class="el" href="../../d9/d83/tensor__contract__sycl__bench_8cc.html#acc4949c3e64b4395f74072403ddf6184">out</a>, const std::string &amp;current_string) const</td></tr>
<tr class="separator:a7a8bcf9a53e8da7a23dbb7aa7c837f1d inherit pub_methods_classoomph_1_1SpineMesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad858479b2509532604bc48a184ad55a9 inherit pub_methods_classoomph_1_1SpineMesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d74/classoomph_1_1SpineMesh.html#ad858479b2509532604bc48a184ad55a9">set_mesh_level_time_stepper</a> (<a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html">TimeStepper</a> *const &amp;time_stepper_pt, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;preserve_existing_data)</td></tr>
<tr class="separator:ad858479b2509532604bc48a184ad55a9 inherit pub_methods_classoomph_1_1SpineMesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace3ec6b369f26c18f18fb28da6351095 inherit pub_methods_classoomph_1_1SpineMesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d74/classoomph_1_1SpineMesh.html#ace3ec6b369f26c18f18fb28da6351095">set_spine_time_stepper</a> (<a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html">TimeStepper</a> *const &amp;time_stepper_pt, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;preserve_existing_data)</td></tr>
<tr class="memdesc:ace3ec6b369f26c18f18fb28da6351095 inherit pub_methods_classoomph_1_1SpineMesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assign time stepper to spines data.  <a href="../../d6/d74/classoomph_1_1SpineMesh.html#ace3ec6b369f26c18f18fb28da6351095">More...</a><br /></td></tr>
<tr class="separator:ace3ec6b369f26c18f18fb28da6351095 inherit pub_methods_classoomph_1_1SpineMesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af44e69b065d7f440057c9065754144ea inherit pub_methods_classoomph_1_1SpineMesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d74/classoomph_1_1SpineMesh.html#af44e69b065d7f440057c9065754144ea">set_consistent_pinned_spine_values_for_continuation</a> (<a class="el" href="../../d1/daa/classoomph_1_1ContinuationStorageScheme.html">ContinuationStorageScheme</a> *const &amp;continuation_stepper_pt)</td></tr>
<tr class="separator:af44e69b065d7f440057c9065754144ea inherit pub_methods_classoomph_1_1SpineMesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90424800c1edeb001bdaa7b6bd3fdeb2 inherit pub_methods_classoomph_1_1SpineMesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d74/classoomph_1_1SpineMesh.html#a90424800c1edeb001bdaa7b6bd3fdeb2">does_pointer_correspond_to_spine_data</a> (<a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;parameter_pt)</td></tr>
<tr class="separator:a90424800c1edeb001bdaa7b6bd3fdeb2 inherit pub_methods_classoomph_1_1SpineMesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0b99fe2126046566be6839f4d5b51c4 inherit pub_methods_classoomph_1_1SpineMesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d74/classoomph_1_1SpineMesh.html#ab0b99fe2126046566be6839f4d5b51c4">node_update</a> (const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;update_all_solid_nodes=false)</td></tr>
<tr class="separator:ab0b99fe2126046566be6839f4d5b51c4 inherit pub_methods_classoomph_1_1SpineMesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ec80358bd751e461ebe553c2977dc68 inherit pub_methods_classoomph_1_1SpineMesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d74/classoomph_1_1SpineMesh.html#a4ec80358bd751e461ebe553c2977dc68">dump</a> (std::ofstream &amp;dump_file) const</td></tr>
<tr class="memdesc:a4ec80358bd751e461ebe553c2977dc68 inherit pub_methods_classoomph_1_1SpineMesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Overload the dump function so that the spine data is dumped.  <a href="../../d6/d74/classoomph_1_1SpineMesh.html#a4ec80358bd751e461ebe553c2977dc68">More...</a><br /></td></tr>
<tr class="separator:a4ec80358bd751e461ebe553c2977dc68 inherit pub_methods_classoomph_1_1SpineMesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd06b02c8ee1f4bf60f6e8f082375c31 inherit pub_methods_classoomph_1_1SpineMesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d74/classoomph_1_1SpineMesh.html#acd06b02c8ee1f4bf60f6e8f082375c31">read</a> (std::ifstream &amp;restart_file)</td></tr>
<tr class="memdesc:acd06b02c8ee1f4bf60f6e8f082375c31 inherit pub_methods_classoomph_1_1SpineMesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Overload the read function so that the spine data is also read.  <a href="../../d6/d74/classoomph_1_1SpineMesh.html#acd06b02c8ee1f4bf60f6e8f082375c31">More...</a><br /></td></tr>
<tr class="separator:acd06b02c8ee1f4bf60f6e8f082375c31 inherit pub_methods_classoomph_1_1SpineMesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a0446cb0efaa31739f51ae0534a73d116"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a0446cb0efaa31739f51ae0534a73d116">spine_node_update_film_lower</a> (<a class="el" href="../../dd/d78/classoomph_1_1SpineNode.html">SpineNode</a> *spine_node_pt)</td></tr>
<tr class="separator:a0446cb0efaa31739f51ae0534a73d116"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0dc35290fc96a075d864e79528e5fec8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a0dc35290fc96a075d864e79528e5fec8">spine_node_update_horizontal_transition_lower</a> (<a class="el" href="../../dd/d78/classoomph_1_1SpineNode.html">SpineNode</a> *spine_node_pt)</td></tr>
<tr class="separator:a0dc35290fc96a075d864e79528e5fec8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ec578183760e386ed5229ba193e1fdf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a9ec578183760e386ed5229ba193e1fdf">spine_node_update_vertical_transition_lower</a> (<a class="el" href="../../dd/d78/classoomph_1_1SpineNode.html">SpineNode</a> *spine_node_pt)</td></tr>
<tr class="separator:a9ec578183760e386ed5229ba193e1fdf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ddc62166abfd621219551957c9b1103"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a6ddc62166abfd621219551957c9b1103">spine_node_update_vertical_transition_upper</a> (<a class="el" href="../../dd/d78/classoomph_1_1SpineNode.html">SpineNode</a> *spine_node_pt)</td></tr>
<tr class="separator:a6ddc62166abfd621219551957c9b1103"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9fa4941d8fb02a388e933a7dd1c76a2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#aa9fa4941d8fb02a388e933a7dd1c76a2">spine_node_update_horizontal_transition_upper</a> (<a class="el" href="../../dd/d78/classoomph_1_1SpineNode.html">SpineNode</a> *spine_node_pt)</td></tr>
<tr class="separator:aa9fa4941d8fb02a388e933a7dd1c76a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3919bd086252db283ee5242b4688f8d1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a3919bd086252db283ee5242b4688f8d1">spine_node_update_film_upper</a> (<a class="el" href="../../dd/d78/classoomph_1_1SpineNode.html">SpineNode</a> *spine_node_pt)</td></tr>
<tr class="separator:a3919bd086252db283ee5242b4688f8d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a09b6d2f5e7ffd12a0ae882754ad818"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a5a09b6d2f5e7ffd12a0ae882754ad818">spine_node_update_channel</a> (<a class="el" href="../../dd/d78/classoomph_1_1SpineNode.html">SpineNode</a> *spine_node_pt)</td></tr>
<tr class="separator:a5a09b6d2f5e7ffd12a0ae882754ad818"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52ffe1a705cb720d09c831b9cf5397f6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a52ffe1a705cb720d09c831b9cf5397f6">initial_element_reorder</a> ()</td></tr>
<tr class="separator:a52ffe1a705cb720d09c831b9cf5397f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_classoomph_1_1SingleLayerSpineMesh"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classoomph_1_1SingleLayerSpineMesh')"><img src="../../closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="../../df/da5/classoomph_1_1SingleLayerSpineMesh.html">oomph::SingleLayerSpineMesh&lt; ELEMENT &gt;</a></td></tr>
<tr class="memitem:a6829fa8216137c0e2f5eb40b389dda35 inherit pro_methods_classoomph_1_1SingleLayerSpineMesh"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/da5/classoomph_1_1SingleLayerSpineMesh.html#a6829fa8216137c0e2f5eb40b389dda35">build_single_layer_mesh</a> (<a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html">TimeStepper</a> *time_stepper_pt)</td></tr>
<tr class="separator:a6829fa8216137c0e2f5eb40b389dda35 inherit pro_methods_classoomph_1_1SingleLayerSpineMesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_classoomph_1_1RectangularQuadMesh"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classoomph_1_1RectangularQuadMesh')"><img src="../../closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="../../da/db8/classoomph_1_1RectangularQuadMesh.html">oomph::RectangularQuadMesh&lt; ELEMENT &gt;</a></td></tr>
<tr class="memitem:afa579b413a2d8120e8228d840cb3582c inherit pro_methods_classoomph_1_1RectangularQuadMesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#afa579b413a2d8120e8228d840cb3582c">build_mesh</a> (<a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html">TimeStepper</a> *time_stepper_pt=&amp;<a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a12243d0fee2b1fcee729ee5a4777ea10">Mesh::Default_TimeStepper</a>)</td></tr>
<tr class="memdesc:afa579b413a2d8120e8228d840cb3582c inherit pro_methods_classoomph_1_1RectangularQuadMesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic mesh construction function: contains all the hard work.  <a href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#afa579b413a2d8120e8228d840cb3582c">More...</a><br /></td></tr>
<tr class="separator:afa579b413a2d8120e8228d840cb3582c inherit pro_methods_classoomph_1_1RectangularQuadMesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeda49fb3896e9e3aec328391b196a6bf inherit pro_methods_classoomph_1_1RectangularQuadMesh"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#aeda49fb3896e9e3aec328391b196a6bf">RectangularQuadMesh</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#abfef93d6322886cdce14a437186e4821">nx</a>, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#a86d76a55eb7c4e8bca9b74d23c8b0412">ny</a>, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;xmin, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;xmax, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;ymin, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;ymax, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;periodic_in_x, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;build, <a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html">TimeStepper</a> *time_stepper_pt=&amp;<a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a12243d0fee2b1fcee729ee5a4777ea10">Mesh::Default_TimeStepper</a>)</td></tr>
<tr class="separator:aeda49fb3896e9e3aec328391b196a6bf inherit pro_methods_classoomph_1_1RectangularQuadMesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_classoomph_1_1Mesh"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classoomph_1_1Mesh')"><img src="../../closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">oomph::Mesh</a></td></tr>
<tr class="memitem:addf84f5fbe29d45259c36acf5f01d330 inherit pro_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#addf84f5fbe29d45259c36acf5f01d330">assign_global_eqn_numbers</a> (<a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> * &gt; &amp;Dof_pt)</td></tr>
<tr class="memdesc:addf84f5fbe29d45259c36acf5f01d330 inherit pro_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assign (global) equation numbers to the nodes.  <a href="../../d6/db8/classoomph_1_1Mesh.html#addf84f5fbe29d45259c36acf5f01d330">More...</a><br /></td></tr>
<tr class="separator:addf84f5fbe29d45259c36acf5f01d330 inherit pro_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86d000c45f6d29fa215b98051cc2d23f inherit pro_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a86d000c45f6d29fa215b98051cc2d23f">describe_dofs</a> (std::ostream &amp;<a class="el" href="../../d9/d83/tensor__contract__sycl__bench_8cc.html#acc4949c3e64b4395f74072403ddf6184">out</a>, const std::string &amp;current_string) const</td></tr>
<tr class="separator:a86d000c45f6d29fa215b98051cc2d23f inherit pro_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57d57b7b6d7a32fadafb03e7055c5ad4 inherit pro_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a57d57b7b6d7a32fadafb03e7055c5ad4">describe_local_dofs</a> (std::ostream &amp;<a class="el" href="../../d9/d83/tensor__contract__sycl__bench_8cc.html#acc4949c3e64b4395f74072403ddf6184">out</a>, const std::string &amp;current_string) const</td></tr>
<tr class="separator:a57d57b7b6d7a32fadafb03e7055c5ad4 inherit pro_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab73d03d38e9b94b15f21b2c12f5dc3bc inherit pro_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ab73d03d38e9b94b15f21b2c12f5dc3bc">assign_local_eqn_numbers</a> (const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;store_local_dof_pt)</td></tr>
<tr class="memdesc:ab73d03d38e9b94b15f21b2c12f5dc3bc inherit pro_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assign local equation numbers in all elements.  <a href="../../d6/db8/classoomph_1_1Mesh.html#ab73d03d38e9b94b15f21b2c12f5dc3bc">More...</a><br /></td></tr>
<tr class="separator:ab73d03d38e9b94b15f21b2c12f5dc3bc inherit pro_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa864cbb7f3ff399eef871c63067894df inherit pro_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#aa864cbb7f3ff399eef871c63067894df">convert_to_boundary_node</a> (<a class="el" href="../../dc/db7/classoomph_1_1Node.html">Node</a> *&amp;<a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">node_pt</a>, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html">FiniteElement</a> * &gt; &amp;<a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a4f274774435e9454bf77bf70de69367a">finite_element_pt</a>)</td></tr>
<tr class="separator:aa864cbb7f3ff399eef871c63067894df inherit pro_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2bdff104c0cc1f2669f9f5cad4a2a1a9 inherit pro_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a2bdff104c0cc1f2669f9f5cad4a2a1a9">convert_to_boundary_node</a> (<a class="el" href="../../dc/db7/classoomph_1_1Node.html">Node</a> *&amp;<a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">node_pt</a>)</td></tr>
<tr class="separator:a2bdff104c0cc1f2669f9f5cad4a2a1a9 inherit pro_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:af6ef10fb80559c3ad27a50116da60dcc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#af6ef10fb80559c3ad27a50116da60dcc">Nx1</a></td></tr>
<tr class="memdesc:af6ef10fb80559c3ad27a50116da60dcc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of elements along wall in deposited film region.  <a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#af6ef10fb80559c3ad27a50116da60dcc">More...</a><br /></td></tr>
<tr class="separator:af6ef10fb80559c3ad27a50116da60dcc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a237b4f516eb3f74e42e190f2a23f93c3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a237b4f516eb3f74e42e190f2a23f93c3">Nx2</a></td></tr>
<tr class="memdesc:a237b4f516eb3f74e42e190f2a23f93c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of elements along wall in horizontal transition region.  <a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a237b4f516eb3f74e42e190f2a23f93c3">More...</a><br /></td></tr>
<tr class="separator:a237b4f516eb3f74e42e190f2a23f93c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26c57f832b7cdc495087cef7b54c98fd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a26c57f832b7cdc495087cef7b54c98fd">Nx3</a></td></tr>
<tr class="memdesc:a26c57f832b7cdc495087cef7b54c98fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of elements along wall in channel region.  <a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a26c57f832b7cdc495087cef7b54c98fd">More...</a><br /></td></tr>
<tr class="separator:a26c57f832b7cdc495087cef7b54c98fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e58d18dd2231c785008efa07260e8da"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a1e58d18dd2231c785008efa07260e8da">Nhalf</a></td></tr>
<tr class="separator:a1e58d18dd2231c785008efa07260e8da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ba20dfa61b6c342f2defbc0cdb47851"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a4ba20dfa61b6c342f2defbc0cdb47851">Nh</a></td></tr>
<tr class="memdesc:a4ba20dfa61b6c342f2defbc0cdb47851"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of elements across the deposited film.  <a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a4ba20dfa61b6c342f2defbc0cdb47851">More...</a><br /></td></tr>
<tr class="separator:a4ba20dfa61b6c342f2defbc0cdb47851"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d711e1bc9d751ab14662f6839a900e3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a3d711e1bc9d751ab14662f6839a900e3">H</a></td></tr>
<tr class="memdesc:a3d711e1bc9d751ab14662f6839a900e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Thickness of deposited film.  <a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a3d711e1bc9d751ab14662f6839a900e3">More...</a><br /></td></tr>
<tr class="separator:a3d711e1bc9d751ab14662f6839a900e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f97e78a12000afcc1bd754102b5b51a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/ddd/classoomph_1_1GeomObject.html">GeomObject</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a1f97e78a12000afcc1bd754102b5b51a">Upper_wall_pt</a></td></tr>
<tr class="memdesc:a1f97e78a12000afcc1bd754102b5b51a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to geometric object that represents the upper wall.  <a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a1f97e78a12000afcc1bd754102b5b51a">More...</a><br /></td></tr>
<tr class="separator:a1f97e78a12000afcc1bd754102b5b51a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04c0136de66c06a34347b89f453730e1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/ddd/classoomph_1_1GeomObject.html">GeomObject</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a04c0136de66c06a34347b89f453730e1">Lower_wall_pt</a></td></tr>
<tr class="memdesc:a04c0136de66c06a34347b89f453730e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to geometric object that represents the lower wall.  <a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a04c0136de66c06a34347b89f453730e1">More...</a><br /></td></tr>
<tr class="separator:a04c0136de66c06a34347b89f453730e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f41083aa9a97fca03d498bd6ec21eb2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a0f41083aa9a97fca03d498bd6ec21eb2">Zeta_start</a></td></tr>
<tr class="memdesc:a0f41083aa9a97fca03d498bd6ec21eb2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start coordinate on wall.  <a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a0f41083aa9a97fca03d498bd6ec21eb2">More...</a><br /></td></tr>
<tr class="separator:a0f41083aa9a97fca03d498bd6ec21eb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1b5e005bfb5db65f54ca599942126ea"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#ac1b5e005bfb5db65f54ca599942126ea">Zeta_end</a></td></tr>
<tr class="memdesc:ac1b5e005bfb5db65f54ca599942126ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wall coordinate of end of liquid filled region (inflow)  <a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#ac1b5e005bfb5db65f54ca599942126ea">More...</a><br /></td></tr>
<tr class="separator:ac1b5e005bfb5db65f54ca599942126ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af701937d59d7804f40cb1b4c7a262391"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#af701937d59d7804f40cb1b4c7a262391">Zeta_transition_start</a></td></tr>
<tr class="memdesc:af701937d59d7804f40cb1b4c7a262391"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wall coordinate of start of the transition region.  <a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#af701937d59d7804f40cb1b4c7a262391">More...</a><br /></td></tr>
<tr class="separator:af701937d59d7804f40cb1b4c7a262391"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d05bb741eba54ab7498ab4f3c55f1b7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a1d05bb741eba54ab7498ab4f3c55f1b7">Zeta_transition_end</a></td></tr>
<tr class="memdesc:a1d05bb741eba54ab7498ab4f3c55f1b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wall coordinate of end of transition region.  <a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a1d05bb741eba54ab7498ab4f3c55f1b7">More...</a><br /></td></tr>
<tr class="separator:a1d05bb741eba54ab7498ab4f3c55f1b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5e7951a89bc13d73f2b137947cda8a3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#af5e7951a89bc13d73f2b137947cda8a3">Spine_centre_fraction_pt</a></td></tr>
<tr class="memdesc:af5e7951a89bc13d73f2b137947cda8a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to vertical fraction of the spine centre.  <a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#af5e7951a89bc13d73f2b137947cda8a3">More...</a><br /></td></tr>
<tr class="separator:af5e7951a89bc13d73f2b137947cda8a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a306cf8ae8f91a81054904de64195bb16"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a306cf8ae8f91a81054904de64195bb16">Default_spine_centre_fraction</a></td></tr>
<tr class="memdesc:a306cf8ae8f91a81054904de64195bb16"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default spine fraction.  <a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a306cf8ae8f91a81054904de64195bb16">More...</a><br /></td></tr>
<tr class="separator:a306cf8ae8f91a81054904de64195bb16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81ee86c0c747947dab52073c221d53c1"><td class="memItemLeft" align="right" valign="top">ELEMENT *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a81ee86c0c747947dab52073c221d53c1">Control_element_pt</a></td></tr>
<tr class="separator:a81ee86c0c747947dab52073c221d53c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a207b6a5e52ce95c0a6125f56eb22b98d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html">FiniteElement</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a207b6a5e52ce95c0a6125f56eb22b98d">Bulk_element_pt</a></td></tr>
<tr class="memdesc:a207b6a5e52ce95c0a6125f56eb22b98d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector of pointers to element in the fluid layer.  <a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a207b6a5e52ce95c0a6125f56eb22b98d">More...</a><br /></td></tr>
<tr class="separator:a207b6a5e52ce95c0a6125f56eb22b98d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7422b912ff7ad780777205f0cbe83362"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html">FiniteElement</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a7422b912ff7ad780777205f0cbe83362">Interface_element_pt</a></td></tr>
<tr class="memdesc:a7422b912ff7ad780777205f0cbe83362"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector of pointers to interface elements.  <a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a7422b912ff7ad780777205f0cbe83362">More...</a><br /></td></tr>
<tr class="separator:a7422b912ff7ad780777205f0cbe83362"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classoomph_1_1RectangularQuadMesh"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classoomph_1_1RectangularQuadMesh')"><img src="../../closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="../../da/db8/classoomph_1_1RectangularQuadMesh.html">oomph::RectangularQuadMesh&lt; ELEMENT &gt;</a></td></tr>
<tr class="memitem:a1b2c0a2d1f8399713033953c72d399ee inherit pro_attribs_classoomph_1_1RectangularQuadMesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#a1b2c0a2d1f8399713033953c72d399ee">Nx</a></td></tr>
<tr class="memdesc:a1b2c0a2d1f8399713033953c72d399ee inherit pro_attribs_classoomph_1_1RectangularQuadMesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Nx: number of elements in x-direction.  <a href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#a1b2c0a2d1f8399713033953c72d399ee">More...</a><br /></td></tr>
<tr class="separator:a1b2c0a2d1f8399713033953c72d399ee inherit pro_attribs_classoomph_1_1RectangularQuadMesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49a5ee7ef86ce837fb807eb6014a296d inherit pro_attribs_classoomph_1_1RectangularQuadMesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#a49a5ee7ef86ce837fb807eb6014a296d">Ny</a></td></tr>
<tr class="memdesc:a49a5ee7ef86ce837fb807eb6014a296d inherit pro_attribs_classoomph_1_1RectangularQuadMesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Ny: number of elements in y-direction.  <a href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#a49a5ee7ef86ce837fb807eb6014a296d">More...</a><br /></td></tr>
<tr class="separator:a49a5ee7ef86ce837fb807eb6014a296d inherit pro_attribs_classoomph_1_1RectangularQuadMesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92502c7536a6644ebffd806841cd4d98 inherit pro_attribs_classoomph_1_1RectangularQuadMesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#a92502c7536a6644ebffd806841cd4d98">Np</a></td></tr>
<tr class="memdesc:a92502c7536a6644ebffd806841cd4d98 inherit pro_attribs_classoomph_1_1RectangularQuadMesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Np: number of (linear) points in the element.  <a href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#a92502c7536a6644ebffd806841cd4d98">More...</a><br /></td></tr>
<tr class="separator:a92502c7536a6644ebffd806841cd4d98 inherit pro_attribs_classoomph_1_1RectangularQuadMesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3aab508d077460545031e758396514a inherit pro_attribs_classoomph_1_1RectangularQuadMesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#af3aab508d077460545031e758396514a">Xmin</a></td></tr>
<tr class="memdesc:af3aab508d077460545031e758396514a inherit pro_attribs_classoomph_1_1RectangularQuadMesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Minimum value of x coordinate.  <a href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#af3aab508d077460545031e758396514a">More...</a><br /></td></tr>
<tr class="separator:af3aab508d077460545031e758396514a inherit pro_attribs_classoomph_1_1RectangularQuadMesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8e4ddba0ce8315cf480cdd1f3447684 inherit pro_attribs_classoomph_1_1RectangularQuadMesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#ab8e4ddba0ce8315cf480cdd1f3447684">Xmax</a></td></tr>
<tr class="memdesc:ab8e4ddba0ce8315cf480cdd1f3447684 inherit pro_attribs_classoomph_1_1RectangularQuadMesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum value of x coordinate.  <a href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#ab8e4ddba0ce8315cf480cdd1f3447684">More...</a><br /></td></tr>
<tr class="separator:ab8e4ddba0ce8315cf480cdd1f3447684 inherit pro_attribs_classoomph_1_1RectangularQuadMesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade53fec7446044418ccba9f55d692adb inherit pro_attribs_classoomph_1_1RectangularQuadMesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#ade53fec7446044418ccba9f55d692adb">Ymin</a></td></tr>
<tr class="memdesc:ade53fec7446044418ccba9f55d692adb inherit pro_attribs_classoomph_1_1RectangularQuadMesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Minimum value of y coordinate.  <a href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#ade53fec7446044418ccba9f55d692adb">More...</a><br /></td></tr>
<tr class="separator:ade53fec7446044418ccba9f55d692adb inherit pro_attribs_classoomph_1_1RectangularQuadMesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacbacc3a0e6ea8508abb3140ba343ffa inherit pro_attribs_classoomph_1_1RectangularQuadMesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#aacbacc3a0e6ea8508abb3140ba343ffa">Ymax</a></td></tr>
<tr class="memdesc:aacbacc3a0e6ea8508abb3140ba343ffa inherit pro_attribs_classoomph_1_1RectangularQuadMesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum value of y coordinate.  <a href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#aacbacc3a0e6ea8508abb3140ba343ffa">More...</a><br /></td></tr>
<tr class="separator:aacbacc3a0e6ea8508abb3140ba343ffa inherit pro_attribs_classoomph_1_1RectangularQuadMesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83dd0ace2eb47449f5e30522f71d9f59 inherit pro_attribs_classoomph_1_1RectangularQuadMesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#a83dd0ace2eb47449f5e30522f71d9f59">Xperiodic</a></td></tr>
<tr class="separator:a83dd0ace2eb47449f5e30522f71d9f59 inherit pro_attribs_classoomph_1_1RectangularQuadMesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classoomph_1_1Mesh"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classoomph_1_1Mesh')"><img src="../../closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">oomph::Mesh</a></td></tr>
<tr class="memitem:abbba08d3de5cccd78ee98afc7b2f61fc inherit pro_attribs_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../dc/db7/classoomph_1_1Node.html">Node</a> * &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#abbba08d3de5cccd78ee98afc7b2f61fc">Boundary_node_pt</a></td></tr>
<tr class="separator:abbba08d3de5cccd78ee98afc7b2f61fc inherit pro_attribs_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37f6d27447f643a74694012b09350ce9 inherit pro_attribs_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a37f6d27447f643a74694012b09350ce9">Lookup_for_elements_next_boundary_is_setup</a></td></tr>
<tr class="separator:a37f6d27447f643a74694012b09350ce9 inherit pro_attribs_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a266ac14a3e884f978c8605f7b5786e81 inherit pro_attribs_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html">FiniteElement</a> * &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a266ac14a3e884f978c8605f7b5786e81">Boundary_element_pt</a></td></tr>
<tr class="separator:a266ac14a3e884f978c8605f7b5786e81 inherit pro_attribs_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62adbe45fe65ff9cd329bb45d197347c inherit pro_attribs_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a62adbe45fe65ff9cd329bb45d197347c">Face_index_at_boundary</a></td></tr>
<tr class="separator:a62adbe45fe65ff9cd329bb45d197347c inherit pro_attribs_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a42111e7eb200e5831f8b73c018b7dc inherit pro_attribs_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../dc/db7/classoomph_1_1Node.html">Node</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a0a42111e7eb200e5831f8b73c018b7dc">Node_pt</a></td></tr>
<tr class="memdesc:a0a42111e7eb200e5831f8b73c018b7dc inherit pro_attribs_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector of pointers to nodes.  <a href="../../d6/db8/classoomph_1_1Mesh.html#a0a42111e7eb200e5831f8b73c018b7dc">More...</a><br /></td></tr>
<tr class="separator:a0a42111e7eb200e5831f8b73c018b7dc inherit pro_attribs_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca12acfe655a4d5c4a4eab4a7b970812 inherit pro_attribs_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html">GeneralisedElement</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#aca12acfe655a4d5c4a4eab4a7b970812">Element_pt</a></td></tr>
<tr class="memdesc:aca12acfe655a4d5c4a4eab4a7b970812 inherit pro_attribs_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector of pointers to generalised elements.  <a href="../../d6/db8/classoomph_1_1Mesh.html#aca12acfe655a4d5c4a4eab4a7b970812">More...</a><br /></td></tr>
<tr class="separator:aca12acfe655a4d5c4a4eab4a7b970812 inherit pro_attribs_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a412a5051be9e81f0ba61bf85e5abc4a6 inherit pro_attribs_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="../../d9/db9/classbool.html">bool</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a412a5051be9e81f0ba61bf85e5abc4a6">Boundary_coordinate_exists</a></td></tr>
<tr class="separator:a412a5051be9e81f0ba61bf85e5abc4a6 inherit pro_attribs_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classoomph_1_1SpineMesh"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classoomph_1_1SpineMesh')"><img src="../../closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="../../d6/d74/classoomph_1_1SpineMesh.html">oomph::SpineMesh</a></td></tr>
<tr class="memitem:a4f3e5e603b61921f52a4311d347d1158 inherit pro_attribs_classoomph_1_1SpineMesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../dc/d4c/classoomph_1_1Spine.html">Spine</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d74/classoomph_1_1SpineMesh.html#a4f3e5e603b61921f52a4311d347d1158">Spine_pt</a></td></tr>
<tr class="memdesc:a4f3e5e603b61921f52a4311d347d1158 inherit pro_attribs_classoomph_1_1SpineMesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">A Spine mesh contains a Vector of pointers to spines.  <a href="../../d6/d74/classoomph_1_1SpineMesh.html#a4f3e5e603b61921f52a4311d347d1158">More...</a><br /></td></tr>
<tr class="separator:a4f3e5e603b61921f52a4311d347d1158 inherit pro_attribs_classoomph_1_1SpineMesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pub_types_classoomph_1_1Mesh"><td colspan="2" onclick="javascript:toggleInherit('pub_types_classoomph_1_1Mesh')"><img src="../../closed.png" alt="-"/>&#160;Public Types inherited from <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">oomph::Mesh</a></td></tr>
<tr class="memitem:a059e155da2b47cc94c3306398bd2be07 inherit pub_types_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">typedef void(FiniteElement::*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a059e155da2b47cc94c3306398bd2be07">SteadyExactSolutionFctPt</a>) (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a61b7da262276970831d88a2f37dbe509">x</a>, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;soln)</td></tr>
<tr class="separator:a059e155da2b47cc94c3306398bd2be07 inherit pub_types_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fccd0b52d2384b0d4f423118284882d inherit pub_types_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">typedef void(FiniteElement::*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a4fccd0b52d2384b0d4f423118284882d">UnsteadyExactSolutionFctPt</a>) (const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;time, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a61b7da262276970831d88a2f37dbe509">x</a>, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;soln)</td></tr>
<tr class="separator:a4fccd0b52d2384b0d4f423118284882d inherit pub_types_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_static_attribs_classoomph_1_1Mesh"><td colspan="2" onclick="javascript:toggleInherit('pub_static_attribs_classoomph_1_1Mesh')"><img src="../../closed.png" alt="-"/>&#160;Static Public Attributes inherited from <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">oomph::Mesh</a></td></tr>
<tr class="memitem:a12243d0fee2b1fcee729ee5a4777ea10 inherit pub_static_attribs_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d5/d11/classoomph_1_1Steady.html">Steady</a>&lt; 0 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a12243d0fee2b1fcee729ee5a4777ea10">Default_TimeStepper</a></td></tr>
<tr class="memdesc:a12243d0fee2b1fcee729ee5a4777ea10 inherit pub_static_attribs_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">The Steady Timestepper.  <a href="../../d6/db8/classoomph_1_1Mesh.html#a12243d0fee2b1fcee729ee5a4777ea10">More...</a><br /></td></tr>
<tr class="separator:a12243d0fee2b1fcee729ee5a4777ea10 inherit pub_static_attribs_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada6bc12304d1536b747596d1049e48be inherit pub_static_attribs_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ada6bc12304d1536b747596d1049e48be">Suppress_warning_about_empty_mesh_level_time_stepper_function</a></td></tr>
<tr class="memdesc:ada6bc12304d1536b747596d1049e48be inherit pub_static_attribs_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Static boolean flag to control warning about mesh level timesteppers.  <a href="../../d6/db8/classoomph_1_1Mesh.html#ada6bc12304d1536b747596d1049e48be">More...</a><br /></td></tr>
<tr class="separator:ada6bc12304d1536b747596d1049e48be inherit pub_static_attribs_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;class ELEMENT, class INTERFACE_ELEMENT&gt;<br />
class oomph::BrethertonSpineMesh&lt; ELEMENT, INTERFACE_ELEMENT &gt;</h3>

<p>Mesh for 2D Bretherton problem &ndash; based on single layer mesh. Templated by spine-ified Navier-Stokes element type (e.g. SpineElement&lt;QCrouzeixRaviartElement&lt;2&gt; &gt; and the corresponding interface element (e.g. SpineLineFluidInterfaceElement&lt;SpineElement&lt;QCrouzeixRaviartElement&lt;2&gt; &gt; &gt; </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a0e9c404141ee65b000ab4d1fdc4f11da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e9c404141ee65b000ab4d1fdc4f11da">&#9670;&nbsp;</a></span>BrethertonSpineMesh()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT , class INTERFACE_ELEMENT &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html">oomph::BrethertonSpineMesh</a>&lt; ELEMENT, INTERFACE_ELEMENT &gt;::<a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html">BrethertonSpineMesh</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>nx1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>nx2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>nx3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>nh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>nhalf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/ddd/classoomph_1_1GeomObject.html">GeomObject</a> *&#160;</td>
          <td class="paramname"><em>lower_wall_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/ddd/classoomph_1_1GeomObject.html">GeomObject</a> *&#160;</td>
          <td class="paramname"><em>upper_wall_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>zeta_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>zeta_transition_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>zeta_transition_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>zeta_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html">TimeStepper</a> *&#160;</td>
          <td class="paramname"><em>time_stepper_pt</em> = <code>&amp;<a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a12243d0fee2b1fcee729ee5a4777ea10">Mesh::Default_TimeStepper</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Constructor. Arguments:</p><ul>
<li>nx1: Number of elements along wall in deposited film region</li>
<li>nx2: Number of elements along wall in horizontal transition region</li>
<li>nx3: Number of elements along wall in channel region</li>
<li>nhalf: Number of elements in vertical transition region (there are twice as many elements across the channel)</li>
<li>nh: Number of elements across the deposited film</li>
<li>h: Thickness of deposited film</li>
<li>zeta0: Start coordinate on wall</li>
<li>zeta1: Wall coordinate of start of transition region</li>
<li>zeta2: Wall coordinate of end of liquid filled region (inflow)</li>
<li>lower_wall_pt: Pointer to geometric object that represents the lower wall</li>
<li>upper_wall_pt: Pointer to geometric object that represents the upper wall</li>
<li>time_stepper_pt: Pointer to timestepper; defaults to Steady</li>
</ul>
<p>Constructor. Arguments:</p><ul>
<li>nx1: Number of elements along wall in deposited film region</li>
<li>nx2: Number of elements along wall in horizontal transition region</li>
<li>nx3: Number of elements along wall in channel region</li>
<li>nhalf: Number of elements in vertical transition region (there are twice as many elements across the channel)</li>
<li>nh: Number of elements across the deposited film</li>
<li>h: Thickness of deposited film</li>
<li>zeta0: Start coordinate on wall</li>
<li>zeta1: Wall coordinate of start of transition region</li>
<li>zeta2: Wall coordinate of end of liquid filled region (inflow)</li>
<li>lower_wall_pt: Pointer to geometric object that represents the lower wall</li>
<li>upper_wall_pt: Pointer to geometric object that represents the upper wall</li>
<li>time_stepper_pt: Pointer to timestepper; defaults to Static </li>
</ul>
<div class="fragment"><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    : SingleLayerSpineMesh&lt;ELEMENT&gt;(</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        2 * (nx1 + nx2 + nhalf), nh, 1.0, h, time_stepper_pt),</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#af6ef10fb80559c3ad27a50116da60dcc">Nx1</a>(nx1),</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a237b4f516eb3f74e42e190f2a23f93c3">Nx2</a>(nx2),</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a26c57f832b7cdc495087cef7b54c98fd">Nx3</a>(nx3),</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a1e58d18dd2231c785008efa07260e8da">Nhalf</a>(nhalf),</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a4ba20dfa61b6c342f2defbc0cdb47851">Nh</a>(nh),</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a3d711e1bc9d751ab14662f6839a900e3">H</a>(h),</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a1f97e78a12000afcc1bd754102b5b51a">Upper_wall_pt</a>(upper_wall_pt),</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a04c0136de66c06a34347b89f453730e1">Lower_wall_pt</a>(lower_wall_pt),</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a0f41083aa9a97fca03d498bd6ec21eb2">Zeta_start</a>(zeta_start),</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#ac1b5e005bfb5db65f54ca599942126ea">Zeta_end</a>(zeta_end),</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#af701937d59d7804f40cb1b4c7a262391">Zeta_transition_start</a>(zeta_transition_start),</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a1d05bb741eba54ab7498ab4f3c55f1b7">Zeta_transition_end</a>(zeta_transition_end),</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#af5e7951a89bc13d73f2b137947cda8a3">Spine_centre_fraction_pt</a>(&amp;<a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a306cf8ae8f91a81054904de64195bb16">Default_spine_centre_fraction</a>),</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a306cf8ae8f91a81054904de64195bb16">Default_spine_centre_fraction</a>(0.5)</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="comment">// Add the created elements to the bulk domain</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordtype">unsigned</span> n_bulk = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">nelement</a>();</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a207b6a5e52ce95c0a6125f56eb22b98d">Bulk_element_pt</a>.resize(n_bulk);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; n_bulk; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a207b6a5e52ce95c0a6125f56eb22b98d">Bulk_element_pt</a>[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>] = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a4f274774435e9454bf77bf70de69367a">finite_element_pt</a>(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    }</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="comment">// Mesh can only be built with 2D Qelements.</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    MeshChecker::assert_geometric_element&lt;QElementGeometricBase, ELEMENT&gt;(2);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="comment">// Mesh can only be built with spine elements</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    MeshChecker::assert_geometric_element&lt;SpineFiniteElement, ELEMENT&gt;(2);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="comment">// Initialise start of transition region to zero</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="comment">// Zeta_transition_start = 0.0;</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="comment">// Length of deposited film region</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keywordtype">double</span> llayer = <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#af701937d59d7804f40cb1b4c7a262391">Zeta_transition_start</a> - <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a0f41083aa9a97fca03d498bd6ec21eb2">Zeta_start</a>;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="comment">// Length of transition region</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordtype">double</span> d = <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a1d05bb741eba54ab7498ab4f3c55f1b7">Zeta_transition_end</a> - <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#af701937d59d7804f40cb1b4c7a262391">Zeta_transition_start</a>;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="comment">// Work out radius of circular cap from lower and upper wall</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    Vector&lt;double&gt; r_wall_lo(2), r_wall_up(2);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    Vector&lt;double&gt; <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>(1), s_lo(1), s_up(1);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    GeomObject *lower_sub_geom_object_pt = 0, *upper_sub_geom_object_pt = 0;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    GeomObject* lower_transition_geom_object_pt = 0;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    GeomObject* upper_transition_geom_object_pt = 0;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    Vector&lt;double&gt; s_transition_lo(1), s_transition_up(1);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    Vector&lt;double&gt; spine_centre(2);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="comment">// Find position of lower and upper walls at start of transition region</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>[0] = <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#af701937d59d7804f40cb1b4c7a262391">Zeta_transition_start</a>;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a04c0136de66c06a34347b89f453730e1">Lower_wall_pt</a>-&gt;<a class="code" href="../../da/ddd/classoomph_1_1GeomObject.html#a0d04c9d4667817f3ef24bb660fd56065">position</a>(<a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>, r_wall_lo);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a1f97e78a12000afcc1bd754102b5b51a">Upper_wall_pt</a>-&gt;<a class="code" href="../../da/ddd/classoomph_1_1GeomObject.html#a0d04c9d4667817f3ef24bb660fd56065">position</a>(<a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>, r_wall_up);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="comment">// Radius is the difference between the film thickness and the distance</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="comment">// to the lower wall</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../de/d6c/namespaceUniformPSDSelfTest.html#ab2a01330429b8f42b72cc01f29f1beeb">radius</a> = -r_wall_lo[1] - <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a3d711e1bc9d751ab14662f6839a900e3">H</a>;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="comment">// Check to non-symmetric mesh</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">std::fabs</a>(r_wall_lo[1] + r_wall_up[1]) &gt; 1.0e-4)</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;\n\n=================================================== &quot;</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                 &lt;&lt; std::endl;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Warning: &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;-------- &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Upper and lower walls are not symmetric at zeta=0&quot;</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                 &lt;&lt; std::endl;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Your initial mesh will look very odd.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;y-coordinates of walls at zeta=0 are: &quot;</span> &lt;&lt; r_wall_lo[1]</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot; and &quot;</span> &lt;&lt; r_wall_up[1] &lt;&lt; std::endl</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                 &lt;&lt; std::endl;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;===================================================\n\n &quot;</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                 &lt;&lt; std::endl;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    }</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="comment">// Add the interface elements</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="comment">// Loop over the horizontal elements</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      <span class="keywordtype">unsigned</span> n_x = 2 * (nx1 + nx2 + nhalf);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      <span class="keywordtype">unsigned</span> n_y = nh;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_x; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <span class="comment">// Construct a new 1D line element on the face on which the local</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="comment">// coordinate 1 is fixed at its max. value (1) --- This is face 2</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        FiniteElement* interface_element_element_pt = <span class="keyword">new</span> INTERFACE_ELEMENT(</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;          this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a4f274774435e9454bf77bf70de69367a">finite_element_pt</a>(n_x * (n_y - 1) + <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>), 2);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="comment">// Push it back onto the stack</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#aca12acfe655a4d5c4a4eab4a7b970812">Element_pt</a>.push_back(interface_element_element_pt);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <span class="comment">// Push it back onto the stack of interface elements</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        this-&gt;<a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a7422b912ff7ad780777205f0cbe83362">Interface_element_pt</a>.push_back(interface_element_element_pt);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      }</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    }</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="comment">// Reorder elements: Vertical stacks of elements, each topped by</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="comment">// their interface element -- this is (currently) identical to the</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="comment">// version in the SingleLayerSpineMesh but it&#39;s important</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="comment">// that element reordering is maintained in exactly this form</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="comment">// so to be on the safe side, we move the function in here.</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a52ffe1a705cb720d09c831b9cf5397f6">initial_element_reorder</a>();</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160; </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="comment">// Store pointer to control element</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a81ee86c0c747947dab52073c221d53c1">Control_element_pt</a> = <span class="keyword">dynamic_cast&lt;</span>ELEMENT*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ab28b03dabf4e247c4a25f834eb11b339">element_pt</a>((nx1 + nx2 + nhalf) * (nh + 1) - 2));</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="comment">// Temporary storage for boundary lookup scheme</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    Vector&lt;std::set&lt;Node*&gt;&gt; set_boundary_node_pt(6);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="comment">// Boundary 1 -&gt; 3; 2 -&gt; 4; 3 -&gt; 5</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ibound = 1; ibound &lt;= 3; ibound++)</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      <span class="keywordtype">unsigned</span> numnod = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a034677ceb48c67769acb83f304c84f7d">nboundary_node</a>(ibound);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; numnod; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        set_boundary_node_pt[ibound + 2].insert(</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;          this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#aca0a21f4eab2d6fe8c7fa011b5c33c3c">boundary_node_pt</a>(ibound, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>));</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      }</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    }</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="comment">// Get number of nodes per element</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordtype">unsigned</span> nnod = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a4f274774435e9454bf77bf70de69367a">finite_element_pt</a>(0)-&gt;<a class="code" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">nnode</a>();</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="comment">// Get number of nodes along element edge</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keywordtype">unsigned</span> np = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a4f274774435e9454bf77bf70de69367a">finite_element_pt</a>(0)-&gt;<a class="code" href="../../d2/dc6/classoomph_1_1FiniteElement.html#ab65c7a94dda80c1876a09ac12be4e39c">nnode_1d</a>();</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="comment">// Initialise number of elements in previous regions:</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keywordtype">unsigned</span> n_prev_elements = 0;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="comment">// We&#39;ve now built the straight single-layer mesh and need to change the</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="comment">// the update functions for all nodes so that the domain</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="comment">// deforms into the Bretherton shape</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="comment">// Loop over elements in lower deposited film region</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="comment">// -------------------------------------------------</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      <span class="comment">// Increments in wall coordinate</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      <span class="keywordtype">double</span> dzeta_el = llayer / <a class="code" href="../../df/de6/classdouble.html">double</a>(nx1);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      <span class="keywordtype">double</span> dzeta_node = llayer / <a class="code" href="../../df/de6/classdouble.html">double</a>(nx1 * (np - 1));</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      <span class="comment">// Loop over elements horizontally</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; nx1; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="comment">// Start of wall coordinate</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <span class="keywordtype">double</span> zeta_lo = <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a0f41083aa9a97fca03d498bd6ec21eb2">Zeta_start</a> + <a class="code" href="../../df/de6/classdouble.html">double</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) * dzeta_el;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <span class="comment">// Loop over elements vertically</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; nh; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;          <span class="comment">// Work out element number in overall mesh</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;          <span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = n_prev_elements + <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> * (nh + 1) + <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;          <span class="comment">// Get pointer to element</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;          FiniteElement* el_pt = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a4f274774435e9454bf77bf70de69367a">finite_element_pt</a>(e);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;          <span class="comment">// Loop over its nodes</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i0 = 0; i0 &lt; np; i0++)</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;          {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i1 = 0; i1 &lt; np; i1++)</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;              <span class="comment">// Node number:</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;              <span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = i0 * np + i1;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;              <span class="comment">// Get spine node</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;              SpineNode* nod_pt = <span class="keyword">dynamic_cast&lt;</span>SpineNode*<span class="keyword">&gt;</span>(el_pt-&gt;node_pt(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>));</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;              <span class="comment">// Set update fct id</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;              nod_pt-&gt;node_update_fct_id() = 0;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;              <span class="comment">// Provide spine with additional storage for wall coordinate</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;              <span class="comment">// and wall geom object:</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;              <span class="keywordflow">if</span> (i0 == 0)</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;              {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                <span class="comment">// Get the Lagrangian coordinate in the Lower Wall</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>[0] = zeta_lo + <a class="code" href="../../df/de6/classdouble.html">double</a>(i1) * dzeta_node;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                <span class="comment">// Get the geometric object and local coordinate</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a04c0136de66c06a34347b89f453730e1">Lower_wall_pt</a>-&gt;<a class="code" href="../../da/ddd/classoomph_1_1GeomObject.html#a78ee9f98bcfd0c5e1f07a459777663d3">locate_zeta</a>(</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                  <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>, lower_sub_geom_object_pt, s_lo);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160; </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                <span class="comment">// The local coordinate is a geometric parameter</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                <span class="comment">// This needs to be set (rather than added) because the</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                <span class="comment">// same spine may be visited more than once</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                Vector&lt;double&gt; parameters(1, s_lo[0]);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                nod_pt-&gt;spine_pt()-&gt;set_geom_parameter(parameters);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                <span class="comment">// Adjust spine height</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                nod_pt-&gt;spine_pt()-&gt;height() = <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a3d711e1bc9d751ab14662f6839a900e3">H</a>;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                <span class="comment">// The sub geom object is one (and only) geom object</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                <span class="comment">// for spine:</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                Vector&lt;GeomObject*&gt; geom_object_pt(1);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                geom_object_pt[0] = lower_sub_geom_object_pt;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                <span class="comment">// Pass geom object(s) to spine</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                nod_pt-&gt;spine_pt()-&gt;set_geom_object_pt(geom_object_pt);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                <span class="comment">// Push the node back onto boundaries</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> == 0) set_boundary_node_pt[0].insert(nod_pt);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;              }</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            }</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;          }</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        }</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      }</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      <span class="comment">// Increment number of previous elements</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      n_prev_elements += nx1 * (nh + 1);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    {</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      <span class="comment">// Calculate the centre for the spine nodes in the transition region</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>[0] = <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#af701937d59d7804f40cb1b4c7a262391">Zeta_transition_start</a>;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      <span class="comment">// Get the geometric objects on the walls at the start of the transition</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      <span class="comment">// region</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a04c0136de66c06a34347b89f453730e1">Lower_wall_pt</a>-&gt;<a class="code" href="../../da/ddd/classoomph_1_1GeomObject.html#a78ee9f98bcfd0c5e1f07a459777663d3">locate_zeta</a>(</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>, lower_transition_geom_object_pt, s_transition_lo);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a1f97e78a12000afcc1bd754102b5b51a">Upper_wall_pt</a>-&gt;<a class="code" href="../../da/ddd/classoomph_1_1GeomObject.html#a78ee9f98bcfd0c5e1f07a459777663d3">locate_zeta</a>(</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>, upper_transition_geom_object_pt, s_transition_up);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      <span class="comment">// Find the Eulerian coordinates of the walls at the transition region</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      lower_transition_geom_object_pt-&gt;position(s_transition_lo, r_wall_lo);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      upper_transition_geom_object_pt-&gt;position(s_transition_up, r_wall_up);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160; </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      <span class="comment">// Take the average of these positions to define the origin of the spines</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      <span class="comment">// in the transition region Horizontal position is always halfway</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      spine_centre[0] = 0.5 * (r_wall_lo[0] + r_wall_up[0]);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      <span class="comment">// Vertical Position is given by a specified fraction</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      <span class="comment">// between the upper and lower walls</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      spine_centre[1] =</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        r_wall_lo[1] + <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a67f784e7b3a898af6c60515042c3ea73">spine_centre_fraction</a>() * (r_wall_up[1] - r_wall_lo[1]);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    }</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160; </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="comment">// Loop over elements in lower horizontal transition region</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="comment">// --------------------------------------------------------</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    {</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      <span class="comment">// Increments in wall coordinate</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      <span class="keywordtype">double</span> dzeta_el = d / <a class="code" href="../../df/de6/classdouble.html">double</a>(nx2);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      <span class="keywordtype">double</span> dzeta_node = d / <a class="code" href="../../df/de6/classdouble.html">double</a>(nx2 * (np - 1));</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      <span class="comment">// Loop over elements horizontally</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; nx2; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      {</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        <span class="comment">// Start of wall coordinate</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <span class="keywordtype">double</span> zeta_lo = <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#af701937d59d7804f40cb1b4c7a262391">Zeta_transition_start</a> + <a class="code" href="../../df/de6/classdouble.html">double</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) * dzeta_el;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160; </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        <span class="comment">// Loop over elements vertically</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; nh; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        {</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;          <span class="comment">// Work out element number in overall mesh</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;          <span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = n_prev_elements + <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> * (nh + 1) + <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;          <span class="comment">// Get pointer to element</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;          FiniteElement* el_pt = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a4f274774435e9454bf77bf70de69367a">finite_element_pt</a>(e);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;          <span class="comment">// Loop over its nodes</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i0 = 0; i0 &lt; np; i0++)</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;          {</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i1 = 0; i1 &lt; np; i1++)</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            {</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;              <span class="comment">// Node number:</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;              <span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = i0 * np + i1;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;              <span class="comment">// Get spine node</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;              SpineNode* nod_pt = <span class="keyword">dynamic_cast&lt;</span>SpineNode*<span class="keyword">&gt;</span>(el_pt-&gt;node_pt(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>));</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160; </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;              <span class="comment">// Set update id</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;              nod_pt-&gt;node_update_fct_id() = 1;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160; </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;              <span class="comment">// Provide spine with additional storage for wall coordinate</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;              <span class="keywordflow">if</span> (i0 == 0)</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;              {</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                <span class="comment">// Get the Lagrangian coordinate in the Lower Wall</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>[0] = zeta_lo + <a class="code" href="../../df/de6/classdouble.html">double</a>(i1) * dzeta_node;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                <span class="comment">// Get the sub geometric object and local coordinate</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a04c0136de66c06a34347b89f453730e1">Lower_wall_pt</a>-&gt;<a class="code" href="../../da/ddd/classoomph_1_1GeomObject.html#a78ee9f98bcfd0c5e1f07a459777663d3">locate_zeta</a>(</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                  <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>, lower_sub_geom_object_pt, s_lo);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160; </div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                <span class="comment">// Pass geometric parameter to the spine</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                Vector&lt;double&gt; parameters(3);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                parameters[0] = s_lo[0];</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                parameters[1] = s_transition_lo[0];</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                parameters[2] = s_transition_up[0];</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                nod_pt-&gt;spine_pt()-&gt;set_geom_parameter(parameters);</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                <span class="comment">// Get position vector to wall</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                lower_sub_geom_object_pt-&gt;position(s_lo, r_wall_lo);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160; </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                <span class="comment">// Get normal vector towards origin</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                Vector&lt;double&gt; <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>(2);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[0] = spine_centre[0] - r_wall_lo[0];</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[1] = spine_centre[1] - r_wall_lo[1];</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                <span class="keywordtype">double</span> length = <a class="code" href="../../d8/de9/AnnoyingScalar_8h.html#abe7b2405f1f05f9997193c680e8e2fe0">sqrt</a>(<a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[0] * <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[0] + <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[1] * <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[1]);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                nod_pt-&gt;spine_pt()-&gt;height() = length - <a class="code" href="../../de/d6c/namespaceUniformPSDSelfTest.html#ab2a01330429b8f42b72cc01f29f1beeb">radius</a>;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160; </div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                <span class="comment">// Lower sub geom object is one (and only) geom object</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                <span class="comment">// for spine:</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                Vector&lt;GeomObject*&gt; geom_object_pt(3);</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                geom_object_pt[0] = lower_sub_geom_object_pt;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                geom_object_pt[1] = lower_transition_geom_object_pt;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                geom_object_pt[2] = upper_transition_geom_object_pt;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160; </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                <span class="comment">// Pass geom object(s) to spine</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                nod_pt-&gt;spine_pt()-&gt;set_geom_object_pt(geom_object_pt);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                <span class="comment">// Push the node back onto boundaries</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> == 0) set_boundary_node_pt[0].insert(nod_pt);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;              }</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            }</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;          }</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        }</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      }</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      <span class="comment">// Increment number of previous elements</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      n_prev_elements += nx2 * (nh + 1);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    }</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160; </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="comment">// Loop over elements in lower vertical transition region</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="comment">// --------------------------------------------------------</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    {</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; nhalf; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      {</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        <span class="comment">// Loop over elements vertically</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; nh; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        {</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;          <span class="comment">// Work out element number in overall mesh</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;          <span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = n_prev_elements + <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> * (nh + 1) + <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160; </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;          <span class="comment">// Get pointer to element</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;          FiniteElement* el_pt = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a4f274774435e9454bf77bf70de69367a">finite_element_pt</a>(e);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160; </div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;          <span class="comment">// Loop over its nodes</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i0 = 0; i0 &lt; np; i0++)</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;          {</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i1 = 0; i1 &lt; np; i1++)</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            {</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;              <span class="comment">// Node number:</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;              <span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = i0 * np + i1;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160; </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;              <span class="comment">// Get spine node</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;              SpineNode* nod_pt = <span class="keyword">dynamic_cast&lt;</span>SpineNode*<span class="keyword">&gt;</span>(el_pt-&gt;node_pt(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>));</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160; </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;              <span class="comment">// Set update id</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;              nod_pt-&gt;node_update_fct_id() = 2;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160; </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;              <span class="comment">// Provide spine with additional storage for fraction along</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;              <span class="comment">// vertical line</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;              <span class="keywordflow">if</span> (i0 == 0)</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;              {</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                <span class="comment">// Get position vectors to wall</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>[0] = <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a1d05bb741eba54ab7498ab4f3c55f1b7">Zeta_transition_end</a>;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                <span class="comment">// Get the sub geometric objects</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a04c0136de66c06a34347b89f453730e1">Lower_wall_pt</a>-&gt;<a class="code" href="../../da/ddd/classoomph_1_1GeomObject.html#a78ee9f98bcfd0c5e1f07a459777663d3">locate_zeta</a>(</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                  <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>, lower_sub_geom_object_pt, s_lo);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a1f97e78a12000afcc1bd754102b5b51a">Upper_wall_pt</a>-&gt;<a class="code" href="../../da/ddd/classoomph_1_1GeomObject.html#a78ee9f98bcfd0c5e1f07a459777663d3">locate_zeta</a>(</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                  <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>, upper_sub_geom_object_pt, s_up);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160; </div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                lower_sub_geom_object_pt-&gt;position(s_lo, r_wall_lo);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                upper_sub_geom_object_pt-&gt;position(s_up, r_wall_up);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160; </div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                <span class="comment">// Set vertical fraction</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                <span class="keywordtype">double</span> vertical_fraction =</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                  (<a class="code" href="../../df/de6/classdouble.html">double</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) + <a class="code" href="../../df/de6/classdouble.html">double</a>(i1) / <a class="code" href="../../df/de6/classdouble.html">double</a>(np - 1)) /</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                  <span class="keywordtype">double</span>(2.0 * nhalf);</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160; </div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                <span class="comment">// Add the geometric parameters in order</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                Vector&lt;double&gt; parameters(5);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                parameters[0] = s_lo[0];</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                parameters[1] = s_up[0];</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                parameters[2] = vertical_fraction;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                parameters[3] = s_transition_lo[0];</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                parameters[4] = s_transition_up[0];</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                nod_pt-&gt;spine_pt()-&gt;set_geom_parameter(parameters);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160; </div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                <span class="comment">// Origin of spine</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                Vector&lt;double&gt; <a class="code" href="../../d9/d37/namespaceGlobalParameters.html#a48941328f0bded62ed7a778062b03dd7">S0</a>(2);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                <a class="code" href="../../d9/d37/namespaceGlobalParameters.html#a48941328f0bded62ed7a778062b03dd7">S0</a>[0] = r_wall_lo[0] +</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                        vertical_fraction * (r_wall_up[0] - r_wall_lo[0]);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                <a class="code" href="../../d9/d37/namespaceGlobalParameters.html#a48941328f0bded62ed7a778062b03dd7">S0</a>[1] = r_wall_lo[1] +</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                        vertical_fraction * (r_wall_up[1] - r_wall_lo[1]);</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160; </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                <span class="comment">// Get normal vector towards origin</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                Vector&lt;double&gt; <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>(2);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[0] = spine_centre[0] - <a class="code" href="../../d9/d37/namespaceGlobalParameters.html#a48941328f0bded62ed7a778062b03dd7">S0</a>[0];</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[1] = spine_centre[1] - <a class="code" href="../../d9/d37/namespaceGlobalParameters.html#a48941328f0bded62ed7a778062b03dd7">S0</a>[1];</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160; </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                <span class="keywordtype">double</span> length = <a class="code" href="../../d8/de9/AnnoyingScalar_8h.html#abe7b2405f1f05f9997193c680e8e2fe0">sqrt</a>(<a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[0] * <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[0] + <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[1] * <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[1]);</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                nod_pt-&gt;spine_pt()-&gt;height() = length - <a class="code" href="../../de/d6c/namespaceUniformPSDSelfTest.html#ab2a01330429b8f42b72cc01f29f1beeb">radius</a>;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                <span class="comment">// Lower and Upper wall sub geom objects affect  spine:</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                Vector&lt;GeomObject*&gt; geom_object_pt(4);</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                geom_object_pt[0] = lower_sub_geom_object_pt;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                geom_object_pt[1] = upper_sub_geom_object_pt;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                geom_object_pt[2] = lower_transition_geom_object_pt;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                geom_object_pt[3] = upper_transition_geom_object_pt;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160; </div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                <span class="comment">// Pass geom object(s) to spine</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                nod_pt-&gt;spine_pt()-&gt;set_geom_object_pt(geom_object_pt);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160; </div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                <span class="comment">// Push the node back onto boundaries</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> == 0) set_boundary_node_pt[1].insert(nod_pt);</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;              }</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;            }</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;          }</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        }</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      }</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160; </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      <span class="comment">// Increment number of previous elements</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      n_prev_elements += nhalf * (nh + 1);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    }</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160; </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160; </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="comment">// Loop over elements in upper vertical transition region</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="comment">// ------------------------------------------------------</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    {</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; nhalf; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;      {</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        <span class="comment">// Loop over elements vertically</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; nh; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        {</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;          <span class="comment">// Work out element number in overall mesh</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;          <span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = n_prev_elements + <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> * (nh + 1) + <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160; </div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;          <span class="comment">// Get pointer to element</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;          FiniteElement* el_pt = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a4f274774435e9454bf77bf70de69367a">finite_element_pt</a>(e);</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160; </div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;          <span class="comment">// Loop over its nodes</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i0 = 0; i0 &lt; np; i0++)</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;          {</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i1 = 0; i1 &lt; np; i1++)</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;            {</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;              <span class="comment">// Node number:</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;              <span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = i0 * np + i1;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160; </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;              <span class="comment">// Get spine node</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;              SpineNode* nod_pt = <span class="keyword">dynamic_cast&lt;</span>SpineNode*<span class="keyword">&gt;</span>(el_pt-&gt;node_pt(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>));</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160; </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;              <span class="comment">// Set update id</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;              nod_pt-&gt;node_update_fct_id() = 3;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160; </div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;              <span class="comment">// Provide spine with additional storage for fraction along</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;              <span class="comment">// vertical line</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;              <span class="keywordflow">if</span> (i0 == 0)</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;              {</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                <span class="comment">// Get position vectors to wall</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>[0] = <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a1d05bb741eba54ab7498ab4f3c55f1b7">Zeta_transition_end</a>;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                <span class="comment">// Get the sub geometric objects</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a04c0136de66c06a34347b89f453730e1">Lower_wall_pt</a>-&gt;<a class="code" href="../../da/ddd/classoomph_1_1GeomObject.html#a78ee9f98bcfd0c5e1f07a459777663d3">locate_zeta</a>(</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                  <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>, lower_sub_geom_object_pt, s_lo);</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a1f97e78a12000afcc1bd754102b5b51a">Upper_wall_pt</a>-&gt;<a class="code" href="../../da/ddd/classoomph_1_1GeomObject.html#a78ee9f98bcfd0c5e1f07a459777663d3">locate_zeta</a>(</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                  <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>, upper_sub_geom_object_pt, s_up);</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160; </div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                lower_sub_geom_object_pt-&gt;position(s_lo, r_wall_lo);</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                upper_sub_geom_object_pt-&gt;position(s_up, r_wall_up);</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160; </div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                <span class="comment">// Set vertical fraction</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                <span class="keywordtype">double</span> vertical_fraction =</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                  0.5 + (<a class="code" href="../../df/de6/classdouble.html">double</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) + <a class="code" href="../../df/de6/classdouble.html">double</a>(i1) / <a class="code" href="../../df/de6/classdouble.html">double</a>(np - 1)) /</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                          <span class="keywordtype">double</span>(2.0 * nhalf);</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160; </div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                <span class="comment">// Add the geometric parameters in order</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                Vector&lt;double&gt; parameters(5);</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                parameters[0] = s_lo[0];</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                parameters[1] = s_up[0];</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                parameters[2] = vertical_fraction;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                parameters[3] = s_transition_lo[0];</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                parameters[4] = s_transition_up[0];</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                nod_pt-&gt;spine_pt()-&gt;set_geom_parameter(parameters);</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160; </div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                <span class="comment">// Origin of spine</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                Vector&lt;double&gt; <a class="code" href="../../d9/d37/namespaceGlobalParameters.html#a48941328f0bded62ed7a778062b03dd7">S0</a>(2);</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                <a class="code" href="../../d9/d37/namespaceGlobalParameters.html#a48941328f0bded62ed7a778062b03dd7">S0</a>[0] = r_wall_lo[0] +</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                        vertical_fraction * (r_wall_up[0] - r_wall_lo[0]);</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                <a class="code" href="../../d9/d37/namespaceGlobalParameters.html#a48941328f0bded62ed7a778062b03dd7">S0</a>[1] = r_wall_lo[1] +</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                        vertical_fraction * (r_wall_up[1] - r_wall_lo[1]);</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160; </div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                <span class="comment">// Get normal vector towards origin</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                Vector&lt;double&gt; <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>(2);</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[0] = spine_centre[0] - <a class="code" href="../../d9/d37/namespaceGlobalParameters.html#a48941328f0bded62ed7a778062b03dd7">S0</a>[0];</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[1] = spine_centre[1] - <a class="code" href="../../d9/d37/namespaceGlobalParameters.html#a48941328f0bded62ed7a778062b03dd7">S0</a>[1];</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160; </div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                <span class="keywordtype">double</span> length = <a class="code" href="../../d8/de9/AnnoyingScalar_8h.html#abe7b2405f1f05f9997193c680e8e2fe0">sqrt</a>(<a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[0] * <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[0] + <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[1] * <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[1]);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                nod_pt-&gt;spine_pt()-&gt;height() = length - <a class="code" href="../../de/d6c/namespaceUniformPSDSelfTest.html#ab2a01330429b8f42b72cc01f29f1beeb">radius</a>;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160; </div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                <span class="comment">// Upper and Lower wall geom objects affect spine</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                Vector&lt;GeomObject*&gt; geom_object_pt(4);</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                geom_object_pt[0] = lower_sub_geom_object_pt;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                geom_object_pt[1] = upper_sub_geom_object_pt;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                geom_object_pt[2] = lower_transition_geom_object_pt;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                geom_object_pt[3] = upper_transition_geom_object_pt;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160; </div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                <span class="comment">// Pass geom object(s) to spine</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                nod_pt-&gt;spine_pt()-&gt;set_geom_object_pt(geom_object_pt);</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160; </div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                <span class="comment">// Push the node back onto boundaries</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> == 0) set_boundary_node_pt[1].insert(nod_pt);</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;              }</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;            }</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;          }</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        }</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      }</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;      <span class="comment">// Increment number of previous elements</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;      n_prev_elements += nhalf * (nh + 1);</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    }</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160; </div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160; </div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="comment">// Loop over elements in upper horizontal transition region</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="comment">// --------------------------------------------------------</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    {</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      <span class="comment">// Increments in wall coordinate</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;      <span class="keywordtype">double</span> dzeta_el = d / <a class="code" href="../../df/de6/classdouble.html">double</a>(nx2);</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;      <span class="keywordtype">double</span> dzeta_node = d / <a class="code" href="../../df/de6/classdouble.html">double</a>(nx2 * (np - 1));</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160; </div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;      <span class="comment">// Loop over elements horizontally</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; nx2; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;      {</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        <span class="comment">// Start of wall coordinate</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        <span class="keywordtype">double</span> zeta_lo = <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a1d05bb741eba54ab7498ab4f3c55f1b7">Zeta_transition_end</a> - <a class="code" href="../../df/de6/classdouble.html">double</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) * dzeta_el;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160; </div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        <span class="comment">// Loop over elements vertically</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; nh; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        {</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;          <span class="comment">// Work out element number in overall mesh</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;          <span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = n_prev_elements + <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> * (nh + 1) + <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160; </div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;          <span class="comment">// Get pointer to element</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;          FiniteElement* el_pt = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a4f274774435e9454bf77bf70de69367a">finite_element_pt</a>(e);</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160; </div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;          <span class="comment">// Loop over its nodes</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i0 = 0; i0 &lt; np; i0++)</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;          {</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i1 = 0; i1 &lt; np; i1++)</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;            {</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;              <span class="comment">// Node number:</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;              <span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = i0 * np + i1;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160; </div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;              <span class="comment">// Get spine node</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;              SpineNode* nod_pt = <span class="keyword">dynamic_cast&lt;</span>SpineNode*<span class="keyword">&gt;</span>(el_pt-&gt;node_pt(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>));</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160; </div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;              <span class="comment">// Set update id</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;              nod_pt-&gt;node_update_fct_id() = 4;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160; </div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;              <span class="comment">// Provide spine with additional storage for wall coordinate</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;              <span class="keywordflow">if</span> (i0 == 0)</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;              {</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                <span class="comment">// Get the Lagrangian coordinate in the Upper wall</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>[0] = zeta_lo - <a class="code" href="../../df/de6/classdouble.html">double</a>(i1) * dzeta_node;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                <span class="comment">// Get the sub geometric object and local coordinate</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a1f97e78a12000afcc1bd754102b5b51a">Upper_wall_pt</a>-&gt;<a class="code" href="../../da/ddd/classoomph_1_1GeomObject.html#a78ee9f98bcfd0c5e1f07a459777663d3">locate_zeta</a>(</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                  <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>, upper_sub_geom_object_pt, s_up);</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160; </div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                <span class="comment">// Pass geometric parameter to spine</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                Vector&lt;double&gt; parameters(3);</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                parameters[0] = s_up[0];</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                parameters[1] = s_transition_lo[0];</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                parameters[2] = s_transition_up[0];</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                nod_pt-&gt;spine_pt()-&gt;set_geom_parameter(parameters);</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160; </div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                <span class="comment">// Get position vector to wall</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                upper_sub_geom_object_pt-&gt;position(s_up, r_wall_up);</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160; </div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                <span class="comment">// Get normal vector towards origin</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                Vector&lt;double&gt; <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>(2);</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[0] = spine_centre[0] - r_wall_up[0];</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[1] = spine_centre[1] - r_wall_up[1];</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                <span class="keywordtype">double</span> length = <a class="code" href="../../d8/de9/AnnoyingScalar_8h.html#abe7b2405f1f05f9997193c680e8e2fe0">sqrt</a>(<a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[0] * <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[0] + <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[1] * <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[1]);</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                nod_pt-&gt;spine_pt()-&gt;height() = length - <a class="code" href="../../de/d6c/namespaceUniformPSDSelfTest.html#ab2a01330429b8f42b72cc01f29f1beeb">radius</a>;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160; </div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                <span class="comment">// upper wall sub geom object is one (and only) geom object</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                <span class="comment">// for spine:</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                Vector&lt;GeomObject*&gt; geom_object_pt(3);</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                geom_object_pt[0] = upper_sub_geom_object_pt;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                geom_object_pt[1] = lower_transition_geom_object_pt;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                geom_object_pt[2] = upper_transition_geom_object_pt;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160; </div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                <span class="comment">// Pass geom object(s) to spine</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                nod_pt-&gt;spine_pt()-&gt;set_geom_object_pt(geom_object_pt);</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160; </div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                <span class="comment">// Push the node back onto boundaries</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> == 0) set_boundary_node_pt[2].insert(nod_pt);</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;              }</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;            }</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;          }</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        }</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;      }</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160; </div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;      <span class="comment">// Increment number of previous elements</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;      n_prev_elements += nx2 * (nh + 1);</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    }</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160; </div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160; </div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <span class="comment">// Loop over elements in upper deposited film region</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <span class="comment">// -------------------------------------------------</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    {</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;      <span class="comment">// Increments in wall coordinate</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;      <span class="keywordtype">double</span> dzeta_el = llayer / <a class="code" href="../../df/de6/classdouble.html">double</a>(nx1);</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;      <span class="keywordtype">double</span> dzeta_node = llayer / <a class="code" href="../../df/de6/classdouble.html">double</a>(nx1 * (np - 1));</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160; </div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;      <span class="comment">// Loop over elements horizontally</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; nx1; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;      {</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        <span class="comment">// Start of wall coordinate</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        <span class="keywordtype">double</span> zeta_lo = <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#af701937d59d7804f40cb1b4c7a262391">Zeta_transition_start</a> - <a class="code" href="../../df/de6/classdouble.html">double</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) * dzeta_el;</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160; </div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        <span class="comment">// Loop over elements vertically</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; nh; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        {</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;          <span class="comment">// Work out element number in overall mesh</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;          <span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = n_prev_elements + <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> * (nh + 1) + <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160; </div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;          <span class="comment">// Get pointer to element</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;          FiniteElement* el_pt = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a4f274774435e9454bf77bf70de69367a">finite_element_pt</a>(e);</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160; </div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;          <span class="comment">// Loop over its nodes</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i0 = 0; i0 &lt; np; i0++)</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;          {</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i1 = 0; i1 &lt; np; i1++)</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;            {</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;              <span class="comment">// Node number:</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;              <span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = i0 * np + i1;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160; </div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;              <span class="comment">// Get spine node</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;              SpineNode* nod_pt = <span class="keyword">dynamic_cast&lt;</span>SpineNode*<span class="keyword">&gt;</span>(el_pt-&gt;node_pt(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>));</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160; </div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;              <span class="comment">// Set update id</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;              nod_pt-&gt;node_update_fct_id() = 5;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160; </div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;              <span class="comment">// Provide spine with additional storage for wall coordinate</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;              <span class="keywordflow">if</span> (i0 == 0)</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;              {</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                <span class="comment">// Get the Lagrangian coordinate in the Upper wall</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>[0] = zeta_lo - <a class="code" href="../../df/de6/classdouble.html">double</a>(i1) * dzeta_node;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                <span class="comment">// Get the geometric object and local coordinate</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a1f97e78a12000afcc1bd754102b5b51a">Upper_wall_pt</a>-&gt;<a class="code" href="../../da/ddd/classoomph_1_1GeomObject.html#a78ee9f98bcfd0c5e1f07a459777663d3">locate_zeta</a>(</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                  <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>, upper_sub_geom_object_pt, s_up);</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160; </div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                <span class="comment">// The local coordinate is a geometric parameter</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                Vector&lt;double&gt; parameters(1, s_up[0]);</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                nod_pt-&gt;spine_pt()-&gt;set_geom_parameter(parameters);</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160; </div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                <span class="comment">// Adjust spine height</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                nod_pt-&gt;spine_pt()-&gt;height() = <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a3d711e1bc9d751ab14662f6839a900e3">H</a>;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160; </div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                <span class="comment">// upper sub geom object is one (and only) geom object</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                <span class="comment">// for spine:</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                Vector&lt;GeomObject*&gt; geom_object_pt(1);</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                geom_object_pt[0] = upper_sub_geom_object_pt;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160; </div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                <span class="comment">// Pass geom object(s) to spine</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                nod_pt-&gt;spine_pt()-&gt;set_geom_object_pt(geom_object_pt);</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160; </div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                <span class="comment">// Push the node back onto boundaries</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> == 0) set_boundary_node_pt[2].insert(nod_pt);</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;              }</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;            }</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;          }</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        }</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;      }</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    }</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160; </div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <span class="comment">// Wipe the boundary lookup schemes</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a8d86e14d55a1162e184bd7fac4630904">remove_boundary_nodes</a>();</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a6667f4ddc6e9357a9a7d53160db8161e">set_nboundary</a>(6);</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160; </div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    <span class="comment">// Copy from sets to vectors</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ibound = 0; ibound &lt; 6; ibound++)</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    {</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;      <span class="keyword">typedef</span> std::set&lt;Node*&gt;::iterator IT;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;      <span class="keywordflow">for</span> (IT it = set_boundary_node_pt[ibound].begin();</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;           it != set_boundary_node_pt[ibound].end();</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;           it++)</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;      {</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a007b102ac8e42328872ad658d7110bfc">add_boundary_node</a>(ibound, *it);</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;      }</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    }</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160; </div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160; </div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    <span class="comment">// Loop over the free surface boundary (4) and set a boundary coordinate</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    {</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;      <span class="comment">// Boundary coordinate</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;      Vector&lt;double&gt; <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>(1);</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;      <span class="keywordtype">unsigned</span> n_boundary_node = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a034677ceb48c67769acb83f304c84f7d">nboundary_node</a>(4);</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> n = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_boundary_node; ++<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>)</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;      {</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>[0] = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#aca0a21f4eab2d6fe8c7fa011b5c33c3c">boundary_node_pt</a>(4, n)-&gt;<a class="code" href="../../dc/db7/classoomph_1_1Node.html#a056f8e82da938369cd38541c5cdc598a">x</a>(0);</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#aca0a21f4eab2d6fe8c7fa011b5c33c3c">boundary_node_pt</a>(4, n)-&gt;<a class="code" href="../../dc/db7/classoomph_1_1Node.html#a94c19e165ab4e88aabbfa27443c530b7">set_coordinates_on_boundary</a>(4, <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>);</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;      }</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    }</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160; </div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160; </div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    <span class="comment">// Now add the rectangular mesh in the channel ahead of the finger tip</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    <span class="comment">//--------------------------------------------------------------------</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160; </div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <span class="comment">// Build a temporary version of a SimpleRectangularQuadMesh as</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="comment">// a unit square</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    SimpleRectangularQuadMesh&lt;ELEMENT&gt;* aux_mesh_pt =</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;      <span class="keyword">new</span> SimpleRectangularQuadMesh&lt;ELEMENT&gt;(</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a26c57f832b7cdc495087cef7b54c98fd">Nx3</a>, 2 * nhalf, 1.0, 1.0, time_stepper_pt);</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160; </div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="comment">// Wipe the boundary information in the auxilliary mesh</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    aux_mesh_pt-&gt;remove_boundary_nodes();</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160; </div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <span class="comment">// Copy all nodes in the auxiliary mesh into a set (from where they</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <span class="comment">// can easily be removed)</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    nnod = aux_mesh_pt-&gt;nnode();</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    std::set&lt;Node*&gt; aux_node_pt;</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; nnod; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    {</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;      aux_node_pt.insert(aux_mesh_pt-&gt;node_pt(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    }</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160; </div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <span class="comment">// Loop over elements in first column and set pointers</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    <span class="comment">// to the nodes in their first column to the ones that already exist</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160; </div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    <span class="comment">// Boundary node number for first node in element</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <span class="keywordtype">unsigned</span> first_bound_node = 0;</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160; </div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <span class="comment">// Loop over elements</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; 2 * nhalf; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    {</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;      FiniteElement* el_pt = aux_mesh_pt-&gt;finite_element_pt(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> * <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a26c57f832b7cdc495087cef7b54c98fd">Nx3</a>);</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;      <span class="comment">// Loop over first column of nodes</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; np; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;      {</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;        <span class="comment">// Node number in element</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        <span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> * np;</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        <span class="comment">// Remove node from set and kill it</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; 1) || (<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &gt; 0))</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;        {</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;          aux_node_pt.erase(el_pt-&gt;node_pt(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>));</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;          <span class="keyword">delete</span> el_pt-&gt;node_pt(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>);</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;        }</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;        <span class="comment">// Set pointer to existing node</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;        el_pt-&gt;node_pt(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>) = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#aca0a21f4eab2d6fe8c7fa011b5c33c3c">boundary_node_pt</a>(1, first_bound_node + <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;      }</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160; </div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;      <span class="comment">// Increment first node number</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;      first_bound_node += np - 1;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    }</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160; </div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <span class="comment">// Now add all the remaining nodes in the auxiliary mesh</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <span class="comment">// to the actual one</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    <span class="keyword">typedef</span> std::set&lt;Node*&gt;::iterator IT;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    <span class="keywordflow">for</span> (IT it = aux_node_pt.begin(); it != aux_node_pt.end(); it++)</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    {</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;      this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a0a42111e7eb200e5831f8b73c018b7dc">Node_pt</a>.push_back(*it);</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    }</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160; </div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    <span class="comment">// Store number of elements before the new bit gets added:</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    <span class="keywordtype">unsigned</span> nelement_orig = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#aca12acfe655a4d5c4a4eab4a7b970812">Element_pt</a>.size();</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160; </div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    <span class="comment">// Add the elements to the actual mesh</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    <span class="keywordtype">unsigned</span> nelem = aux_mesh_pt-&gt;nelement();</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; nelem; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    {</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;      this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#aca12acfe655a4d5c4a4eab4a7b970812">Element_pt</a>.push_back(aux_mesh_pt-&gt;element_pt(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>));</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;      <span class="comment">// Don&#39;t forget to add them to the bulk</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;      this-&gt;<a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a207b6a5e52ce95c0a6125f56eb22b98d">Bulk_element_pt</a>.push_back(aux_mesh_pt-&gt;finite_element_pt(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>));</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    }</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160; </div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    <span class="comment">// Now wipe the boundary node storage scheme for the</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    <span class="comment">// nodes that used to be at the end of the domain:</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a8d86e14d55a1162e184bd7fac4630904">remove_boundary_nodes</a>(1);</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160; </div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160; </div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <span class="comment">// FIRST SPINE</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    <span class="comment">//-----------</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160; </div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    <span class="comment">// Element 0</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <span class="comment">// Node 0</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <span class="comment">// Assign the new spine with unit height (pinned dummy -- never used)</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    Spine* new_spine_pt = <span class="keyword">new</span> Spine(1.0);</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    this-&gt;<a class="code" href="../../d6/d74/classoomph_1_1SpineMesh.html#a4f3e5e603b61921f52a4311d347d1158">Spine_pt</a>.push_back(new_spine_pt);</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    new_spine_pt-&gt;spine_height_pt()-&gt;pin(0);</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160; </div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    <span class="comment">// Get pointer to node</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    SpineNode* nod_pt = this-&gt;<a class="code" href="../../d6/d74/classoomph_1_1SpineMesh.html#aea36e8d0454965f9f96a3adc4a5a9371">element_node_pt</a>(nelement_orig + 0, 0);</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <span class="comment">// Set the pointer to node</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    nod_pt-&gt;spine_pt() = new_spine_pt;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <span class="comment">// Set the fraction</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    nod_pt-&gt;fraction() = 0.0;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <span class="comment">// Pointer to the mesh that implements the update fct</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    nod_pt-&gt;spine_mesh_pt() = <span class="keyword">this</span>;</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    <span class="comment">// ID for the update function</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    nod_pt-&gt;node_update_fct_id() = 6;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160; </div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    <span class="comment">// Need to get the local coordinates for the upper and lower wall</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>[0] = <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a1d05bb741eba54ab7498ab4f3c55f1b7">Zeta_transition_end</a>;</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    <span class="comment">// Get the sub geometric objects</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a04c0136de66c06a34347b89f453730e1">Lower_wall_pt</a>-&gt;<a class="code" href="../../da/ddd/classoomph_1_1GeomObject.html#a78ee9f98bcfd0c5e1f07a459777663d3">locate_zeta</a>(<a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>, lower_sub_geom_object_pt, s_lo);</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a1f97e78a12000afcc1bd754102b5b51a">Upper_wall_pt</a>-&gt;<a class="code" href="../../da/ddd/classoomph_1_1GeomObject.html#a78ee9f98bcfd0c5e1f07a459777663d3">locate_zeta</a>(<a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>, upper_sub_geom_object_pt, s_up);</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160; </div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    lower_sub_geom_object_pt-&gt;position(s_lo, r_wall_lo);</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    upper_sub_geom_object_pt-&gt;position(s_up, r_wall_up);</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160; </div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <span class="comment">// Pass additional data to spine</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    Vector&lt;double&gt; parameters(2);</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    parameters[0] = s_lo[0];</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    parameters[1] = s_up[0];</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    new_spine_pt-&gt;set_geom_parameter(parameters);</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160; </div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    <span class="comment">// Lower and upper wall sub geom objects affect update</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    <span class="comment">// for spine:</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    Vector&lt;GeomObject*&gt; geom_object_pt(2);</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    geom_object_pt[0] = lower_sub_geom_object_pt;</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    geom_object_pt[1] = upper_sub_geom_object_pt;</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160; </div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    <span class="comment">// Pass geom object(s) to spine</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    new_spine_pt-&gt;set_geom_object_pt(geom_object_pt);</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160; </div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    <span class="comment">// Loop vertically along the spine</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <span class="comment">// Loop over the elements</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; 2 * nhalf; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    {</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;      <span class="comment">// Loop over the vertical nodes, apart from the first</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> l1 = 1; l1 &lt; np; l1++)</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;      {</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        <span class="comment">// Get pointer to node</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;        SpineNode* nod_pt =</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;          this-&gt;<a class="code" href="../../d6/d74/classoomph_1_1SpineMesh.html#aea36e8d0454965f9f96a3adc4a5a9371">element_node_pt</a>(nelement_orig + <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> * <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a26c57f832b7cdc495087cef7b54c98fd">Nx3</a>, l1 * np);</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        <span class="comment">// Set the pointer to the spine</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        nod_pt-&gt;spine_pt() = new_spine_pt;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        <span class="comment">// Set the fraction</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        nod_pt-&gt;fraction() =</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;          (<a class="code" href="../../df/de6/classdouble.html">double</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) + <a class="code" href="../../df/de6/classdouble.html">double</a>(l1) / <a class="code" href="../../df/de6/classdouble.html">double</a>(np - 1)) / <span class="keywordtype">double</span>(2 * nhalf);</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;        <span class="comment">// Pointer to the mesh that implements the update fct</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        nod_pt-&gt;spine_mesh_pt() = <span class="keyword">this</span>;</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;        <span class="comment">// ID for the update function</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        nod_pt-&gt;node_update_fct_id() = 6;</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;      }</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    }</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160; </div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160; </div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    <span class="comment">// LOOP OVER OTHER SPINES</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    <span class="comment">//----------------------</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160; </div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    <span class="comment">// Now loop over the elements horizontally</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a26c57f832b7cdc495087cef7b54c98fd">Nx3</a>; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    {</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;      <span class="comment">// Loop over the nodes in the elements horizontally, ignoring</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;      <span class="comment">// the first column</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> l2 = 1; l2 &lt; np; l2++)</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;      {</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;        <span class="comment">// Assign the new spine with unit height (pinned dummy; never used)</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;        new_spine_pt = <span class="keyword">new</span> Spine(1.0);</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;        this-&gt;<a class="code" href="../../d6/d74/classoomph_1_1SpineMesh.html#a4f3e5e603b61921f52a4311d347d1158">Spine_pt</a>.push_back(new_spine_pt);</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;        new_spine_pt-&gt;spine_height_pt()-&gt;pin(0);</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160; </div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        <span class="comment">// Get the node</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        SpineNode* nod_pt = this-&gt;<a class="code" href="../../d6/d74/classoomph_1_1SpineMesh.html#aea36e8d0454965f9f96a3adc4a5a9371">element_node_pt</a>(nelement_orig + <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, l2);</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;        <span class="comment">// Set the pointer to the spine</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        nod_pt-&gt;spine_pt() = new_spine_pt;</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;        <span class="comment">// Set the fraction</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;        nod_pt-&gt;fraction() = 0.0;</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        <span class="comment">// Pointer to the mesh that implements the update fct</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        nod_pt-&gt;spine_mesh_pt() = <span class="keyword">this</span>;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;        <span class="comment">// ID for the update function</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;        nod_pt-&gt;node_update_fct_id() = 6;</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160; </div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;        <span class="comment">// Add to boundary lookup scheme</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;        this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a007b102ac8e42328872ad658d7110bfc">add_boundary_node</a>(0, nod_pt);</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> == <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a26c57f832b7cdc495087cef7b54c98fd">Nx3</a> - 1) &amp;&amp; (l2 == np - 1))</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;        {</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;          this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a007b102ac8e42328872ad658d7110bfc">add_boundary_node</a>(1, nod_pt);</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;        }</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160; </div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;        <span class="comment">// Increment in wall coordinate</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;        <span class="keywordtype">double</span> dzeta_el = (<a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#ac1b5e005bfb5db65f54ca599942126ea">Zeta_end</a> - <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a1d05bb741eba54ab7498ab4f3c55f1b7">Zeta_transition_end</a>) / <span class="keywordtype">double</span>(<a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a26c57f832b7cdc495087cef7b54c98fd">Nx3</a>);</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;        <span class="keywordtype">double</span> dzeta_nod = dzeta_el / <a class="code" href="../../df/de6/classdouble.html">double</a>(np - 1);</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160; </div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;        <span class="comment">// Get wall coordinate</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;        <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>[0] = <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a1d05bb741eba54ab7498ab4f3c55f1b7">Zeta_transition_end</a> + <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> * dzeta_el + l2 * dzeta_nod;</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160; </div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;        <span class="comment">// Get the sub geometric objects</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;        <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a04c0136de66c06a34347b89f453730e1">Lower_wall_pt</a>-&gt;<a class="code" href="../../da/ddd/classoomph_1_1GeomObject.html#a78ee9f98bcfd0c5e1f07a459777663d3">locate_zeta</a>(<a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>, lower_sub_geom_object_pt, s_lo);</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;        <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a1f97e78a12000afcc1bd754102b5b51a">Upper_wall_pt</a>-&gt;<a class="code" href="../../da/ddd/classoomph_1_1GeomObject.html#a78ee9f98bcfd0c5e1f07a459777663d3">locate_zeta</a>(<a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>, upper_sub_geom_object_pt, s_up);</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160; </div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;        lower_sub_geom_object_pt-&gt;position(s_lo, r_wall_lo);</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;        upper_sub_geom_object_pt-&gt;position(s_up, r_wall_up);</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160; </div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;        <span class="comment">// Add geometric parameters to spine</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;        Vector&lt;double&gt; parameters(2);</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;        parameters[0] = s_lo[0];</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;        parameters[1] = s_up[0];</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;        new_spine_pt-&gt;set_geom_parameter(parameters);</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160; </div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;        <span class="comment">// Lower and upper sub geom objects affect update</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;        <span class="comment">// for spine:</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;        Vector&lt;GeomObject*&gt; geom_object_pt(2);</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;        geom_object_pt[0] = lower_sub_geom_object_pt;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;        geom_object_pt[1] = upper_sub_geom_object_pt;</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160; </div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;        <span class="comment">// Pass geom object(s) to spine</span></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        new_spine_pt-&gt;set_geom_object_pt(geom_object_pt);</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160; </div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160; </div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        <span class="comment">// Loop vertically along the spine</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        <span class="comment">// Loop over the elements</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; 2 * nhalf; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        {</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;          <span class="comment">// Loop over the vertical nodes, apart from the first</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> l1 = 1; l1 &lt; np; l1++)</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;          {</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;            <span class="comment">// Get node</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;            SpineNode* nod_pt =</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;              this-&gt;<a class="code" href="../../d6/d74/classoomph_1_1SpineMesh.html#aea36e8d0454965f9f96a3adc4a5a9371">element_node_pt</a>(nelement_orig + <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> * <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a26c57f832b7cdc495087cef7b54c98fd">Nx3</a> + <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, l1 * np + l2);</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;            <span class="comment">// Set the pointer to the spine</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;            nod_pt-&gt;spine_pt() = new_spine_pt;</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;            <span class="comment">// Set the fraction</span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;            nod_pt-&gt;fraction() =</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;              (<a class="code" href="../../df/de6/classdouble.html">double</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) + <a class="code" href="../../df/de6/classdouble.html">double</a>(l1) / <a class="code" href="../../df/de6/classdouble.html">double</a>(np - 1)) / <span class="keywordtype">double</span>(2 * nhalf);</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;            <span class="comment">// Pointer to the mesh that implements the update fct</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;            nod_pt-&gt;spine_mesh_pt() = <span class="keyword">this</span>;</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;            <span class="comment">// ID for the update function</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;            nod_pt-&gt;node_update_fct_id() = 6;</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160; </div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;            <span class="comment">// Add to boundary lookup scheme</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;            <span class="keywordflow">if</span> ((<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> == <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a26c57f832b7cdc495087cef7b54c98fd">Nx3</a> - 1) &amp;&amp; (l2 == np - 1))</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;            {</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;              this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a007b102ac8e42328872ad658d7110bfc">add_boundary_node</a>(1, nod_pt);</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;            }</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160; </div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;            <span class="comment">// Add to boundary lookup scheme</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;            <span class="keywordflow">if</span> ((<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> == 2 * nhalf - 1) &amp;&amp; (l1 == np - 1))</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;            {</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;              this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a007b102ac8e42328872ad658d7110bfc">add_boundary_node</a>(2, nod_pt);</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;            }</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;          }</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        }</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;      }</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    }</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160; </div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    <span class="comment">// (Re-)setup lookup scheme that establishes which elements are located</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    <span class="comment">// on the mesh boundaries</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a6cc8bcd6b41209f0e9295cc993d9c6bb">setup_boundary_element_info</a>();</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160; </div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    <span class="comment">// Flush the storage for elements and nodes in the auxiliary mesh</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    <span class="comment">// so it can be safely deleted</span></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    aux_mesh_pt-&gt;flush_element_and_node_storage();</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160; </div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    <span class="comment">// Kill the auxiliary mesh</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    <span class="keyword">delete</span> aux_mesh_pt;</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;  }</div>
<div class="ttc" id="aAnnoyingScalar_8h_html_abe7b2405f1f05f9997193c680e8e2fe0"><div class="ttname"><a href="../../d8/de9/AnnoyingScalar_8h.html#abe7b2405f1f05f9997193c680e8e2fe0">sqrt</a></div><div class="ttdeci">AnnoyingScalar sqrt(const AnnoyingScalar &amp;x)</div><div class="ttdef"><b>Definition:</b> AnnoyingScalar.h:134</div></div>
<div class="ttc" id="aBiCGSTAB__step__by__step_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> BiCGSTAB_step_by_step.cpp:9</div></div>
<div class="ttc" id="aCG3DPackingUnitTest_8cpp_html_a7026fd16370249ce97cb3d062326baf9"><div class="ttname"><a href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a></div><div class="ttdeci">const unsigned n</div><div class="ttdef"><b>Definition:</b> CG3DPackingUnitTest.cpp:11</div></div>
<div class="ttc" id="aCwise__array__power__array_8cpp_html_a9eb5e92d9d691c1393e5e7c914731dbf"><div class="ttname"><a href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a></div><div class="ttdeci">Array&lt; double, 1, 3 &gt; e(1./3., 0.5, 2.)</div></div>
<div class="ttc" id="aclassdouble_html"><div class="ttname"><a href="../../df/de6/classdouble.html">double</a></div></div>
<div class="ttc" id="aclassoomph_1_1BrethertonSpineMesh_html_a04c0136de66c06a34347b89f453730e1"><div class="ttname"><a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a04c0136de66c06a34347b89f453730e1">oomph::BrethertonSpineMesh::Lower_wall_pt</a></div><div class="ttdeci">GeomObject * Lower_wall_pt</div><div class="ttdoc">Pointer to geometric object that represents the lower wall.</div><div class="ttdef"><b>Definition:</b> bretherton_spine_mesh.template.h:517</div></div>
<div class="ttc" id="aclassoomph_1_1BrethertonSpineMesh_html_a0f41083aa9a97fca03d498bd6ec21eb2"><div class="ttname"><a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a0f41083aa9a97fca03d498bd6ec21eb2">oomph::BrethertonSpineMesh::Zeta_start</a></div><div class="ttdeci">double Zeta_start</div><div class="ttdoc">Start coordinate on wall.</div><div class="ttdef"><b>Definition:</b> bretherton_spine_mesh.template.h:520</div></div>
<div class="ttc" id="aclassoomph_1_1BrethertonSpineMesh_html_a1d05bb741eba54ab7498ab4f3c55f1b7"><div class="ttname"><a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a1d05bb741eba54ab7498ab4f3c55f1b7">oomph::BrethertonSpineMesh::Zeta_transition_end</a></div><div class="ttdeci">double Zeta_transition_end</div><div class="ttdoc">Wall coordinate of end of transition region.</div><div class="ttdef"><b>Definition:</b> bretherton_spine_mesh.template.h:529</div></div>
<div class="ttc" id="aclassoomph_1_1BrethertonSpineMesh_html_a1e58d18dd2231c785008efa07260e8da"><div class="ttname"><a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a1e58d18dd2231c785008efa07260e8da">oomph::BrethertonSpineMesh::Nhalf</a></div><div class="ttdeci">unsigned Nhalf</div><div class="ttdef"><b>Definition:</b> bretherton_spine_mesh.template.h:505</div></div>
<div class="ttc" id="aclassoomph_1_1BrethertonSpineMesh_html_a1f97e78a12000afcc1bd754102b5b51a"><div class="ttname"><a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a1f97e78a12000afcc1bd754102b5b51a">oomph::BrethertonSpineMesh::Upper_wall_pt</a></div><div class="ttdeci">GeomObject * Upper_wall_pt</div><div class="ttdoc">Pointer to geometric object that represents the upper wall.</div><div class="ttdef"><b>Definition:</b> bretherton_spine_mesh.template.h:514</div></div>
<div class="ttc" id="aclassoomph_1_1BrethertonSpineMesh_html_a207b6a5e52ce95c0a6125f56eb22b98d"><div class="ttname"><a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a207b6a5e52ce95c0a6125f56eb22b98d">oomph::BrethertonSpineMesh::Bulk_element_pt</a></div><div class="ttdeci">Vector&lt; FiniteElement * &gt; Bulk_element_pt</div><div class="ttdoc">Vector of pointers to element in the fluid layer.</div><div class="ttdef"><b>Definition:</b> bretherton_spine_mesh.template.h:543</div></div>
<div class="ttc" id="aclassoomph_1_1BrethertonSpineMesh_html_a237b4f516eb3f74e42e190f2a23f93c3"><div class="ttname"><a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a237b4f516eb3f74e42e190f2a23f93c3">oomph::BrethertonSpineMesh::Nx2</a></div><div class="ttdeci">unsigned Nx2</div><div class="ttdoc">Number of elements along wall in horizontal transition region.</div><div class="ttdef"><b>Definition:</b> bretherton_spine_mesh.template.h:498</div></div>
<div class="ttc" id="aclassoomph_1_1BrethertonSpineMesh_html_a26c57f832b7cdc495087cef7b54c98fd"><div class="ttname"><a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a26c57f832b7cdc495087cef7b54c98fd">oomph::BrethertonSpineMesh::Nx3</a></div><div class="ttdeci">unsigned Nx3</div><div class="ttdoc">Number of elements along wall in channel region.</div><div class="ttdef"><b>Definition:</b> bretherton_spine_mesh.template.h:501</div></div>
<div class="ttc" id="aclassoomph_1_1BrethertonSpineMesh_html_a306cf8ae8f91a81054904de64195bb16"><div class="ttname"><a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a306cf8ae8f91a81054904de64195bb16">oomph::BrethertonSpineMesh::Default_spine_centre_fraction</a></div><div class="ttdeci">double Default_spine_centre_fraction</div><div class="ttdoc">Default spine fraction.</div><div class="ttdef"><b>Definition:</b> bretherton_spine_mesh.template.h:535</div></div>
<div class="ttc" id="aclassoomph_1_1BrethertonSpineMesh_html_a3d711e1bc9d751ab14662f6839a900e3"><div class="ttname"><a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a3d711e1bc9d751ab14662f6839a900e3">oomph::BrethertonSpineMesh::H</a></div><div class="ttdeci">double H</div><div class="ttdoc">Thickness of deposited film.</div><div class="ttdef"><b>Definition:</b> bretherton_spine_mesh.template.h:511</div></div>
<div class="ttc" id="aclassoomph_1_1BrethertonSpineMesh_html_a4ba20dfa61b6c342f2defbc0cdb47851"><div class="ttname"><a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a4ba20dfa61b6c342f2defbc0cdb47851">oomph::BrethertonSpineMesh::Nh</a></div><div class="ttdeci">unsigned Nh</div><div class="ttdoc">Number of elements across the deposited film.</div><div class="ttdef"><b>Definition:</b> bretherton_spine_mesh.template.h:508</div></div>
<div class="ttc" id="aclassoomph_1_1BrethertonSpineMesh_html_a52ffe1a705cb720d09c831b9cf5397f6"><div class="ttname"><a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a52ffe1a705cb720d09c831b9cf5397f6">oomph::BrethertonSpineMesh::initial_element_reorder</a></div><div class="ttdeci">void initial_element_reorder()</div><div class="ttdef"><b>Definition:</b> bretherton_spine_mesh.template.cc:1028</div></div>
<div class="ttc" id="aclassoomph_1_1BrethertonSpineMesh_html_a67f784e7b3a898af6c60515042c3ea73"><div class="ttname"><a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a67f784e7b3a898af6c60515042c3ea73">oomph::BrethertonSpineMesh::spine_centre_fraction</a></div><div class="ttdeci">double spine_centre_fraction() const</div><div class="ttdoc">Read the value of the spine centre's vertical fraction.</div><div class="ttdef"><b>Definition:</b> bretherton_spine_mesh.template.h:194</div></div>
<div class="ttc" id="aclassoomph_1_1BrethertonSpineMesh_html_a7422b912ff7ad780777205f0cbe83362"><div class="ttname"><a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a7422b912ff7ad780777205f0cbe83362">oomph::BrethertonSpineMesh::Interface_element_pt</a></div><div class="ttdeci">Vector&lt; FiniteElement * &gt; Interface_element_pt</div><div class="ttdoc">Vector of pointers to interface elements.</div><div class="ttdef"><b>Definition:</b> bretherton_spine_mesh.template.h:546</div></div>
<div class="ttc" id="aclassoomph_1_1BrethertonSpineMesh_html_a81ee86c0c747947dab52073c221d53c1"><div class="ttname"><a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a81ee86c0c747947dab52073c221d53c1">oomph::BrethertonSpineMesh::Control_element_pt</a></div><div class="ttdeci">ELEMENT * Control_element_pt</div><div class="ttdef"><b>Definition:</b> bretherton_spine_mesh.template.h:540</div></div>
<div class="ttc" id="aclassoomph_1_1BrethertonSpineMesh_html_ac1b5e005bfb5db65f54ca599942126ea"><div class="ttname"><a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#ac1b5e005bfb5db65f54ca599942126ea">oomph::BrethertonSpineMesh::Zeta_end</a></div><div class="ttdeci">double Zeta_end</div><div class="ttdoc">Wall coordinate of end of liquid filled region (inflow)</div><div class="ttdef"><b>Definition:</b> bretherton_spine_mesh.template.h:523</div></div>
<div class="ttc" id="aclassoomph_1_1BrethertonSpineMesh_html_af5e7951a89bc13d73f2b137947cda8a3"><div class="ttname"><a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#af5e7951a89bc13d73f2b137947cda8a3">oomph::BrethertonSpineMesh::Spine_centre_fraction_pt</a></div><div class="ttdeci">double * Spine_centre_fraction_pt</div><div class="ttdoc">Pointer to vertical fraction of the spine centre.</div><div class="ttdef"><b>Definition:</b> bretherton_spine_mesh.template.h:532</div></div>
<div class="ttc" id="aclassoomph_1_1BrethertonSpineMesh_html_af6ef10fb80559c3ad27a50116da60dcc"><div class="ttname"><a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#af6ef10fb80559c3ad27a50116da60dcc">oomph::BrethertonSpineMesh::Nx1</a></div><div class="ttdeci">unsigned Nx1</div><div class="ttdoc">Number of elements along wall in deposited film region.</div><div class="ttdef"><b>Definition:</b> bretherton_spine_mesh.template.h:495</div></div>
<div class="ttc" id="aclassoomph_1_1BrethertonSpineMesh_html_af701937d59d7804f40cb1b4c7a262391"><div class="ttname"><a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#af701937d59d7804f40cb1b4c7a262391">oomph::BrethertonSpineMesh::Zeta_transition_start</a></div><div class="ttdeci">double Zeta_transition_start</div><div class="ttdoc">Wall coordinate of start of the transition region.</div><div class="ttdef"><b>Definition:</b> bretherton_spine_mesh.template.h:526</div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a6219ed269a6d89b5aa14659cce48905a"><div class="ttname"><a href="../../d2/dc6/classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">oomph::FiniteElement::nnode</a></div><div class="ttdeci">unsigned nnode() const</div><div class="ttdoc">Return the number of nodes.</div><div class="ttdef"><b>Definition:</b> elements.h:2210</div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_ab65c7a94dda80c1876a09ac12be4e39c"><div class="ttname"><a href="../../d2/dc6/classoomph_1_1FiniteElement.html#ab65c7a94dda80c1876a09ac12be4e39c">oomph::FiniteElement::nnode_1d</a></div><div class="ttdeci">virtual unsigned nnode_1d() const</div><div class="ttdef"><b>Definition:</b> elements.h:2218</div></div>
<div class="ttc" id="aclassoomph_1_1GeomObject_html_a0d04c9d4667817f3ef24bb660fd56065"><div class="ttname"><a href="../../da/ddd/classoomph_1_1GeomObject.html#a0d04c9d4667817f3ef24bb660fd56065">oomph::GeomObject::position</a></div><div class="ttdeci">virtual void position(const Vector&lt; double &gt; &amp;zeta, Vector&lt; double &gt; &amp;r) const =0</div><div class="ttdoc">Parametrised position on object at current time: r(zeta).</div></div>
<div class="ttc" id="aclassoomph_1_1GeomObject_html_a78ee9f98bcfd0c5e1f07a459777663d3"><div class="ttname"><a href="../../da/ddd/classoomph_1_1GeomObject.html#a78ee9f98bcfd0c5e1f07a459777663d3">oomph::GeomObject::locate_zeta</a></div><div class="ttdeci">virtual void locate_zeta(const Vector&lt; double &gt; &amp;zeta, GeomObject *&amp;sub_geom_object_pt, Vector&lt; double &gt; &amp;s, const bool &amp;use_coordinate_as_initial_guess=false)</div><div class="ttdef"><b>Definition:</b> geom_objects.h:381</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_a007b102ac8e42328872ad658d7110bfc"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#a007b102ac8e42328872ad658d7110bfc">oomph::Mesh::add_boundary_node</a></div><div class="ttdeci">void add_boundary_node(const unsigned &amp;b, Node *const &amp;node_pt)</div><div class="ttdoc">Add a (pointer to) a node to the b-th boundary.</div><div class="ttdef"><b>Definition:</b> mesh.cc:243</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_a034677ceb48c67769acb83f304c84f7d"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#a034677ceb48c67769acb83f304c84f7d">oomph::Mesh::nboundary_node</a></div><div class="ttdeci">unsigned long nboundary_node(const unsigned &amp;ibound) const</div><div class="ttdoc">Return number of nodes on a particular boundary.</div><div class="ttdef"><b>Definition:</b> mesh.h:833</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_a0a42111e7eb200e5831f8b73c018b7dc"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#a0a42111e7eb200e5831f8b73c018b7dc">oomph::Mesh::Node_pt</a></div><div class="ttdeci">Vector&lt; Node * &gt; Node_pt</div><div class="ttdoc">Vector of pointers to nodes.</div><div class="ttdef"><b>Definition:</b> mesh.h:183</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_a4f274774435e9454bf77bf70de69367a"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#a4f274774435e9454bf77bf70de69367a">oomph::Mesh::finite_element_pt</a></div><div class="ttdeci">FiniteElement * finite_element_pt(const unsigned &amp;e) const</div><div class="ttdef"><b>Definition:</b> mesh.h:473</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_a6667f4ddc6e9357a9a7d53160db8161e"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#a6667f4ddc6e9357a9a7d53160db8161e">oomph::Mesh::set_nboundary</a></div><div class="ttdeci">void set_nboundary(const unsigned &amp;nbound)</div><div class="ttdoc">Set the number of boundaries in the mesh.</div><div class="ttdef"><b>Definition:</b> mesh.h:505</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_a6cc8bcd6b41209f0e9295cc993d9c6bb"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#a6cc8bcd6b41209f0e9295cc993d9c6bb">oomph::Mesh::setup_boundary_element_info</a></div><div class="ttdeci">virtual void setup_boundary_element_info()</div><div class="ttdef"><b>Definition:</b> mesh.h:275</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_a8d86e14d55a1162e184bd7fac4630904"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#a8d86e14d55a1162e184bd7fac4630904">oomph::Mesh::remove_boundary_nodes</a></div><div class="ttdeci">void remove_boundary_nodes()</div><div class="ttdoc">Clear all pointers to boundary nodes.</div><div class="ttdef"><b>Definition:</b> mesh.cc:204</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_ab28b03dabf4e247c4a25f834eb11b339"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#ab28b03dabf4e247c4a25f834eb11b339">oomph::Mesh::element_pt</a></div><div class="ttdeci">const Vector&lt; GeneralisedElement * &gt; &amp; element_pt() const</div><div class="ttdoc">Return reference to the Vector of elements.</div><div class="ttdef"><b>Definition:</b> mesh.h:460</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_aca0a21f4eab2d6fe8c7fa011b5c33c3c"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#aca0a21f4eab2d6fe8c7fa011b5c33c3c">oomph::Mesh::boundary_node_pt</a></div><div class="ttdeci">Node *&amp; boundary_node_pt(const unsigned &amp;b, const unsigned &amp;n)</div><div class="ttdoc">Return pointer to node n on boundary b.</div><div class="ttdef"><b>Definition:</b> mesh.h:493</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_aca12acfe655a4d5c4a4eab4a7b970812"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#aca12acfe655a4d5c4a4eab4a7b970812">oomph::Mesh::Element_pt</a></div><div class="ttdeci">Vector&lt; GeneralisedElement * &gt; Element_pt</div><div class="ttdoc">Vector of pointers to generalised elements.</div><div class="ttdef"><b>Definition:</b> mesh.h:186</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_af01dfefb66c15579b540be62999d93ee"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">oomph::Mesh::nelement</a></div><div class="ttdeci">unsigned long nelement() const</div><div class="ttdoc">Return number of elements in the mesh.</div><div class="ttdef"><b>Definition:</b> mesh.h:590</div></div>
<div class="ttc" id="aclassoomph_1_1Node_html_a056f8e82da938369cd38541c5cdc598a"><div class="ttname"><a href="../../dc/db7/classoomph_1_1Node.html#a056f8e82da938369cd38541c5cdc598a">oomph::Node::x</a></div><div class="ttdeci">double &amp; x(const unsigned &amp;i)</div><div class="ttdoc">Return the i-th nodal coordinate.</div><div class="ttdef"><b>Definition:</b> nodes.h:1060</div></div>
<div class="ttc" id="aclassoomph_1_1Node_html_a94c19e165ab4e88aabbfa27443c530b7"><div class="ttname"><a href="../../dc/db7/classoomph_1_1Node.html#a94c19e165ab4e88aabbfa27443c530b7">oomph::Node::set_coordinates_on_boundary</a></div><div class="ttdeci">virtual void set_coordinates_on_boundary(const unsigned &amp;b, const unsigned &amp;k, const Vector&lt; double &gt; &amp;boundary_zeta)</div><div class="ttdef"><b>Definition:</b> nodes.cc:2394</div></div>
<div class="ttc" id="aclassoomph_1_1SpineMesh_html_a4f3e5e603b61921f52a4311d347d1158"><div class="ttname"><a href="../../d6/d74/classoomph_1_1SpineMesh.html#a4f3e5e603b61921f52a4311d347d1158">oomph::SpineMesh::Spine_pt</a></div><div class="ttdeci">Vector&lt; Spine * &gt; Spine_pt</div><div class="ttdoc">A Spine mesh contains a Vector of pointers to spines.</div><div class="ttdef"><b>Definition:</b> spines.h:616</div></div>
<div class="ttc" id="aclassoomph_1_1SpineMesh_html_aea36e8d0454965f9f96a3adc4a5a9371"><div class="ttname"><a href="../../d6/d74/classoomph_1_1SpineMesh.html#aea36e8d0454965f9f96a3adc4a5a9371">oomph::SpineMesh::element_node_pt</a></div><div class="ttdeci">SpineNode * element_node_pt(const unsigned long &amp;e, const unsigned &amp;n)</div><div class="ttdef"><b>Definition:</b> spines.h:669</div></div>
<div class="ttc" id="aconstructor_8cpp_html_a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702"><div class="ttname"><a href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a></div><div class="ttdeci">@ N</div><div class="ttdef"><b>Definition:</b> constructor.cpp:22</div></div>
<div class="ttc" id="anamespaceEigen_html_a119e06d0109a8812d63acbf9a15c6a88"><div class="ttname"><a href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">Eigen::zeta</a></div><div class="ttdeci">EIGEN_STRONG_INLINE const Eigen::CwiseBinaryOp&lt; Eigen::internal::scalar_zeta_op&lt; typename DerivedX::Scalar &gt;, const DerivedX, const DerivedQ &gt; zeta(const Eigen::ArrayBase&lt; DerivedX &gt; &amp;x, const Eigen::ArrayBase&lt; DerivedQ &gt; &amp;q)</div><div class="ttdef"><b>Definition:</b> SpecialFunctionsArrayAPI.h:152</div></div>
<div class="ttc" id="anamespaceGlobalParameters_html_a48941328f0bded62ed7a778062b03dd7"><div class="ttname"><a href="../../d9/d37/namespaceGlobalParameters.html#a48941328f0bded62ed7a778062b03dd7">GlobalParameters::S0</a></div><div class="ttdeci">double S0</div><div class="ttdoc">Strength of source function in inner region.</div><div class="ttdef"><b>Definition:</b> stefan_boltzmann.cc:148</div></div>
<div class="ttc" id="anamespaceUniformPSDSelfTest_html_ab2a01330429b8f42b72cc01f29f1beeb"><div class="ttname"><a href="../../de/d6c/namespaceUniformPSDSelfTest.html#ab2a01330429b8f42b72cc01f29f1beeb">UniformPSDSelfTest.radius</a></div><div class="ttdeci">radius</div><div class="ttdef"><b>Definition:</b> UniformPSDSelfTest.py:15</div></div>
<div class="ttc" id="anamespaceboost_1_1multiprecision_html_ab6f80ccf8e1d88df8a8e3acd039d63eb"><div class="ttname"><a href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">boost::multiprecision::fabs</a></div><div class="ttdeci">Real fabs(const Real &amp;a)</div><div class="ttdef"><b>Definition:</b> boostmultiprec.cpp:117</div></div>
<div class="ttc" id="anamespaceoomph_html_aec474227917784dc0a255faf289cfc16"><div class="ttname"><a href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a></div><div class="ttdeci">OomphInfo oomph_info</div><div class="ttdef"><b>Definition:</b> oomph_definitions.cc:319</div></div>
<div class="ttc" id="atut__arithmetic__redux__minmax_8cpp_html_a39513f0f8d942bf9ef17b2e87ac6d34e"><div class="ttname"><a href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a></div><div class="ttdeci">std::ptrdiff_t j</div><div class="ttdef"><b>Definition:</b> tut_arithmetic_redux_minmax.cpp:2</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a93770708eb4769c481d2f811f18f005c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93770708eb4769c481d2f811f18f005c">&#9670;&nbsp;</a></span>bulk_element_pt()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT , class INTERFACE_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html">FiniteElement</a>*&amp; <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html">oomph::BrethertonSpineMesh</a>&lt; ELEMENT, INTERFACE_ELEMENT &gt;::bulk_element_pt </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long &amp;&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Access functions for pointers to elements in bulk. </p>
<div class="fragment"><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    {</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a207b6a5e52ce95c0a6125f56eb22b98d">Bulk_element_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a207b6a5e52ce95c0a6125f56eb22b98d">oomph::BrethertonSpineMesh&lt; ELEMENT, INTERFACE_ELEMENT &gt;::Bulk_element_pt</a>, and <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>.</p>

</div>
</div>
<a id="a9b02893724c76098f75d9285e9985f4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b02893724c76098f75d9285e9985f4b">&#9670;&nbsp;</a></span>control_element_pt()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT , class INTERFACE_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ELEMENT* <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html">oomph::BrethertonSpineMesh</a>&lt; ELEMENT, INTERFACE_ELEMENT &gt;::control_element_pt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Pointer to control element (just under the symmetry line near the bubble tip, so the bubble tip is located at s=[1.0,1.0] in this element. </p>
<div class="fragment"><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a81ee86c0c747947dab52073c221d53c1">Control_element_pt</a>;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a81ee86c0c747947dab52073c221d53c1">oomph::BrethertonSpineMesh&lt; ELEMENT, INTERFACE_ELEMENT &gt;::Control_element_pt</a>.</p>

</div>
</div>
<a id="ac80488ae4db2da00e1b38f6f07e0ff9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac80488ae4db2da00e1b38f6f07e0ff9d">&#9670;&nbsp;</a></span>find_distance_to_free_surface()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT , class INTERFACE_ELEMENT &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html">oomph::BrethertonSpineMesh</a>&lt; ELEMENT, INTERFACE_ELEMENT &gt;::find_distance_to_free_surface </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../da/ddd/classoomph_1_1GeomObject.html">GeomObject</a> *const &amp;&#160;</td>
          <td class="paramname"><em>fs_geom_object_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>initial_zeta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>spine_base</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>spine_end</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Recalculate the spine lengths after repositioning. </p>
<p>Calculate the distance from the spine base to the free surface, i.e. the spine height. </p>
<div class="fragment"><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;  {</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    <span class="comment">// Now we need to find the intersection points</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d6/d41/ComplexEigenSolver__compute_8cpp.html#a8a21c18d4aa23228bc1b89f9b12182be">lambda</a> = 0.5;</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160; </div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    Vector&lt;double&gt; dx(2);</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    Vector&lt;double&gt; new_free_x(2);</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    DenseDoubleMatrix jacobian(2, 2, 0.0);</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    Vector&lt;double&gt; spine_x(2);</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    Vector&lt;double&gt; free_x(2);</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160; </div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    <span class="keywordtype">double</span> maxres = 100.0;</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160; </div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    <span class="keywordtype">unsigned</span> count = 0;</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    <span class="comment">// Let&#39;s Newton method it</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    <span class="keywordflow">do</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    {</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;      count++;</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;      <span class="comment">// Find the spine&#39;s location</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; 2; ++<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;      {</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;        spine_x[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = spine_base[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] + <a class="code" href="../../d6/d41/ComplexEigenSolver__compute_8cpp.html#a8a21c18d4aa23228bc1b89f9b12182be">lambda</a> * (spine_end[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] - spine_base[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;      }</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160; </div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;      <span class="comment">// Find the free_surface location</span></div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;      fs_geom_object_pt-&gt;position(initial_zeta, free_x);</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160; </div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; 2; ++<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;      {</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;        dx[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = spine_x[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] - free_x[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;      }</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160; </div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;      <span class="comment">// Calculate the entries of the jacobian matrix</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;      jacobian(0, 0) = (spine_end[0] - spine_base[0]);</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;      jacobian(1, 0) = (spine_end[1] - spine_base[1]);</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160; </div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;      <span class="comment">// Calculate the others by finite differences</span></div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;      <span class="keywordtype">double</span> FD_Jstep = 1.0e-6;</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;      <span class="keywordtype">double</span> old_zeta = initial_zeta[0];</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;      initial_zeta[0] += FD_Jstep;</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;      fs_geom_object_pt-&gt;position(initial_zeta, new_free_x);</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160; </div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; 2; ++<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;      {</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;        jacobian(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, 1) = (free_x[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] - new_free_x[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]) / FD_Jstep;</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;      }</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160; </div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;      <span class="comment">// Now let&#39;s solve the damn thing</span></div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;      jacobian.solve(dx);</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160; </div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;      <a class="code" href="../../d6/d41/ComplexEigenSolver__compute_8cpp.html#a8a21c18d4aa23228bc1b89f9b12182be">lambda</a> -= dx[0];</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;      initial_zeta[0] = old_zeta - dx[1];</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160; </div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;      <span class="comment">// How are we doing</span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160; </div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; 2; ++<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;      {</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;        spine_x[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = spine_base[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] + <a class="code" href="../../d6/d41/ComplexEigenSolver__compute_8cpp.html#a8a21c18d4aa23228bc1b89f9b12182be">lambda</a> * (spine_end[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] - spine_base[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;      }</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;      fs_geom_object_pt-&gt;position(initial_zeta, free_x);</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160; </div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; 2; ++<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;      {</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;        dx[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = spine_x[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] - free_x[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;      }</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;      maxres = <a class="code" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">std::fabs</a>(dx[0]) &gt; <a class="code" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">std::fabs</a>(dx[1]) ? <a class="code" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">std::fabs</a>(dx[0]) :</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;                                                     std::<a class="code" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">fabs</a>(dx[1]);</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160; </div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;      <span class="keywordflow">if</span> (count &gt; 100)</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;      {</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(<span class="stringliteral">&quot;Failed to converge after 100 steps&quot;</span>,</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;      }</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160; </div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    } <span class="keywordflow">while</span> (maxres &gt; 1.0e-8);</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160; </div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160; </div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;    <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;DONE &quot;</span> &lt;&lt; initial_zeta[0] &lt;&lt; std::endl;</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;    <span class="keywordtype">double</span> spine_length = <a class="code" href="../../d8/de9/AnnoyingScalar_8h.html#abe7b2405f1f05f9997193c680e8e2fe0">sqrt</a>(<a class="code" href="../../db/d6f/namespaceEigen_1_1bfloat16__impl.html#aadf08601dbe94964a06487ba453a0436">pow</a>((spine_base[0] - spine_end[0]), 2.0) +</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;                               <a class="code" href="../../db/d6f/namespaceEigen_1_1bfloat16__impl.html#aadf08601dbe94964a06487ba453a0436">pow</a>((spine_base[1] - spine_end[1]), 2.0));</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160; </div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    <span class="keywordflow">return</span> (<a class="code" href="../../d6/d41/ComplexEigenSolver__compute_8cpp.html#a8a21c18d4aa23228bc1b89f9b12182be">lambda</a> * spine_length); <span class="comment">// Divided by spine length</span></div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;  }</div>
<div class="ttc" id="aComplexEigenSolver__compute_8cpp_html_a8a21c18d4aa23228bc1b89f9b12182be"><div class="ttname"><a href="../../d6/d41/ComplexEigenSolver__compute_8cpp.html#a8a21c18d4aa23228bc1b89f9b12182be">lambda</a></div><div class="ttdeci">cout&lt;&lt; &quot;The eigenvalues of A are:&quot;&lt;&lt; endl&lt;&lt; ces.eigenvalues()&lt;&lt; endl;cout&lt;&lt; &quot;The matrix of eigenvectors, V, is:&quot;&lt;&lt; endl&lt;&lt; ces.eigenvectors()&lt;&lt; endl&lt;&lt; endl;complex&lt; float &gt; lambda</div><div class="ttdef"><b>Definition:</b> ComplexEigenSolver_compute.cpp:9</div></div>
<div class="ttc" id="anamespaceEigen_1_1bfloat16__impl_html_aadf08601dbe94964a06487ba453a0436"><div class="ttname"><a href="../../db/d6f/namespaceEigen_1_1bfloat16__impl.html#aadf08601dbe94964a06487ba453a0436">Eigen::bfloat16_impl::pow</a></div><div class="ttdeci">EIGEN_STRONG_INLINE EIGEN_DEVICE_FUNC bfloat16 pow(const bfloat16 &amp;a, const bfloat16 &amp;b)</div><div class="ttdef"><b>Definition:</b> BFloat16.h:625</div></div>
<div class="ttc" id="aoomph__definitions_8h_html_a25c6813cc7341d125e2502f8923fb6c4"><div class="ttname"><a href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a></div><div class="ttdeci">#define OOMPH_EXCEPTION_LOCATION</div><div class="ttdef"><b>Definition:</b> oomph_definitions.h:61</div></div>
<div class="ttc" id="aoomph__definitions_8h_html_aa260cc4af589e30cea7fde997ae16667"><div class="ttname"><a href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a></div><div class="ttdeci">#define OOMPH_CURRENT_FUNCTION</div><div class="ttdef"><b>Definition:</b> oomph_definitions.h:86</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">boost::multiprecision::fabs()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../d6/d41/ComplexEigenSolver__compute_8cpp.html#a8a21c18d4aa23228bc1b89f9b12182be">lambda</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, <a class="el" href="../../da/ddd/classoomph_1_1GeomObject.html#a0d04c9d4667817f3ef24bb660fd56065">oomph::GeomObject::position()</a>, <a class="el" href="../../dc/d5d/classEigen_1_1ArrayBase.html#ae88c21100861b1cebec61f7db1e5b8e6">Eigen::ArrayBase&lt; Derived &gt;::pow()</a>, <a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a4d445c4a1204da569f40ec1bdace9ef3">oomph::DoubleMatrixBase::solve()</a>, and <a class="el" href="../../d8/de9/AnnoyingScalar_8h.html#abe7b2405f1f05f9997193c680e8e2fe0">sqrt()</a>.</p>

</div>
</div>
<a id="a52ffe1a705cb720d09c831b9cf5397f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52ffe1a705cb720d09c831b9cf5397f6">&#9670;&nbsp;</a></span>initial_element_reorder()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT , class INTERFACE_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html">oomph::BrethertonSpineMesh</a>&lt; ELEMENT, INTERFACE_ELEMENT &gt;::initial_element_reorder</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Initial reordering elements of the elements &ndash; before the channel mesh is added. Vertical stacks of elements, each topped by their interface element &ndash; this is (currently) identical to the version in the SingleLayerSpineMesh but it's important that the element reordering is maintained in exactly this form for the rest of the mesh generation process to work properly. Therefore we keep a copy of the function in here.</p>
<p>Reorder elements: Vertical stacks of elements, each topped by their interface element &ndash; this is (currently) identical to the version in the SingleLayerSpineMesh but it's important that element reordering is maintained in exactly this form so to be on the safe side, we move the function in here. </p>
<div class="fragment"><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;  {</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#a1b2c0a2d1f8399713033953c72d399ee">Nx</a> = this-&gt;<a class="code" href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#a1b2c0a2d1f8399713033953c72d399ee">Nx</a>;</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#a49a5ee7ef86ce837fb807eb6014a296d">Ny</a> = this-&gt;<a class="code" href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#a49a5ee7ef86ce837fb807eb6014a296d">Ny</a>;</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    <span class="comment">// Find out how many elements there are</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> Nelement = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">nelement</a>();</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    <span class="comment">// Find out how many fluid elements there are</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> Nfluid = <a class="code" href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#a1b2c0a2d1f8399713033953c72d399ee">Nx</a> * <a class="code" href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#a49a5ee7ef86ce837fb807eb6014a296d">Ny</a>;</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    <span class="comment">// Create a dummy array of elements</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    Vector&lt;FiniteElement*&gt; dummy;</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160; </div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    <span class="comment">// Loop over the elements in horizontal order</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; <a class="code" href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#a1b2c0a2d1f8399713033953c72d399ee">Nx</a>; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    {</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;      <span class="comment">// Loop over the elements in lower layer vertically</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#a49a5ee7ef86ce837fb807eb6014a296d">Ny</a>; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;      {</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;        <span class="comment">// Push back onto the new stack</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        dummy.push_back(this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a4f274774435e9454bf77bf70de69367a">finite_element_pt</a>(Nx * <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>));</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;      }</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160; </div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;      <span class="comment">// Push back the line element onto the stack</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;      dummy.push_back(this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a4f274774435e9454bf77bf70de69367a">finite_element_pt</a>(Nfluid + <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>));</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    }</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160; </div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    <span class="comment">// Now copy the reordered elements into the element_pt</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; Nelement; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    {</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;      this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#aca12acfe655a4d5c4a4eab4a7b970812">Element_pt</a>[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>] = dummy[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>];</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    }</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1RectangularQuadMesh_html_a1b2c0a2d1f8399713033953c72d399ee"><div class="ttname"><a href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#a1b2c0a2d1f8399713033953c72d399ee">oomph::RectangularQuadMesh::Nx</a></div><div class="ttdeci">unsigned Nx</div><div class="ttdoc">Nx: number of elements in x-direction.</div><div class="ttdef"><b>Definition:</b> rectangular_quadmesh.template.h:63</div></div>
<div class="ttc" id="aclassoomph_1_1RectangularQuadMesh_html_a49a5ee7ef86ce837fb807eb6014a296d"><div class="ttname"><a href="../../da/db8/classoomph_1_1RectangularQuadMesh.html#a49a5ee7ef86ce837fb807eb6014a296d">oomph::RectangularQuadMesh::Ny</a></div><div class="ttdeci">unsigned Ny</div><div class="ttdoc">Ny: number of elements in y-direction.</div><div class="ttdef"><b>Definition:</b> rectangular_quadmesh.template.h:65</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../d9/d37/namespaceGlobalParameters.html#a72a2066213f1fd30b154e116edb2780b">GlobalParameters::Nx</a>, and <a class="el" href="../../d9/d37/namespaceGlobalParameters.html#ac3d9a44125a811db69452eff8840b494">GlobalParameters::Ny</a>.</p>

</div>
</div>
<a id="a8ecc86c4477f498db8fa3d265baa6088"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ecc86c4477f498db8fa3d265baa6088">&#9670;&nbsp;</a></span>interface_element_pt()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT , class INTERFACE_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html">FiniteElement</a>*&amp; <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html">oomph::BrethertonSpineMesh</a>&lt; ELEMENT, INTERFACE_ELEMENT &gt;::interface_element_pt </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long &amp;&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Access functions for pointers to interface elements. </p>
<div class="fragment"><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    {</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a7422b912ff7ad780777205f0cbe83362">Interface_element_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, and <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a7422b912ff7ad780777205f0cbe83362">oomph::BrethertonSpineMesh&lt; ELEMENT, INTERFACE_ELEMENT &gt;::Interface_element_pt</a>.</p>

</div>
</div>
<a id="a47184866746a1fce6dd0ca27ab7e17ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47184866746a1fce6dd0ca27ab7e17ce">&#9670;&nbsp;</a></span>nbulk()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT , class INTERFACE_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html">oomph::BrethertonSpineMesh</a>&lt; ELEMENT, INTERFACE_ELEMENT &gt;::nbulk </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of elements in bulk. </p>
<div class="fragment"><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a207b6a5e52ce95c0a6125f56eb22b98d">Bulk_element_pt</a>.size();</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a207b6a5e52ce95c0a6125f56eb22b98d">oomph::BrethertonSpineMesh&lt; ELEMENT, INTERFACE_ELEMENT &gt;::Bulk_element_pt</a>.</p>

</div>
</div>
<a id="ade4d0f2933beddda517b949d80928a18"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade4d0f2933beddda517b949d80928a18">&#9670;&nbsp;</a></span>nfree_surface_spines()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT , class INTERFACE_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html">oomph::BrethertonSpineMesh</a>&lt; ELEMENT, INTERFACE_ELEMENT &gt;::nfree_surface_spines </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Number of free-surface spines (i.e. excluding the dummy spines in the channel region) </p>
<div class="fragment"><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      <span class="keywordtype">unsigned</span> np = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a4f274774435e9454bf77bf70de69367a">finite_element_pt</a>(0)-&gt;<a class="code" href="../../d2/dc6/classoomph_1_1FiniteElement.html#ab65c7a94dda80c1876a09ac12be4e39c">nnode_1d</a>();</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <span class="keywordflow">return</span> 2 * (<a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#af6ef10fb80559c3ad27a50116da60dcc">Nx1</a> + <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a237b4f516eb3f74e42e190f2a23f93c3">Nx2</a> + <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a1e58d18dd2231c785008efa07260e8da">Nhalf</a>) * (np - 1);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a4f274774435e9454bf77bf70de69367a">oomph::Mesh::finite_element_pt()</a>, <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a1e58d18dd2231c785008efa07260e8da">oomph::BrethertonSpineMesh&lt; ELEMENT, INTERFACE_ELEMENT &gt;::Nhalf</a>, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#ab65c7a94dda80c1876a09ac12be4e39c">oomph::FiniteElement::nnode_1d()</a>, <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#af6ef10fb80559c3ad27a50116da60dcc">oomph::BrethertonSpineMesh&lt; ELEMENT, INTERFACE_ELEMENT &gt;::Nx1</a>, and <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a237b4f516eb3f74e42e190f2a23f93c3">oomph::BrethertonSpineMesh&lt; ELEMENT, INTERFACE_ELEMENT &gt;::Nx2</a>.</p>

</div>
</div>
<a id="ae1ecd7c00fe1032e1ee16d7a98156d5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1ecd7c00fe1032e1ee16d7a98156d5c">&#9670;&nbsp;</a></span>ninterface_element()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT , class INTERFACE_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html">oomph::BrethertonSpineMesh</a>&lt; ELEMENT, INTERFACE_ELEMENT &gt;::ninterface_element </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of elements on interface. </p>
<div class="fragment"><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a7422b912ff7ad780777205f0cbe83362">Interface_element_pt</a>.size();</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a7422b912ff7ad780777205f0cbe83362">oomph::BrethertonSpineMesh&lt; ELEMENT, INTERFACE_ELEMENT &gt;::Interface_element_pt</a>.</p>

</div>
</div>
<a id="a507ea97977b837f2f0d9647407d770cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a507ea97977b837f2f0d9647407d770cd">&#9670;&nbsp;</a></span>pin_all_spines()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT , class INTERFACE_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html">oomph::BrethertonSpineMesh</a>&lt; ELEMENT, INTERFACE_ELEMENT &gt;::pin_all_spines </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Pin all spines so the mesh can be used for computation without free surfaces </p>
<div class="fragment"><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      <span class="keywordtype">unsigned</span> n_spine = this-&gt;<a class="code" href="../../d6/d74/classoomph_1_1SpineMesh.html#a8aa10bf71f0d0126e2cdb98a4a4ae264">nspine</a>();</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_spine; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        this-&gt;<a class="code" href="../../d6/d74/classoomph_1_1SpineMesh.html#aa8a4afbc37ff7f4c19e44c28c1d7552a">spine_pt</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)-&gt;<a class="code" href="../../dc/d4c/classoomph_1_1Spine.html#ac34e4b12d9c1843611e42968ba5d90c7">spine_height_pt</a>()-&gt;<a class="code" href="../../d8/dc5/classoomph_1_1Data.html#a422231c58e423f0b43822827aa334d79">pin</a>(0);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      }</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1Data_html_a422231c58e423f0b43822827aa334d79"><div class="ttname"><a href="../../d8/dc5/classoomph_1_1Data.html#a422231c58e423f0b43822827aa334d79">oomph::Data::pin</a></div><div class="ttdeci">void pin(const unsigned &amp;i)</div><div class="ttdoc">Pin the i-th stored variable.</div><div class="ttdef"><b>Definition:</b> nodes.h:385</div></div>
<div class="ttc" id="aclassoomph_1_1SpineMesh_html_a8aa10bf71f0d0126e2cdb98a4a4ae264"><div class="ttname"><a href="../../d6/d74/classoomph_1_1SpineMesh.html#a8aa10bf71f0d0126e2cdb98a4a4ae264">oomph::SpineMesh::nspine</a></div><div class="ttdeci">unsigned long nspine() const</div><div class="ttdoc">Return the number of spines in the mesh.</div><div class="ttdef"><b>Definition:</b> spines.h:635</div></div>
<div class="ttc" id="aclassoomph_1_1SpineMesh_html_aa8a4afbc37ff7f4c19e44c28c1d7552a"><div class="ttname"><a href="../../d6/d74/classoomph_1_1SpineMesh.html#aa8a4afbc37ff7f4c19e44c28c1d7552a">oomph::SpineMesh::spine_pt</a></div><div class="ttdeci">Spine *&amp; spine_pt(const unsigned long &amp;i)</div><div class="ttdoc">Return the i-th spine in the mesh.</div><div class="ttdef"><b>Definition:</b> spines.h:623</div></div>
<div class="ttc" id="aclassoomph_1_1Spine_html_ac34e4b12d9c1843611e42968ba5d90c7"><div class="ttname"><a href="../../dc/d4c/classoomph_1_1Spine.html#ac34e4b12d9c1843611e42968ba5d90c7">oomph::Spine::spine_height_pt</a></div><div class="ttdeci">Data *&amp; spine_height_pt()</div><div class="ttdoc">Access function to Data object that stores the spine height.</div><div class="ttdef"><b>Definition:</b> spines.h:156</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../d6/d74/classoomph_1_1SpineMesh.html#a8aa10bf71f0d0126e2cdb98a4a4ae264">oomph::SpineMesh::nspine()</a>, <a class="el" href="../../d8/dc5/classoomph_1_1Data.html#a422231c58e423f0b43822827aa334d79">oomph::Data::pin()</a>, <a class="el" href="../../dc/d4c/classoomph_1_1Spine.html#ac34e4b12d9c1843611e42968ba5d90c7">oomph::Spine::spine_height_pt()</a>, and <a class="el" href="../../d6/d74/classoomph_1_1SpineMesh.html#aa8a4afbc37ff7f4c19e44c28c1d7552a">oomph::SpineMesh::spine_pt()</a>.</p>

</div>
</div>
<a id="a0dfeac5bc9a4fa4bfdcd443def30dcdb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0dfeac5bc9a4fa4bfdcd443def30dcdb">&#9670;&nbsp;</a></span>reposition_spines()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT , class INTERFACE_ELEMENT &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html">oomph::BrethertonSpineMesh</a>&lt; ELEMENT, INTERFACE_ELEMENT &gt;::reposition_spines </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>zeta_lo_transition_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>zeta_lo_transition_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>zeta_up_transition_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>zeta_up_transition_end</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reposition the spines in response to changes in geometry. </p>
<p>Reposition the spines that emenate from the lower wall. </p>
<div class="fragment"><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;  {</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    <span class="comment">// Firstly create a geometric object of the free surface</span></div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;    <a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#aa4a64cb23aa881dbd67c1b633173494f">Mesh</a>* fs_mesh_pt = <span class="keyword">new</span> <a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#aa4a64cb23aa881dbd67c1b633173494f">Mesh</a>;</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    this-&gt;<span class="keyword">template</span> build_face_mesh&lt;ELEMENT, FaceElementAsGeomObject&gt;(</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;      4, fs_mesh_pt);</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160; </div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;    <span class="comment">// Loop over these new face elements and set the boundary number</span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    <span class="comment">// of the bulk mesh</span></div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    <span class="keywordtype">unsigned</span> n_face_element = fs_mesh_pt-&gt;nelement();</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    <span class="comment">// Loop over the elements</span></div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; n_face_element; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    {</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;      <span class="comment">// Cast the element pointer to the correct thing!</span></div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;      <span class="keyword">dynamic_cast&lt;</span>FaceElementAsGeomObject&lt;ELEMENT&gt;*<span class="keyword">&gt;</span>(fs_mesh_pt-&gt;element_pt(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>))</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;        -&gt;set_boundary_number_in_bulk_mesh(4);</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    }</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160; </div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    <span class="comment">// Now make a single geometric object that represents the collection of</span></div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    <span class="comment">// geometric objects that form the boundary of the bulk mesh. Two</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    <span class="comment">// Eulerian coordinates, one intrinsic coordinate.</span></div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    MeshAsGeomObject* fs_geom_object_pt = <span class="keyword">new</span> MeshAsGeomObject(fs_mesh_pt);</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160; </div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160; </div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    <span class="comment">// Length of deposited film region</span></div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    <span class="keywordtype">double</span> llayer_lower = zeta_lo_transition_start - <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a0f41083aa9a97fca03d498bd6ec21eb2">Zeta_start</a>;</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    <span class="keywordtype">double</span> llayer_upper = zeta_up_transition_start - <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a0f41083aa9a97fca03d498bd6ec21eb2">Zeta_start</a>;</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160; </div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    <span class="comment">// Length of transition region</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    <span class="keywordtype">double</span> d_lower = zeta_lo_transition_end - zeta_lo_transition_start;</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    <span class="keywordtype">double</span> d_upper = zeta_up_transition_end - zeta_up_transition_start;</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160; </div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    <span class="comment">// Work out radius of circular cap from lower and upper wall</span></div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    Vector&lt;double&gt; r_wall_lo(2), r_wall_up(2);</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    Vector&lt;double&gt; <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>(1), s_lo(1), s_up(1);</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    GeomObject *lower_sub_geom_object_pt = 0, *upper_sub_geom_object_pt = 0;</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160; </div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    GeomObject* lower_transition_geom_object_pt = 0;</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    GeomObject* upper_transition_geom_object_pt = 0;</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    Vector&lt;double&gt; s_transition_lo(1), s_transition_up(1);</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    Vector&lt;double&gt; spine_centre(2);</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160; </div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    <span class="comment">// Get number of nodes along element edge</span></div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    <span class="keywordtype">unsigned</span> np = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a4f274774435e9454bf77bf70de69367a">finite_element_pt</a>(0)-&gt;<a class="code" href="../../d2/dc6/classoomph_1_1FiniteElement.html#ab65c7a94dda80c1876a09ac12be4e39c">nnode_1d</a>();</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160; </div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    <span class="comment">// Calculate the centre for the spine nodes in the transition region</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    {</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;      <span class="comment">// Get the geometric objects on the walls at the start of the transition</span></div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;      <span class="comment">// region</span></div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;      <span class="comment">// Lower wall</span></div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;      <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>[0] = zeta_lo_transition_start;</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;      <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a04c0136de66c06a34347b89f453730e1">Lower_wall_pt</a>-&gt;<a class="code" href="../../da/ddd/classoomph_1_1GeomObject.html#a78ee9f98bcfd0c5e1f07a459777663d3">locate_zeta</a>(</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;        <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>, lower_transition_geom_object_pt, s_transition_lo);</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;      <span class="comment">// Upper wall</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;      <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>[0] = zeta_up_transition_start;</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;      <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a1f97e78a12000afcc1bd754102b5b51a">Upper_wall_pt</a>-&gt;<a class="code" href="../../da/ddd/classoomph_1_1GeomObject.html#a78ee9f98bcfd0c5e1f07a459777663d3">locate_zeta</a>(</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;        <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>, upper_transition_geom_object_pt, s_transition_up);</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160; </div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;      <span class="comment">// Find the Eulerian coordinates of the walls at the transition region</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;      lower_transition_geom_object_pt-&gt;position(s_transition_lo, r_wall_lo);</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;      upper_transition_geom_object_pt-&gt;position(s_transition_up, r_wall_up);</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160; </div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;      <span class="comment">// Take the average of these positions to define the origin of the spines</span></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;      <span class="comment">// in the transition region Horizontal position is always halfway</span></div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;      spine_centre[0] = 0.5 * (r_wall_lo[0] + r_wall_up[0]);</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160; </div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;      <span class="comment">// Vertical Position is given by a specified fraction</span></div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;      <span class="comment">// between the upper and lower walls</span></div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;      spine_centre[1] =</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;        r_wall_lo[1] + <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a67f784e7b3a898af6c60515042c3ea73">spine_centre_fraction</a>() * (r_wall_up[1] - r_wall_lo[1]);</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    }</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160; </div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160; </div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    <span class="comment">// Initialise number of elements in previous regions:</span></div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    <span class="keywordtype">unsigned</span> n_prev_elements = 0;</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160; </div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    <span class="comment">// Storage for the end of the spines</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    Vector&lt;double&gt; spine_end(2);</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    Vector&lt;double&gt; fs_zeta(1, 0.0);</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160; </div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    <span class="comment">// Loop over elements in lower deposited film region</span></div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    <span class="comment">// -------------------------------------------------</span></div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    {</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;LOWER FILM &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;      <span class="comment">// Increments in wall coordinate</span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;      <span class="keywordtype">double</span> dzeta_el = llayer_lower / <a class="code" href="../../df/de6/classdouble.html">double</a>(<a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#af6ef10fb80559c3ad27a50116da60dcc">Nx1</a>);</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;      <span class="keywordtype">double</span> dzeta_node = llayer_lower / <a class="code" href="../../df/de6/classdouble.html">double</a>(<a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#af6ef10fb80559c3ad27a50116da60dcc">Nx1</a> * (np - 1));</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160; </div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;      <span class="comment">// Loop over elements horizontally</span></div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#af6ef10fb80559c3ad27a50116da60dcc">Nx1</a>; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;      {</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;        <span class="comment">// Start of wall coordinate</span></div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;        <span class="keywordtype">double</span> zeta_lo = <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a0f41083aa9a97fca03d498bd6ec21eb2">Zeta_start</a> + <a class="code" href="../../df/de6/classdouble.html">double</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) * dzeta_el;</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160; </div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;        <span class="comment">// Work out element number in overall mesh</span></div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;        <span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = n_prev_elements + <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> * (<a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a4ba20dfa61b6c342f2defbc0cdb47851">Nh</a> + 1);</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160; </div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;        <span class="comment">// Get pointer to lower element</span></div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;        FiniteElement* el_pt = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a4f274774435e9454bf77bf70de69367a">finite_element_pt</a>(e);</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160; </div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;        <span class="comment">// Loop over its nodes &quot;horizontally&quot;</span></div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i1 = 0; i1 &lt; (np - 1); i1++)</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;        {</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;          <span class="comment">// Get spine node</span></div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;          SpineNode* nod_pt = <span class="keyword">dynamic_cast&lt;</span>SpineNode*<span class="keyword">&gt;</span>(el_pt-&gt;node_pt(i1));</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160; </div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;          <span class="comment">// Get the Lagrangian coordinate in the Lower Wall</span></div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;          <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>[0] = zeta_lo + <a class="code" href="../../df/de6/classdouble.html">double</a>(i1) * dzeta_node;</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;          <span class="comment">// Reset the boundary coordinate</span></div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;          nod_pt-&gt;set_coordinates_on_boundary(0, <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>);</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;          <span class="comment">// Get the geometric object and local coordinate</span></div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;          <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a04c0136de66c06a34347b89f453730e1">Lower_wall_pt</a>-&gt;<a class="code" href="../../da/ddd/classoomph_1_1GeomObject.html#a78ee9f98bcfd0c5e1f07a459777663d3">locate_zeta</a>(<a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>, lower_sub_geom_object_pt, s_lo);</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160; </div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;          <span class="comment">// The local coordinate is a geometric parameter</span></div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;          <span class="comment">// This needs to be set (rather than added) because the</span></div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;          <span class="comment">// same spine may be visited more than once</span></div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;          Vector&lt;double&gt; parameters(1, s_lo[0]);</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;          nod_pt-&gt;spine_pt()-&gt;set_geom_parameter(parameters);</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160; </div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;          <span class="comment">// The sub geom object is one (and only) geom object</span></div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;          <span class="comment">// for spine:</span></div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;          Vector&lt;GeomObject*&gt; geom_object_pt(1);</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;          geom_object_pt[0] = lower_sub_geom_object_pt;</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160; </div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;          <span class="comment">// Pass geom object(s) to spine</span></div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;          nod_pt-&gt;spine_pt()-&gt;set_geom_object_pt(geom_object_pt);</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160; </div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;          <span class="comment">// Get the wall position at the bottom of the spine</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;          lower_sub_geom_object_pt-&gt;position(s_lo, r_wall_lo);</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;          <span class="comment">// The end of the spine is vertically above the base</span></div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;          spine_end[0] = r_wall_lo[0];</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;          spine_end[1] = spine_centre[1];</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;          nod_pt-&gt;spine_pt()-&gt;height() = <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#ac80488ae4db2da00e1b38f6f07e0ff9d">find_distance_to_free_surface</a>(</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;            fs_geom_object_pt, fs_zeta, r_wall_lo, spine_end);</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;        }</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;      }</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160; </div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;      <span class="comment">// Increment number of previous elements</span></div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;      n_prev_elements += <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#af6ef10fb80559c3ad27a50116da60dcc">Nx1</a> * (<a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a4ba20dfa61b6c342f2defbc0cdb47851">Nh</a> + 1);</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    }</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160; </div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160; </div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;    <span class="comment">// Loop over elements in lower horizontal transition region</span></div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    <span class="comment">// --------------------------------------------------------</span></div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    {</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;LOWER HORIZONTAL TRANSITION &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;      <span class="comment">// Increments in wall coordinate</span></div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;      <span class="keywordtype">double</span> dzeta_el = d_lower / <a class="code" href="../../df/de6/classdouble.html">double</a>(<a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a237b4f516eb3f74e42e190f2a23f93c3">Nx2</a>);</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;      <span class="keywordtype">double</span> dzeta_node = d_lower / <a class="code" href="../../df/de6/classdouble.html">double</a>(<a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a237b4f516eb3f74e42e190f2a23f93c3">Nx2</a> * (np - 1));</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160; </div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;      <span class="comment">// Loop over elements horizontally</span></div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a237b4f516eb3f74e42e190f2a23f93c3">Nx2</a>; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;      {</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;        <span class="comment">// Start of wall coordinate</span></div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;        <span class="keywordtype">double</span> zeta_lo = zeta_lo_transition_start + <a class="code" href="../../df/de6/classdouble.html">double</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) * dzeta_el;</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160; </div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;        <span class="comment">// Work out element number in overall mesh</span></div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;        <span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = n_prev_elements + <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> * (<a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a4ba20dfa61b6c342f2defbc0cdb47851">Nh</a> + 1);</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160; </div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;        <span class="comment">// Get pointer to element</span></div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;        FiniteElement* el_pt = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a4f274774435e9454bf77bf70de69367a">finite_element_pt</a>(e);</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160; </div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;        <span class="comment">// Loop over its nodes</span></div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i1 = 0; i1 &lt; (np - 1); i1++)</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;        {</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;          <span class="comment">// Get spine node</span></div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;          SpineNode* nod_pt = <span class="keyword">dynamic_cast&lt;</span>SpineNode*<span class="keyword">&gt;</span>(el_pt-&gt;node_pt(i1));</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160; </div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;          <span class="comment">// Get the Lagrangian coordinate in the Lower Wall</span></div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;          <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>[0] = zeta_lo + <a class="code" href="../../df/de6/classdouble.html">double</a>(i1) * dzeta_node;</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;          <span class="comment">// Reset the boundary coordinate</span></div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;          nod_pt-&gt;set_coordinates_on_boundary(0, <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>);</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;          <span class="comment">// Get the sub geometric object and local coordinate</span></div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;          <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a04c0136de66c06a34347b89f453730e1">Lower_wall_pt</a>-&gt;<a class="code" href="../../da/ddd/classoomph_1_1GeomObject.html#a78ee9f98bcfd0c5e1f07a459777663d3">locate_zeta</a>(<a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>, lower_sub_geom_object_pt, s_lo);</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160; </div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;          <span class="comment">// Pass geometric parameter to the spine</span></div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;          Vector&lt;double&gt; parameters(3);</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;          parameters[0] = s_lo[0];</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;          parameters[1] = s_transition_lo[0];</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;          parameters[2] = s_transition_up[0];</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;          nod_pt-&gt;spine_pt()-&gt;set_geom_parameter(parameters);</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160; </div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;          <span class="comment">// Lower sub geom object is one (and only) geom object</span></div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;          <span class="comment">// for spine:</span></div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;          Vector&lt;GeomObject*&gt; geom_object_pt(3);</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;          geom_object_pt[0] = lower_sub_geom_object_pt;</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;          geom_object_pt[1] = lower_transition_geom_object_pt;</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;          geom_object_pt[2] = upper_transition_geom_object_pt;</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160; </div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;          <span class="comment">// Pass geom object(s) to spine</span></div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;          nod_pt-&gt;spine_pt()-&gt;set_geom_object_pt(geom_object_pt);</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160; </div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;          <span class="comment">// Get position vector to wall</span></div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;          lower_sub_geom_object_pt-&gt;position(s_lo, r_wall_lo);</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;          <span class="comment">// The end of the spine is the spine centre,so the height is easy(ish)</span></div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;          nod_pt-&gt;spine_pt()-&gt;height() = <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#ac80488ae4db2da00e1b38f6f07e0ff9d">find_distance_to_free_surface</a>(</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;            fs_geom_object_pt, fs_zeta, r_wall_lo, spine_centre);</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;        }</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;      }</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160; </div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;      <span class="comment">// Increment number of previous elements</span></div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;      n_prev_elements += <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a237b4f516eb3f74e42e190f2a23f93c3">Nx2</a> * (<a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a4ba20dfa61b6c342f2defbc0cdb47851">Nh</a> + 1);</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;    }</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160; </div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;    <span class="comment">// Loop over elements in lower vertical transition region</span></div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;    <span class="comment">// --------------------------------------------------------</span></div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;    {</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;LOWER VERTICAL TRANSITION &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a1e58d18dd2231c785008efa07260e8da">Nhalf</a>; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;      {</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;        <span class="comment">// Work out element number in overall mesh</span></div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;        <span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = n_prev_elements + <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> * (<a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a4ba20dfa61b6c342f2defbc0cdb47851">Nh</a> + 1);</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160; </div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;        <span class="comment">// Get pointer to element</span></div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;        FiniteElement* el_pt = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a4f274774435e9454bf77bf70de69367a">finite_element_pt</a>(e);</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160; </div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;        <span class="comment">// Loop over its nodes</span></div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i1 = 0; i1 &lt; (np - 1); i1++)</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;        {</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;          <span class="comment">// Get spine node</span></div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;          <span class="comment">// Note that I have to loop over the second row of nodes</span></div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;          <span class="comment">// because the first row are updated in region 6 and so</span></div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;          <span class="comment">// you get the wrong spines from them (doh!)</span></div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;          SpineNode* nod_pt = <span class="keyword">dynamic_cast&lt;</span>SpineNode*<span class="keyword">&gt;</span>(el_pt-&gt;node_pt(np + i1));</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160; </div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;          <span class="comment">// Get position vectors to wall</span></div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;          <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>[0] = zeta_lo_transition_end;</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;          <span class="comment">// Get the sub geometric objects</span></div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;          <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a04c0136de66c06a34347b89f453730e1">Lower_wall_pt</a>-&gt;<a class="code" href="../../da/ddd/classoomph_1_1GeomObject.html#a78ee9f98bcfd0c5e1f07a459777663d3">locate_zeta</a>(<a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>, lower_sub_geom_object_pt, s_lo);</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;          <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>[0] = zeta_up_transition_end;</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;          <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a1f97e78a12000afcc1bd754102b5b51a">Upper_wall_pt</a>-&gt;<a class="code" href="../../da/ddd/classoomph_1_1GeomObject.html#a78ee9f98bcfd0c5e1f07a459777663d3">locate_zeta</a>(<a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>, upper_sub_geom_object_pt, s_up);</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160; </div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;          lower_sub_geom_object_pt-&gt;position(s_lo, r_wall_lo);</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;          upper_sub_geom_object_pt-&gt;position(s_up, r_wall_up);</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160; </div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;          <span class="comment">// Set vertical fraction</span></div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;          <span class="keywordtype">double</span> vertical_fraction =</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;            (<a class="code" href="../../df/de6/classdouble.html">double</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) + <a class="code" href="../../df/de6/classdouble.html">double</a>(i1) / <a class="code" href="../../df/de6/classdouble.html">double</a>(np - 1)) / <span class="keywordtype">double</span>(2.0 * <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a1e58d18dd2231c785008efa07260e8da">Nhalf</a>);</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160; </div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;          <span class="comment">// Add the geometric parameters in order</span></div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;          Vector&lt;double&gt; parameters(5);</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;          parameters[0] = s_lo[0];</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;          parameters[1] = s_up[0];</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;          parameters[2] = vertical_fraction;</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;          parameters[3] = s_transition_lo[0];</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;          parameters[4] = s_transition_up[0];</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;          nod_pt-&gt;spine_pt()-&gt;set_geom_parameter(parameters);</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160; </div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;          <span class="comment">// Origin of spine</span></div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;          Vector&lt;double&gt; <a class="code" href="../../d9/d37/namespaceGlobalParameters.html#a48941328f0bded62ed7a778062b03dd7">S0</a>(2);</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;          <a class="code" href="../../d9/d37/namespaceGlobalParameters.html#a48941328f0bded62ed7a778062b03dd7">S0</a>[0] =</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;            r_wall_lo[0] + vertical_fraction * (r_wall_up[0] - r_wall_lo[0]);</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;          <a class="code" href="../../d9/d37/namespaceGlobalParameters.html#a48941328f0bded62ed7a778062b03dd7">S0</a>[1] =</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;            r_wall_lo[1] + vertical_fraction * (r_wall_up[1] - r_wall_lo[1]);</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160; </div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;          <span class="comment">// Lower and Upper wall sub geom objects affect  spine:</span></div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;          Vector&lt;GeomObject*&gt; geom_object_pt(4);</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;          geom_object_pt[0] = lower_sub_geom_object_pt;</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;          geom_object_pt[1] = upper_sub_geom_object_pt;</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;          geom_object_pt[2] = lower_transition_geom_object_pt;</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;          geom_object_pt[3] = upper_transition_geom_object_pt;</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160; </div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;          <span class="comment">// Pass geom object(s) to spine</span></div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;          nod_pt-&gt;spine_pt()-&gt;set_geom_object_pt(geom_object_pt);</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160; </div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;          <span class="comment">// Calculate the spine height</span></div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;          nod_pt-&gt;spine_pt()-&gt;height() = <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#ac80488ae4db2da00e1b38f6f07e0ff9d">find_distance_to_free_surface</a>(</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;            fs_geom_object_pt, fs_zeta, <a class="code" href="../../d9/d37/namespaceGlobalParameters.html#a48941328f0bded62ed7a778062b03dd7">S0</a>, spine_centre);</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;        }</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;      }</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160; </div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;      <span class="comment">// Increment number of previous elements</span></div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;      n_prev_elements += <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a1e58d18dd2231c785008efa07260e8da">Nhalf</a> * (<a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a4ba20dfa61b6c342f2defbc0cdb47851">Nh</a> + 1);</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;    }</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160; </div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160; </div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;    <span class="comment">// Loop over elements in upper vertical transition region</span></div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    <span class="comment">// --------------------------------------------------------</span></div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;    {</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;UPPER VERTICAL TRANSITION&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a1e58d18dd2231c785008efa07260e8da">Nhalf</a>; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;      {</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;        <span class="comment">// Work out element number in overall mesh</span></div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;        <span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = n_prev_elements + <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> * (<a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a4ba20dfa61b6c342f2defbc0cdb47851">Nh</a> + 1);</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160; </div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;        <span class="comment">// Get pointer to element</span></div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;        FiniteElement* el_pt = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a4f274774435e9454bf77bf70de69367a">finite_element_pt</a>(e);</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160; </div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;        <span class="comment">// Loop over its nodes</span></div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i1 = 0; i1 &lt; (np - 1); i1++)</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;        {</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;          <span class="comment">// Get spine node</span></div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;          <span class="comment">// Note that I have to loop over the second row of nodes</span></div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;          <span class="comment">// because the first row are updated in region 6 and so</span></div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;          <span class="comment">// you get the wrong spines from them (doh!)</span></div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;          SpineNode* nod_pt = <span class="keyword">dynamic_cast&lt;</span>SpineNode*<span class="keyword">&gt;</span>(el_pt-&gt;node_pt(np + i1));</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160; </div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;          <span class="comment">// Get position vectors to wall</span></div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;          <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>[0] = zeta_lo_transition_end;</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;          <span class="comment">// Get the sub geometric objects</span></div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;          <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a04c0136de66c06a34347b89f453730e1">Lower_wall_pt</a>-&gt;<a class="code" href="../../da/ddd/classoomph_1_1GeomObject.html#a78ee9f98bcfd0c5e1f07a459777663d3">locate_zeta</a>(<a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>, lower_sub_geom_object_pt, s_lo);</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;          <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>[0] = zeta_up_transition_end;</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;          <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a1f97e78a12000afcc1bd754102b5b51a">Upper_wall_pt</a>-&gt;<a class="code" href="../../da/ddd/classoomph_1_1GeomObject.html#a78ee9f98bcfd0c5e1f07a459777663d3">locate_zeta</a>(<a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>, upper_sub_geom_object_pt, s_up);</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160; </div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;          lower_sub_geom_object_pt-&gt;position(s_lo, r_wall_lo);</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;          upper_sub_geom_object_pt-&gt;position(s_up, r_wall_up);</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160; </div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160; </div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;          <span class="comment">// Set vertical fraction</span></div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;          <span class="keywordtype">double</span> vertical_fraction =</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;            0.5 +</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;            (<a class="code" href="../../df/de6/classdouble.html">double</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) + <a class="code" href="../../df/de6/classdouble.html">double</a>(i1) / <a class="code" href="../../df/de6/classdouble.html">double</a>(np - 1)) / <span class="keywordtype">double</span>(2.0 * <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a1e58d18dd2231c785008efa07260e8da">Nhalf</a>);</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160; </div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;          <span class="comment">// Add the geometric parameters in order</span></div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;          Vector&lt;double&gt; parameters(5);</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;          parameters[0] = s_lo[0];</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;          parameters[1] = s_up[0];</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;          parameters[2] = vertical_fraction;</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;          parameters[3] = s_transition_lo[0];</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;          parameters[4] = s_transition_up[0];</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;          nod_pt-&gt;spine_pt()-&gt;set_geom_parameter(parameters);</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160; </div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;          <span class="comment">// Origin of spine</span></div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;          Vector&lt;double&gt; <a class="code" href="../../d9/d37/namespaceGlobalParameters.html#a48941328f0bded62ed7a778062b03dd7">S0</a>(2);</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;          <a class="code" href="../../d9/d37/namespaceGlobalParameters.html#a48941328f0bded62ed7a778062b03dd7">S0</a>[0] =</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;            r_wall_lo[0] + vertical_fraction * (r_wall_up[0] - r_wall_lo[0]);</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;          <a class="code" href="../../d9/d37/namespaceGlobalParameters.html#a48941328f0bded62ed7a778062b03dd7">S0</a>[1] =</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;            r_wall_lo[1] + vertical_fraction * (r_wall_up[1] - r_wall_lo[1]);</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160; </div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;          <span class="comment">// Lower and Upper wall sub geom objects affect  spine:</span></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;          Vector&lt;GeomObject*&gt; geom_object_pt(4);</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;          geom_object_pt[0] = lower_sub_geom_object_pt;</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;          geom_object_pt[1] = upper_sub_geom_object_pt;</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;          geom_object_pt[2] = lower_transition_geom_object_pt;</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;          geom_object_pt[3] = upper_transition_geom_object_pt;</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160; </div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;          <span class="comment">// Pass geom object(s) to spine</span></div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;          nod_pt-&gt;spine_pt()-&gt;set_geom_object_pt(geom_object_pt);</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160; </div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;          <span class="comment">// Calculate the spine height</span></div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;          nod_pt-&gt;spine_pt()-&gt;height() = <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#ac80488ae4db2da00e1b38f6f07e0ff9d">find_distance_to_free_surface</a>(</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;            fs_geom_object_pt, fs_zeta, <a class="code" href="../../d9/d37/namespaceGlobalParameters.html#a48941328f0bded62ed7a778062b03dd7">S0</a>, spine_centre);</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;        }</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;      }</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160; </div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;      <span class="comment">// Increment number of previous elements</span></div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;      n_prev_elements += <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a1e58d18dd2231c785008efa07260e8da">Nhalf</a> * (<a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a4ba20dfa61b6c342f2defbc0cdb47851">Nh</a> + 1);</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;    }</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160; </div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160; </div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;    <span class="comment">// Loop over elements in upper horizontal transition region</span></div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;    <span class="comment">// --------------------------------------------------------</span></div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;    {</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;UPPER HORIZONTAL TRANSITION &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;      <span class="comment">// Increments in wall coordinate</span></div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;      <span class="keywordtype">double</span> dzeta_el = d_upper / <a class="code" href="../../df/de6/classdouble.html">double</a>(<a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a237b4f516eb3f74e42e190f2a23f93c3">Nx2</a>);</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;      <span class="keywordtype">double</span> dzeta_node = d_upper / <a class="code" href="../../df/de6/classdouble.html">double</a>(<a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a237b4f516eb3f74e42e190f2a23f93c3">Nx2</a> * (np - 1));</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160; </div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;      <span class="comment">// Loop over elements horizontally</span></div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a237b4f516eb3f74e42e190f2a23f93c3">Nx2</a>; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;      {</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;        <span class="comment">// Start of wall coordinate</span></div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;        <span class="keywordtype">double</span> zeta_lo = zeta_up_transition_end - <a class="code" href="../../df/de6/classdouble.html">double</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) * dzeta_el;</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160; </div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;        <span class="comment">// Work out element number in overall mesh</span></div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;        <span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = n_prev_elements + <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> * (<a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a4ba20dfa61b6c342f2defbc0cdb47851">Nh</a> + 1);</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160; </div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;        <span class="comment">// Get pointer to element</span></div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;        FiniteElement* el_pt = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a4f274774435e9454bf77bf70de69367a">finite_element_pt</a>(e);</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160; </div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;        <span class="comment">// Loop over its nodes</span></div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i1 = 0; i1 &lt; (np - 1); i1++)</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;        {</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;          <span class="comment">// Get spine node (same comment)</span></div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;          SpineNode* nod_pt = <span class="keyword">dynamic_cast&lt;</span>SpineNode*<span class="keyword">&gt;</span>(el_pt-&gt;node_pt(np + i1));</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160; </div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;          <span class="comment">// Get the Lagrangian coordinate in the Lower Wall</span></div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;          <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>[0] = zeta_lo - <a class="code" href="../../df/de6/classdouble.html">double</a>(i1) * dzeta_node;</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;          <span class="comment">// Reset the boundary coordinate</span></div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;          el_pt-&gt;node_pt(i1)-&gt;set_coordinates_on_boundary(2, <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>);</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;          <span class="comment">// Get the sub geometric object and local coordinate</span></div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;          <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a1f97e78a12000afcc1bd754102b5b51a">Upper_wall_pt</a>-&gt;<a class="code" href="../../da/ddd/classoomph_1_1GeomObject.html#a78ee9f98bcfd0c5e1f07a459777663d3">locate_zeta</a>(<a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>, upper_sub_geom_object_pt, s_up);</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160; </div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;          <span class="comment">// Pass geometric parameter to the spine</span></div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;          Vector&lt;double&gt; parameters(3);</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;          parameters[0] = s_up[0];</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;          parameters[1] = s_transition_lo[0];</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;          parameters[2] = s_transition_up[0];</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;          nod_pt-&gt;spine_pt()-&gt;set_geom_parameter(parameters);</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160; </div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;          <span class="comment">// Lower sub geom object is one (and only) geom object</span></div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;          <span class="comment">// for spine:</span></div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;          Vector&lt;GeomObject*&gt; geom_object_pt(3);</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;          geom_object_pt[0] = upper_sub_geom_object_pt;</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;          geom_object_pt[1] = lower_transition_geom_object_pt;</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;          geom_object_pt[2] = upper_transition_geom_object_pt;</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160; </div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;          <span class="comment">// Pass geom object(s) to spine</span></div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;          nod_pt-&gt;spine_pt()-&gt;set_geom_object_pt(geom_object_pt);</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160; </div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160; </div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;          <span class="comment">// Get position vector to wall</span></div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;          upper_sub_geom_object_pt-&gt;position(s_up, r_wall_up);</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;          <span class="comment">// Find spine height</span></div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;          nod_pt-&gt;spine_pt()-&gt;height() = <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#ac80488ae4db2da00e1b38f6f07e0ff9d">find_distance_to_free_surface</a>(</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;            fs_geom_object_pt, fs_zeta, r_wall_up, spine_centre);</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;        }</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;      }</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160; </div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;      <span class="comment">// Increment number of previous elements</span></div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;      n_prev_elements += <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a237b4f516eb3f74e42e190f2a23f93c3">Nx2</a> * (<a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a4ba20dfa61b6c342f2defbc0cdb47851">Nh</a> + 1);</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;    }</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160; </div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160; </div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;    <span class="comment">// Loop over elements in upper deposited film region</span></div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;    <span class="comment">// -------------------------------------------------</span></div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;    {</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;UPPER THIN FILM&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;      <span class="comment">// Increments in wall coordinate</span></div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;      <span class="keywordtype">double</span> dzeta_el = llayer_upper / <a class="code" href="../../df/de6/classdouble.html">double</a>(<a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#af6ef10fb80559c3ad27a50116da60dcc">Nx1</a>);</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;      <span class="keywordtype">double</span> dzeta_node = llayer_upper / <a class="code" href="../../df/de6/classdouble.html">double</a>(<a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#af6ef10fb80559c3ad27a50116da60dcc">Nx1</a> * (np - 1));</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160; </div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;      <span class="comment">// Loop over elements horizontally</span></div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#af6ef10fb80559c3ad27a50116da60dcc">Nx1</a>; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;      {</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;        <span class="comment">// Start of wall coordinate</span></div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;        <span class="keywordtype">double</span> zeta_lo = zeta_up_transition_start - <a class="code" href="../../df/de6/classdouble.html">double</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) * dzeta_el;</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160; </div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;        <span class="comment">// Work out element number in overall mesh</span></div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;        <span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = n_prev_elements + <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> * (<a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a4ba20dfa61b6c342f2defbc0cdb47851">Nh</a> + 1);</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160; </div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;        <span class="comment">// Get pointer to element</span></div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;        FiniteElement* el_pt = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a4f274774435e9454bf77bf70de69367a">finite_element_pt</a>(e);</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160; </div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;        <span class="comment">// Loop over its nodes &quot;horizontally&quot;</span></div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i1 = 0; i1 &lt; (np - 1); i1++)</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;        {</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;          <span class="comment">// Get spine node</span></div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;          SpineNode* nod_pt = <span class="keyword">dynamic_cast&lt;</span>SpineNode*<span class="keyword">&gt;</span>(el_pt-&gt;node_pt(i1));</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160; </div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;          <span class="comment">// Get the Lagrangian coordinate in the Upper wall</span></div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;          <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>[0] = zeta_lo - <a class="code" href="../../df/de6/classdouble.html">double</a>(i1) * dzeta_node;</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;          <span class="comment">// Reset coordinate on boundary</span></div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;          nod_pt-&gt;set_coordinates_on_boundary(2, <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>);</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;          <span class="comment">// Get the geometric object and local coordinate</span></div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;          <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a1f97e78a12000afcc1bd754102b5b51a">Upper_wall_pt</a>-&gt;<a class="code" href="../../da/ddd/classoomph_1_1GeomObject.html#a78ee9f98bcfd0c5e1f07a459777663d3">locate_zeta</a>(<a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>, upper_sub_geom_object_pt, s_up);</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160; </div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;          <span class="comment">// The local coordinate is a geometric parameter</span></div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;          Vector&lt;double&gt; parameters(1, s_up[0]);</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;          nod_pt-&gt;spine_pt()-&gt;set_geom_parameter(parameters);</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160; </div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;          <span class="comment">// upper sub geom object is one (and only) geom object</span></div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;          <span class="comment">// for spine:</span></div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;          Vector&lt;GeomObject*&gt; geom_object_pt(1);</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;          geom_object_pt[0] = upper_sub_geom_object_pt;</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160; </div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;          <span class="comment">// Pass geom object(s) to spine</span></div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;          nod_pt-&gt;spine_pt()-&gt;set_geom_object_pt(geom_object_pt);</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160; </div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;          <span class="comment">// Get the wall position at the bottom of the spine</span></div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;          upper_sub_geom_object_pt-&gt;position(s_up, r_wall_up);</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;          spine_end[0] = r_wall_up[0];</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;          spine_end[1] = spine_centre[1];</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;          <span class="comment">// Find the new spine height</span></div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;          nod_pt-&gt;spine_pt()-&gt;height() = <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#ac80488ae4db2da00e1b38f6f07e0ff9d">find_distance_to_free_surface</a>(</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;            fs_geom_object_pt, fs_zeta, r_wall_up, spine_end);</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;        }</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;      }</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160; </div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160; </div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;      <span class="comment">// Increment number of previous elements</span></div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;      n_prev_elements += <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#af6ef10fb80559c3ad27a50116da60dcc">Nx1</a> * (<a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a4ba20dfa61b6c342f2defbc0cdb47851">Nh</a> + 1);</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    }</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160; </div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160; </div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;    <span class="comment">// Additional mesh</span></div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;    {</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;      <span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = n_prev_elements;</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160; </div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;      <span class="comment">// Get pointer to node</span></div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;      SpineNode* nod_pt = this-&gt;<a class="code" href="../../d6/d74/classoomph_1_1SpineMesh.html#aea36e8d0454965f9f96a3adc4a5a9371">element_node_pt</a>(e, 0);</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160; </div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;      <span class="comment">// Need to get the local coordinates for the upper and lower wall</span></div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;      <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>[0] = zeta_lo_transition_end;</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;      <span class="comment">// Get the sub geometric objects</span></div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;      <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a04c0136de66c06a34347b89f453730e1">Lower_wall_pt</a>-&gt;<a class="code" href="../../da/ddd/classoomph_1_1GeomObject.html#a78ee9f98bcfd0c5e1f07a459777663d3">locate_zeta</a>(<a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>, lower_sub_geom_object_pt, s_lo);</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;      <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>[0] = zeta_up_transition_end;</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;      <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a1f97e78a12000afcc1bd754102b5b51a">Upper_wall_pt</a>-&gt;<a class="code" href="../../da/ddd/classoomph_1_1GeomObject.html#a78ee9f98bcfd0c5e1f07a459777663d3">locate_zeta</a>(<a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>, upper_sub_geom_object_pt, s_up);</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160; </div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;      lower_sub_geom_object_pt-&gt;position(s_lo, r_wall_lo);</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;      upper_sub_geom_object_pt-&gt;position(s_up, r_wall_up);</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160; </div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;      <span class="comment">// Pass additional data to spine</span></div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;      Vector&lt;double&gt; parameters(2);</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;      parameters[0] = s_lo[0];</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;      parameters[1] = s_up[0];</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;      nod_pt-&gt;spine_pt()-&gt;set_geom_parameter(parameters);</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160; </div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;      <span class="comment">// Lower and upper wall sub geom objects affect update</span></div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;      <span class="comment">// for spine:</span></div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;      Vector&lt;GeomObject*&gt; geom_object_pt(2);</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;      geom_object_pt[0] = lower_sub_geom_object_pt;</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;      geom_object_pt[1] = upper_sub_geom_object_pt;</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160; </div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;      <span class="comment">// Pass geom object(s) to spine</span></div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;      nod_pt-&gt;spine_pt()-&gt;set_geom_object_pt(geom_object_pt);</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160; </div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;      <span class="comment">// LOOP OVER OTHER SPINES</span></div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;      <span class="comment">//----------------------</span></div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160; </div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;      <span class="comment">// Now loop over the elements horizontally</span></div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a26c57f832b7cdc495087cef7b54c98fd">Nx3</a>; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;      {</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;        <span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = n_prev_elements + <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>;</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160; </div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;        <span class="comment">// Loop over the nodes in the elements horizontally, ignoring</span></div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;        <span class="comment">// the first column</span></div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> l2 = 0; l2 &lt; np; l2++)</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;        {</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;          <span class="comment">// Get pointer to node at the base of the spine</span></div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;          SpineNode* nod_pt = this-&gt;<a class="code" href="../../d6/d74/classoomph_1_1SpineMesh.html#aea36e8d0454965f9f96a3adc4a5a9371">element_node_pt</a>(e, l2);</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160; </div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;          <span class="comment">// Increment in wall coordinate</span></div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;          <span class="keywordtype">double</span> dzeta_el_lower =</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;            (<a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#ac1b5e005bfb5db65f54ca599942126ea">Zeta_end</a> - zeta_lo_transition_end) / <span class="keywordtype">double</span>(<a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a26c57f832b7cdc495087cef7b54c98fd">Nx3</a>);</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;          <span class="keywordtype">double</span> dzeta_nod_lower = dzeta_el_lower / <a class="code" href="../../df/de6/classdouble.html">double</a>(np - 1);</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160; </div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;          <span class="keywordtype">double</span> dzeta_el_upper =</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;            (<a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#ac1b5e005bfb5db65f54ca599942126ea">Zeta_end</a> - zeta_up_transition_end) / <span class="keywordtype">double</span>(<a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a26c57f832b7cdc495087cef7b54c98fd">Nx3</a>);</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;          <span class="keywordtype">double</span> dzeta_nod_upper = dzeta_el_upper / <a class="code" href="../../df/de6/classdouble.html">double</a>(np - 1);</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160; </div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;          <span class="comment">// Get wall coordinate</span></div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;          <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>[0] =</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;            zeta_lo_transition_end + <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> * dzeta_el_lower + l2 * dzeta_nod_lower;</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;          <span class="comment">// Reset the boundary coordinate</span></div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;          nod_pt-&gt;set_coordinates_on_boundary(0, <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>);</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160; </div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;          <span class="comment">// Get the sub geometric objects</span></div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;          <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a04c0136de66c06a34347b89f453730e1">Lower_wall_pt</a>-&gt;<a class="code" href="../../da/ddd/classoomph_1_1GeomObject.html#a78ee9f98bcfd0c5e1f07a459777663d3">locate_zeta</a>(<a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>, lower_sub_geom_object_pt, s_lo);</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160; </div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;          <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>[0] =</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;            zeta_up_transition_end + <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> * dzeta_el_upper + l2 * dzeta_nod_upper;</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;          <span class="comment">// Reset the upper boundary coordinate</span></div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;          this-&gt;<a class="code" href="../../d6/d74/classoomph_1_1SpineMesh.html#aea36e8d0454965f9f96a3adc4a5a9371">element_node_pt</a>(e + <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a26c57f832b7cdc495087cef7b54c98fd">Nx3</a> * (2 * <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a1e58d18dd2231c785008efa07260e8da">Nhalf</a> - 1), np * (np - 1) + l2)</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;            -&gt;<a class="code" href="../../dc/db7/classoomph_1_1Node.html#a94c19e165ab4e88aabbfa27443c530b7">set_coordinates_on_boundary</a>(2, <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>);</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;          <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a1f97e78a12000afcc1bd754102b5b51a">Upper_wall_pt</a>-&gt;<a class="code" href="../../da/ddd/classoomph_1_1GeomObject.html#a78ee9f98bcfd0c5e1f07a459777663d3">locate_zeta</a>(<a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>, upper_sub_geom_object_pt, s_up);</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160; </div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;          lower_sub_geom_object_pt-&gt;position(s_lo, r_wall_lo);</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;          upper_sub_geom_object_pt-&gt;position(s_up, r_wall_up);</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160; </div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;          <span class="comment">// Add geometric parameters to spine</span></div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;          Vector&lt;double&gt; parameters(2);</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;          parameters[0] = s_lo[0];</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;          parameters[1] = s_up[0];</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;          nod_pt-&gt;spine_pt()-&gt;set_geom_parameter(parameters);</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160; </div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;          <span class="comment">// Lower and upper sub geom objects affect update</span></div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;          <span class="comment">// for spine:</span></div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;          Vector&lt;GeomObject*&gt; geom_object_pt(2);</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;          geom_object_pt[0] = lower_sub_geom_object_pt;</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;          geom_object_pt[1] = upper_sub_geom_object_pt;</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160; </div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;          <span class="comment">// Pass geom object(s) to spine</span></div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;          nod_pt-&gt;spine_pt()-&gt;set_geom_object_pt(geom_object_pt);</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;        }</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;      }</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;    }</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160; </div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160; </div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;    <span class="comment">// Clean up all the memory</span></div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;    <span class="comment">// Can delete the Geometric object</span></div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;    <span class="keyword">delete</span> fs_geom_object_pt;</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;    <span class="comment">// Need to be careful with the FaceMesh, because we can&#39;t delete the nodes</span></div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;    <span class="comment">// Loop</span></div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = n_face_element; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &gt; 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>--)</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;    {</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;      <span class="keyword">delete</span> fs_mesh_pt-&gt;element_pt(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> - 1);</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;      fs_mesh_pt-&gt;element_pt(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> - 1) = 0;</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;    }</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;    <span class="comment">// Now clear all element and node storage (should maybe fine-grain this)</span></div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    fs_mesh_pt-&gt;flush_element_and_node_storage();</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    <span class="comment">// Finally delete the mesh</span></div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;    <span class="keyword">delete</span> fs_mesh_pt;</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1BrethertonSpineMesh_html_ac80488ae4db2da00e1b38f6f07e0ff9d"><div class="ttname"><a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#ac80488ae4db2da00e1b38f6f07e0ff9d">oomph::BrethertonSpineMesh::find_distance_to_free_surface</a></div><div class="ttdeci">double find_distance_to_free_surface(GeomObject *const &amp;fs_geom_object_pt, Vector&lt; double &gt; &amp;initial_zeta, const Vector&lt; double &gt; &amp;spine_base, const Vector&lt; double &gt; &amp;spine_end)</div><div class="ttdoc">Recalculate the spine lengths after repositioning.</div><div class="ttdef"><b>Definition:</b> bretherton_spine_mesh.template.cc:1066</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_aa4a64cb23aa881dbd67c1b633173494f"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#aa4a64cb23aa881dbd67c1b633173494f">oomph::Mesh::Mesh</a></div><div class="ttdeci">Mesh()</div><div class="ttdoc">Default constructor.</div><div class="ttdef"><b>Definition:</b> mesh.h:236</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">oomph::Mesh::element_pt()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a38446e721be2f75a64fdaa025b7c23ad">oomph::Mesh::flush_element_and_node_storage()</a>, <a class="el" href="../../dc/d4c/classoomph_1_1Spine.html#a7502bf089f4001796d5ef801cf104a28">oomph::Spine::height()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../de/dbd/namespaceGlobal__Physical__Variables.html#a225f056408944400c88c5427185089aa">Global_Physical_Variables::Lower_wall_pt</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">oomph::Mesh::nelement()</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, <a class="el" href="../../da/ddd/classoomph_1_1GeomObject.html#a0d04c9d4667817f3ef24bb660fd56065">oomph::GeomObject::position()</a>, <a class="el" href="../../d9/d37/namespaceGlobalParameters.html#a48941328f0bded62ed7a778062b03dd7">GlobalParameters::S0</a>, <a class="el" href="../../dc/db7/classoomph_1_1Node.html#a94c19e165ab4e88aabbfa27443c530b7">oomph::Node::set_coordinates_on_boundary()</a>, <a class="el" href="../../dc/d4c/classoomph_1_1Spine.html#a5332657cdaa1e658156a6b572d9d45ba">oomph::Spine::set_geom_object_pt()</a>, <a class="el" href="../../dc/d4c/classoomph_1_1Spine.html#a6d99d5a44a79588d38a83fae4ca87c57">oomph::Spine::set_geom_parameter()</a>, <a class="el" href="../../dd/d78/classoomph_1_1SpineNode.html#acb15e93d53f62e899a3c126736b41079">oomph::SpineNode::spine_pt()</a>, <a class="el" href="../../de/dbd/namespaceGlobal__Physical__Variables.html#a5e047410432401dff0d492581e0af1c5">Global_Physical_Variables::Upper_wall_pt</a>, and <a class="el" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">Eigen::zeta()</a>.</p>

</div>
</div>
<a id="a33c3ed5af92e7b22a22615f42c34c387"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33c3ed5af92e7b22a22615f42c34c387">&#9670;&nbsp;</a></span>set_spine_centre_fraction_pt()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT , class INTERFACE_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html">oomph::BrethertonSpineMesh</a>&lt; ELEMENT, INTERFACE_ELEMENT &gt;::set_spine_centre_fraction_pt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;&#160;</td>
          <td class="paramname"><em>fraction_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set the pointer to the spine centre's vertial fraction. </p>
<div class="fragment"><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#af5e7951a89bc13d73f2b137947cda8a3">Spine_centre_fraction_pt</a> = fraction_pt;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#af5e7951a89bc13d73f2b137947cda8a3">oomph::BrethertonSpineMesh&lt; ELEMENT, INTERFACE_ELEMENT &gt;::Spine_centre_fraction_pt</a>.</p>

</div>
</div>
<a id="a67f784e7b3a898af6c60515042c3ea73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67f784e7b3a898af6c60515042c3ea73">&#9670;&nbsp;</a></span>spine_centre_fraction()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT , class INTERFACE_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html">oomph::BrethertonSpineMesh</a>&lt; ELEMENT, INTERFACE_ELEMENT &gt;::spine_centre_fraction </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Read the value of the spine centre's vertical fraction. </p>
<div class="fragment"><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    {</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      <span class="keywordflow">return</span> *<a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#af5e7951a89bc13d73f2b137947cda8a3">Spine_centre_fraction_pt</a>;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#af5e7951a89bc13d73f2b137947cda8a3">oomph::BrethertonSpineMesh&lt; ELEMENT, INTERFACE_ELEMENT &gt;::Spine_centre_fraction_pt</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a0dc35290fc96a075d864e79528e5fec8">oomph::BrethertonSpineMesh&lt; ELEMENT, INTERFACE_ELEMENT &gt;::spine_node_update_horizontal_transition_lower()</a>, <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#aa9fa4941d8fb02a388e933a7dd1c76a2">oomph::BrethertonSpineMesh&lt; ELEMENT, INTERFACE_ELEMENT &gt;::spine_node_update_horizontal_transition_upper()</a>, <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a9ec578183760e386ed5229ba193e1fdf">oomph::BrethertonSpineMesh&lt; ELEMENT, INTERFACE_ELEMENT &gt;::spine_node_update_vertical_transition_lower()</a>, and <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a6ddc62166abfd621219551957c9b1103">oomph::BrethertonSpineMesh&lt; ELEMENT, INTERFACE_ELEMENT &gt;::spine_node_update_vertical_transition_upper()</a>.</p>

</div>
</div>
<a id="a981301706d4940cfb24d3d769a7a523b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a981301706d4940cfb24d3d769a7a523b">&#9670;&nbsp;</a></span>spine_node_update()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT , class INTERFACE_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html">oomph::BrethertonSpineMesh</a>&lt; ELEMENT, INTERFACE_ELEMENT &gt;::spine_node_update </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dd/d78/classoomph_1_1SpineNode.html">SpineNode</a> *&#160;</td>
          <td class="paramname"><em>spine_node_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>General node update function implements pure virtual function defined in SpineMesh base class and performs specific update actions, depending on the node update fct id stored for each node. </p>

<p>Reimplemented from <a class="el" href="../../df/da5/classoomph_1_1SingleLayerSpineMesh.html#a364648c15ab29c0c8d1cf7c2bc4cb792">oomph::SingleLayerSpineMesh&lt; ELEMENT &gt;</a>.</p>
<div class="fragment"><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">id</span> = spine_node_pt-&gt;node_update_fct_id();</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      <span class="keywordflow">switch</span> (<span class="keywordtype">id</span>)</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;          <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a0446cb0efaa31739f51ae0534a73d116">spine_node_update_film_lower</a>(spine_node_pt);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;          <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a0dc35290fc96a075d864e79528e5fec8">spine_node_update_horizontal_transition_lower</a>(spine_node_pt);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;          <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a9ec578183760e386ed5229ba193e1fdf">spine_node_update_vertical_transition_lower</a>(spine_node_pt);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;          <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a6ddc62166abfd621219551957c9b1103">spine_node_update_vertical_transition_upper</a>(spine_node_pt);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="keywordflow">case</span> 4:</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;          <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#aa9fa4941d8fb02a388e933a7dd1c76a2">spine_node_update_horizontal_transition_upper</a>(spine_node_pt);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="keywordflow">case</span> 5:</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;          <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a3919bd086252db283ee5242b4688f8d1">spine_node_update_film_upper</a>(spine_node_pt);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="keywordflow">case</span> 6:</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;          <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a5a09b6d2f5e7ffd12a0ae882754ad818">spine_node_update_channel</a>(spine_node_pt);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;          std::ostringstream error_message;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;          error_message &lt;&lt; <span class="stringliteral">&quot;Incorrect spine update id &quot;</span> &lt;&lt; <span class="keywordtype">id</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;          <span class="keywordflow">throw</span> OomphLibError(error_message.str(),</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                              <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                              <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      }</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1BrethertonSpineMesh_html_a0446cb0efaa31739f51ae0534a73d116"><div class="ttname"><a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a0446cb0efaa31739f51ae0534a73d116">oomph::BrethertonSpineMesh::spine_node_update_film_lower</a></div><div class="ttdeci">void spine_node_update_film_lower(SpineNode *spine_node_pt)</div><div class="ttdef"><b>Definition:</b> bretherton_spine_mesh.template.h:208</div></div>
<div class="ttc" id="aclassoomph_1_1BrethertonSpineMesh_html_a0dc35290fc96a075d864e79528e5fec8"><div class="ttname"><a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a0dc35290fc96a075d864e79528e5fec8">oomph::BrethertonSpineMesh::spine_node_update_horizontal_transition_lower</a></div><div class="ttdeci">void spine_node_update_horizontal_transition_lower(SpineNode *spine_node_pt)</div><div class="ttdef"><b>Definition:</b> bretherton_spine_mesh.template.h:231</div></div>
<div class="ttc" id="aclassoomph_1_1BrethertonSpineMesh_html_a3919bd086252db283ee5242b4688f8d1"><div class="ttname"><a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a3919bd086252db283ee5242b4688f8d1">oomph::BrethertonSpineMesh::spine_node_update_film_upper</a></div><div class="ttdeci">void spine_node_update_film_upper(SpineNode *spine_node_pt)</div><div class="ttdef"><b>Definition:</b> bretherton_spine_mesh.template.h:440</div></div>
<div class="ttc" id="aclassoomph_1_1BrethertonSpineMesh_html_a5a09b6d2f5e7ffd12a0ae882754ad818"><div class="ttname"><a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a5a09b6d2f5e7ffd12a0ae882754ad818">oomph::BrethertonSpineMesh::spine_node_update_channel</a></div><div class="ttdeci">void spine_node_update_channel(SpineNode *spine_node_pt)</div><div class="ttdef"><b>Definition:</b> bretherton_spine_mesh.template.h:464</div></div>
<div class="ttc" id="aclassoomph_1_1BrethertonSpineMesh_html_a6ddc62166abfd621219551957c9b1103"><div class="ttname"><a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a6ddc62166abfd621219551957c9b1103">oomph::BrethertonSpineMesh::spine_node_update_vertical_transition_upper</a></div><div class="ttdeci">void spine_node_update_vertical_transition_upper(SpineNode *spine_node_pt)</div><div class="ttdef"><b>Definition:</b> bretherton_spine_mesh.template.h:335</div></div>
<div class="ttc" id="aclassoomph_1_1BrethertonSpineMesh_html_a9ec578183760e386ed5229ba193e1fdf"><div class="ttname"><a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a9ec578183760e386ed5229ba193e1fdf">oomph::BrethertonSpineMesh::spine_node_update_vertical_transition_lower</a></div><div class="ttdeci">void spine_node_update_vertical_transition_lower(SpineNode *spine_node_pt)</div><div class="ttdef"><b>Definition:</b> bretherton_spine_mesh.template.h:277</div></div>
<div class="ttc" id="aclassoomph_1_1BrethertonSpineMesh_html_aa9fa4941d8fb02a388e933a7dd1c76a2"><div class="ttname"><a href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#aa9fa4941d8fb02a388e933a7dd1c76a2">oomph::BrethertonSpineMesh::spine_node_update_horizontal_transition_upper</a></div><div class="ttdeci">void spine_node_update_horizontal_transition_upper(SpineNode *spine_node_pt)</div><div class="ttdef"><b>Definition:</b> bretherton_spine_mesh.template.h:393</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d78/classoomph_1_1SpineNode.html#ad805d587c63a24940b7de0fa99fd8101">oomph::SpineNode::node_update_fct_id()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a5a09b6d2f5e7ffd12a0ae882754ad818">oomph::BrethertonSpineMesh&lt; ELEMENT, INTERFACE_ELEMENT &gt;::spine_node_update_channel()</a>, <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a0446cb0efaa31739f51ae0534a73d116">oomph::BrethertonSpineMesh&lt; ELEMENT, INTERFACE_ELEMENT &gt;::spine_node_update_film_lower()</a>, <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a3919bd086252db283ee5242b4688f8d1">oomph::BrethertonSpineMesh&lt; ELEMENT, INTERFACE_ELEMENT &gt;::spine_node_update_film_upper()</a>, <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a0dc35290fc96a075d864e79528e5fec8">oomph::BrethertonSpineMesh&lt; ELEMENT, INTERFACE_ELEMENT &gt;::spine_node_update_horizontal_transition_lower()</a>, <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#aa9fa4941d8fb02a388e933a7dd1c76a2">oomph::BrethertonSpineMesh&lt; ELEMENT, INTERFACE_ELEMENT &gt;::spine_node_update_horizontal_transition_upper()</a>, <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a9ec578183760e386ed5229ba193e1fdf">oomph::BrethertonSpineMesh&lt; ELEMENT, INTERFACE_ELEMENT &gt;::spine_node_update_vertical_transition_lower()</a>, and <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a6ddc62166abfd621219551957c9b1103">oomph::BrethertonSpineMesh&lt; ELEMENT, INTERFACE_ELEMENT &gt;::spine_node_update_vertical_transition_upper()</a>.</p>

</div>
</div>
<a id="a5a09b6d2f5e7ffd12a0ae882754ad818"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a09b6d2f5e7ffd12a0ae882754ad818">&#9670;&nbsp;</a></span>spine_node_update_channel()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT , class INTERFACE_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html">oomph::BrethertonSpineMesh</a>&lt; ELEMENT, INTERFACE_ELEMENT &gt;::spine_node_update_channel </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dd/d78/classoomph_1_1SpineNode.html">SpineNode</a> *&#160;</td>
          <td class="paramname"><em>spine_node_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Update function for the nodes in the channel region ahead of the finger tip: Nodes are evenly distributed along vertical lines between the top and bottom walls </p>
<div class="fragment"><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    {</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      <span class="comment">// Get fraction along the spine</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a> = spine_node_pt-&gt;fraction();</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160; </div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;      <span class="comment">// Get upper and lower local coordinates</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      Vector&lt;double&gt; s_lo(1), s_up(1);</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;      s_lo[0] = spine_node_pt-&gt;spine_pt()-&gt;geom_parameter(0);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;      s_up[0] = spine_node_pt-&gt;spine_pt()-&gt;geom_parameter(1);</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160; </div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;      <span class="comment">// Get position vector to lower wall</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      Vector&lt;double&gt; r_lo(2), r_up(2);</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      spine_node_pt-&gt;spine_pt()-&gt;geom_object_pt(0)-&gt;position(s_lo, r_lo);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      spine_node_pt-&gt;spine_pt()-&gt;geom_object_pt(1)-&gt;position(s_up, r_up);</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160; </div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      <span class="comment">// Update the nodal position</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      spine_node_pt-&gt;x(0) = r_lo[0] + <a class="code" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a> * (r_up[0] - r_lo[0]);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      spine_node_pt-&gt;x(1) = r_lo[1] + <a class="code" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a> * (r_up[1] - r_lo[1]);</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    }</div>
<div class="ttc" id="aMatrix__resize__int_8cpp_html_aab236ce080522c9832217fd5f157541b"><div class="ttname"><a href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a></div><div class="ttdeci">RowVector3d w</div><div class="ttdef"><b>Definition:</b> Matrix_resize_int.cpp:3</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d78/classoomph_1_1SpineNode.html#aea50ab25f54e35d2121b090ae7b0c313">oomph::SpineNode::fraction()</a>, <a class="el" href="../../dc/d4c/classoomph_1_1Spine.html#a68253ccfbfdf33e773dd300dcc4ec42c">oomph::Spine::geom_object_pt()</a>, <a class="el" href="../../dc/d4c/classoomph_1_1Spine.html#a8d8bd170521e615dda38a0d3fdef09cb">oomph::Spine::geom_parameter()</a>, <a class="el" href="../../da/ddd/classoomph_1_1GeomObject.html#a0d04c9d4667817f3ef24bb660fd56065">oomph::GeomObject::position()</a>, <a class="el" href="../../dd/d78/classoomph_1_1SpineNode.html#acb15e93d53f62e899a3c126736b41079">oomph::SpineNode::spine_pt()</a>, <a class="el" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a>, and <a class="el" href="../../dc/db7/classoomph_1_1Node.html#a056f8e82da938369cd38541c5cdc598a">oomph::Node::x()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a981301706d4940cfb24d3d769a7a523b">oomph::BrethertonSpineMesh&lt; ELEMENT, INTERFACE_ELEMENT &gt;::spine_node_update()</a>.</p>

</div>
</div>
<a id="a0446cb0efaa31739f51ae0534a73d116"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0446cb0efaa31739f51ae0534a73d116">&#9670;&nbsp;</a></span>spine_node_update_film_lower()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT , class INTERFACE_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html">oomph::BrethertonSpineMesh</a>&lt; ELEMENT, INTERFACE_ELEMENT &gt;::spine_node_update_film_lower </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dd/d78/classoomph_1_1SpineNode.html">SpineNode</a> *&#160;</td>
          <td class="paramname"><em>spine_node_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Update function for the deposited film region in the lower part of the domain: Vertical spines </p>
<div class="fragment"><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      <span class="comment">// Get fraction along the spine</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a> = spine_node_pt-&gt;fraction();</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      <span class="comment">// Get spine height</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      <span class="keywordtype">double</span> h = spine_node_pt-&gt;h();</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      <span class="comment">// Get wall coordinate</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      Vector&lt;double&gt; s_lo(1);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      s_lo[0] = spine_node_pt-&gt;spine_pt()-&gt;geom_parameter(0);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      <span class="comment">// Get position vector to wall</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      Vector&lt;double&gt; r_wall_lo(2);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      spine_node_pt-&gt;spine_pt()-&gt;geom_object_pt(0)-&gt;position(s_lo, r_wall_lo);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      <span class="comment">// Update the nodal position</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      spine_node_pt-&gt;x(0) = r_wall_lo[0];</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      spine_node_pt-&gt;x(1) = r_wall_lo[1] + <a class="code" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a> * h;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d78/classoomph_1_1SpineNode.html#aea50ab25f54e35d2121b090ae7b0c313">oomph::SpineNode::fraction()</a>, <a class="el" href="../../dc/d4c/classoomph_1_1Spine.html#a68253ccfbfdf33e773dd300dcc4ec42c">oomph::Spine::geom_object_pt()</a>, <a class="el" href="../../dc/d4c/classoomph_1_1Spine.html#a8d8bd170521e615dda38a0d3fdef09cb">oomph::Spine::geom_parameter()</a>, <a class="el" href="../../dd/d78/classoomph_1_1SpineNode.html#a531445631907d2b2164c26f25763fb57">oomph::SpineNode::h()</a>, <a class="el" href="../../da/ddd/classoomph_1_1GeomObject.html#a0d04c9d4667817f3ef24bb660fd56065">oomph::GeomObject::position()</a>, <a class="el" href="../../dd/d78/classoomph_1_1SpineNode.html#acb15e93d53f62e899a3c126736b41079">oomph::SpineNode::spine_pt()</a>, <a class="el" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a>, and <a class="el" href="../../dc/db7/classoomph_1_1Node.html#a056f8e82da938369cd38541c5cdc598a">oomph::Node::x()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a981301706d4940cfb24d3d769a7a523b">oomph::BrethertonSpineMesh&lt; ELEMENT, INTERFACE_ELEMENT &gt;::spine_node_update()</a>.</p>

</div>
</div>
<a id="a3919bd086252db283ee5242b4688f8d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3919bd086252db283ee5242b4688f8d1">&#9670;&nbsp;</a></span>spine_node_update_film_upper()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT , class INTERFACE_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html">oomph::BrethertonSpineMesh</a>&lt; ELEMENT, INTERFACE_ELEMENT &gt;::spine_node_update_film_upper </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dd/d78/classoomph_1_1SpineNode.html">SpineNode</a> *&#160;</td>
          <td class="paramname"><em>spine_node_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Update function for the deposited film region in the upper part of the domain: Vertical spines </p>
<div class="fragment"><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    {</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      <span class="comment">// Get fraction along the spine</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a> = spine_node_pt-&gt;fraction();</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      <span class="comment">// Get spine height</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      <span class="keywordtype">double</span> h = spine_node_pt-&gt;h();</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160; </div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;      <span class="comment">// Get wall coordinate</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;      Vector&lt;double&gt; s_up(1);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      s_up[0] = spine_node_pt-&gt;spine_pt()-&gt;geom_parameter(0);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160; </div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      <span class="comment">// Get position vector to wall</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      Vector&lt;double&gt; r_wall_up(2);</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      spine_node_pt-&gt;spine_pt()-&gt;geom_object_pt(0)-&gt;position(s_up, r_wall_up);</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160; </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      <span class="comment">// Update the nodal position</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      spine_node_pt-&gt;x(0) = r_wall_up[0];</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;      spine_node_pt-&gt;x(1) = r_wall_up[1] - <a class="code" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a> * h;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d78/classoomph_1_1SpineNode.html#aea50ab25f54e35d2121b090ae7b0c313">oomph::SpineNode::fraction()</a>, <a class="el" href="../../dc/d4c/classoomph_1_1Spine.html#a68253ccfbfdf33e773dd300dcc4ec42c">oomph::Spine::geom_object_pt()</a>, <a class="el" href="../../dc/d4c/classoomph_1_1Spine.html#a8d8bd170521e615dda38a0d3fdef09cb">oomph::Spine::geom_parameter()</a>, <a class="el" href="../../dd/d78/classoomph_1_1SpineNode.html#a531445631907d2b2164c26f25763fb57">oomph::SpineNode::h()</a>, <a class="el" href="../../da/ddd/classoomph_1_1GeomObject.html#a0d04c9d4667817f3ef24bb660fd56065">oomph::GeomObject::position()</a>, <a class="el" href="../../dd/d78/classoomph_1_1SpineNode.html#acb15e93d53f62e899a3c126736b41079">oomph::SpineNode::spine_pt()</a>, <a class="el" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a>, and <a class="el" href="../../dc/db7/classoomph_1_1Node.html#a056f8e82da938369cd38541c5cdc598a">oomph::Node::x()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a981301706d4940cfb24d3d769a7a523b">oomph::BrethertonSpineMesh&lt; ELEMENT, INTERFACE_ELEMENT &gt;::spine_node_update()</a>.</p>

</div>
</div>
<a id="a0dc35290fc96a075d864e79528e5fec8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0dc35290fc96a075d864e79528e5fec8">&#9670;&nbsp;</a></span>spine_node_update_horizontal_transition_lower()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT , class INTERFACE_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html">oomph::BrethertonSpineMesh</a>&lt; ELEMENT, INTERFACE_ELEMENT &gt;::spine_node_update_horizontal_transition_lower </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dd/d78/classoomph_1_1SpineNode.html">SpineNode</a> *&#160;</td>
          <td class="paramname"><em>spine_node_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Update function for the horizontal transitition region in the lower part of the domain: Spine points from wall to origin </p>
<div class="fragment"><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      <span class="comment">// Get fraction along the spine</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a> = spine_node_pt-&gt;fraction();</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      <span class="comment">// Get spine height</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      <span class="keywordtype">double</span> h = spine_node_pt-&gt;h();</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      <span class="comment">// Get wall coordinate</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      Vector&lt;double&gt; s_lo(1);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      s_lo[0] = spine_node_pt-&gt;spine_pt()-&gt;geom_parameter(0);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <span class="comment">// Get position vector to wall</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      Vector&lt;double&gt; r_wall_lo(2);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      spine_node_pt-&gt;spine_pt()-&gt;geom_object_pt(0)-&gt;position(s_lo, r_wall_lo);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160; </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      <span class="comment">// Get the spine centre</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      Vector&lt;double&gt; s_transition_lo(1), s_transition_up(1);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      s_transition_lo[0] = spine_node_pt-&gt;spine_pt()-&gt;geom_parameter(1);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      s_transition_up[0] = spine_node_pt-&gt;spine_pt()-&gt;geom_parameter(2);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      Vector&lt;double&gt; r_transition_lo(2), r_transition_up(2);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      spine_node_pt-&gt;spine_pt()-&gt;geom_object_pt(1)-&gt;position(s_transition_lo,</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                                                             r_transition_lo);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      spine_node_pt-&gt;spine_pt()-&gt;geom_object_pt(2)-&gt;position(s_transition_up,</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                                                             r_transition_up);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      Vector&lt;double&gt; spine_centre(2);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      <span class="comment">// Horizontal position is always halfway between the walls</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      spine_centre[0] = 0.5 * (r_transition_lo[0] + r_transition_up[0]);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      <span class="comment">// Vertical spine centre is given by fraction between the walls</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      spine_centre[1] =</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        r_transition_lo[1] +</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a67f784e7b3a898af6c60515042c3ea73">spine_centre_fraction</a>() * (r_transition_up[1] - r_transition_lo[1]);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      <span class="comment">// Get vector twoards spine origin</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      Vector&lt;double&gt; <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>(2);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[0] = spine_centre[0] - r_wall_lo[0];</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[1] = spine_centre[1] - r_wall_lo[1];</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      <span class="keywordtype">double</span> inv_length = 1.0 / <a class="code" href="../../d8/de9/AnnoyingScalar_8h.html#abe7b2405f1f05f9997193c680e8e2fe0">sqrt</a>(<a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[0] * <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[0] + <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[1] * <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[1]);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      <span class="comment">// Update the nodal position</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      spine_node_pt-&gt;x(0) = r_wall_lo[0] + <a class="code" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a> * h * <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[0] * inv_length;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      spine_node_pt-&gt;x(1) = r_wall_lo[1] + <a class="code" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a> * h * <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[1] * inv_length;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d78/classoomph_1_1SpineNode.html#aea50ab25f54e35d2121b090ae7b0c313">oomph::SpineNode::fraction()</a>, <a class="el" href="../../dc/d4c/classoomph_1_1Spine.html#a68253ccfbfdf33e773dd300dcc4ec42c">oomph::Spine::geom_object_pt()</a>, <a class="el" href="../../dc/d4c/classoomph_1_1Spine.html#a8d8bd170521e615dda38a0d3fdef09cb">oomph::Spine::geom_parameter()</a>, <a class="el" href="../../dd/d78/classoomph_1_1SpineNode.html#a531445631907d2b2164c26f25763fb57">oomph::SpineNode::h()</a>, <a class="el" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>, <a class="el" href="../../da/ddd/classoomph_1_1GeomObject.html#a0d04c9d4667817f3ef24bb660fd56065">oomph::GeomObject::position()</a>, <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a67f784e7b3a898af6c60515042c3ea73">oomph::BrethertonSpineMesh&lt; ELEMENT, INTERFACE_ELEMENT &gt;::spine_centre_fraction()</a>, <a class="el" href="../../dd/d78/classoomph_1_1SpineNode.html#acb15e93d53f62e899a3c126736b41079">oomph::SpineNode::spine_pt()</a>, <a class="el" href="../../d8/de9/AnnoyingScalar_8h.html#abe7b2405f1f05f9997193c680e8e2fe0">sqrt()</a>, <a class="el" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a>, and <a class="el" href="../../dc/db7/classoomph_1_1Node.html#a056f8e82da938369cd38541c5cdc598a">oomph::Node::x()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a981301706d4940cfb24d3d769a7a523b">oomph::BrethertonSpineMesh&lt; ELEMENT, INTERFACE_ELEMENT &gt;::spine_node_update()</a>.</p>

</div>
</div>
<a id="aa9fa4941d8fb02a388e933a7dd1c76a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9fa4941d8fb02a388e933a7dd1c76a2">&#9670;&nbsp;</a></span>spine_node_update_horizontal_transition_upper()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT , class INTERFACE_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html">oomph::BrethertonSpineMesh</a>&lt; ELEMENT, INTERFACE_ELEMENT &gt;::spine_node_update_horizontal_transition_upper </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dd/d78/classoomph_1_1SpineNode.html">SpineNode</a> *&#160;</td>
          <td class="paramname"><em>spine_node_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Update function for the horizontal transitition region in the upper part of the domain: Spine points towards origin </p>
<div class="fragment"><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    {</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      <span class="comment">// Get fraction along the spine</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a> = spine_node_pt-&gt;fraction();</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      <span class="comment">// Get spine height</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      <span class="keywordtype">double</span> h = spine_node_pt-&gt;h();</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160; </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;      <span class="comment">// Get wall coordinate</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      Vector&lt;double&gt; s_up(1);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      s_up[0] = spine_node_pt-&gt;spine_pt()-&gt;geom_parameter(0);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160; </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      <span class="comment">// Get position vector to wall</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;      Vector&lt;double&gt; r_wall_up(2);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;      spine_node_pt-&gt;spine_pt()-&gt;geom_object_pt(0)-&gt;position(s_up, r_wall_up);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160; </div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      <span class="comment">// Get the spine centre</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      Vector&lt;double&gt; s_transition_lo(1), s_transition_up(1);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      s_transition_lo[0] = spine_node_pt-&gt;spine_pt()-&gt;geom_parameter(1);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      s_transition_up[0] = spine_node_pt-&gt;spine_pt()-&gt;geom_parameter(2);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      Vector&lt;double&gt; r_transition_lo(2), r_transition_up(2);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      spine_node_pt-&gt;spine_pt()-&gt;geom_object_pt(1)-&gt;position(s_transition_lo,</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                                                             r_transition_lo);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      spine_node_pt-&gt;spine_pt()-&gt;geom_object_pt(2)-&gt;position(s_transition_up,</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                                                             r_transition_up);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      Vector&lt;double&gt; spine_centre(2);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      <span class="comment">// Horizontal position is always halfway between the walls</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      spine_centre[0] = 0.5 * (r_transition_lo[0] + r_transition_up[0]);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      <span class="comment">// Vertical spine centre is given by fraction between the walls</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      spine_centre[1] =</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        r_transition_lo[1] +</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a67f784e7b3a898af6c60515042c3ea73">spine_centre_fraction</a>() * (r_transition_up[1] - r_transition_lo[1]);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160; </div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      <span class="comment">// Get vector towards origin</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      Vector&lt;double&gt; <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>(2);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[0] = spine_centre[0] - r_wall_up[0];</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[1] = spine_centre[1] - r_wall_up[1];</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      <span class="keywordtype">double</span> inv_length = 1.0 / <a class="code" href="../../d8/de9/AnnoyingScalar_8h.html#abe7b2405f1f05f9997193c680e8e2fe0">sqrt</a>(<a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[0] * <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[0] + <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[1] * <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[1]);</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160; </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;      <span class="comment">// Update the nodal position</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      spine_node_pt-&gt;x(0) = r_wall_up[0] + <a class="code" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a> * h * <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[0] * inv_length;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      spine_node_pt-&gt;x(1) = r_wall_up[1] + <a class="code" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a> * h * <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[1] * inv_length;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d78/classoomph_1_1SpineNode.html#aea50ab25f54e35d2121b090ae7b0c313">oomph::SpineNode::fraction()</a>, <a class="el" href="../../dc/d4c/classoomph_1_1Spine.html#a68253ccfbfdf33e773dd300dcc4ec42c">oomph::Spine::geom_object_pt()</a>, <a class="el" href="../../dc/d4c/classoomph_1_1Spine.html#a8d8bd170521e615dda38a0d3fdef09cb">oomph::Spine::geom_parameter()</a>, <a class="el" href="../../dd/d78/classoomph_1_1SpineNode.html#a531445631907d2b2164c26f25763fb57">oomph::SpineNode::h()</a>, <a class="el" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>, <a class="el" href="../../da/ddd/classoomph_1_1GeomObject.html#a0d04c9d4667817f3ef24bb660fd56065">oomph::GeomObject::position()</a>, <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a67f784e7b3a898af6c60515042c3ea73">oomph::BrethertonSpineMesh&lt; ELEMENT, INTERFACE_ELEMENT &gt;::spine_centre_fraction()</a>, <a class="el" href="../../dd/d78/classoomph_1_1SpineNode.html#acb15e93d53f62e899a3c126736b41079">oomph::SpineNode::spine_pt()</a>, <a class="el" href="../../d8/de9/AnnoyingScalar_8h.html#abe7b2405f1f05f9997193c680e8e2fe0">sqrt()</a>, <a class="el" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a>, and <a class="el" href="../../dc/db7/classoomph_1_1Node.html#a056f8e82da938369cd38541c5cdc598a">oomph::Node::x()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a981301706d4940cfb24d3d769a7a523b">oomph::BrethertonSpineMesh&lt; ELEMENT, INTERFACE_ELEMENT &gt;::spine_node_update()</a>.</p>

</div>
</div>
<a id="a9ec578183760e386ed5229ba193e1fdf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ec578183760e386ed5229ba193e1fdf">&#9670;&nbsp;</a></span>spine_node_update_vertical_transition_lower()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT , class INTERFACE_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html">oomph::BrethertonSpineMesh</a>&lt; ELEMENT, INTERFACE_ELEMENT &gt;::spine_node_update_vertical_transition_lower </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dd/d78/classoomph_1_1SpineNode.html">SpineNode</a> *&#160;</td>
          <td class="paramname"><em>spine_node_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Update function for the vertical transitition region in the lower part of the domain: Spine points to origin </p>
<div class="fragment"><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      <span class="comment">// Get fraction along the spine</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a> = spine_node_pt-&gt;fraction();</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      <span class="comment">// Get spine height</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      <span class="keywordtype">double</span> h = spine_node_pt-&gt;h();</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160; </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      <span class="comment">// Get local coordinates</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      Vector&lt;double&gt; s_lo(1), s_up(1);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      s_lo[0] = spine_node_pt-&gt;spine_pt()-&gt;geom_parameter(0);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      s_up[0] = spine_node_pt-&gt;spine_pt()-&gt;geom_parameter(1);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      <span class="comment">// Get position vector to wall</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      Vector&lt;double&gt; r_lo(2), r_up(2);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      spine_node_pt-&gt;spine_pt()-&gt;geom_object_pt(0)-&gt;position(s_lo, r_lo);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      spine_node_pt-&gt;spine_pt()-&gt;geom_object_pt(1)-&gt;position(s_up, r_up);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      <span class="comment">// Get fraction along vertical line across</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      <span class="keywordtype">double</span> vertical_fraction = spine_node_pt-&gt;spine_pt()-&gt;geom_parameter(2);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      <span class="comment">// Origin of spine</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      Vector&lt;double&gt; <a class="code" href="../../d9/d37/namespaceGlobalParameters.html#a48941328f0bded62ed7a778062b03dd7">S0</a>(2);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      <a class="code" href="../../d9/d37/namespaceGlobalParameters.html#a48941328f0bded62ed7a778062b03dd7">S0</a>[0] = r_lo[0] + vertical_fraction * (r_up[0] - r_lo[0]);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      <a class="code" href="../../d9/d37/namespaceGlobalParameters.html#a48941328f0bded62ed7a778062b03dd7">S0</a>[1] = r_lo[1] + vertical_fraction * (r_up[1] - r_lo[1]);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160; </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160; </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      <span class="comment">// Get the spine centre</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      Vector&lt;double&gt; s_transition_lo(1), s_transition_up(1);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      s_transition_lo[0] = spine_node_pt-&gt;spine_pt()-&gt;geom_parameter(3);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      s_transition_up[0] = spine_node_pt-&gt;spine_pt()-&gt;geom_parameter(4);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      Vector&lt;double&gt; r_transition_lo(2), r_transition_up(2);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      spine_node_pt-&gt;spine_pt()-&gt;geom_object_pt(2)-&gt;position(s_transition_lo,</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                                                             r_transition_lo);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      spine_node_pt-&gt;spine_pt()-&gt;geom_object_pt(3)-&gt;position(s_transition_up,</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                                                             r_transition_up);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      Vector&lt;double&gt; spine_centre(2);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      <span class="comment">// Horizontal position is always halfway between the walls</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      spine_centre[0] = 0.5 * (r_transition_lo[0] + r_transition_up[0]);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      <span class="comment">// Vertical spine centre is given by fraction between the walls</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      spine_centre[1] =</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        r_transition_lo[1] +</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a67f784e7b3a898af6c60515042c3ea73">spine_centre_fraction</a>() * (r_transition_up[1] - r_transition_lo[1]);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      <span class="comment">// Get vector towards origin</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      Vector&lt;double&gt; <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>(2);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[0] = spine_centre[0] - <a class="code" href="../../d9/d37/namespaceGlobalParameters.html#a48941328f0bded62ed7a778062b03dd7">S0</a>[0];</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[1] = spine_centre[1] - <a class="code" href="../../d9/d37/namespaceGlobalParameters.html#a48941328f0bded62ed7a778062b03dd7">S0</a>[1];</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      <span class="keywordtype">double</span> inv_length = 1.0 / <a class="code" href="../../d8/de9/AnnoyingScalar_8h.html#abe7b2405f1f05f9997193c680e8e2fe0">sqrt</a>(<a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[0] * <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[0] + <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[1] * <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[1]);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      <span class="comment">// Update the nodal position</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      spine_node_pt-&gt;x(0) = <a class="code" href="../../d9/d37/namespaceGlobalParameters.html#a48941328f0bded62ed7a778062b03dd7">S0</a>[0] + <a class="code" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a> * h * <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[0] * inv_length;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      spine_node_pt-&gt;x(1) = <a class="code" href="../../d9/d37/namespaceGlobalParameters.html#a48941328f0bded62ed7a778062b03dd7">S0</a>[1] + <a class="code" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a> * h * <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[1] * inv_length;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d78/classoomph_1_1SpineNode.html#aea50ab25f54e35d2121b090ae7b0c313">oomph::SpineNode::fraction()</a>, <a class="el" href="../../dc/d4c/classoomph_1_1Spine.html#a68253ccfbfdf33e773dd300dcc4ec42c">oomph::Spine::geom_object_pt()</a>, <a class="el" href="../../dc/d4c/classoomph_1_1Spine.html#a8d8bd170521e615dda38a0d3fdef09cb">oomph::Spine::geom_parameter()</a>, <a class="el" href="../../dd/d78/classoomph_1_1SpineNode.html#a531445631907d2b2164c26f25763fb57">oomph::SpineNode::h()</a>, <a class="el" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>, <a class="el" href="../../da/ddd/classoomph_1_1GeomObject.html#a0d04c9d4667817f3ef24bb660fd56065">oomph::GeomObject::position()</a>, <a class="el" href="../../d9/d37/namespaceGlobalParameters.html#a48941328f0bded62ed7a778062b03dd7">GlobalParameters::S0</a>, <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a67f784e7b3a898af6c60515042c3ea73">oomph::BrethertonSpineMesh&lt; ELEMENT, INTERFACE_ELEMENT &gt;::spine_centre_fraction()</a>, <a class="el" href="../../dd/d78/classoomph_1_1SpineNode.html#acb15e93d53f62e899a3c126736b41079">oomph::SpineNode::spine_pt()</a>, <a class="el" href="../../d8/de9/AnnoyingScalar_8h.html#abe7b2405f1f05f9997193c680e8e2fe0">sqrt()</a>, <a class="el" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a>, and <a class="el" href="../../dc/db7/classoomph_1_1Node.html#a056f8e82da938369cd38541c5cdc598a">oomph::Node::x()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a981301706d4940cfb24d3d769a7a523b">oomph::BrethertonSpineMesh&lt; ELEMENT, INTERFACE_ELEMENT &gt;::spine_node_update()</a>.</p>

</div>
</div>
<a id="a6ddc62166abfd621219551957c9b1103"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ddc62166abfd621219551957c9b1103">&#9670;&nbsp;</a></span>spine_node_update_vertical_transition_upper()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT , class INTERFACE_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html">oomph::BrethertonSpineMesh</a>&lt; ELEMENT, INTERFACE_ELEMENT &gt;::spine_node_update_vertical_transition_upper </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dd/d78/classoomph_1_1SpineNode.html">SpineNode</a> *&#160;</td>
          <td class="paramname"><em>spine_node_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Update function for the vertical transitition region in the upper part of the domain: Spine points to origin </p>
<div class="fragment"><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    {</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      <span class="comment">// Get fraction along the spine</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a> = spine_node_pt-&gt;fraction();</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      <span class="comment">// Get spine height</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      <span class="keywordtype">double</span> h = spine_node_pt-&gt;h();</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160; </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      <span class="comment">// Get local coordinates</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      Vector&lt;double&gt; s_lo(1), s_up(1);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      s_lo[0] = spine_node_pt-&gt;spine_pt()-&gt;geom_parameter(0);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      s_up[0] = spine_node_pt-&gt;spine_pt()-&gt;geom_parameter(1);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160; </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      <span class="comment">// Get position vector to wall</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      Vector&lt;double&gt; r_lo(2), r_up(2);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      spine_node_pt-&gt;spine_pt()-&gt;geom_object_pt(0)-&gt;position(s_lo, r_lo);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      spine_node_pt-&gt;spine_pt()-&gt;geom_object_pt(1)-&gt;position(s_up, r_up);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160; </div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      <span class="comment">// Get fraction along vertical line across</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      <span class="keywordtype">double</span> vertical_fraction = spine_node_pt-&gt;spine_pt()-&gt;geom_parameter(2);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160; </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      <span class="comment">// Origin of spine</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      Vector&lt;double&gt; <a class="code" href="../../d9/d37/namespaceGlobalParameters.html#a48941328f0bded62ed7a778062b03dd7">S0</a>(2);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      <a class="code" href="../../d9/d37/namespaceGlobalParameters.html#a48941328f0bded62ed7a778062b03dd7">S0</a>[0] = r_lo[0] + vertical_fraction * (r_up[0] - r_lo[0]);</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      <a class="code" href="../../d9/d37/namespaceGlobalParameters.html#a48941328f0bded62ed7a778062b03dd7">S0</a>[1] = r_lo[1] + vertical_fraction * (r_up[1] - r_lo[1]);</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160; </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      <span class="comment">// Get the spine centre</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      Vector&lt;double&gt; s_transition_lo(1), s_transition_up(1);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      s_transition_lo[0] = spine_node_pt-&gt;spine_pt()-&gt;geom_parameter(3);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      s_transition_up[0] = spine_node_pt-&gt;spine_pt()-&gt;geom_parameter(4);</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      Vector&lt;double&gt; r_transition_lo(2), r_transition_up(2);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      spine_node_pt-&gt;spine_pt()-&gt;geom_object_pt(2)-&gt;position(s_transition_lo,</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                                                             r_transition_lo);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      spine_node_pt-&gt;spine_pt()-&gt;geom_object_pt(3)-&gt;position(s_transition_up,</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                                                             r_transition_up);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160; </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      Vector&lt;double&gt; spine_centre(2);</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;      <span class="comment">// Horizontal position is always halfway between the walls</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      spine_centre[0] = 0.5 * (r_transition_lo[0] + r_transition_up[0]);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      <span class="comment">// Vertical spine centre is given by fraction between the walls</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      spine_centre[1] =</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        r_transition_lo[1] +</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        <a class="code" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a67f784e7b3a898af6c60515042c3ea73">spine_centre_fraction</a>() * (r_transition_up[1] - r_transition_lo[1]);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      <span class="comment">// Get vector towards origin</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      Vector&lt;double&gt; <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>(2);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[0] = spine_centre[0] - <a class="code" href="../../d9/d37/namespaceGlobalParameters.html#a48941328f0bded62ed7a778062b03dd7">S0</a>[0];</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[1] = spine_centre[1] - <a class="code" href="../../d9/d37/namespaceGlobalParameters.html#a48941328f0bded62ed7a778062b03dd7">S0</a>[1];</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      <span class="keywordtype">double</span> inv_length = 1.0 / <a class="code" href="../../d8/de9/AnnoyingScalar_8h.html#abe7b2405f1f05f9997193c680e8e2fe0">sqrt</a>(<a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[0] * <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[0] + <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[1] * <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[1]);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      <span class="comment">// Update the nodal position</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      spine_node_pt-&gt;x(0) = <a class="code" href="../../d9/d37/namespaceGlobalParameters.html#a48941328f0bded62ed7a778062b03dd7">S0</a>[0] + <a class="code" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a> * h * <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[0] * inv_length;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      spine_node_pt-&gt;x(1) = <a class="code" href="../../d9/d37/namespaceGlobalParameters.html#a48941328f0bded62ed7a778062b03dd7">S0</a>[1] + <a class="code" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a> * h * <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>[1] * inv_length;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d78/classoomph_1_1SpineNode.html#aea50ab25f54e35d2121b090ae7b0c313">oomph::SpineNode::fraction()</a>, <a class="el" href="../../dc/d4c/classoomph_1_1Spine.html#a68253ccfbfdf33e773dd300dcc4ec42c">oomph::Spine::geom_object_pt()</a>, <a class="el" href="../../dc/d4c/classoomph_1_1Spine.html#a8d8bd170521e615dda38a0d3fdef09cb">oomph::Spine::geom_parameter()</a>, <a class="el" href="../../dd/d78/classoomph_1_1SpineNode.html#a531445631907d2b2164c26f25763fb57">oomph::SpineNode::h()</a>, <a class="el" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>, <a class="el" href="../../da/ddd/classoomph_1_1GeomObject.html#a0d04c9d4667817f3ef24bb660fd56065">oomph::GeomObject::position()</a>, <a class="el" href="../../d9/d37/namespaceGlobalParameters.html#a48941328f0bded62ed7a778062b03dd7">GlobalParameters::S0</a>, <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a67f784e7b3a898af6c60515042c3ea73">oomph::BrethertonSpineMesh&lt; ELEMENT, INTERFACE_ELEMENT &gt;::spine_centre_fraction()</a>, <a class="el" href="../../dd/d78/classoomph_1_1SpineNode.html#acb15e93d53f62e899a3c126736b41079">oomph::SpineNode::spine_pt()</a>, <a class="el" href="../../d8/de9/AnnoyingScalar_8h.html#abe7b2405f1f05f9997193c680e8e2fe0">sqrt()</a>, <a class="el" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a>, and <a class="el" href="../../dc/db7/classoomph_1_1Node.html#a056f8e82da938369cd38541c5cdc598a">oomph::Node::x()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a981301706d4940cfb24d3d769a7a523b">oomph::BrethertonSpineMesh&lt; ELEMENT, INTERFACE_ELEMENT &gt;::spine_node_update()</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a207b6a5e52ce95c0a6125f56eb22b98d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a207b6a5e52ce95c0a6125f56eb22b98d">&#9670;&nbsp;</a></span>Bulk_element_pt</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT , class INTERFACE_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt;<a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html">FiniteElement</a>*&gt; <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html">oomph::BrethertonSpineMesh</a>&lt; ELEMENT, INTERFACE_ELEMENT &gt;::Bulk_element_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Vector of pointers to element in the fluid layer. </p>

<p class="reference">Referenced by <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a93770708eb4769c481d2f811f18f005c">oomph::BrethertonSpineMesh&lt; ELEMENT, INTERFACE_ELEMENT &gt;::bulk_element_pt()</a>, and <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a47184866746a1fce6dd0ca27ab7e17ce">oomph::BrethertonSpineMesh&lt; ELEMENT, INTERFACE_ELEMENT &gt;::nbulk()</a>.</p>

</div>
</div>
<a id="a81ee86c0c747947dab52073c221d53c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81ee86c0c747947dab52073c221d53c1">&#9670;&nbsp;</a></span>Control_element_pt</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT , class INTERFACE_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ELEMENT* <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html">oomph::BrethertonSpineMesh</a>&lt; ELEMENT, INTERFACE_ELEMENT &gt;::Control_element_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Pointer to control element (just under the symmetry line near the bubble tip; the bubble tip is located at s=[1.0,1.0] in this element </p>

<p class="reference">Referenced by <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a9b02893724c76098f75d9285e9985f4b">oomph::BrethertonSpineMesh&lt; ELEMENT, INTERFACE_ELEMENT &gt;::control_element_pt()</a>.</p>

</div>
</div>
<a id="a306cf8ae8f91a81054904de64195bb16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a306cf8ae8f91a81054904de64195bb16">&#9670;&nbsp;</a></span>Default_spine_centre_fraction</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT , class INTERFACE_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html">oomph::BrethertonSpineMesh</a>&lt; ELEMENT, INTERFACE_ELEMENT &gt;::Default_spine_centre_fraction</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Default spine fraction. </p>

</div>
</div>
<a id="a3d711e1bc9d751ab14662f6839a900e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d711e1bc9d751ab14662f6839a900e3">&#9670;&nbsp;</a></span>H</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT , class INTERFACE_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html">oomph::BrethertonSpineMesh</a>&lt; ELEMENT, INTERFACE_ELEMENT &gt;::H</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Thickness of deposited film. </p>

</div>
</div>
<a id="a7422b912ff7ad780777205f0cbe83362"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7422b912ff7ad780777205f0cbe83362">&#9670;&nbsp;</a></span>Interface_element_pt</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT , class INTERFACE_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt;<a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html">FiniteElement</a>*&gt; <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html">oomph::BrethertonSpineMesh</a>&lt; ELEMENT, INTERFACE_ELEMENT &gt;::Interface_element_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Vector of pointers to interface elements. </p>

<p class="reference">Referenced by <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a8ecc86c4477f498db8fa3d265baa6088">oomph::BrethertonSpineMesh&lt; ELEMENT, INTERFACE_ELEMENT &gt;::interface_element_pt()</a>, and <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#ae1ecd7c00fe1032e1ee16d7a98156d5c">oomph::BrethertonSpineMesh&lt; ELEMENT, INTERFACE_ELEMENT &gt;::ninterface_element()</a>.</p>

</div>
</div>
<a id="a04c0136de66c06a34347b89f453730e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04c0136de66c06a34347b89f453730e1">&#9670;&nbsp;</a></span>Lower_wall_pt</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT , class INTERFACE_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/ddd/classoomph_1_1GeomObject.html">GeomObject</a>* <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html">oomph::BrethertonSpineMesh</a>&lt; ELEMENT, INTERFACE_ELEMENT &gt;::Lower_wall_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pointer to geometric object that represents the lower wall. </p>

</div>
</div>
<a id="a4ba20dfa61b6c342f2defbc0cdb47851"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ba20dfa61b6c342f2defbc0cdb47851">&#9670;&nbsp;</a></span>Nh</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT , class INTERFACE_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html">oomph::BrethertonSpineMesh</a>&lt; ELEMENT, INTERFACE_ELEMENT &gt;::Nh</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of elements across the deposited film. </p>

</div>
</div>
<a id="a1e58d18dd2231c785008efa07260e8da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e58d18dd2231c785008efa07260e8da">&#9670;&nbsp;</a></span>Nhalf</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT , class INTERFACE_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html">oomph::BrethertonSpineMesh</a>&lt; ELEMENT, INTERFACE_ELEMENT &gt;::Nhalf</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Number of elements in vertical transition region (there are twice as many elements across the channel) </p>

<p class="reference">Referenced by <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#ade4d0f2933beddda517b949d80928a18">oomph::BrethertonSpineMesh&lt; ELEMENT, INTERFACE_ELEMENT &gt;::nfree_surface_spines()</a>.</p>

</div>
</div>
<a id="af6ef10fb80559c3ad27a50116da60dcc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6ef10fb80559c3ad27a50116da60dcc">&#9670;&nbsp;</a></span>Nx1</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT , class INTERFACE_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html">oomph::BrethertonSpineMesh</a>&lt; ELEMENT, INTERFACE_ELEMENT &gt;::Nx1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of elements along wall in deposited film region. </p>

<p class="reference">Referenced by <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#ade4d0f2933beddda517b949d80928a18">oomph::BrethertonSpineMesh&lt; ELEMENT, INTERFACE_ELEMENT &gt;::nfree_surface_spines()</a>.</p>

</div>
</div>
<a id="a237b4f516eb3f74e42e190f2a23f93c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a237b4f516eb3f74e42e190f2a23f93c3">&#9670;&nbsp;</a></span>Nx2</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT , class INTERFACE_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html">oomph::BrethertonSpineMesh</a>&lt; ELEMENT, INTERFACE_ELEMENT &gt;::Nx2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of elements along wall in horizontal transition region. </p>

<p class="reference">Referenced by <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#ade4d0f2933beddda517b949d80928a18">oomph::BrethertonSpineMesh&lt; ELEMENT, INTERFACE_ELEMENT &gt;::nfree_surface_spines()</a>.</p>

</div>
</div>
<a id="a26c57f832b7cdc495087cef7b54c98fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26c57f832b7cdc495087cef7b54c98fd">&#9670;&nbsp;</a></span>Nx3</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT , class INTERFACE_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html">oomph::BrethertonSpineMesh</a>&lt; ELEMENT, INTERFACE_ELEMENT &gt;::Nx3</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of elements along wall in channel region. </p>

</div>
</div>
<a id="af5e7951a89bc13d73f2b137947cda8a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5e7951a89bc13d73f2b137947cda8a3">&#9670;&nbsp;</a></span>Spine_centre_fraction_pt</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT , class INTERFACE_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a>* <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html">oomph::BrethertonSpineMesh</a>&lt; ELEMENT, INTERFACE_ELEMENT &gt;::Spine_centre_fraction_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pointer to vertical fraction of the spine centre. </p>

<p class="reference">Referenced by <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a33c3ed5af92e7b22a22615f42c34c387">oomph::BrethertonSpineMesh&lt; ELEMENT, INTERFACE_ELEMENT &gt;::set_spine_centre_fraction_pt()</a>, and <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html#a67f784e7b3a898af6c60515042c3ea73">oomph::BrethertonSpineMesh&lt; ELEMENT, INTERFACE_ELEMENT &gt;::spine_centre_fraction()</a>.</p>

</div>
</div>
<a id="a1f97e78a12000afcc1bd754102b5b51a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f97e78a12000afcc1bd754102b5b51a">&#9670;&nbsp;</a></span>Upper_wall_pt</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT , class INTERFACE_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/ddd/classoomph_1_1GeomObject.html">GeomObject</a>* <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html">oomph::BrethertonSpineMesh</a>&lt; ELEMENT, INTERFACE_ELEMENT &gt;::Upper_wall_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pointer to geometric object that represents the upper wall. </p>

</div>
</div>
<a id="ac1b5e005bfb5db65f54ca599942126ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1b5e005bfb5db65f54ca599942126ea">&#9670;&nbsp;</a></span>Zeta_end</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT , class INTERFACE_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html">oomph::BrethertonSpineMesh</a>&lt; ELEMENT, INTERFACE_ELEMENT &gt;::Zeta_end</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Wall coordinate of end of liquid filled region (inflow) </p>

</div>
</div>
<a id="a0f41083aa9a97fca03d498bd6ec21eb2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f41083aa9a97fca03d498bd6ec21eb2">&#9670;&nbsp;</a></span>Zeta_start</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT , class INTERFACE_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html">oomph::BrethertonSpineMesh</a>&lt; ELEMENT, INTERFACE_ELEMENT &gt;::Zeta_start</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Start coordinate on wall. </p>

</div>
</div>
<a id="a1d05bb741eba54ab7498ab4f3c55f1b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d05bb741eba54ab7498ab4f3c55f1b7">&#9670;&nbsp;</a></span>Zeta_transition_end</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT , class INTERFACE_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html">oomph::BrethertonSpineMesh</a>&lt; ELEMENT, INTERFACE_ELEMENT &gt;::Zeta_transition_end</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Wall coordinate of end of transition region. </p>

</div>
</div>
<a id="af701937d59d7804f40cb1b4c7a262391"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af701937d59d7804f40cb1b4c7a262391">&#9670;&nbsp;</a></span>Zeta_transition_start</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT , class INTERFACE_ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> <a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html">oomph::BrethertonSpineMesh</a>&lt; ELEMENT, INTERFACE_ELEMENT &gt;::Zeta_transition_start</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Wall coordinate of start of the transition region. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="../../da/db0/bretherton__spine__mesh_8template_8h_source.html">bretherton_spine_mesh.template.h</a></li>
<li><a class="el" href="../../d2/d0d/bretherton__spine__mesh_8template_8cc.html">bretherton_spine_mesh.template.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../da/ddf/namespaceoomph.html">oomph</a></li><li class="navelem"><a class="el" href="../../d5/dba/classoomph_1_1BrethertonSpineMesh.html">BrethertonSpineMesh</a></li>
    <li class="footer">Generated on Wed Aug 27 2025 17:09:17 for MercuryDPM by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
