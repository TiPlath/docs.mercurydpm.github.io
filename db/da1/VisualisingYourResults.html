<!-- HTML header for doxygen 1.8.18-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MercuryDPM: Visualising Your Results</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../MDPM.css" rel="stylesheet" type="text/css"/>
<link href="../../codeLabels.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-fork-corner.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-dropdown-version.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../MDPM-fragment-copy-button.js"></script>
<script type="text/javascript">
DoxygenAwesomeFragmentCopyButton.init()
</script>
<script type="text/javascript" src="../../MDPM-paragraph-link.js"></script>
<script type="text/javascript">
DoxygenAwesomeParagraphLink.init()
</script>
<script type="text/javascript" src="../../MDPM-interactive-toc.js"></script>
<script type="text/javascript">
DoxygenAwesomeInteractiveToc.init()
</script>
<script type="text/javascript" src="../../MDPM-darkmode-toggle.js"></script>
<script type="text/javascript">
DoxygenAwesomeDarkModeToggle.init()
</script>
</head>
<body>
  <div id="bitbucket-corner">
   <a href="https://bitbucket.org/mercurydpm/mercurydpm/src/master/" target="_blank" id="fork-corner" class="fork-corner fc-pos-tr fc-animate fc-theme-bitbucket"></a>
  </div>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../mercury-logo-chosen-light-slogan.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"> <!--MercuryDPM--!>
   <!-- BEGIN version select -->
   <div class="dropdown" id="projectnumber">
    <button class="dropbtn">v1.0</button>
    <div class="dropdown-content">
    </div>
   </div>
   <script type="text/javascript" src="../../MDPM-dropdown-version.js"></script>
<!-- END version select -->
   <!--&#160;<span id="projectnumber">revision: v1.0</span>-->
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<script type="text/javascript" src="../../MDPM-fork-corner.js"></script>
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('db/da1/VisualisingYourResults.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Visualising Your Results </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#UnderstandingTheOutputFiles">Understanding the output files</a><ul><li class="level2"><a href="#ene">The ene file</a></li>
<li class="level2"><a href="#data">The data file</a></li>
<li class="level2"><a href="#fstat">The fstat file</a></li>
</ul>
</li>
<li class="level1"><a href="#VisualisingDataInParaview">Visualising data in ParaView</a><ul><ul><ul><li class="level4"><a href="#autotoc_md0">Visualising Mercury Data Using ParaView</a></li>
<li class="level4"><a href="#autotoc_md1">Running data2pvd</a></li>
<li class="level4"><a href="#autotoc_md2">Running ParaView</a></li>
<li class="level4"><a href="#autotoc_md3">Post-Processing Data</a></li>
</ul>
</ul>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p>Having explained in the previous section the how to run a Mercury driver code, we next explain the form of the data output, and describe how relevant information may be extracted from this data. Mercury produces data regarding a wide range of system parameters and, as such, there exist a variety of manners in which this data may be obtained and processed. This page is divided in two parts:</p><ul>
<li><a class="el" href="../../db/da1/VisualisingYourResults.html#UnderstandingTheOutputFiles">Understanding the output files</a></li>
<li><a class="el" href="../../db/da1/VisualisingYourResults.html#VisualisingDataInParaview">Visualising data in ParaView</a></li>
<li><a class="el" href="../../d9/d86/ParaViewSuperbuild.html">Visualising Superquadrics in Paraview</a></li>
<li><a class="el" href="../../dd/da6/xballs.html">Visualising data in xballs</a></li>
</ul>
<h1><a class="anchor" id="UnderstandingTheOutputFiles"></a>
Understanding the output files</h1>
<p>Each MercuryDPM executable produces three main output files, with the extensions ‘.data’, ‘.fstat’ and ‘.ene’.</p>
<p>For instance, building the source file <code>example.cpp</code> will create an executable named <code>example</code>. The output file name is set using DPMBase::getName; the MercuryDPM convention is that the name of the output file names should be equal to the name of the source file. Thus, execution will create output files named ‘example.data’, ‘example.fstat’ and ‘example.ene’ (other files such as ‘example.restart’ and ‘example.stat’ might be created, which will be discussed in different sections).</p>
<h2><a class="anchor" id="ene"></a>
The ene file</h2>
<p>The simplest of the three file types is the ‘.ene’ file, which allows us to interpret the time evolution of the various forms of energy possessed by the system. Data is written at predefined time steps, with the system’s <b> total </b> gravitational (<code>’ene_gra’</code>) and elastic (<code>’ene_ela’</code>) potential energies and translational (<code>’ene_kin’</code>) and rotational (<code>’ene_rot’</code>) kinetic energies being shown alongside the system’s centre of mass position in the <em>x</em>, <em>y</em> and <em>z</em> directions (<code>’X_COM’</code>, <code>’Y_COM’</code> and <code>’Z_COM’</code>, respectively).</p>
<p>At each time step, the data is output as follows:</p>
<pre class="fragment">time ene_gra ene_kin ene_rot ene_ela X_COM Y_COM Z_COM
</pre><h2><a class="anchor" id="data"></a>
The data file</h2>
<p>The data file is perhaps the most useful and versatile of the three, as it provides full information regarding the positions and velocities of all particles within the system at each given time step.</p>
<p>The files are formatted as follows: at <em>each time step</em>, a single line stating the number of particles in the system (<code>N</code>). This first line is structured as below:</p>
<pre class="fragment">N, time, xmin, ymin, zmin, xmax, ymax, zmax
</pre><p>For each timestep, we are given information regarding</p><ul>
<li>the number of particles <code>N</code>),</li>
<li>the time step <code>time</code> when the output was written, and</li>
<li>the maximal and minimal spatial boundaries defining the computational volume used in the simulations, <code>xmin, ymin, zmin, xmax, ymax, zmax</code>.</li>
</ul>
<p>This output is then followed by a series of <code>N</code> subsequent lines, each providing information for one particle within the system. These parameters are output in the following order:</p>
<pre class="fragment">rx, ry, rz, vx, vy, vz, rad, alpha, beta, gamma, omex, omey, omez, info
</pre><p>For each particle, we are given information regarding</p><ul>
<li>its current position in three dimensions \(\vec{r}=({\tt rx}, {\tt ry}, {\tt rz})\),</li>
<li>the magnitudes of the three components of its instantaneous velocity \(\vec{v}=({\tt vx}, {\tt vy}, {\tt vz})\),</li>
<li>the radius of the particle \(\tt rad\),</li>
<li>its instantaneous angular velocity \(\vec{\omega}=({\tt omex}, {\tt omey}, {\tt omez})\) and</li>
<li>its angular position, given via the three Euler angles \(({\tt alpha}, {\tt beta}, {\tt gamma})\).</li>
<li>The term <code>info</code> represents an additional variable which can be specified by the user using DPMBase::getInfo. By default, <code>info</code> represents the <em>species index</em>, which stores information regarding the particle’s material/contact properties.</li>
</ul>
<p>The sequence of output lines described above is then repeated for each time step.</p>
<div class="image">
<img src="../../data.png" alt="" width="75%"/>
<div class="caption">
Particle properties reported in the data file</div></div>
<p>It should be noted that the above is the standard output required for <b>three-dimensional data</b>; for two-dimensional data, only five items of information are given in the initial line of each time step:</p>
<pre class="fragment">N, time, xmin, zmin, xmax, zmax
</pre><p>and eight in the subsequent <code>N</code> lines:</p>
<pre class="fragment">x, z, vx, vz, rad, qz, omez, xi
</pre><h2><a class="anchor" id="fstat"></a>
The fstat file</h2>
<p>The fstat is predominantly used to calculate stresses.</p>
<p>The .fstat output files follow a similar structure to the .data files; for each time step, three lines are initially output, each preceded by a ‘hash’ symbol (#). These lines are designated as follows:</p>
<pre class="fragment">  # time, fstatVersion
  # xmin ymin zmin xmax ymax zmax
  #
</pre><p>where <code>time</code> is the current time step adn <code>fstatVersion</code> the version number of the output format (currently one, as it has been changed once). The values provided in the second and third line ensure backward compatibility with earlier versions of Mercury, but are not used for analysis.</p>
<p>This initial information is followed by a series of <em>N<sub>c</sub></em> lines corresponding to each of the <em>N<sub>c</sub></em> <b>particle <em>contacts</em></b> (as opposed to <b>particles</b>) within the system at the current instant in time. Each of these lines is structured as follows:</p>
<pre class="fragment">time, i, j, cx, cy, cz, delta, deltat, fn, ft, nx, ny, nz, tx, ty, tz
</pre><ul>
<li><code>i</code> indicates the number used to identify a given particle and</li>
<li><code>j</code> similarly identifies its contact partner.</li>
<li>\(\vec{c}=({\tt cx}, {\tt cy}, {\tt cz})\) denotes the position of the contact point in three dimensions.</li>
<li><code>delta</code> represents the overlap between the two particles,</li>
<li><code>deltat</code> the length of the <em>tangential elongation</em> [Reference missing].</li>
<li>the contact force acting on particle <code>i</code> is split into a normal and tangential component, \(\vec{f}={\tt fn}\cdot\hat{n}+{\tt fn}\cdot\hat{t}\), where \(\hat{n}=({\tt nx}, {\tt ny}, {\tt nz})\) and \(\hat{t}=({\tt tx}, {\tt ty}, {\tt tz})\) denote unit vectors normal and tangential to the contact plane, respectively.</li>
</ul>
<div class="image">
<img src="../../fstat.png" alt="" width="75%"/>
<div class="caption">
Contact properties reported in the fstat file; a non-spherical particle is shown to visualise that the branch vector c-ri is not necessarily parallel to the normal vector n</div></div>
<h1><a class="anchor" id="VisualisingDataInParaview"></a>
Visualising data in ParaView</h1>
<h4><a class="anchor" id="autotoc_md0"></a>
Visualising Mercury Data Using ParaView</h4>
<p>We begin by discussing the manner in which Mercury data can simply be ‘visualised’ - i.e. a direct, visual representation of the motion of all particles within the system produced.</p>
<p>ParaView may be downloaded from <a href="http://www.paraview.org/download/">http://www.paraview.org/download/</a> and installed by following the relevant instructions for your operating system. On Ubuntu, it can simply be installed by typing </p><pre class="fragment">sudo apt-get install paraview
</pre><p>In order to visualise the data using ParaView, the data2pvd tool can be used to convert the ‘.data' files output by Mercury into a '.pvd' ParaView datafile and several VTK (.vtu) files. We will now work through an example, using <code>data2pvd</code> to visualise a simple data set produced using the example code <code>ChuteDemo</code>. From your build directory, go to the <code>ChuteDemos</code> directory:</p>
<div class="fragment"><div class="line">cd Drivers/ChuteDemos</div>
</div><!-- fragment --><p>and run the <code>ChuteDemo</code> code:</p>
<div class="fragment"><div class="line">./ChuteDemo</div>
</div><!-- fragment --><p><em> Note: </em> if the code does not run, it may be necessary to first build the code by typing:</p>
<div class="fragment"><div class="line">make ChuteDemo</div>
</div><!-- fragment --><p>Once the code has run, you will have a series of files; for now, however, we are only interested in the '.data' files.</p>
<h4><a class="anchor" id="autotoc_md1"></a>
Running data2pvd</h4>
<p>Since <code>data2pvd</code> creates numerous files, it is advisable to output these to a different directory. First, we will create a directory called <code>chute_pvd</code>:</p>
<div class="fragment"><div class="line">mkdir chute_pvd</div>
</div><!-- fragment --><p>We will then tell <code>data2pvd</code> to create the files in the directory:</p>
<div class="fragment"><div class="line">../../Tools/data2pvd ChuteDemo.data chute_pvd/chute</div>
</div><!-- fragment --><p>In the above, the first of the three terms should give the path to the directory in which the <code>data2pvd</code> program is found (for a standard installation of Mercury, the path will be exactly as given above); the second is the name of the data file (in the current directory) which you want to visualise; the third gives the name of the directory into which the new files will be output (‘chute_pvd’) and the name of the files to be created ('chute').</p>
<h4><a class="anchor" id="autotoc_md2"></a>
Running ParaView</h4>
<p>Once the files have been successfully created, we now start ParaView by simply typing:</p>
<div class="fragment"><div class="line">paraview</div>
</div><!-- fragment --><p>Which should load a screen similar to the one provided below:</p>
<p><em>Note:</em> for Mac users, ParaView can be opened by clicking 'Go', selecting 'Applications' and opening the file manually.</p>
<div class="image">
<img src="../../paraview2.png" alt=""/>
</div>
<p>The next step is to open the file by pressing the folder icon circled in the above image and navigating to the relevant directory using the panel shown below.</p>
<p>Here, you can choose to open either the &lsquo;.pvd&rsquo; file, which loads the entire simulation, or the '.vtu' file, which allows the selection of a single timestep.</p>
<p>For this tutorial, we will select the full file - ’chute.pvd'.</p>
<div class="image">
<img src="../../openfile.png" alt=""/>
</div>
<p>On the left side of the ParaView window, we can now see chute.pvd, below the builtin in the Pipeline Browser.</p>
<p>Click ‘Apply' to load the file into the pipeline.</p>
<div class="image">
<img src="../../apply.png" alt=""/>
</div>
<p>Now we want to actually draw our particles. To do so, open the 'filters' menu at the top of the ParaView window (or, for Mac users, at the top of the screen) and then, from the drop-down list, select the 'common' menu and click 'Glyph'.</p>
<p>In the current case, we want to draw all our particles, with the correct size and shape. In the left-hand menu, select 'Sphere' for the ‘Glyph Type’, 'scalar' as the Scale Mode (under the ‘Scaling’ heading) and enter a Scale Factor of 2.0 (Mercury uses radii, while ParaView uses diameters).</p>
<p>Select 'All Points' for the ‘Glyph Mode’ under the ‘Masking’ heading to make sure all of our particles are actually rendered. Finally press 'Apply' once again to apply the changes.</p>
<div class="image">
<img src="../../zoom2.png" alt=""/>
</div>
<p>In order to focus on our system of particles, click the 'Zoom to data' button circled in the image above.</p>
<p>The particles can then be coloured according to various properties; for the current tutorial, we will colour our particles according to their velocities. To do this, with the 'Glyph1' stage selected, scroll down in the properties menu until you find 'Colouring' and select the 'Velocities' option.</p>
<p>The colouring can be rescaled for optimal clarity by pressing the ‘Rescale' button in the left hand menu under the ‘Colouring’ heading.</p>
<div class="image">
<img src="../../rescale.png" alt=""/>
</div>
<p>We are now ready to press the 'play' button near the top of the screen and see the system in motion!</p>
<div class="image">
<img src="../../run.png" alt=""/>
</div>
<p>The ParaView program has endless possibilities and goes way beyond the scope of this document. Please consult the ParaView documentation for further information.</p>
<h4><a class="anchor" id="autotoc_md3"></a>
Post-Processing Data</h4>
<p>In the MercuryCG folder (<code>MercuryDPM/MercuryBuild/Drivers/MercuryCG</code>), type ‘<code>make fstatistics</code>’ to compile the ‘fstatistics’ analysis package.</p>
<p>For information on how to operate fstatistics, type ‘<code>./fstatistics -help</code>’.</p>
<p>in this case : ‘<code>~/MercuryDPM/MercuryBuild/Drivers/MercuryCG/fstatistics Drivers/ChuteDemos/ChuteDemo‘</code></p>
<p>The Mercury analysis package are due to be upgraded in the upcoming Version 1.1, at which point full online documentation and usage instructions will be uploaded.</p>
<p>If you experience problems in the meantime, please do not hesitate to contact a member of the Mercury team. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../index.html">MercuryDPM Reference Manual</a></li>
    <li class="footer">Generated on Wed Aug 27 2025 17:05:12 for MercuryDPM by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
