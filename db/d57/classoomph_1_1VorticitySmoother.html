<!-- HTML header for doxygen 1.8.18-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MercuryDPM: oomph::VorticitySmoother&lt; ELEMENT &gt; Class Template Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../MDPM.css" rel="stylesheet" type="text/css"/>
<link href="../../codeLabels.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-fork-corner.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-dropdown-version.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../MDPM-fragment-copy-button.js"></script>
<script type="text/javascript">
DoxygenAwesomeFragmentCopyButton.init()
</script>
<script type="text/javascript" src="../../MDPM-paragraph-link.js"></script>
<script type="text/javascript">
DoxygenAwesomeParagraphLink.init()
</script>
<script type="text/javascript" src="../../MDPM-interactive-toc.js"></script>
<script type="text/javascript">
DoxygenAwesomeInteractiveToc.init()
</script>
<script type="text/javascript" src="../../MDPM-darkmode-toggle.js"></script>
<script type="text/javascript">
DoxygenAwesomeDarkModeToggle.init()
</script>
</head>
<body>
  <div id="bitbucket-corner">
   <a href="https://bitbucket.org/mercurydpm/mercurydpm/src/master/" target="_blank" id="fork-corner" class="fork-corner fc-pos-tr fc-animate fc-theme-bitbucket"></a>
  </div>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../mercury-logo-chosen-light-slogan.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"> <!--MercuryDPM--!>
   <!-- BEGIN version select -->
   <div class="dropdown" id="projectnumber">
    <button class="dropbtn">v1.0</button>
    <div class="dropdown-content">
    </div>
   </div>
   <script type="text/javascript" src="../../MDPM-dropdown-version.js"></script>
<!-- END version select -->
   <!--&#160;<span id="projectnumber">revision: v1.0</span>-->
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<script type="text/javascript" src="../../MDPM-fork-corner.js"></script>
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('db/d57/classoomph_1_1VorticitySmoother.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="../../d2/d62/classoomph_1_1VorticitySmoother-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">oomph::VorticitySmoother&lt; ELEMENT &gt; Class Template Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Smoother for vorticity in 2D.  
 <a href="../../db/d57/classoomph_1_1VorticitySmoother.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="../../de/d0e/vorticity__smoother_8h_source.html">vorticity_smoother.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aa848dd59d224d397c568e86922962c4b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html#aa848dd59d224d397c568e86922962c4b">VorticitySmoother</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html#aa6f69b6e4063b73ccfbcdc6443bce623">recovery_order</a>)</td></tr>
<tr class="memdesc:aa848dd59d224d397c568e86922962c4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor: Set order of recovery shape functions.  <a href="../../db/d57/classoomph_1_1VorticitySmoother.html#aa848dd59d224d397c568e86922962c4b">More...</a><br /></td></tr>
<tr class="separator:aa848dd59d224d397c568e86922962c4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63f9db0ba0a243965a4ca0ac6b4a3193"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html#a63f9db0ba0a243965a4ca0ac6b4a3193">VorticitySmoother</a> (const <a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html">VorticitySmoother</a> &amp;)=delete</td></tr>
<tr class="memdesc:a63f9db0ba0a243965a4ca0ac6b4a3193"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken copy constructor.  <a href="../../db/d57/classoomph_1_1VorticitySmoother.html#a63f9db0ba0a243965a4ca0ac6b4a3193">More...</a><br /></td></tr>
<tr class="separator:a63f9db0ba0a243965a4ca0ac6b4a3193"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa18a8649777088f00d06959ea0db4ac"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html#aaa18a8649777088f00d06959ea0db4ac">operator=</a> (const <a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html">VorticitySmoother</a> &amp;)=delete</td></tr>
<tr class="memdesc:aaa18a8649777088f00d06959ea0db4ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken assignment operator.  <a href="../../db/d57/classoomph_1_1VorticitySmoother.html#aaa18a8649777088f00d06959ea0db4ac">More...</a><br /></td></tr>
<tr class="separator:aaa18a8649777088f00d06959ea0db4ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58770377b1a6c0e3e0922015bae8040d"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html#a58770377b1a6c0e3e0922015bae8040d">~VorticitySmoother</a> ()</td></tr>
<tr class="memdesc:a58770377b1a6c0e3e0922015bae8040d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Empty virtual destructor.  <a href="../../db/d57/classoomph_1_1VorticitySmoother.html#a58770377b1a6c0e3e0922015bae8040d">More...</a><br /></td></tr>
<tr class="separator:a58770377b1a6c0e3e0922015bae8040d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6f69b6e4063b73ccfbcdc6443bce623"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html#aa6f69b6e4063b73ccfbcdc6443bce623">recovery_order</a> ()</td></tr>
<tr class="memdesc:aa6f69b6e4063b73ccfbcdc6443bce623"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access function for order of recovery polynomials.  <a href="../../db/d57/classoomph_1_1VorticitySmoother.html#aa6f69b6e4063b73ccfbcdc6443bce623">More...</a><br /></td></tr>
<tr class="separator:aa6f69b6e4063b73ccfbcdc6443bce623"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c6a0c1333a418b70ae3e629d63f7bf6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html#a7c6a0c1333a418b70ae3e629d63f7bf6">shape_rec</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a61b7da262276970831d88a2f37dbe509">x</a>, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;psi_r)</td></tr>
<tr class="separator:a7c6a0c1333a418b70ae3e629d63f7bf6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b758449024e0dd49d5062fcc502aed7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/d70/classoomph_1_1Integral.html">Integral</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html#a9b758449024e0dd49d5062fcc502aed7">integral_rec</a> (const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;is_q_mesh)</td></tr>
<tr class="separator:a9b758449024e0dd49d5062fcc502aed7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8e49f99dfb35e6ee5eebbce87131d44"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html#ae8e49f99dfb35e6ee5eebbce87131d44">setup_patches</a> (<a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *&amp;mesh_pt, std::map&lt; <a class="el" href="../../dc/db7/classoomph_1_1Node.html">Node</a> *, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; ELEMENT * &gt; * &gt; &amp;adjacent_elements_pt, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../dc/db7/classoomph_1_1Node.html">Node</a> * &gt; &amp;vertex_node_pt)</td></tr>
<tr class="separator:ae8e49f99dfb35e6ee5eebbce87131d44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc724f10b642aa3edc2d02fa8e35787d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html#adc724f10b642aa3edc2d02fa8e35787d">get_recovered_vorticity_in_patch</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; ELEMENT * &gt; &amp;patch_el_pt, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;num_recovery_terms, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; *&amp;recovered_vorticity_coefficient_pt, <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;n_deriv)</td></tr>
<tr class="separator:adc724f10b642aa3edc2d02fa8e35787d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a203602aa127f5c89480304a2f10426f1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html#a203602aa127f5c89480304a2f10426f1">nrecovery_order</a> () const</td></tr>
<tr class="memdesc:a203602aa127f5c89480304a2f10426f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the recovery order.  <a href="../../db/d57/classoomph_1_1VorticitySmoother.html#a203602aa127f5c89480304a2f10426f1">More...</a><br /></td></tr>
<tr class="separator:a203602aa127f5c89480304a2f10426f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d708f1505080ea241cbb6bc71e2b01a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html#a4d708f1505080ea241cbb6bc71e2b01a">recover_vorticity</a> (<a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *mesh_pt)</td></tr>
<tr class="memdesc:a4d708f1505080ea241cbb6bc71e2b01a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Recover vorticity from patches.  <a href="../../db/d57/classoomph_1_1VorticitySmoother.html#a4d708f1505080ea241cbb6bc71e2b01a">More...</a><br /></td></tr>
<tr class="separator:a4d708f1505080ea241cbb6bc71e2b01a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43d407cf76048465189095a82c4f1e32"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html#a43d407cf76048465189095a82c4f1e32">recover_vorticity</a> (<a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *mesh_pt, <a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> &amp;doc_info)</td></tr>
<tr class="separator:a43d407cf76048465189095a82c4f1e32"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:acda3329b3b841aa78abf756222a5ccbb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html#acda3329b3b841aa78abf756222a5ccbb">Recovery_order</a></td></tr>
<tr class="memdesc:acda3329b3b841aa78abf756222a5ccbb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Order of recovery polynomials.  <a href="../../db/d57/classoomph_1_1VorticitySmoother.html#acda3329b3b841aa78abf756222a5ccbb">More...</a><br /></td></tr>
<tr class="separator:acda3329b3b841aa78abf756222a5ccbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;class ELEMENT&gt;<br />
class oomph::VorticitySmoother&lt; ELEMENT &gt;</h3>

<p>Smoother for vorticity in 2D. </p>
<p>/////////////////////////////////////////////////////////////////// /////////////////////////////////////////////////////////////////// /////////////////////////////////////////////////////////////////// </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aa848dd59d224d397c568e86922962c4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa848dd59d224d397c568e86922962c4b">&#9670;&nbsp;</a></span>VorticitySmoother() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html">oomph::VorticitySmoother</a>&lt; ELEMENT &gt;::<a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html">VorticitySmoother</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>recovery_order</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructor: Set order of recovery shape functions. </p>
<div class="fragment"><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;      : <a class="code" href="../../db/d57/classoomph_1_1VorticitySmoother.html#acda3329b3b841aa78abf756222a5ccbb">Recovery_order</a>(<a class="code" href="../../db/d57/classoomph_1_1VorticitySmoother.html#aa6f69b6e4063b73ccfbcdc6443bce623">recovery_order</a>)</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;    {</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1VorticitySmoother_html_aa6f69b6e4063b73ccfbcdc6443bce623"><div class="ttname"><a href="../../db/d57/classoomph_1_1VorticitySmoother.html#aa6f69b6e4063b73ccfbcdc6443bce623">oomph::VorticitySmoother::recovery_order</a></div><div class="ttdeci">unsigned &amp; recovery_order()</div><div class="ttdoc">Access function for order of recovery polynomials.</div><div class="ttdef"><b>Definition:</b> vorticity_smoother.h:1855</div></div>
<div class="ttc" id="aclassoomph_1_1VorticitySmoother_html_acda3329b3b841aa78abf756222a5ccbb"><div class="ttname"><a href="../../db/d57/classoomph_1_1VorticitySmoother.html#acda3329b3b841aa78abf756222a5ccbb">oomph::VorticitySmoother::Recovery_order</a></div><div class="ttdeci">unsigned Recovery_order</div><div class="ttdoc">Order of recovery polynomials.</div><div class="ttdef"><b>Definition:</b> vorticity_smoother.h:2665</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a63f9db0ba0a243965a4ca0ac6b4a3193"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63f9db0ba0a243965a4ca0ac6b4a3193">&#9670;&nbsp;</a></span>VorticitySmoother() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html">oomph::VorticitySmoother</a>&lt; ELEMENT &gt;::<a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html">VorticitySmoother</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html">VorticitySmoother</a>&lt; ELEMENT &gt; &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Broken copy constructor. </p>

</div>
</div>
<a id="a58770377b1a6c0e3e0922015bae8040d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58770377b1a6c0e3e0922015bae8040d">&#9670;&nbsp;</a></span>~VorticitySmoother()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html">oomph::VorticitySmoother</a>&lt; ELEMENT &gt;::~<a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html">VorticitySmoother</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Empty virtual destructor. </p>
<div class="fragment"><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;{}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="adc724f10b642aa3edc2d02fa8e35787d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc724f10b642aa3edc2d02fa8e35787d">&#9670;&nbsp;</a></span>get_recovered_vorticity_in_patch()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html">oomph::VorticitySmoother</a>&lt; ELEMENT &gt;::get_recovered_vorticity_in_patch </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; ELEMENT * &gt; &amp;&#160;</td>
          <td class="paramname"><em>patch_el_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>num_recovery_terms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; *&amp;&#160;</td>
          <td class="paramname"><em>recovered_vorticity_coefficient_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>n_deriv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Given the vector of elements that make up a patch, compute the vector of recovered vorticity coefficients and return a pointer to it. n_deriv indicates which derivative of the vorticity is supposed to be smoothed: 0: zeroth (i.e. the vorticity itself) 1: d/dx; 2: d/dy; 3: d^2/dx^2; 4: d^2/dxdy 5: d^2/dy^2 6: d^3/dx^3, 7: d^3/dx^2dy, 8: d^3/dxdy^2, 9: d^3/dy^3, 10: du/dx, 11: du/dy, 12: dv/dx, 13: dv/dy </p>
<div class="fragment"><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;    {</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;      <span class="comment">// Find the number of elements in the patch</span></div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;      <span class="keywordtype">unsigned</span> nelem = patch_el_pt.size();</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160; </div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;      <span class="comment">// Get a pointer to any element</span></div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;      ELEMENT* el_pt = patch_el_pt[0];</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160; </div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;      <span class="comment">// If there&#39;s at least one element</span></div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;      <span class="keywordflow">if</span> (nelem &gt; 0)</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;      {</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;        <span class="comment">// Get the number of vorticity derivatives to recover</span></div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;        <span class="keywordtype">int</span> n_vort_derivs = el_pt-&gt;get_maximum_order_of_vorticity_derivative();</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160; </div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;        <span class="comment">// Get the number of vorticity derivatives to recover</span></div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;        <span class="keywordtype">int</span> n_veloc_derivs = el_pt-&gt;get_maximum_order_of_velocity_derivative();</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160; </div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;        <span class="comment">// If we&#39;re not recovering anything, we shouldn&#39;t be here</span></div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;        <span class="keywordflow">if</span> (n_vort_derivs + n_veloc_derivs == -1)</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;        {</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;          <span class="comment">// Create an ostringstream object to create an error message</span></div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;          std::ostringstream error_stream;</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160; </div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;          <span class="comment">// Create the error message</span></div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;          error_stream &lt;&lt; <span class="stringliteral">&quot;Not recovering anything. Change the maximum number &quot;</span></div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot;of derivatives to recover.&quot;</span>;</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160; </div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;          <span class="comment">// Throw an error</span></div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;          <span class="keywordflow">throw</span> OomphLibError(error_stream.str(),</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;                              <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;                              <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;        }</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;      } <span class="comment">// if (nelem&gt;0)</span></div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160; </div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;      <span class="comment">// Find the container indices associated with n_deriv</span></div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;      std::pair&lt;unsigned, unsigned&gt; container_id =</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;        el_pt-&gt;vorticity_dof_to_container_id(n_deriv);</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160; </div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;      <span class="comment">// Maximum vorticity derivative order we can recover</span></div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;      <span class="keywordtype">unsigned</span> max_recoverable_vort_order =</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;        el_pt-&gt;get_maximum_order_of_recoverable_vorticity_derivative();</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160; </div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;      <span class="comment">// Maximum velocity derivative order we can recover</span></div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;      <span class="keywordtype">unsigned</span> max_recoverable_veloc_order =</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;        el_pt-&gt;get_maximum_order_of_recoverable_velocity_derivative();</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160; </div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;      <span class="comment">// Make a counter</span></div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;      <span class="keywordtype">unsigned</span> counter = 0;</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160; </div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;      <span class="comment">// Calculate the case value (initialise to -1 so we know if it&#39;s set</span></div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;      <span class="comment">// later)</span></div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;      <span class="keywordtype">int</span> case_value = -1;</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160; </div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;      <span class="comment">// Loop over the derivatives</span></div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; max_recoverable_vort_order + 1; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;      {</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;        <span class="comment">// Increment by the number of partial derivatives of order i</span></div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;        counter += el_pt-&gt;npartial_derivative(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160; </div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;        <span class="comment">// If we&#39;ve exceeded the value of n_deriv then we know which vorticity</span></div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;        <span class="comment">// derivative to recover</span></div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;        <span class="keywordflow">if</span> (n_deriv &lt; counter)</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;        {</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;          <span class="comment">// We need to recover the i-th order of derivative of the vorticity</span></div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;          case_value = <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160; </div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;          <span class="comment">// We&#39;re done here</span></div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;        }</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;      } <span class="comment">// for (unsigned i=0;i&lt;max_recoverable_order+1;i++)</span></div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160; </div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;      <span class="comment">// If we haven&#39;t set the case value yet then we must be recovering a</span></div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;      <span class="comment">// velocity derivative</span></div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;      <span class="keywordflow">if</span> (case_value == -1)</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;      {</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;        <span class="comment">// Loop over the velocity order</span></div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 1; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; max_recoverable_veloc_order + 1; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;        {</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;          <span class="comment">// Increment by the number of velocity partial derivatives of order i</span></div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;          counter += 2 * el_pt-&gt;npartial_derivative(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160; </div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;          <span class="comment">// If we&#39;ve exceeded the value of n_deriv then we know which vorticity</span></div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;          <span class="comment">// derivative to recover</span></div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;          <span class="keywordflow">if</span> (n_deriv &lt; counter)</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;          {</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;            <span class="comment">// We need to recover the i-th order of derivative of the vorticity</span></div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;            case_value = max_recoverable_vort_order + <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160; </div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;            <span class="comment">// We&#39;re done here</span></div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;          }</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;        } <span class="comment">// for (unsigned i=1;i&lt;max_recoverable_veloc_order+1;i++)</span></div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;      } <span class="comment">// if (case_value==-1)</span></div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160; </div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;      <span class="comment">// Sanity check: if the case value hasn&#39;t been set then something&#39;s wrong</span></div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;      <span class="keywordflow">if</span> (case_value == -1)</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;      {</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;        <span class="comment">// Create a ostringstream object to create an error message</span></div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;        std::ostringstream error_message_stream;</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160; </div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;        <span class="comment">// Create an error message</span></div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;        error_message_stream</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;Case order has not been set. Something&#39;s wrong!&quot;</span>;</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160; </div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;        <span class="comment">// Throw an error</span></div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(error_message_stream.str(),</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;      }</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160; </div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;      <span class="comment">// Create space for the recovered quantity</span></div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;      <span class="keywordtype">double</span> recovered_quantity = 0.0;</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160; </div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;      <span class="comment">// Create/initialise matrix for linear system</span></div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;      DenseDoubleMatrix recovery_mat(</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;        num_recovery_terms, num_recovery_terms, 0.0);</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160; </div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;      <span class="comment">// Create/initialise vector for RHS</span></div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;      Vector&lt;double&gt; rhs(num_recovery_terms, 0.0);</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160; </div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;      <span class="comment">// Create a new integration scheme based on the recovery order</span></div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;      <span class="comment">// in the elements. Need to find the type of the element, default</span></div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;      <span class="comment">// is to assume a quad</span></div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;      <span class="keywordtype">bool</span> is_q_mesh = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160; </div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;      <span class="comment">// If we can dynamic cast to the TElementBase, then it&#39;s a triangle/tet</span></div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;      <span class="comment">// Note that I&#39;m assuming that all elements are of the same geometry, but</span></div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;      <span class="comment">// if they weren&#39;t we could adapt...</span></div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">dynamic_cast&lt;</span>TElementBase*<span class="keyword">&gt;</span>(patch_el_pt[0]))</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;      {</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;        <span class="comment">// We&#39;re dealing with a triangle-based mesh so change the bool value</span></div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;        is_q_mesh = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;      }</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160; </div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;      <span class="comment">// Get a pointer to the appropriate integration type</span></div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;      Integral* <span class="keyword">const</span> integ_pt = this-&gt;<a class="code" href="../../db/d57/classoomph_1_1VorticitySmoother.html#a9b758449024e0dd49d5062fcc502aed7">integral_rec</a>(is_q_mesh);</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160; </div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;      <span class="comment">// Loop over all elements in patch to assemble linear system</span></div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; nelem; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;      {</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;        <span class="comment">// Get pointer to element</span></div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;        ELEMENT* <span class="keyword">const</span> el_pt = patch_el_pt[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>];</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160; </div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;        <span class="comment">// Create storage for the recovery shape function values</span></div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;        Vector&lt;double&gt; psi_r(num_recovery_terms);</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160; </div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;        <span class="comment">// Create vector to hold local coordinates</span></div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;        Vector&lt;double&gt; <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>(2, 0.0);</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160; </div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;        <span class="comment">// Find the number of integration points</span></div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;        <span class="keywordtype">unsigned</span> n_intpt = integ_pt-&gt;nweight();</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160; </div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;        <span class="comment">// Loop over the integration points</span></div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ipt = 0; ipt &lt; n_intpt; ipt++)</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;        {</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;          <span class="comment">// Assign values of s, the local coordinate</span></div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; 2; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;          {</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;            <span class="comment">// Get the i-th entry of the local coordinate</span></div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;            <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = integ_pt-&gt;knot(ipt, <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;          }</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160; </div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;          <span class="comment">// Get the integral weight</span></div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;          <span class="keywordtype">double</span> <a class="code" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a> = integ_pt-&gt;weight(ipt);</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160; </div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;          <span class="comment">// Jacobian of mapping</span></div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;          <span class="keywordtype">double</span> <a class="code" href="../../dc/da8/Jacobi__makeJacobi_8cpp.html#a4804f9d1c212b9655934738d0ae395ab">J</a> = el_pt-&gt;J_eulerian(<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>);</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160; </div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;          <span class="comment">// Allocate space for the global coordinates</span></div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;          Vector&lt;double&gt; <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>(2, 0.0);</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160; </div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;          <span class="comment">// Interpolate the global (Eulerian) coordinate</span></div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;          el_pt-&gt;interpolated_x(<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>, <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>);</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160; </div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;          <span class="comment">// Premultiply the weights and the Jacobian and the geometric</span></div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;          <span class="comment">// Jacobian weight (used in axisymmetric and spherical coordinate</span></div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;          <span class="comment">// systems) -- hierher really fct of x? probably yes, actually).</span></div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;          <span class="keywordtype">double</span> <a class="code" href="../../dc/d00/namespaceoomph_1_1QuadTreeNames.html#a9ac199adb82120cbaa47bf2365918ab9aabab2a070c062503375f8264f1b6d7d6">W</a> = <a class="code" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a> * <a class="code" href="../../dc/da8/Jacobi__makeJacobi_8cpp.html#a4804f9d1c212b9655934738d0ae395ab">J</a> * (el_pt-&gt;geometric_jacobian(<a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>));</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160; </div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;          <span class="comment">// Recovery shape functions at global (Eulerian) coordinate</span></div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;          <a class="code" href="../../db/d57/classoomph_1_1VorticitySmoother.html#a7c6a0c1333a418b70ae3e629d63f7bf6">shape_rec</a>(<a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>, psi_r);</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160; </div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;          <span class="comment">// Use a switch statement to decide on which function to call</span></div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;          <span class="keywordflow">switch</span> (case_value)</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;          {</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;            <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;            {</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;              Vector&lt;double&gt; vorticity(1, 0.0);</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;              el_pt-&gt;get_vorticity(<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>, vorticity);</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;              recovered_quantity = vorticity[0];</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;            }</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;            <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;            {</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;              el_pt-&gt;get_raw_vorticity_deriv(</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;                <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>, recovered_quantity, container_id.second);</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;            }</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;            <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;            {</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;              el_pt-&gt;get_raw_vorticity_second_deriv(</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;                <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>, recovered_quantity, container_id.second);</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;            }</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;            <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;            {</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;              el_pt-&gt;get_raw_vorticity_third_deriv(</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;                <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>, recovered_quantity, container_id.second);</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;            }</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;            <span class="keywordflow">case</span> 4:</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;            {</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;              el_pt-&gt;get_raw_velocity_deriv(</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;                <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>, recovered_quantity, container_id.second);</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;            }</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;            {</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;              <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Never get here.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;              abort();</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;            }</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;          }</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160; </div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;          <span class="comment">// Add elemental RHSs and recovery matrix to global versions</span></div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;          <span class="comment">//----------------------------------------------------------</span></div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;          <span class="comment">// RHS: Loop over the nodes for the test functions</span></div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> l = 0; l &lt; num_recovery_terms; l++)</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;          {</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;            <span class="comment">// Update the RHS entry ()</span></div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;            rhs[l] += recovered_quantity * psi_r[l] * <a class="code" href="../../dc/d00/namespaceoomph_1_1QuadTreeNames.html#a9ac199adb82120cbaa47bf2365918ab9aabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;          }</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160; </div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;          <span class="comment">// Loop over the nodes for the test functions</span></div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> l = 0; l &lt; num_recovery_terms; l++)</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;          {</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;            <span class="comment">// Loop over the nodes for the variables</span></div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> l2 = 0; l2 &lt; num_recovery_terms; l2++)</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;            {</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;              <span class="comment">// Add contribution to recovery matrix</span></div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;              recovery_mat(l, l2) += psi_r[l] * psi_r[l2] * <a class="code" href="../../dc/d00/namespaceoomph_1_1QuadTreeNames.html#a9ac199adb82120cbaa47bf2365918ab9aabab2a070c062503375f8264f1b6d7d6">W</a>;</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;            }</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;          } <span class="comment">// for (unsigned l=0;l&lt;num_recovery_terms;l++)</span></div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;        } <span class="comment">// for (unsigned ipt=0;ipt&lt;n_intpt;ipt++)</span></div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;      } <span class="comment">// End of loop over elements that make up patch.</span></div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160; </div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;      <span class="comment">// Delete the integration scheme</span></div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;      <span class="keyword">delete</span> integ_pt;</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160; </div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;      <span class="comment">// Linear system is now assembled: Solve recovery system</span></div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;      <span class="comment">//------------------------------------------------------</span></div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;      <span class="comment">// LU decompose the recovery matrix</span></div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;      recovery_mat.ludecompose();</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160; </div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;      <span class="comment">// Back-substitute</span></div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;      recovery_mat.lubksub(rhs);</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160; </div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;      <span class="comment">// Now create a matrix to store the vorticity recovery coefficients.</span></div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;      <span class="comment">// Pointer to this matrix will be returned.</span></div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;      recovered_vorticity_coefficient_pt =</div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;        <span class="keyword">new</span> Vector&lt;double&gt;(num_recovery_terms);</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160; </div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;      <span class="comment">// Loop over the number of recovered terms</span></div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> icoeff = 0; icoeff &lt; num_recovery_terms; icoeff++)</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;      {</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;        <span class="comment">// Copy the RHS value over</span></div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;        (*recovered_vorticity_coefficient_pt)[icoeff] = rhs[icoeff];</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;      }</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;    } <span class="comment">// End of get_recovered_vorticity_in_patch</span></div>
<div class="ttc" id="aBiCGSTAB__step__by__step_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> BiCGSTAB_step_by_step.cpp:9</div></div>
<div class="ttc" id="aCwise__array__power__array_8cpp_html_a9eb5e92d9d691c1393e5e7c914731dbf"><div class="ttname"><a href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a></div><div class="ttdeci">Array&lt; double, 1, 3 &gt; e(1./3., 0.5, 2.)</div></div>
<div class="ttc" id="aJacobi__makeJacobi_8cpp_html_a4804f9d1c212b9655934738d0ae395ab"><div class="ttname"><a href="../../dc/da8/Jacobi__makeJacobi_8cpp.html#a4804f9d1c212b9655934738d0ae395ab">J</a></div><div class="ttdeci">JacobiRotation&lt; float &gt; J</div><div class="ttdef"><b>Definition:</b> Jacobi_makeJacobi.cpp:3</div></div>
<div class="ttc" id="aMatrix__resize__int_8cpp_html_aab236ce080522c9832217fd5f157541b"><div class="ttname"><a href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a></div><div class="ttdeci">RowVector3d w</div><div class="ttdef"><b>Definition:</b> Matrix_resize_int.cpp:3</div></div>
<div class="ttc" id="aclassoomph_1_1VorticitySmoother_html_a7c6a0c1333a418b70ae3e629d63f7bf6"><div class="ttname"><a href="../../db/d57/classoomph_1_1VorticitySmoother.html#a7c6a0c1333a418b70ae3e629d63f7bf6">oomph::VorticitySmoother::shape_rec</a></div><div class="ttdeci">void shape_rec(const Vector&lt; double &gt; &amp;x, Vector&lt; double &gt; &amp;psi_r)</div><div class="ttdef"><b>Definition:</b> vorticity_smoother.h:1864</div></div>
<div class="ttc" id="aclassoomph_1_1VorticitySmoother_html_a9b758449024e0dd49d5062fcc502aed7"><div class="ttname"><a href="../../db/d57/classoomph_1_1VorticitySmoother.html#a9b758449024e0dd49d5062fcc502aed7">oomph::VorticitySmoother::integral_rec</a></div><div class="ttdeci">Integral * integral_rec(const bool &amp;is_q_mesh)</div><div class="ttdef"><b>Definition:</b> vorticity_smoother.h:1926</div></div>
<div class="ttc" id="alevel1__cplx__impl_8h_html_a462761ca92ad97a9a705cb875828b0b8"><div class="ttname"><a href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a></div><div class="ttdeci">RealScalar s</div><div class="ttdef"><b>Definition:</b> level1_cplx_impl.h:130</div></div>
<div class="ttc" id="anamespaceoomph_1_1QuadTreeNames_html_a9ac199adb82120cbaa47bf2365918ab9aabab2a070c062503375f8264f1b6d7d6"><div class="ttname"><a href="../../dc/d00/namespaceoomph_1_1QuadTreeNames.html#a9ac199adb82120cbaa47bf2365918ab9aabab2a070c062503375f8264f1b6d7d6">oomph::QuadTreeNames::W</a></div><div class="ttdeci">@ W</div><div class="ttdef"><b>Definition:</b> quadtree.h:63</div></div>
<div class="ttc" id="anamespaceoomph_html_aec474227917784dc0a255faf289cfc16"><div class="ttname"><a href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a></div><div class="ttdeci">OomphInfo oomph_info</div><div class="ttdef"><b>Definition:</b> oomph_definitions.cc:319</div></div>
<div class="ttc" id="anamespaceplotDoE_html_a4758fc6194247f040938f29c863d21ee"><div class="ttname"><a href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">plotDoE.x</a></div><div class="ttdeci">list x</div><div class="ttdef"><b>Definition:</b> plotDoE.py:28</div></div>
<div class="ttc" id="aoomph__definitions_8h_html_a25c6813cc7341d125e2502f8923fb6c4"><div class="ttname"><a href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a></div><div class="ttdeci">#define OOMPH_EXCEPTION_LOCATION</div><div class="ttdef"><b>Definition:</b> oomph_definitions.h:61</div></div>
<div class="ttc" id="aoomph__definitions_8h_html_aa260cc4af589e30cea7fde997ae16667"><div class="ttname"><a href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a></div><div class="ttdeci">#define OOMPH_CURRENT_FUNCTION</div><div class="ttdef"><b>Definition:</b> oomph_definitions.h:86</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html#a9b758449024e0dd49d5062fcc502aed7">oomph::VorticitySmoother&lt; ELEMENT &gt;::integral_rec()</a>, <a class="el" href="../../dc/da8/Jacobi__makeJacobi_8cpp.html#a4804f9d1c212b9655934738d0ae395ab">J</a>, <a class="el" href="../../de/d70/classoomph_1_1Integral.html#a1a2122f99a87c18649bafdd9ed739758">oomph::Integral::knot()</a>, <a class="el" href="../../dd/d03/classoomph_1_1DenseDoubleMatrix.html#a52515653ab5b792388258ca04e9dcbcc">oomph::DenseDoubleMatrix::lubksub()</a>, <a class="el" href="../../dd/d03/classoomph_1_1DenseDoubleMatrix.html#a741d54dbea2a16e6e3f10bbd2d9d726e">oomph::DenseDoubleMatrix::ludecompose()</a>, <a class="el" href="../../de/d70/classoomph_1_1Integral.html#a1a270de9d99a1fcf1d25a6c1017f65fa">oomph::Integral::nweight()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, <a class="el" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>, <a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html#a7c6a0c1333a418b70ae3e629d63f7bf6">oomph::VorticitySmoother&lt; ELEMENT &gt;::shape_rec()</a>, <a class="el" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a>, <a class="el" href="../../dc/d00/namespaceoomph_1_1QuadTreeNames.html#a9ac199adb82120cbaa47bf2365918ab9aabab2a070c062503375f8264f1b6d7d6">oomph::QuadTreeNames::W</a>, <a class="el" href="../../de/d70/classoomph_1_1Integral.html#ac65335e2aab120b285b3d6c294507b06">oomph::Integral::weight()</a>, and <a class="el" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">plotDoE::x</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html#a43d407cf76048465189095a82c4f1e32">oomph::VorticitySmoother&lt; ELEMENT &gt;::recover_vorticity()</a>.</p>

</div>
</div>
<a id="a9b758449024e0dd49d5062fcc502aed7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b758449024e0dd49d5062fcc502aed7">&#9670;&nbsp;</a></span>integral_rec()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../de/d70/classoomph_1_1Integral.html">Integral</a>* <a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html">oomph::VorticitySmoother</a>&lt; ELEMENT &gt;::integral_rec </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;&#160;</td>
          <td class="paramname"><em>is_q_mesh</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Integation scheme associated with the recovery shape functions must be of sufficiently high order to integrate the mass matrix associated with the recovery shape functions. The argument is the dimension of the elements. The integration is performed locally over the elements, so the integration scheme does depend on the geometry of the element. The type of element is specified by the boolean which is true if elements in the patch are QElements and false if they are TElements (will need change if we ever have other element types) </p>
<p>Find order of recovery shape functions</p>
<div class="fragment"><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;    {</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;      <span class="comment">// Create an ostringstream object to create a string</span></div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;      std::ostringstream error_stream;</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160; </div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;      <span class="comment">//----</span></div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;      <span class="comment">// 2D:</span></div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;      <span class="comment">//----</span></div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;<span class="comment"></span>      <span class="keywordflow">switch</span> (<a class="code" href="../../db/d57/classoomph_1_1VorticitySmoother.html#aa6f69b6e4063b73ccfbcdc6443bce623">recovery_order</a>())</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;      {</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;        <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;          <span class="comment">// Complete linear polynomial in 2D:</span></div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;          <span class="keywordflow">if</span> (is_q_mesh)</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;          {</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;            <span class="comment">// Return the appropriate Gauss integration scheme</span></div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;            <span class="keywordflow">return</span> (<span class="keyword">new</span> Gauss&lt;2, 2&gt;);</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;          }</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;          {</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;            <span class="comment">// Return the appropriate Gauss integration scheme</span></div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;            <span class="keywordflow">return</span> (<span class="keyword">new</span> TGauss&lt;2, 2&gt;);</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;          }</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160; </div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;        <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;          <span class="comment">// Complete quadratic polynomial in 2D:</span></div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;          <span class="keywordflow">if</span> (is_q_mesh)</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;          {</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;            <span class="comment">// Return the appropriate Gauss integration scheme</span></div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;            <span class="keywordflow">return</span> (<span class="keyword">new</span> Gauss&lt;2, 3&gt;);</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;          }</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;          {</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;            <span class="comment">// Return the appropriate Gauss integration scheme</span></div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;            <span class="keywordflow">return</span> (<span class="keyword">new</span> TGauss&lt;2, 3&gt;);</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;          }</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160; </div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;        <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;          <span class="comment">// Complete cubic polynomial in 2D:</span></div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;          <span class="keywordflow">if</span> (is_q_mesh)</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;          {</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;            <span class="comment">// Return the appropriate Gauss integration scheme</span></div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;            <span class="keywordflow">return</span> (<span class="keyword">new</span> Gauss&lt;2, 4&gt;);</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;          }</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;          {</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;            <span class="comment">// Return the appropriate Gauss integration scheme</span></div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;            <span class="keywordflow">return</span> (<span class="keyword">new</span> TGauss&lt;2, 4&gt;);</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;          }</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160; </div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;          <span class="comment">// Create an error messaage</span></div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;          error_stream &lt;&lt; <span class="stringliteral">&quot;Recovery shape functions for recovery order &quot;</span></div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;                       &lt;&lt; <a class="code" href="../../db/d57/classoomph_1_1VorticitySmoother.html#aa6f69b6e4063b73ccfbcdc6443bce623">recovery_order</a>()</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot; haven&#39;t yet been implemented for 2D&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160; </div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;          <span class="comment">// Throw an error</span></div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;          <span class="keywordflow">throw</span> OomphLibError(error_stream.str(),</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;                              <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;                              <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;      }</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160; </div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;      <span class="comment">// Dummy return (never get here)</span></div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;      <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;    } <span class="comment">// End of integral_rec</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, and <a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html#aa6f69b6e4063b73ccfbcdc6443bce623">oomph::VorticitySmoother&lt; ELEMENT &gt;::recovery_order()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html#adc724f10b642aa3edc2d02fa8e35787d">oomph::VorticitySmoother&lt; ELEMENT &gt;::get_recovered_vorticity_in_patch()</a>.</p>

</div>
</div>
<a id="a203602aa127f5c89480304a2f10426f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a203602aa127f5c89480304a2f10426f1">&#9670;&nbsp;</a></span>nrecovery_order()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> <a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html">oomph::VorticitySmoother</a>&lt; ELEMENT &gt;::nrecovery_order </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the recovery order. </p>
<div class="fragment"><div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;    {</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;      <span class="comment">// Use a switch statement</span></div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;      <span class="keywordflow">switch</span> (<a class="code" href="../../db/d57/classoomph_1_1VorticitySmoother.html#acda3329b3b841aa78abf756222a5ccbb">Recovery_order</a>)</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;      {</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;        <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;          <span class="comment">// Linear recovery shape functions</span></div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;          <span class="comment">//--------------------------------</span></div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;          <span class="keywordflow">return</span> 3; <span class="comment">// 1, x, y</span></div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160; </div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;        <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;          <span class="comment">// Quadratic recovery shape functions</span></div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;          <span class="comment">//-----------------------------------</span></div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;          <span class="keywordflow">return</span> 6; <span class="comment">// 1, x, y, x^2, xy, y^2</span></div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160; </div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;        <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;          <span class="comment">// Cubic recovery shape functions</span></div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;          <span class="comment">//--------------------------------</span></div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;          <span class="keywordflow">return</span> 10; <span class="comment">// 1, x, y, x^2, xy, y^2, x^3, x^2 y, x y^2, y^3</span></div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160; </div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;          <span class="comment">// Any other recovery order?</span></div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;          <span class="comment">//--------------------------</span></div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;          <span class="comment">// Use an ostringstream object to create an error message</span></div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;          std::ostringstream error_stream;</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160; </div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;          <span class="comment">// Create an error message</span></div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;          error_stream &lt;&lt; <span class="stringliteral">&quot;Wrong Recovery_order &quot;</span> &lt;&lt; <a class="code" href="../../db/d57/classoomph_1_1VorticitySmoother.html#acda3329b3b841aa78abf756222a5ccbb">Recovery_order</a></div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;                       &lt;&lt; std::endl;</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160; </div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;          <span class="comment">// Throw an error</span></div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;          <span class="keywordflow">throw</span> OomphLibError(error_stream.str(),</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;                              <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;                              <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;      }</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;    } <span class="comment">// End of nrecovery_order</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, and <a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html#acda3329b3b841aa78abf756222a5ccbb">oomph::VorticitySmoother&lt; ELEMENT &gt;::Recovery_order</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html#a43d407cf76048465189095a82c4f1e32">oomph::VorticitySmoother&lt; ELEMENT &gt;::recover_vorticity()</a>.</p>

</div>
</div>
<a id="aaa18a8649777088f00d06959ea0db4ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa18a8649777088f00d06959ea0db4ac">&#9670;&nbsp;</a></span>operator=()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html">oomph::VorticitySmoother</a>&lt; ELEMENT &gt;::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html">VorticitySmoother</a>&lt; ELEMENT &gt; &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Broken assignment operator. </p>

</div>
</div>
<a id="a4d708f1505080ea241cbb6bc71e2b01a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d708f1505080ea241cbb6bc71e2b01a">&#9670;&nbsp;</a></span>recover_vorticity() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html">oomph::VorticitySmoother</a>&lt; ELEMENT &gt;::recover_vorticity </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *&#160;</td>
          <td class="paramname"><em>mesh_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Recover vorticity from patches. </p>
<div class="fragment"><div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;    {</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;      <span class="comment">// Create a DocInfo object (used as a dummy argument)</span></div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;      DocInfo doc_info;</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160; </div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;      <span class="comment">// Disable any documentation</span></div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;      doc_info.disable_doc();</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160; </div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;      <span class="comment">// Recover the vorticity</span></div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;      <a class="code" href="../../db/d57/classoomph_1_1VorticitySmoother.html#a4d708f1505080ea241cbb6bc71e2b01a">recover_vorticity</a>(mesh_pt, doc_info);</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1VorticitySmoother_html_a4d708f1505080ea241cbb6bc71e2b01a"><div class="ttname"><a href="../../db/d57/classoomph_1_1VorticitySmoother.html#a4d708f1505080ea241cbb6bc71e2b01a">oomph::VorticitySmoother::recover_vorticity</a></div><div class="ttdeci">void recover_vorticity(Mesh *mesh_pt)</div><div class="ttdoc">Recover vorticity from patches.</div><div class="ttdef"><b>Definition:</b> vorticity_smoother.h:2434</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html#a666a20817ab9c396b225d8652bc0a338">oomph::DocInfo::disable_doc()</a>.</p>

</div>
</div>
<a id="a43d407cf76048465189095a82c4f1e32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43d407cf76048465189095a82c4f1e32">&#9670;&nbsp;</a></span>recover_vorticity() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html">oomph::VorticitySmoother</a>&lt; ELEMENT &gt;::recover_vorticity </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *&#160;</td>
          <td class="paramname"><em>mesh_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>doc_info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Recover vorticity from patches &ndash; output intermediate steps to directory specified by DocInfo object </p>
<div class="fragment"><div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;    {</div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;      <span class="comment">// Start the timer</span></div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;      <span class="keywordtype">double</span> t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160; </div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;      <span class="comment">// Allocate space for the local coordinates</span></div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;      Vector&lt;double&gt; <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>(2, 0.0);</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160; </div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;      <span class="comment">// Allocate space for the global coordinates</span></div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;      Vector&lt;double&gt; <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>(2, 0.0);</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160; </div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;      <span class="comment">// Make patches</span></div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;      <span class="comment">//-------------</span></div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;      <span class="comment">// Allocate space for the mapping from nodes to elements</span></div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;      std::map&lt;Node*, Vector&lt;ELEMENT*&gt;*&gt; adjacent_elements_pt;</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160; </div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;      <span class="comment">// Allocate space for the vertex nodes</span></div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;      Vector&lt;Node*&gt; vertex_node_pt;</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160; </div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;      <span class="comment">// Set up the patches information</span></div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;      <a class="code" href="../../db/d57/classoomph_1_1VorticitySmoother.html#ae8e49f99dfb35e6ee5eebbce87131d44">setup_patches</a>(mesh_pt, adjacent_elements_pt, vertex_node_pt);</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160; </div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;      <span class="comment">// Grab any element (this shouldn&#39;t be a null pointer)</span></div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;      ELEMENT* <span class="keyword">const</span> el_pt = <span class="keyword">dynamic_cast&lt;</span>ELEMENT*<span class="keyword">&gt;</span>(mesh_pt-&gt;element_pt(0));</div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160; </div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;      <span class="comment">// Get the index of the vorticity</span></div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;      <span class="keywordtype">unsigned</span> smoothed_vorticity_index = el_pt-&gt;smoothed_vorticity_index();</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160; </div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;      <span class="comment">// Maximum order of vorticity derivative (that can be recovered)</span></div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;      <span class="keywordtype">unsigned</span> max_vort_order =</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;        el_pt-&gt;get_maximum_order_of_recoverable_vorticity_derivative();</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160; </div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;      <span class="comment">// Maximum order of velocity derivative (that can be recovered)</span></div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;      <span class="keywordtype">unsigned</span> max_veloc_order =</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;        el_pt-&gt;get_maximum_order_of_recoverable_velocity_derivative();</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160; </div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;      <span class="comment">// Maximum number of recoverable vorticity terms</span></div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;      <span class="keywordtype">unsigned</span> max_vort_recov = 0;</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160; </div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;      <span class="comment">// Maximum number of recoverable velocity terms</span></div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;      <span class="keywordtype">unsigned</span> max_veloc_recov = 0;</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160; </div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;      <span class="comment">// Loop over the entries of the vector</span></div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; max_vort_order + 1; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;      {</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;        <span class="comment">// Get the number of partial derivatives of the vorticity</span></div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;        max_vort_recov += el_pt-&gt;npartial_derivative(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;      }</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160; </div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;      <span class="comment">// Loop over the entries of the vector</span></div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 1; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; max_veloc_order + 1; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;      {</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;        <span class="comment">// Get the number of partial derivatives of the vorticity</span></div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;        max_veloc_recov += 2 * el_pt-&gt;npartial_derivative(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;      }</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160; </div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;      <span class="comment">// Number of recovered vorticity derivatives</span></div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;      <span class="keywordtype">unsigned</span> n_recovered_vort_derivs =</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;        el_pt-&gt;nvorticity_derivatives_to_recover();</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160; </div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;      <span class="comment">// Number of recovered velocity derivatives</span></div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;      <span class="keywordtype">unsigned</span> n_recovered_veloc_derivs =</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;        el_pt-&gt;nvelocity_derivatives_to_recover();</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160; </div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;      <span class="comment">// Determine number of coefficients for expansion of recovered vorticity.</span></div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;      <span class="comment">// Use complete polynomial of given order for recovery</span></div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;      <span class="keywordtype">unsigned</span> num_recovery_terms = <a class="code" href="../../db/d57/classoomph_1_1VorticitySmoother.html#a203602aa127f5c89480304a2f10426f1">nrecovery_order</a>();</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160; </div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;      <span class="comment">// Counter for averaging of recovered vorticity and its derivatives</span></div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;      std::map&lt;Node*, unsigned&gt; count;</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160; </div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;      <span class="comment">// Counter for which nodal value we&#39;re assigning</span></div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;      <span class="keywordtype">unsigned</span> nodal_dof = 0;</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160; </div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;      <span class="comment">// Loop over derivatives</span></div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> deriv = 0; deriv &lt; max_vort_recov + max_veloc_recov;</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;           deriv++)</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;      {</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;        <span class="comment">// If we&#39;re not recovering this vorticity derivative. Note, we cast</span></div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;        <span class="comment">// to an int because n_recovered_vort_derivs can be zero (so subtracting</span></div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;        <span class="comment">// any positive integer can cause trouble)</span></div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;        <span class="keywordflow">if</span> ((<span class="keywordtype">int</span>(deriv) &gt; <span class="keywordtype">int</span>(n_recovered_vort_derivs - 1)) &amp;&amp;</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;            (deriv &lt; max_vort_recov))</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;        {</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;          <span class="comment">// We&#39;re done here</span></div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;        }</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;        <span class="comment">// If we&#39;re not recovering any of the velocity derivatives and we&#39;re</span></div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;        <span class="comment">// finished with the vorticity derivatives</span></div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((n_recovered_veloc_derivs == 0) &amp;&amp; (deriv &gt;= max_vort_recov))</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;        {</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;          <span class="comment">// We&#39;re done here</span></div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;        }</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160; </div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;        <span class="comment">// Storage for accumulated nodal vorticity (used to compute nodal</span></div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;        <span class="comment">// averages)</span></div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;        std::map&lt;Node*, double&gt; averaged_recovered_vort;</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160; </div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;        <span class="comment">// Calculation of vorticity</span></div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;        <span class="comment">//-------------------------</span></div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;        <span class="comment">// Do patch recovery</span></div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;        <span class="comment">// unsigned counter=0;</span></div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">typename</span> std::map&lt;Node*, Vector&lt;ELEMENT*&gt;*&gt;::iterator it =</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;               adjacent_elements_pt.begin();</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;             it != adjacent_elements_pt.end();</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;             it++)</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;        {</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;          <span class="comment">// Pointer to the recovered vorticity coefficients</span></div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;          Vector&lt;double&gt;* recovered_vorticity_coefficient_pt;</div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160; </div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;          <span class="comment">// Setup smoothed vorticity field for patches</span></div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;          <a class="code" href="../../db/d57/classoomph_1_1VorticitySmoother.html#adc724f10b642aa3edc2d02fa8e35787d">get_recovered_vorticity_in_patch</a>(*(it-&gt;second),</div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;                                           num_recovery_terms,</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;                                           recovered_vorticity_coefficient_pt,</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;                                           deriv);</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160; </div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;          <span class="comment">// Now get the nodal average of the recovered vorticity (nodes are</span></div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;          <span class="comment">// generally part of multiple patches):</span></div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160; </div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;          <span class="comment">// Get the number of elements in adjacent_elements_pt</span></div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;          <span class="keywordtype">unsigned</span> nelem = (*(it-&gt;second)).size();</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160; </div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;          <span class="comment">// Loop over all elements to get recovered vorticity</span></div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; nelem; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;          {</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;            <span class="comment">// Get pointer to element</span></div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;            ELEMENT* <span class="keyword">const</span> el_pt = (*(it-&gt;second))[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>];</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160; </div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;            <span class="comment">// Get the number of nodes by element</span></div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;            <span class="keywordtype">unsigned</span> nnode_el = el_pt-&gt;nnode();</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160; </div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;            <span class="comment">// Loop over the nodes in the element</span></div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; nnode_el; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;            {</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;              <span class="comment">// Get a pointer to the j-th node in this element</span></div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;              Node* nod_pt = el_pt-&gt;node_pt(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160; </div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;              <span class="comment">// Get the local coordinates of the node</span></div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;              el_pt-&gt;local_coordinate_of_node(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>);</div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160; </div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;              <span class="comment">// Interpolate the global (Eulerian) coordinate</span></div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;              el_pt-&gt;interpolated_x(<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>, <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>);</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160; </div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;              <span class="comment">// Recovery shape functions at global (Eulerian) coordinate</span></div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;              Vector&lt;double&gt; psi_r(num_recovery_terms);</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160; </div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;              <span class="comment">// Recover the shape function values at the position x</span></div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;              <a class="code" href="../../db/d57/classoomph_1_1VorticitySmoother.html#a7c6a0c1333a418b70ae3e629d63f7bf6">shape_rec</a>(<a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>, psi_r);</div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160; </div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;              <span class="comment">// Initialise the value of the recovered quantity</span></div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;              <span class="keywordtype">double</span> recovered_vort = 0.0;</div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160; </div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;              <span class="comment">// Loop over the recovery terms</span></div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; num_recovery_terms; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;              {</div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;                <span class="comment">// Assemble recovered vorticity</span></div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;                recovered_vort +=</div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;                  (*recovered_vorticity_coefficient_pt)[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] * psi_r[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;              }</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160; </div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;              <span class="comment">// Keep adding</span></div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;              averaged_recovered_vort[nod_pt] += recovered_vort;</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160; </div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;              <span class="comment">// Increment the counter</span></div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;              count[nod_pt]++;</div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;            } <span class="comment">// for (unsigned j=0;j&lt;nnode_el;j++)</span></div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;          } <span class="comment">// for (unsigned e=0;e&lt;nelem;e++)</span></div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160; </div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;          <span class="comment">// Delete the recovered coefficient data</span></div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;          <span class="keyword">delete</span> recovered_vorticity_coefficient_pt;</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160; </div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;          <span class="comment">// Make it a null pointer</span></div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;          recovered_vorticity_coefficient_pt = 0;</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;        } <span class="comment">// for (typename std::map&lt;Node*,Vector&lt;ELEMENT*&gt;*&gt;::iterator it=...</span></div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160; </div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;        <span class="comment">// Find out how many nodes there are in the mesh</span></div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;        <span class="keywordtype">unsigned</span> nnod = mesh_pt-&gt;nnode();</div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160; </div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;        <span class="comment">// Loop over all nodes to actually work out the average</span></div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; nnod; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;        {</div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;          <span class="comment">// Make a pointer to the j-th node</span></div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;          Node* nod_pt = mesh_pt-&gt;node_pt(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160; </div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;          <span class="comment">// Calculate the values of the smoothed vorticity</span></div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;          averaged_recovered_vort[nod_pt] /= count[nod_pt];</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160; </div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;          <span class="comment">// Assign smoothed vorticity to nodal values</span></div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;          nod_pt-&gt;set_value(smoothed_vorticity_index + nodal_dof,</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;                            averaged_recovered_vort[nod_pt]);</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;        }</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160; </div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;        <span class="comment">// We&#39;re done with this dof so increment the counter</span></div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;        nodal_dof++;</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160; </div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;        <span class="comment">// Start again</span></div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;        count.clear();</div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;      } <span class="comment">// for (unsigned deriv=0;deriv&lt;max_vort_recov+max_veloc_recov;deriv++)</span></div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160; </div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;      <span class="comment">// Cleanup</span></div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">typename</span> std::map&lt;Node*, Vector&lt;ELEMENT*&gt;*&gt;::iterator it =</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;             adjacent_elements_pt.begin();</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;           it != adjacent_elements_pt.end();</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;           it++)</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;      {</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;        <span class="comment">// Delete the vector of element pointers</span></div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;        <span class="keyword">delete</span> it-&gt;second;</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;      }</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160; </div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;      <span class="comment">// Inform the user</span></div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for vorticity recovery [sec]: &quot;</span></div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;                 &lt;&lt; <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>() - t_start &lt;&lt; std::endl;</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;    } <span class="comment">// End of recover_vorticity</span></div>
<div class="ttc" id="aclassoomph_1_1VorticitySmoother_html_a203602aa127f5c89480304a2f10426f1"><div class="ttname"><a href="../../db/d57/classoomph_1_1VorticitySmoother.html#a203602aa127f5c89480304a2f10426f1">oomph::VorticitySmoother::nrecovery_order</a></div><div class="ttdeci">unsigned nrecovery_order() const</div><div class="ttdoc">Get the recovery order.</div><div class="ttdef"><b>Definition:</b> vorticity_smoother.h:2393</div></div>
<div class="ttc" id="aclassoomph_1_1VorticitySmoother_html_adc724f10b642aa3edc2d02fa8e35787d"><div class="ttname"><a href="../../db/d57/classoomph_1_1VorticitySmoother.html#adc724f10b642aa3edc2d02fa8e35787d">oomph::VorticitySmoother::get_recovered_vorticity_in_patch</a></div><div class="ttdeci">void get_recovered_vorticity_in_patch(const Vector&lt; ELEMENT * &gt; &amp;patch_el_pt, const unsigned &amp;num_recovery_terms, Vector&lt; double &gt; *&amp;recovered_vorticity_coefficient_pt, unsigned &amp;n_deriv)</div><div class="ttdef"><b>Definition:</b> vorticity_smoother.h:2115</div></div>
<div class="ttc" id="aclassoomph_1_1VorticitySmoother_html_ae8e49f99dfb35e6ee5eebbce87131d44"><div class="ttname"><a href="../../db/d57/classoomph_1_1VorticitySmoother.html#ae8e49f99dfb35e6ee5eebbce87131d44">oomph::VorticitySmoother::setup_patches</a></div><div class="ttdeci">void setup_patches(Mesh *&amp;mesh_pt, std::map&lt; Node *, Vector&lt; ELEMENT * &gt; * &gt; &amp;adjacent_elements_pt, Vector&lt; Node * &gt; &amp;vertex_node_pt)</div><div class="ttdef"><b>Definition:</b> vorticity_smoother.h:1999</div></div>
<div class="ttc" id="anamespaceoomph_1_1TimingHelpers_html_a9fb6ad7e2e01b0914e9f7072ef9ebfa6"><div class="ttname"><a href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">oomph::TimingHelpers::timer</a></div><div class="ttdeci">double timer()</div><div class="ttdoc">returns the time in seconds after some point in past</div><div class="ttdef"><b>Definition:</b> oomph_utilities.cc:1295</div></div>
<div class="ttc" id="atut__arithmetic__redux__minmax_8cpp_html_a39513f0f8d942bf9ef17b2e87ac6d34e"><div class="ttname"><a href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a></div><div class="ttdeci">std::ptrdiff_t j</div><div class="ttdef"><b>Definition:</b> tut_arithmetic_redux_minmax.cpp:2</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">oomph::Mesh::element_pt()</a>, <a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html#adc724f10b642aa3edc2d02fa8e35787d">oomph::VorticitySmoother&lt; ELEMENT &gt;::get_recovered_vorticity_in_patch()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a945e7823d1a2af243b5b7f7866aaff5e">oomph::Mesh::nnode()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">oomph::Mesh::node_pt()</a>, <a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html#a203602aa127f5c89480304a2f10426f1">oomph::VorticitySmoother&lt; ELEMENT &gt;::nrecovery_order()</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, <a class="el" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>, <a class="el" href="../../d8/dc5/classoomph_1_1Data.html#a7289ca322725c6fd493970a19474b382">oomph::Data::set_value()</a>, <a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html#ae8e49f99dfb35e6ee5eebbce87131d44">oomph::VorticitySmoother&lt; ELEMENT &gt;::setup_patches()</a>, <a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html#a7c6a0c1333a418b70ae3e629d63f7bf6">oomph::VorticitySmoother&lt; ELEMENT &gt;::shape_rec()</a>, <a class="el" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">oomph::TimingHelpers::timer()</a>, and <a class="el" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">plotDoE::x</a>.</p>

</div>
</div>
<a id="aa6f69b6e4063b73ccfbcdc6443bce623"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6f69b6e4063b73ccfbcdc6443bce623">&#9670;&nbsp;</a></span>recovery_order()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&amp; <a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html">oomph::VorticitySmoother</a>&lt; ELEMENT &gt;::recovery_order </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Access function for order of recovery polynomials. </p>
<div class="fragment"><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;    {</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;      <span class="comment">// Return the order of recovery</span></div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../db/d57/classoomph_1_1VorticitySmoother.html#acda3329b3b841aa78abf756222a5ccbb">Recovery_order</a>;</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html#acda3329b3b841aa78abf756222a5ccbb">oomph::VorticitySmoother&lt; ELEMENT &gt;::Recovery_order</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html#a9b758449024e0dd49d5062fcc502aed7">oomph::VorticitySmoother&lt; ELEMENT &gt;::integral_rec()</a>, and <a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html#a7c6a0c1333a418b70ae3e629d63f7bf6">oomph::VorticitySmoother&lt; ELEMENT &gt;::shape_rec()</a>.</p>

</div>
</div>
<a id="ae8e49f99dfb35e6ee5eebbce87131d44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8e49f99dfb35e6ee5eebbce87131d44">&#9670;&nbsp;</a></span>setup_patches()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html">oomph::VorticitySmoother</a>&lt; ELEMENT &gt;::setup_patches </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *&amp;&#160;</td>
          <td class="paramname"><em>mesh_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::map&lt; <a class="el" href="../../dc/db7/classoomph_1_1Node.html">Node</a> *, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; ELEMENT * &gt; * &gt; &amp;&#160;</td>
          <td class="paramname"><em>adjacent_elements_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../dc/db7/classoomph_1_1Node.html">Node</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>vertex_node_pt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Setup patches: For each vertex node pointed to by nod_pt, adjacent_elements_pt[nod_pt] contains the pointer to the vector that contains the pointers to the elements that the node is part of. Also returns a Vector of vertex nodes for use in get_element_errors. </p>
<div class="fragment"><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;    {</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;      <span class="comment">// Clear: hierher should we do this in Z2 as well?</span></div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;      adjacent_elements_pt.clear();</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160; </div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;      <span class="comment">// Auxiliary map that contains element-adjacency for ALL nodes</span></div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;      std::map&lt;Node*, Vector&lt;ELEMENT*&gt;*&gt; aux_adjacent_elements_pt;</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160; </div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;      <span class="comment">// Check if all elements request the same recovery order</span></div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;      <span class="keywordtype">unsigned</span> ndisagree = 0;</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160; </div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;      <span class="comment">// Loop over all elements to setup adjacency for all nodes.</span></div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;      <span class="comment">// Need to do this because midside nodes can be corner nodes for</span></div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;      <span class="comment">// adjacent smaller elements! Admittedly, the inclusion of interior</span></div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;      <span class="comment">// nodes is wasteful...</span></div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;      <span class="keywordtype">unsigned</span> nelem = mesh_pt-&gt;nelement();</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; nelem; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;      {</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;        ELEMENT* el_pt = <span class="keyword">dynamic_cast&lt;</span>ELEMENT*<span class="keyword">&gt;</span>(mesh_pt-&gt;element_pt(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>));</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160; </div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;        <span class="comment">// Check if all elements request the same recovery order</span></div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;        <span class="keywordflow">if</span> (el_pt-&gt;nrecovery_order() != <a class="code" href="../../db/d57/classoomph_1_1VorticitySmoother.html#acda3329b3b841aa78abf756222a5ccbb">Recovery_order</a>)</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;        {</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;          ndisagree++;</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;        }</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160; </div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;        <span class="comment">// Loop all nodes in element</span></div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;        <span class="keywordtype">unsigned</span> nnod = el_pt-&gt;nnode();</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; nnod; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;        {</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;          <span class="comment">// Make a pointer to the n-th node</span></div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;          Node* nod_pt = el_pt-&gt;node_pt(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>);</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160; </div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;          <span class="comment">// Has this node been considered before?</span></div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;          <span class="keywordflow">if</span> (aux_adjacent_elements_pt[nod_pt] == 0)</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;          {</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;            <span class="comment">// Create Vector of pointers to its adjacent elements</span></div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;            aux_adjacent_elements_pt[nod_pt] = <span class="keyword">new</span> Vector&lt;ELEMENT*&gt;;</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;          }</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160; </div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;          <span class="comment">// Add pointer to adjacent element</span></div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;          (*aux_adjacent_elements_pt[nod_pt]).push_back(el_pt);</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;        }</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;      } <span class="comment">// end element loop</span></div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160; </div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;      <span class="comment">// Check if all elements request the same recovery order</span></div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;      <span class="keywordflow">if</span> (ndisagree != 0)</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;      {</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a></div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;\n\n======================================================\n&quot;</span></div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;WARNING:\n&quot;</span></div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;          &lt;&lt; ndisagree &lt;&lt; <span class="stringliteral">&quot; out of &quot;</span> &lt;&lt; mesh_pt-&gt;nelement() &lt;&lt; <span class="stringliteral">&quot; elements&quot;</span></div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;\nhave different preferences for the order of the recovery&quot;</span></div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;\nshape functions. We are using: Recovery_order=&quot;</span></div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;          &lt;&lt; <a class="code" href="../../db/d57/classoomph_1_1VorticitySmoother.html#acda3329b3b841aa78abf756222a5ccbb">Recovery_order</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a></div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;======================================================\n\n&quot;</span>;</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;      }</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160; </div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;      <span class="comment">// Loop over all elements, extract adjacency for corner nodes only</span></div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;      nelem = mesh_pt-&gt;nelement();</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; nelem; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;      {</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;        ELEMENT* el_pt = <span class="keyword">dynamic_cast&lt;</span>ELEMENT*<span class="keyword">&gt;</span>(mesh_pt-&gt;element_pt(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>));</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160; </div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;        <span class="comment">// Loop over corner nodes</span></div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;        <span class="keywordtype">unsigned</span> n_node = el_pt-&gt;nvertex_node();</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_node; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;        {</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;          Node* nod_pt = el_pt-&gt;vertex_node_pt(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>);</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160; </div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;          <span class="comment">// Has this node been considered before?</span></div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;          <span class="keywordflow">if</span> (adjacent_elements_pt[nod_pt] == 0)</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;          {</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;            <span class="comment">// Add the node pointer to the vertex node container</span></div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;            vertex_node_pt.push_back(nod_pt);</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160; </div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;            <span class="comment">// Create Vector of pointers to its adjacent elements</span></div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;            adjacent_elements_pt[nod_pt] = <span class="keyword">new</span> Vector&lt;ELEMENT*&gt;;</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160; </div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;            <span class="comment">// Copy across:</span></div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;            <span class="keywordtype">unsigned</span> nel = (*aux_adjacent_elements_pt[nod_pt]).<a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>();</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; nel; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;            {</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;              (*adjacent_elements_pt[nod_pt])</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;                .push_back((*aux_adjacent_elements_pt[nod_pt])[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>]);</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;            }</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;          }</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;        }</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;      } <span class="comment">// End of loop over elements</span></div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160; </div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;      <span class="comment">// Cleanup</span></div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">typename</span> std::map&lt;Node*, Vector&lt;ELEMENT*&gt;*&gt;::iterator it =</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;             aux_adjacent_elements_pt.begin();</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;           it != aux_adjacent_elements_pt.end();</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;           it++)</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;      {</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;        <span class="keyword">delete</span> it-&gt;second;</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;      }</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;    } <span class="comment">// End of setup_patches</span></div>
<div class="ttc" id="aCG3DPackingUnitTest_8cpp_html_a7026fd16370249ce97cb3d062326baf9"><div class="ttname"><a href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a></div><div class="ttdeci">const unsigned n</div><div class="ttdef"><b>Definition:</b> CG3DPackingUnitTest.cpp:11</div></div>
<div class="ttc" id="abenchVecAdd_8cpp_html_a439227feff9d7f55384e8780cfc2eb82"><div class="ttname"><a href="../../db/ddc/benchVecAdd_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a></div><div class="ttdeci">Scalar Scalar int size</div><div class="ttdef"><b>Definition:</b> benchVecAdd.cpp:17</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">oomph::Mesh::element_pt()</a>, <a class="el" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">oomph::Mesh::nelement()</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, <a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html#acda3329b3b841aa78abf756222a5ccbb">oomph::VorticitySmoother&lt; ELEMENT &gt;::Recovery_order</a>, and <a class="el" href="../../db/ddc/benchVecAdd_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html#a43d407cf76048465189095a82c4f1e32">oomph::VorticitySmoother&lt; ELEMENT &gt;::recover_vorticity()</a>.</p>

</div>
</div>
<a id="a7c6a0c1333a418b70ae3e629d63f7bf6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c6a0c1333a418b70ae3e629d63f7bf6">&#9670;&nbsp;</a></span>shape_rec()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html">oomph::VorticitySmoother</a>&lt; ELEMENT &gt;::shape_rec </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>psi_r</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Recovery shape functions as functions of the global, Eulerian coordinate x of dimension dim. The recovery shape functions are complete polynomials of the order specified by Recovery_order. </p>
<div class="fragment"><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;    {</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;      <span class="comment">// Create an ostringstream object to create a string</span></div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;      std::ostringstream error_stream;</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160; </div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;      <span class="comment">// Find order of recovery shape functions</span></div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;      <span class="keywordflow">switch</span> (<a class="code" href="../../db/d57/classoomph_1_1VorticitySmoother.html#aa6f69b6e4063b73ccfbcdc6443bce623">recovery_order</a>())</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;      {</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;        <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;          <span class="comment">// Complete linear polynomial in 2D:</span></div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;          psi_r[0] = 1.0;</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;          psi_r[1] = <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>[0];</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;          psi_r[2] = <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>[1];</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160; </div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;        <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;          <span class="comment">// Complete quadratic polynomial in 2D:</span></div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;          psi_r[0] = 1.0;</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;          psi_r[1] = <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>[0];</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;          psi_r[2] = <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>[1];</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;          psi_r[3] = <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>[0] * <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>[0];</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;          psi_r[4] = <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>[0] * <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>[1];</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;          psi_r[5] = <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>[1] * <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>[1];</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160; </div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;        <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;          <span class="comment">// Complete cubic polynomial in 2D:</span></div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;          psi_r[0] = 1.0;</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;          psi_r[1] = <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>[0];</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;          psi_r[2] = <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>[1];</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;          psi_r[3] = <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>[0] * <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>[0];</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;          psi_r[4] = <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>[0] * <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>[1];</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;          psi_r[5] = <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>[1] * <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>[1];</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;          psi_r[6] = <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>[0] * <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>[0] * <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>[0];</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;          psi_r[7] = <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>[0] * <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>[0] * <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>[1];</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;          psi_r[8] = <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>[0] * <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>[1] * <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>[1];</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;          psi_r[9] = <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>[1] * <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>[1] * <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>[1];</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160; </div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;          <span class="comment">// Create an error message for this case</span></div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;          error_stream &lt;&lt; <span class="stringliteral">&quot;Recovery shape functions for recovery order &quot;</span></div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;                       &lt;&lt; <a class="code" href="../../db/d57/classoomph_1_1VorticitySmoother.html#aa6f69b6e4063b73ccfbcdc6443bce623">recovery_order</a>()</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot; haven&#39;t yet been implemented for 2D&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160; </div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;          <span class="comment">// Throw an error</span></div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;          <span class="keywordflow">throw</span> OomphLibError(error_stream.str(),</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;                              <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;                              <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;      }</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;    } <span class="comment">// End of shape_rec</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html#aa6f69b6e4063b73ccfbcdc6443bce623">oomph::VorticitySmoother&lt; ELEMENT &gt;::recovery_order()</a>, and <a class="el" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">plotDoE::x</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html#adc724f10b642aa3edc2d02fa8e35787d">oomph::VorticitySmoother&lt; ELEMENT &gt;::get_recovered_vorticity_in_patch()</a>, and <a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html#a43d407cf76048465189095a82c4f1e32">oomph::VorticitySmoother&lt; ELEMENT &gt;::recover_vorticity()</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="acda3329b3b841aa78abf756222a5ccbb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acda3329b3b841aa78abf756222a5ccbb">&#9670;&nbsp;</a></span>Recovery_order</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> <a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html">oomph::VorticitySmoother</a>&lt; ELEMENT &gt;::Recovery_order</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Order of recovery polynomials. </p>

<p class="reference">Referenced by <a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html#a203602aa127f5c89480304a2f10426f1">oomph::VorticitySmoother&lt; ELEMENT &gt;::nrecovery_order()</a>, <a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html#aa6f69b6e4063b73ccfbcdc6443bce623">oomph::VorticitySmoother&lt; ELEMENT &gt;::recovery_order()</a>, and <a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html#ae8e49f99dfb35e6ee5eebbce87131d44">oomph::VorticitySmoother&lt; ELEMENT &gt;::setup_patches()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="../../de/d0e/vorticity__smoother_8h_source.html">vorticity_smoother.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../da/ddf/namespaceoomph.html">oomph</a></li><li class="navelem"><a class="el" href="../../db/d57/classoomph_1_1VorticitySmoother.html">VorticitySmoother</a></li>
    <li class="footer">Generated on Wed Aug 27 2025 17:09:24 for MercuryDPM by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
