<!-- HTML header for doxygen 1.8.18-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MercuryDPM: Introduction to the Code</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../MDPM.css" rel="stylesheet" type="text/css"/>
<link href="../../codeLabels.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-fork-corner.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-dropdown-version.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../MDPM-fragment-copy-button.js"></script>
<script type="text/javascript">
DoxygenAwesomeFragmentCopyButton.init()
</script>
<script type="text/javascript" src="../../MDPM-paragraph-link.js"></script>
<script type="text/javascript">
DoxygenAwesomeParagraphLink.init()
</script>
<script type="text/javascript" src="../../MDPM-interactive-toc.js"></script>
<script type="text/javascript">
DoxygenAwesomeInteractiveToc.init()
</script>
<script type="text/javascript" src="../../MDPM-darkmode-toggle.js"></script>
<script type="text/javascript">
DoxygenAwesomeDarkModeToggle.init()
</script>
</head>
<body>
  <div id="bitbucket-corner">
   <a href="https://bitbucket.org/mercurydpm/mercurydpm/src/master/" target="_blank" id="fork-corner" class="fork-corner fc-pos-tr fc-animate fc-theme-bitbucket"></a>
  </div>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../mercury-logo-chosen-light-slogan.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"> <!--MercuryDPM--!>
   <!-- BEGIN version select -->
   <div class="dropdown" id="projectnumber">
    <button class="dropbtn">v1.0</button>
    <div class="dropdown-content">
    </div>
   </div>
   <script type="text/javascript" src="../../MDPM-dropdown-version.js"></script>
<!-- END version select -->
   <!--&#160;<span id="projectnumber">revision: v1.0</span>-->
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<script type="text/javascript" src="../../MDPM-fork-corner.js"></script>
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('df/d1c/IntroductionToTheCode.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Introduction to the Code </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="SECTION_InfoUsers"></a>
Information for users of this application</h1>
<h2><a class="anchor" id="SUBSECTION_GeneralInfo"></a>
General Information</h2>
<p>This code is written in C++ and does make use of both templates and the object oriented nature of C++. This basic architecture is to have a core kernel code (located in scr) that is general and flexible and then very small driver codes (located in DRIVERS) that pick out the parts of the kernel required to solve specific problems.</p>
<h2><a class="anchor" id="SUBSECTION_DirUsers"></a>
Directory Structure</h2>
<p>At the top level you will find six main directories <br  />
 Configuration/ <br  />
 Documentation/ <br  />
 Drivers/ <br  />
 Kernel/ <br  />
 Scripts/ <br  />
 Tools/ <br  />
 XBalls/ <br  />
 In the Documentation directory is located the documentation, i.e. this file. Please note, if you find no documentation there it can be generated by going into the DRIVERS/ direction and typing "make doc". If the documentation becomes corrupt the following will force it to regenerate "make docClean; make doc"</p>
<p>The Kernel direction contains the heart of the code and as a users you should not need to known much about it.</p>
<p>The Drivers directory has a series of subdirectories for example Tutorials/ that each contain a series of demo codes illustrating how to use the main src code. Typing "make fullTest" in the top level of drivers would perform checks on all parts of the code to confirm everything is functioning as intended.</p>
<p>Finally running a code will (in general) generate four files called some_name.data, some_name.xballs, some_name.stat. and some_name.ene. The files with .data extension contain all the position and velocity information for every particles. The .stat extension, contains macroscopic statistics about the problem (the information contained is semi-driver dependent). The .ene file contain some basic bulk information about the system i.e. centre of mass, total kinetic energy, total potential energy, etc. Finally .xballs extension is an a script file that to run to plot for .data output file using xballs.</p>
<h2><a class="anchor" id="SUBSECTION_TheScripts"></a>
The Scripts</h2>
<p>The directory contains a full scripts that are used by the selftest suite of MercuryDPM. You need worry about the contains of this directory at all; however, for the interested reader</p><ul>
<li>fpdiff.py : Calculated the floating point different between number in text file. This is part of the internal working of the selftest routine. This original version of this code was created for the oomph-lib project at the University of Manchester.</li>
<li>self_test : Makes calls to fpdiff.py passing the locations of newly create data and existing golddata. If writes error logs if something is different between the new data file and the golddata.</li>
</ul>
<h2><a class="anchor" id="SUBSECTION_DriverDir"></a>
Creating your own DRIVERS directory for your code</h2>
<p>It you look in the DRIVERS directory you will see several subdirectories. These subdirectories contain collections of similar codes and, as a new user, you probably want to create a new directory for your own driver codes. To do this copy the TEMPLATE direction to you YOUR_DIR_NAME (if your are a developer and have access to git repository it is advisable to use git to create your new DRIVERS directory see <a class="el" href="../../dc/d32/DevelopersGuide.html">Guidelines for Users and Developers</a>)</p>
<h1><a class="anchor" id="Variables"></a>
Variables and Equations</h1>
<ol type="1">
<li>global parameters: for details refer to MD class documentation.<ul>
<li>time domain \([0,t_{\mbox{max}}]\),</li>
<li>spatial domain \([x_{\mbox{min}},x_{\mbox{max}}] \times [y_{\mbox{min}},y_{\mbox{max}}] \times [z_{\mbox{min}},z_{\mbox{max}}]\),</li>
<li>number of particles \( N \),</li>
<li>number of (regular) walls \( N_{wall}\),</li>
<li>number of periodic walls \( N_{wall,periodic}\)</li>
<li>gravitational acceleration \( \vec{g}\),</li>
<li>Walls are defined by outward unit normal \( \vec{n}_{\mbox{w}}\) and position \( p_{\mbox{w}}\): \( \mbox{w} = \{\vec{x}:\ \vec{n}_{\mbox{w}} \cdot \vec{x} = p_{\mbox{w}} \}\)</li>
</ul>
</li>
<li>global variables: for details refer to MD class documentation.<ul>
<li>time \( t \),</li>
</ul>
</li>
<li>parameters for particle \( \mbox{P}_i \) : for details refer to CParticle class documentation<ul>
<li>radius \( a_i \),</li>
<li>mass \( m_i = \frac{4}{3} \pi a_i^3 \),</li>
<li>inertia \( I_i = \frac{2}{5} m_i \),</li>
<li>normal spring constant \( k \) (globally set)</li>
<li>normal dissipation coefficient \( \gamma \),</li>
<li>tangential dissipation coefficient \( \gamma^t \),</li>
<li>Coulomb friction coefficient \( \mu \)</li>
</ul>
</li>
<li>variables for particle \( \mbox{P}_i \): for details refer to CParticle class documentation<ul>
<li>position \( \vec{r}_i(t)\),</li>
<li>velocity \( \vec{v}_i(t)\),</li>
<li>angle \( \vec{\alpha}_i(t)\),</li>
<li>angular velocity \( \vec{\omega}_i(t)\).</li>
</ul>
</li>
<li>initial values:<ul>
<li>position \( \vec{r}_i(0) = \vec{r}_i^0 \),</li>
<li>velocity \( \vec{v}_i(0) = \vec{v}_i^0 \),</li>
<li>angle \( \vec{\alpha}_i(0)=\vec{0} \),</li>
<li>angular velocity \( \vec{\omega}_i(0) = \vec{\omega}_i^0 \).</li>
</ul>
</li>
<li>variables for each collision between particles \(\mbox{P}_i\) and \(\mbox{P}_j\):<ul>
<li>relative position \( \vec{r}_{ij} = \vec{r}_i - \vec{r}_j \),</li>
<li>normal direction \( \vec{n}_{ij} = \frac{\vec{r}_{ij}}{\|\vec{r}_{ij}\|}\),</li>
<li>overlap \( \delta_{ij} = (\vec{a}_i - \vec{a}_j) - \vec{r}_{ij}\),</li>
<li>relative velocity \( \vec{v}_{ij}=\vec{v}_i-\vec{v}_j + (a_i-\frac{\delta_{ij}}{2}) \vec{n}_{ij} \times \vec{\omega}_i + (a_j-\frac{\delta_{ij}}{2}) \vec{n}_{ij} \times \vec{\omega}_j \)</li>
<li>relative normal velocity \( v_{ij}^n = - \vec{v}_{ij} \cdot \vec{n}_{ij}$ ($= \dot{\delta}_{ij} \)),</li>
<li>normal force (spring-dashpot model) \( f_{ij}^n = k \delta_{ij} + \gamma v_{ij}^n \),</li>
<li>relative tangential velocity \( \vec{v}_{ij}^t = \vec{v}_{ij} - v_{ij}^n \vec{n}_{ij} \),</li>
<li>tangential direction \( \vec{t}_{ij} = \frac{\vec{v}_{ij}^t}{\|\vec{v}_{ij}^t\|}\),</li>
<li>tangential force (sliding friction model) \( f_{ij}^t = - \max( \gamma^t v_{ij}^t,\ \mu f_{ij}^n)\),</li>
<li>collision force \( \vec{f}_{ij} = f_{ij}^n \vec{n}_{ij} + f_{ij}^t \vec{t}_{ij},\ \mbox{if } \delta_{ij}\leq 0,\ 0\ \mbox{else} \),</li>
</ul>
</li>
<li>Variables for collisions between particle \( \mbox{P}_i \) and wall \( \mbox{w}_j \):<ul>
<li>normal direction \( \vec{n}_{ij}^{wall} = - \vec{n}_{\mbox{w}_j}\),</li>
<li>overlap \( \delta_{ij}^{wall} = \vec{a}_i - (p_{\mbox{w}_j} - n_{\mbox{w}_j} \cdot x)\),</li>
<li>relative velocity \( \vec{v}_{ij}^{wall}=\vec{v}_i + (a_i-\frac{\delta_{ij}}{2}) \vec{n}_{ij} \times \vec{\omega}_i \),</li>
<li>all else is the same as for particle collisions</li>
</ul>
</li>
<li>Force and torque calculations <p class="formulaDsp">
\[ \vec{f}_i = m_i \vec{g} + \sum_{j=1}^N \vec{f}_{ij} + \sum_{j=1}^{N_{wall}} \vec{f}_{ij}^{wall}, \]
</p>
 <p class="formulaDsp">
\[ \vec{t}_i = \sum_{j=1}^N (a_i-\frac{\delta_{ij}}{2}) \vec{n}_{ij} \times \vec{f}_{ij} + \sum_{j=1}^{N_{wall}} (a_i-\frac{\delta_{ij}^{wall}}{2}) \vec{n}_{ij}^{wall} \times \vec{f}_{ij}^{wall}. \]
</p>
</li>
<li>Time integration <p class="formulaDsp">
\[ \vec{\dot{r}}_i = \vec{v}_i,\ m_i \vec{\dot{v}}_i = \vec{f}_i,\quad \vec{\dot{\alpha}}_i = \vec{\omega}_i,\ I_i \vec{\dot{\omega}}_i = \vec{t}_i \]
</p>
</li>
</ol>
<h1><a class="anchor" id="Implementation"></a>
Implementation</h1>
<h2><a class="anchor" id="TimeStepping"></a>
Time Stepping</h2>
<p>Verlet integration for \( \vec{r}_i \), forward Euler for \( \vec{\alpha}_i \), \( \vec{\omega}_i \), fixed time step \( dt \). </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dd/d62/UnclassifiedPages.html">Unclassified pages</a></li><li class="navelem"><a class="el" href="../../d8/d51/GettingStarted.html">Getting started</a></li>
    <li class="footer">Generated on Wed Aug 27 2025 17:05:12 for MercuryDPM by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
