<!-- HTML header for doxygen 1.8.18-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MercuryDPM: fsi_jacobian_approximation.cc File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../MDPM.css" rel="stylesheet" type="text/css"/>
<link href="../../codeLabels.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-fork-corner.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-dropdown-version.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../MDPM-fragment-copy-button.js"></script>
<script type="text/javascript">
DoxygenAwesomeFragmentCopyButton.init()
</script>
<script type="text/javascript" src="../../MDPM-paragraph-link.js"></script>
<script type="text/javascript">
DoxygenAwesomeParagraphLink.init()
</script>
<script type="text/javascript" src="../../MDPM-interactive-toc.js"></script>
<script type="text/javascript">
DoxygenAwesomeInteractiveToc.init()
</script>
<script type="text/javascript" src="../../MDPM-darkmode-toggle.js"></script>
<script type="text/javascript">
DoxygenAwesomeDarkModeToggle.init()
</script>
</head>
<body>
  <div id="bitbucket-corner">
   <a href="https://bitbucket.org/mercurydpm/mercurydpm/src/master/" target="_blank" id="fork-corner" class="fork-corner fc-pos-tr fc-animate fc-theme-bitbucket"></a>
  </div>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../mercury-logo-chosen-light-slogan.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"> <!--MercuryDPM--!>
   <!-- BEGIN version select -->
   <div class="dropdown" id="projectnumber">
    <button class="dropbtn">v1.0</button>
    <div class="dropdown-content">
    </div>
   </div>
   <script type="text/javascript" src="../../MDPM-dropdown-version.js"></script>
<!-- END version select -->
   <!--&#160;<span id="projectnumber">revision: v1.0</span>-->
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<script type="text/javascript" src="../../MDPM-fork-corner.js"></script>
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('df/d15/fsi__jacobian__approximation_8cc.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#namespaces">Namespaces</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">fsi_jacobian_approximation.cc File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;iostream&gt;</code><br />
<code>#include &lt;cstring&gt;</code><br />
<code>#include &quot;<a class="el" href="../../d2/d88/generic_8h_source.html">generic.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/d89/navier__stokes_8h_source.html">navier_stokes.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d1/db6/beam_8h_source.html">beam.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../da/deb/one__d__lagrangian__mesh_8h_source.html">meshes/one_d_lagrangian_mesh.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../db/d19/collapsible__channel__mesh_8h_source.html">meshes/collapsible_channel_mesh.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dac/classUndeformedWall.html">UndeformedWall</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/classFSICollapsibleChannelProblem.html">FSICollapsibleChannelProblem&lt; ELEMENT &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Problem class.  <a href="../../dd/da6/classFSICollapsibleChannelProblem.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:db/d34/namespaceBL__Squash"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d34/namespaceBL__Squash.html">BL_Squash</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d9/d35/namespaceControl__Flags"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d35/namespaceControl__Flags.html">Control_Flags</a></td></tr>
<tr class="memdesc:d9/d35/namespaceControl__Flags"><td class="mdescLeft">&#160;</td><td class="mdescRight">Namespace for phyical parameters. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:de/dbd/namespaceGlobal__Physical__Variables"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dbd/namespaceGlobal__Physical__Variables.html">Global_Physical_Variables</a></td></tr>
<tr class="memdesc:de/dbd/namespaceGlobal__Physical__Variables"><td class="mdescLeft">&#160;</td><td class="mdescRight">Global variables. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0fdaf7661591150041b7102dbe578cdc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d34/namespaceBL__Squash.html#a0fdaf7661591150041b7102dbe578cdc">BL_Squash::squash_fct</a> (const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;<a class="el" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>)</td></tr>
<tr class="separator:a0fdaf7661591150041b7102dbe578cdc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80149b39ce76ea0a779f7493905eb1b8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dbd/namespaceGlobal__Physical__Variables.html#a80149b39ce76ea0a779f7493905eb1b8">Global_Physical_Variables::external_pressure</a> ()</td></tr>
<tr class="memdesc:a80149b39ce76ea0a779f7493905eb1b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access function to value of external pressure.  <a href="../../de/dbd/namespaceGlobal__Physical__Variables.html#a80149b39ce76ea0a779f7493905eb1b8">More...</a><br /></td></tr>
<tr class="separator:a80149b39ce76ea0a779f7493905eb1b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0de42ee6d39e85c77c16a04c3a05f7a2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dbd/namespaceGlobal__Physical__Variables.html#a0de42ee6d39e85c77c16a04c3a05f7a2">Global_Physical_Variables::prescribed_traction</a> (const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;t, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a61b7da262276970831d88a2f37dbe509">x</a>, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../d5/d24/level2__real__impl_8h.html#a1224f27e9a621d957f8124bcade25bed">n</a>, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;traction)</td></tr>
<tr class="memdesc:a0de42ee6d39e85c77c16a04c3a05f7a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Traction applied on the fluid at the left (inflow) boundary.  <a href="../../de/dbd/namespaceGlobal__Physical__Variables.html#a0de42ee6d39e85c77c16a04c3a05f7a2">More...</a><br /></td></tr>
<tr class="separator:a0de42ee6d39e85c77c16a04c3a05f7a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a321267e1efb30b5d586302509354fb07"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dbd/namespaceGlobal__Physical__Variables.html#a321267e1efb30b5d586302509354fb07">Global_Physical_Variables::load</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;xi, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a61b7da262276970831d88a2f37dbe509">x</a>, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;load)</td></tr>
<tr class="memdesc:a321267e1efb30b5d586302509354fb07"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load function: Apply a constant external pressure to the beam.  <a href="../../de/dbd/namespaceGlobal__Physical__Variables.html#a321267e1efb30b5d586302509354fb07">More...</a><br /></td></tr>
<tr class="separator:a321267e1efb30b5d586302509354fb07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ddf1224851353fc92bfbff6f499fa97"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d15/fsi__jacobian__approximation_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main</a> (<a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> argc, <a class="el" href="../../da/d7d/classchar.html">char</a> *argv[])</td></tr>
<tr class="separator:a0ddf1224851353fc92bfbff6f499fa97"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:aa50674407164105ae6fa09e71f96fef0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d35/namespaceControl__Flags.html#aa50674407164105ae6fa09e71f96fef0">Control_Flags::Validation_run</a> =false</td></tr>
<tr class="memdesc:aa50674407164105ae6fa09e71f96fef0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Normal run or validation run?  <a href="../../d9/d35/namespaceControl__Flags.html#aa50674407164105ae6fa09e71f96fef0">More...</a><br /></td></tr>
<tr class="separator:aa50674407164105ae6fa09e71f96fef0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8fd24a130fa228566cf42cbcaf479725"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d35/namespaceControl__Flags.html#a8fd24a130fa228566cf42cbcaf479725">Control_Flags::Steady_run</a> =false</td></tr>
<tr class="memdesc:a8fd24a130fa228566cf42cbcaf479725"><td class="mdescLeft">&#160;</td><td class="mdescRight">Steady run or unsteady run?  <a href="../../d9/d35/namespaceControl__Flags.html#a8fd24a130fa228566cf42cbcaf479725">More...</a><br /></td></tr>
<tr class="separator:a8fd24a130fa228566cf42cbcaf479725"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a0ddf1224851353fc92bfbff6f499fa97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ddf1224851353fc92bfbff6f499fa97">&#9670;&nbsp;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> main </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> argc&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d7d/classchar.html">char</a> *&#160;</td>
          <td class="paramname"><em>argv</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Driver code for a collapsible channel problem with FSI.</p>
<p>Run with the -help flag for more information on command line arguments to run with an approximation to the Jacobian, to run steady calculations and to perform validation runs with coarse resolution and small number of timesteps.</p>
<p>Disclaimer: this code is intended to demonstrate how to ask for various approximations to be made to the Jacobian matrix which can result in reduced calculations per Newton step (and to test this).However these approximations to the Jacobian may increase the overall number of Newton steps, or even cause the Newton solve to diverge. Therefore for any particular FSI problem some experiementation is required to determine whether approximating the Jacobian is beneficial. Note: In tests using this code, approximating the Jacobain increased the overall time per Newton solve, however for a 3D equivalent to this problem significant speed ups were found. </p>
<div class="fragment"><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;{</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160; </div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160; <span class="comment">// Store command line arguments</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160; <a class="code" href="../../d5/d85/namespaceFlag__definition.html#a61a03bffd4a34950ef9892be53c49f89">CommandLineArgs::setup</a>(argc,argv);</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160; </div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160; <span class="comment">// Parse command line</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160; <span class="keywordtype">int</span> arg_index = 0;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160; <span class="keywordtype">bool</span> print_help = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160; <span class="keywordtype">bool</span> approx_jacobian = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160; </div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160; <span class="keywordflow">while</span> (arg_index &lt; argc)</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;  {</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;   <span class="keywordflow">if</span> ( strcmp(argv[arg_index], <span class="stringliteral">&quot;-validation_run&quot;</span>) == 0 )</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    {</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;     arg_index++;</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;     <a class="code" href="../../d9/d35/namespaceControl__Flags.html#aa50674407164105ae6fa09e71f96fef0">Control_Flags::Validation_run</a>=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    }</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( strcmp(argv[arg_index], <span class="stringliteral">&quot;-steady_run&quot;</span>) == 0 )</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    {</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;     arg_index++;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;     <a class="code" href="../../d9/d35/namespaceControl__Flags.html#a8fd24a130fa228566cf42cbcaf479725">Control_Flags::Steady_run</a>=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    }</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( strcmp(argv[arg_index], <span class="stringliteral">&quot;-approx_jacobian&quot;</span>) == 0 )</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    {</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;     arg_index++;</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;     approx_jacobian=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    }</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( strcmp(argv[arg_index], <span class="stringliteral">&quot;-help&quot;</span>) == 0 )</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    {</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;     print_help = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;     <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    }</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    {</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;     arg_index++;</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    }</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;  }</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160; </div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160; <span class="keywordflow">if</span> (print_help)</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;  {</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;   <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;\n\nOption flags:\n\n&quot;</span>;</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;   <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;-validation run   Perform validation run with coarse mesh\n&quot;</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;                  and fewer Newton solves\n\n&quot;</span>;</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;   <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;-steady_run       Solve series of steady problems with\n&quot;</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;                  different wall positions, otherwise\n&quot;</span></div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;                  solve unsteady problem\n\n&quot;</span>;</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;   <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;-approx_jacobian  Use Jacobian approximation\n\n&quot;</span>;</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;   <span class="keywordflow">return</span> (0);</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;  }</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160; </div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160; <span class="comment">// Set flags controlling approximations to the Jacobian</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160; <span class="keywordtype">bool</span> wall_jacobian_ignores_fluid_shear_stress_data = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160; <span class="keywordtype">bool</span> wall_jacobian_ignores_geometric_data = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160; <span class="keywordtype">bool</span> fluid_jacobian_ignores_geometric_data = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160; <span class="keywordflow">if</span> (approx_jacobian)</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;  {</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;   wall_jacobian_ignores_fluid_shear_stress_data = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;   wall_jacobian_ignores_geometric_data = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;   </div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d9/d35/namespaceControl__Flags.html#a8fd24a130fa228566cf42cbcaf479725">Control_Flags::Steady_run</a>)</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    {</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;     <span class="comment">// This can speed up the calculation of the Jacobian but causes the</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;     <span class="comment">// Newton method to fail for unsteady problems</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;     fluid_jacobian_ignores_geometric_data = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    }</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;  }</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160; </div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160; <span class="comment">// Reduction in resolution for validation run?</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160; <span class="keywordtype">unsigned</span> coarsening_factor=1;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160; <span class="keywordflow">if</span> (<a class="code" href="../../d9/d35/namespaceControl__Flags.html#aa50674407164105ae6fa09e71f96fef0">Control_Flags::Validation_run</a>)</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;  {</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;   coarsening_factor=4;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;  }</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160; </div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160; <span class="comment">// Number of elements in the domain</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160; <span class="keywordtype">unsigned</span> nup=20/coarsening_factor;</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160; <span class="keywordtype">unsigned</span> ncollapsible=40/coarsening_factor;</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160; <span class="keywordtype">unsigned</span> ndown=40/coarsening_factor;</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160; <span class="keywordtype">unsigned</span> <a class="code" href="../../da/d25/namespaceMesh__Parameters.html#afe97d64daaa8aad85626619c2571c291">ny</a>=16/coarsening_factor;</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160; </div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160; <span class="comment">// Length of the domain</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160; <span class="keywordtype">double</span> lup=5.0;</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160; <span class="keywordtype">double</span> lcollapsible=10.0;</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160; <span class="keywordtype">double</span> ldown=10.0;</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160; <span class="keywordtype">double</span> <a class="code" href="../../da/d25/namespaceMesh__Parameters.html#a3d4f51824035f80cab2b7d13f338ce6a">ly</a>=1.0;</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160; </div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160; <span class="comment">// Build the problem with QTaylorHoodElements</span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160; <a class="code" href="../../dd/da6/classFSICollapsibleChannelProblem.html">FSICollapsibleChannelProblem&lt;AlgebraicElement&lt;QTaylorHoodElement&lt;2&gt;</a> &gt; &gt; </div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;  <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>(nup,</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;          ncollapsible,</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;          ndown,</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;          <a class="code" href="../../da/d25/namespaceMesh__Parameters.html#afe97d64daaa8aad85626619c2571c291">ny</a>, </div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;          lup,</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;          lcollapsible,</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;          ldown,</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;          <a class="code" href="../../da/d25/namespaceMesh__Parameters.html#a3d4f51824035f80cab2b7d13f338ce6a">ly</a>,</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;          wall_jacobian_ignores_fluid_shear_stress_data,</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;          wall_jacobian_ignores_geometric_data,</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;          fluid_jacobian_ignores_geometric_data);</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160; </div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160; <span class="comment">// Set external pressure (on the wall stiffness scale). </span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160; <a class="code" href="../../de/dbd/namespaceGlobal__Physical__Variables.html#a80149b39ce76ea0a779f7493905eb1b8">Global_Physical_Variables::external_pressure</a>() = 1.0e-1;</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160; </div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160; <span class="comment">// Pressure on the left boundary: This is consistent with steady</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160; <span class="comment">// Poiseuille flow</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160; <a class="code" href="../../de/dbd/namespaceGlobal__Physical__Variables.html#ae1a493695b7f4619af32f405b0b28861">Global_Physical_Variables::P_up</a>=12.0*(lup+lcollapsible+ldown);</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160; </div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160; <span class="comment">// Set initial wall displacement</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160; <a class="code" href="../../de/dbd/namespaceGlobal__Physical__Variables.html#aa2f7ea98cb8462b3920a026bed5f6099">Global_Physical_Variables::Prescribed_y</a> = 1.0;</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160; </div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160; <span class="comment">// Set Re and ReSt - it appears small values are required in this 2D problem, </span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160; <span class="comment">// with the Jacobian approximations otherwise the Newton method converges, this</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160; <span class="comment">// is not the experience found with the 3D equivalent problem.</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160; <a class="code" href="../../de/dbd/namespaceGlobal__Physical__Variables.html#ab814e627d2eb5bc50318879d19ab16b9">Global_Physical_Variables::Re</a>=1;</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160; <a class="code" href="../../de/dbd/namespaceGlobal__Physical__Variables.html#a085ee4bf968ffdd01a41b8c41864f907">Global_Physical_Variables::ReSt</a>=<a class="code" href="../../de/dbd/namespaceGlobal__Physical__Variables.html#ab814e627d2eb5bc50318879d19ab16b9">Global_Physical_Variables::Re</a>;</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160; </div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160; <span class="comment">// Timestep. Note: Preliminary runs indicate that the period of</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160; <span class="comment">// the oscillation is about 1 so this gives us 40 steps per period.</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160; <span class="keywordtype">double</span> dt=1.0/40.0; </div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160; </div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160; <span class="comment">// Initial time for the simulation</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160; <span class="keywordtype">double</span> t_min=0.0;</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160; </div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160; <span class="comment">// Maximum time for simulation</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160; <span class="keywordtype">double</span> t_max=3.5; </div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160; </div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160; <span class="comment">// Initialise timestep </span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160; <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.time_pt()-&gt;time()=t_min;</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160; <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.initialise_dt(dt);</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160; </div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160; <span class="comment">// Apply initial condition</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160; <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.set_initial_condition();</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160; </div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160; <span class="comment">//Set output directory</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160; <a class="code" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> doc_info;</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160; <span class="keywordflow">if</span> (<a class="code" href="../../d9/d35/namespaceControl__Flags.html#aa50674407164105ae6fa09e71f96fef0">Control_Flags::Validation_run</a>)</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;  {</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;   <span class="keywordflow">if</span> (approx_jacobian)</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    {</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;     <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Using approximate Jacobian\n&quot;</span>;</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;     <span class="keywordflow">if</span> (<a class="code" href="../../d9/d35/namespaceControl__Flags.html#a8fd24a130fa228566cf42cbcaf479725">Control_Flags::Steady_run</a>)</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;      doc_info.<a class="code" href="../../d7/d2c/classoomph_1_1DocInfo.html#a9800cf1d178162d521588e6e336a6e65">set_directory</a>(<span class="stringliteral">&quot;RESLT_APPROX_STEADY&quot;</span>);</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;     <span class="keywordflow">else</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;      doc_info.<a class="code" href="../../d7/d2c/classoomph_1_1DocInfo.html#a9800cf1d178162d521588e6e336a6e65">set_directory</a>(<span class="stringliteral">&quot;RESLT_APPROX_UNSTEADY&quot;</span>);</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    }</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    {</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;     <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Using exact Jacobian\n&quot;</span>;</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;     <span class="keywordflow">if</span> (<a class="code" href="../../d9/d35/namespaceControl__Flags.html#a8fd24a130fa228566cf42cbcaf479725">Control_Flags::Steady_run</a>)</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;      doc_info.<a class="code" href="../../d7/d2c/classoomph_1_1DocInfo.html#a9800cf1d178162d521588e6e336a6e65">set_directory</a>(<span class="stringliteral">&quot;RESLT_EXACT_STEADY&quot;</span>);</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;     <span class="keywordflow">else</span></div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;      doc_info.<a class="code" href="../../d7/d2c/classoomph_1_1DocInfo.html#a9800cf1d178162d521588e6e336a6e65">set_directory</a>(<span class="stringliteral">&quot;RESLT_EXACT_UNSTEADY&quot;</span>);</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    }</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;  }</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160; <span class="keywordflow">else</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;  {</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;   doc_info.<a class="code" href="../../d7/d2c/classoomph_1_1DocInfo.html#a9800cf1d178162d521588e6e336a6e65">set_directory</a>(<span class="stringliteral">&quot;RESLT&quot;</span>);</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;  }</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160; </div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160; <span class="comment">// Open a trace file </span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160; ofstream trace_file;</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160; <span class="keywordtype">char</span> <a class="code" href="../../d5/db2/namespaceMergeRestartFiles.html#a210231ed06d822ca8be83bd7f75aa572">filename</a>[100];   </div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160; sprintf(<a class="code" href="../../d5/db2/namespaceMergeRestartFiles.html#a210231ed06d822ca8be83bd7f75aa572">filename</a>,<span class="stringliteral">&quot;%s/trace.dat&quot;</span>,doc_info.<a class="code" href="../../d7/d2c/classoomph_1_1DocInfo.html#a85d58bcfce0a7b7cae461624e6fcd08a">directory</a>().c_str());</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160; trace_file.open(<a class="code" href="../../d5/db2/namespaceMergeRestartFiles.html#a210231ed06d822ca8be83bd7f75aa572">filename</a>);</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;   </div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160; <span class="comment">// Output the initial solution</span></div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160; <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.doc_solution(doc_info, trace_file);</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160; </div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160; <span class="comment">// Increment step number</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160; doc_info.<a class="code" href="../../d7/d2c/classoomph_1_1DocInfo.html#af27224b25da5b758442753f0947e62d4">number</a>()++;</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160; </div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160; <span class="keywordflow">if</span> (<a class="code" href="../../d9/d35/namespaceControl__Flags.html#a8fd24a130fa228566cf42cbcaf479725">Control_Flags::Steady_run</a>)</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;  {</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;   <span class="comment">// Number of solves (reduced for validation)</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;   <span class="keywordtype">unsigned</span> nstep = 20;</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d9/d35/namespaceControl__Flags.html#aa50674407164105ae6fa09e71f96fef0">Control_Flags::Validation_run</a>)</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    {</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;     nstep=3;</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    }</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160; </div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;   <span class="comment">// Loop over different wall displacement</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> istep=0;istep&lt;nstep;istep++)</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    {</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;     <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;\nSteady Newton solve &quot;</span> &lt;&lt; istep</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; for wall displacement of &quot;</span> </div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;                &lt;&lt; <a class="code" href="../../de/dbd/namespaceGlobal__Physical__Variables.html#aa2f7ea98cb8462b3920a026bed5f6099">Global_Physical_Variables::Prescribed_y</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;====================================================\n&quot;</span>;</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;     </div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;     <span class="comment">// Solve the problem</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;     <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.newton_solve();</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160; </div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;     cout &lt;&lt; <span class="stringliteral">&quot;External pressure=&quot;</span></div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;          &lt;&lt; <a class="code" href="../../de/dbd/namespaceGlobal__Physical__Variables.html#a80149b39ce76ea0a779f7493905eb1b8">Global_Physical_Variables::external_pressure</a>()</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;     </div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;     <span class="comment">// Output the solution</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;     <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.doc_solution(doc_info, trace_file);</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;     </div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;     <span class="comment">// Step number</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;     doc_info.<a class="code" href="../../d7/d2c/classoomph_1_1DocInfo.html#af27224b25da5b758442753f0947e62d4">number</a>()++;</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160; </div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;     <span class="comment">// Change wall position</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;     <a class="code" href="../../de/dbd/namespaceGlobal__Physical__Variables.html#aa2f7ea98cb8462b3920a026bed5f6099">Global_Physical_Variables::Prescribed_y</a> -= 0.01;</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    }</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;  }</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160; <span class="keywordflow">else</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;  {</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;   <span class="comment">// Find number of timesteps (reduced for validation)</span></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;   <span class="keywordtype">unsigned</span> nstep = <a class="code" href="../../d0/d1d/classunsigned.html">unsigned</a>((t_max-t_min)/dt);</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d9/d35/namespaceControl__Flags.html#aa50674407164105ae6fa09e71f96fef0">Control_Flags::Validation_run</a>)</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    {</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;     nstep=10;</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    }</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;   </div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;   <span class="comment">// Timestepping loop</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> istep=0;istep&lt;nstep;istep++)</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;    {</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;     <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;\nNewton solve &quot;</span> &lt;&lt; istep &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;================\n&quot;</span>;</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;     </div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;     <span class="comment">// Solve the problem</span></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;     <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.unsteady_newton_solve(dt);</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;     </div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;     <span class="comment">// Output the solution</span></div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;     <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.doc_solution(doc_info, trace_file);</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;     </div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;     <span class="comment">// Step number</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;     doc_info.<a class="code" href="../../d7/d2c/classoomph_1_1DocInfo.html#af27224b25da5b758442753f0947e62d4">number</a>()++;</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;    }</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;   </div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;  }</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160; </div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160; <span class="comment">// Close trace file.</span></div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160; trace_file.close();</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160; </div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;}<span class="comment">//end of main</span></div>
<div class="ttc" id="aclassFSICollapsibleChannelProblem_html"><div class="ttname"><a href="../../dd/da6/classFSICollapsibleChannelProblem.html">FSICollapsibleChannelProblem</a></div><div class="ttdoc">Problem class.</div><div class="ttdef"><b>Definition:</b> fsi_chan_problem.h:315</div></div>
<div class="ttc" id="aclassoomph_1_1DocInfo_html"><div class="ttname"><a href="../../d7/d2c/classoomph_1_1DocInfo.html">oomph::DocInfo</a></div><div class="ttdef"><b>Definition:</b> oomph_utilities.h:499</div></div>
<div class="ttc" id="aclassoomph_1_1DocInfo_html_a85d58bcfce0a7b7cae461624e6fcd08a"><div class="ttname"><a href="../../d7/d2c/classoomph_1_1DocInfo.html#a85d58bcfce0a7b7cae461624e6fcd08a">oomph::DocInfo::directory</a></div><div class="ttdeci">std::string directory() const</div><div class="ttdoc">Output directory.</div><div class="ttdef"><b>Definition:</b> oomph_utilities.h:524</div></div>
<div class="ttc" id="aclassoomph_1_1DocInfo_html_a9800cf1d178162d521588e6e336a6e65"><div class="ttname"><a href="../../d7/d2c/classoomph_1_1DocInfo.html#a9800cf1d178162d521588e6e336a6e65">oomph::DocInfo::set_directory</a></div><div class="ttdeci">void set_directory(const std::string &amp;directory)</div><div class="ttdef"><b>Definition:</b> oomph_utilities.cc:298</div></div>
<div class="ttc" id="aclassoomph_1_1DocInfo_html_af27224b25da5b758442753f0947e62d4"><div class="ttname"><a href="../../d7/d2c/classoomph_1_1DocInfo.html#af27224b25da5b758442753f0947e62d4">oomph::DocInfo::number</a></div><div class="ttdeci">unsigned &amp; number()</div><div class="ttdoc">Number used (e.g.) for labeling output files.</div><div class="ttdef"><b>Definition:</b> oomph_utilities.h:554</div></div>
<div class="ttc" id="aclassunsigned_html"><div class="ttname"><a href="../../d0/d1d/classunsigned.html">unsigned</a></div></div>
<div class="ttc" id="anamespaceControl__Flags_html_a8fd24a130fa228566cf42cbcaf479725"><div class="ttname"><a href="../../d9/d35/namespaceControl__Flags.html#a8fd24a130fa228566cf42cbcaf479725">Control_Flags::Steady_run</a></div><div class="ttdeci">bool Steady_run</div><div class="ttdoc">Steady run or unsteady run?</div><div class="ttdef"><b>Definition:</b> fsi_jacobian_approximation.cc:181</div></div>
<div class="ttc" id="anamespaceControl__Flags_html_aa50674407164105ae6fa09e71f96fef0"><div class="ttname"><a href="../../d9/d35/namespaceControl__Flags.html#aa50674407164105ae6fa09e71f96fef0">Control_Flags::Validation_run</a></div><div class="ttdeci">bool Validation_run</div><div class="ttdoc">Normal run or validation run?</div><div class="ttdef"><b>Definition:</b> fsi_jacobian_approximation.cc:178</div></div>
<div class="ttc" id="anamespaceFlag__definition_html_a61a03bffd4a34950ef9892be53c49f89"><div class="ttname"><a href="../../d5/d85/namespaceFlag__definition.html#a61a03bffd4a34950ef9892be53c49f89">Flag_definition::setup</a></div><div class="ttdeci">void setup(Time *time_pt)</div><div class="ttdoc">Create all GeomObjects needed to define the cylinder and the flag.</div><div class="ttdef"><b>Definition:</b> turek_flag_non_fsi.cc:277</div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a085ee4bf968ffdd01a41b8c41864f907"><div class="ttname"><a href="../../de/dbd/namespaceGlobal__Physical__Variables.html#a085ee4bf968ffdd01a41b8c41864f907">Global_Physical_Variables::ReSt</a></div><div class="ttdeci">double ReSt</div><div class="ttdoc">Womersley number.</div><div class="ttdef"><b>Definition:</b> rayleigh_instability.cc:56</div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a80149b39ce76ea0a779f7493905eb1b8"><div class="ttname"><a href="../../de/dbd/namespaceGlobal__Physical__Variables.html#a80149b39ce76ea0a779f7493905eb1b8">Global_Physical_Variables::external_pressure</a></div><div class="ttdeci">double &amp; external_pressure()</div><div class="ttdoc">Access function to value of external pressure.</div><div class="ttdef"><b>Definition:</b> steady_ring.cc:79</div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_aa2f7ea98cb8462b3920a026bed5f6099"><div class="ttname"><a href="../../de/dbd/namespaceGlobal__Physical__Variables.html#aa2f7ea98cb8462b3920a026bed5f6099">Global_Physical_Variables::Prescribed_y</a></div><div class="ttdeci">double Prescribed_y</div><div class="ttdoc">Prescribed position of control point.</div><div class="ttdef"><b>Definition:</b> mpi/distribution/clamped_shell/clamped_shell_with_arclength_cont.cc:54</div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_ab814e627d2eb5bc50318879d19ab16b9"><div class="ttname"><a href="../../de/dbd/namespaceGlobal__Physical__Variables.html#ab814e627d2eb5bc50318879d19ab16b9">Global_Physical_Variables::Re</a></div><div class="ttdeci">double Re</div><div class="ttdoc">Reynolds number.</div><div class="ttdef"><b>Definition:</b> fibre.cc:55</div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_ae1a493695b7f4619af32f405b0b28861"><div class="ttname"><a href="../../de/dbd/namespaceGlobal__Physical__Variables.html#ae1a493695b7f4619af32f405b0b28861">Global_Physical_Variables::P_up</a></div><div class="ttdeci">double P_up</div><div class="ttdoc">Default pressure on the left boundary.</div><div class="ttdef"><b>Definition:</b> fsi_collapsible_channel.cc:183</div></div>
<div class="ttc" id="anamespaceMergeRestartFiles_html_a210231ed06d822ca8be83bd7f75aa572"><div class="ttname"><a href="../../d5/db2/namespaceMergeRestartFiles.html#a210231ed06d822ca8be83bd7f75aa572">MergeRestartFiles.filename</a></div><div class="ttdeci">string filename</div><div class="ttdef"><b>Definition:</b> MergeRestartFiles.py:39</div></div>
<div class="ttc" id="anamespaceMesh__Parameters_html_a3d4f51824035f80cab2b7d13f338ce6a"><div class="ttname"><a href="../../da/d25/namespaceMesh__Parameters.html#a3d4f51824035f80cab2b7d13f338ce6a">Mesh_Parameters::ly</a></div><div class="ttdeci">const double ly</div><div class="ttdef"><b>Definition:</b> ConstraintElementsUnitTest.cpp:34</div></div>
<div class="ttc" id="anamespaceMesh__Parameters_html_afe97d64daaa8aad85626619c2571c291"><div class="ttname"><a href="../../da/d25/namespaceMesh__Parameters.html#afe97d64daaa8aad85626619c2571c291">Mesh_Parameters::ny</a></div><div class="ttdeci">const unsigned ny</div><div class="ttdef"><b>Definition:</b> ConstraintElementsUnitTest.cpp:31</div></div>
<div class="ttc" id="anamespaceoomph_html_aec474227917784dc0a255faf289cfc16"><div class="ttname"><a href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a></div><div class="ttdeci">OomphInfo oomph_info</div><div class="ttdef"><b>Definition:</b> oomph_definitions.cc:319</div></div>
<div class="ttc" id="asteady__axisym__advection__diffusion_8cc_html_a569d6908c13cebe207584b3d146c851e"><div class="ttname"><a href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a></div><div class="ttdeci">Constructor for SteadyAxisymAdvectionDiffusion problem</div><div class="ttdef"><b>Definition:</b> steady_axisym_advection_diffusion.cc:213</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html#a85d58bcfce0a7b7cae461624e6fcd08a">oomph::DocInfo::directory()</a>, <a class="el" href="../../de/dbd/namespaceGlobal__Physical__Variables.html#a80149b39ce76ea0a779f7493905eb1b8">Global_Physical_Variables::external_pressure()</a>, <a class="el" href="../../d5/db2/namespaceMergeRestartFiles.html#a210231ed06d822ca8be83bd7f75aa572">MergeRestartFiles::filename</a>, <a class="el" href="../../da/d25/namespaceMesh__Parameters.html#a3d4f51824035f80cab2b7d13f338ce6a">Mesh_Parameters::ly</a>, <a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html#af27224b25da5b758442753f0947e62d4">oomph::DocInfo::number()</a>, <a class="el" href="../../da/d25/namespaceMesh__Parameters.html#afe97d64daaa8aad85626619c2571c291">Mesh_Parameters::ny</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, <a class="el" href="../../de/dbd/namespaceGlobal__Physical__Variables.html#ae1a493695b7f4619af32f405b0b28861">Global_Physical_Variables::P_up</a>, <a class="el" href="../../de/dbd/namespaceGlobal__Physical__Variables.html#aa2f7ea98cb8462b3920a026bed5f6099">Global_Physical_Variables::Prescribed_y</a>, <a class="el" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>, <a class="el" href="../../de/dbd/namespaceGlobal__Physical__Variables.html#ab814e627d2eb5bc50318879d19ab16b9">Global_Physical_Variables::Re</a>, <a class="el" href="../../de/dbd/namespaceGlobal__Physical__Variables.html#a085ee4bf968ffdd01a41b8c41864f907">Global_Physical_Variables::ReSt</a>, <a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html#a9800cf1d178162d521588e6e336a6e65">oomph::DocInfo::set_directory()</a>, <a class="el" href="../../d5/d85/namespaceFlag__definition.html#a61a03bffd4a34950ef9892be53c49f89">Flag_definition::setup()</a>, <a class="el" href="../../d9/d35/namespaceControl__Flags.html#a8fd24a130fa228566cf42cbcaf479725">Control_Flags::Steady_run</a>, and <a class="el" href="../../d9/d35/namespaceControl__Flags.html#aa50674407164105ae6fa09e71f96fef0">Control_Flags::Validation_run</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_db96c86f197b8d1676194323b32ee460.html">oomph-lib</a></li><li class="navelem"><a class="el" href="../../dir_4c01f1a1e789d237850e453b1abc6e16.html">demo_drivers</a></li><li class="navelem"><a class="el" href="../../dir_5813594e1234234c99f1be4d387c076d.html">optimisation</a></li><li class="navelem"><a class="el" href="../../dir_deb7ae3fa34305cfda4f5166cc1a95b0.html">fsi_jacobian_approximation</a></li><li class="navelem"><a class="el" href="../../df/d15/fsi__jacobian__approximation_8cc.html">fsi_jacobian_approximation.cc</a></li>
    <li class="footer">Generated on Wed Aug 27 2025 17:04:58 for MercuryDPM by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
