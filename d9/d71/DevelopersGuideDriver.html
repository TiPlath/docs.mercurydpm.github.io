<!-- HTML header for doxygen 1.8.18-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MercuryDPM: Developing an application/driver code</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../MDPM.css" rel="stylesheet" type="text/css"/>
<link href="../../codeLabels.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-fork-corner.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-dropdown-version.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../MDPM-fragment-copy-button.js"></script>
<script type="text/javascript">
DoxygenAwesomeFragmentCopyButton.init()
</script>
<script type="text/javascript" src="../../MDPM-paragraph-link.js"></script>
<script type="text/javascript">
DoxygenAwesomeParagraphLink.init()
</script>
<script type="text/javascript" src="../../MDPM-interactive-toc.js"></script>
<script type="text/javascript">
DoxygenAwesomeInteractiveToc.init()
</script>
<script type="text/javascript" src="../../MDPM-darkmode-toggle.js"></script>
<script type="text/javascript">
DoxygenAwesomeDarkModeToggle.init()
</script>
</head>
<body>
  <div id="bitbucket-corner">
   <a href="https://bitbucket.org/mercurydpm/mercurydpm/src/master/" target="_blank" id="fork-corner" class="fork-corner fc-pos-tr fc-animate fc-theme-bitbucket"></a>
  </div>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../mercury-logo-chosen-light-slogan.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"> <!--MercuryDPM--!>
   <!-- BEGIN version select -->
   <div class="dropdown" id="projectnumber">
    <button class="dropbtn">v1.0</button>
    <div class="dropdown-content">
    </div>
   </div>
   <script type="text/javascript" src="../../MDPM-dropdown-version.js"></script>
<!-- END version select -->
   <!--&#160;<span id="projectnumber">revision: v1.0</span>-->
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<script type="text/javascript" src="../../MDPM-fork-corner.js"></script>
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d9/d71/DevelopersGuideDriver.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Developing an application/driver code </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>A driver file usually contains a class derived from Mercury3D in which the concrete parameters of the application are defined, such as species, particles, walls, boundaries, time step, ..., and a main function where the class is declared and the time integration routine (solve) is called. Thus, the basic setup looks like this: </p><pre class="fragment">\code{.cpp}    
#include &lt;Mercury3D.h&gt;

class Example : public Mercury3D    
{ 
public:
  void setupInitialConditions() override
  { 
    // define your particles, walls, boundaries here
  }
};

int main(int argc, char *argv[])
{
  Example problem;
  // define global variables, species here
  problem.solve(argc, argv);
  return 0;
}
\endcode
</pre><p> This file defines a class named <code>Example</code>, that is derived from <code>Mercury3D</code>. It overrides the function setupInitialConditions (which is empty by default) with a function where the simulation objects (particles, walls, boundaries, species) are defined.</p>
<p>Then the main function is defined (which is the function that is executed when you run the executable): First, the <em>Example</em> class is instantiated (a concrete instance of the class is created and stored in memory). Then, the global variables are set, such as name, gravity, spatial/temporal domain. Finally, the time integration routine (solve) is called.</p>
<h3><a class="anchor" id="autotoc_md14"></a>
Global variables</h3>
<p>The following global variables should be set: </p><div class="fragment"><div class="line"><a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.setName(<span class="stringliteral">&quot;Example&quot;</span>);</div>
<div class="line"><a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.setXMin(0.0);</div>
<div class="line"><a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.setYMin(0.0);</div>
<div class="line"><a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.setZMin(0.0);</div>
<div class="line"><a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.setXMax(1.0);</div>
<div class="line"><a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.setYMax(1.0);</div>
<div class="line"><a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.setZMax(1.0);</div>
<div class="line"><a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.setTimeMax(2.0);</div>
<div class="line"><a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.setTimeStep(1<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>-4);</div>
<div class="ttc" id="aCwise__array__power__array_8cpp_html_a9eb5e92d9d691c1393e5e7c914731dbf"><div class="ttname"><a href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a></div><div class="ttdeci">Array&lt; double, 1, 3 &gt; e(1./3., 0.5, 2.)</div></div>
<div class="ttc" id="asteady__axisym__advection__diffusion_8cc_html_a569d6908c13cebe207584b3d146c851e"><div class="ttname"><a href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a></div><div class="ttdeci">Constructor for SteadyAxisymAdvectionDiffusion problem</div><div class="ttdef"><b>Definition:</b> steady_axisym_advection_diffusion.cc:213</div></div>
</div><!-- fragment --><p> The first command sets the name variable to Example, so the output files will be named <code>Example.data</code>, <code>Example.restart</code>, ... The next six commands set the dimensions of the system that are used in displaying the output. Finally, the final time and the time step are set.</p>
<p>There are additional global parameters that can be set here, such as</p><ul>
<li>gravity, e.g. in z-direction <div class="fragment"><div class="line"><a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.setGravity(<a class="code" href="../../d5/dc1/classVec3D.html">Vec3D</a>(0.0, 0.0, -9.8)); <span class="comment">//sets gravity</span></div>
<div class="ttc" id="aclassVec3D_html"><div class="ttname"><a href="../../d5/dc1/classVec3D.html">Vec3D</a></div><div class="ttdef"><b>Definition:</b> Kernel/Math/Vector.h:30</div></div>
</div><!-- fragment --></li>
<li>the amount of time steps between each write command <div class="fragment"><div class="line"><a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.setSaveCount(50); <span class="comment">//writes every 50th time step</span></div>
</div><!-- fragment --></li>
<li>additional output parameters for the xBalls viewer <div class="fragment"><div class="line"><a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.setXBallsAdditionalArguments(<span class="stringliteral">&quot;-v0&quot;</span>); <span class="comment">//displays velocity vectors in xBalls</span></div>
</div><!-- fragment --></li>
<li>...</li>
</ul>
<h3><a class="anchor" id="autotoc_md15"></a>
Species</h3>
<p>A species can be defined as follows:</p>
<div class="fragment"><div class="line"><span class="comment">//include above all other code:</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../da/d68/LinearViscoelasticSpecies_8h.html">Species/LinearViscoelasticSpecies.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">//include in main, before solve:</span></div>
<div class="line"><a class="code" href="../../d9/d0c/classSpecies.html">LinearViscoelasticSpecies</a> species; <span class="comment">// defines linear-viscoelastic contact law</span></div>
<div class="line">species.<a class="code" href="../../dc/d02/classParticleSpecies.html#a274df9fa08ef5580e54f8e9301f1b348">setDensity</a>(2500.0);        <span class="comment">// sets the particle density</span></div>
<div class="line">species.<a class="code" href="../../dd/de0/classLinearViscoelasticNormalSpecies.html#ad179cd0c4c13e4d54ae243956ce5a07d">setStiffness</a>(200.0);       <span class="comment">// sets the linear contact stiffness</span></div>
<div class="line">species.<a class="code" href="../../dd/de0/classLinearViscoelasticNormalSpecies.html#a73d0ff3e1ac4c6cb75dae0b623d7a13b">setDissipation</a>(0.0);       <span class="comment">// sets the dissipation</span></div>
<div class="line"><a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.speciesHandler.copyAndAddObject(species);</div>
<div class="ttc" id="aLinearViscoelasticSpecies_8h_html"><div class="ttname"><a href="../../da/d68/LinearViscoelasticSpecies_8h.html">LinearViscoelasticSpecies.h</a></div></div>
<div class="ttc" id="aclassLinearViscoelasticNormalSpecies_html_a73d0ff3e1ac4c6cb75dae0b623d7a13b"><div class="ttname"><a href="../../dd/de0/classLinearViscoelasticNormalSpecies.html#a73d0ff3e1ac4c6cb75dae0b623d7a13b">LinearViscoelasticNormalSpecies::setDissipation</a></div><div class="ttdeci">void setDissipation(Mdouble dissipation)</div><div class="ttdoc">Allows the normal dissipation to be changed.</div><div class="ttdef"><b>Definition:</b> LinearViscoelasticNormalSpecies.cc:96</div></div>
<div class="ttc" id="aclassLinearViscoelasticNormalSpecies_html_ad179cd0c4c13e4d54ae243956ce5a07d"><div class="ttname"><a href="../../dd/de0/classLinearViscoelasticNormalSpecies.html#ad179cd0c4c13e4d54ae243956ce5a07d">LinearViscoelasticNormalSpecies::setStiffness</a></div><div class="ttdeci">void setStiffness(Mdouble new_k)</div><div class="ttdoc">Allows the spring constant to be changed.</div><div class="ttdef"><b>Definition:</b> LinearViscoelasticNormalSpecies.cc:72</div></div>
<div class="ttc" id="aclassParticleSpecies_html_a274df9fa08ef5580e54f8e9301f1b348"><div class="ttname"><a href="../../dc/d02/classParticleSpecies.html#a274df9fa08ef5580e54f8e9301f1b348">ParticleSpecies::setDensity</a></div><div class="ttdeci">void setDensity(Mdouble density)</div><div class="ttdef"><b>Definition:</b> ParticleSpecies.cc:88</div></div>
<div class="ttc" id="aclassSpecies_html"><div class="ttname"><a href="../../d9/d0c/classSpecies.html">Species&lt; LinearViscoelasticNormalSpecies &gt;</a></div></div>
</div><!-- fragment --><p>Other contact laws are possible; see the documentation of Species for more details.</p>
<h3><a class="anchor" id="autotoc_md16"></a>
Particles</h3>
<p>A particle can be defined as follows:</p>
<div class="fragment"><div class="line"><span class="comment">//include above all other code:</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../d2/dae/BaseParticle_8h.html">Particles/BaseParticle.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">//include in setupInitialConditions:</span></div>
<div class="line"><a class="code" href="../../db/d52/classBaseParticle.html">BaseParticle</a> <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>;                       <span class="comment">// defines a new particle</span></div>
<div class="line"><a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>.setSpecies(speciesHandler.getObject(0)); <span class="comment">// sets particle species</span></div>
<div class="line"><a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>.setRadius(0.5);                     <span class="comment">// sets particle radius</span></div>
<div class="line"><a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>.setPosition(<a class="code" href="../../d5/dc1/classVec3D.html">Vec3D</a>(0.0,0.0,0.0));    <span class="comment">// sets particle position</span></div>
<div class="line"><a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>.setVelocity(<a class="code" href="../../d5/dc1/classVec3D.html">Vec3D</a>(1.0,0.0,0.0));    <span class="comment">// sets particle velocity</span></div>
<div class="line">particleHandler.copyAndAddObject(<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>);  <span class="comment">// copies particle into the handler </span></div>
<div class="ttc" id="aBaseParticle_8h_html"><div class="ttname"><a href="../../d2/dae/BaseParticle_8h.html">BaseParticle.h</a></div></div>
<div class="ttc" id="aTutorial__Map__using_8cpp_html_a7fe964f6b1afd4591f637999272ab9a2"><div class="ttname"><a href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a></div><div class="ttdeci">float * p</div><div class="ttdef"><b>Definition:</b> Tutorial_Map_using.cpp:9</div></div>
<div class="ttc" id="aclassBaseParticle_html"><div class="ttname"><a href="../../db/d52/classBaseParticle.html">BaseParticle</a></div><div class="ttdef"><b>Definition:</b> BaseParticle.h:33</div></div>
</div><!-- fragment --><p>See the documentation of BaseParticle for more details.</p>
<h3><a class="anchor" id="autotoc_md17"></a>
Walls</h3>
<p>A planar bottom wall at the bottom of the domain can be defined as follows:</p>
<div class="fragment"><div class="line"><span class="comment">//include above all other code:</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../db/d14/InfiniteWall_8h.html">Walls/InfiniteWall.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">//include in setupInitialConditions:</span></div>
<div class="line"><a class="code" href="../../d7/d91/classInfiniteWall.html">InfiniteWall</a> <a class="code" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a>;                            <span class="comment">// defines a new planar wall</span></div>
<div class="line"><a class="code" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a>.setSpecies(speciesHandler.getObject(0)); <span class="comment">// sets wall species</span></div>
<div class="line"><a class="code" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a>.set(<a class="code" href="../../d5/dc1/classVec3D.html">Vec3D</a>(0,0,-1),<a class="code" href="../../d5/dc1/classVec3D.html">Vec3D</a>(0,0,getZMin())); <span class="comment">// defines normal into the wall and point on the wall</span></div>
<div class="line">wallHandler.copyAndAddObject(<a class="code" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a>);           <span class="comment">// copies wall into the handler </span></div>
<div class="ttc" id="aInfiniteWall_8h_html"><div class="ttname"><a href="../../db/d14/InfiniteWall_8h.html">InfiniteWall.h</a></div></div>
<div class="ttc" id="aMatrix__resize__int_8cpp_html_aab236ce080522c9832217fd5f157541b"><div class="ttname"><a href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a></div><div class="ttdeci">RowVector3d w</div><div class="ttdef"><b>Definition:</b> Matrix_resize_int.cpp:3</div></div>
<div class="ttc" id="aclassInfiniteWall_html"><div class="ttname"><a href="../../d7/d91/classInfiniteWall.html">InfiniteWall</a></div><div class="ttdoc">A infinite wall fills the half-space {point: (position_-point)*normal_&lt;=0}.</div><div class="ttdef"><b>Definition:</b> InfiniteWall.h:27</div></div>
</div><!-- fragment --><p>Other walls are possible; see the documentation of WallHandler for more details.</p>
<h3><a class="anchor" id="autotoc_md18"></a>
Boundaries</h3>
<p>A periodic boundary in x-direction can be defined as follows:</p>
<div class="fragment"><div class="line"><span class="comment">//include above all other code:</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../d0/d17/PeriodicBoundary_8h.html">Boundaries/PeriodicBoundary.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">//include in setupInitialConditions:</span></div>
<div class="line"><a class="code" href="../../d0/d82/classPeriodicBoundary.html">PeriodicBoundary</a> b0;                     <span class="comment">// defines a new periodic boundary</span></div>
<div class="line"><a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a>.set(<a class="code" href="../../d5/dc1/classVec3D.html">Vec3D</a>(1,0,0),getXMin(),getXMax()); <span class="comment">// defines normal and position of the boundary </span></div>
<div class="line">boundaryHandler.copyAndAddObject(<a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a>);     <span class="comment">// copies boundary into the handler </span></div>
<div class="ttc" id="aPeriodicBoundary_8h_html"><div class="ttname"><a href="../../d0/d17/PeriodicBoundary_8h.html">PeriodicBoundary.h</a></div></div>
<div class="ttc" id="abenchVecAdd_8cpp_html_af9816f50f32fc22762a8289c3cc44f22"><div class="ttname"><a href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a></div><div class="ttdeci">Scalar * b</div><div class="ttdef"><b>Definition:</b> benchVecAdd.cpp:17</div></div>
<div class="ttc" id="aclassPeriodicBoundary_html"><div class="ttname"><a href="../../d0/d82/classPeriodicBoundary.html">PeriodicBoundary</a></div><div class="ttdoc">Defines a pair of periodic walls. Inherits from BaseBoundary.</div><div class="ttdef"><b>Definition:</b> PeriodicBoundary.h:20</div></div>
</div><!-- fragment --><p>Other boundaries are possible; see the documentation of BoundaryHandler for more details.</p>
<h3><a class="anchor" id="autotoc_md19"></a>
Overriding functions</h3>
<p>In some cases it is not enough to define suitable initial conditions. This is done by overriding certain functions in the Mercury3D class, just as we are overriding setupInitialConditions.</p>
<p>For example, to define a criterion to stop the simulation, one can override the </p><div class="fragment"><div class="line"><span class="comment">//include as member function in class definition:</span></div>
<div class="line"><span class="keywordtype">bool</span> continueSolve()<span class="keyword"> const override</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">    <span class="keywordflow">if</span> (getKineticEnergy()&lt;1<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>-5*getElasticEnergy())</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
</div><!-- fragment --><p> In this case, the simulation is stopped as soon as the kinetic energy drops below 0.00001 times the elastic energy stored in the contact springs (a useful criteria to determine arresting flow).</p>
<p>For more examples, see <a class="el" href="../../d6/d8c/DevelopersGuideOverride.html">Overriding functions</a>.</p>
<h3><a class="anchor" id="autotoc_md20"></a>
Avoiding magic numbers</h3>
<p>While the above example works, we advise you to avoid the number of explicitly used parameters such as the tolerance \(1e-5\) inside the class definition. A good coding guideline is to define all parameters in one place (the main function), with the exception of the particles, walls and boundaries, so they can easily be found and changed later. </p><pre class="fragment">\code{.cpp}
//include as member function in class definition:
bool continueSolve() const override
{
    if (getKineticEnergy()&lt;tolerance*getElasticEnergy())
        return false;
    else
        return true;
}

//include as member variable in class definition:
Mdouble tolerance = 0.0;

//include in main function:
problem.tolerance = 1e-5;
\endcode
</pre> <h3><a class="anchor" id="autotoc_md21"></a>
Creating new drivers</h3>
<p>You can start a new driver code by creating your own user directory. First, chose a <code>UserName</code>, then add a folder to the user directory and create a new source file, e.g. <code>Example.cpp</code>, which for convenience is copied here from the file <code>Tutorial1_ParticleInOuterSpace.cpp</code>. cd ~/MercurySource/Drivers/USER mkdir UserName cd UserName cp ../../Tutorials/Tutorial1_ParticleInOuterSpace.cpp Example.cpp git add Example.cpp</p>
<p>Now write your code in the Example.cpp file. Note, you cannot yet execute your code, as the Makefiles in your build directory doesn't know about the new file. To update your Makefiles, use cmake. Note, the file name of your source file has to be unique, otherwise you get error messages. cd ~/MercuryBuild cmake .</p>
<p>Now you can build and execute your new code: cd ~/MercuryBuild/Drivers/USER/UserName make Example</p>
<p>Note, as we currently only support MercuryDPM on Linux/Mac OS, these instructions are only valid for such systems. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dd/d62/UnclassifiedPages.html">Unclassified pages</a></li><li class="navelem"><a class="el" href="../../d8/d51/GettingStarted.html">Getting started</a></li><li class="navelem"><a class="el" href="../../df/d1c/IntroductionToTheCode.html">Introduction to the Code</a></li><li class="navelem"><a class="el" href="../../dc/d32/DevelopersGuide.html">Guidelines for Users and Developers</a></li>
    <li class="footer">Generated on Wed Aug 27 2025 17:05:12 for MercuryDPM by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
