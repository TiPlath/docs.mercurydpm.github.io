<!-- HTML header for doxygen 1.8.18-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MercuryDPM: Particles driven by a rotating coil</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../MDPM.css" rel="stylesheet" type="text/css"/>
<link href="../../codeLabels.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-fork-corner.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-dropdown-version.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../MDPM-fragment-copy-button.js"></script>
<script type="text/javascript">
DoxygenAwesomeFragmentCopyButton.init()
</script>
<script type="text/javascript" src="../../MDPM-paragraph-link.js"></script>
<script type="text/javascript">
DoxygenAwesomeParagraphLink.init()
</script>
<script type="text/javascript" src="../../MDPM-interactive-toc.js"></script>
<script type="text/javascript">
DoxygenAwesomeInteractiveToc.init()
</script>
<script type="text/javascript" src="../../MDPM-darkmode-toggle.js"></script>
<script type="text/javascript">
DoxygenAwesomeDarkModeToggle.init()
</script>
</head>
<body>
  <div id="bitbucket-corner">
   <a href="https://bitbucket.org/mercurydpm/mercurydpm/src/master/" target="_blank" id="fork-corner" class="fork-corner fc-pos-tr fc-animate fc-theme-bitbucket"></a>
  </div>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../mercury-logo-chosen-light-slogan.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"> <!--MercuryDPM--!>
   <!-- BEGIN version select -->
   <div class="dropdown" id="projectnumber">
    <button class="dropbtn">v1.0</button>
    <div class="dropdown-content">
    </div>
   </div>
   <script type="text/javascript" src="../../MDPM-dropdown-version.js"></script>
<!-- END version select -->
   <!--&#160;<span id="projectnumber">revision: v1.0</span>-->
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<script type="text/javascript" src="../../MDPM-fork-corner.js"></script>
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d0/d46/CoilSelfTest.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Particles driven by a rotating coil </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h4><a class="anchor" id="autotoc_md97"></a>
Problem description:</h4>
<p>This tutorial simulates particle flows around a coil for a short time. The code can be found in <b>CoilSelfTest.cpp</b>. It treats particles placed in a feeder being driven forward by a rotating coil.</p>
<h3><a class="anchor" id="autotoc_md98"></a>
Headers</h3>
<p>The following headers are included: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../d8/d02/Mercury3D_8h.html">Mercury3D.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../db/d14/InfiniteWall_8h.html">Walls/InfiniteWall.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../d5/dc4/InfiniteWallWithHole_8h.html">Walls/InfiniteWallWithHole.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../db/d7d/Coil_8h.html">Walls/Coil.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../da/d68/LinearViscoelasticSpecies_8h.html">Species/LinearViscoelasticSpecies.h</a>&quot;</span></div>
<div class="ttc" id="aCoil_8h_html"><div class="ttname"><a href="../../db/d7d/Coil_8h.html">Coil.h</a></div></div>
<div class="ttc" id="aInfiniteWallWithHole_8h_html"><div class="ttname"><a href="../../d5/dc4/InfiniteWallWithHole_8h.html">InfiniteWallWithHole.h</a></div></div>
<div class="ttc" id="aInfiniteWall_8h_html"><div class="ttname"><a href="../../db/d14/InfiniteWall_8h.html">InfiniteWall.h</a></div></div>
<div class="ttc" id="aLinearViscoelasticSpecies_8h_html"><div class="ttname"><a href="../../da/d68/LinearViscoelasticSpecies_8h.html">LinearViscoelasticSpecies.h</a></div></div>
<div class="ttc" id="aMercury3D_8h_html"><div class="ttname"><a href="../../d8/d02/Mercury3D_8h.html">Mercury3D.h</a></div></div>
</div><!-- fragment --><p>These are basically the headers used for the beginner tutorials, except for the additional Coil class.</p>
<h3><a class="anchor" id="autotoc_md99"></a>
Before the main function</h3>
<p>CoilSelfTest, like many of the previous tutorials, inherits from the Mercury3D class. </p><div class="fragment"><div class="line"><span class="keyword">class </span><a class="code" href="../../d2/d6d/classCoilSelfTest.html">CoilSelfTest</a> : <span class="keyword">public</span> <a class="code" href="../../d3/db1/classMercury3D.html">Mercury3D</a> </div>
<div class="ttc" id="aclassCoilSelfTest_html"><div class="ttname"><a href="../../d2/d6d/classCoilSelfTest.html">CoilSelfTest</a></div><div class="ttdoc">[CST:headers]</div><div class="ttdef"><b>Definition:</b> CoilSelfTest.cpp:22</div></div>
<div class="ttc" id="aclassMercury3D_html"><div class="ttname"><a href="../../d3/db1/classMercury3D.html">Mercury3D</a></div><div class="ttdoc">This adds on the hierarchical grid code for 3D problems.</div><div class="ttdef"><b>Definition:</b> Mercury3D.h:16</div></div>
</div><!-- fragment --><p> The different components of the class will be explained in turn in the following.</p>
<p>step 1: Define Walls<br  />
The particles are initially contained by a container made up of six walls, five of which are defined to be infinite. The wall in the positive Z-direction is different. Its normal is set (<code>rightWall-&gt;set(...</code>) in the positive Z-direction (<code>Vec3D(0, 0, 1)</code>), is set a distance <code>zMax_</code> (which is returned by <code>getZMax()</code>) from the origin, and contains a 'hole' (which is practically a horizontal tube, since the wall is 'infinite') around the X-axis of radius <code>1.0</code> in order to let the particles through. </p><div class="fragment"><div class="line">        <a class="code" href="../../d7/d91/classInfiniteWall.html">InfiniteWall</a> <a class="code" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a>;</div>
<div class="line">        <a class="code" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a>.setSpecies(speciesHandler.getObject(0));</div>
<div class="line">        <span class="comment">//front wall</span></div>
<div class="line">        <a class="code" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a>.set(<a class="code" href="../../d5/dc1/classVec3D.html">Vec3D</a>(-1, 0, 0), <a class="code" href="../../d5/dc1/classVec3D.html">Vec3D</a>(getXMin(), 0, 0));</div>
<div class="line">        wallHandler.copyAndAddObject(<a class="code" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">//back wall</span></div>
<div class="line">        <a class="code" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a>.set(<a class="code" href="../../d5/dc1/classVec3D.html">Vec3D</a>(1, 0, 0), <a class="code" href="../../d5/dc1/classVec3D.html">Vec3D</a>(getXMax(), 0, 0));</div>
<div class="line">        wallHandler.copyAndAddObject(<a class="code" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">//bottom wall</span></div>
<div class="line">        <a class="code" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a>.set(<a class="code" href="../../d5/dc1/classVec3D.html">Vec3D</a>(0, -1, 0), <a class="code" href="../../d5/dc1/classVec3D.html">Vec3D</a>(0, getYMin(), 0));</div>
<div class="line">        wallHandler.copyAndAddObject(<a class="code" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">//top wall</span></div>
<div class="line">        <a class="code" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a>.set(<a class="code" href="../../d5/dc1/classVec3D.html">Vec3D</a>(0, 1, 0), <a class="code" href="../../d5/dc1/classVec3D.html">Vec3D</a>(0, getYMax(), 0));</div>
<div class="line">        wallHandler.copyAndAddObject(<a class="code" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">//left wall</span></div>
<div class="line">        <a class="code" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a>.set(<a class="code" href="../../d5/dc1/classVec3D.html">Vec3D</a>(0, 0, -1), <a class="code" href="../../d5/dc1/classVec3D.html">Vec3D</a>(0, 0, getZMin()));</div>
<div class="line">        wallHandler.copyAndAddObject(<a class="code" href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">//right wall</span></div>
<div class="line">        <a class="code" href="../../d6/da6/classInfiniteWallWithHole.html">InfiniteWallWithHole</a> rightWall;</div>
<div class="line">        rightWall.<a class="code" href="../../d0/dd3/classBaseWall.html#ad54e8dd98fbf371d129bdc0e8aff37a9">setSpecies</a>(speciesHandler.getObject(0));</div>
<div class="line">        rightWall.<a class="code" href="../../d6/da6/classInfiniteWallWithHole.html#aedf65b07a2d8848400c47c3b5bdc3e55">set</a>(<a class="code" href="../../d5/dc1/classVec3D.html">Vec3D</a>(0, 0, 1), getZMax(), 1.0);</div>
<div class="line">        wallHandler.copyAndAddObject(rightWall);</div>
<div class="ttc" id="aMatrix__resize__int_8cpp_html_aab236ce080522c9832217fd5f157541b"><div class="ttname"><a href="../../d5/df8/Matrix__resize__int_8cpp.html#aab236ce080522c9832217fd5f157541b">w</a></div><div class="ttdeci">RowVector3d w</div><div class="ttdef"><b>Definition:</b> Matrix_resize_int.cpp:3</div></div>
<div class="ttc" id="aclassBaseWall_html_ad54e8dd98fbf371d129bdc0e8aff37a9"><div class="ttname"><a href="../../d0/dd3/classBaseWall.html#ad54e8dd98fbf371d129bdc0e8aff37a9">BaseWall::setSpecies</a></div><div class="ttdeci">void setSpecies(const ParticleSpecies *species)</div><div class="ttdoc">Defines the species of the current wall.</div><div class="ttdef"><b>Definition:</b> BaseWall.cc:148</div></div>
<div class="ttc" id="aclassInfiniteWallWithHole_html"><div class="ttname"><a href="../../d6/da6/classInfiniteWallWithHole.html">InfiniteWallWithHole</a></div><div class="ttdef"><b>Definition:</b> InfiniteWallWithHole.h:17</div></div>
<div class="ttc" id="aclassInfiniteWallWithHole_html_aedf65b07a2d8848400c47c3b5bdc3e55"><div class="ttname"><a href="../../d6/da6/classInfiniteWallWithHole.html#aedf65b07a2d8848400c47c3b5bdc3e55">InfiniteWallWithHole::set</a></div><div class="ttdeci">void set(Vec3D normal, Mdouble position, Mdouble holeRadius)</div><div class="ttdoc">Defines a standard wall, given an outward normal vector s. t. normal*x=position.</div><div class="ttdef"><b>Definition:</b> InfiniteWallWithHole.cc:51</div></div>
<div class="ttc" id="aclassInfiniteWall_html"><div class="ttname"><a href="../../d7/d91/classInfiniteWall.html">InfiniteWall</a></div><div class="ttdoc">A infinite wall fills the half-space {point: (position_-point)*normal_&lt;=0}.</div><div class="ttdef"><b>Definition:</b> InfiniteWall.h:27</div></div>
<div class="ttc" id="aclassVec3D_html"><div class="ttname"><a href="../../d5/dc1/classVec3D.html">Vec3D</a></div><div class="ttdef"><b>Definition:</b> Kernel/Math/Vector.h:30</div></div>
</div><!-- fragment --><p> step 2: Coil<br  />
After that the Coil object is added. Its geometrical properties are subsequently set by using the Coil::set() method, specifying its starting position (the origin, i.e. <code>Vec3D(0,0,0)</code>), its length (<code>1.0</code>), its radius (<code>1.0 - particleRadius</code>), its number of turns (<code>2.0</code>), its rotation speed (<code>-1.0</code> revelations per second) and its thickness (<code>0.5 * particleRadius</code>). <br  />
NB: its direction or central axis is not specified, since these are the Z-direction and the Z-axis, respectively, by default. </p><div class="fragment"><div class="line">        <span class="comment">// creation of the coil and setting of its properties</span></div>
<div class="line">        <a class="code" href="../../de/dce/classCoil.html">Coil</a> coil;</div>
<div class="line">        coil.<a class="code" href="../../d0/dd3/classBaseWall.html#ad54e8dd98fbf371d129bdc0e8aff37a9">setSpecies</a>(speciesHandler.getObject(0));</div>
<div class="line">        <span class="comment">// the syntax to set the coil geometry is as follows:</span></div>
<div class="line">        <span class="comment">// set(Start position, Length, Radius, Number of turns, Rotation speed, Thickness)</span></div>
<div class="line">        coil.<a class="code" href="../../de/dce/classCoil.html#a62831143f9fc7762b7164ecd23b10cd0">set</a>(<a class="code" href="../../d5/dc1/classVec3D.html">Vec3D</a>(0, 0, 0), 1.0, 1.0 - particleRadius, 2.0, -1.0, 0.5 * particleRadius);</div>
<div class="line">        <span class="keyword">auto</span> pCoil = wallHandler.copyAndAddObject(coil);</div>
<div class="ttc" id="aclassCoil_html"><div class="ttname"><a href="../../de/dce/classCoil.html">Coil</a></div><div class="ttdoc">This class defines a coil in the z-direction from a (constant) starting point, a (constant) length L,...</div><div class="ttdef"><b>Definition:</b> Coil.h:20</div></div>
<div class="ttc" id="aclassCoil_html_a62831143f9fc7762b7164ecd23b10cd0"><div class="ttname"><a href="../../de/dce/classCoil.html#a62831143f9fc7762b7164ecd23b10cd0">Coil::set</a></div><div class="ttdeci">void set(Vec3D Start, Mdouble length, Mdouble radius, Mdouble numberOfRevelations, Mdouble omega, Mdouble thickness)</div><div class="ttdoc">Set all parameters of this Coil.</div><div class="ttdef"><b>Definition:</b> Coil.cc:81</div></div>
</div><!-- fragment --><p> step 3: Create Particles<br  />
The particle properties are set subsequently. The particleHandler is cleared just to be sure it is empty, then the particle to be copied into the container is created and the previously set species is assigned to it. The particle is assigned a zero velocity and the previously defined particle radius. </p><div class="fragment"><div class="line">        particleHandler.clear();</div>
<div class="line">        <a class="code" href="../../d7/d41/classSphericalParticle.html">SphericalParticle</a> <a class="code" href="../../db/d01/MatrixBase__all_8cpp.html#a9b22b0b79984d73a58b20bc0c88a7c5f">p0</a>;</div>
<div class="line">        <a class="code" href="../../db/d01/MatrixBase__all_8cpp.html#a9b22b0b79984d73a58b20bc0c88a7c5f">p0</a>.setSpecies(speciesHandler.getObject(0));</div>
<div class="line">        <a class="code" href="../../db/d01/MatrixBase__all_8cpp.html#a9b22b0b79984d73a58b20bc0c88a7c5f">p0</a>.setVelocity(<a class="code" href="../../d5/dc1/classVec3D.html">Vec3D</a>(0.0, 0.0, 0.0));</div>
<div class="line">        <a class="code" href="../../db/d01/MatrixBase__all_8cpp.html#a9b22b0b79984d73a58b20bc0c88a7c5f">p0</a>.setRadius(particleRadius);</div>
<div class="ttc" id="aMatrixBase__all_8cpp_html_a9b22b0b79984d73a58b20bc0c88a7c5f"><div class="ttname"><a href="../../db/d01/MatrixBase__all_8cpp.html#a9b22b0b79984d73a58b20bc0c88a7c5f">p0</a></div><div class="ttdeci">Vector3f p0</div><div class="ttdef"><b>Definition:</b> MatrixBase_all.cpp:2</div></div>
<div class="ttc" id="aclassSphericalParticle_html"><div class="ttname"><a href="../../d7/d41/classSphericalParticle.html">SphericalParticle</a></div><div class="ttdoc">A spherical particle is the most simple particle used in MercuryDPM.</div><div class="ttdef"><b>Definition:</b> SphericalParticle.h:16</div></div>
</div><!-- fragment --><p> step 4: Place Particles<br  />
After specifying the particle properties, the container is filled with copies of the particle. In this example, particles are placed in a rectangular grid pattern, on evenly spaced positions. First, the number of particles that fit in each direction is computed. Then, a triple for-loop passes every possible particle position, and a particle is placed on the position if there's no part of the coil there. </p><div class="fragment"><div class="line">        <span class="comment">// Nx*Ny*Nz particles are created and placed on evenly spaced positions in</span></div>
<div class="line">        <span class="comment">// the domain [xMin_,xMax_]*[yMin_,yMax_]*[zMin_,zMax_] (unless their position</span></div>
<div class="line">        <span class="comment">// is already occupied by the coil).</span></div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/d37/namespaceGlobalParameters.html#a72a2066213f1fd30b154e116edb2780b">Nx</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span> (<a class="code" href="../../db/d6f/namespaceEigen_1_1bfloat16__impl.html#a31640041d38523bf096fec26745e7d1d">std::floor</a>((getXMax() - getXMin()) / (2.1 * particleRadius)));</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/d37/namespaceGlobalParameters.html#ac3d9a44125a811db69452eff8840b494">Ny</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span> (<a class="code" href="../../db/d6f/namespaceEigen_1_1bfloat16__impl.html#a31640041d38523bf096fec26745e7d1d">std::floor</a>((getYMax() - getYMin()) / (2.1 * particleRadius)));</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d8/d58/namespaceGlobal__Parameters.html#a1f35a0690c7745167a7178fb71f92e6e">Nz</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span> (<a class="code" href="../../db/d6f/namespaceEigen_1_1bfloat16__impl.html#a31640041d38523bf096fec26745e7d1d">std::floor</a>((getZMax() - getZMin()) / (2.1 * particleRadius)));</div>
<div class="line">        <a class="code" href="../../d5/de4/GeneralDefine_8h.html#ac48214003841d463b1dea3233e0788a7">Mdouble</a> distance;</div>
<div class="line">        <a class="code" href="../../d5/dc1/classVec3D.html">Vec3D</a> <a class="code" href="../../d5/d21/namespaceWallFunction.html#aaa127ee1332c51adfe2f7d483e5cc079">normal</a>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../d9/d37/namespaceGlobalParameters.html#a72a2066213f1fd30b154e116edb2780b">Nx</a>; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; <a class="code" href="../../d9/d37/namespaceGlobalParameters.html#ac3d9a44125a811db69452eff8840b494">Ny</a>; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> = 0; <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> &lt; <a class="code" href="../../d8/d58/namespaceGlobal__Parameters.html#a1f35a0690c7745167a7178fb71f92e6e">Nz</a>; <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>++)</div>
<div class="line">                {</div>
<div class="line">                    <a class="code" href="../../db/d01/MatrixBase__all_8cpp.html#a9b22b0b79984d73a58b20bc0c88a7c5f">p0</a>.setPosition(<a class="code" href="../../d5/dc1/classVec3D.html">Vec3D</a>(getXMin() + (getXMax() - getXMin()) * (0.5 + <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) / <a class="code" href="../../d9/d37/namespaceGlobalParameters.html#a72a2066213f1fd30b154e116edb2780b">Nx</a>,</div>
<div class="line">                                         getYMin() + (getYMax() - getYMin()) * (0.5 + <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) / <a class="code" href="../../d9/d37/namespaceGlobalParameters.html#ac3d9a44125a811db69452eff8840b494">Ny</a>,</div>
<div class="line">                                         getZMin() + (getZMax() - getZMin()) * (0.5 + <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>) / <a class="code" href="../../d8/d58/namespaceGlobal__Parameters.html#a1f35a0690c7745167a7178fb71f92e6e">Nz</a>));</div>
<div class="line">                    <span class="keywordflow">if</span> (!pCoil-&gt;getDistanceAndNormal(<a class="code" href="../../db/d01/MatrixBase__all_8cpp.html#a9b22b0b79984d73a58b20bc0c88a7c5f">p0</a>, distance, <a class="code" href="../../d5/d21/namespaceWallFunction.html#aaa127ee1332c51adfe2f7d483e5cc079">normal</a>)) <span class="comment">//if there is no collision with the coil</span></div>
<div class="line">                    {</div>
<div class="line">                        particleHandler.copyAndAddObject(<a class="code" href="../../db/d01/MatrixBase__all_8cpp.html#a9b22b0b79984d73a58b20bc0c88a7c5f">p0</a>);</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">else</span></div>
<div class="line">                    {</div>
<div class="line">                        <a class="code" href="../../df/d79/Logger_8cc.html#a6bb54690071023a814dfcb33b0a5d9a4">logger</a>(<a class="code" href="../../d4/dbf/main_8h.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a>, <span class="stringliteral">&quot;particle at position % could not be inserted&quot;</span>, <a class="code" href="../../db/d01/MatrixBase__all_8cpp.html#a9b22b0b79984d73a58b20bc0c88a7c5f">p0</a>.getPosition());</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="ttc" id="aBiCGSTAB__step__by__step_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> BiCGSTAB_step_by_step.cpp:9</div></div>
<div class="ttc" id="aGeneralDefine_8h_html_ac48214003841d463b1dea3233e0788a7"><div class="ttname"><a href="../../d5/de4/GeneralDefine_8h.html#ac48214003841d463b1dea3233e0788a7">Mdouble</a></div><div class="ttdeci">double Mdouble</div><div class="ttdef"><b>Definition:</b> GeneralDefine.h:13</div></div>
<div class="ttc" id="aLogger_8cc_html_a6bb54690071023a814dfcb33b0a5d9a4"><div class="ttname"><a href="../../df/d79/Logger_8cc.html#a6bb54690071023a814dfcb33b0a5d9a4">logger</a></div><div class="ttdeci">Logger&lt; MERCURYDPM_LOGLEVEL &gt; logger(&quot;MercuryKernel&quot;)</div><div class="ttdoc">Definition of different loggers with certain modules. A user can define its own custom logger here.</div></div>
<div class="ttc" id="alevel2__impl_8h_html_ad46ea6bf5745e72b985b11878e46a45d"><div class="ttname"><a href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a></div><div class="ttdeci">char char char int int * k</div><div class="ttdef"><b>Definition:</b> level2_impl.h:374</div></div>
<div class="ttc" id="amain_8h_html_ad72dbcf6d0153db1b8d8a58001feed83"><div class="ttname"><a href="../../d4/dbf/main_8h.html#ad72dbcf6d0153db1b8d8a58001feed83">DEBUG</a></div><div class="ttdeci">#define DEBUG</div><div class="ttdef"><b>Definition:</b> main.h:181</div></div>
<div class="ttc" id="anamespaceEigen_1_1bfloat16__impl_html_a31640041d38523bf096fec26745e7d1d"><div class="ttname"><a href="../../db/d6f/namespaceEigen_1_1bfloat16__impl.html#a31640041d38523bf096fec26745e7d1d">Eigen::bfloat16_impl::floor</a></div><div class="ttdeci">EIGEN_STRONG_INLINE EIGEN_DEVICE_FUNC bfloat16 floor(const bfloat16 &amp;a)</div><div class="ttdef"><b>Definition:</b> BFloat16.h:643</div></div>
<div class="ttc" id="anamespaceGlobalParameters_html_a72a2066213f1fd30b154e116edb2780b"><div class="ttname"><a href="../../d9/d37/namespaceGlobalParameters.html#a72a2066213f1fd30b154e116edb2780b">GlobalParameters::Nx</a></div><div class="ttdeci">unsigned Nx</div><div class="ttdoc">Number of elements in each direction (used by SimpleCubicMesh)</div><div class="ttdef"><b>Definition:</b> structured_cubic_point_source.cc:114</div></div>
<div class="ttc" id="anamespaceGlobalParameters_html_ac3d9a44125a811db69452eff8840b494"><div class="ttname"><a href="../../d9/d37/namespaceGlobalParameters.html#ac3d9a44125a811db69452eff8840b494">GlobalParameters::Ny</a></div><div class="ttdeci">unsigned Ny</div><div class="ttdef"><b>Definition:</b> structured_cubic_point_source.cc:115</div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a1f35a0690c7745167a7178fb71f92e6e"><div class="ttname"><a href="../../d8/d58/namespaceGlobal__Parameters.html#a1f35a0690c7745167a7178fb71f92e6e">Global_Parameters::Nz</a></div><div class="ttdeci">unsigned Nz</div><div class="ttdoc">Number of elements in z-direction.</div><div class="ttdef"><b>Definition:</b> axisym_linear_elasticity/cylinder/cylinder.cc:62</div></div>
<div class="ttc" id="anamespaceWallFunction_html_aaa127ee1332c51adfe2f7d483e5cc079"><div class="ttname"><a href="../../d5/d21/namespaceWallFunction.html#aaa127ee1332c51adfe2f7d483e5cc079">WallFunction::normal</a></div><div class="ttdeci">void normal(const Vector&lt; double &gt; &amp;x, Vector&lt; double &gt; &amp;normal)</div><div class="ttdef"><b>Definition:</b> free_surface_rotation.cc:65</div></div>
<div class="ttc" id="atut__arithmetic__redux__minmax_8cpp_html_a39513f0f8d942bf9ef17b2e87ac6d34e"><div class="ttname"><a href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a></div><div class="ttdeci">std::ptrdiff_t j</div><div class="ttdef"><b>Definition:</b> tut_arithmetic_redux_minmax.cpp:2</div></div>
</div><!-- fragment --><p> Data members:<br  />
CoilSelfTest only has two (public) data members, namely a pointer to the coil: </p><div class="fragment"><div class="line">    <a class="code" href="../../de/dce/classCoil.html">Coil</a>* coil;</div>
<div class="line">    <a class="code" href="../../d5/de4/GeneralDefine_8h.html#ac48214003841d463b1dea3233e0788a7">Mdouble</a> particleRadius;</div>
</div><!-- fragment --><p> Actions Before TimeStep:<br  />
The <b>actionsBeforeTimeStep()</b> method specifies all actions that need to be performed at the beginning of each time step, i.e. <em>before</em> the actual numerical solution at that time step is computed. In this case, it states that from 1 second into the simulation time and onward, the coil should turn with the given rotational speed. </p><div class="fragment"><div class="line">    <span class="keywordtype">void</span> actionsBeforeTimeStep()<span class="keyword"> override</span></div>
<div class="line"><span class="keyword">    </span>{</div>
<div class="line">        <span class="keywordflow">if</span> (getTime() &gt; 1)</div>
<div class="line">        {</div>
<div class="line">            coil-&gt;<a class="code" href="../../de/dce/classCoil.html#ad89742ecb6608c19241de4ce55f3a216">move_time</a>(getTimeStep());</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="ttc" id="aclassCoil_html_ad89742ecb6608c19241de4ce55f3a216"><div class="ttname"><a href="../../de/dce/classCoil.html#ad89742ecb6608c19241de4ce55f3a216">Coil::move_time</a></div><div class="ttdeci">void move_time(Mdouble dt)</div><div class="ttdoc">Rotate the Coil for a period dt, so that the offset_ changes with omega_*dt.</div><div class="ttdef"><b>Definition:</b> Coil.cc:193</div></div>
</div><!-- fragment --> <h3><a class="anchor" id="autotoc_md100"></a>
Main Function</h3>
<p>In the main program, a CoilSelfTest object is created, after which some of its basic properties are set like its number of dimensions (three), time step and saving parameters. Lastly, the problem is actually solved by calling its <b>solve()</b> method. </p><div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code" href="../../d9/d18/T__protectiveWall_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>(<span class="keywordtype">int</span> argc <a class="code" href="../../d5/de4/GeneralDefine_8h.html#addf5ec070e9499d36b7f2009ce736076">UNUSED</a>, <span class="keywordtype">char</span>* argv[] <a class="code" href="../../d5/de4/GeneralDefine_8h.html#addf5ec070e9499d36b7f2009ce736076">UNUSED</a>)</div>
<div class="line">{</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// create CoilSelfTest object</span></div>
<div class="line">    <a class="code" href="../../d2/d6d/classCoilSelfTest.html">CoilSelfTest</a> <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// set some basic problem properties</span></div>
<div class="line"><span class="comment"></span>    <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.setName(<span class="stringliteral">&quot;CoilSelfTest&quot;</span>);</div>
<div class="line">    <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.setSystemDimensions(3);</div>
<div class="line">    <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.setGravity(<a class="code" href="../../d5/dc1/classVec3D.html">Vec3D</a>(0.0, -9.8, 0.0));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// set problem geometry</span></div>
<div class="line">    <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.setXMax(1.0);</div>
<div class="line">    <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.setYMax(5.0);</div>
<div class="line">    <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.setZMax(2.0);</div>
<div class="line">    <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.setXMin(-1.0);</div>
<div class="line">    <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.setYMin(-1.0);</div>
<div class="line">    <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.setTimeMax(0.5);</div>
<div class="line">    <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.particleRadius = 0.2;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="../../d9/d0c/classSpecies.html">LinearViscoelasticSpecies</a> species;</div>
<div class="line">    species.<a class="code" href="../../dc/d02/classParticleSpecies.html#a274df9fa08ef5580e54f8e9301f1b348">setDensity</a>(1000);</div>
<div class="line">    <a class="code" href="../../d5/de4/GeneralDefine_8h.html#ac48214003841d463b1dea3233e0788a7">Mdouble</a> tc = 0.05;</div>
<div class="line">    <a class="code" href="../../d5/de4/GeneralDefine_8h.html#ac48214003841d463b1dea3233e0788a7">Mdouble</a> restitutionCoefficient = 0.8;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="../../d5/de4/GeneralDefine_8h.html#ac48214003841d463b1dea3233e0788a7">Mdouble</a> particleMass = <a class="code" href="../../dc/d5d/classEigen_1_1ArrayBase.html#ae88c21100861b1cebec61f7db1e5b8e6">pow</a>(<a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.particleRadius, 3) * <a class="code" href="../../d7/d28/namespaceconstants.html#a5f695d1bf98bf8537048b2eee827659d">constants::pi</a> * 4.0 / 3.0 * species.<a class="code" href="../../dc/d02/classParticleSpecies.html#ad18b57ec2a669a903fa4deed0b595aef">getDensity</a>();</div>
<div class="line">    species.<a class="code" href="../../dd/de0/classLinearViscoelasticNormalSpecies.html#a8d0cb6ca784e03f20ebacf5df2c4f089">setCollisionTimeAndRestitutionCoefficient</a>(tc, restitutionCoefficient, particleMass);</div>
<div class="line">    <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.speciesHandler.copyAndAddObject(species);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.setTimeStep(0.02 * 0.05);</div>
<div class="line">    <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.setSaveCount(<a class="code" href="../../d9/d41/namespacehelpers.html#a007d1564517a68b7cd4c1d7d533e0a69">helpers::getSaveCountFromNumberOfSavesAndTimeMaxAndTimeStep</a>(1000, <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.getTimeMax(),</div>
<div class="line">                                                                                     <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.getTimeStep()));</div>
<div class="line">    <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.solve();</div>
<div class="line">    </div>
<div class="line">}</div>
<div class="ttc" id="aGeneralDefine_8h_html_addf5ec070e9499d36b7f2009ce736076"><div class="ttname"><a href="../../d5/de4/GeneralDefine_8h.html#addf5ec070e9499d36b7f2009ce736076">UNUSED</a></div><div class="ttdeci">#define UNUSED</div><div class="ttdef"><b>Definition:</b> GeneralDefine.h:18</div></div>
<div class="ttc" id="aT__protectiveWall_8cpp_html_a0ddf1224851353fc92bfbff6f499fa97"><div class="ttname"><a href="../../d9/d18/T__protectiveWall_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a></div><div class="ttdeci">int main(int argc, char *argv[])</div><div class="ttdef"><b>Definition:</b> T_protectiveWall.cpp:194</div></div>
<div class="ttc" id="aclassEigen_1_1ArrayBase_html_ae88c21100861b1cebec61f7db1e5b8e6"><div class="ttname"><a href="../../dc/d5d/classEigen_1_1ArrayBase.html#ae88c21100861b1cebec61f7db1e5b8e6">Eigen::ArrayBase::pow</a></div><div class="ttdeci">EIGEN_DEVICE_FUNC const GlobalUnaryPowReturnType&lt; Derived, ScalarExponent &gt; pow(const Eigen::ArrayBase&lt; Derived &gt; &amp;x, const ScalarExponent &amp;exponent)</div><div class="ttdef"><b>Definition:</b> GlobalFunctions.h:137</div></div>
<div class="ttc" id="aclassLinearViscoelasticNormalSpecies_html_a8d0cb6ca784e03f20ebacf5df2c4f089"><div class="ttname"><a href="../../dd/de0/classLinearViscoelasticNormalSpecies.html#a8d0cb6ca784e03f20ebacf5df2c4f089">LinearViscoelasticNormalSpecies::setCollisionTimeAndRestitutionCoefficient</a></div><div class="ttdeci">void setCollisionTimeAndRestitutionCoefficient(Mdouble tc, Mdouble eps, BaseParticle *p)</div><div class="ttdoc">Sets k, disp such that it matches a given tc and eps for a collision of two copies of particle p.</div><div class="ttdef"><b>Definition:</b> LinearViscoelasticNormalSpecies.cc:191</div></div>
<div class="ttc" id="aclassParticleSpecies_html_a274df9fa08ef5580e54f8e9301f1b348"><div class="ttname"><a href="../../dc/d02/classParticleSpecies.html#a274df9fa08ef5580e54f8e9301f1b348">ParticleSpecies::setDensity</a></div><div class="ttdeci">void setDensity(Mdouble density)</div><div class="ttdef"><b>Definition:</b> ParticleSpecies.cc:88</div></div>
<div class="ttc" id="aclassParticleSpecies_html_ad18b57ec2a669a903fa4deed0b595aef"><div class="ttname"><a href="../../dc/d02/classParticleSpecies.html#ad18b57ec2a669a903fa4deed0b595aef">ParticleSpecies::getDensity</a></div><div class="ttdeci">Mdouble getDensity() const</div><div class="ttdoc">Allows density_ to be accessed.</div><div class="ttdef"><b>Definition:</b> ParticleSpecies.cc:98</div></div>
<div class="ttc" id="aclassSpecies_html"><div class="ttname"><a href="../../d9/d0c/classSpecies.html">Species&lt; LinearViscoelasticNormalSpecies &gt;</a></div></div>
<div class="ttc" id="anamespaceconstants_html_a5f695d1bf98bf8537048b2eee827659d"><div class="ttname"><a href="../../d7/d28/namespaceconstants.html#a5f695d1bf98bf8537048b2eee827659d">constants::pi</a></div><div class="ttdeci">const Mdouble pi</div><div class="ttdef"><b>Definition:</b> ExtendedMath.h:23</div></div>
<div class="ttc" id="anamespacehelpers_html_a007d1564517a68b7cd4c1d7d533e0a69"><div class="ttname"><a href="../../d9/d41/namespacehelpers.html#a007d1564517a68b7cd4c1d7d533e0a69">helpers::getSaveCountFromNumberOfSavesAndTimeMaxAndTimeStep</a></div><div class="ttdeci">unsigned int getSaveCountFromNumberOfSavesAndTimeMaxAndTimeStep(unsigned int numberOfSaves, Mdouble timeMax, Mdouble timeStep)</div><div class="ttdoc">Returns the correct saveCount if the total number of saves, the final time and the time step is known...</div><div class="ttdef"><b>Definition:</b> FormulaHelpers.cc:75</div></div>
<div class="ttc" id="asteady__axisym__advection__diffusion_8cc_html_a569d6908c13cebe207584b3d146c851e"><div class="ttname"><a href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a></div><div class="ttdeci">Constructor for SteadyAxisymAdvectionDiffusion problem</div><div class="ttdef"><b>Definition:</b> steady_axisym_advection_diffusion.cc:213</div></div>
</div><!-- fragment --><p> Next, the particle species is defined. The particles in this problem will use a linear visco-elastic (normal) contact model. The dissipation and stiffness defining the contact model can be set in different ways. In this example the contact model properties are set by giving a collision time, coefficient of restitution and the particle mass. </p><div class="fragment"><div class="line">    <a class="code" href="../../d9/d0c/classSpecies.html">LinearViscoelasticSpecies</a> species;</div>
<div class="line">    species.<a class="code" href="../../dc/d02/classParticleSpecies.html#a274df9fa08ef5580e54f8e9301f1b348">setDensity</a>(1000);</div>
<div class="line">    <a class="code" href="../../d5/de4/GeneralDefine_8h.html#ac48214003841d463b1dea3233e0788a7">Mdouble</a> tc = 0.05;</div>
<div class="line">    <a class="code" href="../../d5/de4/GeneralDefine_8h.html#ac48214003841d463b1dea3233e0788a7">Mdouble</a> restitutionCoefficient = 0.8;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="../../d5/de4/GeneralDefine_8h.html#ac48214003841d463b1dea3233e0788a7">Mdouble</a> particleMass = <a class="code" href="../../dc/d5d/classEigen_1_1ArrayBase.html#ae88c21100861b1cebec61f7db1e5b8e6">pow</a>(<a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.particleRadius, 3) * <a class="code" href="../../d7/d28/namespaceconstants.html#a5f695d1bf98bf8537048b2eee827659d">constants::pi</a> * 4.0 / 3.0 * species.<a class="code" href="../../dc/d02/classParticleSpecies.html#ad18b57ec2a669a903fa4deed0b595aef">getDensity</a>();</div>
<div class="line">    species.<a class="code" href="../../dd/de0/classLinearViscoelasticNormalSpecies.html#a8d0cb6ca784e03f20ebacf5df2c4f089">setCollisionTimeAndRestitutionCoefficient</a>(tc, restitutionCoefficient, particleMass);</div>
<div class="line">    <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.speciesHandler.copyAndAddObject(species);</div>
</div><!-- fragment --> <h3><a class="anchor" id="autotoc_md101"></a>
Reference:</h3>
<p><a href="https://www.sciencedirect.com/science/article/pii/S0032591016301206?via%3Dihub">Imole, O. I., Krijgsman, D., Weinhart, T., Magnanimo, V., Montes, B. E. C., Ramaioli, M., &amp; Luding, S. (2016). Reprint of" Experiments and discrete element simulation of the dosing of cohesive powders in a simplified geometry". Powder technology, 293, 69-81.</a></p>
<p>(Return to <a class="el" href="../../d7/db9/AdvancedTutorials.html#AdvancedOverview">Overview of advanced tutorials</a>) </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../index.html">MercuryDPM Reference Manual</a></li><li class="navelem"><a class="el" href="../../d5/dac/Tutorials.html">Fun with MercuryDPM (Tutorials)</a></li><li class="navelem"><a class="el" href="../../d0/db0/BeginnerTutorials.html">Beginner tutorials</a></li><li class="navelem"><a class="el" href="../../d7/db9/AdvancedTutorials.html">Advanced tutorials</a></li>
    <li class="footer">Generated on Wed Aug 27 2025 17:05:13 for MercuryDPM by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
