<!-- HTML header for doxygen 1.8.18-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MercuryDPM: oomph::TreeBasedRefineableMeshBase Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../MDPM.css" rel="stylesheet" type="text/css"/>
<link href="../../codeLabels.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-fork-corner.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-dropdown-version.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../MDPM-fragment-copy-button.js"></script>
<script type="text/javascript">
DoxygenAwesomeFragmentCopyButton.init()
</script>
<script type="text/javascript" src="../../MDPM-paragraph-link.js"></script>
<script type="text/javascript">
DoxygenAwesomeParagraphLink.init()
</script>
<script type="text/javascript" src="../../MDPM-interactive-toc.js"></script>
<script type="text/javascript">
DoxygenAwesomeInteractiveToc.init()
</script>
<script type="text/javascript" src="../../MDPM-darkmode-toggle.js"></script>
<script type="text/javascript">
DoxygenAwesomeDarkModeToggle.init()
</script>
</head>
<body>
  <div id="bitbucket-corner">
   <a href="https://bitbucket.org/mercurydpm/mercurydpm/src/master/" target="_blank" id="fork-corner" class="fork-corner fc-pos-tr fc-animate fc-theme-bitbucket"></a>
  </div>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../mercury-logo-chosen-light-slogan.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"> <!--MercuryDPM--!>
   <!-- BEGIN version select -->
   <div class="dropdown" id="projectnumber">
    <button class="dropbtn">v1.0</button>
    <div class="dropdown-content">
    </div>
   </div>
   <script type="text/javascript" src="../../MDPM-dropdown-version.js"></script>
<!-- END version select -->
   <!--&#160;<span id="projectnumber">revision: v1.0</span>-->
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<script type="text/javascript" src="../../MDPM-fork-corner.js"></script>
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="../../db/dc6/classoomph_1_1TreeBasedRefineableMeshBase-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">oomph::TreeBasedRefineableMeshBase Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div>  </div>
</div><!--header-->
<div class="contents">

<p>Base class for tree-based refineable meshes.  
 <a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="../../d6/d40/refineable__mesh_8h_source.html">refineable_mesh.h</a>&gt;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Inheritance diagram for oomph::TreeBasedRefineableMeshBase:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
 <div class="center">
  <img src="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.png" usemap="#oomph::TreeBasedRefineableMeshBase_map" alt=""/>
  <map id="oomph::TreeBasedRefineableMeshBase_map" name="oomph::TreeBasedRefineableMeshBase_map">
<area href="../../d4/d54/classoomph_1_1RefineableMeshBase.html" alt="oomph::RefineableMeshBase" shape="rect" coords="1046,56,1559,80"/>
<area href="../../d6/db8/classoomph_1_1Mesh.html" alt="oomph::Mesh" shape="rect" coords="1046,0,1559,24"/>
<area href="../../d1/d8f/classoomph_1_1TreeBasedRefineableMesh.html" alt="oomph::TreeBasedRefineableMesh&lt; ELEMENT &gt;" shape="rect" coords="1046,168,1559,192"/>
<area href="../../dc/dc1/classoomph_1_1RefineableQuadMesh.html" alt="oomph::RefineableQuadMesh&lt; NST_ELEMENT &gt;" shape="rect" coords="0,224,513,248"/>
<area href="../../dc/dc1/classoomph_1_1RefineableQuadMesh.html" alt="oomph::RefineableQuadMesh&lt; AD_ELEMENT &gt;" shape="rect" coords="523,224,1036,248"/>
<area href="../../de/d14/classoomph_1_1RefineableBrickMesh.html" alt="oomph::RefineableBrickMesh&lt; ELEMENT &gt;" shape="rect" coords="1046,224,1559,248"/>
<area href="../../d7/d4e/classoomph_1_1RefineableLineMesh.html" alt="oomph::RefineableLineMesh&lt; ELEMENT &gt;" shape="rect" coords="2092,224,2605,248"/>
<area href="../../dc/dc1/classoomph_1_1RefineableQuadMesh.html" alt="oomph::RefineableQuadMesh&lt; ELEMENT &gt;" shape="rect" coords="2615,224,3128,248"/>
<area href="../../d4/deb/classoomph_1_1RefineableRectangularQuadMesh.html" alt="oomph::RefineableRectangularQuadMesh&lt; NST_ELEMENT &gt;" shape="rect" coords="0,280,513,304"/>
<area href="../../d4/deb/classoomph_1_1RefineableRectangularQuadMesh.html" alt="oomph::RefineableRectangularQuadMesh&lt; AD_ELEMENT &gt;" shape="rect" coords="523,280,1036,304"/>
<area href="../../d3/da1/classoomph_1_1RefineableExtrudedCubeMeshFromQuadMesh.html" alt="oomph::RefineableExtrudedCubeMeshFromQuadMesh&lt; THREE_D_ELEMENT &gt;" shape="rect" coords="1569,280,2082,304"/>
<area href="../../d3/da1/classoomph_1_1RefineableExtrudedCubeMeshFromQuadMesh.html" alt="oomph::RefineableExtrudedCubeMeshFromQuadMesh&lt; EXTRUDED_ELEMENT &gt;" shape="rect" coords="1569,336,2082,360"/>
<area href="../../d2/dbe/classoomph_1_1RefineableSimpleCubicMesh.html" alt="oomph::RefineableSimpleCubicMesh&lt; NST_ELEMENT &gt;" shape="rect" coords="1569,392,2082,416"/>
<area href="../../d2/dbe/classoomph_1_1RefineableSimpleCubicMesh.html" alt="oomph::RefineableSimpleCubicMesh&lt; AD_ELEMENT &gt;" shape="rect" coords="1569,448,2082,472"/>
<area href="../../dd/d1c/classRefineableElasticCubicMesh.html" title="Simple cubic mesh upgraded to become a solid mesh." alt="RefineableElasticCubicMesh&lt; ELEMENT &gt;" shape="rect" coords="1569,504,2082,528"/>
<area href="../../dd/d1c/classRefineableElasticCubicMesh.html" title="Simple cubic mesh upgraded to become a solid mesh." alt="RefineableElasticCubicMesh&lt; ELEMENT &gt;" shape="rect" coords="1569,560,2082,584"/>
<area href="../../dd/d1c/classRefineableElasticCubicMesh.html" title="Simple cubic mesh upgraded to become a solid mesh." alt="RefineableElasticCubicMesh&lt; ELEMENT &gt;" shape="rect" coords="1569,616,2082,640"/>
<area href="../../dd/d1c/classRefineableElasticCubicMesh.html" title="Simple cubic mesh upgraded to become a solid mesh." alt="RefineableElasticCubicMesh&lt; ELEMENT &gt;" shape="rect" coords="1569,672,2082,696"/>
<area href="../../dd/d1c/classRefineableElasticCubicMesh.html" title="Simple cubic mesh upgraded to become a solid mesh." alt="RefineableElasticCubicMesh&lt; ELEMENT &gt;" shape="rect" coords="1569,728,2082,752"/>
<area href="../../d8/dfd/classTestRefineableCubicMesh.html" alt="TestRefineableCubicMesh&lt; ELEMENT &gt;" shape="rect" coords="1569,784,2082,808"/>
<area href="../../d0/ddb/classoomph_1_1ElasticRefineableQuarterPipeMesh.html" title="Refineable elastic quarter pipe mesh class." alt="oomph::ElasticRefineableQuarterPipeMesh&lt; ELEMENT &gt;" shape="rect" coords="1569,840,2082,864"/>
<area href="../../de/d88/classoomph_1_1RefineableBrickFromTetMesh.html" alt="oomph::RefineableBrickFromTetMesh&lt; ELEMENT &gt;" shape="rect" coords="1569,896,2082,920"/>
<area href="../../d6/d74/classoomph_1_1RefineableEighthSphereMesh.html" alt="oomph::RefineableEighthSphereMesh&lt; ELEMENT &gt;" shape="rect" coords="1569,952,2082,976"/>
<area href="../../d3/da1/classoomph_1_1RefineableExtrudedCubeMeshFromQuadMesh.html" alt="oomph::RefineableExtrudedCubeMeshFromQuadMesh&lt; ELEMENT &gt;" shape="rect" coords="1569,1008,2082,1032"/>
<area href="../../d4/dd0/classoomph_1_1RefineableQuarterPipeMesh.html" title="Refineable quarter pipe mesh class." alt="oomph::RefineableQuarterPipeMesh&lt; ELEMENT &gt;" shape="rect" coords="1569,1064,2082,1088"/>
<area href="../../da/d9a/classoomph_1_1RefineableQuarterTubeMesh.html" alt="oomph::RefineableQuarterTubeMesh&lt; ELEMENT &gt;" shape="rect" coords="1569,1120,2082,1144"/>
<area href="../../d2/dbe/classoomph_1_1RefineableSimpleCubicMesh.html" title="Refineable version of simple cubic 3D Brick mesh class." alt="oomph::RefineableSimpleCubicMesh&lt; ELEMENT &gt;" shape="rect" coords="1569,1176,2082,1200"/>
<area href="../../d6/dc6/classoomph_1_1RefineableSolidBrickFromTetMesh.html" alt="oomph::RefineableSolidBrickFromTetMesh&lt; ELEMENT &gt;" shape="rect" coords="1569,1232,2082,1256"/>
<area href="../../db/da2/classoomph_1_1RefineableSolidThinLayerBrickOnTetMesh.html" alt="oomph::RefineableSolidThinLayerBrickOnTetMesh&lt; ELEMENT &gt;" shape="rect" coords="1569,1288,2082,1312"/>
<area href="../../d6/dce/classoomph_1_1RefineableThinLayerBrickOnTetMesh.html" alt="oomph::RefineableThinLayerBrickOnTetMesh&lt; ELEMENT &gt;" shape="rect" coords="1569,1344,2082,1368"/>
<area href="../../d2/d75/classoomph_1_1RefineableTubeMesh.html" alt="oomph::RefineableTubeMesh&lt; ELEMENT &gt;" shape="rect" coords="1569,1400,2082,1424"/>
<area href="../../d0/da2/classoomph_1_1RotatableRefineableCubicMesh.html" alt="oomph::RotatableRefineableCubicMesh&lt; ELEMENT &gt;" shape="rect" coords="1569,1456,2082,1480"/>
<area href="../../da/d01/classoomph_1_1RefineableOneDMesh.html" title="Refineable version of the OneDMesh." alt="oomph::RefineableOneDMesh&lt; ELEMENT &gt;" shape="rect" coords="2092,280,2605,304"/>
<area href="../../de/d68/classoomph_1_1ElasticRefineableRectangularQuadMesh.html" alt="oomph::ElasticRefineableRectangularQuadMesh&lt; SOLID_ELEMENT &gt;" shape="rect" coords="3138,280,3651,304"/>
<area href="../../d1/dc1/classoomph_1_1RefineableAlgebraicCylinderWithFlagMesh.html" alt="oomph::RefineableAlgebraicCylinderWithFlagMesh&lt; FLUID_ELEMENT &gt;" shape="rect" coords="3138,336,3651,360"/>
<area href="../../dc/d6a/classoomph_1_1RefineableQuadMeshWithMovingCylinder.html" alt="oomph::RefineableQuadMeshWithMovingCylinder&lt; MyRefineableQTaylorHoodElement &gt;" shape="rect" coords="3138,392,3651,416"/>
<area href="../../d2/d49/classoomph_1_1Refineable__r__mesh.html" alt="oomph::Refineable_r_mesh&lt; RefineablePolarStreamfunctionElement &gt;" shape="rect" coords="3138,448,3651,472"/>
<area href="../../d3/d41/classRefineableCylinderAndInterfaceMesh.html" alt="RefineableCylinderAndInterfaceMesh&lt; ELEMENT &gt;" shape="rect" coords="3138,504,3651,528"/>
<area href="../../d3/d51/classRefineableRectangleWithHoleMesh.html" alt="RefineableRectangleWithHoleMesh&lt; ELEMENT &gt;" shape="rect" coords="3138,560,3651,584"/>
<area href="../../d3/d51/classRefineableRectangleWithHoleMesh.html" alt="RefineableRectangleWithHoleMesh&lt; ELEMENT &gt;" shape="rect" coords="3138,616,3651,640"/>
<area href="../../d3/d51/classRefineableRectangleWithHoleMesh.html" alt="RefineableRectangleWithHoleMesh&lt; ELEMENT &gt;" shape="rect" coords="3138,672,3651,696"/>
<area href="../../d9/d48/classSimpleRefineableFishMesh.html" title="Fish shaped mesh with simple adaptivity (no macro elements)." alt="SimpleRefineableFishMesh&lt; ELEMENT &gt;" shape="rect" coords="3138,728,3651,752"/>
<area href="../../d6/db2/classSimpleRefineableRectangularQuadMesh.html" alt="SimpleRefineableRectangularQuadMesh&lt; ELEMENT &gt;" shape="rect" coords="3138,784,3651,808"/>
<area href="../../d6/db2/classSimpleRefineableRectangularQuadMesh.html" alt="SimpleRefineableRectangularQuadMesh&lt; ELEMENT &gt;" shape="rect" coords="3138,840,3651,864"/>
<area href="../../d6/db2/classSimpleRefineableRectangularQuadMesh.html" alt="SimpleRefineableRectangularQuadMesh&lt; ELEMENT &gt;" shape="rect" coords="3138,896,3651,920"/>
<area href="../../d6/db2/classSimpleRefineableRectangularQuadMesh.html" alt="SimpleRefineableRectangularQuadMesh&lt; ELEMENT &gt;" shape="rect" coords="3138,952,3651,976"/>
<area href="../../d6/db2/classSimpleRefineableRectangularQuadMesh.html" alt="SimpleRefineableRectangularQuadMesh&lt; ELEMENT &gt;" shape="rect" coords="3138,1008,3651,1032"/>
<area href="../../d6/db2/classSimpleRefineableRectangularQuadMesh.html" alt="SimpleRefineableRectangularQuadMesh&lt; ELEMENT &gt;" shape="rect" coords="3138,1064,3651,1088"/>
<area href="../../d6/db2/classSimpleRefineableRectangularQuadMesh.html" alt="SimpleRefineableRectangularQuadMesh&lt; ELEMENT &gt;" shape="rect" coords="3138,1120,3651,1144"/>
<area href="../../d6/db2/classSimpleRefineableRectangularQuadMesh.html" alt="SimpleRefineableRectangularQuadMesh&lt; ELEMENT &gt;" shape="rect" coords="3138,1176,3651,1200"/>
<area href="../../d6/db2/classSimpleRefineableRectangularQuadMesh.html" alt="SimpleRefineableRectangularQuadMesh&lt; ELEMENT &gt;" shape="rect" coords="3138,1232,3651,1256"/>
<area href="../../d6/db2/classSimpleRefineableRectangularQuadMesh.html" alt="SimpleRefineableRectangularQuadMesh&lt; ELEMENT &gt;" shape="rect" coords="3138,1288,3651,1312"/>
<area href="../../d6/db2/classSimpleRefineableRectangularQuadMesh.html" alt="SimpleRefineableRectangularQuadMesh&lt; ELEMENT &gt;" shape="rect" coords="3138,1344,3651,1368"/>
<area href="../../d6/db2/classSimpleRefineableRectangularQuadMesh.html" alt="SimpleRefineableRectangularQuadMesh&lt; ELEMENT &gt;" shape="rect" coords="3138,1400,3651,1424"/>
<area href="../../d1/d89/classTestRefineableRectangularQuadMesh.html" alt="TestRefineableRectangularQuadMesh&lt; ELEMENT &gt;" shape="rect" coords="3138,1456,3651,1480"/>
<area href="../../de/d68/classoomph_1_1ElasticRefineableRectangularQuadMesh.html" alt="oomph::ElasticRefineableRectangularQuadMesh&lt; ELEMENT &gt;" shape="rect" coords="3138,1512,3651,1536"/>
<area href="../../db/db2/classoomph_1_1MacroElementNodeUpdateRefineableChannelWithLeafletMesh.html" title="Refineable mesh with MacroElement-based node update." alt="oomph::MacroElementNodeUpdateRefineableChannelWithLeafletMesh&lt; ELEMENT &gt;" shape="rect" coords="3138,1568,3651,1592"/>
<area href="../../d4/de7/classoomph_1_1MacroElementNodeUpdateRefineableCollapsibleChannelMesh.html" alt="oomph::MacroElementNodeUpdateRefineableCollapsibleChannelMesh&lt; ELEMENT &gt;" shape="rect" coords="3138,1624,3651,1648"/>
<area href="../../d8/d38/classoomph_1_1MyRefineableAlgebraicCollapsibleChannelMesh.html" alt="oomph::MyRefineableAlgebraicCollapsibleChannelMesh&lt; ELEMENT &gt;" shape="rect" coords="3138,1680,3651,1704"/>
<area href="../../dc/d58/classoomph_1_1RefineableAlgebraicChannelWithLeafletMesh.html" title="Refineable version of algebraic ChannelWithLeafletMesh." alt="oomph::RefineableAlgebraicChannelWithLeafletMesh&lt; ELEMENT &gt;" shape="rect" coords="3138,1736,3651,1760"/>
<area href="../../d9/d26/classoomph_1_1RefineableAlgebraicCollapsibleChannelMesh.html" alt="oomph::RefineableAlgebraicCollapsibleChannelMesh&lt; ELEMENT &gt;" shape="rect" coords="3138,1792,3651,1816"/>
<area href="../../d1/dc1/classoomph_1_1RefineableAlgebraicCylinderWithFlagMesh.html" title="Refineable version of AlgebraicCylinderWithFlagMesh." alt="oomph::RefineableAlgebraicCylinderWithFlagMesh&lt; ELEMENT &gt;" shape="rect" coords="3138,1848,3651,1872"/>
<area href="../../d5/dba/classoomph_1_1RefineableAlgebraicFSIDrivenCavityMesh.html" alt="oomph::RefineableAlgebraicFSIDrivenCavityMesh&lt; ELEMENT &gt;" shape="rect" coords="3138,1904,3651,1928"/>
<area href="../../da/de4/classoomph_1_1RefineableBackwardStepQuadMesh.html" title="Refineable backward step mesh." alt="oomph::RefineableBackwardStepQuadMesh&lt; ELEMENT &gt;" shape="rect" coords="3138,1960,3651,1984"/>
<area href="../../d4/dae/classoomph_1_1RefineableChannelWithLeafletMesh.html" title="Refineable version of ChannelWithLeafletMesh." alt="oomph::RefineableChannelWithLeafletMesh&lt; ELEMENT &gt;" shape="rect" coords="3138,2016,3651,2040"/>
<area href="../../d2/d19/classoomph_1_1RefineableCollapsibleChannelMesh.html" alt="oomph::RefineableCollapsibleChannelMesh&lt; ELEMENT &gt;" shape="rect" coords="3138,2072,3651,2096"/>
<area href="../../d4/d79/classoomph_1_1RefineableCylinderWithFlagMesh.html" title="Refineable version of CylinderWithFlagMesh." alt="oomph::RefineableCylinderWithFlagMesh&lt; ELEMENT &gt;" shape="rect" coords="3138,2128,3651,2152"/>
<area href="../../d1/d82/classoomph_1_1RefineableFSIDrivenCavityMesh.html" alt="oomph::RefineableFSIDrivenCavityMesh&lt; ELEMENT &gt;" shape="rect" coords="3138,2184,3651,2208"/>
<area href="../../df/de1/classoomph_1_1RefineableFishMesh.html" alt="oomph::RefineableFishMesh&lt; ELEMENT &gt;" shape="rect" coords="3138,2240,3651,2264"/>
<area href="../../d3/d1e/classoomph_1_1RefineableFullCircleMesh.html" alt="oomph::RefineableFullCircleMesh&lt; ELEMENT &gt;" shape="rect" coords="3138,2296,3651,2320"/>
<area href="../../d7/d5d/classoomph_1_1RefineableHalfRectangleWithHoleMesh.html" alt="oomph::RefineableHalfRectangleWithHoleMesh&lt; ELEMENT &gt;" shape="rect" coords="3138,2352,3651,2376"/>
<area href="../../d7/d5d/classoomph_1_1RefineableHalfRectangleWithHoleMesh.html" alt="oomph::RefineableHalfRectangleWithHoleMesh&lt; ELEMENT &gt;" shape="rect" coords="3138,2408,3651,2432"/>
<area href="../../df/d9b/classoomph_1_1RefineableQuadFromTriangleMesh.html" title="Unstructured refineable QuadFromTriangleMesh." alt="oomph::RefineableQuadFromTriangleMesh&lt; ELEMENT &gt;" shape="rect" coords="3138,2464,3651,2488"/>
<area href="../../dc/d6a/classoomph_1_1RefineableQuadMeshWithMovingCylinder.html" title="My Mesh." alt="oomph::RefineableQuadMeshWithMovingCylinder&lt; ELEMENT &gt;" shape="rect" coords="3138,2520,3651,2544"/>
<area href="../../d3/d62/classoomph_1_1RefineableQuarterCircleSectorMesh.html" alt="oomph::RefineableQuarterCircleSectorMesh&lt; ELEMENT &gt;" shape="rect" coords="3138,2576,3651,2600"/>
<area href="../../db/d77/classoomph_1_1RefineableRectangleWithHoleAndAnnularRegionMesh.html" alt="oomph::RefineableRectangleWithHoleAndAnnularRegionMesh&lt; ELEMENT &gt;" shape="rect" coords="3138,2632,3651,2656"/>
<area href="../../d3/dee/classoomph_1_1RefineableRectangleWithHoleMesh.html" alt="oomph::RefineableRectangleWithHoleMesh&lt; ELEMENT &gt;" shape="rect" coords="3138,2688,3651,2712"/>
<area href="../../d4/deb/classoomph_1_1RefineableRectangularQuadMesh.html" alt="oomph::RefineableRectangularQuadMesh&lt; ELEMENT &gt;" shape="rect" coords="3138,2744,3651,2768"/>
<area href="../../d0/df6/classoomph_1_1RefineableTwoDAnnularMesh.html" alt="oomph::RefineableTwoDAnnularMesh&lt; ELEMENT &gt;" shape="rect" coords="3138,2800,3651,2824"/>
<area href="../../d2/d49/classoomph_1_1Refineable__r__mesh.html" title="My log r spaced mesh." alt="oomph::Refineable_r_mesh&lt; ELEMENT &gt;" shape="rect" coords="3138,2856,3651,2880"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aae094b3c6b773c0dbfbeba056c83eac6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#aae094b3c6b773c0dbfbeba056c83eac6">TreeBasedRefineableMeshBase</a> ()</td></tr>
<tr class="memdesc:aae094b3c6b773c0dbfbeba056c83eac6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#aae094b3c6b773c0dbfbeba056c83eac6">More...</a><br /></td></tr>
<tr class="separator:aae094b3c6b773c0dbfbeba056c83eac6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bd10419c1e0fba7742d486d3f4aa7a2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a8bd10419c1e0fba7742d486d3f4aa7a2">TreeBasedRefineableMeshBase</a> (const <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html">TreeBasedRefineableMeshBase</a> &amp;dummy)=delete</td></tr>
<tr class="memdesc:a8bd10419c1e0fba7742d486d3f4aa7a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken copy constructor.  <a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a8bd10419c1e0fba7742d486d3f4aa7a2">More...</a><br /></td></tr>
<tr class="separator:a8bd10419c1e0fba7742d486d3f4aa7a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82f482d65edc9de7a1b4ec6788c9596a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a82f482d65edc9de7a1b4ec6788c9596a">operator=</a> (const <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html">TreeBasedRefineableMeshBase</a> &amp;)=delete</td></tr>
<tr class="memdesc:a82f482d65edc9de7a1b4ec6788c9596a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken assignment operator.  <a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a82f482d65edc9de7a1b4ec6788c9596a">More...</a><br /></td></tr>
<tr class="separator:a82f482d65edc9de7a1b4ec6788c9596a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9edfe81d5b9fc03fbb98c5ff601a260"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#ab9edfe81d5b9fc03fbb98c5ff601a260">~TreeBasedRefineableMeshBase</a> ()</td></tr>
<tr class="memdesc:ab9edfe81d5b9fc03fbb98c5ff601a260"><td class="mdescLeft">&#160;</td><td class="mdescRight">Empty Destructor:  <a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#ab9edfe81d5b9fc03fbb98c5ff601a260">More...</a><br /></td></tr>
<tr class="separator:ab9edfe81d5b9fc03fbb98c5ff601a260"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac98d4120b99d5c6cbcf7225a9ee5648d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#ac98d4120b99d5c6cbcf7225a9ee5648d">adapt</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;elemental_error)</td></tr>
<tr class="separator:ac98d4120b99d5c6cbcf7225a9ee5648d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acec4254dc1b7c75870cfa0bd0c4e363e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#acec4254dc1b7c75870cfa0bd0c4e363e">p_adapt</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;elemental_error)</td></tr>
<tr class="separator:acec4254dc1b7c75870cfa0bd0c4e363e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae238476195a0ceeb2cdb680620fb97a3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#ae238476195a0ceeb2cdb680620fb97a3">refine_uniformly</a> (<a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> &amp;<a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>)</td></tr>
<tr class="memdesc:ae238476195a0ceeb2cdb680620fb97a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Refine mesh uniformly and doc process.  <a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#ae238476195a0ceeb2cdb680620fb97a3">More...</a><br /></td></tr>
<tr class="separator:ae238476195a0ceeb2cdb680620fb97a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e67b50fecb03fe1ac93dcb81e4ac6e9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a8e67b50fecb03fe1ac93dcb81e4ac6e9">refine_uniformly</a> ()</td></tr>
<tr class="memdesc:a8e67b50fecb03fe1ac93dcb81e4ac6e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Refine mesh uniformly.  <a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a8e67b50fecb03fe1ac93dcb81e4ac6e9">More...</a><br /></td></tr>
<tr class="separator:a8e67b50fecb03fe1ac93dcb81e4ac6e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a270d74e0e30f9956c85e4cdcc202c98b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a270d74e0e30f9956c85e4cdcc202c98b">p_refine_uniformly</a> (<a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> &amp;<a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>)</td></tr>
<tr class="memdesc:a270d74e0e30f9956c85e4cdcc202c98b"><td class="mdescLeft">&#160;</td><td class="mdescRight">p-refine mesh uniformly and doc process  <a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a270d74e0e30f9956c85e4cdcc202c98b">More...</a><br /></td></tr>
<tr class="separator:a270d74e0e30f9956c85e4cdcc202c98b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae922698aeb358f174c37dac5101c5369"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#ae922698aeb358f174c37dac5101c5369">p_refine_uniformly</a> ()</td></tr>
<tr class="memdesc:ae922698aeb358f174c37dac5101c5369"><td class="mdescLeft">&#160;</td><td class="mdescRight">p-refine mesh uniformly  <a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#ae922698aeb358f174c37dac5101c5369">More...</a><br /></td></tr>
<tr class="separator:ae922698aeb358f174c37dac5101c5369"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52940028ba9f6472df7e7c65be265057"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a52940028ba9f6472df7e7c65be265057">unrefine_uniformly</a> ()</td></tr>
<tr class="separator:a52940028ba9f6472df7e7c65be265057"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a937e4097d480ed921b86ec4a7e885df6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a937e4097d480ed921b86ec4a7e885df6">p_unrefine_uniformly</a> (<a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> &amp;<a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>)</td></tr>
<tr class="memdesc:a937e4097d480ed921b86ec4a7e885df6"><td class="mdescLeft">&#160;</td><td class="mdescRight">p-unrefine mesh uniformly  <a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a937e4097d480ed921b86ec4a7e885df6">More...</a><br /></td></tr>
<tr class="separator:a937e4097d480ed921b86ec4a7e885df6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab7cbaa680b2258f2b1eea5de6bbe605"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#aab7cbaa680b2258f2b1eea5de6bbe605">setup_tree_forest</a> ()=0</td></tr>
<tr class="memdesc:aab7cbaa680b2258f2b1eea5de6bbe605"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set up the tree forest associated with the Mesh (if any)  <a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#aab7cbaa680b2258f2b1eea5de6bbe605">More...</a><br /></td></tr>
<tr class="separator:aab7cbaa680b2258f2b1eea5de6bbe605"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c5084830a90bf527a27271613b858a7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d2/d36/classoomph_1_1TreeForest.html">TreeForest</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a3c5084830a90bf527a27271613b858a7">forest_pt</a> ()</td></tr>
<tr class="memdesc:a3c5084830a90bf527a27271613b858a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return pointer to the Forest represenation of the mesh.  <a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a3c5084830a90bf527a27271613b858a7">More...</a><br /></td></tr>
<tr class="separator:a3c5084830a90bf527a27271613b858a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a885171376e32cff058ab2fa4df6ca3c6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a885171376e32cff058ab2fa4df6ca3c6">doc_adaptivity_targets</a> (std::ostream &amp;outfile)</td></tr>
<tr class="memdesc:a885171376e32cff058ab2fa4df6ca3c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Doc the targets for mesh adaptation.  <a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a885171376e32cff058ab2fa4df6ca3c6">More...</a><br /></td></tr>
<tr class="separator:a885171376e32cff058ab2fa4df6ca3c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18bf22913dc5daf45fb3995d9ec30bfc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a18bf22913dc5daf45fb3995d9ec30bfc">max_refinement_level</a> ()</td></tr>
<tr class="memdesc:a18bf22913dc5daf45fb3995d9ec30bfc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access fct for max. permissible refinement level (relative to base mesh)  <a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a18bf22913dc5daf45fb3995d9ec30bfc">More...</a><br /></td></tr>
<tr class="separator:a18bf22913dc5daf45fb3995d9ec30bfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3974421171e1bb10daf6864f0749675"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#af3974421171e1bb10daf6864f0749675">min_refinement_level</a> ()</td></tr>
<tr class="memdesc:af3974421171e1bb10daf6864f0749675"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access fct for min. permissible refinement level (relative to base mesh)  <a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#af3974421171e1bb10daf6864f0749675">More...</a><br /></td></tr>
<tr class="separator:af3974421171e1bb10daf6864f0749675"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a957a33d2b7dd59f8789f4d0e9c6357c2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a957a33d2b7dd59f8789f4d0e9c6357c2">max_p_refinement_level</a> ()</td></tr>
<tr class="separator:a957a33d2b7dd59f8789f4d0e9c6357c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42486bb8abcb77663adc361eaa442a3b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a42486bb8abcb77663adc361eaa442a3b">min_p_refinement_level</a> ()</td></tr>
<tr class="separator:a42486bb8abcb77663adc361eaa442a3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acef8ac2f0f2cffe938031db1499c598b"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#acef8ac2f0f2cffe938031db1499c598b">adapt_mesh</a> (<a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> &amp;<a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>)</td></tr>
<tr class="separator:acef8ac2f0f2cffe938031db1499c598b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64608ddedb7eb56e11bee2805aa01360"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a64608ddedb7eb56e11bee2805aa01360">adapt_mesh</a> ()</td></tr>
<tr class="separator:a64608ddedb7eb56e11bee2805aa01360"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d714967dc71ba477c2ca807bbf6d6bd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a5d714967dc71ba477c2ca807bbf6d6bd">p_adapt_mesh</a> (<a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> &amp;<a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>)</td></tr>
<tr class="separator:a5d714967dc71ba477c2ca807bbf6d6bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae36ab5e807acc10ccc31a7886ffc040a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#ae36ab5e807acc10ccc31a7886ffc040a">p_adapt_mesh</a> ()</td></tr>
<tr class="separator:ae36ab5e807acc10ccc31a7886ffc040a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a171be4c171cc60de5831f6a2ffaf278e"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a171be4c171cc60de5831f6a2ffaf278e">refine_selected_elements</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;elements_to_be_refined)</td></tr>
<tr class="separator:a171be4c171cc60de5831f6a2ffaf278e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d88d6365af7f92bf766b73b115bcf3f"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a6d88d6365af7f92bf766b73b115bcf3f">refine_selected_elements</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../dc/d08/classoomph_1_1RefineableElement.html">RefineableElement</a> * &gt; &amp;elements_to_be_refined)</td></tr>
<tr class="separator:a6d88d6365af7f92bf766b73b115bcf3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8596076849247d63cadfe579fdc17d60"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a8596076849247d63cadfe579fdc17d60">p_refine_selected_elements</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;elements_to_be_refined)</td></tr>
<tr class="memdesc:a8596076849247d63cadfe579fdc17d60"><td class="mdescLeft">&#160;</td><td class="mdescRight">p-refine mesh by refining the elements identified by their numbers.  <a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a8596076849247d63cadfe579fdc17d60">More...</a><br /></td></tr>
<tr class="separator:a8596076849247d63cadfe579fdc17d60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a178431e8c17ca9784f6fdc2501404471"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a178431e8c17ca9784f6fdc2501404471">p_refine_selected_elements</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d3/d0c/classoomph_1_1PRefineableElement.html">PRefineableElement</a> * &gt; &amp;elements_to_be_refined_pt)</td></tr>
<tr class="memdesc:a178431e8c17ca9784f6fdc2501404471"><td class="mdescLeft">&#160;</td><td class="mdescRight">p-refine mesh by refining the elements identified by their pointers.  <a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a178431e8c17ca9784f6fdc2501404471">More...</a><br /></td></tr>
<tr class="separator:a178431e8c17ca9784f6fdc2501404471"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a69f5485eb426f6f60ed5a92db383a3"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a6a69f5485eb426f6f60ed5a92db383a3">refine_base_mesh_as_in_reference_mesh</a> (<a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html">TreeBasedRefineableMeshBase</a> *const &amp;ref_mesh_pt)</td></tr>
<tr class="memdesc:a6a69f5485eb426f6f60ed5a92db383a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Refine to same degree as the reference mesh.  <a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a6a69f5485eb426f6f60ed5a92db383a3">More...</a><br /></td></tr>
<tr class="separator:a6a69f5485eb426f6f60ed5a92db383a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6fc7cc7acf368423cc49cc10ab276bc"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#ae6fc7cc7acf368423cc49cc10ab276bc">refine_base_mesh_as_in_reference_mesh_minus_one</a> (<a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html">TreeBasedRefineableMeshBase</a> *const &amp;ref_mesh_pt)</td></tr>
<tr class="separator:ae6fc7cc7acf368423cc49cc10ab276bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7451ff312a3ac482b2f62ded020630c3"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a7451ff312a3ac482b2f62ded020630c3">refine_as_in_reference_mesh</a> (<a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html">TreeBasedRefineableMeshBase</a> *const &amp;ref_mesh_pt)</td></tr>
<tr class="separator:a7451ff312a3ac482b2f62ded020630c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a937e4321288b6642d5057498f7659d76"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a937e4321288b6642d5057498f7659d76">get_refinement_levels</a> (<a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#af3974421171e1bb10daf6864f0749675">min_refinement_level</a>, <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a18bf22913dc5daf45fb3995d9ec30bfc">max_refinement_level</a>)</td></tr>
<tr class="memdesc:a937e4321288b6642d5057498f7659d76"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get max/min refinement levels in mesh.  <a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a937e4321288b6642d5057498f7659d76">More...</a><br /></td></tr>
<tr class="separator:a937e4321288b6642d5057498f7659d76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d5d1cfce0db7953c21eef213049c433"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a0d5d1cfce0db7953c21eef213049c433">get_elements_at_refinement_level</a> (<a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;refinement_level, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../dc/d08/classoomph_1_1RefineableElement.html">RefineableElement</a> * &gt; &amp;level_elements)</td></tr>
<tr class="separator:a0d5d1cfce0db7953c21eef213049c433"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae61cbe29fa2aa644af32e73854d5cab3"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#ae61cbe29fa2aa644af32e73854d5cab3">get_refinement_pattern</a> (<a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt;&gt; &amp;to_be_refined)</td></tr>
<tr class="separator:ae61cbe29fa2aa644af32e73854d5cab3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13548e57b680c5e7466d1deeb8f12ff0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a13548e57b680c5e7466d1deeb8f12ff0">refine_base_mesh</a> (<a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt;&gt; &amp;to_be_refined)</td></tr>
<tr class="memdesc:a13548e57b680c5e7466d1deeb8f12ff0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Refine base mesh according to specified refinement pattern.  <a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a13548e57b680c5e7466d1deeb8f12ff0">More...</a><br /></td></tr>
<tr class="separator:a13548e57b680c5e7466d1deeb8f12ff0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5753ea33897c77342d00644bef86ba74"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a5753ea33897c77342d00644bef86ba74">refine</a> (std::ifstream &amp;restart_file)</td></tr>
<tr class="memdesc:a5753ea33897c77342d00644bef86ba74"><td class="mdescLeft">&#160;</td><td class="mdescRight">Refine mesh according to refinement pattern in restart file.  <a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a5753ea33897c77342d00644bef86ba74">More...</a><br /></td></tr>
<tr class="separator:a5753ea33897c77342d00644bef86ba74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2398683f533e5ba0960fbbe9ff545fb2"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a2398683f533e5ba0960fbbe9ff545fb2">dump_refinement</a> (std::ostream &amp;outfile)</td></tr>
<tr class="memdesc:a2398683f533e5ba0960fbbe9ff545fb2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dump refinement pattern to allow for rebuild.  <a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a2398683f533e5ba0960fbbe9ff545fb2">More...</a><br /></td></tr>
<tr class="separator:a2398683f533e5ba0960fbbe9ff545fb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a429d5beeb3c44d4310647c805883ea30"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a429d5beeb3c44d4310647c805883ea30">read_refinement</a> (std::ifstream &amp;restart_file, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt;&gt; &amp;to_be_refined)</td></tr>
<tr class="memdesc:a429d5beeb3c44d4310647c805883ea30"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read refinement pattern to allow for rebuild.  <a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a429d5beeb3c44d4310647c805883ea30">More...</a><br /></td></tr>
<tr class="separator:a429d5beeb3c44d4310647c805883ea30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ee27bd5bd3c2eded38103b9161af719"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a1ee27bd5bd3c2eded38103b9161af719">uniform_refinement_level_when_pruned</a> () const</td></tr>
<tr class="separator:a1ee27bd5bd3c2eded38103b9161af719"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7514c207f648191b11b70319e1c978d5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a7514c207f648191b11b70319e1c978d5">uniform_refinement_level_when_pruned</a> ()</td></tr>
<tr class="memdesc:a7514c207f648191b11b70319e1c978d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Level to which the mesh was uniformly refined when it was pruned.  <a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a7514c207f648191b11b70319e1c978d5">More...</a><br /></td></tr>
<tr class="separator:a7514c207f648191b11b70319e1c978d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classoomph_1_1RefineableMeshBase"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classoomph_1_1RefineableMeshBase')"><img src="../../closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html">oomph::RefineableMeshBase</a></td></tr>
<tr class="memitem:a82b2d84c2845092acb3714336f65f72d inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a82b2d84c2845092acb3714336f65f72d">adapt_flag</a> ()</td></tr>
<tr class="separator:a82b2d84c2845092acb3714336f65f72d inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b6e95347d4ffcc916c3d760f6e94a89 inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a2b6e95347d4ffcc916c3d760f6e94a89">RefineableMeshBase</a> ()</td></tr>
<tr class="separator:a2b6e95347d4ffcc916c3d760f6e94a89 inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac31f0d79a35d67c17bade2b159bba8ae inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#ac31f0d79a35d67c17bade2b159bba8ae">RefineableMeshBase</a> (const <a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html">RefineableMeshBase</a> &amp;dummy)=delete</td></tr>
<tr class="memdesc:ac31f0d79a35d67c17bade2b159bba8ae inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken copy constructor.  <a href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#ac31f0d79a35d67c17bade2b159bba8ae">More...</a><br /></td></tr>
<tr class="separator:ac31f0d79a35d67c17bade2b159bba8ae inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ffad5fbd808b8ba49f9256381f9be6d inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a2ffad5fbd808b8ba49f9256381f9be6d">operator=</a> (const <a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html">RefineableMeshBase</a> &amp;)=delete</td></tr>
<tr class="memdesc:a2ffad5fbd808b8ba49f9256381f9be6d inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken assignment operator.  <a href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a2ffad5fbd808b8ba49f9256381f9be6d">More...</a><br /></td></tr>
<tr class="separator:a2ffad5fbd808b8ba49f9256381f9be6d inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace69036132a97dd34dc9969a0db5b502 inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#ace69036132a97dd34dc9969a0db5b502">~RefineableMeshBase</a> ()</td></tr>
<tr class="memdesc:ace69036132a97dd34dc9969a0db5b502 inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Empty Destructor:  <a href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#ace69036132a97dd34dc9969a0db5b502">More...</a><br /></td></tr>
<tr class="separator:ace69036132a97dd34dc9969a0db5b502 inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc1285956019d530610a3d9e0ff770e8 inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#abc1285956019d530610a3d9e0ff770e8">nrefined</a> ()</td></tr>
<tr class="memdesc:abc1285956019d530610a3d9e0ff770e8 inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access fct for number of elements that were refined.  <a href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#abc1285956019d530610a3d9e0ff770e8">More...</a><br /></td></tr>
<tr class="separator:abc1285956019d530610a3d9e0ff770e8 inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d3d3c72721e97e4fa24e1d7dc13f2b5 inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a1d3d3c72721e97e4fa24e1d7dc13f2b5">nunrefined</a> ()</td></tr>
<tr class="memdesc:a1d3d3c72721e97e4fa24e1d7dc13f2b5 inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access fct for number of elements that were unrefined.  <a href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a1d3d3c72721e97e4fa24e1d7dc13f2b5">More...</a><br /></td></tr>
<tr class="separator:a1d3d3c72721e97e4fa24e1d7dc13f2b5 inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af189058782c7217f6d29a6f9555e7c3d inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#af189058782c7217f6d29a6f9555e7c3d">nrefinement_overruled</a> ()</td></tr>
<tr class="separator:af189058782c7217f6d29a6f9555e7c3d inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2216b4d0a8433a1975e6990a5e6533f7 inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a2216b4d0a8433a1975e6990a5e6533f7">max_keep_unrefined</a> ()</td></tr>
<tr class="separator:a2216b4d0a8433a1975e6990a5e6533f7 inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8bb7a00156a9ddc54bdfccc988fd413 inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/dab/classoomph_1_1ErrorEstimator.html">ErrorEstimator</a> *&amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#af8bb7a00156a9ddc54bdfccc988fd413">spatial_error_estimator_pt</a> ()</td></tr>
<tr class="memdesc:af8bb7a00156a9ddc54bdfccc988fd413 inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access to spatial error estimator.  <a href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#af8bb7a00156a9ddc54bdfccc988fd413">More...</a><br /></td></tr>
<tr class="separator:af8bb7a00156a9ddc54bdfccc988fd413 inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3acbda3faa159eaa9a2889af8a432175 inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/dab/classoomph_1_1ErrorEstimator.html">ErrorEstimator</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a3acbda3faa159eaa9a2889af8a432175">spatial_error_estimator_pt</a> () const</td></tr>
<tr class="memdesc:a3acbda3faa159eaa9a2889af8a432175 inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access to spatial error estimator (const version.  <a href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a3acbda3faa159eaa9a2889af8a432175">More...</a><br /></td></tr>
<tr class="separator:a3acbda3faa159eaa9a2889af8a432175 inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3a13bfaf687135d0154ce2f9b60edb7 inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#ad3a13bfaf687135d0154ce2f9b60edb7">min_permitted_error</a> ()</td></tr>
<tr class="separator:ad3a13bfaf687135d0154ce2f9b60edb7 inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb5ba9ac30bf0a0683eb30f5703800e4 inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#adb5ba9ac30bf0a0683eb30f5703800e4">max_permitted_error</a> ()</td></tr>
<tr class="separator:adb5ba9ac30bf0a0683eb30f5703800e4 inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60baf0add6d015ca4248622ce21ae09f inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a60baf0add6d015ca4248622ce21ae09f">min_error</a> ()</td></tr>
<tr class="separator:a60baf0add6d015ca4248622ce21ae09f inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d7689918a098ce597c3d4fc716a0727 inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a8d7689918a098ce597c3d4fc716a0727">max_error</a> ()</td></tr>
<tr class="separator:a8d7689918a098ce597c3d4fc716a0727 inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a706216900b53bc7d9214e1f982e69309 inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> *&amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a706216900b53bc7d9214e1f982e69309">doc_info_pt</a> ()</td></tr>
<tr class="memdesc:a706216900b53bc7d9214e1f982e69309 inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access fct for pointer to DocInfo.  <a href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a706216900b53bc7d9214e1f982e69309">More...</a><br /></td></tr>
<tr class="separator:a706216900b53bc7d9214e1f982e69309 inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a369a915c290a07f1b43efabc5af272f2 inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a369a915c290a07f1b43efabc5af272f2">enable_adaptation</a> ()</td></tr>
<tr class="memdesc:a369a915c290a07f1b43efabc5af272f2 inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enable adaptation.  <a href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a369a915c290a07f1b43efabc5af272f2">More...</a><br /></td></tr>
<tr class="separator:a369a915c290a07f1b43efabc5af272f2 inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7bdb132c6562c922ddbc1e152b6e9d73 inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a7bdb132c6562c922ddbc1e152b6e9d73">disable_adaptation</a> ()</td></tr>
<tr class="memdesc:a7bdb132c6562c922ddbc1e152b6e9d73 inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Disable adaptation.  <a href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a7bdb132c6562c922ddbc1e152b6e9d73">More...</a><br /></td></tr>
<tr class="separator:a7bdb132c6562c922ddbc1e152b6e9d73 inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c0bd748288c580dfaee4f865ac6dd36 inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a1c0bd748288c580dfaee4f865ac6dd36">enable_p_adaptation</a> ()</td></tr>
<tr class="memdesc:a1c0bd748288c580dfaee4f865ac6dd36 inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enable adaptation.  <a href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a1c0bd748288c580dfaee4f865ac6dd36">More...</a><br /></td></tr>
<tr class="separator:a1c0bd748288c580dfaee4f865ac6dd36 inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7265c7cdcf5ac2c9a043739eb9497aec inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a7265c7cdcf5ac2c9a043739eb9497aec">disable_p_adaptation</a> ()</td></tr>
<tr class="memdesc:a7265c7cdcf5ac2c9a043739eb9497aec inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Disable adaptation.  <a href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a7265c7cdcf5ac2c9a043739eb9497aec">More...</a><br /></td></tr>
<tr class="separator:a7265c7cdcf5ac2c9a043739eb9497aec inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84fbc9d2a8f30d80ea1cf8b3ddd1780e inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a84fbc9d2a8f30d80ea1cf8b3ddd1780e">enable_additional_synchronisation_of_hanging_nodes</a> ()</td></tr>
<tr class="memdesc:a84fbc9d2a8f30d80ea1cf8b3ddd1780e inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enable additional synchronisation of hanging nodes.  <a href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a84fbc9d2a8f30d80ea1cf8b3ddd1780e">More...</a><br /></td></tr>
<tr class="separator:a84fbc9d2a8f30d80ea1cf8b3ddd1780e inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5d1de773c7941afa18ee9fee35f1c4f inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#ad5d1de773c7941afa18ee9fee35f1c4f">disable_additional_synchronisation_of_hanging_nodes</a> ()</td></tr>
<tr class="memdesc:ad5d1de773c7941afa18ee9fee35f1c4f inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Disable additional synchronisation of hanging nodes.  <a href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#ad5d1de773c7941afa18ee9fee35f1c4f">More...</a><br /></td></tr>
<tr class="separator:ad5d1de773c7941afa18ee9fee35f1c4f inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95936de8451623e899f26a80c7b056b5 inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a95936de8451623e899f26a80c7b056b5">is_adaptation_enabled</a> () const</td></tr>
<tr class="memdesc:a95936de8451623e899f26a80c7b056b5 inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return whether the mesh is to be adapted.  <a href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a95936de8451623e899f26a80c7b056b5">More...</a><br /></td></tr>
<tr class="separator:a95936de8451623e899f26a80c7b056b5 inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e85bf51c80e88bfc505ddb40115af4f inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a9e85bf51c80e88bfc505ddb40115af4f">is_p_adaptation_enabled</a> () const</td></tr>
<tr class="memdesc:a9e85bf51c80e88bfc505ddb40115af4f inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return whether the mesh is to be adapted.  <a href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a9e85bf51c80e88bfc505ddb40115af4f">More...</a><br /></td></tr>
<tr class="separator:a9e85bf51c80e88bfc505ddb40115af4f inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87ba874aa6fd4bcd80bcffd2fa0465da inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a87ba874aa6fd4bcd80bcffd2fa0465da">is_additional_synchronisation_of_hanging_nodes_disabled</a> () const</td></tr>
<tr class="memdesc:a87ba874aa6fd4bcd80bcffd2fa0465da inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return whether additional synchronisation is enabled.  <a href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a87ba874aa6fd4bcd80bcffd2fa0465da">More...</a><br /></td></tr>
<tr class="separator:a87ba874aa6fd4bcd80bcffd2fa0465da inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a266f8b2a1499cc2ae7b24b19813923ee inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a> ()</td></tr>
<tr class="memdesc:a266f8b2a1499cc2ae7b24b19813923ee inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access fct for DocInfo.  <a href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">More...</a><br /></td></tr>
<tr class="separator:a266f8b2a1499cc2ae7b24b19813923ee inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a59e7e2e6caac875091a15e79487953 inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a6a59e7e2e6caac875091a15e79487953">p_unrefine_uniformly</a> (<a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> &amp;<a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>)</td></tr>
<tr class="memdesc:a6a59e7e2e6caac875091a15e79487953 inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">p-unrefine mesh uniformly  <a href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a6a59e7e2e6caac875091a15e79487953">More...</a><br /></td></tr>
<tr class="separator:a6a59e7e2e6caac875091a15e79487953 inherit pub_methods_classoomph_1_1RefineableMeshBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classoomph_1_1Mesh"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classoomph_1_1Mesh')"><img src="../../closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">oomph::Mesh</a></td></tr>
<tr class="memitem:aa4a64cb23aa881dbd67c1b633173494f inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#aa4a64cb23aa881dbd67c1b633173494f">Mesh</a> ()</td></tr>
<tr class="memdesc:aa4a64cb23aa881dbd67c1b633173494f inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default constructor.  <a href="../../d6/db8/classoomph_1_1Mesh.html#aa4a64cb23aa881dbd67c1b633173494f">More...</a><br /></td></tr>
<tr class="separator:aa4a64cb23aa881dbd67c1b633173494f inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc3c2f1fe3de3b6e7484eb65eb03efa3 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#afc3c2f1fe3de3b6e7484eb65eb03efa3">Mesh</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> * &gt; &amp;sub_mesh_pt)</td></tr>
<tr class="separator:afc3c2f1fe3de3b6e7484eb65eb03efa3 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4e77a5529b2aabfed8289e313c1c8d9 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af4e77a5529b2aabfed8289e313c1c8d9">merge_meshes</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> * &gt; &amp;sub_mesh_pt)</td></tr>
<tr class="separator:af4e77a5529b2aabfed8289e313c1c8d9 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cc8bcd6b41209f0e9295cc993d9c6bb inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a6cc8bcd6b41209f0e9295cc993d9c6bb">setup_boundary_element_info</a> ()</td></tr>
<tr class="separator:a6cc8bcd6b41209f0e9295cc993d9c6bb inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a413cbcbea4fb1111703da9ee97429640 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a413cbcbea4fb1111703da9ee97429640">setup_boundary_element_info</a> (std::ostream &amp;outfile)</td></tr>
<tr class="separator:a413cbcbea4fb1111703da9ee97429640 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac481de51900d57248dd601b53816891f inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ac481de51900d57248dd601b53816891f">reset_boundary_element_info</a> (<a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;ntmp_boundary_elements, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt;&gt; &amp;ntmp_boundary_elements_in_region, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html">FiniteElement</a> * &gt; &amp;deleted_elements)</td></tr>
<tr class="memdesc:ac481de51900d57248dd601b53816891f inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Virtual function to perform the reset boundary elements info rutines.  <a href="../../d6/db8/classoomph_1_1Mesh.html#ac481de51900d57248dd601b53816891f">More...</a><br /></td></tr>
<tr class="separator:ac481de51900d57248dd601b53816891f inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68cad622b3fe39d306fe367d0fdf4083 inherit pub_methods_classoomph_1_1Mesh"><td class="memTemplParams" colspan="2">template&lt;class BULK_ELEMENT &gt; </td></tr>
<tr class="memitem:a68cad622b3fe39d306fe367d0fdf4083 inherit pub_methods_classoomph_1_1Mesh"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a68cad622b3fe39d306fe367d0fdf4083">doc_boundary_coordinates</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#a9d82f3af1459c1efc910b77f3ccd3180">b</a>, std::ofstream &amp;the_file)</td></tr>
<tr class="separator:a68cad622b3fe39d306fe367d0fdf4083 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e0d761fca70b856185b7b9b2168663d inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a7e0d761fca70b856185b7b9b2168663d">scale_mesh</a> (const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;factor)</td></tr>
<tr class="separator:a7e0d761fca70b856185b7b9b2168663d inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9e74914296faa6a2d1a2a03503eee2e inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ae9e74914296faa6a2d1a2a03503eee2e">Mesh</a> (const <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> &amp;dummy)=delete</td></tr>
<tr class="memdesc:ae9e74914296faa6a2d1a2a03503eee2e inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken copy constructor.  <a href="../../d6/db8/classoomph_1_1Mesh.html#ae9e74914296faa6a2d1a2a03503eee2e">More...</a><br /></td></tr>
<tr class="separator:ae9e74914296faa6a2d1a2a03503eee2e inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1247fdbb0529b36de0ace7f16b4e70a inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ab1247fdbb0529b36de0ace7f16b4e70a">operator=</a> (const <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> &amp;)=delete</td></tr>
<tr class="memdesc:ab1247fdbb0529b36de0ace7f16b4e70a inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken assignment operator.  <a href="../../d6/db8/classoomph_1_1Mesh.html#ab1247fdbb0529b36de0ace7f16b4e70a">More...</a><br /></td></tr>
<tr class="separator:ab1247fdbb0529b36de0ace7f16b4e70a inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc071afb5c34ca6ced42734030f81353 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#abc071afb5c34ca6ced42734030f81353">~Mesh</a> ()</td></tr>
<tr class="memdesc:abc071afb5c34ca6ced42734030f81353 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Virtual Destructor to clean up all memory.  <a href="../../d6/db8/classoomph_1_1Mesh.html#abc071afb5c34ca6ced42734030f81353">More...</a><br /></td></tr>
<tr class="separator:abc071afb5c34ca6ced42734030f81353 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38446e721be2f75a64fdaa025b7c23ad inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a38446e721be2f75a64fdaa025b7c23ad">flush_element_and_node_storage</a> ()</td></tr>
<tr class="separator:a38446e721be2f75a64fdaa025b7c23ad inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3def47aa1e0028970a250d9c534e93b2 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a3def47aa1e0028970a250d9c534e93b2">flush_element_storage</a> ()</td></tr>
<tr class="separator:a3def47aa1e0028970a250d9c534e93b2 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4773924237488f46fe5ad3fe49138f0 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ab4773924237488f46fe5ad3fe49138f0">flush_node_storage</a> ()</td></tr>
<tr class="separator:ab4773924237488f46fe5ad3fe49138f0 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3c2b72c8ef4e9fd35f5998a5e7dc93b inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/db7/classoomph_1_1Node.html">Node</a> *&amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">node_pt</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long &amp;<a class="el" href="../../d5/d24/level2__real__impl_8h.html#a1224f27e9a621d957f8124bcade25bed">n</a>)</td></tr>
<tr class="memdesc:ab3c2b72c8ef4e9fd35f5998a5e7dc93b inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return pointer to global node n.  <a href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">More...</a><br /></td></tr>
<tr class="separator:ab3c2b72c8ef4e9fd35f5998a5e7dc93b inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a468ab976a9df7c1eb5bade6405a96a72 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/db7/classoomph_1_1Node.html">Node</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a468ab976a9df7c1eb5bade6405a96a72">node_pt</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long &amp;<a class="el" href="../../d5/d24/level2__real__impl_8h.html#a1224f27e9a621d957f8124bcade25bed">n</a>) const</td></tr>
<tr class="memdesc:a468ab976a9df7c1eb5bade6405a96a72 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return pointer to global node n (const version)  <a href="../../d6/db8/classoomph_1_1Mesh.html#a468ab976a9df7c1eb5bade6405a96a72">More...</a><br /></td></tr>
<tr class="separator:a468ab976a9df7c1eb5bade6405a96a72 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a876faf1f87b24b220ea21a38d6adde5b inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html">GeneralisedElement</a> *&amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">element_pt</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long &amp;<a class="el" href="../../db/de3/Cwise__scalar__power__array_8cpp.html#abfa88ee95cd5e1c8d923f1b21740ece4">e</a>)</td></tr>
<tr class="memdesc:a876faf1f87b24b220ea21a38d6adde5b inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return pointer to element e.  <a href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">More...</a><br /></td></tr>
<tr class="separator:a876faf1f87b24b220ea21a38d6adde5b inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f6428fbd6cb234d04bcef7f1e4fd703 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html">GeneralisedElement</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a3f6428fbd6cb234d04bcef7f1e4fd703">element_pt</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long &amp;<a class="el" href="../../db/de3/Cwise__scalar__power__array_8cpp.html#abfa88ee95cd5e1c8d923f1b21740ece4">e</a>) const</td></tr>
<tr class="memdesc:a3f6428fbd6cb234d04bcef7f1e4fd703 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return pointer to element e (const version)  <a href="../../d6/db8/classoomph_1_1Mesh.html#a3f6428fbd6cb234d04bcef7f1e4fd703">More...</a><br /></td></tr>
<tr class="separator:a3f6428fbd6cb234d04bcef7f1e4fd703 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab28b03dabf4e247c4a25f834eb11b339 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html">GeneralisedElement</a> * &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ab28b03dabf4e247c4a25f834eb11b339">element_pt</a> () const</td></tr>
<tr class="memdesc:ab28b03dabf4e247c4a25f834eb11b339 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return reference to the Vector of elements.  <a href="../../d6/db8/classoomph_1_1Mesh.html#ab28b03dabf4e247c4a25f834eb11b339">More...</a><br /></td></tr>
<tr class="separator:ab28b03dabf4e247c4a25f834eb11b339 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a669f0cea59f1b60a5e59176c91340ed9 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html">GeneralisedElement</a> * &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a669f0cea59f1b60a5e59176c91340ed9">element_pt</a> ()</td></tr>
<tr class="memdesc:a669f0cea59f1b60a5e59176c91340ed9 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return reference to the Vector of elements.  <a href="../../d6/db8/classoomph_1_1Mesh.html#a669f0cea59f1b60a5e59176c91340ed9">More...</a><br /></td></tr>
<tr class="separator:a669f0cea59f1b60a5e59176c91340ed9 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f274774435e9454bf77bf70de69367a inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html">FiniteElement</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a4f274774435e9454bf77bf70de69367a">finite_element_pt</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../db/de3/Cwise__scalar__power__array_8cpp.html#abfa88ee95cd5e1c8d923f1b21740ece4">e</a>) const</td></tr>
<tr class="separator:a4f274774435e9454bf77bf70de69367a inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca0a21f4eab2d6fe8c7fa011b5c33c3c inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/db7/classoomph_1_1Node.html">Node</a> *&amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#aca0a21f4eab2d6fe8c7fa011b5c33c3c">boundary_node_pt</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#a9d82f3af1459c1efc910b77f3ccd3180">b</a>, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d5/d24/level2__real__impl_8h.html#a1224f27e9a621d957f8124bcade25bed">n</a>)</td></tr>
<tr class="memdesc:aca0a21f4eab2d6fe8c7fa011b5c33c3c inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return pointer to node n on boundary b.  <a href="../../d6/db8/classoomph_1_1Mesh.html#aca0a21f4eab2d6fe8c7fa011b5c33c3c">More...</a><br /></td></tr>
<tr class="separator:aca0a21f4eab2d6fe8c7fa011b5c33c3c inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ab2bf2cf4cca88b7a972d1a659c7e5a inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/db7/classoomph_1_1Node.html">Node</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a0ab2bf2cf4cca88b7a972d1a659c7e5a">boundary_node_pt</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#a9d82f3af1459c1efc910b77f3ccd3180">b</a>, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d5/d24/level2__real__impl_8h.html#a1224f27e9a621d957f8124bcade25bed">n</a>) const</td></tr>
<tr class="memdesc:a0ab2bf2cf4cca88b7a972d1a659c7e5a inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return pointer to node n on boundary b.  <a href="../../d6/db8/classoomph_1_1Mesh.html#a0ab2bf2cf4cca88b7a972d1a659c7e5a">More...</a><br /></td></tr>
<tr class="separator:a0ab2bf2cf4cca88b7a972d1a659c7e5a inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6667f4ddc6e9357a9a7d53160db8161e inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a6667f4ddc6e9357a9a7d53160db8161e">set_nboundary</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;nbound)</td></tr>
<tr class="memdesc:a6667f4ddc6e9357a9a7d53160db8161e inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the number of boundaries in the mesh.  <a href="../../d6/db8/classoomph_1_1Mesh.html#a6667f4ddc6e9357a9a7d53160db8161e">More...</a><br /></td></tr>
<tr class="separator:a6667f4ddc6e9357a9a7d53160db8161e inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d86e14d55a1162e184bd7fac4630904 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a8d86e14d55a1162e184bd7fac4630904">remove_boundary_nodes</a> ()</td></tr>
<tr class="memdesc:a8d86e14d55a1162e184bd7fac4630904 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clear all pointers to boundary nodes.  <a href="../../d6/db8/classoomph_1_1Mesh.html#a8d86e14d55a1162e184bd7fac4630904">More...</a><br /></td></tr>
<tr class="separator:a8d86e14d55a1162e184bd7fac4630904 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bf720135d0728907b98c5d31157f569 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a5bf720135d0728907b98c5d31157f569">remove_boundary_nodes</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#a9d82f3af1459c1efc910b77f3ccd3180">b</a>)</td></tr>
<tr class="separator:a5bf720135d0728907b98c5d31157f569 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1690e5351ff05b5e47db184f64b1edc4 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a1690e5351ff05b5e47db184f64b1edc4">remove_boundary_node</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#a9d82f3af1459c1efc910b77f3ccd3180">b</a>, <a class="el" href="../../dc/db7/classoomph_1_1Node.html">Node</a> *const &amp;<a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">node_pt</a>)</td></tr>
<tr class="memdesc:a1690e5351ff05b5e47db184f64b1edc4 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove a node from the boundary b.  <a href="../../d6/db8/classoomph_1_1Mesh.html#a1690e5351ff05b5e47db184f64b1edc4">More...</a><br /></td></tr>
<tr class="separator:a1690e5351ff05b5e47db184f64b1edc4 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a007b102ac8e42328872ad658d7110bfc inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a007b102ac8e42328872ad658d7110bfc">add_boundary_node</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#a9d82f3af1459c1efc910b77f3ccd3180">b</a>, <a class="el" href="../../dc/db7/classoomph_1_1Node.html">Node</a> *const &amp;<a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">node_pt</a>)</td></tr>
<tr class="memdesc:a007b102ac8e42328872ad658d7110bfc inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a (pointer to) a node to the b-th boundary.  <a href="../../d6/db8/classoomph_1_1Mesh.html#a007b102ac8e42328872ad658d7110bfc">More...</a><br /></td></tr>
<tr class="separator:a007b102ac8e42328872ad658d7110bfc inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67b93ac3809bcc1fe3220c46f417682f inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a67b93ac3809bcc1fe3220c46f417682f">copy_boundary_node_data_from_nodes</a> ()</td></tr>
<tr class="separator:a67b93ac3809bcc1fe3220c46f417682f inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1b124a959628aba00162b89617b3a62 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ad1b124a959628aba00162b89617b3a62">boundary_coordinate_exists</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>) const</td></tr>
<tr class="memdesc:ad1b124a959628aba00162b89617b3a62 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Indicate whether the i-th boundary has an intrinsic coordinate.  <a href="../../d6/db8/classoomph_1_1Mesh.html#ad1b124a959628aba00162b89617b3a62">More...</a><br /></td></tr>
<tr class="separator:ad1b124a959628aba00162b89617b3a62 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af01dfefb66c15579b540be62999d93ee inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">nelement</a> () const</td></tr>
<tr class="memdesc:af01dfefb66c15579b540be62999d93ee inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return number of elements in the mesh.  <a href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">More...</a><br /></td></tr>
<tr class="separator:af01dfefb66c15579b540be62999d93ee inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a945e7823d1a2af243b5b7f7866aaff5e inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a945e7823d1a2af243b5b7f7866aaff5e">nnode</a> () const</td></tr>
<tr class="memdesc:a945e7823d1a2af243b5b7f7866aaff5e inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return number of nodes in the mesh.  <a href="../../d6/db8/classoomph_1_1Mesh.html#a945e7823d1a2af243b5b7f7866aaff5e">More...</a><br /></td></tr>
<tr class="separator:a945e7823d1a2af243b5b7f7866aaff5e inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16225f0094eeb234460f6cf963099c85 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a16225f0094eeb234460f6cf963099c85">ndof_types</a> () const</td></tr>
<tr class="memdesc:a16225f0094eeb234460f6cf963099c85 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return number of dof types in mesh.  <a href="../../d6/db8/classoomph_1_1Mesh.html#a16225f0094eeb234460f6cf963099c85">More...</a><br /></td></tr>
<tr class="separator:a16225f0094eeb234460f6cf963099c85 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a700a3c461df1c52534d7f6e303a0ebb6 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a700a3c461df1c52534d7f6e303a0ebb6">elemental_dimension</a> () const</td></tr>
<tr class="memdesc:a700a3c461df1c52534d7f6e303a0ebb6 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return number of elemental dimension in mesh.  <a href="../../d6/db8/classoomph_1_1Mesh.html#a700a3c461df1c52534d7f6e303a0ebb6">More...</a><br /></td></tr>
<tr class="separator:a700a3c461df1c52534d7f6e303a0ebb6 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32c8d3d454d3ba912b04985cb63e6a3c inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a32c8d3d454d3ba912b04985cb63e6a3c">nodal_dimension</a> () const</td></tr>
<tr class="memdesc:a32c8d3d454d3ba912b04985cb63e6a3c inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return number of nodal dimension in mesh.  <a href="../../d6/db8/classoomph_1_1Mesh.html#a32c8d3d454d3ba912b04985cb63e6a3c">More...</a><br /></td></tr>
<tr class="separator:a32c8d3d454d3ba912b04985cb63e6a3c inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac09a9bfeb6d70d8bbefe13c86948a6fc inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ac09a9bfeb6d70d8bbefe13c86948a6fc">add_node_pt</a> (<a class="el" href="../../dc/db7/classoomph_1_1Node.html">Node</a> *const &amp;<a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">node_pt</a>)</td></tr>
<tr class="memdesc:ac09a9bfeb6d70d8bbefe13c86948a6fc inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a (pointer to a) node to the mesh.  <a href="../../d6/db8/classoomph_1_1Mesh.html#ac09a9bfeb6d70d8bbefe13c86948a6fc">More...</a><br /></td></tr>
<tr class="separator:ac09a9bfeb6d70d8bbefe13c86948a6fc inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafc35b5df26c448b5d5ab26a793eee35 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#aafc35b5df26c448b5d5ab26a793eee35">add_element_pt</a> (<a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html">GeneralisedElement</a> *const &amp;<a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">element_pt</a>)</td></tr>
<tr class="memdesc:aafc35b5df26c448b5d5ab26a793eee35 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a (pointer to) an element to the mesh.  <a href="../../d6/db8/classoomph_1_1Mesh.html#aafc35b5df26c448b5d5ab26a793eee35">More...</a><br /></td></tr>
<tr class="separator:aafc35b5df26c448b5d5ab26a793eee35 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95bf112e5e1b3892e70a41f91b3cc523 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a95bf112e5e1b3892e70a41f91b3cc523">node_update</a> (const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;update_all_solid_nodes=false)</td></tr>
<tr class="separator:a95bf112e5e1b3892e70a41f91b3cc523 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a801e77424d1bf8a35c9bba055230f1e3 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a801e77424d1bf8a35c9bba055230f1e3">reorder_nodes</a> (const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;use_old_ordering=true)</td></tr>
<tr class="separator:a801e77424d1bf8a35c9bba055230f1e3 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af191bd67272f0ca8ec389bdc233140fd inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af191bd67272f0ca8ec389bdc233140fd">get_node_reordering</a> (<a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../dc/db7/classoomph_1_1Node.html">Node</a> * &gt; &amp;reordering, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;use_old_ordering=true) const</td></tr>
<tr class="separator:af191bd67272f0ca8ec389bdc233140fd inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93e1758501aeea3328291571ce501029 inherit pub_methods_classoomph_1_1Mesh"><td class="memTemplParams" colspan="2">template&lt;class BULK_ELEMENT , template&lt; class &gt; class FACE_ELEMENT&gt; </td></tr>
<tr class="memitem:a93e1758501aeea3328291571ce501029 inherit pub_methods_classoomph_1_1Mesh"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a93e1758501aeea3328291571ce501029">build_face_mesh</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#a9d82f3af1459c1efc910b77f3ccd3180">b</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;face_mesh_pt)</td></tr>
<tr class="separator:a93e1758501aeea3328291571ce501029 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac713e5a9cbd8b21907d39df493d6bfc9 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ac713e5a9cbd8b21907d39df493d6bfc9">self_test</a> ()</td></tr>
<tr class="memdesc:ac713e5a9cbd8b21907d39df493d6bfc9 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Self-test: Check elements and nodes. Return 0 for OK.  <a href="../../d6/db8/classoomph_1_1Mesh.html#ac713e5a9cbd8b21907d39df493d6bfc9">More...</a><br /></td></tr>
<tr class="separator:ac713e5a9cbd8b21907d39df493d6bfc9 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20579c8d8f8b6e6ca2d2e897a67fda68 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a20579c8d8f8b6e6ca2d2e897a67fda68">max_and_min_element_size</a> (<a class="el" href="../../df/de6/classdouble.html">double</a> &amp;max_size, <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;min_size)</td></tr>
<tr class="separator:a20579c8d8f8b6e6ca2d2e897a67fda68 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa4aa3d2d41bd2a5a40ce4cffc9e2952 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#afa4aa3d2d41bd2a5a40ce4cffc9e2952">total_size</a> ()</td></tr>
<tr class="separator:afa4aa3d2d41bd2a5a40ce4cffc9e2952 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76adc3fcd3e49d3bd2e3b9d92c854430 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a76adc3fcd3e49d3bd2e3b9d92c854430">check_inverted_elements</a> (<a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;mesh_has_inverted_elements, std::ofstream &amp;inverted_element_file)</td></tr>
<tr class="separator:a76adc3fcd3e49d3bd2e3b9d92c854430 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c95ee63b466247e6c57c38fb59c577c inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a5c95ee63b466247e6c57c38fb59c577c">check_inverted_elements</a> (<a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;mesh_has_inverted_elements)</td></tr>
<tr class="separator:a5c95ee63b466247e6c57c38fb59c577c inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8229e193565c8de821170d482dfcee2 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#aa8229e193565c8de821170d482dfcee2">check_for_repeated_nodes</a> (const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;epsilon=1.0e-12)</td></tr>
<tr class="separator:aa8229e193565c8de821170d482dfcee2 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9f58929371a3f39dd646d2756547ad2 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../dc/db7/classoomph_1_1Node.html">Node</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ac9f58929371a3f39dd646d2756547ad2">prune_dead_nodes</a> ()</td></tr>
<tr class="separator:ac9f58929371a3f39dd646d2756547ad2 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84543564d6babe4faacbb9d87043fc19 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a84543564d6babe4faacbb9d87043fc19">nboundary</a> () const</td></tr>
<tr class="memdesc:a84543564d6babe4faacbb9d87043fc19 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return number of boundaries.  <a href="../../d6/db8/classoomph_1_1Mesh.html#a84543564d6babe4faacbb9d87043fc19">More...</a><br /></td></tr>
<tr class="separator:a84543564d6babe4faacbb9d87043fc19 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a034677ceb48c67769acb83f304c84f7d inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a034677ceb48c67769acb83f304c84f7d">nboundary_node</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;ibound) const</td></tr>
<tr class="memdesc:a034677ceb48c67769acb83f304c84f7d inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return number of nodes on a particular boundary.  <a href="../../d6/db8/classoomph_1_1Mesh.html#a034677ceb48c67769acb83f304c84f7d">More...</a><br /></td></tr>
<tr class="separator:a034677ceb48c67769acb83f304c84f7d inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a875271b6f162ddc5685a2511b35e75ec inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html">FiniteElement</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a875271b6f162ddc5685a2511b35e75ec">boundary_element_pt</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#a9d82f3af1459c1efc910b77f3ccd3180">b</a>, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../db/de3/Cwise__scalar__power__array_8cpp.html#abfa88ee95cd5e1c8d923f1b21740ece4">e</a>) const</td></tr>
<tr class="memdesc:a875271b6f162ddc5685a2511b35e75ec inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return pointer to e-th finite element on boundary b.  <a href="../../d6/db8/classoomph_1_1Mesh.html#a875271b6f162ddc5685a2511b35e75ec">More...</a><br /></td></tr>
<tr class="separator:a875271b6f162ddc5685a2511b35e75ec inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada7a88cfce20feae01e6841bf4375228 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/db7/classoomph_1_1Node.html">Node</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ada7a88cfce20feae01e6841bf4375228">get_some_non_boundary_node</a> () const</td></tr>
<tr class="separator:ada7a88cfce20feae01e6841bf4375228 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68e04b3b70cff70d53d75f66661555e8 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a68e04b3b70cff70d53d75f66661555e8">nboundary_element</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#a9d82f3af1459c1efc910b77f3ccd3180">b</a>) const</td></tr>
<tr class="memdesc:a68e04b3b70cff70d53d75f66661555e8 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return number of finite elements that are adjacent to boundary b.  <a href="../../d6/db8/classoomph_1_1Mesh.html#a68e04b3b70cff70d53d75f66661555e8">More...</a><br /></td></tr>
<tr class="separator:a68e04b3b70cff70d53d75f66661555e8 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6095e417593de6136d248ab08823f453 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a6095e417593de6136d248ab08823f453">face_index_at_boundary</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#a9d82f3af1459c1efc910b77f3ccd3180">b</a>, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../db/de3/Cwise__scalar__power__array_8cpp.html#abfa88ee95cd5e1c8d923f1b21740ece4">e</a>) const</td></tr>
<tr class="separator:a6095e417593de6136d248ab08823f453 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af821b936768868ea5dd91495e9ae3bc0 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af821b936768868ea5dd91495e9ae3bc0">dump</a> (std::ofstream &amp;dump_file, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;use_old_ordering=true) const</td></tr>
<tr class="memdesc:af821b936768868ea5dd91495e9ae3bc0 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dump the data in the mesh into a file for restart.  <a href="../../d6/db8/classoomph_1_1Mesh.html#af821b936768868ea5dd91495e9ae3bc0">More...</a><br /></td></tr>
<tr class="separator:af821b936768868ea5dd91495e9ae3bc0 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa8d0d8b55c1bb10982fe5449fd6389e inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#afa8d0d8b55c1bb10982fe5449fd6389e">dump</a> (const std::string &amp;dump_file_name, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;use_old_ordering=true) const</td></tr>
<tr class="memdesc:afa8d0d8b55c1bb10982fe5449fd6389e inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dump the data in the mesh into a file for restart.  <a href="../../d6/db8/classoomph_1_1Mesh.html#afa8d0d8b55c1bb10982fe5449fd6389e">More...</a><br /></td></tr>
<tr class="separator:afa8d0d8b55c1bb10982fe5449fd6389e inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac192b41d1a24297ff38854548defd92b inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ac192b41d1a24297ff38854548defd92b">read</a> (std::ifstream &amp;restart_file)</td></tr>
<tr class="memdesc:ac192b41d1a24297ff38854548defd92b inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read solution from restart file.  <a href="../../d6/db8/classoomph_1_1Mesh.html#ac192b41d1a24297ff38854548defd92b">More...</a><br /></td></tr>
<tr class="separator:ac192b41d1a24297ff38854548defd92b inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af62d80c53dc07390d8f62ed180ab6d3a inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af62d80c53dc07390d8f62ed180ab6d3a">output_paraview</a> (std::ofstream &amp;file_out, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;nplot) const</td></tr>
<tr class="separator:af62d80c53dc07390d8f62ed180ab6d3a inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bba347dea4098f0bf7142db582adc38 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a8bba347dea4098f0bf7142db582adc38">output_fct_paraview</a> (std::ofstream &amp;file_out, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;nplot, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a690fd33af26cc3e84f39bba6d5a85202">FiniteElement::SteadyExactSolutionFctPt</a> exact_soln_pt) const</td></tr>
<tr class="separator:a8bba347dea4098f0bf7142db582adc38 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16157f769019724da979e47445e6c2d2 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a16157f769019724da979e47445e6c2d2">output_fct_paraview</a> (std::ofstream &amp;file_out, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;nplot, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;time, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#ad4ecf2b61b158a4b4d351a60d23c633e">FiniteElement::UnsteadyExactSolutionFctPt</a> exact_soln_pt) const</td></tr>
<tr class="separator:a16157f769019724da979e47445e6c2d2 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab74388e8e21325f3ca26f1bd99c26f7 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#aab74388e8e21325f3ca26f1bd99c26f7">output</a> (std::ostream &amp;outfile)</td></tr>
<tr class="memdesc:aab74388e8e21325f3ca26f1bd99c26f7 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output for all elements.  <a href="../../d6/db8/classoomph_1_1Mesh.html#aab74388e8e21325f3ca26f1bd99c26f7">More...</a><br /></td></tr>
<tr class="separator:aab74388e8e21325f3ca26f1bd99c26f7 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdd7ba97e7b862988955fd0c4766ba4d inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#acdd7ba97e7b862988955fd0c4766ba4d">output</a> (std::ostream &amp;outfile, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;n_plot)</td></tr>
<tr class="memdesc:acdd7ba97e7b862988955fd0c4766ba4d inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output at f(n_plot) points in each element.  <a href="../../d6/db8/classoomph_1_1Mesh.html#acdd7ba97e7b862988955fd0c4766ba4d">More...</a><br /></td></tr>
<tr class="separator:acdd7ba97e7b862988955fd0c4766ba4d inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d2a1aa08f3a7912c5e3f2d5f30e0110 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a8d2a1aa08f3a7912c5e3f2d5f30e0110">output</a> (FILE *file_pt)</td></tr>
<tr class="memdesc:a8d2a1aa08f3a7912c5e3f2d5f30e0110 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output for all elements (C-style output)  <a href="../../d6/db8/classoomph_1_1Mesh.html#a8d2a1aa08f3a7912c5e3f2d5f30e0110">More...</a><br /></td></tr>
<tr class="separator:a8d2a1aa08f3a7912c5e3f2d5f30e0110 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a926a1595fd8e9932e8c87a58a7ae23e1 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a926a1595fd8e9932e8c87a58a7ae23e1">output</a> (FILE *file_pt, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;nplot)</td></tr>
<tr class="memdesc:a926a1595fd8e9932e8c87a58a7ae23e1 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output at f(n_plot) points in each element (C-style output)  <a href="../../d6/db8/classoomph_1_1Mesh.html#a926a1595fd8e9932e8c87a58a7ae23e1">More...</a><br /></td></tr>
<tr class="separator:a926a1595fd8e9932e8c87a58a7ae23e1 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a411332db681ec982e88f60c40b3b648d inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a411332db681ec982e88f60c40b3b648d">output</a> (const std::string &amp;output_filename)</td></tr>
<tr class="memdesc:a411332db681ec982e88f60c40b3b648d inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output for all elements.  <a href="../../d6/db8/classoomph_1_1Mesh.html#a411332db681ec982e88f60c40b3b648d">More...</a><br /></td></tr>
<tr class="separator:a411332db681ec982e88f60c40b3b648d inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9f8eb8a56f81fe525a36157bd166ea0 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ac9f8eb8a56f81fe525a36157bd166ea0">output</a> (const std::string &amp;output_filename, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;n_plot)</td></tr>
<tr class="memdesc:ac9f8eb8a56f81fe525a36157bd166ea0 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output at f(n_plot) points in each element.  <a href="../../d6/db8/classoomph_1_1Mesh.html#ac9f8eb8a56f81fe525a36157bd166ea0">More...</a><br /></td></tr>
<tr class="separator:ac9f8eb8a56f81fe525a36157bd166ea0 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c5d6492f33fcd0dc7a65b7bc2a2dde2 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a7c5d6492f33fcd0dc7a65b7bc2a2dde2">output_fct</a> (std::ostream &amp;outfile, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;n_plot, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a690fd33af26cc3e84f39bba6d5a85202">FiniteElement::SteadyExactSolutionFctPt</a>)</td></tr>
<tr class="memdesc:a7c5d6492f33fcd0dc7a65b7bc2a2dde2 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output a given Vector function at f(n_plot) points in each element.  <a href="../../d6/db8/classoomph_1_1Mesh.html#a7c5d6492f33fcd0dc7a65b7bc2a2dde2">More...</a><br /></td></tr>
<tr class="separator:a7c5d6492f33fcd0dc7a65b7bc2a2dde2 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56d3007b3d8a11c8f5852bcfcc1d195d inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a56d3007b3d8a11c8f5852bcfcc1d195d">output_fct</a> (std::ostream &amp;outfile, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;n_plot, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;time, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#ad4ecf2b61b158a4b4d351a60d23c633e">FiniteElement::UnsteadyExactSolutionFctPt</a>)</td></tr>
<tr class="separator:a56d3007b3d8a11c8f5852bcfcc1d195d inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6effab50e32290d4d8066440b9b3e37 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af6effab50e32290d4d8066440b9b3e37">output_boundaries</a> (std::ostream &amp;outfile)</td></tr>
<tr class="memdesc:af6effab50e32290d4d8066440b9b3e37 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output the nodes on the boundaries (into separate tecplot zones)  <a href="../../d6/db8/classoomph_1_1Mesh.html#af6effab50e32290d4d8066440b9b3e37">More...</a><br /></td></tr>
<tr class="separator:af6effab50e32290d4d8066440b9b3e37 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82c291df31d4b6400004ede7c0973106 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a82c291df31d4b6400004ede7c0973106">output_boundaries</a> (const std::string &amp;output_filename)</td></tr>
<tr class="separator:a82c291df31d4b6400004ede7c0973106 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1ceceaadc7114773f5a70cb52e67081 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ab1ceceaadc7114773f5a70cb52e67081">assign_initial_values_impulsive</a> ()</td></tr>
<tr class="memdesc:ab1ceceaadc7114773f5a70cb52e67081 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assign initial values for an impulsive start.  <a href="../../d6/db8/classoomph_1_1Mesh.html#ab1ceceaadc7114773f5a70cb52e67081">More...</a><br /></td></tr>
<tr class="separator:ab1ceceaadc7114773f5a70cb52e67081 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f097aaa854ac697f8016ba3b7e6c982 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a7f097aaa854ac697f8016ba3b7e6c982">shift_time_values</a> ()</td></tr>
<tr class="separator:a7f097aaa854ac697f8016ba3b7e6c982 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a823b11b11e6a0c3c22ea86dc60a3da65 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a823b11b11e6a0c3c22ea86dc60a3da65">calculate_predictions</a> ()</td></tr>
<tr class="separator:a823b11b11e6a0c3c22ea86dc60a3da65 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c9a84e7e912c2fef3f513bfcd50fc70 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a6c9a84e7e912c2fef3f513bfcd50fc70">set_nodal_and_elemental_time_stepper</a> (<a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html">TimeStepper</a> *const &amp;time_stepper_pt, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;preserve_existing_data)</td></tr>
<tr class="separator:a6c9a84e7e912c2fef3f513bfcd50fc70 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52c30b4ebc67038e137a5de1c5d422e5 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a52c30b4ebc67038e137a5de1c5d422e5">set_mesh_level_time_stepper</a> (<a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html">TimeStepper</a> *const &amp;time_stepper_pt, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;preserve_existing_data)</td></tr>
<tr class="separator:a52c30b4ebc67038e137a5de1c5d422e5 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8d6a5dcf3af2df66625079975d84c19 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ac8d6a5dcf3af2df66625079975d84c19">set_consistent_pinned_values_for_continuation</a> (<a class="el" href="../../d1/daa/classoomph_1_1ContinuationStorageScheme.html">ContinuationStorageScheme</a> *const &amp;continuation_stepper_pt)</td></tr>
<tr class="memdesc:ac8d6a5dcf3af2df66625079975d84c19 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set consistent values for pinned data in continuation.  <a href="../../d6/db8/classoomph_1_1Mesh.html#ac8d6a5dcf3af2df66625079975d84c19">More...</a><br /></td></tr>
<tr class="separator:ac8d6a5dcf3af2df66625079975d84c19 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13712b3fb8f01107772db51e01dbeee0 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a13712b3fb8f01107772db51e01dbeee0">does_pointer_correspond_to_mesh_data</a> (<a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;parameter_pt)</td></tr>
<tr class="memdesc:a13712b3fb8f01107772db51e01dbeee0 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Does the double pointer correspond to any mesh data.  <a href="../../d6/db8/classoomph_1_1Mesh.html#a13712b3fb8f01107772db51e01dbeee0">More...</a><br /></td></tr>
<tr class="separator:a13712b3fb8f01107772db51e01dbeee0 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac40c947d8ffe5b14aa6ac77fc398f3ec inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ac40c947d8ffe5b14aa6ac77fc398f3ec">set_nodal_time_stepper</a> (<a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html">TimeStepper</a> *const &amp;time_stepper_pt, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;preserve_existing_data)</td></tr>
<tr class="memdesc:ac40c947d8ffe5b14aa6ac77fc398f3ec inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the timestepper associated with the nodal data in the mesh.  <a href="../../d6/db8/classoomph_1_1Mesh.html#ac40c947d8ffe5b14aa6ac77fc398f3ec">More...</a><br /></td></tr>
<tr class="separator:ac40c947d8ffe5b14aa6ac77fc398f3ec inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a681b7531f2c90ea88c8a5ff4df7bce59 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a681b7531f2c90ea88c8a5ff4df7bce59">set_elemental_internal_time_stepper</a> (<a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html">TimeStepper</a> *const &amp;time_stepper_pt, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;preserve_existing_data)</td></tr>
<tr class="separator:a681b7531f2c90ea88c8a5ff4df7bce59 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36ceaaaa59093ae61393a3fd9090469e inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a36ceaaaa59093ae61393a3fd9090469e">compute_norm</a> (<a class="el" href="../../df/de6/classdouble.html">double</a> &amp;norm)</td></tr>
<tr class="separator:a36ceaaaa59093ae61393a3fd9090469e inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79ad604c845a2925fa661395987c79ed inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a79ad604c845a2925fa661395987c79ed">compute_norm</a> (<a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;norm)</td></tr>
<tr class="separator:a79ad604c845a2925fa661395987c79ed inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ccc8ea627c4aaeace90c78365b7ea30 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a7ccc8ea627c4aaeace90c78365b7ea30">compute_error</a> (std::ostream &amp;outfile, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#ad4ecf2b61b158a4b4d351a60d23c633e">FiniteElement::UnsteadyExactSolutionFctPt</a> exact_soln_pt, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;time, <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;error, <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;norm)</td></tr>
<tr class="separator:a7ccc8ea627c4aaeace90c78365b7ea30 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9488e849a82ef1fc4971013e3661a1ce inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a9488e849a82ef1fc4971013e3661a1ce">compute_error</a> (std::ostream &amp;outfile, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a690fd33af26cc3e84f39bba6d5a85202">FiniteElement::SteadyExactSolutionFctPt</a> exact_soln_pt, <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;error, <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;norm)</td></tr>
<tr class="separator:a9488e849a82ef1fc4971013e3661a1ce inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adea276fc0a96372cb5970e19dd2e4e09 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#adea276fc0a96372cb5970e19dd2e4e09">compute_error</a> (<a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a690fd33af26cc3e84f39bba6d5a85202">FiniteElement::SteadyExactSolutionFctPt</a> exact_soln_pt, <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;error, <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;norm)</td></tr>
<tr class="separator:adea276fc0a96372cb5970e19dd2e4e09 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca979a01748a6a53c31a0f3f44d37527 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#aca979a01748a6a53c31a0f3f44d37527">compute_error</a> (<a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a690fd33af26cc3e84f39bba6d5a85202">FiniteElement::SteadyExactSolutionFctPt</a> exact_soln_pt, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;error, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;norm)</td></tr>
<tr class="separator:aca979a01748a6a53c31a0f3f44d37527 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13e54320a2c859f9085a8ecd01cc72f0 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a13e54320a2c859f9085a8ecd01cc72f0">compute_error</a> (std::ostream &amp;outfile, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#ad4ecf2b61b158a4b4d351a60d23c633e">FiniteElement::UnsteadyExactSolutionFctPt</a> exact_soln_pt, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;time, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;error, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;norm)</td></tr>
<tr class="separator:a13e54320a2c859f9085a8ecd01cc72f0 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf01468aaed8c208faa4bdb474b9519e inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#aaf01468aaed8c208faa4bdb474b9519e">compute_error</a> (std::ostream &amp;outfile, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a690fd33af26cc3e84f39bba6d5a85202">FiniteElement::SteadyExactSolutionFctPt</a> exact_soln_pt, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;error, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;norm)</td></tr>
<tr class="separator:aaf01468aaed8c208faa4bdb474b9519e inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedf8ec7f1156031bf9d5a24d1c908b7c inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#aedf8ec7f1156031bf9d5a24d1c908b7c">compute_error</a> (<a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#ad4ecf2b61b158a4b4d351a60d23c633e">FiniteElement::UnsteadyExactSolutionFctPt</a> exact_soln_pt, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;time, <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;error, <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;norm)</td></tr>
<tr class="memdesc:aedf8ec7f1156031bf9d5a24d1c908b7c inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the norm of the error and that of the exact solution.  <a href="../../d6/db8/classoomph_1_1Mesh.html#aedf8ec7f1156031bf9d5a24d1c908b7c">More...</a><br /></td></tr>
<tr class="separator:aedf8ec7f1156031bf9d5a24d1c908b7c inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e84d922027f5860b272df48d2efe312 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a9e84d922027f5860b272df48d2efe312">compute_error</a> (<a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#ad4ecf2b61b158a4b4d351a60d23c633e">FiniteElement::UnsteadyExactSolutionFctPt</a> exact_soln_pt, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;time, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;error, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;norm)</td></tr>
<tr class="separator:a9e84d922027f5860b272df48d2efe312 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ab35b022b95f2d28c53aa58859bd6b5 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a1ab35b022b95f2d28c53aa58859bd6b5">is_mesh_distributed</a> () const</td></tr>
<tr class="memdesc:a1ab35b022b95f2d28c53aa58859bd6b5 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Boolean to indicate if Mesh has been distributed.  <a href="../../d6/db8/classoomph_1_1Mesh.html#a1ab35b022b95f2d28c53aa58859bd6b5">More...</a><br /></td></tr>
<tr class="separator:a1ab35b022b95f2d28c53aa58859bd6b5 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b2c1aba0f9cb4e1767c65f9a3162577 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html">OomphCommunicator</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a3b2c1aba0f9cb4e1767c65f9a3162577">communicator_pt</a> () const</td></tr>
<tr class="separator:a3b2c1aba0f9cb4e1767c65f9a3162577 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e3ecb07dc622cf37ce0085446ff9aa6 inherit pub_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a9e3ecb07dc622cf37ce0085446ff9aa6">delete_all_external_storage</a> ()</td></tr>
<tr class="memdesc:a9e3ecb07dc622cf37ce0085446ff9aa6 inherit pub_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wipe the storage for all externally-based elements.  <a href="../../d6/db8/classoomph_1_1Mesh.html#a9e3ecb07dc622cf37ce0085446ff9aa6">More...</a><br /></td></tr>
<tr class="separator:a9e3ecb07dc622cf37ce0085446ff9aa6 inherit pub_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a86dace1f78991fb9b401a31215df89ef"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a86dace1f78991fb9b401a31215df89ef">split_elements_if_required</a> ()=0</td></tr>
<tr class="separator:a86dace1f78991fb9b401a31215df89ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a2f26f447d6386505bdbdd0ac518321"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a9a2f26f447d6386505bdbdd0ac518321">p_refine_elements_if_required</a> ()=0</td></tr>
<tr class="separator:a9a2f26f447d6386505bdbdd0ac518321"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab6f14b0933edc819231a88b1d555f62"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#aab6f14b0933edc819231a88b1d555f62">complete_hanging_nodes</a> (const <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> &amp;ncont_interpolated_values)</td></tr>
<tr class="memdesc:aab6f14b0933edc819231a88b1d555f62"><td class="mdescLeft">&#160;</td><td class="mdescRight">Complete the hanging node scheme recursively.  <a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#aab6f14b0933edc819231a88b1d555f62">More...</a><br /></td></tr>
<tr class="separator:aab6f14b0933edc819231a88b1d555f62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6dd9c95ee6c2ffcd687ad0ed736c5ba3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a6dd9c95ee6c2ffcd687ad0ed736c5ba3">complete_hanging_nodes_recursively</a> (<a class="el" href="../../dc/db7/classoomph_1_1Node.html">Node</a> *&amp;nod_pt, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../dc/db7/classoomph_1_1Node.html">Node</a> * &gt; &amp;master_nodes, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;hang_weights, const <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> &amp;ival)</td></tr>
<tr class="memdesc:a6dd9c95ee6c2ffcd687ad0ed736c5ba3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Auxiliary routine for recursive hanging node completion.  <a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a6dd9c95ee6c2ffcd687ad0ed736c5ba3">More...</a><br /></td></tr>
<tr class="separator:a6dd9c95ee6c2ffcd687ad0ed736c5ba3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_classoomph_1_1Mesh"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classoomph_1_1Mesh')"><img src="../../closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">oomph::Mesh</a></td></tr>
<tr class="memitem:addf84f5fbe29d45259c36acf5f01d330 inherit pro_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#addf84f5fbe29d45259c36acf5f01d330">assign_global_eqn_numbers</a> (<a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> * &gt; &amp;Dof_pt)</td></tr>
<tr class="memdesc:addf84f5fbe29d45259c36acf5f01d330 inherit pro_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assign (global) equation numbers to the nodes.  <a href="../../d6/db8/classoomph_1_1Mesh.html#addf84f5fbe29d45259c36acf5f01d330">More...</a><br /></td></tr>
<tr class="separator:addf84f5fbe29d45259c36acf5f01d330 inherit pro_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86d000c45f6d29fa215b98051cc2d23f inherit pro_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a86d000c45f6d29fa215b98051cc2d23f">describe_dofs</a> (std::ostream &amp;<a class="el" href="../../d9/d83/tensor__contract__sycl__bench_8cc.html#acc4949c3e64b4395f74072403ddf6184">out</a>, const std::string &amp;current_string) const</td></tr>
<tr class="separator:a86d000c45f6d29fa215b98051cc2d23f inherit pro_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57d57b7b6d7a32fadafb03e7055c5ad4 inherit pro_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a57d57b7b6d7a32fadafb03e7055c5ad4">describe_local_dofs</a> (std::ostream &amp;<a class="el" href="../../d9/d83/tensor__contract__sycl__bench_8cc.html#acc4949c3e64b4395f74072403ddf6184">out</a>, const std::string &amp;current_string) const</td></tr>
<tr class="separator:a57d57b7b6d7a32fadafb03e7055c5ad4 inherit pro_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab73d03d38e9b94b15f21b2c12f5dc3bc inherit pro_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ab73d03d38e9b94b15f21b2c12f5dc3bc">assign_local_eqn_numbers</a> (const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;store_local_dof_pt)</td></tr>
<tr class="memdesc:ab73d03d38e9b94b15f21b2c12f5dc3bc inherit pro_methods_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assign local equation numbers in all elements.  <a href="../../d6/db8/classoomph_1_1Mesh.html#ab73d03d38e9b94b15f21b2c12f5dc3bc">More...</a><br /></td></tr>
<tr class="separator:ab73d03d38e9b94b15f21b2c12f5dc3bc inherit pro_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa864cbb7f3ff399eef871c63067894df inherit pro_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#aa864cbb7f3ff399eef871c63067894df">convert_to_boundary_node</a> (<a class="el" href="../../dc/db7/classoomph_1_1Node.html">Node</a> *&amp;<a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">node_pt</a>, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html">FiniteElement</a> * &gt; &amp;<a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a4f274774435e9454bf77bf70de69367a">finite_element_pt</a>)</td></tr>
<tr class="separator:aa864cbb7f3ff399eef871c63067894df inherit pro_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2bdff104c0cc1f2669f9f5cad4a2a1a9 inherit pro_methods_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a2bdff104c0cc1f2669f9f5cad4a2a1a9">convert_to_boundary_node</a> (<a class="el" href="../../dc/db7/classoomph_1_1Node.html">Node</a> *&amp;<a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">node_pt</a>)</td></tr>
<tr class="separator:a2bdff104c0cc1f2669f9f5cad4a2a1a9 inherit pro_methods_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a1a69da6d99f1776f53209940d40eaaa3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a1a69da6d99f1776f53209940d40eaaa3">Uniform_refinement_level_when_pruned</a></td></tr>
<tr class="memdesc:a1a69da6d99f1776f53209940d40eaaa3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Level to which the mesh was uniformly refined when it was pruned.  <a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a1a69da6d99f1776f53209940d40eaaa3">More...</a><br /></td></tr>
<tr class="separator:a1a69da6d99f1776f53209940d40eaaa3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd1c5544779f42de66b25a0225644f7d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#acd1c5544779f42de66b25a0225644f7d">Max_refinement_level</a></td></tr>
<tr class="memdesc:acd1c5544779f42de66b25a0225644f7d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Max. permissible refinement level (relative to base mesh)  <a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#acd1c5544779f42de66b25a0225644f7d">More...</a><br /></td></tr>
<tr class="separator:acd1c5544779f42de66b25a0225644f7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af48df64966833ed693c11576ff28ada1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#af48df64966833ed693c11576ff28ada1">Min_refinement_level</a></td></tr>
<tr class="memdesc:af48df64966833ed693c11576ff28ada1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Min. permissible refinement level (relative to base mesh)  <a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#af48df64966833ed693c11576ff28ada1">More...</a><br /></td></tr>
<tr class="separator:af48df64966833ed693c11576ff28ada1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39ab498ac06506e1500f9f03e8cecf72"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a39ab498ac06506e1500f9f03e8cecf72">Max_p_refinement_level</a></td></tr>
<tr class="memdesc:a39ab498ac06506e1500f9f03e8cecf72"><td class="mdescLeft">&#160;</td><td class="mdescRight">Max. permissible p-refinement level (relative to base mesh)  <a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a39ab498ac06506e1500f9f03e8cecf72">More...</a><br /></td></tr>
<tr class="separator:a39ab498ac06506e1500f9f03e8cecf72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd9b33d333c11837b3d2dbca163b6320"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#abd9b33d333c11837b3d2dbca163b6320">Min_p_refinement_level</a></td></tr>
<tr class="memdesc:abd9b33d333c11837b3d2dbca163b6320"><td class="mdescLeft">&#160;</td><td class="mdescRight">Min. permissible p-refinement level (relative to base mesh)  <a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#abd9b33d333c11837b3d2dbca163b6320">More...</a><br /></td></tr>
<tr class="separator:abd9b33d333c11837b3d2dbca163b6320"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf121b2595ff71815c4e9db35247f951"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d2/d36/classoomph_1_1TreeForest.html">TreeForest</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#aaf121b2595ff71815c4e9db35247f951">Forest_pt</a></td></tr>
<tr class="memdesc:aaf121b2595ff71815c4e9db35247f951"><td class="mdescLeft">&#160;</td><td class="mdescRight">Forest representation of the mesh.  <a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#aaf121b2595ff71815c4e9db35247f951">More...</a><br /></td></tr>
<tr class="separator:aaf121b2595ff71815c4e9db35247f951"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classoomph_1_1RefineableMeshBase"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classoomph_1_1RefineableMeshBase')"><img src="../../closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html">oomph::RefineableMeshBase</a></td></tr>
<tr class="memitem:a9e5f299e0f07b0b78d0147b207f94883 inherit pro_attribs_classoomph_1_1RefineableMeshBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/dab/classoomph_1_1ErrorEstimator.html">ErrorEstimator</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a9e5f299e0f07b0b78d0147b207f94883">Spatial_error_estimator_pt</a></td></tr>
<tr class="memdesc:a9e5f299e0f07b0b78d0147b207f94883 inherit pro_attribs_classoomph_1_1RefineableMeshBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to spatial error estimator.  <a href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a9e5f299e0f07b0b78d0147b207f94883">More...</a><br /></td></tr>
<tr class="separator:a9e5f299e0f07b0b78d0147b207f94883 inherit pro_attribs_classoomph_1_1RefineableMeshBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3a2b9ae35dd65e377032c53c4f25ca9 inherit pro_attribs_classoomph_1_1RefineableMeshBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#af3a2b9ae35dd65e377032c53c4f25ca9">Max_permitted_error</a></td></tr>
<tr class="memdesc:af3a2b9ae35dd65e377032c53c4f25ca9 inherit pro_attribs_classoomph_1_1RefineableMeshBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Max. error (i.e. split elements if their error is larger)  <a href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#af3a2b9ae35dd65e377032c53c4f25ca9">More...</a><br /></td></tr>
<tr class="separator:af3a2b9ae35dd65e377032c53c4f25ca9 inherit pro_attribs_classoomph_1_1RefineableMeshBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac623d3a2406dc79c517636ad6abad0d3 inherit pro_attribs_classoomph_1_1RefineableMeshBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#ac623d3a2406dc79c517636ad6abad0d3">Min_permitted_error</a></td></tr>
<tr class="memdesc:ac623d3a2406dc79c517636ad6abad0d3 inherit pro_attribs_classoomph_1_1RefineableMeshBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Min. error (i.e. (try to) merge elements if their error is smaller)  <a href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#ac623d3a2406dc79c517636ad6abad0d3">More...</a><br /></td></tr>
<tr class="separator:ac623d3a2406dc79c517636ad6abad0d3 inherit pro_attribs_classoomph_1_1RefineableMeshBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab8dedbf9f239f89f949f7d968195c0c inherit pro_attribs_classoomph_1_1RefineableMeshBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#aab8dedbf9f239f89f949f7d968195c0c">Min_error</a></td></tr>
<tr class="memdesc:aab8dedbf9f239f89f949f7d968195c0c inherit pro_attribs_classoomph_1_1RefineableMeshBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Min.actual error.  <a href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#aab8dedbf9f239f89f949f7d968195c0c">More...</a><br /></td></tr>
<tr class="separator:aab8dedbf9f239f89f949f7d968195c0c inherit pro_attribs_classoomph_1_1RefineableMeshBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa179661bfb11a786cc84aba4032c97d8 inherit pro_attribs_classoomph_1_1RefineableMeshBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#aa179661bfb11a786cc84aba4032c97d8">Max_error</a></td></tr>
<tr class="memdesc:aa179661bfb11a786cc84aba4032c97d8 inherit pro_attribs_classoomph_1_1RefineableMeshBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Max. actual error.  <a href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#aa179661bfb11a786cc84aba4032c97d8">More...</a><br /></td></tr>
<tr class="separator:aa179661bfb11a786cc84aba4032c97d8 inherit pro_attribs_classoomph_1_1RefineableMeshBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a35c13c3c37ddc5ac2852217d903459 inherit pro_attribs_classoomph_1_1RefineableMeshBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a1a35c13c3c37ddc5ac2852217d903459">Nrefined</a></td></tr>
<tr class="memdesc:a1a35c13c3c37ddc5ac2852217d903459 inherit pro_attribs_classoomph_1_1RefineableMeshBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stats: Number of elements that were refined.  <a href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a1a35c13c3c37ddc5ac2852217d903459">More...</a><br /></td></tr>
<tr class="separator:a1a35c13c3c37ddc5ac2852217d903459 inherit pro_attribs_classoomph_1_1RefineableMeshBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62c0314a69b2e40355a2aa27ff5ea133 inherit pro_attribs_classoomph_1_1RefineableMeshBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a62c0314a69b2e40355a2aa27ff5ea133">Nunrefined</a></td></tr>
<tr class="memdesc:a62c0314a69b2e40355a2aa27ff5ea133 inherit pro_attribs_classoomph_1_1RefineableMeshBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stats: Number of elements that were unrefined.  <a href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a62c0314a69b2e40355a2aa27ff5ea133">More...</a><br /></td></tr>
<tr class="separator:a62c0314a69b2e40355a2aa27ff5ea133 inherit pro_attribs_classoomph_1_1RefineableMeshBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2bc0a1c6c011672442049d9032774ca4 inherit pro_attribs_classoomph_1_1RefineableMeshBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a2bc0a1c6c011672442049d9032774ca4">Adapt_flag</a></td></tr>
<tr class="memdesc:a2bc0a1c6c011672442049d9032774ca4 inherit pro_attribs_classoomph_1_1RefineableMeshBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag that requests adaptation.  <a href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a2bc0a1c6c011672442049d9032774ca4">More...</a><br /></td></tr>
<tr class="separator:a2bc0a1c6c011672442049d9032774ca4 inherit pro_attribs_classoomph_1_1RefineableMeshBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e378a1fe248b22b813bd31505f42de2 inherit pro_attribs_classoomph_1_1RefineableMeshBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a0e378a1fe248b22b813bd31505f42de2">P_adapt_flag</a></td></tr>
<tr class="memdesc:a0e378a1fe248b22b813bd31505f42de2 inherit pro_attribs_classoomph_1_1RefineableMeshBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag that requests p-adaptation.  <a href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a0e378a1fe248b22b813bd31505f42de2">More...</a><br /></td></tr>
<tr class="separator:a0e378a1fe248b22b813bd31505f42de2 inherit pro_attribs_classoomph_1_1RefineableMeshBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ab22815312413547b130b2c02b95341 inherit pro_attribs_classoomph_1_1RefineableMeshBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a6ab22815312413547b130b2c02b95341">Additional_synchronisation_of_hanging_nodes_not_required</a></td></tr>
<tr class="memdesc:a6ab22815312413547b130b2c02b95341 inherit pro_attribs_classoomph_1_1RefineableMeshBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag that disables additional synchronisation of hanging nodes.  <a href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a6ab22815312413547b130b2c02b95341">More...</a><br /></td></tr>
<tr class="separator:a6ab22815312413547b130b2c02b95341 inherit pro_attribs_classoomph_1_1RefineableMeshBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37561a1518733dc95a193e46b085f313 inherit pro_attribs_classoomph_1_1RefineableMeshBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a37561a1518733dc95a193e46b085f313">Doc_info_pt</a></td></tr>
<tr class="memdesc:a37561a1518733dc95a193e46b085f313 inherit pro_attribs_classoomph_1_1RefineableMeshBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to DocInfo.  <a href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a37561a1518733dc95a193e46b085f313">More...</a><br /></td></tr>
<tr class="separator:a37561a1518733dc95a193e46b085f313 inherit pro_attribs_classoomph_1_1RefineableMeshBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55c7480baae4082f4da4cbb48c40c623 inherit pro_attribs_classoomph_1_1RefineableMeshBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a55c7480baae4082f4da4cbb48c40c623">Max_keep_unrefined</a></td></tr>
<tr class="separator:a55c7480baae4082f4da4cbb48c40c623 inherit pro_attribs_classoomph_1_1RefineableMeshBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad52549170de34203f6b558c50ecf8f8f inherit pro_attribs_classoomph_1_1RefineableMeshBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#ad52549170de34203f6b558c50ecf8f8f">Nrefinement_overruled</a></td></tr>
<tr class="separator:ad52549170de34203f6b558c50ecf8f8f inherit pro_attribs_classoomph_1_1RefineableMeshBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classoomph_1_1Mesh"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classoomph_1_1Mesh')"><img src="../../closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">oomph::Mesh</a></td></tr>
<tr class="memitem:abbba08d3de5cccd78ee98afc7b2f61fc inherit pro_attribs_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../dc/db7/classoomph_1_1Node.html">Node</a> * &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#abbba08d3de5cccd78ee98afc7b2f61fc">Boundary_node_pt</a></td></tr>
<tr class="separator:abbba08d3de5cccd78ee98afc7b2f61fc inherit pro_attribs_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37f6d27447f643a74694012b09350ce9 inherit pro_attribs_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a37f6d27447f643a74694012b09350ce9">Lookup_for_elements_next_boundary_is_setup</a></td></tr>
<tr class="separator:a37f6d27447f643a74694012b09350ce9 inherit pro_attribs_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a266ac14a3e884f978c8605f7b5786e81 inherit pro_attribs_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html">FiniteElement</a> * &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a266ac14a3e884f978c8605f7b5786e81">Boundary_element_pt</a></td></tr>
<tr class="separator:a266ac14a3e884f978c8605f7b5786e81 inherit pro_attribs_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62adbe45fe65ff9cd329bb45d197347c inherit pro_attribs_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a62adbe45fe65ff9cd329bb45d197347c">Face_index_at_boundary</a></td></tr>
<tr class="separator:a62adbe45fe65ff9cd329bb45d197347c inherit pro_attribs_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a42111e7eb200e5831f8b73c018b7dc inherit pro_attribs_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../dc/db7/classoomph_1_1Node.html">Node</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a0a42111e7eb200e5831f8b73c018b7dc">Node_pt</a></td></tr>
<tr class="memdesc:a0a42111e7eb200e5831f8b73c018b7dc inherit pro_attribs_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector of pointers to nodes.  <a href="../../d6/db8/classoomph_1_1Mesh.html#a0a42111e7eb200e5831f8b73c018b7dc">More...</a><br /></td></tr>
<tr class="separator:a0a42111e7eb200e5831f8b73c018b7dc inherit pro_attribs_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca12acfe655a4d5c4a4eab4a7b970812 inherit pro_attribs_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html">GeneralisedElement</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#aca12acfe655a4d5c4a4eab4a7b970812">Element_pt</a></td></tr>
<tr class="memdesc:aca12acfe655a4d5c4a4eab4a7b970812 inherit pro_attribs_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector of pointers to generalised elements.  <a href="../../d6/db8/classoomph_1_1Mesh.html#aca12acfe655a4d5c4a4eab4a7b970812">More...</a><br /></td></tr>
<tr class="separator:aca12acfe655a4d5c4a4eab4a7b970812 inherit pro_attribs_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a412a5051be9e81f0ba61bf85e5abc4a6 inherit pro_attribs_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="../../d9/db9/classbool.html">bool</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a412a5051be9e81f0ba61bf85e5abc4a6">Boundary_coordinate_exists</a></td></tr>
<tr class="separator:a412a5051be9e81f0ba61bf85e5abc4a6 inherit pro_attribs_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pub_types_classoomph_1_1Mesh"><td colspan="2" onclick="javascript:toggleInherit('pub_types_classoomph_1_1Mesh')"><img src="../../closed.png" alt="-"/>&#160;Public Types inherited from <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">oomph::Mesh</a></td></tr>
<tr class="memitem:a059e155da2b47cc94c3306398bd2be07 inherit pub_types_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">typedef void(FiniteElement::*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a059e155da2b47cc94c3306398bd2be07">SteadyExactSolutionFctPt</a>) (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a61b7da262276970831d88a2f37dbe509">x</a>, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;soln)</td></tr>
<tr class="separator:a059e155da2b47cc94c3306398bd2be07 inherit pub_types_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fccd0b52d2384b0d4f423118284882d inherit pub_types_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">typedef void(FiniteElement::*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a4fccd0b52d2384b0d4f423118284882d">UnsteadyExactSolutionFctPt</a>) (const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;time, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a61b7da262276970831d88a2f37dbe509">x</a>, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;soln)</td></tr>
<tr class="separator:a4fccd0b52d2384b0d4f423118284882d inherit pub_types_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_static_attribs_classoomph_1_1Mesh"><td colspan="2" onclick="javascript:toggleInherit('pub_static_attribs_classoomph_1_1Mesh')"><img src="../../closed.png" alt="-"/>&#160;Static Public Attributes inherited from <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">oomph::Mesh</a></td></tr>
<tr class="memitem:a12243d0fee2b1fcee729ee5a4777ea10 inherit pub_static_attribs_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d5/d11/classoomph_1_1Steady.html">Steady</a>&lt; 0 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a12243d0fee2b1fcee729ee5a4777ea10">Default_TimeStepper</a></td></tr>
<tr class="memdesc:a12243d0fee2b1fcee729ee5a4777ea10 inherit pub_static_attribs_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">The Steady Timestepper.  <a href="../../d6/db8/classoomph_1_1Mesh.html#a12243d0fee2b1fcee729ee5a4777ea10">More...</a><br /></td></tr>
<tr class="separator:a12243d0fee2b1fcee729ee5a4777ea10 inherit pub_static_attribs_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada6bc12304d1536b747596d1049e48be inherit pub_static_attribs_classoomph_1_1Mesh"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ada6bc12304d1536b747596d1049e48be">Suppress_warning_about_empty_mesh_level_time_stepper_function</a></td></tr>
<tr class="memdesc:ada6bc12304d1536b747596d1049e48be inherit pub_static_attribs_classoomph_1_1Mesh"><td class="mdescLeft">&#160;</td><td class="mdescRight">Static boolean flag to control warning about mesh level timesteppers.  <a href="../../d6/db8/classoomph_1_1Mesh.html#ada6bc12304d1536b747596d1049e48be">More...</a><br /></td></tr>
<tr class="separator:ada6bc12304d1536b747596d1049e48be inherit pub_static_attribs_classoomph_1_1Mesh"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Base class for tree-based refineable meshes. </p>
<p>///////////////////////////////////////////////////////////////// ///////////////////////////////////////////////////////////////// ///////////////////////////////////////////////////////////////// </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aae094b3c6b773c0dbfbeba056c83eac6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae094b3c6b773c0dbfbeba056c83eac6">&#9670;&nbsp;</a></span>TreeBasedRefineableMeshBase() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">oomph::TreeBasedRefineableMeshBase::TreeBasedRefineableMeshBase </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructor. </p>
<div class="fragment"><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    {</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      <span class="comment">// Max/min refinement levels</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#acd1c5544779f42de66b25a0225644f7d">Max_refinement_level</a> = 5;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#af48df64966833ed693c11576ff28ada1">Min_refinement_level</a> = 0;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160; </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      <span class="comment">// Max/min p-refinement levels</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a39ab498ac06506e1500f9f03e8cecf72">Max_p_refinement_level</a> = 7;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#abd9b33d333c11837b3d2dbca163b6320">Min_p_refinement_level</a> = 2;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160; </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      <span class="comment">// Stats</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a1a35c13c3c37ddc5ac2852217d903459">Nrefined</a> = 0;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a62c0314a69b2e40355a2aa27ff5ea133">Nunrefined</a> = 0;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160; </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      <span class="comment">// Where do I write the documatation of the refinement process?</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a37561a1518733dc95a193e46b085f313">Doc_info_pt</a> = 0;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160; </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      <span class="comment">// Initialise the forest pointer to NULL</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#aaf121b2595ff71815c4e9db35247f951">Forest_pt</a> = 0;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160; </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      <span class="comment">// Mesh hasn&#39;t been pruned yet</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;      <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a1a69da6d99f1776f53209940d40eaaa3">Uniform_refinement_level_when_pruned</a> = 0;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1RefineableMeshBase_html_a1a35c13c3c37ddc5ac2852217d903459"><div class="ttname"><a href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a1a35c13c3c37ddc5ac2852217d903459">oomph::RefineableMeshBase::Nrefined</a></div><div class="ttdeci">unsigned Nrefined</div><div class="ttdoc">Stats: Number of elements that were refined.</div><div class="ttdef"><b>Definition:</b> refineable_mesh.h:338</div></div>
<div class="ttc" id="aclassoomph_1_1RefineableMeshBase_html_a37561a1518733dc95a193e46b085f313"><div class="ttname"><a href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a37561a1518733dc95a193e46b085f313">oomph::RefineableMeshBase::Doc_info_pt</a></div><div class="ttdeci">DocInfo * Doc_info_pt</div><div class="ttdoc">Pointer to DocInfo.</div><div class="ttdef"><b>Definition:</b> refineable_mesh.h:353</div></div>
<div class="ttc" id="aclassoomph_1_1RefineableMeshBase_html_a62c0314a69b2e40355a2aa27ff5ea133"><div class="ttname"><a href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a62c0314a69b2e40355a2aa27ff5ea133">oomph::RefineableMeshBase::Nunrefined</a></div><div class="ttdeci">unsigned Nunrefined</div><div class="ttdoc">Stats: Number of elements that were unrefined.</div><div class="ttdef"><b>Definition:</b> refineable_mesh.h:341</div></div>
<div class="ttc" id="aclassoomph_1_1TreeBasedRefineableMeshBase_html_a1a69da6d99f1776f53209940d40eaaa3"><div class="ttname"><a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a1a69da6d99f1776f53209940d40eaaa3">oomph::TreeBasedRefineableMeshBase::Uniform_refinement_level_when_pruned</a></div><div class="ttdeci">unsigned Uniform_refinement_level_when_pruned</div><div class="ttdoc">Level to which the mesh was uniformly refined when it was pruned.</div><div class="ttdef"><b>Definition:</b> refineable_mesh.h:753</div></div>
<div class="ttc" id="aclassoomph_1_1TreeBasedRefineableMeshBase_html_a39ab498ac06506e1500f9f03e8cecf72"><div class="ttname"><a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a39ab498ac06506e1500f9f03e8cecf72">oomph::TreeBasedRefineableMeshBase::Max_p_refinement_level</a></div><div class="ttdeci">unsigned Max_p_refinement_level</div><div class="ttdoc">Max. permissible p-refinement level (relative to base mesh)</div><div class="ttdef"><b>Definition:</b> refineable_mesh.h:762</div></div>
<div class="ttc" id="aclassoomph_1_1TreeBasedRefineableMeshBase_html_aaf121b2595ff71815c4e9db35247f951"><div class="ttname"><a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#aaf121b2595ff71815c4e9db35247f951">oomph::TreeBasedRefineableMeshBase::Forest_pt</a></div><div class="ttdeci">TreeForest * Forest_pt</div><div class="ttdoc">Forest representation of the mesh.</div><div class="ttdef"><b>Definition:</b> refineable_mesh.h:768</div></div>
<div class="ttc" id="aclassoomph_1_1TreeBasedRefineableMeshBase_html_abd9b33d333c11837b3d2dbca163b6320"><div class="ttname"><a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#abd9b33d333c11837b3d2dbca163b6320">oomph::TreeBasedRefineableMeshBase::Min_p_refinement_level</a></div><div class="ttdeci">unsigned Min_p_refinement_level</div><div class="ttdoc">Min. permissible p-refinement level (relative to base mesh)</div><div class="ttdef"><b>Definition:</b> refineable_mesh.h:765</div></div>
<div class="ttc" id="aclassoomph_1_1TreeBasedRefineableMeshBase_html_acd1c5544779f42de66b25a0225644f7d"><div class="ttname"><a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#acd1c5544779f42de66b25a0225644f7d">oomph::TreeBasedRefineableMeshBase::Max_refinement_level</a></div><div class="ttdeci">unsigned Max_refinement_level</div><div class="ttdoc">Max. permissible refinement level (relative to base mesh)</div><div class="ttdef"><b>Definition:</b> refineable_mesh.h:756</div></div>
<div class="ttc" id="aclassoomph_1_1TreeBasedRefineableMeshBase_html_af48df64966833ed693c11576ff28ada1"><div class="ttname"><a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#af48df64966833ed693c11576ff28ada1">oomph::TreeBasedRefineableMeshBase::Min_refinement_level</a></div><div class="ttdeci">unsigned Min_refinement_level</div><div class="ttdoc">Min. permissible refinement level (relative to base mesh)</div><div class="ttdef"><b>Definition:</b> refineable_mesh.h:759</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a37561a1518733dc95a193e46b085f313">oomph::RefineableMeshBase::Doc_info_pt</a>, <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#aaf121b2595ff71815c4e9db35247f951">Forest_pt</a>, <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a39ab498ac06506e1500f9f03e8cecf72">Max_p_refinement_level</a>, <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#acd1c5544779f42de66b25a0225644f7d">Max_refinement_level</a>, <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#abd9b33d333c11837b3d2dbca163b6320">Min_p_refinement_level</a>, <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#af48df64966833ed693c11576ff28ada1">Min_refinement_level</a>, <a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a1a35c13c3c37ddc5ac2852217d903459">oomph::RefineableMeshBase::Nrefined</a>, <a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a62c0314a69b2e40355a2aa27ff5ea133">oomph::RefineableMeshBase::Nunrefined</a>, and <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a1a69da6d99f1776f53209940d40eaaa3">Uniform_refinement_level_when_pruned</a>.</p>

</div>
</div>
<a id="a8bd10419c1e0fba7742d486d3f4aa7a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bd10419c1e0fba7742d486d3f4aa7a2">&#9670;&nbsp;</a></span>TreeBasedRefineableMeshBase() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">oomph::TreeBasedRefineableMeshBase::TreeBasedRefineableMeshBase </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html">TreeBasedRefineableMeshBase</a> &amp;&#160;</td>
          <td class="paramname"><em>dummy</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Broken copy constructor. </p>

</div>
</div>
<a id="ab9edfe81d5b9fc03fbb98c5ff601a260"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9edfe81d5b9fc03fbb98c5ff601a260">&#9670;&nbsp;</a></span>~TreeBasedRefineableMeshBase()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual oomph::TreeBasedRefineableMeshBase::~TreeBasedRefineableMeshBase </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Empty Destructor: </p>
<div class="fragment"><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    {</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      <span class="comment">// Kill the forest if there is one</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#aaf121b2595ff71815c4e9db35247f951">Forest_pt</a> != 0)</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      {</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        <span class="keyword">delete</span> <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#aaf121b2595ff71815c4e9db35247f951">Forest_pt</a>;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#aaf121b2595ff71815c4e9db35247f951">Forest_pt</a> = 0;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      }</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#aaf121b2595ff71815c4e9db35247f951">Forest_pt</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ac98d4120b99d5c6cbcf7225a9ee5648d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac98d4120b99d5c6cbcf7225a9ee5648d">&#9670;&nbsp;</a></span>adapt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::TreeBasedRefineableMeshBase::adapt </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>elemental_error</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Adapt mesh: Refine elements whose error is lager than err_max and (try to) unrefine those whose error is smaller than err_min</p>
<p>Do adaptive refinement for mesh.</p><ul>
<li>Pass Vector of error estimates for all elements.</li>
<li>Refine those whose errors exceeds the threshold</li>
<li>(Try to) unrefine those whose errors is less than threshold (only possible if the three brothers also want to be unrefined, of course.)</li>
<li>Update the nodal positions in the whole lot</li>
<li>Store # of refined/unrefined elements.</li>
<li>Doc refinement process (if required) </li>
</ul>

<p>Implements <a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#aabe38fc56f2f12e91f2a2e8a4cf663b0">oomph::RefineableMeshBase</a>.</p>

<p>Reimplemented in <a class="el" href="../../df/d9b/classoomph_1_1RefineableQuadFromTriangleMesh.html#a7d2efa292dd5dd4930e661fd32e42eec">oomph::RefineableQuadFromTriangleMesh&lt; ELEMENT &gt;</a>.</p>
<div class="fragment"><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  {</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="comment">// Set the refinement tolerance to be the max permissible error</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordtype">double</span> refine_tol = <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#adb5ba9ac30bf0a0683eb30f5703800e4">max_permitted_error</a>();</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160; </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="comment">// Set the unrefinement tolerance to be the min permissible error</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keywordtype">double</span> unrefine_tol = <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#ad3a13bfaf687135d0154ce2f9b60edb7">min_permitted_error</a>();</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="comment">// Setup doc info</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    DocInfo local_doc_info;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a706216900b53bc7d9214e1f982e69309">doc_info_pt</a>() == 0)</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    {</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      local_doc_info.disable_doc();</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    }</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    {</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      local_doc_info = <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>();</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    }</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160; </div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="comment">// Check that the errors make sense</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keywordflow">if</span> (refine_tol &lt;= unrefine_tol)</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    {</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      std::ostringstream error_stream;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      error_stream &lt;&lt; <span class="stringliteral">&quot;Refinement tolerance &lt;= Unrefinement tolerance&quot;</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                   &lt;&lt; refine_tol &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; unrefine_tol &lt;&lt; std::endl</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;doesn&#39;t make sense and will almost certainly crash&quot;</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                   &lt;&lt; std::endl</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;this beautiful code!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    }</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160; </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="comment">// Select elements for refinement and unrefinement</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="comment">//================================================</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="comment">// Reset counter for number of elements that would like to be</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="comment">// refined further but can&#39;t</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#af189058782c7217f6d29a6f9555e7c3d">nrefinement_overruled</a>() = 0;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="comment">// Note: Yes, this needs to be a map because we&#39;ll have to check</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="comment">// the refinement wishes of brothers (who we only access via pointers)</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    std::map&lt;RefineableElement*, bool&gt; wants_to_be_unrefined;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160; </div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="comment">// Initialise a variable to store the number of elements for refinment</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keywordtype">unsigned</span> n_refine = 0;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160; </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="comment">// Loop over all elements and mark them according to the error criterion</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> Nelement = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">nelement</a>();</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; Nelement; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      <span class="comment">// (Cast) pointer to the element</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      RefineableElement* el_pt =</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="keyword">dynamic_cast&lt;</span>RefineableElement*<span class="keyword">&gt;</span>(this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ab28b03dabf4e247c4a25f834eb11b339">element_pt</a>(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>));</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160; </div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      <span class="comment">// Initially element is not to be refined</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      el_pt-&gt;deselect_for_refinement();</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160; </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      <span class="comment">// If the element error exceeds the threshold ...</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      <span class="keywordflow">if</span> (elemental_error[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>] &gt; refine_tol)</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      {</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <span class="comment">// ... and its refinement level is less than the maximum desired level</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        <span class="comment">// mark is to be refined</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        <span class="keywordflow">if</span> ((el_pt-&gt;refinement_is_enabled()) &amp;&amp;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;            (el_pt-&gt;refinement_level() &lt; <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a18bf22913dc5daf45fb3995d9ec30bfc">max_refinement_level</a>()))</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        {</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;          el_pt-&gt;select_for_refinement();</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;          n_refine++;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        }</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        <span class="comment">// ... otherwise mark it as having been over-ruled</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        {</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;          <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#af189058782c7217f6d29a6f9555e7c3d">nrefinement_overruled</a>() += 1;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        }</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      }</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      <span class="comment">// Now worry about unrefinement (first pass):</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160; </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      <span class="comment">// Is my error too small AND do I have a father?</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      <span class="keywordflow">if</span> ((elemental_error[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>] &lt; unrefine_tol) &amp;&amp;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;          (el_pt-&gt;tree_pt()-&gt;father_pt() != 0))</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      {</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <span class="comment">// Flag to indicate whether to unrefine</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <span class="keywordtype">bool</span> unrefine = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <span class="keywordtype">unsigned</span> n_sons = el_pt-&gt;tree_pt()-&gt;father_pt()-&gt;nsons();</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160; </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <span class="comment">// Are all brothers leaf nodes?</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ison = 0; ison &lt; n_sons; ison++)</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        {</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;          <span class="comment">// (At least) one brother is not a leaf: end of story; we&#39;re not doing</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;          <span class="comment">// it (= the unrefinement)</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;          <span class="keywordflow">if</span> (!(el_pt-&gt;tree_pt()-&gt;father_pt()-&gt;son_pt(ison)-&gt;is_leaf()))</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;          {</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;            unrefine = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;          }</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        }</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160; </div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        <span class="comment">// Don&#39;t allow unrefinement of elements that would become larger</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        <span class="comment">// than the minimum legal refinement level</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        <span class="keywordflow">if</span> (el_pt-&gt;refinement_level() - 1 &lt; <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#af3974421171e1bb10daf6864f0749675">min_refinement_level</a>())</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        {</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;          unrefine = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        }</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160; </div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        <span class="comment">// So, all things considered, is the element eligbible for refinement?</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        <span class="keywordflow">if</span> (unrefine)</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        {</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;          wants_to_be_unrefined[el_pt] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        }</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        {</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;          wants_to_be_unrefined[el_pt] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        }</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      }</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    }</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160; </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot; \n Number of elements to be refined: &quot;</span> &lt;&lt; n_refine</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;               &lt;&lt; std::endl;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot; \n Number of elements whose refinement was overruled: &quot;</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;               &lt;&lt; <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#af189058782c7217f6d29a6f9555e7c3d">nrefinement_overruled</a>() &lt;&lt; std::endl;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160; </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="comment">// Second pass for unrefinement --- an element cannot be unrefined unless</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="comment">// all brothers want to be unrefined.</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="comment">// Loop over all elements again and let the first set of sons check if their</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="comment">// brothers also want to be unrefined</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="keywordtype">unsigned</span> n_unrefine = 0;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; Nelement; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    {</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      <span class="comment">//(Cast) pointer to the element</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      RefineableElement* el_pt =</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        <span class="keyword">dynamic_cast&lt;</span>RefineableElement*<span class="keyword">&gt;</span>(this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ab28b03dabf4e247c4a25f834eb11b339">element_pt</a>(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>));</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160; </div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      <span class="comment">// hierher: This is a bit naughty... We want to put the</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      <span class="comment">// first son in charge -- the statement below assumes (correctly) that the</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      <span class="comment">// enumeration of all (!) trees starts with son types.</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;      <span class="comment">// This is correct for oc and quadtrees but will bite us if we</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      <span class="comment">// ever introduce other trees if/when we accidentally break this</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      <span class="comment">// tacit assumption. Not sure what to do about it for</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;      <span class="comment">// now other than leaving it hierher-ed...</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;      <span class="keywordflow">if</span> (el_pt-&gt;tree_pt()-&gt;son_type() == <a class="code" href="../../da/dee/namespaceoomph_1_1OcTreeNames.html#a1240bbd25e0b8bffa1171375f1c7183dabed39d2cabdadba8a0746381691ccf77">OcTreeNames::LDB</a>)</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;      {</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        <span class="comment">// Do all sons want to be unrefined?</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        <span class="keywordtype">bool</span> unrefine = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <span class="keywordtype">unsigned</span> n_sons = el_pt-&gt;tree_pt()-&gt;father_pt()-&gt;nsons();</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ison = 0; ison &lt; n_sons; ison++)</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        {</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;          <span class="keywordflow">if</span> (!(wants_to_be_unrefined[<span class="keyword">dynamic_cast&lt;</span>RefineableElement*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                el_pt-&gt;tree_pt()-&gt;father_pt()-&gt;son_pt(ison)-&gt;object_pt())]))</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;          {</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;            <span class="comment">// One guy isn&#39;t cooperating and spoils the party.</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;            unrefine = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;          }</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        }</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160; </div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        <span class="comment">// Tell father that his sons need to be merged</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <span class="keywordflow">if</span> (unrefine)</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        {</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;          el_pt-&gt;tree_pt()</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;            -&gt;father_pt()</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;            -&gt;object_pt()</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;            -&gt;select_sons_for_unrefinement();</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;          n_unrefine += n_sons;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        }</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <span class="comment">// Otherwise mark the sons as not to be touched</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        {</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;          el_pt-&gt;tree_pt()</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;            -&gt;father_pt()</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;            -&gt;object_pt()</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            -&gt;deselect_sons_for_unrefinement();</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        }</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      }</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    }</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot; \n Number of elements to be merged : &quot;</span> &lt;&lt; n_unrefine</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;               &lt;&lt; std::endl</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;               &lt;&lt; std::endl;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160; </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160; </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="comment">// Now do the actual mesh adaptation</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="comment">//---------------------------------</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160; </div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="comment">// Check whether its worth our while</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="comment">// Either some elements want to be refined,</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="comment">// or the number that want to be unrefined are greater than the</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="comment">// specified tolerance</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160; </div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="comment">// In a parallel job, it is possible that one process may not have</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="comment">// any elements to refine, BUT a neighbouring process may refine an</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="comment">// element which changes the hanging status of a node that is on</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="comment">// both processes (i.e. a halo(ed) node).  To get around this issue,</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="comment">// ALL processes need to call adapt_mesh if ANY refinement is to</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="comment">// take place anywhere.</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160; </div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="keywordtype">unsigned</span> total_n_refine = 0;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="comment">// Sum n_refine across all processors</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a1ab35b022b95f2d28c53aa58859bd6b5">is_mesh_distributed</a>())</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    {</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      MPI_Allreduce(&amp;n_refine,</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                    &amp;total_n_refine,</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                    1,</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                    MPI_UNSIGNED,</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                    MPI_SUM,</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                    Comm_pt-&gt;mpi_comm());</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    }</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    {</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      total_n_refine = n_refine;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    }</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    total_n_refine = n_refine;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160; </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <span class="comment">// There may be some issues with unrefinement too, but I have not</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="comment">// been able to come up with an example (either in my head or in a</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="comment">// particular problem) where anything has arisen. I can see that</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <span class="comment">// there may be an issue if n_unrefine differs across processes so</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="comment">// that (total_n_unrefine &gt; max_keep_unrefined()) on some but not</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="comment">// all processes. I haven&#39;t seen any examples of this yet so the</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="comment">// following code may or may not work!  (Andy, 06/03/08)</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160; </div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="keywordtype">unsigned</span> total_n_unrefine = 0;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="comment">// Sum n_unrefine across all processors</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a1ab35b022b95f2d28c53aa58859bd6b5">is_mesh_distributed</a>())</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    {</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;      MPI_Allreduce(&amp;n_unrefine,</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                    &amp;total_n_unrefine,</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                    1,</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                    MPI_UNSIGNED,</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                    MPI_SUM,</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                    Comm_pt-&gt;mpi_comm());</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    }</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    {</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;      total_n_unrefine = n_unrefine;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    }</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    total_n_unrefine = n_unrefine;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160; </div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;---&gt; &quot;</span> &lt;&lt; total_n_refine &lt;&lt; <span class="stringliteral">&quot; elements to be refined, and &quot;</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;               &lt;&lt; total_n_unrefine &lt;&lt; <span class="stringliteral">&quot; to be unrefined, in total.\n&quot;</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;               &lt;&lt; std::endl;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160; </div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="keywordflow">if</span> ((total_n_refine &gt; 0) || (total_n_unrefine &gt; <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a2216b4d0a8433a1975e6990a5e6533f7">max_keep_unrefined</a>()))</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    {</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160; </div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160; </div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;      <span class="comment">// Sanity check: Each processor checks if the enforced unrefinement of</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      <span class="comment">// its haloed element is matched by enforced unrefinement of the</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;      <span class="comment">// corresponding halo elements on the other processors.</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;      <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a1ab35b022b95f2d28c53aa58859bd6b5">is_mesh_distributed</a>())</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;      {</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        <span class="comment">// Store number of processors and current process</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        MPI_Status status;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        <span class="keywordtype">int</span> n_proc = Comm_pt-&gt;nproc();</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        <span class="keywordtype">int</span> my_rank = Comm_pt-&gt;my_rank();</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160; </div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        <span class="comment">// Loop over processes: Each processor sends unrefinement pattern</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        <span class="comment">// for halo elements with processor d to processor d where it&#39;s</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        <span class="comment">// compared against the unrefinement pattern for the corresponding</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        <span class="comment">// haloed elements</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; n_proc; d++)</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        {</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;          <span class="comment">// No halo with self: Send unrefinement info to proc d</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;          <span class="keywordflow">if</span> (d != my_rank)</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;          {</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;            <span class="comment">// Get the vector of halo elements whose non-halo counterpart</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;            <span class="comment">// are on processor d</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;            Vector&lt;GeneralisedElement*&gt; halo_elem_pt(this-&gt;halo_element_pt(d));</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160; </div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;            <span class="comment">// Create vector containing (0)1 to indicate that</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;            <span class="comment">// halo element is (not) to be unrefined</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;            <span class="keywordtype">unsigned</span> nhalo = halo_elem_pt.size();</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;            Vector&lt;int&gt; halo_to_be_unrefined(nhalo, 0);</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; nhalo; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;            {</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;              <span class="keywordflow">if</span> (<span class="keyword">dynamic_cast&lt;</span>RefineableElement*<span class="keyword">&gt;</span>(halo_elem_pt[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>])</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                    -&gt;sons_to_be_unrefined())</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;              {</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                halo_to_be_unrefined[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>] = 1;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;              }</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;            }</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160; </div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;            <span class="comment">// Trap the case when there are no halo elements</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;            <span class="comment">// so that we don&#39;t get a segfault in the MPI send</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;            <span class="keywordflow">if</span> (nhalo &gt; 0)</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;            {</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;              <span class="comment">// Send it across to proc d</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;              MPI_Send(&amp;halo_to_be_unrefined[0],</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                       nhalo,</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                       MPI_INT,</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                       d,</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                       0,</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                       Comm_pt-&gt;mpi_comm());</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;            }</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;          }</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;          <span class="comment">// else (d=my_rank): Receive unrefinement pattern from all</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;          <span class="comment">// other processors (dd)</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;          {</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;            <span class="comment">// Loop over other processors</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dd = 0; dd &lt; n_proc; dd++)</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;            {</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;              <span class="comment">// No halo with yourself</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;              <span class="keywordflow">if</span> (dd != d)</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;              {</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                <span class="comment">// Get the vector of haloed elements on current processor</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                <span class="comment">// with processor dd</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                Vector&lt;GeneralisedElement*&gt; haloed_elem_pt(</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                  this-&gt;haloed_element_pt(dd));</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160; </div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                <span class="comment">// Ask processor dd to send vector containing (0)1 for</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                <span class="comment">// halo element with current processor to be (not)unrefined</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                <span class="keywordtype">unsigned</span> nhaloed = haloed_elem_pt.size();</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                Vector&lt;int&gt; halo_to_be_unrefined(nhaloed);</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                <span class="comment">// Trap to catch the case that there are no haloed elements</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                <span class="keywordflow">if</span> (nhaloed &gt; 0)</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                {</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                  <span class="comment">// Receive unrefinement pattern of haloes from proc dd</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                  MPI_Recv(&amp;halo_to_be_unrefined[0],</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                           nhaloed,</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                           MPI_INT,</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                           dd,</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                           0,</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                           Comm_pt-&gt;mpi_comm(),</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                           &amp;status);</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                }</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160; </div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                <span class="comment">// Check it</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; nhaloed; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                {</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                  <span class="keywordflow">if</span> (((halo_to_be_unrefined[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>] == 0) &amp;&amp;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                       (<span class="keyword">dynamic_cast&lt;</span>RefineableElement*<span class="keyword">&gt;</span>(haloed_elem_pt[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>])</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                          -&gt;sons_to_be_unrefined())) ||</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                      ((halo_to_be_unrefined[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>] == 1) &amp;&amp;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                       (!<span class="keyword">dynamic_cast&lt;</span>RefineableElement*<span class="keyword">&gt;</span>(haloed_elem_pt[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>])</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                           -&gt;sons_to_be_unrefined())))</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                  {</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                    std::ostringstream error_message;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                    error_message</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;Error in unrefinement: \n&quot;</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;Haloed element: &quot;</span> &lt;&lt; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt;&lt; <span class="stringliteral">&quot; on proc &quot;</span> &lt;&lt; my_rank</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot; \n&quot;</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;wants to be unrefined whereas its halo counterpart &quot;</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                         <span class="stringliteral">&quot;on\n&quot;</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;proc &quot;</span> &lt;&lt; dd &lt;&lt; <span class="stringliteral">&quot; doesn&#39;t (or vice versa)...\n&quot;</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;This is most likely because the error estimator\n&quot;</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;has not assigned the same errors to halo and haloed\n&quot;</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;elements -- it ought to!\n&quot;</span>;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                    <span class="keywordflow">throw</span> OomphLibError(error_message.str(),</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                                        <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                                        <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                  }</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                }</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;              }</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;            }</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;          }</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        }</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160; </div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160; </div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        <span class="comment">// Loop over processes: Each processor sends refinement pattern</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        <span class="comment">// for halo elements with processor d to processor d where it&#39;s</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        <span class="comment">// compared against the refinement pattern for the corresponding</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        <span class="comment">// haloed elements</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; n_proc; d++)</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        {</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;          <span class="comment">// No halo with self: Send refinement info to proc d</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;          <span class="keywordflow">if</span> (d != my_rank)</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;          {</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;            <span class="comment">// Get the vector of halo elements whose non-halo counterpart</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;            <span class="comment">// are on processor d</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;            Vector&lt;GeneralisedElement*&gt; halo_elem_pt(this-&gt;halo_element_pt(d));</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160; </div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;            <span class="comment">// Create vector containing (0)1 to indicate that</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;            <span class="comment">// halo element is (not) to be refined</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;            <span class="keywordtype">unsigned</span> nhalo = halo_elem_pt.size();</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;            Vector&lt;int&gt; halo_to_be_refined(nhalo, 0);</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; nhalo; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;            {</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;              <span class="keywordflow">if</span> (<span class="keyword">dynamic_cast&lt;</span>RefineableElement*<span class="keyword">&gt;</span>(halo_elem_pt[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>])</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                    -&gt;to_be_refined())</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;              {</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                halo_to_be_refined[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>] = 1;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;              }</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;            }</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160; </div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;            <span class="comment">// Trap the case when there are no halo elements</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;            <span class="comment">// so that we don&#39;t get a segfault in the MPI send</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;            <span class="keywordflow">if</span> (nhalo &gt; 0)</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;            {</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;              <span class="comment">// Send it across to proc d</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;              MPI_Send(&amp;halo_to_be_refined[0],</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                       nhalo,</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                       MPI_INT,</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                       d,</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                       0,</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                       Comm_pt-&gt;mpi_comm());</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;            }</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;          }</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;          <span class="comment">// else (d=my_rank): Receive refinement pattern from all</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;          <span class="comment">// other processors (dd)</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;          {</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;            <span class="comment">// Loop over other processors</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dd = 0; dd &lt; n_proc; dd++)</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;            {</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;              <span class="comment">// No halo with yourself</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;              <span class="keywordflow">if</span> (dd != d)</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;              {</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                <span class="comment">// Get the vector of haloed elements on current processor</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                <span class="comment">// with processor dd</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                Vector&lt;GeneralisedElement*&gt; haloed_elem_pt(</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                  this-&gt;haloed_element_pt(dd));</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160; </div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                <span class="comment">// Ask processor dd to send vector containing (0)1 for</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                <span class="comment">// halo element with current processor to be (not)refined</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                <span class="keywordtype">unsigned</span> nhaloed = haloed_elem_pt.size();</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                Vector&lt;int&gt; halo_to_be_refined(nhaloed);</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                <span class="comment">// Trap to catch the case that there are no haloed elements</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                <span class="keywordflow">if</span> (nhaloed &gt; 0)</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                {</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                  <span class="comment">// Receive unrefinement pattern of haloes from proc dd</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                  MPI_Recv(&amp;halo_to_be_refined[0],</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                           nhaloed,</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                           MPI_INT,</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                           dd,</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                           0,</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                           Comm_pt-&gt;mpi_comm(),</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                           &amp;status);</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                }</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160; </div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                <span class="comment">// Check it</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; nhaloed; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                {</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                  <span class="keywordflow">if</span> (((halo_to_be_refined[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>] == 0) &amp;&amp;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                       (<span class="keyword">dynamic_cast&lt;</span>RefineableElement*<span class="keyword">&gt;</span>(haloed_elem_pt[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>])</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                          -&gt;to_be_refined())) ||</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                      ((halo_to_be_refined[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>] == 1) &amp;&amp;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                       (!<span class="keyword">dynamic_cast&lt;</span>RefineableElement*<span class="keyword">&gt;</span>(haloed_elem_pt[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>])</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                           -&gt;to_be_refined())))</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                  {</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                    std::ostringstream error_message;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                    error_message</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;Error in refinement: \n&quot;</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;Haloed element: &quot;</span> &lt;&lt; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt;&lt; <span class="stringliteral">&quot; on proc &quot;</span> &lt;&lt; my_rank</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot; \n&quot;</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;wants to be refined whereas its halo counterpart on\n&quot;</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;proc &quot;</span> &lt;&lt; dd &lt;&lt; <span class="stringliteral">&quot; doesn&#39;t (or vice versa)...\n&quot;</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;This is most likely because the error estimator\n&quot;</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;has not assigned the same errors to halo and haloed\n&quot;</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;elements -- it ought to!\n&quot;</span>;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                    <span class="keywordflow">throw</span> OomphLibError(error_message.str(),</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                                        <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                                        <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                  }</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                }</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;              }</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;            }</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;          }</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        }</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;      }</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160; </div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160; </div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;      <span class="comment">// Perform the actual adaptation</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;      <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a64608ddedb7eb56e11bee2805aa01360">adapt_mesh</a>(local_doc_info);</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160; </div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;      <span class="comment">// The number of refineable elements is still local to each process</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;      <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a62c0314a69b2e40355a2aa27ff5ea133">Nunrefined</a> = n_unrefine;</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;      <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a1a35c13c3c37ddc5ac2852217d903459">Nrefined</a> = n_refine;</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    }</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    <span class="comment">// If not worthwhile, say so but still reorder nodes and kill</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <span class="comment">// external storage for consistency in parallel computations</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    {</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;      <span class="comment">// Delete any external element storage - any interaction will still</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;      <span class="comment">// be set up on the fly again, so we need to get rid of old information.</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;      <span class="comment">// This particularly causes problems in multi-domain examples where</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;      <span class="comment">// we decide not to refine one of the meshes</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;      this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a9e3ecb07dc622cf37ce0085446ff9aa6">delete_all_external_storage</a>();</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160; </div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;      <span class="comment">// Reorder the nodes within the mesh&#39;s node vector</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;      <span class="comment">// to establish a standard ordering regardless of the sequence</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;      <span class="comment">// of mesh refinements -- this is required to allow dump/restart</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;      <span class="comment">// on refined meshes</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;      this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a801e77424d1bf8a35c9bba055230f1e3">reorder_nodes</a>();</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160; </div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160; </div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;      <span class="comment">// Now (re-)classify halo and haloed nodes and synchronise hanging</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;      <span class="comment">// nodes</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;      <span class="comment">// This is required in cases where delete_all_external_storage()</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;      <span class="comment">// made dependent nodes to external halo nodes nonhanging.</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;      <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a1ab35b022b95f2d28c53aa58859bd6b5">is_mesh_distributed</a>())</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;      {</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;        DocInfo <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>;</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;        <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>.<a class="code" href="../../d7/d2c/classoomph_1_1DocInfo.html#a666a20817ab9c396b225d8652bc0a338">disable_doc</a>();</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        classify_halo_and_haloed_nodes(<a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>, <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>.<a class="code" href="../../d7/d2c/classoomph_1_1DocInfo.html#a2ce90cf54f24b4ab523c624031fbb76b">is_doc_enabled</a>());</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;      }</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160; </div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160; </div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;      <span class="keywordflow">if</span> (n_refine == 0)</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;      {</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot; Not enough benefit in adapting mesh.&quot;</span> &lt;&lt; std::endl</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                   &lt;&lt; std::endl;</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;      }</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;      <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a62c0314a69b2e40355a2aa27ff5ea133">Nunrefined</a> = 0;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;      <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a1a35c13c3c37ddc5ac2852217d903459">Nrefined</a> = 0;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    }</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;  }</div>
<div class="ttc" id="aCwise__array__power__array_8cpp_html_a9eb5e92d9d691c1393e5e7c914731dbf"><div class="ttname"><a href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a></div><div class="ttdeci">Array&lt; double, 1, 3 &gt; e(1./3., 0.5, 2.)</div></div>
<div class="ttc" id="aclassoomph_1_1DocInfo_html_a2ce90cf54f24b4ab523c624031fbb76b"><div class="ttname"><a href="../../d7/d2c/classoomph_1_1DocInfo.html#a2ce90cf54f24b4ab523c624031fbb76b">oomph::DocInfo::is_doc_enabled</a></div><div class="ttdeci">bool is_doc_enabled() const</div><div class="ttdoc">Are we documenting?</div><div class="ttdef"><b>Definition:</b> oomph_utilities.h:548</div></div>
<div class="ttc" id="aclassoomph_1_1DocInfo_html_a666a20817ab9c396b225d8652bc0a338"><div class="ttname"><a href="../../d7/d2c/classoomph_1_1DocInfo.html#a666a20817ab9c396b225d8652bc0a338">oomph::DocInfo::disable_doc</a></div><div class="ttdeci">void disable_doc()</div><div class="ttdoc">Disable documentation.</div><div class="ttdef"><b>Definition:</b> oomph_utilities.h:542</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_a1ab35b022b95f2d28c53aa58859bd6b5"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#a1ab35b022b95f2d28c53aa58859bd6b5">oomph::Mesh::is_mesh_distributed</a></div><div class="ttdeci">bool is_mesh_distributed() const</div><div class="ttdoc">Boolean to indicate if Mesh has been distributed.</div><div class="ttdef"><b>Definition:</b> mesh.h:1588</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_a801e77424d1bf8a35c9bba055230f1e3"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#a801e77424d1bf8a35c9bba055230f1e3">oomph::Mesh::reorder_nodes</a></div><div class="ttdeci">virtual void reorder_nodes(const bool &amp;use_old_ordering=true)</div><div class="ttdef"><b>Definition:</b> mesh.cc:508</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_a9e3ecb07dc622cf37ce0085446ff9aa6"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#a9e3ecb07dc622cf37ce0085446ff9aa6">oomph::Mesh::delete_all_external_storage</a></div><div class="ttdeci">void delete_all_external_storage()</div><div class="ttdoc">Wipe the storage for all externally-based elements.</div><div class="ttdef"><b>Definition:</b> mesh.cc:9190</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_ab28b03dabf4e247c4a25f834eb11b339"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#ab28b03dabf4e247c4a25f834eb11b339">oomph::Mesh::element_pt</a></div><div class="ttdeci">const Vector&lt; GeneralisedElement * &gt; &amp; element_pt() const</div><div class="ttdoc">Return reference to the Vector of elements.</div><div class="ttdef"><b>Definition:</b> mesh.h:460</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_af01dfefb66c15579b540be62999d93ee"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">oomph::Mesh::nelement</a></div><div class="ttdeci">unsigned long nelement() const</div><div class="ttdoc">Return number of elements in the mesh.</div><div class="ttdef"><b>Definition:</b> mesh.h:590</div></div>
<div class="ttc" id="aclassoomph_1_1RefineableMeshBase_html_a2216b4d0a8433a1975e6990a5e6533f7"><div class="ttname"><a href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a2216b4d0a8433a1975e6990a5e6533f7">oomph::RefineableMeshBase::max_keep_unrefined</a></div><div class="ttdeci">unsigned &amp; max_keep_unrefined()</div><div class="ttdef"><b>Definition:</b> refineable_mesh.h:123</div></div>
<div class="ttc" id="aclassoomph_1_1RefineableMeshBase_html_a266f8b2a1499cc2ae7b24b19813923ee"><div class="ttname"><a href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">oomph::RefineableMeshBase::doc_info</a></div><div class="ttdeci">DocInfo doc_info()</div><div class="ttdoc">Access fct for DocInfo.</div><div class="ttdef"><b>Definition:</b> refineable_mesh.h:243</div></div>
<div class="ttc" id="aclassoomph_1_1RefineableMeshBase_html_a706216900b53bc7d9214e1f982e69309"><div class="ttname"><a href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a706216900b53bc7d9214e1f982e69309">oomph::RefineableMeshBase::doc_info_pt</a></div><div class="ttdeci">DocInfo *&amp; doc_info_pt()</div><div class="ttdoc">Access fct for pointer to DocInfo.</div><div class="ttdef"><b>Definition:</b> refineable_mesh.h:183</div></div>
<div class="ttc" id="aclassoomph_1_1RefineableMeshBase_html_ad3a13bfaf687135d0154ce2f9b60edb7"><div class="ttname"><a href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#ad3a13bfaf687135d0154ce2f9b60edb7">oomph::RefineableMeshBase::min_permitted_error</a></div><div class="ttdeci">double &amp; min_permitted_error()</div><div class="ttdef"><b>Definition:</b> refineable_mesh.h:156</div></div>
<div class="ttc" id="aclassoomph_1_1RefineableMeshBase_html_adb5ba9ac30bf0a0683eb30f5703800e4"><div class="ttname"><a href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#adb5ba9ac30bf0a0683eb30f5703800e4">oomph::RefineableMeshBase::max_permitted_error</a></div><div class="ttdeci">double &amp; max_permitted_error()</div><div class="ttdef"><b>Definition:</b> refineable_mesh.h:163</div></div>
<div class="ttc" id="aclassoomph_1_1RefineableMeshBase_html_af189058782c7217f6d29a6f9555e7c3d"><div class="ttname"><a href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#af189058782c7217f6d29a6f9555e7c3d">oomph::RefineableMeshBase::nrefinement_overruled</a></div><div class="ttdeci">unsigned &amp; nrefinement_overruled()</div><div class="ttdef"><b>Definition:</b> refineable_mesh.h:114</div></div>
<div class="ttc" id="aclassoomph_1_1TreeBasedRefineableMeshBase_html_a18bf22913dc5daf45fb3995d9ec30bfc"><div class="ttname"><a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a18bf22913dc5daf45fb3995d9ec30bfc">oomph::TreeBasedRefineableMeshBase::max_refinement_level</a></div><div class="ttdeci">unsigned &amp; max_refinement_level()</div><div class="ttdoc">Access fct for max. permissible refinement level (relative to base mesh)</div><div class="ttdef"><b>Definition:</b> refineable_mesh.h:486</div></div>
<div class="ttc" id="aclassoomph_1_1TreeBasedRefineableMeshBase_html_a64608ddedb7eb56e11bee2805aa01360"><div class="ttname"><a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a64608ddedb7eb56e11bee2805aa01360">oomph::TreeBasedRefineableMeshBase::adapt_mesh</a></div><div class="ttdeci">virtual void adapt_mesh()</div><div class="ttdef"><b>Definition:</b> refineable_mesh.h:517</div></div>
<div class="ttc" id="aclassoomph_1_1TreeBasedRefineableMeshBase_html_af3974421171e1bb10daf6864f0749675"><div class="ttname"><a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#af3974421171e1bb10daf6864f0749675">oomph::TreeBasedRefineableMeshBase::min_refinement_level</a></div><div class="ttdeci">unsigned &amp; min_refinement_level()</div><div class="ttdoc">Access fct for min. permissible refinement level (relative to base mesh)</div><div class="ttdef"><b>Definition:</b> refineable_mesh.h:492</div></div>
<div class="ttc" id="anamespaceoomph_1_1OcTreeNames_html_a1240bbd25e0b8bffa1171375f1c7183dabed39d2cabdadba8a0746381691ccf77"><div class="ttname"><a href="../../da/dee/namespaceoomph_1_1OcTreeNames.html#a1240bbd25e0b8bffa1171375f1c7183dabed39d2cabdadba8a0746381691ccf77">oomph::OcTreeNames::LDB</a></div><div class="ttdeci">@ LDB</div><div class="ttdef"><b>Definition:</b> octree.h:49</div></div>
<div class="ttc" id="anamespaceoomph_html_aec474227917784dc0a255faf289cfc16"><div class="ttname"><a href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a></div><div class="ttdeci">OomphInfo oomph_info</div><div class="ttdef"><b>Definition:</b> oomph_definitions.cc:319</div></div>
<div class="ttc" id="aoomph__definitions_8h_html_a25c6813cc7341d125e2502f8923fb6c4"><div class="ttname"><a href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a></div><div class="ttdeci">#define OOMPH_EXCEPTION_LOCATION</div><div class="ttdef"><b>Definition:</b> oomph_definitions.h:61</div></div>
<div class="ttc" id="aoomph__definitions_8h_html_aa260cc4af589e30cea7fde997ae16667"><div class="ttname"><a href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a></div><div class="ttdeci">#define OOMPH_CURRENT_FUNCTION</div><div class="ttdef"><b>Definition:</b> oomph_definitions.h:86</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a64608ddedb7eb56e11bee2805aa01360">adapt_mesh()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a9e3ecb07dc622cf37ce0085446ff9aa6">oomph::Mesh::delete_all_external_storage()</a>, <a class="el" href="../../dc/d08/classoomph_1_1RefineableElement.html#a984bf7bf6132e11648e3e54845d852b7">oomph::RefineableElement::deselect_for_refinement()</a>, <a class="el" href="../../dc/d08/classoomph_1_1RefineableElement.html#afa0572f14ecd9cc2021f853218d7a659">oomph::RefineableElement::deselect_sons_for_unrefinement()</a>, <a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html#a666a20817ab9c396b225d8652bc0a338">oomph::DocInfo::disable_doc()</a>, <a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">oomph::RefineableMeshBase::doc_info()</a>, <a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a706216900b53bc7d9214e1f982e69309">oomph::RefineableMeshBase::doc_info_pt()</a>, <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ab28b03dabf4e247c4a25f834eb11b339">oomph::Mesh::element_pt()</a>, <a class="el" href="../../dd/d99/classoomph_1_1Tree.html#a5f8444ddeda272b70669b8bbe929708a">oomph::Tree::father_pt()</a>, <a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html#a2ce90cf54f24b4ab523c624031fbb76b">oomph::DocInfo::is_doc_enabled()</a>, <a class="el" href="../../dd/d99/classoomph_1_1Tree.html#a72000456c76880e3f78f8f8fb43d49d8">oomph::Tree::is_leaf()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a1ab35b022b95f2d28c53aa58859bd6b5">oomph::Mesh::is_mesh_distributed()</a>, <a class="el" href="../../da/dee/namespaceoomph_1_1OcTreeNames.html#a1240bbd25e0b8bffa1171375f1c7183dabed39d2cabdadba8a0746381691ccf77">oomph::OcTreeNames::LDB</a>, <a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a2216b4d0a8433a1975e6990a5e6533f7">oomph::RefineableMeshBase::max_keep_unrefined()</a>, <a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#adb5ba9ac30bf0a0683eb30f5703800e4">oomph::RefineableMeshBase::max_permitted_error()</a>, <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a18bf22913dc5daf45fb3995d9ec30bfc">max_refinement_level()</a>, <a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#ad3a13bfaf687135d0154ce2f9b60edb7">oomph::RefineableMeshBase::min_permitted_error()</a>, <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#af3974421171e1bb10daf6864f0749675">min_refinement_level()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">oomph::Mesh::nelement()</a>, <a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a1a35c13c3c37ddc5ac2852217d903459">oomph::RefineableMeshBase::Nrefined</a>, <a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#af189058782c7217f6d29a6f9555e7c3d">oomph::RefineableMeshBase::nrefinement_overruled()</a>, <a class="el" href="../../dd/d99/classoomph_1_1Tree.html#a31e4123b40f6fb52d180a154c9123e85">oomph::Tree::nsons()</a>, <a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a62c0314a69b2e40355a2aa27ff5ea133">oomph::RefineableMeshBase::Nunrefined</a>, <a class="el" href="../../dd/d99/classoomph_1_1Tree.html#a2f2eeb0f1dd161f696cccc652974ff4c">oomph::Tree::object_pt()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, <a class="el" href="../../dc/d08/classoomph_1_1RefineableElement.html#a8f5e9e69342ed6258c6f450fec4d0999">oomph::RefineableElement::refinement_is_enabled()</a>, <a class="el" href="../../dc/d08/classoomph_1_1RefineableElement.html#a6b9153d7933baf6092febaca278a6fc7">oomph::RefineableElement::refinement_level()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a801e77424d1bf8a35c9bba055230f1e3">oomph::Mesh::reorder_nodes()</a>, <a class="el" href="../../dc/d08/classoomph_1_1RefineableElement.html#a2a129d9c143cb0bb330c1bcba0343826">oomph::RefineableElement::select_for_refinement()</a>, <a class="el" href="../../dc/d08/classoomph_1_1RefineableElement.html#a0f756235a17399d9175e05b29efed292">oomph::RefineableElement::select_sons_for_unrefinement()</a>, <a class="el" href="../../dd/d99/classoomph_1_1Tree.html#ab2ca6416d7a368e29da6a6a998f460c7">oomph::Tree::son_pt()</a>, <a class="el" href="../../dd/d99/classoomph_1_1Tree.html#a7537f8fe7c896d2220eb2da03567b34d">oomph::Tree::son_type()</a>, and <a class="el" href="../../dc/d08/classoomph_1_1RefineableElement.html#a17201434f10a993b2ac5ba2bccd9c2b7">oomph::RefineableElement::tree_pt()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a52940028ba9f6472df7e7c65be265057">unrefine_uniformly()</a>.</p>

</div>
</div>
<a id="a64608ddedb7eb56e11bee2805aa01360"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64608ddedb7eb56e11bee2805aa01360">&#9670;&nbsp;</a></span>adapt_mesh() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void oomph::TreeBasedRefineableMeshBase::adapt_mesh </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Perform the actual tree-based mesh adaptation. A simple wrapper to call the function without documentation. </p>
<div class="fragment"><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    {</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      <span class="comment">// Create a dummy doc_info object</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;      DocInfo <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;      <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>.<a class="code" href="../../d7/d2c/classoomph_1_1DocInfo.html#a85d58bcfce0a7b7cae461624e6fcd08a">directory</a>() = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;      <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>.<a class="code" href="../../d7/d2c/classoomph_1_1DocInfo.html#a666a20817ab9c396b225d8652bc0a338">disable_doc</a>();</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;      <span class="comment">// Call the other adapt mesh</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;      <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a64608ddedb7eb56e11bee2805aa01360">adapt_mesh</a>(<a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>);</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1DocInfo_html_a85d58bcfce0a7b7cae461624e6fcd08a"><div class="ttname"><a href="../../d7/d2c/classoomph_1_1DocInfo.html#a85d58bcfce0a7b7cae461624e6fcd08a">oomph::DocInfo::directory</a></div><div class="ttdeci">std::string directory() const</div><div class="ttdoc">Output directory.</div><div class="ttdef"><b>Definition:</b> oomph_utilities.h:524</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html#a85d58bcfce0a7b7cae461624e6fcd08a">oomph::DocInfo::directory()</a>, <a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html#a666a20817ab9c396b225d8652bc0a338">oomph::DocInfo::disable_doc()</a>, and <a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">oomph::RefineableMeshBase::doc_info()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#ac98d4120b99d5c6cbcf7225a9ee5648d">adapt()</a>, <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a13548e57b680c5e7466d1deeb8f12ff0">refine_base_mesh()</a>, <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a171be4c171cc60de5831f6a2ffaf278e">refine_selected_elements()</a>, and <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#ae238476195a0ceeb2cdb680620fb97a3">refine_uniformly()</a>.</p>

</div>
</div>
<a id="acef8ac2f0f2cffe938031db1499c598b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acef8ac2f0f2cffe938031db1499c598b">&#9670;&nbsp;</a></span>adapt_mesh() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::TreeBasedRefineableMeshBase::adapt_mesh </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>doc_info</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Perform the actual tree-based mesh adaptation, documenting the progress in the directory specified in DocInfo object.</p>
<p>Adapt mesh, which exists in two representations, namely as:</p><ul>
<li>a FE mesh</li>
<li>a forest of Oc or QuadTrees</li>
</ul>
<p>Refinement/derefinement process is documented (in tecplot-able form) if requested.</p>
<p>Procedure:</p><ul>
<li>Loop over all elements and do the refinement for those who want to be refined. Note: Refinement/splitting only allocates elements but doesn't build them.</li>
<li>Build the new elements (i.e. give them nodes (create new ones where necessary), assign boundary conditions, and add nodes to mesh and mesh boundaries.</li>
<li>For all nodes that were hanging on the previous mesh (and are still marked as such), fill in their nodal values (consistent with the current hanging node scheme) to make sure they are fully functional, should they have become non-hanging during the mesh-adaptation. Then mark the nodes as non-hanging.</li>
<li>Unrefine selected elements (which may cause nodes to be re-built).</li>
<li>Add the new elements to the mesh (by completely overwriting the old Vector of elements).</li>
<li>Delete any nodes that have become obsolete.</li>
<li>Mark up hanging nodes and setup hanging node scheme (incl. recursive cleanup for hanging nodes that depend on other hanging nodes).</li>
<li>Adjust position of hanging nodes to make sure their position is consistent with the FE-based represenetation of their larger neighbours.</li>
<li>run a quick self-test on the neighbour finding scheme and check the integrity of the elements (if PARANOID)</li>
<li>doc hanging node status, boundary conditions, neighbour scheme if requested.</li>
</ul>
<p>After adaptation, all nodes (whether new or old) have up-to-date current and previous values.</p>
<p>If refinement process is being documented, the following information is documented:</p><ul>
<li>The files<ul>
<li>"neighbours.dat"</li>
<li>"all_nodes.dat"</li>
<li>"new_nodes.dat"</li>
<li>"hang_nodes_*.dat" where the * denotes a direction (n,s,e,w) in 2D or (r,l,u,d,f,b) in 3D</li>
</ul>
</li>
</ul>
<p>can be viewed with</p><ul>
<li>QHangingNodes.mcr</li>
</ul>
<ul>
<li>The file<ul>
<li>"hangnodes_withmasters.dat"</li>
</ul>
</li>
</ul>
<p>can be viewed with</p><ul>
<li>QHangingNodesWithMasters.mcr</li>
</ul>
<p>to check the hanging node status.</p><ul>
<li>The neighbour status of the elements is documented in<ul>
<li>"neighbours.dat"</li>
</ul>
</li>
</ul>
<p>and can be viewed with</p><ul>
<li>QuadTreeNeighbours.mcr</li>
</ul>
<p>Update the boundary element info &ndash; this can be a costly procedure and for this reason the mesh writer might have decided not to set up this scheme. If so, we won't change this and suppress its creation...</p>
<div class="fragment"><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;  {</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    <span class="comment">// Delete any external element storage before performing the adaptation</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    <span class="comment">// (in particular, external halo nodes that are on mesh boundaries)</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a9e3ecb07dc622cf37ce0085446ff9aa6">delete_all_external_storage</a>();</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160; </div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    <span class="comment">// Only perform the adapt step if the mesh has any elements.  This is</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <span class="comment">// relevant in a distributed problem with multiple meshes, where a</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    <span class="comment">// particular process may not have any elements on a particular submesh.</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">nelement</a>() &gt; 0)</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    {</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;      <span class="comment">// Pointer to mesh needs to be passed to some functions</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;      <a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#aa4a64cb23aa881dbd67c1b633173494f">Mesh</a>* mesh_pt = <span class="keyword">this</span>;</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160; </div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;      <span class="keywordtype">double</span> t_start = 0.0;</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;      {</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;        t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;      }</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160; </div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;      <span class="comment">// Do refinement(=splitting) of elements that have been selected</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;      <span class="comment">// This function encapsulates the template parameter</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;      this-&gt;<a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a86dace1f78991fb9b401a31215df89ef">split_elements_if_required</a>();</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160; </div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160; </div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;      {</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;        <span class="keywordtype">double</span> t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for split_elements_if_required: &quot;</span> &lt;&lt; t_end - t_start</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                   &lt;&lt; std::endl;</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;        t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;      }</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160; </div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;      <span class="comment">// Now elements have been created -- build all the leaves</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;      <span class="comment">//-------------------------------------------------------</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;      <span class="comment">// Firstly put all the elements into a vector</span></div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;      Vector&lt;Tree*&gt; leaf_nodes_pt;</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;      <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#aaf121b2595ff71815c4e9db35247f951">Forest_pt</a>-&gt;<a class="code" href="../../d2/d36/classoomph_1_1TreeForest.html#a6d99d1f513a60b9bd053ff98699cbe52">stick_leaves_into_vector</a>(leaf_nodes_pt);</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160; </div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160; </div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;      {</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        <span class="keywordtype">double</span> t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for stick_leaves_into_vector: &quot;</span> &lt;&lt; t_end - t_start</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                   &lt;&lt; std::endl;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;      }</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160; </div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;      <span class="comment">// If we are documenting the output, create the filename</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;      std::ostringstream fullname;</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;      std::ofstream new_nodes_file;</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>.<a class="code" href="../../d7/d2c/classoomph_1_1DocInfo.html#a2ce90cf54f24b4ab523c624031fbb76b">is_doc_enabled</a>())</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;      {</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        fullname &lt;&lt; <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>.<a class="code" href="../../d7/d2c/classoomph_1_1DocInfo.html#a85d58bcfce0a7b7cae461624e6fcd08a">directory</a>() &lt;&lt; <span class="stringliteral">&quot;/new_nodes&quot;</span> &lt;&lt; <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>.<a class="code" href="../../d7/d2c/classoomph_1_1DocInfo.html#af27224b25da5b758442753f0947e62d4">number</a>()</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;.dat&quot;</span>;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        new_nodes_file.open(fullname.str().c_str());</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;      }</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160; </div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160; </div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;      <span class="comment">// Build all elements and store vector of pointers to new nodes</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;      <span class="comment">// (Note: build() checks if the element has been built</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;      <span class="comment">// already, i.e. if it&#39;s not a new element).</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;      Vector&lt;Node*&gt; new_node_pt;</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;      <span class="keywordtype">bool</span> was_already_built;</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> num_tree_nodes = leaf_nodes_pt.size();</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; num_tree_nodes; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;      {</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;        <span class="comment">// Pre-build must be performed before any elements are built</span></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;        leaf_nodes_pt[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>]-&gt;object_pt()-&gt;pre_build(mesh_pt, new_node_pt);</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;      }</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; num_tree_nodes; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;      {</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;        <span class="comment">// Now do the actual build of the new elements</span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;        leaf_nodes_pt[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>]-&gt;object_pt()-&gt;build(</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;          mesh_pt, new_node_pt, was_already_built, new_nodes_file);</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;      }</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160; </div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160; </div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;      <span class="keywordtype">double</span> t_end = 0.0;</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;      {</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;        t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for building &quot;</span> &lt;&lt; num_tree_nodes</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot; new elements: &quot;</span> &lt;&lt; t_end - t_start &lt;&lt; std::endl;</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;        t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;      }</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160; </div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;      <span class="comment">// Close the new nodes files, if it was opened</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>.<a class="code" href="../../d7/d2c/classoomph_1_1DocInfo.html#a2ce90cf54f24b4ab523c624031fbb76b">is_doc_enabled</a>())</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;      {</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;        new_nodes_file.close();</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;      }</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160; </div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;      <span class="comment">// Loop over all nodes in mesh and free the dofs of those that were</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;      <span class="comment">//-----------------------------------------------------------------</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;      <span class="comment">// pinned only because they were hanging nodes. Also update their</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;      <span class="comment">//-----------------------------------------------------------------</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;      <span class="comment">// nodal values so that they contain data that is consistent</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;      <span class="comment">//----------------------------------------------------------</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;      <span class="comment">// with the hanging node representation</span></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;      <span class="comment">//-------------------------------------</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;      <span class="comment">// (Even if the nodal data isn&#39;t actually accessed because the node</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;      <span class="comment">// is still hanging -- we don&#39;t know this yet, and this step makes</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;      <span class="comment">// sure that all nodes are fully functional and up-to-date, should</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;      <span class="comment">// they become non-hanging below).</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;      <span class="comment">// However, if we have a fixed mesh and hanging nodes on the boundary</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;      <span class="comment">// become non-hanging they will not necessarily respect the curvilinear</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;      <span class="comment">// boundaries. This can only happen in 3D of course because it is not</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;      <span class="comment">// possible to have hanging nodes on boundaries in 2D.</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;      <span class="comment">// The solution is to store those nodes on the boundaries that are</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;      <span class="comment">// currently hanging and then check to see whether they have changed</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;      <span class="comment">// status at the end of the refinement procedure.</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;      <span class="comment">// If it has changed, then we need to adjust their positions.</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_boundary = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a84543564d6babe4faacbb9d87043fc19">nboundary</a>();</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> mesh_dim = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a4f274774435e9454bf77bf70de69367a">finite_element_pt</a>(0)-&gt;<a class="code" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">dim</a>();</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;      Vector&lt;std::set&lt;Node*&gt;&gt; hanging_nodes_on_boundary_pt(n_boundary);</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160; </div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n_node = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a945e7823d1a2af243b5b7f7866aaff5e">nnode</a>();</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_node; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;      {</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;        <span class="comment">// Get the pointer to the node</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        Node* nod_pt = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">node_pt</a>(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>);</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160; </div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;        <span class="comment">// Get the number of values in the node</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;        <span class="keywordtype">unsigned</span> n_value = nod_pt-&gt;nvalue();</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160; </div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        <span class="comment">// We need to find if any of the values are hanging</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;        <span class="keywordtype">bool</span> is_hanging = nod_pt-&gt;is_hanging();</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;        <span class="comment">// Loop over the values and find out whether any are hanging</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_value; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;        {</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;          is_hanging |= nod_pt-&gt;is_hanging(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>);</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;        }</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160; </div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;        <span class="comment">// If the node is hanging then ...</span></div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;        <span class="keywordflow">if</span> (is_hanging)</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;        {</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;          <span class="comment">// Unless they are turned into hanging nodes again below</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;          <span class="comment">// (this might or might not happen), fill in all the necessary</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;          <span class="comment">// data to make them &#39;proper&#39; nodes again.</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160; </div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;          <span class="comment">// Reconstruct the nodal values/position from the node&#39;s</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;          <span class="comment">// hanging node representation</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;          <span class="keywordtype">unsigned</span> nt = nod_pt-&gt;ntstorage();</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;          Vector&lt;double&gt; values(n_value);</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;          <span class="keywordtype">unsigned</span> n_dim = nod_pt-&gt;ndim();</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;          Vector&lt;double&gt; position(n_dim);</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;          <span class="comment">// Loop over all history values</span></div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../dd/ddd/namespaceplotPSD.html#a112f38a9c28b7e27fed13fb3ebf10362">t</a> = 0; <a class="code" href="../../dd/ddd/namespaceplotPSD.html#a112f38a9c28b7e27fed13fb3ebf10362">t</a> &lt; nt; <a class="code" href="../../dd/ddd/namespaceplotPSD.html#a112f38a9c28b7e27fed13fb3ebf10362">t</a>++)</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;          {</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;            nod_pt-&gt;value(<a class="code" href="../../dd/ddd/namespaceplotPSD.html#a112f38a9c28b7e27fed13fb3ebf10362">t</a>, values);</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_value; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;            {</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;              nod_pt-&gt;set_value(<a class="code" href="../../dd/ddd/namespaceplotPSD.html#a112f38a9c28b7e27fed13fb3ebf10362">t</a>, <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, values[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;            }</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;            nod_pt-&gt;position(<a class="code" href="../../dd/ddd/namespaceplotPSD.html#a112f38a9c28b7e27fed13fb3ebf10362">t</a>, position);</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_dim; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;            {</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;              nod_pt-&gt;x(<a class="code" href="../../dd/ddd/namespaceplotPSD.html#a112f38a9c28b7e27fed13fb3ebf10362">t</a>, <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = position[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;            }</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;          }</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160; </div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;          <span class="comment">// If it&#39;s an algebraic node: Update its previous nodal positions too</span></div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;          AlgebraicNode* alg_node_pt = <span class="keyword">dynamic_cast&lt;</span>AlgebraicNode*<span class="keyword">&gt;</span>(nod_pt);</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;          <span class="keywordflow">if</span> (alg_node_pt != 0)</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;          {</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;            <span class="keywordtype">bool</span> update_all_time_levels = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;            alg_node_pt-&gt;node_update(update_all_time_levels);</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;          }</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160; </div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160; </div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;          <span class="comment">// If it&#39;s a Solid node, update Lagrangian coordinates</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;          <span class="comment">// from its hanging node representation</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;          SolidNode* solid_node_pt = <span class="keyword">dynamic_cast&lt;</span>SolidNode*<span class="keyword">&gt;</span>(nod_pt);</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;          <span class="keywordflow">if</span> (solid_node_pt != 0)</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;          {</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;            <span class="keywordtype">unsigned</span> n_lagrangian = solid_node_pt-&gt;nlagrangian();</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_lagrangian; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;            {</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;              solid_node_pt-&gt;xi(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = solid_node_pt-&gt;lagrangian_position(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;            }</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;          }</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160; </div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;          <span class="comment">// Now store geometrically hanging nodes on boundaries that</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;          <span class="comment">// may need updating after refinement.</span></div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;          <span class="comment">// There will only be a problem if we have 3 spatial dimensions</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;          <span class="keywordflow">if</span> ((mesh_dim &gt; 2) &amp;&amp; (nod_pt-&gt;is_hanging()))</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;          {</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;            <span class="comment">// If the node is on a boundary then add a pointer to the node</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;            <span class="comment">// to our lookup scheme</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;            <span class="keywordflow">if</span> (nod_pt-&gt;is_on_boundary())</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;            {</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;              <span class="comment">// Storage for the boundaries on which the Node is located</span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;              std::set&lt;unsigned&gt;* boundaries_pt;</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;              nod_pt-&gt;get_boundaries_pt(boundaries_pt);</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;              <span class="keywordflow">if</span> (boundaries_pt != 0)</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;              {</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;                <span class="comment">// Loop over the boundaries and add a pointer to the node</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;                <span class="comment">// to the appropriate storage scheme</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;                <span class="keywordflow">for</span> (std::set&lt;unsigned&gt;::iterator it = boundaries_pt-&gt;begin();</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;                     it != boundaries_pt-&gt;end();</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;                     ++it)</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;                {</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;                  hanging_nodes_on_boundary_pt[*it].insert(nod_pt);</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;                }</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;              }</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;            }</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;          }</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160; </div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;        } <span class="comment">// End of is_hanging</span></div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160; </div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;        <span class="comment">// Initially mark all nodes as &#39;non-hanging&#39; and `obsolete&#39;</span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;        nod_pt-&gt;set_nonhanging();</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;        nod_pt-&gt;set_obsolete();</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;      }</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160; </div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;      {</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;        t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for sorting out initial hanging status: &quot;</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;                   &lt;&lt; t_end - t_start &lt;&lt; std::endl;</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;        t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;      }</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160; </div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;      <span class="comment">// Unrefine all the selected elements: This needs to be</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;      <span class="comment">//-----------------------------------------------------</span></div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;      <span class="comment">// all elements, because the father elements are not actually leaves.</span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;      <span class="comment">//-------------------------------------------------------------------</span></div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160; </div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;      <span class="comment">// Unrefine</span></div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#aaf121b2595ff71815c4e9db35247f951">Forest_pt</a>-&gt;<a class="code" href="../../d2/d36/classoomph_1_1TreeForest.html#a6796a34cf1211f554a59055ff5765863">ntree</a>(); <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;      {</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;        <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#aaf121b2595ff71815c4e9db35247f951">Forest_pt</a>-&gt;<a class="code" href="../../d2/d36/classoomph_1_1TreeForest.html#ab031414d924b1637cc4492c7048f3f7a">tree_pt</a>(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>)-&gt;<a class="code" href="../../dd/d99/classoomph_1_1Tree.html#a3caab39c8bee6fb65bbafed523aa6d3d">traverse_all</a>(&amp;<a class="code" href="../../dd/d99/classoomph_1_1Tree.html#af4f977931ece6b719a9e616037bb2481">Tree::merge_sons_if_required</a>,</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;                                            mesh_pt);</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;      }</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160; </div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;      {</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;        t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for unrefinement: &quot;</span> &lt;&lt; t_end - t_start &lt;&lt; std::endl;</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;        t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;      }</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160; </div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;      <span class="comment">// Add the newly created elements to mesh</span></div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;      <span class="comment">//---------------------------------------</span></div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160; </div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;      <span class="comment">// Stick all elements into a new vector</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;      <span class="comment">//(note the leaves may have changed, so this is not duplicated work)</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;      Vector&lt;Tree*&gt; tree_nodes_pt;</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;      <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#aaf121b2595ff71815c4e9db35247f951">Forest_pt</a>-&gt;<a class="code" href="../../d2/d36/classoomph_1_1TreeForest.html#a6d99d1f513a60b9bd053ff98699cbe52">stick_leaves_into_vector</a>(tree_nodes_pt);</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160; </div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;      <span class="comment">// Copy the elements into the mesh Vector</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;      num_tree_nodes = tree_nodes_pt.size();</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;      <a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#aca12acfe655a4d5c4a4eab4a7b970812">Element_pt</a>.resize(num_tree_nodes);</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; num_tree_nodes; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;      {</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;        <a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#aca12acfe655a4d5c4a4eab4a7b970812">Element_pt</a>[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>] = tree_nodes_pt[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>]-&gt;object_pt();</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160; </div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;        <span class="comment">// Now loop over all nodes in element and mark them as non-obsolete</span></div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;        <span class="comment">// Logic: Initially all nodes in the unrefined mesh were labeled</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;        <span class="comment">// as deleteable. Then we create new elements (whose newly created</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;        <span class="comment">// nodes are obviously non-obsolete), and killed some other elements (by</span></div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;        <span class="comment">// by deleting them and marking the nodes that were not shared by</span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;        <span class="comment">// their father as obsolete. Now we loop over all the remaining</span></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;        <span class="comment">// elements and (re-)label all their nodes as non-obsolete. This</span></div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;        <span class="comment">// saves some nodes that were regarded as obsolete by deleted</span></div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;        <span class="comment">// elements but are still required in some surviving ones</span></div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;        <span class="comment">// from a tragic early death...</span></div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;        FiniteElement* this_el_pt = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a4f274774435e9454bf77bf70de69367a">finite_element_pt</a>(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>);</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;        <span class="keywordtype">unsigned</span> n_node = this_el_pt-&gt;nnode(); <span class="comment">// caching pre-loop</span></div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_node; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;        {</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;          this_el_pt-&gt;node_pt(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>)-&gt;set_non_obsolete();</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;        }</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;      }</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160; </div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160; </div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;      {</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;        t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for adding elements to mesh: &quot;</span> &lt;&lt; t_end - t_start</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;                   &lt;&lt; std::endl;</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;        t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;      }</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160; </div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;      <span class="comment">// Cannot delete nodes that are still marked as obsolete</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;      <span class="comment">// because they may still be required to assemble the hanging schemes</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;      <span class="comment">//-------------------------------------------------------------------</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160; </div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;      <span class="comment">// Mark up hanging nodes</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;      <span class="comment">//----------------------</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160; </div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;      <span class="comment">// Output streams for the hanging nodes</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;      Vector&lt;std::ofstream*&gt; hanging_output_files;</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;      <span class="comment">// Setup the output files for hanging nodes, this must be called</span></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;      <span class="comment">// precisely once for the forest. Note that the files will only</span></div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;      <span class="comment">// actually be opened if doc_info.is_doc_enabled() is true</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;      <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#aaf121b2595ff71815c4e9db35247f951">Forest_pt</a>-&gt;<a class="code" href="../../d2/d36/classoomph_1_1TreeForest.html#a635443274eaa2fb1afa889e4e748608f">open_hanging_node_files</a>(<a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>, hanging_output_files);</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160; </div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; num_tree_nodes; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;      {</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;        <span class="comment">// Generic setup</span></div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;        tree_nodes_pt[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>]-&gt;object_pt()-&gt;setup_hanging_nodes(</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;          hanging_output_files);</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;        <span class="comment">// Element specific setup</span></div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;        tree_nodes_pt[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>]-&gt;object_pt()-&gt;further_setup_hanging_nodes();</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;      }</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160; </div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;      <span class="comment">// Close the hanging node files and delete the memory allocated</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;      <span class="comment">// for the streams</span></div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;      <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#aaf121b2595ff71815c4e9db35247f951">Forest_pt</a>-&gt;<a class="code" href="../../d2/d36/classoomph_1_1TreeForest.html#ace63bb552b21ba46eb5ae062826dab26">close_hanging_node_files</a>(<a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>, hanging_output_files);</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160; </div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160; </div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;      {</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;        t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for setup_hanging_nodes() and &quot;</span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;                      <span class="stringliteral">&quot;further_setup_hanging_nodes() for &quot;</span></div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;                   &lt;&lt; num_tree_nodes &lt;&lt; <span class="stringliteral">&quot; elements: &quot;</span> &lt;&lt; t_end - t_start</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;                   &lt;&lt; std::endl;</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;        t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;      }</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160; </div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;      <span class="comment">// Read out the number of continously interpolated values</span></div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;      <span class="comment">// from one of the elements (assuming it&#39;s the same in all elements)</span></div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;      <span class="keywordtype">unsigned</span> ncont_interpolated_values =</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;        tree_nodes_pt[0]-&gt;object_pt()-&gt;ncont_interpolated_values();</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160; </div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;      <span class="comment">// Complete the hanging nodes schemes by dealing with the</span></div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;      <span class="comment">// recursively hanging nodes</span></div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;      <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#aab6f14b0933edc819231a88b1d555f62">complete_hanging_nodes</a>(ncont_interpolated_values);</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160; </div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;      {</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;        t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for complete_hanging_nodes: &quot;</span> &lt;&lt; t_end - t_start</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;                   &lt;&lt; std::endl;</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;        t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;      }</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160; </div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a37f6d27447f643a74694012b09350ce9">Lookup_for_elements_next_boundary_is_setup</a>)</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;      {</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;        this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a6cc8bcd6b41209f0e9295cc993d9c6bb">setup_boundary_element_info</a>();</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;      }</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160; </div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;      {</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;        t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for boundary element info: &quot;</span> &lt;&lt; t_end - t_start</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;                   &lt;&lt; std::endl;</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;        t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;      }</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160; </div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160; </div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;      <span class="comment">// Doc/check the neighbours</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;      <span class="comment">//-------------------------</span></div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;      Vector&lt;Tree*&gt; all_tree_nodes_pt;</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;      <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#aaf121b2595ff71815c4e9db35247f951">Forest_pt</a>-&gt;<a class="code" href="../../d2/d36/classoomph_1_1TreeForest.html#a40bd3735303f019892b03d6a5355c8db">stick_all_tree_nodes_into_vector</a>(all_tree_nodes_pt);</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160; </div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;      <span class="comment">// Check the neighbours</span></div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;      <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#aaf121b2595ff71815c4e9db35247f951">Forest_pt</a>-&gt;<a class="code" href="../../d2/d36/classoomph_1_1TreeForest.html#a0e6a7f821d9f14374c6d23d8766c7679">check_all_neighbours</a>(<a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>);</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160; </div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;      <span class="comment">// Check the integrity of the elements</span></div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;      <span class="comment">// -----------------------------------</span></div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160; </div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;      <span class="comment">// Loop over elements and get the elemental integrity</span></div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a8d7689918a098ce597c3d4fc716a0727">max_error</a> = 0.0;</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; num_tree_nodes; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;      {</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;        <span class="keywordtype">double</span> max_el_error;</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;        tree_nodes_pt[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>]-&gt;object_pt()-&gt;check_integrity(max_el_error);</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;        <span class="comment">// If the elemental error is greater than our maximum error</span></div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;        <span class="comment">// reset the maximum</span></div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;        <span class="keywordflow">if</span> (max_el_error &gt; <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a8d7689918a098ce597c3d4fc716a0727">max_error</a>)</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;        {</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;          <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a8d7689918a098ce597c3d4fc716a0727">max_error</a> = max_el_error;</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;        }</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;      }</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160; </div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a8d7689918a098ce597c3d4fc716a0727">max_error</a> &gt; <a class="code" href="../../dc/d08/classoomph_1_1RefineableElement.html#a25b5901fb0689aefe2c67c361f4290f2">RefineableElement::max_integrity_tolerance</a>())</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;      {</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;        std::ostringstream error_stream;</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;        error_stream &lt;&lt; <span class="stringliteral">&quot;Mesh refined: Max. error in integrity check: &quot;</span></div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;                     &lt;&lt; <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a8d7689918a098ce597c3d4fc716a0727">max_error</a> &lt;&lt; <span class="stringliteral">&quot; is too big\n&quot;</span>;</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;        error_stream</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;i.e. bigger than RefineableElement::max_integrity_tolerance()=&quot;</span></div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;          &lt;&lt; <a class="code" href="../../dc/d08/classoomph_1_1RefineableElement.html#a25b5901fb0689aefe2c67c361f4290f2">RefineableElement::max_integrity_tolerance</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;          &lt;&lt; std::endl;</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160; </div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;        std::ofstream some_file;</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;        some_file.open(<span class="stringliteral">&quot;ProblemMesh.dat&quot;</span>);</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_node; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;        {</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;          <span class="comment">// Get the pointer to the node</span></div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;          Node* nod_pt = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">node_pt</a>(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>);</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;          <span class="comment">// Get the dimension</span></div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;          <span class="keywordtype">unsigned</span> n_dim = nod_pt-&gt;ndim();</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;          <span class="comment">// Output the coordinates</span></div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_dim; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;          {</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;            some_file &lt;&lt; this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">node_pt</a>(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>)-&gt;<a class="code" href="../../dc/db7/classoomph_1_1Node.html#a056f8e82da938369cd38541c5cdc598a">x</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;          }</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;          some_file &lt;&lt; std::endl;</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;        }</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;        some_file.close();</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160; </div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;        error_stream &lt;&lt; <span class="stringliteral">&quot;Doced problem mesh in ProblemMesh.dat&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160; </div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;          error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;      }</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;      {</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Mesh refined: Max. error in integrity check: &quot;</span></div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                   &lt;&lt; <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a8d7689918a098ce597c3d4fc716a0727">max_error</a> &lt;&lt; <span class="stringliteral">&quot; is OK&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a></div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;i.e. less than RefineableElement::max_integrity_tolerance()=&quot;</span></div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;          &lt;&lt; <a class="code" href="../../dc/d08/classoomph_1_1RefineableElement.html#a25b5901fb0689aefe2c67c361f4290f2">RefineableElement::max_integrity_tolerance</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;          &lt;&lt; std::endl;</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;      }</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160; </div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160; </div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;      {</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;        t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for (paranoid only) checking of integrity: &quot;</span></div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;                   &lt;&lt; t_end - t_start &lt;&lt; std::endl;</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;        t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;      }</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160; </div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160; </div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;      <span class="comment">// Loop over all elements other than the final level and deactivate the</span></div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;      <span class="comment">// objects, essentially set the pointer that point to nodes that are</span></div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;      <span class="comment">// about to be deleted to NULL. This must take place here because nodes</span></div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;      <span class="comment">// addressed by elements that are dead but still living in the tree might</span></div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;      <span class="comment">// have been made obsolete in the last round of refinement</span></div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#aaf121b2595ff71815c4e9db35247f951">Forest_pt</a>-&gt;<a class="code" href="../../d2/d36/classoomph_1_1TreeForest.html#a6796a34cf1211f554a59055ff5765863">ntree</a>(); <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;      {</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;        <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#aaf121b2595ff71815c4e9db35247f951">Forest_pt</a>-&gt;<a class="code" href="../../d2/d36/classoomph_1_1TreeForest.html#ab031414d924b1637cc4492c7048f3f7a">tree_pt</a>(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>)-&gt;<a class="code" href="../../dd/d99/classoomph_1_1Tree.html#aef175445b09edb47624c4b88c6d548bc">traverse_all_but_leaves</a>(</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;          &amp;<a class="code" href="../../dd/d99/classoomph_1_1Tree.html#aea17489589a1872db51f2b142da4c1fb">Tree::deactivate_object</a>);</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;      }</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160; </div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;      <span class="comment">// Now we can prune the dead nodes from the mesh.</span></div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;      Vector&lt;Node*&gt; deleted_node_pt = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ac9f58929371a3f39dd646d2756547ad2">prune_dead_nodes</a>();</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160; </div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;      {</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;        t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for deactivating objects and pruning nodes: &quot;</span></div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;                   &lt;&lt; t_end - t_start &lt;&lt; std::endl;</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;        t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;      }</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160; </div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;      <span class="comment">// Finally: Reorder the nodes within the mesh&#39;s node vector</span></div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;      <span class="comment">// to establish a standard ordering regardless of the sequence</span></div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;      <span class="comment">// of mesh refinements -- this is required to allow dump/restart</span></div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;      <span class="comment">// on refined meshes</span></div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;      this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a801e77424d1bf8a35c9bba055230f1e3">reorder_nodes</a>();</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160; </div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;      {</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;        t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for reordering &quot;</span> &lt;&lt; <a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a945e7823d1a2af243b5b7f7866aaff5e">nnode</a>()</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot; nodes: &quot;</span> &lt;&lt; t_end - t_start &lt;&lt; std::endl;</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;        t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;      }</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160; </div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;      <span class="comment">// Now we can correct the nodes on boundaries that were hanging that</span></div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;      <span class="comment">// are no longer hanging</span></div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;      <span class="comment">// Only bother if we have more than two dimensions</span></div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;      <span class="keywordflow">if</span> (mesh_dim &gt; 2)</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;      {</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;        <span class="comment">// Loop over the boundaries</span></div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a> = 0; <a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a> &lt; n_boundary; <a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a>++)</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;        {</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;          <span class="comment">// Remove deleted nodes from the set</span></div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;          <span class="keywordtype">unsigned</span> n_del = deleted_node_pt.size();</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; n_del; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;          {</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;            hanging_nodes_on_boundary_pt[<a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a>].erase(deleted_node_pt[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>]);</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;          }</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160; </div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;          <span class="comment">// If the nodes that were hanging are still hanging then remove them</span></div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;          <span class="comment">// from the set (note increment is not in for command for efficiencty)</span></div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;          <span class="keywordflow">for</span> (std::set&lt;Node*&gt;::iterator it =</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;                 hanging_nodes_on_boundary_pt[<a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a>].begin();</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;               it != hanging_nodes_on_boundary_pt[<a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a>].end();)</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;          {</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;            <span class="keywordflow">if</span> ((*it)-&gt;is_hanging())</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;            {</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;              hanging_nodes_on_boundary_pt[<a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a>].erase(it++);</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;            }</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;            {</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;              ++it;</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;            }</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;          }</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160; </div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;          <span class="comment">// Are there any nodes that have changed geometric hanging status</span></div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;          <span class="comment">// on the boundary</span></div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;          <span class="comment">// The slightly painful part is that we must adjust the position</span></div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;          <span class="comment">// via the macro-elements which are only available through the</span></div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;          <span class="comment">// elements and not the nodes.</span></div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;          <span class="keywordflow">if</span> (hanging_nodes_on_boundary_pt[<a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a>].<a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>() &gt; 0)</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;          {</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;            <span class="comment">// If so we loop over all elements adjacent to the boundary</span></div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;            <span class="keywordtype">unsigned</span> n_boundary_element = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a68e04b3b70cff70d53d75f66661555e8">nboundary_element</a>(<a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a>);</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; n_boundary_element; ++<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>)</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;            {</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;              <span class="comment">// Get a pointer to the element</span></div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;              FiniteElement* el_pt = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a875271b6f162ddc5685a2511b35e75ec">boundary_element_pt</a>(<a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a>, <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>);</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160; </div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;              <span class="comment">// Do we have a solid element</span></div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;              SolidFiniteElement* solid_el_pt =</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;                <span class="keyword">dynamic_cast&lt;</span>SolidFiniteElement*<span class="keyword">&gt;</span>(el_pt);</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160; </div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;              <span class="comment">// Determine whether there is a macro element</span></div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;              <span class="keywordtype">bool</span> macro_present = (el_pt-&gt;macro_elem_pt() != 0);</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;              <span class="comment">// Or a solid macro element</span></div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;              <span class="keywordflow">if</span> (solid_el_pt != 0)</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;              {</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;                macro_present |= (solid_el_pt-&gt;undeformed_macro_elem_pt() != 0);</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;              }</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160; </div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;              <span class="comment">// Only bother to do anything if there is a macro element</span></div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;              <span class="comment">// or undeformed macro element in a SolidElement</span></div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;              <span class="keywordflow">if</span> (macro_present)</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;              {</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;                <span class="comment">// Loop over the nodes</span></div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;                <span class="comment">// ALH: (could optimise to only loop over</span></div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;                <span class="comment">// node associated with the boundary with more effort)</span></div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;                <span class="keywordtype">unsigned</span> n_el_node = el_pt-&gt;nnode();</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_el_node; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;                {</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;                  <span class="comment">// Cache pointer to the node</span></div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;                  Node* nod_pt = el_pt-&gt;node_pt(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>);</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;                  <span class="keywordflow">if</span> (nod_pt-&gt;is_on_boundary(<a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a>))</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;                  {</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;                    <span class="comment">// Is the Node in our set</span></div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;                    std::set&lt;Node*&gt;::iterator it =</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;                      hanging_nodes_on_boundary_pt[<a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a>].find(nod_pt);</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160; </div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;                    <span class="comment">// If we have found the Node then update the position</span></div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;                    <span class="comment">// to be consistent with the macro-element representation</span></div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;                    <span class="keywordflow">if</span> (it != hanging_nodes_on_boundary_pt[<a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a>].<a class="code" href="../../df/d04/group__Core__Module.html#ga0e45b6b2adead7c6a29815b99f9f14dd">end</a>())</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;                    {</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;                      <span class="comment">// Specialise local and global coordinates to 3D</span></div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;                      <span class="comment">// because there is only a problem in 3D.</span></div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;                      Vector&lt;double&gt; <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>(3), <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>(3);</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160; </div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;                      <span class="comment">// Find the local coordinate of the ndoe</span></div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;                      el_pt-&gt;local_coordinate_of_node(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>, <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>);</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160; </div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;                      <span class="comment">// Find the number of time history values</span></div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> ntstorage = nod_pt-&gt;ntstorage();</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160; </div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;                      <span class="comment">// Do we have a solid node</span></div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;                      SolidNode* solid_node_pt =</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;                        <span class="keyword">dynamic_cast&lt;</span>SolidNode*<span class="keyword">&gt;</span>(nod_pt);</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;                      <span class="keywordflow">if</span> (solid_node_pt)</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;                      {</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;                        <span class="comment">// Assign Lagrangian coordinates from undeformed</span></div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;                        <span class="comment">// macro element (if it has one -- get_x_and_xi()</span></div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;                        <span class="comment">// does &quot;the right thing&quot; anyway. Leave actual</span></div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;                        <span class="comment">// nodal positions alone -- we&#39;re doing a solid</span></div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;                        <span class="comment">// mechanics problem and once we&#39;re going</span></div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;                        <span class="comment">// the nodal positions are always computed, never</span></div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;                        <span class="comment">// (automatically) reset to macro-element based</span></div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;                        <span class="comment">// positions; not even on pinned boundaries</span></div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;                        <span class="comment">// because the user may have other ideas about where</span></div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;                        <span class="comment">// these should go -- pinning means &quot;don&#39;t touch the</span></div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;                        <span class="comment">// value&quot;, not &quot;leave where the macro-element thinks</span></div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;                        <span class="comment">// it should be&quot;</span></div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;                        Vector&lt;double&gt; x_fe(3), xi(3), xi_fe(3);</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;                        solid_el_pt-&gt;get_x_and_xi(<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>, x_fe, <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>, xi_fe, xi);</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; 3; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;                        {</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;                          solid_node_pt-&gt;xi(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = xi[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;                        }</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;                      }</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;                      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;                      {</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;                        <span class="comment">// Set position and history values from the</span></div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;                        <span class="comment">// macro-element representation</span></div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../dd/ddd/namespaceplotPSD.html#a112f38a9c28b7e27fed13fb3ebf10362">t</a> = 0; <a class="code" href="../../dd/ddd/namespaceplotPSD.html#a112f38a9c28b7e27fed13fb3ebf10362">t</a> &lt; ntstorage; <a class="code" href="../../dd/ddd/namespaceplotPSD.html#a112f38a9c28b7e27fed13fb3ebf10362">t</a>++)</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;                        {</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;                          <span class="comment">// Get the history value from the macro element</span></div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;                          el_pt-&gt;get_x(<a class="code" href="../../dd/ddd/namespaceplotPSD.html#a112f38a9c28b7e27fed13fb3ebf10362">t</a>, <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>, <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>);</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160; </div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;                          <span class="comment">// Set the coordinate to that of the macroelement</span></div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;                          <span class="comment">// representation</span></div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;                          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; 3; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;                          {</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;                            nod_pt-&gt;x(<a class="code" href="../../dd/ddd/namespaceplotPSD.html#a112f38a9c28b7e27fed13fb3ebf10362">t</a>, <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;                          }</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;                        }</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;                      } <span class="comment">// End of non-solid node case</span></div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160; </div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;                      <span class="comment">// Now remove the node from the list</span></div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;                      hanging_nodes_on_boundary_pt[<a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a>].erase(it);</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160; </div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;                      <span class="comment">// If there are no Nodes left then exit the loops</span></div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;                      <span class="keywordflow">if</span> (hanging_nodes_on_boundary_pt[<a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a>].<a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>() == 0)</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;                      {</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;                        <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = n_boundary_element;</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;                      }</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;                    }</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;                  }</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;                }</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;              } <span class="comment">// End of macro element case</span></div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;            }</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;          }</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;        }</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;      } <span class="comment">// End of case when we have fixed nodal positions</span></div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160; </div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160; </div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;      <span class="comment">// Final doc</span></div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;      <span class="comment">//-----------</span></div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>.<a class="code" href="../../d7/d2c/classoomph_1_1DocInfo.html#a2ce90cf54f24b4ab523c624031fbb76b">is_doc_enabled</a>())</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;      {</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;        <span class="comment">// Doc the boundary conditions (&#39;0&#39; for non-existent, &#39;1&#39; for free,</span></div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;        <span class="comment">//----------------------------------------------------------------</span></div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;        <span class="comment">// &#39;2&#39; for pinned -- ideal for tecplot scatter sizing.</span></div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;        <span class="comment">//----------------------------------------------------</span></div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;        <span class="comment">// num_tree_nodes=tree_nodes_pt.size();</span></div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160; </div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;        <span class="comment">// Determine maximum number of values at any node in this type of</span></div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;        <span class="comment">// element</span></div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;        RefineableElement* el_pt = tree_nodes_pt[0]-&gt;object_pt();</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;        <span class="comment">// Initalise max_nval</span></div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;        <span class="keywordtype">unsigned</span> max_nval = 0;</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; el_pt-&gt;nnode(); <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;        {</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;          <span class="keywordflow">if</span> (el_pt-&gt;node_pt(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>)-&gt;nvalue() &gt; max_nval)</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;          {</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;            max_nval = el_pt-&gt;node_pt(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>)-&gt;nvalue();</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;          }</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;        }</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160; </div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;        <span class="comment">// Open the output file</span></div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;        std::ofstream bcs_file;</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;        fullname.str(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;        fullname &lt;&lt; <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>.<a class="code" href="../../d7/d2c/classoomph_1_1DocInfo.html#a85d58bcfce0a7b7cae461624e6fcd08a">directory</a>() &lt;&lt; <span class="stringliteral">&quot;/bcs&quot;</span> &lt;&lt; <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>.<a class="code" href="../../d7/d2c/classoomph_1_1DocInfo.html#af27224b25da5b758442753f0947e62d4">number</a>()</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;.dat&quot;</span>;</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;        bcs_file.open(fullname.str().c_str());</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160; </div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;        <span class="comment">// Loop over elements</span></div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; num_tree_nodes; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;        {</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;          el_pt = tree_nodes_pt[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>]-&gt;object_pt();</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;          <span class="comment">// Loop over nodes in element</span></div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;          <span class="keywordtype">unsigned</span> n_nod = el_pt-&gt;nnode();</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_nod; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;          {</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;            <span class="comment">// Get pointer to the node</span></div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;            Node* nod_pt = el_pt-&gt;node_pt(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>);</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;            <span class="comment">// Find the dimension of the node</span></div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;            <span class="keywordtype">unsigned</span> n_dim = nod_pt-&gt;ndim();</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;            <span class="comment">// Write the nodal coordinates to the file</span></div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_dim; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;            {</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;              bcs_file &lt;&lt; nod_pt-&gt;x(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;            }</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160; </div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;            <span class="comment">// Loop over all values in this element</span></div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; max_nval; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;            {</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;              <span class="comment">// Value exists at this node:</span></div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;              <span class="keywordflow">if</span> (i &lt; nod_pt-&gt;nvalue())</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;              {</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;                bcs_file &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; 1 + nod_pt-&gt;is_pinned(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;              }</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;              <span class="comment">// ...if not just dump out a zero</span></div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;              <span class="keywordflow">else</span></div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;              {</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;                bcs_file &lt;&lt; <span class="stringliteral">&quot; 0 &quot;</span>;</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;              }</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;            }</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;            bcs_file &lt;&lt; std::endl;</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;          }</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;        }</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;        bcs_file.close();</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160; </div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;        <span class="comment">// Doc all nodes</span></div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;        <span class="comment">//---------------</span></div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;        std::ofstream all_nodes_file;</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;        fullname.str(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;        fullname &lt;&lt; <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>.<a class="code" href="../../d7/d2c/classoomph_1_1DocInfo.html#a85d58bcfce0a7b7cae461624e6fcd08a">directory</a>() &lt;&lt; <span class="stringliteral">&quot;/all_nodes&quot;</span> &lt;&lt; <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>.<a class="code" href="../../d7/d2c/classoomph_1_1DocInfo.html#af27224b25da5b758442753f0947e62d4">number</a>()</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;.dat&quot;</span>;</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;        all_nodes_file.open(fullname.str().c_str());</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160; </div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;        all_nodes_file &lt;&lt; <span class="stringliteral">&quot;ZONE \n&quot;</span>;</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160; </div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;        <span class="comment">// Need to recompute the number of nodes since it may have</span></div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;        <span class="comment">// changed during mesh refinement/unrefinement</span></div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;        n_node = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a945e7823d1a2af243b5b7f7866aaff5e">nnode</a>();</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_node; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;        {</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;          Node* nod_pt = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">node_pt</a>(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>);</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;          <span class="keywordtype">unsigned</span> n_dim = nod_pt-&gt;ndim();</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_dim; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;          {</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;            all_nodes_file &lt;&lt; this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">node_pt</a>(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>)-&gt;<a class="code" href="../../dc/db7/classoomph_1_1Node.html#a056f8e82da938369cd38541c5cdc598a">x</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;          }</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;          all_nodes_file &lt;&lt; std::endl;</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;        }</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160; </div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;        all_nodes_file.close();</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160; </div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160; </div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;        <span class="comment">// Doc all hanging nodes:</span></div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;        <span class="comment">//-----------------------</span></div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;        std::ofstream some_file;</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;        fullname.str(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;        fullname &lt;&lt; <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>.<a class="code" href="../../d7/d2c/classoomph_1_1DocInfo.html#a85d58bcfce0a7b7cae461624e6fcd08a">directory</a>() &lt;&lt; <span class="stringliteral">&quot;/all_hangnodes&quot;</span></div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;                 &lt;&lt; <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>.<a class="code" href="../../d7/d2c/classoomph_1_1DocInfo.html#af27224b25da5b758442753f0947e62d4">number</a>() &lt;&lt; <span class="stringliteral">&quot;.dat&quot;</span>;</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;        some_file.open(fullname.str().c_str());</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_node; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;        {</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;          Node* nod_pt = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">node_pt</a>(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>);</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160; </div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;          <span class="keywordflow">if</span> (nod_pt-&gt;is_hanging())</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;          {</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;            <span class="keywordtype">unsigned</span> n_dim = nod_pt-&gt;ndim();</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_dim; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;            {</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;              some_file &lt;&lt; nod_pt-&gt;x(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;            }</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160; </div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;            <span class="comment">// ALH: Added this to stop Solid problems seg-faulting</span></div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;            <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">node_pt</a>(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>)-&gt;nvalue() &gt; 0)</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;            {</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;              some_file &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; nod_pt-&gt;raw_value(0);</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;            }</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;            some_file &lt;&lt; std::endl;</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;          }</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;        }</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;        some_file.close();</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160; </div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;        <span class="comment">// Doc all hanging nodes and their masters</span></div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;        <span class="comment">// View with QHangingNodesWithMasters.mcr</span></div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;        fullname.str(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;        fullname &lt;&lt; <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>.<a class="code" href="../../d7/d2c/classoomph_1_1DocInfo.html#a85d58bcfce0a7b7cae461624e6fcd08a">directory</a>() &lt;&lt; <span class="stringliteral">&quot;/geometric_hangnodes_withmasters&quot;</span></div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;                 &lt;&lt; <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>.<a class="code" href="../../d7/d2c/classoomph_1_1DocInfo.html#af27224b25da5b758442753f0947e62d4">number</a>() &lt;&lt; <span class="stringliteral">&quot;.dat&quot;</span>;</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;        some_file.open(fullname.str().c_str());</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_node; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;        {</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;          Node* nod_pt = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">node_pt</a>(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>);</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;          <span class="keywordflow">if</span> (nod_pt-&gt;is_hanging())</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;          {</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;            <span class="keywordtype">unsigned</span> n_dim = nod_pt-&gt;ndim();</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;            <span class="keywordtype">unsigned</span> nmaster = nod_pt-&gt;hanging_pt()-&gt;nmaster();</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;            some_file &lt;&lt; <span class="stringliteral">&quot;ZONE I=&quot;</span> &lt;&lt; nmaster + 1 &lt;&lt; std::endl;</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_dim; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;            {</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;              some_file &lt;&lt; nod_pt-&gt;x(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;            }</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;            some_file &lt;&lt; <span class="stringliteral">&quot; 2 &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160; </div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> imaster = 0; imaster &lt; nmaster; imaster++)</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;            {</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;              Node* master_nod_pt =</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;                nod_pt-&gt;hanging_pt()-&gt;master_node_pt(imaster);</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;              <span class="keywordtype">unsigned</span> n_dim = master_nod_pt-&gt;ndim();</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_dim; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;              {</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;                some_file &lt;&lt; master_nod_pt-&gt;x(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;              }</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;              some_file &lt;&lt; <span class="stringliteral">&quot; 1 &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;            }</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;          }</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;        }</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;        some_file.close();</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160; </div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;        <span class="comment">// Doc all hanging nodes and their masters</span></div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;        <span class="comment">// View with QHangingNodesWithMasters.mcr</span></div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; ncont_interpolated_values; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;        {</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;          fullname.str(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;          fullname &lt;&lt; <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>.<a class="code" href="../../d7/d2c/classoomph_1_1DocInfo.html#a85d58bcfce0a7b7cae461624e6fcd08a">directory</a>()</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;/nonstandard_hangnodes_withmasters&quot;</span> &lt;&lt; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot;_&quot;</span></div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;                   &lt;&lt; <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>.<a class="code" href="../../d7/d2c/classoomph_1_1DocInfo.html#af27224b25da5b758442753f0947e62d4">number</a>() &lt;&lt; <span class="stringliteral">&quot;.dat&quot;</span>;</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;          some_file.open(fullname.str().c_str());</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;          <span class="keywordtype">unsigned</span> n_nod = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a945e7823d1a2af243b5b7f7866aaff5e">nnode</a>();</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_nod; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;          {</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;            Node* nod_pt = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">node_pt</a>(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>);</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;            <span class="keywordflow">if</span> (nod_pt-&gt;is_hanging(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>))</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;            {</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;              <span class="keywordflow">if</span> (nod_pt-&gt;hanging_pt(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) != nod_pt-&gt;hanging_pt())</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;              {</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;                <span class="keywordtype">unsigned</span> nmaster = nod_pt-&gt;hanging_pt(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)-&gt;nmaster();</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;                some_file &lt;&lt; <span class="stringliteral">&quot;ZONE I=&quot;</span> &lt;&lt; nmaster + 1 &lt;&lt; std::endl;</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;                <span class="keywordtype">unsigned</span> n_dim = nod_pt-&gt;ndim();</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; n_dim; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;                {</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;                  some_file &lt;&lt; nod_pt-&gt;x(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;                }</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;                some_file &lt;&lt; <span class="stringliteral">&quot; 2 &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> imaster = 0; imaster &lt; nmaster; imaster++)</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;                {</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;                  Node* master_nod_pt =</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;                    nod_pt-&gt;hanging_pt(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)-&gt;master_node_pt(imaster);</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;                  <span class="keywordtype">unsigned</span> n_dim = master_nod_pt-&gt;ndim();</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; n_dim; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;                  {</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;                    <span class="comment">//               some_file &lt;&lt; master_nod_pt-&gt;x(i) &lt;&lt; &quot; &quot;;</span></div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;                  }</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;                  some_file &lt;&lt; <span class="stringliteral">&quot; 1 &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;                }</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;              }</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;            }</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;          }</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;          some_file.close();</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;        }</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;      } <span class="comment">// End of documentation</span></div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;    } <span class="comment">// End if (this-&gt;nelement()&gt;0)</span></div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160; </div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160; </div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160; </div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;    <span class="comment">// Now (re-)classify halo and haloed nodes and synchronise hanging</span></div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;    <span class="comment">// nodes</span></div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a1ab35b022b95f2d28c53aa58859bd6b5">is_mesh_distributed</a>())</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;    {</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;      classify_halo_and_haloed_nodes(<a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>, <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>.<a class="code" href="../../d7/d2c/classoomph_1_1DocInfo.html#a2ce90cf54f24b4ab523c624031fbb76b">is_doc_enabled</a>());</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;    }</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160; </div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;  }</div>
<div class="ttc" id="aBiCGSTAB__step__by__step_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> BiCGSTAB_step_by_step.cpp:9</div></div>
<div class="ttc" id="aCG3DPackingUnitTest_8cpp_html_a7026fd16370249ce97cb3d062326baf9"><div class="ttname"><a href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a></div><div class="ttdeci">const unsigned n</div><div class="ttdef"><b>Definition:</b> CG3DPackingUnitTest.cpp:11</div></div>
<div class="ttc" id="abenchVecAdd_8cpp_html_a439227feff9d7f55384e8780cfc2eb82"><div class="ttname"><a href="../../db/ddc/benchVecAdd_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a></div><div class="ttdeci">Scalar Scalar int size</div><div class="ttdef"><b>Definition:</b> benchVecAdd.cpp:17</div></div>
<div class="ttc" id="abenchVecAdd_8cpp_html_af9816f50f32fc22762a8289c3cc44f22"><div class="ttname"><a href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a></div><div class="ttdeci">Scalar * b</div><div class="ttdef"><b>Definition:</b> benchVecAdd.cpp:17</div></div>
<div class="ttc" id="aclassoomph_1_1DocInfo_html_af27224b25da5b758442753f0947e62d4"><div class="ttname"><a href="../../d7/d2c/classoomph_1_1DocInfo.html#af27224b25da5b758442753f0947e62d4">oomph::DocInfo::number</a></div><div class="ttdeci">unsigned &amp; number()</div><div class="ttdoc">Number used (e.g.) for labeling output files.</div><div class="ttdef"><b>Definition:</b> oomph_utilities.h:554</div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a5f8fe59f06da1da9f6b7bbcbdb90ef93"><div class="ttname"><a href="../../d2/dc6/classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">oomph::FiniteElement::dim</a></div><div class="ttdeci">unsigned dim() const</div><div class="ttdef"><b>Definition:</b> elements.h:2611</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_a37f6d27447f643a74694012b09350ce9"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#a37f6d27447f643a74694012b09350ce9">oomph::Mesh::Lookup_for_elements_next_boundary_is_setup</a></div><div class="ttdeci">bool Lookup_for_elements_next_boundary_is_setup</div><div class="ttdef"><b>Definition:</b> mesh.h:87</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_a4f274774435e9454bf77bf70de69367a"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#a4f274774435e9454bf77bf70de69367a">oomph::Mesh::finite_element_pt</a></div><div class="ttdeci">FiniteElement * finite_element_pt(const unsigned &amp;e) const</div><div class="ttdef"><b>Definition:</b> mesh.h:473</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_a68e04b3b70cff70d53d75f66661555e8"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#a68e04b3b70cff70d53d75f66661555e8">oomph::Mesh::nboundary_element</a></div><div class="ttdeci">unsigned nboundary_element(const unsigned &amp;b) const</div><div class="ttdoc">Return number of finite elements that are adjacent to boundary b.</div><div class="ttdef"><b>Definition:</b> mesh.h:878</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_a6cc8bcd6b41209f0e9295cc993d9c6bb"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#a6cc8bcd6b41209f0e9295cc993d9c6bb">oomph::Mesh::setup_boundary_element_info</a></div><div class="ttdeci">virtual void setup_boundary_element_info()</div><div class="ttdef"><b>Definition:</b> mesh.h:275</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_a84543564d6babe4faacbb9d87043fc19"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#a84543564d6babe4faacbb9d87043fc19">oomph::Mesh::nboundary</a></div><div class="ttdeci">unsigned nboundary() const</div><div class="ttdoc">Return number of boundaries.</div><div class="ttdef"><b>Definition:</b> mesh.h:827</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_a875271b6f162ddc5685a2511b35e75ec"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#a875271b6f162ddc5685a2511b35e75ec">oomph::Mesh::boundary_element_pt</a></div><div class="ttdeci">FiniteElement * boundary_element_pt(const unsigned &amp;b, const unsigned &amp;e) const</div><div class="ttdoc">Return pointer to e-th finite element on boundary b.</div><div class="ttdef"><b>Definition:</b> mesh.h:840</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_a945e7823d1a2af243b5b7f7866aaff5e"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#a945e7823d1a2af243b5b7f7866aaff5e">oomph::Mesh::nnode</a></div><div class="ttdeci">unsigned long nnode() const</div><div class="ttdoc">Return number of nodes in the mesh.</div><div class="ttdef"><b>Definition:</b> mesh.h:596</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_aa4a64cb23aa881dbd67c1b633173494f"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#aa4a64cb23aa881dbd67c1b633173494f">oomph::Mesh::Mesh</a></div><div class="ttdeci">Mesh()</div><div class="ttdoc">Default constructor.</div><div class="ttdef"><b>Definition:</b> mesh.h:236</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_ab3c2b72c8ef4e9fd35f5998a5e7dc93b"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">oomph::Mesh::node_pt</a></div><div class="ttdeci">Node *&amp; node_pt(const unsigned long &amp;n)</div><div class="ttdoc">Return pointer to global node n.</div><div class="ttdef"><b>Definition:</b> mesh.h:436</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_ac9f58929371a3f39dd646d2756547ad2"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#ac9f58929371a3f39dd646d2756547ad2">oomph::Mesh::prune_dead_nodes</a></div><div class="ttdeci">Vector&lt; Node * &gt; prune_dead_nodes()</div><div class="ttdef"><b>Definition:</b> mesh.cc:966</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_aca12acfe655a4d5c4a4eab4a7b970812"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#aca12acfe655a4d5c4a4eab4a7b970812">oomph::Mesh::Element_pt</a></div><div class="ttdeci">Vector&lt; GeneralisedElement * &gt; Element_pt</div><div class="ttdoc">Vector of pointers to generalised elements.</div><div class="ttdef"><b>Definition:</b> mesh.h:186</div></div>
<div class="ttc" id="aclassoomph_1_1Node_html_a056f8e82da938369cd38541c5cdc598a"><div class="ttname"><a href="../../dc/db7/classoomph_1_1Node.html#a056f8e82da938369cd38541c5cdc598a">oomph::Node::x</a></div><div class="ttdeci">double &amp; x(const unsigned &amp;i)</div><div class="ttdoc">Return the i-th nodal coordinate.</div><div class="ttdef"><b>Definition:</b> nodes.h:1060</div></div>
<div class="ttc" id="aclassoomph_1_1RefineableElement_html_a25b5901fb0689aefe2c67c361f4290f2"><div class="ttname"><a href="../../dc/d08/classoomph_1_1RefineableElement.html#a25b5901fb0689aefe2c67c361f4290f2">oomph::RefineableElement::max_integrity_tolerance</a></div><div class="ttdeci">static double &amp; max_integrity_tolerance()</div><div class="ttdoc">Max. allowed discrepancy in element integrity check.</div><div class="ttdef"><b>Definition:</b> refineable_elements.h:495</div></div>
<div class="ttc" id="aclassoomph_1_1RefineableMeshBase_html_a8d7689918a098ce597c3d4fc716a0727"><div class="ttname"><a href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a8d7689918a098ce597c3d4fc716a0727">oomph::RefineableMeshBase::max_error</a></div><div class="ttdeci">double &amp; max_error()</div><div class="ttdef"><b>Definition:</b> refineable_mesh.h:177</div></div>
<div class="ttc" id="aclassoomph_1_1TreeBasedRefineableMeshBase_html_a86dace1f78991fb9b401a31215df89ef"><div class="ttname"><a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a86dace1f78991fb9b401a31215df89ef">oomph::TreeBasedRefineableMeshBase::split_elements_if_required</a></div><div class="ttdeci">virtual void split_elements_if_required()=0</div></div>
<div class="ttc" id="aclassoomph_1_1TreeBasedRefineableMeshBase_html_aab6f14b0933edc819231a88b1d555f62"><div class="ttname"><a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#aab6f14b0933edc819231a88b1d555f62">oomph::TreeBasedRefineableMeshBase::complete_hanging_nodes</a></div><div class="ttdeci">void complete_hanging_nodes(const int &amp;ncont_interpolated_values)</div><div class="ttdoc">Complete the hanging node scheme recursively.</div><div class="ttdef"><b>Definition:</b> refineable_mesh.cc:2271</div></div>
<div class="ttc" id="aclassoomph_1_1TreeForest_html_a0e6a7f821d9f14374c6d23d8766c7679"><div class="ttname"><a href="../../d2/d36/classoomph_1_1TreeForest.html#a0e6a7f821d9f14374c6d23d8766c7679">oomph::TreeForest::check_all_neighbours</a></div><div class="ttdeci">virtual void check_all_neighbours(DocInfo &amp;doc_info)=0</div></div>
<div class="ttc" id="aclassoomph_1_1TreeForest_html_a40bd3735303f019892b03d6a5355c8db"><div class="ttname"><a href="../../d2/d36/classoomph_1_1TreeForest.html#a40bd3735303f019892b03d6a5355c8db">oomph::TreeForest::stick_all_tree_nodes_into_vector</a></div><div class="ttdeci">void stick_all_tree_nodes_into_vector(Vector&lt; Tree * &gt; &amp;all_forest_nodes)</div><div class="ttdoc">Traverse forest and stick pointers to all &quot;nodes&quot; into Vector.</div><div class="ttdef"><b>Definition:</b> tree.cc:405</div></div>
<div class="ttc" id="aclassoomph_1_1TreeForest_html_a635443274eaa2fb1afa889e4e748608f"><div class="ttname"><a href="../../d2/d36/classoomph_1_1TreeForest.html#a635443274eaa2fb1afa889e4e748608f">oomph::TreeForest::open_hanging_node_files</a></div><div class="ttdeci">virtual void open_hanging_node_files(DocInfo &amp;doc_info, Vector&lt; std::ofstream * &gt; &amp;output_stream)=0</div></div>
<div class="ttc" id="aclassoomph_1_1TreeForest_html_a6796a34cf1211f554a59055ff5765863"><div class="ttname"><a href="../../d2/d36/classoomph_1_1TreeForest.html#a6796a34cf1211f554a59055ff5765863">oomph::TreeForest::ntree</a></div><div class="ttdeci">unsigned ntree()</div><div class="ttdoc">Number of trees in forest.</div><div class="ttdef"><b>Definition:</b> tree.h:460</div></div>
<div class="ttc" id="aclassoomph_1_1TreeForest_html_a6d99d1f513a60b9bd053ff98699cbe52"><div class="ttname"><a href="../../d2/d36/classoomph_1_1TreeForest.html#a6d99d1f513a60b9bd053ff98699cbe52">oomph::TreeForest::stick_leaves_into_vector</a></div><div class="ttdeci">void stick_leaves_into_vector(Vector&lt; Tree * &gt; &amp;forest_nodes)</div><div class="ttdoc">Traverse forst and stick pointers to leaf &quot;nodes&quot; into Vector.</div><div class="ttdef"><b>Definition:</b> tree.cc:379</div></div>
<div class="ttc" id="aclassoomph_1_1TreeForest_html_ab031414d924b1637cc4492c7048f3f7a"><div class="ttname"><a href="../../d2/d36/classoomph_1_1TreeForest.html#ab031414d924b1637cc4492c7048f3f7a">oomph::TreeForest::tree_pt</a></div><div class="ttdeci">TreeRoot * tree_pt(const unsigned &amp;i) const</div><div class="ttdoc">Return pointer to i-th tree in forest.</div><div class="ttdef"><b>Definition:</b> tree.h:466</div></div>
<div class="ttc" id="aclassoomph_1_1TreeForest_html_ace63bb552b21ba46eb5ae062826dab26"><div class="ttname"><a href="../../d2/d36/classoomph_1_1TreeForest.html#ace63bb552b21ba46eb5ae062826dab26">oomph::TreeForest::close_hanging_node_files</a></div><div class="ttdeci">void close_hanging_node_files(DocInfo &amp;doc_info, Vector&lt; std::ofstream * &gt; &amp;output_stream)</div><div class="ttdef"><b>Definition:</b> tree.cc:432</div></div>
<div class="ttc" id="aclassoomph_1_1Tree_html_a3caab39c8bee6fb65bbafed523aa6d3d"><div class="ttname"><a href="../../dd/d99/classoomph_1_1Tree.html#a3caab39c8bee6fb65bbafed523aa6d3d">oomph::Tree::traverse_all</a></div><div class="ttdeci">void traverse_all(Tree::VoidMemberFctPt member_function)</div><div class="ttdef"><b>Definition:</b> tree.cc:145</div></div>
<div class="ttc" id="aclassoomph_1_1Tree_html_aea17489589a1872db51f2b142da4c1fb"><div class="ttname"><a href="../../dd/d99/classoomph_1_1Tree.html#aea17489589a1872db51f2b142da4c1fb">oomph::Tree::deactivate_object</a></div><div class="ttdeci">void deactivate_object()</div><div class="ttdoc">Call the RefineableElement's deactivate_element() function.</div><div class="ttdef"><b>Definition:</b> tree.cc:341</div></div>
<div class="ttc" id="aclassoomph_1_1Tree_html_aef175445b09edb47624c4b88c6d548bc"><div class="ttname"><a href="../../dd/d99/classoomph_1_1Tree.html#aef175445b09edb47624c4b88c6d548bc">oomph::Tree::traverse_all_but_leaves</a></div><div class="ttdeci">void traverse_all_but_leaves(Tree::VoidMemberFctPt member_function)</div><div class="ttdef"><b>Definition:</b> tree.cc:184</div></div>
<div class="ttc" id="aclassoomph_1_1Tree_html_af4f977931ece6b719a9e616037bb2481"><div class="ttname"><a href="../../dd/d99/classoomph_1_1Tree.html#af4f977931ece6b719a9e616037bb2481">oomph::Tree::merge_sons_if_required</a></div><div class="ttdeci">void merge_sons_if_required(Mesh *&amp;mesh_pt)</div><div class="ttdef"><b>Definition:</b> tree.cc:302</div></div>
<div class="ttc" id="agroup__Core__Module_html_ga0e45b6b2adead7c6a29815b99f9f14dd"><div class="ttname"><a href="../../df/d04/group__Core__Module.html#ga0e45b6b2adead7c6a29815b99f9f14dd">Eigen::placeholders::end</a></div><div class="ttdeci">static constexpr lastp1_t end</div><div class="ttdef"><b>Definition:</b> IndexedViewHelper.h:79</div></div>
<div class="ttc" id="alevel1__cplx__impl_8h_html_a462761ca92ad97a9a705cb875828b0b8"><div class="ttname"><a href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a></div><div class="ttdeci">RealScalar s</div><div class="ttdef"><b>Definition:</b> level1_cplx_impl.h:130</div></div>
<div class="ttc" id="anamespaceoomph_1_1Global__timings_html_af25dd181537f6e338daadd0a73d269a0"><div class="ttname"><a href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">oomph::Global_timings::Doc_comprehensive_timings</a></div><div class="ttdeci">bool Doc_comprehensive_timings</div><div class="ttdef"><b>Definition:</b> oomph_definitions.cc:49</div></div>
<div class="ttc" id="anamespaceoomph_1_1TimingHelpers_html_a9fb6ad7e2e01b0914e9f7072ef9ebfa6"><div class="ttname"><a href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">oomph::TimingHelpers::timer</a></div><div class="ttdeci">double timer()</div><div class="ttdoc">returns the time in seconds after some point in past</div><div class="ttdef"><b>Definition:</b> oomph_utilities.cc:1295</div></div>
<div class="ttc" id="anamespaceplotDoE_html_a4758fc6194247f040938f29c863d21ee"><div class="ttname"><a href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">plotDoE.x</a></div><div class="ttdeci">list x</div><div class="ttdef"><b>Definition:</b> plotDoE.py:28</div></div>
<div class="ttc" id="anamespaceplotPSD_html_a112f38a9c28b7e27fed13fb3ebf10362"><div class="ttname"><a href="../../dd/ddd/namespaceplotPSD.html#a112f38a9c28b7e27fed13fb3ebf10362">plotPSD.t</a></div><div class="ttdeci">t</div><div class="ttdef"><b>Definition:</b> plotPSD.py:36</div></div>
<div class="ttc" id="atut__arithmetic__redux__minmax_8cpp_html_a39513f0f8d942bf9ef17b2e87ac6d34e"><div class="ttname"><a href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a></div><div class="ttdeci">std::ptrdiff_t j</div><div class="ttdef"><b>Definition:</b> tut_arithmetic_redux_minmax.cpp:2</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a875271b6f162ddc5685a2511b35e75ec">oomph::Mesh::boundary_element_pt()</a>, <a class="el" href="../../d2/d36/classoomph_1_1TreeForest.html#a0e6a7f821d9f14374c6d23d8766c7679">oomph::TreeForest::check_all_neighbours()</a>, <a class="el" href="../../d2/d36/classoomph_1_1TreeForest.html#ace63bb552b21ba46eb5ae062826dab26">oomph::TreeForest::close_hanging_node_files()</a>, <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#aab6f14b0933edc819231a88b1d555f62">complete_hanging_nodes()</a>, <a class="el" href="../../dd/d99/classoomph_1_1Tree.html#aea17489589a1872db51f2b142da4c1fb">oomph::Tree::deactivate_object()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a9e3ecb07dc622cf37ce0085446ff9aa6">oomph::Mesh::delete_all_external_storage()</a>, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">oomph::FiniteElement::dim()</a>, <a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html#a85d58bcfce0a7b7cae461624e6fcd08a">oomph::DocInfo::directory()</a>, <a class="el" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">oomph::Global_timings::Doc_comprehensive_timings</a>, <a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">oomph::RefineableMeshBase::doc_info()</a>, <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#aca12acfe655a4d5c4a4eab4a7b970812">oomph::Mesh::Element_pt</a>, <a class="el" href="../../df/d04/group__Core__Module.html#ga0e45b6b2adead7c6a29815b99f9f14dd">Eigen::placeholders::end</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a4f274774435e9454bf77bf70de69367a">oomph::Mesh::finite_element_pt()</a>, <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#aaf121b2595ff71815c4e9db35247f951">Forest_pt</a>, <a class="el" href="../../dc/db7/classoomph_1_1Node.html#a33092a3d51285282ae8ec8e702d1cbf5">oomph::Node::get_boundaries_pt()</a>, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a6fc14cbf4e1d031acbc59b415cefa1ca">oomph::FiniteElement::get_x()</a>, <a class="el" href="../../d5/d1a/classoomph_1_1SolidFiniteElement.html#a2e557cb3647e40fe3225bab4d8f834a0">oomph::SolidFiniteElement::get_x_and_xi()</a>, <a class="el" href="../../dc/db7/classoomph_1_1Node.html#a09e3993064a98e7986f392fd5b239603">oomph::Node::hanging_pt()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html#a2ce90cf54f24b4ab523c624031fbb76b">oomph::DocInfo::is_doc_enabled()</a>, <a class="el" href="../../dc/db7/classoomph_1_1Node.html#af0e6237dfafad62cf427ff5013ddcfef">oomph::Node::is_hanging()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a1ab35b022b95f2d28c53aa58859bd6b5">oomph::Mesh::is_mesh_distributed()</a>, <a class="el" href="../../dc/db7/classoomph_1_1Node.html#a2ca215e42116ee8a2acc7d6a35e37788">oomph::Node::is_on_boundary()</a>, <a class="el" href="../../d8/dc5/classoomph_1_1Data.html#aedd0c445396ddcd650c814d17fef77dc">oomph::Data::is_pinned()</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../dc/dfd/classoomph_1_1SolidNode.html#a790277999eb7d8ff0c3f2398d8aaedb0">oomph::SolidNode::lagrangian_position()</a>, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a22bc4ee35e4f948d8d7fba18c7b4f4c4">oomph::FiniteElement::local_coordinate_of_node()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a37f6d27447f643a74694012b09350ce9">oomph::Mesh::Lookup_for_elements_next_boundary_is_setup</a>, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#aa8bce95f69e3199a508672eea7ecc226">oomph::FiniteElement::macro_elem_pt()</a>, <a class="el" href="../../db/d08/classoomph_1_1HangInfo.html#a4983192a13d2ce3d12a454bd895b16e7">oomph::HangInfo::master_node_pt()</a>, <a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a8d7689918a098ce597c3d4fc716a0727">oomph::RefineableMeshBase::max_error()</a>, <a class="el" href="../../dc/d08/classoomph_1_1RefineableElement.html#a25b5901fb0689aefe2c67c361f4290f2">oomph::RefineableElement::max_integrity_tolerance()</a>, <a class="el" href="../../dd/d99/classoomph_1_1Tree.html#af4f977931ece6b719a9e616037bb2481">oomph::Tree::merge_sons_if_required()</a>, <a class="el" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a84543564d6babe4faacbb9d87043fc19">oomph::Mesh::nboundary()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a68e04b3b70cff70d53d75f66661555e8">oomph::Mesh::nboundary_element()</a>, <a class="el" href="../../dc/db7/classoomph_1_1Node.html#a786c96a8e46eb27a03b2b31f629d41b3">oomph::Node::ndim()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">oomph::Mesh::nelement()</a>, <a class="el" href="../../dc/dfd/classoomph_1_1SolidNode.html#af98a0623f9e41a10f48112b9ff7b38a0">oomph::SolidNode::nlagrangian()</a>, <a class="el" href="../../db/d08/classoomph_1_1HangInfo.html#aa9c1130b58db2ff6d5eee4f923ba365c">oomph::HangInfo::nmaster()</a>, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">oomph::FiniteElement::nnode()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a945e7823d1a2af243b5b7f7866aaff5e">oomph::Mesh::nnode()</a>, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a28ae3eb7760edc5c9d6427611d8e6fb6">oomph::FiniteElement::node_pt()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">oomph::Mesh::node_pt()</a>, <a class="el" href="../../d4/d14/classoomph_1_1AlgebraicNode.html#a754dc8fcac3382a07f60262c9792c84c">oomph::AlgebraicNode::node_update()</a>, <a class="el" href="../../d2/d36/classoomph_1_1TreeForest.html#a6796a34cf1211f554a59055ff5765863">oomph::TreeForest::ntree()</a>, <a class="el" href="../../d8/dc5/classoomph_1_1Data.html#a9752205c5fb3bb886200b3fae9181e94">oomph::Data::ntstorage()</a>, <a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html#af27224b25da5b758442753f0947e62d4">oomph::DocInfo::number()</a>, <a class="el" href="../../d8/dc5/classoomph_1_1Data.html#a7e67fc78a2e8a2fd6eb75bd292d42ff8">oomph::Data::nvalue()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, <a class="el" href="../../d2/d36/classoomph_1_1TreeForest.html#a635443274eaa2fb1afa889e4e748608f">oomph::TreeForest::open_hanging_node_files()</a>, <a class="el" href="../../dc/db7/classoomph_1_1Node.html#a61c3ad6b319e4d2cce38dc8faae1bfae">oomph::Node::position()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ac9f58929371a3f39dd646d2756547ad2">oomph::Mesh::prune_dead_nodes()</a>, <a class="el" href="../../dc/db7/classoomph_1_1Node.html#abc9f54df56cbe8eedc6f1595c7d7f11e">oomph::Node::raw_value()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a801e77424d1bf8a35c9bba055230f1e3">oomph::Mesh::reorder_nodes()</a>, <a class="el" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>, <a class="el" href="../../dc/db7/classoomph_1_1Node.html#a6dfc895be93214f4a880c1e9e7a3b4a6">oomph::Node::set_non_obsolete()</a>, <a class="el" href="../../dc/db7/classoomph_1_1Node.html#a2517b670b4494f5421f5ec0d92cf8bb0">oomph::Node::set_nonhanging()</a>, <a class="el" href="../../dc/db7/classoomph_1_1Node.html#a2f19488a7967f963b073b93dc12728ab">oomph::Node::set_obsolete()</a>, <a class="el" href="../../d8/dc5/classoomph_1_1Data.html#a7289ca322725c6fd493970a19474b382">oomph::Data::set_value()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a6cc8bcd6b41209f0e9295cc993d9c6bb">oomph::Mesh::setup_boundary_element_info()</a>, <a class="el" href="../../db/ddc/benchVecAdd_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>, <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a86dace1f78991fb9b401a31215df89ef">split_elements_if_required()</a>, <a class="el" href="../../d2/d36/classoomph_1_1TreeForest.html#a40bd3735303f019892b03d6a5355c8db">oomph::TreeForest::stick_all_tree_nodes_into_vector()</a>, <a class="el" href="../../d2/d36/classoomph_1_1TreeForest.html#a6d99d1f513a60b9bd053ff98699cbe52">oomph::TreeForest::stick_leaves_into_vector()</a>, <a class="el" href="../../dd/ddd/namespaceplotPSD.html#a112f38a9c28b7e27fed13fb3ebf10362">plotPSD::t</a>, <a class="el" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">oomph::TimingHelpers::timer()</a>, <a class="el" href="../../dd/d99/classoomph_1_1Tree.html#a3caab39c8bee6fb65bbafed523aa6d3d">oomph::Tree::traverse_all()</a>, <a class="el" href="../../dd/d99/classoomph_1_1Tree.html#aef175445b09edb47624c4b88c6d548bc">oomph::Tree::traverse_all_but_leaves()</a>, <a class="el" href="../../d2/d36/classoomph_1_1TreeForest.html#ab031414d924b1637cc4492c7048f3f7a">oomph::TreeForest::tree_pt()</a>, <a class="el" href="../../d5/d1a/classoomph_1_1SolidFiniteElement.html#a20517d8d6ba84c8e90d880f38310915f">oomph::SolidFiniteElement::undeformed_macro_elem_pt()</a>, <a class="el" href="../../dc/db7/classoomph_1_1Node.html#afcc5cdba40bca251826ae5bee5ca15b4">oomph::Node::value()</a>, <a class="el" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">plotDoE::x</a>, <a class="el" href="../../dc/db7/classoomph_1_1Node.html#a056f8e82da938369cd38541c5cdc598a">oomph::Node::x()</a>, and <a class="el" href="../../dc/dfd/classoomph_1_1SolidNode.html#aca98d62374067829ef896bdf62952385">oomph::SolidNode::xi()</a>.</p>

</div>
</div>
<a id="aab6f14b0933edc819231a88b1d555f62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab6f14b0933edc819231a88b1d555f62">&#9670;&nbsp;</a></span>complete_hanging_nodes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::TreeBasedRefineableMeshBase::complete_hanging_nodes </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> &amp;&#160;</td>
          <td class="paramname"><em>ncont_interpolated_values</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Complete the hanging node scheme recursively. </p>
<p>Complete the hanging node scheme recursively. After the initial markup scheme, hanging nodes can depend on other hanging nodes &mdash;&gt; AAAAAAAAARGH! Need to translate this into a scheme where all hanging nodes only depend on non-hanging nodes... </p>
<div class="fragment"><div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;  {</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;    <span class="comment">// Number of nodes in mesh</span></div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n_node = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a945e7823d1a2af243b5b7f7866aaff5e">nnode</a>();</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;    <span class="keywordtype">double</span> min_weight = 1.0e-8; <span class="comment">// RefineableBrickElement::min_weight_value();</span></div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160; </div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;    <span class="comment">// Loop over the nodes in the mesh</span></div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_node; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;    {</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;      <span class="comment">// Assign a local pointer to the node</span></div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;      Node* nod_pt = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">node_pt</a>(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>);</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160; </div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;      <span class="comment">// Loop over the values,</span></div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;      <span class="comment">// N.B. geometric hanging data is stored at the index -1</span></div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = -1; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; ncont_interpolated_values; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;      {</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;        <span class="comment">// Is the node hanging?</span></div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;        <span class="keywordflow">if</span> (nod_pt-&gt;is_hanging(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>))</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;        {</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;          <span class="comment">// If it is geometric OR has hanging node data that differs</span></div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;          <span class="comment">// from the geometric data, we must do some work</span></div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;          <span class="keywordflow">if</span> ((<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> == -1) || (nod_pt-&gt;hanging_pt(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) != nod_pt-&gt;hanging_pt()))</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;          {</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;            <span class="comment">// Find out the ultimate map of dependencies: Master nodes</span></div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;            <span class="comment">// and associated weights</span></div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;            Vector&lt;Node*&gt; master_nodes;</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;            Vector&lt;double&gt; hanging_weights;</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;            <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a6dd9c95ee6c2ffcd687ad0ed736c5ba3">complete_hanging_nodes_recursively</a>(</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;              nod_pt, master_nodes, hanging_weights, <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160; </div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;            <span class="comment">// put them into a map to merge all the occurences of the same node</span></div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;            <span class="comment">// (add the weights)</span></div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;            std::map&lt;Node*, double&gt; hang_weights;</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;            <span class="keywordtype">unsigned</span> n_master = master_nodes.size();</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> = 0; <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> &lt; n_master; <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>++)</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;            {</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">std::fabs</a>(hanging_weights[<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>]) &gt; min_weight)</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;                hang_weights[master_nodes[<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>]] += hanging_weights[<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>];</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;            }</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160; </div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;            <span class="comment">// Create new hanging data (we know how many data there are)</span></div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;            HangInfo* hang_pt = <span class="keyword">new</span> HangInfo(hang_weights.size());</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160; </div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;            <span class="keywordtype">unsigned</span> hang_weights_index = 0;</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;            <span class="comment">// Copy the map into the HangInfo object</span></div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;            <span class="keyword">typedef</span> std::map&lt;Node*, double&gt;::iterator IT;</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;            <span class="keywordflow">for</span> (IT it = hang_weights.begin(); it != hang_weights.end(); ++it)</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;            {</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;              hang_pt-&gt;set_master_node_pt(</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;                hang_weights_index, it-&gt;first, it-&gt;second);</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;              ++hang_weights_index;</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;            }</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160; </div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;            <span class="comment">// Assign the new hanging pointer to the appropriate value</span></div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;            nod_pt-&gt;set_hanging_pt(hang_pt, <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;          }</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;        }</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;      }</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;    }</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160; </div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160; </div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;    <span class="comment">// Check hanging node scheme: The weights need to add up to one</span></div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;    <span class="comment">//-------------------------------------------------------------</span></div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;    <span class="comment">// Loop over all values indices</span></div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = -1; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; ncont_interpolated_values; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;    {</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;      <span class="comment">// Loop over all nodes in mesh</span></div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_node; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;      {</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;        <span class="comment">// Set a local pointer to the node</span></div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;        Node* nod_pt = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">node_pt</a>(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>);</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160; </div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;        <span class="comment">// Is it hanging?</span></div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;        <span class="keywordflow">if</span> (nod_pt-&gt;is_hanging(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>))</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;        {</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;          <span class="keywordtype">unsigned</span> nmaster = nod_pt-&gt;hanging_pt(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)-&gt;nmaster();</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;          <span class="keywordtype">double</span> sum = 0.0;</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> imaster = 0; imaster &lt; nmaster; imaster++)</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;          {</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;            sum += nod_pt-&gt;hanging_pt(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)-&gt;master_weight(imaster);</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;          }</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">std::fabs</a>(sum - 1.0) &gt; 1.0e-7)</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;          {</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;            <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;WARNING: Sum of master node weights fabs(sum-1.0) &quot;</span></div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;                       &lt;&lt; <a class="code" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">std::fabs</a>(sum - 1.0) &lt;&lt; <span class="stringliteral">&quot; for node number &quot;</span> &lt;&lt; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a></div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot; at value &quot;</span> &lt;&lt; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;          }</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;        }</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;      }</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;    }</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1TreeBasedRefineableMeshBase_html_a6dd9c95ee6c2ffcd687ad0ed736c5ba3"><div class="ttname"><a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a6dd9c95ee6c2ffcd687ad0ed736c5ba3">oomph::TreeBasedRefineableMeshBase::complete_hanging_nodes_recursively</a></div><div class="ttdeci">void complete_hanging_nodes_recursively(Node *&amp;nod_pt, Vector&lt; Node * &gt; &amp;master_nodes, Vector&lt; double &gt; &amp;hang_weights, const int &amp;ival)</div><div class="ttdoc">Auxiliary routine for recursive hanging node completion.</div><div class="ttdef"><b>Definition:</b> refineable_mesh.cc:2214</div></div>
<div class="ttc" id="alevel2__impl_8h_html_ad46ea6bf5745e72b985b11878e46a45d"><div class="ttname"><a href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a></div><div class="ttdeci">char char char int int * k</div><div class="ttdef"><b>Definition:</b> level2_impl.h:374</div></div>
<div class="ttc" id="anamespaceboost_1_1multiprecision_html_ab6f80ccf8e1d88df8a8e3acd039d63eb"><div class="ttname"><a href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">boost::multiprecision::fabs</a></div><div class="ttdeci">Real fabs(const Real &amp;a)</div><div class="ttdef"><b>Definition:</b> boostmultiprec.cpp:117</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a6dd9c95ee6c2ffcd687ad0ed736c5ba3">complete_hanging_nodes_recursively()</a>, <a class="el" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">boost::multiprecision::fabs()</a>, <a class="el" href="../../dc/db7/classoomph_1_1Node.html#a09e3993064a98e7986f392fd5b239603">oomph::Node::hanging_pt()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../dc/db7/classoomph_1_1Node.html#af0e6237dfafad62cf427ff5013ddcfef">oomph::Node::is_hanging()</a>, <a class="el" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>, <a class="el" href="../../db/d08/classoomph_1_1HangInfo.html#a348a41fa20beb782d42f7a2275a4397a">oomph::HangInfo::master_weight()</a>, <a class="el" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>, <a class="el" href="../../db/d08/classoomph_1_1HangInfo.html#aa9c1130b58db2ff6d5eee4f923ba365c">oomph::HangInfo::nmaster()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a945e7823d1a2af243b5b7f7866aaff5e">oomph::Mesh::nnode()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">oomph::Mesh::node_pt()</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, <a class="el" href="../../dc/db7/classoomph_1_1Node.html#a98b3e63390c43196db9429f32319b0ca">oomph::Node::set_hanging_pt()</a>, and <a class="el" href="../../db/d08/classoomph_1_1HangInfo.html#afe4042d5805342d5e12b6a28e376885a">oomph::HangInfo::set_master_node_pt()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#acef8ac2f0f2cffe938031db1499c598b">adapt_mesh()</a>, and <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a5d714967dc71ba477c2ca807bbf6d6bd">p_adapt_mesh()</a>.</p>

</div>
</div>
<a id="a6dd9c95ee6c2ffcd687ad0ed736c5ba3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6dd9c95ee6c2ffcd687ad0ed736c5ba3">&#9670;&nbsp;</a></span>complete_hanging_nodes_recursively()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::TreeBasedRefineableMeshBase::complete_hanging_nodes_recursively </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dc/db7/classoomph_1_1Node.html">Node</a> *&amp;&#160;</td>
          <td class="paramname"><em>nod_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../dc/db7/classoomph_1_1Node.html">Node</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>master_nodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>hang_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> &amp;&#160;</td>
          <td class="paramname"><em>i</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Auxiliary routine for recursive hanging node completion. </p>
<p>Given a node, return a vector of pointers to master nodes and a vector of the associated weights. This is done recursively, so if a node is not hanging, the node is regarded as its own master node which has weight 1.0. </p>
<div class="fragment"><div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;  {</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;    <span class="comment">// Is the node hanging in the variable i</span></div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;    <span class="keywordflow">if</span> (nod_pt-&gt;is_hanging(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>))</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;    {</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;      <span class="comment">// Loop over all master nodes</span></div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;      HangInfo* <span class="keyword">const</span> hang_pt = nod_pt-&gt;hanging_pt(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;      <span class="keywordtype">unsigned</span> nmaster = hang_pt-&gt;nmaster();</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160; </div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> = 0; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> &lt; nmaster; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>++)</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;      {</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;        <span class="comment">// Get the master node</span></div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;        Node* master_nod_pt = hang_pt-&gt;master_node_pt(<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>);</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160; </div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;        <span class="comment">// Keep in memory the size of the list before adding the nodes this</span></div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;        <span class="comment">// master node depends on. This is required so that the recursion is</span></div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;        <span class="comment">// only performed on these particular master nodes. A master node</span></div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;        <span class="comment">// could contain contributions from two separate pseudo-masters.</span></div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;        <span class="comment">// These contributions must be summed, not multiplied.</span></div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;        <span class="keywordtype">int</span> first_new_node = master_nodes.size();</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160; </div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;        <span class="comment">// Now check which master nodes this master node depends on</span></div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;        <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a6dd9c95ee6c2ffcd687ad0ed736c5ba3">complete_hanging_nodes_recursively</a>(</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;          master_nod_pt, master_nodes, hang_weights, <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160; </div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;        <span class="comment">// Multiply old weight by new weight for all the nodes this master</span></div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;        <span class="comment">// node depends on</span></div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;        <span class="keywordtype">unsigned</span> n_new_master_node = master_nodes.size();</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160; </div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;        <span class="keywordtype">double</span> mtr_weight = hang_pt-&gt;master_weight(<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>);</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160; </div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> = first_new_node; <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> &lt; n_new_master_node; <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>++)</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;        {</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;          hang_weights[<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>] = mtr_weight * hang_weights[<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>];</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;        }</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;      }</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;    }</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;    <span class="comment">// Node isn&#39;t hanging so it enters itself with the full weight</span></div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;    {</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;      master_nodes.push_back(nod_pt);</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;      hang_weights.push_back(1.0);</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;    }</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;  }</div>
<div class="ttc" id="alevel2__cplx__impl_8h_html_a8d334fd8388055a029936c59d361ff00"><div class="ttname"><a href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a></div><div class="ttdeci">int * m</div><div class="ttdef"><b>Definition:</b> level2_cplx_impl.h:294</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/db7/classoomph_1_1Node.html#a09e3993064a98e7986f392fd5b239603">oomph::Node::hanging_pt()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../dc/db7/classoomph_1_1Node.html#af0e6237dfafad62cf427ff5013ddcfef">oomph::Node::is_hanging()</a>, <a class="el" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>, <a class="el" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>, <a class="el" href="../../db/d08/classoomph_1_1HangInfo.html#a4983192a13d2ce3d12a454bd895b16e7">oomph::HangInfo::master_node_pt()</a>, <a class="el" href="../../db/d08/classoomph_1_1HangInfo.html#a348a41fa20beb782d42f7a2275a4397a">oomph::HangInfo::master_weight()</a>, and <a class="el" href="../../db/d08/classoomph_1_1HangInfo.html#aa9c1130b58db2ff6d5eee4f923ba365c">oomph::HangInfo::nmaster()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#aab6f14b0933edc819231a88b1d555f62">complete_hanging_nodes()</a>.</p>

</div>
</div>
<a id="a885171376e32cff058ab2fa4df6ca3c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a885171376e32cff058ab2fa4df6ca3c6">&#9670;&nbsp;</a></span>doc_adaptivity_targets()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::TreeBasedRefineableMeshBase::doc_adaptivity_targets </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>outfile</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Doc the targets for mesh adaptation. </p>

<p>Reimplemented from <a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a9f54bbde6fbfe2fef719c4d3fa5e0ae7">oomph::RefineableMeshBase</a>.</p>
<div class="fragment"><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    {</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;      outfile &lt;&lt; std::endl;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      outfile &lt;&lt; <span class="stringliteral">&quot;Targets for mesh adaptation: &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;      outfile &lt;&lt; <span class="stringliteral">&quot;---------------------------- &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;      outfile &lt;&lt; <span class="stringliteral">&quot;Target for max. error: &quot;</span> &lt;&lt; <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#af3a2b9ae35dd65e377032c53c4f25ca9">Max_permitted_error</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;      outfile &lt;&lt; <span class="stringliteral">&quot;Target for min. error: &quot;</span> &lt;&lt; <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#ac623d3a2406dc79c517636ad6abad0d3">Min_permitted_error</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;      outfile &lt;&lt; <span class="stringliteral">&quot;Min. refinement level: &quot;</span> &lt;&lt; <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#af48df64966833ed693c11576ff28ada1">Min_refinement_level</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      outfile &lt;&lt; <span class="stringliteral">&quot;Max. refinement level: &quot;</span> &lt;&lt; <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#acd1c5544779f42de66b25a0225644f7d">Max_refinement_level</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      outfile &lt;&lt; <span class="stringliteral">&quot;Min. p-refinement level: &quot;</span> &lt;&lt; <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#abd9b33d333c11837b3d2dbca163b6320">Min_p_refinement_level</a></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;              &lt;&lt; std::endl;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      outfile &lt;&lt; <span class="stringliteral">&quot;Max. p-refinement level: &quot;</span> &lt;&lt; <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a39ab498ac06506e1500f9f03e8cecf72">Max_p_refinement_level</a></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;              &lt;&lt; std::endl;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      outfile &lt;&lt; <span class="stringliteral">&quot;Don&#39;t unrefine if less than &quot;</span> &lt;&lt; <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a55c7480baae4082f4da4cbb48c40c623">Max_keep_unrefined</a></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;              &lt;&lt; <span class="stringliteral">&quot; elements need unrefinement.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      outfile &lt;&lt; std::endl;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1RefineableMeshBase_html_a55c7480baae4082f4da4cbb48c40c623"><div class="ttname"><a href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a55c7480baae4082f4da4cbb48c40c623">oomph::RefineableMeshBase::Max_keep_unrefined</a></div><div class="ttdeci">unsigned Max_keep_unrefined</div><div class="ttdef"><b>Definition:</b> refineable_mesh.h:359</div></div>
<div class="ttc" id="aclassoomph_1_1RefineableMeshBase_html_ac623d3a2406dc79c517636ad6abad0d3"><div class="ttname"><a href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#ac623d3a2406dc79c517636ad6abad0d3">oomph::RefineableMeshBase::Min_permitted_error</a></div><div class="ttdeci">double Min_permitted_error</div><div class="ttdoc">Min. error (i.e. (try to) merge elements if their error is smaller)</div><div class="ttdef"><b>Definition:</b> refineable_mesh.h:329</div></div>
<div class="ttc" id="aclassoomph_1_1RefineableMeshBase_html_af3a2b9ae35dd65e377032c53c4f25ca9"><div class="ttname"><a href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#af3a2b9ae35dd65e377032c53c4f25ca9">oomph::RefineableMeshBase::Max_permitted_error</a></div><div class="ttdeci">double Max_permitted_error</div><div class="ttdoc">Max. error (i.e. split elements if their error is larger)</div><div class="ttdef"><b>Definition:</b> refineable_mesh.h:326</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a55c7480baae4082f4da4cbb48c40c623">oomph::RefineableMeshBase::Max_keep_unrefined</a>, <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a39ab498ac06506e1500f9f03e8cecf72">Max_p_refinement_level</a>, <a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#af3a2b9ae35dd65e377032c53c4f25ca9">oomph::RefineableMeshBase::Max_permitted_error</a>, <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#acd1c5544779f42de66b25a0225644f7d">Max_refinement_level</a>, <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#abd9b33d333c11837b3d2dbca163b6320">Min_p_refinement_level</a>, <a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#ac623d3a2406dc79c517636ad6abad0d3">oomph::RefineableMeshBase::Min_permitted_error</a>, and <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#af48df64966833ed693c11576ff28ada1">Min_refinement_level</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/db6/classFSIRingProblem.html#acbb3bc5cd6d16cfee7a2f19a3b984ce7">FSIRingProblem::dynamic_run()</a>.</p>

</div>
</div>
<a id="a2398683f533e5ba0960fbbe9ff545fb2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2398683f533e5ba0960fbbe9ff545fb2">&#9670;&nbsp;</a></span>dump_refinement()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::TreeBasedRefineableMeshBase::dump_refinement </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>outfile</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Dump refinement pattern to allow for rebuild. </p>
<p>Dump refinement pattern to allow for rebuild </p>
<div class="fragment"><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  {</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="comment">// Assign storage for refinement pattern</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    Vector&lt;Vector&lt;unsigned&gt;&gt; to_be_refined;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="comment">// Get refinement pattern of reference mesh:</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#ae61cbe29fa2aa644af32e73854d5cab3">get_refinement_pattern</a>(to_be_refined);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="comment">// Dump max refinement level:</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordtype">unsigned</span> max_level = to_be_refined.size();</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    outfile &lt;&lt; max_level &lt;&lt; <span class="stringliteral">&quot; # max. refinement level &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="comment">// Doc the numbers of the elements that need to be refined at this level</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> l = 0; l &lt; max_level; l++)</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      <span class="comment">// Loop over elements that need to be refined at this level</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      <span class="keywordtype">unsigned</span> n_to_be_refined = to_be_refined[l].size();</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      outfile &lt;&lt; n_to_be_refined &lt;&lt; <span class="stringliteral">&quot; # number of elements to be refined. &quot;</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;What follows are the numbers of the elements. &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      <span class="comment">// Select relevant elements to be refined</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_to_be_refined; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        outfile &lt;&lt; to_be_refined[l][<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      }</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1TreeBasedRefineableMeshBase_html_ae61cbe29fa2aa644af32e73854d5cab3"><div class="ttname"><a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#ae61cbe29fa2aa644af32e73854d5cab3">oomph::TreeBasedRefineableMeshBase::get_refinement_pattern</a></div><div class="ttdeci">virtual void get_refinement_pattern(Vector&lt; Vector&lt; unsigned &gt;&gt; &amp;to_be_refined)</div><div class="ttdef"><b>Definition:</b> refineable_mesh.cc:50</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#ae61cbe29fa2aa644af32e73854d5cab3">get_refinement_pattern()</a>, and <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>.</p>

</div>
</div>
<a id="a3c5084830a90bf527a27271613b858a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c5084830a90bf527a27271613b858a7">&#9670;&nbsp;</a></span>forest_pt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d2/d36/classoomph_1_1TreeForest.html">TreeForest</a>* oomph::TreeBasedRefineableMeshBase::forest_pt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return pointer to the Forest represenation of the mesh. </p>
<div class="fragment"><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    {</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#aaf121b2595ff71815c4e9db35247f951">Forest_pt</a>;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#aaf121b2595ff71815c4e9db35247f951">Forest_pt</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a0d5d1cfce0db7953c21eef213049c433">get_elements_at_refinement_level()</a>, <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#ae61cbe29fa2aa644af32e73854d5cab3">get_refinement_pattern()</a>, <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a5d714967dc71ba477c2ca807bbf6d6bd">p_adapt_mesh()</a>, and <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a7451ff312a3ac482b2f62ded020630c3">refine_as_in_reference_mesh()</a>.</p>

</div>
</div>
<a id="a0d5d1cfce0db7953c21eef213049c433"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d5d1cfce0db7953c21eef213049c433">&#9670;&nbsp;</a></span>get_elements_at_refinement_level()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::TreeBasedRefineableMeshBase::get_elements_at_refinement_level </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>refinement_level</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../dc/d08/classoomph_1_1RefineableElement.html">RefineableElement</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>level_elements</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Extract the elements at a particular refinement level in the refinement pattern - used in Mesh::redistribute or whatever it's going to be called (RefineableMeshBase::reduce_halo_layers or something)</p>
<p>Extract the elements at a particular refinement level in the refinement pattern (used in Mesh::redistribute or whatever it's going to be called (RefineableMeshBase::reduce_halo_layers or something) </p>
<div class="fragment"><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="comment">// Extract *all* elements from current (fully refined) mesh.</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    Vector&lt;Tree*&gt; all_tree_nodes_pt;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a3c5084830a90bf527a27271613b858a7">forest_pt</a>()-&gt;<a class="code" href="../../d2/d36/classoomph_1_1TreeForest.html#a40bd3735303f019892b03d6a5355c8db">stick_all_tree_nodes_into_vector</a>(all_tree_nodes_pt);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="comment">// Add the element to the vector if its level matches refinement_level</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keywordtype">unsigned</span> nnodes = all_tree_nodes_pt.size();</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; nnodes; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      <span class="keywordtype">unsigned</span> level = all_tree_nodes_pt[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>]-&gt;level();</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      <span class="keywordflow">if</span> (level == refinement_level)</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        level_elements.push_back(</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;          <span class="keyword">dynamic_cast&lt;</span>RefineableElement*<span class="keyword">&gt;</span>(all_tree_nodes_pt[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>]-&gt;object_pt()));</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      }</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    }</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1TreeBasedRefineableMeshBase_html_a3c5084830a90bf527a27271613b858a7"><div class="ttname"><a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a3c5084830a90bf527a27271613b858a7">oomph::TreeBasedRefineableMeshBase::forest_pt</a></div><div class="ttdeci">TreeForest * forest_pt()</div><div class="ttdoc">Return pointer to the Forest represenation of the mesh.</div><div class="ttdef"><b>Definition:</b> refineable_mesh.h:460</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a3c5084830a90bf527a27271613b858a7">forest_pt()</a>, and <a class="el" href="../../d2/d36/classoomph_1_1TreeForest.html#a40bd3735303f019892b03d6a5355c8db">oomph::TreeForest::stick_all_tree_nodes_into_vector()</a>.</p>

</div>
</div>
<a id="a937e4321288b6642d5057498f7659d76"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a937e4321288b6642d5057498f7659d76">&#9670;&nbsp;</a></span>get_refinement_levels()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::TreeBasedRefineableMeshBase::get_refinement_levels </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>min_refinement_level</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>max_refinement_level</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get max/min refinement levels in mesh. </p>
<p>Get max/min refinement level. </p>
<div class="fragment"><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;  {</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    <span class="comment">// Initialise</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#af3974421171e1bb10daf6864f0749675">min_refinement_level</a> = UINT_MAX;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a18bf22913dc5daf45fb3995d9ec30bfc">max_refinement_level</a> = 0;</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160; </div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    <span class="comment">// Loop over all elements</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n_element = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">nelement</a>();</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <span class="keywordflow">if</span> (n_element == 0)</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    {</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;      <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#af3974421171e1bb10daf6864f0749675">min_refinement_level</a> = 0;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;      <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a18bf22913dc5daf45fb3995d9ec30bfc">max_refinement_level</a> = 0;</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    }</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    {</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; n_element; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;      {</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;        <span class="comment">// Get the refinement level of the element</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        <span class="keywordtype">unsigned</span> level = <span class="keyword">dynamic_cast&lt;</span>RefineableElement*<span class="keyword">&gt;</span>(this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ab28b03dabf4e247c4a25f834eb11b339">element_pt</a>(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>))</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                           -&gt;refinement_level();</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160; </div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        <span class="keywordflow">if</span> (level &gt; <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a18bf22913dc5daf45fb3995d9ec30bfc">max_refinement_level</a>) <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a18bf22913dc5daf45fb3995d9ec30bfc">max_refinement_level</a> = level;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;        <span class="keywordflow">if</span> (level &lt; <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#af3974421171e1bb10daf6864f0749675">min_refinement_level</a>) <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#af3974421171e1bb10daf6864f0749675">min_refinement_level</a> = level;</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;      }</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    }</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ab28b03dabf4e247c4a25f834eb11b339">oomph::Mesh::element_pt()</a>, <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a18bf22913dc5daf45fb3995d9ec30bfc">max_refinement_level()</a>, <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#af3974421171e1bb10daf6864f0749675">min_refinement_level()</a>, and <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">oomph::Mesh::nelement()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a4f6011ef141cc68598a9502052129a3f">oomph::Problem::read()</a>, <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a7451ff312a3ac482b2f62ded020630c3">refine_as_in_reference_mesh()</a>, <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a13548e57b680c5e7466d1deeb8f12ff0">refine_base_mesh()</a>, <a class="el" href="../../de/d14/classoomph_1_1RefineableBrickMesh.html#a7488ae090e09e3f1e01b20a2c2c7a188">oomph::RefineableBrickMesh&lt; ELEMENT &gt;::setup_octree_forest()</a>, and <a class="el" href="../../dc/dc1/classoomph_1_1RefineableQuadMesh.html#ab27780da6f9be1b625d75fc4973ce8f1">oomph::RefineableQuadMesh&lt; ELEMENT &gt;::setup_quadtree_forest()</a>.</p>

</div>
</div>
<a id="ae61cbe29fa2aa644af32e73854d5cab3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae61cbe29fa2aa644af32e73854d5cab3">&#9670;&nbsp;</a></span>get_refinement_pattern()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::TreeBasedRefineableMeshBase::get_refinement_pattern </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>to_be_refined</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Extract refinement pattern: Consider the hypothetical mesh obtained by truncating the refinement of the current mesh to a given level (where <code>level=0</code> is the un-refined base mesh). To advance to the next refinement level, we need to refine (split) the <code>to_be_refined</code>[level].size() elements identified by the element numbers contained in <code>vector</code> to_be_refined[level][...]</p>
<p>Get refinement pattern of mesh: Consider the hypothetical mesh obtained by truncating the refinement of the current mesh to a given level (where <code>level=0</code> is the un-refined base mesh). To advance to the next refinement level, we need to refine (split) the <code>to_be_refined</code>[level].size() elements identified by the element numbers contained in <code>vector</code> to_be_refined[level][...] </p>
<div class="fragment"><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="comment">// Extract *all* elements from current (fully refined) mesh.</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    Vector&lt;Tree*&gt; all_tree_nodes_pt;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a3c5084830a90bf527a27271613b858a7">forest_pt</a>()-&gt;<a class="code" href="../../d2/d36/classoomph_1_1TreeForest.html#a40bd3735303f019892b03d6a5355c8db">stick_all_tree_nodes_into_vector</a>(all_tree_nodes_pt);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="comment">// Find out maximum refinement level</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keywordtype">unsigned</span> max_level = 0;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordtype">unsigned</span> nnodes = all_tree_nodes_pt.size();</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; nnodes; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    {</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <span class="keywordtype">unsigned</span> level = all_tree_nodes_pt[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>]-&gt;level();</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <span class="keywordflow">if</span> (level &gt; max_level) max_level = level;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    }</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="comment">// Assign storage for refinement pattern</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    to_be_refined.clear();</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    to_be_refined.resize(max_level);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    Vector&lt;unsigned&gt; el_count(max_level);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="comment">// Initialise count of elements that exist in mesh when refinement</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="comment">// has proceeded to this level</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> l = 0; l &lt; max_level; l++)</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      el_count[l] = 0;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="comment">// Loop over all levels and extract all elements that exist</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="comment">// in reference mesh when refinement has proceeded to this level</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> l = 0; l &lt; max_level; l++)</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <span class="comment">// Loop over all elements (tree nodes)</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; nnodes; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="comment">// What level does this element exist on?</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <span class="keywordtype">unsigned</span> level = all_tree_nodes_pt[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>]-&gt;level();</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <span class="comment">// Element is part of the mesh at this refinement level</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <span class="comment">// if it exists at this level OR if it exists at a lower level</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="comment">// and is a leaf</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <span class="keywordflow">if</span> ((level == l) || ((level &lt; l) &amp;&amp; (all_tree_nodes_pt[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>]-&gt;is_leaf())))</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;          <span class="comment">// If element exsts at this level and is not a leaf it will</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;          <span class="comment">// be refined when we move to the next level:</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;          <span class="keywordflow">if</span> ((level == l) &amp;&amp; (!all_tree_nodes_pt[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>]-&gt;is_leaf()))</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;          {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            <span class="comment">// Add element number (in mesh at current refinement level)</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            <span class="comment">// to the list of elements that need to be refined</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            to_be_refined[l].push_back(el_count[l]);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;          }</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;          <span class="comment">// Element exists in this mesh: Add to counter</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;          el_count[l]++;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        }</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      }</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    }</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a3c5084830a90bf527a27271613b858a7">forest_pt()</a>, and <a class="el" href="../../d2/d36/classoomph_1_1TreeForest.html#a40bd3735303f019892b03d6a5355c8db">oomph::TreeForest::stick_all_tree_nodes_into_vector()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a2398683f533e5ba0960fbbe9ff545fb2">dump_refinement()</a>, <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a6a69f5485eb426f6f60ed5a92db383a3">refine_base_mesh_as_in_reference_mesh()</a>, and <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#ae6fc7cc7acf368423cc49cc10ab276bc">refine_base_mesh_as_in_reference_mesh_minus_one()</a>.</p>

</div>
</div>
<a id="a957a33d2b7dd59f8789f4d0e9c6357c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a957a33d2b7dd59f8789f4d0e9c6357c2">&#9670;&nbsp;</a></span>max_p_refinement_level()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&amp; oomph::TreeBasedRefineableMeshBase::max_p_refinement_level </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Access fct for max. permissible p-refinement level (relative to base mesh) </p>
<div class="fragment"><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    {</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a39ab498ac06506e1500f9f03e8cecf72">Max_p_refinement_level</a>;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a39ab498ac06506e1500f9f03e8cecf72">Max_p_refinement_level</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#acec4254dc1b7c75870cfa0bd0c4e363e">p_adapt()</a>.</p>

</div>
</div>
<a id="a18bf22913dc5daf45fb3995d9ec30bfc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18bf22913dc5daf45fb3995d9ec30bfc">&#9670;&nbsp;</a></span>max_refinement_level()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&amp; oomph::TreeBasedRefineableMeshBase::max_refinement_level </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Access fct for max. permissible refinement level (relative to base mesh) </p>
<div class="fragment"><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    {</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#acd1c5544779f42de66b25a0225644f7d">Max_refinement_level</a>;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#acd1c5544779f42de66b25a0225644f7d">Max_refinement_level</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#ac98d4120b99d5c6cbcf7225a9ee5648d">adapt()</a>, <a class="el" href="../../da/db6/classFSIRingProblem.html#acbb3bc5cd6d16cfee7a2f19a3b984ce7">FSIRingProblem::dynamic_run()</a>, and <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a937e4321288b6642d5057498f7659d76">get_refinement_levels()</a>.</p>

</div>
</div>
<a id="a42486bb8abcb77663adc361eaa442a3b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42486bb8abcb77663adc361eaa442a3b">&#9670;&nbsp;</a></span>min_p_refinement_level()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&amp; oomph::TreeBasedRefineableMeshBase::min_p_refinement_level </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Access fct for min. permissible p-refinement level (relative to base mesh) </p>
<div class="fragment"><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    {</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#abd9b33d333c11837b3d2dbca163b6320">Min_p_refinement_level</a>;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#abd9b33d333c11837b3d2dbca163b6320">Min_p_refinement_level</a>.</p>

</div>
</div>
<a id="af3974421171e1bb10daf6864f0749675"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3974421171e1bb10daf6864f0749675">&#9670;&nbsp;</a></span>min_refinement_level()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&amp; oomph::TreeBasedRefineableMeshBase::min_refinement_level </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Access fct for min. permissible refinement level (relative to base mesh) </p>
<div class="fragment"><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    {</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#af48df64966833ed693c11576ff28ada1">Min_refinement_level</a>;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#af48df64966833ed693c11576ff28ada1">Min_refinement_level</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#ac98d4120b99d5c6cbcf7225a9ee5648d">adapt()</a>, <a class="el" href="../../da/db6/classFSIRingProblem.html#acbb3bc5cd6d16cfee7a2f19a3b984ce7">FSIRingProblem::dynamic_run()</a>, and <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a937e4321288b6642d5057498f7659d76">get_refinement_levels()</a>.</p>

</div>
</div>
<a id="a82f482d65edc9de7a1b4ec6788c9596a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82f482d65edc9de7a1b4ec6788c9596a">&#9670;&nbsp;</a></span>operator=()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::TreeBasedRefineableMeshBase::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html">TreeBasedRefineableMeshBase</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Broken assignment operator. </p>

</div>
</div>
<a id="acec4254dc1b7c75870cfa0bd0c4e363e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acec4254dc1b7c75870cfa0bd0c4e363e">&#9670;&nbsp;</a></span>p_adapt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::TreeBasedRefineableMeshBase::p_adapt </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>elemental_error</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>p-adapt mesh: Refine elements whose error is lager than err_max and (try to) unrefine those whose error is smaller than err_min</p>
<p>///////////////////////////////////////////////////////////////// ///////////////////////////////////////////////////////////////// ///////////////////////////////////////////////////////////////// Do adaptive p-refinement for mesh.</p><ul>
<li>Pass Vector of error estimates for all elements.</li>
<li>p-refine those whose errors exceeds the threshold</li>
<li>p-unrefine those whose errors is less than threshold. </li>
</ul>
<p>/ ... otherwise mark it as having been over-ruled</p>

<p>Reimplemented from <a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a03222065e7dfe9eac96fbd58faf0e4ab">oomph::RefineableMeshBase</a>.</p>
<div class="fragment"><div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;  {</div>
<div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;    <span class="comment">// Set the refinement tolerance to be the max permissible error</span></div>
<div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;    <span class="keywordtype">double</span> refine_tol = this-&gt;<a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#adb5ba9ac30bf0a0683eb30f5703800e4">max_permitted_error</a>();</div>
<div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160; </div>
<div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;    <span class="comment">// Set the unrefinement tolerance to be the min permissible error</span></div>
<div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;    <span class="keywordtype">double</span> unrefine_tol = this-&gt;<a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#ad3a13bfaf687135d0154ce2f9b60edb7">min_permitted_error</a>();</div>
<div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160; </div>
<div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;    <span class="comment">// Setup doc info</span></div>
<div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;    DocInfo local_doc_info;</div>
<div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a706216900b53bc7d9214e1f982e69309">doc_info_pt</a>() == 0)</div>
<div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;    {</div>
<div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;      local_doc_info.disable_doc();</div>
<div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;    }</div>
<div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;    {</div>
<div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;      local_doc_info = this-&gt;<a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>();</div>
<div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;    }</div>
<div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160; </div>
<div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160; </div>
<div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;    <span class="comment">// Check that the errors make sense</span></div>
<div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;    <span class="keywordflow">if</span> (refine_tol &lt;= unrefine_tol)</div>
<div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;    {</div>
<div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;      std::ostringstream error_stream;</div>
<div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;      error_stream &lt;&lt; <span class="stringliteral">&quot;Refinement tolerance &lt;= Unrefinement tolerance&quot;</span></div>
<div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;                   &lt;&lt; refine_tol &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; unrefine_tol &lt;&lt; std::endl</div>
<div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;doesn&#39;t make sense and will almost certainly crash&quot;</span></div>
<div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;                   &lt;&lt; std::endl</div>
<div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;this beautiful code!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160; </div>
<div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;        error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;    }</div>
<div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160; </div>
<div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160; </div>
<div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;    <span class="comment">// Select elements for refinement and unrefinement</span></div>
<div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;    <span class="comment">//==============================================</span></div>
<div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;    <span class="comment">// Reset counter for number of elements that would like to be</span></div>
<div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;    <span class="comment">// refined further but can&#39;t</span></div>
<div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;    this-&gt;<a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#af189058782c7217f6d29a6f9555e7c3d">nrefinement_overruled</a>() = 0;</div>
<div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160; </div>
<div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;    <span class="keywordtype">unsigned</span> n_refine = 0;</div>
<div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;    <span class="keywordtype">unsigned</span> n_unrefine = 0;</div>
<div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;    <span class="comment">// Loop over all elements and mark them according to the error criterion</span></div>
<div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> Nelement = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">nelement</a>();</div>
<div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; Nelement; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;    {</div>
<div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;      <span class="comment">//(Cast) pointer to the element</span></div>
<div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;      PRefineableElement* el_pt =</div>
<div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;        <span class="keyword">dynamic_cast&lt;</span>PRefineableElement*<span class="keyword">&gt;</span>(this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ab28b03dabf4e247c4a25f834eb11b339">element_pt</a>(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>));</div>
<div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160; </div>
<div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;      <span class="comment">// Check that we can p-refine the element</span></div>
<div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;      <span class="keywordflow">if</span> (el_pt != 0)</div>
<div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;      {</div>
<div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;        <span class="comment">// Initially element is not to be refined</span></div>
<div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;        el_pt-&gt;deselect_for_p_refinement();</div>
<div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;        el_pt-&gt;deselect_for_p_unrefinement();</div>
<div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160; </div>
<div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;        <span class="comment">// If the element error exceeds the threshold ...</span></div>
<div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;        <span class="keywordflow">if</span> (elemental_error[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>] &gt; refine_tol)</div>
<div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;        {</div>
<div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;          <span class="comment">// ... and its refinement level is less than the maximum desired level</span></div>
<div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;          <span class="comment">// mark is to be refined</span></div>
<div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;          <span class="keywordflow">if</span> ((el_pt-&gt;p_refinement_is_enabled()) &amp;&amp;</div>
<div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;              (el_pt-&gt;p_order() &lt; this-&gt;<a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a957a33d2b7dd59f8789f4d0e9c6357c2">max_p_refinement_level</a>()))</div>
<div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;          {</div>
<div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;            el_pt-&gt;select_for_p_refinement();</div>
<div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;            n_refine++;</div>
<div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;          }</div>
<div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;          <span class="comment">// ... otherwise mark it as having been over-ruled</span></div>
<div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;          {</div>
<div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;            this-&gt;<a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#af189058782c7217f6d29a6f9555e7c3d">nrefinement_overruled</a>() += 1;</div>
<div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;          }</div>
<div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;        }</div>
<div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;        <span class="keywordflow">if</span> (elemental_error[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>] &lt; unrefine_tol)</div>
<div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;        {</div>
<div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;          <span class="comment">// ... and its refinement level is more than the minimum desired level</span></div>
<div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;          <span class="comment">// mark is to be refined</span></div>
<div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;          <span class="comment">//(Also check that we don&#39;t unrefine past the initial refinement</span></div>
<div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;          <span class="comment">// level)</span></div>
<div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;          <span class="keywordflow">if</span> ((el_pt-&gt;p_refinement_is_enabled()) &amp;&amp;</div>
<div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;              (el_pt-&gt;p_order() &gt; this-&gt;min_p_refinement_level()) &amp;&amp;</div>
<div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;              (el_pt-&gt;p_order() &gt; el_pt-&gt;initial_p_order()))</div>
<div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;          {</div>
<div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;            el_pt-&gt;select_for_p_unrefinement();</div>
<div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;            n_unrefine++;</div>
<div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;          }</div>
<div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;          <span class="comment">// Don&#39;t mark as overruled - it&#39;s misleading</span></div>
<div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;<span class="comment"></span>          <span class="comment">// else</span></div>
<div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;          <span class="comment">// {</span></div>
<div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;          <span class="comment">//  this-&gt;nrefinement_overruled()+=1;</span></div>
<div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;          <span class="comment">// }</span></div>
<div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;        }</div>
<div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;      } <span class="comment">// End of check for p-refineability of element</span></div>
<div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;      {</div>
<div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;p-refinement is not possible for these elements&quot;</span></div>
<div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;                   &lt;&lt; std::endl;</div>
<div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;        <span class="comment">// Don&#39;t try to p-refine any more elements</span></div>
<div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;      }</div>
<div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;    }</div>
<div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160; </div>
<div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;    <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot; \n Number of elements to be refined: &quot;</span> &lt;&lt; n_refine</div>
<div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;               &lt;&lt; std::endl;</div>
<div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;    <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot; \n Number of elements whose refinement was overruled: &quot;</span></div>
<div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;               &lt;&lt; this-&gt;<a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#af189058782c7217f6d29a6f9555e7c3d">nrefinement_overruled</a>() &lt;&lt; std::endl;</div>
<div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160; </div>
<div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;    <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot; \n Number of elements to be unrefined : &quot;</span> &lt;&lt; n_unrefine</div>
<div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;               &lt;&lt; std::endl</div>
<div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;               &lt;&lt; std::endl;</div>
<div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160; </div>
<div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160; </div>
<div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;    <span class="comment">// Now do the actual mesh adaptation</span></div>
<div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;    <span class="comment">//---------------------------------</span></div>
<div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160; </div>
<div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;    <span class="comment">// Check whether its worth our while</span></div>
<div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;    <span class="comment">// Either some elements want to be refined,</span></div>
<div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;    <span class="comment">// or the number that want to be unrefined are greater than the</span></div>
<div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;    <span class="comment">// specified tolerance</span></div>
<div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160; </div>
<div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;    <span class="comment">// In a parallel job, it is possible that one process may not have</span></div>
<div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;    <span class="comment">// any elements to refine, BUT a neighbouring process may refine an</span></div>
<div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;    <span class="comment">// element which changes the hanging status of a node that is on</span></div>
<div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;    <span class="comment">// both processes (i.e. a halo(ed) node).  To get around this issue,</span></div>
<div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;    <span class="comment">// ALL processes need to call adapt_mesh if ANY refinement is to</span></div>
<div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;    <span class="comment">// take place anywhere.</span></div>
<div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160; </div>
<div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;    <span class="keywordtype">unsigned</span> total_n_refine = 0;</div>
<div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;    <span class="comment">// Sum n_refine across all processors</span></div>
<div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a1ab35b022b95f2d28c53aa58859bd6b5">is_mesh_distributed</a>())</div>
<div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;    {</div>
<div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;      MPI_Allreduce(</div>
<div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;        &amp;n_refine, &amp;total_n_refine, 1, MPI_INT, MPI_SUM, Comm_pt-&gt;mpi_comm());</div>
<div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;    }</div>
<div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;    {</div>
<div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;      total_n_refine = n_refine;</div>
<div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;    }</div>
<div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;    total_n_refine = n_refine;</div>
<div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160; </div>
<div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;    <span class="comment">// There may be some issues with unrefinement too, but I have not</span></div>
<div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;    <span class="comment">// been able to come up with an example (either in my head or in a</span></div>
<div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;    <span class="comment">// particular problem) where anything has arisen.  I can see that</span></div>
<div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;    <span class="comment">// there may be an issue if n_unrefine differs across processes so</span></div>
<div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;    <span class="comment">// that (total_n_unrefine &gt; max_keep_unrefined()) on some but not</span></div>
<div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;    <span class="comment">// all processes. I haven&#39;t seen any examples of this yet so the</span></div>
<div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;    <span class="comment">// following code may or may not work!  (Andy, 06/03/08)</span></div>
<div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160; </div>
<div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;    <span class="keywordtype">unsigned</span> total_n_unrefine = 0;</div>
<div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;    <span class="comment">// Sum n_unrefine across all processors</span></div>
<div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a1ab35b022b95f2d28c53aa58859bd6b5">is_mesh_distributed</a>())</div>
<div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;    {</div>
<div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160;      MPI_Allreduce(&amp;n_unrefine,</div>
<div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;                    &amp;total_n_unrefine,</div>
<div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;                    1,</div>
<div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160;                    MPI_INT,</div>
<div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;                    MPI_SUM,</div>
<div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;                    Comm_pt-&gt;mpi_comm());</div>
<div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;    }</div>
<div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;    {</div>
<div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;      total_n_unrefine = n_unrefine;</div>
<div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;    }</div>
<div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;    total_n_unrefine = n_unrefine;</div>
<div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160; </div>
<div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;    <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;---&gt; &quot;</span> &lt;&lt; total_n_refine &lt;&lt; <span class="stringliteral">&quot; elements to be refined, and &quot;</span></div>
<div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;               &lt;&lt; total_n_unrefine &lt;&lt; <span class="stringliteral">&quot; to be unrefined, in total.&quot;</span></div>
<div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160;               &lt;&lt; std::endl;</div>
<div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160; </div>
<div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;    <span class="keywordflow">if</span> ((total_n_refine &gt; 0) || (total_n_unrefine &gt; this-&gt;<a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a2216b4d0a8433a1975e6990a5e6533f7">max_keep_unrefined</a>()))</div>
<div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;    {</div>
<div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160; </div>
<div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;      <span class="comment">// Sanity check: Each processor checks if the enforced unrefinement of</span></div>
<div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160;      <span class="comment">// its haloed element is matched by enforced unrefinement of the</span></div>
<div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;      <span class="comment">// corresponding halo elements on the other processors.</span></div>
<div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;      <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a1ab35b022b95f2d28c53aa58859bd6b5">is_mesh_distributed</a>())</div>
<div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;      {</div>
<div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;        <span class="comment">// Store number of processors and current process</span></div>
<div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;        MPI_Status status;</div>
<div class="line"><a name="l04142"></a><span class="lineno"> 4142</span>&#160;        <span class="keywordtype">int</span> n_proc = Comm_pt-&gt;nproc();</div>
<div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;        <span class="keywordtype">int</span> my_rank = Comm_pt-&gt;my_rank();</div>
<div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160; </div>
<div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;        <span class="comment">// Loop over all other domains/processors</span></div>
<div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; n_proc; d++)</div>
<div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;        {</div>
<div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160;          <span class="comment">// Don&#39;t talk to yourself</span></div>
<div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;          <span class="keywordflow">if</span> (d != my_rank)</div>
<div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;          {</div>
<div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;            {</div>
<div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;              <span class="comment">// Get the vector of halo elements whose non-halo counterpart</span></div>
<div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;              <span class="comment">// are on processor d</span></div>
<div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;              Vector&lt;GeneralisedElement*&gt; halo_elem_pt(</div>
<div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;                this-&gt;halo_element_pt(d));</div>
<div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160; </div>
<div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;              <span class="comment">// Create vector containing (0)1 to indicate that</span></div>
<div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160;              <span class="comment">// halo element is (not) to be unrefined</span></div>
<div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160;              <span class="keywordtype">unsigned</span> nhalo = halo_elem_pt.size();</div>
<div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;              Vector&lt;int&gt; halo_to_be_unrefined(nhalo, 0);</div>
<div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; nhalo; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;              {</div>
<div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;                <span class="keywordflow">if</span> (<span class="keyword">dynamic_cast&lt;</span>PRefineableElement*<span class="keyword">&gt;</span>(halo_elem_pt[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>])</div>
<div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;                      -&gt;to_be_p_unrefined())</div>
<div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160;                {</div>
<div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;                  halo_to_be_unrefined[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>] = 1;</div>
<div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;                }</div>
<div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;              }</div>
<div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160; </div>
<div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;              <span class="comment">// Trap the case when there are no halo elements</span></div>
<div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;              <span class="comment">// so that we don&#39;t get a segfault in the MPI send</span></div>
<div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;              <span class="keywordflow">if</span> (nhalo &gt; 0)</div>
<div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;              {</div>
<div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;                <span class="comment">// Send it across</span></div>
<div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160;                MPI_Send(&amp;halo_to_be_unrefined[0],</div>
<div class="line"><a name="l04176"></a><span class="lineno"> 4176</span>&#160;                         nhalo,</div>
<div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;                         MPI_INT,</div>
<div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160;                         d,</div>
<div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160;                         0,</div>
<div class="line"><a name="l04180"></a><span class="lineno"> 4180</span>&#160;                         Comm_pt-&gt;mpi_comm());</div>
<div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160;              }</div>
<div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;            }</div>
<div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160; </div>
<div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;            {</div>
<div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160;              <span class="comment">// Get the vector of haloed elements on current processor</span></div>
<div class="line"><a name="l04186"></a><span class="lineno"> 4186</span>&#160;              Vector&lt;GeneralisedElement*&gt; haloed_elem_pt(</div>
<div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160;                this-&gt;haloed_element_pt(d));</div>
<div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160; </div>
<div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;              <span class="comment">// Ask processor d to send vector containing (0)1 for</span></div>
<div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;              <span class="comment">// halo element with current processor to be (not)unrefined</span></div>
<div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;              <span class="keywordtype">unsigned</span> nhaloed = haloed_elem_pt.size();</div>
<div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;              Vector&lt;int&gt; halo_to_be_unrefined(nhaloed);</div>
<div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;              <span class="comment">// Trap to catch the case that there are no haloed elements</span></div>
<div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;              <span class="keywordflow">if</span> (nhaloed &gt; 0)</div>
<div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;              {</div>
<div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;                MPI_Recv(&amp;halo_to_be_unrefined[0],</div>
<div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160;                         nhaloed,</div>
<div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;                         MPI_INT,</div>
<div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;                         d,</div>
<div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160;                         0,</div>
<div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;                         Comm_pt-&gt;mpi_comm(),</div>
<div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;                         &amp;status);</div>
<div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;              }</div>
<div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160; </div>
<div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160;              <span class="comment">// Check it</span></div>
<div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; nhaloed; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;              {</div>
<div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160;                <span class="keywordflow">if</span> (((halo_to_be_unrefined[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>] == 0) &amp;&amp;</div>
<div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;                     (<span class="keyword">dynamic_cast&lt;</span>PRefineableElement*<span class="keyword">&gt;</span>(haloed_elem_pt[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>])</div>
<div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160;                        -&gt;to_be_p_unrefined())) ||</div>
<div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;                    ((halo_to_be_unrefined[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>] == 1) &amp;&amp;</div>
<div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160;                     (!<span class="keyword">dynamic_cast&lt;</span>PRefineableElement*<span class="keyword">&gt;</span>(haloed_elem_pt[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>])</div>
<div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;                         -&gt;to_be_p_unrefined())))</div>
<div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160;                {</div>
<div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160;                  std::ostringstream error_message;</div>
<div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;                  error_message</div>
<div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;Error in refinement: \n&quot;</span></div>
<div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;Haloed element: &quot;</span> &lt;&lt; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt;&lt; <span class="stringliteral">&quot; on proc &quot;</span> &lt;&lt; my_rank</div>
<div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot; \n&quot;</span></div>
<div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;wants to be unrefined whereas its halo counterpart on\n&quot;</span></div>
<div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;proc &quot;</span> &lt;&lt; d &lt;&lt; <span class="stringliteral">&quot; doesn&#39;t (or vice versa)...\n&quot;</span></div>
<div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;This is most likely because the error estimator\n&quot;</span></div>
<div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;has not assigned the same errors to halo and haloed\n&quot;</span></div>
<div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;elements -- it ought to!\n&quot;</span>;</div>
<div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;                  <span class="keywordflow">throw</span> OomphLibError(error_message.str(),</div>
<div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160;                                      <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;                                      <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;                }</div>
<div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;              }</div>
<div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;            }</div>
<div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;          }</div>
<div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;        }</div>
<div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160; </div>
<div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160; </div>
<div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160;        <span class="comment">// Loop over all other domains/processors</span></div>
<div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; n_proc; d++)</div>
<div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;        {</div>
<div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160;          <span class="comment">// Don&#39;t talk to yourself</span></div>
<div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160;          <span class="keywordflow">if</span> (d != my_rank)</div>
<div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;          {</div>
<div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160;            {</div>
<div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160;              <span class="comment">// Get the vector of halo elements whose non-halo counterpart</span></div>
<div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;              <span class="comment">// are on processor d</span></div>
<div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;              Vector&lt;GeneralisedElement*&gt; halo_elem_pt(</div>
<div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160;                this-&gt;halo_element_pt(d));</div>
<div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160; </div>
<div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;              <span class="comment">// Create vector containing (0)1 to indicate that</span></div>
<div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;              <span class="comment">// halo element is (not) to be refined</span></div>
<div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160;              <span class="keywordtype">unsigned</span> nhalo = halo_elem_pt.size();</div>
<div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;              Vector&lt;int&gt; halo_to_be_refined(nhalo, 0);</div>
<div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; nhalo; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;              {</div>
<div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;                <span class="keywordflow">if</span> (<span class="keyword">dynamic_cast&lt;</span>PRefineableElement*<span class="keyword">&gt;</span>(halo_elem_pt[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>])</div>
<div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;                      -&gt;to_be_p_refined())</div>
<div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;                {</div>
<div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;                  halo_to_be_refined[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>] = 1;</div>
<div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;                }</div>
<div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;              }</div>
<div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160; </div>
<div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;              <span class="comment">// Send it across</span></div>
<div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;              <span class="keywordflow">if</span> (nhalo &gt; 0)</div>
<div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;              {</div>
<div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;                MPI_Send(&amp;halo_to_be_refined[0],</div>
<div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;                         nhalo,</div>
<div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;                         MPI_INT,</div>
<div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160;                         d,</div>
<div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;                         0,</div>
<div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;                         Comm_pt-&gt;mpi_comm());</div>
<div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160;              }</div>
<div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160;            }</div>
<div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160; </div>
<div class="line"><a name="l04272"></a><span class="lineno"> 4272</span>&#160;            {</div>
<div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160;              <span class="comment">// Get the vector of haloed elements on current processor</span></div>
<div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;              Vector&lt;GeneralisedElement*&gt; haloed_elem_pt(</div>
<div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160;                this-&gt;haloed_element_pt(d));</div>
<div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160; </div>
<div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;              <span class="comment">// Ask processor d to send vector containing (0)1 for</span></div>
<div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;              <span class="comment">// halo element with current processor to be (not)refined</span></div>
<div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160;              <span class="keywordtype">unsigned</span> nhaloed = haloed_elem_pt.size();</div>
<div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;              Vector&lt;int&gt; halo_to_be_refined(nhaloed);</div>
<div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;              <span class="keywordflow">if</span> (nhaloed &gt; 0)</div>
<div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;              {</div>
<div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160;                MPI_Recv(&amp;halo_to_be_refined[0],</div>
<div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;                         nhaloed,</div>
<div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160;                         MPI_INT,</div>
<div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;                         d,</div>
<div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;                         0,</div>
<div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160;                         Comm_pt-&gt;mpi_comm(),</div>
<div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160;                         &amp;status);</div>
<div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160;              }</div>
<div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160; </div>
<div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160;              <span class="comment">// Check it</span></div>
<div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; nhaloed; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160;              {</div>
<div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160;                <span class="keywordflow">if</span> (((halo_to_be_refined[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>] == 0) &amp;&amp;</div>
<div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;                     (<span class="keyword">dynamic_cast&lt;</span>PRefineableElement*<span class="keyword">&gt;</span>(haloed_elem_pt[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>])</div>
<div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;                        -&gt;to_be_p_refined())) ||</div>
<div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;                    ((halo_to_be_refined[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>] == 1) &amp;&amp;</div>
<div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160;                     (!<span class="keyword">dynamic_cast&lt;</span>PRefineableElement*<span class="keyword">&gt;</span>(haloed_elem_pt[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>])</div>
<div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160;                         -&gt;to_be_p_refined())))</div>
<div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;                {</div>
<div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160;                  std::ostringstream error_message;</div>
<div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;                  error_message</div>
<div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;Error in refinement: \n&quot;</span></div>
<div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;Haloed element: &quot;</span> &lt;&lt; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt;&lt; <span class="stringliteral">&quot; on proc &quot;</span> &lt;&lt; my_rank</div>
<div class="line"><a name="l04306"></a><span class="lineno"> 4306</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot; \n&quot;</span></div>
<div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;wants to be refined whereas its halo counterpart on\n&quot;</span></div>
<div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;proc &quot;</span> &lt;&lt; d &lt;&lt; <span class="stringliteral">&quot; doesn&#39;t (or vice versa)...\n&quot;</span></div>
<div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;This is most likely because the error estimator\n&quot;</span></div>
<div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;has not assigned the same errors to halo and haloed\n&quot;</span></div>
<div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;elements -- it ought to!\n&quot;</span>;</div>
<div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;                  <span class="keywordflow">throw</span> OomphLibError(error_message.str(),</div>
<div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160;                                      <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;                                      <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;                }</div>
<div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;              }</div>
<div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;            }</div>
<div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;          }</div>
<div class="line"><a name="l04319"></a><span class="lineno"> 4319</span>&#160;        }</div>
<div class="line"><a name="l04320"></a><span class="lineno"> 4320</span>&#160;      }</div>
<div class="line"><a name="l04321"></a><span class="lineno"> 4321</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04322"></a><span class="lineno"> 4322</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160; </div>
<div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160;      <span class="comment">// Perform the actual adaptation</span></div>
<div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;      <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#ae36ab5e807acc10ccc31a7886ffc040a">p_adapt_mesh</a>(local_doc_info);</div>
<div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160; </div>
<div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160;      <span class="comment">// The number of refineable elements is still local to each process</span></div>
<div class="line"><a name="l04328"></a><span class="lineno"> 4328</span>&#160;      this-&gt;<a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a62c0314a69b2e40355a2aa27ff5ea133">Nunrefined</a> = n_unrefine;</div>
<div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;      this-&gt;<a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a1a35c13c3c37ddc5ac2852217d903459">Nrefined</a> = n_refine;</div>
<div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160;    }</div>
<div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160;    <span class="comment">// If not worthwhile, say so but still reorder nodes and kill external</span></div>
<div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;    <span class="comment">// storage for consistency in parallel computations</span></div>
<div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160;    {</div>
<div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160;      <span class="comment">// Delete any external element storage - any interaction will still</span></div>
<div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160;      <span class="comment">// be set up on the fly again, so we need to get rid of old information.</span></div>
<div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;      <span class="comment">// This particularly causes problems in multi-domain examples where</span></div>
<div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;      <span class="comment">// we decide not to refine one of the meshes</span></div>
<div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160;      this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a9e3ecb07dc622cf37ce0085446ff9aa6">delete_all_external_storage</a>();</div>
<div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160; </div>
<div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160;      <span class="comment">// Reorder the nodes within the mesh&#39;s node vector</span></div>
<div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;      <span class="comment">// to establish a standard ordering regardless of the sequence</span></div>
<div class="line"><a name="l04345"></a><span class="lineno"> 4345</span>&#160;      <span class="comment">// of mesh refinements -- this is required to allow dump/restart</span></div>
<div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160;      <span class="comment">// on refined meshes</span></div>
<div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160;      this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a801e77424d1bf8a35c9bba055230f1e3">reorder_nodes</a>();</div>
<div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160; </div>
<div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160; </div>
<div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160;      <span class="comment">// Now (re-)classify halo and haloed nodes and synchronise hanging</span></div>
<div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;      <span class="comment">// nodes</span></div>
<div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;      <span class="comment">// This is required in cases where delete_all_external_storage()</span></div>
<div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160;      <span class="comment">// made dependent nodes to external halo nodes nonhanging.</span></div>
<div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;      <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a1ab35b022b95f2d28c53aa58859bd6b5">is_mesh_distributed</a>())</div>
<div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;      {</div>
<div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;        DocInfo <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>;</div>
<div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160;        <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>.<a class="code" href="../../d7/d2c/classoomph_1_1DocInfo.html#a666a20817ab9c396b225d8652bc0a338">disable_doc</a>();</div>
<div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160;        classify_halo_and_haloed_nodes(<a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>, <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>.<a class="code" href="../../d7/d2c/classoomph_1_1DocInfo.html#a2ce90cf54f24b4ab523c624031fbb76b">is_doc_enabled</a>());</div>
<div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;      }</div>
<div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160; </div>
<div class="line"><a name="l04362"></a><span class="lineno"> 4362</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04363"></a><span class="lineno"> 4363</span>&#160; </div>
<div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;      <span class="keywordflow">if</span> (n_refine == 0)</div>
<div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;      {</div>
<div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;\n Not enough benefit in adapting mesh. &quot;</span> &lt;&lt; std::endl</div>
<div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;                   &lt;&lt; std::endl;</div>
<div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;      }</div>
<div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160;      this-&gt;<a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a62c0314a69b2e40355a2aa27ff5ea133">Nunrefined</a> = 0;</div>
<div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160;      this-&gt;<a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a1a35c13c3c37ddc5ac2852217d903459">Nrefined</a> = 0;</div>
<div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160;    }</div>
<div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1TreeBasedRefineableMeshBase_html_a957a33d2b7dd59f8789f4d0e9c6357c2"><div class="ttname"><a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a957a33d2b7dd59f8789f4d0e9c6357c2">oomph::TreeBasedRefineableMeshBase::max_p_refinement_level</a></div><div class="ttdeci">unsigned &amp; max_p_refinement_level()</div><div class="ttdef"><b>Definition:</b> refineable_mesh.h:499</div></div>
<div class="ttc" id="aclassoomph_1_1TreeBasedRefineableMeshBase_html_ae36ab5e807acc10ccc31a7886ffc040a"><div class="ttname"><a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#ae36ab5e807acc10ccc31a7886ffc040a">oomph::TreeBasedRefineableMeshBase::p_adapt_mesh</a></div><div class="ttdeci">void p_adapt_mesh()</div><div class="ttdef"><b>Definition:</b> refineable_mesh.h:533</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a9e3ecb07dc622cf37ce0085446ff9aa6">oomph::Mesh::delete_all_external_storage()</a>, <a class="el" href="../../d3/d0c/classoomph_1_1PRefineableElement.html#ae09fd11dea8f804c352a447a6bbdfb9a">oomph::PRefineableElement::deselect_for_p_refinement()</a>, <a class="el" href="../../d3/d0c/classoomph_1_1PRefineableElement.html#a9885c7f63cc66df42692505f2261dc88">oomph::PRefineableElement::deselect_for_p_unrefinement()</a>, <a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html#a666a20817ab9c396b225d8652bc0a338">oomph::DocInfo::disable_doc()</a>, <a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">oomph::RefineableMeshBase::doc_info()</a>, <a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a706216900b53bc7d9214e1f982e69309">oomph::RefineableMeshBase::doc_info_pt()</a>, <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ab28b03dabf4e247c4a25f834eb11b339">oomph::Mesh::element_pt()</a>, <a class="el" href="../../d3/d0c/classoomph_1_1PRefineableElement.html#a6babd48e981414ad54cbfc1d89977f43">oomph::PRefineableElement::initial_p_order()</a>, <a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html#a2ce90cf54f24b4ab523c624031fbb76b">oomph::DocInfo::is_doc_enabled()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a1ab35b022b95f2d28c53aa58859bd6b5">oomph::Mesh::is_mesh_distributed()</a>, <a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a2216b4d0a8433a1975e6990a5e6533f7">oomph::RefineableMeshBase::max_keep_unrefined()</a>, <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a957a33d2b7dd59f8789f4d0e9c6357c2">max_p_refinement_level()</a>, <a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#adb5ba9ac30bf0a0683eb30f5703800e4">oomph::RefineableMeshBase::max_permitted_error()</a>, <a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#ad3a13bfaf687135d0154ce2f9b60edb7">oomph::RefineableMeshBase::min_permitted_error()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">oomph::Mesh::nelement()</a>, <a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a1a35c13c3c37ddc5ac2852217d903459">oomph::RefineableMeshBase::Nrefined</a>, <a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#af189058782c7217f6d29a6f9555e7c3d">oomph::RefineableMeshBase::nrefinement_overruled()</a>, <a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a62c0314a69b2e40355a2aa27ff5ea133">oomph::RefineableMeshBase::Nunrefined</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#ae36ab5e807acc10ccc31a7886ffc040a">p_adapt_mesh()</a>, <a class="el" href="../../d3/d0c/classoomph_1_1PRefineableElement.html#a399d686caa2f65fff9c825d1ff55f053">oomph::PRefineableElement::p_order()</a>, <a class="el" href="../../d3/d0c/classoomph_1_1PRefineableElement.html#a086636c6717bb5bbe7e31123bc0cd511">oomph::PRefineableElement::p_refinement_is_enabled()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a801e77424d1bf8a35c9bba055230f1e3">oomph::Mesh::reorder_nodes()</a>, <a class="el" href="../../d3/d0c/classoomph_1_1PRefineableElement.html#a89ecf3e300ea9c7dd37ce981053377f4">oomph::PRefineableElement::select_for_p_refinement()</a>, and <a class="el" href="../../d3/d0c/classoomph_1_1PRefineableElement.html#a99c9cb3bc0a1d6877f58e741f9b36df4">oomph::PRefineableElement::select_for_p_unrefinement()</a>.</p>

</div>
</div>
<a id="ae36ab5e807acc10ccc31a7886ffc040a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae36ab5e807acc10ccc31a7886ffc040a">&#9670;&nbsp;</a></span>p_adapt_mesh() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::TreeBasedRefineableMeshBase::p_adapt_mesh </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Perform the actual tree-based mesh p-adaptation. A simple wrapper to call the function without documentation. </p>
<div class="fragment"><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    {</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;      <span class="comment">// Create a dummy doc_info object</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      DocInfo <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;      <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>.<a class="code" href="../../d7/d2c/classoomph_1_1DocInfo.html#a85d58bcfce0a7b7cae461624e6fcd08a">directory</a>() = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;      <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>.<a class="code" href="../../d7/d2c/classoomph_1_1DocInfo.html#a666a20817ab9c396b225d8652bc0a338">disable_doc</a>();</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;      <span class="comment">// Call the other adapt mesh</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;      <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#ae36ab5e807acc10ccc31a7886ffc040a">p_adapt_mesh</a>(<a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>);</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html#a85d58bcfce0a7b7cae461624e6fcd08a">oomph::DocInfo::directory()</a>, <a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html#a666a20817ab9c396b225d8652bc0a338">oomph::DocInfo::disable_doc()</a>, and <a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">oomph::RefineableMeshBase::doc_info()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#acec4254dc1b7c75870cfa0bd0c4e363e">p_adapt()</a>, <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a8596076849247d63cadfe579fdc17d60">p_refine_selected_elements()</a>, <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a270d74e0e30f9956c85e4cdcc202c98b">p_refine_uniformly()</a>, and <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a937e4097d480ed921b86ec4a7e885df6">p_unrefine_uniformly()</a>.</p>

</div>
</div>
<a id="a5d714967dc71ba477c2ca807bbf6d6bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d714967dc71ba477c2ca807bbf6d6bd">&#9670;&nbsp;</a></span>p_adapt_mesh() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::TreeBasedRefineableMeshBase::p_adapt_mesh </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>doc_info</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Perform the actual tree-based mesh p-adaptation, documenting the progress in the directory specified in DocInfo object.</p>
<p>p-adapt mesh, which exists in two representations, namely as:</p><ul>
<li>a FE mesh</li>
<li>a forest of Oc or QuadTrees</li>
</ul>
<p>p-refinement/derefinement process is documented (in tecplot-able form) if requested.</p>
<p>Procedure:</p><ul>
<li>Loop over all elements and do the p-refinement/unrefinement for those who want to be refined. Note: p-refinement builds fully- functional elements.</li>
<li>For all nodes that were hanging on the previous mesh (and are still marked as such), fill in their nodal values (consistent with the current hanging node scheme) to make sure they are fully functional, should they have become non-hanging during the mesh-adaptation. Then mark the nodes as non-hanging.</li>
<li>Delete any nodes that have become obsolete.</li>
<li>Mark up hanging nodes and setup hanging node scheme (incl. recursive cleanup for hanging nodes that depend on other hanging nodes).</li>
<li>run a quick self-test on the neighbour finding scheme and check the integrity of the elements (if PARANOID)</li>
<li>doc hanging node status, boundary conditions, neighbour scheme if requested.</li>
</ul>
<p>After adaptation, all nodes (whether new or old) have up-to-date current and previous values.</p>
<p>If refinement process is being documented, the following information is documented:</p><ul>
<li>The files<ul>
<li>"neighbours.dat"</li>
<li>"all_nodes.dat"</li>
<li>"new_nodes.dat"</li>
<li>"hang_nodes_*.dat" where the * denotes a direction (n,s,e,w) in 2D or (r,l,u,d,f,b) in 3D</li>
</ul>
</li>
</ul>
<p>can be viewed with</p><ul>
<li>QHangingNodes.mcr</li>
</ul>
<ul>
<li>The file<ul>
<li>"hangnodes_withmasters.dat"</li>
</ul>
</li>
</ul>
<p>can be viewed with</p><ul>
<li>QHangingNodesWithMasters.mcr</li>
</ul>
<p>to check the hanging node status.</p><ul>
<li>The neighbour status of the elements is documented in<ul>
<li>"neighbours.dat"</li>
</ul>
</li>
</ul>
<p>and can be viewed with</p><ul>
<li>QuadTreeNeighbours.mcr</li>
</ul>
<p>Update the boundary element info &ndash; this can be a costly procedure and for this reason the mesh writer might have decided not to set up this scheme. If so, we won't change this and suppress its creation...</p>
<p>/BENFLAG: Check that all the nodes belong to their update elements</p>
<div class="fragment"><div class="line"><a name="l04434"></a><span class="lineno"> 4434</span>&#160;  {</div>
<div class="line"><a name="l04435"></a><span class="lineno"> 4435</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l04436"></a><span class="lineno"> 4436</span>&#160;    <span class="comment">// Delete any external element storage before performing the adaptation</span></div>
<div class="line"><a name="l04437"></a><span class="lineno"> 4437</span>&#160;    <span class="comment">// (in particular, external halo nodes that are on mesh boundaries)</span></div>
<div class="line"><a name="l04438"></a><span class="lineno"> 4438</span>&#160;    this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a9e3ecb07dc622cf37ce0085446ff9aa6">delete_all_external_storage</a>();</div>
<div class="line"><a name="l04439"></a><span class="lineno"> 4439</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04440"></a><span class="lineno"> 4440</span>&#160; </div>
<div class="line"><a name="l04441"></a><span class="lineno"> 4441</span>&#160;    <span class="comment">// Only perform the adapt step if the mesh has any elements.  This is</span></div>
<div class="line"><a name="l04442"></a><span class="lineno"> 4442</span>&#160;    <span class="comment">// relevant in a distributed problem with multiple meshes, where a</span></div>
<div class="line"><a name="l04443"></a><span class="lineno"> 4443</span>&#160;    <span class="comment">// particular process may not have any elements on a particular submesh.</span></div>
<div class="line"><a name="l04444"></a><span class="lineno"> 4444</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">nelement</a>() &gt; 0)</div>
<div class="line"><a name="l04445"></a><span class="lineno"> 4445</span>&#160;    {</div>
<div class="line"><a name="l04446"></a><span class="lineno"> 4446</span>&#160;      <span class="keywordtype">double</span> t_start = 0.0;</div>
<div class="line"><a name="l04447"></a><span class="lineno"> 4447</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l04448"></a><span class="lineno"> 4448</span>&#160;      {</div>
<div class="line"><a name="l04449"></a><span class="lineno"> 4449</span>&#160;        t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l04450"></a><span class="lineno"> 4450</span>&#160;      }</div>
<div class="line"><a name="l04451"></a><span class="lineno"> 4451</span>&#160; </div>
<div class="line"><a name="l04452"></a><span class="lineno"> 4452</span>&#160;      <span class="comment">// Do refinement/unrefinement if required</span></div>
<div class="line"><a name="l04453"></a><span class="lineno"> 4453</span>&#160;      this-&gt;<a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a9a2f26f447d6386505bdbdd0ac518321">p_refine_elements_if_required</a>();</div>
<div class="line"><a name="l04454"></a><span class="lineno"> 4454</span>&#160; </div>
<div class="line"><a name="l04455"></a><span class="lineno"> 4455</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l04456"></a><span class="lineno"> 4456</span>&#160;      {</div>
<div class="line"><a name="l04457"></a><span class="lineno"> 4457</span>&#160;        <span class="keywordtype">double</span> t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l04458"></a><span class="lineno"> 4458</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for p-refinement/unrefinement: &quot;</span> &lt;&lt; t_end - t_start</div>
<div class="line"><a name="l04459"></a><span class="lineno"> 4459</span>&#160;                   &lt;&lt; std::endl;</div>
<div class="line"><a name="l04460"></a><span class="lineno"> 4460</span>&#160;        t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l04461"></a><span class="lineno"> 4461</span>&#160;      }</div>
<div class="line"><a name="l04462"></a><span class="lineno"> 4462</span>&#160; </div>
<div class="line"><a name="l04463"></a><span class="lineno"> 4463</span>&#160;      <span class="comment">// Loop over all nodes in mesh and free the dofs of those that were</span></div>
<div class="line"><a name="l04464"></a><span class="lineno"> 4464</span>&#160;      <span class="comment">//-----------------------------------------------------------------</span></div>
<div class="line"><a name="l04465"></a><span class="lineno"> 4465</span>&#160;      <span class="comment">// pinned only because they were hanging nodes. Also update their</span></div>
<div class="line"><a name="l04466"></a><span class="lineno"> 4466</span>&#160;      <span class="comment">//-----------------------------------------------------------------</span></div>
<div class="line"><a name="l04467"></a><span class="lineno"> 4467</span>&#160;      <span class="comment">// nodal values so that they contain data that is consistent</span></div>
<div class="line"><a name="l04468"></a><span class="lineno"> 4468</span>&#160;      <span class="comment">//----------------------------------------------------------</span></div>
<div class="line"><a name="l04469"></a><span class="lineno"> 4469</span>&#160;      <span class="comment">// with the hanging node representation</span></div>
<div class="line"><a name="l04470"></a><span class="lineno"> 4470</span>&#160;      <span class="comment">//-------------------------------------</span></div>
<div class="line"><a name="l04471"></a><span class="lineno"> 4471</span>&#160;      <span class="comment">// (Even if the nodal data isn&#39;t actually accessed because the node</span></div>
<div class="line"><a name="l04472"></a><span class="lineno"> 4472</span>&#160;      <span class="comment">// is still hanging -- we don&#39;t know this yet, and this step makes</span></div>
<div class="line"><a name="l04473"></a><span class="lineno"> 4473</span>&#160;      <span class="comment">// sure that all nodes are fully functional and up-to-date, should</span></div>
<div class="line"><a name="l04474"></a><span class="lineno"> 4474</span>&#160;      <span class="comment">// they become non-hanging below).</span></div>
<div class="line"><a name="l04475"></a><span class="lineno"> 4475</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l04476"></a><span class="lineno"> 4476</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l04477"></a><span class="lineno"> 4477</span>&#160;      <span class="comment">// However, if we have a fixed mesh and hanging nodes on the boundary</span></div>
<div class="line"><a name="l04478"></a><span class="lineno"> 4478</span>&#160;      <span class="comment">// become non-hanging they will not necessarily respect the curvilinear</span></div>
<div class="line"><a name="l04479"></a><span class="lineno"> 4479</span>&#160;      <span class="comment">// boundaries. This can only happen in 3D of course because it is not</span></div>
<div class="line"><a name="l04480"></a><span class="lineno"> 4480</span>&#160;      <span class="comment">// possible to have hanging nodes on boundaries in 2D.</span></div>
<div class="line"><a name="l04481"></a><span class="lineno"> 4481</span>&#160;      <span class="comment">// The solution is to store those nodes on the boundaries that are</span></div>
<div class="line"><a name="l04482"></a><span class="lineno"> 4482</span>&#160;      <span class="comment">// currently hanging and then check to see whether they have changed</span></div>
<div class="line"><a name="l04483"></a><span class="lineno"> 4483</span>&#160;      <span class="comment">// status at the end of the refinement procedure.</span></div>
<div class="line"><a name="l04484"></a><span class="lineno"> 4484</span>&#160;      <span class="comment">// If it has changed, then we need to adjust their positions.</span></div>
<div class="line"><a name="l04485"></a><span class="lineno"> 4485</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_boundary = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a84543564d6babe4faacbb9d87043fc19">nboundary</a>();</div>
<div class="line"><a name="l04486"></a><span class="lineno"> 4486</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> mesh_dim = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a4f274774435e9454bf77bf70de69367a">finite_element_pt</a>(0)-&gt;<a class="code" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">dim</a>();</div>
<div class="line"><a name="l04487"></a><span class="lineno"> 4487</span>&#160;      Vector&lt;std::set&lt;Node*&gt;&gt; hanging_nodes_on_boundary_pt(n_boundary);</div>
<div class="line"><a name="l04488"></a><span class="lineno"> 4488</span>&#160; </div>
<div class="line"><a name="l04489"></a><span class="lineno"> 4489</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n_node = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a945e7823d1a2af243b5b7f7866aaff5e">nnode</a>();</div>
<div class="line"><a name="l04490"></a><span class="lineno"> 4490</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_node; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l04491"></a><span class="lineno"> 4491</span>&#160;      {</div>
<div class="line"><a name="l04492"></a><span class="lineno"> 4492</span>&#160;        <span class="comment">// Get the pointer to the node</span></div>
<div class="line"><a name="l04493"></a><span class="lineno"> 4493</span>&#160;        Node* nod_pt = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">node_pt</a>(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>);</div>
<div class="line"><a name="l04494"></a><span class="lineno"> 4494</span>&#160; </div>
<div class="line"><a name="l04495"></a><span class="lineno"> 4495</span>&#160;        <span class="comment">// Get the number of values in the node</span></div>
<div class="line"><a name="l04496"></a><span class="lineno"> 4496</span>&#160;        <span class="keywordtype">unsigned</span> n_value = nod_pt-&gt;nvalue();</div>
<div class="line"><a name="l04497"></a><span class="lineno"> 4497</span>&#160; </div>
<div class="line"><a name="l04498"></a><span class="lineno"> 4498</span>&#160;        <span class="comment">// We need to find if any of the values are hanging</span></div>
<div class="line"><a name="l04499"></a><span class="lineno"> 4499</span>&#160;        <span class="keywordtype">bool</span> is_hanging = nod_pt-&gt;is_hanging();</div>
<div class="line"><a name="l04500"></a><span class="lineno"> 4500</span>&#160;        <span class="comment">// Loop over the values and find out whether any are hanging</span></div>
<div class="line"><a name="l04501"></a><span class="lineno"> 4501</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_value; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l04502"></a><span class="lineno"> 4502</span>&#160;        {</div>
<div class="line"><a name="l04503"></a><span class="lineno"> 4503</span>&#160;          is_hanging |= nod_pt-&gt;is_hanging(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>);</div>
<div class="line"><a name="l04504"></a><span class="lineno"> 4504</span>&#160;        }</div>
<div class="line"><a name="l04505"></a><span class="lineno"> 4505</span>&#160; </div>
<div class="line"><a name="l04506"></a><span class="lineno"> 4506</span>&#160;        <span class="comment">// If the node is hanging then ...</span></div>
<div class="line"><a name="l04507"></a><span class="lineno"> 4507</span>&#160;        <span class="keywordflow">if</span> (is_hanging)</div>
<div class="line"><a name="l04508"></a><span class="lineno"> 4508</span>&#160;        {</div>
<div class="line"><a name="l04509"></a><span class="lineno"> 4509</span>&#160;          <span class="comment">// Unless they are turned into hanging nodes again below</span></div>
<div class="line"><a name="l04510"></a><span class="lineno"> 4510</span>&#160;          <span class="comment">// (this might or might not happen), fill in all the necessary</span></div>
<div class="line"><a name="l04511"></a><span class="lineno"> 4511</span>&#160;          <span class="comment">// data to make them &#39;proper&#39; nodes again.</span></div>
<div class="line"><a name="l04512"></a><span class="lineno"> 4512</span>&#160; </div>
<div class="line"><a name="l04513"></a><span class="lineno"> 4513</span>&#160;          <span class="comment">// Reconstruct the nodal values/position from the node&#39;s</span></div>
<div class="line"><a name="l04514"></a><span class="lineno"> 4514</span>&#160;          <span class="comment">// hanging node representation</span></div>
<div class="line"><a name="l04515"></a><span class="lineno"> 4515</span>&#160;          <span class="keywordtype">unsigned</span> nt = nod_pt-&gt;ntstorage();</div>
<div class="line"><a name="l04516"></a><span class="lineno"> 4516</span>&#160;          Vector&lt;double&gt; values(n_value);</div>
<div class="line"><a name="l04517"></a><span class="lineno"> 4517</span>&#160;          <span class="keywordtype">unsigned</span> n_dim = nod_pt-&gt;ndim();</div>
<div class="line"><a name="l04518"></a><span class="lineno"> 4518</span>&#160;          Vector&lt;double&gt; position(n_dim);</div>
<div class="line"><a name="l04519"></a><span class="lineno"> 4519</span>&#160;          <span class="comment">// Loop over all history values</span></div>
<div class="line"><a name="l04520"></a><span class="lineno"> 4520</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../dd/ddd/namespaceplotPSD.html#a112f38a9c28b7e27fed13fb3ebf10362">t</a> = 0; <a class="code" href="../../dd/ddd/namespaceplotPSD.html#a112f38a9c28b7e27fed13fb3ebf10362">t</a> &lt; nt; <a class="code" href="../../dd/ddd/namespaceplotPSD.html#a112f38a9c28b7e27fed13fb3ebf10362">t</a>++)</div>
<div class="line"><a name="l04521"></a><span class="lineno"> 4521</span>&#160;          {</div>
<div class="line"><a name="l04522"></a><span class="lineno"> 4522</span>&#160;            nod_pt-&gt;value(<a class="code" href="../../dd/ddd/namespaceplotPSD.html#a112f38a9c28b7e27fed13fb3ebf10362">t</a>, values);</div>
<div class="line"><a name="l04523"></a><span class="lineno"> 4523</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_value; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l04524"></a><span class="lineno"> 4524</span>&#160;            {</div>
<div class="line"><a name="l04525"></a><span class="lineno"> 4525</span>&#160;              nod_pt-&gt;set_value(<a class="code" href="../../dd/ddd/namespaceplotPSD.html#a112f38a9c28b7e27fed13fb3ebf10362">t</a>, <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, values[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l04526"></a><span class="lineno"> 4526</span>&#160;            }</div>
<div class="line"><a name="l04527"></a><span class="lineno"> 4527</span>&#160;            nod_pt-&gt;position(<a class="code" href="../../dd/ddd/namespaceplotPSD.html#a112f38a9c28b7e27fed13fb3ebf10362">t</a>, position);</div>
<div class="line"><a name="l04528"></a><span class="lineno"> 4528</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_dim; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l04529"></a><span class="lineno"> 4529</span>&#160;            {</div>
<div class="line"><a name="l04530"></a><span class="lineno"> 4530</span>&#160;              nod_pt-&gt;x(<a class="code" href="../../dd/ddd/namespaceplotPSD.html#a112f38a9c28b7e27fed13fb3ebf10362">t</a>, <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = position[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l04531"></a><span class="lineno"> 4531</span>&#160;            }</div>
<div class="line"><a name="l04532"></a><span class="lineno"> 4532</span>&#160;          }</div>
<div class="line"><a name="l04533"></a><span class="lineno"> 4533</span>&#160; </div>
<div class="line"><a name="l04534"></a><span class="lineno"> 4534</span>&#160;          <span class="comment">// If it&#39;s an algebraic node: Update its previous nodal positions too</span></div>
<div class="line"><a name="l04535"></a><span class="lineno"> 4535</span>&#160;          AlgebraicNode* alg_node_pt = <span class="keyword">dynamic_cast&lt;</span>AlgebraicNode*<span class="keyword">&gt;</span>(nod_pt);</div>
<div class="line"><a name="l04536"></a><span class="lineno"> 4536</span>&#160;          <span class="keywordflow">if</span> (alg_node_pt != 0)</div>
<div class="line"><a name="l04537"></a><span class="lineno"> 4537</span>&#160;          {</div>
<div class="line"><a name="l04538"></a><span class="lineno"> 4538</span>&#160;            <span class="keywordtype">bool</span> update_all_time_levels = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04539"></a><span class="lineno"> 4539</span>&#160;            alg_node_pt-&gt;node_update(update_all_time_levels);</div>
<div class="line"><a name="l04540"></a><span class="lineno"> 4540</span>&#160;          }</div>
<div class="line"><a name="l04541"></a><span class="lineno"> 4541</span>&#160; </div>
<div class="line"><a name="l04542"></a><span class="lineno"> 4542</span>&#160; </div>
<div class="line"><a name="l04543"></a><span class="lineno"> 4543</span>&#160;          <span class="comment">// If it&#39;s a Solid node, update Lagrangian coordinates</span></div>
<div class="line"><a name="l04544"></a><span class="lineno"> 4544</span>&#160;          <span class="comment">// from its hanging node representation</span></div>
<div class="line"><a name="l04545"></a><span class="lineno"> 4545</span>&#160;          SolidNode* solid_node_pt = <span class="keyword">dynamic_cast&lt;</span>SolidNode*<span class="keyword">&gt;</span>(nod_pt);</div>
<div class="line"><a name="l04546"></a><span class="lineno"> 4546</span>&#160;          <span class="keywordflow">if</span> (solid_node_pt != 0)</div>
<div class="line"><a name="l04547"></a><span class="lineno"> 4547</span>&#160;          {</div>
<div class="line"><a name="l04548"></a><span class="lineno"> 4548</span>&#160;            <span class="keywordtype">unsigned</span> n_lagrangian = solid_node_pt-&gt;nlagrangian();</div>
<div class="line"><a name="l04549"></a><span class="lineno"> 4549</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_lagrangian; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l04550"></a><span class="lineno"> 4550</span>&#160;            {</div>
<div class="line"><a name="l04551"></a><span class="lineno"> 4551</span>&#160;              solid_node_pt-&gt;xi(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = solid_node_pt-&gt;lagrangian_position(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l04552"></a><span class="lineno"> 4552</span>&#160;            }</div>
<div class="line"><a name="l04553"></a><span class="lineno"> 4553</span>&#160;          }</div>
<div class="line"><a name="l04554"></a><span class="lineno"> 4554</span>&#160; </div>
<div class="line"><a name="l04555"></a><span class="lineno"> 4555</span>&#160;          <span class="comment">// Now store geometrically hanging nodes on boundaries that</span></div>
<div class="line"><a name="l04556"></a><span class="lineno"> 4556</span>&#160;          <span class="comment">// may need updating after refinement.</span></div>
<div class="line"><a name="l04557"></a><span class="lineno"> 4557</span>&#160;          <span class="comment">// There will only be a problem if we have 3 spatial dimensions</span></div>
<div class="line"><a name="l04558"></a><span class="lineno"> 4558</span>&#160;          <span class="keywordflow">if</span> ((mesh_dim &gt; 2) &amp;&amp; (nod_pt-&gt;is_hanging()))</div>
<div class="line"><a name="l04559"></a><span class="lineno"> 4559</span>&#160;          {</div>
<div class="line"><a name="l04560"></a><span class="lineno"> 4560</span>&#160;            <span class="comment">// If the node is on a boundary then add a pointer to the node</span></div>
<div class="line"><a name="l04561"></a><span class="lineno"> 4561</span>&#160;            <span class="comment">// to our lookup scheme</span></div>
<div class="line"><a name="l04562"></a><span class="lineno"> 4562</span>&#160;            <span class="keywordflow">if</span> (nod_pt-&gt;is_on_boundary())</div>
<div class="line"><a name="l04563"></a><span class="lineno"> 4563</span>&#160;            {</div>
<div class="line"><a name="l04564"></a><span class="lineno"> 4564</span>&#160;              <span class="comment">// Storage for the boundaries on which the Node is located</span></div>
<div class="line"><a name="l04565"></a><span class="lineno"> 4565</span>&#160;              std::set&lt;unsigned&gt;* boundaries_pt;</div>
<div class="line"><a name="l04566"></a><span class="lineno"> 4566</span>&#160;              nod_pt-&gt;get_boundaries_pt(boundaries_pt);</div>
<div class="line"><a name="l04567"></a><span class="lineno"> 4567</span>&#160;              <span class="keywordflow">if</span> (boundaries_pt != 0)</div>
<div class="line"><a name="l04568"></a><span class="lineno"> 4568</span>&#160;              {</div>
<div class="line"><a name="l04569"></a><span class="lineno"> 4569</span>&#160;                <span class="comment">// Loop over the boundaries and add a pointer to the node</span></div>
<div class="line"><a name="l04570"></a><span class="lineno"> 4570</span>&#160;                <span class="comment">// to the appropriate storage scheme</span></div>
<div class="line"><a name="l04571"></a><span class="lineno"> 4571</span>&#160;                <span class="keywordflow">for</span> (std::set&lt;unsigned&gt;::iterator it = boundaries_pt-&gt;begin();</div>
<div class="line"><a name="l04572"></a><span class="lineno"> 4572</span>&#160;                     it != boundaries_pt-&gt;end();</div>
<div class="line"><a name="l04573"></a><span class="lineno"> 4573</span>&#160;                     ++it)</div>
<div class="line"><a name="l04574"></a><span class="lineno"> 4574</span>&#160;                {</div>
<div class="line"><a name="l04575"></a><span class="lineno"> 4575</span>&#160;                  hanging_nodes_on_boundary_pt[*it].insert(nod_pt);</div>
<div class="line"><a name="l04576"></a><span class="lineno"> 4576</span>&#160;                }</div>
<div class="line"><a name="l04577"></a><span class="lineno"> 4577</span>&#160;              }</div>
<div class="line"><a name="l04578"></a><span class="lineno"> 4578</span>&#160;            }</div>
<div class="line"><a name="l04579"></a><span class="lineno"> 4579</span>&#160;          }</div>
<div class="line"><a name="l04580"></a><span class="lineno"> 4580</span>&#160; </div>
<div class="line"><a name="l04581"></a><span class="lineno"> 4581</span>&#160;        } <span class="comment">// End of is_hanging</span></div>
<div class="line"><a name="l04582"></a><span class="lineno"> 4582</span>&#160; </div>
<div class="line"><a name="l04583"></a><span class="lineno"> 4583</span>&#160;        <span class="comment">// Initially mark all nodes as &#39;non-hanging&#39; and `obsolete&#39;</span></div>
<div class="line"><a name="l04584"></a><span class="lineno"> 4584</span>&#160;        nod_pt-&gt;set_nonhanging();</div>
<div class="line"><a name="l04585"></a><span class="lineno"> 4585</span>&#160;        nod_pt-&gt;set_obsolete();</div>
<div class="line"><a name="l04586"></a><span class="lineno"> 4586</span>&#160;      }</div>
<div class="line"><a name="l04587"></a><span class="lineno"> 4587</span>&#160; </div>
<div class="line"><a name="l04588"></a><span class="lineno"> 4588</span>&#160;      <span class="keywordtype">double</span> t_end = 0.0;</div>
<div class="line"><a name="l04589"></a><span class="lineno"> 4589</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l04590"></a><span class="lineno"> 4590</span>&#160;      {</div>
<div class="line"><a name="l04591"></a><span class="lineno"> 4591</span>&#160;        t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l04592"></a><span class="lineno"> 4592</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for sorting out initial hanging status: &quot;</span></div>
<div class="line"><a name="l04593"></a><span class="lineno"> 4593</span>&#160;                   &lt;&lt; t_end - t_start &lt;&lt; std::endl;</div>
<div class="line"><a name="l04594"></a><span class="lineno"> 4594</span>&#160;        t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l04595"></a><span class="lineno"> 4595</span>&#160;      }</div>
<div class="line"><a name="l04596"></a><span class="lineno"> 4596</span>&#160; </div>
<div class="line"><a name="l04597"></a><span class="lineno"> 4597</span>&#160;      <span class="comment">// Stick all elements into a vector</span></div>
<div class="line"><a name="l04598"></a><span class="lineno"> 4598</span>&#160;      Vector&lt;Tree*&gt; tree_nodes_pt;</div>
<div class="line"><a name="l04599"></a><span class="lineno"> 4599</span>&#160;      this-&gt;<a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a3c5084830a90bf527a27271613b858a7">forest_pt</a>()-&gt;<a class="code" href="../../d2/d36/classoomph_1_1TreeForest.html#a6d99d1f513a60b9bd053ff98699cbe52">stick_leaves_into_vector</a>(tree_nodes_pt);</div>
<div class="line"><a name="l04600"></a><span class="lineno"> 4600</span>&#160; </div>
<div class="line"><a name="l04601"></a><span class="lineno"> 4601</span>&#160;      <span class="comment">// Copy the elements into the mesh Vector</span></div>
<div class="line"><a name="l04602"></a><span class="lineno"> 4602</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> num_tree_nodes = tree_nodes_pt.size();</div>
<div class="line"><a name="l04603"></a><span class="lineno"> 4603</span>&#160;      this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ab28b03dabf4e247c4a25f834eb11b339">element_pt</a>().resize(num_tree_nodes);</div>
<div class="line"><a name="l04604"></a><span class="lineno"> 4604</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; num_tree_nodes; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l04605"></a><span class="lineno"> 4605</span>&#160;      {</div>
<div class="line"><a name="l04606"></a><span class="lineno"> 4606</span>&#160;        this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ab28b03dabf4e247c4a25f834eb11b339">element_pt</a>(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>) = tree_nodes_pt[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>]-&gt;object_pt();</div>
<div class="line"><a name="l04607"></a><span class="lineno"> 4607</span>&#160; </div>
<div class="line"><a name="l04608"></a><span class="lineno"> 4608</span>&#160;        <span class="comment">// Now loop over all nodes in element and mark them as non-obsolete</span></div>
<div class="line"><a name="l04609"></a><span class="lineno"> 4609</span>&#160;        FiniteElement* this_el_pt = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a4f274774435e9454bf77bf70de69367a">finite_element_pt</a>(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>);</div>
<div class="line"><a name="l04610"></a><span class="lineno"> 4610</span>&#160;        <span class="keywordtype">unsigned</span> n_node = this_el_pt-&gt;nnode(); <span class="comment">// caching pre-loop</span></div>
<div class="line"><a name="l04611"></a><span class="lineno"> 4611</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_node; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l04612"></a><span class="lineno"> 4612</span>&#160;        {</div>
<div class="line"><a name="l04613"></a><span class="lineno"> 4613</span>&#160;          this_el_pt-&gt;node_pt(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>)-&gt;set_non_obsolete();</div>
<div class="line"><a name="l04614"></a><span class="lineno"> 4614</span>&#160;        }</div>
<div class="line"><a name="l04615"></a><span class="lineno"> 4615</span>&#160; </div>
<div class="line"><a name="l04616"></a><span class="lineno"> 4616</span>&#160;        <span class="comment">// Mark up so that repeated refinements do not occur</span></div>
<div class="line"><a name="l04617"></a><span class="lineno"> 4617</span>&#160;        <span class="comment">// (Required because refined element is the same element as the</span></div>
<div class="line"><a name="l04618"></a><span class="lineno"> 4618</span>&#160;        <span class="comment">// original)</span></div>
<div class="line"><a name="l04619"></a><span class="lineno"> 4619</span>&#160;        PRefineableElement* cast_el_pt =</div>
<div class="line"><a name="l04620"></a><span class="lineno"> 4620</span>&#160;          <span class="keyword">dynamic_cast&lt;</span>PRefineableElement*<span class="keyword">&gt;</span>(this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ab28b03dabf4e247c4a25f834eb11b339">element_pt</a>(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>));</div>
<div class="line"><a name="l04621"></a><span class="lineno"> 4621</span>&#160;        cast_el_pt-&gt;deselect_for_p_refinement();</div>
<div class="line"><a name="l04622"></a><span class="lineno"> 4622</span>&#160;        cast_el_pt-&gt;deselect_for_p_unrefinement();</div>
<div class="line"><a name="l04623"></a><span class="lineno"> 4623</span>&#160;      }</div>
<div class="line"><a name="l04624"></a><span class="lineno"> 4624</span>&#160; </div>
<div class="line"><a name="l04625"></a><span class="lineno"> 4625</span>&#160;      <span class="comment">// Cannot delete nodes that are still marked as obsolete</span></div>
<div class="line"><a name="l04626"></a><span class="lineno"> 4626</span>&#160;      <span class="comment">// because they may still be required to assemble the hanging schemes</span></div>
<div class="line"><a name="l04627"></a><span class="lineno"> 4627</span>&#160;      <span class="comment">//-------------------------------------------------------------------</span></div>
<div class="line"><a name="l04628"></a><span class="lineno"> 4628</span>&#160; </div>
<div class="line"><a name="l04629"></a><span class="lineno"> 4629</span>&#160;      <span class="comment">// Mark up hanging nodes</span></div>
<div class="line"><a name="l04630"></a><span class="lineno"> 4630</span>&#160;      <span class="comment">//----------------------</span></div>
<div class="line"><a name="l04631"></a><span class="lineno"> 4631</span>&#160; </div>
<div class="line"><a name="l04632"></a><span class="lineno"> 4632</span>&#160;      <span class="comment">// Output streams for the hanging nodes</span></div>
<div class="line"><a name="l04633"></a><span class="lineno"> 4633</span>&#160;      Vector&lt;std::ofstream*&gt; hanging_output_files;</div>
<div class="line"><a name="l04634"></a><span class="lineno"> 4634</span>&#160;      <span class="comment">// Setup the output files for hanging nodes, this must be called</span></div>
<div class="line"><a name="l04635"></a><span class="lineno"> 4635</span>&#160;      <span class="comment">// precisely once for the forest. Note that the files will only</span></div>
<div class="line"><a name="l04636"></a><span class="lineno"> 4636</span>&#160;      <span class="comment">// actually be opened if doc_info.Doc_flag is true</span></div>
<div class="line"><a name="l04637"></a><span class="lineno"> 4637</span>&#160;      this-&gt;<a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a3c5084830a90bf527a27271613b858a7">forest_pt</a>()-&gt;<a class="code" href="../../d2/d36/classoomph_1_1TreeForest.html#a635443274eaa2fb1afa889e4e748608f">open_hanging_node_files</a>(<a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>,</div>
<div class="line"><a name="l04638"></a><span class="lineno"> 4638</span>&#160;                                                 hanging_output_files);</div>
<div class="line"><a name="l04639"></a><span class="lineno"> 4639</span>&#160; </div>
<div class="line"><a name="l04640"></a><span class="lineno"> 4640</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; num_tree_nodes; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l04641"></a><span class="lineno"> 4641</span>&#160;      {</div>
<div class="line"><a name="l04642"></a><span class="lineno"> 4642</span>&#160;        <span class="comment">// Generic setup</span></div>
<div class="line"><a name="l04643"></a><span class="lineno"> 4643</span>&#160;        tree_nodes_pt[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>]-&gt;object_pt()-&gt;setup_hanging_nodes(</div>
<div class="line"><a name="l04644"></a><span class="lineno"> 4644</span>&#160;          hanging_output_files);</div>
<div class="line"><a name="l04645"></a><span class="lineno"> 4645</span>&#160;        <span class="comment">// Element specific setup</span></div>
<div class="line"><a name="l04646"></a><span class="lineno"> 4646</span>&#160;        tree_nodes_pt[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>]-&gt;object_pt()-&gt;further_setup_hanging_nodes();</div>
<div class="line"><a name="l04647"></a><span class="lineno"> 4647</span>&#160;      }</div>
<div class="line"><a name="l04648"></a><span class="lineno"> 4648</span>&#160; </div>
<div class="line"><a name="l04649"></a><span class="lineno"> 4649</span>&#160;      <span class="comment">// Close the hanging node files and delete the memory allocated</span></div>
<div class="line"><a name="l04650"></a><span class="lineno"> 4650</span>&#160;      <span class="comment">// for the streams</span></div>
<div class="line"><a name="l04651"></a><span class="lineno"> 4651</span>&#160;      this-&gt;<a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a3c5084830a90bf527a27271613b858a7">forest_pt</a>()-&gt;<a class="code" href="../../d2/d36/classoomph_1_1TreeForest.html#ace63bb552b21ba46eb5ae062826dab26">close_hanging_node_files</a>(<a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>,</div>
<div class="line"><a name="l04652"></a><span class="lineno"> 4652</span>&#160;                                                  hanging_output_files);</div>
<div class="line"><a name="l04653"></a><span class="lineno"> 4653</span>&#160; </div>
<div class="line"><a name="l04654"></a><span class="lineno"> 4654</span>&#160; </div>
<div class="line"><a name="l04655"></a><span class="lineno"> 4655</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l04656"></a><span class="lineno"> 4656</span>&#160;      {</div>
<div class="line"><a name="l04657"></a><span class="lineno"> 4657</span>&#160;        t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l04658"></a><span class="lineno"> 4658</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for setup_hanging_nodes() and &quot;</span></div>
<div class="line"><a name="l04659"></a><span class="lineno"> 4659</span>&#160;                      <span class="stringliteral">&quot;further_setup_hanging_nodes() for &quot;</span></div>
<div class="line"><a name="l04660"></a><span class="lineno"> 4660</span>&#160;                   &lt;&lt; num_tree_nodes &lt;&lt; <span class="stringliteral">&quot; elements: &quot;</span> &lt;&lt; t_end - t_start</div>
<div class="line"><a name="l04661"></a><span class="lineno"> 4661</span>&#160;                   &lt;&lt; std::endl;</div>
<div class="line"><a name="l04662"></a><span class="lineno"> 4662</span>&#160;        t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l04663"></a><span class="lineno"> 4663</span>&#160;      }</div>
<div class="line"><a name="l04664"></a><span class="lineno"> 4664</span>&#160; </div>
<div class="line"><a name="l04665"></a><span class="lineno"> 4665</span>&#160;      <span class="comment">// Read out the number of continously interpolated values</span></div>
<div class="line"><a name="l04666"></a><span class="lineno"> 4666</span>&#160;      <span class="comment">// from one of the elements (assuming it&#39;s the same in all elements)</span></div>
<div class="line"><a name="l04667"></a><span class="lineno"> 4667</span>&#160;      <span class="keywordtype">unsigned</span> ncont_interpolated_values =</div>
<div class="line"><a name="l04668"></a><span class="lineno"> 4668</span>&#160;        tree_nodes_pt[0]-&gt;object_pt()-&gt;ncont_interpolated_values();</div>
<div class="line"><a name="l04669"></a><span class="lineno"> 4669</span>&#160; </div>
<div class="line"><a name="l04670"></a><span class="lineno"> 4670</span>&#160;      <span class="comment">// Complete the hanging nodes schemes by dealing with the</span></div>
<div class="line"><a name="l04671"></a><span class="lineno"> 4671</span>&#160;      <span class="comment">// recursively hanging nodes</span></div>
<div class="line"><a name="l04672"></a><span class="lineno"> 4672</span>&#160;      this-&gt;<a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#aab6f14b0933edc819231a88b1d555f62">complete_hanging_nodes</a>(ncont_interpolated_values);</div>
<div class="line"><a name="l04673"></a><span class="lineno"> 4673</span>&#160; </div>
<div class="line"><a name="l04674"></a><span class="lineno"> 4674</span>&#160; </div>
<div class="line"><a name="l04675"></a><span class="lineno"> 4675</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l04676"></a><span class="lineno"> 4676</span>&#160;      {</div>
<div class="line"><a name="l04677"></a><span class="lineno"> 4677</span>&#160;        t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l04678"></a><span class="lineno"> 4678</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for complete_hanging_nodes: &quot;</span> &lt;&lt; t_end - t_start</div>
<div class="line"><a name="l04679"></a><span class="lineno"> 4679</span>&#160;                   &lt;&lt; std::endl;</div>
<div class="line"><a name="l04680"></a><span class="lineno"> 4680</span>&#160;        t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l04681"></a><span class="lineno"> 4681</span>&#160;      }</div>
<div class="line"><a name="l04682"></a><span class="lineno"> 4682</span>&#160; </div>
<div class="line"><a name="l04686"></a><span class="lineno"> 4686</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a37f6d27447f643a74694012b09350ce9">Lookup_for_elements_next_boundary_is_setup</a>)</div>
<div class="line"><a name="l04687"></a><span class="lineno"> 4687</span>&#160;      {</div>
<div class="line"><a name="l04688"></a><span class="lineno"> 4688</span>&#160;        this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a6cc8bcd6b41209f0e9295cc993d9c6bb">setup_boundary_element_info</a>();</div>
<div class="line"><a name="l04689"></a><span class="lineno"> 4689</span>&#160;      }</div>
<div class="line"><a name="l04690"></a><span class="lineno"> 4690</span>&#160; </div>
<div class="line"><a name="l04691"></a><span class="lineno"> 4691</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l04692"></a><span class="lineno"> 4692</span>&#160;      {</div>
<div class="line"><a name="l04693"></a><span class="lineno"> 4693</span>&#160;        t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l04694"></a><span class="lineno"> 4694</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for boundary element info: &quot;</span> &lt;&lt; t_end - t_start</div>
<div class="line"><a name="l04695"></a><span class="lineno"> 4695</span>&#160;                   &lt;&lt; std::endl;</div>
<div class="line"><a name="l04696"></a><span class="lineno"> 4696</span>&#160;        t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l04697"></a><span class="lineno"> 4697</span>&#160;      }</div>
<div class="line"><a name="l04698"></a><span class="lineno"> 4698</span>&#160; </div>
<div class="line"><a name="l04699"></a><span class="lineno"> 4699</span>&#160;      <span class="comment">// BENFLAG: Reset all the node update elements.</span></div>
<div class="line"><a name="l04700"></a><span class="lineno"> 4700</span>&#160;      <span class="comment">//         This is necessary to prevent the following case: A node N is</span></div>
<div class="line"><a name="l04701"></a><span class="lineno"> 4701</span>&#160;      <span class="comment">//         shared between two elements, A and B. The update element for</span></div>
<div class="line"><a name="l04702"></a><span class="lineno"> 4702</span>&#160;      <span class="comment">//         the node is set to A, say. Element A is p-refined and now</span></div>
<div class="line"><a name="l04703"></a><span class="lineno"> 4703</span>&#160;      <span class="comment">//         nolonger has N as a node. However the node update element for N</span></div>
<div class="line"><a name="l04704"></a><span class="lineno"> 4704</span>&#160;      <span class="comment">//         is still A but the node doesn&#39;t exist in A.</span></div>
<div class="line"><a name="l04705"></a><span class="lineno"> 4705</span>&#160;      MacroElementNodeUpdateElementBase* first_macro_el_pt =</div>
<div class="line"><a name="l04706"></a><span class="lineno"> 4706</span>&#160;        <span class="keyword">dynamic_cast&lt;</span>MacroElementNodeUpdateElementBase*<span class="keyword">&gt;</span>(this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ab28b03dabf4e247c4a25f834eb11b339">element_pt</a>(0));</div>
<div class="line"><a name="l04707"></a><span class="lineno"> 4707</span>&#160;      <span class="keywordflow">if</span> (first_macro_el_pt != 0)</div>
<div class="line"><a name="l04708"></a><span class="lineno"> 4708</span>&#160;      {</div>
<div class="line"><a name="l04709"></a><span class="lineno"> 4709</span>&#160;        <span class="comment">// Now set the node update info elementwise</span></div>
<div class="line"><a name="l04710"></a><span class="lineno"> 4710</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">nelement</a>(); <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l04711"></a><span class="lineno"> 4711</span>&#160;        {</div>
<div class="line"><a name="l04712"></a><span class="lineno"> 4712</span>&#160;          <span class="comment">// Cast to macro element</span></div>
<div class="line"><a name="l04713"></a><span class="lineno"> 4713</span>&#160;          MacroElementNodeUpdateElementBase* macro_el_pt =</div>
<div class="line"><a name="l04714"></a><span class="lineno"> 4714</span>&#160;            <span class="keyword">dynamic_cast&lt;</span>MacroElementNodeUpdateElementBase*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l04715"></a><span class="lineno"> 4715</span>&#160;              this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ab28b03dabf4e247c4a25f834eb11b339">element_pt</a>(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>));</div>
<div class="line"><a name="l04716"></a><span class="lineno"> 4716</span>&#160;          <span class="keywordflow">if</span> (macro_el_pt != 0)</div>
<div class="line"><a name="l04717"></a><span class="lineno"> 4717</span>&#160;          {</div>
<div class="line"><a name="l04718"></a><span class="lineno"> 4718</span>&#160;            <span class="comment">// Get vector of geometric objects from element (construct vector</span></div>
<div class="line"><a name="l04719"></a><span class="lineno"> 4719</span>&#160;            <span class="comment">// via copy operation)</span></div>
<div class="line"><a name="l04720"></a><span class="lineno"> 4720</span>&#160;            Vector&lt;GeomObject*&gt; geom_object_pt(macro_el_pt-&gt;geom_object_pt());</div>
<div class="line"><a name="l04721"></a><span class="lineno"> 4721</span>&#160; </div>
<div class="line"><a name="l04722"></a><span class="lineno"> 4722</span>&#160;            <span class="comment">// (Re)set node update info for all the nodes in the element</span></div>
<div class="line"><a name="l04723"></a><span class="lineno"> 4723</span>&#160;            macro_el_pt-&gt;set_node_update_info(geom_object_pt);</div>
<div class="line"><a name="l04724"></a><span class="lineno"> 4724</span>&#160;          }</div>
<div class="line"><a name="l04725"></a><span class="lineno"> 4725</span>&#160;        }</div>
<div class="line"><a name="l04726"></a><span class="lineno"> 4726</span>&#160;      }</div>
<div class="line"><a name="l04727"></a><span class="lineno"> 4727</span>&#160; </div>
<div class="line"><a name="l04728"></a><span class="lineno"> 4728</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l04729"></a><span class="lineno"> 4729</span>&#160; </div>
<div class="line"><a name="l04730"></a><span class="lineno"> 4730</span>&#160;      <span class="comment">// Doc/check the neighbours</span></div>
<div class="line"><a name="l04731"></a><span class="lineno"> 4731</span>&#160;      <span class="comment">//-------------------------</span></div>
<div class="line"><a name="l04732"></a><span class="lineno"> 4732</span>&#160;      Vector&lt;Tree*&gt; all_tree_nodes_pt;</div>
<div class="line"><a name="l04733"></a><span class="lineno"> 4733</span>&#160;      this-&gt;<a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a3c5084830a90bf527a27271613b858a7">forest_pt</a>()-&gt;<a class="code" href="../../d2/d36/classoomph_1_1TreeForest.html#a40bd3735303f019892b03d6a5355c8db">stick_all_tree_nodes_into_vector</a>(all_tree_nodes_pt);</div>
<div class="line"><a name="l04734"></a><span class="lineno"> 4734</span>&#160; </div>
<div class="line"><a name="l04735"></a><span class="lineno"> 4735</span>&#160;      <span class="comment">// Check the neighbours</span></div>
<div class="line"><a name="l04736"></a><span class="lineno"> 4736</span>&#160;      this-&gt;<a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a3c5084830a90bf527a27271613b858a7">forest_pt</a>()-&gt;<a class="code" href="../../d2/d36/classoomph_1_1TreeForest.html#a0e6a7f821d9f14374c6d23d8766c7679">check_all_neighbours</a>(<a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>);</div>
<div class="line"><a name="l04737"></a><span class="lineno"> 4737</span>&#160; </div>
<div class="line"><a name="l04738"></a><span class="lineno"> 4738</span>&#160;      <span class="comment">// Check the integrity of the elements</span></div>
<div class="line"><a name="l04739"></a><span class="lineno"> 4739</span>&#160;      <span class="comment">// -----------------------------------</span></div>
<div class="line"><a name="l04740"></a><span class="lineno"> 4740</span>&#160; </div>
<div class="line"><a name="l04741"></a><span class="lineno"> 4741</span>&#160;      <span class="comment">// Loop over elements and get the elemental integrity</span></div>
<div class="line"><a name="l04742"></a><span class="lineno"> 4742</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a8d7689918a098ce597c3d4fc716a0727">max_error</a> = 0.0;</div>
<div class="line"><a name="l04743"></a><span class="lineno"> 4743</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; num_tree_nodes; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l04744"></a><span class="lineno"> 4744</span>&#160;      {</div>
<div class="line"><a name="l04745"></a><span class="lineno"> 4745</span>&#160;        <span class="keywordtype">double</span> max_el_error;</div>
<div class="line"><a name="l04746"></a><span class="lineno"> 4746</span>&#160;        tree_nodes_pt[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>]-&gt;object_pt()-&gt;check_integrity(max_el_error);</div>
<div class="line"><a name="l04747"></a><span class="lineno"> 4747</span>&#160;        <span class="comment">// If the elemental error is greater than our maximum error</span></div>
<div class="line"><a name="l04748"></a><span class="lineno"> 4748</span>&#160;        <span class="comment">// reset the maximum</span></div>
<div class="line"><a name="l04749"></a><span class="lineno"> 4749</span>&#160;        <span class="keywordflow">if</span> (max_el_error &gt; <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a8d7689918a098ce597c3d4fc716a0727">max_error</a>)</div>
<div class="line"><a name="l04750"></a><span class="lineno"> 4750</span>&#160;        {</div>
<div class="line"><a name="l04751"></a><span class="lineno"> 4751</span>&#160;          <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a8d7689918a098ce597c3d4fc716a0727">max_error</a> = max_el_error;</div>
<div class="line"><a name="l04752"></a><span class="lineno"> 4752</span>&#160;        }</div>
<div class="line"><a name="l04753"></a><span class="lineno"> 4753</span>&#160;      }</div>
<div class="line"><a name="l04754"></a><span class="lineno"> 4754</span>&#160; </div>
<div class="line"><a name="l04755"></a><span class="lineno"> 4755</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a8d7689918a098ce597c3d4fc716a0727">max_error</a> &gt; <a class="code" href="../../dc/d08/classoomph_1_1RefineableElement.html#a25b5901fb0689aefe2c67c361f4290f2">RefineableElement::max_integrity_tolerance</a>())</div>
<div class="line"><a name="l04756"></a><span class="lineno"> 4756</span>&#160;      {</div>
<div class="line"><a name="l04757"></a><span class="lineno"> 4757</span>&#160;        std::ostringstream error_stream;</div>
<div class="line"><a name="l04758"></a><span class="lineno"> 4758</span>&#160;        error_stream &lt;&lt; <span class="stringliteral">&quot;Mesh refined: Max. error in integrity check: &quot;</span></div>
<div class="line"><a name="l04759"></a><span class="lineno"> 4759</span>&#160;                     &lt;&lt; <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a8d7689918a098ce597c3d4fc716a0727">max_error</a> &lt;&lt; <span class="stringliteral">&quot; is too big&quot;</span></div>
<div class="line"><a name="l04760"></a><span class="lineno"> 4760</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;\ni.e. bigger than RefineableElement::&quot;</span></div>
<div class="line"><a name="l04761"></a><span class="lineno"> 4761</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;max_integrity_tolerance()=&quot;</span></div>
<div class="line"><a name="l04762"></a><span class="lineno"> 4762</span>&#160;                     &lt;&lt; <a class="code" href="../../dc/d08/classoomph_1_1RefineableElement.html#a25b5901fb0689aefe2c67c361f4290f2">RefineableElement::max_integrity_tolerance</a>()</div>
<div class="line"><a name="l04763"></a><span class="lineno"> 4763</span>&#160;                     &lt;&lt; std::endl;</div>
<div class="line"><a name="l04764"></a><span class="lineno"> 4764</span>&#160; </div>
<div class="line"><a name="l04765"></a><span class="lineno"> 4765</span>&#160;        std::ofstream some_file;</div>
<div class="line"><a name="l04766"></a><span class="lineno"> 4766</span>&#160;        some_file.open(<span class="stringliteral">&quot;ProblemMesh.dat&quot;</span>);</div>
<div class="line"><a name="l04767"></a><span class="lineno"> 4767</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_node; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l04768"></a><span class="lineno"> 4768</span>&#160;        {</div>
<div class="line"><a name="l04769"></a><span class="lineno"> 4769</span>&#160;          <span class="comment">// Get the pointer to the node</span></div>
<div class="line"><a name="l04770"></a><span class="lineno"> 4770</span>&#160;          Node* nod_pt = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">node_pt</a>(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>);</div>
<div class="line"><a name="l04771"></a><span class="lineno"> 4771</span>&#160;          <span class="comment">// Get the dimension</span></div>
<div class="line"><a name="l04772"></a><span class="lineno"> 4772</span>&#160;          <span class="keywordtype">unsigned</span> n_dim = nod_pt-&gt;ndim();</div>
<div class="line"><a name="l04773"></a><span class="lineno"> 4773</span>&#160;          <span class="comment">// Output the coordinates</span></div>
<div class="line"><a name="l04774"></a><span class="lineno"> 4774</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_dim; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l04775"></a><span class="lineno"> 4775</span>&#160;          {</div>
<div class="line"><a name="l04776"></a><span class="lineno"> 4776</span>&#160;            some_file &lt;&lt; this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">node_pt</a>(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>)-&gt;<a class="code" href="../../dc/db7/classoomph_1_1Node.html#a056f8e82da938369cd38541c5cdc598a">x</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l04777"></a><span class="lineno"> 4777</span>&#160;          }</div>
<div class="line"><a name="l04778"></a><span class="lineno"> 4778</span>&#160;          some_file &lt;&lt; std::endl;</div>
<div class="line"><a name="l04779"></a><span class="lineno"> 4779</span>&#160;        }</div>
<div class="line"><a name="l04780"></a><span class="lineno"> 4780</span>&#160;        some_file.close();</div>
<div class="line"><a name="l04781"></a><span class="lineno"> 4781</span>&#160; </div>
<div class="line"><a name="l04782"></a><span class="lineno"> 4782</span>&#160;        error_stream &lt;&lt; <span class="stringliteral">&quot;Documented problem mesh in ProblemMesh.dat&quot;</span></div>
<div class="line"><a name="l04783"></a><span class="lineno"> 4783</span>&#160;                     &lt;&lt; std::endl;</div>
<div class="line"><a name="l04784"></a><span class="lineno"> 4784</span>&#160; </div>
<div class="line"><a name="l04785"></a><span class="lineno"> 4785</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l04786"></a><span class="lineno"> 4786</span>&#160;          error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l04787"></a><span class="lineno"> 4787</span>&#160;      }</div>
<div class="line"><a name="l04788"></a><span class="lineno"> 4788</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l04789"></a><span class="lineno"> 4789</span>&#160;      {</div>
<div class="line"><a name="l04790"></a><span class="lineno"> 4790</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Mesh refined: Max. error in integrity check: &quot;</span></div>
<div class="line"><a name="l04791"></a><span class="lineno"> 4791</span>&#160;                   &lt;&lt; <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a8d7689918a098ce597c3d4fc716a0727">max_error</a> &lt;&lt; <span class="stringliteral">&quot; is OK&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l04792"></a><span class="lineno"> 4792</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a></div>
<div class="line"><a name="l04793"></a><span class="lineno"> 4793</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;i.e. less than RefineableElement::max_integrity_tolerance()=&quot;</span></div>
<div class="line"><a name="l04794"></a><span class="lineno"> 4794</span>&#160;          &lt;&lt; <a class="code" href="../../dc/d08/classoomph_1_1RefineableElement.html#a25b5901fb0689aefe2c67c361f4290f2">RefineableElement::max_integrity_tolerance</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l04795"></a><span class="lineno"> 4795</span>&#160;          &lt;&lt; std::endl;</div>
<div class="line"><a name="l04796"></a><span class="lineno"> 4796</span>&#160;      }</div>
<div class="line"><a name="l04797"></a><span class="lineno"> 4797</span>&#160; </div>
<div class="line"><a name="l04798"></a><span class="lineno"> 4798</span>&#160; </div>
<div class="line"><a name="l04799"></a><span class="lineno"> 4799</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l04800"></a><span class="lineno"> 4800</span>&#160;      {</div>
<div class="line"><a name="l04801"></a><span class="lineno"> 4801</span>&#160;        t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l04802"></a><span class="lineno"> 4802</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for (paranoid only) checking of integrity: &quot;</span></div>
<div class="line"><a name="l04803"></a><span class="lineno"> 4803</span>&#160;                   &lt;&lt; t_end - t_start &lt;&lt; std::endl;</div>
<div class="line"><a name="l04804"></a><span class="lineno"> 4804</span>&#160;        t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l04805"></a><span class="lineno"> 4805</span>&#160;      }</div>
<div class="line"><a name="l04806"></a><span class="lineno"> 4806</span>&#160; </div>
<div class="line"><a name="l04807"></a><span class="lineno"> 4807</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04808"></a><span class="lineno"> 4808</span>&#160; </div>
<div class="line"><a name="l04809"></a><span class="lineno"> 4809</span>&#160;      <span class="comment">// Loop over all elements other than the final level and deactivate the</span></div>
<div class="line"><a name="l04810"></a><span class="lineno"> 4810</span>&#160;      <span class="comment">// objects, essentially set the pointer that point to nodes that are</span></div>
<div class="line"><a name="l04811"></a><span class="lineno"> 4811</span>&#160;      <span class="comment">// about to be deleted to NULL. This must take place here because nodes</span></div>
<div class="line"><a name="l04812"></a><span class="lineno"> 4812</span>&#160;      <span class="comment">// addressed by elements that are dead but still living in the tree might</span></div>
<div class="line"><a name="l04813"></a><span class="lineno"> 4813</span>&#160;      <span class="comment">// have been made obsolete in the last round of refinement</span></div>
<div class="line"><a name="l04814"></a><span class="lineno"> 4814</span>&#160;      <span class="comment">//(Not strictly required, as tree structure has not changed, but does no</span></div>
<div class="line"><a name="l04815"></a><span class="lineno"> 4815</span>&#160;      <span class="comment">// harm)</span></div>
<div class="line"><a name="l04816"></a><span class="lineno"> 4816</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; this-&gt;<a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a3c5084830a90bf527a27271613b858a7">forest_pt</a>()-&gt;<a class="code" href="../../d2/d36/classoomph_1_1TreeForest.html#a6796a34cf1211f554a59055ff5765863">ntree</a>(); <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l04817"></a><span class="lineno"> 4817</span>&#160;      {</div>
<div class="line"><a name="l04818"></a><span class="lineno"> 4818</span>&#160;        this-&gt;<a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a3c5084830a90bf527a27271613b858a7">forest_pt</a>()-&gt;<a class="code" href="../../d2/d36/classoomph_1_1TreeForest.html#ab031414d924b1637cc4492c7048f3f7a">tree_pt</a>(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>)-&gt;<a class="code" href="../../dd/d99/classoomph_1_1Tree.html#a3caab39c8bee6fb65bbafed523aa6d3d">traverse_all</a>(&amp;<a class="code" href="../../dd/d99/classoomph_1_1Tree.html#aea17489589a1872db51f2b142da4c1fb">Tree::deactivate_object</a>);</div>
<div class="line"><a name="l04819"></a><span class="lineno"> 4819</span>&#160;      }</div>
<div class="line"><a name="l04820"></a><span class="lineno"> 4820</span>&#160; </div>
<div class="line"><a name="l04821"></a><span class="lineno"> 4821</span>&#160;      <span class="comment">// Now we can prune the dead nodes from the mesh.</span></div>
<div class="line"><a name="l04822"></a><span class="lineno"> 4822</span>&#160;      Vector&lt;Node*&gt; deleted_node_pt = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ac9f58929371a3f39dd646d2756547ad2">prune_dead_nodes</a>();</div>
<div class="line"><a name="l04823"></a><span class="lineno"> 4823</span>&#160; </div>
<div class="line"><a name="l04824"></a><span class="lineno"> 4824</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l04825"></a><span class="lineno"> 4825</span>&#160;      {</div>
<div class="line"><a name="l04826"></a><span class="lineno"> 4826</span>&#160;        t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l04827"></a><span class="lineno"> 4827</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for deactivating objects and pruning nodes: &quot;</span></div>
<div class="line"><a name="l04828"></a><span class="lineno"> 4828</span>&#160;                   &lt;&lt; t_end - t_start &lt;&lt; std::endl;</div>
<div class="line"><a name="l04829"></a><span class="lineno"> 4829</span>&#160;        t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l04830"></a><span class="lineno"> 4830</span>&#160;      }</div>
<div class="line"><a name="l04831"></a><span class="lineno"> 4831</span>&#160; </div>
<div class="line"><a name="l04832"></a><span class="lineno"> 4832</span>&#160;      <span class="comment">// Finally: Reorder the nodes within the mesh&#39;s node vector</span></div>
<div class="line"><a name="l04833"></a><span class="lineno"> 4833</span>&#160;      <span class="comment">// to establish a standard ordering regardless of the sequence</span></div>
<div class="line"><a name="l04834"></a><span class="lineno"> 4834</span>&#160;      <span class="comment">// of mesh refinements -- this is required to allow dump/restart</span></div>
<div class="line"><a name="l04835"></a><span class="lineno"> 4835</span>&#160;      <span class="comment">// on refined meshes</span></div>
<div class="line"><a name="l04836"></a><span class="lineno"> 4836</span>&#160;      this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a801e77424d1bf8a35c9bba055230f1e3">reorder_nodes</a>();</div>
<div class="line"><a name="l04837"></a><span class="lineno"> 4837</span>&#160; </div>
<div class="line"><a name="l04838"></a><span class="lineno"> 4838</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l04839"></a><span class="lineno"> 4839</span>&#160;      {</div>
<div class="line"><a name="l04840"></a><span class="lineno"> 4840</span>&#160;        t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l04841"></a><span class="lineno"> 4841</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for reordering &quot;</span> &lt;&lt; <a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a945e7823d1a2af243b5b7f7866aaff5e">nnode</a>()</div>
<div class="line"><a name="l04842"></a><span class="lineno"> 4842</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot; nodes: &quot;</span> &lt;&lt; t_end - t_start &lt;&lt; std::endl;</div>
<div class="line"><a name="l04843"></a><span class="lineno"> 4843</span>&#160;        t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l04844"></a><span class="lineno"> 4844</span>&#160;      }</div>
<div class="line"><a name="l04845"></a><span class="lineno"> 4845</span>&#160; </div>
<div class="line"><a name="l04846"></a><span class="lineno"> 4846</span>&#160;      <span class="comment">// Now we can correct the nodes on boundaries that were hanging that</span></div>
<div class="line"><a name="l04847"></a><span class="lineno"> 4847</span>&#160;      <span class="comment">// are no longer hanging</span></div>
<div class="line"><a name="l04848"></a><span class="lineno"> 4848</span>&#160;      <span class="comment">// Only bother if we have more than two dimensions</span></div>
<div class="line"><a name="l04849"></a><span class="lineno"> 4849</span>&#160;      <span class="keywordflow">if</span> (mesh_dim &gt; 2)</div>
<div class="line"><a name="l04850"></a><span class="lineno"> 4850</span>&#160;      {</div>
<div class="line"><a name="l04851"></a><span class="lineno"> 4851</span>&#160;        <span class="comment">// Loop over the boundaries</span></div>
<div class="line"><a name="l04852"></a><span class="lineno"> 4852</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a> = 0; <a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a> &lt; n_boundary; <a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a>++)</div>
<div class="line"><a name="l04853"></a><span class="lineno"> 4853</span>&#160;        {</div>
<div class="line"><a name="l04854"></a><span class="lineno"> 4854</span>&#160;          <span class="comment">// Remove deleted nodes from the set</span></div>
<div class="line"><a name="l04855"></a><span class="lineno"> 4855</span>&#160;          <span class="keywordtype">unsigned</span> n_del = deleted_node_pt.size();</div>
<div class="line"><a name="l04856"></a><span class="lineno"> 4856</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; n_del; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l04857"></a><span class="lineno"> 4857</span>&#160;          {</div>
<div class="line"><a name="l04858"></a><span class="lineno"> 4858</span>&#160;            hanging_nodes_on_boundary_pt[<a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a>].erase(deleted_node_pt[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>]);</div>
<div class="line"><a name="l04859"></a><span class="lineno"> 4859</span>&#160;          }</div>
<div class="line"><a name="l04860"></a><span class="lineno"> 4860</span>&#160; </div>
<div class="line"><a name="l04861"></a><span class="lineno"> 4861</span>&#160;          <span class="comment">// If the nodes that were hanging are still hanging then remove them</span></div>
<div class="line"><a name="l04862"></a><span class="lineno"> 4862</span>&#160;          <span class="comment">// from the set (note increment is not in for command for efficiencty)</span></div>
<div class="line"><a name="l04863"></a><span class="lineno"> 4863</span>&#160;          <span class="keywordflow">for</span> (std::set&lt;Node*&gt;::iterator it =</div>
<div class="line"><a name="l04864"></a><span class="lineno"> 4864</span>&#160;                 hanging_nodes_on_boundary_pt[<a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a>].begin();</div>
<div class="line"><a name="l04865"></a><span class="lineno"> 4865</span>&#160;               it != hanging_nodes_on_boundary_pt[<a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a>].end();)</div>
<div class="line"><a name="l04866"></a><span class="lineno"> 4866</span>&#160;          {</div>
<div class="line"><a name="l04867"></a><span class="lineno"> 4867</span>&#160;            <span class="keywordflow">if</span> ((*it)-&gt;is_hanging())</div>
<div class="line"><a name="l04868"></a><span class="lineno"> 4868</span>&#160;            {</div>
<div class="line"><a name="l04869"></a><span class="lineno"> 4869</span>&#160;              hanging_nodes_on_boundary_pt[<a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a>].erase(it++);</div>
<div class="line"><a name="l04870"></a><span class="lineno"> 4870</span>&#160;            }</div>
<div class="line"><a name="l04871"></a><span class="lineno"> 4871</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l04872"></a><span class="lineno"> 4872</span>&#160;            {</div>
<div class="line"><a name="l04873"></a><span class="lineno"> 4873</span>&#160;              ++it;</div>
<div class="line"><a name="l04874"></a><span class="lineno"> 4874</span>&#160;            }</div>
<div class="line"><a name="l04875"></a><span class="lineno"> 4875</span>&#160;          }</div>
<div class="line"><a name="l04876"></a><span class="lineno"> 4876</span>&#160; </div>
<div class="line"><a name="l04877"></a><span class="lineno"> 4877</span>&#160;          <span class="comment">// Are there any nodes that have changed geometric hanging status</span></div>
<div class="line"><a name="l04878"></a><span class="lineno"> 4878</span>&#160;          <span class="comment">// on the boundary</span></div>
<div class="line"><a name="l04879"></a><span class="lineno"> 4879</span>&#160;          <span class="comment">// The slightly painful part is that we must adjust the position</span></div>
<div class="line"><a name="l04880"></a><span class="lineno"> 4880</span>&#160;          <span class="comment">// via the macro-elements which are only available through the</span></div>
<div class="line"><a name="l04881"></a><span class="lineno"> 4881</span>&#160;          <span class="comment">// elements and not the nodes.</span></div>
<div class="line"><a name="l04882"></a><span class="lineno"> 4882</span>&#160;          <span class="keywordflow">if</span> (hanging_nodes_on_boundary_pt[<a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a>].<a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>() &gt; 0)</div>
<div class="line"><a name="l04883"></a><span class="lineno"> 4883</span>&#160;          {</div>
<div class="line"><a name="l04884"></a><span class="lineno"> 4884</span>&#160;            <span class="comment">// If so we loop over all elements adjacent to the boundary</span></div>
<div class="line"><a name="l04885"></a><span class="lineno"> 4885</span>&#160;            <span class="keywordtype">unsigned</span> n_boundary_element = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a68e04b3b70cff70d53d75f66661555e8">nboundary_element</a>(<a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a>);</div>
<div class="line"><a name="l04886"></a><span class="lineno"> 4886</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; n_boundary_element; ++<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>)</div>
<div class="line"><a name="l04887"></a><span class="lineno"> 4887</span>&#160;            {</div>
<div class="line"><a name="l04888"></a><span class="lineno"> 4888</span>&#160;              <span class="comment">// Get a pointer to the element</span></div>
<div class="line"><a name="l04889"></a><span class="lineno"> 4889</span>&#160;              FiniteElement* el_pt = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a875271b6f162ddc5685a2511b35e75ec">boundary_element_pt</a>(<a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a>, <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>);</div>
<div class="line"><a name="l04890"></a><span class="lineno"> 4890</span>&#160; </div>
<div class="line"><a name="l04891"></a><span class="lineno"> 4891</span>&#160;              <span class="comment">// Do we have a solid element</span></div>
<div class="line"><a name="l04892"></a><span class="lineno"> 4892</span>&#160;              SolidFiniteElement* solid_el_pt =</div>
<div class="line"><a name="l04893"></a><span class="lineno"> 4893</span>&#160;                <span class="keyword">dynamic_cast&lt;</span>SolidFiniteElement*<span class="keyword">&gt;</span>(el_pt);</div>
<div class="line"><a name="l04894"></a><span class="lineno"> 4894</span>&#160; </div>
<div class="line"><a name="l04895"></a><span class="lineno"> 4895</span>&#160;              <span class="comment">// Determine whether there is a macro element</span></div>
<div class="line"><a name="l04896"></a><span class="lineno"> 4896</span>&#160;              <span class="keywordtype">bool</span> macro_present = (el_pt-&gt;macro_elem_pt() != 0);</div>
<div class="line"><a name="l04897"></a><span class="lineno"> 4897</span>&#160;              <span class="comment">// Or a solid macro element</span></div>
<div class="line"><a name="l04898"></a><span class="lineno"> 4898</span>&#160;              <span class="keywordflow">if</span> (solid_el_pt != 0)</div>
<div class="line"><a name="l04899"></a><span class="lineno"> 4899</span>&#160;              {</div>
<div class="line"><a name="l04900"></a><span class="lineno"> 4900</span>&#160;                macro_present |= (solid_el_pt-&gt;undeformed_macro_elem_pt() != 0);</div>
<div class="line"><a name="l04901"></a><span class="lineno"> 4901</span>&#160;              }</div>
<div class="line"><a name="l04902"></a><span class="lineno"> 4902</span>&#160; </div>
<div class="line"><a name="l04903"></a><span class="lineno"> 4903</span>&#160;              <span class="comment">// Only bother to do anything if there is a macro element</span></div>
<div class="line"><a name="l04904"></a><span class="lineno"> 4904</span>&#160;              <span class="comment">// or undeformed macro element in a SolidElement</span></div>
<div class="line"><a name="l04905"></a><span class="lineno"> 4905</span>&#160;              <span class="keywordflow">if</span> (macro_present)</div>
<div class="line"><a name="l04906"></a><span class="lineno"> 4906</span>&#160;              {</div>
<div class="line"><a name="l04907"></a><span class="lineno"> 4907</span>&#160;                <span class="comment">// Loop over the nodes</span></div>
<div class="line"><a name="l04908"></a><span class="lineno"> 4908</span>&#160;                <span class="comment">// ALH: (could optimise to only loop over</span></div>
<div class="line"><a name="l04909"></a><span class="lineno"> 4909</span>&#160;                <span class="comment">// node associated with the boundary with more effort)</span></div>
<div class="line"><a name="l04910"></a><span class="lineno"> 4910</span>&#160;                <span class="keywordtype">unsigned</span> n_el_node = el_pt-&gt;nnode();</div>
<div class="line"><a name="l04911"></a><span class="lineno"> 4911</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_el_node; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l04912"></a><span class="lineno"> 4912</span>&#160;                {</div>
<div class="line"><a name="l04913"></a><span class="lineno"> 4913</span>&#160;                  <span class="comment">// Cache pointer to the node</span></div>
<div class="line"><a name="l04914"></a><span class="lineno"> 4914</span>&#160;                  Node* nod_pt = el_pt-&gt;node_pt(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>);</div>
<div class="line"><a name="l04915"></a><span class="lineno"> 4915</span>&#160;                  <span class="keywordflow">if</span> (nod_pt-&gt;is_on_boundary(<a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a>))</div>
<div class="line"><a name="l04916"></a><span class="lineno"> 4916</span>&#160;                  {</div>
<div class="line"><a name="l04917"></a><span class="lineno"> 4917</span>&#160;                    <span class="comment">// Is the Node in our set</span></div>
<div class="line"><a name="l04918"></a><span class="lineno"> 4918</span>&#160;                    std::set&lt;Node*&gt;::iterator it =</div>
<div class="line"><a name="l04919"></a><span class="lineno"> 4919</span>&#160;                      hanging_nodes_on_boundary_pt[<a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a>].find(nod_pt);</div>
<div class="line"><a name="l04920"></a><span class="lineno"> 4920</span>&#160;                    <span class="comment">// If we have found the Node then update the position</span></div>
<div class="line"><a name="l04921"></a><span class="lineno"> 4921</span>&#160;                    <span class="comment">// to be consistent with the macro-element representation</span></div>
<div class="line"><a name="l04922"></a><span class="lineno"> 4922</span>&#160;                    <span class="keywordflow">if</span> (it != hanging_nodes_on_boundary_pt[<a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a>].<a class="code" href="../../df/d04/group__Core__Module.html#ga0e45b6b2adead7c6a29815b99f9f14dd">end</a>())</div>
<div class="line"><a name="l04923"></a><span class="lineno"> 4923</span>&#160;                    {</div>
<div class="line"><a name="l04924"></a><span class="lineno"> 4924</span>&#160;                      <span class="comment">// Specialise local and global coordinates to 3D</span></div>
<div class="line"><a name="l04925"></a><span class="lineno"> 4925</span>&#160;                      <span class="comment">// because there is only a problem in 3D.</span></div>
<div class="line"><a name="l04926"></a><span class="lineno"> 4926</span>&#160;                      Vector&lt;double&gt; <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>(3), <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>(3);</div>
<div class="line"><a name="l04927"></a><span class="lineno"> 4927</span>&#160;                      <span class="comment">// Find the local coordinate of the ndoe</span></div>
<div class="line"><a name="l04928"></a><span class="lineno"> 4928</span>&#160;                      el_pt-&gt;local_coordinate_of_node(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>, <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>);</div>
<div class="line"><a name="l04929"></a><span class="lineno"> 4929</span>&#160;                      <span class="comment">// Find the number of time history values</span></div>
<div class="line"><a name="l04930"></a><span class="lineno"> 4930</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> ntstorage = nod_pt-&gt;ntstorage();</div>
<div class="line"><a name="l04931"></a><span class="lineno"> 4931</span>&#160; </div>
<div class="line"><a name="l04932"></a><span class="lineno"> 4932</span>&#160;                      <span class="comment">// Do we have a solid node</span></div>
<div class="line"><a name="l04933"></a><span class="lineno"> 4933</span>&#160;                      SolidNode* solid_node_pt =</div>
<div class="line"><a name="l04934"></a><span class="lineno"> 4934</span>&#160;                        <span class="keyword">dynamic_cast&lt;</span>SolidNode*<span class="keyword">&gt;</span>(nod_pt);</div>
<div class="line"><a name="l04935"></a><span class="lineno"> 4935</span>&#160;                      <span class="keywordflow">if</span> (solid_node_pt)</div>
<div class="line"><a name="l04936"></a><span class="lineno"> 4936</span>&#160;                      {</div>
<div class="line"><a name="l04937"></a><span class="lineno"> 4937</span>&#160;                        <span class="comment">// Assign Lagrangian coordinates from undeformed</span></div>
<div class="line"><a name="l04938"></a><span class="lineno"> 4938</span>&#160;                        <span class="comment">// macro element (if it has one -- get_x_and_xi()</span></div>
<div class="line"><a name="l04939"></a><span class="lineno"> 4939</span>&#160;                        <span class="comment">// does &quot;the right thing&quot; anyway. Leave actual</span></div>
<div class="line"><a name="l04940"></a><span class="lineno"> 4940</span>&#160;                        <span class="comment">// nodal positions alone -- we&#39;re doing a solid</span></div>
<div class="line"><a name="l04941"></a><span class="lineno"> 4941</span>&#160;                        <span class="comment">// mechanics problem and once we&#39;re going</span></div>
<div class="line"><a name="l04942"></a><span class="lineno"> 4942</span>&#160;                        <span class="comment">// the nodal positions are always computed, never</span></div>
<div class="line"><a name="l04943"></a><span class="lineno"> 4943</span>&#160;                        <span class="comment">// (automatically) reset to macro-element based</span></div>
<div class="line"><a name="l04944"></a><span class="lineno"> 4944</span>&#160;                        <span class="comment">// positions; not even on pinned boundaries</span></div>
<div class="line"><a name="l04945"></a><span class="lineno"> 4945</span>&#160;                        <span class="comment">// because the user may have other ideas about where</span></div>
<div class="line"><a name="l04946"></a><span class="lineno"> 4946</span>&#160;                        <span class="comment">// these should go -- pinning means &quot;don&#39;t touch the</span></div>
<div class="line"><a name="l04947"></a><span class="lineno"> 4947</span>&#160;                        <span class="comment">// value&quot;, not &quot;leave where the macro-element thinks</span></div>
<div class="line"><a name="l04948"></a><span class="lineno"> 4948</span>&#160;                        <span class="comment">// it should be&quot;</span></div>
<div class="line"><a name="l04949"></a><span class="lineno"> 4949</span>&#160;                        Vector&lt;double&gt; x_fe(3), xi(3), xi_fe(3);</div>
<div class="line"><a name="l04950"></a><span class="lineno"> 4950</span>&#160;                        solid_el_pt-&gt;get_x_and_xi(<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>, x_fe, <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>, xi_fe, xi);</div>
<div class="line"><a name="l04951"></a><span class="lineno"> 4951</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; 3; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l04952"></a><span class="lineno"> 4952</span>&#160;                        {</div>
<div class="line"><a name="l04953"></a><span class="lineno"> 4953</span>&#160;                          solid_node_pt-&gt;xi(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = xi[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l04954"></a><span class="lineno"> 4954</span>&#160;                        }</div>
<div class="line"><a name="l04955"></a><span class="lineno"> 4955</span>&#160;                      }</div>
<div class="line"><a name="l04956"></a><span class="lineno"> 4956</span>&#160;                      <span class="keywordflow">else</span></div>
<div class="line"><a name="l04957"></a><span class="lineno"> 4957</span>&#160;                      {</div>
<div class="line"><a name="l04958"></a><span class="lineno"> 4958</span>&#160;                        <span class="comment">// Set position and history values from the</span></div>
<div class="line"><a name="l04959"></a><span class="lineno"> 4959</span>&#160;                        <span class="comment">// macro-element representation</span></div>
<div class="line"><a name="l04960"></a><span class="lineno"> 4960</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../dd/ddd/namespaceplotPSD.html#a112f38a9c28b7e27fed13fb3ebf10362">t</a> = 0; <a class="code" href="../../dd/ddd/namespaceplotPSD.html#a112f38a9c28b7e27fed13fb3ebf10362">t</a> &lt; ntstorage; <a class="code" href="../../dd/ddd/namespaceplotPSD.html#a112f38a9c28b7e27fed13fb3ebf10362">t</a>++)</div>
<div class="line"><a name="l04961"></a><span class="lineno"> 4961</span>&#160;                        {</div>
<div class="line"><a name="l04962"></a><span class="lineno"> 4962</span>&#160;                          <span class="comment">// Get the history value from the macro element</span></div>
<div class="line"><a name="l04963"></a><span class="lineno"> 4963</span>&#160;                          el_pt-&gt;get_x(<a class="code" href="../../dd/ddd/namespaceplotPSD.html#a112f38a9c28b7e27fed13fb3ebf10362">t</a>, <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>, <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>);</div>
<div class="line"><a name="l04964"></a><span class="lineno"> 4964</span>&#160; </div>
<div class="line"><a name="l04965"></a><span class="lineno"> 4965</span>&#160;                          <span class="comment">// Set the coordinate to that of the macroelement</span></div>
<div class="line"><a name="l04966"></a><span class="lineno"> 4966</span>&#160;                          <span class="comment">// representation</span></div>
<div class="line"><a name="l04967"></a><span class="lineno"> 4967</span>&#160;                          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; 3; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l04968"></a><span class="lineno"> 4968</span>&#160;                          {</div>
<div class="line"><a name="l04969"></a><span class="lineno"> 4969</span>&#160;                            nod_pt-&gt;x(<a class="code" href="../../dd/ddd/namespaceplotPSD.html#a112f38a9c28b7e27fed13fb3ebf10362">t</a>, <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l04970"></a><span class="lineno"> 4970</span>&#160;                          }</div>
<div class="line"><a name="l04971"></a><span class="lineno"> 4971</span>&#160;                        }</div>
<div class="line"><a name="l04972"></a><span class="lineno"> 4972</span>&#160;                      } <span class="comment">// End of non-solid node case</span></div>
<div class="line"><a name="l04973"></a><span class="lineno"> 4973</span>&#160; </div>
<div class="line"><a name="l04974"></a><span class="lineno"> 4974</span>&#160;                      <span class="comment">// Now remove the node from the list</span></div>
<div class="line"><a name="l04975"></a><span class="lineno"> 4975</span>&#160;                      hanging_nodes_on_boundary_pt[<a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a>].erase(it);</div>
<div class="line"><a name="l04976"></a><span class="lineno"> 4976</span>&#160;                      <span class="comment">// If there are no Nodes left then exit the loops</span></div>
<div class="line"><a name="l04977"></a><span class="lineno"> 4977</span>&#160;                      <span class="keywordflow">if</span> (hanging_nodes_on_boundary_pt[<a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a>].<a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>() == 0)</div>
<div class="line"><a name="l04978"></a><span class="lineno"> 4978</span>&#160;                      {</div>
<div class="line"><a name="l04979"></a><span class="lineno"> 4979</span>&#160;                        <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = n_boundary_element;</div>
<div class="line"><a name="l04980"></a><span class="lineno"> 4980</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04981"></a><span class="lineno"> 4981</span>&#160;                      }</div>
<div class="line"><a name="l04982"></a><span class="lineno"> 4982</span>&#160;                    }</div>
<div class="line"><a name="l04983"></a><span class="lineno"> 4983</span>&#160;                  }</div>
<div class="line"><a name="l04984"></a><span class="lineno"> 4984</span>&#160;                }</div>
<div class="line"><a name="l04985"></a><span class="lineno"> 4985</span>&#160;              } <span class="comment">// End of macro element case</span></div>
<div class="line"><a name="l04986"></a><span class="lineno"> 4986</span>&#160;            }</div>
<div class="line"><a name="l04987"></a><span class="lineno"> 4987</span>&#160;          }</div>
<div class="line"><a name="l04988"></a><span class="lineno"> 4988</span>&#160;        }</div>
<div class="line"><a name="l04989"></a><span class="lineno"> 4989</span>&#160;      } <span class="comment">// End of case when we have fixed nodal positions</span></div>
<div class="line"><a name="l04990"></a><span class="lineno"> 4990</span>&#160; </div>
<div class="line"><a name="l04991"></a><span class="lineno"> 4991</span>&#160;      <span class="comment">// Final doc</span></div>
<div class="line"><a name="l04992"></a><span class="lineno"> 4992</span>&#160;      <span class="comment">//-----------</span></div>
<div class="line"><a name="l04993"></a><span class="lineno"> 4993</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>.<a class="code" href="../../d7/d2c/classoomph_1_1DocInfo.html#a2ce90cf54f24b4ab523c624031fbb76b">is_doc_enabled</a>())</div>
<div class="line"><a name="l04994"></a><span class="lineno"> 4994</span>&#160;      {</div>
<div class="line"><a name="l04995"></a><span class="lineno"> 4995</span>&#160;        <span class="comment">// Doc the boundary conditions (&#39;0&#39; for non-existent, &#39;1&#39; for free,</span></div>
<div class="line"><a name="l04996"></a><span class="lineno"> 4996</span>&#160;        <span class="comment">//----------------------------------------------------------------</span></div>
<div class="line"><a name="l04997"></a><span class="lineno"> 4997</span>&#160;        <span class="comment">// &#39;2&#39; for pinned -- ideal for tecplot scatter sizing.</span></div>
<div class="line"><a name="l04998"></a><span class="lineno"> 4998</span>&#160;        <span class="comment">//----------------------------------------------------</span></div>
<div class="line"><a name="l04999"></a><span class="lineno"> 4999</span>&#160;        <span class="comment">// num_tree_nodes=tree_nodes_pt.size();</span></div>
<div class="line"><a name="l05000"></a><span class="lineno"> 5000</span>&#160; </div>
<div class="line"><a name="l05001"></a><span class="lineno"> 5001</span>&#160;        <span class="comment">// Determine maximum number of values at any node in this type of</span></div>
<div class="line"><a name="l05002"></a><span class="lineno"> 5002</span>&#160;        <span class="comment">// element</span></div>
<div class="line"><a name="l05003"></a><span class="lineno"> 5003</span>&#160;        RefineableElement* el_pt = tree_nodes_pt[0]-&gt;object_pt();</div>
<div class="line"><a name="l05004"></a><span class="lineno"> 5004</span>&#160;        <span class="comment">// Initalise max_nval</span></div>
<div class="line"><a name="l05005"></a><span class="lineno"> 5005</span>&#160;        <span class="keywordtype">unsigned</span> max_nval = 0;</div>
<div class="line"><a name="l05006"></a><span class="lineno"> 5006</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; el_pt-&gt;nnode(); <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l05007"></a><span class="lineno"> 5007</span>&#160;        {</div>
<div class="line"><a name="l05008"></a><span class="lineno"> 5008</span>&#160;          <span class="keywordflow">if</span> (el_pt-&gt;node_pt(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>)-&gt;nvalue() &gt; max_nval)</div>
<div class="line"><a name="l05009"></a><span class="lineno"> 5009</span>&#160;          {</div>
<div class="line"><a name="l05010"></a><span class="lineno"> 5010</span>&#160;            max_nval = el_pt-&gt;node_pt(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>)-&gt;nvalue();</div>
<div class="line"><a name="l05011"></a><span class="lineno"> 5011</span>&#160;          }</div>
<div class="line"><a name="l05012"></a><span class="lineno"> 5012</span>&#160;        }</div>
<div class="line"><a name="l05013"></a><span class="lineno"> 5013</span>&#160; </div>
<div class="line"><a name="l05014"></a><span class="lineno"> 5014</span>&#160;        <span class="comment">// Open the output file</span></div>
<div class="line"><a name="l05015"></a><span class="lineno"> 5015</span>&#160;        std::ostringstream fullname;</div>
<div class="line"><a name="l05016"></a><span class="lineno"> 5016</span>&#160;        std::ofstream bcs_file;</div>
<div class="line"><a name="l05017"></a><span class="lineno"> 5017</span>&#160;        fullname.str(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l05018"></a><span class="lineno"> 5018</span>&#160;        fullname &lt;&lt; <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>.<a class="code" href="../../d7/d2c/classoomph_1_1DocInfo.html#a85d58bcfce0a7b7cae461624e6fcd08a">directory</a>() &lt;&lt; <span class="stringliteral">&quot;/bcs&quot;</span> &lt;&lt; <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>.<a class="code" href="../../d7/d2c/classoomph_1_1DocInfo.html#af27224b25da5b758442753f0947e62d4">number</a>()</div>
<div class="line"><a name="l05019"></a><span class="lineno"> 5019</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;.dat&quot;</span>;</div>
<div class="line"><a name="l05020"></a><span class="lineno"> 5020</span>&#160;        bcs_file.open(fullname.str().c_str());</div>
<div class="line"><a name="l05021"></a><span class="lineno"> 5021</span>&#160; </div>
<div class="line"><a name="l05022"></a><span class="lineno"> 5022</span>&#160;        <span class="comment">// Loop over elements</span></div>
<div class="line"><a name="l05023"></a><span class="lineno"> 5023</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; num_tree_nodes; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l05024"></a><span class="lineno"> 5024</span>&#160;        {</div>
<div class="line"><a name="l05025"></a><span class="lineno"> 5025</span>&#160;          el_pt = tree_nodes_pt[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>]-&gt;object_pt();</div>
<div class="line"><a name="l05026"></a><span class="lineno"> 5026</span>&#160;          <span class="comment">// Loop over nodes in element</span></div>
<div class="line"><a name="l05027"></a><span class="lineno"> 5027</span>&#160;          <span class="keywordtype">unsigned</span> n_nod = el_pt-&gt;nnode();</div>
<div class="line"><a name="l05028"></a><span class="lineno"> 5028</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_nod; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l05029"></a><span class="lineno"> 5029</span>&#160;          {</div>
<div class="line"><a name="l05030"></a><span class="lineno"> 5030</span>&#160;            <span class="comment">// Get pointer to the node</span></div>
<div class="line"><a name="l05031"></a><span class="lineno"> 5031</span>&#160;            Node* nod_pt = el_pt-&gt;node_pt(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>);</div>
<div class="line"><a name="l05032"></a><span class="lineno"> 5032</span>&#160;            <span class="comment">// Find the dimension of the node</span></div>
<div class="line"><a name="l05033"></a><span class="lineno"> 5033</span>&#160;            <span class="keywordtype">unsigned</span> n_dim = nod_pt-&gt;ndim();</div>
<div class="line"><a name="l05034"></a><span class="lineno"> 5034</span>&#160;            <span class="comment">// Write the nodal coordinates to the file</span></div>
<div class="line"><a name="l05035"></a><span class="lineno"> 5035</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_dim; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l05036"></a><span class="lineno"> 5036</span>&#160;            {</div>
<div class="line"><a name="l05037"></a><span class="lineno"> 5037</span>&#160;              bcs_file &lt;&lt; nod_pt-&gt;x(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l05038"></a><span class="lineno"> 5038</span>&#160;            }</div>
<div class="line"><a name="l05039"></a><span class="lineno"> 5039</span>&#160; </div>
<div class="line"><a name="l05040"></a><span class="lineno"> 5040</span>&#160;            <span class="comment">// Loop over all values in this element</span></div>
<div class="line"><a name="l05041"></a><span class="lineno"> 5041</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; max_nval; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l05042"></a><span class="lineno"> 5042</span>&#160;            {</div>
<div class="line"><a name="l05043"></a><span class="lineno"> 5043</span>&#160;              <span class="comment">// Value exists at this node:</span></div>
<div class="line"><a name="l05044"></a><span class="lineno"> 5044</span>&#160;              <span class="keywordflow">if</span> (i &lt; nod_pt-&gt;nvalue())</div>
<div class="line"><a name="l05045"></a><span class="lineno"> 5045</span>&#160;              {</div>
<div class="line"><a name="l05046"></a><span class="lineno"> 5046</span>&#160;                bcs_file &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; 1 + nod_pt-&gt;is_pinned(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l05047"></a><span class="lineno"> 5047</span>&#160;              }</div>
<div class="line"><a name="l05048"></a><span class="lineno"> 5048</span>&#160;              <span class="comment">// ...if not just dump out a zero</span></div>
<div class="line"><a name="l05049"></a><span class="lineno"> 5049</span>&#160;              <span class="keywordflow">else</span></div>
<div class="line"><a name="l05050"></a><span class="lineno"> 5050</span>&#160;              {</div>
<div class="line"><a name="l05051"></a><span class="lineno"> 5051</span>&#160;                bcs_file &lt;&lt; <span class="stringliteral">&quot; 0 &quot;</span>;</div>
<div class="line"><a name="l05052"></a><span class="lineno"> 5052</span>&#160;              }</div>
<div class="line"><a name="l05053"></a><span class="lineno"> 5053</span>&#160;            }</div>
<div class="line"><a name="l05054"></a><span class="lineno"> 5054</span>&#160;            bcs_file &lt;&lt; std::endl;</div>
<div class="line"><a name="l05055"></a><span class="lineno"> 5055</span>&#160;          }</div>
<div class="line"><a name="l05056"></a><span class="lineno"> 5056</span>&#160;        }</div>
<div class="line"><a name="l05057"></a><span class="lineno"> 5057</span>&#160;        bcs_file.close();</div>
<div class="line"><a name="l05058"></a><span class="lineno"> 5058</span>&#160; </div>
<div class="line"><a name="l05059"></a><span class="lineno"> 5059</span>&#160;        <span class="comment">// Doc all nodes</span></div>
<div class="line"><a name="l05060"></a><span class="lineno"> 5060</span>&#160;        <span class="comment">//---------------</span></div>
<div class="line"><a name="l05061"></a><span class="lineno"> 5061</span>&#160;        std::ofstream all_nodes_file;</div>
<div class="line"><a name="l05062"></a><span class="lineno"> 5062</span>&#160;        fullname.str(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l05063"></a><span class="lineno"> 5063</span>&#160;        fullname &lt;&lt; <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>.<a class="code" href="../../d7/d2c/classoomph_1_1DocInfo.html#a85d58bcfce0a7b7cae461624e6fcd08a">directory</a>() &lt;&lt; <span class="stringliteral">&quot;/all_nodes&quot;</span> &lt;&lt; <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>.<a class="code" href="../../d7/d2c/classoomph_1_1DocInfo.html#af27224b25da5b758442753f0947e62d4">number</a>()</div>
<div class="line"><a name="l05064"></a><span class="lineno"> 5064</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;.dat&quot;</span>;</div>
<div class="line"><a name="l05065"></a><span class="lineno"> 5065</span>&#160;        all_nodes_file.open(fullname.str().c_str());</div>
<div class="line"><a name="l05066"></a><span class="lineno"> 5066</span>&#160; </div>
<div class="line"><a name="l05067"></a><span class="lineno"> 5067</span>&#160;        all_nodes_file &lt;&lt; <span class="stringliteral">&quot;ZONE \n&quot;</span>;</div>
<div class="line"><a name="l05068"></a><span class="lineno"> 5068</span>&#160; </div>
<div class="line"><a name="l05069"></a><span class="lineno"> 5069</span>&#160;        <span class="comment">// Need to recompute the number of nodes since it may have</span></div>
<div class="line"><a name="l05070"></a><span class="lineno"> 5070</span>&#160;        <span class="comment">// changed during mesh refinement/unrefinement</span></div>
<div class="line"><a name="l05071"></a><span class="lineno"> 5071</span>&#160;        n_node = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a945e7823d1a2af243b5b7f7866aaff5e">nnode</a>();</div>
<div class="line"><a name="l05072"></a><span class="lineno"> 5072</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_node; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l05073"></a><span class="lineno"> 5073</span>&#160;        {</div>
<div class="line"><a name="l05074"></a><span class="lineno"> 5074</span>&#160;          Node* nod_pt = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">node_pt</a>(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>);</div>
<div class="line"><a name="l05075"></a><span class="lineno"> 5075</span>&#160;          <span class="keywordtype">unsigned</span> n_dim = nod_pt-&gt;ndim();</div>
<div class="line"><a name="l05076"></a><span class="lineno"> 5076</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_dim; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l05077"></a><span class="lineno"> 5077</span>&#160;          {</div>
<div class="line"><a name="l05078"></a><span class="lineno"> 5078</span>&#160;            all_nodes_file &lt;&lt; this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">node_pt</a>(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>)-&gt;<a class="code" href="../../dc/db7/classoomph_1_1Node.html#a056f8e82da938369cd38541c5cdc598a">x</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l05079"></a><span class="lineno"> 5079</span>&#160;          }</div>
<div class="line"><a name="l05080"></a><span class="lineno"> 5080</span>&#160;          all_nodes_file &lt;&lt; std::endl;</div>
<div class="line"><a name="l05081"></a><span class="lineno"> 5081</span>&#160;        }</div>
<div class="line"><a name="l05082"></a><span class="lineno"> 5082</span>&#160; </div>
<div class="line"><a name="l05083"></a><span class="lineno"> 5083</span>&#160;        all_nodes_file.close();</div>
<div class="line"><a name="l05084"></a><span class="lineno"> 5084</span>&#160; </div>
<div class="line"><a name="l05085"></a><span class="lineno"> 5085</span>&#160; </div>
<div class="line"><a name="l05086"></a><span class="lineno"> 5086</span>&#160;        <span class="comment">// Doc all hanging nodes:</span></div>
<div class="line"><a name="l05087"></a><span class="lineno"> 5087</span>&#160;        <span class="comment">//-----------------------</span></div>
<div class="line"><a name="l05088"></a><span class="lineno"> 5088</span>&#160;        std::ofstream some_file;</div>
<div class="line"><a name="l05089"></a><span class="lineno"> 5089</span>&#160;        fullname.str(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l05090"></a><span class="lineno"> 5090</span>&#160;        fullname &lt;&lt; <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>.<a class="code" href="../../d7/d2c/classoomph_1_1DocInfo.html#a85d58bcfce0a7b7cae461624e6fcd08a">directory</a>() &lt;&lt; <span class="stringliteral">&quot;/all_hangnodes&quot;</span></div>
<div class="line"><a name="l05091"></a><span class="lineno"> 5091</span>&#160;                 &lt;&lt; <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>.<a class="code" href="../../d7/d2c/classoomph_1_1DocInfo.html#af27224b25da5b758442753f0947e62d4">number</a>() &lt;&lt; <span class="stringliteral">&quot;.dat&quot;</span>;</div>
<div class="line"><a name="l05092"></a><span class="lineno"> 5092</span>&#160;        some_file.open(fullname.str().c_str());</div>
<div class="line"><a name="l05093"></a><span class="lineno"> 5093</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_node; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l05094"></a><span class="lineno"> 5094</span>&#160;        {</div>
<div class="line"><a name="l05095"></a><span class="lineno"> 5095</span>&#160;          Node* nod_pt = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">node_pt</a>(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>);</div>
<div class="line"><a name="l05096"></a><span class="lineno"> 5096</span>&#160; </div>
<div class="line"><a name="l05097"></a><span class="lineno"> 5097</span>&#160;          <span class="keywordflow">if</span> (nod_pt-&gt;is_hanging())</div>
<div class="line"><a name="l05098"></a><span class="lineno"> 5098</span>&#160;          {</div>
<div class="line"><a name="l05099"></a><span class="lineno"> 5099</span>&#160;            <span class="keywordtype">unsigned</span> n_dim = nod_pt-&gt;ndim();</div>
<div class="line"><a name="l05100"></a><span class="lineno"> 5100</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_dim; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l05101"></a><span class="lineno"> 5101</span>&#160;            {</div>
<div class="line"><a name="l05102"></a><span class="lineno"> 5102</span>&#160;              some_file &lt;&lt; nod_pt-&gt;x(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l05103"></a><span class="lineno"> 5103</span>&#160;            }</div>
<div class="line"><a name="l05104"></a><span class="lineno"> 5104</span>&#160; </div>
<div class="line"><a name="l05105"></a><span class="lineno"> 5105</span>&#160;            <span class="comment">// ALH: Added this to stop Solid problems seg-faulting</span></div>
<div class="line"><a name="l05106"></a><span class="lineno"> 5106</span>&#160;            <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">node_pt</a>(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>)-&gt;nvalue() &gt; 0)</div>
<div class="line"><a name="l05107"></a><span class="lineno"> 5107</span>&#160;            {</div>
<div class="line"><a name="l05108"></a><span class="lineno"> 5108</span>&#160;              some_file &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; nod_pt-&gt;raw_value(0);</div>
<div class="line"><a name="l05109"></a><span class="lineno"> 5109</span>&#160;            }</div>
<div class="line"><a name="l05110"></a><span class="lineno"> 5110</span>&#160;            some_file &lt;&lt; std::endl;</div>
<div class="line"><a name="l05111"></a><span class="lineno"> 5111</span>&#160;          }</div>
<div class="line"><a name="l05112"></a><span class="lineno"> 5112</span>&#160;        }</div>
<div class="line"><a name="l05113"></a><span class="lineno"> 5113</span>&#160;        some_file.close();</div>
<div class="line"><a name="l05114"></a><span class="lineno"> 5114</span>&#160; </div>
<div class="line"><a name="l05115"></a><span class="lineno"> 5115</span>&#160;        <span class="comment">// Doc all hanging nodes and their masters</span></div>
<div class="line"><a name="l05116"></a><span class="lineno"> 5116</span>&#160;        <span class="comment">// View with QHangingNodesWithMasters.mcr</span></div>
<div class="line"><a name="l05117"></a><span class="lineno"> 5117</span>&#160;        fullname.str(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l05118"></a><span class="lineno"> 5118</span>&#160;        fullname &lt;&lt; <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>.<a class="code" href="../../d7/d2c/classoomph_1_1DocInfo.html#a85d58bcfce0a7b7cae461624e6fcd08a">directory</a>() &lt;&lt; <span class="stringliteral">&quot;/geometric_hangnodes_withmasters&quot;</span></div>
<div class="line"><a name="l05119"></a><span class="lineno"> 5119</span>&#160;                 &lt;&lt; <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>.<a class="code" href="../../d7/d2c/classoomph_1_1DocInfo.html#af27224b25da5b758442753f0947e62d4">number</a>() &lt;&lt; <span class="stringliteral">&quot;.dat&quot;</span>;</div>
<div class="line"><a name="l05120"></a><span class="lineno"> 5120</span>&#160;        some_file.open(fullname.str().c_str());</div>
<div class="line"><a name="l05121"></a><span class="lineno"> 5121</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_node; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l05122"></a><span class="lineno"> 5122</span>&#160;        {</div>
<div class="line"><a name="l05123"></a><span class="lineno"> 5123</span>&#160;          Node* nod_pt = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">node_pt</a>(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>);</div>
<div class="line"><a name="l05124"></a><span class="lineno"> 5124</span>&#160;          <span class="keywordflow">if</span> (nod_pt-&gt;is_hanging())</div>
<div class="line"><a name="l05125"></a><span class="lineno"> 5125</span>&#160;          {</div>
<div class="line"><a name="l05126"></a><span class="lineno"> 5126</span>&#160;            <span class="keywordtype">unsigned</span> n_dim = nod_pt-&gt;ndim();</div>
<div class="line"><a name="l05127"></a><span class="lineno"> 5127</span>&#160;            <span class="keywordtype">unsigned</span> nmaster = nod_pt-&gt;hanging_pt()-&gt;nmaster();</div>
<div class="line"><a name="l05128"></a><span class="lineno"> 5128</span>&#160;            some_file &lt;&lt; <span class="stringliteral">&quot;ZONE I=&quot;</span> &lt;&lt; nmaster + 1 &lt;&lt; std::endl;</div>
<div class="line"><a name="l05129"></a><span class="lineno"> 5129</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_dim; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l05130"></a><span class="lineno"> 5130</span>&#160;            {</div>
<div class="line"><a name="l05131"></a><span class="lineno"> 5131</span>&#160;              some_file &lt;&lt; nod_pt-&gt;x(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l05132"></a><span class="lineno"> 5132</span>&#160;            }</div>
<div class="line"><a name="l05133"></a><span class="lineno"> 5133</span>&#160;            some_file &lt;&lt; <span class="stringliteral">&quot; 2 &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l05134"></a><span class="lineno"> 5134</span>&#160; </div>
<div class="line"><a name="l05135"></a><span class="lineno"> 5135</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> imaster = 0; imaster &lt; nmaster; imaster++)</div>
<div class="line"><a name="l05136"></a><span class="lineno"> 5136</span>&#160;            {</div>
<div class="line"><a name="l05137"></a><span class="lineno"> 5137</span>&#160;              Node* master_nod_pt =</div>
<div class="line"><a name="l05138"></a><span class="lineno"> 5138</span>&#160;                nod_pt-&gt;hanging_pt()-&gt;master_node_pt(imaster);</div>
<div class="line"><a name="l05139"></a><span class="lineno"> 5139</span>&#160;              <span class="keywordtype">unsigned</span> n_dim = master_nod_pt-&gt;ndim();</div>
<div class="line"><a name="l05140"></a><span class="lineno"> 5140</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_dim; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l05141"></a><span class="lineno"> 5141</span>&#160;              {</div>
<div class="line"><a name="l05142"></a><span class="lineno"> 5142</span>&#160;                some_file &lt;&lt; master_nod_pt-&gt;x(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l05143"></a><span class="lineno"> 5143</span>&#160;              }</div>
<div class="line"><a name="l05144"></a><span class="lineno"> 5144</span>&#160;              some_file &lt;&lt; <span class="stringliteral">&quot; 1 &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l05145"></a><span class="lineno"> 5145</span>&#160;            }</div>
<div class="line"><a name="l05146"></a><span class="lineno"> 5146</span>&#160;          }</div>
<div class="line"><a name="l05147"></a><span class="lineno"> 5147</span>&#160;        }</div>
<div class="line"><a name="l05148"></a><span class="lineno"> 5148</span>&#160;        some_file.close();</div>
<div class="line"><a name="l05149"></a><span class="lineno"> 5149</span>&#160; </div>
<div class="line"><a name="l05150"></a><span class="lineno"> 5150</span>&#160;        <span class="comment">// Doc all hanging nodes and their masters</span></div>
<div class="line"><a name="l05151"></a><span class="lineno"> 5151</span>&#160;        <span class="comment">// View with QHangingNodesWithMasters.mcr</span></div>
<div class="line"><a name="l05152"></a><span class="lineno"> 5152</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; ncont_interpolated_values; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l05153"></a><span class="lineno"> 5153</span>&#160;        {</div>
<div class="line"><a name="l05154"></a><span class="lineno"> 5154</span>&#160;          fullname.str(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l05155"></a><span class="lineno"> 5155</span>&#160;          fullname &lt;&lt; <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>.<a class="code" href="../../d7/d2c/classoomph_1_1DocInfo.html#a85d58bcfce0a7b7cae461624e6fcd08a">directory</a>()</div>
<div class="line"><a name="l05156"></a><span class="lineno"> 5156</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;/nonstandard_hangnodes_withmasters&quot;</span> &lt;&lt; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot;_&quot;</span></div>
<div class="line"><a name="l05157"></a><span class="lineno"> 5157</span>&#160;                   &lt;&lt; <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>.<a class="code" href="../../d7/d2c/classoomph_1_1DocInfo.html#af27224b25da5b758442753f0947e62d4">number</a>() &lt;&lt; <span class="stringliteral">&quot;.dat&quot;</span>;</div>
<div class="line"><a name="l05158"></a><span class="lineno"> 5158</span>&#160;          some_file.open(fullname.str().c_str());</div>
<div class="line"><a name="l05159"></a><span class="lineno"> 5159</span>&#160;          <span class="keywordtype">unsigned</span> n_nod = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a945e7823d1a2af243b5b7f7866aaff5e">nnode</a>();</div>
<div class="line"><a name="l05160"></a><span class="lineno"> 5160</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_nod; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l05161"></a><span class="lineno"> 5161</span>&#160;          {</div>
<div class="line"><a name="l05162"></a><span class="lineno"> 5162</span>&#160;            Node* nod_pt = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">node_pt</a>(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>);</div>
<div class="line"><a name="l05163"></a><span class="lineno"> 5163</span>&#160;            <span class="keywordflow">if</span> (nod_pt-&gt;is_hanging(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>))</div>
<div class="line"><a name="l05164"></a><span class="lineno"> 5164</span>&#160;            {</div>
<div class="line"><a name="l05165"></a><span class="lineno"> 5165</span>&#160;              <span class="keywordflow">if</span> (nod_pt-&gt;hanging_pt(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) != nod_pt-&gt;hanging_pt())</div>
<div class="line"><a name="l05166"></a><span class="lineno"> 5166</span>&#160;              {</div>
<div class="line"><a name="l05167"></a><span class="lineno"> 5167</span>&#160;                <span class="keywordtype">unsigned</span> nmaster = nod_pt-&gt;hanging_pt(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)-&gt;nmaster();</div>
<div class="line"><a name="l05168"></a><span class="lineno"> 5168</span>&#160;                some_file &lt;&lt; <span class="stringliteral">&quot;ZONE I=&quot;</span> &lt;&lt; nmaster + 1 &lt;&lt; std::endl;</div>
<div class="line"><a name="l05169"></a><span class="lineno"> 5169</span>&#160;                <span class="keywordtype">unsigned</span> n_dim = nod_pt-&gt;ndim();</div>
<div class="line"><a name="l05170"></a><span class="lineno"> 5170</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; n_dim; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l05171"></a><span class="lineno"> 5171</span>&#160;                {</div>
<div class="line"><a name="l05172"></a><span class="lineno"> 5172</span>&#160;                  some_file &lt;&lt; nod_pt-&gt;x(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l05173"></a><span class="lineno"> 5173</span>&#160;                }</div>
<div class="line"><a name="l05174"></a><span class="lineno"> 5174</span>&#160;                some_file &lt;&lt; <span class="stringliteral">&quot; 2 &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l05175"></a><span class="lineno"> 5175</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> imaster = 0; imaster &lt; nmaster; imaster++)</div>
<div class="line"><a name="l05176"></a><span class="lineno"> 5176</span>&#160;                {</div>
<div class="line"><a name="l05177"></a><span class="lineno"> 5177</span>&#160;                  Node* master_nod_pt =</div>
<div class="line"><a name="l05178"></a><span class="lineno"> 5178</span>&#160;                    nod_pt-&gt;hanging_pt(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)-&gt;master_node_pt(imaster);</div>
<div class="line"><a name="l05179"></a><span class="lineno"> 5179</span>&#160;                  <span class="keywordtype">unsigned</span> n_dim = master_nod_pt-&gt;ndim();</div>
<div class="line"><a name="l05180"></a><span class="lineno"> 5180</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; n_dim; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l05181"></a><span class="lineno"> 5181</span>&#160;                  {</div>
<div class="line"><a name="l05182"></a><span class="lineno"> 5182</span>&#160;                    <span class="comment">//               some_file &lt;&lt; master_nod_pt-&gt;x(i) &lt;&lt; &quot; &quot;;</span></div>
<div class="line"><a name="l05183"></a><span class="lineno"> 5183</span>&#160;                  }</div>
<div class="line"><a name="l05184"></a><span class="lineno"> 5184</span>&#160;                  some_file &lt;&lt; <span class="stringliteral">&quot; 1 &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l05185"></a><span class="lineno"> 5185</span>&#160;                }</div>
<div class="line"><a name="l05186"></a><span class="lineno"> 5186</span>&#160;              }</div>
<div class="line"><a name="l05187"></a><span class="lineno"> 5187</span>&#160;            }</div>
<div class="line"><a name="l05188"></a><span class="lineno"> 5188</span>&#160;          }</div>
<div class="line"><a name="l05189"></a><span class="lineno"> 5189</span>&#160;          some_file.close();</div>
<div class="line"><a name="l05190"></a><span class="lineno"> 5190</span>&#160;        }</div>
<div class="line"><a name="l05191"></a><span class="lineno"> 5191</span>&#160; </div>
<div class="line"><a name="l05192"></a><span class="lineno"> 5192</span>&#160;      } <span class="comment">// End of documentation</span></div>
<div class="line"><a name="l05193"></a><span class="lineno"> 5193</span>&#160;    } <span class="comment">// End if (this-&gt;nelement()&gt;0)</span></div>
<div class="line"><a name="l05194"></a><span class="lineno"> 5194</span>&#160; </div>
<div class="line"><a name="l05196"></a><span class="lineno"> 5196</span>&#160;    <span class="comment">// std::cout &lt;&lt; &quot;p_adapt_mesh(): Checking stuff works!&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l05197"></a><span class="lineno"> 5197</span>&#160;    <span class="comment">// for(unsigned j=0; j&lt;this-&gt;nnode(); j++)</span></div>
<div class="line"><a name="l05198"></a><span class="lineno"> 5198</span>&#160;    <span class="comment">// {</span></div>
<div class="line"><a name="l05199"></a><span class="lineno"> 5199</span>&#160;    <span class="comment">//  MacroElementNodeUpdateNode* macro_nod_pt =</span></div>
<div class="line"><a name="l05200"></a><span class="lineno"> 5200</span>&#160;    <span class="comment">//  dynamic_cast&lt;MacroElementNodeUpdateNode*&gt;(this-&gt;node_pt(j));</span></div>
<div class="line"><a name="l05201"></a><span class="lineno"> 5201</span>&#160;    <span class="comment">//  if(macro_nod_pt!=0)</span></div>
<div class="line"><a name="l05202"></a><span class="lineno"> 5202</span>&#160;    <span class="comment">//   {</span></div>
<div class="line"><a name="l05203"></a><span class="lineno"> 5203</span>&#160;    <span class="comment">//    bool big_problem = true;</span></div>
<div class="line"><a name="l05204"></a><span class="lineno"> 5204</span>&#160;    <span class="comment">//    std::cout &lt;&lt; &quot;Node &quot; &lt;&lt; macro_nod_pt &lt;&lt; &quot; at [ &quot; &lt;&lt; macro_nod_pt-&gt;x(0)</span></div>
<div class="line"><a name="l05205"></a><span class="lineno"> 5205</span>&#160;    <span class="comment">//    &lt;&lt; &quot;, &quot; &lt;&lt; macro_nod_pt-&gt;x(1) &lt;&lt; &quot; ]&quot; &lt;&lt; std::endl; FiniteElement*</span></div>
<div class="line"><a name="l05206"></a><span class="lineno"> 5206</span>&#160;    <span class="comment">//    up_el_pt =</span></div>
<div class="line"><a name="l05207"></a><span class="lineno"> 5207</span>&#160;    <span class="comment">//    dynamic_cast&lt;FiniteElement*&gt;(macro_nod_pt-&gt;node_update_element_pt());</span></div>
<div class="line"><a name="l05208"></a><span class="lineno"> 5208</span>&#160;    <span class="comment">//    for(unsigned l=0; l&lt;up_el_pt-&gt;nnode(); l++)</span></div>
<div class="line"><a name="l05209"></a><span class="lineno"> 5209</span>&#160;    <span class="comment">//     {</span></div>
<div class="line"><a name="l05210"></a><span class="lineno"> 5210</span>&#160;    <span class="comment">//      if(up_el_pt-&gt;node_pt(l)==macro_nod_pt)</span></div>
<div class="line"><a name="l05211"></a><span class="lineno"> 5211</span>&#160;    <span class="comment">//       {</span></div>
<div class="line"><a name="l05212"></a><span class="lineno"> 5212</span>&#160;    <span class="comment">//        big_problem = false;</span></div>
<div class="line"><a name="l05213"></a><span class="lineno"> 5213</span>&#160;    <span class="comment">//        break;</span></div>
<div class="line"><a name="l05214"></a><span class="lineno"> 5214</span>&#160;    <span class="comment">//       }</span></div>
<div class="line"><a name="l05215"></a><span class="lineno"> 5215</span>&#160;    <span class="comment">//     }</span></div>
<div class="line"><a name="l05216"></a><span class="lineno"> 5216</span>&#160;    <span class="comment">//    if(big_problem)</span></div>
<div class="line"><a name="l05217"></a><span class="lineno"> 5217</span>&#160;    <span class="comment">//     {</span></div>
<div class="line"><a name="l05218"></a><span class="lineno"> 5218</span>&#160;    <span class="comment">//      std::cout &lt;&lt; &quot;  This node doesn&#39;t exist in it&#39;s update element!&quot; &lt;&lt;</span></div>
<div class="line"><a name="l05219"></a><span class="lineno"> 5219</span>&#160;    <span class="comment">//      std::endl;</span></div>
<div class="line"><a name="l05220"></a><span class="lineno"> 5220</span>&#160;    <span class="comment">//     }</span></div>
<div class="line"><a name="l05221"></a><span class="lineno"> 5221</span>&#160;    <span class="comment">//   }</span></div>
<div class="line"><a name="l05222"></a><span class="lineno"> 5222</span>&#160;    <span class="comment">// }</span></div>
<div class="line"><a name="l05223"></a><span class="lineno"> 5223</span>&#160; </div>
<div class="line"><a name="l05224"></a><span class="lineno"> 5224</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l05225"></a><span class="lineno"> 5225</span>&#160; </div>
<div class="line"><a name="l05226"></a><span class="lineno"> 5226</span>&#160;    <span class="comment">// Now (re-)classify halo and haloed nodes and synchronise hanging</span></div>
<div class="line"><a name="l05227"></a><span class="lineno"> 5227</span>&#160;    <span class="comment">// nodes</span></div>
<div class="line"><a name="l05228"></a><span class="lineno"> 5228</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a1ab35b022b95f2d28c53aa58859bd6b5">is_mesh_distributed</a>())</div>
<div class="line"><a name="l05229"></a><span class="lineno"> 5229</span>&#160;    {</div>
<div class="line"><a name="l05230"></a><span class="lineno"> 5230</span>&#160;      classify_halo_and_haloed_nodes(<a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>, <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>.<a class="code" href="../../d7/d2c/classoomph_1_1DocInfo.html#a2ce90cf54f24b4ab523c624031fbb76b">is_doc_enabled</a>());</div>
<div class="line"><a name="l05231"></a><span class="lineno"> 5231</span>&#160;    }</div>
<div class="line"><a name="l05232"></a><span class="lineno"> 5232</span>&#160; </div>
<div class="line"><a name="l05233"></a><span class="lineno"> 5233</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l05234"></a><span class="lineno"> 5234</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1TreeBasedRefineableMeshBase_html_a9a2f26f447d6386505bdbdd0ac518321"><div class="ttname"><a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a9a2f26f447d6386505bdbdd0ac518321">oomph::TreeBasedRefineableMeshBase::p_refine_elements_if_required</a></div><div class="ttdeci">virtual void p_refine_elements_if_required()=0</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a875271b6f162ddc5685a2511b35e75ec">oomph::Mesh::boundary_element_pt()</a>, <a class="el" href="../../d2/d36/classoomph_1_1TreeForest.html#a0e6a7f821d9f14374c6d23d8766c7679">oomph::TreeForest::check_all_neighbours()</a>, <a class="el" href="../../d2/d36/classoomph_1_1TreeForest.html#ace63bb552b21ba46eb5ae062826dab26">oomph::TreeForest::close_hanging_node_files()</a>, <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#aab6f14b0933edc819231a88b1d555f62">complete_hanging_nodes()</a>, <a class="el" href="../../dd/d99/classoomph_1_1Tree.html#aea17489589a1872db51f2b142da4c1fb">oomph::Tree::deactivate_object()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a9e3ecb07dc622cf37ce0085446ff9aa6">oomph::Mesh::delete_all_external_storage()</a>, <a class="el" href="../../d3/d0c/classoomph_1_1PRefineableElement.html#ae09fd11dea8f804c352a447a6bbdfb9a">oomph::PRefineableElement::deselect_for_p_refinement()</a>, <a class="el" href="../../d3/d0c/classoomph_1_1PRefineableElement.html#a9885c7f63cc66df42692505f2261dc88">oomph::PRefineableElement::deselect_for_p_unrefinement()</a>, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">oomph::FiniteElement::dim()</a>, <a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html#a85d58bcfce0a7b7cae461624e6fcd08a">oomph::DocInfo::directory()</a>, <a class="el" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">oomph::Global_timings::Doc_comprehensive_timings</a>, <a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">oomph::RefineableMeshBase::doc_info()</a>, <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ab28b03dabf4e247c4a25f834eb11b339">oomph::Mesh::element_pt()</a>, <a class="el" href="../../df/d04/group__Core__Module.html#ga0e45b6b2adead7c6a29815b99f9f14dd">Eigen::placeholders::end</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a4f274774435e9454bf77bf70de69367a">oomph::Mesh::finite_element_pt()</a>, <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a3c5084830a90bf527a27271613b858a7">forest_pt()</a>, <a class="el" href="../../df/d06/classoomph_1_1MacroElementNodeUpdateElementBase.html#a45d0d15ee371799c84f59bb13cdac304">oomph::MacroElementNodeUpdateElementBase::geom_object_pt()</a>, <a class="el" href="../../dc/db7/classoomph_1_1Node.html#a33092a3d51285282ae8ec8e702d1cbf5">oomph::Node::get_boundaries_pt()</a>, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a6fc14cbf4e1d031acbc59b415cefa1ca">oomph::FiniteElement::get_x()</a>, <a class="el" href="../../d5/d1a/classoomph_1_1SolidFiniteElement.html#a2e557cb3647e40fe3225bab4d8f834a0">oomph::SolidFiniteElement::get_x_and_xi()</a>, <a class="el" href="../../dc/db7/classoomph_1_1Node.html#a09e3993064a98e7986f392fd5b239603">oomph::Node::hanging_pt()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html#a2ce90cf54f24b4ab523c624031fbb76b">oomph::DocInfo::is_doc_enabled()</a>, <a class="el" href="../../dc/db7/classoomph_1_1Node.html#af0e6237dfafad62cf427ff5013ddcfef">oomph::Node::is_hanging()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a1ab35b022b95f2d28c53aa58859bd6b5">oomph::Mesh::is_mesh_distributed()</a>, <a class="el" href="../../dc/db7/classoomph_1_1Node.html#a2ca215e42116ee8a2acc7d6a35e37788">oomph::Node::is_on_boundary()</a>, <a class="el" href="../../d8/dc5/classoomph_1_1Data.html#aedd0c445396ddcd650c814d17fef77dc">oomph::Data::is_pinned()</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../dc/dfd/classoomph_1_1SolidNode.html#a790277999eb7d8ff0c3f2398d8aaedb0">oomph::SolidNode::lagrangian_position()</a>, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a22bc4ee35e4f948d8d7fba18c7b4f4c4">oomph::FiniteElement::local_coordinate_of_node()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a37f6d27447f643a74694012b09350ce9">oomph::Mesh::Lookup_for_elements_next_boundary_is_setup</a>, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#aa8bce95f69e3199a508672eea7ecc226">oomph::FiniteElement::macro_elem_pt()</a>, <a class="el" href="../../db/d08/classoomph_1_1HangInfo.html#a4983192a13d2ce3d12a454bd895b16e7">oomph::HangInfo::master_node_pt()</a>, <a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a8d7689918a098ce597c3d4fc716a0727">oomph::RefineableMeshBase::max_error()</a>, <a class="el" href="../../dc/d08/classoomph_1_1RefineableElement.html#a25b5901fb0689aefe2c67c361f4290f2">oomph::RefineableElement::max_integrity_tolerance()</a>, <a class="el" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a84543564d6babe4faacbb9d87043fc19">oomph::Mesh::nboundary()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a68e04b3b70cff70d53d75f66661555e8">oomph::Mesh::nboundary_element()</a>, <a class="el" href="../../dc/db7/classoomph_1_1Node.html#a786c96a8e46eb27a03b2b31f629d41b3">oomph::Node::ndim()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">oomph::Mesh::nelement()</a>, <a class="el" href="../../dc/dfd/classoomph_1_1SolidNode.html#af98a0623f9e41a10f48112b9ff7b38a0">oomph::SolidNode::nlagrangian()</a>, <a class="el" href="../../db/d08/classoomph_1_1HangInfo.html#aa9c1130b58db2ff6d5eee4f923ba365c">oomph::HangInfo::nmaster()</a>, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">oomph::FiniteElement::nnode()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a945e7823d1a2af243b5b7f7866aaff5e">oomph::Mesh::nnode()</a>, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a28ae3eb7760edc5c9d6427611d8e6fb6">oomph::FiniteElement::node_pt()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">oomph::Mesh::node_pt()</a>, <a class="el" href="../../d4/d14/classoomph_1_1AlgebraicNode.html#a754dc8fcac3382a07f60262c9792c84c">oomph::AlgebraicNode::node_update()</a>, <a class="el" href="../../d2/d36/classoomph_1_1TreeForest.html#a6796a34cf1211f554a59055ff5765863">oomph::TreeForest::ntree()</a>, <a class="el" href="../../d8/dc5/classoomph_1_1Data.html#a9752205c5fb3bb886200b3fae9181e94">oomph::Data::ntstorage()</a>, <a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html#af27224b25da5b758442753f0947e62d4">oomph::DocInfo::number()</a>, <a class="el" href="../../d8/dc5/classoomph_1_1Data.html#a7e67fc78a2e8a2fd6eb75bd292d42ff8">oomph::Data::nvalue()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, <a class="el" href="../../d2/d36/classoomph_1_1TreeForest.html#a635443274eaa2fb1afa889e4e748608f">oomph::TreeForest::open_hanging_node_files()</a>, <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a9a2f26f447d6386505bdbdd0ac518321">p_refine_elements_if_required()</a>, <a class="el" href="../../dc/db7/classoomph_1_1Node.html#a61c3ad6b319e4d2cce38dc8faae1bfae">oomph::Node::position()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ac9f58929371a3f39dd646d2756547ad2">oomph::Mesh::prune_dead_nodes()</a>, <a class="el" href="../../dc/db7/classoomph_1_1Node.html#abc9f54df56cbe8eedc6f1595c7d7f11e">oomph::Node::raw_value()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a801e77424d1bf8a35c9bba055230f1e3">oomph::Mesh::reorder_nodes()</a>, <a class="el" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>, <a class="el" href="../../df/d06/classoomph_1_1MacroElementNodeUpdateElementBase.html#aa2408d8463e8cecc2ad12a93e10390b1">oomph::MacroElementNodeUpdateElementBase::set_node_update_info()</a>, <a class="el" href="../../dc/db7/classoomph_1_1Node.html#a6dfc895be93214f4a880c1e9e7a3b4a6">oomph::Node::set_non_obsolete()</a>, <a class="el" href="../../dc/db7/classoomph_1_1Node.html#a2517b670b4494f5421f5ec0d92cf8bb0">oomph::Node::set_nonhanging()</a>, <a class="el" href="../../dc/db7/classoomph_1_1Node.html#a2f19488a7967f963b073b93dc12728ab">oomph::Node::set_obsolete()</a>, <a class="el" href="../../d8/dc5/classoomph_1_1Data.html#a7289ca322725c6fd493970a19474b382">oomph::Data::set_value()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a6cc8bcd6b41209f0e9295cc993d9c6bb">oomph::Mesh::setup_boundary_element_info()</a>, <a class="el" href="../../db/ddc/benchVecAdd_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>, <a class="el" href="../../d2/d36/classoomph_1_1TreeForest.html#a40bd3735303f019892b03d6a5355c8db">oomph::TreeForest::stick_all_tree_nodes_into_vector()</a>, <a class="el" href="../../d2/d36/classoomph_1_1TreeForest.html#a6d99d1f513a60b9bd053ff98699cbe52">oomph::TreeForest::stick_leaves_into_vector()</a>, <a class="el" href="../../dd/ddd/namespaceplotPSD.html#a112f38a9c28b7e27fed13fb3ebf10362">plotPSD::t</a>, <a class="el" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">oomph::TimingHelpers::timer()</a>, <a class="el" href="../../dd/d99/classoomph_1_1Tree.html#a3caab39c8bee6fb65bbafed523aa6d3d">oomph::Tree::traverse_all()</a>, <a class="el" href="../../d2/d36/classoomph_1_1TreeForest.html#ab031414d924b1637cc4492c7048f3f7a">oomph::TreeForest::tree_pt()</a>, <a class="el" href="../../d5/d1a/classoomph_1_1SolidFiniteElement.html#a20517d8d6ba84c8e90d880f38310915f">oomph::SolidFiniteElement::undeformed_macro_elem_pt()</a>, <a class="el" href="../../dc/db7/classoomph_1_1Node.html#afcc5cdba40bca251826ae5bee5ca15b4">oomph::Node::value()</a>, <a class="el" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">plotDoE::x</a>, <a class="el" href="../../dc/db7/classoomph_1_1Node.html#a056f8e82da938369cd38541c5cdc598a">oomph::Node::x()</a>, and <a class="el" href="../../dc/dfd/classoomph_1_1SolidNode.html#aca98d62374067829ef896bdf62952385">oomph::SolidNode::xi()</a>.</p>

</div>
</div>
<a id="a9a2f26f447d6386505bdbdd0ac518321"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a2f26f447d6386505bdbdd0ac518321">&#9670;&nbsp;</a></span>p_refine_elements_if_required()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void oomph::TreeBasedRefineableMeshBase::p_refine_elements_if_required </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>p-refine all the elements in the mesh if required. This template free interface will be overloaded in RefineableMesh&lt;ELEMENT&gt; so that any temporary copies of the element that are created will be of the correct type. </p>

<p>Implemented in <a class="el" href="../../d1/d8f/classoomph_1_1TreeBasedRefineableMesh.html#aa47363e7700089d4b8756b2339c4893c">oomph::TreeBasedRefineableMesh&lt; ELEMENT &gt;</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a5d714967dc71ba477c2ca807bbf6d6bd">p_adapt_mesh()</a>.</p>

</div>
</div>
<a id="a178431e8c17ca9784f6fdc2501404471"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a178431e8c17ca9784f6fdc2501404471">&#9670;&nbsp;</a></span>p_refine_selected_elements() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::TreeBasedRefineableMeshBase::p_refine_selected_elements </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d3/d0c/classoomph_1_1PRefineableElement.html">PRefineableElement</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>elements_to_be_refined_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>p-refine mesh by refining the elements identified by their pointers. </p>
<p>p-refine mesh by refining the elements identified by their pointers. </p>
<div class="fragment"><div class="line"><a name="l05306"></a><span class="lineno"> 5306</span>&#160;  {</div>
<div class="line"><a name="l05307"></a><span class="lineno"> 5307</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l05308"></a><span class="lineno"> 5308</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a1ab35b022b95f2d28c53aa58859bd6b5">is_mesh_distributed</a>())</div>
<div class="line"><a name="l05309"></a><span class="lineno"> 5309</span>&#160;    {</div>
<div class="line"><a name="l05310"></a><span class="lineno"> 5310</span>&#160;      std::ostringstream warn_stream;</div>
<div class="line"><a name="l05311"></a><span class="lineno"> 5311</span>&#160;      warn_stream &lt;&lt; <span class="stringliteral">&quot;You are attempting to refine selected elements of a &quot;</span></div>
<div class="line"><a name="l05312"></a><span class="lineno"> 5312</span>&#160;                  &lt;&lt; std::endl</div>
<div class="line"><a name="l05313"></a><span class="lineno"> 5313</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;distributed mesh. This may have undesired effects.&quot;</span></div>
<div class="line"><a name="l05314"></a><span class="lineno"> 5314</span>&#160;                  &lt;&lt; std::endl;</div>
<div class="line"><a name="l05315"></a><span class="lineno"> 5315</span>&#160; </div>
<div class="line"><a name="l05316"></a><span class="lineno"> 5316</span>&#160;      OomphLibWarning(warn_stream.str(),</div>
<div class="line"><a name="l05317"></a><span class="lineno"> 5317</span>&#160;                      <span class="stringliteral">&quot;TreeBasedRefineableMeshBase::refine_selected_elements()&quot;</span>,</div>
<div class="line"><a name="l05318"></a><span class="lineno"> 5318</span>&#160;                      <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l05319"></a><span class="lineno"> 5319</span>&#160;    }</div>
<div class="line"><a name="l05320"></a><span class="lineno"> 5320</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l05321"></a><span class="lineno"> 5321</span>&#160; </div>
<div class="line"><a name="l05322"></a><span class="lineno"> 5322</span>&#160;    <span class="comment">// Select elements for refinement</span></div>
<div class="line"><a name="l05323"></a><span class="lineno"> 5323</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nref = elements_to_be_refined_pt.size();</div>
<div class="line"><a name="l05324"></a><span class="lineno"> 5324</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; nref; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l05325"></a><span class="lineno"> 5325</span>&#160;    {</div>
<div class="line"><a name="l05326"></a><span class="lineno"> 5326</span>&#160;      elements_to_be_refined_pt[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>]-&gt;select_for_p_refinement();</div>
<div class="line"><a name="l05327"></a><span class="lineno"> 5327</span>&#160;    }</div>
<div class="line"><a name="l05328"></a><span class="lineno"> 5328</span>&#160; </div>
<div class="line"><a name="l05329"></a><span class="lineno"> 5329</span>&#160;    <span class="comment">// Do the actual mesh adaptation</span></div>
<div class="line"><a name="l05330"></a><span class="lineno"> 5330</span>&#160;    <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#ae36ab5e807acc10ccc31a7886ffc040a">p_adapt_mesh</a>();</div>
<div class="line"><a name="l05331"></a><span class="lineno"> 5331</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a1ab35b022b95f2d28c53aa58859bd6b5">oomph::Mesh::is_mesh_distributed()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, and <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#ae36ab5e807acc10ccc31a7886ffc040a">p_adapt_mesh()</a>.</p>

</div>
</div>
<a id="a8596076849247d63cadfe579fdc17d60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8596076849247d63cadfe579fdc17d60">&#9670;&nbsp;</a></span>p_refine_selected_elements() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::TreeBasedRefineableMeshBase::p_refine_selected_elements </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>elements_to_be_refined</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>p-refine mesh by refining the elements identified by their numbers. </p>
<p>p-refine mesh by refining the elements identified by their numbers. </p>
<div class="fragment"><div class="line"><a name="l05266"></a><span class="lineno"> 5266</span>&#160;  {</div>
<div class="line"><a name="l05267"></a><span class="lineno"> 5267</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l05268"></a><span class="lineno"> 5268</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a1ab35b022b95f2d28c53aa58859bd6b5">is_mesh_distributed</a>())</div>
<div class="line"><a name="l05269"></a><span class="lineno"> 5269</span>&#160;    {</div>
<div class="line"><a name="l05270"></a><span class="lineno"> 5270</span>&#160;      std::ostringstream warn_stream;</div>
<div class="line"><a name="l05271"></a><span class="lineno"> 5271</span>&#160;      warn_stream &lt;&lt; <span class="stringliteral">&quot;You are attempting to refine selected elements of a &quot;</span></div>
<div class="line"><a name="l05272"></a><span class="lineno"> 5272</span>&#160;                  &lt;&lt; std::endl</div>
<div class="line"><a name="l05273"></a><span class="lineno"> 5273</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;distributed mesh. This may have undesired effects.&quot;</span></div>
<div class="line"><a name="l05274"></a><span class="lineno"> 5274</span>&#160;                  &lt;&lt; std::endl;</div>
<div class="line"><a name="l05275"></a><span class="lineno"> 5275</span>&#160; </div>
<div class="line"><a name="l05276"></a><span class="lineno"> 5276</span>&#160;      OomphLibWarning(warn_stream.str(),</div>
<div class="line"><a name="l05277"></a><span class="lineno"> 5277</span>&#160;                      <span class="stringliteral">&quot;TreeBasedRefineableMeshBase::refine_selected_elements()&quot;</span>,</div>
<div class="line"><a name="l05278"></a><span class="lineno"> 5278</span>&#160;                      <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l05279"></a><span class="lineno"> 5279</span>&#160;    }</div>
<div class="line"><a name="l05280"></a><span class="lineno"> 5280</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l05281"></a><span class="lineno"> 5281</span>&#160; </div>
<div class="line"><a name="l05282"></a><span class="lineno"> 5282</span>&#160;    <span class="comment">// Select elements for refinement</span></div>
<div class="line"><a name="l05283"></a><span class="lineno"> 5283</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nref = elements_to_be_refined.size();</div>
<div class="line"><a name="l05284"></a><span class="lineno"> 5284</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; nref; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l05285"></a><span class="lineno"> 5285</span>&#160;    {</div>
<div class="line"><a name="l05286"></a><span class="lineno"> 5286</span>&#160;      <span class="comment">// Get pointer to p-refineable element</span></div>
<div class="line"><a name="l05287"></a><span class="lineno"> 5287</span>&#160;      PRefineableElement* el_pt = <span class="keyword">dynamic_cast&lt;</span>PRefineableElement*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l05288"></a><span class="lineno"> 5288</span>&#160;        this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ab28b03dabf4e247c4a25f834eb11b339">element_pt</a>(elements_to_be_refined[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>]));</div>
<div class="line"><a name="l05289"></a><span class="lineno"> 5289</span>&#160;      <span class="comment">// Mark for p-refinement if possible. If not then p_adapt_mesh() will</span></div>
<div class="line"><a name="l05290"></a><span class="lineno"> 5290</span>&#160;      <span class="comment">// report the error.</span></div>
<div class="line"><a name="l05291"></a><span class="lineno"> 5291</span>&#160;      <span class="keywordflow">if</span> (el_pt != 0)</div>
<div class="line"><a name="l05292"></a><span class="lineno"> 5292</span>&#160;      {</div>
<div class="line"><a name="l05293"></a><span class="lineno"> 5293</span>&#160;        el_pt-&gt;select_for_p_refinement();</div>
<div class="line"><a name="l05294"></a><span class="lineno"> 5294</span>&#160;      }</div>
<div class="line"><a name="l05295"></a><span class="lineno"> 5295</span>&#160;    }</div>
<div class="line"><a name="l05296"></a><span class="lineno"> 5296</span>&#160; </div>
<div class="line"><a name="l05297"></a><span class="lineno"> 5297</span>&#160;    <span class="comment">// Do the actual mesh adaptation</span></div>
<div class="line"><a name="l05298"></a><span class="lineno"> 5298</span>&#160;    <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#ae36ab5e807acc10ccc31a7886ffc040a">p_adapt_mesh</a>();</div>
<div class="line"><a name="l05299"></a><span class="lineno"> 5299</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ab28b03dabf4e247c4a25f834eb11b339">oomph::Mesh::element_pt()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a1ab35b022b95f2d28c53aa58859bd6b5">oomph::Mesh::is_mesh_distributed()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#ae36ab5e807acc10ccc31a7886ffc040a">p_adapt_mesh()</a>, and <a class="el" href="../../d3/d0c/classoomph_1_1PRefineableElement.html#a89ecf3e300ea9c7dd37ce981053377f4">oomph::PRefineableElement::select_for_p_refinement()</a>.</p>

</div>
</div>
<a id="ae922698aeb358f174c37dac5101c5369"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae922698aeb358f174c37dac5101c5369">&#9670;&nbsp;</a></span>p_refine_uniformly() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::TreeBasedRefineableMeshBase::p_refine_uniformly </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>p-refine mesh uniformly </p>

<p>Reimplemented from <a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a648a6fd1b186baf1b01c07b879280480">oomph::RefineableMeshBase</a>.</p>
<div class="fragment"><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    {</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a648a6fd1b186baf1b01c07b879280480">RefineableMeshBase::p_refine_uniformly</a>();</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1RefineableMeshBase_html_a648a6fd1b186baf1b01c07b879280480"><div class="ttname"><a href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a648a6fd1b186baf1b01c07b879280480">oomph::RefineableMeshBase::p_refine_uniformly</a></div><div class="ttdeci">virtual void p_refine_uniformly()</div><div class="ttdoc">p-refine mesh uniformly</div><div class="ttdef"><b>Definition:</b> refineable_mesh.h:294</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a648a6fd1b186baf1b01c07b879280480">oomph::RefineableMeshBase::p_refine_uniformly()</a>.</p>

</div>
</div>
<a id="a270d74e0e30f9956c85e4cdcc202c98b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a270d74e0e30f9956c85e4cdcc202c98b">&#9670;&nbsp;</a></span>p_refine_uniformly() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::TreeBasedRefineableMeshBase::p_refine_uniformly </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>doc_info</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>p-refine mesh uniformly and doc process </p>
<p>p-refine mesh uniformly </p>

<p>Reimplemented from <a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a443bfce7586aecfa50b4b8a6c6078710">oomph::RefineableMeshBase</a>.</p>
<div class="fragment"><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;  {</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;    <span class="comment">// Select all elements for refinement</span></div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> Nelement = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">nelement</a>();</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; Nelement; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;    {</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;      <span class="comment">// Get pointer to p-refineable element</span></div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;      PRefineableElement* el_pt =</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;        <span class="keyword">dynamic_cast&lt;</span>PRefineableElement*<span class="keyword">&gt;</span>(this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ab28b03dabf4e247c4a25f834eb11b339">element_pt</a>(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>));</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;      <span class="comment">// Mark for p-refinement if possible. If not then p_adapt_mesh() will</span></div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;      <span class="comment">// report the error.</span></div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;      <span class="keywordflow">if</span> (el_pt != 0)</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;      {</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;        el_pt-&gt;select_for_p_refinement();</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;      }</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;    }</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160; </div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;    <span class="comment">// Do the actual mesh adaptation</span></div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;    <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#ae36ab5e807acc10ccc31a7886ffc040a">p_adapt_mesh</a>(<a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>);</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">oomph::RefineableMeshBase::doc_info()</a>, <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ab28b03dabf4e247c4a25f834eb11b339">oomph::Mesh::element_pt()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">oomph::Mesh::nelement()</a>, <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#ae36ab5e807acc10ccc31a7886ffc040a">p_adapt_mesh()</a>, and <a class="el" href="../../d3/d0c/classoomph_1_1PRefineableElement.html#a89ecf3e300ea9c7dd37ce981053377f4">oomph::PRefineableElement::select_for_p_refinement()</a>.</p>

</div>
</div>
<a id="a937e4097d480ed921b86ec4a7e885df6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a937e4097d480ed921b86ec4a7e885df6">&#9670;&nbsp;</a></span>p_unrefine_uniformly()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::TreeBasedRefineableMeshBase::p_unrefine_uniformly </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>doc_info</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>p-unrefine mesh uniformly </p>
<p>p-unrefine mesh uniformly Unlike in h-refinement, we can simply p-unrefine each element in the mesh </p>
<div class="fragment"><div class="line"><a name="l05241"></a><span class="lineno"> 5241</span>&#160;  {</div>
<div class="line"><a name="l05242"></a><span class="lineno"> 5242</span>&#160;    <span class="comment">// Select all elements for unrefinement</span></div>
<div class="line"><a name="l05243"></a><span class="lineno"> 5243</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> Nelement = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">nelement</a>();</div>
<div class="line"><a name="l05244"></a><span class="lineno"> 5244</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; Nelement; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l05245"></a><span class="lineno"> 5245</span>&#160;    {</div>
<div class="line"><a name="l05246"></a><span class="lineno"> 5246</span>&#160;      <span class="comment">// Get pointer to p-refineable element</span></div>
<div class="line"><a name="l05247"></a><span class="lineno"> 5247</span>&#160;      PRefineableElement* el_pt =</div>
<div class="line"><a name="l05248"></a><span class="lineno"> 5248</span>&#160;        <span class="keyword">dynamic_cast&lt;</span>PRefineableElement*<span class="keyword">&gt;</span>(this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ab28b03dabf4e247c4a25f834eb11b339">element_pt</a>(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>));</div>
<div class="line"><a name="l05249"></a><span class="lineno"> 5249</span>&#160;      <span class="comment">// Mark for p-refinement if possible. If not then p_adapt_mesh() will</span></div>
<div class="line"><a name="l05250"></a><span class="lineno"> 5250</span>&#160;      <span class="comment">// report the error.</span></div>
<div class="line"><a name="l05251"></a><span class="lineno"> 5251</span>&#160;      <span class="keywordflow">if</span> (el_pt != 0)</div>
<div class="line"><a name="l05252"></a><span class="lineno"> 5252</span>&#160;      {</div>
<div class="line"><a name="l05253"></a><span class="lineno"> 5253</span>&#160;        el_pt-&gt;select_for_p_unrefinement();</div>
<div class="line"><a name="l05254"></a><span class="lineno"> 5254</span>&#160;      }</div>
<div class="line"><a name="l05255"></a><span class="lineno"> 5255</span>&#160;    }</div>
<div class="line"><a name="l05256"></a><span class="lineno"> 5256</span>&#160; </div>
<div class="line"><a name="l05257"></a><span class="lineno"> 5257</span>&#160;    <span class="comment">// Do the actual mesh adaptation</span></div>
<div class="line"><a name="l05258"></a><span class="lineno"> 5258</span>&#160;    <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#ae36ab5e807acc10ccc31a7886ffc040a">p_adapt_mesh</a>(<a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>);</div>
<div class="line"><a name="l05259"></a><span class="lineno"> 5259</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">oomph::RefineableMeshBase::doc_info()</a>, <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ab28b03dabf4e247c4a25f834eb11b339">oomph::Mesh::element_pt()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">oomph::Mesh::nelement()</a>, <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#ae36ab5e807acc10ccc31a7886ffc040a">p_adapt_mesh()</a>, and <a class="el" href="../../d3/d0c/classoomph_1_1PRefineableElement.html#a99c9cb3bc0a1d6877f58e741f9b36df4">oomph::PRefineableElement::select_for_p_unrefinement()</a>.</p>

</div>
</div>
<a id="a429d5beeb3c44d4310647c805883ea30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a429d5beeb3c44d4310647c805883ea30">&#9670;&nbsp;</a></span>read_refinement()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::TreeBasedRefineableMeshBase::read_refinement </td>
          <td>(</td>
          <td class="paramtype">std::ifstream &amp;&#160;</td>
          <td class="paramname"><em>restart_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>to_be_refined</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Read refinement pattern to allow for rebuild. </p>
<p>Read refinement pattern to allow for rebuild </p>
<div class="fragment"><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  {</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <a class="code" href="../../d2/dc3/namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">std::string</a> input_string;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="comment">// Read max refinement level:</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="comment">// Read line up to termination sign</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    getline(restart_file, input_string, <span class="charliteral">&#39;#&#39;</span>);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="comment">// Ignore rest of line</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    restart_file.ignore(80, <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="comment">// Convert</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keywordtype">unsigned</span> max_level = std::atoi(input_string.c_str());</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="comment">// Assign storage for refinement pattern</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    to_be_refined.resize(max_level);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="comment">// Read the number of the elements that need to be refined at different</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="comment">// levels</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> l = 0; l &lt; max_level; l++)</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    {</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      <span class="comment">// Read line up to termination sign</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      getline(restart_file, input_string, <span class="charliteral">&#39;#&#39;</span>);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      <span class="comment">// Ignore rest of line</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      restart_file.ignore(80, <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      <span class="comment">// Convert</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      <span class="keywordtype">unsigned</span> n_to_be_refined = atoi(input_string.c_str());</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      ;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160; </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      <span class="comment">// Assign storage</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      to_be_refined[l].resize(n_to_be_refined);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      <span class="comment">// Read numbers of the elements that need to be refined</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_to_be_refined; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      {</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        restart_file &gt;&gt; to_be_refined[l][<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      }</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    }</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  }</div>
<div class="ttc" id="anamespaceoomph_1_1Global__string__for__annotation_html_ac5379de2fa7fe44f2cb31785fc208135"><div class="ttname"><a href="../../d2/dc3/namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">oomph::Global_string_for_annotation::string</a></div><div class="ttdeci">std::string string(const unsigned &amp;i)</div><div class="ttdef"><b>Definition:</b> oomph_definitions.cc:286</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, and <a class="el" href="../../d2/dc3/namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">oomph::Global_string_for_annotation::string()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a5753ea33897c77342d00644bef86ba74">refine()</a>.</p>

</div>
</div>
<a id="a5753ea33897c77342d00644bef86ba74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5753ea33897c77342d00644bef86ba74">&#9670;&nbsp;</a></span>refine()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::TreeBasedRefineableMeshBase::refine </td>
          <td>(</td>
          <td class="paramtype">std::ifstream &amp;&#160;</td>
          <td class="paramname"><em>restart_file</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Refine mesh according to refinement pattern in restart file. </p>
<p>Refine base mesh according to refinement pattern in restart file. </p>
<div class="fragment"><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="comment">// Assign storage for refinement pattern</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    Vector&lt;Vector&lt;unsigned&gt;&gt; to_be_refined;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="comment">// Read refinement pattern</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a429d5beeb3c44d4310647c805883ea30">read_refinement</a>(restart_file, to_be_refined);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="comment">// Refine</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a13548e57b680c5e7466d1deeb8f12ff0">refine_base_mesh</a>(to_be_refined);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1TreeBasedRefineableMeshBase_html_a13548e57b680c5e7466d1deeb8f12ff0"><div class="ttname"><a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a13548e57b680c5e7466d1deeb8f12ff0">oomph::TreeBasedRefineableMeshBase::refine_base_mesh</a></div><div class="ttdeci">void refine_base_mesh(Vector&lt; Vector&lt; unsigned &gt;&gt; &amp;to_be_refined)</div><div class="ttdoc">Refine base mesh according to specified refinement pattern.</div><div class="ttdef"><b>Definition:</b> refineable_mesh.cc:137</div></div>
<div class="ttc" id="aclassoomph_1_1TreeBasedRefineableMeshBase_html_a429d5beeb3c44d4310647c805883ea30"><div class="ttname"><a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a429d5beeb3c44d4310647c805883ea30">oomph::TreeBasedRefineableMeshBase::read_refinement</a></div><div class="ttdeci">virtual void read_refinement(std::ifstream &amp;restart_file, Vector&lt; Vector&lt; unsigned &gt;&gt; &amp;to_be_refined)</div><div class="ttdoc">Read refinement pattern to allow for rebuild.</div><div class="ttdef"><b>Definition:</b> refineable_mesh.cc:251</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a429d5beeb3c44d4310647c805883ea30">read_refinement()</a>, and <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a13548e57b680c5e7466d1deeb8f12ff0">refine_base_mesh()</a>.</p>

</div>
</div>
<a id="a7451ff312a3ac482b2f62ded020630c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7451ff312a3ac482b2f62ded020630c3">&#9670;&nbsp;</a></span>refine_as_in_reference_mesh()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::TreeBasedRefineableMeshBase::refine_as_in_reference_mesh </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html">TreeBasedRefineableMeshBase</a> *const &amp;&#160;</td>
          <td class="paramname"><em>ref_mesh_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Refine mesh once so that its topology etc becomes that of the (finer!) reference mesh &ndash; if possible! Useful for meshes in multigrid hierarchies. If the meshes are too different and the conversion cannot be performed, the code dies (provided PARANOID is enabled). </p>
<div class="fragment"><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;  {</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;    <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;WARNING : This has not been checked comprehensively yet&quot;</span></div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;               &lt;&lt; std::endl</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;               &lt;&lt; <span class="stringliteral">&quot;Check it and remove this break &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;    <a class="code" href="../../da/ddf/namespaceoomph.html#a4a82243b0ce4c28469a290fe2d7cd2c4">pause</a>(<span class="stringliteral">&quot;Yes really pause&quot;</span>);</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160; </div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;    <span class="comment">// The max. refinement levels of the two meshes need to differ</span></div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;    <span class="comment">// by one, otherwise what we&#39;re doing here doesn&#39;t make sense.</span></div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;    <span class="keywordtype">unsigned</span> my_min, my_max;</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;    <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a937e4321288b6642d5057498f7659d76">get_refinement_levels</a>(my_min, my_max);</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160; </div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;    <span class="keywordtype">unsigned</span> ref_min, ref_max;</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;    ref_mesh_pt-&gt;get_refinement_levels(ref_min, ref_max);</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160; </div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;    <span class="keywordflow">if</span> (ref_max != my_max + 1)</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;    {</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;      std::ostringstream error_stream;</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;      error_stream</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;Meshes definitely don&#39;t differ by one refinement level \n&quot;</span></div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;max. refinement levels: &quot;</span> &lt;&lt; ref_max &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; my_max &lt;&lt; std::endl;</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160; </div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;        error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;    }</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160; </div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;    <span class="comment">// Vector storing the elements of the uniformly unrefined mesh</span></div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;    Vector&lt;Tree*&gt; coarse_elements_pt;</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160; </div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;    <span class="comment">// Map storing which father elements have already been added to coarse mesh</span></div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;    <span class="comment">// (Default return is 0).</span></div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;    std::map&lt;Tree*, unsigned&gt; father_element_included;</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160; </div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;    <span class="comment">// Extract active elements (=leaf nodes in the quadtree) from reference</span></div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;    <span class="comment">// mesh.</span></div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;    Vector&lt;Tree*&gt; leaf_nodes_pt;</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;    ref_mesh_pt-&gt;forest_pt()-&gt;stick_leaves_into_vector(leaf_nodes_pt);</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160; </div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;    <span class="comment">// Loop over all elements (in their quadtree impersonation) and</span></div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;    <span class="comment">// check if their fathers&#39;s sons are all leaves too:</span></div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;    <span class="keywordtype">unsigned</span> nelem = leaf_nodes_pt.size();</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; nelem; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;    {</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;      <span class="comment">// Pointer to leaf node</span></div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;      Tree* leaf_pt = leaf_nodes_pt[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>];</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160; </div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;      <span class="comment">// Get pointer to father:</span></div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;      Tree* father_pt = leaf_pt-&gt;father_pt();</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160; </div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;      <span class="comment">// If we don&#39;t have a father we&#39;re at the root level in which</span></div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;      <span class="comment">// case this element can&#39;t be unrefined.</span></div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;      <span class="keywordflow">if</span> (0 == father_pt)</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;      {</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;        coarse_elements_pt.push_back(leaf_pt);</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;      }</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;      {</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;        <span class="comment">// Loop over the father&#39;s sons to check if they&#39;re</span></div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;        <span class="comment">// all non-leafs, i.e. if they can be unrefined</span></div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;        <span class="keywordtype">bool</span> can_unrefine = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;        <span class="keywordtype">unsigned</span> n_sons = father_pt-&gt;nsons();</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_sons; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;        {</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;          <span class="comment">// If (at least) one of the sons is not a leaf, we can&#39;t unrefine</span></div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;          <span class="keywordflow">if</span> (!father_pt-&gt;son_pt(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)-&gt;is_leaf()) can_unrefine = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;        }</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160; </div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;        <span class="comment">// If we can unrefine, the father element will be</span></div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;        <span class="comment">// an element in the coarse mesh, the sons won&#39;t</span></div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;        <span class="keywordflow">if</span> (can_unrefine)</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;        {</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;          <span class="keywordflow">if</span> (father_element_included[father_pt] == 0)</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;          {</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;            coarse_elements_pt.push_back(father_pt);</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;            father_element_included[father_pt] = 1;</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;          }</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;        }</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;        <span class="comment">// Son will still be there on the coarse mesh</span></div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;        {</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;          coarse_elements_pt.push_back(leaf_pt);</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;        }</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;      }</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;    }</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160; </div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;    <span class="comment">// Number of elements in ref mesh if it was unrefined uniformly:</span></div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;    <span class="keywordtype">unsigned</span> nel_coarse = coarse_elements_pt.size();</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160; </div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160; </div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;    <span class="keywordtype">bool</span> stop_it = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;    <span class="comment">// The numbers had better match otherwise we might as well stop now...</span></div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;    <span class="keywordflow">if</span> (nel_coarse != this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">nelement</a>())</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;    {</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Number of elements in uniformly unrefined reference mesh: &quot;</span></div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;                 &lt;&lt; nel_coarse &lt;&lt; std::endl;</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Number of elements in &#39;this&#39; mesh: &quot;</span> &lt;&lt; nel_coarse</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;                 &lt;&lt; std::endl;</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;don&#39;t match&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;      stop_it = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;    }</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160; </div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;    <span class="comment">// Now loop over all elements in uniformly coarsened reference mesh</span></div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;    <span class="comment">// and check if add the number of any element that was created</span></div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;    <span class="comment">// by having had its sons merged to the vector of elements that</span></div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;    <span class="comment">// need to get refined if we go the other way</span></div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;    Vector&lt;unsigned&gt; elements_to_be_refined;</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; nel_coarse; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;    {</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;      <span class="keywordflow">if</span> (father_element_included[coarse_elements_pt[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]] == 1)</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;      {</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;        elements_to_be_refined.push_back(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;      }</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;    }</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160; </div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160; </div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;    <span class="comment">// Doc troublesome meshes:</span></div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;    <span class="keywordflow">if</span> (stop_it)</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;    {</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;      std::ofstream some_file;</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;      some_file.open(<span class="stringliteral">&quot;orig_mesh.dat&quot;</span>);</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;      this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#aab74388e8e21325f3ca26f1bd99c26f7">output</a>(some_file);</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;      some_file.close();</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Documented original (&#39;this&#39;)mesh in orig_mesh.dat&quot;</span></div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;                 &lt;&lt; std::endl;</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;    }</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160; </div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160; </div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;    <span class="comment">// Now refine precisely these elements in &quot;this&quot; mesh.</span></div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;    <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a171be4c171cc60de5831f6a2ffaf278e">refine_selected_elements</a>(elements_to_be_refined);</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160; </div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160; </div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160; </div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;    <span class="comment">// Check if the nodal positions of all element&#39;s nodes agree</span></div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;    <span class="comment">// in the two fine meshes:</span></div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;    <span class="keywordtype">double</span> tol = 1.0e-5;</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; nelem; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;    {</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;      <span class="comment">// Get elements</span></div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;      FiniteElement* ref_el_pt = ref_mesh_pt-&gt;finite_element_pt(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>);</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;      FiniteElement* el_pt = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a4f274774435e9454bf77bf70de69367a">finite_element_pt</a>(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>);</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160; </div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;      <span class="comment">// Loop over nodes</span></div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;      <span class="keywordtype">unsigned</span> nnod = ref_el_pt-&gt;nnode();</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; nnod; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;      {</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;        <span class="comment">// Get nodes</span></div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;        Node* ref_node_pt = ref_el_pt-&gt;node_pt(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;        Node* <a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">node_pt</a> = el_pt-&gt;node_pt(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160; </div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;        <span class="comment">// Check error in position</span></div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="../../d9/d33/namespacecalibrate.html#a4dbebf21da853ac368a3a9af2fbab442">error</a> = 0.0;</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;        <span class="keywordtype">unsigned</span> ndim = <a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">node_pt</a>-&gt;<a class="code" href="../../dc/db7/classoomph_1_1Node.html#a786c96a8e46eb27a03b2b31f629d41b3">ndim</a>();</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; ndim; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;        {</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;          <a class="code" href="../../d9/d33/namespacecalibrate.html#a4dbebf21da853ac368a3a9af2fbab442">error</a> += <a class="code" href="../../db/d6f/namespaceEigen_1_1bfloat16__impl.html#aadf08601dbe94964a06487ba453a0436">pow</a>(<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">node_pt</a>-&gt;<a class="code" href="../../dc/db7/classoomph_1_1Node.html#a056f8e82da938369cd38541c5cdc598a">x</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) - ref_node_pt-&gt;x(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>), 2);</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;        }</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;        <a class="code" href="../../d9/d33/namespacecalibrate.html#a4dbebf21da853ac368a3a9af2fbab442">error</a> = <a class="code" href="../../d8/de9/AnnoyingScalar_8h.html#abe7b2405f1f05f9997193c680e8e2fe0">sqrt</a>(<a class="code" href="../../d9/d33/namespacecalibrate.html#a4dbebf21da853ac368a3a9af2fbab442">error</a>);</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160; </div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d9/d33/namespacecalibrate.html#a4dbebf21da853ac368a3a9af2fbab442">error</a> &gt; tol)</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;        {</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Error in nodal position of node &quot;</span> &lt;&lt; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; <a class="code" href="../../d9/d33/namespacecalibrate.html#a4dbebf21da853ac368a3a9af2fbab442">error</a></div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;           [tol=&quot;</span> &lt;&lt; tol &lt;&lt; <span class="stringliteral">&quot;]&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;          stop_it = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;        }</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;      }</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;    }</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160; </div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;    <span class="comment">// Do we have a death wish?</span></div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;    <span class="keywordflow">if</span> (stop_it)</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;    {</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;      <span class="comment">// Doc troublesome meshes:</span></div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;      std::ofstream some_file;</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;      some_file.open(<span class="stringliteral">&quot;refined_mesh.dat&quot;</span>);</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;      this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#aab74388e8e21325f3ca26f1bd99c26f7">output</a>(some_file);</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;      some_file.close();</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160; </div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;      some_file.open(<span class="stringliteral">&quot;finer_mesh.dat&quot;</span>);</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;      ref_mesh_pt-&gt;output(some_file);</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;      some_file.close();</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160; </div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;        <span class="stringliteral">&quot;Bailing out. Doced refined_mesh.dat finer_mesh.dat\n&quot;</span>,</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;        <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;        <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;    }</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160; </div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;  }</div>
<div class="ttc" id="aAnnoyingScalar_8h_html_abe7b2405f1f05f9997193c680e8e2fe0"><div class="ttname"><a href="../../d8/de9/AnnoyingScalar_8h.html#abe7b2405f1f05f9997193c680e8e2fe0">sqrt</a></div><div class="ttdeci">AnnoyingScalar sqrt(const AnnoyingScalar &amp;x)</div><div class="ttdef"><b>Definition:</b> AnnoyingScalar.h:134</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_aab74388e8e21325f3ca26f1bd99c26f7"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#aab74388e8e21325f3ca26f1bd99c26f7">oomph::Mesh::output</a></div><div class="ttdeci">void output(std::ostream &amp;outfile)</div><div class="ttdoc">Output for all elements.</div><div class="ttdef"><b>Definition:</b> mesh.cc:2027</div></div>
<div class="ttc" id="aclassoomph_1_1Node_html_a786c96a8e46eb27a03b2b31f629d41b3"><div class="ttname"><a href="../../dc/db7/classoomph_1_1Node.html#a786c96a8e46eb27a03b2b31f629d41b3">oomph::Node::ndim</a></div><div class="ttdeci">unsigned ndim() const</div><div class="ttdoc">Return (Eulerian) spatial dimension of the node.</div><div class="ttdef"><b>Definition:</b> nodes.h:1054</div></div>
<div class="ttc" id="aclassoomph_1_1TreeBasedRefineableMeshBase_html_a171be4c171cc60de5831f6a2ffaf278e"><div class="ttname"><a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a171be4c171cc60de5831f6a2ffaf278e">oomph::TreeBasedRefineableMeshBase::refine_selected_elements</a></div><div class="ttdeci">virtual void refine_selected_elements(const Vector&lt; unsigned &gt; &amp;elements_to_be_refined)</div><div class="ttdef"><b>Definition:</b> refineable_mesh.cc:1816</div></div>
<div class="ttc" id="aclassoomph_1_1TreeBasedRefineableMeshBase_html_a937e4321288b6642d5057498f7659d76"><div class="ttname"><a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a937e4321288b6642d5057498f7659d76">oomph::TreeBasedRefineableMeshBase::get_refinement_levels</a></div><div class="ttdeci">virtual void get_refinement_levels(unsigned &amp;min_refinement_level, unsigned &amp;max_refinement_level)</div><div class="ttdoc">Get max/min refinement levels in mesh.</div><div class="ttdef"><b>Definition:</b> refineable_mesh.cc:830</div></div>
<div class="ttc" id="anamespaceEigen_1_1bfloat16__impl_html_aadf08601dbe94964a06487ba453a0436"><div class="ttname"><a href="../../db/d6f/namespaceEigen_1_1bfloat16__impl.html#aadf08601dbe94964a06487ba453a0436">Eigen::bfloat16_impl::pow</a></div><div class="ttdeci">EIGEN_STRONG_INLINE EIGEN_DEVICE_FUNC bfloat16 pow(const bfloat16 &amp;a, const bfloat16 &amp;b)</div><div class="ttdef"><b>Definition:</b> BFloat16.h:625</div></div>
<div class="ttc" id="anamespacecalibrate_html_a4dbebf21da853ac368a3a9af2fbab442"><div class="ttname"><a href="../../d9/d33/namespacecalibrate.html#a4dbebf21da853ac368a3a9af2fbab442">calibrate.error</a></div><div class="ttdeci">int error</div><div class="ttdef"><b>Definition:</b> calibrate.py:297</div></div>
<div class="ttc" id="anamespaceoomph_html_a4a82243b0ce4c28469a290fe2d7cd2c4"><div class="ttname"><a href="../../da/ddf/namespaceoomph.html#a4a82243b0ce4c28469a290fe2d7cd2c4">oomph::pause</a></div><div class="ttdeci">void pause(std::string message)</div><div class="ttdoc">Pause and display message.</div><div class="ttdef"><b>Definition:</b> oomph_utilities.cc:1265</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../d9/d33/namespacecalibrate.html#a4dbebf21da853ac368a3a9af2fbab442">calibrate::error</a>, <a class="el" href="../../dd/d99/classoomph_1_1Tree.html#a5f8444ddeda272b70669b8bbe929708a">oomph::Tree::father_pt()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a4f274774435e9454bf77bf70de69367a">oomph::Mesh::finite_element_pt()</a>, <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a3c5084830a90bf527a27271613b858a7">forest_pt()</a>, <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a937e4321288b6642d5057498f7659d76">get_refinement_levels()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../dd/d99/classoomph_1_1Tree.html#a72000456c76880e3f78f8f8fb43d49d8">oomph::Tree::is_leaf()</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../dc/db7/classoomph_1_1Node.html#a786c96a8e46eb27a03b2b31f629d41b3">oomph::Node::ndim()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">oomph::Mesh::nelement()</a>, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">oomph::FiniteElement::nnode()</a>, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a28ae3eb7760edc5c9d6427611d8e6fb6">oomph::FiniteElement::node_pt()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">oomph::Mesh::node_pt()</a>, <a class="el" href="../../dd/d99/classoomph_1_1Tree.html#a31e4123b40f6fb52d180a154c9123e85">oomph::Tree::nsons()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#aab74388e8e21325f3ca26f1bd99c26f7">oomph::Mesh::output()</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#a4a82243b0ce4c28469a290fe2d7cd2c4">oomph::pause()</a>, <a class="el" href="../../db/d6f/namespaceEigen_1_1bfloat16__impl.html#aadf08601dbe94964a06487ba453a0436">Eigen::bfloat16_impl::pow()</a>, <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a171be4c171cc60de5831f6a2ffaf278e">refine_selected_elements()</a>, <a class="el" href="../../dd/d99/classoomph_1_1Tree.html#ab2ca6416d7a368e29da6a6a998f460c7">oomph::Tree::son_pt()</a>, <a class="el" href="../../d8/de9/AnnoyingScalar_8h.html#abe7b2405f1f05f9997193c680e8e2fe0">sqrt()</a>, <a class="el" href="../../d2/d36/classoomph_1_1TreeForest.html#a6d99d1f513a60b9bd053ff98699cbe52">oomph::TreeForest::stick_leaves_into_vector()</a>, and <a class="el" href="../../dc/db7/classoomph_1_1Node.html#a056f8e82da938369cd38541c5cdc598a">oomph::Node::x()</a>.</p>

</div>
</div>
<a id="a13548e57b680c5e7466d1deeb8f12ff0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13548e57b680c5e7466d1deeb8f12ff0">&#9670;&nbsp;</a></span>refine_base_mesh()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::TreeBasedRefineableMeshBase::refine_base_mesh </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>to_be_refined</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Refine base mesh according to specified refinement pattern. </p>
<p>Refine original, unrefined mesh according to specified refinement pattern (relative to original, unrefined mesh). </p>
<div class="fragment"><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="comment">// Get mesh back to unrefined state</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordtype">unsigned</span> my_max, my_min;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a937e4321288b6642d5057498f7659d76">get_refinement_levels</a>(my_min, my_max);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="comment">// Max refinement level:</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordtype">unsigned</span> my_max_level = to_be_refined.size();</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordtype">unsigned</span> global_max = 0;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordtype">unsigned</span> global_max_level = 0;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    Vector&lt;unsigned&gt; <a class="code" href="../../d5/d3b/Map__placement__new_8cpp.html#abe49a82806b5db2e012bc33839af03e6">data</a>(2, 0);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <a class="code" href="../../d5/d3b/Map__placement__new_8cpp.html#abe49a82806b5db2e012bc33839af03e6">data</a>[0] = my_max;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <a class="code" href="../../d5/d3b/Map__placement__new_8cpp.html#abe49a82806b5db2e012bc33839af03e6">data</a>[1] = my_max_level;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    Vector&lt;unsigned&gt; global_data(2, 0);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a1ab35b022b95f2d28c53aa58859bd6b5">is_mesh_distributed</a>())</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      MPI_Allreduce(&amp;<a class="code" href="../../d5/d3b/Map__placement__new_8cpp.html#abe49a82806b5db2e012bc33839af03e6">data</a>[0],</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                    &amp;global_data[0],</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                    2,</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                    MPI_UNSIGNED,</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                    MPI_MAX,</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                    Comm_pt-&gt;mpi_comm());</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      global_max = global_data[0];</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      global_max_level = global_data[1];</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    }</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      global_max = my_max;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      global_max_level = my_max_level;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    }</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; global_max; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a52940028ba9f6472df7e7c65be265057">unrefine_uniformly</a>();</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    }</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="comment">// Do refinement steps in current mesh</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> l = 0; l &lt; global_max_level; l++)</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <span class="comment">// Loop over elements that need to be refined at this level</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <span class="keywordtype">unsigned</span> n_to_be_refined = 0;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      <span class="keywordflow">if</span> (l &lt; my_max_level) n_to_be_refined = to_be_refined[l].size();</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      <span class="comment">// Select relevant elements to be refined</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_to_be_refined; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      {</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <span class="keyword">dynamic_cast&lt;</span>RefineableElement*<span class="keyword">&gt;</span>(this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ab28b03dabf4e247c4a25f834eb11b339">element_pt</a>(to_be_refined[l][<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]))</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;          -&gt;select_for_refinement();</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      }</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      <span class="comment">// Now do the actual mesh refinement</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a64608ddedb7eb56e11bee2805aa01360">adapt_mesh</a>();</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    }</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  }</div>
<div class="ttc" id="aMap__placement__new_8cpp_html_abe49a82806b5db2e012bc33839af03e6"><div class="ttname"><a href="../../d5/d3b/Map__placement__new_8cpp.html#abe49a82806b5db2e012bc33839af03e6">data</a></div><div class="ttdeci">int data[]</div><div class="ttdef"><b>Definition:</b> Map_placement_new.cpp:1</div></div>
<div class="ttc" id="aclassoomph_1_1TreeBasedRefineableMeshBase_html_a52940028ba9f6472df7e7c65be265057"><div class="ttname"><a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a52940028ba9f6472df7e7c65be265057">oomph::TreeBasedRefineableMeshBase::unrefine_uniformly</a></div><div class="ttdeci">unsigned unrefine_uniformly()</div><div class="ttdef"><b>Definition:</b> refineable_mesh.cc:2150</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a64608ddedb7eb56e11bee2805aa01360">adapt_mesh()</a>, <a class="el" href="../../d5/d3b/Map__placement__new_8cpp.html#abe49a82806b5db2e012bc33839af03e6">data</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ab28b03dabf4e247c4a25f834eb11b339">oomph::Mesh::element_pt()</a>, <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a937e4321288b6642d5057498f7659d76">get_refinement_levels()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a1ab35b022b95f2d28c53aa58859bd6b5">oomph::Mesh::is_mesh_distributed()</a>, and <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a52940028ba9f6472df7e7c65be265057">unrefine_uniformly()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d5a/classPolarNSProblem.html#a6b3674a72f007efd9b8ee6b5218485b5">PolarNSProblem&lt; ELEMENT &gt;::output_streamfunction()</a>, <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a5753ea33897c77342d00644bef86ba74">refine()</a>, <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a6a69f5485eb426f6f60ed5a92db383a3">refine_base_mesh_as_in_reference_mesh()</a>, and <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#ae6fc7cc7acf368423cc49cc10ab276bc">refine_base_mesh_as_in_reference_mesh_minus_one()</a>.</p>

</div>
</div>
<a id="a6a69f5485eb426f6f60ed5a92db383a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a69f5485eb426f6f60ed5a92db383a3">&#9670;&nbsp;</a></span>refine_base_mesh_as_in_reference_mesh()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::TreeBasedRefineableMeshBase::refine_base_mesh_as_in_reference_mesh </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html">TreeBasedRefineableMeshBase</a> *const &amp;&#160;</td>
          <td class="paramname"><em>ref_mesh_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Refine to same degree as the reference mesh. </p>
<p>Refine base mesh to same degree as reference mesh (relative to original unrefined mesh). </p>
<div class="fragment"><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;  {</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;    <span class="comment">// Assign storage for refinement pattern</span></div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;    Vector&lt;Vector&lt;unsigned&gt;&gt; to_be_refined;</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160; </div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;    <span class="comment">// Get refinement pattern of reference mesh:</span></div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;    ref_mesh_pt-&gt;get_refinement_pattern(to_be_refined);</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160; </div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;    <span class="comment">// Refine mesh according to given refinement pattern</span></div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;    <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a13548e57b680c5e7466d1deeb8f12ff0">refine_base_mesh</a>(to_be_refined);</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#ae61cbe29fa2aa644af32e73854d5cab3">get_refinement_pattern()</a>, and <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a13548e57b680c5e7466d1deeb8f12ff0">refine_base_mesh()</a>.</p>

</div>
</div>
<a id="ae6fc7cc7acf368423cc49cc10ab276bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6fc7cc7acf368423cc49cc10ab276bc">&#9670;&nbsp;</a></span>refine_base_mesh_as_in_reference_mesh_minus_one()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::TreeBasedRefineableMeshBase::refine_base_mesh_as_in_reference_mesh_minus_one </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html">TreeBasedRefineableMeshBase</a> *const &amp;&#160;</td>
          <td class="paramname"><em>ref_mesh_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Refine base mesh to same degree as reference mesh minus one level of refinement (relative to original unrefined mesh). Useful function for multigrid solvers; allows the easy copy of a mesh to the level of refinement just below the current one</p>
<p>Refine to same degree as the reference mesh minus one. Useful function for multigrid solvers; allows the easy copy of a mesh to the level of refinement just below the current one. Returns a boolean variable which indicates if the reference mesh has not been refined at all </p>
<div class="fragment"><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;  {</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;    <span class="comment">// Assign storage for refinement pattern</span></div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;    Vector&lt;Vector&lt;unsigned&gt;&gt; to_be_refined;</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160; </div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;    <span class="comment">// Get refinement pattern of reference mesh:</span></div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;    ref_mesh_pt-&gt;get_refinement_pattern(to_be_refined);</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160; </div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;    <span class="comment">// Find the length of the vector</span></div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;    <span class="keywordtype">unsigned</span> nrefinement_levels = to_be_refined.size();</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160; </div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;    <span class="comment">// If the reference mesh has not been refined a single time then</span></div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;    <span class="comment">// we cannot create an unrefined copy so stop here</span></div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;    <span class="keywordflow">if</span> (nrefinement_levels == 0)</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;    {</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;    }</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;    <span class="comment">// If the reference mesh has been refined at least once</span></div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;    {</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;      <span class="comment">// Remove the last entry of the vector to make sure we refine to</span></div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;      <span class="comment">// the same level minus one</span></div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;      to_be_refined.resize(nrefinement_levels - 1);</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160; </div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;      <span class="comment">// Refine mesh according to given refinement pattern</span></div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;      <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a13548e57b680c5e7466d1deeb8f12ff0">refine_base_mesh</a>(to_be_refined);</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160; </div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;      <span class="comment">// Indicate that it was possible to create an unrefined copy</span></div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;    }</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#ae61cbe29fa2aa644af32e73854d5cab3">get_refinement_pattern()</a>, and <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a13548e57b680c5e7466d1deeb8f12ff0">refine_base_mesh()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d2e/classoomph_1_1MGSolver.html#a8b25ea9a7781f95ddf46b4b8d427d3d0">oomph::MGSolver&lt; DIM &gt;::setup_mg_hierarchy()</a>, and <a class="el" href="../../da/d32/classoomph_1_1HelmholtzMGPreconditioner.html#ad811c870bf06b25f3237c84b5037e089">oomph::HelmholtzMGPreconditioner&lt; DIM &gt;::setup_mg_hierarchy()</a>.</p>

</div>
</div>
<a id="a6d88d6365af7f92bf766b73b115bcf3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d88d6365af7f92bf766b73b115bcf3f">&#9670;&nbsp;</a></span>refine_selected_elements() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::TreeBasedRefineableMeshBase::refine_selected_elements </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../dc/d08/classoomph_1_1RefineableElement.html">RefineableElement</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>elements_to_be_refined_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Refine mesh by splitting the elements identified by their pointers.</p>
<p>Refine mesh by splitting the elements identified by their pointers </p>
<div class="fragment"><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;  {</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a1ab35b022b95f2d28c53aa58859bd6b5">is_mesh_distributed</a>())</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;    {</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;      std::ostringstream warn_stream;</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;      warn_stream &lt;&lt; <span class="stringliteral">&quot;You are attempting to refine selected elements of a &quot;</span></div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;                  &lt;&lt; std::endl</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;distributed mesh. This may have undesired effects.&quot;</span></div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;                  &lt;&lt; std::endl;</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160; </div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;      OomphLibWarning(warn_stream.str(),</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;                      <span class="stringliteral">&quot;TreeBasedRefineableMeshBase::refine_selected_elements()&quot;</span>,</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;                      <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;    }</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160; </div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;    <span class="comment">// Select elements for refinement</span></div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nref = elements_to_be_refined_pt.size();</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; nref; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;    {</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;      elements_to_be_refined_pt[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>]-&gt;select_for_refinement();</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;    }</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160; </div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;    <span class="comment">// Do the actual mesh adaptation</span></div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;    <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a64608ddedb7eb56e11bee2805aa01360">adapt_mesh</a>();</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a64608ddedb7eb56e11bee2805aa01360">adapt_mesh()</a>, <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a1ab35b022b95f2d28c53aa58859bd6b5">oomph::Mesh::is_mesh_distributed()</a>, and <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>.</p>

</div>
</div>
<a id="a171be4c171cc60de5831f6a2ffaf278e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a171be4c171cc60de5831f6a2ffaf278e">&#9670;&nbsp;</a></span>refine_selected_elements() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::TreeBasedRefineableMeshBase::refine_selected_elements </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>elements_to_be_refined</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Refine mesh by splitting the elements identified by their numbers. </p>
<div class="fragment"><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;  {</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a1ab35b022b95f2d28c53aa58859bd6b5">is_mesh_distributed</a>())</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;    {</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;      std::ostringstream warn_stream;</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;      warn_stream &lt;&lt; <span class="stringliteral">&quot;You are attempting to refine selected elements of a &quot;</span></div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;                  &lt;&lt; std::endl</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;distributed mesh. This may have undesired effects.&quot;</span></div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;                  &lt;&lt; std::endl;</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160; </div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;      OomphLibWarning(warn_stream.str(),</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;                      <span class="stringliteral">&quot;TreeBasedRefineableMeshBase::refine_selected_elements()&quot;</span>,</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;                      <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;    }</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160; </div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;    <span class="comment">// Select elements for refinement</span></div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nref = elements_to_be_refined.size();</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; nref; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;    {</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;      <span class="keyword">dynamic_cast&lt;</span>RefineableElement*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;        this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ab28b03dabf4e247c4a25f834eb11b339">element_pt</a>(elements_to_be_refined[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>]))</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;        -&gt;select_for_refinement();</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;    }</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160; </div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;    <span class="comment">// Do the actual mesh adaptation</span></div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;    <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a64608ddedb7eb56e11bee2805aa01360">adapt_mesh</a>();</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a64608ddedb7eb56e11bee2805aa01360">adapt_mesh()</a>, <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ab28b03dabf4e247c4a25f834eb11b339">oomph::Mesh::element_pt()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a1ab35b022b95f2d28c53aa58859bd6b5">oomph::Mesh::is_mesh_distributed()</a>, and <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/db6/classFSIRingProblem.html#a99a92bc3e2713063664277ce535c0af1">FSIRingProblem::FSIRingProblem()</a>, and <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a7451ff312a3ac482b2f62ded020630c3">refine_as_in_reference_mesh()</a>.</p>

</div>
</div>
<a id="a8e67b50fecb03fe1ac93dcb81e4ac6e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e67b50fecb03fe1ac93dcb81e4ac6e9">&#9670;&nbsp;</a></span>refine_uniformly() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::TreeBasedRefineableMeshBase::refine_uniformly </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Refine mesh uniformly. </p>

<p>Reimplemented from <a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#aa96201d241ce05bb33bce687632470be">oomph::RefineableMeshBase</a>.</p>

<p>Reimplemented in <a class="el" href="../../df/d9b/classoomph_1_1RefineableQuadFromTriangleMesh.html#a73e88bb8c1cc8464f079e928e89a4a14">oomph::RefineableQuadFromTriangleMesh&lt; ELEMENT &gt;</a>.</p>
<div class="fragment"><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    {</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#aa96201d241ce05bb33bce687632470be">RefineableMeshBase::refine_uniformly</a>();</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1RefineableMeshBase_html_aa96201d241ce05bb33bce687632470be"><div class="ttname"><a href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#aa96201d241ce05bb33bce687632470be">oomph::RefineableMeshBase::refine_uniformly</a></div><div class="ttdeci">virtual void refine_uniformly()</div><div class="ttdoc">Refine mesh uniformly.</div><div class="ttdef"><b>Definition:</b> refineable_mesh.h:271</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#aa96201d241ce05bb33bce687632470be">oomph::RefineableMeshBase::refine_uniformly()</a>.</p>

</div>
</div>
<a id="ae238476195a0ceeb2cdb680620fb97a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae238476195a0ceeb2cdb680620fb97a3">&#9670;&nbsp;</a></span>refine_uniformly() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::TreeBasedRefineableMeshBase::refine_uniformly </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>doc_info</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Refine mesh uniformly and doc process. </p>
<p>Refine mesh uniformly. </p>

<p>Implements <a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#afe5810e718ce1939f3f81e3eb5743768">oomph::RefineableMeshBase</a>.</p>

<p>Reimplemented in <a class="el" href="../../df/d9b/classoomph_1_1RefineableQuadFromTriangleMesh.html#ab78f50c13f9ccf7d1f359bc443fe2a9d">oomph::RefineableQuadFromTriangleMesh&lt; ELEMENT &gt;</a>.</p>
<div class="fragment"><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;  {</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;    <span class="comment">// Select all elements for refinement</span></div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> Nelement = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">nelement</a>();</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; Nelement; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;    {</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;      <span class="keyword">dynamic_cast&lt;</span>RefineableElement*<span class="keyword">&gt;</span>(this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ab28b03dabf4e247c4a25f834eb11b339">element_pt</a>(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>))</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;        -&gt;select_for_refinement();</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;    }</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160; </div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;    <span class="comment">// Do the actual mesh adaptation</span></div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;    <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a64608ddedb7eb56e11bee2805aa01360">adapt_mesh</a>(<a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">doc_info</a>);</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a64608ddedb7eb56e11bee2805aa01360">adapt_mesh()</a>, <a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a266f8b2a1499cc2ae7b24b19813923ee">oomph::RefineableMeshBase::doc_info()</a>, <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ab28b03dabf4e247c4a25f834eb11b339">oomph::Mesh::element_pt()</a>, and <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">oomph::Mesh::nelement()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d2f/classExtrudedMovingCylinderProblem.html#aa70de0060cead44454c31eb72538e873">ExtrudedMovingCylinderProblem&lt; TWO_D_ELEMENT, THREE_D_ELEMENT &gt;::create_extruded_mesh()</a>, <a class="el" href="../../d7/d99/two__d__womersley_8cc.html#afeca094704b42e01a52e4bd35c54e8b7">run_navier_stokes_outflow()</a>, and <a class="el" href="../../d1/dfc/classTurekProblem.html#a69f6624fd854393f0c0e5303603ec749">TurekProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;::TurekProblem()</a>.</p>

</div>
</div>
<a id="aab7cbaa680b2258f2b1eea5de6bbe605"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab7cbaa680b2258f2b1eea5de6bbe605">&#9670;&nbsp;</a></span>setup_tree_forest()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void oomph::TreeBasedRefineableMeshBase::setup_tree_forest </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set up the tree forest associated with the Mesh (if any) </p>

<p>Implemented in <a class="el" href="../../dc/dc1/classoomph_1_1RefineableQuadMesh.html#ae3fed75707aa829323aeaf25ac343247">oomph::RefineableQuadMesh&lt; ELEMENT &gt;</a>, <a class="el" href="../../dc/dc1/classoomph_1_1RefineableQuadMesh.html#ae3fed75707aa829323aeaf25ac343247">oomph::RefineableQuadMesh&lt; NST_ELEMENT &gt;</a>, <a class="el" href="../../dc/dc1/classoomph_1_1RefineableQuadMesh.html#ae3fed75707aa829323aeaf25ac343247">oomph::RefineableQuadMesh&lt; AD_ELEMENT &gt;</a>, <a class="el" href="../../d7/d4e/classoomph_1_1RefineableLineMesh.html#a11ee25cace35f302fdf64b623906ea35">oomph::RefineableLineMesh&lt; ELEMENT &gt;</a>, and <a class="el" href="../../de/d14/classoomph_1_1RefineableBrickMesh.html#afdb7af23886c1088ce9dcc855028fb84">oomph::RefineableBrickMesh&lt; ELEMENT &gt;</a>.</p>

</div>
</div>
<a id="a86dace1f78991fb9b401a31215df89ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86dace1f78991fb9b401a31215df89ef">&#9670;&nbsp;</a></span>split_elements_if_required()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void oomph::TreeBasedRefineableMeshBase::split_elements_if_required </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Split all the elements in the mesh if required. This template free interface will be overloaded in RefineableMesh&lt;ELEMENT&gt; so that any new elements that are created will be of the correct type. </p>

<p>Implemented in <a class="el" href="../../d1/d8f/classoomph_1_1TreeBasedRefineableMesh.html#a43f134cb974f25f25d5ddfa88d56ef95">oomph::TreeBasedRefineableMesh&lt; ELEMENT &gt;</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#acef8ac2f0f2cffe938031db1499c598b">adapt_mesh()</a>.</p>

</div>
</div>
<a id="a7514c207f648191b11b70319e1c978d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7514c207f648191b11b70319e1c978d5">&#9670;&nbsp;</a></span>uniform_refinement_level_when_pruned() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&amp; oomph::TreeBasedRefineableMeshBase::uniform_refinement_level_when_pruned </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Level to which the mesh was uniformly refined when it was pruned. </p>
<div class="fragment"><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    {</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a1a69da6d99f1776f53209940d40eaaa3">Uniform_refinement_level_when_pruned</a>;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a1a69da6d99f1776f53209940d40eaaa3">Uniform_refinement_level_when_pruned</a>.</p>

</div>
</div>
<a id="a1ee27bd5bd3c2eded38103b9161af719"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ee27bd5bd3c2eded38103b9161af719">&#9670;&nbsp;</a></span>uniform_refinement_level_when_pruned() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> oomph::TreeBasedRefineableMeshBase::uniform_refinement_level_when_pruned </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Level to which the mesh was uniformly refined when it was pruned (const version) </p>
<div class="fragment"><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    {</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a1a69da6d99f1776f53209940d40eaaa3">Uniform_refinement_level_when_pruned</a>;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a1a69da6d99f1776f53209940d40eaaa3">Uniform_refinement_level_when_pruned</a>.</p>

</div>
</div>
<a id="a52940028ba9f6472df7e7c65be265057"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52940028ba9f6472df7e7c65be265057">&#9670;&nbsp;</a></span>unrefine_uniformly()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> oomph::TreeBasedRefineableMeshBase::unrefine_uniformly </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Unrefine mesh uniformly: Return 0 for success, 1 for failure (if unrefinement has reached the coarsest permitted level)</p>
<p>Unrefine mesh uniformly. Return 0 for success, 1 for failure (if unrefinement has reached the coarsest permitted level) </p>

<p>Implements <a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a5bbd5c85e7c5c9e75c5a28155ac3f956">oomph::RefineableMeshBase</a>.</p>
<div class="fragment"><div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;  {</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;    <span class="comment">// We can&#39;t just select all elements for unrefinement</span></div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;    <span class="comment">// because they need to merge with their brothers.</span></div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;    <span class="comment">// --&gt; Rather than repeating the convoluted logic of</span></div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;    <span class="comment">// RefineableQuadMesh&lt;ELEMENT&gt;::adapt(Vector&lt;double&gt;&amp; elemental_error)</span></div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;    <span class="comment">// here (code duplication!) hack it by filling the error</span></div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;    <span class="comment">// vector with values that ensure unrefinement for all</span></div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;    <span class="comment">// elements where this is possible</span></div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160; </div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;    <span class="comment">// Create dummy vector for elemental errors</span></div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> Nelement = this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">nelement</a>();</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;    Vector&lt;double&gt; elemental_error(Nelement);</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160; </div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;    <span class="comment">// In order to force unrefinement, set the min permitted error to</span></div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;    <span class="comment">// be the default and then set the actual error to be below this.</span></div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;    <span class="comment">// This avoids problems when the actual min error is zero (or small)</span></div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;    <span class="comment">// For sanity&#39;s sake, also set the max permitted error back to the default</span></div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;    <span class="comment">// so that we have a max error bigger than a min error</span></div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> current_min_error = this-&gt;<a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#ad3a13bfaf687135d0154ce2f9b60edb7">min_permitted_error</a>();</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> current_max_error = this-&gt;<a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#adb5ba9ac30bf0a0683eb30f5703800e4">max_permitted_error</a>();</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160; </div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;    this-&gt;<a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#ad3a13bfaf687135d0154ce2f9b60edb7">min_permitted_error</a>() = 1.0e-5;</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;    this-&gt;<a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#adb5ba9ac30bf0a0683eb30f5703800e4">max_permitted_error</a>() = 1.0e-3;</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160; </div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d9/d33/namespacecalibrate.html#a4dbebf21da853ac368a3a9af2fbab442">error</a> = <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#ad3a13bfaf687135d0154ce2f9b60edb7">min_permitted_error</a>() / 100.0;</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; Nelement; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;    {</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;      elemental_error[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>] = <a class="code" href="../../d9/d33/namespacecalibrate.html#a4dbebf21da853ac368a3a9af2fbab442">error</a>;</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;    }</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160; </div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;    <span class="comment">// Temporarily lift any restrictions on the minimum number of</span></div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;    <span class="comment">// elements that need to be unrefined to make it worthwhile</span></div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;    <span class="keywordtype">unsigned</span> backup = <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a2216b4d0a8433a1975e6990a5e6533f7">max_keep_unrefined</a>();</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;    <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a2216b4d0a8433a1975e6990a5e6533f7">max_keep_unrefined</a>() = 0;</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160; </div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;    <span class="comment">// Do the actual mesh adaptation with fake error vector</span></div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;    <a class="code" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#ac98d4120b99d5c6cbcf7225a9ee5648d">adapt</a>(elemental_error);</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160; </div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;    <span class="comment">// Reset the minimum number of elements that need to be unrefined</span></div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;    <span class="comment">// to make it worthwhile</span></div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;    <a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a2216b4d0a8433a1975e6990a5e6533f7">max_keep_unrefined</a>() = backup;</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160; </div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;    <span class="comment">// Now restore the error tolerances</span></div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;    this-&gt;<a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#ad3a13bfaf687135d0154ce2f9b60edb7">min_permitted_error</a>() = current_min_error;</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;    this-&gt;<a class="code" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#adb5ba9ac30bf0a0683eb30f5703800e4">max_permitted_error</a>() = current_max_error;</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160; </div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;    <span class="comment">// Has the unrefinement actually changed anything?</span></div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;    <span class="keywordflow">if</span> (Nelement == this-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">nelement</a>())</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;    {</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;      <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;    }</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;    {</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;      <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;    }</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1TreeBasedRefineableMeshBase_html_ac98d4120b99d5c6cbcf7225a9ee5648d"><div class="ttname"><a href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#ac98d4120b99d5c6cbcf7225a9ee5648d">oomph::TreeBasedRefineableMeshBase::adapt</a></div><div class="ttdeci">void adapt(const Vector&lt; double &gt; &amp;elemental_error)</div><div class="ttdef"><b>Definition:</b> refineable_mesh.cc:307</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#ac98d4120b99d5c6cbcf7225a9ee5648d">adapt()</a>, <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../d9/d33/namespacecalibrate.html#a4dbebf21da853ac368a3a9af2fbab442">calibrate::error</a>, <a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#a2216b4d0a8433a1975e6990a5e6533f7">oomph::RefineableMeshBase::max_keep_unrefined()</a>, <a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#adb5ba9ac30bf0a0683eb30f5703800e4">oomph::RefineableMeshBase::max_permitted_error()</a>, <a class="el" href="../../d4/d54/classoomph_1_1RefineableMeshBase.html#ad3a13bfaf687135d0154ce2f9b60edb7">oomph::RefineableMeshBase::min_permitted_error()</a>, and <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">oomph::Mesh::nelement()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a13548e57b680c5e7466d1deeb8f12ff0">refine_base_mesh()</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="aaf121b2595ff71815c4e9db35247f951"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf121b2595ff71815c4e9db35247f951">&#9670;&nbsp;</a></span>Forest_pt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d2/d36/classoomph_1_1TreeForest.html">TreeForest</a>* oomph::TreeBasedRefineableMeshBase::Forest_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Forest representation of the mesh. </p>

<p class="reference">Referenced by <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#acef8ac2f0f2cffe938031db1499c598b">adapt_mesh()</a>, <a class="el" href="../../d0/ddb/classoomph_1_1ElasticRefineableQuarterPipeMesh.html#a5d90778b3a060b97353b5d9ff5a9dd3d">oomph::ElasticRefineableQuarterPipeMesh&lt; ELEMENT &gt;::ElasticRefineableQuarterPipeMesh()</a>, <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a3c5084830a90bf527a27271613b858a7">forest_pt()</a>, <a class="el" href="../../d1/d8f/classoomph_1_1TreeBasedRefineableMesh.html#aa47363e7700089d4b8756b2339c4893c">oomph::TreeBasedRefineableMesh&lt; ELEMENT &gt;::p_refine_elements_if_required()</a>, <a class="el" href="../../d6/d74/classoomph_1_1RefineableEighthSphereMesh.html#a975d12a45de7356f50bd69f3197659aa">oomph::RefineableEighthSphereMesh&lt; ELEMENT &gt;::RefineableEighthSphereMesh()</a>, <a class="el" href="../../d3/d1e/classoomph_1_1RefineableFullCircleMesh.html#a08abf23ee7b1c7cc3082bcf8aa9fc8c9">oomph::RefineableFullCircleMesh&lt; ELEMENT &gt;::RefineableFullCircleMesh()</a>, <a class="el" href="../../d4/dd0/classoomph_1_1RefineableQuarterPipeMesh.html#ac4b3f592279a2437487ddce284b406a6">oomph::RefineableQuarterPipeMesh&lt; ELEMENT &gt;::RefineableQuarterPipeMesh()</a>, <a class="el" href="../../da/d9a/classoomph_1_1RefineableQuarterTubeMesh.html#a8aaace5bc465614ace0a9117b3ee169c">oomph::RefineableQuarterTubeMesh&lt; ELEMENT &gt;::RefineableQuarterTubeMesh()</a>, <a class="el" href="../../d2/d75/classoomph_1_1RefineableTubeMesh.html#a0b8e2307c2d4594196f78a6278d9bbf7">oomph::RefineableTubeMesh&lt; ELEMENT &gt;::RefineableTubeMesh()</a>, <a class="el" href="../../d7/d4e/classoomph_1_1RefineableLineMesh.html#ac87ad1a1be6f9a9e444acea2e42598ff">oomph::RefineableLineMesh&lt; ELEMENT &gt;::setup_binary_tree_forest()</a>, <a class="el" href="../../de/d14/classoomph_1_1RefineableBrickMesh.html#a7488ae090e09e3f1e01b20a2c2c7a188">oomph::RefineableBrickMesh&lt; ELEMENT &gt;::setup_octree_forest()</a>, <a class="el" href="../../dc/dc1/classoomph_1_1RefineableQuadMesh.html#ab27780da6f9be1b625d75fc4973ce8f1">oomph::RefineableQuadMesh&lt; ELEMENT &gt;::setup_quadtree_forest()</a>, <a class="el" href="../../d1/d8f/classoomph_1_1TreeBasedRefineableMesh.html#a43f134cb974f25f25d5ddfa88d56ef95">oomph::TreeBasedRefineableMesh&lt; ELEMENT &gt;::split_elements_if_required()</a>, <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#aae094b3c6b773c0dbfbeba056c83eac6">TreeBasedRefineableMeshBase()</a>, <a class="el" href="../../d4/dd0/classoomph_1_1RefineableQuarterPipeMesh.html#ad2015da2ae7382f3fe2c3a088f4fa021">oomph::RefineableQuarterPipeMesh&lt; ELEMENT &gt;::~RefineableQuarterPipeMesh()</a>, and <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#ab9edfe81d5b9fc03fbb98c5ff601a260">~TreeBasedRefineableMeshBase()</a>.</p>

</div>
</div>
<a id="a39ab498ac06506e1500f9f03e8cecf72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39ab498ac06506e1500f9f03e8cecf72">&#9670;&nbsp;</a></span>Max_p_refinement_level</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> oomph::TreeBasedRefineableMeshBase::Max_p_refinement_level</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Max. permissible p-refinement level (relative to base mesh) </p>

<p class="reference">Referenced by <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a885171376e32cff058ab2fa4df6ca3c6">doc_adaptivity_targets()</a>, <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a957a33d2b7dd59f8789f4d0e9c6357c2">max_p_refinement_level()</a>, and <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#aae094b3c6b773c0dbfbeba056c83eac6">TreeBasedRefineableMeshBase()</a>.</p>

</div>
</div>
<a id="acd1c5544779f42de66b25a0225644f7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd1c5544779f42de66b25a0225644f7d">&#9670;&nbsp;</a></span>Max_refinement_level</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> oomph::TreeBasedRefineableMeshBase::Max_refinement_level</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Max. permissible refinement level (relative to base mesh) </p>

<p class="reference">Referenced by <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a885171376e32cff058ab2fa4df6ca3c6">doc_adaptivity_targets()</a>, <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a18bf22913dc5daf45fb3995d9ec30bfc">max_refinement_level()</a>, and <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#aae094b3c6b773c0dbfbeba056c83eac6">TreeBasedRefineableMeshBase()</a>.</p>

</div>
</div>
<a id="abd9b33d333c11837b3d2dbca163b6320"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd9b33d333c11837b3d2dbca163b6320">&#9670;&nbsp;</a></span>Min_p_refinement_level</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> oomph::TreeBasedRefineableMeshBase::Min_p_refinement_level</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Min. permissible p-refinement level (relative to base mesh) </p>

<p class="reference">Referenced by <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a885171376e32cff058ab2fa4df6ca3c6">doc_adaptivity_targets()</a>, <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a42486bb8abcb77663adc361eaa442a3b">min_p_refinement_level()</a>, and <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#aae094b3c6b773c0dbfbeba056c83eac6">TreeBasedRefineableMeshBase()</a>.</p>

</div>
</div>
<a id="af48df64966833ed693c11576ff28ada1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af48df64966833ed693c11576ff28ada1">&#9670;&nbsp;</a></span>Min_refinement_level</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> oomph::TreeBasedRefineableMeshBase::Min_refinement_level</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Min. permissible refinement level (relative to base mesh) </p>

<p class="reference">Referenced by <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a885171376e32cff058ab2fa4df6ca3c6">doc_adaptivity_targets()</a>, <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#af3974421171e1bb10daf6864f0749675">min_refinement_level()</a>, and <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#aae094b3c6b773c0dbfbeba056c83eac6">TreeBasedRefineableMeshBase()</a>.</p>

</div>
</div>
<a id="a1a69da6d99f1776f53209940d40eaaa3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a69da6d99f1776f53209940d40eaaa3">&#9670;&nbsp;</a></span>Uniform_refinement_level_when_pruned</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> oomph::TreeBasedRefineableMeshBase::Uniform_refinement_level_when_pruned</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Level to which the mesh was uniformly refined when it was pruned. </p>

<p class="reference">Referenced by <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#aae094b3c6b773c0dbfbeba056c83eac6">TreeBasedRefineableMeshBase()</a>, and <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a1ee27bd5bd3c2eded38103b9161af719">uniform_refinement_level_when_pruned()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="../../d6/d40/refineable__mesh_8h_source.html">refineable_mesh.h</a></li>
<li><a class="el" href="../../d5/dd0/refineable__mesh_8cc.html">refineable_mesh.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../da/ddf/namespaceoomph.html">oomph</a></li><li class="navelem"><a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html">TreeBasedRefineableMeshBase</a></li>
    <li class="footer">Generated on Wed Aug 27 2025 17:09:12 for MercuryDPM by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
