<!-- HTML header for doxygen 1.8.18-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MercuryDPM: oomph::AlgebraicElementBase Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../MDPM.css" rel="stylesheet" type="text/css"/>
<link href="../../codeLabels.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-fork-corner.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-dropdown-version.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../MDPM-fragment-copy-button.js"></script>
<script type="text/javascript">
DoxygenAwesomeFragmentCopyButton.init()
</script>
<script type="text/javascript" src="../../MDPM-paragraph-link.js"></script>
<script type="text/javascript">
DoxygenAwesomeParagraphLink.init()
</script>
<script type="text/javascript" src="../../MDPM-interactive-toc.js"></script>
<script type="text/javascript">
DoxygenAwesomeInteractiveToc.init()
</script>
<script type="text/javascript" src="../../MDPM-darkmode-toggle.js"></script>
<script type="text/javascript">
DoxygenAwesomeDarkModeToggle.init()
</script>
</head>
<body>
  <div id="bitbucket-corner">
   <a href="https://bitbucket.org/mercurydpm/mercurydpm/src/master/" target="_blank" id="fork-corner" class="fork-corner fc-pos-tr fc-animate fc-theme-bitbucket"></a>
  </div>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../mercury-logo-chosen-light-slogan.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"> <!--MercuryDPM--!>
   <!-- BEGIN version select -->
   <div class="dropdown" id="projectnumber">
    <button class="dropbtn">v1.0</button>
    <div class="dropdown-content">
    </div>
   </div>
   <script type="text/javascript" src="../../MDPM-dropdown-version.js"></script>
<!-- END version select -->
   <!--&#160;<span id="projectnumber">revision: v1.0</span>-->
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<script type="text/javascript" src="../../MDPM-fork-corner.js"></script>
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d0/dba/classoomph_1_1AlgebraicElementBase.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="../../d3/d58/classoomph_1_1AlgebraicElementBase-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">oomph::AlgebraicElementBase Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="../../d6/d52/algebraic__elements_8h_source.html">algebraic_elements.h</a>&gt;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Inheritance diagram for oomph::AlgebraicElementBase:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
 <div class="center">
  <img src="../../d0/dba/classoomph_1_1AlgebraicElementBase.png" usemap="#oomph::AlgebraicElementBase_map" alt=""/>
  <map id="oomph::AlgebraicElementBase_map" name="oomph::AlgebraicElementBase_map">
<area href="../../d2/d40/classoomph_1_1AlgebraicElement.html" alt="oomph::AlgebraicElement&lt; ELEMENT &gt;" shape="rect" coords="0,56,236,80"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ac94e4a7116416add9539def19791f1b4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dba/classoomph_1_1AlgebraicElementBase.html#ac94e4a7116416add9539def19791f1b4">AlgebraicElementBase</a> ()</td></tr>
<tr class="memdesc:ac94e4a7116416add9539def19791f1b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Empty constructor.  <a href="../../d0/dba/classoomph_1_1AlgebraicElementBase.html#ac94e4a7116416add9539def19791f1b4">More...</a><br /></td></tr>
<tr class="separator:ac94e4a7116416add9539def19791f1b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41d5b00c6c83584994d378465fcd6dce"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dba/classoomph_1_1AlgebraicElementBase.html#a41d5b00c6c83584994d378465fcd6dce">AlgebraicElementBase</a> (const <a class="el" href="../../d0/dba/classoomph_1_1AlgebraicElementBase.html">AlgebraicElementBase</a> &amp;)=delete</td></tr>
<tr class="memdesc:a41d5b00c6c83584994d378465fcd6dce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken copy constructor.  <a href="../../d0/dba/classoomph_1_1AlgebraicElementBase.html#a41d5b00c6c83584994d378465fcd6dce">More...</a><br /></td></tr>
<tr class="separator:a41d5b00c6c83584994d378465fcd6dce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5382e00534e9afb9aafbe6e7a1a730bb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dba/classoomph_1_1AlgebraicElementBase.html#a5382e00534e9afb9aafbe6e7a1a730bb">operator=</a> (const <a class="el" href="../../d0/dba/classoomph_1_1AlgebraicElementBase.html">AlgebraicElementBase</a> &amp;)=delete</td></tr>
<tr class="memdesc:a5382e00534e9afb9aafbe6e7a1a730bb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken assignment operator.  <a href="../../d0/dba/classoomph_1_1AlgebraicElementBase.html#a5382e00534e9afb9aafbe6e7a1a730bb">More...</a><br /></td></tr>
<tr class="separator:a5382e00534e9afb9aafbe6e7a1a730bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9ada27015d5cb28ae00b086ace3600f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dba/classoomph_1_1AlgebraicElementBase.html#ab9ada27015d5cb28ae00b086ace3600f">setup_algebraic_node_update</a> (<a class="el" href="../../dc/db7/classoomph_1_1Node.html">Node</a> *&amp;node_pt, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;s_father, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html">FiniteElement</a> *father_el_pt) const</td></tr>
<tr class="separator:ab9ada27015d5cb28ae00b086ace3600f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>//////////////////////////////////////////////////////////////////// //////////////////////////////////////////////////////////////////// //////////////////////////////////////////////////////////////////// //////////////////////////////////////////////////////////////////// Base class for algebraic elements. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ac94e4a7116416add9539def19791f1b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac94e4a7116416add9539def19791f1b4">&#9670;&nbsp;</a></span>AlgebraicElementBase() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">oomph::AlgebraicElementBase::AlgebraicElementBase </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Empty constructor. </p>
<div class="fragment"><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;{}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a41d5b00c6c83584994d378465fcd6dce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41d5b00c6c83584994d378465fcd6dce">&#9670;&nbsp;</a></span>AlgebraicElementBase() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">oomph::AlgebraicElementBase::AlgebraicElementBase </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/dba/classoomph_1_1AlgebraicElementBase.html">AlgebraicElementBase</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Broken copy constructor. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a5382e00534e9afb9aafbe6e7a1a730bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5382e00534e9afb9aafbe6e7a1a730bb">&#9670;&nbsp;</a></span>operator=()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::AlgebraicElementBase::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/dba/classoomph_1_1AlgebraicElementBase.html">AlgebraicElementBase</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Broken assignment operator. </p>

</div>
</div>
<a id="ab9ada27015d5cb28ae00b086ace3600f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9ada27015d5cb28ae00b086ace3600f">&#9670;&nbsp;</a></span>setup_algebraic_node_update()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::AlgebraicElementBase::setup_algebraic_node_update </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dc/db7/classoomph_1_1Node.html">Node</a> *&amp;&#160;</td>
          <td class="paramname"><em>node_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>s_father</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html">FiniteElement</a> *&#160;</td>
          <td class="paramname"><em>father_el_pt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set up node update info for (newly created) algebraic node: I.e. work out its node update information by interpolation from the father element. Pass pointer to father element and the newly created node's local coordinate in the father element.</p>
<p>//////////////////////////////////////////////////////////////////// //////////////////////////////////////////////////////////////////// //////////////////////////////////////////////////////////////////// //////////////////////////////////////////////////////////////////// Set up node update info for (newly created) algebraic node: Work out its node update information by interpolation from its father element, based on pointer to father element and its local coordinate in the father element. We're creating the node update info for update functions that are shared by all nodes in the father element. </p>
<p>Now loop over the ids and check if they appear in all nodes</p>
<div class="fragment"><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="comment">// Turn node into algebraic node</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    AlgebraicNode* alg_node_pt = <span class="keyword">dynamic_cast&lt;</span>AlgebraicNode*<span class="keyword">&gt;</span>(node_pt);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="comment">// Get number of nodes in father element</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordtype">unsigned</span> nnod_father = father_el_pt-&gt;nnode();</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="comment">// Create map that stores the number of times a node update fct id</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="comment">// has been encountered</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    std::map&lt;int, unsigned&gt; id_count;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="comment">// Loop over all nodes in father element to extract node update ids</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    Vector&lt;int&gt; id;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; nnod_father; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      <span class="comment">// Get vector of ids and add them to map</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      <span class="keyword">dynamic_cast&lt;</span>AlgebraicNode*<span class="keyword">&gt;</span>(father_el_pt-&gt;node_pt(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>))</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        -&gt;node_update_fct_id(<span class="keywordtype">id</span>);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      <span class="keywordtype">unsigned</span> n_id = <span class="keywordtype">id</span>.size();</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_id; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        id_count[<span class="keywordtype">id</span>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]]++;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      }</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    }</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    Vector&lt;int&gt; shared_ids;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keyword">typedef</span> std::map&lt;int, unsigned&gt;::iterator IT;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keywordflow">for</span> (IT it = id_count.begin(); it != id_count.end(); it++)</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <span class="keywordflow">if</span> (it-&gt;second == nnod_father)</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      {</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        shared_ids.push_back(it-&gt;first);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      }</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    }</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="comment">// How many update functions we have?</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordtype">unsigned</span> n_update_id = shared_ids.size();</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="comment">// Loop over all node udate functions -- since it&#39;s shared by</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="comment">// nodes we may as well read the required data  from the first</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="comment">// node in the father.</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    AlgebraicNode* father_node_pt =</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <span class="keyword">dynamic_cast&lt;</span>AlgebraicNode*<span class="keyword">&gt;</span>(father_el_pt-&gt;node_pt(0));</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_update_id; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      <span class="comment">// Actual id:</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <span class="keywordtype">int</span> <span class="keywordtype">id</span> = shared_ids[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      <span class="comment">// Is this a real update fct or the default dummy one?</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      <span class="keywordflow">if</span> (<span class="keywordtype">id</span> &gt;= 0)</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="comment">// Get vector of geometric objects involved in specified node update</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="comment">// function (create vector by copy operation)</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        Vector&lt;GeomObject*&gt; geom_obj_pt(</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;          father_node_pt-&gt;vector_geom_object_pt(<span class="keywordtype">id</span>));</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="comment">// Loop over reference values and obtain the</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="comment">// ones for the current (son) element by interpolation from</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <span class="comment">// the father</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="comment">// Number of reference values for this udpate function</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="keywordtype">unsigned</span> nvalue = father_node_pt-&gt;nref_value(<span class="keywordtype">id</span>);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        Vector&lt;double&gt; ref_value(nvalue);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="comment">// Set up the shape functions in father element</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        Shape psi(nnod_father);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="comment">// Get shape functions in father element</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        father_el_pt-&gt;shape(s_father, psi);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <span class="comment">// Initialise reference values</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ivalue = 0; ivalue &lt; nvalue; ivalue++)</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;          ref_value[ivalue] = 0.0;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="comment">// Loop over all nodes in father element for</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <span class="comment">// interpolation of nodes -- don&#39;t need to</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="comment">// worry about hanging nodes here as reference values</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="comment">// are only assigned once and then in a consistent way</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j_father = 0; j_father &lt; nnod_father; j_father++)</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;          <span class="comment">// Get reference values at node in father by copy operation</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;          Vector&lt;double&gt; father_ref_value(</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            <span class="keyword">dynamic_cast&lt;</span>AlgebraicNode*<span class="keyword">&gt;</span>(father_el_pt-&gt;node_pt(j_father))</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;              -&gt;vector_ref_value(<span class="keywordtype">id</span>));</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;          <span class="comment">// Loop over reference values</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ivalue = 0; ivalue &lt; nvalue; ivalue++)</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;          {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            ref_value[ivalue] += father_ref_value[ivalue] * psi(j_father);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;          }</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        }</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="comment">// Get mesh that implements the update operation</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        AlgebraicMesh* mesh_pt = father_node_pt-&gt;mesh_pt(<span class="keywordtype">id</span>);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="comment">// Setup node update info for node</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        alg_node_pt-&gt;add_node_update_info(<span class="keywordtype">id</span>, <span class="comment">// id</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                                          mesh_pt, <span class="comment">// mesh</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                                          geom_obj_pt, <span class="comment">// vector of geom objects</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                                          ref_value); <span class="comment">// vector of ref. values</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="comment">// Update the geometric references (e.g. in FSI) if required</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        mesh_pt-&gt;update_node_update(alg_node_pt);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      } <span class="comment">// endif for real vs. default dummy node update fct</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    } <span class="comment">// end of loop over different update fcts</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="comment">// Update the node at its current and previous positions</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordtype">bool</span> update_all_time_levels_for_new_node = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    alg_node_pt-&gt;node_update(update_all_time_levels_for_new_node);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  }</div>
<div class="ttc" id="aBiCGSTAB__step__by__step_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> BiCGSTAB_step_by_step.cpp:9</div></div>
<div class="ttc" id="atut__arithmetic__redux__minmax_8cpp_html_a39513f0f8d942bf9ef17b2e87ac6d34e"><div class="ttname"><a href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a></div><div class="ttdeci">std::ptrdiff_t j</div><div class="ttdef"><b>Definition:</b> tut_arithmetic_redux_minmax.cpp:2</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/d14/classoomph_1_1AlgebraicNode.html#ac6bd268c80889507d92431a4638eb85c">oomph::AlgebraicNode::add_node_update_info()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../d4/d14/classoomph_1_1AlgebraicNode.html#a929a96691397e1990fdf785dfcea5c07">oomph::AlgebraicNode::mesh_pt()</a>, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a6219ed269a6d89b5aa14659cce48905a">oomph::FiniteElement::nnode()</a>, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a28ae3eb7760edc5c9d6427611d8e6fb6">oomph::FiniteElement::node_pt()</a>, <a class="el" href="../../d4/d14/classoomph_1_1AlgebraicNode.html#a754dc8fcac3382a07f60262c9792c84c">oomph::AlgebraicNode::node_update()</a>, <a class="el" href="../../d4/d14/classoomph_1_1AlgebraicNode.html#a18b508012bc638d85539568219865383">oomph::AlgebraicNode::nref_value()</a>, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a58a25b6859ddd43b7bfe64a19fee5023">oomph::FiniteElement::shape()</a>, <a class="el" href="../../d0/d8e/classoomph_1_1AlgebraicMesh.html#a6c6a35ae2be6e2766f5b80d85693c1ce">oomph::AlgebraicMesh::update_node_update()</a>, <a class="el" href="../../d4/d14/classoomph_1_1AlgebraicNode.html#aa82f9b47f4b7fb1cc49178c48c2873d3">oomph::AlgebraicNode::vector_geom_object_pt()</a>, and <a class="el" href="../../d4/d14/classoomph_1_1AlgebraicNode.html#ad2236d78dd07f59345ee7a8275d3fefb">oomph::AlgebraicNode::vector_ref_value()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d9/dbc/classoomph_1_1RefineableQElement_3_013_01_4.html#ac085ca58b7eefb81628275e2b7ab07ce">oomph::RefineableQElement&lt; 3 &gt;::build()</a>, <a class="el" href="../../d6/d96/classoomph_1_1RefineableQElement_3_011_01_4.html#a32262f8b505be28cd71022fc27746a03">oomph::RefineableQElement&lt; 1 &gt;::build()</a>, <a class="el" href="../../d6/d5d/classoomph_1_1RefineableQElement_3_012_01_4.html#a1226bff1b077a092766cedc2a12a350f">oomph::RefineableQElement&lt; 2 &gt;::build()</a>, <a class="el" href="../../d4/d6f/classoomph_1_1PRefineableQElement_3_011_00_01INITIAL__NNODE__1D_01_4.html#ab3210a40d15dd21dd3befee2220eca95">oomph::PRefineableQElement&lt; 1, INITIAL_NNODE_1D &gt;::p_refine()</a>, <a class="el" href="../../d8/dd8/classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4.html#aa74bd994a95736da7c0c92297959b026">oomph::PRefineableQElement&lt; 2, INITIAL_NNODE_1D &gt;::p_refine()</a>, and <a class="el" href="../../da/d90/classoomph_1_1PRefineableQElement_3_013_00_01INITIAL__NNODE__1D_01_4.html#a27dcd49d1188203b52a0c482a5466ba6">oomph::PRefineableQElement&lt; 3, INITIAL_NNODE_1D &gt;::p_refine()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="../../d6/d52/algebraic__elements_8h_source.html">algebraic_elements.h</a></li>
<li><a class="el" href="../../d6/d3b/algebraic__elements_8cc.html">algebraic_elements.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../da/ddf/namespaceoomph.html">oomph</a></li><li class="navelem"><a class="el" href="../../d0/dba/classoomph_1_1AlgebraicElementBase.html">AlgebraicElementBase</a></li>
    <li class="footer">Generated on Wed Aug 27 2025 17:09:00 for MercuryDPM by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
