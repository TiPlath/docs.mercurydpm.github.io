<!-- HTML header for doxygen 1.8.18-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MercuryDPM: oomph::PitchForkHandler Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../MDPM.css" rel="stylesheet" type="text/css"/>
<link href="../../codeLabels.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-fork-corner.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-dropdown-version.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../MDPM-fragment-copy-button.js"></script>
<script type="text/javascript">
DoxygenAwesomeFragmentCopyButton.init()
</script>
<script type="text/javascript" src="../../MDPM-paragraph-link.js"></script>
<script type="text/javascript">
DoxygenAwesomeParagraphLink.init()
</script>
<script type="text/javascript" src="../../MDPM-interactive-toc.js"></script>
<script type="text/javascript">
DoxygenAwesomeInteractiveToc.init()
</script>
<script type="text/javascript" src="../../MDPM-darkmode-toggle.js"></script>
<script type="text/javascript">
DoxygenAwesomeDarkModeToggle.init()
</script>
</head>
<body>
  <div id="bitbucket-corner">
   <a href="https://bitbucket.org/mercurydpm/mercurydpm/src/master/" target="_blank" id="fork-corner" class="fork-corner fc-pos-tr fc-animate fc-theme-bitbucket"></a>
  </div>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../mercury-logo-chosen-light-slogan.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"> <!--MercuryDPM--!>
   <!-- BEGIN version select -->
   <div class="dropdown" id="projectnumber">
    <button class="dropbtn">v1.0</button>
    <div class="dropdown-content">
    </div>
   </div>
   <script type="text/javascript" src="../../MDPM-dropdown-version.js"></script>
<!-- END version select -->
   <!--&#160;<span id="projectnumber">revision: v1.0</span>-->
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<script type="text/javascript" src="../../MDPM-fork-corner.js"></script>
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d1/d08/classoomph_1_1PitchForkHandler.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-types">Private Types</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="../../d3/d92/classoomph_1_1PitchForkHandler-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">oomph::PitchForkHandler Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="../../d3/d3a/assembly__handler_8h_source.html">assembly_handler.h</a>&gt;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Inheritance diagram for oomph::PitchForkHandler:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
 <div class="center">
  <img src="../../d1/d08/classoomph_1_1PitchForkHandler.png" usemap="#oomph::PitchForkHandler_map" alt=""/>
  <map id="oomph::PitchForkHandler_map" name="oomph::PitchForkHandler_map">
<area href="../../d4/db6/classoomph_1_1AssemblyHandler.html" alt="oomph::AssemblyHandler" shape="rect" coords="0,0,154,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a96e0343c261d087f5d67a49f68561d96"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a96e0343c261d087f5d67a49f68561d96">PitchForkHandler</a> (<a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *const &amp;problem_pt, <a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html">AssemblyHandler</a> *const &amp;assembly_handler_pt, <a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;parameter_pt, const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;symmetry_vector)</td></tr>
<tr class="memdesc:a96e0343c261d087f5d67a49f68561d96"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor, initialise the systems.  <a href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a96e0343c261d087f5d67a49f68561d96">More...</a><br /></td></tr>
<tr class="separator:a96e0343c261d087f5d67a49f68561d96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69c6b0b6aedd03d828d295531fd61820"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a69c6b0b6aedd03d828d295531fd61820">~PitchForkHandler</a> ()</td></tr>
<tr class="memdesc:a69c6b0b6aedd03d828d295531fd61820"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor return the problem to its original (non-augmented) state.  <a href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a69c6b0b6aedd03d828d295531fd61820">More...</a><br /></td></tr>
<tr class="separator:a69c6b0b6aedd03d828d295531fd61820"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae066fa45e9f1bf10601286ca2d083a42"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ae066fa45e9f1bf10601286ca2d083a42">ndof</a> (<a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html">GeneralisedElement</a> *const &amp;elem_pt)</td></tr>
<tr class="memdesc:ae066fa45e9f1bf10601286ca2d083a42"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the number of elemental degrees of freedom.  <a href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ae066fa45e9f1bf10601286ca2d083a42">More...</a><br /></td></tr>
<tr class="separator:ae066fa45e9f1bf10601286ca2d083a42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab29e58e25bd5bebd836e30015f01ac8d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ab29e58e25bd5bebd836e30015f01ac8d">eqn_number</a> (<a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html">GeneralisedElement</a> *const &amp;elem_pt, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;ieqn_local)</td></tr>
<tr class="memdesc:ab29e58e25bd5bebd836e30015f01ac8d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the global equation number of the local unknown.  <a href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ab29e58e25bd5bebd836e30015f01ac8d">More...</a><br /></td></tr>
<tr class="separator:ab29e58e25bd5bebd836e30015f01ac8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a461b24284da88b9489d720e484a6925c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a461b24284da88b9489d720e484a6925c">get_residuals</a> (<a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html">GeneralisedElement</a> *const &amp;elem_pt, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;residuals)</td></tr>
<tr class="memdesc:a461b24284da88b9489d720e484a6925c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the residuals.  <a href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a461b24284da88b9489d720e484a6925c">More...</a><br /></td></tr>
<tr class="separator:a461b24284da88b9489d720e484a6925c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6728813a099111bee2b6c79dec20fc4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aa6728813a099111bee2b6c79dec20fc4">get_jacobian</a> (<a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html">GeneralisedElement</a> *const &amp;elem_pt, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;residuals, <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;jacobian)</td></tr>
<tr class="separator:aa6728813a099111bee2b6c79dec20fc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6510803afcbcfce1ae5b1c1c5d82a541"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a6510803afcbcfce1ae5b1c1c5d82a541">get_dresiduals_dparameter</a> (<a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html">GeneralisedElement</a> *const &amp;elem_pt, <a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;parameter_pt, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;dres_dparam)</td></tr>
<tr class="memdesc:a6510803afcbcfce1ae5b1c1c5d82a541"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the derivatives of the residuals with respect to a parameter.  <a href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a6510803afcbcfce1ae5b1c1c5d82a541">More...</a><br /></td></tr>
<tr class="separator:a6510803afcbcfce1ae5b1c1c5d82a541"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa16d6770f6d46b7db4101f417373b191"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aa16d6770f6d46b7db4101f417373b191">get_djacobian_dparameter</a> (<a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html">GeneralisedElement</a> *const &amp;elem_pt, <a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;parameter_pt, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;dres_dparam, <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;djac_dparam)</td></tr>
<tr class="separator:aa16d6770f6d46b7db4101f417373b191"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85e7dba2d21c9fe95a575a115cf3ee9f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a85e7dba2d21c9fe95a575a115cf3ee9f">get_hessian_vector_products</a> (<a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html">GeneralisedElement</a> *const &amp;elem_pt, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; const &amp;<a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a289ce15584734b8ea50cd9a7f7f430ed">Y</a>, <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; const &amp;<a class="el" href="../../d8/d3e/bench__gemm_8cpp.html#a3a8dbf45d202c92cb1786477c8315262">C</a>, <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../dc/daa/product_8h.html#a9ea93a3bb5ed3a3517d5db341bae0238">product</a>)</td></tr>
<tr class="separator:a85e7dba2d21c9fe95a575a115cf3ee9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadc4f0b5dfb82cf171b91432536d1679"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aadc4f0b5dfb82cf171b91432536d1679">bifurcation_type</a> () const</td></tr>
<tr class="separator:aadc4f0b5dfb82cf171b91432536d1679"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7363cb34d716d64d891af5018e09d807"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a7363cb34d716d64d891af5018e09d807">bifurcation_parameter_pt</a> () const</td></tr>
<tr class="separator:a7363cb34d716d64d891af5018e09d807"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d5e1388fe0ede6834a249b98168b71a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a9d5e1388fe0ede6834a249b98168b71a">get_eigenfunction</a> (<a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &gt; &amp;eigenfunction)</td></tr>
<tr class="separator:a9d5e1388fe0ede6834a249b98168b71a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0b0920383bcbdab5df1f43db5affa47"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ad0b0920383bcbdab5df1f43db5affa47">solve_augmented_block_system</a> ()</td></tr>
<tr class="memdesc:ad0b0920383bcbdab5df1f43db5affa47"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set to solve the augmented block system.  <a href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ad0b0920383bcbdab5df1f43db5affa47">More...</a><br /></td></tr>
<tr class="separator:ad0b0920383bcbdab5df1f43db5affa47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad193c3d67741edd60b023c94e42c8802"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ad193c3d67741edd60b023c94e42c8802">solve_block_system</a> ()</td></tr>
<tr class="memdesc:ad193c3d67741edd60b023c94e42c8802"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set to solve the block system.  <a href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ad193c3d67741edd60b023c94e42c8802">More...</a><br /></td></tr>
<tr class="separator:ad193c3d67741edd60b023c94e42c8802"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27325616f4342d159f6f5e7c82ccdf98"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a27325616f4342d159f6f5e7c82ccdf98">solve_full_system</a> ()</td></tr>
<tr class="memdesc:a27325616f4342d159f6f5e7c82ccdf98"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solve non-block system.  <a href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a27325616f4342d159f6f5e7c82ccdf98">More...</a><br /></td></tr>
<tr class="separator:a27325616f4342d159f6f5e7c82ccdf98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classoomph_1_1AssemblyHandler"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classoomph_1_1AssemblyHandler')"><img src="../../closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html">oomph::AssemblyHandler</a></td></tr>
<tr class="memitem:af3ab79744dce0b50370defdbf7981691 inherit pub_methods_classoomph_1_1AssemblyHandler"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#af3ab79744dce0b50370defdbf7981691">AssemblyHandler</a> ()</td></tr>
<tr class="memdesc:af3ab79744dce0b50370defdbf7981691 inherit pub_methods_classoomph_1_1AssemblyHandler"><td class="mdescLeft">&#160;</td><td class="mdescRight">Empty constructor.  <a href="../../d4/db6/classoomph_1_1AssemblyHandler.html#af3ab79744dce0b50370defdbf7981691">More...</a><br /></td></tr>
<tr class="separator:af3ab79744dce0b50370defdbf7981691 inherit pub_methods_classoomph_1_1AssemblyHandler"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfd15243fce76ce8f1ea0248c700a3f4 inherit pub_methods_classoomph_1_1AssemblyHandler"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#abfd15243fce76ce8f1ea0248c700a3f4">dof_vector</a> (<a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html">GeneralisedElement</a> *const &amp;elem_pt, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;t, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;dof)</td></tr>
<tr class="memdesc:abfd15243fce76ce8f1ea0248c700a3f4 inherit pub_methods_classoomph_1_1AssemblyHandler"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return vector of dofs at time level t in the element elem_pt.  <a href="../../d4/db6/classoomph_1_1AssemblyHandler.html#abfd15243fce76ce8f1ea0248c700a3f4">More...</a><br /></td></tr>
<tr class="separator:abfd15243fce76ce8f1ea0248c700a3f4 inherit pub_methods_classoomph_1_1AssemblyHandler"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe6002d5703a93b3b147de79508c5719 inherit pub_methods_classoomph_1_1AssemblyHandler"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#afe6002d5703a93b3b147de79508c5719">dof_pt_vector</a> (<a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html">GeneralisedElement</a> *const &amp;elem_pt, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> * &gt; &amp;dof_pt)</td></tr>
<tr class="memdesc:afe6002d5703a93b3b147de79508c5719 inherit pub_methods_classoomph_1_1AssemblyHandler"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return vector of pointers to dofs in the element elem_pt.  <a href="../../d4/db6/classoomph_1_1AssemblyHandler.html#afe6002d5703a93b3b147de79508c5719">More...</a><br /></td></tr>
<tr class="separator:afe6002d5703a93b3b147de79508c5719 inherit pub_methods_classoomph_1_1AssemblyHandler"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab61559fc5df46871c1eebd103f7bf08b inherit pub_methods_classoomph_1_1AssemblyHandler"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#ab61559fc5df46871c1eebd103f7bf08b">local_problem_dof</a> (<a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *const &amp;problem_pt, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;t, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>)</td></tr>
<tr class="separator:ab61559fc5df46871c1eebd103f7bf08b inherit pub_methods_classoomph_1_1AssemblyHandler"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67093ef481c51d384606486c41002baa inherit pub_methods_classoomph_1_1AssemblyHandler"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a67093ef481c51d384606486c41002baa">get_all_vectors_and_matrices</a> (<a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html">GeneralisedElement</a> *const &amp;elem_pt, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt;&gt; &amp;vec, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt;&gt; &amp;<a class="el" href="../../da/d67/level3__impl_8h.html#a21849b14ce38b5bc40d43a5782d89138">matrix</a>)</td></tr>
<tr class="separator:a67093ef481c51d384606486c41002baa inherit pub_methods_classoomph_1_1AssemblyHandler"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9c8bb0e9a66d031283bf37571be2524 inherit pub_methods_classoomph_1_1AssemblyHandler"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#ab9c8bb0e9a66d031283bf37571be2524">get_inner_products</a> (<a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html">GeneralisedElement</a> *const &amp;elem_pt, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; std::pair&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>, <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt;&gt; const &amp;history_index, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;inner_product)</td></tr>
<tr class="separator:ab9c8bb0e9a66d031283bf37571be2524 inherit pub_methods_classoomph_1_1AssemblyHandler"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc7da94d31606a6212a5106a36d91961 inherit pub_methods_classoomph_1_1AssemblyHandler"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#afc7da94d31606a6212a5106a36d91961">get_inner_product_vectors</a> (<a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html">GeneralisedElement</a> *const &amp;elem_pt, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; const &amp;history_index, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt;&gt; &amp;inner_product_vector)</td></tr>
<tr class="separator:afc7da94d31606a6212a5106a36d91961 inherit pub_methods_classoomph_1_1AssemblyHandler"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab26633238200230ab57a20cc49e731de inherit pub_methods_classoomph_1_1AssemblyHandler"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#ab26633238200230ab57a20cc49e731de">~AssemblyHandler</a> ()</td></tr>
<tr class="memdesc:ab26633238200230ab57a20cc49e731de inherit pub_methods_classoomph_1_1AssemblyHandler"><td class="mdescLeft">&#160;</td><td class="mdescRight">Empty virtual destructor.  <a href="../../d4/db6/classoomph_1_1AssemblyHandler.html#ab26633238200230ab57a20cc49e731de">More...</a><br /></td></tr>
<tr class="separator:ab26633238200230ab57a20cc49e731de inherit pub_methods_classoomph_1_1AssemblyHandler"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-types"></a>
Private Types</h2></td></tr>
<tr class="memitem:a4f9249832460e1583d537ab9e2872c93"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93a0e7d0b0eb06a1f2d90a3ab2831bec36d">Full_augmented</a>
, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93ae729c94eb567cd88e0b33dc29d9f8d5d">Block_J</a>
, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93ac8e196e66210e158988de0bfebcdf6a5">Block_augmented_J</a>
 }</td></tr>
<tr class="separator:a4f9249832460e1583d537ab9e2872c93"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:ac1a4bbb1415a009e9f176f16263fcb3e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ac1a4bbb1415a009e9f176f16263fcb3e">global_eqn_number</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>)</td></tr>
<tr class="separator:ac1a4bbb1415a009e9f176f16263fcb3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a614de1eea213de58687ed161fc7c53ae"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a614de1eea213de58687ed161fc7c53ae">Solve_which_system</a></td></tr>
<tr class="separator:a614de1eea213de58687ed161fc7c53ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a196adc8e79a66292d2df9bd9093f8f73"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a></td></tr>
<tr class="memdesc:a196adc8e79a66292d2df9bd9093f8f73"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to the problem.  <a href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">More...</a><br /></td></tr>
<tr class="separator:a196adc8e79a66292d2df9bd9093f8f73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40358960131e00efd6bd0febd397a3ef"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html">AssemblyHandler</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a40358960131e00efd6bd0febd397a3ef">Assembly_handler_pt</a></td></tr>
<tr class="memdesc:a40358960131e00efd6bd0febd397a3ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to the underlying (original) assembly handler.  <a href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a40358960131e00efd6bd0febd397a3ef">More...</a><br /></td></tr>
<tr class="separator:a40358960131e00efd6bd0febd397a3ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9314a176be55e7e9c5a359accfbec751"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a9314a176be55e7e9c5a359accfbec751">Ndof</a></td></tr>
<tr class="separator:a9314a176be55e7e9c5a359accfbec751"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a075f47b5f8941d25796f96d258a1752e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a075f47b5f8941d25796f96d258a1752e">Dof_distribution_pt</a></td></tr>
<tr class="memdesc:a075f47b5f8941d25796f96d258a1752e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Store the original dof distribution.  <a href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a075f47b5f8941d25796f96d258a1752e">More...</a><br /></td></tr>
<tr class="separator:a075f47b5f8941d25796f96d258a1752e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6346c1dc77f3d4fb3dc8950afd91e0f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#af6346c1dc77f3d4fb3dc8950afd91e0f">Augmented_dof_distribution_pt</a></td></tr>
<tr class="memdesc:af6346c1dc77f3d4fb3dc8950afd91e0f"><td class="mdescLeft">&#160;</td><td class="mdescRight">The augmented distribution.  <a href="../../d1/d08/classoomph_1_1PitchForkHandler.html#af6346c1dc77f3d4fb3dc8950afd91e0f">More...</a><br /></td></tr>
<tr class="separator:af6346c1dc77f3d4fb3dc8950afd91e0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56a173cbdf59e73728c9c1b8c5221817"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a56a173cbdf59e73728c9c1b8c5221817">Sigma</a></td></tr>
<tr class="separator:a56a173cbdf59e73728c9c1b8c5221817"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a289ce15584734b8ea50cd9a7f7f430ed"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html">DoubleVectorWithHaloEntries</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a289ce15584734b8ea50cd9a7f7f430ed">Y</a></td></tr>
<tr class="memdesc:a289ce15584734b8ea50cd9a7f7f430ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Storage for the null vector.  <a href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a289ce15584734b8ea50cd9a7f7f430ed">More...</a><br /></td></tr>
<tr class="separator:a289ce15584734b8ea50cd9a7f7f430ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa04d0f340d919d4da3f9199eb76649b1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html">DoubleVectorWithHaloEntries</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aa04d0f340d919d4da3f9199eb76649b1">Psi</a></td></tr>
<tr class="memdesc:aa04d0f340d919d4da3f9199eb76649b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">A constant vector that is specifies the symmetry being broken.  <a href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aa04d0f340d919d4da3f9199eb76649b1">More...</a><br /></td></tr>
<tr class="separator:aa04d0f340d919d4da3f9199eb76649b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88f5df169c44b02f4ba563cf42241599"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html">DoubleVectorWithHaloEntries</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a88f5df169c44b02f4ba563cf42241599">C</a></td></tr>
<tr class="separator:a88f5df169c44b02f4ba563cf42241599"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3f5fc1d7ee4918c9734e59e0611a62c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html">DoubleVectorWithHaloEntries</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ad3f5fc1d7ee4918c9734e59e0611a62c">Count</a></td></tr>
<tr class="separator:ad3f5fc1d7ee4918c9734e59e0611a62c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7010a8c64237d76cb0f23bfad126e07"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ac7010a8c64237d76cb0f23bfad126e07">Global_eqn_number</a></td></tr>
<tr class="separator:ac7010a8c64237d76cb0f23bfad126e07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0e8800d56e68fcb63ec2315f503cab2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aa0e8800d56e68fcb63ec2315f503cab2">Parameter_pt</a></td></tr>
<tr class="memdesc:aa0e8800d56e68fcb63ec2315f503cab2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Storage for the pointer to the parameter.  <a href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aa0e8800d56e68fcb63ec2315f503cab2">More...</a><br /></td></tr>
<tr class="separator:aa0e8800d56e68fcb63ec2315f503cab2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac85263fcd40fa913e4bc12c07f6b7343"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ac85263fcd40fa913e4bc12c07f6b7343">Nelement</a></td></tr>
<tr class="separator:ac85263fcd40fa913e4bc12c07f6b7343"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:aba62ac8cc057be07657972adc4a78b45"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aba62ac8cc057be07657972adc4a78b45">BlockPitchForkLinearSolver</a></td></tr>
<tr class="separator:aba62ac8cc057be07657972adc4a78b45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a223dd55e02e905ce0ce98e98f50b7e57"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a223dd55e02e905ce0ce98e98f50b7e57">AugmentedBlockPitchForkLinearSolver</a></td></tr>
<tr class="separator:a223dd55e02e905ce0ce98e98f50b7e57"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A class that is used to assemble the augmented system that defines a pitchfork (symmetry-breaking) bifurcation. The "standard" problem must be a function of a global parameter \( \lambda \) and a solution is \(R(u,\lambda) = 0\), where \(u\) are the unknowns in the problem. A pitchfork bifurcation may be specified by the augmented system of size \(2N+2\). </p><p class="formulaDsp">
\[ R(u,\lambda) + \sigma \psi = 0,\]
</p>
 <p class="formulaDsp">
\[ Jy = 0,\]
</p>
 <p class="formulaDsp">
\[ \langle u, \phi \rangle = 0, \]
</p>
 <p class="formulaDsp">
\[ \phi \cdot y = 1.\]
</p>
<p> In the abovem \(J\) is the usual Jacobian matrix, \(dR/du\) and \(\phi\) is a constant vector that is chosen to ensure that the null vector, \(y\), is not trivial. Here \(\sigma \) is a slack variable that is used to enforce the constraint \( \langle u, \phi \rangle = 0 \) &mdash; the inner product of the solution with the chosen symmetry vector is zero. At the bifurcation \( \sigma \) should be very close to zero. Note that this formulation means that any odd symmetry in the problem must be about zero. Moreover, we use the dot product of two vectors to calculate the inner product, rather than an integral over the domain and so the mesh must be symmetric in the appropriate directions. </p>
</div><h2 class="groupheader">Member Enumeration Documentation</h2>
<a id="a4f9249832460e1583d537ab9e2872c93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f9249832460e1583d537ab9e2872c93">&#9670;&nbsp;</a></span>anonymous enum</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>A little private enum to determine whether we are solving the block system or not </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a4f9249832460e1583d537ab9e2872c93a0e7d0b0eb06a1f2d90a3ab2831bec36d"></a>Full_augmented&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a4f9249832460e1583d537ab9e2872c93ae729c94eb567cd88e0b33dc29d9f8d5d"></a>Block_J&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a4f9249832460e1583d537ab9e2872c93ac8e196e66210e158988de0bfebcdf6a5"></a>Block_augmented_J&#160;</td><td class="fielddoc"></td></tr>
</table>
<div class="fragment"><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    {</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;      <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93a0e7d0b0eb06a1f2d90a3ab2831bec36d">Full_augmented</a>,</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;      <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93ae729c94eb567cd88e0b33dc29d9f8d5d">Block_J</a>,</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;      <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93ac8e196e66210e158988de0bfebcdf6a5">Block_augmented_J</a></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    };</div>
<div class="ttc" id="aclassoomph_1_1PitchForkHandler_html_a4f9249832460e1583d537ab9e2872c93a0e7d0b0eb06a1f2d90a3ab2831bec36d"><div class="ttname"><a href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93a0e7d0b0eb06a1f2d90a3ab2831bec36d">oomph::PitchForkHandler::Full_augmented</a></div><div class="ttdeci">@ Full_augmented</div><div class="ttdef"><b>Definition:</b> assembly_handler.h:781</div></div>
<div class="ttc" id="aclassoomph_1_1PitchForkHandler_html_a4f9249832460e1583d537ab9e2872c93ac8e196e66210e158988de0bfebcdf6a5"><div class="ttname"><a href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93ac8e196e66210e158988de0bfebcdf6a5">oomph::PitchForkHandler::Block_augmented_J</a></div><div class="ttdeci">@ Block_augmented_J</div><div class="ttdef"><b>Definition:</b> assembly_handler.h:783</div></div>
<div class="ttc" id="aclassoomph_1_1PitchForkHandler_html_a4f9249832460e1583d537ab9e2872c93ae729c94eb567cd88e0b33dc29d9f8d5d"><div class="ttname"><a href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93ae729c94eb567cd88e0b33dc29d9f8d5d">oomph::PitchForkHandler::Block_J</a></div><div class="ttdeci">@ Block_J</div><div class="ttdef"><b>Definition:</b> assembly_handler.h:782</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a96e0343c261d087f5d67a49f68561d96"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96e0343c261d087f5d67a49f68561d96">&#9670;&nbsp;</a></span>PitchForkHandler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">oomph::PitchForkHandler::PitchForkHandler </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *const &amp;&#160;</td>
          <td class="paramname"><em>problem_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html">AssemblyHandler</a> *const &amp;&#160;</td>
          <td class="paramname"><em>assembly_handler_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;&#160;</td>
          <td class="paramname"><em>parameter_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;&#160;</td>
          <td class="paramname"><em>symmetry_vector</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor, initialise the systems. </p>
<p>Constructor: Initialise the PitchForkHandler by setting intial guesses for Sigma, Y, specifying C and Psi and calculating count. </p>
<div class="fragment"><div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;    : <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a614de1eea213de58687ed161fc7c53ae">Solve_which_system</a>(<a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93a0e7d0b0eb06a1f2d90a3ab2831bec36d">Full_augmented</a>), <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a56a173cbdf59e73728c9c1b8c5221817">Sigma</a>(0.0), <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aa0e8800d56e68fcb63ec2315f503cab2">Parameter_pt</a>(parameter_pt)</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;  {</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;    <span class="comment">// Set the problem pointer</span></div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;    <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a> = problem_pt;</div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;    <span class="comment">// Set the assembly handler</span></div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;    <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a40358960131e00efd6bd0febd397a3ef">Assembly_handler_pt</a> = assembly_handler_pt;</div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;    <span class="comment">// Set the number of degrees of freedom</span></div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;    <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a9314a176be55e7e9c5a359accfbec751">Ndof</a> = <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>();</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;    <span class="comment">// Backup the distribution</span></div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;    <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a075f47b5f8941d25796f96d258a1752e">Dof_distribution_pt</a> = <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>;</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;    <span class="comment">// Set the distribution flag</span></div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;    Distributed = <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#af5e9f1623cad361048856a4c0463ea23">distributed</a>();</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160; </div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;    <span class="comment">// Find the elements in the problem</span></div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;    <span class="keywordtype">unsigned</span> n_element = <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>()-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">nelement</a>();</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160; </div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160; </div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;    <span class="comment">// Work out all the global equations to which this processor</span></div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;    <span class="comment">// contributes and store the halo data in the problem</span></div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;    <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;setup_dof_halo_scheme();</div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160; </div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160; </div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160; </div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;    <span class="comment">// Now use the dof distribution for all double vectors</span></div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;    <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aa04d0f340d919d4da3f9199eb76649b1">Psi</a>.<a class="code" href="../../d6/d5b/classoomph_1_1DoubleVector.html#a7bcc94c157d6853a0f0502e8a76ed380">build</a>(<a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a075f47b5f8941d25796f96d258a1752e">Dof_distribution_pt</a>);</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;    <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a289ce15584734b8ea50cd9a7f7f430ed">Y</a>.<a class="code" href="../../d6/d5b/classoomph_1_1DoubleVector.html#a7bcc94c157d6853a0f0502e8a76ed380">build</a>(<a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a075f47b5f8941d25796f96d258a1752e">Dof_distribution_pt</a>);</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;    <a class="code" href="../../d6/d74/classoomph_1_1Matrix.html">C</a>.build(<a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a075f47b5f8941d25796f96d258a1752e">Dof_distribution_pt</a>);</div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;    <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ad3f5fc1d7ee4918c9734e59e0611a62c">Count</a>.<a class="code" href="../../d6/d5b/classoomph_1_1DoubleVector.html#a7bcc94c157d6853a0f0502e8a76ed380">build</a>(<a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a075f47b5f8941d25796f96d258a1752e">Dof_distribution_pt</a>);</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;    <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ad3f5fc1d7ee4918c9734e59e0611a62c">Count</a>.<a class="code" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html#a1aab1a84c6a82a755fdc3c6b27ce49d7">build_halo_scheme</a>(<a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;Halo_scheme_pt);</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160; </div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;    <span class="comment">// Loop over the elements and count the entries</span></div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;    <span class="comment">// and number of (non-halo) elements</span></div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;    <span class="keywordtype">unsigned</span> n_non_halo_element_local = 0;</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; n_element; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;    {</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;      GeneralisedElement* elem_pt = <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>()-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">element_pt</a>(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>);</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;      <span class="comment">// Ignore halo elements</span></div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;      <span class="keywordflow">if</span> (!elem_pt-&gt;is_halo())</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;      {</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;        <span class="comment">// Increment the number of non halo elements</span></div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;        ++n_non_halo_element_local;</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;        <span class="comment">// Now count the number of times the element contributes to a value</span></div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;        <span class="keywordtype">unsigned</span> n_var = assembly_handler_pt-&gt;ndof(elem_pt);</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_var; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;        {</div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;          ++<a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ad3f5fc1d7ee4918c9734e59e0611a62c">Count</a>.<a class="code" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html#a8891ed97a65045e43f906237b109dad2">global_value</a>(assembly_handler_pt-&gt;eqn_number(elem_pt, <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>));</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;        }</div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;      }</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;    }</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160; </div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;    <span class="comment">// Add together all the counts</span></div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;    <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ad3f5fc1d7ee4918c9734e59e0611a62c">Count</a>.<a class="code" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html#a7165745d3397b6ea9d87f123cc97e5c9">sum_all_halo_and_haloed_values</a>();</div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160; </div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;    <span class="comment">// If distributed, find the total number of elements in the problem</span></div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;    <span class="keywordflow">if</span> (Distributed)</div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;    {</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;      <span class="comment">// Need to gather the total number of non halo elements</span></div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;      MPI_Allreduce(&amp;n_non_halo_element_local,</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;                    &amp;<a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ac85263fcd40fa913e4bc12c07f6b7343">Nelement</a>,</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;                    1,</div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;                    MPI_UNSIGNED,</div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;                    MPI_SUM,</div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;                    <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">communicator_pt</a>()-&gt;mpi_comm());</div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;    }</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;    <span class="comment">// Otherwise the total number is the same on each processor</span></div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;    {</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;      <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ac85263fcd40fa913e4bc12c07f6b7343">Nelement</a> = n_non_halo_element_local;</div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;    }</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160; </div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;    <span class="comment">// Only add the parameter to the first processor, if distributed</span></div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;    <span class="keywordtype">int</span> my_rank = <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">communicator_pt</a>()-&gt;<a class="code" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a670b34aab05bfe0b96d0e0fabf583c7a">my_rank</a>();</div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;    <span class="keywordflow">if</span> ((!Distributed) || (my_rank == 0))</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;    {</div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;      <span class="comment">// Add the parameter to the problem</span></div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;      <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>.push_back(parameter_pt);</div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;    }</div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160; </div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;    <span class="comment">// Find length of the symmetry vector</span></div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;    <span class="keywordtype">double</span> length = symmetry_vector.norm();</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160; </div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;    <span class="comment">// Add the unknowns for the null vector to the problem</span></div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;    <span class="comment">// Normalise the symmetry vector and initialise the null vector to the</span></div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;    <span class="comment">// symmetry vector and set the constant vector, c, to the</span></div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;    <span class="comment">// normalised symmetry vector.</span></div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160; </div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;    <span class="comment">// Need to redistribute the symmetry vector into the (natural)</span></div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;    <span class="comment">// distribution of the Dofs</span></div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;    <span class="comment">// Check that the symmetry vector has the correct distribution</span></div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;    <span class="keywordflow">if</span> (!(*symmetry_vector.distribution_pt() == *<a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a075f47b5f8941d25796f96d258a1752e">Dof_distribution_pt</a>))</div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;    {</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;        <span class="stringliteral">&quot;The symmetry vector must have the same distribution as the dofs\n&quot;</span>,</div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;        <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;        <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;    }</div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160; </div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;    <span class="comment">// Only loop over the local unknowns</span></div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_dof_local = <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a075f47b5f8941d25796f96d258a1752e">Dof_distribution_pt</a>-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">nrow_local</a>();</div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_dof_local; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;    {</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;      <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>.push_back(&amp;<a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a289ce15584734b8ea50cd9a7f7f430ed">Y</a>[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>]);</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;      <span class="comment">// Psi[n] = symmetry_vector[n];</span></div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;      <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aa04d0f340d919d4da3f9199eb76649b1">Psi</a>[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>] = <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a289ce15584734b8ea50cd9a7f7f430ed">Y</a>[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>] = <a class="code" href="../../d6/d74/classoomph_1_1Matrix.html">C</a>[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>] = symmetry_vector[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>] / length;</div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;    }</div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160; </div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160; </div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;    <span class="comment">// Set up the required halo schemes (which also synchronises)</span></div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;    <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aa04d0f340d919d4da3f9199eb76649b1">Psi</a>.<a class="code" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html#a1aab1a84c6a82a755fdc3c6b27ce49d7">build_halo_scheme</a>(<a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;Halo_scheme_pt);</div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;    <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a289ce15584734b8ea50cd9a7f7f430ed">Y</a>.<a class="code" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html#a1aab1a84c6a82a755fdc3c6b27ce49d7">build_halo_scheme</a>(<a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;Halo_scheme_pt);</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;    <a class="code" href="../../d6/d74/classoomph_1_1Matrix.html">C</a>.build_halo_scheme(<a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;Halo_scheme_pt);</div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160; </div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160; </div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;    <span class="keywordflow">if</span> ((!Distributed) || (my_rank == 0))</div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;    <span class="comment">// Add the slack parameter to the problem on the first processor</span></div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;    <span class="comment">// if distributed</span></div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;    {</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;      <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>.push_back(&amp;<a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a56a173cbdf59e73728c9c1b8c5221817">Sigma</a>);</div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;    }</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160; </div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;    <span class="keywordflow">if</span> (Distributed)</div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;    {</div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;      <span class="keywordtype">unsigned</span> augmented_first_row = 0;</div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;      <span class="keywordtype">unsigned</span> augmented_n_row_local = 0;</div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160; </div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;      <span class="comment">// Set up the translation scheme on every processor</span></div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;      <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ac7010a8c64237d76cb0f23bfad126e07">Global_eqn_number</a>.resize(2 * <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a9314a176be55e7e9c5a359accfbec751">Ndof</a> + 2);</div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;      <span class="keywordtype">int</span> n_proc = <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">communicator_pt</a>()-&gt;<a class="code" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a6c78c72666f4b102c2bccf200f0853b7">nproc</a>();</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;      <span class="keywordtype">unsigned</span> global_eqn_count = 0;</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; n_proc; d++)</div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;      {</div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;        <span class="comment">// Find out the first row of the current processor</span></div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;        <span class="keywordflow">if</span> (my_rank == d)</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;        {</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;          augmented_first_row = global_eqn_count;</div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;        }</div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160; </div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_row_local = <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a075f47b5f8941d25796f96d258a1752e">Dof_distribution_pt</a>-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">nrow_local</a>(d);</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> first_row = <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a075f47b5f8941d25796f96d258a1752e">Dof_distribution_pt</a>-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a2634e540a78fe1ee3f5c907aff500b58">first_row</a>(d);</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;        <span class="comment">// Add the basic equations</span></div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_row_local; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;        {</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;          <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ac7010a8c64237d76cb0f23bfad126e07">Global_eqn_number</a>[first_row + <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>] = global_eqn_count;</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;          ++global_eqn_count;</div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;        }</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;        <span class="comment">// If on the first processor add the pointer to the parameter</span></div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;        <span class="keywordflow">if</span> (d == 0)</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;        {</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;          <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ac7010a8c64237d76cb0f23bfad126e07">Global_eqn_number</a>[<a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a9314a176be55e7e9c5a359accfbec751">Ndof</a>] = global_eqn_count;</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;          ++global_eqn_count;</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;        }</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;        <span class="comment">// Add the eigenfunction</span></div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_row_local; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;        {</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;          <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ac7010a8c64237d76cb0f23bfad126e07">Global_eqn_number</a>[<a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a9314a176be55e7e9c5a359accfbec751">Ndof</a> + 1 + first_row + <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>] = global_eqn_count;</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;          ++global_eqn_count;</div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;        }</div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;        <span class="comment">// Finally add the slack parameter</span></div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;        <span class="keywordflow">if</span> (d == 0)</div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;        {</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;          <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ac7010a8c64237d76cb0f23bfad126e07">Global_eqn_number</a>[2 * <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a9314a176be55e7e9c5a359accfbec751">Ndof</a> + 1] = global_eqn_count;</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;          ++global_eqn_count;</div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;        }</div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;        <span class="comment">// Find out the number of rows of the current processor</span></div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;        <span class="keywordflow">if</span> (my_rank == d)</div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;        {</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;          augmented_n_row_local = global_eqn_count - augmented_first_row;</div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;        }</div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;      }</div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160; </div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;      <span class="comment">// Make a new linear algebra distribution</span></div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;      <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#af6346c1dc77f3d4fb3dc8950afd91e0f">Augmented_dof_distribution_pt</a> =</div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;        <span class="keyword">new</span> LinearAlgebraDistribution(<a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">communicator_pt</a>(),</div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;                                      augmented_first_row,</div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;                                      augmented_n_row_local);</div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;    }</div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;    {</div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;      <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#af6346c1dc77f3d4fb3dc8950afd91e0f">Augmented_dof_distribution_pt</a> = <span class="keyword">new</span> LinearAlgebraDistribution(</div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;        <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">communicator_pt</a>(), 2 * <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a9314a176be55e7e9c5a359accfbec751">Ndof</a> + 2, <span class="keyword">false</span>);</div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;    }</div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160; </div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;    <span class="comment">// resize</span></div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;    <span class="comment">// Problem_pt-&gt;Dof_distribution_pt-&gt;build(Problem_pt-&gt;communicator_pt(),</span></div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;    <span class="comment">//                                       2*Ndof+2,false);</span></div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160; </div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;    <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a> = <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#af6346c1dc77f3d4fb3dc8950afd91e0f">Augmented_dof_distribution_pt</a>;</div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160; </div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;    <span class="comment">// Remove all previous sparse storage used during Jacobian assembly</span></div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;    <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a547c85bfa6a2eb3effc4db1b46ebcdde">Sparse_assemble_with_arrays_previous_allocation</a>.resize(0);</div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;  }</div>
<div class="ttc" id="aCG3DPackingUnitTest_8cpp_html_a7026fd16370249ce97cb3d062326baf9"><div class="ttname"><a href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a></div><div class="ttdeci">const unsigned n</div><div class="ttdef"><b>Definition:</b> CG3DPackingUnitTest.cpp:11</div></div>
<div class="ttc" id="aCwise__array__power__array_8cpp_html_a9eb5e92d9d691c1393e5e7c914731dbf"><div class="ttname"><a href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a></div><div class="ttdeci">Array&lt; double, 1, 3 &gt; e(1./3., 0.5, 2.)</div></div>
<div class="ttc" id="aclassoomph_1_1DoubleVectorWithHaloEntries_html_a1aab1a84c6a82a755fdc3c6b27ce49d7"><div class="ttname"><a href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html#a1aab1a84c6a82a755fdc3c6b27ce49d7">oomph::DoubleVectorWithHaloEntries::build_halo_scheme</a></div><div class="ttdeci">void build_halo_scheme(DoubleVectorHaloScheme *const &amp;halo_scheme_pt)</div><div class="ttdoc">Construct the halo scheme and storage for the halo data.</div><div class="ttdef"><b>Definition:</b> double_vector_with_halo.cc:379</div></div>
<div class="ttc" id="aclassoomph_1_1DoubleVectorWithHaloEntries_html_a7165745d3397b6ea9d87f123cc97e5c9"><div class="ttname"><a href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html#a7165745d3397b6ea9d87f123cc97e5c9">oomph::DoubleVectorWithHaloEntries::sum_all_halo_and_haloed_values</a></div><div class="ttdeci">void sum_all_halo_and_haloed_values()</div><div class="ttdef"><b>Definition:</b> double_vector_with_halo.cc:323</div></div>
<div class="ttc" id="aclassoomph_1_1DoubleVectorWithHaloEntries_html_a8891ed97a65045e43f906237b109dad2"><div class="ttname"><a href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html#a8891ed97a65045e43f906237b109dad2">oomph::DoubleVectorWithHaloEntries::global_value</a></div><div class="ttdeci">double &amp; global_value(const unsigned &amp;i)</div><div class="ttdoc">Direct access to global entry.</div><div class="ttdef"><b>Definition:</b> double_vector_with_halo.h:221</div></div>
<div class="ttc" id="aclassoomph_1_1DoubleVector_html_a7bcc94c157d6853a0f0502e8a76ed380"><div class="ttname"><a href="../../d6/d5b/classoomph_1_1DoubleVector.html#a7bcc94c157d6853a0f0502e8a76ed380">oomph::DoubleVector::build</a></div><div class="ttdeci">void build(const DoubleVector &amp;old_vector)</div><div class="ttdoc">Just copys the argument DoubleVector.</div><div class="ttdef"><b>Definition:</b> double_vector.cc:35</div></div>
<div class="ttc" id="aclassoomph_1_1LinearAlgebraDistribution_html_a2634e540a78fe1ee3f5c907aff500b58"><div class="ttname"><a href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a2634e540a78fe1ee3f5c907aff500b58">oomph::LinearAlgebraDistribution::first_row</a></div><div class="ttdeci">unsigned first_row() const</div><div class="ttdef"><b>Definition:</b> linear_algebra_distribution.h:261</div></div>
<div class="ttc" id="aclassoomph_1_1LinearAlgebraDistribution_html_ac9310de740f9c3a61f8d5dab9bef88ca"><div class="ttname"><a href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">oomph::LinearAlgebraDistribution::nrow_local</a></div><div class="ttdeci">unsigned nrow_local() const</div><div class="ttdef"><b>Definition:</b> linear_algebra_distribution.h:193</div></div>
<div class="ttc" id="aclassoomph_1_1Matrix_html"><div class="ttname"><a href="../../d6/d74/classoomph_1_1Matrix.html">oomph::Matrix</a></div><div class="ttdef"><b>Definition:</b> matrices.h:74</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_a876faf1f87b24b220ea21a38d6adde5b"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">oomph::Mesh::element_pt</a></div><div class="ttdeci">GeneralisedElement *&amp; element_pt(const unsigned long &amp;e)</div><div class="ttdoc">Return pointer to element e.</div><div class="ttdef"><b>Definition:</b> mesh.h:448</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_af01dfefb66c15579b540be62999d93ee"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">oomph::Mesh::nelement</a></div><div class="ttdeci">unsigned long nelement() const</div><div class="ttdoc">Return number of elements in the mesh.</div><div class="ttdef"><b>Definition:</b> mesh.h:590</div></div>
<div class="ttc" id="aclassoomph_1_1OomphCommunicator_html_a670b34aab05bfe0b96d0e0fabf583c7a"><div class="ttname"><a href="../../de/d83/classoomph_1_1OomphCommunicator.html#a670b34aab05bfe0b96d0e0fabf583c7a">oomph::OomphCommunicator::my_rank</a></div><div class="ttdeci">int my_rank() const</div><div class="ttdoc">my rank</div><div class="ttdef"><b>Definition:</b> communicator.h:176</div></div>
<div class="ttc" id="aclassoomph_1_1OomphCommunicator_html_a6c78c72666f4b102c2bccf200f0853b7"><div class="ttname"><a href="../../de/d83/classoomph_1_1OomphCommunicator.html#a6c78c72666f4b102c2bccf200f0853b7">oomph::OomphCommunicator::nproc</a></div><div class="ttdeci">int nproc() const</div><div class="ttdoc">number of processors</div><div class="ttdef"><b>Definition:</b> communicator.h:157</div></div>
<div class="ttc" id="aclassoomph_1_1PitchForkHandler_html_a075f47b5f8941d25796f96d258a1752e"><div class="ttname"><a href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a075f47b5f8941d25796f96d258a1752e">oomph::PitchForkHandler::Dof_distribution_pt</a></div><div class="ttdeci">LinearAlgebraDistribution * Dof_distribution_pt</div><div class="ttdoc">Store the original dof distribution.</div><div class="ttdef"><b>Definition:</b> assembly_handler.h:804</div></div>
<div class="ttc" id="aclassoomph_1_1PitchForkHandler_html_a196adc8e79a66292d2df9bd9093f8f73"><div class="ttname"><a href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">oomph::PitchForkHandler::Problem_pt</a></div><div class="ttdeci">Problem * Problem_pt</div><div class="ttdoc">Pointer to the problem.</div><div class="ttdef"><b>Definition:</b> assembly_handler.h:794</div></div>
<div class="ttc" id="aclassoomph_1_1PitchForkHandler_html_a289ce15584734b8ea50cd9a7f7f430ed"><div class="ttname"><a href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a289ce15584734b8ea50cd9a7f7f430ed">oomph::PitchForkHandler::Y</a></div><div class="ttdeci">DoubleVectorWithHaloEntries Y</div><div class="ttdoc">Storage for the null vector.</div><div class="ttdef"><b>Definition:</b> assembly_handler.h:814</div></div>
<div class="ttc" id="aclassoomph_1_1PitchForkHandler_html_a40358960131e00efd6bd0febd397a3ef"><div class="ttname"><a href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a40358960131e00efd6bd0febd397a3ef">oomph::PitchForkHandler::Assembly_handler_pt</a></div><div class="ttdeci">AssemblyHandler * Assembly_handler_pt</div><div class="ttdoc">Pointer to the underlying (original) assembly handler.</div><div class="ttdef"><b>Definition:</b> assembly_handler.h:797</div></div>
<div class="ttc" id="aclassoomph_1_1PitchForkHandler_html_a56a173cbdf59e73728c9c1b8c5221817"><div class="ttname"><a href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a56a173cbdf59e73728c9c1b8c5221817">oomph::PitchForkHandler::Sigma</a></div><div class="ttdeci">double Sigma</div><div class="ttdef"><b>Definition:</b> assembly_handler.h:811</div></div>
<div class="ttc" id="aclassoomph_1_1PitchForkHandler_html_a614de1eea213de58687ed161fc7c53ae"><div class="ttname"><a href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a614de1eea213de58687ed161fc7c53ae">oomph::PitchForkHandler::Solve_which_system</a></div><div class="ttdeci">unsigned Solve_which_system</div><div class="ttdef"><b>Definition:</b> assembly_handler.h:791</div></div>
<div class="ttc" id="aclassoomph_1_1PitchForkHandler_html_a9314a176be55e7e9c5a359accfbec751"><div class="ttname"><a href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a9314a176be55e7e9c5a359accfbec751">oomph::PitchForkHandler::Ndof</a></div><div class="ttdeci">unsigned Ndof</div><div class="ttdef"><b>Definition:</b> assembly_handler.h:801</div></div>
<div class="ttc" id="aclassoomph_1_1PitchForkHandler_html_aa04d0f340d919d4da3f9199eb76649b1"><div class="ttname"><a href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aa04d0f340d919d4da3f9199eb76649b1">oomph::PitchForkHandler::Psi</a></div><div class="ttdeci">DoubleVectorWithHaloEntries Psi</div><div class="ttdoc">A constant vector that is specifies the symmetry being broken.</div><div class="ttdef"><b>Definition:</b> assembly_handler.h:817</div></div>
<div class="ttc" id="aclassoomph_1_1PitchForkHandler_html_aa0e8800d56e68fcb63ec2315f503cab2"><div class="ttname"><a href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aa0e8800d56e68fcb63ec2315f503cab2">oomph::PitchForkHandler::Parameter_pt</a></div><div class="ttdeci">double * Parameter_pt</div><div class="ttdoc">Storage for the pointer to the parameter.</div><div class="ttdef"><b>Definition:</b> assembly_handler.h:835</div></div>
<div class="ttc" id="aclassoomph_1_1PitchForkHandler_html_ac7010a8c64237d76cb0f23bfad126e07"><div class="ttname"><a href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ac7010a8c64237d76cb0f23bfad126e07">oomph::PitchForkHandler::Global_eqn_number</a></div><div class="ttdeci">Vector&lt; unsigned &gt; Global_eqn_number</div><div class="ttdef"><b>Definition:</b> assembly_handler.h:832</div></div>
<div class="ttc" id="aclassoomph_1_1PitchForkHandler_html_ac85263fcd40fa913e4bc12c07f6b7343"><div class="ttname"><a href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ac85263fcd40fa913e4bc12c07f6b7343">oomph::PitchForkHandler::Nelement</a></div><div class="ttdeci">unsigned Nelement</div><div class="ttdef"><b>Definition:</b> assembly_handler.h:838</div></div>
<div class="ttc" id="aclassoomph_1_1PitchForkHandler_html_ad3f5fc1d7ee4918c9734e59e0611a62c"><div class="ttname"><a href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ad3f5fc1d7ee4918c9734e59e0611a62c">oomph::PitchForkHandler::Count</a></div><div class="ttdeci">DoubleVectorWithHaloEntries Count</div><div class="ttdef"><b>Definition:</b> assembly_handler.h:828</div></div>
<div class="ttc" id="aclassoomph_1_1PitchForkHandler_html_af6346c1dc77f3d4fb3dc8950afd91e0f"><div class="ttname"><a href="../../d1/d08/classoomph_1_1PitchForkHandler.html#af6346c1dc77f3d4fb3dc8950afd91e0f">oomph::PitchForkHandler::Augmented_dof_distribution_pt</a></div><div class="ttdeci">LinearAlgebraDistribution * Augmented_dof_distribution_pt</div><div class="ttdoc">The augmented distribution.</div><div class="ttdef"><b>Definition:</b> assembly_handler.h:807</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a218d4dfff74bc14f3f5dc8416236e01d"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">oomph::Problem::ndof</a></div><div class="ttdeci">unsigned long ndof() const</div><div class="ttdoc">Return the number of dofs.</div><div class="ttdef"><b>Definition:</b> problem.h:1674</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a547c85bfa6a2eb3effc4db1b46ebcdde"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a547c85bfa6a2eb3effc4db1b46ebcdde">oomph::Problem::Sparse_assemble_with_arrays_previous_allocation</a></div><div class="ttdeci">Vector&lt; Vector&lt; unsigned &gt; &gt; Sparse_assemble_with_arrays_previous_allocation</div><div class="ttdef"><b>Definition:</b> problem.h:667</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a600bb1740edd0aa07c6d001033bf676a"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">oomph::Problem::communicator_pt</a></div><div class="ttdeci">OomphCommunicator * communicator_pt()</div><div class="ttdoc">access function to the oomph-lib communicator</div><div class="ttdef"><b>Definition:</b> problem.h:1246</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_aa9e4cfff7e1dc295036b0e58bc11ae75"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">oomph::Problem::Dof_pt</a></div><div class="ttdeci">Vector&lt; double * &gt; Dof_pt</div><div class="ttdoc">Vector of pointers to dofs.</div><div class="ttdef"><b>Definition:</b> problem.h:554</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_aad122d70a22dc5302cfd5853d3cf3057"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">oomph::Problem::mesh_pt</a></div><div class="ttdeci">Mesh *&amp; mesh_pt()</div><div class="ttdoc">Return a pointer to the global mesh.</div><div class="ttdef"><b>Definition:</b> problem.h:1280</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_ade01b88db08dcec1706fe44eaa0090a3"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">oomph::Problem::Dof_distribution_pt</a></div><div class="ttdeci">LinearAlgebraDistribution * Dof_distribution_pt</div><div class="ttdef"><b>Definition:</b> problem.h:460</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_af5e9f1623cad361048856a4c0463ea23"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#af5e9f1623cad361048856a4c0463ea23">oomph::Problem::distributed</a></div><div class="ttdeci">bool distributed() const</div><div class="ttdef"><b>Definition:</b> problem.h:808</div></div>
<div class="ttc" id="aoomph__definitions_8h_html_a25c6813cc7341d125e2502f8923fb6c4"><div class="ttname"><a href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a></div><div class="ttdeci">#define OOMPH_EXCEPTION_LOCATION</div><div class="ttdef"><b>Definition:</b> oomph_definitions.h:61</div></div>
<div class="ttc" id="aoomph__definitions_8h_html_aa260cc4af589e30cea7fde997ae16667"><div class="ttname"><a href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a></div><div class="ttdeci">#define OOMPH_CURRENT_FUNCTION</div><div class="ttdef"><b>Definition:</b> oomph_definitions.h:86</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a40358960131e00efd6bd0febd397a3ef">Assembly_handler_pt</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#af6346c1dc77f3d4fb3dc8950afd91e0f">Augmented_dof_distribution_pt</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#a7bcc94c157d6853a0f0502e8a76ed380">oomph::DoubleVector::build()</a>, <a class="el" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html#a1aab1a84c6a82a755fdc3c6b27ce49d7">oomph::DoubleVectorWithHaloEntries::build_halo_scheme()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">oomph::Problem::communicator_pt()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ad3f5fc1d7ee4918c9734e59e0611a62c">Count</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af5e9f1623cad361048856a4c0463ea23">oomph::Problem::distributed()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">oomph::DistributableLinearAlgebraObject::distribution_pt()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a075f47b5f8941d25796f96d258a1752e">Dof_distribution_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">oomph::Problem::Dof_distribution_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">oomph::Problem::Dof_pt</a>, <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">oomph::Mesh::element_pt()</a>, <a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a94d28e2de2559cde803d1ba2195b5290">oomph::AssemblyHandler::eqn_number()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a2634e540a78fe1ee3f5c907aff500b58">oomph::LinearAlgebraDistribution::first_row()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ac7010a8c64237d76cb0f23bfad126e07">Global_eqn_number</a>, <a class="el" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html#a8891ed97a65045e43f906237b109dad2">oomph::DoubleVectorWithHaloEntries::global_value()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">oomph::Problem::mesh_pt()</a>, <a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a670b34aab05bfe0b96d0e0fabf583c7a">oomph::OomphCommunicator::my_rank()</a>, <a class="el" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a9314a176be55e7e9c5a359accfbec751">Ndof</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">oomph::Problem::ndof()</a>, <a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a09213be8f4aa009e0366460a7ed78e68">oomph::AssemblyHandler::ndof()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ac85263fcd40fa913e4bc12c07f6b7343">Nelement</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">oomph::Mesh::nelement()</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#a9ac9245cac87ddcdb70cfcd697553a55">oomph::DoubleVector::norm()</a>, <a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a6c78c72666f4b102c2bccf200f0853b7">oomph::OomphCommunicator::nproc()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">oomph::LinearAlgebraDistribution::nrow_local()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aa04d0f340d919d4da3f9199eb76649b1">Psi</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a56a173cbdf59e73728c9c1b8c5221817">Sigma</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a547c85bfa6a2eb3effc4db1b46ebcdde">oomph::Problem::Sparse_assemble_with_arrays_previous_allocation</a>, <a class="el" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html#a7165745d3397b6ea9d87f123cc97e5c9">oomph::DoubleVectorWithHaloEntries::sum_all_halo_and_haloed_values()</a>, and <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a289ce15584734b8ea50cd9a7f7f430ed">Y</a>.</p>

</div>
</div>
<a id="a69c6b0b6aedd03d828d295531fd61820"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69c6b0b6aedd03d828d295531fd61820">&#9670;&nbsp;</a></span>~PitchForkHandler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">oomph::PitchForkHandler::~PitchForkHandler </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destructor return the problem to its original (non-augmented) state. </p>
<p>Destructor, return the problem to its original state, before the augmented system was added </p>
<div class="fragment"><div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;  {</div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;    <span class="comment">// If we are using the block solver reset the problem&#39;s linear solver</span></div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;    <span class="comment">// to the original one</span></div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;    <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aba62ac8cc057be07657972adc4a78b45">BlockPitchForkLinearSolver</a>* block_pitchfork_solver_pt =</div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;      <span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aba62ac8cc057be07657972adc4a78b45">BlockPitchForkLinearSolver</a>*<span class="keyword">&gt;</span>(<a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a689687cacc40dd351430545a7041f44c">linear_solver_pt</a>());</div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160; </div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;    <span class="keywordflow">if</span> (block_pitchfork_solver_pt)</div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;    {</div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;      <span class="comment">// Reset the problem&#39;s linear solver</span></div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;      <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a689687cacc40dd351430545a7041f44c">linear_solver_pt</a>() =</div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;        block_pitchfork_solver_pt-&gt;linear_solver_pt();</div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;      <span class="comment">// Delete the block solver</span></div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;      <span class="keyword">delete</span> block_pitchfork_solver_pt;</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;    }</div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160; </div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;    <span class="comment">// If we are using the augmented</span></div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;    <span class="comment">// block solver reset the problem&#39;s linear solver</span></div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;    <span class="comment">// to the original one</span></div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;    <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a223dd55e02e905ce0ce98e98f50b7e57">AugmentedBlockPitchForkLinearSolver</a>* augmented_block_pitchfork_solver_pt =</div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;      <span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a223dd55e02e905ce0ce98e98f50b7e57">AugmentedBlockPitchForkLinearSolver</a>*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;        <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a689687cacc40dd351430545a7041f44c">linear_solver_pt</a>());</div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160; </div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;    <span class="keywordflow">if</span> (augmented_block_pitchfork_solver_pt)</div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;    {</div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;      <span class="comment">// Reset the problem&#39;s linear solver</span></div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;      <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a689687cacc40dd351430545a7041f44c">linear_solver_pt</a>() =</div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;        augmented_block_pitchfork_solver_pt-&gt;linear_solver_pt();</div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;      <span class="comment">// Delete the block solver</span></div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;      <span class="keyword">delete</span> augmented_block_pitchfork_solver_pt;</div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;    }</div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160; </div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;    <span class="comment">// Now return the problem to its original size</span></div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;    <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>.resize(this-&gt;<a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a075f47b5f8941d25796f96d258a1752e">Dof_distribution_pt</a>-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">nrow_local</a>());</div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160; </div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;    <span class="comment">// Problem_pt-&gt;Dof_pt.resize(Ndof);</span></div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;    <span class="comment">// Problem_pt-&gt;Dof_distribution_pt-&gt;build(Problem_pt-&gt;communicator_pt(),</span></div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;    <span class="comment">//                                       Ndof,false);</span></div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160; </div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;    <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a> = this-&gt;<a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a075f47b5f8941d25796f96d258a1752e">Dof_distribution_pt</a>;</div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;    <span class="comment">// Remove all previous sparse storage used during Jacobian assembly</span></div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;    <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a547c85bfa6a2eb3effc4db1b46ebcdde">Sparse_assemble_with_arrays_previous_allocation</a>.resize(0);</div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1PitchForkHandler_html_a223dd55e02e905ce0ce98e98f50b7e57"><div class="ttname"><a href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a223dd55e02e905ce0ce98e98f50b7e57">oomph::PitchForkHandler::AugmentedBlockPitchForkLinearSolver</a></div><div class="ttdeci">friend class AugmentedBlockPitchForkLinearSolver</div><div class="ttdef"><b>Definition:</b> assembly_handler.h:775</div></div>
<div class="ttc" id="aclassoomph_1_1PitchForkHandler_html_aba62ac8cc057be07657972adc4a78b45"><div class="ttname"><a href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aba62ac8cc057be07657972adc4a78b45">oomph::PitchForkHandler::BlockPitchForkLinearSolver</a></div><div class="ttdeci">friend class BlockPitchForkLinearSolver</div><div class="ttdef"><b>Definition:</b> assembly_handler.h:774</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a689687cacc40dd351430545a7041f44c"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a689687cacc40dd351430545a7041f44c">oomph::Problem::linear_solver_pt</a></div><div class="ttdeci">LinearSolver *&amp; linear_solver_pt()</div><div class="ttdoc">Return a pointer to the linear solver object.</div><div class="ttdef"><b>Definition:</b> problem.h:1466</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a075f47b5f8941d25796f96d258a1752e">Dof_distribution_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">oomph::Problem::Dof_distribution_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">oomph::Problem::Dof_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a689687cacc40dd351430545a7041f44c">oomph::Problem::linear_solver_pt()</a>, <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a38efead8e84202a3232b4a3624a2986c">oomph::BlockPitchForkLinearSolver::linear_solver_pt()</a>, <a class="el" href="../../de/d72/classoomph_1_1AugmentedBlockPitchForkLinearSolver.html#a96ac14c60f20314f5be075a68a620b3f">oomph::AugmentedBlockPitchForkLinearSolver::linear_solver_pt()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">oomph::LinearAlgebraDistribution::nrow_local()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a547c85bfa6a2eb3effc4db1b46ebcdde">oomph::Problem::Sparse_assemble_with_arrays_previous_allocation</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a7363cb34d716d64d891af5018e09d807"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7363cb34d716d64d891af5018e09d807">&#9670;&nbsp;</a></span>bifurcation_parameter_pt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a>* oomph::PitchForkHandler::bifurcation_parameter_pt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Return a pointer to the bifurcation parameter in bifurcation tracking problems </p>

<p>Reimplemented from <a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a3e369ec692c3d36a4a2a8a64dab7fe2b">oomph::AssemblyHandler</a>.</p>
<div class="fragment"><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    {</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aa0e8800d56e68fcb63ec2315f503cab2">Parameter_pt</a>;</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aa0e8800d56e68fcb63ec2315f503cab2">Parameter_pt</a>.</p>

</div>
</div>
<a id="aadc4f0b5dfb82cf171b91432536d1679"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aadc4f0b5dfb82cf171b91432536d1679">&#9670;&nbsp;</a></span>bifurcation_type()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> oomph::PitchForkHandler::bifurcation_type </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Indicate that we are tracking a pitchfork bifurcation by returning 2 </p>

<p>Reimplemented from <a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a22c5f240674e4f6cee12006790c11dae">oomph::AssemblyHandler</a>.</p>
<div class="fragment"><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    {</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;      <span class="keywordflow">return</span> 2;</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab29e58e25bd5bebd836e30015f01ac8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab29e58e25bd5bebd836e30015f01ac8d">&#9670;&nbsp;</a></span>eqn_number()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long oomph::PitchForkHandler::eqn_number </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html">GeneralisedElement</a> *const &amp;&#160;</td>
          <td class="paramname"><em>elem_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>ieqn_local</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the global equation number of the local unknown. </p>

<p>Reimplemented from <a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a94d28e2de2559cde803d1ba2195b5290">oomph::AssemblyHandler</a>.</p>
<div class="fragment"><div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;  {</div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;    <span class="comment">// Get the raw value</span></div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;    <span class="keywordtype">unsigned</span> raw_ndof = elem_pt-&gt;ndof();</div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> global_eqn = 0;</div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160; </div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;    <span class="comment">// Which system are we solving</span></div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a614de1eea213de58687ed161fc7c53ae">Solve_which_system</a>)</div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;    {</div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;        <span class="comment">// In the block case, it&#39;s just the standard numbering</span></div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93ae729c94eb567cd88e0b33dc29d9f8d5d">Block_J</a>:</div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;        global_eqn = elem_pt-&gt;eqn_number(ieqn_local);</div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160; </div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;        <span class="comment">// Block augmented not done properly yet</span></div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93ac8e196e66210e158988de0bfebcdf6a5">Block_augmented_J</a>:</div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;        <span class="comment">// Not done the distributed case</span></div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;        <span class="keywordflow">if</span> (Distributed)</div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;        {</div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;          <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;            <span class="stringliteral">&quot;Block Augmented solver not implemented for distributed case\n&quot;</span>,</div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;        }</div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160; </div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;        <span class="comment">// Full case</span></div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93a0e7d0b0eb06a1f2d90a3ab2831bec36d">Full_augmented</a>:</div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;        <span class="comment">// The usual equations</span></div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;        <span class="keywordflow">if</span> (ieqn_local &lt; raw_ndof)</div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;        {</div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;          global_eqn = this-&gt;<a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ac1a4bbb1415a009e9f176f16263fcb3e">global_eqn_number</a>(elem_pt-&gt;eqn_number(ieqn_local));</div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;        }</div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;        <span class="comment">// The bifurcation parameter equation</span></div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ieqn_local == raw_ndof)</div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;        {</div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;          global_eqn = this-&gt;<a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ac1a4bbb1415a009e9f176f16263fcb3e">global_eqn_number</a>(<a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a9314a176be55e7e9c5a359accfbec751">Ndof</a>);</div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;        }</div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;        <span class="comment">// If we are assembling the full system we also have</span></div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;        <span class="comment">// The components of the null vector</span></div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ieqn_local &lt; (2 * raw_ndof + 1))</div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;        {</div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;          global_eqn = this-&gt;<a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ac1a4bbb1415a009e9f176f16263fcb3e">global_eqn_number</a>(</div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;            <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a9314a176be55e7e9c5a359accfbec751">Ndof</a> + 1 + elem_pt-&gt;eqn_number(ieqn_local - 1 - raw_ndof));</div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;        }</div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;        <span class="comment">// The slack parameter</span></div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;        {</div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;          global_eqn = this-&gt;<a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ac1a4bbb1415a009e9f176f16263fcb3e">global_eqn_number</a>(2 * <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a9314a176be55e7e9c5a359accfbec751">Ndof</a> + 1);</div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;        }</div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;    } <span class="comment">// End of switch</span></div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;    <span class="keywordflow">return</span> global_eqn;</div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1PitchForkHandler_html_ac1a4bbb1415a009e9f176f16263fcb3e"><div class="ttname"><a href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ac1a4bbb1415a009e9f176f16263fcb3e">oomph::PitchForkHandler::global_eqn_number</a></div><div class="ttdeci">unsigned global_eqn_number(const unsigned &amp;i)</div><div class="ttdef"><b>Definition:</b> assembly_handler.h:848</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93ac8e196e66210e158988de0bfebcdf6a5">Block_augmented_J</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93ae729c94eb567cd88e0b33dc29d9f8d5d">Block_J</a>, <a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a37ac5a1d5234fa931ab710c0c74d55d2">oomph::GeneralisedElement::eqn_number()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93a0e7d0b0eb06a1f2d90a3ab2831bec36d">Full_augmented</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ac1a4bbb1415a009e9f176f16263fcb3e">global_eqn_number()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a9314a176be55e7e9c5a359accfbec751">Ndof</a>, <a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a37204f67b37d212fd170c68d48f6da57">oomph::GeneralisedElement::ndof()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, and <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a614de1eea213de58687ed161fc7c53ae">Solve_which_system</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../de/d72/classoomph_1_1AugmentedBlockPitchForkLinearSolver.html#a1d617896a3f1c1b1236ff18dc87ed8d7">oomph::AugmentedBlockPitchForkLinearSolver::resolve()</a>, and <a class="el" href="../../de/d72/classoomph_1_1AugmentedBlockPitchForkLinearSolver.html#a0cbeb150ac83d5be1a1e30c0f728a70b">oomph::AugmentedBlockPitchForkLinearSolver::solve()</a>.</p>

</div>
</div>
<a id="aa16d6770f6d46b7db4101f417373b191"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa16d6770f6d46b7db4101f417373b191">&#9670;&nbsp;</a></span>get_djacobian_dparameter()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::PitchForkHandler::get_djacobian_dparameter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html">GeneralisedElement</a> *const &amp;&#160;</td>
          <td class="paramname"><em>elem_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;&#160;</td>
          <td class="paramname"><em>parameter_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>dres_dparam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>djac_dparam</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Overload the derivative of the residuals and jacobian with respect to a parameter so that it breaks</p>
<p>Overload the derivative of the residuals and jacobian with respect to a parameter so that it breaks because it should not be required </p>

<p>Reimplemented from <a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#aefc0c13a65342806c167c5d53f014803">oomph::AssemblyHandler</a>.</p>
<div class="fragment"><div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;  {</div>
<div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;    std::ostringstream error_stream;</div>
<div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;    error_stream</div>
<div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;This function has not been implemented because it is not required\n&quot;</span>;</div>
<div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;    error_stream &lt;&lt; <span class="stringliteral">&quot;in standard problems.\n&quot;</span>;</div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;    error_stream</div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;If you find that you need it, you will have to implement it!\n\n&quot;</span>;</div>
<div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160; </div>
<div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;    <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;      error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, and <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>.</p>

</div>
</div>
<a id="a6510803afcbcfce1ae5b1c1c5d82a541"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6510803afcbcfce1ae5b1c1c5d82a541">&#9670;&nbsp;</a></span>get_dresiduals_dparameter()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::PitchForkHandler::get_dresiduals_dparameter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html">GeneralisedElement</a> *const &amp;&#160;</td>
          <td class="paramname"><em>elem_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;&#160;</td>
          <td class="paramname"><em>parameter_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>dres_dparam</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the derivatives of the residuals with respect to a parameter. </p>
<p>Overload the derivatives of the residuals with respect to a parameter to apply to the augmented system </p>

<p>Reimplemented from <a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a2ee980ccabe0ad82f98e694eecf270bb">oomph::AssemblyHandler</a>.</p>
<div class="fragment"><div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;  {</div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;    <span class="comment">// Need to get raw residuals and jacobian</span></div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;    <span class="keywordtype">unsigned</span> raw_ndof = elem_pt-&gt;ndof();</div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;    <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae6ad96ddf5d48b517b89c9a9b879bc4b">actions_before_newton_convergence_check</a>();</div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;    <span class="comment">// Find out which system we are solving</span></div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a614de1eea213de58687ed161fc7c53ae">Solve_which_system</a>)</div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;    {</div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;        <span class="comment">// If we are solving the original system</span></div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93ae729c94eb567cd88e0b33dc29d9f8d5d">Block_J</a>:</div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;      {</div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;        <span class="comment">// get the basic residual derivatives</span></div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;        elem_pt-&gt;get_dresiduals_dparameter(parameter_pt, dres_dparam);</div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;        <span class="comment">// Slack parameter term does not depened explicitly on the parameter</span></div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;        <span class="comment">// so is not added</span></div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;      }</div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160; </div>
<div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;      <span class="comment">// If we are solving the augmented-by-one system</span></div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93ac8e196e66210e158988de0bfebcdf6a5">Block_augmented_J</a>:</div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;      {</div>
<div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;        <span class="comment">// Get the basic residual derivatives</span></div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;        elem_pt-&gt;get_dresiduals_dparameter(parameter_pt, dres_dparam);</div>
<div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160; </div>
<div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;        <span class="comment">// Zero the final residuals derivative</span></div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;        dres_dparam[raw_ndof] = 0.0;</div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160; </div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;        <span class="comment">// Other terms must not depend on the parameter</span></div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;      }</div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160; </div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;      <span class="comment">// Otherwise we are solving the fully augemented system</span></div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93a0e7d0b0eb06a1f2d90a3ab2831bec36d">Full_augmented</a>:</div>
<div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;      {</div>
<div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;        <a class="code" href="../../dc/d34/classEigen_1_1Matrix.html">DenseMatrix&lt;double&gt;</a> djac_dparam(raw_ndof);</div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160; </div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;        <span class="comment">// Get the basic residuals and jacobian derivatives</span></div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;        elem_pt-&gt;get_djacobian_dparameter(</div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;          parameter_pt, dres_dparam, djac_dparam);</div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160; </div>
<div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;        <span class="comment">// The &quot;final&quot; residual derivatives do not depend on the parameter</span></div>
<div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;        dres_dparam[raw_ndof] = 0.0;</div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;        dres_dparam[2 * raw_ndof + 1] = 0.0;</div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160; </div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;        <span class="comment">// Now multiply to fill in the residuals associated</span></div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;        <span class="comment">// with the null vector condition</span></div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; raw_ndof; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;        {</div>
<div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;          dres_dparam[raw_ndof + 1 + <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = 0.0;</div>
<div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; raw_ndof; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;          {</div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;            <span class="keywordtype">unsigned</span> local_unknown = elem_pt-&gt;eqn_number(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;            dres_dparam[raw_ndof + 1 + <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] +=</div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;              djac_dparam(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) * <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a289ce15584734b8ea50cd9a7f7f430ed">Y</a>.<a class="code" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html#a8891ed97a65045e43f906237b109dad2">global_value</a>(local_unknown);</div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;          }</div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;        }</div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;      }</div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160; </div>
<div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;        std::ostringstream error_stream;</div>
<div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;        error_stream</div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;The Solve_which_system flag can only take values 0, 1, 2&quot;</span></div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;          &lt;&lt; <span class="stringliteral">&quot; not &quot;</span> &lt;&lt; <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a614de1eea213de58687ed161fc7c53ae">Solve_which_system</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;          error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;    }</div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;  }</div>
<div class="ttc" id="aBiCGSTAB__step__by__step_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> BiCGSTAB_step_by_step.cpp:9</div></div>
<div class="ttc" id="aclassEigen_1_1Matrix_html"><div class="ttname"><a href="../../dc/d34/classEigen_1_1Matrix.html">Eigen::Matrix&lt; Scalar, Dynamic, Dynamic &gt;</a></div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_ae6ad96ddf5d48b517b89c9a9b879bc4b"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#ae6ad96ddf5d48b517b89c9a9b879bc4b">oomph::Problem::actions_before_newton_convergence_check</a></div><div class="ttdeci">virtual void actions_before_newton_convergence_check()</div><div class="ttdef"><b>Definition:</b> problem.h:1048</div></div>
<div class="ttc" id="atut__arithmetic__redux__minmax_8cpp_html_a39513f0f8d942bf9ef17b2e87ac6d34e"><div class="ttname"><a href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a></div><div class="ttdeci">std::ptrdiff_t j</div><div class="ttdef"><b>Definition:</b> tut_arithmetic_redux_minmax.cpp:2</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae6ad96ddf5d48b517b89c9a9b879bc4b">oomph::Problem::actions_before_newton_convergence_check()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93ac8e196e66210e158988de0bfebcdf6a5">Block_augmented_J</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93ae729c94eb567cd88e0b33dc29d9f8d5d">Block_J</a>, <a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a37ac5a1d5234fa931ab710c0c74d55d2">oomph::GeneralisedElement::eqn_number()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93a0e7d0b0eb06a1f2d90a3ab2831bec36d">Full_augmented</a>, <a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#ab92de6f9c750735bc660f0a10f0df44c">oomph::GeneralisedElement::get_djacobian_dparameter()</a>, <a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a63bf8f3db94fdb4098ff61fa930a6d40">oomph::GeneralisedElement::get_dresiduals_dparameter()</a>, <a class="el" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html#a8891ed97a65045e43f906237b109dad2">oomph::DoubleVectorWithHaloEntries::global_value()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a37204f67b37d212fd170c68d48f6da57">oomph::GeneralisedElement::ndof()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a614de1eea213de58687ed161fc7c53ae">Solve_which_system</a>, and <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a289ce15584734b8ea50cd9a7f7f430ed">Y</a>.</p>

</div>
</div>
<a id="a9d5e1388fe0ede6834a249b98168b71a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d5e1388fe0ede6834a249b98168b71a">&#9670;&nbsp;</a></span>get_eigenfunction()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::PitchForkHandler::get_eigenfunction </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>eigenfunction</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Return the eigenfunction(s) associated with the bifurcation that has been detected in bifurcation tracking problems </p>

<p>Reimplemented from <a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a6d614b1b3809d0eb7ceb393e3ae9594f">oomph::AssemblyHandler</a>.</p>
<div class="fragment"><div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;  {</div>
<div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;    <span class="comment">// There is only one (real) null vector</span></div>
<div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;    eigenfunction.resize(1);</div>
<div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;    <span class="comment">// Rebuild the vector</span></div>
<div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;    eigenfunction[0].build(this-&gt;<a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a075f47b5f8941d25796f96d258a1752e">Dof_distribution_pt</a>, 0.0);</div>
<div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;    <span class="comment">// Set the value to be the null vector</span></div>
<div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_row_local = eigenfunction[0].nrow_local();</div>
<div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_row_local; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;    {</div>
<div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;      eigenfunction[0][<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>] = <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a289ce15584734b8ea50cd9a7f7f430ed">Y</a>[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>];</div>
<div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;    }</div>
<div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a075f47b5f8941d25796f96d258a1752e">Dof_distribution_pt</a>, <a class="el" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>, and <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a289ce15584734b8ea50cd9a7f7f430ed">Y</a>.</p>

</div>
</div>
<a id="a85e7dba2d21c9fe95a575a115cf3ee9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85e7dba2d21c9fe95a575a115cf3ee9f">&#9670;&nbsp;</a></span>get_hessian_vector_products()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::PitchForkHandler::get_hessian_vector_products </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html">GeneralisedElement</a> *const &amp;&#160;</td>
          <td class="paramname"><em>elem_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; const &amp;&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; const &amp;&#160;</td>
          <td class="paramname"><em>C</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>product</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Overload the hessian vector product function so that it breaks</p>
<p>Overload the hessian vector product function so that it calls the underlying element's hessian function. </p>

<p>Reimplemented from <a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a296bef49838d23522bb660c4c5207f03">oomph::AssemblyHandler</a>.</p>
<div class="fragment"><div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;  {</div>
<div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;    elem_pt-&gt;get_hessian_vector_products(<a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a289ce15584734b8ea50cd9a7f7f430ed">Y</a>, <a class="code" href="../../d6/d74/classoomph_1_1Matrix.html">C</a>, <a class="code" href="../../dc/daa/product_8h.html#a9ea93a3bb5ed3a3517d5db341bae0238">product</a>);</div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;  }</div>
<div class="ttc" id="aproduct_8h_html_a9ea93a3bb5ed3a3517d5db341bae0238"><div class="ttname"><a href="../../dc/daa/product_8h.html#a9ea93a3bb5ed3a3517d5db341bae0238">product</a></div><div class="ttdeci">void product(const MatrixType &amp;m)</div><div class="ttdef"><b>Definition:</b> product.h:42</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a1fbe77c663eefdf38a0c95f62f6e51bb">oomph::GeneralisedElement::get_hessian_vector_products()</a>, <a class="el" href="../../dc/daa/product_8h.html#a9ea93a3bb5ed3a3517d5db341bae0238">product()</a>, and <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a289ce15584734b8ea50cd9a7f7f430ed">Y</a>.</p>

</div>
</div>
<a id="aa6728813a099111bee2b6c79dec20fc4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6728813a099111bee2b6c79dec20fc4">&#9670;&nbsp;</a></span>get_jacobian()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::PitchForkHandler::get_jacobian </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html">GeneralisedElement</a> *const &amp;&#160;</td>
          <td class="paramname"><em>elem_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>residuals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>jacobian</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Calculate the elemental Jacobian matrix "d equation
/ d variable". </p>
<p>ALICE:</p>
<p>ALICE</p>

<p>Reimplemented from <a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#ad43c3d8760be0ba6ebee8d82509458e5">oomph::AssemblyHandler</a>.</p>
<div class="fragment"><div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;  {</div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;    <span class="keywordtype">unsigned</span> augmented_ndof = <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ae066fa45e9f1bf10601286ca2d083a42">ndof</a>(elem_pt);</div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;    <span class="keywordtype">unsigned</span> raw_ndof = elem_pt-&gt;ndof();</div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160; </div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;    <span class="comment">// Which system are we solving</span></div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a614de1eea213de58687ed161fc7c53ae">Solve_which_system</a>)</div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;    {</div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;        <span class="comment">// If we are solving the original system</span></div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93ae729c94eb567cd88e0b33dc29d9f8d5d">Block_J</a>:</div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;      {</div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;        <span class="comment">// get the raw residuals and jacobian</span></div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;        elem_pt-&gt;get_jacobian(residuals, jacobian);</div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160; </div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;        <span class="comment">// Now multiply to fill in the residuals for the final term</span></div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; raw_ndof; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;        {</div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;          <span class="keywordtype">unsigned</span> local_eqn = elem_pt-&gt;eqn_number(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;          <span class="comment">// Add the slack parameter to the final residuals</span></div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;          residuals[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] +=</div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;            <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a56a173cbdf59e73728c9c1b8c5221817">Sigma</a> * <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aa04d0f340d919d4da3f9199eb76649b1">Psi</a>.<a class="code" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html#a8891ed97a65045e43f906237b109dad2">global_value</a>(local_eqn) / <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ad3f5fc1d7ee4918c9734e59e0611a62c">Count</a>.<a class="code" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html#a8891ed97a65045e43f906237b109dad2">global_value</a>(local_eqn);</div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;        }</div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;      }</div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160; </div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;      <span class="comment">// If we are solving the augmented-by-one system</span></div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93ac8e196e66210e158988de0bfebcdf6a5">Block_augmented_J</a>:</div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;      {</div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;        <span class="comment">// Get the full residuals, we need them</span></div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;        <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a461b24284da88b9489d720e484a6925c">get_residuals</a>(elem_pt, residuals);</div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160; </div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;        <span class="comment">// Need to get the raw jacobian (and raw residuals)</span></div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;        Vector&lt;double&gt; newres(augmented_ndof);</div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;        elem_pt-&gt;get_jacobian(newres, jacobian);</div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160; </div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;        <span class="comment">// Now do finite differencing stuff</span></div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="../../d5/d65/namespaceoomph_1_1BlackBoxFDNewtonSolver.html#a6f0d2ceb4451e66bb7ef4ab4fdb62bcf">FD_step</a> = 1.0e-8;</div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;        <span class="comment">// Fill in the first lot of finite differences</span></div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;        {</div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;          <span class="comment">// increase the global parameter</span></div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;          <span class="keywordtype">double</span>* unknown_pt = <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aa0e8800d56e68fcb63ec2315f503cab2">Parameter_pt</a>;</div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;          <span class="keywordtype">double</span> <a class="code" href="../../d0/d02/structinit.html">init</a> = *unknown_pt;</div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;          *unknown_pt += <a class="code" href="../../d5/d65/namespaceoomph_1_1BlackBoxFDNewtonSolver.html#a6f0d2ceb4451e66bb7ef4ab4fdb62bcf">FD_step</a>;</div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160; </div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;          <span class="comment">// Not do any possible updates</span></div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;          <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a5f08629e3c9c72b441ec7f19f175b2c7">actions_after_change_in_bifurcation_parameter</a>();</div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160; </div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;          <span class="comment">// Get the new (modified) residuals</span></div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;          <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a461b24284da88b9489d720e484a6925c">get_residuals</a>(elem_pt, newres);</div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160; </div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;          <span class="comment">// The final column  is given by the difference</span></div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;          <span class="comment">// between the residuals</span></div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; raw_ndof; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;          {</div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;            jacobian(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>, augmented_ndof - 1) =</div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;              (newres[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>] - residuals[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>]) / <a class="code" href="../../d5/d65/namespaceoomph_1_1BlackBoxFDNewtonSolver.html#a6f0d2ceb4451e66bb7ef4ab4fdb62bcf">FD_step</a>;</div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;          }</div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;          <span class="comment">// Reset the global parameter</span></div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;          *unknown_pt = <a class="code" href="../../d0/d02/structinit.html">init</a>;</div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160; </div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;          <span class="comment">// Now do any possible updates</span></div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;          <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a5f08629e3c9c72b441ec7f19f175b2c7">actions_after_change_in_bifurcation_parameter</a>();</div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;        }</div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160; </div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;        <span class="comment">// Fill in the bottom row</span></div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; raw_ndof; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;        {</div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;          <span class="keywordtype">unsigned</span> local_eqn = elem_pt-&gt;eqn_number(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>);</div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;          jacobian(augmented_ndof - 1, <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>) =</div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;            <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aa04d0f340d919d4da3f9199eb76649b1">Psi</a>.<a class="code" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html#a8891ed97a65045e43f906237b109dad2">global_value</a>(local_eqn) / <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ad3f5fc1d7ee4918c9734e59e0611a62c">Count</a>.<a class="code" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html#a8891ed97a65045e43f906237b109dad2">global_value</a>(local_eqn);</div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;        }</div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;      }</div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160; </div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;      <span class="comment">// Otherwise solving the full system</span></div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93a0e7d0b0eb06a1f2d90a3ab2831bec36d">Full_augmented</a>:</div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;      {</div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;        <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae6ad96ddf5d48b517b89c9a9b879bc4b">actions_before_newton_convergence_check</a>();</div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;        <span class="comment">// Get the basic jacobian and residuals</span></div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;        elem_pt-&gt;get_jacobian(residuals, jacobian);</div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;        <span class="comment">// get the proper residuals</span></div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;        <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a461b24284da88b9489d720e484a6925c">get_residuals</a>(elem_pt, residuals);</div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160; </div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;        <span class="comment">// Now fill in the next diagonal jacobian entry</span></div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; raw_ndof; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;        {</div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> = 0; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> &lt; raw_ndof; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>++)</div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;          {</div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;            jacobian(raw_ndof + 1 + <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>, raw_ndof + 1 + <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>) = jacobian(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>, <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>);</div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;          }</div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;          <span class="keywordtype">unsigned</span> local_eqn = elem_pt-&gt;eqn_number(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>);</div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;          <span class="comment">// Add in the sigma contribution</span></div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;          jacobian(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>, 2 * raw_ndof + 1) =</div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;            <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aa04d0f340d919d4da3f9199eb76649b1">Psi</a>.<a class="code" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html#a8891ed97a65045e43f906237b109dad2">global_value</a>(local_eqn) / <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ad3f5fc1d7ee4918c9734e59e0611a62c">Count</a>.<a class="code" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html#a8891ed97a65045e43f906237b109dad2">global_value</a>(local_eqn);</div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;          <span class="comment">// Symmetry constraint</span></div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;          jacobian(raw_ndof, <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>) =</div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;            <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aa04d0f340d919d4da3f9199eb76649b1">Psi</a>.<a class="code" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html#a8891ed97a65045e43f906237b109dad2">global_value</a>(local_eqn) / <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ad3f5fc1d7ee4918c9734e59e0611a62c">Count</a>.<a class="code" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html#a8891ed97a65045e43f906237b109dad2">global_value</a>(local_eqn);</div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;          <span class="comment">// Non-zero constraint</span></div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;          jacobian(2 * raw_ndof + 1, raw_ndof + 1 + <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>) =</div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;            <a class="code" href="../../d6/d74/classoomph_1_1Matrix.html">C</a>.global_value(local_eqn) / <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ad3f5fc1d7ee4918c9734e59e0611a62c">Count</a>.<a class="code" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html#a8891ed97a65045e43f906237b109dad2">global_value</a>(local_eqn);</div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;        }</div>
<div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160; </div>
<div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;        <span class="comment">// Finite difference the remaining blocks</span></div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="../../d5/d65/namespaceoomph_1_1BlackBoxFDNewtonSolver.html#a6f0d2ceb4451e66bb7ef4ab4fdb62bcf">FD_step</a> = 1.0e-8;</div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160; </div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;        Vector&lt;double&gt; newres_p(augmented_ndof);</div>
<div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160; </div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;        <span class="comment">// Loop over the ndofs only</span></div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; raw_ndof; ++<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>)</div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;        {</div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;          <span class="comment">// Get the original (unaugmented) global equation number</span></div>
<div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> global_eqn =</div>
<div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;            <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a40358960131e00efd6bd0febd397a3ef">Assembly_handler_pt</a>-&gt;<a class="code" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a94d28e2de2559cde803d1ba2195b5290">eqn_number</a>(elem_pt, <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>);</div>
<div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;          <span class="keywordtype">double</span>* unknown_pt = <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a491354401f780ccc114ceb76f5cacef0">global_dof_pt</a>(global_eqn);</div>
<div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;          <span class="keywordtype">double</span> <a class="code" href="../../d0/d02/structinit.html">init</a> = *unknown_pt;</div>
<div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;          *unknown_pt += <a class="code" href="../../d5/d65/namespaceoomph_1_1BlackBoxFDNewtonSolver.html#a6f0d2ceb4451e66bb7ef4ab4fdb62bcf">FD_step</a>;</div>
<div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;          <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae6ad96ddf5d48b517b89c9a9b879bc4b">actions_before_newton_convergence_check</a>();</div>
<div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;          <span class="comment">// Get the new residuals</span></div>
<div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;          <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a461b24284da88b9489d720e484a6925c">get_residuals</a>(elem_pt, newres_p);</div>
<div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;          <span class="comment">// Fill in the entries in the block d(Jy)/dx</span></div>
<div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> = 0; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> &lt; raw_ndof; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>++)</div>
<div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;          {</div>
<div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;            jacobian(raw_ndof + 1 + <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>, <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>) =</div>
<div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;              (newres_p[raw_ndof + 1 + <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>] - residuals[raw_ndof + 1 + <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>]) /</div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;              (<a class="code" href="../../d5/d65/namespaceoomph_1_1BlackBoxFDNewtonSolver.html#a6f0d2ceb4451e66bb7ef4ab4fdb62bcf">FD_step</a>);</div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;          }</div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160; </div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;          <span class="comment">// Reset the unknown</span></div>
<div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;          *unknown_pt = <a class="code" href="../../d0/d02/structinit.html">init</a>;</div>
<div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;          <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae6ad96ddf5d48b517b89c9a9b879bc4b">actions_before_newton_convergence_check</a>();</div>
<div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;        }</div>
<div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160; </div>
<div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;        {</div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;          <span class="comment">// Now increase the global parameter</span></div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;          <span class="keywordtype">double</span>* unknown_pt = <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aa0e8800d56e68fcb63ec2315f503cab2">Parameter_pt</a>;</div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;          <span class="keywordtype">double</span> <a class="code" href="../../d0/d02/structinit.html">init</a> = *unknown_pt;</div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;          *unknown_pt += <a class="code" href="../../d5/d65/namespaceoomph_1_1BlackBoxFDNewtonSolver.html#a6f0d2ceb4451e66bb7ef4ab4fdb62bcf">FD_step</a>;</div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160; </div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;          <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a5f08629e3c9c72b441ec7f19f175b2c7">actions_after_change_in_bifurcation_parameter</a>();</div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;          <span class="comment">// Get the new residuals</span></div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;          <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a461b24284da88b9489d720e484a6925c">get_residuals</a>(elem_pt, newres_p);</div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160; </div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;          <span class="comment">// Add in the first block d/dx</span></div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> = 0; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> &lt; raw_ndof; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>++)</div>
<div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;          {</div>
<div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;            jacobian(<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>, raw_ndof) = (newres_p[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>] - residuals[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>]) / <a class="code" href="../../d5/d65/namespaceoomph_1_1BlackBoxFDNewtonSolver.html#a6f0d2ceb4451e66bb7ef4ab4fdb62bcf">FD_step</a>;</div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;          }</div>
<div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;          <span class="comment">// Add in the second block d/dy</span></div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> = raw_ndof + 1; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> &lt; augmented_ndof - 1; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>++)</div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;          {</div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;            jacobian(<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>, raw_ndof) = (newres_p[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>] - residuals[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>]) / <a class="code" href="../../d5/d65/namespaceoomph_1_1BlackBoxFDNewtonSolver.html#a6f0d2ceb4451e66bb7ef4ab4fdb62bcf">FD_step</a>;</div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;          }</div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160; </div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;          <span class="comment">// Reset the unknown</span></div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;          *unknown_pt = <a class="code" href="../../d0/d02/structinit.html">init</a>;</div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;          <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a5f08629e3c9c72b441ec7f19f175b2c7">actions_after_change_in_bifurcation_parameter</a>();</div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;        }</div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;      }</div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160; </div>
<div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;        std::ostringstream error_stream;</div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;        error_stream</div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;The Solve_which_system flag can only take values 0, 1, 2&quot;</span></div>
<div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;          &lt;&lt; <span class="stringliteral">&quot; not &quot;</span> &lt;&lt; <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a614de1eea213de58687ed161fc7c53ae">Solve_which_system</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;          error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;    }</div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;    <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a5f08629e3c9c72b441ec7f19f175b2c7">actions_after_change_in_bifurcation_parameter</a>();</div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1AssemblyHandler_html_a94d28e2de2559cde803d1ba2195b5290"><div class="ttname"><a href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a94d28e2de2559cde803d1ba2195b5290">oomph::AssemblyHandler::eqn_number</a></div><div class="ttdeci">virtual unsigned long eqn_number(GeneralisedElement *const &amp;elem_pt, const unsigned &amp;ieqn_local)</div><div class="ttdef"><b>Definition:</b> assembly_handler.cc:82</div></div>
<div class="ttc" id="aclassoomph_1_1PitchForkHandler_html_a461b24284da88b9489d720e484a6925c"><div class="ttname"><a href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a461b24284da88b9489d720e484a6925c">oomph::PitchForkHandler::get_residuals</a></div><div class="ttdeci">void get_residuals(GeneralisedElement *const &amp;elem_pt, Vector&lt; double &gt; &amp;residuals)</div><div class="ttdoc">Get the residuals.</div><div class="ttdef"><b>Definition:</b> assembly_handler.cc:3034</div></div>
<div class="ttc" id="aclassoomph_1_1PitchForkHandler_html_ae066fa45e9f1bf10601286ca2d083a42"><div class="ttname"><a href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ae066fa45e9f1bf10601286ca2d083a42">oomph::PitchForkHandler::ndof</a></div><div class="ttdeci">unsigned ndof(GeneralisedElement *const &amp;elem_pt)</div><div class="ttdoc">Get the number of elemental degrees of freedom.</div><div class="ttdef"><b>Definition:</b> assembly_handler.cc:2944</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a491354401f780ccc114ceb76f5cacef0"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a491354401f780ccc114ceb76f5cacef0">oomph::Problem::global_dof_pt</a></div><div class="ttdeci">double * global_dof_pt(const unsigned &amp;i)</div><div class="ttdef"><b>Definition:</b> problem.h:1764</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a5f08629e3c9c72b441ec7f19f175b2c7"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a5f08629e3c9c72b441ec7f19f175b2c7">oomph::Problem::actions_after_change_in_bifurcation_parameter</a></div><div class="ttdeci">virtual void actions_after_change_in_bifurcation_parameter()</div><div class="ttdef"><b>Definition:</b> problem.h:1151</div></div>
<div class="ttc" id="alevel2__cplx__impl_8h_html_a8d334fd8388055a029936c59d361ff00"><div class="ttname"><a href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a></div><div class="ttdeci">int * m</div><div class="ttdef"><b>Definition:</b> level2_cplx_impl.h:294</div></div>
<div class="ttc" id="anamespaceoomph_1_1BlackBoxFDNewtonSolver_html_a6f0d2ceb4451e66bb7ef4ab4fdb62bcf"><div class="ttname"><a href="../../d5/d65/namespaceoomph_1_1BlackBoxFDNewtonSolver.html#a6f0d2ceb4451e66bb7ef4ab4fdb62bcf">oomph::BlackBoxFDNewtonSolver::FD_step</a></div><div class="ttdeci">double FD_step</div><div class="ttdoc">FD step.</div><div class="ttdef"><b>Definition:</b> black_box_newton_solver.cc:54</div></div>
<div class="ttc" id="astructinit_html"><div class="ttname"><a href="../../d0/d02/structinit.html">init</a></div><div class="ttdef"><b>Definition:</b> TutorialInplaceLU.cpp:2</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5f08629e3c9c72b441ec7f19f175b2c7">oomph::Problem::actions_after_change_in_bifurcation_parameter()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae6ad96ddf5d48b517b89c9a9b879bc4b">oomph::Problem::actions_before_newton_convergence_check()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a40358960131e00efd6bd0febd397a3ef">Assembly_handler_pt</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93ac8e196e66210e158988de0bfebcdf6a5">Block_augmented_J</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93ae729c94eb567cd88e0b33dc29d9f8d5d">Block_J</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ad3f5fc1d7ee4918c9734e59e0611a62c">Count</a>, <a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a37ac5a1d5234fa931ab710c0c74d55d2">oomph::GeneralisedElement::eqn_number()</a>, <a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a94d28e2de2559cde803d1ba2195b5290">oomph::AssemblyHandler::eqn_number()</a>, <a class="el" href="../../d5/d65/namespaceoomph_1_1BlackBoxFDNewtonSolver.html#a6f0d2ceb4451e66bb7ef4ab4fdb62bcf">oomph::BlackBoxFDNewtonSolver::FD_step</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93a0e7d0b0eb06a1f2d90a3ab2831bec36d">Full_augmented</a>, <a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#ab915bdad7e6643e5e73a6d98bc7cf48e">oomph::GeneralisedElement::get_jacobian()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a461b24284da88b9489d720e484a6925c">get_residuals()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a491354401f780ccc114ceb76f5cacef0">oomph::Problem::global_dof_pt()</a>, <a class="el" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html#a8891ed97a65045e43f906237b109dad2">oomph::DoubleVectorWithHaloEntries::global_value()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>, <a class="el" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>, <a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a37204f67b37d212fd170c68d48f6da57">oomph::GeneralisedElement::ndof()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ae066fa45e9f1bf10601286ca2d083a42">ndof()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aa0e8800d56e68fcb63ec2315f503cab2">Parameter_pt</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aa04d0f340d919d4da3f9199eb76649b1">Psi</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a56a173cbdf59e73728c9c1b8c5221817">Sigma</a>, and <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a614de1eea213de58687ed161fc7c53ae">Solve_which_system</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../de/d72/classoomph_1_1AugmentedBlockPitchForkLinearSolver.html#a1d617896a3f1c1b1236ff18dc87ed8d7">oomph::AugmentedBlockPitchForkLinearSolver::resolve()</a>, and <a class="el" href="../../de/d72/classoomph_1_1AugmentedBlockPitchForkLinearSolver.html#a0cbeb150ac83d5be1a1e30c0f728a70b">oomph::AugmentedBlockPitchForkLinearSolver::solve()</a>.</p>

</div>
</div>
<a id="a461b24284da88b9489d720e484a6925c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a461b24284da88b9489d720e484a6925c">&#9670;&nbsp;</a></span>get_residuals()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::PitchForkHandler::get_residuals </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html">GeneralisedElement</a> *const &amp;&#160;</td>
          <td class="paramname"><em>elem_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>residuals</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the residuals. </p>

<p>Reimplemented from <a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a7a6203b0ab90da62b4da2af8a26d08b3">oomph::AssemblyHandler</a>.</p>
<div class="fragment"><div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;  {</div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;    <span class="comment">// Need to get raw residuals and jacobian</span></div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;    <span class="keywordtype">unsigned</span> raw_ndof = elem_pt-&gt;ndof();</div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160; </div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;    <span class="comment">// Find out which system we are solving</span></div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a614de1eea213de58687ed161fc7c53ae">Solve_which_system</a>)</div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;    {</div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;        <span class="comment">// If we are solving the original system</span></div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93ae729c94eb567cd88e0b33dc29d9f8d5d">Block_J</a>:</div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;      {</div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;        <span class="comment">// get the basic residuals</span></div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;        elem_pt-&gt;get_residuals(residuals);</div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;        <span class="comment">// Now multiply to fill in the residuals for the final term</span></div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; raw_ndof; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;        {</div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;          <span class="keywordtype">unsigned</span> local_eqn = elem_pt-&gt;eqn_number(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;          <span class="comment">// Add the slack parameter to the final residuals</span></div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;          residuals[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] +=</div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;            <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a56a173cbdf59e73728c9c1b8c5221817">Sigma</a> * <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aa04d0f340d919d4da3f9199eb76649b1">Psi</a>.<a class="code" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html#a8891ed97a65045e43f906237b109dad2">global_value</a>(local_eqn) / <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ad3f5fc1d7ee4918c9734e59e0611a62c">Count</a>.<a class="code" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html#a8891ed97a65045e43f906237b109dad2">global_value</a>(local_eqn);</div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;        }</div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;      }</div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160; </div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;      <span class="comment">// If we are solving the augmented-by-one system</span></div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93ac8e196e66210e158988de0bfebcdf6a5">Block_augmented_J</a>:</div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;      {</div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;        <span class="comment">// Get the basic residuals</span></div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;        elem_pt-&gt;get_residuals(residuals);</div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160; </div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;        <span class="comment">// Zero the final residual</span></div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;        residuals[raw_ndof] = 0.0;</div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;        <span class="comment">// Now multiply to fill in the residuals for the final term</span></div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; raw_ndof; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;        {</div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;          <span class="keywordtype">unsigned</span> local_eqn = elem_pt-&gt;eqn_number(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;          <span class="comment">// Add the slack parameter to the final residuals</span></div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;          residuals[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] +=</div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;            <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a56a173cbdf59e73728c9c1b8c5221817">Sigma</a> * <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aa04d0f340d919d4da3f9199eb76649b1">Psi</a>.<a class="code" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html#a8891ed97a65045e43f906237b109dad2">global_value</a>(local_eqn) / <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ad3f5fc1d7ee4918c9734e59e0611a62c">Count</a>.<a class="code" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html#a8891ed97a65045e43f906237b109dad2">global_value</a>(local_eqn);</div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;          <span class="comment">// Final term that specifies the symmetry</span></div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;          residuals[raw_ndof] += ((*<a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a491354401f780ccc114ceb76f5cacef0">global_dof_pt</a>(local_eqn)) *</div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;                                  <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aa04d0f340d919d4da3f9199eb76649b1">Psi</a>.<a class="code" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html#a8891ed97a65045e43f906237b109dad2">global_value</a>(local_eqn)) /</div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;                                 <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ad3f5fc1d7ee4918c9734e59e0611a62c">Count</a>.<a class="code" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html#a8891ed97a65045e43f906237b109dad2">global_value</a>(local_eqn);</div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;        }</div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;      }</div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160; </div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;      <span class="comment">// Otherwise we are solving the fully augemented system</span></div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93a0e7d0b0eb06a1f2d90a3ab2831bec36d">Full_augmented</a>:</div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;      {</div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;        <a class="code" href="../../dc/d34/classEigen_1_1Matrix.html">DenseMatrix&lt;double&gt;</a> jacobian(raw_ndof);</div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160; </div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;        <span class="comment">// Get the basic residuals and jacobian</span></div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;        elem_pt-&gt;get_jacobian(residuals, jacobian);</div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160; </div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;        <span class="comment">// Initialise the final residuals</span></div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;        residuals[raw_ndof] = 0.0;</div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;        residuals[2 * raw_ndof + 1] = -1.0 / <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ac85263fcd40fa913e4bc12c07f6b7343">Nelement</a>;</div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160; </div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;        <span class="comment">// Now multiply to fill in the residuals associated</span></div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;        <span class="comment">// with the null vector condition</span></div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; raw_ndof; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;        {</div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;          <span class="keywordtype">unsigned</span> local_eqn = elem_pt-&gt;eqn_number(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;          residuals[raw_ndof + 1 + <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = 0.0;</div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; raw_ndof; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;          {</div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;            <span class="keywordtype">unsigned</span> local_unknown = elem_pt-&gt;eqn_number(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;            residuals[raw_ndof + 1 + <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] +=</div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;              jacobian(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) * <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a289ce15584734b8ea50cd9a7f7f430ed">Y</a>.<a class="code" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html#a8891ed97a65045e43f906237b109dad2">global_value</a>(local_unknown);</div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;          }</div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160; </div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;          <span class="comment">// Add the slack parameter to the governing equations</span></div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;          residuals[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] +=</div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;            <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a56a173cbdf59e73728c9c1b8c5221817">Sigma</a> * <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aa04d0f340d919d4da3f9199eb76649b1">Psi</a>.<a class="code" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html#a8891ed97a65045e43f906237b109dad2">global_value</a>(local_eqn) / <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ad3f5fc1d7ee4918c9734e59e0611a62c">Count</a>.<a class="code" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html#a8891ed97a65045e43f906237b109dad2">global_value</a>(local_eqn);</div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160; </div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;          <span class="comment">// Specify the symmetry</span></div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;          residuals[raw_ndof] += ((*<a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a491354401f780ccc114ceb76f5cacef0">global_dof_pt</a>(local_eqn)) *</div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;                                  <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aa04d0f340d919d4da3f9199eb76649b1">Psi</a>.<a class="code" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html#a8891ed97a65045e43f906237b109dad2">global_value</a>(local_eqn)) /</div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;                                 <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ad3f5fc1d7ee4918c9734e59e0611a62c">Count</a>.<a class="code" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html#a8891ed97a65045e43f906237b109dad2">global_value</a>(local_eqn);</div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;          <span class="comment">// Specify the normalisation</span></div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;          residuals[2 * raw_ndof + 1] +=</div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;            (<a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a289ce15584734b8ea50cd9a7f7f430ed">Y</a>.<a class="code" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html#a8891ed97a65045e43f906237b109dad2">global_value</a>(local_eqn) * <a class="code" href="../../d6/d74/classoomph_1_1Matrix.html">C</a>.global_value(local_eqn)) /</div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;            <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ad3f5fc1d7ee4918c9734e59e0611a62c">Count</a>.<a class="code" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html#a8891ed97a65045e43f906237b109dad2">global_value</a>(local_eqn);</div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;        }</div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;      }</div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160; </div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;        std::ostringstream error_stream;</div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;        error_stream</div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;The Solve_which_system flag can only take values 0, 1, 2&quot;</span></div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;          &lt;&lt; <span class="stringliteral">&quot; not &quot;</span> &lt;&lt; <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a614de1eea213de58687ed161fc7c53ae">Solve_which_system</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;          error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;    }</div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93ac8e196e66210e158988de0bfebcdf6a5">Block_augmented_J</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93ae729c94eb567cd88e0b33dc29d9f8d5d">Block_J</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ad3f5fc1d7ee4918c9734e59e0611a62c">Count</a>, <a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a37ac5a1d5234fa931ab710c0c74d55d2">oomph::GeneralisedElement::eqn_number()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93a0e7d0b0eb06a1f2d90a3ab2831bec36d">Full_augmented</a>, <a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#ab915bdad7e6643e5e73a6d98bc7cf48e">oomph::GeneralisedElement::get_jacobian()</a>, <a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a53d348ab71c86b53619129a1dd411d30">oomph::GeneralisedElement::get_residuals()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a491354401f780ccc114ceb76f5cacef0">oomph::Problem::global_dof_pt()</a>, <a class="el" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html#a8891ed97a65045e43f906237b109dad2">oomph::DoubleVectorWithHaloEntries::global_value()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a37204f67b37d212fd170c68d48f6da57">oomph::GeneralisedElement::ndof()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ac85263fcd40fa913e4bc12c07f6b7343">Nelement</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aa04d0f340d919d4da3f9199eb76649b1">Psi</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a56a173cbdf59e73728c9c1b8c5221817">Sigma</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a614de1eea213de58687ed161fc7c53ae">Solve_which_system</a>, and <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a289ce15584734b8ea50cd9a7f7f430ed">Y</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aa6728813a099111bee2b6c79dec20fc4">get_jacobian()</a>.</p>

</div>
</div>
<a id="ac1a4bbb1415a009e9f176f16263fcb3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1a4bbb1415a009e9f176f16263fcb3e">&#9670;&nbsp;</a></span>global_eqn_number()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> oomph::PitchForkHandler::global_eqn_number </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Function that is used to return map the global equations using the simplistic numbering scheme into the actual distributed scheme </p>
<div class="fragment"><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    {</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;      <span class="comment">// If the problem is distributed I have to do something</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;      <span class="keywordflow">if</span> (Distributed)</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;      {</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ac7010a8c64237d76cb0f23bfad126e07">Global_eqn_number</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;      }</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;      <span class="comment">// Otherwise it&#39;s just i</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;      {</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;      }</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ac7010a8c64237d76cb0f23bfad126e07">Global_eqn_number</a>, and <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ab29e58e25bd5bebd836e30015f01ac8d">eqn_number()</a>.</p>

</div>
</div>
<a id="ae066fa45e9f1bf10601286ca2d083a42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae066fa45e9f1bf10601286ca2d083a42">&#9670;&nbsp;</a></span>ndof()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> oomph::PitchForkHandler::ndof </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html">GeneralisedElement</a> *const &amp;&#160;</td>
          <td class="paramname"><em>elem_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the number of elemental degrees of freedom. </p>

<p>Reimplemented from <a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a09213be8f4aa009e0366460a7ed78e68">oomph::AssemblyHandler</a>.</p>
<div class="fragment"><div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;  {</div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;    <span class="keywordtype">unsigned</span> raw_ndof = elem_pt-&gt;ndof();</div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160; </div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;    <span class="comment">// Return different values depending on the type of block decomposition</span></div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a614de1eea213de58687ed161fc7c53ae">Solve_which_system</a>)</div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;    {</div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93a0e7d0b0eb06a1f2d90a3ab2831bec36d">Full_augmented</a>:</div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;        <span class="keywordflow">return</span> (2 * raw_ndof + 2);</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160; </div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93ac8e196e66210e158988de0bfebcdf6a5">Block_augmented_J</a>:</div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;        <span class="keywordflow">return</span> (raw_ndof + 1);</div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160; </div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93ae729c94eb567cd88e0b33dc29d9f8d5d">Block_J</a>:</div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;        <span class="keywordflow">return</span> raw_ndof;</div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160; </div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;        std::ostringstream error_stream;</div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;        error_stream</div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;The Solve_which_system flag can only take values 0, 1, 2&quot;</span></div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;          &lt;&lt; <span class="stringliteral">&quot; not &quot;</span> &lt;&lt; <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a614de1eea213de58687ed161fc7c53ae">Solve_which_system</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;          error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;    }</div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93ac8e196e66210e158988de0bfebcdf6a5">Block_augmented_J</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93ae729c94eb567cd88e0b33dc29d9f8d5d">Block_J</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93a0e7d0b0eb06a1f2d90a3ab2831bec36d">Full_augmented</a>, <a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a37204f67b37d212fd170c68d48f6da57">oomph::GeneralisedElement::ndof()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, and <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a614de1eea213de58687ed161fc7c53ae">Solve_which_system</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aa6728813a099111bee2b6c79dec20fc4">get_jacobian()</a>, <a class="el" href="../../de/d72/classoomph_1_1AugmentedBlockPitchForkLinearSolver.html#a1d617896a3f1c1b1236ff18dc87ed8d7">oomph::AugmentedBlockPitchForkLinearSolver::resolve()</a>, and <a class="el" href="../../de/d72/classoomph_1_1AugmentedBlockPitchForkLinearSolver.html#a0cbeb150ac83d5be1a1e30c0f728a70b">oomph::AugmentedBlockPitchForkLinearSolver::solve()</a>.</p>

</div>
</div>
<a id="ad0b0920383bcbdab5df1f43db5affa47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0b0920383bcbdab5df1f43db5affa47">&#9670;&nbsp;</a></span>solve_augmented_block_system()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::PitchForkHandler::solve_augmented_block_system </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set to solve the augmented block system. </p>
<p>Set to solve the augmented-by-one block system. </p>
<div class="fragment"><div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;  {</div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;    <span class="comment">// Only bother to do anything if we haven&#39;t already set the flag</span></div>
<div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a614de1eea213de58687ed161fc7c53ae">Solve_which_system</a> != <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93ac8e196e66210e158988de0bfebcdf6a5">Block_augmented_J</a>)</div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;    {</div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;      <span class="comment">// If we were solving the system with the original jacobian add the</span></div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;      <span class="comment">// parameter back</span></div>
<div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a614de1eea213de58687ed161fc7c53ae">Solve_which_system</a> == <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93ae729c94eb567cd88e0b33dc29d9f8d5d">Block_J</a>)</div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;      {</div>
<div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;        <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>.push_back(<a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aa0e8800d56e68fcb63ec2315f503cab2">Parameter_pt</a>);</div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;      }</div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160; </div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;      <span class="comment">// Restrict the problem to the standard variables and</span></div>
<div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;      <span class="comment">// the bifurcation parameter only</span></div>
<div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;      <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a> = <span class="keyword">new</span> LinearAlgebraDistribution(</div>
<div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;        <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">communicator_pt</a>(), <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a9314a176be55e7e9c5a359accfbec751">Ndof</a> + 1, <span class="keyword">false</span>);</div>
<div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;      <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>.resize(<a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a9314a176be55e7e9c5a359accfbec751">Ndof</a> + 1);</div>
<div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160; </div>
<div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;      <span class="comment">// Problem_pt-&gt;Dof_pt.resize(Ndof+1);</span></div>
<div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;      <span class="comment">//    Problem_pt-&gt;Dof_distribution_pt-&gt;build(Problem_pt-&gt;communicator_pt(),</span></div>
<div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;      <span class="comment">//                                         Ndof+1,false);</span></div>
<div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160; </div>
<div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;      <span class="comment">// Remove all previous sparse storage used during Jacobian assembly</span></div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;      <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a547c85bfa6a2eb3effc4db1b46ebcdde">Sparse_assemble_with_arrays_previous_allocation</a>.resize(0);</div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160; </div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;      <span class="comment">// Set the solve flag</span></div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;      <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a614de1eea213de58687ed161fc7c53ae">Solve_which_system</a> = <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93ac8e196e66210e158988de0bfebcdf6a5">Block_augmented_J</a>;</div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;    }</div>
<div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93ac8e196e66210e158988de0bfebcdf6a5">Block_augmented_J</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93ae729c94eb567cd88e0b33dc29d9f8d5d">Block_J</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">oomph::Problem::communicator_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">oomph::Problem::Dof_distribution_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">oomph::Problem::Dof_pt</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a9314a176be55e7e9c5a359accfbec751">Ndof</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aa0e8800d56e68fcb63ec2315f503cab2">Parameter_pt</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a614de1eea213de58687ed161fc7c53ae">Solve_which_system</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a547c85bfa6a2eb3effc4db1b46ebcdde">oomph::Problem::Sparse_assemble_with_arrays_previous_allocation</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../de/d72/classoomph_1_1AugmentedBlockPitchForkLinearSolver.html#a1d617896a3f1c1b1236ff18dc87ed8d7">oomph::AugmentedBlockPitchForkLinearSolver::resolve()</a>, and <a class="el" href="../../de/d72/classoomph_1_1AugmentedBlockPitchForkLinearSolver.html#a0cbeb150ac83d5be1a1e30c0f728a70b">oomph::AugmentedBlockPitchForkLinearSolver::solve()</a>.</p>

</div>
</div>
<a id="ad193c3d67741edd60b023c94e42c8802"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad193c3d67741edd60b023c94e42c8802">&#9670;&nbsp;</a></span>solve_block_system()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::PitchForkHandler::solve_block_system </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set to solve the block system. </p>
<p>Set to solve the block system. The boolean flag is used to specify whether the block decomposition should use exactly the same jacobian as the original system. </p>
<div class="fragment"><div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;  {</div>
<div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;    <span class="comment">// Only bother to do anything if we haven&#39;t already set the flag</span></div>
<div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a614de1eea213de58687ed161fc7c53ae">Solve_which_system</a> != <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93ae729c94eb567cd88e0b33dc29d9f8d5d">Block_J</a>)</div>
<div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;    {</div>
<div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;      <span class="comment">// Restrict the problem to the standard variables</span></div>
<div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;      <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>.resize(this-&gt;<a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a075f47b5f8941d25796f96d258a1752e">Dof_distribution_pt</a>-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">nrow_local</a>());</div>
<div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;      <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a> = this-&gt;<a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a075f47b5f8941d25796f96d258a1752e">Dof_distribution_pt</a>;</div>
<div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160; </div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;      <span class="comment">// Problem_pt-&gt;Dof_distribution_pt-&gt;build(Problem_pt-&gt;communicator_pt(),</span></div>
<div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;      <span class="comment">// Ndof,false);</span></div>
<div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160; </div>
<div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;      <span class="comment">// Remove all previous sparse storage used during Jacobian assembly</span></div>
<div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;      <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a547c85bfa6a2eb3effc4db1b46ebcdde">Sparse_assemble_with_arrays_previous_allocation</a>.resize(0);</div>
<div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160; </div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;      <span class="comment">// Set the solve flag</span></div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;      <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a614de1eea213de58687ed161fc7c53ae">Solve_which_system</a> = <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93ae729c94eb567cd88e0b33dc29d9f8d5d">Block_J</a>;</div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;    }</div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93ae729c94eb567cd88e0b33dc29d9f8d5d">Block_J</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a075f47b5f8941d25796f96d258a1752e">Dof_distribution_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">oomph::Problem::Dof_distribution_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">oomph::Problem::Dof_pt</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">oomph::LinearAlgebraDistribution::nrow_local()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a614de1eea213de58687ed161fc7c53ae">Solve_which_system</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a547c85bfa6a2eb3effc4db1b46ebcdde">oomph::Problem::Sparse_assemble_with_arrays_previous_allocation</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a9a424fd2ae0b67ef8c3ff59f16030786">oomph::BlockPitchForkLinearSolver::resolve()</a>, and <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#ad196867613954a8fabd318b50e2aadc6">oomph::BlockPitchForkLinearSolver::solve()</a>.</p>

</div>
</div>
<a id="a27325616f4342d159f6f5e7c82ccdf98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27325616f4342d159f6f5e7c82ccdf98">&#9670;&nbsp;</a></span>solve_full_system()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::PitchForkHandler::solve_full_system </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Solve non-block system. </p>
<div class="fragment"><div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;  {</div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;    <span class="comment">// Only do something if we are not solving the full system</span></div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a614de1eea213de58687ed161fc7c53ae">Solve_which_system</a> != <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93a0e7d0b0eb06a1f2d90a3ab2831bec36d">Full_augmented</a>)</div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;    {</div>
<div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;      <span class="keywordtype">int</span> my_rank = <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">communicator_pt</a>()-&gt;<a class="code" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a670b34aab05bfe0b96d0e0fabf583c7a">my_rank</a>();</div>
<div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;      <span class="comment">// If we were solving the problem without any augementation</span></div>
<div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;      <span class="comment">// add the parameter again</span></div>
<div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a614de1eea213de58687ed161fc7c53ae">Solve_which_system</a> == <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93ae729c94eb567cd88e0b33dc29d9f8d5d">Block_J</a>)</div>
<div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;      {</div>
<div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160; </div>
<div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;        <span class="keywordflow">if</span> ((!Distributed) || (my_rank == 0))</div>
<div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;        {</div>
<div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;          <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>.push_back(<a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aa0e8800d56e68fcb63ec2315f503cab2">Parameter_pt</a>);</div>
<div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;        }</div>
<div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;      }</div>
<div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160; </div>
<div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;      <span class="comment">// Always add the additional unknowns back into the problem</span></div>
<div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_dof_local = <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a075f47b5f8941d25796f96d258a1752e">Dof_distribution_pt</a>-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">nrow_local</a>();</div>
<div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_dof_local; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;      {</div>
<div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;        <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>.push_back(&amp;<a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a289ce15584734b8ea50cd9a7f7f430ed">Y</a>[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>]);</div>
<div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;      }</div>
<div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160; </div>
<div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160; </div>
<div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;      <span class="keywordflow">if</span> ((!Distributed) || (my_rank == 0))</div>
<div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;      <span class="comment">// Add the slack parameter to the problem on the first processor</span></div>
<div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;      <span class="comment">// if distributed</span></div>
<div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;      {</div>
<div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;        <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>.push_back(&amp;<a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a56a173cbdf59e73728c9c1b8c5221817">Sigma</a>);</div>
<div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;      }</div>
<div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160; </div>
<div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160; </div>
<div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;      <span class="comment">// Delete the distribtion created in the augmented block solve</span></div>
<div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a> != this-&gt;Dof_distribution_pt)</div>
<div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;      {</div>
<div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;        <span class="keyword">delete</span> <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>;</div>
<div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;      }</div>
<div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160; </div>
<div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;      <span class="comment">// update the Dof distribution</span></div>
<div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;      <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a> = this-&gt;<a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#af6346c1dc77f3d4fb3dc8950afd91e0f">Augmented_dof_distribution_pt</a>;</div>
<div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;      <span class="comment">// Problem_pt-&gt;Dof_distribution_pt-&gt;build(Problem_pt-&gt;communicator_pt(),</span></div>
<div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;      <span class="comment">//                                       Ndof*2+2,false);</span></div>
<div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;      <span class="comment">// Remove all previous sparse storage used during Jacobian assembly</span></div>
<div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;      <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a547c85bfa6a2eb3effc4db1b46ebcdde">Sparse_assemble_with_arrays_previous_allocation</a>.resize(0);</div>
<div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160; </div>
<div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;      <span class="comment">// Set the solve flag</span></div>
<div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;      <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a614de1eea213de58687ed161fc7c53ae">Solve_which_system</a> = <a class="code" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93a0e7d0b0eb06a1f2d90a3ab2831bec36d">Full_augmented</a>;</div>
<div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;    }</div>
<div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#af6346c1dc77f3d4fb3dc8950afd91e0f">Augmented_dof_distribution_pt</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93ae729c94eb567cd88e0b33dc29d9f8d5d">Block_J</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">oomph::Problem::communicator_pt()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a075f47b5f8941d25796f96d258a1752e">Dof_distribution_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">oomph::Problem::Dof_distribution_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">oomph::Problem::Dof_pt</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a4f9249832460e1583d537ab9e2872c93a0e7d0b0eb06a1f2d90a3ab2831bec36d">Full_augmented</a>, <a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a670b34aab05bfe0b96d0e0fabf583c7a">oomph::OomphCommunicator::my_rank()</a>, <a class="el" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">oomph::LinearAlgebraDistribution::nrow_local()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aa0e8800d56e68fcb63ec2315f503cab2">Parameter_pt</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a196adc8e79a66292d2df9bd9093f8f73">Problem_pt</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a56a173cbdf59e73728c9c1b8c5221817">Sigma</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a614de1eea213de58687ed161fc7c53ae">Solve_which_system</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a547c85bfa6a2eb3effc4db1b46ebcdde">oomph::Problem::Sparse_assemble_with_arrays_previous_allocation</a>, and <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a289ce15584734b8ea50cd9a7f7f430ed">Y</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a9a424fd2ae0b67ef8c3ff59f16030786">oomph::BlockPitchForkLinearSolver::resolve()</a>, <a class="el" href="../../de/d72/classoomph_1_1AugmentedBlockPitchForkLinearSolver.html#a1d617896a3f1c1b1236ff18dc87ed8d7">oomph::AugmentedBlockPitchForkLinearSolver::resolve()</a>, <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#ad196867613954a8fabd318b50e2aadc6">oomph::BlockPitchForkLinearSolver::solve()</a>, and <a class="el" href="../../de/d72/classoomph_1_1AugmentedBlockPitchForkLinearSolver.html#a0cbeb150ac83d5be1a1e30c0f728a70b">oomph::AugmentedBlockPitchForkLinearSolver::solve()</a>.</p>

</div>
</div>
<h2 class="groupheader">Friends And Related Function Documentation</h2>
<a id="a223dd55e02e905ce0ce98e98f50b7e57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a223dd55e02e905ce0ce98e98f50b7e57">&#9670;&nbsp;</a></span>AugmentedBlockPitchForkLinearSolver</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="../../de/d72/classoomph_1_1AugmentedBlockPitchForkLinearSolver.html">AugmentedBlockPitchForkLinearSolver</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aba62ac8cc057be07657972adc4a78b45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba62ac8cc057be07657972adc4a78b45">&#9670;&nbsp;</a></span>BlockPitchForkLinearSolver</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html">BlockPitchForkLinearSolver</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a40358960131e00efd6bd0febd397a3ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40358960131e00efd6bd0febd397a3ef">&#9670;&nbsp;</a></span>Assembly_handler_pt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html">AssemblyHandler</a>* oomph::PitchForkHandler::Assembly_handler_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pointer to the underlying (original) assembly handler. </p>

<p class="reference">Referenced by <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aa6728813a099111bee2b6c79dec20fc4">get_jacobian()</a>, and <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a96e0343c261d087f5d67a49f68561d96">PitchForkHandler()</a>.</p>

</div>
</div>
<a id="af6346c1dc77f3d4fb3dc8950afd91e0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6346c1dc77f3d4fb3dc8950afd91e0f">&#9670;&nbsp;</a></span>Augmented_dof_distribution_pt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a>* oomph::PitchForkHandler::Augmented_dof_distribution_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The augmented distribution. </p>

<p class="reference">Referenced by <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a96e0343c261d087f5d67a49f68561d96">PitchForkHandler()</a>, <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a9a424fd2ae0b67ef8c3ff59f16030786">oomph::BlockPitchForkLinearSolver::resolve()</a>, <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#ad196867613954a8fabd318b50e2aadc6">oomph::BlockPitchForkLinearSolver::solve()</a>, and <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a27325616f4342d159f6f5e7c82ccdf98">solve_full_system()</a>.</p>

</div>
</div>
<a id="a88f5df169c44b02f4ba563cf42241599"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88f5df169c44b02f4ba563cf42241599">&#9670;&nbsp;</a></span>C</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html">DoubleVectorWithHaloEntries</a> oomph::PitchForkHandler::C</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>A constant vector used to ensure that the null vector is not trivial </p>

</div>
</div>
<a id="ad3f5fc1d7ee4918c9734e59e0611a62c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3f5fc1d7ee4918c9734e59e0611a62c">&#9670;&nbsp;</a></span>Count</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html">DoubleVectorWithHaloEntries</a> oomph::PitchForkHandler::Count</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>A vector that is used to determine how many elements contribute to a particular equation. It is used to ensure that the global system is correctly formulated. This should really be an integer, but its double so that the distribution can be used </p>

<p class="reference">Referenced by <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aa6728813a099111bee2b6c79dec20fc4">get_jacobian()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a461b24284da88b9489d720e484a6925c">get_residuals()</a>, and <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a96e0343c261d087f5d67a49f68561d96">PitchForkHandler()</a>.</p>

</div>
</div>
<a id="a075f47b5f8941d25796f96d258a1752e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a075f47b5f8941d25796f96d258a1752e">&#9670;&nbsp;</a></span>Dof_distribution_pt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a>* oomph::PitchForkHandler::Dof_distribution_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Store the original dof distribution. </p>

<p class="reference">Referenced by <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a9d5e1388fe0ede6834a249b98168b71a">get_eigenfunction()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a96e0343c261d087f5d67a49f68561d96">PitchForkHandler()</a>, <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a9a424fd2ae0b67ef8c3ff59f16030786">oomph::BlockPitchForkLinearSolver::resolve()</a>, <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#ad196867613954a8fabd318b50e2aadc6">oomph::BlockPitchForkLinearSolver::solve()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ad193c3d67741edd60b023c94e42c8802">solve_block_system()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a27325616f4342d159f6f5e7c82ccdf98">solve_full_system()</a>, and <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a69c6b0b6aedd03d828d295531fd61820">~PitchForkHandler()</a>.</p>

</div>
</div>
<a id="ac7010a8c64237d76cb0f23bfad126e07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7010a8c64237d76cb0f23bfad126e07">&#9670;&nbsp;</a></span>Global_eqn_number</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt;<a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&gt; oomph::PitchForkHandler::Global_eqn_number</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>A vector that is used to map the global equations to their actual location in a distributed problem </p>

<p class="reference">Referenced by <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ac1a4bbb1415a009e9f176f16263fcb3e">global_eqn_number()</a>, and <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a96e0343c261d087f5d67a49f68561d96">PitchForkHandler()</a>.</p>

</div>
</div>
<a id="a9314a176be55e7e9c5a359accfbec751"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9314a176be55e7e9c5a359accfbec751">&#9670;&nbsp;</a></span>Ndof</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> oomph::PitchForkHandler::Ndof</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Store the number of degrees of freedom in the non-augmented problem </p>

<p class="reference">Referenced by <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ab29e58e25bd5bebd836e30015f01ac8d">eqn_number()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a96e0343c261d087f5d67a49f68561d96">PitchForkHandler()</a>, and <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ad0b0920383bcbdab5df1f43db5affa47">solve_augmented_block_system()</a>.</p>

</div>
</div>
<a id="ac85263fcd40fa913e4bc12c07f6b7343"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac85263fcd40fa913e4bc12c07f6b7343">&#9670;&nbsp;</a></span>Nelement</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> oomph::PitchForkHandler::Nelement</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a461b24284da88b9489d720e484a6925c">get_residuals()</a>, and <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a96e0343c261d087f5d67a49f68561d96">PitchForkHandler()</a>.</p>

</div>
</div>
<a id="aa0e8800d56e68fcb63ec2315f503cab2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0e8800d56e68fcb63ec2315f503cab2">&#9670;&nbsp;</a></span>Parameter_pt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a>* oomph::PitchForkHandler::Parameter_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Storage for the pointer to the parameter. </p>

<p class="reference">Referenced by <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a7363cb34d716d64d891af5018e09d807">bifurcation_parameter_pt()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aa6728813a099111bee2b6c79dec20fc4">get_jacobian()</a>, <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#ad196867613954a8fabd318b50e2aadc6">oomph::BlockPitchForkLinearSolver::solve()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ad0b0920383bcbdab5df1f43db5affa47">solve_augmented_block_system()</a>, and <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a27325616f4342d159f6f5e7c82ccdf98">solve_full_system()</a>.</p>

</div>
</div>
<a id="a196adc8e79a66292d2df9bd9093f8f73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a196adc8e79a66292d2df9bd9093f8f73">&#9670;&nbsp;</a></span>Problem_pt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a>* oomph::PitchForkHandler::Problem_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pointer to the problem. </p>

<p class="reference">Referenced by <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a6510803afcbcfce1ae5b1c1c5d82a541">get_dresiduals_dparameter()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aa6728813a099111bee2b6c79dec20fc4">get_jacobian()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a461b24284da88b9489d720e484a6925c">get_residuals()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a96e0343c261d087f5d67a49f68561d96">PitchForkHandler()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ad0b0920383bcbdab5df1f43db5affa47">solve_augmented_block_system()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ad193c3d67741edd60b023c94e42c8802">solve_block_system()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a27325616f4342d159f6f5e7c82ccdf98">solve_full_system()</a>, and <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a69c6b0b6aedd03d828d295531fd61820">~PitchForkHandler()</a>.</p>

</div>
</div>
<a id="aa04d0f340d919d4da3f9199eb76649b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa04d0f340d919d4da3f9199eb76649b1">&#9670;&nbsp;</a></span>Psi</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html">DoubleVectorWithHaloEntries</a> oomph::PitchForkHandler::Psi</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A constant vector that is specifies the symmetry being broken. </p>

<p class="reference">Referenced by <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aa6728813a099111bee2b6c79dec20fc4">get_jacobian()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a461b24284da88b9489d720e484a6925c">get_residuals()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a96e0343c261d087f5d67a49f68561d96">PitchForkHandler()</a>, <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a9a424fd2ae0b67ef8c3ff59f16030786">oomph::BlockPitchForkLinearSolver::resolve()</a>, <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#ad196867613954a8fabd318b50e2aadc6">oomph::BlockPitchForkLinearSolver::solve()</a>, and <a class="el" href="../../de/d72/classoomph_1_1AugmentedBlockPitchForkLinearSolver.html#a0cbeb150ac83d5be1a1e30c0f728a70b">oomph::AugmentedBlockPitchForkLinearSolver::solve()</a>.</p>

</div>
</div>
<a id="a56a173cbdf59e73728c9c1b8c5221817"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56a173cbdf59e73728c9c1b8c5221817">&#9670;&nbsp;</a></span>Sigma</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> oomph::PitchForkHandler::Sigma</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>A slack variable used to specify the amount of antisymmetry in the solution. </p>

<p class="reference">Referenced by <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aa6728813a099111bee2b6c79dec20fc4">get_jacobian()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a461b24284da88b9489d720e484a6925c">get_residuals()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a96e0343c261d087f5d67a49f68561d96">PitchForkHandler()</a>, and <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a27325616f4342d159f6f5e7c82ccdf98">solve_full_system()</a>.</p>

</div>
</div>
<a id="a614de1eea213de58687ed161fc7c53ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a614de1eea213de58687ed161fc7c53ae">&#9670;&nbsp;</a></span>Solve_which_system</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> oomph::PitchForkHandler::Solve_which_system</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Integer flag to indicate which system should be assembled. There are three possibilities. The full augmented system (0), the non-augmented jacobian system (1), a system in which the jacobian is augmented by 1 row and column to ensure that it is non-singular (2). See the enum above </p>

<p class="reference">Referenced by <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ab29e58e25bd5bebd836e30015f01ac8d">eqn_number()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a6510803afcbcfce1ae5b1c1c5d82a541">get_dresiduals_dparameter()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aa6728813a099111bee2b6c79dec20fc4">get_jacobian()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a461b24284da88b9489d720e484a6925c">get_residuals()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ae066fa45e9f1bf10601286ca2d083a42">ndof()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ad0b0920383bcbdab5df1f43db5affa47">solve_augmented_block_system()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ad193c3d67741edd60b023c94e42c8802">solve_block_system()</a>, and <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a27325616f4342d159f6f5e7c82ccdf98">solve_full_system()</a>.</p>

</div>
</div>
<a id="a289ce15584734b8ea50cd9a7f7f430ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a289ce15584734b8ea50cd9a7f7f430ed">&#9670;&nbsp;</a></span>Y</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html">DoubleVectorWithHaloEntries</a> oomph::PitchForkHandler::Y</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Storage for the null vector. </p>

<p class="reference">Referenced by <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a6510803afcbcfce1ae5b1c1c5d82a541">get_dresiduals_dparameter()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a9d5e1388fe0ede6834a249b98168b71a">get_eigenfunction()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a85e7dba2d21c9fe95a575a115cf3ee9f">get_hessian_vector_products()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a461b24284da88b9489d720e484a6925c">get_residuals()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a96e0343c261d087f5d67a49f68561d96">PitchForkHandler()</a>, <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a9a424fd2ae0b67ef8c3ff59f16030786">oomph::BlockPitchForkLinearSolver::resolve()</a>, <a class="el" href="../../de/d72/classoomph_1_1AugmentedBlockPitchForkLinearSolver.html#a1d617896a3f1c1b1236ff18dc87ed8d7">oomph::AugmentedBlockPitchForkLinearSolver::resolve()</a>, <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#ad196867613954a8fabd318b50e2aadc6">oomph::BlockPitchForkLinearSolver::solve()</a>, <a class="el" href="../../de/d72/classoomph_1_1AugmentedBlockPitchForkLinearSolver.html#a0cbeb150ac83d5be1a1e30c0f728a70b">oomph::AugmentedBlockPitchForkLinearSolver::solve()</a>, and <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a27325616f4342d159f6f5e7c82ccdf98">solve_full_system()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="../../d3/d3a/assembly__handler_8h_source.html">assembly_handler.h</a></li>
<li><a class="el" href="../../da/da3/assembly__handler_8cc.html">assembly_handler.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../da/ddf/namespaceoomph.html">oomph</a></li><li class="navelem"><a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html">PitchForkHandler</a></li>
    <li class="footer">Generated on Wed Aug 27 2025 17:09:00 for MercuryDPM by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
