<!-- HTML header for doxygen 1.8.18-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MercuryDPM: Write Your Own Code</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../MDPM.css" rel="stylesheet" type="text/css"/>
<link href="../../codeLabels.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-fork-corner.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-dropdown-version.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../MDPM-fragment-copy-button.js"></script>
<script type="text/javascript">
DoxygenAwesomeFragmentCopyButton.init()
</script>
<script type="text/javascript" src="../../MDPM-paragraph-link.js"></script>
<script type="text/javascript">
DoxygenAwesomeParagraphLink.init()
</script>
<script type="text/javascript" src="../../MDPM-interactive-toc.js"></script>
<script type="text/javascript">
DoxygenAwesomeInteractiveToc.init()
</script>
<script type="text/javascript" src="../../MDPM-darkmode-toggle.js"></script>
<script type="text/javascript">
DoxygenAwesomeDarkModeToggle.init()
</script>
</head>
<body>
  <div id="bitbucket-corner">
   <a href="https://bitbucket.org/mercurydpm/mercurydpm/src/master/" target="_blank" id="fork-corner" class="fork-corner fc-pos-tr fc-animate fc-theme-bitbucket"></a>
  </div>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../mercury-logo-chosen-light-slogan.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"> <!--MercuryDPM--!>
   <!-- BEGIN version select -->
   <div class="dropdown" id="projectnumber">
    <button class="dropbtn">v1.0</button>
    <div class="dropdown-content">
    </div>
   </div>
   <script type="text/javascript" src="../../MDPM-dropdown-version.js"></script>
<!-- END version select -->
   <!--&#160;<span id="projectnumber">revision: v1.0</span>-->
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<script type="text/javascript" src="../../MDPM-fork-corner.js"></script>
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d6/d47/creating.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Write Your Own Code </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="Before"></a>
Before you start</h1>
<p>Before you read about how to write your own code, we recommend you to work through the <a class="el" href="../../d5/dac/Tutorials.html">Tutorials</a>. These tutorials explain the basic construction of the codes. After this, you will be familiar with the code design. You also will compile, run and visualise the simulations, so you will know the general tools available to you.</p>
<p>To explain how to creat your own code, a single particle bouncing between two walls will be created from a scratch; we will call it PingPong.cpp. Some of you want to use the terminal and some others an IDE, so we will show you both ways.</p>
<p>The first thing you need is a place to put your code. You can create your own code in one of the existing Driver directories, but we recommend you creating your own directory. This is how you do it: These steps are also explained by the figure below, the numbers indicate the steps.</p><ol type="1">
<li>Create the directory in which you want to put the driver code, for example Drivers/USER/myName.</li>
<li>Copy the CMakeLists.txt and the TemplateDriver.cpp into the just created directory. Make sure that you rename the TemplateDriver.cpp to a file with a unique name (e.g. PingPong), otherwise make will generate an error.</li>
<li>Now that we have a new cpp file, we need to execute cmake to create a make command. You do this by executing cmake in the root of the build directory (e.g. MercuryBuild).</li>
<li>Build the executable by using the fileName of the cpp file, e.g. make PingPong <div class="image">
<img src="../../CreateYourOwnCode.png" alt=""/>
</div>
</li>
</ol>
<p>Now let's take a look how we can implement the PingPong example.</p>
<h2><a class="anchor" id="How"></a>
How to write your own code</h2>
<p>The basic steps to create a simple Mercury program are:</p>
<h2><a class="anchor" id="Headers"></a>
0.0 Define headers</h2>
<p>Here the user includes the headers to use in the simulations. The first header calls &lt;Mercury3D.h&gt; is the base one. Furthermore, this PingPong tutorial must have walls and the type of model (species) to be used.</p>
<div class="fragment"><div class="line">#include &lt;Mercury3D.h&gt;</div>
<div class="line">#include &lt;Walls/InfiniteWall.h&gt;</div>
<div class="line">#include &lt;Species/LinearViscoelasticSpecies.h&gt;</div>
</div><!-- fragment --><p>There are different type of walls, you can find further information in <a class="el" href="../../de/dec/WallTypes.html">Different types of walls</a>.</p>
<p>There are several contact models and species to interact with combined classes. You can find more information in <a class="el" href="../../d7/dc4/ContactModel.html">Contact Models in MercuryDPM</a>.</p>
<h2><a class="anchor" id="BeforeMain"></a>
1.0 Before the main function</h2>
<p>1.1.1 Constructor: General and unchangeable parameters during the simulation </p><div class="fragment"><div class="line">class pingPongTest : public DPMBase {</div>
<div class="line">public:</div>
<div class="line"> </div>
<div class="line">    explicit pingPongTesTest(Mdouble radius)</div>
</div><!-- fragment --><ul>
<li>Output configuration and general specifications. <div class="fragment"><div class="line">setName(&quot;PingPong&quot;)</div>
<div class="line">setFileType(FileType::ONE_FILE);</div>
<div class="line">setGravity(Vec3D(0.0, 0.0,0.0));</div>
</div><!-- fragment --></li>
<li>Particle species. Material properties and positions <div class="fragment"><div class="line">// particle properties</div>
<div class="line">LinearViscoelasticSpecies sf;</div>
<div class="line">sf.setHandler(&amp;speciesHandler);</div>
<div class="line">sf.setDensity(1000);</div>
<div class="line">const Mdouble mass = sf.getMassFromRadius(radius);</div>
<div class="line">sf.setStiffnessAndRestitutionCoefficient(1.0 * radius, 1.0, mass);</div>
<div class="line">const Mdouble collisionTime = sf.getCollisionTime(mass);</div>
<div class="line">auto species = speciesHandler.copyAndAddObject(sf);</div>
<div class="line"> </div>
<div class="line">//Positions</div>
<div class="line">SphericalParticle P0, P1;</div>
<div class="line">P0.setSpecies(species);</div>
<div class="line">P1.setSpecies(species);</div>
<div class="line"> </div>
<div class="line">P0.setRadius(radius);</div>
<div class="line">P1.setRadius(radius);</div>
<div class="line"> </div>
<div class="line">P0.setPosition(Vec3D(-1.50 * radius, 0, 0));</div>
<div class="line">P0.setVelocity(Vec3D(0.001,0,0));</div>
<div class="line">P1.setPosition(-P0.getPosition());</div>
<div class="line">P1.setVelocity(-P0.getVelocity());</div>
<div class="line"> </div>
<div class="line">particleHandler.copyAndAddObject(P0);</div>
<div class="line">particleHandler.copyAndAddObject(P1);</div>
</div><!-- fragment --></li>
<li>walls <div class="fragment"><div class="line">InfiniteWall w0;</div>
<div class="line"> </div>
<div class="line">w0.setSpecies(speciesHandler.getObject(0));</div>
<div class="line">w0.set(Vec3D(1.0, 0.0, 0.0), Vec3D(getXMax(), 0.0, 0.0));</div>
<div class="line">wallHandler.copyAndAddObject(w0);</div>
<div class="line"> </div>
<div class="line">w0.set(Vec3D(-1.0, 0.0, 0.0), Vec3D(getXMin(), 0.0, 0.0));</div>
<div class="line">wallHandler.copyAndAddObject(w0);</div>
<div class="line"> </div>
<div class="line">w0.set(Vec3D(0.0, 1.0, 0.0), Vec3D(0.0, getYMax(), 0.0));</div>
<div class="line">wallHandler.copyAndAddObject(w0);</div>
<div class="line"> </div>
<div class="line">w0.set(Vec3D(0.0, -1.0, 0.0), Vec3D(0.0, getYMin(), 0.0));</div>
<div class="line">wallHandler.copyAndAddObject(w0);</div>
</div><!-- fragment --></li>
<li>time integration parameters <div class="fragment"><div class="line">setSaveCount(10000);</div>
<div class="line">setTimeMax(10);</div>
<div class="line">setTimeStep(0.0000005 * 50);</div>
</div><!-- fragment --></li>
</ul>
<p>1.1.1 Member functions</p><ul>
<li>Time display, energy, etc. <div class="fragment"><div class="line">void printTime() const override {</div>
<div class="line">    std::cout &lt;&lt; &quot;t=&quot; &lt;&lt; std::setprecision(3) &lt;&lt; std::left &lt;&lt; std::setw(6) &lt;&lt; getTime()</div>
<div class="line">              &lt;&lt; std::endl;</div>
<div class="line">}</div>
</div><!-- fragment --></li>
</ul>
<h2><a class="anchor" id="Main"></a>
2.0 Main function</h2>
<p>2.1 User specifications</p>
<div class="fragment"><div class="line">int main(int argc UNUSED, char *argv[] UNUSED)</div>
<div class="line">{</div>
<div class="line">    Mdouble radius = 0.01</div>
<div class="line">    pingPongTes sp0(radius);</div>
<div class="line"> </div>
<div class="line">    sp0.solve();</div>
<div class="line">}</div>
</div><!-- fragment --><p>If the user wants to implement a new contact model interaction (a new species), you could get more information of how clicking <a class="el" href="../../dd/da4/HowToCreateANewSpecies.html">Creating a new species</a>.</p>
<h1><a class="anchor" id="RestartOp"></a>
Using restart option</h1>
<p>The user can also write a program reading information from previous results or programs. For this, the restart option must be included in the main function. You could get further information in <a class="el" href="../../d9/df2/Restart.html">How to restart MercuryDPM driver codes</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../index.html">MercuryDPM Reference Manual</a></li>
    <li class="footer">Generated on Wed Aug 27 2025 17:05:12 for MercuryDPM by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
