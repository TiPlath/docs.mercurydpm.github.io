<!-- HTML header for doxygen 1.8.18-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MercuryDPM: oomph::CRDoubleMatrix Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../MDPM.css" rel="stylesheet" type="text/css"/>
<link href="../../codeLabels.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-fork-corner.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-dropdown-version.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../MDPM-fragment-copy-button.js"></script>
<script type="text/javascript">
DoxygenAwesomeFragmentCopyButton.init()
</script>
<script type="text/javascript" src="../../MDPM-paragraph-link.js"></script>
<script type="text/javascript">
DoxygenAwesomeParagraphLink.init()
</script>
<script type="text/javascript" src="../../MDPM-interactive-toc.js"></script>
<script type="text/javascript">
DoxygenAwesomeInteractiveToc.init()
</script>
<script type="text/javascript" src="../../MDPM-darkmode-toggle.js"></script>
<script type="text/javascript">
DoxygenAwesomeDarkModeToggle.init()
</script>
</head>
<body>
  <div id="bitbucket-corner">
   <a href="https://bitbucket.org/mercurydpm/mercurydpm/src/master/" target="_blank" id="fork-corner" class="fork-corner fc-pos-tr fc-animate fc-theme-bitbucket"></a>
  </div>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../mercury-logo-chosen-light-slogan.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"> <!--MercuryDPM--!>
   <!-- BEGIN version select -->
   <div class="dropdown" id="projectnumber">
    <button class="dropbtn">v1.0</button>
    <div class="dropdown-content">
    </div>
   </div>
   <script type="text/javascript" src="../../MDPM-dropdown-version.js"></script>
<!-- END version select -->
   <!--&#160;<span id="projectnumber">revision: v1.0</span>-->
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<script type="text/javascript" src="../../MDPM-fork-corner.js"></script>
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d6/dd4/classoomph_1_1CRDoubleMatrix.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="../../d4/d0f/classoomph_1_1CRDoubleMatrix-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">oomph::CRDoubleMatrix Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="../../d1/dd8/matrices_8h_source.html">matrices.h</a>&gt;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Inheritance diagram for oomph::CRDoubleMatrix:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
 <div class="center">
  <img src="../../d6/dd4/classoomph_1_1CRDoubleMatrix.png" usemap="#oomph::CRDoubleMatrix_map" alt=""/>
  <map id="oomph::CRDoubleMatrix_map" name="oomph::CRDoubleMatrix_map">
<area href="../../d6/d74/classoomph_1_1Matrix.html" alt="oomph::Matrix&lt; double, CRDoubleMatrix &gt;" shape="rect" coords="0,0,253,24"/>
<area href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html" alt="oomph::DoubleMatrixBase" shape="rect" coords="263,0,516,24"/>
<area href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html" alt="oomph::DistributableLinearAlgebraObject" shape="rect" coords="526,0,779,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d96/structoomph_1_1CRDoubleMatrix_1_1CRDoubleMatrixComparisonHelper.html">CRDoubleMatrixComparisonHelper</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a struct to provide a comparison function for std::sort.  <a href="../../d1/d96/structoomph_1_1CRDoubleMatrix_1_1CRDoubleMatrixComparisonHelper.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ad8914fa1a5a98f7602a1724b76eef26c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ad8914fa1a5a98f7602a1724b76eef26c">CRDoubleMatrix</a> ()</td></tr>
<tr class="memdesc:ad8914fa1a5a98f7602a1724b76eef26c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default constructor.  <a href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ad8914fa1a5a98f7602a1724b76eef26c">More...</a><br /></td></tr>
<tr class="separator:ad8914fa1a5a98f7602a1724b76eef26c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f1ffece5cbd2d25d46fe3db3b9c3ff5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a1f1ffece5cbd2d25d46fe3db3b9c3ff5">CRDoubleMatrix</a> (const <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> *<a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a4ed5597d8a34dd14f90b0e6cfb88ca2e">ncol</a>, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab8220b7c2bb763dab32a4d0fea7da6f4">value</a>, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> &gt; &amp;<a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a21b3dbb8ee74e1247f80ce4506c395f8">column_index</a>, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> &gt; &amp;<a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start</a>)</td></tr>
<tr class="separator:a1f1ffece5cbd2d25d46fe3db3b9c3ff5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80b1f351988b2a7c0bd39387c77b85f3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a80b1f351988b2a7c0bd39387c77b85f3">CRDoubleMatrix</a> (const <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> *<a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>)</td></tr>
<tr class="separator:a80b1f351988b2a7c0bd39387c77b85f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af88437afe2b838fd6b508c590d26bd26"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#af88437afe2b838fd6b508c590d26bd26">CRDoubleMatrix</a> (const <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> &amp;<a class="el" href="../../da/d67/level3__impl_8h.html#a21849b14ce38b5bc40d43a5782d89138">matrix</a>)</td></tr>
<tr class="memdesc:af88437afe2b838fd6b508c590d26bd26"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy constructor.  <a href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#af88437afe2b838fd6b508c590d26bd26">More...</a><br /></td></tr>
<tr class="separator:af88437afe2b838fd6b508c590d26bd26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3def3614952fcdd16a8edbc82f472490"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a3def3614952fcdd16a8edbc82f472490">operator=</a> (const <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> &amp;)=delete</td></tr>
<tr class="memdesc:a3def3614952fcdd16a8edbc82f472490"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken assignment operator.  <a href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a3def3614952fcdd16a8edbc82f472490">More...</a><br /></td></tr>
<tr class="separator:a3def3614952fcdd16a8edbc82f472490"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27c30b4faf3d2328f3b9ce9c590f43a4"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a27c30b4faf3d2328f3b9ce9c590f43a4">~CRDoubleMatrix</a> ()</td></tr>
<tr class="memdesc:a27c30b4faf3d2328f3b9ce9c590f43a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <a href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a27c30b4faf3d2328f3b9ce9c590f43a4">More...</a><br /></td></tr>
<tr class="separator:a27c30b4faf3d2328f3b9ce9c590f43a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80c3342b36dbcdf60bb21676fda66c97"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a80c3342b36dbcdf60bb21676fda66c97">get_index_of_diagonal_entries</a> () const</td></tr>
<tr class="separator:a80c3342b36dbcdf60bb21676fda66c97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae35fbae1702bbf75601c2a1026df103e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ae35fbae1702bbf75601c2a1026df103e">entries_are_sorted</a> (const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;doc_unordered_entries=false) const</td></tr>
<tr class="separator:ae35fbae1702bbf75601c2a1026df103e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2107875787d4dfa1cf007c05a041b078"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a2107875787d4dfa1cf007c05a041b078">sort_entries</a> ()</td></tr>
<tr class="separator:a2107875787d4dfa1cf007c05a041b078"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af44bac2acd071317f96dae49cbb0d977"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#af44bac2acd071317f96dae49cbb0d977">build</a> (const <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> *<a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a4ed5597d8a34dd14f90b0e6cfb88ca2e">ncol</a>, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab8220b7c2bb763dab32a4d0fea7da6f4">value</a>, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> &gt; &amp;<a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a21b3dbb8ee74e1247f80ce4506c395f8">column_index</a>, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> &gt; &amp;<a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start</a>)</td></tr>
<tr class="separator:af44bac2acd071317f96dae49cbb0d977"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7fc397b91a7289df8ee64287ae20e132"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a7fc397b91a7289df8ee64287ae20e132">build</a> (const <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> *<a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>)</td></tr>
<tr class="memdesc:a7fc397b91a7289df8ee64287ae20e132"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rebuild the matrix - assembles an empty matrix with a defined distribution.  <a href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a7fc397b91a7289df8ee64287ae20e132">More...</a><br /></td></tr>
<tr class="separator:a7fc397b91a7289df8ee64287ae20e132"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac04c0787a123256b3dbaf6acf40df4e2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ac04c0787a123256b3dbaf6acf40df4e2">build</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a4ed5597d8a34dd14f90b0e6cfb88ca2e">ncol</a>, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab8220b7c2bb763dab32a4d0fea7da6f4">value</a>, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> &gt; &amp;<a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a21b3dbb8ee74e1247f80ce4506c395f8">column_index</a>, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> &gt; &amp;<a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start</a>)</td></tr>
<tr class="memdesc:ac04c0787a123256b3dbaf6acf40df4e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">keeps the existing distribution and just matrix that is stored  <a href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ac04c0787a123256b3dbaf6acf40df4e2">More...</a><br /></td></tr>
<tr class="separator:ac04c0787a123256b3dbaf6acf40df4e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafb4d7de0a87b4bda560928e6a128060"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aafb4d7de0a87b4bda560928e6a128060">build_without_copy</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a4ed5597d8a34dd14f90b0e6cfb88ca2e">ncol</a>, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a9482dafc0a17ebc5b7431369d8d07565">nnz</a>, <a class="el" href="../../df/de6/classdouble.html">double</a> *<a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab8220b7c2bb763dab32a4d0fea7da6f4">value</a>, <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> *<a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a21b3dbb8ee74e1247f80ce4506c395f8">column_index</a>, <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> *<a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start</a>)</td></tr>
<tr class="memdesc:aafb4d7de0a87b4bda560928e6a128060"><td class="mdescLeft">&#160;</td><td class="mdescRight">method to rebuild the matrix, but not the distribution  <a href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aafb4d7de0a87b4bda560928e6a128060">More...</a><br /></td></tr>
<tr class="separator:aafb4d7de0a87b4bda560928e6a128060"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ba295a04e08e3153ae06bc0556f507d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a9ba295a04e08e3153ae06bc0556f507d">redistribute</a> (const <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> *const &amp;dist_pt)</td></tr>
<tr class="separator:a9ba295a04e08e3153ae06bc0556f507d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70c8a67158c081e70b4d07a6b248bc7a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a70c8a67158c081e70b4d07a6b248bc7a">clear</a> ()</td></tr>
<tr class="memdesc:a70c8a67158c081e70b4d07a6b248bc7a"><td class="mdescLeft">&#160;</td><td class="mdescRight">clear  <a href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a70c8a67158c081e70b4d07a6b248bc7a">More...</a><br /></td></tr>
<tr class="separator:a70c8a67158c081e70b4d07a6b248bc7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd8d231b0549540144b4739a667b1e75"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#abd8d231b0549540144b4739a667b1e75">nrow</a> () const</td></tr>
<tr class="memdesc:abd8d231b0549540144b4739a667b1e75"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the number of rows of the matrix.  <a href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#abd8d231b0549540144b4739a667b1e75">More...</a><br /></td></tr>
<tr class="separator:abd8d231b0549540144b4739a667b1e75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ed5597d8a34dd14f90b0e6cfb88ca2e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a4ed5597d8a34dd14f90b0e6cfb88ca2e">ncol</a> () const</td></tr>
<tr class="memdesc:a4ed5597d8a34dd14f90b0e6cfb88ca2e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the number of columns of the matrix.  <a href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a4ed5597d8a34dd14f90b0e6cfb88ca2e">More...</a><br /></td></tr>
<tr class="separator:a4ed5597d8a34dd14f90b0e6cfb88ca2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0887b5420752c47bfc14777006bcc1e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab0887b5420752c47bfc14777006bcc1e">output_bottom_right_zero_helper</a> (std::ostream &amp;outfile) const</td></tr>
<tr class="separator:ab0887b5420752c47bfc14777006bcc1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a468055aa2e36ff270a769a74c9ac2856"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a468055aa2e36ff270a769a74c9ac2856">sparse_indexed_output_helper</a> (std::ostream &amp;outfile) const</td></tr>
<tr class="separator:a468055aa2e36ff270a769a74c9ac2856"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b5dcdc5e1b9ccea51647f02b3239e66"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a2b5dcdc5e1b9ccea51647f02b3239e66">sparse_indexed_output_with_offset</a> (std::string filename)</td></tr>
<tr class="separator:a2b5dcdc5e1b9ccea51647f02b3239e66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5b1d934bae618c92aa1089671b6130e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#af5b1d934bae618c92aa1089671b6130e">operator()</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) const</td></tr>
<tr class="separator:af5b1d934bae618c92aa1089671b6130e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25f1efd00318183abd8c65efede3f3f4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start</a> ()</td></tr>
<tr class="memdesc:a25f1efd00318183abd8c65efede3f3f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access to C-style row_start array.  <a href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">More...</a><br /></td></tr>
<tr class="separator:a25f1efd00318183abd8c65efede3f3f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c7f058048764537f4d4ecadded5dd7c"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a9c7f058048764537f4d4ecadded5dd7c">row_start</a> () const</td></tr>
<tr class="memdesc:a9c7f058048764537f4d4ecadded5dd7c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access to C-style row_start array (const version)  <a href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a9c7f058048764537f4d4ecadded5dd7c">More...</a><br /></td></tr>
<tr class="separator:a9c7f058048764537f4d4ecadded5dd7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21b3dbb8ee74e1247f80ce4506c395f8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a21b3dbb8ee74e1247f80ce4506c395f8">column_index</a> ()</td></tr>
<tr class="memdesc:a21b3dbb8ee74e1247f80ce4506c395f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access to C-style column index array.  <a href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a21b3dbb8ee74e1247f80ce4506c395f8">More...</a><br /></td></tr>
<tr class="separator:a21b3dbb8ee74e1247f80ce4506c395f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a886a481d11974f5707405f573fcb9850"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a886a481d11974f5707405f573fcb9850">column_index</a> () const</td></tr>
<tr class="memdesc:a886a481d11974f5707405f573fcb9850"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access to C-style column index array (const version)  <a href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a886a481d11974f5707405f573fcb9850">More...</a><br /></td></tr>
<tr class="separator:a886a481d11974f5707405f573fcb9850"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8220b7c2bb763dab32a4d0fea7da6f4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab8220b7c2bb763dab32a4d0fea7da6f4">value</a> ()</td></tr>
<tr class="memdesc:ab8220b7c2bb763dab32a4d0fea7da6f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access to C-style value array.  <a href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab8220b7c2bb763dab32a4d0fea7da6f4">More...</a><br /></td></tr>
<tr class="separator:ab8220b7c2bb763dab32a4d0fea7da6f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b0895f75ec750c386f0dbc11bfbf57b"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../df/de6/classdouble.html">double</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a2b0895f75ec750c386f0dbc11bfbf57b">value</a> () const</td></tr>
<tr class="memdesc:a2b0895f75ec750c386f0dbc11bfbf57b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access to C-style value array (const version)  <a href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a2b0895f75ec750c386f0dbc11bfbf57b">More...</a><br /></td></tr>
<tr class="separator:a2b0895f75ec750c386f0dbc11bfbf57b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9482dafc0a17ebc5b7431369d8d07565"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a9482dafc0a17ebc5b7431369d8d07565">nnz</a> () const</td></tr>
<tr class="memdesc:a9482dafc0a17ebc5b7431369d8d07565"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the number of nonzero entries (the local nnz)  <a href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a9482dafc0a17ebc5b7431369d8d07565">More...</a><br /></td></tr>
<tr class="separator:a9482dafc0a17ebc5b7431369d8d07565"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b90203edbcbfec4e5e1c79f7d8d2722"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a4b90203edbcbfec4e5e1c79f7d8d2722">ludecompose</a> ()</td></tr>
<tr class="memdesc:a4b90203edbcbfec4e5e1c79f7d8d2722"><td class="mdescLeft">&#160;</td><td class="mdescRight">Do LU decomposition.  <a href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a4b90203edbcbfec4e5e1c79f7d8d2722">More...</a><br /></td></tr>
<tr class="separator:a4b90203edbcbfec4e5e1c79f7d8d2722"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2c0f286f77ca44453f0da684b8f9dc7"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#af2c0f286f77ca44453f0da684b8f9dc7">lubksub</a> (<a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;rhs)</td></tr>
<tr class="memdesc:af2c0f286f77ca44453f0da684b8f9dc7"><td class="mdescLeft">&#160;</td><td class="mdescRight">LU back solve for given RHS.  <a href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#af2c0f286f77ca44453f0da684b8f9dc7">More...</a><br /></td></tr>
<tr class="separator:af2c0f286f77ca44453f0da684b8f9dc7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54b75960df52e3aebd21aaab20e9869d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a54b75960df52e3aebd21aaab20e9869d">multiply</a> (const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a61b7da262276970831d88a2f37dbe509">x</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;soln) const</td></tr>
<tr class="memdesc:a54b75960df52e3aebd21aaab20e9869d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Multiply the matrix by the vector x: soln=Ax.  <a href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a54b75960df52e3aebd21aaab20e9869d">More...</a><br /></td></tr>
<tr class="separator:a54b75960df52e3aebd21aaab20e9869d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42fb274c98ccf4c2a542ca15343fcc0e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a42fb274c98ccf4c2a542ca15343fcc0e">multiply_transpose</a> (const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a61b7da262276970831d88a2f37dbe509">x</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;soln) const</td></tr>
<tr class="memdesc:a42fb274c98ccf4c2a542ca15343fcc0e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Multiply the transposed matrix by the vector x: soln=A^T x.  <a href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a42fb274c98ccf4c2a542ca15343fcc0e">More...</a><br /></td></tr>
<tr class="separator:a42fb274c98ccf4c2a542ca15343fcc0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af08fd73a7edbdbde9facf47b913e3e43"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#af08fd73a7edbdbde9facf47b913e3e43">multiply</a> (const <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> &amp;matrix_in, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> &amp;result) const</td></tr>
<tr class="separator:af08fd73a7edbdbde9facf47b913e3e43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3853068b7fce9e83bc817930262e9ca1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a3853068b7fce9e83bc817930262e9ca1">matrix_reduction</a> (const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;<a class="el" href="../../da/d67/level3__impl_8h.html#aab71aae952f5851155b312eeb00ec7c2">alpha</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> &amp;reduced_matrix)</td></tr>
<tr class="separator:a3853068b7fce9e83bc817930262e9ca1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa09d92094d0ccf281dded547edfc981e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aa09d92094d0ccf281dded547edfc981e">serial_matrix_matrix_multiply_method</a> ()</td></tr>
<tr class="separator:aa09d92094d0ccf281dded547edfc981e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8eff79ad9ac6e399ef4b677b6e0e1e5"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ae8eff79ad9ac6e399ef4b677b6e0e1e5">serial_matrix_matrix_multiply_method</a> () const</td></tr>
<tr class="separator:ae8eff79ad9ac6e399ef4b677b6e0e1e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a311cf35d030c6cc22b389c2542a4089c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a311cf35d030c6cc22b389c2542a4089c">distributed_matrix_matrix_multiply_method</a> ()</td></tr>
<tr class="separator:a311cf35d030c6cc22b389c2542a4089c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61b0b02e40f94ddceecafe38626e7ad2"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a61b0b02e40f94ddceecafe38626e7ad2">distributed_matrix_matrix_multiply_method</a> () const</td></tr>
<tr class="separator:a61b0b02e40f94ddceecafe38626e7ad2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0503bc64ef0ccb60cb7d7e645425a62"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aa0503bc64ef0ccb60cb7d7e645425a62">built</a> () const</td></tr>
<tr class="separator:aa0503bc64ef0ccb60cb7d7e645425a62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a984602c9df0c573451f315a025820ced"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a984602c9df0c573451f315a025820ced">global_matrix</a> () const</td></tr>
<tr class="separator:a984602c9df0c573451f315a025820ced"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82cb428139f7c35a7c62a09fad38eecb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a82cb428139f7c35a7c62a09fad38eecb">get_matrix_transpose</a> (<a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> *result) const</td></tr>
<tr class="memdesc:a82cb428139f7c35a7c62a09fad38eecb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the transpose of this matrix.  <a href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a82cb428139f7c35a7c62a09fad38eecb">More...</a><br /></td></tr>
<tr class="separator:a82cb428139f7c35a7c62a09fad38eecb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cd938ba5f026f1508239cef05b16cb4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a6cd938ba5f026f1508239cef05b16cb4">inf_norm</a> () const</td></tr>
<tr class="memdesc:a6cd938ba5f026f1508239cef05b16cb4"><td class="mdescLeft">&#160;</td><td class="mdescRight">returns the inf-norm of this matrix  <a href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a6cd938ba5f026f1508239cef05b16cb4">More...</a><br /></td></tr>
<tr class="separator:a6cd938ba5f026f1508239cef05b16cb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad438e693468cd0ae179460eafcaab038"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ad438e693468cd0ae179460eafcaab038">diagonal_entries</a> () const</td></tr>
<tr class="separator:ad438e693468cd0ae179460eafcaab038"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57f88253acfa87a764652c06c1bdc362"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a57f88253acfa87a764652c06c1bdc362">add</a> (const <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> &amp;matrix_in, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> &amp;result_matrix) const</td></tr>
<tr class="memdesc:a57f88253acfa87a764652c06c1bdc362"><td class="mdescLeft">&#160;</td><td class="mdescRight">element-wise addition of this matrix with matrix_in.  <a href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a57f88253acfa87a764652c06c1bdc362">More...</a><br /></td></tr>
<tr class="separator:a57f88253acfa87a764652c06c1bdc362"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classoomph_1_1Matrix"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classoomph_1_1Matrix')"><img src="../../closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="../../d6/d74/classoomph_1_1Matrix.html">oomph::Matrix&lt; double, CRDoubleMatrix &gt;</a></td></tr>
<tr class="memitem:ab414a0bf8e2658fc30d2c516f3bf4837 inherit pub_methods_classoomph_1_1Matrix"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d74/classoomph_1_1Matrix.html#ab414a0bf8e2658fc30d2c516f3bf4837">Matrix</a> ()</td></tr>
<tr class="memdesc:ab414a0bf8e2658fc30d2c516f3bf4837 inherit pub_methods_classoomph_1_1Matrix"><td class="mdescLeft">&#160;</td><td class="mdescRight">(Empty) constructor  <a href="../../d6/d74/classoomph_1_1Matrix.html#ab414a0bf8e2658fc30d2c516f3bf4837">More...</a><br /></td></tr>
<tr class="separator:ab414a0bf8e2658fc30d2c516f3bf4837 inherit pub_methods_classoomph_1_1Matrix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac40b846daa81698ea61aba9dfb1ae361 inherit pub_methods_classoomph_1_1Matrix"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d74/classoomph_1_1Matrix.html#ac40b846daa81698ea61aba9dfb1ae361">Matrix</a> (const <a class="el" href="../../d6/d74/classoomph_1_1Matrix.html">Matrix</a> &amp;<a class="el" href="../../da/d67/level3__impl_8h.html#a21849b14ce38b5bc40d43a5782d89138">matrix</a>)=delete</td></tr>
<tr class="memdesc:ac40b846daa81698ea61aba9dfb1ae361 inherit pub_methods_classoomph_1_1Matrix"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken copy constructor.  <a href="../../d6/d74/classoomph_1_1Matrix.html#ac40b846daa81698ea61aba9dfb1ae361">More...</a><br /></td></tr>
<tr class="separator:ac40b846daa81698ea61aba9dfb1ae361 inherit pub_methods_classoomph_1_1Matrix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81c8f71e6eae8ebf79aa206666e666b4 inherit pub_methods_classoomph_1_1Matrix"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d74/classoomph_1_1Matrix.html#a81c8f71e6eae8ebf79aa206666e666b4">operator=</a> (const <a class="el" href="../../d6/d74/classoomph_1_1Matrix.html">Matrix</a> &amp;)=delete</td></tr>
<tr class="memdesc:a81c8f71e6eae8ebf79aa206666e666b4 inherit pub_methods_classoomph_1_1Matrix"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken assignment operator.  <a href="../../d6/d74/classoomph_1_1Matrix.html#a81c8f71e6eae8ebf79aa206666e666b4">More...</a><br /></td></tr>
<tr class="separator:a81c8f71e6eae8ebf79aa206666e666b4 inherit pub_methods_classoomph_1_1Matrix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bc2eeb0940268de5252a9234d126f11 inherit pub_methods_classoomph_1_1Matrix"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d74/classoomph_1_1Matrix.html#a3bc2eeb0940268de5252a9234d126f11">~Matrix</a> ()</td></tr>
<tr class="memdesc:a3bc2eeb0940268de5252a9234d126f11 inherit pub_methods_classoomph_1_1Matrix"><td class="mdescLeft">&#160;</td><td class="mdescRight">Virtual (empty) destructor.  <a href="../../d6/d74/classoomph_1_1Matrix.html#a3bc2eeb0940268de5252a9234d126f11">More...</a><br /></td></tr>
<tr class="separator:a3bc2eeb0940268de5252a9234d126f11 inherit pub_methods_classoomph_1_1Matrix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26f23d2b331cb7f533fd8585f1ef8d28 inherit pub_methods_classoomph_1_1Matrix"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d74/classoomph_1_1Matrix.html#a26f23d2b331cb7f533fd8585f1ef8d28">operator()</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) const</td></tr>
<tr class="separator:a26f23d2b331cb7f533fd8585f1ef8d28 inherit pub_methods_classoomph_1_1Matrix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1601b48479c8fe38dd2d04600d7ebbae inherit pub_methods_classoomph_1_1Matrix"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d74/classoomph_1_1Matrix.html#a1601b48479c8fe38dd2d04600d7ebbae">operator()</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>)</td></tr>
<tr class="separator:a1601b48479c8fe38dd2d04600d7ebbae inherit pub_methods_classoomph_1_1Matrix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace9b59cbe514c77f0b3816b144c740f6 inherit pub_methods_classoomph_1_1Matrix"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d74/classoomph_1_1Matrix.html#ace9b59cbe514c77f0b3816b144c740f6">output</a> (std::ostream &amp;outfile) const</td></tr>
<tr class="separator:ace9b59cbe514c77f0b3816b144c740f6 inherit pub_methods_classoomph_1_1Matrix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f97fa3c94e6fd664e46acb8873a80f8 inherit pub_methods_classoomph_1_1Matrix"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d74/classoomph_1_1Matrix.html#a4f97fa3c94e6fd664e46acb8873a80f8">sparse_indexed_output</a> (std::ostream &amp;outfile, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;precision=0, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;output_bottom_right_zero=false) const</td></tr>
<tr class="separator:a4f97fa3c94e6fd664e46acb8873a80f8 inherit pub_methods_classoomph_1_1Matrix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7473fb07d4db925b4cf3a22131b561a inherit pub_methods_classoomph_1_1Matrix"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d74/classoomph_1_1Matrix.html#ac7473fb07d4db925b4cf3a22131b561a">sparse_indexed_output</a> (std::string filename, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;precision=0, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;output_bottom_right_zero=false) const</td></tr>
<tr class="separator:ac7473fb07d4db925b4cf3a22131b561a inherit pub_methods_classoomph_1_1Matrix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classoomph_1_1DoubleMatrixBase"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classoomph_1_1DoubleMatrixBase')"><img src="../../closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html">oomph::DoubleMatrixBase</a></td></tr>
<tr class="memitem:a9ab2dcaf990403cd43d4b952f7dbaa1c inherit pub_methods_classoomph_1_1DoubleMatrixBase"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a9ab2dcaf990403cd43d4b952f7dbaa1c">DoubleMatrixBase</a> ()</td></tr>
<tr class="memdesc:a9ab2dcaf990403cd43d4b952f7dbaa1c inherit pub_methods_classoomph_1_1DoubleMatrixBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">(Empty) constructor.  <a href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a9ab2dcaf990403cd43d4b952f7dbaa1c">More...</a><br /></td></tr>
<tr class="separator:a9ab2dcaf990403cd43d4b952f7dbaa1c inherit pub_methods_classoomph_1_1DoubleMatrixBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a449fe88a14eed90f8820a75f53883c66 inherit pub_methods_classoomph_1_1DoubleMatrixBase"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a449fe88a14eed90f8820a75f53883c66">DoubleMatrixBase</a> (const <a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html">DoubleMatrixBase</a> &amp;<a class="el" href="../../da/d67/level3__impl_8h.html#a21849b14ce38b5bc40d43a5782d89138">matrix</a>)=delete</td></tr>
<tr class="memdesc:a449fe88a14eed90f8820a75f53883c66 inherit pub_methods_classoomph_1_1DoubleMatrixBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken copy constructor.  <a href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a449fe88a14eed90f8820a75f53883c66">More...</a><br /></td></tr>
<tr class="separator:a449fe88a14eed90f8820a75f53883c66 inherit pub_methods_classoomph_1_1DoubleMatrixBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc390458d9899179f84488f6a94b261d inherit pub_methods_classoomph_1_1DoubleMatrixBase"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#abc390458d9899179f84488f6a94b261d">operator=</a> (const <a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html">DoubleMatrixBase</a> &amp;)=delete</td></tr>
<tr class="memdesc:abc390458d9899179f84488f6a94b261d inherit pub_methods_classoomph_1_1DoubleMatrixBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken assignment operator.  <a href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#abc390458d9899179f84488f6a94b261d">More...</a><br /></td></tr>
<tr class="separator:abc390458d9899179f84488f6a94b261d inherit pub_methods_classoomph_1_1DoubleMatrixBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82ece2e3cfc355bb68ba78a2ed9dae9f inherit pub_methods_classoomph_1_1DoubleMatrixBase"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a82ece2e3cfc355bb68ba78a2ed9dae9f">~DoubleMatrixBase</a> ()</td></tr>
<tr class="memdesc:a82ece2e3cfc355bb68ba78a2ed9dae9f inherit pub_methods_classoomph_1_1DoubleMatrixBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">virtual (empty) destructor  <a href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a82ece2e3cfc355bb68ba78a2ed9dae9f">More...</a><br /></td></tr>
<tr class="separator:a82ece2e3cfc355bb68ba78a2ed9dae9f inherit pub_methods_classoomph_1_1DoubleMatrixBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c100500a245852c4299fed257ad352c inherit pub_methods_classoomph_1_1DoubleMatrixBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html">LinearSolver</a> *&amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a0c100500a245852c4299fed257ad352c">linear_solver_pt</a> ()</td></tr>
<tr class="memdesc:a0c100500a245852c4299fed257ad352c inherit pub_methods_classoomph_1_1DoubleMatrixBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return a pointer to the linear solver object.  <a href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a0c100500a245852c4299fed257ad352c">More...</a><br /></td></tr>
<tr class="separator:a0c100500a245852c4299fed257ad352c inherit pub_methods_classoomph_1_1DoubleMatrixBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3a865cc9920a2fe7d895b638667be18 inherit pub_methods_classoomph_1_1DoubleMatrixBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html">LinearSolver</a> *const  &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#af3a865cc9920a2fe7d895b638667be18">linear_solver_pt</a> () const</td></tr>
<tr class="memdesc:af3a865cc9920a2fe7d895b638667be18 inherit pub_methods_classoomph_1_1DoubleMatrixBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return a pointer to the linear solver object (const version)  <a href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#af3a865cc9920a2fe7d895b638667be18">More...</a><br /></td></tr>
<tr class="separator:af3a865cc9920a2fe7d895b638667be18 inherit pub_methods_classoomph_1_1DoubleMatrixBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d445c4a1204da569f40ec1bdace9ef3 inherit pub_methods_classoomph_1_1DoubleMatrixBase"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a4d445c4a1204da569f40ec1bdace9ef3">solve</a> (<a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;rhs)</td></tr>
<tr class="separator:a4d445c4a1204da569f40ec1bdace9ef3 inherit pub_methods_classoomph_1_1DoubleMatrixBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac35083cf8225822363c25b921b4ca1ce inherit pub_methods_classoomph_1_1DoubleMatrixBase"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#ac35083cf8225822363c25b921b4ca1ce">solve</a> (const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;rhs, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;soln)</td></tr>
<tr class="separator:ac35083cf8225822363c25b921b4ca1ce inherit pub_methods_classoomph_1_1DoubleMatrixBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9098f3e129833a6b1cb5fe6ebdd9835 inherit pub_methods_classoomph_1_1DoubleMatrixBase"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#ae9098f3e129833a6b1cb5fe6ebdd9835">solve</a> (<a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;rhs)</td></tr>
<tr class="separator:ae9098f3e129833a6b1cb5fe6ebdd9835 inherit pub_methods_classoomph_1_1DoubleMatrixBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d9fb5fddec05a0b6e35cff23c79255c inherit pub_methods_classoomph_1_1DoubleMatrixBase"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a8d9fb5fddec05a0b6e35cff23c79255c">solve</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;rhs, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;soln)</td></tr>
<tr class="separator:a8d9fb5fddec05a0b6e35cff23c79255c inherit pub_methods_classoomph_1_1DoubleMatrixBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a971bdc2d9297fc582af8467178f4e00e inherit pub_methods_classoomph_1_1DoubleMatrixBase"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a971bdc2d9297fc582af8467178f4e00e">residual</a> (const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a61b7da262276970831d88a2f37dbe509">x</a>, const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#a9d82f3af1459c1efc910b77f3ccd3180">b</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;residual_)</td></tr>
<tr class="memdesc:a971bdc2d9297fc582af8467178f4e00e inherit pub_methods_classoomph_1_1DoubleMatrixBase"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find the residual, i.e. r=b-Ax the residual.  <a href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a971bdc2d9297fc582af8467178f4e00e">More...</a><br /></td></tr>
<tr class="separator:a971bdc2d9297fc582af8467178f4e00e inherit pub_methods_classoomph_1_1DoubleMatrixBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69a001b704e1d67277170ff7c0e4f6af inherit pub_methods_classoomph_1_1DoubleMatrixBase"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a69a001b704e1d67277170ff7c0e4f6af">max_residual</a> (const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a61b7da262276970831d88a2f37dbe509">x</a>, const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;rhs)</td></tr>
<tr class="separator:a69a001b704e1d67277170ff7c0e4f6af inherit pub_methods_classoomph_1_1DoubleMatrixBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classoomph_1_1DistributableLinearAlgebraObject')"><img src="../../closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html">oomph::DistributableLinearAlgebraObject</a></td></tr>
<tr class="memitem:ac9492d59cff9d9b0098712ae72989cd3 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ac9492d59cff9d9b0098712ae72989cd3">DistributableLinearAlgebraObject</a> ()</td></tr>
<tr class="memdesc:ac9492d59cff9d9b0098712ae72989cd3 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default constructor - create a distribution.  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ac9492d59cff9d9b0098712ae72989cd3">More...</a><br /></td></tr>
<tr class="separator:ac9492d59cff9d9b0098712ae72989cd3 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7522391265c46e6c748fd660eae66f5e inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a7522391265c46e6c748fd660eae66f5e">DistributableLinearAlgebraObject</a> (const <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html">DistributableLinearAlgebraObject</a> &amp;<a class="el" href="../../da/d67/level3__impl_8h.html#a21849b14ce38b5bc40d43a5782d89138">matrix</a>)=delete</td></tr>
<tr class="memdesc:a7522391265c46e6c748fd660eae66f5e inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken copy constructor.  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a7522391265c46e6c748fd660eae66f5e">More...</a><br /></td></tr>
<tr class="separator:a7522391265c46e6c748fd660eae66f5e inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada5f539f36451c06e69de79bb129521b inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ada5f539f36451c06e69de79bb129521b">operator=</a> (const <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html">DistributableLinearAlgebraObject</a> &amp;)=delete</td></tr>
<tr class="memdesc:ada5f539f36451c06e69de79bb129521b inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken assignment operator.  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ada5f539f36451c06e69de79bb129521b">More...</a><br /></td></tr>
<tr class="separator:ada5f539f36451c06e69de79bb129521b inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4038de53b5737dc625411e7848d21dad inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a4038de53b5737dc625411e7848d21dad">~DistributableLinearAlgebraObject</a> ()</td></tr>
<tr class="memdesc:a4038de53b5737dc625411e7848d21dad inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a4038de53b5737dc625411e7848d21dad">More...</a><br /></td></tr>
<tr class="separator:a4038de53b5737dc625411e7848d21dad inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a603105384d60c9a3710378af39f538b9 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a> () const</td></tr>
<tr class="memdesc:a603105384d60c9a3710378af39f538b9 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">access to the LinearAlgebraDistribution  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">More...</a><br /></td></tr>
<tr class="separator:a603105384d60c9a3710378af39f538b9 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7569556f14fd68b28508920e89bd5eee inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a7569556f14fd68b28508920e89bd5eee">nrow</a> () const</td></tr>
<tr class="memdesc:a7569556f14fd68b28508920e89bd5eee inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">access function to the number of global rows.  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a7569556f14fd68b28508920e89bd5eee">More...</a><br /></td></tr>
<tr class="separator:a7569556f14fd68b28508920e89bd5eee inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bd7e1d242c69a28da85a804a7717fce inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">nrow_local</a> () const</td></tr>
<tr class="memdesc:a9bd7e1d242c69a28da85a804a7717fce inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">access function for the num of local rows on this processor.  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">More...</a><br /></td></tr>
<tr class="separator:a9bd7e1d242c69a28da85a804a7717fce inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21e966b025edec79067b41d7f1f25220 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a21e966b025edec79067b41d7f1f25220">nrow_local</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>) const</td></tr>
<tr class="memdesc:a21e966b025edec79067b41d7f1f25220 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">access function for the num of local rows on this processor.  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a21e966b025edec79067b41d7f1f25220">More...</a><br /></td></tr>
<tr class="separator:a21e966b025edec79067b41d7f1f25220 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab00a3919b8634c698749f14a4d92947d inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ab00a3919b8634c698749f14a4d92947d">first_row</a> () const</td></tr>
<tr class="memdesc:ab00a3919b8634c698749f14a4d92947d inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">access function for the first row on this processor  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ab00a3919b8634c698749f14a4d92947d">More...</a><br /></td></tr>
<tr class="separator:ab00a3919b8634c698749f14a4d92947d inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4266c1d18d8e102bad3f4aec26c9b7cf inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a4266c1d18d8e102bad3f4aec26c9b7cf">first_row</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>) const</td></tr>
<tr class="memdesc:a4266c1d18d8e102bad3f4aec26c9b7cf inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">access function for the first row on this processor  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a4266c1d18d8e102bad3f4aec26c9b7cf">More...</a><br /></td></tr>
<tr class="separator:a4266c1d18d8e102bad3f4aec26c9b7cf inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5505731e7e73d7e4251c67c7adec6bf5 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a5505731e7e73d7e4251c67c7adec6bf5">distributed</a> () const</td></tr>
<tr class="memdesc:a5505731e7e73d7e4251c67c7adec6bf5 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">distribution is serial or distributed  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a5505731e7e73d7e4251c67c7adec6bf5">More...</a><br /></td></tr>
<tr class="separator:a5505731e7e73d7e4251c67c7adec6bf5 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c35baa65e335043f62954c92c090a5a inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a8c35baa65e335043f62954c92c090a5a">distribution_built</a> () const</td></tr>
<tr class="separator:a8c35baa65e335043f62954c92c090a5a inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5340bac40b9559b0378037b57005203 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ac5340bac40b9559b0378037b57005203">build_distribution</a> (const <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> *const dist_pt)</td></tr>
<tr class="separator:ac5340bac40b9559b0378037b57005203 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adad20ac61a61d907f823da7694b50616 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#adad20ac61a61d907f823da7694b50616">build_distribution</a> (const <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> &amp;dist)</td></tr>
<tr class="separator:adad20ac61a61d907f823da7694b50616 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a37d76ad3814e127802b80e1e274a3f15"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d1/d96/structoomph_1_1CRDoubleMatrix_1_1CRDoubleMatrixComparisonHelper.html">oomph::CRDoubleMatrix::CRDoubleMatrixComparisonHelper</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a37d76ad3814e127802b80e1e274a3f15">Comparison_struct</a></td></tr>
<tr class="separator:a37d76ad3814e127802b80e1e274a3f15"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a6cb9860ebacf742fc7fc47d77703cc82"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a6cb9860ebacf742fc7fc47d77703cc82">Index_of_diagonal_entries</a></td></tr>
<tr class="separator:a6cb9860ebacf742fc7fc47d77703cc82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8fab9824a0766b6bb6361a6b25df9ce"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ac8fab9824a0766b6bb6361a6b25df9ce">Serial_matrix_matrix_multiply_method</a></td></tr>
<tr class="separator:ac8fab9824a0766b6bb6361a6b25df9ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ab4056eff376d383c613a11082651cb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a4ab4056eff376d383c613a11082651cb">Distributed_matrix_matrix_multiply_method</a></td></tr>
<tr class="separator:a4ab4056eff376d383c613a11082651cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefc9a269911694cdd5bde98dc536148f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/def/classoomph_1_1CRMatrix.html">CRMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a></td></tr>
<tr class="memdesc:aefc9a269911694cdd5bde98dc536148f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Storage for the Matrix in CR Format.  <a href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">More...</a><br /></td></tr>
<tr class="separator:aefc9a269911694cdd5bde98dc536148f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63afd9976f0970a4e6ffee3755d21540"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a63afd9976f0970a4e6ffee3755d21540">Built</a></td></tr>
<tr class="separator:a63afd9976f0970a4e6ffee3755d21540"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_methods_classoomph_1_1Matrix"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classoomph_1_1Matrix')"><img src="../../closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="../../d6/d74/classoomph_1_1Matrix.html">oomph::Matrix&lt; double, CRDoubleMatrix &gt;</a></td></tr>
<tr class="memitem:a2fed2ea1840638eb0ddaa2d4ab1da82f inherit pro_methods_classoomph_1_1Matrix"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d74/classoomph_1_1Matrix.html#a2fed2ea1840638eb0ddaa2d4ab1da82f">range_check</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) const</td></tr>
<tr class="separator:a2fed2ea1840638eb0ddaa2d4ab1da82f inherit pro_methods_classoomph_1_1Matrix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_classoomph_1_1DistributableLinearAlgebraObject"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classoomph_1_1DistributableLinearAlgebraObject')"><img src="../../closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html">oomph::DistributableLinearAlgebraObject</a></td></tr>
<tr class="memitem:a30742aa2ac9abcfa037179f2d28ff43a inherit pro_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a30742aa2ac9abcfa037179f2d28ff43a">clear_distribution</a> ()</td></tr>
<tr class="separator:a30742aa2ac9abcfa037179f2d28ff43a inherit pro_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classoomph_1_1DoubleMatrixBase"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classoomph_1_1DoubleMatrixBase')"><img src="../../closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html">oomph::DoubleMatrixBase</a></td></tr>
<tr class="memitem:a86f0315e581cd5b41b75867383aa3760 inherit pro_attribs_classoomph_1_1DoubleMatrixBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html">LinearSolver</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a86f0315e581cd5b41b75867383aa3760">Linear_solver_pt</a></td></tr>
<tr class="separator:a86f0315e581cd5b41b75867383aa3760 inherit pro_attribs_classoomph_1_1DoubleMatrixBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ef2e36e4e5907af2738934f131e8dcf inherit pro_attribs_classoomph_1_1DoubleMatrixBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html">LinearSolver</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a6ef2e36e4e5907af2738934f131e8dcf">Default_linear_solver_pt</a></td></tr>
<tr class="separator:a6ef2e36e4e5907af2738934f131e8dcf inherit pro_attribs_classoomph_1_1DoubleMatrixBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A class for compressed row matrices. This is a distributable object. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ad8914fa1a5a98f7602a1724b76eef26c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8914fa1a5a98f7602a1724b76eef26c">&#9670;&nbsp;</a></span>CRDoubleMatrix() <span class="overload">[1/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">oomph::CRDoubleMatrix::CRDoubleMatrix </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Default constructor. </p>
<p>//////////////////////////////////////////////////////////////////////////// //////////////////////////////////////////////////////////////////////////// //////////////////////////////////////////////////////////////////////////// </p>
<div class="fragment"><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;  {</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    <span class="comment">// set the default solver</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    <a class="code" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a86f0315e581cd5b41b75867383aa3760">Linear_solver_pt</a> = <a class="code" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a6ef2e36e4e5907af2738934f131e8dcf">Default_linear_solver_pt</a> = <span class="keyword">new</span> SuperLUSolver;</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160; </div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    <span class="comment">// matrix not built</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a63afd9976f0970a4e6ffee3755d21540">Built</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160; </div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    <span class="comment">// set the serial matrix-matrix multiply method</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_TRILINOS</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    <span class="comment">//    Serial_matrix_matrix_multiply_method = 4;</span></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ac8fab9824a0766b6bb6361a6b25df9ce">Serial_matrix_matrix_multiply_method</a> = 2;</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ac8fab9824a0766b6bb6361a6b25df9ce">Serial_matrix_matrix_multiply_method</a> = 2;</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1CRDoubleMatrix_html_a63afd9976f0970a4e6ffee3755d21540"><div class="ttname"><a href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a63afd9976f0970a4e6ffee3755d21540">oomph::CRDoubleMatrix::Built</a></div><div class="ttdeci">bool Built</div><div class="ttdef"><b>Definition:</b> matrices.h:1253</div></div>
<div class="ttc" id="aclassoomph_1_1CRDoubleMatrix_html_ac8fab9824a0766b6bb6361a6b25df9ce"><div class="ttname"><a href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ac8fab9824a0766b6bb6361a6b25df9ce">oomph::CRDoubleMatrix::Serial_matrix_matrix_multiply_method</a></div><div class="ttdeci">unsigned Serial_matrix_matrix_multiply_method</div><div class="ttdef"><b>Definition:</b> matrices.h:1242</div></div>
<div class="ttc" id="aclassoomph_1_1DoubleMatrixBase_html_a6ef2e36e4e5907af2738934f131e8dcf"><div class="ttname"><a href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a6ef2e36e4e5907af2738934f131e8dcf">oomph::DoubleMatrixBase::Default_linear_solver_pt</a></div><div class="ttdeci">LinearSolver * Default_linear_solver_pt</div><div class="ttdef"><b>Definition:</b> matrices.h:267</div></div>
<div class="ttc" id="aclassoomph_1_1DoubleMatrixBase_html_a86f0315e581cd5b41b75867383aa3760"><div class="ttname"><a href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a86f0315e581cd5b41b75867383aa3760">oomph::DoubleMatrixBase::Linear_solver_pt</a></div><div class="ttdeci">LinearSolver * Linear_solver_pt</div><div class="ttdef"><b>Definition:</b> matrices.h:264</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a63afd9976f0970a4e6ffee3755d21540">Built</a>, <a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a6ef2e36e4e5907af2738934f131e8dcf">oomph::DoubleMatrixBase::Default_linear_solver_pt</a>, <a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a86f0315e581cd5b41b75867383aa3760">oomph::DoubleMatrixBase::Linear_solver_pt</a>, and <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ac8fab9824a0766b6bb6361a6b25df9ce">Serial_matrix_matrix_multiply_method</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a984602c9df0c573451f315a025820ced">global_matrix()</a>.</p>

</div>
</div>
<a id="a1f1ffece5cbd2d25d46fe3db3b9c3ff5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f1ffece5cbd2d25d46fe3db3b9c3ff5">&#9670;&nbsp;</a></span>CRDoubleMatrix() <span class="overload">[2/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">oomph::CRDoubleMatrix::CRDoubleMatrix </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> *&#160;</td>
          <td class="paramname"><em>dist_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>ncol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>column_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>row_start</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Constructor: vector of values, vector of column indices, vector of row starts and number of rows and columns.</p>
<p>Constructor: Takes the distribution and the number of columns, as well as the vector of values, vector of column indices,vector of row starts. </p>
<div class="fragment"><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;  {</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    <span class="comment">// build the compressed row matrix</span></div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a>.<a class="code" href="../../d4/def/classoomph_1_1CRMatrix.html#a73e05d0fc4fe5fb402416b18f17316b8">build</a>(</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;      <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab8220b7c2bb763dab32a4d0fea7da6f4">value</a>, <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a21b3dbb8ee74e1247f80ce4506c395f8">column_index</a>, <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start</a>, dist_pt-&gt;nrow_local(), <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a4ed5597d8a34dd14f90b0e6cfb88ca2e">ncol</a>);</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160; </div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    <span class="comment">// store the Distribution</span></div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ac5340bac40b9559b0378037b57005203">build_distribution</a>(dist_pt);</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160; </div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    <span class="comment">// set the linear solver</span></div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    <a class="code" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a86f0315e581cd5b41b75867383aa3760">Linear_solver_pt</a> = <a class="code" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a6ef2e36e4e5907af2738934f131e8dcf">Default_linear_solver_pt</a> = <span class="keyword">new</span> SuperLUSolver;</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160; </div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;    <span class="comment">// set the serial matrix-matrix multiply method</span></div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_TRILINOS</span></div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;    <span class="comment">// Serial_matrix_matrix_multiply_method = 4;</span></div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;    <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ac8fab9824a0766b6bb6361a6b25df9ce">Serial_matrix_matrix_multiply_method</a> = 2;</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;    <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ac8fab9824a0766b6bb6361a6b25df9ce">Serial_matrix_matrix_multiply_method</a> = 2;</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160; </div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    <span class="comment">// matrix has been built</span></div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;    <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a63afd9976f0970a4e6ffee3755d21540">Built</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1CRDoubleMatrix_html_a21b3dbb8ee74e1247f80ce4506c395f8"><div class="ttname"><a href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a21b3dbb8ee74e1247f80ce4506c395f8">oomph::CRDoubleMatrix::column_index</a></div><div class="ttdeci">int * column_index()</div><div class="ttdoc">Access to C-style column index array.</div><div class="ttdef"><b>Definition:</b> matrices.h:1072</div></div>
<div class="ttc" id="aclassoomph_1_1CRDoubleMatrix_html_a25f1efd00318183abd8c65efede3f3f4"><div class="ttname"><a href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">oomph::CRDoubleMatrix::row_start</a></div><div class="ttdeci">int * row_start()</div><div class="ttdoc">Access to C-style row_start array.</div><div class="ttdef"><b>Definition:</b> matrices.h:1060</div></div>
<div class="ttc" id="aclassoomph_1_1CRDoubleMatrix_html_a4ed5597d8a34dd14f90b0e6cfb88ca2e"><div class="ttname"><a href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a4ed5597d8a34dd14f90b0e6cfb88ca2e">oomph::CRDoubleMatrix::ncol</a></div><div class="ttdeci">unsigned long ncol() const</div><div class="ttdoc">Return the number of columns of the matrix.</div><div class="ttdef"><b>Definition:</b> matrices.h:1008</div></div>
<div class="ttc" id="aclassoomph_1_1CRDoubleMatrix_html_ab8220b7c2bb763dab32a4d0fea7da6f4"><div class="ttname"><a href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab8220b7c2bb763dab32a4d0fea7da6f4">oomph::CRDoubleMatrix::value</a></div><div class="ttdeci">double * value()</div><div class="ttdoc">Access to C-style value array.</div><div class="ttdef"><b>Definition:</b> matrices.h:1084</div></div>
<div class="ttc" id="aclassoomph_1_1CRDoubleMatrix_html_aefc9a269911694cdd5bde98dc536148f"><div class="ttname"><a href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">oomph::CRDoubleMatrix::CR_matrix</a></div><div class="ttdeci">CRMatrix&lt; double &gt; CR_matrix</div><div class="ttdoc">Storage for the Matrix in CR Format.</div><div class="ttdef"><b>Definition:</b> matrices.h:1249</div></div>
<div class="ttc" id="aclassoomph_1_1CRMatrix_html_a73e05d0fc4fe5fb402416b18f17316b8"><div class="ttname"><a href="../../d4/def/classoomph_1_1CRMatrix.html#a73e05d0fc4fe5fb402416b18f17316b8">oomph::CRMatrix::build</a></div><div class="ttdeci">void build(const Vector&lt; T &gt; &amp;value, const Vector&lt; int &gt; &amp;column_index, const Vector&lt; int &gt; &amp;row_start, const unsigned long &amp;n, const unsigned long &amp;m)</div><div class="ttdef"><b>Definition:</b> matrices.h:3404</div></div>
<div class="ttc" id="aclassoomph_1_1DistributableLinearAlgebraObject_html_ac5340bac40b9559b0378037b57005203"><div class="ttname"><a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ac5340bac40b9559b0378037b57005203">oomph::DistributableLinearAlgebraObject::build_distribution</a></div><div class="ttdeci">void build_distribution(const LinearAlgebraDistribution *const dist_pt)</div><div class="ttdef"><b>Definition:</b> linear_algebra_distribution.h:507</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/def/classoomph_1_1CRMatrix.html#a73e05d0fc4fe5fb402416b18f17316b8">oomph::CRMatrix&lt; T &gt;::build()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ac5340bac40b9559b0378037b57005203">oomph::DistributableLinearAlgebraObject::build_distribution()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a63afd9976f0970a4e6ffee3755d21540">Built</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a21b3dbb8ee74e1247f80ce4506c395f8">column_index()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a>, <a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a6ef2e36e4e5907af2738934f131e8dcf">oomph::DoubleMatrixBase::Default_linear_solver_pt</a>, <a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a86f0315e581cd5b41b75867383aa3760">oomph::DoubleMatrixBase::Linear_solver_pt</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a4ed5597d8a34dd14f90b0e6cfb88ca2e">ncol()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">oomph::LinearAlgebraDistribution::nrow_local()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ac8fab9824a0766b6bb6361a6b25df9ce">Serial_matrix_matrix_multiply_method</a>, and <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab8220b7c2bb763dab32a4d0fea7da6f4">value()</a>.</p>

</div>
</div>
<a id="a80b1f351988b2a7c0bd39387c77b85f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80b1f351988b2a7c0bd39387c77b85f3">&#9670;&nbsp;</a></span>CRDoubleMatrix() <span class="overload">[3/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">oomph::CRDoubleMatrix::CRDoubleMatrix </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> *&#160;</td>
          <td class="paramname"><em>distribution_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Constructor: just stores the distribution but does not build the matrix </p>
<div class="fragment"><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;  {</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ac5340bac40b9559b0378037b57005203">build_distribution</a>(<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>);</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160; </div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    <span class="comment">// set the default solver</span></div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;    <a class="code" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a86f0315e581cd5b41b75867383aa3760">Linear_solver_pt</a> = <a class="code" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a6ef2e36e4e5907af2738934f131e8dcf">Default_linear_solver_pt</a> = <span class="keyword">new</span> SuperLUSolver;</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160; </div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    <span class="comment">// matrix not built</span></div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a63afd9976f0970a4e6ffee3755d21540">Built</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160; </div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;<span class="comment">// set the serial matrix-matrix multiply method</span></div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_TRILINOS</span></div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    <span class="comment">//    Serial_matrix_matrix_multiply_method = 4;</span></div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ac8fab9824a0766b6bb6361a6b25df9ce">Serial_matrix_matrix_multiply_method</a> = 2;</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ac8fab9824a0766b6bb6361a6b25df9ce">Serial_matrix_matrix_multiply_method</a> = 2;</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1DistributableLinearAlgebraObject_html_a603105384d60c9a3710378af39f538b9"><div class="ttname"><a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">oomph::DistributableLinearAlgebraObject::distribution_pt</a></div><div class="ttdeci">LinearAlgebraDistribution * distribution_pt() const</div><div class="ttdoc">access to the LinearAlgebraDistribution</div><div class="ttdef"><b>Definition:</b> linear_algebra_distribution.h:457</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ac5340bac40b9559b0378037b57005203">oomph::DistributableLinearAlgebraObject::build_distribution()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a63afd9976f0970a4e6ffee3755d21540">Built</a>, <a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a6ef2e36e4e5907af2738934f131e8dcf">oomph::DoubleMatrixBase::Default_linear_solver_pt</a>, <a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a86f0315e581cd5b41b75867383aa3760">oomph::DoubleMatrixBase::Linear_solver_pt</a>, and <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ac8fab9824a0766b6bb6361a6b25df9ce">Serial_matrix_matrix_multiply_method</a>.</p>

</div>
</div>
<a id="af88437afe2b838fd6b508c590d26bd26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af88437afe2b838fd6b508c590d26bd26">&#9670;&nbsp;</a></span>CRDoubleMatrix() <span class="overload">[4/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">oomph::CRDoubleMatrix::CRDoubleMatrix </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>matrix</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Copy constructor. </p>
<div class="fragment"><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;  {</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    <span class="comment">// copy the distribution</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ac5340bac40b9559b0378037b57005203">build_distribution</a>(other_matrix.distribution_pt());</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160; </div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    <span class="comment">// copy coefficients</span></div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span>* values_pt = other_matrix.value();</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span>* column_indices = other_matrix.column_index();</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span>* <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start</a> = other_matrix.row_start();</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160; </div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    <span class="comment">// This is the local nnz.</span></div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a9482dafc0a17ebc5b7431369d8d07565">nnz</a> = other_matrix.nnz();</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160; </div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    <span class="comment">// Using number of local rows since the underlying CRMatrix is local to</span></div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    <span class="comment">// each processor.</span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">nrow_local</a> = other_matrix.nrow_local();</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160; </div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;    <span class="comment">// Storage for the (yet to be copied) data.</span></div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    <span class="keywordtype">double</span>* my_values_pt = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a9482dafc0a17ebc5b7431369d8d07565">nnz</a>];</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    <span class="keywordtype">int</span>* my_column_indices = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a9482dafc0a17ebc5b7431369d8d07565">nnz</a>];</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    <span class="keywordtype">int</span>* my_row_start = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">nrow_local</a> + 1];</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160; </div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    <span class="comment">// Copying over the data.</span></div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;    <a class="code" href="../../de/d6c/level1__impl_8h.html#af1eb30bd79553c9e566435de1f82a94f">std::copy</a>(values_pt, values_pt + <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a9482dafc0a17ebc5b7431369d8d07565">nnz</a>, my_values_pt);</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;    <a class="code" href="../../de/d6c/level1__impl_8h.html#af1eb30bd79553c9e566435de1f82a94f">std::copy</a>(column_indices, column_indices + <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a9482dafc0a17ebc5b7431369d8d07565">nnz</a>, my_column_indices);</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    <a class="code" href="../../de/d6c/level1__impl_8h.html#af1eb30bd79553c9e566435de1f82a94f">std::copy</a>(<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start</a>, <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start</a> + <a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">nrow_local</a> + 1, my_row_start);</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160; </div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160; </div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;    <span class="comment">// Build without copy since we have made a deep copy of the data structure.</span></div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;    this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aafb4d7de0a87b4bda560928e6a128060">build_without_copy</a>(</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;      other_matrix.ncol(), <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a9482dafc0a17ebc5b7431369d8d07565">nnz</a>, my_values_pt, my_column_indices, my_row_start);</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160; </div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;    <span class="comment">// set the default solver</span></div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;    <a class="code" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a86f0315e581cd5b41b75867383aa3760">Linear_solver_pt</a> = <a class="code" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a6ef2e36e4e5907af2738934f131e8dcf">Default_linear_solver_pt</a> = <span class="keyword">new</span> SuperLUSolver;</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160; </div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;    <span class="comment">// matrix is built</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;    <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a63afd9976f0970a4e6ffee3755d21540">Built</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160; </div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;    <span class="comment">// set the serial matrix-matrix multiply method</span></div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_TRILINOS</span></div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;    <span class="comment">// Serial_matrix_matrix_multiply_method = 4;</span></div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ac8fab9824a0766b6bb6361a6b25df9ce">Serial_matrix_matrix_multiply_method</a> = 2;</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ac8fab9824a0766b6bb6361a6b25df9ce">Serial_matrix_matrix_multiply_method</a> = 2;</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1CRDoubleMatrix_html_a9482dafc0a17ebc5b7431369d8d07565"><div class="ttname"><a href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a9482dafc0a17ebc5b7431369d8d07565">oomph::CRDoubleMatrix::nnz</a></div><div class="ttdeci">unsigned long nnz() const</div><div class="ttdoc">Return the number of nonzero entries (the local nnz)</div><div class="ttdef"><b>Definition:</b> matrices.h:1096</div></div>
<div class="ttc" id="aclassoomph_1_1CRDoubleMatrix_html_aafb4d7de0a87b4bda560928e6a128060"><div class="ttname"><a href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aafb4d7de0a87b4bda560928e6a128060">oomph::CRDoubleMatrix::build_without_copy</a></div><div class="ttdeci">void build_without_copy(const unsigned &amp;ncol, const unsigned &amp;nnz, double *value, int *column_index, int *row_start)</div><div class="ttdoc">method to rebuild the matrix, but not the distribution</div><div class="ttdef"><b>Definition:</b> matrices.cc:1710</div></div>
<div class="ttc" id="aclassoomph_1_1DistributableLinearAlgebraObject_html_a9bd7e1d242c69a28da85a804a7717fce"><div class="ttname"><a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">oomph::DistributableLinearAlgebraObject::nrow_local</a></div><div class="ttdeci">unsigned nrow_local() const</div><div class="ttdoc">access function for the num of local rows on this processor.</div><div class="ttdef"><b>Definition:</b> linear_algebra_distribution.h:469</div></div>
<div class="ttc" id="alevel1__impl_8h_html_af1eb30bd79553c9e566435de1f82a94f"><div class="ttname"><a href="../../de/d6c/level1__impl_8h.html#af1eb30bd79553c9e566435de1f82a94f">copy</a></div><div class="ttdeci">EIGEN_BLAS_FUNC() copy(int *n, RealScalar *px, int *incx, RealScalar *py, int *incy)</div><div class="ttdef"><b>Definition:</b> level1_impl.h:32</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ac5340bac40b9559b0378037b57005203">oomph::DistributableLinearAlgebraObject::build_distribution()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aafb4d7de0a87b4bda560928e6a128060">build_without_copy()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a63afd9976f0970a4e6ffee3755d21540">Built</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a21b3dbb8ee74e1247f80ce4506c395f8">column_index()</a>, <a class="el" href="../../de/d6c/level1__impl_8h.html#af1eb30bd79553c9e566435de1f82a94f">copy()</a>, <a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a6ef2e36e4e5907af2738934f131e8dcf">oomph::DoubleMatrixBase::Default_linear_solver_pt</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">oomph::DistributableLinearAlgebraObject::distribution_pt()</a>, <a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a86f0315e581cd5b41b75867383aa3760">oomph::DoubleMatrixBase::Linear_solver_pt</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a4ed5597d8a34dd14f90b0e6cfb88ca2e">ncol()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a9482dafc0a17ebc5b7431369d8d07565">nnz()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">oomph::DistributableLinearAlgebraObject::nrow_local()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ac8fab9824a0766b6bb6361a6b25df9ce">Serial_matrix_matrix_multiply_method</a>, and <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab8220b7c2bb763dab32a4d0fea7da6f4">value()</a>.</p>

</div>
</div>
<a id="a27c30b4faf3d2328f3b9ce9c590f43a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27c30b4faf3d2328f3b9ce9c590f43a4">&#9670;&nbsp;</a></span>~CRDoubleMatrix()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">oomph::CRDoubleMatrix::~CRDoubleMatrix </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destructor. </p>
<div class="fragment"><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;  {</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a70c8a67158c081e70b4d07a6b248bc7a">clear</a>();</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;    <span class="keyword">delete</span> <a class="code" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a6ef2e36e4e5907af2738934f131e8dcf">Default_linear_solver_pt</a>;</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;    <a class="code" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a6ef2e36e4e5907af2738934f131e8dcf">Default_linear_solver_pt</a> = 0;</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1CRDoubleMatrix_html_a70c8a67158c081e70b4d07a6b248bc7a"><div class="ttname"><a href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a70c8a67158c081e70b4d07a6b248bc7a">oomph::CRDoubleMatrix::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdoc">clear</div><div class="ttdef"><b>Definition:</b> matrices.cc:1657</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a70c8a67158c081e70b4d07a6b248bc7a">clear()</a>, and <a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a6ef2e36e4e5907af2738934f131e8dcf">oomph::DoubleMatrixBase::Default_linear_solver_pt</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a57f88253acfa87a764652c06c1bdc362"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57f88253acfa87a764652c06c1bdc362">&#9670;&nbsp;</a></span>add()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::CRDoubleMatrix::add </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>matrix_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>result_matrix</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>element-wise addition of this matrix with matrix_in. </p>
<p>Element-wise addition of this matrix with matrix_in. </p>
<div class="fragment"><div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;  {</div>
<div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;    <span class="comment">// Check if this matrix is built.</span></div>
<div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;    <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aa0503bc64ef0ccb60cb7d7e645425a62">built</a>())</div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;    {</div>
<div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;      std::ostringstream error_message;</div>
<div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;      error_message &lt;&lt; <span class="stringliteral">&quot;The matrix is not built.\n&quot;</span></div>
<div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;Please build the matrix!\n&quot;</span>;</div>
<div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;        error_message.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;    }</div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160; </div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;    <span class="comment">// Check if this matrix_in is built.</span></div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;    <span class="keywordflow">if</span> (!matrix_in.built())</div>
<div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;    {</div>
<div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;      std::ostringstream error_message;</div>
<div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;      error_message &lt;&lt; <span class="stringliteral">&quot;The matrix matrix_in is not built.\n&quot;</span></div>
<div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;Please build the matrix!\n&quot;</span>;</div>
<div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;        error_message.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;    }</div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160; </div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;    <span class="comment">// Check if the dimensions of this matrix and matrix_in are the same.</span></div>
<div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> this_nrow = this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#abd8d231b0549540144b4739a667b1e75">nrow</a>();</div>
<div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> matrix_in_nrow = matrix_in.nrow();</div>
<div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;    <span class="keywordflow">if</span> (this_nrow != matrix_in_nrow)</div>
<div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;    {</div>
<div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;      std::ostringstream error_message;</div>
<div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;      error_message &lt;&lt; <span class="stringliteral">&quot;matrix_in has a different number of rows than\n&quot;</span></div>
<div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;this matrix.\n&quot;</span>;</div>
<div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;        error_message.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;    }</div>
<div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160; </div>
<div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> this_ncol = this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a4ed5597d8a34dd14f90b0e6cfb88ca2e">ncol</a>();</div>
<div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> matrix_in_ncol = matrix_in.ncol();</div>
<div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;    <span class="keywordflow">if</span> (this_ncol != matrix_in_ncol)</div>
<div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;    {</div>
<div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;      std::ostringstream error_message;</div>
<div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;      error_message &lt;&lt; <span class="stringliteral">&quot;matrix_in has a different number of columns than\n&quot;</span></div>
<div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;this matrix.\n&quot;</span>;</div>
<div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;        error_message.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;    }</div>
<div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160; </div>
<div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;    <span class="comment">// Check if the distribution is the same (Otherwise we may have to send and</span></div>
<div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;    <span class="comment">// receive data from other processors - which is not implemented!)</span></div>
<div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;    <span class="keywordflow">if</span> (*(this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>()) != *(matrix_in.distribution_pt()))</div>
<div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;    {</div>
<div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;      std::ostringstream error_message;</div>
<div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;      error_message &lt;&lt; <span class="stringliteral">&quot;matrix_in must have the same distribution as\n&quot;</span></div>
<div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;this matrix.\n&quot;</span>;</div>
<div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;        error_message.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;    }</div>
<div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160; </div>
<div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;    <span class="comment">// If the matrix is built, check that it&#39;s existing distribution is the</span></div>
<div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;    <span class="comment">// same as the in matrix. Since we&#39;ll use the same distribution instead</span></div>
<div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;    <span class="comment">// of completely rebuilding it.</span></div>
<div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;    <span class="keywordflow">if</span> (result_matrix.built() &amp;&amp;</div>
<div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;        (*result_matrix.distribution_pt() != *matrix_in.distribution_pt()))</div>
<div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;    {</div>
<div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;      std::ostringstream error_message;</div>
<div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;      error_message &lt;&lt; <span class="stringliteral">&quot;The result_matrix is built. &quot;</span></div>
<div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;But has a different distribution from matrix_in \n&quot;</span></div>
<div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;They need to be the same.\n&quot;</span>;</div>
<div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;        error_message.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;    }</div>
<div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160; </div>
<div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;    <span class="comment">// To add the elements of two CRDoubleMatrices, we need to know the union of</span></div>
<div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;    <span class="comment">// the sparsity patterns. This is determined by the column indices.</span></div>
<div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;    <span class="comment">// We add the column indices and values (entries) as a key-value pair in</span></div>
<div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;    <span class="comment">// a map (per row). We then read these out into two column indices and</span></div>
<div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;    <span class="comment">// values vector for the result matrix.</span></div>
<div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160; </div>
<div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">nrow_local</a> = this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">nrow_local</a>();</div>
<div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;    Vector&lt;int&gt; res_column_indices;</div>
<div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;    Vector&lt;double&gt; res_values;</div>
<div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;    Vector&lt;int&gt; res_row_start;</div>
<div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;    res_row_start.reserve(<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">nrow_local</a> + 1);</div>
<div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160; </div>
<div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;    <span class="comment">// The row_start and column_indices</span></div>
<div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span>* this_column_indices = this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a21b3dbb8ee74e1247f80ce4506c395f8">column_index</a>();</div>
<div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span>* this_row_start = this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start</a>();</div>
<div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span>* in_column_indices = matrix_in.column_index();</div>
<div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span>* in_row_start = matrix_in.row_start();</div>
<div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160; </div>
<div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;    <span class="comment">// Values from this matrix and matrix_in.</span></div>
<div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span>* this_values = this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab8220b7c2bb763dab32a4d0fea7da6f4">value</a>();</div>
<div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span>* in_values = matrix_in.value();</div>
<div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160; </div>
<div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160; </div>
<div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;    <span class="comment">// The first entry in row_start is always zero.</span></div>
<div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;    res_row_start.push_back(0);</div>
<div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160; </div>
<div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;    <span class="comment">// Loop through the rows of both matrices and insert the column indices and</span></div>
<div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;    <span class="comment">// values as a key-value pair.</span></div>
<div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> row_i = 0; row_i &lt; <a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">nrow_local</a>; row_i++)</div>
<div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;    {</div>
<div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;      <span class="comment">// Create the map for this row.</span></div>
<div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;      std::map&lt;int, double&gt; res_row_map;</div>
<div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160; </div>
<div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;      <span class="comment">// Insert the column and value pair for this matrix.</span></div>
<div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = this_row_start[row_i]; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; this_row_start[row_i + 1]; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;      {</div>
<div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;        res_row_map[this_column_indices[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]] = this_values[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;      }</div>
<div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160; </div>
<div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;      <span class="comment">// Insert the column and value pair for in matrix.</span></div>
<div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = in_row_start[row_i]; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; in_row_start[row_i + 1]; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;      {</div>
<div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;        res_row_map[in_column_indices[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]] += in_values[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;      }</div>
<div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160; </div>
<div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;      <span class="comment">// Fill in the row start</span></div>
<div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;      res_row_start.push_back(res_row_start.back() + res_row_map.size());</div>
<div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160; </div>
<div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;      <span class="comment">// Now insert the key into res_column_indices and value into res_values</span></div>
<div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;      <span class="keywordflow">for</span> (std::map&lt;int, double&gt;::iterator it = res_row_map.begin();</div>
<div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;           it != res_row_map.end();</div>
<div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;           ++it)</div>
<div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;      {</div>
<div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;        res_column_indices.push_back(it-&gt;first);</div>
<div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;        res_values.push_back(it-&gt;second);</div>
<div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;      }</div>
<div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;    }</div>
<div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160; </div>
<div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;    <span class="comment">// Finally build the result_matrix.</span></div>
<div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;    <span class="keywordflow">if</span> (result_matrix.distribution_pt()-&gt;built())</div>
<div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;    {</div>
<div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;      <span class="comment">// Use the existing distribution.</span></div>
<div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;      result_matrix.build(</div>
<div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;        this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a4ed5597d8a34dd14f90b0e6cfb88ca2e">ncol</a>(), res_values, res_column_indices, res_row_start);</div>
<div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;    }</div>
<div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;    {</div>
<div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;      <span class="comment">// Build with THIS distribution</span></div>
<div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;      result_matrix.build(this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>(),</div>
<div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;                          this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a4ed5597d8a34dd14f90b0e6cfb88ca2e">ncol</a>(),</div>
<div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;                          res_values,</div>
<div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;                          res_column_indices,</div>
<div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;                          res_row_start);</div>
<div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;    }</div>
<div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;  }</div>
<div class="ttc" id="aBiCGSTAB__step__by__step_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> BiCGSTAB_step_by_step.cpp:9</div></div>
<div class="ttc" id="aclassoomph_1_1CRDoubleMatrix_html_aa0503bc64ef0ccb60cb7d7e645425a62"><div class="ttname"><a href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aa0503bc64ef0ccb60cb7d7e645425a62">oomph::CRDoubleMatrix::built</a></div><div class="ttdeci">bool built() const</div><div class="ttdef"><b>Definition:</b> matrices.h:1210</div></div>
<div class="ttc" id="aclassoomph_1_1CRDoubleMatrix_html_abd8d231b0549540144b4739a667b1e75"><div class="ttname"><a href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#abd8d231b0549540144b4739a667b1e75">oomph::CRDoubleMatrix::nrow</a></div><div class="ttdeci">unsigned long nrow() const</div><div class="ttdoc">Return the number of rows of the matrix.</div><div class="ttdef"><b>Definition:</b> matrices.h:1002</div></div>
<div class="ttc" id="aoomph__definitions_8h_html_a25c6813cc7341d125e2502f8923fb6c4"><div class="ttname"><a href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a></div><div class="ttdeci">#define OOMPH_EXCEPTION_LOCATION</div><div class="ttdef"><b>Definition:</b> oomph_definitions.h:61</div></div>
<div class="ttc" id="aoomph__definitions_8h_html_aa260cc4af589e30cea7fde997ae16667"><div class="ttname"><a href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a></div><div class="ttdeci">#define OOMPH_CURRENT_FUNCTION</div><div class="ttdef"><b>Definition:</b> oomph_definitions.h:86</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#af44bac2acd071317f96dae49cbb0d977">build()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a92bfff97fd228b9c528922c39ab563b2">oomph::LinearAlgebraDistribution::built()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aa0503bc64ef0ccb60cb7d7e645425a62">built()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a21b3dbb8ee74e1247f80ce4506c395f8">column_index()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">oomph::DistributableLinearAlgebraObject::distribution_pt()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a4ed5597d8a34dd14f90b0e6cfb88ca2e">ncol()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#abd8d231b0549540144b4739a667b1e75">nrow()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">oomph::DistributableLinearAlgebraObject::nrow_local()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start()</a>, and <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab8220b7c2bb763dab32a4d0fea7da6f4">value()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d51/matrix__addition_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>

</div>
</div>
<a id="a7fc397b91a7289df8ee64287ae20e132"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7fc397b91a7289df8ee64287ae20e132">&#9670;&nbsp;</a></span>build() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::CRDoubleMatrix::build </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> *&#160;</td>
          <td class="paramname"><em>distribution_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rebuild the matrix - assembles an empty matrix with a defined distribution. </p>
<p>rebuild the matrix - assembles an empty matrix will a defined distribution </p>
<div class="fragment"><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;  {</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a70c8a67158c081e70b4d07a6b248bc7a">clear</a>();</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ac5340bac40b9559b0378037b57005203">build_distribution</a>(<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>);</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ac5340bac40b9559b0378037b57005203">oomph::DistributableLinearAlgebraObject::build_distribution()</a>, and <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a70c8a67158c081e70b4d07a6b248bc7a">clear()</a>.</p>

</div>
</div>
<a id="af44bac2acd071317f96dae49cbb0d977"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af44bac2acd071317f96dae49cbb0d977">&#9670;&nbsp;</a></span>build() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::CRDoubleMatrix::build </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> *&#160;</td>
          <td class="paramname"><em>distribution_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>ncol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>column_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>row_start</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>build method: vector of values, vector of column indices, vector of row starts and number of rows and columns.</p>
<p>build method: Takes the distribution and the number of columns, as well as the vector of values, vector of column indices,vector of row starts. </p>
<div class="fragment"><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;  {</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;    <span class="comment">// clear</span></div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;    this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a70c8a67158c081e70b4d07a6b248bc7a">clear</a>();</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160; </div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;    <span class="comment">// store the Distribution</span></div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;    this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ac5340bac40b9559b0378037b57005203">build_distribution</a>(<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>);</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160; </div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;    <span class="comment">// set the linear solver</span></div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;    <a class="code" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a6ef2e36e4e5907af2738934f131e8dcf">Default_linear_solver_pt</a> = <span class="keyword">new</span> SuperLUSolver;</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160; </div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    <span class="comment">// now build the matrix</span></div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#af44bac2acd071317f96dae49cbb0d977">build</a>(ncol, <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab8220b7c2bb763dab32a4d0fea7da6f4">value</a>, <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a21b3dbb8ee74e1247f80ce4506c395f8">column_index</a>, <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start</a>);</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1CRDoubleMatrix_html_af44bac2acd071317f96dae49cbb0d977"><div class="ttname"><a href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#af44bac2acd071317f96dae49cbb0d977">oomph::CRDoubleMatrix::build</a></div><div class="ttdeci">void build(const LinearAlgebraDistribution *distribution_pt, const unsigned &amp;ncol, const Vector&lt; double &gt; &amp;value, const Vector&lt; int &gt; &amp;column_index, const Vector&lt; int &gt; &amp;row_start)</div><div class="ttdef"><b>Definition:</b> matrices.cc:1672</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ac5340bac40b9559b0378037b57005203">oomph::DistributableLinearAlgebraObject::build_distribution()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a70c8a67158c081e70b4d07a6b248bc7a">clear()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a21b3dbb8ee74e1247f80ce4506c395f8">column_index()</a>, <a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a6ef2e36e4e5907af2738934f131e8dcf">oomph::DoubleMatrixBase::Default_linear_solver_pt</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start()</a>, and <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab8220b7c2bb763dab32a4d0fea7da6f4">value()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a57f88253acfa87a764652c06c1bdc362">add()</a>, <a class="el" href="../../dd/d95/namespaceoomph_1_1CRDoubleMatrixHelpers.html#ab7e3ac344aa644292a143a3917a03e65">oomph::CRDoubleMatrixHelpers::concatenate()</a>, <a class="el" href="../../dd/d95/namespaceoomph_1_1CRDoubleMatrixHelpers.html#a996568831ca0db90f080560dd400b3d6">oomph::CRDoubleMatrixHelpers::concatenate_without_communication()</a>, <a class="el" href="../../dd/d95/namespaceoomph_1_1CRDoubleMatrixHelpers.html#ae3c10e59d5857457c7e34be8e9262035">oomph::CRDoubleMatrixHelpers::create_uniformly_distributed_matrix()</a>, <a class="el" href="../../dd/d95/namespaceoomph_1_1CRDoubleMatrixHelpers.html#a157511f700993ab8bc014f9d0d44f4c7">oomph::CRDoubleMatrixHelpers::deep_copy()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a4e59f1c854d1258aa2b4eca218405731">oomph::Problem::get_eigenproblem_matrices()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aab9533075d11b251636fa1c3a544dba7">oomph::Problem::get_jacobian()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a82cb428139f7c35a7c62a09fad38eecb">get_matrix_transpose()</a>, <a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a4f714d01cd2fdb791aa0795f34b9610a">oomph::BlockPreconditioner&lt; MATRIX &gt;::internal_get_block()</a>, <a class="el" href="../../da/d2b/generic__mpi__test_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a3853068b7fce9e83bc817930262e9ca1">matrix_reduction()</a>, <a class="el" href="../../d1/d35/namespaceoomph_1_1TrilinosEpetraHelpers.html#a0d96936ed1e5f3266ef06564ae300103">oomph::TrilinosEpetraHelpers::multiply()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#af08fd73a7edbdbde9facf47b913e3e43">multiply()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a9ba295a04e08e3153ae06bc0556f507d">redistribute()</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#aadcbdb5af92d7889c956098cb86dee87">oomph::LagrangeEnforcedFlowPreconditioner::setup()</a>, and <a class="el" href="../../da/d32/classoomph_1_1HelmholtzMGPreconditioner.html#a4285eee67bbf57ae00ca2aada2744743">oomph::HelmholtzMGPreconditioner&lt; DIM &gt;::setup_mg_structures()</a>.</p>

</div>
</div>
<a id="ac04c0787a123256b3dbaf6acf40df4e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac04c0787a123256b3dbaf6acf40df4e2">&#9670;&nbsp;</a></span>build() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::CRDoubleMatrix::build </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>ncol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>column_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>row_start</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>keeps the existing distribution and just matrix that is stored </p>
<p>method to rebuild the matrix, but not the distribution </p>
<div class="fragment"><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;  {</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;    <span class="comment">// call the underlying build method</span></div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;    <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a>.<a class="code" href="../../d4/def/classoomph_1_1CRMatrix.html#a14f6cf02e78e14afc9a50eb73c6d517a">clean_up_memory</a>();</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;    <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a>.<a class="code" href="../../d4/def/classoomph_1_1CRMatrix.html#a73e05d0fc4fe5fb402416b18f17316b8">build</a>(<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab8220b7c2bb763dab32a4d0fea7da6f4">value</a>, <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a21b3dbb8ee74e1247f80ce4506c395f8">column_index</a>, <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start</a>, this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">nrow_local</a>(), ncol);</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160; </div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;    <span class="comment">// matrix has been build</span></div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;    <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a63afd9976f0970a4e6ffee3755d21540">Built</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1CRMatrix_html_a14f6cf02e78e14afc9a50eb73c6d517a"><div class="ttname"><a href="../../d4/def/classoomph_1_1CRMatrix.html#a14f6cf02e78e14afc9a50eb73c6d517a">oomph::CRMatrix::clean_up_memory</a></div><div class="ttdeci">void clean_up_memory()</div><div class="ttdoc">Wipe matrix data and set all values to 0.</div><div class="ttdef"><b>Definition:</b> matrices.h:3323</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/def/classoomph_1_1CRMatrix.html#a73e05d0fc4fe5fb402416b18f17316b8">oomph::CRMatrix&lt; T &gt;::build()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a63afd9976f0970a4e6ffee3755d21540">Built</a>, <a class="el" href="../../d4/def/classoomph_1_1CRMatrix.html#a14f6cf02e78e14afc9a50eb73c6d517a">oomph::CRMatrix&lt; T &gt;::clean_up_memory()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a21b3dbb8ee74e1247f80ce4506c395f8">column_index()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">oomph::DistributableLinearAlgebraObject::nrow_local()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start()</a>, and <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab8220b7c2bb763dab32a4d0fea7da6f4">value()</a>.</p>

</div>
</div>
<a id="aafb4d7de0a87b4bda560928e6a128060"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aafb4d7de0a87b4bda560928e6a128060">&#9670;&nbsp;</a></span>build_without_copy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::CRDoubleMatrix::build_without_copy </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>ncol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>nnz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a> *&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> *&#160;</td>
          <td class="paramname"><em>column_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> *&#160;</td>
          <td class="paramname"><em>row_start</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>method to rebuild the matrix, but not the distribution </p>
<p>keeps the existing distribution and just matrix that is stored without copying the matrix data </p>
<div class="fragment"><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;  {</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;    <span class="comment">// call the underlying build method</span></div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;    <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a>.<a class="code" href="../../d4/def/classoomph_1_1CRMatrix.html#a14f6cf02e78e14afc9a50eb73c6d517a">clean_up_memory</a>();</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;    <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a>.<a class="code" href="../../d4/def/classoomph_1_1CRMatrix.html#aee41b01876f3b8ce9011e6fe7a332da6">build_without_copy</a>(</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;      <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab8220b7c2bb763dab32a4d0fea7da6f4">value</a>, <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a21b3dbb8ee74e1247f80ce4506c395f8">column_index</a>, <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start</a>, <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a9482dafc0a17ebc5b7431369d8d07565">nnz</a>, this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">nrow_local</a>(), ncol);</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160; </div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;    <span class="comment">// matrix has been build</span></div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;    <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a63afd9976f0970a4e6ffee3755d21540">Built</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1CRMatrix_html_aee41b01876f3b8ce9011e6fe7a332da6"><div class="ttname"><a href="../../d4/def/classoomph_1_1CRMatrix.html#aee41b01876f3b8ce9011e6fe7a332da6">oomph::CRMatrix::build_without_copy</a></div><div class="ttdeci">void build_without_copy(T *value, int *column_index, int *row_start, const unsigned long &amp;nnz, const unsigned long &amp;n, const unsigned long &amp;m)</div><div class="ttdef"><b>Definition:</b> matrices.h:3354</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/def/classoomph_1_1CRMatrix.html#aee41b01876f3b8ce9011e6fe7a332da6">oomph::CRMatrix&lt; T &gt;::build_without_copy()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a63afd9976f0970a4e6ffee3755d21540">Built</a>, <a class="el" href="../../d4/def/classoomph_1_1CRMatrix.html#a14f6cf02e78e14afc9a50eb73c6d517a">oomph::CRMatrix&lt; T &gt;::clean_up_memory()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a21b3dbb8ee74e1247f80ce4506c395f8">column_index()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a9482dafc0a17ebc5b7431369d8d07565">nnz()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">oomph::DistributableLinearAlgebraObject::nrow_local()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start()</a>, and <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab8220b7c2bb763dab32a4d0fea7da6f4">value()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ab45d7496790cc29a056b83c194aa2a1c">oomph::NavierStokesSchurComplementPreconditioner::assemble_inv_press_and_veloc_mass_matrix_diagonal()</a>, <a class="el" href="../../d7/da4/classoomph_1_1PressureBasedSolidLSCPreconditioner.html#a2b32d66080ccfb3a464245d16bea6168">oomph::PressureBasedSolidLSCPreconditioner::assemble_mass_matrix_diagonal()</a>, <a class="el" href="../../dd/d95/namespaceoomph_1_1CRDoubleMatrixHelpers.html#a996568831ca0db90f080560dd400b3d6">oomph::CRDoubleMatrixHelpers::concatenate_without_communication()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#af88437afe2b838fd6b508c590d26bd26">CRDoubleMatrix()</a>, <a class="el" href="../../dd/d95/namespaceoomph_1_1CRDoubleMatrixHelpers.html#a157511f700993ab8bc014f9d0d44f4c7">oomph::CRDoubleMatrixHelpers::deep_copy()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a4e59f1c854d1258aa2b4eca218405731">oomph::Problem::get_eigenproblem_matrices()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aab9533075d11b251636fa1c3a544dba7">oomph::Problem::get_jacobian()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a984602c9df0c573451f315a025820ced">global_matrix()</a>, <a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a4f714d01cd2fdb791aa0795f34b9610a">oomph::BlockPreconditioner&lt; MATRIX &gt;::internal_get_block()</a>, <a class="el" href="../../d1/d35/namespaceoomph_1_1TrilinosEpetraHelpers.html#a0d96936ed1e5f3266ef06564ae300103">oomph::TrilinosEpetraHelpers::multiply()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#af08fd73a7edbdbde9facf47b913e3e43">multiply()</a>, and <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a9ba295a04e08e3153ae06bc0556f507d">redistribute()</a>.</p>

</div>
</div>
<a id="aa0503bc64ef0ccb60cb7d7e645425a62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0503bc64ef0ccb60cb7d7e645425a62">&#9670;&nbsp;</a></span>built()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::CRDoubleMatrix::built </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>access function to the Built flag - indicates whether the matrix has been build - i.e. the distribution has been defined and the matrix assembled. </p>
<div class="fragment"><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    {</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a63afd9976f0970a4e6ffee3755d21540">Built</a>;</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a63afd9976f0970a4e6ffee3755d21540">Built</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a57f88253acfa87a764652c06c1bdc362">add()</a>, <a class="el" href="../../d1/d35/namespaceoomph_1_1TrilinosEpetraHelpers.html#a0a8d24c6cf06d8c71bb414c153a276cf">oomph::TrilinosEpetraHelpers::create_distributed_epetra_matrix()</a>, <a class="el" href="../../d1/d35/namespaceoomph_1_1TrilinosEpetraHelpers.html#a1b96bb02b661a770a7b5830af771a249">oomph::TrilinosEpetraHelpers::create_distributed_epetra_matrix_for_aztecoo()</a>, <a class="el" href="../../d6/dc6/namespaceoomph_1_1HypreHelpers.html#a3c7d0df9c9c2ce939e071a16716d7734">oomph::HypreHelpers::create_HYPRE_Matrix()</a>, <a class="el" href="../../dd/d95/namespaceoomph_1_1CRDoubleMatrixHelpers.html#ae3c10e59d5857457c7e34be8e9262035">oomph::CRDoubleMatrixHelpers::create_uniformly_distributed_matrix()</a>, <a class="el" href="../../dd/d95/namespaceoomph_1_1CRDoubleMatrixHelpers.html#a157511f700993ab8bc014f9d0d44f4c7">oomph::CRDoubleMatrixHelpers::deep_copy()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ad438e693468cd0ae179460eafcaab038">diagonal_entries()</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#aeab520bd25edb0f4e88feaedec689333">oomph::MumpsSolver::factorise()</a>, <a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a51636746e5921ee2845daf60b1c322dc">oomph::BlockPreconditioner&lt; MATRIX &gt;::get_concatenated_block()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#af08fd73a7edbdbde9facf47b913e3e43">multiply()</a>, <a class="el" href="../../d1/d35/namespaceoomph_1_1TrilinosEpetraHelpers.html#a595c337ff02ad53b3dcac04ed142f8db">oomph::TrilinosEpetraHelpers::multiply()</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#abe25ba0bd83ba1e963103c4ad95328cc">oomph::DoubleVector::norm()</a>, and <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a9ba295a04e08e3153ae06bc0556f507d">redistribute()</a>.</p>

</div>
</div>
<a id="a70c8a67158c081e70b4d07a6b248bc7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70c8a67158c081e70b4d07a6b248bc7a">&#9670;&nbsp;</a></span>clear()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::CRDoubleMatrix::clear </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>clear </p>
<p>Clean method. </p>
<div class="fragment"><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;  {</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a30742aa2ac9abcfa037179f2d28ff43a">clear_distribution</a>();</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;    <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a>.<a class="code" href="../../d4/def/classoomph_1_1CRMatrix.html#a14f6cf02e78e14afc9a50eb73c6d517a">clean_up_memory</a>();</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;    <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a63afd9976f0970a4e6ffee3755d21540">Built</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160; </div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a86f0315e581cd5b41b75867383aa3760">Linear_solver_pt</a> != 0) <span class="comment">// Only clean up if it exists</span></div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;      <a class="code" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a86f0315e581cd5b41b75867383aa3760">Linear_solver_pt</a>-&gt;<a class="code" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a9d66f3262e80ca06a365f98216afd85f">clean_up_memory</a>();</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1DistributableLinearAlgebraObject_html_a30742aa2ac9abcfa037179f2d28ff43a"><div class="ttname"><a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a30742aa2ac9abcfa037179f2d28ff43a">oomph::DistributableLinearAlgebraObject::clear_distribution</a></div><div class="ttdeci">void clear_distribution()</div><div class="ttdef"><b>Definition:</b> linear_algebra_distribution.h:522</div></div>
<div class="ttc" id="aclassoomph_1_1LinearSolver_html_a9d66f3262e80ca06a365f98216afd85f"><div class="ttname"><a href="../../d5/dd7/classoomph_1_1LinearSolver.html#a9d66f3262e80ca06a365f98216afd85f">oomph::LinearSolver::clean_up_memory</a></div><div class="ttdeci">virtual void clean_up_memory()</div><div class="ttdef"><b>Definition:</b> linear_solver.h:256</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a63afd9976f0970a4e6ffee3755d21540">Built</a>, <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a9d66f3262e80ca06a365f98216afd85f">oomph::LinearSolver::clean_up_memory()</a>, <a class="el" href="../../d4/def/classoomph_1_1CRMatrix.html#a14f6cf02e78e14afc9a50eb73c6d517a">oomph::CRMatrix&lt; T &gt;::clean_up_memory()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a30742aa2ac9abcfa037179f2d28ff43a">oomph::DistributableLinearAlgebraObject::clear_distribution()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a>, and <a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a86f0315e581cd5b41b75867383aa3760">oomph::DoubleMatrixBase::Linear_solver_pt</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a7fc397b91a7289df8ee64287ae20e132">build()</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#aeab520bd25edb0f4e88feaedec689333">oomph::MumpsSolver::factorise()</a>, <a class="el" href="../../dd/d55/classoomph_1_1HypreInterface.html#aebc23d169937d5e6a5b492710843ae7b">oomph::HypreInterface::hypre_matrix_setup()</a>, <a class="el" href="../../da/d2b/generic__mpi__test_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, <a class="el" href="../../dd/d59/classoomph_1_1FSIPreconditioner.html#adadfe9f4332af610b00f1f45d1ad432e">oomph::FSIPreconditioner::setup()</a>, and <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a27c30b4faf3d2328f3b9ce9c590f43a4">~CRDoubleMatrix()</a>.</p>

</div>
</div>
<a id="a21b3dbb8ee74e1247f80ce4506c395f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21b3dbb8ee74e1247f80ce4506c395f8">&#9670;&nbsp;</a></span>column_index() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a>* oomph::CRDoubleMatrix::column_index </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Access to C-style column index array. </p>
<div class="fragment"><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    {</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a>.<a class="code" href="../../d4/def/classoomph_1_1CRMatrix.html#aa6057d1c2a9a491f643e0633c778f8fb">column_index</a>();</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1CRMatrix_html_aa6057d1c2a9a491f643e0633c778f8fb"><div class="ttname"><a href="../../d4/def/classoomph_1_1CRMatrix.html#aa6057d1c2a9a491f643e0633c778f8fb">oomph::CRMatrix::column_index</a></div><div class="ttdeci">int * column_index()</div><div class="ttdoc">Access to C-style column index array.</div><div class="ttdef"><b>Definition:</b> matrices.h:797</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/def/classoomph_1_1CRMatrix.html#aa6057d1c2a9a491f643e0633c778f8fb">oomph::CRMatrix&lt; T &gt;::column_index()</a>, and <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a57f88253acfa87a764652c06c1bdc362">add()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#af44bac2acd071317f96dae49cbb0d977">build()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aafb4d7de0a87b4bda560928e6a128060">build_without_copy()</a>, <a class="el" href="../../dd/d95/namespaceoomph_1_1CRDoubleMatrixHelpers.html#ab7e3ac344aa644292a143a3917a03e65">oomph::CRDoubleMatrixHelpers::concatenate()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#af88437afe2b838fd6b508c590d26bd26">CRDoubleMatrix()</a>, <a class="el" href="../../d1/d35/namespaceoomph_1_1TrilinosEpetraHelpers.html#a0a8d24c6cf06d8c71bb414c153a276cf">oomph::TrilinosEpetraHelpers::create_distributed_epetra_matrix()</a>, <a class="el" href="../../d1/d35/namespaceoomph_1_1TrilinosEpetraHelpers.html#a1b96bb02b661a770a7b5830af771a249">oomph::TrilinosEpetraHelpers::create_distributed_epetra_matrix_for_aztecoo()</a>, <a class="el" href="../../d6/dc6/namespaceoomph_1_1HypreHelpers.html#a3c7d0df9c9c2ce939e071a16716d7734">oomph::HypreHelpers::create_HYPRE_Matrix()</a>, <a class="el" href="../../dd/d95/namespaceoomph_1_1CRDoubleMatrixHelpers.html#a157511f700993ab8bc014f9d0d44f4c7">oomph::CRDoubleMatrixHelpers::deep_copy()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ae35fbae1702bbf75601c2a1026df103e">entries_are_sorted()</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#aeab520bd25edb0f4e88feaedec689333">oomph::MumpsSolver::factorise()</a>, <a class="el" href="../../d7/db1/classoomph_1_1SuperLUSolver.html#a6b1ce356d11fa878315e9b32ac566748">oomph::SuperLUSolver::factorise_serial()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a82cb428139f7c35a7c62a09fad38eecb">get_matrix_transpose()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a984602c9df0c573451f315a025820ced">global_matrix()</a>, <a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a4f714d01cd2fdb791aa0795f34b9610a">oomph::BlockPreconditioner&lt; MATRIX &gt;::internal_get_block()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a3853068b7fce9e83bc817930262e9ca1">matrix_reduction()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a54b75960df52e3aebd21aaab20e9869d">multiply()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a42fb274c98ccf4c2a542ca15343fcc0e">multiply_transpose()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a9ba295a04e08e3153ae06bc0556f507d">redistribute()</a>, <a class="el" href="../../de/dc5/classoomph_1_1ILUZeroPreconditioner_3_01CRDoubleMatrix_01_4.html#a2398a8674540bfdb8d69a699085107d8">oomph::ILUZeroPreconditioner&lt; CRDoubleMatrix &gt;::setup()</a>, <a class="el" href="../../d5/da4/classoomph_1_1PseudoElasticPreconditionerSubsidiaryPreconditionerOld.html#a532201f17edc43b3b475fff2d2744b8b">oomph::PseudoElasticPreconditionerSubsidiaryPreconditionerOld::setup()</a>, <a class="el" href="../../da/d32/classoomph_1_1HelmholtzMGPreconditioner.html#a2436c6189b4cda832bf28471f4f9e23c">oomph::HelmholtzMGPreconditioner&lt; DIM &gt;::setup_coarsest_level_structures()</a>, <a class="el" href="../../dc/df6/classoomph_1_1GS_3_01CRDoubleMatrix_01_4.html#a12a720316ec6fde47e0fa524bd8728b1">oomph::GS&lt; CRDoubleMatrix &gt;::solve_helper()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a2107875787d4dfa1cf007c05a041b078">sort_entries()</a>, and <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a2b5dcdc5e1b9ccea51647f02b3239e66">sparse_indexed_output_with_offset()</a>.</p>

</div>
</div>
<a id="a886a481d11974f5707405f573fcb9850"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a886a481d11974f5707405f573fcb9850">&#9670;&nbsp;</a></span>column_index() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a>* oomph::CRDoubleMatrix::column_index </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Access to C-style column index array (const version) </p>
<div class="fragment"><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    {</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a>.<a class="code" href="../../d4/def/classoomph_1_1CRMatrix.html#aa6057d1c2a9a491f643e0633c778f8fb">column_index</a>();</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/def/classoomph_1_1CRMatrix.html#aa6057d1c2a9a491f643e0633c778f8fb">oomph::CRMatrix&lt; T &gt;::column_index()</a>, and <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a>.</p>

</div>
</div>
<a id="ad438e693468cd0ae179460eafcaab038"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad438e693468cd0ae179460eafcaab038">&#9670;&nbsp;</a></span>diagonal_entries()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; oomph::CRDoubleMatrix::diagonal_entries </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>returns a Vector of diagonal entries of this matrix. This only works with square matrices. This condition may be relaxed in the future if need be.</p>
<p>Return the diagonal entries of the matrix. This only works with square matrices. This condition may be relaxed in the future if need be. </p>
<div class="fragment"><div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;  {</div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;    <span class="comment">// Check if the matrix has been built.</span></div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;    <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aa0503bc64ef0ccb60cb7d7e645425a62">built</a>())</div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;    {</div>
<div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;      std::ostringstream error_message;</div>
<div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;      error_message &lt;&lt; <span class="stringliteral">&quot;The matrix has not been built.\n&quot;</span></div>
<div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;Please build it...\n&quot;</span>;</div>
<div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;        error_message.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;    }</div>
<div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160; </div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;    <span class="comment">// Check if this is a square matrix.</span></div>
<div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#abd8d231b0549540144b4739a667b1e75">nrow</a>() != this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a4ed5597d8a34dd14f90b0e6cfb88ca2e">ncol</a>())</div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;    {</div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;      std::ostringstream error_message;</div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;      error_message &lt;&lt; <span class="stringliteral">&quot;The matrix is not square. Can only get the diagonal\n&quot;</span></div>
<div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;entries of a square matrix.\n&quot;</span>;</div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;        error_message.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;    }</div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160; </div>
<div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;    <span class="comment">// We get the diagonal entries on this processor.</span></div>
<div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">nrow_local</a> = this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">nrow_local</a>();</div>
<div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160; </div>
<div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;    <span class="comment">// Create storage for the diagonal entries.</span></div>
<div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;    Vector&lt;double&gt; result_vec;</div>
<div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;    result_vec.reserve(<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">nrow_local</a>);</div>
<div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160; </div>
<div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;    <span class="comment">// Get the first row for the column offset.</span></div>
<div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ab00a3919b8634c698749f14a4d92947d">first_row</a> = this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ab00a3919b8634c698749f14a4d92947d">first_row</a>();</div>
<div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160; </div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;    <span class="comment">// Loop through the local rows.</span></div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">nrow_local</a>; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;    {</div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;      <span class="comment">// The column entries are globally indexed.</span></div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;      <span class="keywordtype">unsigned</span> diag_entry_col = <a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ab00a3919b8634c698749f14a4d92947d">first_row</a> + <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160; </div>
<div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;      <span class="comment">// Push back the diagonal entry.</span></div>
<div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;      result_vec.push_back(<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a>.<a class="code" href="../../d4/def/classoomph_1_1CRMatrix.html#afc7fe758067c8ab3fe2dba96a4258492">get_entry</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, diag_entry_col));</div>
<div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;    }</div>
<div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160; </div>
<div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;    <span class="keywordflow">return</span> result_vec;</div>
<div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1CRMatrix_html_afc7fe758067c8ab3fe2dba96a4258492"><div class="ttname"><a href="../../d4/def/classoomph_1_1CRMatrix.html#afc7fe758067c8ab3fe2dba96a4258492">oomph::CRMatrix::get_entry</a></div><div class="ttdeci">T get_entry(const unsigned long &amp;i, const unsigned long &amp;j) const</div><div class="ttdef"><b>Definition:</b> matrices.h:748</div></div>
<div class="ttc" id="aclassoomph_1_1DistributableLinearAlgebraObject_html_ab00a3919b8634c698749f14a4d92947d"><div class="ttname"><a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ab00a3919b8634c698749f14a4d92947d">oomph::DistributableLinearAlgebraObject::first_row</a></div><div class="ttdeci">unsigned first_row() const</div><div class="ttdoc">access function for the first row on this processor</div><div class="ttdef"><b>Definition:</b> linear_algebra_distribution.h:481</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aa0503bc64ef0ccb60cb7d7e645425a62">built()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ab00a3919b8634c698749f14a4d92947d">oomph::DistributableLinearAlgebraObject::first_row()</a>, <a class="el" href="../../d4/def/classoomph_1_1CRMatrix.html#afc7fe758067c8ab3fe2dba96a4258492">oomph::CRMatrix&lt; T &gt;::get_entry()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a4ed5597d8a34dd14f90b0e6cfb88ca2e">ncol()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#abd8d231b0549540144b4739a667b1e75">nrow()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">oomph::DistributableLinearAlgebraObject::nrow_local()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, and <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../df/daa/classoomph_1_1ComplexDampedJacobi.html#a4cf2cdac05266021cd0660ba60ae6a8b">oomph::ComplexDampedJacobi&lt; MATRIX &gt;::complex_smoother_setup()</a>, and <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#aadcbdb5af92d7889c956098cb86dee87">oomph::LagrangeEnforcedFlowPreconditioner::setup()</a>.</p>

</div>
</div>
<a id="a311cf35d030c6cc22b389c2542a4089c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a311cf35d030c6cc22b389c2542a4089c">&#9670;&nbsp;</a></span>distributed_matrix_matrix_multiply_method() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&amp; oomph::CRDoubleMatrix::distributed_matrix_matrix_multiply_method </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Access function to Distributed_matrix_matrix_multiply_method, the flag which determines the matrix matrix multiplication method used for distributed matrices. Method 1: Trilinos Epetra Matrix Matrix multiply. Method 2: Trilinos Epetra Matrix Matrix multiply (ML based). </p>
<div class="fragment"><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    {</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a4ab4056eff376d383c613a11082651cb">Distributed_matrix_matrix_multiply_method</a>;</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1CRDoubleMatrix_html_a4ab4056eff376d383c613a11082651cb"><div class="ttname"><a href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a4ab4056eff376d383c613a11082651cb">oomph::CRDoubleMatrix::Distributed_matrix_matrix_multiply_method</a></div><div class="ttdeci">unsigned Distributed_matrix_matrix_multiply_method</div><div class="ttdef"><b>Definition:</b> matrices.h:1246</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a4ab4056eff376d383c613a11082651cb">Distributed_matrix_matrix_multiply_method</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d95/namespaceoomph_1_1CRDoubleMatrixHelpers.html#a157511f700993ab8bc014f9d0d44f4c7">oomph::CRDoubleMatrixHelpers::deep_copy()</a>.</p>

</div>
</div>
<a id="a61b0b02e40f94ddceecafe38626e7ad2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61b0b02e40f94ddceecafe38626e7ad2">&#9670;&nbsp;</a></span>distributed_matrix_matrix_multiply_method() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&amp; oomph::CRDoubleMatrix::distributed_matrix_matrix_multiply_method </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Read only access function (const version) to Distributed_matrix_matrix_multiply_method, the flag which determines the matrix matrix multiplication method used for distributed matrices. Method 1: Trilinos Epetra Matrix Matrix multiply. Method 2: Trilinos Epetra Matrix Matrix multiply (ML based). </p>
<div class="fragment"><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    {</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a4ab4056eff376d383c613a11082651cb">Distributed_matrix_matrix_multiply_method</a>;</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a4ab4056eff376d383c613a11082651cb">Distributed_matrix_matrix_multiply_method</a>.</p>

</div>
</div>
<a id="ae35fbae1702bbf75601c2a1026df103e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae35fbae1702bbf75601c2a1026df103e">&#9670;&nbsp;</a></span>entries_are_sorted()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::CRDoubleMatrix::entries_are_sorted </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;&#160;</td>
          <td class="paramname"><em>doc_unordered_entries</em> = <code>false</code></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Runs through the column index vector and checks if the entries follow the regular lexicographical ordering of matrix entries, i.e. it will check (at the i-th row of the matrix) if the entries in the column index vector associated with this row are in increasing order</p>
<p>Runs through the column index vector and checks if the entries are arranged arbitrarily or if they follow the regular lexicographical of matrices. If a boolean argument is provided with the assignment TRUE then information on the first entry which is not in the correct position will also be given </p>
<div class="fragment"><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;  {</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    <span class="comment">// We only need to produce a warning if the matrix is distributed</span></div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a5505731e7e73d7e4251c67c7adec6bf5">distributed</a>())</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    {</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;      <span class="comment">// Create an ostringstream object to store the warning message</span></div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;      std::ostringstream warning_message;</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160; </div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;      <span class="comment">// Create the warning messsage</span></div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;      warning_message &lt;&lt; <span class="stringliteral">&quot;This method currently works for serial but &quot;</span></div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;has not been implemented for use with MPI!\n&quot;</span>;</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160; </div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;      <span class="comment">// Issue the warning</span></div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;      OomphLibWarning(warning_message.str(),</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;                      <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;                      <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    }</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160; </div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;    <span class="comment">// Get the number of rows in this matrix</span></div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;    <span class="keywordtype">unsigned</span> n_rows = this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#abd8d231b0549540144b4739a667b1e75">nrow</a>();</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160; </div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;    <span class="comment">// Acquire access to the value, row_start and column_index arrays from</span></div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;    <span class="comment">// the CR matrix. Since we do not change anything in row_start_pt we</span></div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    <span class="comment">// give it the const prefix</span></div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span>* column_index_pt = this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a21b3dbb8ee74e1247f80ce4506c395f8">column_index</a>();</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span>* row_start_pt = this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start</a>();</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160; </div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    <span class="comment">// Loop over the rows of matrix</span></div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_rows; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;    {</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;      <span class="comment">// Calculate the number of nonzeros in the i-th row</span></div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;      <span class="keywordtype">unsigned</span> nnz_row_i = *(row_start_pt + <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1) - *(row_start_pt + <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160; </div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;      <span class="comment">// Get the index of the first entry in row i</span></div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;      <span class="keywordtype">unsigned</span> i_row_start = *(row_start_pt + <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160; </div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;      <span class="comment">// Loop over the entries of the i-th row</span></div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; nnz_row_i - 1; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;      {</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;        <span class="comment">// Check if the column index of the following entry is greater than the</span></div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;        <span class="comment">// current entry</span></div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;        <span class="keywordflow">if</span> ((*(column_index_pt + i_row_start + <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> + 1)) &lt;</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;            (*(column_index_pt + i_row_start + <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>)))</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;        {</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;          <span class="comment">// If the input argument was set to TRUE we document we output</span></div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;          <span class="comment">// information of the first entry which is not in the correct position</span></div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;          <span class="keywordflow">if</span> (doc_unordered_entries)</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;          {</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;            <span class="comment">// Tell the user</span></div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;            <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Matrix has not been correctly sorted!&quot;</span></div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot;\nOn row: &quot;</span> &lt;&lt; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot;\nEntry: &quot;</span> &lt;&lt; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a></div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot;\nEntry 1 = &quot;</span> &lt;&lt; *(column_index_pt + i_row_start + <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>)</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot;\nEntry 2 = &quot;</span></div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;                       &lt;&lt; *(column_index_pt + i_row_start + <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> + 1) &lt;&lt; std::endl;</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;          }</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160; </div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;          <span class="comment">// It hasn&#39;t worked</span></div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;        } <span class="comment">// if ((*(column_index_pt+i_row_start+j+1)) ...</span></div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;      } <span class="comment">// for (unsigned j=0;j&lt;nnz_row_i-1;j++)</span></div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;    } <span class="comment">// for (unsigned i=0;i&lt;n_rows;i++)</span></div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160; </div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;    <span class="comment">// If it gets here without a warning then the entries in each row of</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;    <span class="comment">// the matrix are ordered by increasing column index</span></div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;  } <span class="comment">// End of entries_are_sorted()</span></div>
<div class="ttc" id="aclassoomph_1_1DistributableLinearAlgebraObject_html_a5505731e7e73d7e4251c67c7adec6bf5"><div class="ttname"><a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a5505731e7e73d7e4251c67c7adec6bf5">oomph::DistributableLinearAlgebraObject::distributed</a></div><div class="ttdeci">bool distributed() const</div><div class="ttdoc">distribution is serial or distributed</div><div class="ttdef"><b>Definition:</b> linear_algebra_distribution.h:493</div></div>
<div class="ttc" id="anamespaceoomph_html_aec474227917784dc0a255faf289cfc16"><div class="ttname"><a href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a></div><div class="ttdeci">OomphInfo oomph_info</div><div class="ttdef"><b>Definition:</b> oomph_definitions.cc:319</div></div>
<div class="ttc" id="atut__arithmetic__redux__minmax_8cpp_html_a39513f0f8d942bf9ef17b2e87ac6d34e"><div class="ttname"><a href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a></div><div class="ttdeci">std::ptrdiff_t j</div><div class="ttdef"><b>Definition:</b> tut_arithmetic_redux_minmax.cpp:2</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a21b3dbb8ee74e1247f80ce4506c395f8">column_index()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a5505731e7e73d7e4251c67c7adec6bf5">oomph::DistributableLinearAlgebraObject::distributed()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#abd8d231b0549540144b4739a667b1e75">nrow()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, and <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start()</a>.</p>

</div>
</div>
<a id="a80c3342b36dbcdf60bb21676fda66c97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80c3342b36dbcdf60bb21676fda66c97">&#9670;&nbsp;</a></span>get_index_of_diagonal_entries()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt;<a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a>&gt; oomph::CRDoubleMatrix::get_index_of_diagonal_entries </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Access function: returns the vector Index_of_diagonal_entries. The i-th entry of the vector contains the index of the last entry below or on the diagonal. If there are no entries below or on the diagonal then the corresponding entry is -1. If, however, there are no entries in the row then the entry is irrelevant and is kept as the initialised value; 0. </p>
<div class="fragment"><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    {</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;      <span class="comment">// Check to see if the vector has been set up</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a6cb9860ebacf742fc7fc47d77703cc82">Index_of_diagonal_entries</a>.size() == 0)</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;      {</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        <span class="comment">// Make the warning</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;        <a class="code" href="../../d2/dc3/namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">std::string</a> err_strng =</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;          <span class="stringliteral">&quot;The Index_of_diagonal_entries vector has not been &quot;</span>;</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        err_strng += <span class="stringliteral">&quot;set up yet. Run sort_entries() to set this vector up.&quot;</span>;</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160; </div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;        <span class="comment">// Throw the warning</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;        OomphLibWarning(err_strng,</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                        <span class="stringliteral">&quot;CRDoubleMatrix::get_index_of_diagonal_entries()&quot;</span>,</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                        <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;      }</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160; </div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;      <span class="comment">// Return the vector</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a6cb9860ebacf742fc7fc47d77703cc82">Index_of_diagonal_entries</a>;</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    } <span class="comment">// End of index_of_diagonal_entries</span></div>
<div class="ttc" id="aclassoomph_1_1CRDoubleMatrix_html_a6cb9860ebacf742fc7fc47d77703cc82"><div class="ttname"><a href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a6cb9860ebacf742fc7fc47d77703cc82">oomph::CRDoubleMatrix::Index_of_diagonal_entries</a></div><div class="ttdeci">Vector&lt; int &gt; Index_of_diagonal_entries</div><div class="ttdef"><b>Definition:</b> matrices.h:1238</div></div>
<div class="ttc" id="anamespaceoomph_1_1Global__string__for__annotation_html_ac5379de2fa7fe44f2cb31785fc208135"><div class="ttname"><a href="../../d2/dc3/namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">oomph::Global_string_for_annotation::string</a></div><div class="ttdeci">std::string string(const unsigned &amp;i)</div><div class="ttdef"><b>Definition:</b> oomph_definitions.cc:286</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a6cb9860ebacf742fc7fc47d77703cc82">Index_of_diagonal_entries</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, and <a class="el" href="../../d2/dc3/namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">oomph::Global_string_for_annotation::string()</a>.</p>

</div>
</div>
<a id="a82cb428139f7c35a7c62a09fad38eecb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82cb428139f7c35a7c62a09fad38eecb">&#9670;&nbsp;</a></span>get_matrix_transpose()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::CRDoubleMatrix::get_matrix_transpose </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> *&#160;</td>
          <td class="paramname"><em>result</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the transpose of this matrix. </p>
<p>Compute transpose of matrix. </p>
<div class="fragment"><div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;  {</div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;    <span class="comment">// Get the number of non_zeros</span></div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nnon_zeros = this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a9482dafc0a17ebc5b7431369d8d07565">nnz</a>();</div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160; </div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;    <span class="comment">// Find the number of rows and columns in the transposed</span></div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;    <span class="comment">// matrix. We differentiate these from those associated</span></div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;    <span class="comment">// with the original matrix by appending the characters</span></div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;    <span class="comment">// &#39;_t&#39; onto the end</span></div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n_rows = this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#abd8d231b0549540144b4739a667b1e75">nrow</a>();</div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n_rows_t = this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a4ed5597d8a34dd14f90b0e6cfb88ca2e">ncol</a>();</div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160; </div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;    <span class="comment">// We only need to produce a warning if the matrix is distributed</span></div>
<div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a5505731e7e73d7e4251c67c7adec6bf5">distributed</a>())</div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;    {</div>
<div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;      <span class="comment">// Create an ostringstream object to store the warning message</span></div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;      std::ostringstream warning_message;</div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160; </div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;      <span class="comment">// Create the warning messsage</span></div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;      warning_message &lt;&lt; <span class="stringliteral">&quot;This method currently works for serial but &quot;</span></div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;has not been tested with MPI!\n&quot;</span>;</div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160; </div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;      <span class="comment">// Issue the warning</span></div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;      OomphLibWarning(warning_message.str(),</div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;                      <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;                      <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;    }</div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160; </div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;    <span class="comment">// Set up the distribution for the transposed matrix</span></div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;    result-&gt;distribution_pt()-&gt;build(</div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;      this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>()-&gt;communicator_pt(), n_rows_t, <span class="keyword">false</span>);</div>
<div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160; </div>
<div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;    <span class="comment">// Acquire access to the value, row_start and column_index</span></div>
<div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;    <span class="comment">// arrays from the CR matrix</span></div>
<div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span>* value_pt = this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab8220b7c2bb763dab32a4d0fea7da6f4">value</a>();</div>
<div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span>* row_start_pt = this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start</a>();</div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span>* column_index_pt = this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a21b3dbb8ee74e1247f80ce4506c395f8">column_index</a>();</div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160; </div>
<div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;    <span class="comment">// Allocate space for the row_start and column_index vectors</span></div>
<div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;    <span class="comment">// associated with the transpose of the current matrix.</span></div>
<div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;    Vector&lt;double&gt; value_t(nnon_zeros, 0.0);</div>
<div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;    Vector&lt;int&gt; column_index_t(nnon_zeros, 0);</div>
<div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;    Vector&lt;int&gt; row_start_t(n_rows_t + 1, 0);</div>
<div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160; </div>
<div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;    <span class="comment">// Loop over the column index vector and count how many times</span></div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;    <span class="comment">// each column number occurs and increment the appropriate</span></div>
<div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;    <span class="comment">// entry in row_start_t whose i+1&#39;th entry will contain the</span></div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;    <span class="comment">// number of non-zeros in the i&#39;th column of the matrix (this</span></div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;    <span class="comment">// is done so that the cumulative sum done next returns the</span></div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;    <span class="comment">// correct result)</span></div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; nnon_zeros; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;    {</div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;      <span class="comment">// Assign entries to row_start_t (noting the first</span></div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;      <span class="comment">// entry is left as 0 for the cumulative sum done later)</span></div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;      row_start_t[*(column_index_pt + <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) + 1]++;</div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;    }</div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160; </div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;    <span class="comment">// Calculate the sum of the first i entries in the row_start_t</span></div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;    <span class="comment">// vector and store the values in the i&#39;th entry of row_start_t</span></div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 1; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_rows_t + 1; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;    {</div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;      <span class="comment">// Calculate the cumulative sum</span></div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;      row_start_t[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] += row_start_t[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - 1];</div>
<div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;    }</div>
<div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160; </div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;    <span class="comment">// Allocate space for variables to store the indices of the</span></div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;    <span class="comment">// start and end of the non-zeros in a given row of the matrix</span></div>
<div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;    <span class="keywordtype">unsigned</span> i_row_s = 0;</div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;    <span class="keywordtype">unsigned</span> i_row_e = 0;</div>
<div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160; </div>
<div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;    <span class="comment">// Initialise 3 extra variables for readability of the</span></div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;    <span class="comment">// code in the subsequent piece of code</span></div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a3c00523890f1892f53e8246b909e04dc">a</a> = 0;</div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a> = 0;</div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a> = 0;</div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160; </div>
<div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;    <span class="comment">// Vector needed to count the number of entries added</span></div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;    <span class="comment">// to each segment in column_index_t where each segment</span></div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;    <span class="comment">// is associated with each row in the transposed matrix</span></div>
<div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;    Vector&lt;int&gt; counter(n_rows_t, 0);</div>
<div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160; </div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;    <span class="comment">// Set the entries in column_index_t. To do this we loop</span></div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;    <span class="comment">// over each row of the original matrix (equivalently</span></div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;    <span class="comment">// the number of columns in the transpose)</span></div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i_row = 0; i_row &lt; n_rows; i_row++)</div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;    {</div>
<div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;      <span class="comment">// Here we find the indices of the start and end</span></div>
<div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;      <span class="comment">// of the non-zeros in i_row&#39;th row of the matrix.</span></div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;      <span class="comment">// [Note, there should be a -1 on i_row_e but this</span></div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;      <span class="comment">// is ignored so that we use a strict inequality</span></div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;      <span class="comment">// in the subsequent for-loop!]</span></div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;      i_row_s = *(row_start_pt + i_row);</div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;      i_row_e = *(row_start_pt + i_row + 1);</div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160; </div>
<div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;      <span class="comment">// Loop over the entries in the i_row&#39;th row</span></div>
<div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;      <span class="comment">// of the matrix</span></div>
<div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = i_row_s; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; i_row_e; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;      {</div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;        <span class="comment">// The value of a is the column index of the j&#39;th</span></div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;        <span class="comment">// element in the i_row&#39;th row of the original matrix</span></div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;        <span class="comment">// (which is also the row index of the associated</span></div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;        <span class="comment">// non-zero in the transposed matrix)</span></div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;        <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a3c00523890f1892f53e8246b909e04dc">a</a> = *(column_index_pt + <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160; </div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;        <span class="comment">// The value of b will be used to find the start</span></div>
<div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;        <span class="comment">// of the appropriate segment of column_index_t</span></div>
<div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;        <span class="comment">// that the non-zero belongs in</span></div>
<div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;        <a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a> = row_start_t[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a3c00523890f1892f53e8246b909e04dc">a</a>];</div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160; </div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;        <span class="comment">// Find the number of elements already added to</span></div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;        <span class="comment">// this segment (to find which entry of the segment</span></div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;        <span class="comment">// the value i_row, the column index of the non-zero</span></div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;        <span class="comment">// in the transposed matrix, should be assigned to)</span></div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;        <a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a> = counter[*(column_index_pt + <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>)];</div>
<div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160; </div>
<div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;        <span class="comment">// Assign the value i_row to the appropriate entry</span></div>
<div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;        <span class="comment">// in column_index_t</span></div>
<div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;        column_index_t[<a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a> + <a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>] = i_row;</div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;        value_t[<a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a> + <a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>] = *(value_pt + <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160; </div>
<div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;        <span class="comment">// Increment the j&#39;th value of the vector counter</span></div>
<div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;        <span class="comment">// to indicate another non-zero index has been</span></div>
<div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;        <span class="comment">// added into the</span></div>
<div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;        counter[*(column_index_pt + <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>)]++;</div>
<div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160; </div>
<div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;      } <span class="comment">// End of for-loop over i_row&#39;th row of the matrix</span></div>
<div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160; </div>
<div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;    } <span class="comment">// End of for-loop over rows of the matrix</span></div>
<div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160; </div>
<div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;    <span class="comment">// Build the matrix (note: the value of n_cols for the</span></div>
<div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;    <span class="comment">// transposed matrix is n_rows for the original matrix)</span></div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;    result-&gt;build(n_rows, value_t, column_index_t, row_start_t);</div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160; </div>
<div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;  } <span class="comment">// End of the function</span></div>
<div class="ttc" id="abenchVecAdd_8cpp_html_af9816f50f32fc22762a8289c3cc44f22"><div class="ttname"><a href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a></div><div class="ttdeci">Scalar * b</div><div class="ttdef"><b>Definition:</b> benchVecAdd.cpp:17</div></div>
<div class="ttc" id="alevel2__cplx__impl_8h_html_a3c00523890f1892f53e8246b909e04dc"><div class="ttname"><a href="../../da/dc6/level2__cplx__impl_8h.html#a3c00523890f1892f53e8246b909e04dc">a</a></div><div class="ttdeci">const Scalar * a</div><div class="ttdef"><b>Definition:</b> level2_cplx_impl.h:32</div></div>
<div class="ttc" id="anamespacecalibrate_html_a1919e193275bfcb62d1e5b79a3aea213"><div class="ttname"><a href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">calibrate.c</a></div><div class="ttdeci">int c</div><div class="ttdef"><b>Definition:</b> calibrate.py:100</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../da/dc6/level2__cplx__impl_8h.html#a3c00523890f1892f53e8246b909e04dc">a</a>, <a class="el" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#af44bac2acd071317f96dae49cbb0d977">build()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a3cab441019e738e4c6db6ee22dd71515">oomph::LinearAlgebraDistribution::build()</a>, <a class="el" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">calibrate::c</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a21b3dbb8ee74e1247f80ce4506c395f8">column_index()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a5505731e7e73d7e4251c67c7adec6bf5">oomph::DistributableLinearAlgebraObject::distributed()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">oomph::DistributableLinearAlgebraObject::distribution_pt()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a4ed5597d8a34dd14f90b0e6cfb88ca2e">ncol()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a9482dafc0a17ebc5b7431369d8d07565">nnz()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#abd8d231b0549540144b4739a667b1e75">nrow()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start()</a>, and <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab8220b7c2bb763dab32a4d0fea7da6f4">value()</a>.</p>

</div>
</div>
<a id="a984602c9df0c573451f315a025820ced"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a984602c9df0c573451f315a025820ced">&#9670;&nbsp;</a></span>global_matrix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> * oomph::CRDoubleMatrix::global_matrix </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>if this matrix is distributed then a the equivalent global matrix is built using new and returned. The calling method is responsible for the destruction of the new matrix.</p>
<p>if this matrix is distributed then the equivalent global matrix is built using new and returned. The calling method is responsible for the destruction of the new matrix. </p>
<div class="fragment"><div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;  {</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;    <span class="comment">// if this matrix is not distributed then this method is redundant</span></div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;    <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a5505731e7e73d7e4251c67c7adec6bf5">distributed</a>() ||</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;        this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>()-&gt;communicator_pt()-&gt;nproc() == 1)</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;    {</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ad8914fa1a5a98f7602a1724b76eef26c">CRDoubleMatrix</a>(*<span class="keyword">this</span>);</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;    }</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160; </div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;    <span class="comment">// nnz</span></div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a9482dafc0a17ebc5b7431369d8d07565">nnz</a> = this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a9482dafc0a17ebc5b7431369d8d07565">nnz</a>();</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160; </div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;    <span class="comment">// my nrow local</span></div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">nrow_local</a> = this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">nrow_local</a>();</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160; </div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;    <span class="comment">// nrow global</span></div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#abd8d231b0549540144b4739a667b1e75">nrow</a> = this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#abd8d231b0549540144b4739a667b1e75">nrow</a>();</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160; </div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;    <span class="comment">// cache nproc</span></div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;    <span class="keywordtype">int</span> nproc = this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>()-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a2e4736826a65253f574d4f6f152ab514">communicator_pt</a>()-&gt;<a class="code" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a6c78c72666f4b102c2bccf200f0853b7">nproc</a>();</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160; </div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;    <span class="comment">// get the nnzs on the other processors</span></div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;    <span class="keywordtype">int</span>* dist_nnz_pt = <span class="keyword">new</span> <span class="keywordtype">int</span>[nproc];</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;    MPI_Allgather(&amp;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a9482dafc0a17ebc5b7431369d8d07565">nnz</a>,</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;                  1,</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;                  MPI_INT,</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;                  dist_nnz_pt,</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;                  1,</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;                  MPI_INT,</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;                  this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>()-&gt;communicator_pt()-&gt;mpi_comm());</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160; </div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;    <span class="comment">// create a int vector of first rows and nrow local and compute nnz global</span></div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;    <span class="keywordtype">int</span>* dist_first_row = <span class="keyword">new</span> <span class="keywordtype">int</span>[nproc];</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;    <span class="keywordtype">int</span>* dist_nrow_local = <span class="keyword">new</span> <span class="keywordtype">int</span>[nproc];</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;    <span class="keywordtype">int</span> nnz_global = 0;</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> = 0; <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> &lt; nproc; <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>++)</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;    {</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;      nnz_global += dist_nnz_pt[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>];</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;      dist_first_row[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] = this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ab00a3919b8634c698749f14a4d92947d">first_row</a>(<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>);</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;      dist_nrow_local[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] = this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">nrow_local</a>(<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>);</div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;    }</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160; </div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;    <span class="comment">// compute the offset for the values and column index data</span></div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;    <span class="keywordtype">int</span>* nnz_offset = <span class="keyword">new</span> <span class="keywordtype">int</span>[nproc];</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;    nnz_offset[0] = 0;</div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> = 1; <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> &lt; nproc; <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>++)</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;    {</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;      nnz_offset[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] = nnz_offset[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> - 1] + dist_nnz_pt[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> - 1];</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;    }</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160; </div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;    <span class="comment">// get pointers to the (current) distributed data</span></div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;    <span class="comment">// const_cast required because MPI requires non-const data when sending</span></div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;    <span class="comment">// data</span></div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;    <span class="keywordtype">int</span>* dist_row_start = <span class="keyword">const_cast&lt;</span><span class="keywordtype">int</span>*<span class="keyword">&gt;</span>(this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start</a>());</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;    <span class="keywordtype">int</span>* dist_column_index = <span class="keyword">const_cast&lt;</span><span class="keywordtype">int</span>*<span class="keyword">&gt;</span>(this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a21b3dbb8ee74e1247f80ce4506c395f8">column_index</a>());</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;    <span class="keywordtype">double</span>* dist_value = <span class="keyword">const_cast&lt;</span><span class="keywordtype">double</span>*<span class="keyword">&gt;</span>(this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab8220b7c2bb763dab32a4d0fea7da6f4">value</a>());</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160; </div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;    <span class="comment">// space for the global matrix</span></div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;    <span class="keywordtype">int</span>* global_row_start = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#abd8d231b0549540144b4739a667b1e75">nrow</a> + 1];</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;    <span class="keywordtype">int</span>* global_column_index = <span class="keyword">new</span> <span class="keywordtype">int</span>[nnz_global];</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;    <span class="keywordtype">double</span>* global_value = <span class="keyword">new</span> <span class="keywordtype">double</span>[nnz_global];</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160; </div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;    <span class="comment">// get the row starts</span></div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;    MPI_Allgatherv(dist_row_start,</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;                   <a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">nrow_local</a>,</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;                   MPI_INT,</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;                   global_row_start,</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;                   dist_nrow_local,</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;                   dist_first_row,</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;                   MPI_INT,</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;                   this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>()-&gt;communicator_pt()-&gt;mpi_comm());</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160; </div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;    <span class="comment">// get the column indexes</span></div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;    MPI_Allgatherv(dist_column_index,</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;                   <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a9482dafc0a17ebc5b7431369d8d07565">nnz</a>,</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;                   MPI_INT,</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;                   global_column_index,</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;                   dist_nnz_pt,</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;                   nnz_offset,</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;                   MPI_INT,</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;                   this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>()-&gt;communicator_pt()-&gt;mpi_comm());</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160; </div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;    <span class="comment">// get the values</span></div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;    MPI_Allgatherv(dist_value,</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;                   <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a9482dafc0a17ebc5b7431369d8d07565">nnz</a>,</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;                   MPI_DOUBLE,</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;                   global_value,</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;                   dist_nnz_pt,</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;                   nnz_offset,</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;                   MPI_DOUBLE,</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;                   this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>()-&gt;communicator_pt()-&gt;mpi_comm());</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160; </div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;    <span class="comment">// finally the last row start</span></div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;    global_row_start[<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#abd8d231b0549540144b4739a667b1e75">nrow</a>] = nnz_global;</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160; </div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;    <span class="comment">// update the other row start</span></div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> = 0; <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> &lt; nproc; <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>++)</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;    {</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; dist_nrow_local[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>]; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;      {</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;        <span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = dist_first_row[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] + <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;        global_row_start[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>] += nnz_offset[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>];</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;      }</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;    }</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160; </div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;    <span class="comment">// create the global distribution</span></div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;    LinearAlgebraDistribution* dist_pt = <span class="keyword">new</span> LinearAlgebraDistribution(</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;      this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>()-&gt;communicator_pt(), <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#abd8d231b0549540144b4739a667b1e75">nrow</a>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160; </div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;    <span class="comment">// create the matrix</span></div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;    <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ad8914fa1a5a98f7602a1724b76eef26c">CRDoubleMatrix</a>* matrix_pt = <span class="keyword">new</span> <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ad8914fa1a5a98f7602a1724b76eef26c">CRDoubleMatrix</a>(dist_pt);</div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160; </div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;    <span class="comment">// copy of distribution taken so delete</span></div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;    <span class="keyword">delete</span> dist_pt;</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160; </div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;    <span class="comment">// pass data into matrix</span></div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;    matrix_pt-&gt;build_without_copy(this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a4ed5597d8a34dd14f90b0e6cfb88ca2e">ncol</a>(),</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;                                  nnz_global,</div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;                                  global_value,</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;                                  global_column_index,</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;                                  global_row_start);</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160; </div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;    <span class="comment">// clean up</span></div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;    <span class="keyword">delete</span>[] dist_first_row;</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;    <span class="keyword">delete</span>[] dist_nrow_local;</div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;    <span class="keyword">delete</span>[] nnz_offset;</div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;    <span class="keyword">delete</span>[] dist_nnz_pt;</div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160; </div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;    <span class="comment">// and return</span></div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;    <span class="keywordflow">return</span> matrix_pt;</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ad8914fa1a5a98f7602a1724b76eef26c">CRDoubleMatrix</a>(*<span class="keyword">this</span>);</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;  }</div>
<div class="ttc" id="aTutorial__Map__using_8cpp_html_a7fe964f6b1afd4591f637999272ab9a2"><div class="ttname"><a href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a></div><div class="ttdeci">float * p</div><div class="ttdef"><b>Definition:</b> Tutorial_Map_using.cpp:9</div></div>
<div class="ttc" id="aclassoomph_1_1CRDoubleMatrix_html_ad8914fa1a5a98f7602a1724b76eef26c"><div class="ttname"><a href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ad8914fa1a5a98f7602a1724b76eef26c">oomph::CRDoubleMatrix::CRDoubleMatrix</a></div><div class="ttdeci">CRDoubleMatrix()</div><div class="ttdoc">Default constructor.</div><div class="ttdef"><b>Definition:</b> matrices.cc:1214</div></div>
<div class="ttc" id="aclassoomph_1_1LinearAlgebraDistribution_html_a2e4736826a65253f574d4f6f152ab514"><div class="ttname"><a href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a2e4736826a65253f574d4f6f152ab514">oomph::LinearAlgebraDistribution::communicator_pt</a></div><div class="ttdeci">OomphCommunicator * communicator_pt() const</div><div class="ttdoc">const access to the communicator pointer</div><div class="ttdef"><b>Definition:</b> linear_algebra_distribution.h:335</div></div>
<div class="ttc" id="aclassoomph_1_1OomphCommunicator_html_a6c78c72666f4b102c2bccf200f0853b7"><div class="ttname"><a href="../../de/d83/classoomph_1_1OomphCommunicator.html#a6c78c72666f4b102c2bccf200f0853b7">oomph::OomphCommunicator::nproc</a></div><div class="ttdeci">int nproc() const</div><div class="ttdoc">number of processors</div><div class="ttdef"><b>Definition:</b> communicator.h:157</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aafb4d7de0a87b4bda560928e6a128060">build_without_copy()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a21b3dbb8ee74e1247f80ce4506c395f8">column_index()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a2e4736826a65253f574d4f6f152ab514">oomph::LinearAlgebraDistribution::communicator_pt()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ad8914fa1a5a98f7602a1724b76eef26c">CRDoubleMatrix()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a5505731e7e73d7e4251c67c7adec6bf5">oomph::DistributableLinearAlgebraObject::distributed()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">oomph::DistributableLinearAlgebraObject::distribution_pt()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ab00a3919b8634c698749f14a4d92947d">oomph::DistributableLinearAlgebraObject::first_row()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a4ed5597d8a34dd14f90b0e6cfb88ca2e">ncol()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a9482dafc0a17ebc5b7431369d8d07565">nnz()</a>, <a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a6c78c72666f4b102c2bccf200f0853b7">oomph::OomphCommunicator::nproc()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#abd8d231b0549540144b4739a667b1e75">nrow()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">oomph::DistributableLinearAlgebraObject::nrow_local()</a>, <a class="el" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start()</a>, and <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab8220b7c2bb763dab32a4d0fea7da6f4">value()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../de/dc5/classoomph_1_1ILUZeroPreconditioner_3_01CRDoubleMatrix_01_4.html#a2398a8674540bfdb8d69a699085107d8">oomph::ILUZeroPreconditioner&lt; CRDoubleMatrix &gt;::setup()</a>.</p>

</div>
</div>
<a id="a6cd938ba5f026f1508239cef05b16cb4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cd938ba5f026f1508239cef05b16cb4">&#9670;&nbsp;</a></span>inf_norm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> oomph::CRDoubleMatrix::inf_norm </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>returns the inf-norm of this matrix </p>
<p>Compute infinity (maximum) norm of matrix. </p>
<div class="fragment"><div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;  {</div>
<div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;    <span class="comment">// paranoid check that the vector is setup</span></div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;    <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a8c35baa65e335043f62954c92c090a5a">distribution_built</a>())</div>
<div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;    {</div>
<div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;      std::ostringstream error_message;</div>
<div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;      error_message &lt;&lt; <span class="stringliteral">&quot;This matrix must be setup.&quot;</span>;</div>
<div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;        error_message.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;    }</div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160; </div>
<div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;    <span class="comment">// compute the local norm</span></div>
<div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">nrow_local</a> = this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">nrow_local</a>();</div>
<div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0;</div>
<div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span>* <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start</a> = <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a>.<a class="code" href="../../d4/def/classoomph_1_1CRMatrix.html#a6210ebb3d384de9c3a289f5d841a0d7a">row_start</a>();</div>
<div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span>* <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab8220b7c2bb763dab32a4d0fea7da6f4">value</a> = <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a>.<a class="code" href="../../d6/d24/classoomph_1_1SparseMatrix.html#a3e382ff145082821a6b0b3e63b6aed5d">value</a>();</div>
<div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">nrow_local</a>; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;    {</div>
<div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a3c00523890f1892f53e8246b909e04dc">a</a> = 0;</div>
<div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = row_start[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1]; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;      {</div>
<div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;        <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a3c00523890f1892f53e8246b909e04dc">a</a> += <a class="code" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">fabs</a>(<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab8220b7c2bb763dab32a4d0fea7da6f4">value</a>[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>]);</div>
<div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;      }</div>
<div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;      <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = <a class="code" href="../../dc/d51/datatypes_8h.html#affe776513b24d84b39af8ab0930fef7f">std::max</a>(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>, <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a3c00523890f1892f53e8246b909e04dc">a</a>);</div>
<div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;    }</div>
<div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160; </div>
<div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;    <span class="comment">// if this vector is distributed and on multiple processors then gather</span></div>
<div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;    <span class="keywordtype">double</span> n2 = <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>;</div>
<div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a5505731e7e73d7e4251c67c7adec6bf5">distributed</a>() &amp;&amp;</div>
<div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;        this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>()-&gt;communicator_pt()-&gt;nproc() &gt; 1)</div>
<div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;    {</div>
<div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;      MPI_Allreduce(&amp;<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>,</div>
<div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;                    &amp;n2,</div>
<div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;                    1,</div>
<div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;                    MPI_DOUBLE,</div>
<div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;                    MPI_MAX,</div>
<div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;                    this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>()-&gt;communicator_pt()-&gt;mpi_comm());</div>
<div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;    }</div>
<div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;    <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = n2;</div>
<div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160; </div>
<div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;    <span class="comment">// and return</span></div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>;</div>
<div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;  }</div>
<div class="ttc" id="aCG3DPackingUnitTest_8cpp_html_a7026fd16370249ce97cb3d062326baf9"><div class="ttname"><a href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a></div><div class="ttdeci">const unsigned n</div><div class="ttdef"><b>Definition:</b> CG3DPackingUnitTest.cpp:11</div></div>
<div class="ttc" id="aclassoomph_1_1CRMatrix_html_a6210ebb3d384de9c3a289f5d841a0d7a"><div class="ttname"><a href="../../d4/def/classoomph_1_1CRMatrix.html#a6210ebb3d384de9c3a289f5d841a0d7a">oomph::CRMatrix::row_start</a></div><div class="ttdeci">int * row_start()</div><div class="ttdoc">Access to C-style row_start array.</div><div class="ttdef"><b>Definition:</b> matrices.h:785</div></div>
<div class="ttc" id="aclassoomph_1_1DistributableLinearAlgebraObject_html_a8c35baa65e335043f62954c92c090a5a"><div class="ttname"><a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a8c35baa65e335043f62954c92c090a5a">oomph::DistributableLinearAlgebraObject::distribution_built</a></div><div class="ttdeci">bool distribution_built() const</div><div class="ttdef"><b>Definition:</b> linear_algebra_distribution.h:500</div></div>
<div class="ttc" id="aclassoomph_1_1SparseMatrix_html_a3e382ff145082821a6b0b3e63b6aed5d"><div class="ttname"><a href="../../d6/d24/classoomph_1_1SparseMatrix.html#a3e382ff145082821a6b0b3e63b6aed5d">oomph::SparseMatrix::value</a></div><div class="ttdeci">T * value()</div><div class="ttdoc">Access to C-style value array.</div><div class="ttdef"><b>Definition:</b> matrices.h:616</div></div>
<div class="ttc" id="adatatypes_8h_html_affe776513b24d84b39af8ab0930fef7f"><div class="ttname"><a href="../../dc/d51/datatypes_8h.html#affe776513b24d84b39af8ab0930fef7f">max</a></div><div class="ttdeci">#define max(a, b)</div><div class="ttdef"><b>Definition:</b> datatypes.h:23</div></div>
<div class="ttc" id="anamespaceboost_1_1multiprecision_html_ab6f80ccf8e1d88df8a8e3acd039d63eb"><div class="ttname"><a href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">boost::multiprecision::fabs</a></div><div class="ttdeci">Real fabs(const Real &amp;a)</div><div class="ttdef"><b>Definition:</b> boostmultiprec.cpp:117</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../da/dc6/level2__cplx__impl_8h.html#a3c00523890f1892f53e8246b909e04dc">a</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a5505731e7e73d7e4251c67c7adec6bf5">oomph::DistributableLinearAlgebraObject::distributed()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a8c35baa65e335043f62954c92c090a5a">oomph::DistributableLinearAlgebraObject::distribution_built()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">oomph::DistributableLinearAlgebraObject::distribution_pt()</a>, <a class="el" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">boost::multiprecision::fabs()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../dc/d51/datatypes_8h.html#affe776513b24d84b39af8ab0930fef7f">max</a>, <a class="el" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">oomph::DistributableLinearAlgebraObject::nrow_local()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../d4/def/classoomph_1_1CRMatrix.html#a6210ebb3d384de9c3a289f5d841a0d7a">oomph::CRMatrix&lt; T &gt;::row_start()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start()</a>, <a class="el" href="../../d6/d24/classoomph_1_1SparseMatrix.html#a3e382ff145082821a6b0b3e63b6aed5d">oomph::SparseMatrix&lt; T, MATRIX_TYPE &gt;::value()</a>, and <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab8220b7c2bb763dab32a4d0fea7da6f4">value()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../de/da0/classoomph_1_1PseudoElasticPreconditionerScalingHelperOld.html#a4774c6db30bd4f7d054e438add48f7eb">oomph::PseudoElasticPreconditionerScalingHelperOld::s_inf_norm()</a>.</p>

</div>
</div>
<a id="af2c0f286f77ca44453f0da684b8f9dc7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2c0f286f77ca44453f0da684b8f9dc7">&#9670;&nbsp;</a></span>lubksub()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::CRDoubleMatrix::lubksub </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;&#160;</td>
          <td class="paramname"><em>rhs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>LU back solve for given RHS. </p>
<p>Do back-substitution. </p>
<div class="fragment"><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;  {</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;    <span class="comment">// check that the rhs vector is setup</span></div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;    <span class="keywordflow">if</span> (!rhs.built())</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;    {</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;      std::ostringstream error_message_stream;</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;      error_message_stream &lt;&lt; <span class="stringliteral">&quot;The vector rhs has not been setup&quot;</span>;</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(error_message_stream.str(),</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;    }</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;    <span class="comment">// check that the rhs vector has the same distribution as this matrix</span></div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;    <span class="keywordflow">if</span> (!(*this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>() == *rhs.distribution_pt()))</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;    {</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;      std::ostringstream error_message_stream;</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;      error_message_stream</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;The vector rhs must have the same distribution as the matrix&quot;</span>;</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(error_message_stream.str(),</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;    }</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160; </div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;    <span class="comment">// backsub</span></div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;    <a class="code" href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a> rhs_copy(rhs);</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;    <span class="keyword">static_cast&lt;</span>SuperLUSolver*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a6ef2e36e4e5907af2738934f131e8dcf">Default_linear_solver_pt</a>)</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;      -&gt;backsub(rhs_copy, rhs);</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;  }</div>
<div class="ttc" id="aClumpInput_8h_html_a82f6bc76e1c7a0f51bf3e95ad5d3c590"><div class="ttname"><a href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a></div><div class="ttdeci">std::vector&lt; double &gt; DoubleVector</div><div class="ttdoc">loads clump configuration</div><div class="ttdef"><b>Definition:</b> ClumpInput.h:26</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#aae402d422ec4344a4a45cdb7659b7161">oomph::DoubleVector::built()</a>, <a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a6ef2e36e4e5907af2738934f131e8dcf">oomph::DoubleMatrixBase::Default_linear_solver_pt</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">oomph::DistributableLinearAlgebraObject::distribution_pt()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, and <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>.</p>

</div>
</div>
<a id="a4b90203edbcbfec4e5e1c79f7d8d2722"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b90203edbcbfec4e5e1c79f7d8d2722">&#9670;&nbsp;</a></span>ludecompose()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::CRDoubleMatrix::ludecompose </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Do LU decomposition. </p>
<p>LU decomposition using SuperLU if matrix is not distributed or distributed onto a single processor. </p>
<div class="fragment"><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;  {</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;    <span class="comment">// check that the this matrix is built</span></div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a63afd9976f0970a4e6ffee3755d21540">Built</a>)</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;    {</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;      std::ostringstream error_message_stream;</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;      error_message_stream &lt;&lt; <span class="stringliteral">&quot;This matrix has not been built.&quot;</span>;</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(error_message_stream.str(),</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    }</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160; </div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    <span class="comment">// factorise using superlu or superlu dist if we oomph has mpi</span></div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    <span class="keyword">static_cast&lt;</span>SuperLUSolver*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a6ef2e36e4e5907af2738934f131e8dcf">Default_linear_solver_pt</a>)-&gt;factorise(<span class="keyword">this</span>);</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a63afd9976f0970a4e6ffee3755d21540">Built</a>, <a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a6ef2e36e4e5907af2738934f131e8dcf">oomph::DoubleMatrixBase::Default_linear_solver_pt</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, and <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>.</p>

</div>
</div>
<a id="a3853068b7fce9e83bc817930262e9ca1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3853068b7fce9e83bc817930262e9ca1">&#9670;&nbsp;</a></span>matrix_reduction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::CRDoubleMatrix::matrix_reduction </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>reduced_matrix</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>For every row, find the maximum absolute value of the entries in this row. Set all values that are less than alpha times this maximum to zero and return the resulting matrix in reduced_matrix. Note: Diagonal entries are retained regardless of their size. </p>
<div class="fragment"><div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;  {</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;    <span class="comment">// number of rows in matrix</span></div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;    <span class="keywordtype">long</span> n_row = <a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">nrow_local</a>();</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;    <span class="keywordtype">double</span> max_row;</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160; </div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;    <span class="comment">// Here&#39;s the packed format for the new matrix</span></div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;    Vector&lt;int&gt; B_row_start(1);</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;    Vector&lt;int&gt; B_column_index;</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;    Vector&lt;double&gt; B_value;</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160; </div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;    <span class="comment">// get pointers to the underlying data</span></div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span>* <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start</a> = <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a>.<a class="code" href="../../d4/def/classoomph_1_1CRMatrix.html#a6210ebb3d384de9c3a289f5d841a0d7a">row_start</a>();</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span>* <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a21b3dbb8ee74e1247f80ce4506c395f8">column_index</a> = <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a>.<a class="code" href="../../d4/def/classoomph_1_1CRMatrix.html#aa6057d1c2a9a491f643e0633c778f8fb">column_index</a>();</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span>* <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab8220b7c2bb763dab32a4d0fea7da6f4">value</a> = <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a>.<a class="code" href="../../d6/d24/classoomph_1_1SparseMatrix.html#a3e382ff145082821a6b0b3e63b6aed5d">value</a>();</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160; </div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;    <span class="comment">// k is counter for the number of entries in the reduced matrix</span></div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> = 0;</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160; </div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;    <span class="comment">// Initialise row start</span></div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;    B_row_start[0] = 0;</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160; </div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;    <span class="comment">// Loop over rows</span></div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">long</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_row; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;    {</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;      <span class="comment">// Initialise max value in row</span></div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;      max_row = 0.0;</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160; </div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;      <span class="comment">// Loop over entries in columns</span></div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">long</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1]; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;      {</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;        <span class="comment">// Find max. value in row</span></div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">std::fabs</a>(<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab8220b7c2bb763dab32a4d0fea7da6f4">value</a>[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>]) &gt; max_row)</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;        {</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;          max_row = <a class="code" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">std::fabs</a>(<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab8220b7c2bb763dab32a4d0fea7da6f4">value</a>[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>]);</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;        }</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;      }</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160; </div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;      <span class="comment">// Decide if we need to retain the entries in the row</span></div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">long</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1]; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;      {</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;        <span class="comment">// If we&#39;re on the diagonal or the value is sufficiently large: retain</span></div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;        <span class="comment">// i.e. copy across.</span></div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> == <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a21b3dbb8ee74e1247f80ce4506c395f8">column_index</a>[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>] || <a class="code" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">std::fabs</a>(<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab8220b7c2bb763dab32a4d0fea7da6f4">value</a>[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>]) &gt; <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#aab71aae952f5851155b312eeb00ec7c2">alpha</a> * max_row)</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;        {</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;          B_value.push_back(<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab8220b7c2bb763dab32a4d0fea7da6f4">value</a>[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>]);</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;          B_column_index.push_back(<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a21b3dbb8ee74e1247f80ce4506c395f8">column_index</a>[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>]);</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;          <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>++;</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;        }</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;      }</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;      <span class="comment">// This writes the row start for the next row -- equal to</span></div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;      <span class="comment">// to the number of entries written so far (C++ zero-based indexing!)</span></div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;      B_row_start.push_back(<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>);</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;    }</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160; </div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;    <span class="comment">// Build the matrix from the compressed format</span></div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;    <span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ad8914fa1a5a98f7602a1724b76eef26c">CRDoubleMatrix</a>&amp;<span class="keyword">&gt;</span>(reduced_matrix)</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;      .<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#af44bac2acd071317f96dae49cbb0d977">build</a>(this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a4ed5597d8a34dd14f90b0e6cfb88ca2e">ncol</a>(), B_value, B_column_index, B_row_start);</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;  }</div>
<div class="ttc" id="alevel1__cplx__impl_8h_html_aab71aae952f5851155b312eeb00ec7c2"><div class="ttname"><a href="../../d2/d2e/level1__cplx__impl_8h.html#aab71aae952f5851155b312eeb00ec7c2">alpha</a></div><div class="ttdeci">RealScalar alpha</div><div class="ttdef"><b>Definition:</b> level1_cplx_impl.h:151</div></div>
<div class="ttc" id="alevel2__impl_8h_html_ad46ea6bf5745e72b985b11878e46a45d"><div class="ttname"><a href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a></div><div class="ttdeci">char char char int int * k</div><div class="ttdef"><b>Definition:</b> level2_impl.h:374</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/d2e/level1__cplx__impl_8h.html#aab71aae952f5851155b312eeb00ec7c2">alpha</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#af44bac2acd071317f96dae49cbb0d977">build()</a>, <a class="el" href="../../d4/def/classoomph_1_1CRMatrix.html#aa6057d1c2a9a491f643e0633c778f8fb">oomph::CRMatrix&lt; T &gt;::column_index()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a21b3dbb8ee74e1247f80ce4506c395f8">column_index()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a>, <a class="el" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">boost::multiprecision::fabs()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a4ed5597d8a34dd14f90b0e6cfb88ca2e">ncol()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">oomph::DistributableLinearAlgebraObject::nrow_local()</a>, <a class="el" href="../../d4/def/classoomph_1_1CRMatrix.html#a6210ebb3d384de9c3a289f5d841a0d7a">oomph::CRMatrix&lt; T &gt;::row_start()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start()</a>, <a class="el" href="../../d6/d24/classoomph_1_1SparseMatrix.html#a3e382ff145082821a6b0b3e63b6aed5d">oomph::SparseMatrix&lt; T, MATRIX_TYPE &gt;::value()</a>, and <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab8220b7c2bb763dab32a4d0fea7da6f4">value()</a>.</p>

</div>
</div>
<a id="af08fd73a7edbdbde9facf47b913e3e43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af08fd73a7edbdbde9facf47b913e3e43">&#9670;&nbsp;</a></span>multiply() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::CRDoubleMatrix::multiply </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>matrix_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function to multiply this matrix by the CRDoubleMatrix matrix_in. In a serial matrix, there are 4 methods available: Method 1: First runs through this matrix and matrix_in to find the storage requirements for result - arrays of the correct size are then allocated before performing the calculation. Minimises memory requirements but more costly. Method 2: Grows storage for values and column indices of result 'on the fly' using an array of maps. Faster but more memory intensive. Method 3: Grows storage for values and column indices of result 'on the fly' using a vector of vectors. Not particularly impressive on the platforms we tried... Method 4: Trilinos Epetra Matrix Matrix multiply. Method 5: Trilinox Epetra Matrix Matrix Mulitply (ml based) If Trilinos is installed then Method 4 is employed by default, otherwise Method 2 is employed by default. In a distributed matrix, only Trilinos Epetra Matrix Matrix multiply is available. </p>
<div class="fragment"><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;  {</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;    <span class="comment">// check that this matrix is built</span></div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a63afd9976f0970a4e6ffee3755d21540">Built</a>)</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;    {</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;      std::ostringstream error_message_stream;</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;      error_message_stream &lt;&lt; <span class="stringliteral">&quot;This matrix has not been built&quot;</span>;</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(error_message_stream.str(),</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;    }</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;    <span class="comment">// check that this matrix is built</span></div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;    <span class="keywordflow">if</span> (!matrix_in.built())</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;    {</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;      std::ostringstream error_message_stream;</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;      error_message_stream &lt;&lt; <span class="stringliteral">&quot;This matrix matrix_in has not been built&quot;</span>;</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(error_message_stream.str(),</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;    }</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;    <span class="comment">// if soln is setup then it should have the same distribution as x</span></div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;    <span class="keywordflow">if</span> (result.built())</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;    {</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;      <span class="keywordflow">if</span> (!(*result.distribution_pt() == *this-&gt;distribution_pt()))</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;      {</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;        std::ostringstream error_message_stream;</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;        error_message_stream</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;The matrix result is setup and therefore must have the same &quot;</span></div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;distribution as the vector x&quot;</span>;</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(error_message_stream.str(),</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;      }</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;    }</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160; </div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;    <span class="comment">// if the result has not been setup, then store the distribution</span></div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;    <span class="keywordflow">if</span> (!result.distribution_built())</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;    {</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;      result.build(this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>());</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;    }</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160; </div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;    <span class="comment">// short name for Serial_matrix_matrix_multiply_method</span></div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;    <span class="keywordtype">unsigned</span> method = <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ac8fab9824a0766b6bb6361a6b25df9ce">Serial_matrix_matrix_multiply_method</a>;</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160; </div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;    <span class="comment">// if this matrix is not distributed and matrix in is not distributed</span></div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;    <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a5505731e7e73d7e4251c67c7adec6bf5">distributed</a>() &amp;&amp; !matrix_in.distributed() &amp;&amp;</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;        ((method == 1) || (method == 2) || (method == 3)))</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;    {</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;      <span class="comment">// NB N is number of rows!</span></div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a> = this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#abd8d231b0549540144b4739a667b1e75">nrow</a>();</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../dc/d34/classEigen_1_1Matrix.html">M</a> = matrix_in.ncol();</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> Nnz = 0;</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160; </div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;      <span class="comment">// pointers to arrays which store result</span></div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;      <span class="keywordtype">int</span>* Row_start = 0;</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;      <span class="keywordtype">double</span>* <a class="code" href="../../d1/dc3/namespacerapidjson.html#afb3fa116c66d834b6f4289d648cc8d6d">Value</a> = 0;</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;      <span class="keywordtype">int</span>* Column_index = 0;</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160; </div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;      <span class="comment">// get pointers to matrix_in</span></div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span>* matrix_in_row_start = matrix_in.row_start();</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span>* matrix_in_column_index = matrix_in.column_index();</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span>* matrix_in_value = matrix_in.value();</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160; </div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;      <span class="comment">// get pointers to this matrix</span></div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span>* this_value = this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab8220b7c2bb763dab32a4d0fea7da6f4">value</a>();</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span>* this_row_start = this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start</a>();</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span>* this_column_index = this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a21b3dbb8ee74e1247f80ce4506c395f8">column_index</a>();</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160; </div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;      <span class="comment">// clock_t clock1 = clock();</span></div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160; </div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;      <span class="comment">// METHOD 1</span></div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;      <span class="comment">// --------</span></div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;      <span class="keywordflow">if</span> (method == 1)</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;      {</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;        <span class="comment">// allocate storage for row starts</span></div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;        Row_start = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a> + 1];</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;        Row_start[0] = 0;</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160; </div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;        <span class="comment">// a set to store number of non-zero columns in each row of result</span></div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;        std::set&lt;unsigned&gt; columns;</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160; </div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;        <span class="comment">// run through rows of this matrix and matrix_in to find number of</span></div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;        <span class="comment">// non-zero entries in each row of result</span></div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> this_row = 0; this_row &lt; <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>; this_row++)</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;        {</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;          <span class="comment">// run through non-zeros in this_row of this matrix</span></div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> this_ptr = this_row_start[this_row];</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;               this_ptr &lt; this_row_start[this_row + 1];</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;               this_ptr++)</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;          {</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;            <span class="comment">// find column index for non-zero</span></div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;            <span class="keywordtype">int</span> matrix_in_row = this_column_index[this_ptr];</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160; </div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;            <span class="comment">// run through corresponding row in matrix_in</span></div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> matrix_in_ptr = matrix_in_row_start[matrix_in_row];</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;                 matrix_in_ptr &lt; matrix_in_row_start[matrix_in_row + 1];</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;                 matrix_in_ptr++)</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;            {</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;              <span class="comment">// find column index for non-zero in matrix_in and store in</span></div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;              <span class="comment">// columns</span></div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;              columns.insert(matrix_in_column_index[matrix_in_ptr]);</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;            }</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;          }</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;          <span class="comment">// update Row_start</span></div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;          Row_start[this_row + 1] = Row_start[this_row] + columns.size();</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160; </div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;          <span class="comment">// wipe values in columns</span></div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;          columns.clear();</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;        }</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160; </div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;        <span class="comment">// set Nnz</span></div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;        Nnz = Row_start[<a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>];</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160; </div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;        <span class="comment">// allocate arrays for result</span></div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;        <a class="code" href="../../d1/dc3/namespacerapidjson.html#afb3fa116c66d834b6f4289d648cc8d6d">Value</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[Nnz];</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;        Column_index = <span class="keyword">new</span> <span class="keywordtype">int</span>[Nnz];</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160; </div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;        <span class="comment">// set all values of Column_index to -1</span></div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; Nnz; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;        {</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;          Column_index[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = -1;</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;        }</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160; </div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;        <span class="comment">// Calculate values for result - first run through rows of this matrix</span></div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> this_row = 0; this_row &lt; <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>; this_row++)</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;        {</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;          <span class="comment">// run through non-zeros in this_row</span></div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> this_ptr = this_row_start[this_row];</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;               this_ptr &lt; this_row_start[this_row + 1];</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;               this_ptr++)</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;          {</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;            <span class="comment">// find value of non-zero</span></div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;            <span class="keywordtype">double</span> this_val = this_value[this_ptr];</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160; </div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;            <span class="comment">// find column associated with non-zero</span></div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;            <span class="keywordtype">int</span> matrix_in_row = this_column_index[this_ptr];</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160; </div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;            <span class="comment">// run through corresponding row in matrix_in</span></div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> matrix_in_ptr = matrix_in_row_start[matrix_in_row];</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;                 matrix_in_ptr &lt; matrix_in_row_start[matrix_in_row + 1];</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;                 matrix_in_ptr++)</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;            {</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;              <span class="comment">// find column index for non-zero in matrix_in</span></div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;              <span class="keywordtype">int</span> <a class="code" href="../../df/de7/MatrixBase__col_8cpp.html#aa168d9544aa6d49fce0cbfc0bec849b0">col</a> = matrix_in_column_index[matrix_in_ptr];</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160; </div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;              <span class="comment">// find position in result to insert value</span></div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ptr = Row_start[this_row];</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;                   ptr &lt;= Row_start[this_row + 1];</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;                   ptr++)</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;              {</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;                <span class="keywordflow">if</span> (ptr == Row_start[this_row + 1])</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;                {</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;                  <span class="comment">// error - have passed end of row without finding</span></div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;                  <span class="comment">// correct column</span></div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;                  std::ostringstream error_message;</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;                  error_message &lt;&lt; <span class="stringliteral">&quot;Error inserting value in result&quot;</span>;</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160; </div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;                  <span class="keywordflow">throw</span> OomphLibError(error_message.str(),</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;                                      <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;                                      <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;                }</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Column_index[ptr] == -1)</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;                {</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;                  <span class="comment">// first entry for this column index</span></div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;                  Column_index[ptr] = <a class="code" href="../../df/de7/MatrixBase__col_8cpp.html#aa168d9544aa6d49fce0cbfc0bec849b0">col</a>;</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;                  <a class="code" href="../../d1/dc3/namespacerapidjson.html#afb3fa116c66d834b6f4289d648cc8d6d">Value</a>[ptr] = this_val * matrix_in_value[matrix_in_ptr];</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;                  <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;                }</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Column_index[ptr] == <a class="code" href="../../df/de7/MatrixBase__col_8cpp.html#aa168d9544aa6d49fce0cbfc0bec849b0">col</a>)</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;                {</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;                  <span class="comment">// column index already exists - add value</span></div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;                  <a class="code" href="../../d1/dc3/namespacerapidjson.html#afb3fa116c66d834b6f4289d648cc8d6d">Value</a>[ptr] += this_val * matrix_in_value[matrix_in_ptr];</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;                  <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;                }</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;              }</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;            }</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;          }</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;        }</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;      }</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160; </div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;      <span class="comment">// METHOD 2</span></div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;      <span class="comment">// --------</span></div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (method == 2)</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;      {</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;        <span class="comment">// generate array of maps to store values for result</span></div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;        std::map&lt;int, double&gt;* result_maps = <span class="keyword">new</span> std::map&lt;int, double&gt;[<a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>];</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160; </div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;        <span class="comment">// run through rows of this matrix</span></div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> this_row = 0; this_row &lt; <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>; this_row++)</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;        {</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;          <span class="comment">// run through non-zeros in this_row</span></div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> this_ptr = this_row_start[this_row];</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;               this_ptr &lt; this_row_start[this_row + 1];</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;               this_ptr++)</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;          {</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;            <span class="comment">// find value of non-zero</span></div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;            <span class="keywordtype">double</span> this_val = this_value[this_ptr];</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160; </div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;            <span class="comment">// find column index associated with non-zero</span></div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;            <span class="keywordtype">int</span> matrix_in_row = this_column_index[this_ptr];</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160; </div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;            <span class="comment">// run through corresponding row in matrix_in</span></div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> matrix_in_ptr = matrix_in_row_start[matrix_in_row];</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;                 matrix_in_ptr &lt; matrix_in_row_start[matrix_in_row + 1];</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;                 matrix_in_ptr++)</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;            {</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;              <span class="comment">// find column index for non-zero in matrix_in</span></div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;              <span class="keywordtype">int</span> <a class="code" href="../../df/de7/MatrixBase__col_8cpp.html#aa168d9544aa6d49fce0cbfc0bec849b0">col</a> = matrix_in_column_index[matrix_in_ptr];</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160; </div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;              <span class="comment">// insert value</span></div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;              result_maps[this_row][<a class="code" href="../../df/de7/MatrixBase__col_8cpp.html#aa168d9544aa6d49fce0cbfc0bec849b0">col</a>] +=</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;                this_val * matrix_in_value[matrix_in_ptr];</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;            }</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;          }</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;        }</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160; </div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;        <span class="comment">// allocate Row_start</span></div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;        Row_start = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a> + 1];</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160; </div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;        <span class="comment">// copy across row starts</span></div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;        Row_start[0] = 0;</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../df/ddc/MatrixBase__row_8cpp.html#a64ef8efef59f875033a27e7cbbc879ec">row</a> = 0; <a class="code" href="../../df/ddc/MatrixBase__row_8cpp.html#a64ef8efef59f875033a27e7cbbc879ec">row</a> &lt; <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>; <a class="code" href="../../df/ddc/MatrixBase__row_8cpp.html#a64ef8efef59f875033a27e7cbbc879ec">row</a>++)</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;        {</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;          <span class="keywordtype">int</span> <a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a> = result_maps[<a class="code" href="../../df/ddc/MatrixBase__row_8cpp.html#a64ef8efef59f875033a27e7cbbc879ec">row</a>].size();</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;          Row_start[<a class="code" href="../../df/ddc/MatrixBase__row_8cpp.html#a64ef8efef59f875033a27e7cbbc879ec">row</a> + 1] = Row_start[<a class="code" href="../../df/ddc/MatrixBase__row_8cpp.html#a64ef8efef59f875033a27e7cbbc879ec">row</a>] + <a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>;</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;        }</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160; </div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;        <span class="comment">// set Nnz</span></div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;        Nnz = Row_start[<a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>];</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160; </div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;        <span class="comment">// allocate other arrays</span></div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;        <a class="code" href="../../d1/dc3/namespacerapidjson.html#afb3fa116c66d834b6f4289d648cc8d6d">Value</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[Nnz];</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;        Column_index = <span class="keyword">new</span> <span class="keywordtype">int</span>[Nnz];</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160; </div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;        <span class="comment">// copy values and column indices</span></div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../df/ddc/MatrixBase__row_8cpp.html#a64ef8efef59f875033a27e7cbbc879ec">row</a> = 0; <a class="code" href="../../df/ddc/MatrixBase__row_8cpp.html#a64ef8efef59f875033a27e7cbbc879ec">row</a> &lt; <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>; <a class="code" href="../../df/ddc/MatrixBase__row_8cpp.html#a64ef8efef59f875033a27e7cbbc879ec">row</a>++)</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;        {</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;          <span class="keywordtype">unsigned</span> ptr = Row_start[<a class="code" href="../../df/ddc/MatrixBase__row_8cpp.html#a64ef8efef59f875033a27e7cbbc879ec">row</a>];</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;          <span class="keywordflow">for</span> (std::map&lt;int, double&gt;::iterator <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = result_maps[<a class="code" href="../../df/ddc/MatrixBase__row_8cpp.html#a64ef8efef59f875033a27e7cbbc879ec">row</a>].begin();</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;               <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> != result_maps[<a class="code" href="../../df/ddc/MatrixBase__row_8cpp.html#a64ef8efef59f875033a27e7cbbc879ec">row</a>].end();</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;               <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;          {</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;            Column_index[ptr] = <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>-&gt;first;</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;            <a class="code" href="../../d1/dc3/namespacerapidjson.html#afb3fa116c66d834b6f4289d648cc8d6d">Value</a>[ptr] = <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>-&gt;second;</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;            ptr++;</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;          }</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;        }</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160; </div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;        <span class="comment">// tidy up memory</span></div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;        <span class="keyword">delete</span>[] result_maps;</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;      }</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160; </div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;      <span class="comment">// METHOD 3</span></div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;      <span class="comment">// --------</span></div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (method == 3)</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;      {</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;        <span class="comment">// vectors of vectors to store results</span></div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;        std::vector&lt;std::vector&lt;int&gt;&gt; result_cols(<a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>);</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;        std::vector&lt;std::vector&lt;double&gt;&gt; result_vals(<a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>);</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160; </div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;        <span class="comment">// run through the rows of this matrix</span></div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> this_row = 0; this_row &lt; <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>; this_row++)</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;        {</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;          <span class="comment">// run through non-zeros in this_row</span></div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> this_ptr = this_row_start[this_row];</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;               this_ptr &lt; this_row_start[this_row + 1];</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;               this_ptr++)</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;          {</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;            <span class="comment">// find value of non-zero</span></div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;            <span class="keywordtype">double</span> this_val = this_value[this_ptr];</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160; </div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;            <span class="comment">// find column index associated with non-zero</span></div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;            <span class="keywordtype">int</span> matrix_in_row = this_column_index[this_ptr];</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160; </div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;            <span class="comment">// run through corresponding row in matrix_in</span></div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> matrix_in_ptr = matrix_in_row_start[matrix_in_row];</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;                 matrix_in_ptr &lt; matrix_in_row_start[matrix_in_row + 1];</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;                 matrix_in_ptr++)</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;            {</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;              <span class="comment">// find column index for non-zero in matrix_in</span></div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;              <span class="keywordtype">int</span> <a class="code" href="../../df/de7/MatrixBase__col_8cpp.html#aa168d9544aa6d49fce0cbfc0bec849b0">col</a> = matrix_in_column_index[matrix_in_ptr];</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160; </div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;              <span class="comment">// insert value</span></div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;              <span class="keywordtype">int</span> <a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a> = result_cols[this_row].size();</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;= <a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;              {</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> == <a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>)</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;                {</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;                  <span class="comment">// first entry for this column</span></div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;                  result_cols[this_row].push_back(<a class="code" href="../../df/de7/MatrixBase__col_8cpp.html#aa168d9544aa6d49fce0cbfc0bec849b0">col</a>);</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;                  result_vals[this_row].push_back(</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;                    this_val * matrix_in_value[matrix_in_ptr]);</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;                }</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../df/de7/MatrixBase__col_8cpp.html#aa168d9544aa6d49fce0cbfc0bec849b0">col</a> == result_cols[this_row][<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;                {</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;                  <span class="comment">// column already exists</span></div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;                  result_vals[this_row][<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] +=</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;                    this_val * matrix_in_value[matrix_in_ptr];</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;                  <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;                }</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;              }</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;            }</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;          }</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;        }</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160; </div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;        <span class="comment">// allocate Row_start</span></div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;        Row_start = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a> + 1];</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160; </div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;        <span class="comment">// copy across row starts</span></div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;        Row_start[0] = 0;</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../df/ddc/MatrixBase__row_8cpp.html#a64ef8efef59f875033a27e7cbbc879ec">row</a> = 0; <a class="code" href="../../df/ddc/MatrixBase__row_8cpp.html#a64ef8efef59f875033a27e7cbbc879ec">row</a> &lt; <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>; <a class="code" href="../../df/ddc/MatrixBase__row_8cpp.html#a64ef8efef59f875033a27e7cbbc879ec">row</a>++)</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;        {</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;          <span class="keywordtype">int</span> <a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a> = result_cols[<a class="code" href="../../df/ddc/MatrixBase__row_8cpp.html#a64ef8efef59f875033a27e7cbbc879ec">row</a>].size();</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;          Row_start[<a class="code" href="../../df/ddc/MatrixBase__row_8cpp.html#a64ef8efef59f875033a27e7cbbc879ec">row</a> + 1] = Row_start[<a class="code" href="../../df/ddc/MatrixBase__row_8cpp.html#a64ef8efef59f875033a27e7cbbc879ec">row</a>] + <a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>;</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;        }</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160; </div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;        <span class="comment">// set Nnz</span></div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;        Nnz = Row_start[<a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>];</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160; </div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;        <span class="comment">// allocate other arrays</span></div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;        <a class="code" href="../../d1/dc3/namespacerapidjson.html#afb3fa116c66d834b6f4289d648cc8d6d">Value</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[Nnz];</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;        Column_index = <span class="keyword">new</span> <span class="keywordtype">int</span>[Nnz];</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160; </div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;        <span class="comment">// copy across values and column indices</span></div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../df/ddc/MatrixBase__row_8cpp.html#a64ef8efef59f875033a27e7cbbc879ec">row</a> = 0; <a class="code" href="../../df/ddc/MatrixBase__row_8cpp.html#a64ef8efef59f875033a27e7cbbc879ec">row</a> &lt; <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>; <a class="code" href="../../df/ddc/MatrixBase__row_8cpp.html#a64ef8efef59f875033a27e7cbbc879ec">row</a>++)</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;        {</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;          <span class="keywordtype">unsigned</span> ptr = Row_start[<a class="code" href="../../df/ddc/MatrixBase__row_8cpp.html#a64ef8efef59f875033a27e7cbbc879ec">row</a>];</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;          <span class="keywordtype">unsigned</span> nnn = result_cols[<a class="code" href="../../df/ddc/MatrixBase__row_8cpp.html#a64ef8efef59f875033a27e7cbbc879ec">row</a>].size();</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; nnn; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;          {</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;            Column_index[ptr] = result_cols[<a class="code" href="../../df/ddc/MatrixBase__row_8cpp.html#a64ef8efef59f875033a27e7cbbc879ec">row</a>][<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;            <a class="code" href="../../d1/dc3/namespacerapidjson.html#afb3fa116c66d834b6f4289d648cc8d6d">Value</a>[ptr] = result_vals[<a class="code" href="../../df/ddc/MatrixBase__row_8cpp.html#a64ef8efef59f875033a27e7cbbc879ec">row</a>][<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;            ptr++;</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;          }</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;        }</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;      }</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160; </div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;      <span class="comment">// build</span></div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;      result.build_without_copy(<a class="code" href="../../dc/d34/classEigen_1_1Matrix.html">M</a>, Nnz, <a class="code" href="../../d1/dc3/namespacerapidjson.html#afb3fa116c66d834b6f4289d648cc8d6d">Value</a>, Column_index, Row_start);</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;    }</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160; </div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;    <span class="comment">// else we have to use trilinos</span></div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;    {</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_TRILINOS</span></div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;      <span class="keywordtype">bool</span> use_ml = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;      <span class="keywordflow">if</span> (method == 5)</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;      {</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;        use_ml = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;      }</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;      <a class="code" href="../../d1/d35/namespaceoomph_1_1TrilinosEpetraHelpers.html#a595c337ff02ad53b3dcac04ed142f8db">TrilinosEpetraHelpers::multiply</a>(*<span class="keyword">this</span>, matrix_in, result, use_ml);</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;      std::ostringstream error_message;</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;      error_message &lt;&lt; <span class="stringliteral">&quot;Serial_matrix_matrix_multiply_method = &quot;</span></div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;                    &lt;&lt; <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ac8fab9824a0766b6bb6361a6b25df9ce">Serial_matrix_matrix_multiply_method</a></div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot; requires trilinos.&quot;</span>;</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;        error_message.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;    }</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;  }</div>
<div class="ttc" id="aMatrixBase__col_8cpp_html_aa168d9544aa6d49fce0cbfc0bec849b0"><div class="ttname"><a href="../../df/de7/MatrixBase__col_8cpp.html#aa168d9544aa6d49fce0cbfc0bec849b0">col</a></div><div class="ttdeci">m col(1)</div></div>
<div class="ttc" id="aMatrixBase__row_8cpp_html_a64ef8efef59f875033a27e7cbbc879ec"><div class="ttname"><a href="../../df/ddc/MatrixBase__row_8cpp.html#a64ef8efef59f875033a27e7cbbc879ec">row</a></div><div class="ttdeci">m row(1)</div></div>
<div class="ttc" id="abenchVecAdd_8cpp_html_a439227feff9d7f55384e8780cfc2eb82"><div class="ttname"><a href="../../db/ddc/benchVecAdd_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a></div><div class="ttdeci">Scalar Scalar int size</div><div class="ttdef"><b>Definition:</b> benchVecAdd.cpp:17</div></div>
<div class="ttc" id="aclassEigen_1_1Matrix_html"><div class="ttname"><a href="../../dc/d34/classEigen_1_1Matrix.html">Eigen::Matrix</a></div><div class="ttdoc">The matrix class, also used for vectors and row-vectors.</div><div class="ttdef"><b>Definition:</b> Eigen/Eigen/src/Core/Matrix.h:186</div></div>
<div class="ttc" id="aconstructor_8cpp_html_a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702"><div class="ttname"><a href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a></div><div class="ttdeci">@ N</div><div class="ttdef"><b>Definition:</b> constructor.cpp:22</div></div>
<div class="ttc" id="anamespaceoomph_1_1TrilinosEpetraHelpers_html_a595c337ff02ad53b3dcac04ed142f8db"><div class="ttname"><a href="../../d1/d35/namespaceoomph_1_1TrilinosEpetraHelpers.html#a595c337ff02ad53b3dcac04ed142f8db">oomph::TrilinosEpetraHelpers::multiply</a></div><div class="ttdeci">void multiply(const CRDoubleMatrix *matrix, const DoubleVector &amp;x, DoubleVector &amp;soln)</div><div class="ttdef"><b>Definition:</b> trilinos_helpers.cc:657</div></div>
<div class="ttc" id="anamespacerapidjson_html_afb3fa116c66d834b6f4289d648cc8d6d"><div class="ttname"><a href="../../d1/dc3/namespacerapidjson.html#afb3fa116c66d834b6f4289d648cc8d6d">rapidjson::Value</a></div><div class="ttdeci">GenericValue&lt; UTF8&lt;&gt; &gt; Value</div><div class="ttdoc">Value with UTF8 encoding.</div><div class="ttdef"><b>Definition:</b> document.h:679</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#af44bac2acd071317f96dae49cbb0d977">build()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aafb4d7de0a87b4bda560928e6a128060">build_without_copy()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aa0503bc64ef0ccb60cb7d7e645425a62">built()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a63afd9976f0970a4e6ffee3755d21540">Built</a>, <a class="el" href="../../df/de7/MatrixBase__col_8cpp.html#aa168d9544aa6d49fce0cbfc0bec849b0">col()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a21b3dbb8ee74e1247f80ce4506c395f8">column_index()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a5505731e7e73d7e4251c67c7adec6bf5">oomph::DistributableLinearAlgebraObject::distributed()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a8c35baa65e335043f62954c92c090a5a">oomph::DistributableLinearAlgebraObject::distribution_built()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">oomph::DistributableLinearAlgebraObject::distribution_pt()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../d1/d35/namespaceoomph_1_1TrilinosEpetraHelpers.html#a595c337ff02ad53b3dcac04ed142f8db">oomph::TrilinosEpetraHelpers::multiply()</a>, <a class="el" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a4ed5597d8a34dd14f90b0e6cfb88ca2e">ncol()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#abd8d231b0549540144b4739a667b1e75">nrow()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../df/ddc/MatrixBase__row_8cpp.html#a64ef8efef59f875033a27e7cbbc879ec">row()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ac8fab9824a0766b6bb6361a6b25df9ce">Serial_matrix_matrix_multiply_method</a>, <a class="el" href="../../db/ddc/benchVecAdd_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>, and <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab8220b7c2bb763dab32a4d0fea7da6f4">value()</a>.</p>

</div>
</div>
<a id="a54b75960df52e3aebd21aaab20e9869d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54b75960df52e3aebd21aaab20e9869d">&#9670;&nbsp;</a></span>multiply() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::CRDoubleMatrix::multiply </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;&#160;</td>
          <td class="paramname"><em>soln</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Multiply the matrix by the vector x: soln=Ax. </p>
<p>Multiply the matrix by the vector x. </p>

<p>Implements <a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a78204eab557e0dc99618e41a28a5c092">oomph::DoubleMatrixBase</a>.</p>
<div class="fragment"><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;  {</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;    <span class="comment">// check that this matrix is built</span></div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a63afd9976f0970a4e6ffee3755d21540">Built</a>)</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;    {</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;      std::ostringstream error_message_stream;</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;      error_message_stream &lt;&lt; <span class="stringliteral">&quot;This matrix has not been built&quot;</span>;</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(error_message_stream.str(),</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;    }</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;    <span class="comment">// check that the distribution of x is setup</span></div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>.built())</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;    {</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;      std::ostringstream error_message_stream;</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;      error_message_stream &lt;&lt; <span class="stringliteral">&quot;The distribution of the vector x must be setup&quot;</span>;</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(error_message_stream.str(),</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;    }</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;    <span class="comment">// Check to see if x.size() = ncol().</span></div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a4ed5597d8a34dd14f90b0e6cfb88ca2e">ncol</a>() != <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>.distribution_pt()-&gt;nrow())</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;    {</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;      std::ostringstream error_message_stream;</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;      error_message_stream &lt;&lt; <span class="stringliteral">&quot;The number of rows in the x vector and the &quot;</span></div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;                              <span class="stringliteral">&quot;number of columns in the &quot;</span></div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;                           &lt;&lt; <span class="stringliteral">&quot;matrix must be the same&quot;</span>;</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(error_message_stream.str(),</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;    }</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;    <span class="comment">// if the soln is distributed</span></div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;    <span class="keywordflow">if</span> (soln.built())</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;    {</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;      <span class="keywordflow">if</span> (!(*soln.distribution_pt() == *this-&gt;distribution_pt()))</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;      {</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;        std::ostringstream error_message_stream;</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;        error_message_stream</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;The soln vector is setup and therefore must have the same &quot;</span></div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;distribution as the matrix&quot;</span>;</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(error_message_stream.str(),</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;      }</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;    }</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160; </div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;    <span class="comment">// if soln is not setup then setup the distribution</span></div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;    <span class="keywordflow">if</span> (!soln.built())</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;    {</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;      <span class="comment">// Resize and initialize the solution vector</span></div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;      soln.build(this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>(), 0.0);</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;    }</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160; </div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;    <span class="comment">// Initialise</span></div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;    soln.initialise(0.0);</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160; </div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;    <span class="comment">// if distributed and on more than one processor use trilinos</span></div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;    <span class="comment">// otherwise use the oomph-lib methods</span></div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a5505731e7e73d7e4251c67c7adec6bf5">distributed</a>() &amp;&amp;</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;        this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>()-&gt;communicator_pt()-&gt;nproc() &gt; 1)</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;    {</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_TRILINOS</span></div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;      <span class="comment">// This will only work if we have trilinos on board</span></div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;      <a class="code" href="../../d1/d35/namespaceoomph_1_1TrilinosEpetraHelpers.html#a595c337ff02ad53b3dcac04ed142f8db">TrilinosEpetraHelpers::multiply</a>(<span class="keyword">this</span>, <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>, soln);</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;      std::ostringstream error_message_stream;</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;      error_message_stream</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;Matrix-vector product on multiple processors with distributed &quot;</span></div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;CRDoubleMatrix requires Trilinos.&quot;</span>;</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(error_message_stream.str(),</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;    }</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;    {</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;      <span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#abd8d231b0549540144b4739a667b1e75">nrow</a>();</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span>* <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start</a> = <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a>.<a class="code" href="../../d4/def/classoomph_1_1CRMatrix.html#a6210ebb3d384de9c3a289f5d841a0d7a">row_start</a>();</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span>* <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a21b3dbb8ee74e1247f80ce4506c395f8">column_index</a> = <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a>.<a class="code" href="../../d4/def/classoomph_1_1CRMatrix.html#aa6057d1c2a9a491f643e0633c778f8fb">column_index</a>();</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span>* <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab8220b7c2bb763dab32a4d0fea7da6f4">value</a> = <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a>.<a class="code" href="../../d6/d24/classoomph_1_1SparseMatrix.html#a3e382ff145082821a6b0b3e63b6aed5d">value</a>();</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;      <span class="keywordtype">double</span>* soln_pt = soln.values_pt();</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span>* x_pt = <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>.values_pt();</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;      {</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;        soln_pt[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = 0.0;</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">long</span> <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> = <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]; <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> &lt; <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1]; <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>++)</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;        {</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a21b3dbb8ee74e1247f80ce4506c395f8">column_index</a>[<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>];</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;          <span class="keywordtype">double</span> a_ij = <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab8220b7c2bb763dab32a4d0fea7da6f4">value</a>[<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>];</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;          soln_pt[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] += a_ij * x_pt[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>];</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;        }</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;      }</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;    }</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;  }</div>
<div class="ttc" id="anamespaceplotDoE_html_a4758fc6194247f040938f29c863d21ee"><div class="ttname"><a href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">plotDoE.x</a></div><div class="ttdeci">list x</div><div class="ttdef"><b>Definition:</b> plotDoE.py:28</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#a7bcc94c157d6853a0f0502e8a76ed380">oomph::DoubleVector::build()</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#aae402d422ec4344a4a45cdb7659b7161">oomph::DoubleVector::built()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a63afd9976f0970a4e6ffee3755d21540">Built</a>, <a class="el" href="../../d4/def/classoomph_1_1CRMatrix.html#aa6057d1c2a9a491f643e0633c778f8fb">oomph::CRMatrix&lt; T &gt;::column_index()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a21b3dbb8ee74e1247f80ce4506c395f8">column_index()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a5505731e7e73d7e4251c67c7adec6bf5">oomph::DistributableLinearAlgebraObject::distributed()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">oomph::DistributableLinearAlgebraObject::distribution_pt()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#a180c1057a29f4ed721da46040a619ecd">oomph::DoubleVector::initialise()</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>, <a class="el" href="../../d1/d35/namespaceoomph_1_1TrilinosEpetraHelpers.html#a595c337ff02ad53b3dcac04ed142f8db">oomph::TrilinosEpetraHelpers::multiply()</a>, <a class="el" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a4ed5597d8a34dd14f90b0e6cfb88ca2e">ncol()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#aafad0b69de2284808366b65bd63e493b">oomph::LinearAlgebraDistribution::nrow()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#abd8d231b0549540144b4739a667b1e75">nrow()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../d4/def/classoomph_1_1CRMatrix.html#a6210ebb3d384de9c3a289f5d841a0d7a">oomph::CRMatrix&lt; T &gt;::row_start()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start()</a>, <a class="el" href="../../d6/d24/classoomph_1_1SparseMatrix.html#a3e382ff145082821a6b0b3e63b6aed5d">oomph::SparseMatrix&lt; T, MATRIX_TYPE &gt;::value()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab8220b7c2bb763dab32a4d0fea7da6f4">value()</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#a8c3dcdf8a602a1f266bbe72d98fde2e7">oomph::DoubleVector::values_pt()</a>, and <a class="el" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">plotDoE::x</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/dcc/classoomph_1_1ProblemBasedShiftInvertOperator.html#a1f209382d6023466da7e978ce16f1c09">oomph::ProblemBasedShiftInvertOperator::apply()</a>, <a class="el" href="../../d2/d08/classoomph_1_1AugmentedProblemGMRES.html#a98bde93ede0909eb0170ef490c6d184d">oomph::AugmentedProblemGMRES::augmented_matrix_multiply()</a>, <a class="el" href="../../da/d85/matrix__multiply__test_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main()</a>, <a class="el" href="../../d1/dac/classoomph_1_1MatrixVectorProduct.html#ac29ba50f1a77bf0e316c3417bcff71ee">oomph::MatrixVectorProduct::multiply()</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#abe25ba0bd83ba1e963103c4ad95328cc">oomph::DoubleVector::norm()</a>, <a class="el" href="../../de/d0d/classoomph_1_1GMRESBlockPreconditioner.html#a73f8298ef0dee62de0eabd28ac78a53b">oomph::GMRESBlockPreconditioner::preconditioner_solve()</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#aadcbdb5af92d7889c956098cb86dee87">oomph::LagrangeEnforcedFlowPreconditioner::setup()</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a03cbfa527081ea03c910aadc281615d7">oomph::NavierStokesSchurComplementPreconditioner::setup()</a>, <a class="el" href="../../d7/da4/classoomph_1_1PressureBasedSolidLSCPreconditioner.html#aba594f38c2d36775115adbc90bcd0025">oomph::PressureBasedSolidLSCPreconditioner::setup()</a>, and <a class="el" href="../../da/da7/classoomph_1_1SpaceTimeNavierStokesSubsidiaryPreconditioner.html#a416c107b8095d5083b7a84775bae9881">oomph::SpaceTimeNavierStokesSubsidiaryPreconditioner::setup()</a>.</p>

</div>
</div>
<a id="a42fb274c98ccf4c2a542ca15343fcc0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42fb274c98ccf4c2a542ca15343fcc0e">&#9670;&nbsp;</a></span>multiply_transpose()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::CRDoubleMatrix::multiply_transpose </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;&#160;</td>
          <td class="paramname"><em>soln</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Multiply the transposed matrix by the vector x: soln=A^T x. </p>

<p>Implements <a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a843d44405b70da1d96b43218a21e6ffc">oomph::DoubleMatrixBase</a>.</p>
<div class="fragment"><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;  {</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;    <span class="comment">// check that this matrix is built</span></div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a63afd9976f0970a4e6ffee3755d21540">Built</a>)</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;    {</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;      std::ostringstream error_message_stream;</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;      error_message_stream &lt;&lt; <span class="stringliteral">&quot;This matrix has not been built&quot;</span>;</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(error_message_stream.str(),</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;    }</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;    <span class="comment">// Check to see if x.size() = ncol().</span></div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;    <span class="keywordflow">if</span> (!(*this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>() == *<a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>.distribution_pt()))</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;    {</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;      std::ostringstream error_message_stream;</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;      error_message_stream</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;The x vector and this matrix must have the same distribution.&quot;</span>;</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(error_message_stream.str(),</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;    }</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;    <span class="comment">// if soln is setup then it should have the same distribution as x</span></div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;    <span class="keywordflow">if</span> (soln.built())</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;    {</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;      <span class="keywordflow">if</span> (soln.distribution_pt()-&gt;nrow() != this-&gt;ncol())</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;      {</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;        std::ostringstream error_message_stream;</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;        error_message_stream</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;The soln vector is setup and therefore must have the same &quot;</span></div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;number of rows as the vector x&quot;</span>;</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(error_message_stream.str(),</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;      }</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;    }</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160; </div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;    <span class="comment">// if soln is not setup then setup the distribution</span></div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;    <span class="keywordflow">if</span> (!soln.built())</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;    {</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;      LinearAlgebraDistribution* dist_pt =</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;        <span class="keyword">new</span> LinearAlgebraDistribution(<a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>.distribution_pt()-&gt;communicator_pt(),</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;                                      this-&gt;ncol(),</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;                                      this-&gt;distributed());</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;      soln.build(dist_pt, 0.0);</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;      <span class="keyword">delete</span> dist_pt;</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;    }</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160; </div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;    <span class="comment">// Initialise</span></div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;    soln.initialise(0.0);</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160; </div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a5505731e7e73d7e4251c67c7adec6bf5">distributed</a>() &amp;&amp;</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;        this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>()-&gt;communicator_pt()-&gt;nproc() &gt; 1)</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;    {</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_TRILINOS</span></div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;      <span class="comment">// This will only work if we have trilinos on board</span></div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;      <a class="code" href="../../d1/d35/namespaceoomph_1_1TrilinosEpetraHelpers.html#a595c337ff02ad53b3dcac04ed142f8db">TrilinosEpetraHelpers::multiply</a>(<span class="keyword">this</span>, <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>, soln);</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;      std::ostringstream error_message_stream;</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;      error_message_stream</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;Matrix-vector product on multiple processors with distributed &quot;</span></div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;CRDoubleMatrix requires Trilinos.&quot;</span>;</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(error_message_stream.str(),</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;    }</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;    {</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;      <span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#abd8d231b0549540144b4739a667b1e75">nrow</a>();</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span>* <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start</a> = <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a>.<a class="code" href="../../d4/def/classoomph_1_1CRMatrix.html#a6210ebb3d384de9c3a289f5d841a0d7a">row_start</a>();</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span>* <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a21b3dbb8ee74e1247f80ce4506c395f8">column_index</a> = <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a>.<a class="code" href="../../d4/def/classoomph_1_1CRMatrix.html#aa6057d1c2a9a491f643e0633c778f8fb">column_index</a>();</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span>* <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab8220b7c2bb763dab32a4d0fea7da6f4">value</a> = <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a>.<a class="code" href="../../d6/d24/classoomph_1_1SparseMatrix.html#a3e382ff145082821a6b0b3e63b6aed5d">value</a>();</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;      <span class="keywordtype">double</span>* soln_pt = soln.values_pt();</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span>* x_pt = <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>.values_pt();</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;      <span class="comment">// Matrix vector product</span></div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;      {</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">long</span> <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> = <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]; <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> &lt; <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1]; <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>++)</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;        {</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a21b3dbb8ee74e1247f80ce4506c395f8">column_index</a>[<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>];</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;          <span class="keywordtype">double</span> a_ij = <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab8220b7c2bb763dab32a4d0fea7da6f4">value</a>[<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>];</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;          soln_pt[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>] += a_ij * x_pt[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;        }</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;      }</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;    }</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#a7bcc94c157d6853a0f0502e8a76ed380">oomph::DoubleVector::build()</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#aae402d422ec4344a4a45cdb7659b7161">oomph::DoubleVector::built()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a63afd9976f0970a4e6ffee3755d21540">Built</a>, <a class="el" href="../../d4/def/classoomph_1_1CRMatrix.html#aa6057d1c2a9a491f643e0633c778f8fb">oomph::CRMatrix&lt; T &gt;::column_index()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a21b3dbb8ee74e1247f80ce4506c395f8">column_index()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a5505731e7e73d7e4251c67c7adec6bf5">oomph::DistributableLinearAlgebraObject::distributed()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">oomph::DistributableLinearAlgebraObject::distribution_pt()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#a180c1057a29f4ed721da46040a619ecd">oomph::DoubleVector::initialise()</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>, <a class="el" href="../../d1/d35/namespaceoomph_1_1TrilinosEpetraHelpers.html#a595c337ff02ad53b3dcac04ed142f8db">oomph::TrilinosEpetraHelpers::multiply()</a>, <a class="el" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#aafad0b69de2284808366b65bd63e493b">oomph::LinearAlgebraDistribution::nrow()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#abd8d231b0549540144b4739a667b1e75">nrow()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../d4/def/classoomph_1_1CRMatrix.html#a6210ebb3d384de9c3a289f5d841a0d7a">oomph::CRMatrix&lt; T &gt;::row_start()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start()</a>, <a class="el" href="../../d6/d24/classoomph_1_1SparseMatrix.html#a3e382ff145082821a6b0b3e63b6aed5d">oomph::SparseMatrix&lt; T, MATRIX_TYPE &gt;::value()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab8220b7c2bb763dab32a4d0fea7da6f4">value()</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#a8c3dcdf8a602a1f266bbe72d98fde2e7">oomph::DoubleVector::values_pt()</a>, and <a class="el" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">plotDoE::x</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/dac/classoomph_1_1MatrixVectorProduct.html#a2b7670797fe289ea814968f2f9469fd5">oomph::MatrixVectorProduct::multiply_transpose()</a>, <a class="el" href="../../d7/db1/classoomph_1_1SuperLUSolver.html#a5a121df89c72a8741d051aa176b12255">oomph::SuperLUSolver::solve()</a>, and <a class="el" href="../../d7/db1/classoomph_1_1SuperLUSolver.html#a10bdce2b176a3ca514b82f66cd50e037">oomph::SuperLUSolver::solve_transpose()</a>.</p>

</div>
</div>
<a id="a4ed5597d8a34dd14f90b0e6cfb88ca2e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ed5597d8a34dd14f90b0e6cfb88ca2e">&#9670;&nbsp;</a></span>ncol()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long oomph::CRDoubleMatrix::ncol </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the number of columns of the matrix. </p>

<p>Implements <a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a253feffbf1db1976cdd86c6134c50abe">oomph::DoubleMatrixBase</a>.</p>
<div class="fragment"><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    {</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a>.<a class="code" href="../../d6/d24/classoomph_1_1SparseMatrix.html#a4db71b6d794cfcee1624c15c09d62d7f">ncol</a>();</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1SparseMatrix_html_a4db71b6d794cfcee1624c15c09d62d7f"><div class="ttname"><a href="../../d6/d24/classoomph_1_1SparseMatrix.html#a4db71b6d794cfcee1624c15c09d62d7f">oomph::SparseMatrix::ncol</a></div><div class="ttdeci">unsigned long ncol() const</div><div class="ttdoc">Return the number of columns of the matrix.</div><div class="ttdef"><b>Definition:</b> matrices.h:634</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a>, and <a class="el" href="../../d6/d24/classoomph_1_1SparseMatrix.html#a4db71b6d794cfcee1624c15c09d62d7f">oomph::SparseMatrix&lt; T, MATRIX_TYPE &gt;::ncol()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a57f88253acfa87a764652c06c1bdc362">add()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#af88437afe2b838fd6b508c590d26bd26">CRDoubleMatrix()</a>, <a class="el" href="../../d1/d35/namespaceoomph_1_1TrilinosEpetraHelpers.html#a1b96bb02b661a770a7b5830af771a249">oomph::TrilinosEpetraHelpers::create_distributed_epetra_matrix_for_aztecoo()</a>, <a class="el" href="../../d6/dc6/namespaceoomph_1_1HypreHelpers.html#a3c7d0df9c9c2ce939e071a16716d7734">oomph::HypreHelpers::create_HYPRE_Matrix()</a>, <a class="el" href="../../dd/d95/namespaceoomph_1_1CRDoubleMatrixHelpers.html#a157511f700993ab8bc014f9d0d44f4c7">oomph::CRDoubleMatrixHelpers::deep_copy()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ad438e693468cd0ae179460eafcaab038">diagonal_entries()</a>, <a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a51636746e5921ee2845daf60b1c322dc">oomph::BlockPreconditioner&lt; MATRIX &gt;::get_concatenated_block()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a82cb428139f7c35a7c62a09fad38eecb">get_matrix_transpose()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a984602c9df0c573451f315a025820ced">global_matrix()</a>, <a class="el" href="../../da/d85/matrix__multiply__test_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a3853068b7fce9e83bc817930262e9ca1">matrix_reduction()</a>, <a class="el" href="../../d1/d35/namespaceoomph_1_1TrilinosEpetraHelpers.html#a0d96936ed1e5f3266ef06564ae300103">oomph::TrilinosEpetraHelpers::multiply()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a54b75960df52e3aebd21aaab20e9869d">multiply()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a9ba295a04e08e3153ae06bc0556f507d">redistribute()</a>, <a class="el" href="../../d1/dac/classoomph_1_1MatrixVectorProduct.html#aec74f9bdb65ee7ce86590e26a705f3e9">oomph::MatrixVectorProduct::setup()</a>, and <a class="el" href="../../da/d32/classoomph_1_1HelmholtzMGPreconditioner.html#a2436c6189b4cda832bf28471f4f9e23c">oomph::HelmholtzMGPreconditioner&lt; DIM &gt;::setup_coarsest_level_structures()</a>.</p>

</div>
</div>
<a id="a9482dafc0a17ebc5b7431369d8d07565"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9482dafc0a17ebc5b7431369d8d07565">&#9670;&nbsp;</a></span>nnz()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long oomph::CRDoubleMatrix::nnz </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the number of nonzero entries (the local nnz) </p>
<div class="fragment"><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    {</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a>.<a class="code" href="../../d6/d24/classoomph_1_1SparseMatrix.html#a8b8010edcc0869283621e72a9bbc51e3">nnz</a>();</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1SparseMatrix_html_a8b8010edcc0869283621e72a9bbc51e3"><div class="ttname"><a href="../../d6/d24/classoomph_1_1SparseMatrix.html#a8b8010edcc0869283621e72a9bbc51e3">oomph::SparseMatrix::nnz</a></div><div class="ttdeci">unsigned long nnz() const</div><div class="ttdoc">Return the number of nonzero entries.</div><div class="ttdef"><b>Definition:</b> matrices.h:640</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a>, and <a class="el" href="../../d6/d24/classoomph_1_1SparseMatrix.html#a8b8010edcc0869283621e72a9bbc51e3">oomph::SparseMatrix&lt; T, MATRIX_TYPE &gt;::nnz()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aafb4d7de0a87b4bda560928e6a128060">build_without_copy()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#af88437afe2b838fd6b508c590d26bd26">CRDoubleMatrix()</a>, <a class="el" href="../../d1/d35/namespaceoomph_1_1TrilinosEpetraHelpers.html#a1b96bb02b661a770a7b5830af771a249">oomph::TrilinosEpetraHelpers::create_distributed_epetra_matrix_for_aztecoo()</a>, <a class="el" href="../../dd/d95/namespaceoomph_1_1CRDoubleMatrixHelpers.html#a157511f700993ab8bc014f9d0d44f4c7">oomph::CRDoubleMatrixHelpers::deep_copy()</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#aeab520bd25edb0f4e88feaedec689333">oomph::MumpsSolver::factorise()</a>, <a class="el" href="../../d7/db1/classoomph_1_1SuperLUSolver.html#a6b1ce356d11fa878315e9b32ac566748">oomph::SuperLUSolver::factorise_serial()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a82cb428139f7c35a7c62a09fad38eecb">get_matrix_transpose()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a984602c9df0c573451f315a025820ced">global_matrix()</a>, <a class="el" href="../../da/d2b/generic__mpi__test_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a9ba295a04e08e3153ae06bc0556f507d">redistribute()</a>, <a class="el" href="../../d0/d0c/classoomph_1_1HyprePreconditioner.html#a5622db3b409cbdc49887aa65fa35215a">oomph::HyprePreconditioner::setup()</a>, <a class="el" href="../../d8/d77/classoomph_1_1LagrangeEnforcedFlowPreconditioner.html#aadcbdb5af92d7889c956098cb86dee87">oomph::LagrangeEnforcedFlowPreconditioner::setup()</a>, <a class="el" href="../../d1/dd8/classoomph_1_1BandedBlockTriangularPreconditioner.html#a3b6ce68dead6323b9f62bacd71a22337">oomph::BandedBlockTriangularPreconditioner&lt; MATRIX &gt;::setup()</a>, <a class="el" href="../../da/da7/classoomph_1_1SpaceTimeNavierStokesSubsidiaryPreconditioner.html#a416c107b8095d5083b7a84775bae9881">oomph::SpaceTimeNavierStokesSubsidiaryPreconditioner::setup()</a>, <a class="el" href="../../de/d0d/classoomph_1_1GMRESBlockPreconditioner.html#ae517d83cf8eddba9f9e2ed709f503da2">oomph::GMRESBlockPreconditioner::setup()</a>, <a class="el" href="../../da/d32/classoomph_1_1HelmholtzMGPreconditioner.html#a2436c6189b4cda832bf28471f4f9e23c">oomph::HelmholtzMGPreconditioner&lt; DIM &gt;::setup_coarsest_level_structures()</a>, <a class="el" href="../../d7/db1/classoomph_1_1SuperLUSolver.html#a94e94a44f4cb93f2adf035e9b99990e7">oomph::SuperLUSolver::solve()</a>, and <a class="el" href="../../d7/db1/classoomph_1_1SuperLUSolver.html#a4954bcec402af933d69825d58824fafc">oomph::SuperLUSolver::solve_transpose()</a>.</p>

</div>
</div>
<a id="abd8d231b0549540144b4739a667b1e75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd8d231b0549540144b4739a667b1e75">&#9670;&nbsp;</a></span>nrow()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long oomph::CRDoubleMatrix::nrow </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the number of rows of the matrix. </p>

<p>Implements <a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#acdcd6e1ea2bf2380f1a2fa32c7829cb5">oomph::DoubleMatrixBase</a>.</p>
<div class="fragment"><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    {</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a7569556f14fd68b28508920e89bd5eee">DistributableLinearAlgebraObject::nrow</a>();</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1DistributableLinearAlgebraObject_html_a7569556f14fd68b28508920e89bd5eee"><div class="ttname"><a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a7569556f14fd68b28508920e89bd5eee">oomph::DistributableLinearAlgebraObject::nrow</a></div><div class="ttdeci">unsigned nrow() const</div><div class="ttdoc">access function to the number of global rows.</div><div class="ttdef"><b>Definition:</b> linear_algebra_distribution.h:463</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a7569556f14fd68b28508920e89bd5eee">oomph::DistributableLinearAlgebraObject::nrow()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a57f88253acfa87a764652c06c1bdc362">add()</a>, <a class="el" href="../../d2/d08/classoomph_1_1AugmentedProblemGMRES.html#a98bde93ede0909eb0170ef490c6d184d">oomph::AugmentedProblemGMRES::augmented_matrix_multiply()</a>, <a class="el" href="../../df/daa/classoomph_1_1ComplexDampedJacobi.html#a4cf2cdac05266021cd0660ba60ae6a8b">oomph::ComplexDampedJacobi&lt; MATRIX &gt;::complex_smoother_setup()</a>, <a class="el" href="../../dd/d95/namespaceoomph_1_1CRDoubleMatrixHelpers.html#ab7e3ac344aa644292a143a3917a03e65">oomph::CRDoubleMatrixHelpers::concatenate()</a>, <a class="el" href="../../d1/d35/namespaceoomph_1_1TrilinosEpetraHelpers.html#a0a8d24c6cf06d8c71bb414c153a276cf">oomph::TrilinosEpetraHelpers::create_distributed_epetra_matrix()</a>, <a class="el" href="../../d1/d35/namespaceoomph_1_1TrilinosEpetraHelpers.html#a1b96bb02b661a770a7b5830af771a249">oomph::TrilinosEpetraHelpers::create_distributed_epetra_matrix_for_aztecoo()</a>, <a class="el" href="../../d6/dc6/namespaceoomph_1_1HypreHelpers.html#a3c7d0df9c9c2ce939e071a16716d7734">oomph::HypreHelpers::create_HYPRE_Matrix()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ad438e693468cd0ae179460eafcaab038">diagonal_entries()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ae35fbae1702bbf75601c2a1026df103e">entries_are_sorted()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a4e59f1c854d1258aa2b4eca218405731">oomph::Problem::get_eigenproblem_matrices()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a82cb428139f7c35a7c62a09fad38eecb">get_matrix_transpose()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a984602c9df0c573451f315a025820ced">global_matrix()</a>, <a class="el" href="../../dd/d55/classoomph_1_1HypreInterface.html#aebc23d169937d5e6a5b492710843ae7b">oomph::HypreInterface::hypre_matrix_setup()</a>, <a class="el" href="../../da/d85/matrix__multiply__test_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main()</a>, <a class="el" href="../../dc/d2e/classoomph_1_1MGSolver.html#ad31f3a5daa8edec01ab20c92e5fcca54">oomph::MGSolver&lt; DIM &gt;::modify_restriction_matrices()</a>, <a class="el" href="../../d1/d35/namespaceoomph_1_1TrilinosEpetraHelpers.html#a0d96936ed1e5f3266ef06564ae300103">oomph::TrilinosEpetraHelpers::multiply()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a54b75960df52e3aebd21aaab20e9869d">multiply()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a42fb274c98ccf4c2a542ca15343fcc0e">multiply_transpose()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a9ba295a04e08e3153ae06bc0556f507d">redistribute()</a>, <a class="el" href="../../de/dc5/classoomph_1_1ILUZeroPreconditioner_3_01CRDoubleMatrix_01_4.html#a2398a8674540bfdb8d69a699085107d8">oomph::ILUZeroPreconditioner&lt; CRDoubleMatrix &gt;::setup()</a>, <a class="el" href="../../d0/d0c/classoomph_1_1HyprePreconditioner.html#a5622db3b409cbdc49887aa65fa35215a">oomph::HyprePreconditioner::setup()</a>, <a class="el" href="../../d1/dd8/classoomph_1_1BandedBlockTriangularPreconditioner.html#a3b6ce68dead6323b9f62bacd71a22337">oomph::BandedBlockTriangularPreconditioner&lt; MATRIX &gt;::setup()</a>, <a class="el" href="../../da/da7/classoomph_1_1SpaceTimeNavierStokesSubsidiaryPreconditioner.html#a416c107b8095d5083b7a84775bae9881">oomph::SpaceTimeNavierStokesSubsidiaryPreconditioner::setup()</a>, <a class="el" href="../../de/d0d/classoomph_1_1GMRESBlockPreconditioner.html#ae517d83cf8eddba9f9e2ed709f503da2">oomph::GMRESBlockPreconditioner::setup()</a>, <a class="el" href="../../da/d32/classoomph_1_1HelmholtzMGPreconditioner.html#a2436c6189b4cda832bf28471f4f9e23c">oomph::HelmholtzMGPreconditioner&lt; DIM &gt;::setup_coarsest_level_structures()</a>, <a class="el" href="../../d7/db1/classoomph_1_1SuperLUSolver.html#a94e94a44f4cb93f2adf035e9b99990e7">oomph::SuperLUSolver::solve()</a>, <a class="el" href="../../d7/db1/classoomph_1_1SuperLUSolver.html#a4954bcec402af933d69825d58824fafc">oomph::SuperLUSolver::solve_transpose()</a>, and <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a2107875787d4dfa1cf007c05a041b078">sort_entries()</a>.</p>

</div>
</div>
<a id="af5b1d934bae618c92aa1089671b6130e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5b1d934bae618c92aa1089671b6130e">&#9670;&nbsp;</a></span>operator()()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> oomph::CRDoubleMatrix::operator() </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long &amp;&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long &amp;&#160;</td>
          <td class="paramname"><em>j</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Overload the round-bracket access operator for read-only access. In a distributed matrix i refers to the local row index. </p>

<p>Implements <a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a20b85f0286f80464f42f0846fede2d77">oomph::DoubleMatrixBase</a>.</p>
<div class="fragment"><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    {</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a>.<a class="code" href="../../d4/def/classoomph_1_1CRMatrix.html#afc7fe758067c8ab3fe2dba96a4258492">get_entry</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a>, <a class="el" href="../../d4/def/classoomph_1_1CRMatrix.html#afc7fe758067c8ab3fe2dba96a4258492">oomph::CRMatrix&lt; T &gt;::get_entry()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, and <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>.</p>

</div>
</div>
<a id="a3def3614952fcdd16a8edbc82f472490"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3def3614952fcdd16a8edbc82f472490">&#9670;&nbsp;</a></span>operator=()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::CRDoubleMatrix::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Broken assignment operator. </p>

</div>
</div>
<a id="ab0887b5420752c47bfc14777006bcc1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0887b5420752c47bfc14777006bcc1e">&#9670;&nbsp;</a></span>output_bottom_right_zero_helper()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::CRDoubleMatrix::output_bottom_right_zero_helper </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>outfile</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Output the "bottom right" entry regardless of it being zero or not (this allows automatic detection of matrix size in e.g. matlab, python). </p>

<p>Implements <a class="el" href="../../d6/d74/classoomph_1_1Matrix.html#a10ee338f4d3893010291a692aea04248">oomph::Matrix&lt; double, CRDoubleMatrix &gt;</a>.</p>
<div class="fragment"><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    {</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;      <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a>.<a class="code" href="../../d4/def/classoomph_1_1CRMatrix.html#abf764862746afbbe2655a41bdf726327">output_bottom_right_zero_helper</a>(outfile);</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1CRMatrix_html_abf764862746afbbe2655a41bdf726327"><div class="ttname"><a href="../../d4/def/classoomph_1_1CRMatrix.html#abf764862746afbbe2655a41bdf726327">oomph::CRMatrix::output_bottom_right_zero_helper</a></div><div class="ttdeci">void output_bottom_right_zero_helper(std::ostream &amp;outfile) const</div><div class="ttdef"><b>Definition:</b> matrices.h:811</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a>, and <a class="el" href="../../d4/def/classoomph_1_1CRMatrix.html#abf764862746afbbe2655a41bdf726327">oomph::CRMatrix&lt; T &gt;::output_bottom_right_zero_helper()</a>.</p>

</div>
</div>
<a id="a9ba295a04e08e3153ae06bc0556f507d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ba295a04e08e3153ae06bc0556f507d">&#9670;&nbsp;</a></span>redistribute()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::CRDoubleMatrix::redistribute </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> *const &amp;&#160;</td>
          <td class="paramname"><em>dist_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The contents of the matrix are redistributed to match the new distribution. In a non-MPI build this method does nothing. <b>NOTE</b> 1: The current distribution and the new distribution must have the same number of global rows. <b>NOTE</b> 2: The current distribution and the new distribution must have the same Communicator. </p>
<div class="fragment"><div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;  {</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;    <span class="comment">// paranoid check that the nrows for both distributions is the</span></div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;    <span class="comment">// same</span></div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;    <span class="keywordflow">if</span> (dist_pt-&gt;nrow() != this-&gt;distribution_pt()-&gt;nrow())</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;    {</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;      std::ostringstream error_message;</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;      error_message &lt;&lt; <span class="stringliteral">&quot;The number of global rows in the new distribution (&quot;</span></div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;                    &lt;&lt; dist_pt-&gt;nrow() &lt;&lt; <span class="stringliteral">&quot;) is not equal to the number&quot;</span></div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot; of global rows in the current distribution (&quot;</span></div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;                    &lt;&lt; this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>()-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#aafad0b69de2284808366b65bd63e493b">nrow</a>() &lt;&lt; <span class="stringliteral">&quot;).\n&quot;</span>;</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;        error_message.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;    }</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;    <span class="comment">// paranoid check that the current distribution and the new distribution</span></div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;    <span class="comment">// have the same Communicator</span></div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;    OomphCommunicator temp_comm(*dist_pt-&gt;communicator_pt());</div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;    <span class="keywordflow">if</span> (!(temp_comm == *this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>()-&gt;communicator_pt()))</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;    {</div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;      std::ostringstream error_message;</div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;      error_message &lt;&lt; <span class="stringliteral">&quot;The new distribution and the current distribution must &quot;</span></div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;have the same communicator.&quot;</span>;</div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;        error_message.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;    }</div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;    <span class="comment">// paranoid check that the matrix is build</span></div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;    <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aa0503bc64ef0ccb60cb7d7e645425a62">built</a>())</div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;    {</div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;      std::ostringstream error_message;</div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;      error_message &lt;&lt; <span class="stringliteral">&quot;The matrix must be build to be redistributed&quot;</span>;</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;        error_message.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;    }</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160; </div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;    <span class="comment">// if the two distributions are not the same</span></div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;    <span class="comment">// =========================================</span></div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;    <span class="keywordflow">if</span> (!((*this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>()) == *dist_pt))</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;    {</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;      <span class="comment">// Get the number of columns to build the matrix.</span></div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a4ed5597d8a34dd14f90b0e6cfb88ca2e">ncol</a> = this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a4ed5597d8a34dd14f90b0e6cfb88ca2e">ncol</a>();</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160; </div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;      <span class="comment">// current data</span></div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;      <span class="keywordtype">int</span>* current_row_start = this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start</a>();</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;      <span class="keywordtype">int</span>* current_column_index = this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a21b3dbb8ee74e1247f80ce4506c395f8">column_index</a>();</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;      <span class="keywordtype">double</span>* current_value = this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab8220b7c2bb763dab32a4d0fea7da6f4">value</a>();</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160; </div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;      <span class="comment">// get the rank and the number of processors</span></div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;      <span class="keywordtype">int</span> my_rank = this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>()-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a2e4736826a65253f574d4f6f152ab514">communicator_pt</a>()-&gt;<a class="code" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a670b34aab05bfe0b96d0e0fabf583c7a">my_rank</a>();</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;      <span class="keywordtype">int</span> nproc = this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>()-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a2e4736826a65253f574d4f6f152ab514">communicator_pt</a>()-&gt;<a class="code" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a6c78c72666f4b102c2bccf200f0853b7">nproc</a>();</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160; </div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;      <span class="comment">// if both distributions are distributed</span></div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;      <span class="comment">// =====================================</span></div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;      <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a5505731e7e73d7e4251c67c7adec6bf5">distributed</a>() &amp;&amp; dist_pt-&gt;distributed())</div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;      {</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;        <span class="comment">// new nrow_local and first_row data</span></div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;        Vector&lt;unsigned&gt; new_first_row(nproc);</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;        Vector&lt;unsigned&gt; new_nrow_local(nproc);</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;        Vector&lt;unsigned&gt; current_first_row(nproc);</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;        Vector&lt;unsigned&gt; current_nrow_local(nproc);</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; nproc; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;        {</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;          new_first_row[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = dist_pt-&gt;first_row(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;          new_nrow_local[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = dist_pt-&gt;nrow_local(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;          current_first_row[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ab00a3919b8634c698749f14a4d92947d">first_row</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;          current_nrow_local[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">nrow_local</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;        }</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160; </div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;        <span class="comment">// compute which local rows are expected to be received from each</span></div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;        <span class="comment">// processor / sent to each processor</span></div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;        Vector&lt;unsigned&gt; first_row_for_proc(nproc, 0);</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;        Vector&lt;unsigned&gt; nrow_local_for_proc(nproc, 0);</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;        Vector&lt;unsigned&gt; first_row_from_proc(nproc, 0);</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;        Vector&lt;unsigned&gt; nrow_local_from_proc(nproc, 0);</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160; </div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;        <span class="comment">// for every processor compute first_row and nrow_local that will</span></div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;        <span class="comment">// will sent and received by this processor</span></div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> = 0; <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> &lt; nproc; <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>++)</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;        {</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;          <span class="comment">// start with data to be sent</span></div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;          <span class="keywordflow">if</span> ((new_first_row[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] &lt;</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;               (current_first_row[my_rank] + current_nrow_local[my_rank])) &amp;&amp;</div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;              (current_first_row[my_rank] &lt;</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;               (new_first_row[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] + new_nrow_local[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>])))</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;          {</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;            first_row_for_proc[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] =</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;              <a class="code" href="../../dc/d51/datatypes_8h.html#affe776513b24d84b39af8ab0930fef7f">std::max</a>(current_first_row[my_rank], new_first_row[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>]);</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;            nrow_local_for_proc[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] =</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;              <a class="code" href="../../dc/d51/datatypes_8h.html#ac6afabdc09a49a433ee19d8a9486056d">std::min</a>(</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;                (current_first_row[my_rank] + current_nrow_local[my_rank]),</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;                (new_first_row[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] + new_nrow_local[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>])) -</div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;              first_row_for_proc[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>];</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;          }</div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160; </div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;          <span class="comment">// and data to be received</span></div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;          <span class="keywordflow">if</span> ((new_first_row[my_rank] &lt;</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;               (current_first_row[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] + current_nrow_local[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>])) &amp;&amp;</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;              (current_first_row[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] &lt;</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;               (new_first_row[my_rank] + new_nrow_local[my_rank])))</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;          {</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;            first_row_from_proc[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] =</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;              <a class="code" href="../../dc/d51/datatypes_8h.html#affe776513b24d84b39af8ab0930fef7f">std::max</a>(current_first_row[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>], new_first_row[my_rank]);</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;            nrow_local_from_proc[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] =</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;              <a class="code" href="../../dc/d51/datatypes_8h.html#ac6afabdc09a49a433ee19d8a9486056d">std::min</a>((current_first_row[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] + current_nrow_local[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>]),</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;                       (new_first_row[my_rank] + new_nrow_local[my_rank])) -</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;              first_row_from_proc[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>];</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;          }</div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;        }</div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160; </div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;        <span class="comment">// determine how many nnzs to send to each processor</span></div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;        Vector&lt;unsigned&gt; nnz_for_proc(nproc, 0);</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> = 0; <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> &lt; nproc; <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>++)</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;        {</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;          <span class="keywordflow">if</span> (nrow_local_for_proc[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] &gt; 0)</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;          {</div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;            nnz_for_proc[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] = (current_row_start[first_row_for_proc[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] -</div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;                                                 current_first_row[my_rank] +</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;                                                 nrow_local_for_proc[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>]] -</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;                               current_row_start[first_row_for_proc[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] -</div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;                                                 current_first_row[my_rank]]);</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;          }</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;        }</div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160; </div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;        <span class="comment">// next post non-blocking sends and recv for the nnzs</span></div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;        Vector&lt;unsigned&gt; nnz_from_proc(nproc, 0);</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;        Vector&lt;MPI_Request&gt; send_req;</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;        Vector&lt;MPI_Request&gt; nnz_recv_req;</div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> = 0; <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> &lt; nproc; <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>++)</div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;        {</div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> != my_rank)</div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;          {</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;            <span class="comment">// send</span></div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;            <span class="keywordflow">if</span> (nrow_local_for_proc[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] &gt; 0)</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;            {</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;              MPI_Request req;</div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;              MPI_Isend(&amp;nnz_for_proc[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>],</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;                        1,</div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;                        MPI_UNSIGNED,</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;                        <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>,</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;                        0,</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;                        this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>()-&gt;communicator_pt()-&gt;mpi_comm(),</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;                        &amp;req);</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;              send_req.push_back(req);</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;            }</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160; </div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;            <span class="comment">// recv</span></div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;            <span class="keywordflow">if</span> (nrow_local_from_proc[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] &gt; 0)</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;            {</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;              MPI_Request req;</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;              MPI_Irecv(&amp;nnz_from_proc[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>],</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;                        1,</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;                        MPI_UNSIGNED,</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;                        <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>,</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;                        0,</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;                        this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>()-&gt;communicator_pt()-&gt;mpi_comm(),</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;                        &amp;req);</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;              nnz_recv_req.push_back(req);</div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;            }</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;          }</div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;          <span class="comment">// &quot;send to self&quot;</span></div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;          {</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;            nnz_from_proc[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] = nnz_for_proc[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>];</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;          }</div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;        }</div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160; </div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;        <span class="comment">// allocate new storage for the new row_start</span></div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;        <span class="keywordtype">int</span>* new_row_start = <span class="keyword">new</span> <span class="keywordtype">int</span>[new_nrow_local[my_rank] + 1];</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160; </div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;        <span class="comment">// wait for recvs to complete</span></div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;        <span class="keywordtype">unsigned</span> n_recv_req = nnz_recv_req.size();</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;        <span class="keywordflow">if</span> (n_recv_req &gt; 0)</div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;        {</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;          Vector&lt;MPI_Status&gt; recv_status(n_recv_req);</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;          MPI_Waitall(n_recv_req, &amp;nnz_recv_req[0], &amp;recv_status[0]);</div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;        }</div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160; </div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;        <span class="comment">// compute the nnz offset for each processor</span></div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;        <span class="keywordtype">unsigned</span> next_row = 0;</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;        <span class="keywordtype">unsigned</span> nnz_count = 0;</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;        Vector&lt;unsigned&gt; nnz_offset(nproc, 0);</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> = 0; <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> &lt; nproc; <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>++)</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;        {</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;          <span class="keywordtype">unsigned</span> pp = 0;</div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;          <span class="keywordflow">while</span> (new_first_row[pp] != next_row)</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;          {</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;            pp++;</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;          }</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;          nnz_offset[pp] = nnz_count;</div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;          nnz_count += nnz_from_proc[pp];</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;          next_row += new_nrow_local[pp];</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;        }</div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160; </div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;        <span class="comment">// allocate storage for the values and column indices</span></div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;        <span class="keywordtype">int</span>* new_column_index = <span class="keyword">new</span> <span class="keywordtype">int</span>[nnz_count];</div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;        <span class="keywordtype">double</span>* new_value = <span class="keyword">new</span> <span class="keywordtype">double</span>[nnz_count];</div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160; </div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;        <span class="comment">// post the sends and recvs for the matrix data</span></div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;        Vector&lt;MPI_Request&gt; recv_req;</div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;        MPI_Aint base_address;</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;        MPI_Get_address(new_value, &amp;base_address);</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> = 0; <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> &lt; nproc; <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>++)</div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;        {</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;          <span class="comment">// communicated with other processors</span></div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> != my_rank)</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;          {</div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;            <span class="comment">// SEND</span></div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;            <span class="keywordflow">if</span> (nrow_local_for_proc[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] &gt; 0)</div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;            {</div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;              <span class="comment">// array of datatypes</span></div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;              MPI_Datatype types[3];</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160; </div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;              <span class="comment">// array of offsets</span></div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;              MPI_Aint offsets[3];</div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160; </div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;              <span class="comment">// array of lengths</span></div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;              <span class="keywordtype">int</span> len[3];</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160; </div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;              <span class="comment">// row start</span></div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;              <span class="keywordtype">unsigned</span> first_row_to_send =</div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;                first_row_for_proc[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] - current_first_row[my_rank];</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;              MPI_Type_contiguous(nrow_local_for_proc[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>], MPI_INT, &amp;types[0]);</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;              MPI_Type_commit(&amp;types[0]);</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;              len[0] = 1;</div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;              MPI_Get_address(current_row_start + first_row_to_send,</div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;                              &amp;offsets[0]);</div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;              offsets[0] -= base_address;</div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160; </div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;              <span class="comment">// values</span></div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;              <span class="keywordtype">unsigned</span> first_coef_to_send =</div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;                current_row_start[first_row_to_send];</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;              MPI_Type_contiguous(nnz_for_proc[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>], MPI_DOUBLE, &amp;types[1]);</div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;              MPI_Type_commit(&amp;types[1]);</div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;              len[1] = 1;</div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;              MPI_Get_address(current_value + first_coef_to_send, &amp;offsets[1]);</div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;              offsets[1] -= base_address;</div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160; </div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;              <span class="comment">// column index</span></div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;              MPI_Type_contiguous(nnz_for_proc[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>], MPI_DOUBLE, &amp;types[2]);</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;              MPI_Type_commit(&amp;types[2]);</div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;              len[2] = 1;</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;              MPI_Get_address(current_column_index + first_coef_to_send,</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;                              &amp;offsets[2]);</div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;              offsets[2] -= base_address;</div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160; </div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;              <span class="comment">// build the combined datatype</span></div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;              MPI_Datatype send_type;</div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;              MPI_Type_create_struct(3, len, offsets, types, &amp;send_type);</div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;              MPI_Type_commit(&amp;send_type);</div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;              MPI_Type_free(&amp;types[0]);</div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;              MPI_Type_free(&amp;types[1]);</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;              MPI_Type_free(&amp;types[2]);</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160; </div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;              <span class="comment">// and send</span></div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;              MPI_Request req;</div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;              MPI_Isend(new_value,</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;                        1,</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;                        send_type,</div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;                        <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>,</div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;                        1,</div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;                        this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>()-&gt;communicator_pt()-&gt;mpi_comm(),</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;                        &amp;req);</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;              send_req.push_back(req);</div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;              MPI_Type_free(&amp;send_type);</div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;            }</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160; </div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;            <span class="comment">// RECV</span></div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;            <span class="keywordflow">if</span> (nrow_local_from_proc[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] &gt; 0)</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;            {</div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;              <span class="comment">// array of datatypes</span></div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;              MPI_Datatype types[3];</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160; </div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;              <span class="comment">// array of offsets</span></div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;              MPI_Aint offsets[3];</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160; </div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;              <span class="comment">// array of lengths</span></div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;              <span class="keywordtype">int</span> len[3];</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160; </div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;              <span class="comment">// row start</span></div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;              <span class="keywordtype">unsigned</span> first_row_to_recv =</div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;                first_row_from_proc[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] - new_first_row[my_rank];</div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;              MPI_Type_contiguous(nrow_local_from_proc[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>], MPI_INT, &amp;types[0]);</div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;              MPI_Type_commit(&amp;types[0]);</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;              len[0] = 1;</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;              MPI_Get_address(new_row_start + first_row_to_recv, &amp;offsets[0]);</div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;              offsets[0] -= base_address;</div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160; </div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;              <span class="comment">// values</span></div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;              <span class="keywordtype">unsigned</span> first_coef_to_recv = nnz_offset[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>];</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;              MPI_Type_contiguous(nnz_from_proc[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>], MPI_DOUBLE, &amp;types[1]);</div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;              MPI_Type_commit(&amp;types[1]);</div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;              len[1] = 1;</div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;              MPI_Get_address(new_value + first_coef_to_recv, &amp;offsets[1]);</div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;              offsets[1] -= base_address;</div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160; </div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;              <span class="comment">// column index</span></div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;              MPI_Type_contiguous(nnz_from_proc[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>], MPI_INT, &amp;types[2]);</div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;              MPI_Type_commit(&amp;types[2]);</div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;              len[2] = 1;</div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;              MPI_Get_address(new_column_index + first_coef_to_recv,</div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;                              &amp;offsets[2]);</div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;              offsets[2] -= base_address;</div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160; </div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;              <span class="comment">// build the combined datatype</span></div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;              MPI_Datatype recv_type;</div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;              MPI_Type_create_struct(3, len, offsets, types, &amp;recv_type);</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;              MPI_Type_commit(&amp;recv_type);</div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;              MPI_Type_free(&amp;types[0]);</div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;              MPI_Type_free(&amp;types[1]);</div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;              MPI_Type_free(&amp;types[2]);</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160; </div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;              <span class="comment">// and send</span></div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;              MPI_Request req;</div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;              MPI_Irecv(new_value,</div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;                        1,</div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;                        recv_type,</div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;                        <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>,</div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;                        1,</div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;                        this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>()-&gt;communicator_pt()-&gt;mpi_comm(),</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;                        &amp;req);</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;              recv_req.push_back(req);</div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;              MPI_Type_free(&amp;recv_type);</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;            }</div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;          }</div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;          <span class="comment">// other wise transfer data internally</span></div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;          {</div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;            <span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> =</div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;              first_row_for_proc[my_rank] - current_first_row[my_rank];</div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;            <span class="keywordtype">unsigned</span> <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> = first_row_from_proc[my_rank] - new_first_row[my_rank];</div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; nrow_local_for_proc[my_rank]; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;            {</div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;              new_row_start[<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> + <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = current_row_start[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> + <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;            }</div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;            <span class="keywordtype">unsigned</span> first_coef_to_send = current_row_start[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>];</div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; nnz_for_proc[my_rank]; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;            {</div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;              new_value[nnz_offset[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] + <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] =</div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;                current_value[first_coef_to_send + <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;              new_column_index[nnz_offset[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] + <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] =</div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;                current_column_index[first_coef_to_send + <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;            }</div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;          }</div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;        }</div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160; </div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;        <span class="comment">// wait for all recvs to complete</span></div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;        n_recv_req = recv_req.size();</div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;        <span class="keywordflow">if</span> (n_recv_req &gt; 0)</div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;        {</div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;          Vector&lt;MPI_Status&gt; recv_status(n_recv_req);</div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;          MPI_Waitall(n_recv_req, &amp;recv_req[0], &amp;recv_status[0]);</div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;        }</div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160; </div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;        <span class="comment">// next we need to update the row starts</span></div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> = 0; <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> &lt; nproc; <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>++)</div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;        {</div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;          <span class="keywordflow">if</span> (nrow_local_from_proc[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] &gt; 0)</div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;          {</div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;            <span class="keywordtype">unsigned</span> <a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ab00a3919b8634c698749f14a4d92947d">first_row</a> =</div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;              first_row_from_proc[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] - new_first_row[my_rank];</div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;            <span class="keywordtype">unsigned</span> last_row = <a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ab00a3919b8634c698749f14a4d92947d">first_row</a> + nrow_local_from_proc[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] - 1;</div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;            <span class="keywordtype">int</span> update = nnz_offset[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] - new_row_start[<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ab00a3919b8634c698749f14a4d92947d">first_row</a>];</div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = <a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ab00a3919b8634c698749f14a4d92947d">first_row</a>; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;= last_row; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;            {</div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;              new_row_start[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] += update;</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;            }</div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;          }</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;        }</div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;        new_row_start[dist_pt-&gt;nrow_local()] = nnz_count;</div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160; </div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;        <span class="comment">// wait for sends to complete</span></div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;        <span class="keywordtype">unsigned</span> n_send_req = send_req.size();</div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;        <span class="keywordflow">if</span> (n_recv_req &gt; 0)</div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;        {</div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;          Vector&lt;MPI_Status&gt; send_status(n_recv_req);</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;          MPI_Waitall(n_send_req, &amp;send_req[0], &amp;send_status[0]);</div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;        }</div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;        <span class="comment">// if (my_rank == 0)</span></div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;        <span class="comment">//  {</span></div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;        <span class="comment">//   CRDoubleMatrix* m_pt = this-&gt;global_matrix();</span></div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;        <span class="comment">//   m_pt-&gt;sparse_indexed_output(&quot;m1.dat&quot;);</span></div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;        <span class="comment">//  }</span></div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160; </div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;        this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#af44bac2acd071317f96dae49cbb0d977">build</a>(dist_pt);</div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;        this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aafb4d7de0a87b4bda560928e6a128060">build_without_copy</a>(</div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;          ncol, nnz_count, new_value, new_column_index, new_row_start);</div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;        <span class="comment">// if (my_rank == 0)</span></div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;        <span class="comment">//  {</span></div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;        <span class="comment">//   CRDoubleMatrix* m_pt = this-&gt;global_matrix();</span></div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;        <span class="comment">//   m_pt-&gt;sparse_indexed_output(&quot;m2.dat&quot;);</span></div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;        <span class="comment">//  }</span></div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;        <span class="comment">//       this-&gt;sparse_indexed_output(oomph_info);</span></div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;        abort();</div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;      }</div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160; </div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;      <span class="comment">// if this matrix is distributed but the new distributed matrix is global</span></div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;      <span class="comment">// ======================================================================</span></div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a5505731e7e73d7e4251c67c7adec6bf5">distributed</a>() &amp;&amp; !dist_pt-&gt;distributed())</div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;      {</div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;        <span class="comment">// nnz</span></div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a9482dafc0a17ebc5b7431369d8d07565">nnz</a> = this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a9482dafc0a17ebc5b7431369d8d07565">nnz</a>();</div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160; </div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;        <span class="comment">// nrow global</span></div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;        <span class="keywordtype">unsigned</span> <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#abd8d231b0549540144b4739a667b1e75">nrow</a> = this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#abd8d231b0549540144b4739a667b1e75">nrow</a>();</div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160; </div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;        <span class="comment">// cache nproc</span></div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;        <span class="keywordtype">int</span> nproc = this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>()-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a2e4736826a65253f574d4f6f152ab514">communicator_pt</a>()-&gt;<a class="code" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a6c78c72666f4b102c2bccf200f0853b7">nproc</a>();</div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160; </div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;        <span class="comment">// get the nnzs on the other processors</span></div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;        <span class="keywordtype">int</span>* dist_nnz_pt = <span class="keyword">new</span> <span class="keywordtype">int</span>[nproc];</div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;        MPI_Allgather(&amp;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a9482dafc0a17ebc5b7431369d8d07565">nnz</a>,</div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;                      1,</div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;                      MPI_INT,</div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;                      dist_nnz_pt,</div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;                      1,</div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;                      MPI_INT,</div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;                      this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>()-&gt;communicator_pt()-&gt;mpi_comm());</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160; </div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;        <span class="comment">// create an int array of first rows and nrow local and</span></div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;        <span class="comment">// compute nnz global</span></div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;        <span class="keywordtype">int</span>* dist_first_row = <span class="keyword">new</span> <span class="keywordtype">int</span>[nproc];</div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;        <span class="keywordtype">int</span>* dist_nrow_local = <span class="keyword">new</span> <span class="keywordtype">int</span>[nproc];</div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> = 0; <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> &lt; nproc; <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>++)</div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;        {</div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;          dist_first_row[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] = this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ab00a3919b8634c698749f14a4d92947d">first_row</a>(p);</div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;          dist_nrow_local[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] = this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">nrow_local</a>(p);</div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;        }</div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160; </div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;        <span class="comment">// conpute the offset for the values and column index data</span></div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;        <span class="comment">// compute the nnz offset for each processor</span></div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;        <span class="keywordtype">int</span> next_row = 0;</div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;        <span class="keywordtype">unsigned</span> nnz_count = 0;</div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;        Vector&lt;unsigned&gt; nnz_offset(nproc, 0);</div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> = 0; <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> &lt; nproc; <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>++)</div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;        {</div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;          <span class="keywordtype">unsigned</span> pp = 0;</div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;          <span class="keywordflow">while</span> (dist_first_row[pp] != next_row)</div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;          {</div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;            pp++;</div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;          }</div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;          nnz_offset[pp] = nnz_count;</div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;          nnz_count += dist_nnz_pt[pp];</div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;          next_row += dist_nrow_local[pp];</div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;        }</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160; </div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;        <span class="comment">// get pointers to the (current) distributed data</span></div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;        <span class="keywordtype">int</span>* dist_row_start = this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start</a>();</div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;        <span class="keywordtype">int</span>* dist_column_index = this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a21b3dbb8ee74e1247f80ce4506c395f8">column_index</a>();</div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;        <span class="keywordtype">double</span>* dist_value = this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab8220b7c2bb763dab32a4d0fea7da6f4">value</a>();</div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160; </div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;        <span class="comment">// space for the global matrix</span></div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;        <span class="keywordtype">int</span>* global_row_start = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#abd8d231b0549540144b4739a667b1e75">nrow</a> + 1];</div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;        <span class="keywordtype">int</span>* global_column_index = <span class="keyword">new</span> <span class="keywordtype">int</span>[nnz_count];</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;        <span class="keywordtype">double</span>* global_value = <span class="keyword">new</span> <span class="keywordtype">double</span>[nnz_count];</div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160; </div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;        <span class="comment">// post the sends and recvs for the matrix data</span></div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;        Vector&lt;MPI_Request&gt; recv_req;</div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;        Vector&lt;MPI_Request&gt; send_req;</div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;        MPI_Aint base_address;</div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;        MPI_Get_address(global_value, &amp;base_address);</div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160; </div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;        <span class="comment">// SEND</span></div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;        <span class="keywordflow">if</span> (dist_nrow_local[my_rank] &gt; 0)</div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;        {</div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;          <span class="comment">// types</span></div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;          MPI_Datatype types[3];</div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160; </div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;          <span class="comment">// offsets</span></div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;          MPI_Aint offsets[3];</div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160; </div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;          <span class="comment">// lengths</span></div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;          <span class="keywordtype">int</span> len[3];</div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160; </div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;          <span class="comment">// row start</span></div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;          MPI_Type_contiguous(dist_nrow_local[my_rank], MPI_INT, &amp;types[0]);</div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;          MPI_Type_commit(&amp;types[0]);</div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;          MPI_Get_address(dist_row_start, &amp;offsets[0]);</div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;          offsets[0] -= base_address;</div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;          len[0] = 1;</div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160; </div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;          <span class="comment">// value</span></div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;          MPI_Type_contiguous(<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a9482dafc0a17ebc5b7431369d8d07565">nnz</a>, MPI_DOUBLE, &amp;types[1]);</div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;          MPI_Type_commit(&amp;types[1]);</div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;          MPI_Get_address(dist_value, &amp;offsets[1]);</div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;          offsets[1] -= base_address;</div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;          len[1] = 1;</div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160; </div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;          <span class="comment">// column indices</span></div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;          MPI_Type_contiguous(<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a9482dafc0a17ebc5b7431369d8d07565">nnz</a>, MPI_INT, &amp;types[2]);</div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;          MPI_Type_commit(&amp;types[2]);</div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;          MPI_Get_address(dist_column_index, &amp;offsets[2]);</div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;          offsets[2] -= base_address;</div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;          len[2] = 1;</div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160; </div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;          <span class="comment">// build the send type</span></div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;          MPI_Datatype send_type;</div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;          MPI_Type_create_struct(3, len, offsets, types, &amp;send_type);</div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;          MPI_Type_commit(&amp;send_type);</div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;          MPI_Type_free(&amp;types[0]);</div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;          MPI_Type_free(&amp;types[1]);</div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;          MPI_Type_free(&amp;types[2]);</div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160; </div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;          <span class="comment">// and send</span></div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> = 0; <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> &lt; nproc; <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>++)</div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;          {</div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> != my_rank)</div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;            {</div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;              MPI_Request req;</div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;              MPI_Isend(global_value,</div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;                        1,</div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;                        send_type,</div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;                        <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>,</div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;                        1,</div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;                        this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>()-&gt;communicator_pt()-&gt;mpi_comm(),</div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;                        &amp;req);</div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;              send_req.push_back(req);</div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;            }</div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;          }</div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;          MPI_Type_free(&amp;send_type);</div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;        }</div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160; </div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;        <span class="comment">// RECV</span></div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> = 0; <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> &lt; nproc; <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>++)</div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;        {</div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;          <span class="comment">// communicated with other processors</span></div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> != my_rank)</div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;          {</div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;            <span class="comment">// RECV</span></div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;            <span class="keywordflow">if</span> (dist_nrow_local[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] &gt; 0)</div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;            {</div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;              <span class="comment">// types</span></div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;              MPI_Datatype types[3];</div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160; </div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;              <span class="comment">// offsets</span></div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;              MPI_Aint offsets[3];</div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160; </div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;              <span class="comment">// lengths</span></div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;              <span class="keywordtype">int</span> len[3];</div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160; </div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;              <span class="comment">// row start</span></div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;              MPI_Type_contiguous(dist_nrow_local[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>], MPI_INT, &amp;types[0]);</div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;              MPI_Type_commit(&amp;types[0]);</div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;              MPI_Get_address(global_row_start + dist_first_row[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>],</div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;                              &amp;offsets[0]);</div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;              offsets[0] -= base_address;</div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;              len[0] = 1;</div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160; </div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;              <span class="comment">// value</span></div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;              MPI_Type_contiguous(dist_nnz_pt[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>], MPI_DOUBLE, &amp;types[1]);</div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;              MPI_Type_commit(&amp;types[1]);</div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;              MPI_Get_address(global_value + nnz_offset[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>], &amp;offsets[1]);</div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;              offsets[1] -= base_address;</div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;              len[1] = 1;</div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160; </div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;              <span class="comment">// column indices</span></div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;              MPI_Type_contiguous(dist_nnz_pt[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>], MPI_INT, &amp;types[2]);</div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;              MPI_Type_commit(&amp;types[2]);</div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;              MPI_Get_address(global_column_index + nnz_offset[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>], &amp;offsets[2]);</div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;              offsets[2] -= base_address;</div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;              len[2] = 1;</div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160; </div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;              <span class="comment">// build the send type</span></div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;              MPI_Datatype recv_type;</div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;              MPI_Type_create_struct(3, len, offsets, types, &amp;recv_type);</div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;              MPI_Type_commit(&amp;recv_type);</div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;              MPI_Type_free(&amp;types[0]);</div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;              MPI_Type_free(&amp;types[1]);</div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;              MPI_Type_free(&amp;types[2]);</div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160; </div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;              <span class="comment">// and send</span></div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;              MPI_Request req;</div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;              MPI_Irecv(global_value,</div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;                        1,</div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;                        recv_type,</div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;                        <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>,</div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;                        1,</div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;                        this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>()-&gt;communicator_pt()-&gt;mpi_comm(),</div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;                        &amp;req);</div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;              recv_req.push_back(req);</div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;              MPI_Type_free(&amp;recv_type);</div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;            }</div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;          }</div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;          <span class="comment">// otherwise send to self</span></div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;          {</div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;            <span class="keywordtype">unsigned</span> <a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">nrow_local</a> = dist_nrow_local[my_rank];</div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;            <span class="keywordtype">unsigned</span> <a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ab00a3919b8634c698749f14a4d92947d">first_row</a> = dist_first_row[my_rank];</div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">nrow_local</a>; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;            {</div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;              global_row_start[<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ab00a3919b8634c698749f14a4d92947d">first_row</a> + <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = dist_row_start[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;            }</div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;            <span class="keywordtype">unsigned</span> offset = nnz_offset[my_rank];</div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a9482dafc0a17ebc5b7431369d8d07565">nnz</a>; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;            {</div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;              global_value[offset + <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = dist_value[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;              global_column_index[offset + <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = dist_column_index[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;            }</div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;          }</div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;        }</div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160; </div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;        <span class="comment">// wait for all recvs to complete</span></div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;        <span class="keywordtype">unsigned</span> n_recv_req = recv_req.size();</div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;        <span class="keywordflow">if</span> (n_recv_req &gt; 0)</div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;        {</div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;          Vector&lt;MPI_Status&gt; recv_status(n_recv_req);</div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;          MPI_Waitall(n_recv_req, &amp;recv_req[0], &amp;recv_status[0]);</div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;        }</div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160; </div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;        <span class="comment">// finally the last row start</span></div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;        global_row_start[<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#abd8d231b0549540144b4739a667b1e75">nrow</a>] = nnz_count;</div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160; </div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;        <span class="comment">// update the other row start</span></div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> = 0; <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> &lt; nproc; <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>++)</div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;        {</div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; dist_nrow_local[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>]; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;          {</div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;            <span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = dist_first_row[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] + <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;            global_row_start[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>] += nnz_offset[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>];</div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;          }</div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;        }</div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160; </div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;        <span class="comment">// wait for sends to complete</span></div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;        <span class="keywordtype">unsigned</span> n_send_req = send_req.size();</div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;        <span class="keywordflow">if</span> (n_recv_req &gt; 0)</div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;        {</div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;          Vector&lt;MPI_Status&gt; send_status(n_recv_req);</div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;          MPI_Waitall(n_send_req, &amp;send_req[0], &amp;send_status[0]);</div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;        }</div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160; </div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;        <span class="comment">// rebuild the matrix</span></div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;        LinearAlgebraDistribution* dist_pt = <span class="keyword">new</span> LinearAlgebraDistribution(</div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;          this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>()-&gt;communicator_pt(), <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#abd8d231b0549540144b4739a667b1e75">nrow</a>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;        this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#af44bac2acd071317f96dae49cbb0d977">build</a>(dist_pt);</div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;        this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aafb4d7de0a87b4bda560928e6a128060">build_without_copy</a>(</div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;          ncol, nnz_count, global_value, global_column_index, global_row_start);</div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160; </div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;        <span class="comment">// clean up</span></div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;        <span class="keyword">delete</span> dist_pt;</div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;        <span class="keyword">delete</span>[] dist_first_row;</div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;        <span class="keyword">delete</span>[] dist_nrow_local;</div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;        <span class="keyword">delete</span>[] dist_nnz_pt;</div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;      }</div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160; </div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;      <span class="comment">// other the matrix is not distributed but it needs to be turned</span></div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;      <span class="comment">// into a distributed matrix</span></div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;      <span class="comment">// =============================================================</span></div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a5505731e7e73d7e4251c67c7adec6bf5">distributed</a>() &amp;&amp; dist_pt-&gt;distributed())</div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;      {</div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;        <span class="comment">// cache the new nrow_local</span></div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;        <span class="keywordtype">unsigned</span> <a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">nrow_local</a> = dist_pt-&gt;nrow_local();</div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160; </div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;        <span class="comment">// and first_row</span></div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;        <span class="keywordtype">unsigned</span> <a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ab00a3919b8634c698749f14a4d92947d">first_row</a> = dist_pt-&gt;first_row();</div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160; </div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;        <span class="comment">// get pointers to the (current) distributed data</span></div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;        <span class="keywordtype">int</span>* global_row_start = this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start</a>();</div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;        <span class="keywordtype">int</span>* global_column_index = this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a21b3dbb8ee74e1247f80ce4506c395f8">column_index</a>();</div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;        <span class="keywordtype">double</span>* global_value = this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab8220b7c2bb763dab32a4d0fea7da6f4">value</a>();</div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160; </div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;        <span class="comment">// determine the number of non zeros required by this processor</span></div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;        <span class="keywordtype">unsigned</span> nnz = global_row_start[<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ab00a3919b8634c698749f14a4d92947d">first_row</a> + <a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">nrow_local</a>] -</div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;                       global_row_start[<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ab00a3919b8634c698749f14a4d92947d">first_row</a>];</div>
<div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160; </div>
<div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;        <span class="comment">// allocate</span></div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;        <span class="keywordtype">int</span>* dist_row_start = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">nrow_local</a> + 1];</div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;        <span class="keywordtype">int</span>* dist_column_index = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a9482dafc0a17ebc5b7431369d8d07565">nnz</a>];</div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;        <span class="keywordtype">double</span>* dist_value = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a9482dafc0a17ebc5b7431369d8d07565">nnz</a>];</div>
<div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160; </div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;        <span class="comment">// copy</span></div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;        <span class="keywordtype">int</span> offset = global_row_start[<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ab00a3919b8634c698749f14a4d92947d">first_row</a>];</div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;= <a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">nrow_local</a>; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;        {</div>
<div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;          dist_row_start[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = global_row_start[<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ab00a3919b8634c698749f14a4d92947d">first_row</a> + <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] - offset;</div>
<div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;        }</div>
<div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a9482dafc0a17ebc5b7431369d8d07565">nnz</a>; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;        {</div>
<div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;          dist_column_index[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = global_column_index[offset + <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;          dist_value[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = global_value[offset + <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;        }</div>
<div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160; </div>
<div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;        <span class="comment">// rebuild</span></div>
<div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;        this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#af44bac2acd071317f96dae49cbb0d977">build</a>(dist_pt);</div>
<div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;        this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aafb4d7de0a87b4bda560928e6a128060">build_without_copy</a>(</div>
<div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;          ncol, <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a9482dafc0a17ebc5b7431369d8d07565">nnz</a>, dist_value, dist_column_index, dist_row_start);</div>
<div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;      }</div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;    }</div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1LinearAlgebraDistribution_html_aafad0b69de2284808366b65bd63e493b"><div class="ttname"><a href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#aafad0b69de2284808366b65bd63e493b">oomph::LinearAlgebraDistribution::nrow</a></div><div class="ttdeci">unsigned nrow() const</div><div class="ttdoc">access function to the number of global rows.</div><div class="ttdef"><b>Definition:</b> linear_algebra_distribution.h:186</div></div>
<div class="ttc" id="aclassoomph_1_1OomphCommunicator_html_a670b34aab05bfe0b96d0e0fabf583c7a"><div class="ttname"><a href="../../de/d83/classoomph_1_1OomphCommunicator.html#a670b34aab05bfe0b96d0e0fabf583c7a">oomph::OomphCommunicator::my_rank</a></div><div class="ttdeci">int my_rank() const</div><div class="ttdoc">my rank</div><div class="ttdef"><b>Definition:</b> communicator.h:176</div></div>
<div class="ttc" id="adatatypes_8h_html_ac6afabdc09a49a433ee19d8a9486056d"><div class="ttname"><a href="../../dc/d51/datatypes_8h.html#ac6afabdc09a49a433ee19d8a9486056d">min</a></div><div class="ttdeci">#define min(a, b)</div><div class="ttdef"><b>Definition:</b> datatypes.h:22</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#af44bac2acd071317f96dae49cbb0d977">build()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aafb4d7de0a87b4bda560928e6a128060">build_without_copy()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aa0503bc64ef0ccb60cb7d7e645425a62">built()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a21b3dbb8ee74e1247f80ce4506c395f8">column_index()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a2e4736826a65253f574d4f6f152ab514">oomph::LinearAlgebraDistribution::communicator_pt()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a05842d032d28880ae37951deae804ad8">oomph::LinearAlgebraDistribution::distributed()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a5505731e7e73d7e4251c67c7adec6bf5">oomph::DistributableLinearAlgebraObject::distributed()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">oomph::DistributableLinearAlgebraObject::distribution_pt()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a2634e540a78fe1ee3f5c907aff500b58">oomph::LinearAlgebraDistribution::first_row()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ab00a3919b8634c698749f14a4d92947d">oomph::DistributableLinearAlgebraObject::first_row()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>, <a class="el" href="../../dc/d51/datatypes_8h.html#affe776513b24d84b39af8ab0930fef7f">max</a>, <a class="el" href="../../dc/d51/datatypes_8h.html#ac6afabdc09a49a433ee19d8a9486056d">min</a>, <a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a670b34aab05bfe0b96d0e0fabf583c7a">oomph::OomphCommunicator::my_rank()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a4ed5597d8a34dd14f90b0e6cfb88ca2e">ncol()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a9482dafc0a17ebc5b7431369d8d07565">nnz()</a>, <a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a6c78c72666f4b102c2bccf200f0853b7">oomph::OomphCommunicator::nproc()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#aafad0b69de2284808366b65bd63e493b">oomph::LinearAlgebraDistribution::nrow()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#abd8d231b0549540144b4739a667b1e75">nrow()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">oomph::LinearAlgebraDistribution::nrow_local()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">oomph::DistributableLinearAlgebraObject::nrow_local()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start()</a>, and <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab8220b7c2bb763dab32a4d0fea7da6f4">value()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d95/namespaceoomph_1_1CRDoubleMatrixHelpers.html#ae3c10e59d5857457c7e34be8e9262035">oomph::CRDoubleMatrixHelpers::create_uniformly_distributed_matrix()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a4e59f1c854d1258aa2b4eca218405731">oomph::Problem::get_eigenproblem_matrices()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aab9533075d11b251636fa1c3a544dba7">oomph::Problem::get_jacobian()</a>.</p>

</div>
</div>
<a id="a25f1efd00318183abd8c65efede3f3f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25f1efd00318183abd8c65efede3f3f4">&#9670;&nbsp;</a></span>row_start() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a>* oomph::CRDoubleMatrix::row_start </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Access to C-style row_start array. </p>
<div class="fragment"><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    {</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a>.<a class="code" href="../../d4/def/classoomph_1_1CRMatrix.html#a6210ebb3d384de9c3a289f5d841a0d7a">row_start</a>();</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a>, and <a class="el" href="../../d4/def/classoomph_1_1CRMatrix.html#a6210ebb3d384de9c3a289f5d841a0d7a">oomph::CRMatrix&lt; T &gt;::row_start()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a57f88253acfa87a764652c06c1bdc362">add()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#af44bac2acd071317f96dae49cbb0d977">build()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aafb4d7de0a87b4bda560928e6a128060">build_without_copy()</a>, <a class="el" href="../../dd/d95/namespaceoomph_1_1CRDoubleMatrixHelpers.html#ab7e3ac344aa644292a143a3917a03e65">oomph::CRDoubleMatrixHelpers::concatenate()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#af88437afe2b838fd6b508c590d26bd26">CRDoubleMatrix()</a>, <a class="el" href="../../d1/d35/namespaceoomph_1_1TrilinosEpetraHelpers.html#a0a8d24c6cf06d8c71bb414c153a276cf">oomph::TrilinosEpetraHelpers::create_distributed_epetra_matrix()</a>, <a class="el" href="../../d1/d35/namespaceoomph_1_1TrilinosEpetraHelpers.html#a1b96bb02b661a770a7b5830af771a249">oomph::TrilinosEpetraHelpers::create_distributed_epetra_matrix_for_aztecoo()</a>, <a class="el" href="../../d6/dc6/namespaceoomph_1_1HypreHelpers.html#a3c7d0df9c9c2ce939e071a16716d7734">oomph::HypreHelpers::create_HYPRE_Matrix()</a>, <a class="el" href="../../dd/d95/namespaceoomph_1_1CRDoubleMatrixHelpers.html#a157511f700993ab8bc014f9d0d44f4c7">oomph::CRDoubleMatrixHelpers::deep_copy()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ae35fbae1702bbf75601c2a1026df103e">entries_are_sorted()</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#aeab520bd25edb0f4e88feaedec689333">oomph::MumpsSolver::factorise()</a>, <a class="el" href="../../d7/db1/classoomph_1_1SuperLUSolver.html#a6b1ce356d11fa878315e9b32ac566748">oomph::SuperLUSolver::factorise_serial()</a>, <a class="el" href="../../dd/d95/namespaceoomph_1_1CRDoubleMatrixHelpers.html#a02b5962dbe2bbfb93f54b668100afffc">oomph::CRDoubleMatrixHelpers::gershgorin_eigenvalue_estimate()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a82cb428139f7c35a7c62a09fad38eecb">get_matrix_transpose()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a984602c9df0c573451f315a025820ced">global_matrix()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a6cd938ba5f026f1508239cef05b16cb4">inf_norm()</a>, <a class="el" href="../../dd/d95/namespaceoomph_1_1CRDoubleMatrixHelpers.html#ab17222c9461096e3d5b8cf6250524644">oomph::CRDoubleMatrixHelpers::inf_norm()</a>, <a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a4f714d01cd2fdb791aa0795f34b9610a">oomph::BlockPreconditioner&lt; MATRIX &gt;::internal_get_block()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a3853068b7fce9e83bc817930262e9ca1">matrix_reduction()</a>, <a class="el" href="../../dc/d2e/classoomph_1_1MGSolver.html#ad31f3a5daa8edec01ab20c92e5fcca54">oomph::MGSolver&lt; DIM &gt;::modify_restriction_matrices()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a54b75960df52e3aebd21aaab20e9869d">multiply()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a42fb274c98ccf4c2a542ca15343fcc0e">multiply_transpose()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a9ba295a04e08e3153ae06bc0556f507d">redistribute()</a>, <a class="el" href="../../d8/d35/classoomph_1_1MatrixBasedLumpedPreconditioner.html#a0942572dde419e2658226ebc6e0d5dfd">oomph::MatrixBasedLumpedPreconditioner&lt; MATRIX &gt;::setup()</a>, <a class="el" href="../../de/dc5/classoomph_1_1ILUZeroPreconditioner_3_01CRDoubleMatrix_01_4.html#a2398a8674540bfdb8d69a699085107d8">oomph::ILUZeroPreconditioner&lt; CRDoubleMatrix &gt;::setup()</a>, <a class="el" href="../../d5/da4/classoomph_1_1PseudoElasticPreconditionerSubsidiaryPreconditionerOld.html#a532201f17edc43b3b475fff2d2744b8b">oomph::PseudoElasticPreconditionerSubsidiaryPreconditionerOld::setup()</a>, <a class="el" href="../../da/d32/classoomph_1_1HelmholtzMGPreconditioner.html#a2436c6189b4cda832bf28471f4f9e23c">oomph::HelmholtzMGPreconditioner&lt; DIM &gt;::setup_coarsest_level_structures()</a>, <a class="el" href="../../dc/df6/classoomph_1_1GS_3_01CRDoubleMatrix_01_4.html#a12a720316ec6fde47e0fa524bd8728b1">oomph::GS&lt; CRDoubleMatrix &gt;::solve_helper()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a2107875787d4dfa1cf007c05a041b078">sort_entries()</a>, and <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a2b5dcdc5e1b9ccea51647f02b3239e66">sparse_indexed_output_with_offset()</a>.</p>

</div>
</div>
<a id="a9c7f058048764537f4d4ecadded5dd7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c7f058048764537f4d4ecadded5dd7c">&#9670;&nbsp;</a></span>row_start() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a>* oomph::CRDoubleMatrix::row_start </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Access to C-style row_start array (const version) </p>
<div class="fragment"><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    {</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a>.<a class="code" href="../../d4/def/classoomph_1_1CRMatrix.html#a6210ebb3d384de9c3a289f5d841a0d7a">row_start</a>();</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a>, and <a class="el" href="../../d4/def/classoomph_1_1CRMatrix.html#a6210ebb3d384de9c3a289f5d841a0d7a">oomph::CRMatrix&lt; T &gt;::row_start()</a>.</p>

</div>
</div>
<a id="aa09d92094d0ccf281dded547edfc981e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa09d92094d0ccf281dded547edfc981e">&#9670;&nbsp;</a></span>serial_matrix_matrix_multiply_method() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&amp; oomph::CRDoubleMatrix::serial_matrix_matrix_multiply_method </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Access function to Serial_matrix_matrix_multiply_method, the flag which determines the matrix matrix multiplication method used for serial matrices. Method 1: First runs through this matrix and matrix_in to find the storage requirements for result - arrays of the correct size are then allocated before performing the calculation. Minimises memory requirements but more costly. Method 2: Grows storage for values and column indices of result 'on the fly' using an array of maps. Faster but more memory intensive. Method 3: Grows storage for values and column indices of result 'on the fly' using a vector of vectors. Not particularly impressive on the platforms we tried... Method 4: Trilinos Epetra Matrix Matrix multiply. Method 5: Trilinos Epetra Matrix Matrix multiply (ML based). </p>
<div class="fragment"><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    {</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ac8fab9824a0766b6bb6361a6b25df9ce">Serial_matrix_matrix_multiply_method</a>;</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ac8fab9824a0766b6bb6361a6b25df9ce">Serial_matrix_matrix_multiply_method</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d95/namespaceoomph_1_1CRDoubleMatrixHelpers.html#a157511f700993ab8bc014f9d0d44f4c7">oomph::CRDoubleMatrixHelpers::deep_copy()</a>, and <a class="el" href="../../da/d85/matrix__multiply__test_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main()</a>.</p>

</div>
</div>
<a id="ae8eff79ad9ac6e399ef4b677b6e0e1e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8eff79ad9ac6e399ef4b677b6e0e1e5">&#9670;&nbsp;</a></span>serial_matrix_matrix_multiply_method() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&amp; oomph::CRDoubleMatrix::serial_matrix_matrix_multiply_method </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Read only access function (const version) to Serial_matrix_matrix_multiply_method, the flag which determines the matrix matrix multiplication method used for serial matrices. Method 1: First runs through this matrix and matrix_in to find the storage requirements for result - arrays of the correct size are then allocated before performing the calculation. Minimises memory requirements but more costly. Method 2: Grows storage for values and column indices of result 'on the fly' using an array of maps. Faster but more memory intensive. Method 3: Grows storage for values and column indices of result 'on the fly' using a vector of vectors. Not particularly impressive on the platforms we tried... Method 4: Trilinos Epetra Matrix Matrix multiply. Method 5: Trilinos Epetra Matrix Matrix multiply (ML based). </p>
<div class="fragment"><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    {</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ac8fab9824a0766b6bb6361a6b25df9ce">Serial_matrix_matrix_multiply_method</a>;</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ac8fab9824a0766b6bb6361a6b25df9ce">Serial_matrix_matrix_multiply_method</a>.</p>

</div>
</div>
<a id="a2107875787d4dfa1cf007c05a041b078"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2107875787d4dfa1cf007c05a041b078">&#9670;&nbsp;</a></span>sort_entries()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::CRDoubleMatrix::sort_entries </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sorts the entries associated with each row of the matrix in the column index vector and the value vector into ascending order and sets up the Index_of_diagonal_entries vector</p>
<p>This helper function sorts the entries in the column index vector and the value vector. During the construction of the matrix the entries were most likely assigned in an arbitrary order. As a result, it cannot be assumed that the entries in the column index vector corresponding to each row of the matrix have been arranged in increasing order. During the setup an additional vector will be set up; Index_of_diagonal_entries. The i-th entry of this vector contains the index of the last entry below or on the diagonal. If there are no entries below or on the diagonal then the corresponding entry is -1. If, however, there are no entries in the row then the entry is irrelevant and is kept as the initialised value; 0. </p>
<div class="fragment"><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;  {</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;    <span class="comment">// We only need to produce a warning if the matrix is distributed</span></div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a5505731e7e73d7e4251c67c7adec6bf5">distributed</a>())</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    {</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;      <span class="comment">// Create an ostringstream object to store the warning message</span></div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;      std::ostringstream warning_message;</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160; </div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;      <span class="comment">// Create the warning messsage</span></div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;      warning_message &lt;&lt; <span class="stringliteral">&quot;This method currently works for serial but &quot;</span></div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;has not been tested with MPI!\n&quot;</span>;</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160; </div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;      <span class="comment">// Issue the warning</span></div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;      OomphLibWarning(warning_message.str(),</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;                      <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;                      <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    }</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160; </div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;    <span class="comment">// Get the number of rows in the matrix</span></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    <span class="keywordtype">unsigned</span> n_rows = this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#abd8d231b0549540144b4739a667b1e75">nrow</a>();</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160; </div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;    <span class="comment">// Acquire access to the value, row_start and column_index arrays from</span></div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;    <span class="comment">// the CR matrix. Since we do not change anything in row_start_pt we</span></div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    <span class="comment">// give it the const prefix</span></div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;    <span class="keywordtype">double</span>* value_pt = this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab8220b7c2bb763dab32a4d0fea7da6f4">value</a>();</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;    <span class="keywordtype">int</span>* column_index_pt = this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a21b3dbb8ee74e1247f80ce4506c395f8">column_index</a>();</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span>* row_start_pt = this-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start</a>();</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160; </div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;    <span class="comment">// Resize the Index_of_diagonal_entries vector</span></div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;    <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a6cb9860ebacf742fc7fc47d77703cc82">Index_of_diagonal_entries</a>.resize(n_rows, 0);</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160; </div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    <span class="comment">// Vector of pairs to store the column_index of each value in the i-th row</span></div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    <span class="comment">// and its corresponding matrix entry</span></div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    Vector&lt;std::pair&lt;int, double&gt;&gt; column_index_and_value_row_i;</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160; </div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;    <span class="comment">// Loop over the rows of the matrix</span></div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_rows; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    {</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;      <span class="comment">// Find the number of nonzeros in the i-th row</span></div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;      <span class="keywordtype">unsigned</span> nnz_row_i = *(row_start_pt + <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1) - *(row_start_pt + <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160; </div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;      <span class="comment">// Variable to store the start of the i-th row</span></div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;      <span class="keywordtype">unsigned</span> i_row_start = *(row_start_pt + <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160; </div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;      <span class="comment">// If there are no nonzeros in this row then the i-th entry of the vector</span></div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;      <span class="comment">// Index_of_diagonal_entries is irrelevant so we can simply let it be 0</span></div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;      <span class="keywordflow">if</span> (nnz_row_i == 0)</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;      {</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;        <span class="comment">// Set the i-th entry</span></div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;        <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a6cb9860ebacf742fc7fc47d77703cc82">Index_of_diagonal_entries</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = 0;</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;      }</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;      <span class="comment">// If there are nonzeros in the i-th row</span></div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;      {</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;        <span class="comment">// If there is more than one entry in the row resize the vector</span></div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;        <span class="comment">// column_index_and_value_row_i</span></div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;        column_index_and_value_row_i.resize(nnz_row_i);</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160; </div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;        <span class="comment">// Loop over the entries in the row</span></div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; nnz_row_i; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;        {</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;          <span class="comment">// Assign the appropriate entries to column_index_and_value_row_i</span></div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;          column_index_and_value_row_i[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>] =</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;            std::make_pair(*(column_index_pt + i_row_start + <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>),</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;                           *(value_pt + i_row_start + <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>));</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;        }</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160; </div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;        <span class="comment">// Sort the vector of pairs using the struct</span></div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;        <span class="comment">// CRDoubleMatrixComparisonHelper</span></div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;        std::sort(column_index_and_value_row_i.begin(),</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;                  column_index_and_value_row_i.end(),</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;                  <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a37d76ad3814e127802b80e1e274a3f15">Comparison_struct</a>);</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160; </div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;        <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;        <span class="comment">// Now that the entries of the i-th row have been sorted we can read</span></div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;        <span class="comment">// them back into value_pt and column_index_pt:</span></div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;        <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160; </div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;        <span class="comment">// Create a boolean variable to indicate whether or not the i-th entry</span></div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;        <span class="comment">// of Index_of_diagonal_entries has been set</span></div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;        <span class="keywordtype">bool</span> is_ith_entry_set = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160; </div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;        <span class="comment">// Loop over the entries in the vector column_index_and_value_row_i and</span></div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;        <span class="comment">// assign its entries to value_pt and column_index_pt</span></div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; nnz_row_i; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;        {</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;          <span class="comment">// Set the column index of the j-th nonzero value in the i-th row of</span></div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;          <span class="comment">// the matrix</span></div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;          *(column_index_pt + i_row_start + <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) =</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;            column_index_and_value_row_i[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>].first;</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160; </div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;          <span class="comment">// Set the value of the j-th nonzero value in the i-th row of</span></div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;          <span class="comment">// the matrix</span></div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;          *(value_pt + i_row_start + <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) =</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;            column_index_and_value_row_i[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>].second;</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160; </div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;          <span class="comment">// This if statement is used to set the i-th entry of the vector</span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;          <span class="comment">// Index_of_diagonal_entries if it has not yet been set</span></div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;          <span class="keywordflow">if</span> (!is_ith_entry_set)</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;          {</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;            <span class="comment">// If the column index of the first entry in row i is greater than</span></div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;            <span class="comment">// the row number then the first entry must lie above the diagonal</span></div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;            <span class="keywordflow">if</span> (<span class="keywordtype">unsigned</span>(*(column_index_pt + i_row_start)) &gt; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;            {</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;              <span class="comment">// If the column index of the first entry in the row is greater</span></div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;              <span class="comment">// than the row number, i, then the i-th entry of</span></div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;              <span class="comment">// Index_of_diagonal_entries needs to be set to -1 to indicate</span></div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;              <span class="comment">// there are no entries below or on the diagonal</span></div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;              <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a6cb9860ebacf742fc7fc47d77703cc82">Index_of_diagonal_entries</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = -1;</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160; </div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;              <span class="comment">// Indicate that the i-th entry of Index_of_diagonal_entries has</span></div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;              <span class="comment">// been set</span></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;              is_ith_entry_set = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;            }</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;            <span class="comment">// If there are entries below or on the diagonal</span></div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;            {</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;              <span class="comment">// If there is only one entry in the row then we know that this</span></div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;              <span class="comment">// will be the last entry below or on the diagonal because we have</span></div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;              <span class="comment">// eliminated the possibility that if there is only one entry,</span></div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;              <span class="comment">// that it lies above the diagonal</span></div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;              <span class="keywordflow">if</span> (nnz_row_i == 1)</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;              {</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;                <span class="comment">// Set the index of the current entry to be the value of i-th</span></div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;                <span class="comment">// entry of Index_of_diagonal_entries</span></div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;                <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a6cb9860ebacf742fc7fc47d77703cc82">Index_of_diagonal_entries</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = i_row_start + <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>;</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160; </div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;                <span class="comment">// Indicate that the i-th entry of Index_of_diagonal_entries has</span></div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;                <span class="comment">// been set</span></div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;                is_ith_entry_set = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;              }</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;              <span class="comment">// It remains to now check the case that there is more than one</span></div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;              <span class="comment">// entry in the row. If there is more than one entry in the row</span></div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;              <span class="comment">// and there are entries below or on the diagonal then we have</span></div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;              <span class="comment">// three cases:</span></div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;              <span class="comment">//          (1) The current entry lies on the diagonal;</span></div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;              <span class="comment">//          (2) The current entry lies above the diagonal;</span></div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;              <span class="comment">//          (3) The current entry lies below the diagonal;</span></div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;              <span class="comment">// The first case can easily be checked as done below. If the</span></div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;              <span class="comment">// second case occurs then we have just passed the last entry. We</span></div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;              <span class="comment">// know this because at least one entry lies on or below the</span></div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;              <span class="comment">// diagonal. If the second case it true then we need to assign the</span></div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;              <span class="comment">// previous entry to the vector Index_of_diagonal_entries.</span></div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;              <span class="comment">// Finally, we are left with case (3), which can be split into two</span></div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;              <span class="comment">// cases:</span></div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;              <span class="comment">//          (3.1) The current entry lies below the diagonal but it</span></div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;              <span class="comment">//                is not the last entry below or on the diagonal;</span></div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;              <span class="comment">//          (3.2) The current entry lies below the diagonal and is</span></div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;              <span class="comment">//                the last entry below or on the diagonal.</span></div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;              <span class="comment">// If case (3.1) holds then we can simply wait until we get to the</span></div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;              <span class="comment">// next entry in the row and examine that. If the next entry lies</span></div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;              <span class="comment">// on the diagonal then it will be swept up by case (1). If the</span></div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;              <span class="comment">// next entry lies above the diagonal then case (2) will sweep it</span></div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;              <span class="comment">// up and if neither is the case then we wait until the next entry</span></div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;              <span class="comment">// and so on. If, instead, case (3.2) holds then our last check</span></div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;              <span class="comment">// simply needs to check if the current entry is the last entry in</span></div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;              <span class="comment">// the row because if the last entry lies on the diagonal, case</span></div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;              <span class="comment">// (1) will sweep it up. If it lies above the diagonal, case (2)</span></div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;              <span class="comment">// will take care of it. Therefore, the only remaining case is</span></div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;              <span class="comment">// that it lies strictly below the diagonal and since it is the</span></div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;              <span class="comment">// last entry in the row it means the index of this entry needs to</span></div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;              <span class="comment">// be assigned to Index_of_diagonal_entries</span></div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160; </div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;              <span class="comment">// Case (1) : The current entry lies on the diagonal</span></div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keywordtype">unsigned</span>(*(column_index_pt + i_row_start + <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>)) == <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;              {</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;                <span class="comment">// Set the index of the current entry to be the value of i-th</span></div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;                <span class="comment">// entry of Index_of_diagonal_entries</span></div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;                <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a6cb9860ebacf742fc7fc47d77703cc82">Index_of_diagonal_entries</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = i_row_start + <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>;</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160; </div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;                <span class="comment">// Indicate that the i-th entry of Index_of_diagonal_entries has</span></div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;                <span class="comment">// been set</span></div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;                is_ith_entry_set = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;              }</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;              <span class="comment">// Case (2) : The current entry lies above the diagonal</span></div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keywordtype">unsigned</span>(*(column_index_pt + i_row_start + <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>)) &gt; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;              {</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;                <span class="comment">// Set the index of the current entry to be the value of i-th</span></div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;                <span class="comment">// entry of Index_of_diagonal_entries</span></div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;                <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a6cb9860ebacf742fc7fc47d77703cc82">Index_of_diagonal_entries</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = i_row_start + <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> - 1;</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160; </div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;                <span class="comment">// Indicate that the i-th entry of Index_of_diagonal_entries has</span></div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;                <span class="comment">// been set</span></div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;                is_ith_entry_set = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;              }</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;              <span class="comment">// Case (3.2) : The current entry is the last entry in the row</span></div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> == nnz_row_i - 1)</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;              {</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;                <span class="comment">// Set the index of the current entry to be the value of i-th</span></div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;                <span class="comment">// entry of Index_of_diagonal_entries</span></div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;                <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a6cb9860ebacf742fc7fc47d77703cc82">Index_of_diagonal_entries</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = i_row_start + <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>;</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160; </div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;                <span class="comment">// Indicate that the i-th entry of Index_of_diagonal_entries has</span></div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;                <span class="comment">// been set</span></div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;                is_ith_entry_set = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;              } <span class="comment">// if (nnz_row_i==1) else if</span></div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;            } <span class="comment">// if (*(column_index_pt+i_row_start)&gt;i)</span></div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;          } <span class="comment">// if (!is_ith_entry_set)</span></div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;        } <span class="comment">// for (unsigned j=0;j&lt;nnz_row_i;j++)</span></div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;      } <span class="comment">// if (nnz_row_i==0) else</span></div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;    } <span class="comment">// for (unsigned i=0;i&lt;n_rows;i++)</span></div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;  } <span class="comment">// End of sort_entries()</span></div>
<div class="ttc" id="aclassoomph_1_1CRDoubleMatrix_html_a37d76ad3814e127802b80e1e274a3f15"><div class="ttname"><a href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a37d76ad3814e127802b80e1e274a3f15">oomph::CRDoubleMatrix::Comparison_struct</a></div><div class="ttdeci">struct oomph::CRDoubleMatrix::CRDoubleMatrixComparisonHelper Comparison_struct</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a21b3dbb8ee74e1247f80ce4506c395f8">column_index()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a37d76ad3814e127802b80e1e274a3f15">Comparison_struct</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a5505731e7e73d7e4251c67c7adec6bf5">oomph::DistributableLinearAlgebraObject::distributed()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a6cb9860ebacf742fc7fc47d77703cc82">Index_of_diagonal_entries</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#abd8d231b0549540144b4739a667b1e75">nrow()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start()</a>, and <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab8220b7c2bb763dab32a4d0fea7da6f4">value()</a>.</p>

</div>
</div>
<a id="a468055aa2e36ff270a769a74c9ac2856"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a468055aa2e36ff270a769a74c9ac2856">&#9670;&nbsp;</a></span>sparse_indexed_output_helper()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::CRDoubleMatrix::sparse_indexed_output_helper </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>outfile</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Indexed output function to print a matrix to the stream outfile as i,j,a(i,j) for a(i,j)!=0 only. </p>

<p>Implements <a class="el" href="../../d6/d74/classoomph_1_1Matrix.html#a7a5b44e7688ce2c2f7552da104e615c8">oomph::Matrix&lt; double, CRDoubleMatrix &gt;</a>.</p>
<div class="fragment"><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    {</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;      <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a>.<a class="code" href="../../d4/def/classoomph_1_1CRMatrix.html#af34167172020d60e5fa382e4bd5d6466">sparse_indexed_output_helper</a>(outfile);</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1CRMatrix_html_af34167172020d60e5fa382e4bd5d6466"><div class="ttname"><a href="../../d4/def/classoomph_1_1CRMatrix.html#af34167172020d60e5fa382e4bd5d6466">oomph::CRMatrix::sparse_indexed_output_helper</a></div><div class="ttdeci">void sparse_indexed_output_helper(std::ostream &amp;outfile) const</div><div class="ttdef"><b>Definition:</b> matrices.h:828</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a>, and <a class="el" href="../../d4/def/classoomph_1_1CRMatrix.html#af34167172020d60e5fa382e4bd5d6466">oomph::CRMatrix&lt; T &gt;::sparse_indexed_output_helper()</a>.</p>

</div>
</div>
<a id="a2b5dcdc5e1b9ccea51647f02b3239e66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b5dcdc5e1b9ccea51647f02b3239e66">&#9670;&nbsp;</a></span>sparse_indexed_output_with_offset()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::CRDoubleMatrix::sparse_indexed_output_with_offset </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>filename</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Indexed output function to print a matrix to a file as i,j,a(i,j) for a(i,j)!=0 only. Specify filename. This uses acual global row numbers. </p>
<div class="fragment"><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    {</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;      <span class="comment">// Get offset</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;      <span class="keywordtype">unsigned</span> <a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ab00a3919b8634c698749f14a4d92947d">first_row</a> = <a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>()-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a2634e540a78fe1ee3f5c907aff500b58">first_row</a>();</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160; </div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;      <span class="comment">// Open file</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;      std::ofstream some_file;</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;      some_file.open(<a class="code" href="../../d5/db2/namespaceMergeRestartFiles.html#a210231ed06d822ca8be83bd7f75aa572">filename</a>.c_str());</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;      <span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = <a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">nrow_local</a>();</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;      {</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">long</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start</a>()[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start</a>()[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1]; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;        {</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;          some_file &lt;&lt; <a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ab00a3919b8634c698749f14a4d92947d">first_row</a> + <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a21b3dbb8ee74e1247f80ce4506c395f8">column_index</a>()[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                    &lt;&lt; <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab8220b7c2bb763dab32a4d0fea7da6f4">value</a>()[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>] &lt;&lt; std::endl;</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        }</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;      }</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;      some_file.close();</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1LinearAlgebraDistribution_html_a2634e540a78fe1ee3f5c907aff500b58"><div class="ttname"><a href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a2634e540a78fe1ee3f5c907aff500b58">oomph::LinearAlgebraDistribution::first_row</a></div><div class="ttdeci">unsigned first_row() const</div><div class="ttdef"><b>Definition:</b> linear_algebra_distribution.h:261</div></div>
<div class="ttc" id="anamespaceMergeRestartFiles_html_a210231ed06d822ca8be83bd7f75aa572"><div class="ttname"><a href="../../d5/db2/namespaceMergeRestartFiles.html#a210231ed06d822ca8be83bd7f75aa572">MergeRestartFiles.filename</a></div><div class="ttdeci">string filename</div><div class="ttdef"><b>Definition:</b> MergeRestartFiles.py:39</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a21b3dbb8ee74e1247f80ce4506c395f8">column_index()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">oomph::DistributableLinearAlgebraObject::distribution_pt()</a>, <a class="el" href="../../d5/db2/namespaceMergeRestartFiles.html#a210231ed06d822ca8be83bd7f75aa572">MergeRestartFiles::filename</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a2634e540a78fe1ee3f5c907aff500b58">oomph::LinearAlgebraDistribution::first_row()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ab00a3919b8634c698749f14a4d92947d">oomph::DistributableLinearAlgebraObject::first_row()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">oomph::DistributableLinearAlgebraObject::nrow_local()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start()</a>, and <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab8220b7c2bb763dab32a4d0fea7da6f4">value()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/da7/classoomph_1_1SpaceTimeNavierStokesSubsidiaryPreconditioner.html#a416c107b8095d5083b7a84775bae9881">oomph::SpaceTimeNavierStokesSubsidiaryPreconditioner::setup()</a>.</p>

</div>
</div>
<a id="ab8220b7c2bb763dab32a4d0fea7da6f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8220b7c2bb763dab32a4d0fea7da6f4">&#9670;&nbsp;</a></span>value() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a>* oomph::CRDoubleMatrix::value </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Access to C-style value array. </p>
<div class="fragment"><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    {</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a>.<a class="code" href="../../d6/d24/classoomph_1_1SparseMatrix.html#a3e382ff145082821a6b0b3e63b6aed5d">value</a>();</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a>, and <a class="el" href="../../d6/d24/classoomph_1_1SparseMatrix.html#a3e382ff145082821a6b0b3e63b6aed5d">oomph::SparseMatrix&lt; T, MATRIX_TYPE &gt;::value()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a57f88253acfa87a764652c06c1bdc362">add()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#af44bac2acd071317f96dae49cbb0d977">build()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aafb4d7de0a87b4bda560928e6a128060">build_without_copy()</a>, <a class="el" href="../../dd/d95/namespaceoomph_1_1CRDoubleMatrixHelpers.html#ab7e3ac344aa644292a143a3917a03e65">oomph::CRDoubleMatrixHelpers::concatenate()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#af88437afe2b838fd6b508c590d26bd26">CRDoubleMatrix()</a>, <a class="el" href="../../d1/d35/namespaceoomph_1_1TrilinosEpetraHelpers.html#a0a8d24c6cf06d8c71bb414c153a276cf">oomph::TrilinosEpetraHelpers::create_distributed_epetra_matrix()</a>, <a class="el" href="../../d1/d35/namespaceoomph_1_1TrilinosEpetraHelpers.html#a1b96bb02b661a770a7b5830af771a249">oomph::TrilinosEpetraHelpers::create_distributed_epetra_matrix_for_aztecoo()</a>, <a class="el" href="../../d6/dc6/namespaceoomph_1_1HypreHelpers.html#a3c7d0df9c9c2ce939e071a16716d7734">oomph::HypreHelpers::create_HYPRE_Matrix()</a>, <a class="el" href="../../dd/d95/namespaceoomph_1_1CRDoubleMatrixHelpers.html#a157511f700993ab8bc014f9d0d44f4c7">oomph::CRDoubleMatrixHelpers::deep_copy()</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#aeab520bd25edb0f4e88feaedec689333">oomph::MumpsSolver::factorise()</a>, <a class="el" href="../../d7/db1/classoomph_1_1SuperLUSolver.html#a6b1ce356d11fa878315e9b32ac566748">oomph::SuperLUSolver::factorise_serial()</a>, <a class="el" href="../../dd/d95/namespaceoomph_1_1CRDoubleMatrixHelpers.html#a02b5962dbe2bbfb93f54b668100afffc">oomph::CRDoubleMatrixHelpers::gershgorin_eigenvalue_estimate()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a82cb428139f7c35a7c62a09fad38eecb">get_matrix_transpose()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a984602c9df0c573451f315a025820ced">global_matrix()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a6cd938ba5f026f1508239cef05b16cb4">inf_norm()</a>, <a class="el" href="../../dd/d95/namespaceoomph_1_1CRDoubleMatrixHelpers.html#ab17222c9461096e3d5b8cf6250524644">oomph::CRDoubleMatrixHelpers::inf_norm()</a>, <a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a4f714d01cd2fdb791aa0795f34b9610a">oomph::BlockPreconditioner&lt; MATRIX &gt;::internal_get_block()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a3853068b7fce9e83bc817930262e9ca1">matrix_reduction()</a>, <a class="el" href="../../dc/d2e/classoomph_1_1MGSolver.html#ad31f3a5daa8edec01ab20c92e5fcca54">oomph::MGSolver&lt; DIM &gt;::modify_restriction_matrices()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a54b75960df52e3aebd21aaab20e9869d">multiply()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a42fb274c98ccf4c2a542ca15343fcc0e">multiply_transpose()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a9ba295a04e08e3153ae06bc0556f507d">redistribute()</a>, <a class="el" href="../../d8/d35/classoomph_1_1MatrixBasedLumpedPreconditioner.html#a0942572dde419e2658226ebc6e0d5dfd">oomph::MatrixBasedLumpedPreconditioner&lt; MATRIX &gt;::setup()</a>, <a class="el" href="../../de/dc5/classoomph_1_1ILUZeroPreconditioner_3_01CRDoubleMatrix_01_4.html#a2398a8674540bfdb8d69a699085107d8">oomph::ILUZeroPreconditioner&lt; CRDoubleMatrix &gt;::setup()</a>, <a class="el" href="../../d5/da4/classoomph_1_1PseudoElasticPreconditionerSubsidiaryPreconditionerOld.html#a532201f17edc43b3b475fff2d2744b8b">oomph::PseudoElasticPreconditionerSubsidiaryPreconditionerOld::setup()</a>, <a class="el" href="../../da/d32/classoomph_1_1HelmholtzMGPreconditioner.html#a2436c6189b4cda832bf28471f4f9e23c">oomph::HelmholtzMGPreconditioner&lt; DIM &gt;::setup_coarsest_level_structures()</a>, <a class="el" href="../../dc/df6/classoomph_1_1GS_3_01CRDoubleMatrix_01_4.html#a12a720316ec6fde47e0fa524bd8728b1">oomph::GS&lt; CRDoubleMatrix &gt;::solve_helper()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a2107875787d4dfa1cf007c05a041b078">sort_entries()</a>, and <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a2b5dcdc5e1b9ccea51647f02b3239e66">sparse_indexed_output_with_offset()</a>.</p>

</div>
</div>
<a id="a2b0895f75ec750c386f0dbc11bfbf57b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b0895f75ec750c386f0dbc11bfbf57b">&#9670;&nbsp;</a></span>value() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="../../df/de6/classdouble.html">double</a>* oomph::CRDoubleMatrix::value </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Access to C-style value array (const version) </p>
<div class="fragment"><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    {</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a>.<a class="code" href="../../d6/d24/classoomph_1_1SparseMatrix.html#a3e382ff145082821a6b0b3e63b6aed5d">value</a>();</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aefc9a269911694cdd5bde98dc536148f">CR_matrix</a>, and <a class="el" href="../../d6/d24/classoomph_1_1SparseMatrix.html#a3e382ff145082821a6b0b3e63b6aed5d">oomph::SparseMatrix&lt; T, MATRIX_TYPE &gt;::value()</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a63afd9976f0970a4e6ffee3755d21540"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63afd9976f0970a4e6ffee3755d21540">&#9670;&nbsp;</a></span>Built</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::CRDoubleMatrix::Built</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Flag to indicate whether the matrix has been built - i.e. the distribution has been setup AND the matrix has been assembled. </p>

<p class="reference">Referenced by <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ac04c0787a123256b3dbaf6acf40df4e2">build()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aafb4d7de0a87b4bda560928e6a128060">build_without_copy()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aa0503bc64ef0ccb60cb7d7e645425a62">built()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a70c8a67158c081e70b4d07a6b248bc7a">clear()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ad8914fa1a5a98f7602a1724b76eef26c">CRDoubleMatrix()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a4b90203edbcbfec4e5e1c79f7d8d2722">ludecompose()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a54b75960df52e3aebd21aaab20e9869d">multiply()</a>, and <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a42fb274c98ccf4c2a542ca15343fcc0e">multiply_transpose()</a>.</p>

</div>
</div>
<a id="a37d76ad3814e127802b80e1e274a3f15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37d76ad3814e127802b80e1e274a3f15">&#9670;&nbsp;</a></span>Comparison_struct</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d1/d96/structoomph_1_1CRDoubleMatrix_1_1CRDoubleMatrixComparisonHelper.html">oomph::CRDoubleMatrix::CRDoubleMatrixComparisonHelper</a> oomph::CRDoubleMatrix::Comparison_struct</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a2107875787d4dfa1cf007c05a041b078">sort_entries()</a>.</p>

</div>
</div>
<a id="aefc9a269911694cdd5bde98dc536148f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aefc9a269911694cdd5bde98dc536148f">&#9670;&nbsp;</a></span>CR_matrix</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/def/classoomph_1_1CRMatrix.html">CRMatrix</a>&lt;<a class="el" href="../../df/de6/classdouble.html">double</a>&gt; oomph::CRDoubleMatrix::CR_matrix</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Storage for the Matrix in CR Format. </p>

<p class="reference">Referenced by <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ac04c0787a123256b3dbaf6acf40df4e2">build()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aafb4d7de0a87b4bda560928e6a128060">build_without_copy()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a70c8a67158c081e70b4d07a6b248bc7a">clear()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a21b3dbb8ee74e1247f80ce4506c395f8">column_index()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a1f1ffece5cbd2d25d46fe3db3b9c3ff5">CRDoubleMatrix()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ad438e693468cd0ae179460eafcaab038">diagonal_entries()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a6cd938ba5f026f1508239cef05b16cb4">inf_norm()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a3853068b7fce9e83bc817930262e9ca1">matrix_reduction()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a54b75960df52e3aebd21aaab20e9869d">multiply()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a42fb274c98ccf4c2a542ca15343fcc0e">multiply_transpose()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a4ed5597d8a34dd14f90b0e6cfb88ca2e">ncol()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a9482dafc0a17ebc5b7431369d8d07565">nnz()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#af5b1d934bae618c92aa1089671b6130e">operator()()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab0887b5420752c47bfc14777006bcc1e">output_bottom_right_zero_helper()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">row_start()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a468055aa2e36ff270a769a74c9ac2856">sparse_indexed_output_helper()</a>, and <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab8220b7c2bb763dab32a4d0fea7da6f4">value()</a>.</p>

</div>
</div>
<a id="a4ab4056eff376d383c613a11082651cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ab4056eff376d383c613a11082651cb">&#9670;&nbsp;</a></span>Distributed_matrix_matrix_multiply_method</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> oomph::CRDoubleMatrix::Distributed_matrix_matrix_multiply_method</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Flag to determine which matrix-matrix multiplication method is used (for distributed matrices) </p>

<p class="reference">Referenced by <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a311cf35d030c6cc22b389c2542a4089c">distributed_matrix_matrix_multiply_method()</a>.</p>

</div>
</div>
<a id="a6cb9860ebacf742fc7fc47d77703cc82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cb9860ebacf742fc7fc47d77703cc82">&#9670;&nbsp;</a></span>Index_of_diagonal_entries</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt;<a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a>&gt; oomph::CRDoubleMatrix::Index_of_diagonal_entries</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Vector whose i'th entry contains the index of the last entry below or on the diagonal of the i'th row of the matrix </p>

<p class="reference">Referenced by <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a80c3342b36dbcdf60bb21676fda66c97">get_index_of_diagonal_entries()</a>, and <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a2107875787d4dfa1cf007c05a041b078">sort_entries()</a>.</p>

</div>
</div>
<a id="ac8fab9824a0766b6bb6361a6b25df9ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8fab9824a0766b6bb6361a6b25df9ce">&#9670;&nbsp;</a></span>Serial_matrix_matrix_multiply_method</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> oomph::CRDoubleMatrix::Serial_matrix_matrix_multiply_method</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Flag to determine which matrix-matrix multiplication method is used (for serial (or global) matrices) </p>

<p class="reference">Referenced by <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ad8914fa1a5a98f7602a1724b76eef26c">CRDoubleMatrix()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#af08fd73a7edbdbde9facf47b913e3e43">multiply()</a>, and <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aa09d92094d0ccf281dded547edfc981e">serial_matrix_matrix_multiply_method()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="../../d1/dd8/matrices_8h_source.html">matrices.h</a></li>
<li><a class="el" href="../../d8/d99/matrices_8cc.html">matrices.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../da/ddf/namespaceoomph.html">oomph</a></li><li class="navelem"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a></li>
    <li class="footer">Generated on Wed Aug 27 2025 17:09:07 for MercuryDPM by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
