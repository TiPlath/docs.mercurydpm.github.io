<!-- HTML header for doxygen 1.8.18-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MercuryDPM: Parameter study in 2D parameter space</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../MDPM.css" rel="stylesheet" type="text/css"/>
<link href="../../codeLabels.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-fork-corner.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-dropdown-version.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../MDPM-fragment-copy-button.js"></script>
<script type="text/javascript">
DoxygenAwesomeFragmentCopyButton.init()
</script>
<script type="text/javascript" src="../../MDPM-paragraph-link.js"></script>
<script type="text/javascript">
DoxygenAwesomeParagraphLink.init()
</script>
<script type="text/javascript" src="../../MDPM-interactive-toc.js"></script>
<script type="text/javascript">
DoxygenAwesomeInteractiveToc.init()
</script>
<script type="text/javascript" src="../../MDPM-darkmode-toggle.js"></script>
<script type="text/javascript">
DoxygenAwesomeDarkModeToggle.init()
</script>
</head>
<body>
  <div id="bitbucket-corner">
   <a href="https://bitbucket.org/mercurydpm/mercurydpm/src/master/" target="_blank" id="fork-corner" class="fork-corner fc-pos-tr fc-animate fc-theme-bitbucket"></a>
  </div>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../mercury-logo-chosen-light-slogan.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"> <!--MercuryDPM--!>
   <!-- BEGIN version select -->
   <div class="dropdown" id="projectnumber">
    <button class="dropbtn">v1.0</button>
    <div class="dropdown-content">
    </div>
   </div>
   <script type="text/javascript" src="../../MDPM-dropdown-version.js"></script>
<!-- END version select -->
   <!--&#160;<span id="projectnumber">revision: v1.0</span>-->
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<script type="text/javascript" src="../../MDPM-fork-corner.js"></script>
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d6/daa/ParameterStudy2D.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Parameter study in 2D parameter space </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h4><a class="anchor" id="autotoc_md176"></a>
Problem description</h4>
<p>This tutorial is an extension to ParameterStudy1DDemo, and thus also has very similar code structure. It shows how to do a parameter study by using the DPMBase::autonumber function in DPMBase. This tutorial treats the case in which a 2D parameter study has to be performed. The difference with ParameterStudy1DDemo is only the addition of the second dimension of the parameter study. Only the differences with respect to the 1D case are given here, as it is assumed that one looks at ParameterStudy1DDemo first. In this case ParameterStudy1D is extended to change both particle radii, and thus a parameter space can be created. This parameter space is also visualised in the image below.</p>
<div class="image">
<img src="../../GridParamStudy2D.png" alt=""/>
<div class="caption">
Schematic overview of a 2D parameter study. Definitions of i, j, dim1 and dim2 will be given later.</div></div>
<h3><a class="anchor" id="autotoc_md177"></a>
Headers</h3>
<p>The following headers are included: <br  />
</p><div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../d8/d02/Mercury3D_8h.html">Mercury3D.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../d5/d10/Math_2Helpers_8h.html">Math/Helpers.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../d8/deb/LinearViscoelasticFrictionSpecies_8h.html">Species/LinearViscoelasticFrictionSpecies.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="ttc" id="aLinearViscoelasticFrictionSpecies_8h_html"><div class="ttname"><a href="../../d8/deb/LinearViscoelasticFrictionSpecies_8h.html">LinearViscoelasticFrictionSpecies.h</a></div></div>
<div class="ttc" id="aMath_2Helpers_8h_html"><div class="ttname"><a href="../../d5/d10/Math_2Helpers_8h.html">Helpers.h</a></div></div>
<div class="ttc" id="aMercury3D_8h_html"><div class="ttname"><a href="../../d8/d02/Mercury3D_8h.html">Mercury3D.h</a></div></div>
</div><!-- fragment --><p>These are the headers needed for this tutorial.</p>
<h2><a class="anchor" id="autotoc_md178"></a>
Before the main function</h2>
<p>The main class inherits from Mercury3D.<br  />
</p><div class="fragment"><div class="line"><span class="keyword">class </span><a class="code" href="../../de/d3d/classParameterStudy2DDemo.html">ParameterStudy2DDemo</a> : <span class="keyword">public</span> <a class="code" href="../../d3/db1/classMercury3D.html">Mercury3D</a> </div>
<div class="ttc" id="aclassMercury3D_html"><div class="ttname"><a href="../../d3/db1/classMercury3D.html">Mercury3D</a></div><div class="ttdoc">This adds on the hierarchical grid code for 3D problems.</div><div class="ttdef"><b>Definition:</b> Mercury3D.h:16</div></div>
<div class="ttc" id="aclassParameterStudy2DDemo_html"><div class="ttname"><a href="../../de/d3d/classParameterStudy2DDemo.html">ParameterStudy2DDemo</a></div><div class="ttdoc">[PAR_SIM2D:headers]</div><div class="ttdef"><b>Definition:</b> ParameterStudy2DDemo.cpp:15</div></div>
</div><!-- fragment --><p> All steps needed in order to create this class have been explained below.<br  />
 Step 1: (Private) Member variables. <br  />
Compared to ParameterStudy1DDemo a new variable is added, dim2_, that stores the information of the second dimension of the parameter study. Furthermore the size of studyNum is now also incremented by 1, as it stores information of both dimensions. studyNum is now build up as follows: The first entry is (still) storing an integer value giving information of the completeness of the study. The second and third entry store the current run in the first and second dimension respectively. </p><div class="fragment"><div class="line">    <span class="keywordtype">int</span> dim1_ = 0;</div>
<div class="line">    <span class="keywordtype">int</span> dim2_ = 0;</div>
<div class="line">    std::vector&lt;int&gt; studyNum;</div>
</div><!-- fragment --><p> Step 2: Set- and Get-functions for private member variables. <br  />
The set- and get-functions are extended to incorporate the second dimension with respect to ParameterStudy1DDemo. </p><div class="fragment"><div class="line">    <span class="keywordtype">void</span> setStudyDimensions(<span class="keywordtype">int</span> dim1, <span class="keywordtype">int</span> dim2)</div>
<div class="line">    {</div>
<div class="line">        dim1_ = dim1;</div>
<div class="line">        dim2_ = dim2;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    std::vector&lt;int&gt; getCurrentStudyNum()</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="../../d5/d89/classDPMBase.html#a8a2bf821f6928cd8cffe9a5aa263ec10">DPMBase::get2DParametersFromRunNumber</a>(dim1_,dim2_);</div>
<div class="line">    }</div>
<div class="ttc" id="aclassDPMBase_html_a8a2bf821f6928cd8cffe9a5aa263ec10"><div class="ttname"><a href="../../d5/d89/classDPMBase.html#a8a2bf821f6928cd8cffe9a5aa263ec10">DPMBase::get2DParametersFromRunNumber</a></div><div class="ttdeci">std::vector&lt; int &gt; get2DParametersFromRunNumber(int size_x, int size_y) const</div><div class="ttdoc">This turns a counter into 2 indices which is a very useful feature for performing a 2D study....</div><div class="ttdef"><b>Definition:</b> DPMBase.cc:689</div></div>
</div><!-- fragment --><p> Step 3: Create the particle species. <br  />
Nothing changed with respect to ParameterStudy1DDemo</p>
<p>Step 4: Setup the initial conditions. <br  />
The only change with respect to ParameterStudy2DDemo is that now the second particle is dependent on the second dimension of the parameter study. </p><div class="fragment"><div class="line">    <span class="keywordtype">void</span> setupInitialConditions()<span class="keyword"> override</span></div>
<div class="line"><span class="keyword">    </span>{</div>
<div class="line">        studyNum = getCurrentStudyNum();</div>
<div class="line">        createSpecies();</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="../../d7/d41/classSphericalParticle.html">SphericalParticle</a> <a class="code" href="../../de/dbd/namespaceGlobal__Physical__Variables.html#a23c2ade6398f54040b869f7f3a2bcc4b">P</a>;</div>
<div class="line">        <a class="code" href="../../de/dbd/namespaceGlobal__Physical__Variables.html#a23c2ade6398f54040b869f7f3a2bcc4b">P</a>.setSpecies(speciesHandler.getObject(0));</div>
<div class="line">        <span class="comment">// Create 2 particles</span></div>
<div class="line">        particleHandler.copyAndAddObject(<a class="code" href="../../de/dbd/namespaceGlobal__Physical__Variables.html#a23c2ade6398f54040b869f7f3a2bcc4b">P</a>);</div>
<div class="line">        particleHandler.copyAndAddObject(<a class="code" href="../../de/dbd/namespaceGlobal__Physical__Variables.html#a23c2ade6398f54040b869f7f3a2bcc4b">P</a>);</div>
<div class="line">        <span class="comment">//Set up the stuff that is the same for all runs</span></div>
<div class="line">        particleHandler.getObject(0)-&gt;setPosition(<a class="code" href="../../d5/dc1/classVec3D.html">Vec3D</a>(0.006,0.005,0.0));</div>
<div class="line">        particleHandler.getObject(1)-&gt;setPosition(<a class="code" href="../../d5/dc1/classVec3D.html">Vec3D</a>(0.004,0.005,0.0));</div>
<div class="line">        particleHandler.getObject(0)-&gt;setVelocity(<a class="code" href="../../d5/dc1/classVec3D.html">Vec3D</a>(-0.1,0.0,0.0));</div>
<div class="line">        particleHandler.getObject(1)-&gt;setVelocity(<a class="code" href="../../d5/dc1/classVec3D.html">Vec3D</a>( 0.1,0.0,0.0));</div>
<div class="line">        <span class="comment">// We have two different size particles for both left and right particles</span></div>
<div class="line">        <span class="comment">// The value gets updated based on what studyNum is, these come from the automatic counter</span></div>
<div class="line">        particleHandler.getObject(0)-&gt;setRadius(0.0001*studyNum[1]);</div>
<div class="line">        particleHandler.getObject(1)-&gt;setRadius(0.0001*studyNum[2]);</div>
<div class="line">    }</div>
<div class="ttc" id="aclassSphericalParticle_html"><div class="ttname"><a href="../../d7/d41/classSphericalParticle.html">SphericalParticle</a></div><div class="ttdoc">A spherical particle is the most simple particle used in MercuryDPM.</div><div class="ttdef"><b>Definition:</b> SphericalParticle.h:16</div></div>
<div class="ttc" id="aclassVec3D_html"><div class="ttname"><a href="../../d5/dc1/classVec3D.html">Vec3D</a></div><div class="ttdef"><b>Definition:</b> Kernel/Math/Vector.h:30</div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a23c2ade6398f54040b869f7f3a2bcc4b"><div class="ttname"><a href="../../de/dbd/namespaceGlobal__Physical__Variables.html#a23c2ade6398f54040b869f7f3a2bcc4b">Global_Physical_Variables::P</a></div><div class="ttdeci">double P</div><div class="ttdoc">Uniform pressure.</div><div class="ttdef"><b>Definition:</b> TwenteMeshGluing.cpp:77</div></div>
</div><!-- fragment --><p> Step 5: Setting up the parameter study. <br  />
Nothing changed with respect to ParameterStudy1DDemo, both actionsBeforeTimeLoop() and actionsAfterSolve() are the same.</p>
<p>Step 6: Creating the main function. <br  />
The only difference with ParameterStudy2DDemo is that now both study dimensions have to be set. </p><div class="fragment"><div class="line"><a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.setStudyDimensions(2,2) </div>
<div class="ttc" id="asteady__axisym__advection__diffusion_8cc_html_a569d6908c13cebe207584b3d146c851e"><div class="ttname"><a href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a></div><div class="ttdeci">Constructor for SteadyAxisymAdvectionDiffusion problem</div><div class="ttdef"><b>Definition:</b> steady_axisym_advection_diffusion.cc:213</div></div>
</div><!-- fragment --><p> This line results in 4 simulations being run, in which all 4 combinations of particle sizes are solved. </p><div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code" href="../../d9/d18/T__protectiveWall_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>(<span class="keywordtype">int</span> argc <a class="code" href="../../d5/de4/GeneralDefine_8h.html#addf5ec070e9499d36b7f2009ce736076">UNUSED</a>, <span class="keywordtype">char</span> *argv[] <a class="code" href="../../d5/de4/GeneralDefine_8h.html#addf5ec070e9499d36b7f2009ce736076">UNUSED</a>)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">//Problem constructor, using class definition above</span></div>
<div class="line">    <a class="code" href="../../de/d3d/classParameterStudy2DDemo.html">ParameterStudy2DDemo</a> <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>;</div>
<div class="line">    <span class="comment">// Setup the study dimensions that you want to perform</span></div>
<div class="line">    <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.setStudyDimensions(2,2);</div>
<div class="line">    <span class="comment">// Setup the automatic numbering system (create/read COUNTER_DO_NOT_DEL file)</span></div>
<div class="line">    <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.autoNumber();</div>
<div class="line">    <span class="comment">// Setup output file name</span></div>
<div class="line">    <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.setName(<span class="stringliteral">&quot;ParameterStudy2DDemo&quot;</span>);</div>
<div class="line">    <span class="comment">// General simulation settings</span></div>
<div class="line">    <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.setTimeStep(1<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>-5);</div>
<div class="line">    <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.setTimeMax(0.1);</div>
<div class="line">    <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.setSaveCount(5000);</div>
<div class="line">    <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.setXMin(0.0);</div>
<div class="line">    <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.setXMax(1.0);</div>
<div class="line">    <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.setYMin(0.0);</div>
<div class="line">    <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.setYMax(1.0);</div>
<div class="line">    <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.setZMin(0.0);</div>
<div class="line">    <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.setZMax(1.0);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Solve the problem</span></div>
<div class="line">    <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.solve();</div>
<div class="line">    <span class="comment">// Give a successful exit code to the terminal</span></div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="aCwise__array__power__array_8cpp_html_a9eb5e92d9d691c1393e5e7c914731dbf"><div class="ttname"><a href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a></div><div class="ttdeci">Array&lt; double, 1, 3 &gt; e(1./3., 0.5, 2.)</div></div>
<div class="ttc" id="aGeneralDefine_8h_html_addf5ec070e9499d36b7f2009ce736076"><div class="ttname"><a href="../../d5/de4/GeneralDefine_8h.html#addf5ec070e9499d36b7f2009ce736076">UNUSED</a></div><div class="ttdeci">#define UNUSED</div><div class="ttdef"><b>Definition:</b> GeneralDefine.h:18</div></div>
<div class="ttc" id="aT__protectiveWall_8cpp_html_a0ddf1224851353fc92bfbff6f499fa97"><div class="ttname"><a href="../../d9/d18/T__protectiveWall_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a></div><div class="ttdeci">int main(int argc, char *argv[])</div><div class="ttdef"><b>Definition:</b> T_protectiveWall.cpp:194</div></div>
</div><!-- fragment --><p> If you would like to look at the 1D or 3D parameter study demos:<br  />
<a class="el" href="../../d9/d2b/ParameterStudy1D.html">ParameterStudy1DDemo</a> <br  />
<a class="el" href="../../d9/db2/ParameterStudy3D.html">ParameterStudy3DDemo</a> <br  />
 Or return to <a class="el" href="../../d7/db9/AdvancedTutorials.html#AdvancedOverview">Overview of advanced tutorials</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../index.html">MercuryDPM Reference Manual</a></li><li class="navelem"><a class="el" href="../../d5/dac/Tutorials.html">Fun with MercuryDPM (Tutorials)</a></li><li class="navelem"><a class="el" href="../../d0/db0/BeginnerTutorials.html">Beginner tutorials</a></li><li class="navelem"><a class="el" href="../../d7/db9/AdvancedTutorials.html">Advanced tutorials</a></li>
    <li class="footer">Generated on Wed Aug 27 2025 17:05:13 for MercuryDPM by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
