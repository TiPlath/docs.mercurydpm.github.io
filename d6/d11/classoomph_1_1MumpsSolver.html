<!-- HTML header for doxygen 1.8.18-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MercuryDPM: oomph::MumpsSolver Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../MDPM.css" rel="stylesheet" type="text/css"/>
<link href="../../codeLabels.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-fork-corner.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-dropdown-version.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../MDPM-fragment-copy-button.js"></script>
<script type="text/javascript">
DoxygenAwesomeFragmentCopyButton.init()
</script>
<script type="text/javascript" src="../../MDPM-paragraph-link.js"></script>
<script type="text/javascript">
DoxygenAwesomeParagraphLink.init()
</script>
<script type="text/javascript" src="../../MDPM-interactive-toc.js"></script>
<script type="text/javascript">
DoxygenAwesomeInteractiveToc.init()
</script>
<script type="text/javascript" src="../../MDPM-darkmode-toggle.js"></script>
<script type="text/javascript">
DoxygenAwesomeDarkModeToggle.init()
</script>
</head>
<body>
  <div id="bitbucket-corner">
   <a href="https://bitbucket.org/mercurydpm/mercurydpm/src/master/" target="_blank" id="fork-corner" class="fork-corner fc-pos-tr fc-animate fc-theme-bitbucket"></a>
  </div>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../mercury-logo-chosen-light-slogan.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"> <!--MercuryDPM--!>
   <!-- BEGIN version select -->
   <div class="dropdown" id="projectnumber">
    <button class="dropbtn">v1.0</button>
    <div class="dropdown-content">
    </div>
   </div>
   <script type="text/javascript" src="../../MDPM-dropdown-version.js"></script>
<!-- END version select -->
   <!--&#160;<span id="projectnumber">revision: v1.0</span>-->
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<script type="text/javascript" src="../../MDPM-fork-corner.js"></script>
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d6/d11/classoomph_1_1MumpsSolver.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="#pri-types">Private Types</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="../../de/db8/classoomph_1_1MumpsSolver-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">oomph::MumpsSolver Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Wrapper to Mumps solver.  
 <a href="../../d6/d11/classoomph_1_1MumpsSolver.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="../../db/ddd/mumps__solver_8h_source.html">mumps_solver.h</a>&gt;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Inheritance diagram for oomph::MumpsSolver:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
 <div class="center">
  <img src="../../d6/d11/classoomph_1_1MumpsSolver.png" usemap="#oomph::MumpsSolver_map" alt=""/>
  <map id="oomph::MumpsSolver_map" name="oomph::MumpsSolver_map">
<area href="../../d5/dd7/classoomph_1_1LinearSolver.html" alt="oomph::LinearSolver" shape="rect" coords="0,56,243,80"/>
<area href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html" alt="oomph::DistributableLinearAlgebraObject" shape="rect" coords="0,0,243,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ac3f965da46774f48a9b756610f81140e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#ac3f965da46774f48a9b756610f81140e">MumpsSolver</a> ()</td></tr>
<tr class="memdesc:ac3f965da46774f48a9b756610f81140e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor: Call setup.  <a href="../../d6/d11/classoomph_1_1MumpsSolver.html#ac3f965da46774f48a9b756610f81140e">More...</a><br /></td></tr>
<tr class="separator:ac3f965da46774f48a9b756610f81140e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85731b5c626437479245e91f20e18500"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a85731b5c626437479245e91f20e18500">MumpsSolver</a> (const <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html">MumpsSolver</a> &amp;dummy)=delete</td></tr>
<tr class="memdesc:a85731b5c626437479245e91f20e18500"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken copy constructor.  <a href="../../d6/d11/classoomph_1_1MumpsSolver.html#a85731b5c626437479245e91f20e18500">More...</a><br /></td></tr>
<tr class="separator:a85731b5c626437479245e91f20e18500"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d5ca953c8e042da066d0598b1941112"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a8d5ca953c8e042da066d0598b1941112">operator=</a> (const <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html">MumpsSolver</a> &amp;)=delete</td></tr>
<tr class="memdesc:a8d5ca953c8e042da066d0598b1941112"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken assignment operator.  <a href="../../d6/d11/classoomph_1_1MumpsSolver.html#a8d5ca953c8e042da066d0598b1941112">More...</a><br /></td></tr>
<tr class="separator:a8d5ca953c8e042da066d0598b1941112"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20e6116da9911337fb80486bcfaf7eb4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a20e6116da9911337fb80486bcfaf7eb4">~MumpsSolver</a> ()</td></tr>
<tr class="memdesc:a20e6116da9911337fb80486bcfaf7eb4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor: Cleanup.  <a href="../../d6/d11/classoomph_1_1MumpsSolver.html#a20e6116da9911337fb80486bcfaf7eb4">More...</a><br /></td></tr>
<tr class="separator:a20e6116da9911337fb80486bcfaf7eb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba2b1c844e190da45c8adbd6dfc0f344"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#aba2b1c844e190da45c8adbd6dfc0f344">disable_resolve</a> ()</td></tr>
<tr class="memdesc:aba2b1c844e190da45c8adbd6dfc0f344"><td class="mdescLeft">&#160;</td><td class="mdescRight">Overload disable resolve so that it cleans up memory too.  <a href="../../d6/d11/classoomph_1_1MumpsSolver.html#aba2b1c844e190da45c8adbd6dfc0f344">More...</a><br /></td></tr>
<tr class="separator:aba2b1c844e190da45c8adbd6dfc0f344"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f7ea8c453b2ff106ce42a11c8182cf5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0f7ea8c453b2ff106ce42a11c8182cf5">enable_suppress_warning_about_MPI_COMM_WORLD</a> ()</td></tr>
<tr class="separator:a0f7ea8c453b2ff106ce42a11c8182cf5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade6f5dff6fddd0eeef6ef051ab5dfbc1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#ade6f5dff6fddd0eeef6ef051ab5dfbc1">disable_suppress_warning_about_MPI_COMM_WORLD</a> ()</td></tr>
<tr class="memdesc:ade6f5dff6fddd0eeef6ef051ab5dfbc1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Don't suppress warning about communicator not equal to MPI_COMM_WORLD.  <a href="../../d6/d11/classoomph_1_1MumpsSolver.html#ade6f5dff6fddd0eeef6ef051ab5dfbc1">More...</a><br /></td></tr>
<tr class="separator:ade6f5dff6fddd0eeef6ef051ab5dfbc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9be151628e1d8b488441ce2455f888e1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a9be151628e1d8b488441ce2455f888e1">enable_suppress_mumps_info_during_solve</a> ()</td></tr>
<tr class="separator:a9be151628e1d8b488441ce2455f888e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad75c9ff36be18867a88e0a68fac68f7c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#ad75c9ff36be18867a88e0a68fac68f7c">disable_suppress_mumps_info_during_solve</a> ()</td></tr>
<tr class="memdesc:ad75c9ff36be18867a88e0a68fac68f7c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Don't suppress info being printed to screen during MUMPS solve.  <a href="../../d6/d11/classoomph_1_1MumpsSolver.html#ad75c9ff36be18867a88e0a68fac68f7c">More...</a><br /></td></tr>
<tr class="separator:ad75c9ff36be18867a88e0a68fac68f7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0346a464f3ed74bfcca4063bdeed3ad"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#ae0346a464f3ed74bfcca4063bdeed3ad">solve</a> (<a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *const &amp;problem_pt, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;result)</td></tr>
<tr class="separator:ae0346a464f3ed74bfcca4063bdeed3ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3995dcf46675fc443b4d373d348a0fdf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a3995dcf46675fc443b4d373d348a0fdf">solve</a> (<a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html">DoubleMatrixBase</a> *const &amp;matrix_pt, const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;rhs, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;result)</td></tr>
<tr class="separator:a3995dcf46675fc443b4d373d348a0fdf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a849d13cac2177452446c2ec387a0260f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a849d13cac2177452446c2ec387a0260f">resolve</a> (const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;rhs, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;result)</td></tr>
<tr class="separator:a849d13cac2177452446c2ec387a0260f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25426798eb831cf552bdc17c0307ff25"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a25426798eb831cf552bdc17c0307ff25">enable_doc_stats</a> ()</td></tr>
<tr class="memdesc:a25426798eb831cf552bdc17c0307ff25"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enable documentation of statistics.  <a href="../../d6/d11/classoomph_1_1MumpsSolver.html#a25426798eb831cf552bdc17c0307ff25">More...</a><br /></td></tr>
<tr class="separator:a25426798eb831cf552bdc17c0307ff25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f64fcf52cb7cbf89b75da1d794dee5f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a8f64fcf52cb7cbf89b75da1d794dee5f">disable_doc_stats</a> ()</td></tr>
<tr class="memdesc:a8f64fcf52cb7cbf89b75da1d794dee5f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Disable documentation of statistics.  <a href="../../d6/d11/classoomph_1_1MumpsSolver.html#a8f64fcf52cb7cbf89b75da1d794dee5f">More...</a><br /></td></tr>
<tr class="separator:a8f64fcf52cb7cbf89b75da1d794dee5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea9e3eead627f8f8963f7b5c70b669f7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#aea9e3eead627f8f8963f7b5c70b669f7">jacobian_setup_time</a> ()</td></tr>
<tr class="separator:aea9e3eead627f8f8963f7b5c70b669f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52e765662a0e2cbd81dc5dc280905604"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a52e765662a0e2cbd81dc5dc280905604">linear_solver_solution_time</a> ()</td></tr>
<tr class="separator:a52e765662a0e2cbd81dc5dc280905604"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5d49803e13ef6e6026e470a9933613e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#ab5d49803e13ef6e6026e470a9933613e">enable_suppress_solve</a> ()</td></tr>
<tr class="separator:ab5d49803e13ef6e6026e470a9933613e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34346022a010acc09dc0ab1ce59d90a7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a34346022a010acc09dc0ab1ce59d90a7">disable_suppress_solve</a> ()</td></tr>
<tr class="separator:a34346022a010acc09dc0ab1ce59d90a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbab47dbf3effebd34f3d3ba1634f7d3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#afbab47dbf3effebd34f3d3ba1634f7d3">enable_delete_matrix_data</a> ()</td></tr>
<tr class="separator:afbab47dbf3effebd34f3d3ba1634f7d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52b3fbf9407cb8284f1c80600b11869f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a52b3fbf9407cb8284f1c80600b11869f">disable_delete_matrix_data</a> ()</td></tr>
<tr class="separator:a52b3fbf9407cb8284f1c80600b11869f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeab520bd25edb0f4e88feaedec689333"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#aeab520bd25edb0f4e88feaedec689333">factorise</a> (<a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html">DoubleMatrixBase</a> *const &amp;matrix_pt)</td></tr>
<tr class="separator:aeab520bd25edb0f4e88feaedec689333"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92ab601b671c2b7eea44a470aa5ec4f3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a92ab601b671c2b7eea44a470aa5ec4f3">backsub</a> (const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;rhs, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;result)</td></tr>
<tr class="separator:a92ab601b671c2b7eea44a470aa5ec4f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc1541e4a9cbbe9c641f988380618713"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#adc1541e4a9cbbe9c641f988380618713">clean_up_memory</a> ()</td></tr>
<tr class="memdesc:adc1541e4a9cbbe9c641f988380618713"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clean up the memory allocated by the mumps solver.  <a href="../../d6/d11/classoomph_1_1MumpsSolver.html#adc1541e4a9cbbe9c641f988380618713">More...</a><br /></td></tr>
<tr class="separator:adc1541e4a9cbbe9c641f988380618713"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6bceea5ab29bbc30322b092b227ac03"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#af6bceea5ab29bbc30322b092b227ac03">declare_jacobian_is_unsymmetric</a> ()</td></tr>
<tr class="memdesc:af6bceea5ab29bbc30322b092b227ac03"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tell MUMPS that the Jacobian matrix is unsymmetric.  <a href="../../d6/d11/classoomph_1_1MumpsSolver.html#af6bceea5ab29bbc30322b092b227ac03">More...</a><br /></td></tr>
<tr class="separator:af6bceea5ab29bbc30322b092b227ac03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a752f8f023f3b6c1b7021ad6683853850"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a752f8f023f3b6c1b7021ad6683853850">declare_jacobian_is_symmetric</a> ()</td></tr>
<tr class="memdesc:a752f8f023f3b6c1b7021ad6683853850"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tell MUMPS that the Jacobian matrix is general symmetric.  <a href="../../d6/d11/classoomph_1_1MumpsSolver.html#a752f8f023f3b6c1b7021ad6683853850">More...</a><br /></td></tr>
<tr class="separator:a752f8f023f3b6c1b7021ad6683853850"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee53c09d398f6a982de5dc5fa9c02df7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#aee53c09d398f6a982de5dc5fa9c02df7">declare_jacobian_is_symmetric_positive_definite</a> ()</td></tr>
<tr class="memdesc:aee53c09d398f6a982de5dc5fa9c02df7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tell MUMPS that the Jacobian matrix is symmetric positive-definite.  <a href="../../d6/d11/classoomph_1_1MumpsSolver.html#aee53c09d398f6a982de5dc5fa9c02df7">More...</a><br /></td></tr>
<tr class="separator:aee53c09d398f6a982de5dc5fa9c02df7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a576cb1f983353144e063aa63c50757bc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a576cb1f983353144e063aa63c50757bc">use_pord_ordering</a> ()</td></tr>
<tr class="separator:a576cb1f983353144e063aa63c50757bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25cd4ab6089d1532100ff61d5863c6fd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a25cd4ab6089d1532100ff61d5863c6fd">use_metis_ordering</a> ()</td></tr>
<tr class="separator:a25cd4ab6089d1532100ff61d5863c6fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34fecff46bfab62a67f7200a745efeea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a34fecff46bfab62a67f7200a745efeea">use_scotch_ordering</a> ()</td></tr>
<tr class="separator:a34fecff46bfab62a67f7200a745efeea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classoomph_1_1LinearSolver"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classoomph_1_1LinearSolver')"><img src="../../closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html">oomph::LinearSolver</a></td></tr>
<tr class="memitem:a6e7e8728f36c888f052e49df8624b8ca inherit pub_methods_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a6e7e8728f36c888f052e49df8624b8ca">LinearSolver</a> ()</td></tr>
<tr class="memdesc:a6e7e8728f36c888f052e49df8624b8ca inherit pub_methods_classoomph_1_1LinearSolver"><td class="mdescLeft">&#160;</td><td class="mdescRight">Empty constructor, initialise the member data.  <a href="../../d5/dd7/classoomph_1_1LinearSolver.html#a6e7e8728f36c888f052e49df8624b8ca">More...</a><br /></td></tr>
<tr class="separator:a6e7e8728f36c888f052e49df8624b8ca inherit pub_methods_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c4dba96b243e3e9be1ef6bdb9440d23 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a6c4dba96b243e3e9be1ef6bdb9440d23">LinearSolver</a> (const <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html">LinearSolver</a> &amp;dummy)=delete</td></tr>
<tr class="memdesc:a6c4dba96b243e3e9be1ef6bdb9440d23 inherit pub_methods_classoomph_1_1LinearSolver"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken copy constructor.  <a href="../../d5/dd7/classoomph_1_1LinearSolver.html#a6c4dba96b243e3e9be1ef6bdb9440d23">More...</a><br /></td></tr>
<tr class="separator:a6c4dba96b243e3e9be1ef6bdb9440d23 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b342cfa595300cb8227665382929e8b inherit pub_methods_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a0b342cfa595300cb8227665382929e8b">operator=</a> (const <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html">LinearSolver</a> &amp;)=delete</td></tr>
<tr class="memdesc:a0b342cfa595300cb8227665382929e8b inherit pub_methods_classoomph_1_1LinearSolver"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken assignment operator.  <a href="../../d5/dd7/classoomph_1_1LinearSolver.html#a0b342cfa595300cb8227665382929e8b">More...</a><br /></td></tr>
<tr class="separator:a0b342cfa595300cb8227665382929e8b inherit pub_methods_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9cc9b2c9a239777c4f9b15f26bb324a0 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a9cc9b2c9a239777c4f9b15f26bb324a0">~LinearSolver</a> ()</td></tr>
<tr class="memdesc:a9cc9b2c9a239777c4f9b15f26bb324a0 inherit pub_methods_classoomph_1_1LinearSolver"><td class="mdescLeft">&#160;</td><td class="mdescRight">Empty virtual destructor.  <a href="../../d5/dd7/classoomph_1_1LinearSolver.html#a9cc9b2c9a239777c4f9b15f26bb324a0">More...</a><br /></td></tr>
<tr class="separator:a9cc9b2c9a239777c4f9b15f26bb324a0 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abeb9ef9127e927bf6df75d03645d6a81 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#abeb9ef9127e927bf6df75d03645d6a81">enable_doc_time</a> ()</td></tr>
<tr class="memdesc:abeb9ef9127e927bf6df75d03645d6a81 inherit pub_methods_classoomph_1_1LinearSolver"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enable documentation of solve times.  <a href="../../d5/dd7/classoomph_1_1LinearSolver.html#abeb9ef9127e927bf6df75d03645d6a81">More...</a><br /></td></tr>
<tr class="separator:abeb9ef9127e927bf6df75d03645d6a81 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91ffe51f3de82dad1a110c099f256d73 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a91ffe51f3de82dad1a110c099f256d73">disable_doc_time</a> ()</td></tr>
<tr class="memdesc:a91ffe51f3de82dad1a110c099f256d73 inherit pub_methods_classoomph_1_1LinearSolver"><td class="mdescLeft">&#160;</td><td class="mdescRight">Disable documentation of solve times.  <a href="../../d5/dd7/classoomph_1_1LinearSolver.html#a91ffe51f3de82dad1a110c099f256d73">More...</a><br /></td></tr>
<tr class="separator:a91ffe51f3de82dad1a110c099f256d73 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a451ce3af5db82f9edbddf8f417597248 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a451ce3af5db82f9edbddf8f417597248">is_doc_time_enabled</a> () const</td></tr>
<tr class="memdesc:a451ce3af5db82f9edbddf8f417597248 inherit pub_methods_classoomph_1_1LinearSolver"><td class="mdescLeft">&#160;</td><td class="mdescRight">Is documentation of solve times enabled?  <a href="../../d5/dd7/classoomph_1_1LinearSolver.html#a451ce3af5db82f9edbddf8f417597248">More...</a><br /></td></tr>
<tr class="separator:a451ce3af5db82f9edbddf8f417597248 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1e4d34a7e2b1537d36153f87e8a62a6 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#ae1e4d34a7e2b1537d36153f87e8a62a6">is_resolve_enabled</a> () const</td></tr>
<tr class="memdesc:ae1e4d34a7e2b1537d36153f87e8a62a6 inherit pub_methods_classoomph_1_1LinearSolver"><td class="mdescLeft">&#160;</td><td class="mdescRight">Boolean flag indicating if resolves are enabled.  <a href="../../d5/dd7/classoomph_1_1LinearSolver.html#ae1e4d34a7e2b1537d36153f87e8a62a6">More...</a><br /></td></tr>
<tr class="separator:ae1e4d34a7e2b1537d36153f87e8a62a6 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3000ebd9becb3468d8a6a821a9cc0cd9 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a3000ebd9becb3468d8a6a821a9cc0cd9">enable_resolve</a> ()</td></tr>
<tr class="separator:a3000ebd9becb3468d8a6a821a9cc0cd9 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f7a2ee2cd18d3dafc20a61ca2f52dbb inherit pub_methods_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a1f7a2ee2cd18d3dafc20a61ca2f52dbb">solve</a> (<a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html">DoubleMatrixBase</a> *const &amp;matrix_pt, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;rhs, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;result)</td></tr>
<tr class="separator:a1f7a2ee2cd18d3dafc20a61ca2f52dbb inherit pub_methods_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e970813a1583f6105ee2d677d3e45f3 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a8e970813a1583f6105ee2d677d3e45f3">solve_transpose</a> (<a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *const &amp;problem_pt, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;result)</td></tr>
<tr class="separator:a8e970813a1583f6105ee2d677d3e45f3 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a600b4d06d85c238bdd6bd33f05d69c44 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a600b4d06d85c238bdd6bd33f05d69c44">solve_transpose</a> (<a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html">DoubleMatrixBase</a> *const &amp;matrix_pt, const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;rhs, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;result)</td></tr>
<tr class="separator:a600b4d06d85c238bdd6bd33f05d69c44 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a499b738758451f94df398d8d2556ae76 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a499b738758451f94df398d8d2556ae76">solve_transpose</a> (<a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html">DoubleMatrixBase</a> *const &amp;matrix_pt, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;rhs, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;result)</td></tr>
<tr class="separator:a499b738758451f94df398d8d2556ae76 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf539c2dd415e22e597fade4c0ca4022 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#acf539c2dd415e22e597fade4c0ca4022">resolve_transpose</a> (const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;rhs, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;result)</td></tr>
<tr class="separator:acf539c2dd415e22e597fade4c0ca4022 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fedfb9d9855d0e998c0e32140bc56d4 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a0fedfb9d9855d0e998c0e32140bc56d4">jacobian_setup_time</a> () const</td></tr>
<tr class="separator:a0fedfb9d9855d0e998c0e32140bc56d4 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c66f77db812a9c196478c7e2f77ef09 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a3c66f77db812a9c196478c7e2f77ef09">linear_solver_solution_time</a> () const</td></tr>
<tr class="separator:a3c66f77db812a9c196478c7e2f77ef09 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37f1f8b8c6d45115e649739abd5d2f5d inherit pub_methods_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a37f1f8b8c6d45115e649739abd5d2f5d">enable_computation_of_gradient</a> ()</td></tr>
<tr class="separator:a37f1f8b8c6d45115e649739abd5d2f5d inherit pub_methods_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bc045e20074cb9b45ab3f304d037fc6 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a8bc045e20074cb9b45ab3f304d037fc6">disable_computation_of_gradient</a> ()</td></tr>
<tr class="separator:a8bc045e20074cb9b45ab3f304d037fc6 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aceef502cbdf826cdf6aa31f5803982e0 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#aceef502cbdf826cdf6aa31f5803982e0">reset_gradient</a> ()</td></tr>
<tr class="separator:aceef502cbdf826cdf6aa31f5803982e0 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6733411e85f0a1d6d82200c802481681 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a6733411e85f0a1d6d82200c802481681">get_gradient</a> (<a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;gradient)</td></tr>
<tr class="memdesc:a6733411e85f0a1d6d82200c802481681 inherit pub_methods_classoomph_1_1LinearSolver"><td class="mdescLeft">&#160;</td><td class="mdescRight">function to access the gradient, provided it has been computed  <a href="../../d5/dd7/classoomph_1_1LinearSolver.html#a6733411e85f0a1d6d82200c802481681">More...</a><br /></td></tr>
<tr class="separator:a6733411e85f0a1d6d82200c802481681 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classoomph_1_1DistributableLinearAlgebraObject')"><img src="../../closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html">oomph::DistributableLinearAlgebraObject</a></td></tr>
<tr class="memitem:ac9492d59cff9d9b0098712ae72989cd3 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ac9492d59cff9d9b0098712ae72989cd3">DistributableLinearAlgebraObject</a> ()</td></tr>
<tr class="memdesc:ac9492d59cff9d9b0098712ae72989cd3 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default constructor - create a distribution.  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ac9492d59cff9d9b0098712ae72989cd3">More...</a><br /></td></tr>
<tr class="separator:ac9492d59cff9d9b0098712ae72989cd3 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7522391265c46e6c748fd660eae66f5e inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a7522391265c46e6c748fd660eae66f5e">DistributableLinearAlgebraObject</a> (const <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html">DistributableLinearAlgebraObject</a> &amp;<a class="el" href="../../da/d67/level3__impl_8h.html#a21849b14ce38b5bc40d43a5782d89138">matrix</a>)=delete</td></tr>
<tr class="memdesc:a7522391265c46e6c748fd660eae66f5e inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken copy constructor.  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a7522391265c46e6c748fd660eae66f5e">More...</a><br /></td></tr>
<tr class="separator:a7522391265c46e6c748fd660eae66f5e inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada5f539f36451c06e69de79bb129521b inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ada5f539f36451c06e69de79bb129521b">operator=</a> (const <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html">DistributableLinearAlgebraObject</a> &amp;)=delete</td></tr>
<tr class="memdesc:ada5f539f36451c06e69de79bb129521b inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken assignment operator.  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ada5f539f36451c06e69de79bb129521b">More...</a><br /></td></tr>
<tr class="separator:ada5f539f36451c06e69de79bb129521b inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4038de53b5737dc625411e7848d21dad inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a4038de53b5737dc625411e7848d21dad">~DistributableLinearAlgebraObject</a> ()</td></tr>
<tr class="memdesc:a4038de53b5737dc625411e7848d21dad inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a4038de53b5737dc625411e7848d21dad">More...</a><br /></td></tr>
<tr class="separator:a4038de53b5737dc625411e7848d21dad inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a603105384d60c9a3710378af39f538b9 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a> () const</td></tr>
<tr class="memdesc:a603105384d60c9a3710378af39f538b9 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">access to the LinearAlgebraDistribution  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">More...</a><br /></td></tr>
<tr class="separator:a603105384d60c9a3710378af39f538b9 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7569556f14fd68b28508920e89bd5eee inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a7569556f14fd68b28508920e89bd5eee">nrow</a> () const</td></tr>
<tr class="memdesc:a7569556f14fd68b28508920e89bd5eee inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">access function to the number of global rows.  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a7569556f14fd68b28508920e89bd5eee">More...</a><br /></td></tr>
<tr class="separator:a7569556f14fd68b28508920e89bd5eee inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bd7e1d242c69a28da85a804a7717fce inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">nrow_local</a> () const</td></tr>
<tr class="memdesc:a9bd7e1d242c69a28da85a804a7717fce inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">access function for the num of local rows on this processor.  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">More...</a><br /></td></tr>
<tr class="separator:a9bd7e1d242c69a28da85a804a7717fce inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21e966b025edec79067b41d7f1f25220 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a21e966b025edec79067b41d7f1f25220">nrow_local</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>) const</td></tr>
<tr class="memdesc:a21e966b025edec79067b41d7f1f25220 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">access function for the num of local rows on this processor.  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a21e966b025edec79067b41d7f1f25220">More...</a><br /></td></tr>
<tr class="separator:a21e966b025edec79067b41d7f1f25220 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab00a3919b8634c698749f14a4d92947d inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ab00a3919b8634c698749f14a4d92947d">first_row</a> () const</td></tr>
<tr class="memdesc:ab00a3919b8634c698749f14a4d92947d inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">access function for the first row on this processor  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ab00a3919b8634c698749f14a4d92947d">More...</a><br /></td></tr>
<tr class="separator:ab00a3919b8634c698749f14a4d92947d inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4266c1d18d8e102bad3f4aec26c9b7cf inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a4266c1d18d8e102bad3f4aec26c9b7cf">first_row</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>) const</td></tr>
<tr class="memdesc:a4266c1d18d8e102bad3f4aec26c9b7cf inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">access function for the first row on this processor  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a4266c1d18d8e102bad3f4aec26c9b7cf">More...</a><br /></td></tr>
<tr class="separator:a4266c1d18d8e102bad3f4aec26c9b7cf inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5505731e7e73d7e4251c67c7adec6bf5 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a5505731e7e73d7e4251c67c7adec6bf5">distributed</a> () const</td></tr>
<tr class="memdesc:a5505731e7e73d7e4251c67c7adec6bf5 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">distribution is serial or distributed  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a5505731e7e73d7e4251c67c7adec6bf5">More...</a><br /></td></tr>
<tr class="separator:a5505731e7e73d7e4251c67c7adec6bf5 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c35baa65e335043f62954c92c090a5a inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a8c35baa65e335043f62954c92c090a5a">distribution_built</a> () const</td></tr>
<tr class="separator:a8c35baa65e335043f62954c92c090a5a inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5340bac40b9559b0378037b57005203 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ac5340bac40b9559b0378037b57005203">build_distribution</a> (const <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> *const dist_pt)</td></tr>
<tr class="separator:ac5340bac40b9559b0378037b57005203 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adad20ac61a61d907f823da7694b50616 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#adad20ac61a61d907f823da7694b50616">build_distribution</a> (const <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> &amp;dist)</td></tr>
<tr class="separator:adad20ac61a61d907f823da7694b50616 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:ab0656b67b21335203eb7fbce8c7c7535"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#ab0656b67b21335203eb7fbce8c7c7535">Suppress_incorrect_rhs_distribution_warning_in_resolve</a></td></tr>
<tr class="separator:ab0656b67b21335203eb7fbce8c7c7535"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6bd1660c9c62b039b9cdd8074169a25"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#ad6bd1660c9c62b039b9cdd8074169a25">Default_workspace_scaling_factor</a> = 5</td></tr>
<tr class="separator:ad6bd1660c9c62b039b9cdd8074169a25"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-types"></a>
Private Types</h2></td></tr>
<tr class="memitem:aeffb9b19a97ee7ba86336b694a57d836"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#aeffb9b19a97ee7ba86336b694a57d836">MumpsJacobianSymmetryFlags</a> { <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#aeffb9b19a97ee7ba86336b694a57d836a8e20922b3a1dbfa7ddb6ca95c35b03a8">Unsymmetric</a> = 0
, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#aeffb9b19a97ee7ba86336b694a57d836aafd4b90b3304bd19bd2998f9464e4095">Symmetric_positive_definite</a> = 1
, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#aeffb9b19a97ee7ba86336b694a57d836ac37b58b1aad1705a3986aad20494e1c0">Symmetric</a> = 2
 }</td></tr>
<tr class="separator:aeffb9b19a97ee7ba86336b694a57d836"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e380357c515b4f280cf6bdf7273ed4b"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a5e380357c515b4f280cf6bdf7273ed4b">MumpsJacobianOrderingFlags</a> { <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a5e380357c515b4f280cf6bdf7273ed4ba8484bf86594bef6f3509ca968e65eb1d">Scotch_ordering</a> = 3
, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a5e380357c515b4f280cf6bdf7273ed4ba13393a6ca320fac921fdc389ef247f10">Pord_ordering</a> = 4
, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a5e380357c515b4f280cf6bdf7273ed4ba3f76be5ac72cb29a86f05019e0b7f496">Metis_ordering</a> = 5
 }</td></tr>
<tr class="separator:a5e380357c515b4f280cf6bdf7273ed4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:ae5e186152100c7d5f045d3df2a115c72"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#ae5e186152100c7d5f045d3df2a115c72">initialise_mumps</a> ()</td></tr>
<tr class="memdesc:ae5e186152100c7d5f045d3df2a115c72"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise instance of mumps data structure.  <a href="../../d6/d11/classoomph_1_1MumpsSolver.html#ae5e186152100c7d5f045d3df2a115c72">More...</a><br /></td></tr>
<tr class="separator:ae5e186152100c7d5f045d3df2a115c72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cf1f5e02e905d39e1b324dc921568f6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a5cf1f5e02e905d39e1b324dc921568f6">shutdown_mumps</a> ()</td></tr>
<tr class="memdesc:a5cf1f5e02e905d39e1b324dc921568f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Shutdown mumps.  <a href="../../d6/d11/classoomph_1_1MumpsSolver.html#a5cf1f5e02e905d39e1b324dc921568f6">More...</a><br /></td></tr>
<tr class="separator:a5cf1f5e02e905d39e1b324dc921568f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a0608ee6d4a166c35a5d2d3756f119780"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0608ee6d4a166c35a5d2d3756f119780">Jacobian_setup_time</a></td></tr>
<tr class="memdesc:a0608ee6d4a166c35a5d2d3756f119780"><td class="mdescLeft">&#160;</td><td class="mdescRight">Jacobian setup time.  <a href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0608ee6d4a166c35a5d2d3756f119780">More...</a><br /></td></tr>
<tr class="separator:a0608ee6d4a166c35a5d2d3756f119780"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a5a305985a4215cc3456df54f531900"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a6a5a305985a4215cc3456df54f531900">Solution_time</a></td></tr>
<tr class="memdesc:a6a5a305985a4215cc3456df54f531900"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solution time.  <a href="../../d6/d11/classoomph_1_1MumpsSolver.html#a6a5a305985a4215cc3456df54f531900">More...</a><br /></td></tr>
<tr class="separator:a6a5a305985a4215cc3456df54f531900"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a851b95821f3adce5545e7abe238b3cce"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a851b95821f3adce5545e7abe238b3cce">Suppress_solve</a></td></tr>
<tr class="memdesc:a851b95821f3adce5545e7abe238b3cce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Suppress solve?  <a href="../../d6/d11/classoomph_1_1MumpsSolver.html#a851b95821f3adce5545e7abe238b3cce">More...</a><br /></td></tr>
<tr class="separator:a851b95821f3adce5545e7abe238b3cce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8dc51b4b7e2b121773aea1ed7820ea16"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a8dc51b4b7e2b121773aea1ed7820ea16">Doc_stats</a></td></tr>
<tr class="memdesc:a8dc51b4b7e2b121773aea1ed7820ea16"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set to true for MumpsSolver to output statistics (false by default).  <a href="../../d6/d11/classoomph_1_1MumpsSolver.html#a8dc51b4b7e2b121773aea1ed7820ea16">More...</a><br /></td></tr>
<tr class="separator:a8dc51b4b7e2b121773aea1ed7820ea16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a770886867c62d2eff6afe4b091fabd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a4a770886867c62d2eff6afe4b091fabd">Suppress_warning_about_MPI_COMM_WORLD</a></td></tr>
<tr class="separator:a4a770886867c62d2eff6afe4b091fabd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfc51e1ed214d9d2dc5a83b04a08d1f7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#acfc51e1ed214d9d2dc5a83b04a08d1f7">Suppress_mumps_info_during_solve</a></td></tr>
<tr class="memdesc:acfc51e1ed214d9d2dc5a83b04a08d1f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Boolean to suppress info being printed to screen during MUMPS solve.  <a href="../../d6/d11/classoomph_1_1MumpsSolver.html#acfc51e1ed214d9d2dc5a83b04a08d1f7">More...</a><br /></td></tr>
<tr class="separator:acfc51e1ed214d9d2dc5a83b04a08d1f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3512c04b1bfcf11064c0da453ba34806"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a3512c04b1bfcf11064c0da453ba34806">Mumps_is_initialised</a></td></tr>
<tr class="memdesc:a3512c04b1bfcf11064c0da453ba34806"><td class="mdescLeft">&#160;</td><td class="mdescRight">Has mumps been initialised?  <a href="../../d6/d11/classoomph_1_1MumpsSolver.html#a3512c04b1bfcf11064c0da453ba34806">More...</a><br /></td></tr>
<tr class="separator:a3512c04b1bfcf11064c0da453ba34806"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78d0283ea0263a5b31b7662d7abdfcb8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a78d0283ea0263a5b31b7662d7abdfcb8">Workspace_scaling_factor</a></td></tr>
<tr class="separator:a78d0283ea0263a5b31b7662d7abdfcb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88430ee69fb2015c48ec123b26e019e9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a88430ee69fb2015c48ec123b26e019e9">Delete_matrix_data</a></td></tr>
<tr class="separator:a88430ee69fb2015c48ec123b26e019e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a969c7e01bcce31a946e01f03953e0745"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a969c7e01bcce31a946e01f03953e0745">Irn_loc</a></td></tr>
<tr class="memdesc:a969c7e01bcce31a946e01f03953e0745"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector for row numbers.  <a href="../../d6/d11/classoomph_1_1MumpsSolver.html#a969c7e01bcce31a946e01f03953e0745">More...</a><br /></td></tr>
<tr class="separator:a969c7e01bcce31a946e01f03953e0745"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a593d7783708440445e09b6d595168cce"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a593d7783708440445e09b6d595168cce">Jcn_loc</a></td></tr>
<tr class="separator:a593d7783708440445e09b6d595168cce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b40d6e4d26ada5edef87bc1fa511d06"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a5b40d6e4d26ada5edef87bc1fa511d06">A_loc</a></td></tr>
<tr class="separator:a5b40d6e4d26ada5edef87bc1fa511d06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cf148106cf3cc86e238ae4f289be0f8"><td class="memItemLeft" align="right" valign="top">DMUMPS_STRUC_C *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a></td></tr>
<tr class="memdesc:a0cf148106cf3cc86e238ae4f289be0f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to MUMPS struct that contains the solver data.  <a href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">More...</a><br /></td></tr>
<tr class="separator:a0cf148106cf3cc86e238ae4f289be0f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab816409c94736fea48814096af0bd14b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#ab816409c94736fea48814096af0bd14b">Jacobian_symmetry_flag</a></td></tr>
<tr class="separator:ab816409c94736fea48814096af0bd14b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3358fea674f17424aac41152aeb7f990"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a3358fea674f17424aac41152aeb7f990">Jacobian_ordering_flag</a></td></tr>
<tr class="separator:a3358fea674f17424aac41152aeb7f990"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_methods_classoomph_1_1DistributableLinearAlgebraObject"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classoomph_1_1DistributableLinearAlgebraObject')"><img src="../../closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html">oomph::DistributableLinearAlgebraObject</a></td></tr>
<tr class="memitem:a30742aa2ac9abcfa037179f2d28ff43a inherit pro_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a30742aa2ac9abcfa037179f2d28ff43a">clear_distribution</a> ()</td></tr>
<tr class="separator:a30742aa2ac9abcfa037179f2d28ff43a inherit pro_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classoomph_1_1LinearSolver"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classoomph_1_1LinearSolver')"><img src="../../closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html">oomph::LinearSolver</a></td></tr>
<tr class="memitem:a5f5e7e7a44ff0897b0e4cd9524000edc inherit pro_attribs_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a5f5e7e7a44ff0897b0e4cd9524000edc">Enable_resolve</a></td></tr>
<tr class="separator:a5f5e7e7a44ff0897b0e4cd9524000edc inherit pro_attribs_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a536e41b50b3f3464ca9cb4a5776acc19 inherit pro_attribs_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a536e41b50b3f3464ca9cb4a5776acc19">Doc_time</a></td></tr>
<tr class="memdesc:a536e41b50b3f3464ca9cb4a5776acc19 inherit pro_attribs_classoomph_1_1LinearSolver"><td class="mdescLeft">&#160;</td><td class="mdescRight">Boolean flag that indicates whether the time taken.  <a href="../../d5/dd7/classoomph_1_1LinearSolver.html#a536e41b50b3f3464ca9cb4a5776acc19">More...</a><br /></td></tr>
<tr class="separator:a536e41b50b3f3464ca9cb4a5776acc19 inherit pro_attribs_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef857e4c0c16e8b342a14493e558bb15 inherit pro_attribs_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#aef857e4c0c16e8b342a14493e558bb15">Compute_gradient</a></td></tr>
<tr class="separator:aef857e4c0c16e8b342a14493e558bb15 inherit pro_attribs_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fd3bf9a5a94dcc23b7d903f99535e72 inherit pro_attribs_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a9fd3bf9a5a94dcc23b7d903f99535e72">Gradient_has_been_computed</a></td></tr>
<tr class="memdesc:a9fd3bf9a5a94dcc23b7d903f99535e72 inherit pro_attribs_classoomph_1_1LinearSolver"><td class="mdescLeft">&#160;</td><td class="mdescRight">flag that indicates whether the gradient was computed or not  <a href="../../d5/dd7/classoomph_1_1LinearSolver.html#a9fd3bf9a5a94dcc23b7d903f99535e72">More...</a><br /></td></tr>
<tr class="separator:a9fd3bf9a5a94dcc23b7d903f99535e72 inherit pro_attribs_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad38255ae12611787a857cc5c90ffa9f8 inherit pro_attribs_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#ad38255ae12611787a857cc5c90ffa9f8">Gradient_for_glob_conv_newton_solve</a></td></tr>
<tr class="separator:ad38255ae12611787a857cc5c90ffa9f8 inherit pro_attribs_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Wrapper to Mumps solver. </p>
</div><h2 class="groupheader">Member Enumeration Documentation</h2>
<a id="a5e380357c515b4f280cf6bdf7273ed4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e380357c515b4f280cf6bdf7273ed4b">&#9670;&nbsp;</a></span>MumpsJacobianOrderingFlags</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a5e380357c515b4f280cf6bdf7273ed4b">oomph::MumpsSolver::MumpsJacobianOrderingFlags</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>ordering library to use for serial analysis; magic numbers as defined by MUMPS documentation </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a5e380357c515b4f280cf6bdf7273ed4ba8484bf86594bef6f3509ca968e65eb1d"></a>Scotch_ordering&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a5e380357c515b4f280cf6bdf7273ed4ba13393a6ca320fac921fdc389ef247f10"></a>Pord_ordering&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a5e380357c515b4f280cf6bdf7273ed4ba3f76be5ac72cb29a86f05019e0b7f496"></a>Metis_ordering&#160;</td><td class="fielddoc"></td></tr>
</table>
<div class="fragment"><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    {</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a5e380357c515b4f280cf6bdf7273ed4ba8484bf86594bef6f3509ca968e65eb1d">Scotch_ordering</a> = 3,</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a5e380357c515b4f280cf6bdf7273ed4ba13393a6ca320fac921fdc389ef247f10">Pord_ordering</a> = 4,</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a5e380357c515b4f280cf6bdf7273ed4ba3f76be5ac72cb29a86f05019e0b7f496">Metis_ordering</a> = 5</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    };</div>
<div class="ttc" id="aclassoomph_1_1MumpsSolver_html_a5e380357c515b4f280cf6bdf7273ed4ba13393a6ca320fac921fdc389ef247f10"><div class="ttname"><a href="../../d6/d11/classoomph_1_1MumpsSolver.html#a5e380357c515b4f280cf6bdf7273ed4ba13393a6ca320fac921fdc389ef247f10">oomph::MumpsSolver::Pord_ordering</a></div><div class="ttdeci">@ Pord_ordering</div><div class="ttdef"><b>Definition:</b> mumps_solver.h:314</div></div>
<div class="ttc" id="aclassoomph_1_1MumpsSolver_html_a5e380357c515b4f280cf6bdf7273ed4ba3f76be5ac72cb29a86f05019e0b7f496"><div class="ttname"><a href="../../d6/d11/classoomph_1_1MumpsSolver.html#a5e380357c515b4f280cf6bdf7273ed4ba3f76be5ac72cb29a86f05019e0b7f496">oomph::MumpsSolver::Metis_ordering</a></div><div class="ttdeci">@ Metis_ordering</div><div class="ttdef"><b>Definition:</b> mumps_solver.h:315</div></div>
<div class="ttc" id="aclassoomph_1_1MumpsSolver_html_a5e380357c515b4f280cf6bdf7273ed4ba8484bf86594bef6f3509ca968e65eb1d"><div class="ttname"><a href="../../d6/d11/classoomph_1_1MumpsSolver.html#a5e380357c515b4f280cf6bdf7273ed4ba8484bf86594bef6f3509ca968e65eb1d">oomph::MumpsSolver::Scotch_ordering</a></div><div class="ttdeci">@ Scotch_ordering</div><div class="ttdef"><b>Definition:</b> mumps_solver.h:313</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aeffb9b19a97ee7ba86336b694a57d836"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeffb9b19a97ee7ba86336b694a57d836">&#9670;&nbsp;</a></span>MumpsJacobianSymmetryFlags</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#aeffb9b19a97ee7ba86336b694a57d836">oomph::MumpsSolver::MumpsJacobianSymmetryFlags</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>values of the SYM variable used by the MUMPS solver which dictates the symmetry properties of the Jacobian matrix; magic numbers as defined by MUMPS documentation </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="aeffb9b19a97ee7ba86336b694a57d836a8e20922b3a1dbfa7ddb6ca95c35b03a8"></a>Unsymmetric&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aeffb9b19a97ee7ba86336b694a57d836aafd4b90b3304bd19bd2998f9464e4095"></a>Symmetric_positive_definite&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aeffb9b19a97ee7ba86336b694a57d836ac37b58b1aad1705a3986aad20494e1c0"></a>Symmetric&#160;</td><td class="fielddoc"></td></tr>
</table>
<div class="fragment"><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    {</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#aeffb9b19a97ee7ba86336b694a57d836a8e20922b3a1dbfa7ddb6ca95c35b03a8">Unsymmetric</a> = 0,</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#aeffb9b19a97ee7ba86336b694a57d836aafd4b90b3304bd19bd2998f9464e4095">Symmetric_positive_definite</a> = 1,</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#aeffb9b19a97ee7ba86336b694a57d836ac37b58b1aad1705a3986aad20494e1c0">Symmetric</a> = 2</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    };</div>
<div class="ttc" id="aclassoomph_1_1MumpsSolver_html_aeffb9b19a97ee7ba86336b694a57d836a8e20922b3a1dbfa7ddb6ca95c35b03a8"><div class="ttname"><a href="../../d6/d11/classoomph_1_1MumpsSolver.html#aeffb9b19a97ee7ba86336b694a57d836a8e20922b3a1dbfa7ddb6ca95c35b03a8">oomph::MumpsSolver::Unsymmetric</a></div><div class="ttdeci">@ Unsymmetric</div><div class="ttdef"><b>Definition:</b> mumps_solver.h:304</div></div>
<div class="ttc" id="aclassoomph_1_1MumpsSolver_html_aeffb9b19a97ee7ba86336b694a57d836aafd4b90b3304bd19bd2998f9464e4095"><div class="ttname"><a href="../../d6/d11/classoomph_1_1MumpsSolver.html#aeffb9b19a97ee7ba86336b694a57d836aafd4b90b3304bd19bd2998f9464e4095">oomph::MumpsSolver::Symmetric_positive_definite</a></div><div class="ttdeci">@ Symmetric_positive_definite</div><div class="ttdef"><b>Definition:</b> mumps_solver.h:305</div></div>
<div class="ttc" id="aclassoomph_1_1MumpsSolver_html_aeffb9b19a97ee7ba86336b694a57d836ac37b58b1aad1705a3986aad20494e1c0"><div class="ttname"><a href="../../d6/d11/classoomph_1_1MumpsSolver.html#aeffb9b19a97ee7ba86336b694a57d836ac37b58b1aad1705a3986aad20494e1c0">oomph::MumpsSolver::Symmetric</a></div><div class="ttdeci">@ Symmetric</div><div class="ttdef"><b>Definition:</b> mumps_solver.h:306</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ac3f965da46774f48a9b756610f81140e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3f965da46774f48a9b756610f81140e">&#9670;&nbsp;</a></span>MumpsSolver() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">oomph::MumpsSolver::MumpsSolver </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor: Call setup. </p>
<div class="fragment"><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    : <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a851b95821f3adce5545e7abe238b3cce">Suppress_solve</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a8dc51b4b7e2b121773aea1ed7820ea16">Doc_stats</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a4a770886867c62d2eff6afe4b091fabd">Suppress_warning_about_MPI_COMM_WORLD</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#acfc51e1ed214d9d2dc5a83b04a08d1f7">Suppress_mumps_info_during_solve</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a3512c04b1bfcf11064c0da453ba34806">Mumps_is_initialised</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a78d0283ea0263a5b31b7662d7abdfcb8">Workspace_scaling_factor</a>(<a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#ad6bd1660c9c62b039b9cdd8074169a25">Default_workspace_scaling_factor</a>),</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a88430ee69fb2015c48ec123b26e019e9">Delete_matrix_data</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>(<span class="keyword">nullptr</span>),</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#ab816409c94736fea48814096af0bd14b">Jacobian_symmetry_flag</a>(MumpsJacobianSymmetryFlags::Unsymmetric),</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a3358fea674f17424aac41152aeb7f990">Jacobian_ordering_flag</a>(MumpsJacobianOrderingFlags::Metis_ordering)</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1MumpsSolver_html_a0cf148106cf3cc86e238ae4f289be0f8"><div class="ttname"><a href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">oomph::MumpsSolver::Mumps_struc_pt</a></div><div class="ttdeci">DMUMPS_STRUC_C * Mumps_struc_pt</div><div class="ttdoc">Pointer to MUMPS struct that contains the solver data.</div><div class="ttdef"><b>Definition:</b> mumps_solver.h:297</div></div>
<div class="ttc" id="aclassoomph_1_1MumpsSolver_html_a3358fea674f17424aac41152aeb7f990"><div class="ttname"><a href="../../d6/d11/classoomph_1_1MumpsSolver.html#a3358fea674f17424aac41152aeb7f990">oomph::MumpsSolver::Jacobian_ordering_flag</a></div><div class="ttdeci">unsigned Jacobian_ordering_flag</div><div class="ttdef"><b>Definition:</b> mumps_solver.h:325</div></div>
<div class="ttc" id="aclassoomph_1_1MumpsSolver_html_a3512c04b1bfcf11064c0da453ba34806"><div class="ttname"><a href="../../d6/d11/classoomph_1_1MumpsSolver.html#a3512c04b1bfcf11064c0da453ba34806">oomph::MumpsSolver::Mumps_is_initialised</a></div><div class="ttdeci">bool Mumps_is_initialised</div><div class="ttdoc">Has mumps been initialised?</div><div class="ttdef"><b>Definition:</b> mumps_solver.h:274</div></div>
<div class="ttc" id="aclassoomph_1_1MumpsSolver_html_a4a770886867c62d2eff6afe4b091fabd"><div class="ttname"><a href="../../d6/d11/classoomph_1_1MumpsSolver.html#a4a770886867c62d2eff6afe4b091fabd">oomph::MumpsSolver::Suppress_warning_about_MPI_COMM_WORLD</a></div><div class="ttdeci">bool Suppress_warning_about_MPI_COMM_WORLD</div><div class="ttdef"><b>Definition:</b> mumps_solver.h:268</div></div>
<div class="ttc" id="aclassoomph_1_1MumpsSolver_html_a78d0283ea0263a5b31b7662d7abdfcb8"><div class="ttname"><a href="../../d6/d11/classoomph_1_1MumpsSolver.html#a78d0283ea0263a5b31b7662d7abdfcb8">oomph::MumpsSolver::Workspace_scaling_factor</a></div><div class="ttdeci">unsigned Workspace_scaling_factor</div><div class="ttdef"><b>Definition:</b> mumps_solver.h:277</div></div>
<div class="ttc" id="aclassoomph_1_1MumpsSolver_html_a851b95821f3adce5545e7abe238b3cce"><div class="ttname"><a href="../../d6/d11/classoomph_1_1MumpsSolver.html#a851b95821f3adce5545e7abe238b3cce">oomph::MumpsSolver::Suppress_solve</a></div><div class="ttdeci">bool Suppress_solve</div><div class="ttdoc">Suppress solve?</div><div class="ttdef"><b>Definition:</b> mumps_solver.h:261</div></div>
<div class="ttc" id="aclassoomph_1_1MumpsSolver_html_a88430ee69fb2015c48ec123b26e019e9"><div class="ttname"><a href="../../d6/d11/classoomph_1_1MumpsSolver.html#a88430ee69fb2015c48ec123b26e019e9">oomph::MumpsSolver::Delete_matrix_data</a></div><div class="ttdeci">bool Delete_matrix_data</div><div class="ttdef"><b>Definition:</b> mumps_solver.h:285</div></div>
<div class="ttc" id="aclassoomph_1_1MumpsSolver_html_a8dc51b4b7e2b121773aea1ed7820ea16"><div class="ttname"><a href="../../d6/d11/classoomph_1_1MumpsSolver.html#a8dc51b4b7e2b121773aea1ed7820ea16">oomph::MumpsSolver::Doc_stats</a></div><div class="ttdeci">bool Doc_stats</div><div class="ttdoc">Set to true for MumpsSolver to output statistics (false by default).</div><div class="ttdef"><b>Definition:</b> mumps_solver.h:264</div></div>
<div class="ttc" id="aclassoomph_1_1MumpsSolver_html_ab816409c94736fea48814096af0bd14b"><div class="ttname"><a href="../../d6/d11/classoomph_1_1MumpsSolver.html#ab816409c94736fea48814096af0bd14b">oomph::MumpsSolver::Jacobian_symmetry_flag</a></div><div class="ttdeci">unsigned Jacobian_symmetry_flag</div><div class="ttdef"><b>Definition:</b> mumps_solver.h:320</div></div>
<div class="ttc" id="aclassoomph_1_1MumpsSolver_html_acfc51e1ed214d9d2dc5a83b04a08d1f7"><div class="ttname"><a href="../../d6/d11/classoomph_1_1MumpsSolver.html#acfc51e1ed214d9d2dc5a83b04a08d1f7">oomph::MumpsSolver::Suppress_mumps_info_during_solve</a></div><div class="ttdeci">bool Suppress_mumps_info_during_solve</div><div class="ttdoc">Boolean to suppress info being printed to screen during MUMPS solve.</div><div class="ttdef"><b>Definition:</b> mumps_solver.h:271</div></div>
<div class="ttc" id="aclassoomph_1_1MumpsSolver_html_ad6bd1660c9c62b039b9cdd8074169a25"><div class="ttname"><a href="../../d6/d11/classoomph_1_1MumpsSolver.html#ad6bd1660c9c62b039b9cdd8074169a25">oomph::MumpsSolver::Default_workspace_scaling_factor</a></div><div class="ttdeci">static int Default_workspace_scaling_factor</div><div class="ttdef"><b>Definition:</b> mumps_solver.h:209</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a85731b5c626437479245e91f20e18500"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85731b5c626437479245e91f20e18500">&#9670;&nbsp;</a></span>MumpsSolver() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">oomph::MumpsSolver::MumpsSolver </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html">MumpsSolver</a> &amp;&#160;</td>
          <td class="paramname"><em>dummy</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Broken copy constructor. </p>

</div>
</div>
<a id="a20e6116da9911337fb80486bcfaf7eb4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20e6116da9911337fb80486bcfaf7eb4">&#9670;&nbsp;</a></span>~MumpsSolver()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">oomph::MumpsSolver::~MumpsSolver </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destructor: Cleanup. </p>
<p>Destructor: Shutdown mumps. </p>
<div class="fragment"><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a5cf1f5e02e905d39e1b324dc921568f6">shutdown_mumps</a>();</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1MumpsSolver_html_a5cf1f5e02e905d39e1b324dc921568f6"><div class="ttname"><a href="../../d6/d11/classoomph_1_1MumpsSolver.html#a5cf1f5e02e905d39e1b324dc921568f6">oomph::MumpsSolver::shutdown_mumps</a></div><div class="ttdeci">void shutdown_mumps()</div><div class="ttdoc">Shutdown mumps.</div><div class="ttdef"><b>Definition:</b> mumps_solver.cc:141</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a5cf1f5e02e905d39e1b324dc921568f6">shutdown_mumps()</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a92ab601b671c2b7eea44a470aa5ec4f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92ab601b671c2b7eea44a470aa5ec4f3">&#9670;&nbsp;</a></span>backsub()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::MumpsSolver::backsub </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;&#160;</td>
          <td class="paramname"><em>rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Do the backsubstitution for mumps solver Note: returns the global result Vector.</p>
<p>Do the backsubstitution for mumps solver. This does not make any assumption about the distribution of the vectors </p>
<div class="fragment"><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  {</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="keywordtype">double</span> t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160; </div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a4a770886867c62d2eff6afe4b091fabd">Suppress_warning_about_MPI_COMM_WORLD</a>)</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    {</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>()-&gt;communicator_pt()-&gt;mpi_comm() !=</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;          MPI_COMM_WORLD)</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;      {</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        std::ostringstream error_message_stream;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        error_message_stream</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;Warning: Mumps wrapper assumes that communicator is &quot;</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;             <span class="stringliteral">&quot;MPI_COMM_WORLD\n&quot;</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;         which is not the case, so mumps may die...\n&quot;</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;         If it does initialise oomph-lib&#39;s mpi without &quot;</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;             <span class="stringliteral">&quot;requesting\n&quot;</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;         the communicator to be a duplicate of MPI_COMM_WORLD\n&quot;</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;         (done via an optional boolean to &quot;</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;             <span class="stringliteral">&quot;MPI_Helpers::init(...)\n\n&quot;</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;         (You can suppress this warning by recompiling without\n&quot;</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;         paranoia or calling \n\n&quot;</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;         &quot;</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;             <span class="stringliteral">&quot;MumpsSolver::enable_suppress_warning_about_MPI_COMM_WORLD()\n\n&quot;</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;         \n&quot;</span>;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        OomphLibWarning(error_message_stream.str(),</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                        <span class="stringliteral">&quot;MumpsSolver::backsub()&quot;</span>,</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                        <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;      }</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    }</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160; </div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="comment">// Initialised?</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a3512c04b1bfcf11064c0da453ba34806">Mumps_is_initialised</a>)</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    {</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      std::ostringstream error_message_stream;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;      error_message_stream &lt;&lt; <span class="stringliteral">&quot;Mumps has not been initialised.&quot;</span>;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(error_message_stream.str(),</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    }</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160; </div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <span class="comment">// check that the rhs vector is setup</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="keywordflow">if</span> (!rhs.distribution_pt()-&gt;built())</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    {</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;      std::ostringstream error_message_stream;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;      error_message_stream &lt;&lt; <span class="stringliteral">&quot;The vectors rhs must be setup&quot;</span>;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(error_message_stream.str(),</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    }</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160; </div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160; </div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="comment">// Check that the rhs distribution is the same as the distribution as this</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="comment">// solver. If not redistribute and issue a warning</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    LinearAlgebraDistribution rhs_distribution(rhs.distribution_pt());</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="keywordflow">if</span> (!(*rhs.distribution_pt() == *this-&gt;distribution_pt()))</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    {</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#ab0656b67b21335203eb7fbce8c7c7535">Suppress_incorrect_rhs_distribution_warning_in_resolve</a>)</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;      {</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        std::ostringstream warning_stream;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        warning_stream &lt;&lt; <span class="stringliteral">&quot;The distribution of rhs vector does not match that &quot;</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                          <span class="stringliteral">&quot;of the solver.\n&quot;</span>;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        warning_stream</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;The rhs may have to be redistributed but we&#39;re not doing this &quot;</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;             <span class="stringliteral">&quot;because\n&quot;</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;I&#39;m no longer convinced it&#39;s necessary. Keep an eye on this...\n&quot;</span>;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        warning_stream</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;To remove this warning you can either:\n&quot;</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;    i) Ensure that the rhs vector has the correct distribution\n&quot;</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;       before calling the resolve() function\n&quot;</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;or ii) Set the flag \n&quot;</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;          &lt;&lt; <span class="stringliteral">&quot; MumpsSolver::Suppress_incorrect_rhs_distribution_warning_in_&quot;</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;             <span class="stringliteral">&quot;resolve\n&quot;</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;       to be true\n\n&quot;</span>;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160; </div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        OomphLibWarning(warning_stream.str(),</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                        <span class="stringliteral">&quot;MumpsSolver::resolve()&quot;</span>,</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                        <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;      }</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160; </div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;      <span class="comment">// //Have to cast away const-ness (which tells us that we shouldn&#39;t really</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;      <span class="comment">// //be doing this!)</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;      <span class="comment">// const_cast&lt;DoubleVector&amp;&gt;(rhs).redistribute(this-&gt;distribution_pt());</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    }</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160; </div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160; </div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    <span class="comment">// if the result vector is setup then check it has the same distribution</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <span class="comment">// as the rhs</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <span class="keywordflow">if</span> (result.distribution_built())</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    {</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;      <span class="keywordflow">if</span> (!(*result.distribution_pt() == *rhs.distribution_pt()))</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;      {</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        std::ostringstream error_message_stream;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        error_message_stream</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;The result vector distribution has been setup; it must have the &quot;</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;same distribution as the rhs vector.&quot;</span>;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(error_message_stream.str(),</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;      }</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    }</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160; </div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160; </div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <span class="comment">// Doc stats?</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a8dc51b4b7e2b121773aea1ed7820ea16">Doc_stats</a>)</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    {</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;      <span class="comment">// Output stream for global info on host. Negative value suppresses</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;      <span class="comment">// printing</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;      <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>-&gt;ICNTL(3) = 6;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    }</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160; </div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <span class="comment">// number of DOFs</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <span class="keywordtype">int</span> ndof = this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>()-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#aafad0b69de2284808366b65bd63e493b">nrow</a>();</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160; </div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <span class="comment">// Make backup to avoid over-writing</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <a class="code" href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a> tmp_rhs;</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    tmp_rhs = rhs;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160; </div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <span class="comment">// Now turn this into a global (non-distributed) vector</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <span class="comment">// because that&#39;s what mumps needs</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160; </div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    <span class="comment">// Make a global distribution (i.e. one that isn&#39;t distributed)</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    LinearAlgebraDistribution global_distribution(</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;      this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>()-&gt;communicator_pt(), ndof, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160; </div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="comment">// Redistribute the tmp_rhs vector with this distribution -- it&#39;s</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <span class="comment">// now &quot;global&quot;, as required for mumps</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    tmp_rhs.redistribute(&amp;global_distribution);</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160; </div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <span class="comment">// Do the backsubsitution phase -- overwrites the tmp_rhs vector with the</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    <span class="comment">// solution</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>-&gt;rhs = &amp;tmp_rhs[0];</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>-&gt;job = 3;</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    dmumps_c(<a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>);</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160; </div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <span class="comment">// Copy back</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>-&gt;n;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    {</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;      tmp_rhs[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>] = <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>-&gt;rhs[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>];</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    }</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160; </div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <span class="comment">// Broadcast the result which is only held on root</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    MPI_Bcast(&amp;tmp_rhs[0],</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;              ndof,</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;              MPI_DOUBLE,</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;              0,</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;              this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>()-&gt;communicator_pt()-&gt;mpi_comm());</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160; </div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <span class="comment">// If the result vector is distributed, re-distribute the</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    <span class="comment">// non-distributed tmp_rhs vector to match</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="keywordflow">if</span> (result.built())</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    {</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;      tmp_rhs.redistribute(result.distribution_pt());</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    }</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    {</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;      tmp_rhs.redistribute(this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>());</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    }</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160; </div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <span class="comment">// Now copy the tmp_rhs vector into the (matching) result</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    result = tmp_rhs;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160; </div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a536e41b50b3f3464ca9cb4a5776acc19">Doc_time</a>) &amp;&amp;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        (this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>()-&gt;communicator_pt()-&gt;my_rank() == 0))</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    {</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;      <span class="keywordtype">double</span> t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for MumpsSolver backsub                            : &quot;</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                 &lt;&lt; <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#ae746b756dfb86c00c7cf37558a7870f3">TimingHelpers::convert_secs_to_formatted_string</a>(t_end -</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                                                                    t_start)</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                 &lt;&lt; std::endl;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    }</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160; </div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="comment">// Switch off docing again by setting output stream for global info on</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <span class="comment">// to negative number</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>-&gt;ICNTL(3) = -1;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  }</div>
<div class="ttc" id="aCG3DPackingUnitTest_8cpp_html_a7026fd16370249ce97cb3d062326baf9"><div class="ttname"><a href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a></div><div class="ttdeci">const unsigned n</div><div class="ttdef"><b>Definition:</b> CG3DPackingUnitTest.cpp:11</div></div>
<div class="ttc" id="aClumpInput_8h_html_a82f6bc76e1c7a0f51bf3e95ad5d3c590"><div class="ttname"><a href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a></div><div class="ttdeci">std::vector&lt; double &gt; DoubleVector</div><div class="ttdoc">loads clump configuration</div><div class="ttdef"><b>Definition:</b> ClumpInput.h:26</div></div>
<div class="ttc" id="aclassoomph_1_1DistributableLinearAlgebraObject_html_a603105384d60c9a3710378af39f538b9"><div class="ttname"><a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">oomph::DistributableLinearAlgebraObject::distribution_pt</a></div><div class="ttdeci">LinearAlgebraDistribution * distribution_pt() const</div><div class="ttdoc">access to the LinearAlgebraDistribution</div><div class="ttdef"><b>Definition:</b> linear_algebra_distribution.h:457</div></div>
<div class="ttc" id="aclassoomph_1_1LinearAlgebraDistribution_html_aafad0b69de2284808366b65bd63e493b"><div class="ttname"><a href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#aafad0b69de2284808366b65bd63e493b">oomph::LinearAlgebraDistribution::nrow</a></div><div class="ttdeci">unsigned nrow() const</div><div class="ttdoc">access function to the number of global rows.</div><div class="ttdef"><b>Definition:</b> linear_algebra_distribution.h:186</div></div>
<div class="ttc" id="aclassoomph_1_1LinearSolver_html_a536e41b50b3f3464ca9cb4a5776acc19"><div class="ttname"><a href="../../d5/dd7/classoomph_1_1LinearSolver.html#a536e41b50b3f3464ca9cb4a5776acc19">oomph::LinearSolver::Doc_time</a></div><div class="ttdeci">bool Doc_time</div><div class="ttdoc">Boolean flag that indicates whether the time taken.</div><div class="ttdef"><b>Definition:</b> linear_solver.h:77</div></div>
<div class="ttc" id="aclassoomph_1_1MumpsSolver_html_ab0656b67b21335203eb7fbce8c7c7535"><div class="ttname"><a href="../../d6/d11/classoomph_1_1MumpsSolver.html#ab0656b67b21335203eb7fbce8c7c7535">oomph::MumpsSolver::Suppress_incorrect_rhs_distribution_warning_in_resolve</a></div><div class="ttdeci">static bool Suppress_incorrect_rhs_distribution_warning_in_resolve</div><div class="ttdef"><b>Definition:</b> mumps_solver.h:66</div></div>
<div class="ttc" id="anamespaceoomph_1_1TimingHelpers_html_a9fb6ad7e2e01b0914e9f7072ef9ebfa6"><div class="ttname"><a href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">oomph::TimingHelpers::timer</a></div><div class="ttdeci">double timer()</div><div class="ttdoc">returns the time in seconds after some point in past</div><div class="ttdef"><b>Definition:</b> oomph_utilities.cc:1295</div></div>
<div class="ttc" id="anamespaceoomph_1_1TimingHelpers_html_ae746b756dfb86c00c7cf37558a7870f3"><div class="ttname"><a href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#ae746b756dfb86c00c7cf37558a7870f3">oomph::TimingHelpers::convert_secs_to_formatted_string</a></div><div class="ttdeci">std::string convert_secs_to_formatted_string(const double &amp;time_in_sec)</div><div class="ttdef"><b>Definition:</b> oomph_utilities.cc:1316</div></div>
<div class="ttc" id="anamespaceoomph_html_aec474227917784dc0a255faf289cfc16"><div class="ttname"><a href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a></div><div class="ttdeci">OomphInfo oomph_info</div><div class="ttdef"><b>Definition:</b> oomph_definitions.cc:319</div></div>
<div class="ttc" id="aoomph__definitions_8h_html_a25c6813cc7341d125e2502f8923fb6c4"><div class="ttname"><a href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a></div><div class="ttdeci">#define OOMPH_EXCEPTION_LOCATION</div><div class="ttdef"><b>Definition:</b> oomph_definitions.h:61</div></div>
<div class="ttc" id="aoomph__definitions_8h_html_aa260cc4af589e30cea7fde997ae16667"><div class="ttname"><a href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a></div><div class="ttdeci">#define OOMPH_CURRENT_FUNCTION</div><div class="ttdef"><b>Definition:</b> oomph_definitions.h:86</div></div>
<div class="ttc" id="atut__arithmetic__redux__minmax_8cpp_html_a39513f0f8d942bf9ef17b2e87ac6d34e"><div class="ttname"><a href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a></div><div class="ttdeci">std::ptrdiff_t j</div><div class="ttdef"><b>Definition:</b> tut_arithmetic_redux_minmax.cpp:2</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#aae402d422ec4344a4a45cdb7659b7161">oomph::DoubleVector::built()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a92bfff97fd228b9c528922c39ab563b2">oomph::LinearAlgebraDistribution::built()</a>, <a class="el" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#ae746b756dfb86c00c7cf37558a7870f3">oomph::TimingHelpers::convert_secs_to_formatted_string()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a8c35baa65e335043f62954c92c090a5a">oomph::DistributableLinearAlgebraObject::distribution_built()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">oomph::DistributableLinearAlgebraObject::distribution_pt()</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a8dc51b4b7e2b121773aea1ed7820ea16">Doc_stats</a>, <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a536e41b50b3f3464ca9cb4a5776acc19">oomph::LinearSolver::Doc_time</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a3512c04b1bfcf11064c0da453ba34806">Mumps_is_initialised</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>, <a class="el" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#aafad0b69de2284808366b65bd63e493b">oomph::LinearAlgebraDistribution::nrow()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#a9396b861977c16606d8eca39056976c8">oomph::DoubleVector::redistribute()</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#ab0656b67b21335203eb7fbce8c7c7535">Suppress_incorrect_rhs_distribution_warning_in_resolve</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a4a770886867c62d2eff6afe4b091fabd">Suppress_warning_about_MPI_COMM_WORLD</a>, and <a class="el" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">oomph::TimingHelpers::timer()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a849d13cac2177452446c2ec387a0260f">resolve()</a>, and <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a3995dcf46675fc443b4d373d348a0fdf">solve()</a>.</p>

</div>
</div>
<a id="adc1541e4a9cbbe9c641f988380618713"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc1541e4a9cbbe9c641f988380618713">&#9670;&nbsp;</a></span>clean_up_memory()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::MumpsSolver::clean_up_memory </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Clean up the memory allocated by the mumps solver. </p>
<p>Clean up the memory allocated for the MumpsSolver solver. </p>

<p>Reimplemented from <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a9d66f3262e80ca06a365f98216afd85f">oomph::LinearSolver</a>.</p>
<div class="fragment"><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  {</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a5cf1f5e02e905d39e1b324dc921568f6">shutdown_mumps</a>();</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a5cf1f5e02e905d39e1b324dc921568f6">shutdown_mumps()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d4e/classoomph_1_1NewMumpsPreconditioner.html#a4a6cb6cc1207a765cc02ef47c6efa6e0">oomph::NewMumpsPreconditioner::clean_up_memory()</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#aba2b1c844e190da45c8adbd6dfc0f344">disable_resolve()</a>, and <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a3995dcf46675fc443b4d373d348a0fdf">solve()</a>.</p>

</div>
</div>
<a id="a752f8f023f3b6c1b7021ad6683853850"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a752f8f023f3b6c1b7021ad6683853850">&#9670;&nbsp;</a></span>declare_jacobian_is_symmetric()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::MumpsSolver::declare_jacobian_is_symmetric </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Tell MUMPS that the Jacobian matrix is general symmetric. </p>
<div class="fragment"><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    {</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#ab816409c94736fea48814096af0bd14b">Jacobian_symmetry_flag</a> = <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#aeffb9b19a97ee7ba86336b694a57d836ac37b58b1aad1705a3986aad20494e1c0">Symmetric</a>;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#ab816409c94736fea48814096af0bd14b">Jacobian_symmetry_flag</a>, and <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#aeffb9b19a97ee7ba86336b694a57d836ac37b58b1aad1705a3986aad20494e1c0">Symmetric</a>.</p>

</div>
</div>
<a id="aee53c09d398f6a982de5dc5fa9c02df7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee53c09d398f6a982de5dc5fa9c02df7">&#9670;&nbsp;</a></span>declare_jacobian_is_symmetric_positive_definite()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::MumpsSolver::declare_jacobian_is_symmetric_positive_definite </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Tell MUMPS that the Jacobian matrix is symmetric positive-definite. </p>
<div class="fragment"><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    {</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#ab816409c94736fea48814096af0bd14b">Jacobian_symmetry_flag</a> = <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#aeffb9b19a97ee7ba86336b694a57d836aafd4b90b3304bd19bd2998f9464e4095">Symmetric_positive_definite</a>;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#ab816409c94736fea48814096af0bd14b">Jacobian_symmetry_flag</a>, and <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#aeffb9b19a97ee7ba86336b694a57d836aafd4b90b3304bd19bd2998f9464e4095">Symmetric_positive_definite</a>.</p>

</div>
</div>
<a id="af6bceea5ab29bbc30322b092b227ac03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6bceea5ab29bbc30322b092b227ac03">&#9670;&nbsp;</a></span>declare_jacobian_is_unsymmetric()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::MumpsSolver::declare_jacobian_is_unsymmetric </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Tell MUMPS that the Jacobian matrix is unsymmetric. </p>
<div class="fragment"><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    {</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#ab816409c94736fea48814096af0bd14b">Jacobian_symmetry_flag</a> = <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#aeffb9b19a97ee7ba86336b694a57d836a8e20922b3a1dbfa7ddb6ca95c35b03a8">Unsymmetric</a>;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#ab816409c94736fea48814096af0bd14b">Jacobian_symmetry_flag</a>, and <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#aeffb9b19a97ee7ba86336b694a57d836a8e20922b3a1dbfa7ddb6ca95c35b03a8">Unsymmetric</a>.</p>

</div>
</div>
<a id="a52b3fbf9407cb8284f1c80600b11869f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52b3fbf9407cb8284f1c80600b11869f">&#9670;&nbsp;</a></span>disable_delete_matrix_data()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::MumpsSolver::disable_delete_matrix_data </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Unset Delete_matrix_data flag. MumpsSolver needs its own copy of the input matrix, therefore a copy must be made if any matrix used with this solver is to be preserved. If the input matrix can be deleted the flag can be set to true to reduce the amount of memory required, and the matrix data will be wiped using its clean_up_memory() function. Default value is false. </p>
<div class="fragment"><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a88430ee69fb2015c48ec123b26e019e9">Delete_matrix_data</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a88430ee69fb2015c48ec123b26e019e9">Delete_matrix_data</a>.</p>

</div>
</div>
<a id="a8f64fcf52cb7cbf89b75da1d794dee5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f64fcf52cb7cbf89b75da1d794dee5f">&#9670;&nbsp;</a></span>disable_doc_stats()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::MumpsSolver::disable_doc_stats </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Disable documentation of statistics. </p>
<div class="fragment"><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    {</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a8dc51b4b7e2b121773aea1ed7820ea16">Doc_stats</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a8dc51b4b7e2b121773aea1ed7820ea16">Doc_stats</a>.</p>

</div>
</div>
<a id="aba2b1c844e190da45c8adbd6dfc0f344"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba2b1c844e190da45c8adbd6dfc0f344">&#9670;&nbsp;</a></span>disable_resolve()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::MumpsSolver::disable_resolve </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Overload disable resolve so that it cleans up memory too. </p>

<p>Reimplemented from <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#ad61c63af94c5961830bd9807225a48d6">oomph::LinearSolver</a>.</p>
<div class="fragment"><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    {</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      <a class="code" href="../../d5/dd7/classoomph_1_1LinearSolver.html#ad61c63af94c5961830bd9807225a48d6">LinearSolver::disable_resolve</a>();</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#adc1541e4a9cbbe9c641f988380618713">clean_up_memory</a>();</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1LinearSolver_html_ad61c63af94c5961830bd9807225a48d6"><div class="ttname"><a href="../../d5/dd7/classoomph_1_1LinearSolver.html#ad61c63af94c5961830bd9807225a48d6">oomph::LinearSolver::disable_resolve</a></div><div class="ttdeci">virtual void disable_resolve()</div><div class="ttdef"><b>Definition:</b> linear_solver.h:144</div></div>
<div class="ttc" id="aclassoomph_1_1MumpsSolver_html_adc1541e4a9cbbe9c641f988380618713"><div class="ttname"><a href="../../d6/d11/classoomph_1_1MumpsSolver.html#adc1541e4a9cbbe9c641f988380618713">oomph::MumpsSolver::clean_up_memory</a></div><div class="ttdeci">void clean_up_memory()</div><div class="ttdoc">Clean up the memory allocated by the mumps solver.</div><div class="ttdef"><b>Definition:</b> mumps_solver.cc:710</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#adc1541e4a9cbbe9c641f988380618713">clean_up_memory()</a>, and <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#ad61c63af94c5961830bd9807225a48d6">oomph::LinearSolver::disable_resolve()</a>.</p>

</div>
</div>
<a id="ad75c9ff36be18867a88e0a68fac68f7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad75c9ff36be18867a88e0a68fac68f7c">&#9670;&nbsp;</a></span>disable_suppress_mumps_info_during_solve()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::MumpsSolver::disable_suppress_mumps_info_during_solve </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Don't suppress info being printed to screen during MUMPS solve. </p>
<div class="fragment"><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#acfc51e1ed214d9d2dc5a83b04a08d1f7">Suppress_mumps_info_during_solve</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#acfc51e1ed214d9d2dc5a83b04a08d1f7">Suppress_mumps_info_during_solve</a>.</p>

</div>
</div>
<a id="a34346022a010acc09dc0ab1ce59d90a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34346022a010acc09dc0ab1ce59d90a7">&#9670;&nbsp;</a></span>disable_suppress_solve()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::MumpsSolver::disable_suppress_solve </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Unset the flag so that the system is actually solved again This is the default (obviously) </p>
<div class="fragment"><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a851b95821f3adce5545e7abe238b3cce">Suppress_solve</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a851b95821f3adce5545e7abe238b3cce">Suppress_solve</a>.</p>

</div>
</div>
<a id="ade6f5dff6fddd0eeef6ef051ab5dfbc1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade6f5dff6fddd0eeef6ef051ab5dfbc1">&#9670;&nbsp;</a></span>disable_suppress_warning_about_MPI_COMM_WORLD()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::MumpsSolver::disable_suppress_warning_about_MPI_COMM_WORLD </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Don't suppress warning about communicator not equal to MPI_COMM_WORLD. </p>
<div class="fragment"><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a4a770886867c62d2eff6afe4b091fabd">Suppress_warning_about_MPI_COMM_WORLD</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a4a770886867c62d2eff6afe4b091fabd">Suppress_warning_about_MPI_COMM_WORLD</a>.</p>

</div>
</div>
<a id="afbab47dbf3effebd34f3d3ba1634f7d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afbab47dbf3effebd34f3d3ba1634f7d3">&#9670;&nbsp;</a></span>enable_delete_matrix_data()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::MumpsSolver::enable_delete_matrix_data </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Set Delete_matrix_data flag. MumpsSolver needs its own copy of the input matrix, therefore a copy must be made if any matrix used with this solver is to be preserved. If the input matrix can be deleted the flag can be set to true to reduce the amount of memory required, and the matrix data will be wiped using its clean_up_memory() function. Default value is false. </p>
<div class="fragment"><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a88430ee69fb2015c48ec123b26e019e9">Delete_matrix_data</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a88430ee69fb2015c48ec123b26e019e9">Delete_matrix_data</a>.</p>

</div>
</div>
<a id="a25426798eb831cf552bdc17c0307ff25"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25426798eb831cf552bdc17c0307ff25">&#9670;&nbsp;</a></span>enable_doc_stats()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::MumpsSolver::enable_doc_stats </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Enable documentation of statistics. </p>
<div class="fragment"><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a8dc51b4b7e2b121773aea1ed7820ea16">Doc_stats</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a8dc51b4b7e2b121773aea1ed7820ea16">Doc_stats</a>.</p>

</div>
</div>
<a id="a9be151628e1d8b488441ce2455f888e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9be151628e1d8b488441ce2455f888e1">&#9670;&nbsp;</a></span>enable_suppress_mumps_info_during_solve()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::MumpsSolver::enable_suppress_mumps_info_during_solve </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Set boolean to suppress info being printed to screen during MUMPS solve </p>
<div class="fragment"><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#acfc51e1ed214d9d2dc5a83b04a08d1f7">Suppress_mumps_info_during_solve</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#acfc51e1ed214d9d2dc5a83b04a08d1f7">Suppress_mumps_info_during_solve</a>.</p>

</div>
</div>
<a id="ab5d49803e13ef6e6026e470a9933613e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5d49803e13ef6e6026e470a9933613e">&#9670;&nbsp;</a></span>enable_suppress_solve()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::MumpsSolver::enable_suppress_solve </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Set the flag to avoid solution of the system, so just assemble the Jacobian and the rhs. (Used only for timing runs, obviously) </p>
<div class="fragment"><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a851b95821f3adce5545e7abe238b3cce">Suppress_solve</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a851b95821f3adce5545e7abe238b3cce">Suppress_solve</a>.</p>

</div>
</div>
<a id="a0f7ea8c453b2ff106ce42a11c8182cf5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f7ea8c453b2ff106ce42a11c8182cf5">&#9670;&nbsp;</a></span>enable_suppress_warning_about_MPI_COMM_WORLD()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::MumpsSolver::enable_suppress_warning_about_MPI_COMM_WORLD </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Set boolean to suppress warning about communicator not equal to MPI_COMM_WORLD </p>
<div class="fragment"><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a4a770886867c62d2eff6afe4b091fabd">Suppress_warning_about_MPI_COMM_WORLD</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a4a770886867c62d2eff6afe4b091fabd">Suppress_warning_about_MPI_COMM_WORLD</a>.</p>

</div>
</div>
<a id="aeab520bd25edb0f4e88feaedec689333"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeab520bd25edb0f4e88feaedec689333">&#9670;&nbsp;</a></span>factorise()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::MumpsSolver::factorise </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html">DoubleMatrixBase</a> *const &amp;&#160;</td>
          <td class="paramname"><em>matrix_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Do the factorisation stage Note: if Delete_matrix_data is true the function matrix_pt-&gt;clean_up_memory() will be used to wipe the matrix data.</p>
<p>LU decompose the matrix addressed by matrix_pt using mumps. The resulting matrix factors are stored internally. Note: if Delete_matrix_data is true the function matrix_pt-&gt;clean_up_memory() will be used to wipe the matrix data. </p>
<div class="fragment"><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  {</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="comment">// Initialise timer</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordtype">double</span> t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="comment">// set the distribution</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ac9492d59cff9d9b0098712ae72989cd3">DistributableLinearAlgebraObject</a>* dist_matrix_pt =</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      <span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ac9492d59cff9d9b0098712ae72989cd3">DistributableLinearAlgebraObject</a>*<span class="keyword">&gt;</span>(matrix_pt);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordflow">if</span> (dist_matrix_pt)</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    {</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      <span class="comment">// the solver has the same distribution as the matrix if possible</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ac5340bac40b9559b0378037b57005203">build_distribution</a>(dist_matrix_pt-&gt;distribution_pt());</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    }</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(<span class="stringliteral">&quot;Matrix must be distributable&quot;</span>,</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    }</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="comment">// Check that we have a square matrix</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = matrix_pt-&gt;nrow();</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> = matrix_pt-&gt;ncol();</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> != <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>)</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    {</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      std::ostringstream error_message_stream;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      error_message_stream &lt;&lt; <span class="stringliteral">&quot;Can only solve for square matrices\n&quot;</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                           &lt;&lt; <span class="stringliteral">&quot;N, M &quot;</span> &lt;&lt; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(error_message_stream.str(),</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    }</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a4a770886867c62d2eff6afe4b091fabd">Suppress_warning_about_MPI_COMM_WORLD</a>)</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>()-&gt;communicator_pt()-&gt;mpi_comm() !=</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;          MPI_COMM_WORLD)</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      {</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        std::ostringstream error_message_stream;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        error_message_stream</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;Warning: Mumps wrapper assumes that communicator is &quot;</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;             <span class="stringliteral">&quot;MPI_COMM_WORLD\n&quot;</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;         which is not the case, so mumps may die...\n&quot;</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;         If it does initialise oomph-lib&#39;s mpi without &quot;</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;             <span class="stringliteral">&quot;requesting\n&quot;</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;         the communicator to be a duplicate of MPI_COMM_WORLD\n&quot;</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;         (done via an optional boolean to &quot;</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;             <span class="stringliteral">&quot;MPI_Helpers::init(...)\n\n&quot;</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;         (You can suppress this warning by recompiling without\n&quot;</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;         paranoia or calling \n\n&quot;</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;         &quot;</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;             <span class="stringliteral">&quot;MumpsSolver::enable_suppress_warning_about_MPI_COMM_WORLD()\n\n&quot;</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;         \n&quot;</span>;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        OomphLibWarning(error_message_stream.str(),</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                        <span class="stringliteral">&quot;MumpsSolver::factorise()&quot;</span>,</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                        <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      }</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    }</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="comment">// Initialise</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a3512c04b1bfcf11064c0da453ba34806">Mumps_is_initialised</a>)</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    {</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a5cf1f5e02e905d39e1b324dc921568f6">shutdown_mumps</a>();</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    }</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#ae5e186152100c7d5f045d3df2a115c72">initialise_mumps</a>();</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="comment">// Doc stats?</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a8dc51b4b7e2b121773aea1ed7820ea16">Doc_stats</a>)</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    {</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      <span class="comment">// Output stream for global info on host. Negative value suppresses</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      <span class="comment">// printing</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>-&gt;ICNTL(3) = 6;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    }</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="comment">// number of processors</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordtype">unsigned</span> nproc = 1;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordflow">if</span> (dist_matrix_pt != 0)</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    {</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      nproc = dist_matrix_pt-&gt;distribution_pt()-&gt;communicator_pt()-&gt;nproc();</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    }</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="comment">// Is it a CRDoubleMatrix?</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    CRDoubleMatrix* cr_matrix_pt = <span class="keyword">dynamic_cast&lt;</span>CRDoubleMatrix*<span class="keyword">&gt;</span>(matrix_pt);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keywordflow">if</span> (cr_matrix_pt != 0)</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    {</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      <span class="comment">// paranoid check that the matrix has been set up</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      <span class="keywordflow">if</span> (!cr_matrix_pt-&gt;built())</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      {</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;          <span class="stringliteral">&quot;To apply MumpsSolver to a CRDoubleMatrix - it must be built&quot;</span>,</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      }</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      <span class="comment">// if the matrix is distributed then set up solver</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      <span class="keywordflow">if</span> ((nproc == 1) || (cr_matrix_pt-&gt;distributed()))</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      {</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        <span class="keywordtype">double</span> t_start_copy = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <span class="comment">// Find the number of rows and non-zero entries in the matrix</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> nnz_loc = <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a>(cr_matrix_pt-&gt;nnz());</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = matrix_pt-&gt;nrow();</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <span class="comment">// Create mumps storage</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <span class="comment">// Create vector for row numbers</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a969c7e01bcce31a946e01f03953e0745">Irn_loc</a>.resize(nnz_loc);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <span class="comment">// Create vector for column numbers</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a593d7783708440445e09b6d595168cce">Jcn_loc</a>.resize(nnz_loc);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        <span class="comment">// Vector for entries</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a5b40d6e4d26ada5edef87bc1fa511d06">A_loc</a>.resize(nnz_loc);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="comment">// First row held on this processor</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ab00a3919b8634c698749f14a4d92947d">first_row</a> = cr_matrix_pt-&gt;first_row();</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <span class="comment">// Copy into coordinate storage scheme using pointer arithmetic</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        <span class="keywordtype">double</span>* matrix_value_pt = cr_matrix_pt-&gt;value();</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <span class="keywordtype">int</span>* matrix_index_pt = cr_matrix_pt-&gt;column_index();</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <span class="keywordtype">int</span>* matrix_start_pt = cr_matrix_pt-&gt;row_start();</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <span class="keywordtype">int</span> i_row = 0;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        <span class="comment">// is the matrix symmetric? If so, we must only provide</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <span class="comment">// MUMPS with the upper (or lower) triangular part of the Jacobian</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>-&gt;sym != MumpsJacobianSymmetryFlags::Unsymmetric)</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        {</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Assuming Jacobian matrix is symmetric &quot;</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;(passing MUMPS the upper triangular part)&quot;</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                     &lt;&lt; std::endl;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        }</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160; </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> count = 0; count &lt; nnz_loc; count++)</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        {</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;          <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a5b40d6e4d26ada5edef87bc1fa511d06">A_loc</a>[count] = matrix_value_pt[count];</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;          <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a593d7783708440445e09b6d595168cce">Jcn_loc</a>[count] = matrix_index_pt[count] + 1;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;          <span class="keywordflow">if</span> (count &lt; matrix_start_pt[i_row + 1])</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;          {</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;            <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a969c7e01bcce31a946e01f03953e0745">Irn_loc</a>[count] = <a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ab00a3919b8634c698749f14a4d92947d">first_row</a> + i_row + 1;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;          }</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;          {</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;            i_row++;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a969c7e01bcce31a946e01f03953e0745">Irn_loc</a>[count] = <a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ab00a3919b8634c698749f14a4d92947d">first_row</a> + i_row + 1;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;          }</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;          <span class="comment">// only pass the upper triangular part (and diagonal)</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;          <span class="comment">// if we have a symmetric matrix (MUMPS sums values,</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;          <span class="comment">// so need to set the lwoer triangle to zero)</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;          <span class="keywordflow">if</span> ((<a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>-&gt;sym !=</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;               MumpsJacobianSymmetryFlags::Unsymmetric) &amp;&amp;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;              (<a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a969c7e01bcce31a946e01f03953e0745">Irn_loc</a>[count] &gt; <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a593d7783708440445e09b6d595168cce">Jcn_loc</a>[count]))</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;          {</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a5b40d6e4d26ada5edef87bc1fa511d06">A_loc</a>[count] = 0.0;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;          }</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        }</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160; </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <span class="comment">// Now delete the matrix if we are allowed</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a88430ee69fb2015c48ec123b26e019e9">Delete_matrix_data</a> == <span class="keyword">true</span>)</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        {</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;          cr_matrix_pt-&gt;clear();</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        }</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a536e41b50b3f3464ca9cb4a5776acc19">Doc_time</a>) &amp;&amp;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;            (this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>()-&gt;communicator_pt()-&gt;my_rank() == 0))</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        {</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;          <span class="keywordtype">double</span> t_end_copy = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for copying matrix into MumpsSolver data &quot;</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                        <span class="stringliteral">&quot;structure : &quot;</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                     &lt;&lt; <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#ae746b756dfb86c00c7cf37558a7870f3">TimingHelpers::convert_secs_to_formatted_string</a>(</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                          t_end_copy - t_start_copy)</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                     &lt;&lt; std::endl;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        }</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="comment">// Call mumps factorisation</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <span class="comment">//-------------------------</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160; </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        <span class="comment">// Specify size of system</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>-&gt;n = <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160; </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        <span class="comment">// Number of nonzeroes</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>-&gt;nz_loc = nnz_loc;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160; </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        <span class="comment">// The entries</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>-&gt;irn_loc = &amp;<a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a969c7e01bcce31a946e01f03953e0745">Irn_loc</a>[0];</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>-&gt;jcn_loc = &amp;<a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a593d7783708440445e09b6d595168cce">Jcn_loc</a>[0];</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>-&gt;a_loc = &amp;<a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a5b40d6e4d26ada5edef87bc1fa511d06">A_loc</a>[0];</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160; </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        <span class="keywordtype">double</span> t_start_analyse = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        <span class="comment">// Do analysis</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>-&gt;job = 1;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        dmumps_c(<a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160; </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160; </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a536e41b50b3f3464ca9cb4a5776acc19">Doc_time</a>) &amp;&amp;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            (this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>()-&gt;communicator_pt()-&gt;my_rank() == 0))</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        {</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;          <span class="keywordtype">double</span> t_end_analyse = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;Time for mumps analysis stage in MumpsSolver            : &quot;</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;            &lt;&lt; <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#ae746b756dfb86c00c7cf37558a7870f3">TimingHelpers::convert_secs_to_formatted_string</a>(t_end_analyse -</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                                                               t_start_analyse)</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;\n(Ordering generated using: &quot;</span>;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160; </div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;          <span class="keywordflow">switch</span> (<a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>-&gt;INFOG(7))</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;          {</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            <span class="keywordflow">case</span> MumpsJacobianOrderingFlags::Scotch_ordering:</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;              <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;SCOTCH&quot;</span>;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            <span class="keywordflow">case</span> MumpsJacobianOrderingFlags::Pord_ordering:</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;              <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;PORD&quot;</span>;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;            <span class="keywordflow">case</span> MumpsJacobianOrderingFlags::Metis_ordering:</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;              <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;METIS&quot;</span>;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;              <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>-&gt;INFOG(7);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;          }</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        }</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        <span class="keywordtype">int</span> my_rank = this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>()-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a2e4736826a65253f574d4f6f152ab514">communicator_pt</a>()-&gt;<a class="code" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a670b34aab05bfe0b96d0e0fabf583c7a">my_rank</a>();</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160; </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        <span class="comment">// Document estimate for size of workspace</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        <span class="keywordflow">if</span> (my_rank == 0)</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        {</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;          <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#acfc51e1ed214d9d2dc5a83b04a08d1f7">Suppress_mumps_info_during_solve</a>)</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;          {</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;            <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Estimated max. workspace in MB: &quot;</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                       &lt;&lt; <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>-&gt;INFOG(26) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;          }</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        }</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160; </div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        <span class="keywordtype">double</span> t_start_factor = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160; </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <span class="comment">// Loop until successfully factorised</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <span class="keywordtype">bool</span> factorised = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        <span class="keywordflow">while</span> (!factorised)</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        {</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;          <span class="comment">// Set workspace to multiple of that -- ought to be &quot;significantly</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;          <span class="comment">// larger than infog(26)&quot;, according to the manual :(</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;          <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>-&gt;ICNTL(23) =</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;            <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a78d0283ea0263a5b31b7662d7abdfcb8">Workspace_scaling_factor</a> * <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>-&gt;INFOG(26);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160; </div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;          <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#acfc51e1ed214d9d2dc5a83b04a08d1f7">Suppress_mumps_info_during_solve</a>)</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;          {</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;            <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Attempting factorisation with workspace estimate: &quot;</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                       &lt;&lt; <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>-&gt;ICNTL(23) &lt;&lt; <span class="stringliteral">&quot; MB\n&quot;</span>;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;            <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;corresponding to Workspace_scaling_factor = &quot;</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                       &lt;&lt; <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a78d0283ea0263a5b31b7662d7abdfcb8">Workspace_scaling_factor</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;          }</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160; </div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;          <span class="comment">// Do factorisation</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;          <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>-&gt;job = 2;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;          dmumps_c(<a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>);</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;          <span class="comment">// Check for error</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>-&gt;INFOG(1) != 0)</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;          {</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#acfc51e1ed214d9d2dc5a83b04a08d1f7">Suppress_mumps_info_during_solve</a>)</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;            {</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;              <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Error during mumps factorisation!\n&quot;</span>;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;              <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Error codes: &quot;</span> &lt;&lt; <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>-&gt;INFO(1) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                         &lt;&lt; <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>-&gt;INFO(2) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;            }</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160; </div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;            <span class="comment">// Increase scaling factor for workspace and run again</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;            <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a78d0283ea0263a5b31b7662d7abdfcb8">Workspace_scaling_factor</a> *= 2;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160; </div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#acfc51e1ed214d9d2dc5a83b04a08d1f7">Suppress_mumps_info_during_solve</a>)</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            {</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;              <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Increasing workspace_scaling_factor to &quot;</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                         &lt;&lt; <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a78d0283ea0263a5b31b7662d7abdfcb8">Workspace_scaling_factor</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;            }</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;          }</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;          {</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;            factorised = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;          }</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        }</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160; </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160; </div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a536e41b50b3f3464ca9cb4a5776acc19">Doc_time</a>) &amp;&amp;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            (this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>()-&gt;communicator_pt()-&gt;my_rank() == 0))</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        {</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;          <span class="keywordtype">double</span> t_end_factor = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for actual mumps factorisation in MumpsSolver&quot;</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                        <span class="stringliteral">&quot;      : &quot;</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                     &lt;&lt; <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#ae746b756dfb86c00c7cf37558a7870f3">TimingHelpers::convert_secs_to_formatted_string</a>(</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                          t_end_factor - t_start_factor)</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                     &lt;&lt; std::endl;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        }</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      }</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      <span class="comment">// else the CRDoubleMatrix is not distributed</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      {</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        std::ostringstream error_message_stream;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        error_message_stream &lt;&lt; <span class="stringliteral">&quot;MumpsSolver only works for a &quot;</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                             &lt;&lt; <span class="stringliteral">&quot; distributed CRDoubleMatrix\n&quot;</span>;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(error_message_stream.str(),</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;      }</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    }</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="comment">// Otherwise throw an error</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    {</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;      std::ostringstream error_message_stream;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      error_message_stream &lt;&lt; <span class="stringliteral">&quot;MumpsSolver implemented only for &quot;</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                           &lt;&lt; <span class="stringliteral">&quot;distributed CRDoubleMatrix. \n&quot;</span>;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(error_message_stream.str(),</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    }</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160; </div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160; </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a536e41b50b3f3464ca9cb4a5776acc19">Doc_time</a>) &amp;&amp;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        (this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>()-&gt;communicator_pt()-&gt;my_rank() == 0))</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    {</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      <span class="keywordtype">double</span> t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for MumpsSolver factorisation                      : &quot;</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                 &lt;&lt; <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#ae746b756dfb86c00c7cf37558a7870f3">TimingHelpers::convert_secs_to_formatted_string</a>(t_end -</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                                                                    t_start)</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                 &lt;&lt; std::endl;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    }</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160; </div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="comment">// Switch off docing again by setting output stream for global info on</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="comment">// to negative number</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>-&gt;ICNTL(3) = -1;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1DistributableLinearAlgebraObject_html_ab00a3919b8634c698749f14a4d92947d"><div class="ttname"><a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ab00a3919b8634c698749f14a4d92947d">oomph::DistributableLinearAlgebraObject::first_row</a></div><div class="ttdeci">unsigned first_row() const</div><div class="ttdoc">access function for the first row on this processor</div><div class="ttdef"><b>Definition:</b> linear_algebra_distribution.h:481</div></div>
<div class="ttc" id="aclassoomph_1_1DistributableLinearAlgebraObject_html_ac5340bac40b9559b0378037b57005203"><div class="ttname"><a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ac5340bac40b9559b0378037b57005203">oomph::DistributableLinearAlgebraObject::build_distribution</a></div><div class="ttdeci">void build_distribution(const LinearAlgebraDistribution *const dist_pt)</div><div class="ttdef"><b>Definition:</b> linear_algebra_distribution.h:507</div></div>
<div class="ttc" id="aclassoomph_1_1DistributableLinearAlgebraObject_html_ac9492d59cff9d9b0098712ae72989cd3"><div class="ttname"><a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ac9492d59cff9d9b0098712ae72989cd3">oomph::DistributableLinearAlgebraObject::DistributableLinearAlgebraObject</a></div><div class="ttdeci">DistributableLinearAlgebraObject()</div><div class="ttdoc">Default constructor - create a distribution.</div><div class="ttdef"><b>Definition:</b> linear_algebra_distribution.h:438</div></div>
<div class="ttc" id="aclassoomph_1_1LinearAlgebraDistribution_html_a2e4736826a65253f574d4f6f152ab514"><div class="ttname"><a href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a2e4736826a65253f574d4f6f152ab514">oomph::LinearAlgebraDistribution::communicator_pt</a></div><div class="ttdeci">OomphCommunicator * communicator_pt() const</div><div class="ttdoc">const access to the communicator pointer</div><div class="ttdef"><b>Definition:</b> linear_algebra_distribution.h:335</div></div>
<div class="ttc" id="aclassoomph_1_1MumpsSolver_html_a593d7783708440445e09b6d595168cce"><div class="ttname"><a href="../../d6/d11/classoomph_1_1MumpsSolver.html#a593d7783708440445e09b6d595168cce">oomph::MumpsSolver::Jcn_loc</a></div><div class="ttdeci">Vector&lt; int &gt; Jcn_loc</div><div class="ttdef"><b>Definition:</b> mumps_solver.h:291</div></div>
<div class="ttc" id="aclassoomph_1_1MumpsSolver_html_a5b40d6e4d26ada5edef87bc1fa511d06"><div class="ttname"><a href="../../d6/d11/classoomph_1_1MumpsSolver.html#a5b40d6e4d26ada5edef87bc1fa511d06">oomph::MumpsSolver::A_loc</a></div><div class="ttdeci">Vector&lt; double &gt; A_loc</div><div class="ttdef"><b>Definition:</b> mumps_solver.h:294</div></div>
<div class="ttc" id="aclassoomph_1_1MumpsSolver_html_a969c7e01bcce31a946e01f03953e0745"><div class="ttname"><a href="../../d6/d11/classoomph_1_1MumpsSolver.html#a969c7e01bcce31a946e01f03953e0745">oomph::MumpsSolver::Irn_loc</a></div><div class="ttdeci">Vector&lt; int &gt; Irn_loc</div><div class="ttdoc">Vector for row numbers.</div><div class="ttdef"><b>Definition:</b> mumps_solver.h:288</div></div>
<div class="ttc" id="aclassoomph_1_1MumpsSolver_html_ae5e186152100c7d5f045d3df2a115c72"><div class="ttname"><a href="../../d6/d11/classoomph_1_1MumpsSolver.html#ae5e186152100c7d5f045d3df2a115c72">oomph::MumpsSolver::initialise_mumps</a></div><div class="ttdeci">void initialise_mumps()</div><div class="ttdoc">Initialise instance of mumps data structure.</div><div class="ttdef"><b>Definition:</b> mumps_solver.cc:86</div></div>
<div class="ttc" id="aclassoomph_1_1OomphCommunicator_html_a670b34aab05bfe0b96d0e0fabf583c7a"><div class="ttname"><a href="../../de/d83/classoomph_1_1OomphCommunicator.html#a670b34aab05bfe0b96d0e0fabf583c7a">oomph::OomphCommunicator::my_rank</a></div><div class="ttdeci">int my_rank() const</div><div class="ttdoc">my rank</div><div class="ttdef"><b>Definition:</b> communicator.h:176</div></div>
<div class="ttc" id="alevel1__cplx__impl_8h_html_a4e8e1c1bb9d4e05fc671fc133ec9dc9b"><div class="ttname"><a href="../../d2/d2e/level1__cplx__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a></div><div class="ttdeci">return int(ret)+1</div></div>
<div class="ttc" id="alevel2__cplx__impl_8h_html_a8d334fd8388055a029936c59d361ff00"><div class="ttname"><a href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a></div><div class="ttdeci">int * m</div><div class="ttdef"><b>Definition:</b> level2_cplx_impl.h:294</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a5b40d6e4d26ada5edef87bc1fa511d06">A_loc</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ac5340bac40b9559b0378037b57005203">oomph::DistributableLinearAlgebraObject::build_distribution()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aa0503bc64ef0ccb60cb7d7e645425a62">oomph::CRDoubleMatrix::built()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a70c8a67158c081e70b4d07a6b248bc7a">oomph::CRDoubleMatrix::clear()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a21b3dbb8ee74e1247f80ce4506c395f8">oomph::CRDoubleMatrix::column_index()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a2e4736826a65253f574d4f6f152ab514">oomph::LinearAlgebraDistribution::communicator_pt()</a>, <a class="el" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#ae746b756dfb86c00c7cf37558a7870f3">oomph::TimingHelpers::convert_secs_to_formatted_string()</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a88430ee69fb2015c48ec123b26e019e9">Delete_matrix_data</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a5505731e7e73d7e4251c67c7adec6bf5">oomph::DistributableLinearAlgebraObject::distributed()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">oomph::DistributableLinearAlgebraObject::distribution_pt()</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a8dc51b4b7e2b121773aea1ed7820ea16">Doc_stats</a>, <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a536e41b50b3f3464ca9cb4a5776acc19">oomph::LinearSolver::Doc_time</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ab00a3919b8634c698749f14a4d92947d">oomph::DistributableLinearAlgebraObject::first_row()</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#ae5e186152100c7d5f045d3df2a115c72">initialise_mumps()</a>, <a class="el" href="../../d2/d2e/level1__cplx__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int()</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a969c7e01bcce31a946e01f03953e0745">Irn_loc</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a593d7783708440445e09b6d595168cce">Jcn_loc</a>, <a class="el" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a3512c04b1bfcf11064c0da453ba34806">Mumps_is_initialised</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>, <a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a670b34aab05bfe0b96d0e0fabf583c7a">oomph::OomphCommunicator::my_rank()</a>, <a class="el" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>, <a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a253feffbf1db1976cdd86c6134c50abe">oomph::DoubleMatrixBase::ncol()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a9482dafc0a17ebc5b7431369d8d07565">oomph::CRDoubleMatrix::nnz()</a>, <a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a6c78c72666f4b102c2bccf200f0853b7">oomph::OomphCommunicator::nproc()</a>, <a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#acdcd6e1ea2bf2380f1a2fa32c7829cb5">oomph::DoubleMatrixBase::nrow()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a25f1efd00318183abd8c65efede3f3f4">oomph::CRDoubleMatrix::row_start()</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a5cf1f5e02e905d39e1b324dc921568f6">shutdown_mumps()</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#acfc51e1ed214d9d2dc5a83b04a08d1f7">Suppress_mumps_info_during_solve</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a4a770886867c62d2eff6afe4b091fabd">Suppress_warning_about_MPI_COMM_WORLD</a>, <a class="el" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">oomph::TimingHelpers::timer()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#ab8220b7c2bb763dab32a4d0fea7da6f4">oomph::CRDoubleMatrix::value()</a>, and <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a78d0283ea0263a5b31b7662d7abdfcb8">Workspace_scaling_factor</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d4e/classoomph_1_1NewMumpsPreconditioner.html#a47e894b47284711131cb0a13a65c24e5">oomph::NewMumpsPreconditioner::setup()</a>, and <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a3995dcf46675fc443b4d373d348a0fdf">solve()</a>.</p>

</div>
</div>
<a id="ae5e186152100c7d5f045d3df2a115c72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5e186152100c7d5f045d3df2a115c72">&#9670;&nbsp;</a></span>initialise_mumps()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::MumpsSolver::initialise_mumps </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialise instance of mumps data structure. </p>
<div class="fragment"><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  {</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="comment">// Make new instance of Mumps data structure</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a> = <span class="keyword">new</span> DMUMPS_STRUC_C;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="comment">// Mumps&#39; hack to indicate that mpi_comm_world is used. Conversion of any</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="comment">// other communicators appears to be non-portable, so we simply</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="comment">// issue a warning if we later discover that oomph-lib&#39;s communicator</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="comment">// is not MPI_COMM_WORLD</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>-&gt;comm_fortran = -987654;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="comment">// Root processor participates in solution</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>-&gt;par = 1;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="comment">// Set matrix symmetry properties</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="comment">// (unsymmetric / symmetric positive definite / general symmetric)</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>-&gt;sym = <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#ab816409c94736fea48814096af0bd14b">Jacobian_symmetry_flag</a>;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="comment">// First call does the initialise phase</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>-&gt;job = -1;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="comment">// Call c interface to double precision mumps to initialise</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    dmumps_c(<a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a3512c04b1bfcf11064c0da453ba34806">Mumps_is_initialised</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="comment">// Output stream for global info on host. Negative value suppresses printing</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>-&gt;ICNTL(3) = -1;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="comment">// Only show error messages and stats</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="comment">// (4 for full doc; creates huge amount of output)</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>-&gt;ICNTL(4) = 2;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="comment">// Write matrix</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="comment">// sprintf(Mumps_struc_pt-&gt;write_problem,&quot;/work/e173/e173/mheil/matrix&quot;);</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="comment">// Assembled matrix (rather than element-by_element)</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>-&gt;ICNTL(5) = 0;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="comment">// set the package to use for ordering during (sequential) analysis</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>-&gt;ICNTL(7) = <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a3358fea674f17424aac41152aeb7f990">Jacobian_ordering_flag</a>;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="comment">// Distributed problem with user-specified distribution</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>-&gt;ICNTL(18) = 3;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="comment">// Dense RHS</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>-&gt;ICNTL(20) = 0;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="comment">// Non-distributed solution</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>-&gt;ICNTL(21) = 0;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a3358fea674f17424aac41152aeb7f990">Jacobian_ordering_flag</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#ab816409c94736fea48814096af0bd14b">Jacobian_symmetry_flag</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a3512c04b1bfcf11064c0da453ba34806">Mumps_is_initialised</a>, and <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#aeab520bd25edb0f4e88feaedec689333">factorise()</a>.</p>

</div>
</div>
<a id="aea9e3eead627f8f8963f7b5c70b669f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea9e3eead627f8f8963f7b5c70b669f7">&#9670;&nbsp;</a></span>jacobian_setup_time()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> oomph::MumpsSolver::jacobian_setup_time </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns the time taken to assemble the Jacobian matrix and residual vector </p>
<div class="fragment"><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0608ee6d4a166c35a5d2d3756f119780">Jacobian_setup_time</a>;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1MumpsSolver_html_a0608ee6d4a166c35a5d2d3756f119780"><div class="ttname"><a href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0608ee6d4a166c35a5d2d3756f119780">oomph::MumpsSolver::Jacobian_setup_time</a></div><div class="ttdeci">double Jacobian_setup_time</div><div class="ttdoc">Jacobian setup time.</div><div class="ttdef"><b>Definition:</b> mumps_solver.h:255</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0608ee6d4a166c35a5d2d3756f119780">Jacobian_setup_time</a>.</p>

</div>
</div>
<a id="a52e765662a0e2cbd81dc5dc280905604"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52e765662a0e2cbd81dc5dc280905604">&#9670;&nbsp;</a></span>linear_solver_solution_time()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="../../df/de6/classdouble.html">double</a> oomph::MumpsSolver::linear_solver_solution_time </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Return the time taken to solve the linear system (needs to be overloaded for each linear solver) </p>
<div class="fragment"><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a6a5a305985a4215cc3456df54f531900">Solution_time</a>;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1MumpsSolver_html_a6a5a305985a4215cc3456df54f531900"><div class="ttname"><a href="../../d6/d11/classoomph_1_1MumpsSolver.html#a6a5a305985a4215cc3456df54f531900">oomph::MumpsSolver::Solution_time</a></div><div class="ttdeci">double Solution_time</div><div class="ttdoc">Solution time.</div><div class="ttdef"><b>Definition:</b> mumps_solver.h:258</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a6a5a305985a4215cc3456df54f531900">Solution_time</a>.</p>

</div>
</div>
<a id="a8d5ca953c8e042da066d0598b1941112"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d5ca953c8e042da066d0598b1941112">&#9670;&nbsp;</a></span>operator=()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::MumpsSolver::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html">MumpsSolver</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Broken assignment operator. </p>

</div>
</div>
<a id="a849d13cac2177452446c2ec387a0260f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a849d13cac2177452446c2ec387a0260f">&#9670;&nbsp;</a></span>resolve()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::MumpsSolver::resolve </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;&#160;</td>
          <td class="paramname"><em>rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Resolve the system defined by the last assembled Jacobian and the specified rhs vector if resolve has been enabled. Note: returns the global result Vector.</p>
<p>Resolve the system defined by the last assembled jacobian and the specified rhs vector if resolve has been enabled. Note: returns the global result Vector. </p>

<p>Reimplemented from <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a3b310d08333033edc119b2a5bd7dcbfb">oomph::LinearSolver</a>.</p>
<div class="fragment"><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;  {</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a4a770886867c62d2eff6afe4b091fabd">Suppress_warning_about_MPI_COMM_WORLD</a>)</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    {</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;      <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>()-&gt;communicator_pt()-&gt;mpi_comm() !=</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;          MPI_COMM_WORLD)</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;      {</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;        std::ostringstream error_message_stream;</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;        error_message_stream</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;Warning: Mumps wrapper assumes communicator is MPI_COMM_WORLD\n&quot;</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;         which is not the case, so mumps may die...\n&quot;</span></div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;         If it does initialise oomph-lib&#39;s mpi without &quot;</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;             <span class="stringliteral">&quot;requesting\n&quot;</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;         the communicator to be a duplicate of MPI_COMM_WORLD\n&quot;</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;         (done via an optional boolean to &quot;</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;             <span class="stringliteral">&quot;MPI_Helpers::init(...)\n\n&quot;</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;         (You can suppress this warning by recompiling without\n&quot;</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;         paranoia or calling\n\n&quot;</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;         &quot;</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;             <span class="stringliteral">&quot;MumpsSolver::enable_suppress_warning_about_MPI_COMM_WORLD()\n\n&quot;</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;         \n&quot;</span>;</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;        OomphLibWarning(error_message_stream.str(),</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                        <span class="stringliteral">&quot;MumpsSolver::resolve()&quot;</span>,</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;                        <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;      }</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    }</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160; </div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    <span class="comment">// Store starting time for solve</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    <span class="keywordtype">double</span> t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160; </div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    <span class="comment">// Doc stats?</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a8dc51b4b7e2b121773aea1ed7820ea16">Doc_stats</a>)</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    {</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;      <span class="comment">// Output stream for global info on host. Negative value suppresses</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;      <span class="comment">// printing</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;      <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>-&gt;ICNTL(3) = 6;</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    }</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160; </div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    <span class="comment">// Now do the back substitution phase</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a92ab601b671c2b7eea44a470aa5ec4f3">backsub</a>(rhs, result);</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160; </div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    <span class="comment">// Doc time for solve</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    <span class="keywordtype">double</span> t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a6a5a305985a4215cc3456df54f531900">Solution_time</a> = t_end - t_start;</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160; </div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    <span class="comment">// Switch off docing again by setting output stream for global info on</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    <span class="comment">// to negative number</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>-&gt;ICNTL(3) = -1;</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160; </div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a536e41b50b3f3464ca9cb4a5776acc19">Doc_time</a>) &amp;&amp;</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;        (this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>()-&gt;communicator_pt()-&gt;my_rank() == 0))</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    {</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for MumpsSolver solve: &quot;</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;                 &lt;&lt; <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#ae746b756dfb86c00c7cf37558a7870f3">TimingHelpers::convert_secs_to_formatted_string</a>(t_end -</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;                                                                    t_start)</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;                 &lt;&lt; std::endl;</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    }</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1MumpsSolver_html_a92ab601b671c2b7eea44a470aa5ec4f3"><div class="ttname"><a href="../../d6/d11/classoomph_1_1MumpsSolver.html#a92ab601b671c2b7eea44a470aa5ec4f3">oomph::MumpsSolver::backsub</a></div><div class="ttdeci">void backsub(const DoubleVector &amp;rhs, DoubleVector &amp;result)</div><div class="ttdef"><b>Definition:</b> mumps_solver.cc:526</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a92ab601b671c2b7eea44a470aa5ec4f3">backsub()</a>, <a class="el" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#ae746b756dfb86c00c7cf37558a7870f3">oomph::TimingHelpers::convert_secs_to_formatted_string()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">oomph::DistributableLinearAlgebraObject::distribution_pt()</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a8dc51b4b7e2b121773aea1ed7820ea16">Doc_stats</a>, <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a536e41b50b3f3464ca9cb4a5776acc19">oomph::LinearSolver::Doc_time</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a6a5a305985a4215cc3456df54f531900">Solution_time</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a4a770886867c62d2eff6afe4b091fabd">Suppress_warning_about_MPI_COMM_WORLD</a>, and <a class="el" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">oomph::TimingHelpers::timer()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d4e/classoomph_1_1NewMumpsPreconditioner.html#a763a8297c031fab7f16b37eaf257aeb1">oomph::NewMumpsPreconditioner::preconditioner_solve()</a>.</p>

</div>
</div>
<a id="a5cf1f5e02e905d39e1b324dc921568f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5cf1f5e02e905d39e1b324dc921568f6">&#9670;&nbsp;</a></span>shutdown_mumps()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::MumpsSolver::shutdown_mumps </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Shutdown mumps. </p>
<div class="fragment"><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a3512c04b1bfcf11064c0da453ba34806">Mumps_is_initialised</a>)</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      <span class="comment">// Shut down flag</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>-&gt;job = -2;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      <span class="comment">// Call c interface to double precision mumps to shut down</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      dmumps_c(<a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      <span class="comment">// Cleanup</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      <span class="keyword">delete</span> <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a> = 0;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a3512c04b1bfcf11064c0da453ba34806">Mumps_is_initialised</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      <span class="comment">// Cleanup storage</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a969c7e01bcce31a946e01f03953e0745">Irn_loc</a>.clear();</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a593d7783708440445e09b6d595168cce">Jcn_loc</a>.clear();</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a5b40d6e4d26ada5edef87bc1fa511d06">A_loc</a>.clear();</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    }</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a5b40d6e4d26ada5edef87bc1fa511d06">A_loc</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a969c7e01bcce31a946e01f03953e0745">Irn_loc</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a593d7783708440445e09b6d595168cce">Jcn_loc</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a3512c04b1bfcf11064c0da453ba34806">Mumps_is_initialised</a>, and <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#adc1541e4a9cbbe9c641f988380618713">clean_up_memory()</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#aeab520bd25edb0f4e88feaedec689333">factorise()</a>, and <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a20e6116da9911337fb80486bcfaf7eb4">~MumpsSolver()</a>.</p>

</div>
</div>
<a id="a3995dcf46675fc443b4d373d348a0fdf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3995dcf46675fc443b4d373d348a0fdf">&#9670;&nbsp;</a></span>solve() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::MumpsSolver::solve </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html">DoubleMatrixBase</a> *const &amp;&#160;</td>
          <td class="paramname"><em>matrix_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;&#160;</td>
          <td class="paramname"><em>rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Linear-algebra-type solver: Takes pointer to a matrix and rhs vector and returns the solution of the linear system. The function returns the global result Vector. Note: if Delete_matrix_data is true the function matrix_pt-&gt;clean_up_memory() will be used to wipe the matrix data.</p>
<p>Linear-algebra-type solver: Takes pointer to a matrix and rhs vector and returns the solution of the linear system. Problem pointer defaults to NULL and can be omitted. The function returns the global result vector. Matrix must be CRDoubleMatrix. Note: if Delete_matrix_data is true the function matrix_pt-&gt;clean_up_memory() will be used to wipe the matrix data. </p>

<p>Reimplemented from <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a546c09822d18191df14caed864c04c09">oomph::LinearSolver</a>.</p>
<div class="fragment"><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  {</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a4a770886867c62d2eff6afe4b091fabd">Suppress_warning_about_MPI_COMM_WORLD</a>)</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    {</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ac9492d59cff9d9b0098712ae72989cd3">DistributableLinearAlgebraObject</a>*<span class="keyword">&gt;</span>(matrix_pt)</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;            -&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>()</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;            -&gt;communicator_pt()</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;            -&gt;mpi_comm() != MPI_COMM_WORLD)</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;      {</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;        std::ostringstream error_message_stream;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;        error_message_stream</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;Warning: Mumps wrapper assumes that communicator is &quot;</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;             <span class="stringliteral">&quot;MPI_COMM_WORLD\n&quot;</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;         which is not the case, so mumps may die...\n&quot;</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;         If it does initialise oomph-lib&#39;s mpi without &quot;</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;             <span class="stringliteral">&quot;requesting\n&quot;</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;         the communicator to be a duplicate of MPI_COMM_WORLD\n&quot;</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;         (done via an optional boolean to &quot;</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;             <span class="stringliteral">&quot;MPI_Helpers::init(...)\n\n&quot;</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;         (You can suppress this warning by recompiling without\n&quot;</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;         paranoia or calling \n\n&quot;</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;         &quot;</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;             <span class="stringliteral">&quot;MumpsSolver::enable_suppress_warning_about_MPI_COMM_WORLD()\n\n&quot;</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;         \n&quot;</span>;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        OomphLibWarning(error_message_stream.str(),</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                        <span class="stringliteral">&quot;MumpsSolver::solve()&quot;</span>,</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                        <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;      }</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    }</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160; </div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <span class="comment">// Initialise timer</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <span class="keywordtype">double</span> t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160; </div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    <span class="comment">// check that the rhs vector is setup</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    <span class="keywordflow">if</span> (!rhs.distribution_pt()-&gt;built())</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    {</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;      std::ostringstream error_message_stream;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;      error_message_stream &lt;&lt; <span class="stringliteral">&quot;The vectors rhs must be setup&quot;</span>;</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(error_message_stream.str(),</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    }</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160; </div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    <span class="comment">// check that the matrix is square</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="keywordflow">if</span> (matrix_pt-&gt;nrow() != matrix_pt-&gt;ncol())</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    {</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;      std::ostringstream error_message_stream;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;      error_message_stream &lt;&lt; <span class="stringliteral">&quot;The matrix at matrix_pt must be square.&quot;</span>;</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(error_message_stream.str(),</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    }</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160; </div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    <span class="comment">// check that the matrix and the rhs vector have the same nrow()</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    <span class="keywordflow">if</span> (matrix_pt-&gt;nrow() != rhs.nrow())</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    {</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;      std::ostringstream error_message_stream;</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;      error_message_stream</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;The matrix and the rhs vector must have the same number of rows.&quot;</span>;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(error_message_stream.str(),</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    }</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160; </div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160; </div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <span class="comment">// if the matrix is distributable then should have the same distribution</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    <span class="comment">// as the rhs vector</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ac9492d59cff9d9b0098712ae72989cd3">DistributableLinearAlgebraObject</a>* ddist_matrix_pt =</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;      <span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ac9492d59cff9d9b0098712ae72989cd3">DistributableLinearAlgebraObject</a>*<span class="keyword">&gt;</span>(matrix_pt);</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <span class="keywordflow">if</span> (ddist_matrix_pt != 0)</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    {</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;      <span class="keywordflow">if</span> (!(*ddist_matrix_pt-&gt;distribution_pt() == *rhs.distribution_pt()))</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;      {</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;        std::ostringstream error_message_stream;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        error_message_stream</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;The matrix matrix_pt must have the same distribution as the &quot;</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;rhs vector.&quot;</span>;</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(error_message_stream.str(),</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;      }</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    }</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    <span class="comment">// if the matrix is not distributable then it the rhs vector should not be</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    <span class="comment">// distributed</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    {</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;      <span class="keywordflow">if</span> (rhs.distribution_pt()-&gt;distributed())</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;      {</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        std::ostringstream error_message_stream;</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;        error_message_stream</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;The matrix (matrix_pt) is not distributable and therefore the rhs&quot;</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;          &lt;&lt; <span class="stringliteral">&quot; vector must not be distributed&quot;</span>;</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(error_message_stream.str(),</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;      }</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    }</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    <span class="comment">// if the result vector is setup then check it has the same distribution</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    <span class="comment">// as the rhs</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    <span class="keywordflow">if</span> (result.built())</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    {</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;      <span class="keywordflow">if</span> (!(*result.distribution_pt() == *rhs.distribution_pt()))</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;      {</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        std::ostringstream error_message_stream;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        error_message_stream</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;The result vector distribution has been setup; it must have the &quot;</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;same distribution as the rhs vector.&quot;</span>;</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(error_message_stream.str(),</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;      }</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    }</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160; </div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160; </div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160; </div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    <span class="comment">// set the distribution</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ac9492d59cff9d9b0098712ae72989cd3">DistributableLinearAlgebraObject</a>* dist_matrix_pt =</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;      <span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ac9492d59cff9d9b0098712ae72989cd3">DistributableLinearAlgebraObject</a>*<span class="keyword">&gt;</span>(matrix_pt);</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    <span class="keywordflow">if</span> (dist_matrix_pt)</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    {</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;      <span class="comment">// the solver has the same distribution as the matrix if possible</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;      this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ac5340bac40b9559b0378037b57005203">build_distribution</a>(dist_matrix_pt-&gt;distribution_pt());</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    }</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    {</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;      <span class="comment">// the solver has the same distribution as the RHS</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;      this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ac5340bac40b9559b0378037b57005203">build_distribution</a>(rhs.distribution_pt());</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    }</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160; </div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    <span class="comment">// Factorise the matrix</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#aeab520bd25edb0f4e88feaedec689333">factorise</a>(matrix_pt);</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160; </div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    <span class="comment">// Now do the back solve</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a92ab601b671c2b7eea44a470aa5ec4f3">backsub</a>(rhs, result);</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160; </div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    <span class="comment">// Doc time for solve</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    <span class="keywordtype">double</span> t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a6a5a305985a4215cc3456df54f531900">Solution_time</a> = t_end - t_start;</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160; </div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a536e41b50b3f3464ca9cb4a5776acc19">Doc_time</a>) &amp;&amp;</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        (this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>()-&gt;communicator_pt()-&gt;my_rank() == 0))</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    {</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for MumpsSolver solve                              : &quot;</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                 &lt;&lt; <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#ae746b756dfb86c00c7cf37558a7870f3">TimingHelpers::convert_secs_to_formatted_string</a>(t_end -</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                                                                    t_start)</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                 &lt;&lt; std::endl;</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    }</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160; </div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    <span class="comment">// Switch off docing again by setting output stream for global info on</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <span class="comment">// to negative number</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>-&gt;ICNTL(3) = -1;</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160; </div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <span class="comment">// If we are not storing the solver data for resolves, delete it</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a5f5e7e7a44ff0897b0e4cd9524000edc">Enable_resolve</a>)</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    {</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;      <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#adc1541e4a9cbbe9c641f988380618713">clean_up_memory</a>();</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    }</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1LinearSolver_html_a5f5e7e7a44ff0897b0e4cd9524000edc"><div class="ttname"><a href="../../d5/dd7/classoomph_1_1LinearSolver.html#a5f5e7e7a44ff0897b0e4cd9524000edc">oomph::LinearSolver::Enable_resolve</a></div><div class="ttdeci">bool Enable_resolve</div><div class="ttdef"><b>Definition:</b> linear_solver.h:73</div></div>
<div class="ttc" id="aclassoomph_1_1MumpsSolver_html_aeab520bd25edb0f4e88feaedec689333"><div class="ttname"><a href="../../d6/d11/classoomph_1_1MumpsSolver.html#aeab520bd25edb0f4e88feaedec689333">oomph::MumpsSolver::factorise</a></div><div class="ttdeci">void factorise(DoubleMatrixBase *const &amp;matrix_pt)</div><div class="ttdef"><b>Definition:</b> mumps_solver.cc:180</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a92ab601b671c2b7eea44a470aa5ec4f3">backsub()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ac5340bac40b9559b0378037b57005203">oomph::DistributableLinearAlgebraObject::build_distribution()</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#aae402d422ec4344a4a45cdb7659b7161">oomph::DoubleVector::built()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a92bfff97fd228b9c528922c39ab563b2">oomph::LinearAlgebraDistribution::built()</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#adc1541e4a9cbbe9c641f988380618713">clean_up_memory()</a>, <a class="el" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#ae746b756dfb86c00c7cf37558a7870f3">oomph::TimingHelpers::convert_secs_to_formatted_string()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a05842d032d28880ae37951deae804ad8">oomph::LinearAlgebraDistribution::distributed()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">oomph::DistributableLinearAlgebraObject::distribution_pt()</a>, <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a536e41b50b3f3464ca9cb4a5776acc19">oomph::LinearSolver::Doc_time</a>, <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a5f5e7e7a44ff0897b0e4cd9524000edc">oomph::LinearSolver::Enable_resolve</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#aeab520bd25edb0f4e88feaedec689333">factorise()</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0cf148106cf3cc86e238ae4f289be0f8">Mumps_struc_pt</a>, <a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#a253feffbf1db1976cdd86c6134c50abe">oomph::DoubleMatrixBase::ncol()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a7569556f14fd68b28508920e89bd5eee">oomph::DistributableLinearAlgebraObject::nrow()</a>, <a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html#acdcd6e1ea2bf2380f1a2fa32c7829cb5">oomph::DoubleMatrixBase::nrow()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a6a5a305985a4215cc3456df54f531900">Solution_time</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a4a770886867c62d2eff6afe4b091fabd">Suppress_warning_about_MPI_COMM_WORLD</a>, and <a class="el" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">oomph::TimingHelpers::timer()</a>.</p>

</div>
</div>
<a id="ae0346a464f3ed74bfcca4063bdeed3ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0346a464f3ed74bfcca4063bdeed3ad">&#9670;&nbsp;</a></span>solve() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::MumpsSolver::solve </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *const &amp;&#160;</td>
          <td class="paramname"><em>problem_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Solver: Takes pointer to problem and returns the results Vector which contains the solution of the linear system defined by the problem's fully assembled Jacobian and residual Vector. </p>

<p>Implements <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a15ce22542b74ed1826ea485edacbeb6e">oomph::LinearSolver</a>.</p>
<div class="fragment"><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;  {</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a4a770886867c62d2eff6afe4b091fabd">Suppress_warning_about_MPI_COMM_WORLD</a>)</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    {</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;      <span class="keywordflow">if</span> (problem_pt-&gt;communicator_pt()-&gt;mpi_comm() != MPI_COMM_WORLD)</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;      {</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;        std::ostringstream error_message_stream;</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        error_message_stream</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;Warning: Mumps wrapper assumes that communicator is &quot;</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;             <span class="stringliteral">&quot;MPI_COMM_WORLD\n&quot;</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;         which is not the case, so mumps may die...\n&quot;</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;         If it does initialise oomph-lib&#39;s mpi without &quot;</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;             <span class="stringliteral">&quot;requesting\n&quot;</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;         the communicator to be a duplicate of MPI_COMM_WORLD\n&quot;</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;         (done via an optional boolean to &quot;</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;             <span class="stringliteral">&quot;MPI_Helpers::init(...)\n\n&quot;</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;         (You can suppress this warning by recompiling without\n&quot;</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;         paranoia or calling \n\n&quot;</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;         &quot;</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;             <span class="stringliteral">&quot;MumpsSolver::enable_suppress_warning_about_MPI_COMM_WORLD()\n\n&quot;</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;         \n&quot;</span>;</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;        OomphLibWarning(error_message_stream.str(),</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                        <span class="stringliteral">&quot;MumpsSolver::solve()&quot;</span>,</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                        <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;      }</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    }</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160; </div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    <span class="comment">// Initialise timer</span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    <span class="keywordtype">double</span> t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160; </div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    <span class="comment">// number of dofs</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    <span class="keywordtype">unsigned</span> n_dof = problem_pt-&gt;ndof();</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160; </div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    <span class="comment">// Set the distribution for the solver.</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>()-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a3cab441019e738e4c6db6ee22dd71515">build</a>(problem_pt-&gt;communicator_pt(), n_dof);</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160; </div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    <span class="comment">// Take a copy of Delete_matrix_data</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    <span class="keywordtype">bool</span> copy_of_Delete_matrix_data = <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a88430ee69fb2015c48ec123b26e019e9">Delete_matrix_data</a>;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160; </div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <span class="comment">// Set Delete_matrix to true</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a88430ee69fb2015c48ec123b26e019e9">Delete_matrix_data</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160; </div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    <span class="comment">// Initialise timer</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160; </div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    <span class="comment">// Storage for the distributed residuals vector</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    <a class="code" href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a> residuals(this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>(), 0.0);</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160; </div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    <span class="comment">// Get the sparse jacobian and residuals of the problem</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    CRDoubleMatrix jacobian(this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>());</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    problem_pt-&gt;get_jacobian(residuals, jacobian);</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160; </div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    <span class="comment">// Doc time for setup</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    <span class="keywordtype">double</span> t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0608ee6d4a166c35a5d2d3756f119780">Jacobian_setup_time</a> = t_end - t_start;</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    <span class="keywordtype">int</span> my_rank = this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>()-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a2e4736826a65253f574d4f6f152ab514">communicator_pt</a>()-&gt;<a class="code" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a670b34aab05bfe0b96d0e0fabf583c7a">my_rank</a>();</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a536e41b50b3f3464ca9cb4a5776acc19">Doc_time</a>) &amp;&amp; (my_rank == 0))</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    {</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time to set up CRDoubleMatrix Jacobian                  : &quot;</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;                 &lt;&lt; <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#ae746b756dfb86c00c7cf37558a7870f3">TimingHelpers::convert_secs_to_formatted_string</a>(</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;                      <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0608ee6d4a166c35a5d2d3756f119780">Jacobian_setup_time</a>)</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                 &lt;&lt; std::endl;</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    }</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160; </div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160; </div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <span class="comment">// Now call the linear algebra solve, if desired</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a851b95821f3adce5545e7abe238b3cce">Suppress_solve</a>)</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    {</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;      <span class="comment">// If the distribution of the result has been build and</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;      <span class="comment">// does not match that of</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;      <span class="comment">// the solver then redistribute before the solve and return</span></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;      <span class="comment">// to the incoming distribution afterwards.</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;      <span class="keywordflow">if</span> ((result.built()) &amp;&amp;</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;          (!(*result.distribution_pt() == *this-&gt;distribution_pt())))</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;      {</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        LinearAlgebraDistribution temp_global_dist(result.distribution_pt());</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        result.build(this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>(), 0.0);</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#ae0346a464f3ed74bfcca4063bdeed3ad">solve</a>(&amp;jacobian, residuals, result);</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;        result.redistribute(&amp;temp_global_dist);</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;      }</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;      {</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;        <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#ae0346a464f3ed74bfcca4063bdeed3ad">solve</a>(&amp;jacobian, residuals, result);</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;      }</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    }</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160; </div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    <span class="comment">// Set Delete_matrix back to original value</span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a88430ee69fb2015c48ec123b26e019e9">Delete_matrix_data</a> = copy_of_Delete_matrix_data;</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160; </div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    <span class="comment">// Finalise/doc timings</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a536e41b50b3f3464ca9cb4a5776acc19">Doc_time</a>) &amp;&amp; (my_rank == 0))</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    {</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;      <span class="keywordtype">double</span> t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Total time for MumpsSolver &quot;</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;(np=&quot;</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;                 &lt;&lt; this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>()-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a2e4736826a65253f574d4f6f152ab514">communicator_pt</a>()-&gt;<a class="code" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a6c78c72666f4b102c2bccf200f0853b7">nproc</a>()</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;,N=&quot;</span> &lt;&lt; problem_pt-&gt;ndof() &lt;&lt; <span class="stringliteral">&quot;)                : &quot;</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;                 &lt;&lt; <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#ae746b756dfb86c00c7cf37558a7870f3">TimingHelpers::convert_secs_to_formatted_string</a>(t_end -</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                                                                    t_start)</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;                 &lt;&lt; std::endl;</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    }</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1LinearAlgebraDistribution_html_a3cab441019e738e4c6db6ee22dd71515"><div class="ttname"><a href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a3cab441019e738e4c6db6ee22dd71515">oomph::LinearAlgebraDistribution::build</a></div><div class="ttdeci">void build(const OomphCommunicator *const comm_pt, const unsigned &amp;first_row, const unsigned &amp;nrow_local, const unsigned &amp;nrow=0)</div><div class="ttdef"><b>Definition:</b> linear_algebra_distribution.cc:35</div></div>
<div class="ttc" id="aclassoomph_1_1MumpsSolver_html_ae0346a464f3ed74bfcca4063bdeed3ad"><div class="ttname"><a href="../../d6/d11/classoomph_1_1MumpsSolver.html#ae0346a464f3ed74bfcca4063bdeed3ad">oomph::MumpsSolver::solve</a></div><div class="ttdeci">void solve(Problem *const &amp;problem_pt, DoubleVector &amp;result)</div><div class="ttdef"><b>Definition:</b> mumps_solver.cc:894</div></div>
<div class="ttc" id="aclassoomph_1_1OomphCommunicator_html_a6c78c72666f4b102c2bccf200f0853b7"><div class="ttname"><a href="../../de/d83/classoomph_1_1OomphCommunicator.html#a6c78c72666f4b102c2bccf200f0853b7">oomph::OomphCommunicator::nproc</a></div><div class="ttdeci">int nproc() const</div><div class="ttdoc">number of processors</div><div class="ttdef"><b>Definition:</b> communicator.h:157</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#a7bcc94c157d6853a0f0502e8a76ed380">oomph::DoubleVector::build()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a3cab441019e738e4c6db6ee22dd71515">oomph::LinearAlgebraDistribution::build()</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#aae402d422ec4344a4a45cdb7659b7161">oomph::DoubleVector::built()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">oomph::Problem::communicator_pt()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a2e4736826a65253f574d4f6f152ab514">oomph::LinearAlgebraDistribution::communicator_pt()</a>, <a class="el" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#ae746b756dfb86c00c7cf37558a7870f3">oomph::TimingHelpers::convert_secs_to_formatted_string()</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a88430ee69fb2015c48ec123b26e019e9">Delete_matrix_data</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">oomph::DistributableLinearAlgebraObject::distribution_pt()</a>, <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a536e41b50b3f3464ca9cb4a5776acc19">oomph::LinearSolver::Doc_time</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af660c2c0d10eaea1972314ce80de000e">oomph::Problem::get_jacobian()</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0608ee6d4a166c35a5d2d3756f119780">Jacobian_setup_time</a>, <a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a670b34aab05bfe0b96d0e0fabf583c7a">oomph::OomphCommunicator::my_rank()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">oomph::Problem::ndof()</a>, <a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a6c78c72666f4b102c2bccf200f0853b7">oomph::OomphCommunicator::nproc()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#a9396b861977c16606d8eca39056976c8">oomph::DoubleVector::redistribute()</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a851b95821f3adce5545e7abe238b3cce">Suppress_solve</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a4a770886867c62d2eff6afe4b091fabd">Suppress_warning_about_MPI_COMM_WORLD</a>, and <a class="el" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">oomph::TimingHelpers::timer()</a>.</p>

</div>
</div>
<a id="a25cd4ab6089d1532100ff61d5863c6fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25cd4ab6089d1532100ff61d5863c6fd">&#9670;&nbsp;</a></span>use_metis_ordering()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::MumpsSolver::use_metis_ordering </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a3358fea674f17424aac41152aeb7f990">Jacobian_ordering_flag</a> = <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a5e380357c515b4f280cf6bdf7273ed4ba3f76be5ac72cb29a86f05019e0b7f496">Metis_ordering</a>;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a3358fea674f17424aac41152aeb7f990">Jacobian_ordering_flag</a>, and <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a5e380357c515b4f280cf6bdf7273ed4ba3f76be5ac72cb29a86f05019e0b7f496">Metis_ordering</a>.</p>

</div>
</div>
<a id="a576cb1f983353144e063aa63c50757bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a576cb1f983353144e063aa63c50757bc">&#9670;&nbsp;</a></span>use_pord_ordering()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::MumpsSolver::use_pord_ordering </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a3358fea674f17424aac41152aeb7f990">Jacobian_ordering_flag</a> = <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a5e380357c515b4f280cf6bdf7273ed4ba13393a6ca320fac921fdc389ef247f10">Pord_ordering</a>;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a3358fea674f17424aac41152aeb7f990">Jacobian_ordering_flag</a>, and <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a5e380357c515b4f280cf6bdf7273ed4ba13393a6ca320fac921fdc389ef247f10">Pord_ordering</a>.</p>

</div>
</div>
<a id="a34fecff46bfab62a67f7200a745efeea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34fecff46bfab62a67f7200a745efeea">&#9670;&nbsp;</a></span>use_scotch_ordering()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::MumpsSolver::use_scotch_ordering </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    {</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a3358fea674f17424aac41152aeb7f990">Jacobian_ordering_flag</a> = <a class="code" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a5e380357c515b4f280cf6bdf7273ed4ba8484bf86594bef6f3509ca968e65eb1d">Scotch_ordering</a>;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a3358fea674f17424aac41152aeb7f990">Jacobian_ordering_flag</a>, and <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a5e380357c515b4f280cf6bdf7273ed4ba8484bf86594bef6f3509ca968e65eb1d">Scotch_ordering</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a5b40d6e4d26ada5edef87bc1fa511d06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b40d6e4d26ada5edef87bc1fa511d06">&#9670;&nbsp;</a></span>A_loc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt;<a class="el" href="../../df/de6/classdouble.html">double</a>&gt; oomph::MumpsSolver::A_loc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#aeab520bd25edb0f4e88feaedec689333">factorise()</a>, and <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a5cf1f5e02e905d39e1b324dc921568f6">shutdown_mumps()</a>.</p>

</div>
</div>
<a id="ad6bd1660c9c62b039b9cdd8074169a25"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6bd1660c9c62b039b9cdd8074169a25">&#9670;&nbsp;</a></span>Default_workspace_scaling_factor</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> oomph::MumpsSolver::Default_workspace_scaling_factor = 5</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Default factor for workspace &ndash; static so it can be overwritten globally.</p>
<p>/////////////////////////////////////////////////////////////////////// /////////////////////////////////////////////////////////////////////// /////////////////////////////////////////////////////////////////////// Default factor for workspace &ndash; static so it can be overwritten globally. </p>

</div>
</div>
<a id="a88430ee69fb2015c48ec123b26e019e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88430ee69fb2015c48ec123b26e019e9">&#9670;&nbsp;</a></span>Delete_matrix_data</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::MumpsSolver::Delete_matrix_data</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Delete_matrix_data flag. MumpsSolver needs its own copy of the input matrix, therefore a copy must be made if any matrix used with this solver is to be preserved. If the input matrix can be deleted the flag can be set to true to reduce the amount of memory required, and the matrix data will be wiped using its clean_up_memory() function. Default value is false. </p>

<p class="reference">Referenced by <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a52b3fbf9407cb8284f1c80600b11869f">disable_delete_matrix_data()</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#afbab47dbf3effebd34f3d3ba1634f7d3">enable_delete_matrix_data()</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#aeab520bd25edb0f4e88feaedec689333">factorise()</a>, and <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#ae0346a464f3ed74bfcca4063bdeed3ad">solve()</a>.</p>

</div>
</div>
<a id="a8dc51b4b7e2b121773aea1ed7820ea16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8dc51b4b7e2b121773aea1ed7820ea16">&#9670;&nbsp;</a></span>Doc_stats</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::MumpsSolver::Doc_stats</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set to true for MumpsSolver to output statistics (false by default). </p>

<p class="reference">Referenced by <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a92ab601b671c2b7eea44a470aa5ec4f3">backsub()</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a8f64fcf52cb7cbf89b75da1d794dee5f">disable_doc_stats()</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a25426798eb831cf552bdc17c0307ff25">enable_doc_stats()</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#aeab520bd25edb0f4e88feaedec689333">factorise()</a>, and <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a849d13cac2177452446c2ec387a0260f">resolve()</a>.</p>

</div>
</div>
<a id="a969c7e01bcce31a946e01f03953e0745"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a969c7e01bcce31a946e01f03953e0745">&#9670;&nbsp;</a></span>Irn_loc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt;<a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a>&gt; oomph::MumpsSolver::Irn_loc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Vector for row numbers. </p>

<p class="reference">Referenced by <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#aeab520bd25edb0f4e88feaedec689333">factorise()</a>, and <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a5cf1f5e02e905d39e1b324dc921568f6">shutdown_mumps()</a>.</p>

</div>
</div>
<a id="a3358fea674f17424aac41152aeb7f990"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3358fea674f17424aac41152aeb7f990">&#9670;&nbsp;</a></span>Jacobian_ordering_flag</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> oomph::MumpsSolver::Jacobian_ordering_flag</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>stores an integer from the public enum which specifies which package (PORD, Metis or SCOTCH) is used to reorder the Jacobian matrix during the analysis </p>

<p class="reference">Referenced by <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#ae5e186152100c7d5f045d3df2a115c72">initialise_mumps()</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a25cd4ab6089d1532100ff61d5863c6fd">use_metis_ordering()</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a576cb1f983353144e063aa63c50757bc">use_pord_ordering()</a>, and <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a34fecff46bfab62a67f7200a745efeea">use_scotch_ordering()</a>.</p>

</div>
</div>
<a id="a0608ee6d4a166c35a5d2d3756f119780"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0608ee6d4a166c35a5d2d3756f119780">&#9670;&nbsp;</a></span>Jacobian_setup_time</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> oomph::MumpsSolver::Jacobian_setup_time</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Jacobian setup time. </p>

<p class="reference">Referenced by <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#aea9e3eead627f8f8963f7b5c70b669f7">jacobian_setup_time()</a>, and <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#ae0346a464f3ed74bfcca4063bdeed3ad">solve()</a>.</p>

</div>
</div>
<a id="ab816409c94736fea48814096af0bd14b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab816409c94736fea48814096af0bd14b">&#9670;&nbsp;</a></span>Jacobian_symmetry_flag</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> oomph::MumpsSolver::Jacobian_symmetry_flag</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>symmetry of the Jacobian matrix we're solving; takes one of the enum values above </p>

<p class="reference">Referenced by <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a752f8f023f3b6c1b7021ad6683853850">declare_jacobian_is_symmetric()</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#aee53c09d398f6a982de5dc5fa9c02df7">declare_jacobian_is_symmetric_positive_definite()</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#af6bceea5ab29bbc30322b092b227ac03">declare_jacobian_is_unsymmetric()</a>, and <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#ae5e186152100c7d5f045d3df2a115c72">initialise_mumps()</a>.</p>

</div>
</div>
<a id="a593d7783708440445e09b6d595168cce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a593d7783708440445e09b6d595168cce">&#9670;&nbsp;</a></span>Jcn_loc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt;<a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a>&gt; oomph::MumpsSolver::Jcn_loc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#aeab520bd25edb0f4e88feaedec689333">factorise()</a>, and <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a5cf1f5e02e905d39e1b324dc921568f6">shutdown_mumps()</a>.</p>

</div>
</div>
<a id="a3512c04b1bfcf11064c0da453ba34806"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3512c04b1bfcf11064c0da453ba34806">&#9670;&nbsp;</a></span>Mumps_is_initialised</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::MumpsSolver::Mumps_is_initialised</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Has mumps been initialised? </p>

<p class="reference">Referenced by <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a92ab601b671c2b7eea44a470aa5ec4f3">backsub()</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#aeab520bd25edb0f4e88feaedec689333">factorise()</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#ae5e186152100c7d5f045d3df2a115c72">initialise_mumps()</a>, and <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a5cf1f5e02e905d39e1b324dc921568f6">shutdown_mumps()</a>.</p>

</div>
</div>
<a id="a0cf148106cf3cc86e238ae4f289be0f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0cf148106cf3cc86e238ae4f289be0f8">&#9670;&nbsp;</a></span>Mumps_struc_pt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">DMUMPS_STRUC_C* oomph::MumpsSolver::Mumps_struc_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pointer to MUMPS struct that contains the solver data. </p>

<p class="reference">Referenced by <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a92ab601b671c2b7eea44a470aa5ec4f3">backsub()</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#aeab520bd25edb0f4e88feaedec689333">factorise()</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#ae5e186152100c7d5f045d3df2a115c72">initialise_mumps()</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a849d13cac2177452446c2ec387a0260f">resolve()</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a5cf1f5e02e905d39e1b324dc921568f6">shutdown_mumps()</a>, and <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a3995dcf46675fc443b4d373d348a0fdf">solve()</a>.</p>

</div>
</div>
<a id="a6a5a305985a4215cc3456df54f531900"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a5a305985a4215cc3456df54f531900">&#9670;&nbsp;</a></span>Solution_time</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> oomph::MumpsSolver::Solution_time</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Solution time. </p>

<p class="reference">Referenced by <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a52e765662a0e2cbd81dc5dc280905604">linear_solver_solution_time()</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a849d13cac2177452446c2ec387a0260f">resolve()</a>, and <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a3995dcf46675fc443b4d373d348a0fdf">solve()</a>.</p>

</div>
</div>
<a id="ab0656b67b21335203eb7fbce8c7c7535"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0656b67b21335203eb7fbce8c7c7535">&#9670;&nbsp;</a></span>Suppress_incorrect_rhs_distribution_warning_in_resolve</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::MumpsSolver::Suppress_incorrect_rhs_distribution_warning_in_resolve</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=</div>
<div class="line">    <span class="keyword">false</span></div>
</div><!-- fragment --><p>Static flag that determines whether the warning about incorrect distribution of RHSs will be printed or not</p>
<p>Static warning to suppress warnings about incorrect distribution of RHS vector. Default is false </p>

<p class="reference">Referenced by <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a92ab601b671c2b7eea44a470aa5ec4f3">backsub()</a>.</p>

</div>
</div>
<a id="acfc51e1ed214d9d2dc5a83b04a08d1f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acfc51e1ed214d9d2dc5a83b04a08d1f7">&#9670;&nbsp;</a></span>Suppress_mumps_info_during_solve</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::MumpsSolver::Suppress_mumps_info_during_solve</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Boolean to suppress info being printed to screen during MUMPS solve. </p>

<p class="reference">Referenced by <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#ad75c9ff36be18867a88e0a68fac68f7c">disable_suppress_mumps_info_during_solve()</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a9be151628e1d8b488441ce2455f888e1">enable_suppress_mumps_info_during_solve()</a>, and <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#aeab520bd25edb0f4e88feaedec689333">factorise()</a>.</p>

</div>
</div>
<a id="a851b95821f3adce5545e7abe238b3cce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a851b95821f3adce5545e7abe238b3cce">&#9670;&nbsp;</a></span>Suppress_solve</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::MumpsSolver::Suppress_solve</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Suppress solve? </p>

<p class="reference">Referenced by <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a34346022a010acc09dc0ab1ce59d90a7">disable_suppress_solve()</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#ab5d49803e13ef6e6026e470a9933613e">enable_suppress_solve()</a>, and <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#ae0346a464f3ed74bfcca4063bdeed3ad">solve()</a>.</p>

</div>
</div>
<a id="a4a770886867c62d2eff6afe4b091fabd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a770886867c62d2eff6afe4b091fabd">&#9670;&nbsp;</a></span>Suppress_warning_about_MPI_COMM_WORLD</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::MumpsSolver::Suppress_warning_about_MPI_COMM_WORLD</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Boolean to suppress warning about communicator not equal to MPI_COMM_WORLD </p>

<p class="reference">Referenced by <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a92ab601b671c2b7eea44a470aa5ec4f3">backsub()</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#ade6f5dff6fddd0eeef6ef051ab5dfbc1">disable_suppress_warning_about_MPI_COMM_WORLD()</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a0f7ea8c453b2ff106ce42a11c8182cf5">enable_suppress_warning_about_MPI_COMM_WORLD()</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#aeab520bd25edb0f4e88feaedec689333">factorise()</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a849d13cac2177452446c2ec387a0260f">resolve()</a>, and <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#a3995dcf46675fc443b4d373d348a0fdf">solve()</a>.</p>

</div>
</div>
<a id="a78d0283ea0263a5b31b7662d7abdfcb8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78d0283ea0263a5b31b7662d7abdfcb8">&#9670;&nbsp;</a></span>Workspace_scaling_factor</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> oomph::MumpsSolver::Workspace_scaling_factor</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#aeab520bd25edb0f4e88feaedec689333">factorise()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="../../db/ddd/mumps__solver_8h_source.html">mumps_solver.h</a></li>
<li><a class="el" href="../../d0/d11/mumps__solver_8cc.html">mumps_solver.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../da/ddf/namespaceoomph.html">oomph</a></li><li class="navelem"><a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html">MumpsSolver</a></li>
    <li class="footer">Generated on Wed Aug 27 2025 17:09:07 for MercuryDPM by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
