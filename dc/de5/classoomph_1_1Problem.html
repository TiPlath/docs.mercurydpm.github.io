<!-- HTML header for doxygen 1.8.18-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MercuryDPM: oomph::Problem Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../MDPM.css" rel="stylesheet" type="text/css"/>
<link href="../../codeLabels.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-fork-corner.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-dropdown-version.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../MDPM-fragment-copy-button.js"></script>
<script type="text/javascript">
DoxygenAwesomeFragmentCopyButton.init()
</script>
<script type="text/javascript" src="../../MDPM-paragraph-link.js"></script>
<script type="text/javascript">
DoxygenAwesomeParagraphLink.init()
</script>
<script type="text/javascript" src="../../MDPM-interactive-toc.js"></script>
<script type="text/javascript">
DoxygenAwesomeInteractiveToc.init()
</script>
<script type="text/javascript" src="../../MDPM-darkmode-toggle.js"></script>
<script type="text/javascript">
DoxygenAwesomeDarkModeToggle.init()
</script>
</head>
<body>
  <div id="bitbucket-corner">
   <a href="https://bitbucket.org/mercurydpm/mercurydpm/src/master/" target="_blank" id="fork-corner" class="fork-corner fc-pos-tr fc-animate fc-theme-bitbucket"></a>
  </div>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../mercury-logo-chosen-light-slogan.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"> <!--MercuryDPM--!>
   <!-- BEGIN version select -->
   <div class="dropdown" id="projectnumber">
    <button class="dropbtn">v1.0</button>
    <div class="dropdown-content">
    </div>
   </div>
   <script type="text/javascript" src="../../MDPM-dropdown-version.js"></script>
<!-- END version select -->
   <!--&#160;<span id="projectnumber">revision: v1.0</span>-->
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<script type="text/javascript" src="../../MDPM-fork-corner.js"></script>
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('dc/de5/classoomph_1_1Problem.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="#pro-types">Protected Types</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#pro-static-attribs">Static Protected Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="../../d8/d2d/classoomph_1_1Problem-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">oomph::Problem Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="../../d0/d83/problem_8h_source.html">problem.h</a>&gt;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Inheritance diagram for oomph::Problem:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
 <div class="center">
  <img src="../../dc/de5/classoomph_1_1Problem.png" usemap="#oomph::Problem_map" alt=""/>
  <map id="oomph::Problem_map" name="oomph::Problem_map">
<area href="../../df/d86/classoomph_1_1ExplicitTimeSteppableObject.html" alt="oomph::ExplicitTimeSteppableObject" shape="rect" coords="0,0,481,24"/>
<area href="../../d9/dc5/classoomph_1_1BiharmonicProblem.html" alt="oomph::BiharmonicProblem&lt; 2 &gt;" shape="rect" coords="491,112,972,136"/>
<area href="../../da/dec/classABCProblem.html" alt="ABCProblem&lt; ELEMENT, TIMESTEPPERT &gt;" shape="rect" coords="491,168,972,192"/>
<area href="../../d8/d2c/classActivatorInhibitorProblem.html" alt="ActivatorInhibitorProblem&lt; ELEMENT &gt;" shape="rect" coords="491,224,972,248"/>
<area href="../../d9/d2f/classAdvectionProblem.html" alt="AdvectionProblem" shape="rect" coords="491,280,972,304"/>
<area href="../../dd/dfa/classAirwayReopeningProblem.html" title="Bretherton problem." alt="AirwayReopeningProblem&lt; ELEMENT &gt;" shape="rect" coords="491,336,972,360"/>
<area href="../../d8/d28/classAnnularDiskProblem.html" title="Annular disk." alt="AnnularDiskProblem&lt; ELASTICITY_ELEMENT &gt;" shape="rect" coords="491,392,972,416"/>
<area href="../../d3/d7a/classAxiPoroProblem.html" title="Problem class." alt="AxiPoroProblem&lt; ELEMENT, TIMESTEPPER &gt;" shape="rect" coords="491,448,972,472"/>
<area href="../../df/d37/classAxisymFreeSurfaceNozzleAdvDiffRobinProblem.html" alt="AxisymFreeSurfaceNozzleAdvDiffRobinProblem&lt; ELEMENT &gt;" shape="rect" coords="491,504,972,528"/>
<area href="../../d1/d4b/classAxisymFvKProblem.html" title="Problem class." alt="AxisymFvKProblem&lt; ELEMENT &gt;" shape="rect" coords="491,560,972,584"/>
<area href="../../d1/d4b/classAxisymFvKProblem.html" title="Problem class." alt="AxisymFvKProblem&lt; ELEMENT &gt;" shape="rect" coords="491,616,972,640"/>
<area href="../../d1/d4b/classAxisymFvKProblem.html" title="Problem class." alt="AxisymFvKProblem&lt; ELEMENT &gt;" shape="rect" coords="491,672,972,696"/>
<area href="../../d1/d4b/classAxisymFvKProblem.html" title="Problem class." alt="AxisymFvKProblem&lt; ELEMENT &gt;" shape="rect" coords="491,728,972,752"/>
<area href="../../d7/d9c/classAxisymmetricLinearElasticityProblem.html" alt="AxisymmetricLinearElasticityProblem&lt; ELEMENT, TIMESTEPPER &gt;" shape="rect" coords="491,784,972,808"/>
<area href="../../dd/d7d/classAxisymmetricVibratingShellProblem.html" title="Problem class to simulate the settling of a viscous drop." alt="AxisymmetricVibratingShellProblem&lt; ELEMENT &gt;" shape="rect" coords="491,840,972,864"/>
<area href="../../d2/d3b/classBaseStateProblem.html" title="Base state problem class for Tuckerman counter-rotating lids problem." alt="BaseStateProblem&lt; BASE_ELEMENT &gt;" shape="rect" coords="491,896,972,920"/>
<area href="../../d2/d3b/classBaseStateProblem.html" title="Base state problem class for Tuckerman counter-rotating lids problem." alt="BaseStateProblem&lt; BASE_ELEMENT &gt;" shape="rect" coords="491,952,972,976"/>
<area href="../../d2/d3b/classBaseStateProblem.html" title="Base state problem class for Tuckerman counter-rotating lids problem." alt="BaseStateProblem&lt; BASE_ELEMENT &gt;" shape="rect" coords="491,1008,972,1032"/>
<area href="../../d2/d3b/classBaseStateProblem.html" title="Base state problem class for Tuckerman counter-rotating lids problem." alt="BaseStateProblem&lt; BASE_ELEMENT &gt;" shape="rect" coords="491,1064,972,1088"/>
<area href="../../d2/d3b/classBaseStateProblem.html" title="Base state problem class for Tuckerman counter-rotating lids problem." alt="BaseStateProblem&lt; BASE_ELEMENT &gt;" shape="rect" coords="491,1120,972,1144"/>
<area href="../../d2/d3b/classBaseStateProblem.html" title="Base state problem class for Tuckerman counter-rotating lids problem." alt="BaseStateProblem&lt; BASE_ELEMENT &gt;" shape="rect" coords="491,1176,972,1200"/>
<area href="../../da/d4b/classBendingCantileverProblem.html" alt="BendingCantileverProblem&lt; ELEMENT &gt;" shape="rect" coords="491,1232,972,1256"/>
<area href="../../d5/d7a/classBlockCompressionProblem.html" title="Deformation of elastic block." alt="BlockCompressionProblem&lt; ELEMENT &gt;" shape="rect" coords="491,1288,972,1312"/>
<area href="../../d3/d41/classBratuProblem.html" alt="BratuProblem&lt; ELEMENT &gt;" shape="rect" coords="491,1344,972,1368"/>
<area href="../../d0/d5b/classBrethertonProblem.html" title="Bretherton problem." alt="BrethertonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,1400,972,1424"/>
<area href="../../da/def/classBubbleInChannelProblem.html" title="Problem class to simulate inviscid bubble propagating along 2D channel." alt="BubbleInChannelProblem&lt; ELEMENT &gt;" shape="rect" coords="491,1456,972,1480"/>
<area href="../../df/d16/classCantileverProblem.html" title="Problem class for the cantilever &quot;beam&quot; structure." alt="CantileverProblem&lt; ELEMENT &gt;" shape="rect" coords="491,1512,972,1536"/>
<area href="../../df/d16/classCantileverProblem.html" title="Problem class for the cantilever &quot;beam&quot; structure." alt="CantileverProblem&lt; ELEMENT &gt;" shape="rect" coords="491,1568,972,1592"/>
<area href="../../df/d16/classCantileverProblem.html" title="Problem class for the cantilever &quot;beam&quot; structure." alt="CantileverProblem&lt; ELEMENT &gt;" shape="rect" coords="491,1624,972,1648"/>
<area href="../../df/d16/classCantileverProblem.html" title="Problem class for the cantilever &quot;beam&quot; structure." alt="CantileverProblem&lt; ELEMENT &gt;" shape="rect" coords="491,1680,972,1704"/>
<area href="../../df/d16/classCantileverProblem.html" title="Problem class for the cantilever &quot;beam&quot; structure." alt="CantileverProblem&lt; ELEMENT &gt;" shape="rect" coords="491,1736,972,1760"/>
<area href="../../df/d16/classCantileverProblem.html" title="Problem class for the cantilever &quot;beam&quot; structure." alt="CantileverProblem&lt; ELEMENT &gt;" shape="rect" coords="491,1792,972,1816"/>
<area href="../../df/de6/classCapProblem.html" alt="CapProblem&lt; ELEMENT &gt;" shape="rect" coords="491,1848,972,1872"/>
<area href="../../df/de6/classCapProblem.html" alt="CapProblem&lt; ELEMENT &gt;" shape="rect" coords="491,1904,972,1928"/>
<area href="../../df/de6/classCapProblem.html" alt="CapProblem&lt; ELEMENT &gt;" shape="rect" coords="491,1960,972,1984"/>
<area href="../../df/de6/classCapProblem.html" alt="CapProblem&lt; ELEMENT &gt;" shape="rect" coords="491,2016,972,2040"/>
<area href="../../d5/db8/classChannelSpineFlowProblem.html" alt="ChannelSpineFlowProblem&lt; ELEMENT &gt;" shape="rect" coords="491,2072,972,2096"/>
<area href="../../d5/db8/classChannelSpineFlowProblem.html" alt="ChannelSpineFlowProblem&lt; ELEMENT &gt;" shape="rect" coords="491,2128,972,2152"/>
<area href="../../d2/d1f/classChannelWithLeafletProblem.html" title="Problem class." alt="ChannelWithLeafletProblem&lt; ELEMENT &gt;" shape="rect" coords="491,2184,972,2208"/>
<area href="../../d3/d0f/classCoatedDiskProblem.html" title="Coated disk FSI." alt="CoatedDiskProblem&lt; ELASTICITY_ELEMENT, HELMHOLTZ_ELEMENT &gt;" shape="rect" coords="491,2240,972,2264"/>
<area href="../../d3/d0f/classCoatedDiskProblem.html" title="Coated disk FSI." alt="CoatedDiskProblem&lt; ELASTICITY_ELEMENT, HELMHOLTZ_ELEMENT &gt;" shape="rect" coords="491,2296,972,2320"/>
<area href="../../d5/d09/classCoatedSphereProblem.html" title="Coated sphere FSI." alt="CoatedSphereProblem&lt; ELASTICITY_ELEMENT, HELMHOLTZ_ELEMENT &gt;" shape="rect" coords="491,2352,972,2376"/>
<area href="../../d5/d09/classCoatedSphereProblem.html" title="Coated sphere FSI." alt="CoatedSphereProblem&lt; ELASTICITY_ELEMENT, HELMHOLTZ_ELEMENT &gt;" shape="rect" coords="491,2408,972,2432"/>
<area href="../../d1/d8c/classCollapsibleChannelProblem.html" title="Problem class." alt="CollapsibleChannelProblem&lt; ELEMENT &gt;" shape="rect" coords="491,2464,972,2488"/>
<area href="../../d1/d8c/classCollapsibleChannelProblem.html" title="Problem class." alt="CollapsibleChannelProblem&lt; ELEMENT &gt;" shape="rect" coords="491,2520,972,2544"/>
<area href="../../d1/d8c/classCollapsibleChannelProblem.html" title="Problem class." alt="CollapsibleChannelProblem&lt; ELEMENT &gt;" shape="rect" coords="491,2576,972,2600"/>
<area href="../../d1/d8c/classCollapsibleChannelProblem.html" title="Problem class." alt="CollapsibleChannelProblem&lt; ELEMENT &gt;" shape="rect" coords="491,2632,972,2656"/>
<area href="../../d1/d8c/classCollapsibleChannelProblem.html" title="Problem class." alt="CollapsibleChannelProblem&lt; ELEMENT &gt;" shape="rect" coords="491,2688,972,2712"/>
<area href="../../d7/d9a/classComplexHarmonicProblem.html" title="1D ComplexHarmonic problem in unit interval." alt="ComplexHarmonicProblem&lt; ELEMENT, EIGEN_SOLVER &gt;" shape="rect" coords="491,2744,972,2768"/>
<area href="../../dd/d11/classCompressedSquareProblem.html" title="Problem class." alt="CompressedSquareProblem&lt; ELEMENT &gt;" shape="rect" coords="491,2800,972,2824"/>
<area href="../../d0/dec/classContactProblem.html" title="Problem class." alt="ContactProblem&lt; ELEMENT &gt;" shape="rect" coords="491,2856,972,2880"/>
<area href="../../d0/dec/classContactProblem.html" title="Problem class." alt="ContactProblem&lt; ELEMENT &gt;" shape="rect" coords="491,2912,972,2936"/>
<area href="../../d0/dec/classContactProblem.html" title="Problem class." alt="ContactProblem&lt; ELEMENT &gt;" shape="rect" coords="491,2968,972,2992"/>
<area href="../../d0/dec/classContactProblem.html" title="Problem class." alt="ContactProblem&lt; ELEMENT &gt;" shape="rect" coords="491,3024,972,3048"/>
<area href="../../d1/d67/classContinuationProblem.html" title="Mini problem class for the continuation problem." alt="ContinuationProblem" shape="rect" coords="491,3080,972,3104"/>
<area href="../../d3/d00/classConvectionProblem.html" alt="ConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;" shape="rect" coords="491,3136,972,3160"/>
<area href="../../d3/d00/classConvectionProblem.html" alt="ConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;" shape="rect" coords="491,3192,972,3216"/>
<area href="../../d3/d00/classConvectionProblem.html" alt="ConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;" shape="rect" coords="491,3248,972,3272"/>
<area href="../../d3/d00/classConvectionProblem.html" alt="ConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;" shape="rect" coords="491,3304,972,3328"/>
<area href="../../d3/d00/classConvectionProblem.html" alt="ConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;" shape="rect" coords="491,3360,972,3384"/>
<area href="../../d3/d00/classConvectionProblem.html" alt="ConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;" shape="rect" coords="491,3416,972,3440"/>
<area href="../../d3/d00/classConvectionProblem.html" alt="ConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;" shape="rect" coords="491,3472,972,3496"/>
<area href="../../d3/d00/classConvectionProblem.html" alt="ConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;" shape="rect" coords="491,3528,972,3552"/>
<area href="../../d1/d6e/classDDConvectionProblem.html" alt="DDConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;" shape="rect" coords="491,3584,972,3608"/>
<area href="../../d3/d78/classDarcyProblem.html" title="Darcy problem." alt="DarcyProblem&lt; ELEMENT &gt;" shape="rect" coords="491,3640,972,3664"/>
<area href="../../d9/dcd/classDeformableFishPoissonProblem.html" alt="DeformableFishPoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,3696,972,3720"/>
<area href="../../d9/dcd/classDeformableFishPoissonProblem.html" alt="DeformableFishPoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,3752,972,3776"/>
<area href="../../df/d58/classDemoPoissonProblem.html" alt="DemoPoissonProblem" shape="rect" coords="491,3808,972,3832"/>
<area href="../../dd/d08/classDiskOscillationProblem.html" alt="DiskOscillationProblem&lt; ELEMENT &gt;" shape="rect" coords="491,3864,972,3888"/>
<area href="../../df/d9b/classDiskShockWaveProblem.html" alt="DiskShockWaveProblem&lt; ELEMENT, TIMESTEPPER &gt;" shape="rect" coords="491,3920,972,3944"/>
<area href="../../de/d3f/classDrivenCavityProblem.html" alt="DrivenCavityProblem&lt; ELEMENT, MESH &gt;" shape="rect" coords="491,3976,972,4000"/>
<area href="../../d9/dee/classDropInChannelProblem.html" title="Problem class to simulate viscous drop propagating along 2D channel." alt="DropInChannelProblem&lt; ELEMENT &gt;" shape="rect" coords="491,4032,972,4056"/>
<area href="../../d8/de1/classEighthSpherePoissonProblem.html" title="Poisson problem in refineable eighth of a sphere mesh." alt="EighthSpherePoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,4088,972,4112"/>
<area href="../../d8/de1/classEighthSpherePoissonProblem.html" title="Poisson problem in refineable eighth of a sphere mesh." alt="EighthSpherePoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,4144,972,4168"/>
<area href="../../d8/de1/classEighthSpherePoissonProblem.html" title="Poisson problem in refineable eighth of a sphere mesh." alt="EighthSpherePoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,4200,972,4224"/>
<area href="../../d8/de1/classEighthSpherePoissonProblem.html" title="Poisson problem in refineable eighth of a sphere mesh." alt="EighthSpherePoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,4256,972,4280"/>
<area href="../../d8/de1/classEighthSpherePoissonProblem.html" title="Poisson problem in refineable eighth of a sphere mesh." alt="EighthSpherePoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,4312,972,4336"/>
<area href="../../df/de5/classElasticAnnulusProblem.html" title="Annular disk." alt="ElasticAnnulusProblem&lt; ELASTICITY_ELEMENT &gt;" shape="rect" coords="491,4368,972,4392"/>
<area href="../../df/de5/classElasticAnnulusProblem.html" title="Annular disk." alt="ElasticAnnulusProblem&lt; ELASTICITY_ELEMENT &gt;" shape="rect" coords="491,4424,972,4448"/>
<area href="../../dd/ddc/classElasticBeamProblem.html" title="Beam problem object." alt="ElasticBeamProblem" shape="rect" coords="491,4480,972,4504"/>
<area href="../../dd/d0a/classElasticFishProblem.html" title="Boundary-driven elastic deformation of fish-shaped domain." alt="ElasticFishProblem&lt; ELEMENT &gt;" shape="rect" coords="491,4536,972,4560"/>
<area href="../../d4/d8b/classElasticInterfaceProblem.html" title="Elastic version of Single fluid interface problem." alt="ElasticInterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;" shape="rect" coords="491,4592,972,4616"/>
<area href="../../d2/d06/classElasticRingProblem.html" title="Ring problem." alt="ElasticRingProblem&lt; ELEMENT &gt;" shape="rect" coords="491,4648,972,4672"/>
<area href="../../d2/d06/classElasticRingProblem.html" title="Ring problem." alt="ElasticRingProblem&lt; ELEMENT &gt;" shape="rect" coords="491,4704,972,4728"/>
<area href="../../d2/d06/classElasticRingProblem.html" title="Ring problem." alt="ElasticRingProblem&lt; ELEMENT &gt;" shape="rect" coords="491,4760,972,4784"/>
<area href="../../d2/d06/classElasticRingProblem.html" title="Ring problem." alt="ElasticRingProblem&lt; ELEMENT &gt;" shape="rect" coords="491,4816,972,4840"/>
<area href="../../db/d31/classEntryFlowProblem.html" title="Entry flow problem in quarter tube domain." alt="EntryFlowProblem&lt; ELEMENT &gt;" shape="rect" coords="491,4872,972,4896"/>
<area href="../../db/d31/classEntryFlowProblem.html" title="Entry flow problem in quarter tube domain." alt="EntryFlowProblem&lt; ELEMENT &gt;" shape="rect" coords="491,4928,972,4952"/>
<area href="../../db/d31/classEntryFlowProblem.html" title="Entry flow problem in quarter tube domain." alt="EntryFlowProblem&lt; ELEMENT &gt;" shape="rect" coords="491,4984,972,5008"/>
<area href="../../d4/dbc/classEulerProblem.html" alt="EulerProblem" shape="rect" coords="491,5040,972,5064"/>
<area href="../../d3/da1/classEultingSphereProblem.html" alt="EultingSphereProblem&lt; ELEMENT &gt;" shape="rect" coords="491,5096,972,5120"/>
<area href="../../d5/d2f/classExtrudedMovingCylinderProblem.html" alt="ExtrudedMovingCylinderProblem&lt; TWO_D_ELEMENT, THREE_D_ELEMENT &gt;" shape="rect" coords="491,5152,972,5176"/>
<area href="../../dd/d4a/classFSIChannelWithLeafletProblem.html" title="FSI leaflet in channel." alt="FSIChannelWithLeafletProblem&lt; ELEMENT &gt;" shape="rect" coords="491,5208,972,5232"/>
<area href="../../dd/d4a/classFSIChannelWithLeafletProblem.html" title="FSI leaflet in channel." alt="FSIChannelWithLeafletProblem&lt; ELEMENT &gt;" shape="rect" coords="491,5264,972,5288"/>
<area href="../../dd/d4a/classFSIChannelWithLeafletProblem.html" title="FSI leaflet in channel." alt="FSIChannelWithLeafletProblem&lt; ELEMENT &gt;" shape="rect" coords="491,5320,972,5344"/>
<area href="../../dd/d4a/classFSIChannelWithLeafletProblem.html" title="FSI leaflet in channel." alt="FSIChannelWithLeafletProblem&lt; ELEMENT &gt;" shape="rect" coords="491,5376,972,5400"/>
<area href="../../dd/da6/classFSICollapsibleChannelProblem.html" title="Problem class." alt="FSICollapsibleChannelProblem&lt; ELEMENT &gt;" shape="rect" coords="491,5432,972,5456"/>
<area href="../../dd/da6/classFSICollapsibleChannelProblem.html" title="Problem class." alt="FSICollapsibleChannelProblem&lt; ELEMENT &gt;" shape="rect" coords="491,5488,972,5512"/>
<area href="../../dd/da6/classFSICollapsibleChannelProblem.html" title="Problem class." alt="FSICollapsibleChannelProblem&lt; ELEMENT &gt;" shape="rect" coords="491,5544,972,5568"/>
<area href="../../dd/da6/classFSICollapsibleChannelProblem.html" title="Problem class." alt="FSICollapsibleChannelProblem&lt; ELEMENT &gt;" shape="rect" coords="491,5600,972,5624"/>
<area href="../../dd/da6/classFSICollapsibleChannelProblem.html" title="Problem class." alt="FSICollapsibleChannelProblem&lt; ELEMENT &gt;" shape="rect" coords="491,5656,972,5680"/>
<area href="../../dd/da6/classFSICollapsibleChannelProblem.html" title="Problem class." alt="FSICollapsibleChannelProblem&lt; ELEMENT &gt;" shape="rect" coords="491,5712,972,5736"/>
<area href="../../dd/da6/classFSICollapsibleChannelProblem.html" title="Problem class." alt="FSICollapsibleChannelProblem&lt; ELEMENT &gt;" shape="rect" coords="491,5768,972,5792"/>
<area href="../../d5/df4/classFSIDrivenCavityProblem.html" title="Problem class." alt="FSIDrivenCavityProblem&lt; ELEMENT &gt;" shape="rect" coords="491,5824,972,5848"/>
<area href="../../da/db6/classFSIRingProblem.html" alt="FSIRingProblem" shape="rect" coords="491,5880,972,5904"/>
<area href="../../da/db6/classFSIRingProblem.html" alt="FSIRingProblem" shape="rect" coords="491,5936,972,5960"/>
<area href="../../da/db6/classFSIRingProblem.html" alt="FSIRingProblem" shape="rect" coords="491,5992,972,6016"/>
<area href="../../dd/d6a/classFallingBlockProblem.html" title="Micky mouse problem." alt="FallingBlockProblem&lt; ELEMENT &gt;" shape="rect" coords="491,6048,972,6072"/>
<area href="../../d6/d10/classFishPoissonProblem.html" alt="FishPoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,6104,972,6128"/>
<area href="../../d6/d10/classFishPoissonProblem.html" alt="FishPoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,6160,972,6184"/>
<area href="../../dc/d83/classFlowAroundCylinderProblem.html" title="Flow around a cylinder in rectangular domain." alt="FlowAroundCylinderProblem&lt; ELEMENT &gt;" shape="rect" coords="491,6216,972,6240"/>
<area href="../../dc/d83/classFlowAroundCylinderProblem.html" title="Flow around a cylinder in rectangular domain." alt="FlowAroundCylinderProblem&lt; ELEMENT &gt;" shape="rect" coords="491,6272,972,6296"/>
<area href="../../dc/d83/classFlowAroundCylinderProblem.html" title="Flow around a cylinder in rectangular domain." alt="FlowAroundCylinderProblem&lt; ELEMENT &gt;" shape="rect" coords="491,6328,972,6352"/>
<area href="../../dc/d83/classFlowAroundCylinderProblem.html" title="Flow around a cylinder in rectangular domain." alt="FlowAroundCylinderProblem&lt; ELEMENT &gt;" shape="rect" coords="491,6384,972,6408"/>
<area href="../../d8/d48/classFlowAroundHalfCylinderProblem.html" title="Flow around a cylinder in rectangular domain." alt="FlowAroundHalfCylinderProblem&lt; ELEMENT &gt;" shape="rect" coords="491,6440,972,6464"/>
<area href="../../d8/d48/classFlowAroundHalfCylinderProblem.html" title="Flow around a cylinder in rectangular domain." alt="FlowAroundHalfCylinderProblem&lt; ELEMENT &gt;" shape="rect" coords="491,6496,972,6520"/>
<area href="../../d8/d48/classFlowAroundHalfCylinderProblem.html" title="Flow around a cylinder in rectangular domain." alt="FlowAroundHalfCylinderProblem&lt; ELEMENT &gt;" shape="rect" coords="491,6552,972,6576"/>
<area href="../../d8/d48/classFlowAroundHalfCylinderProblem.html" title="Flow around a cylinder in rectangular domain." alt="FlowAroundHalfCylinderProblem&lt; ELEMENT &gt;" shape="rect" coords="491,6608,972,6632"/>
<area href="../../da/d13/classFlowPastBoxProblem.html" title="Flow past a box in a channel." alt="FlowPastBoxProblem&lt; ELEMENT &gt;" shape="rect" coords="491,6664,972,6688"/>
<area href="../../da/d13/classFlowPastBoxProblem.html" title="Flow past a box in a channel." alt="FlowPastBoxProblem&lt; ELEMENT &gt;" shape="rect" coords="491,6720,972,6744"/>
<area href="../../df/da7/classFluxPoissonProblem.html" alt="FluxPoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,6776,972,6800"/>
<area href="../../d9/d32/classFourierDecomposedHelmholtzProblem.html" title="Problem class." alt="FourierDecomposedHelmholtzProblem&lt; ELEMENT &gt;" shape="rect" coords="491,6832,972,6856"/>
<area href="../../d9/d32/classFourierDecomposedHelmholtzProblem.html" title="Problem class." alt="FourierDecomposedHelmholtzProblem&lt; ELEMENT &gt;" shape="rect" coords="491,6888,972,6912"/>
<area href="../../d6/d48/classFourierDecomposedTimeHarmonicLinearElasticityProblem.html" alt="FourierDecomposedTimeHarmonicLinearElasticityProblem&lt; ELEMENT &gt;" shape="rect" coords="491,6944,972,6968"/>
<area href="../../d6/d48/classFourierDecomposedTimeHarmonicLinearElasticityProblem.html" alt="FourierDecomposedTimeHarmonicLinearElasticityProblem&lt; ELEMENT &gt;" shape="rect" coords="491,7000,972,7024"/>
<area href="../../d6/d48/classFourierDecomposedTimeHarmonicLinearElasticityProblem.html" alt="FourierDecomposedTimeHarmonicLinearElasticityProblem&lt; ELEMENT &gt;" shape="rect" coords="491,7056,972,7080"/>
<area href="../../de/da5/classFpTestProblem.html" title="Test problem for Fp/PCD preconditioner." alt="FpTestProblem" shape="rect" coords="491,7112,972,7136"/>
<area href="../../de/da5/classFpTestProblem.html" title="Test problem for Fp/PCD preconditioner." alt="FpTestProblem" shape="rect" coords="491,7168,972,7192"/>
<area href="../../db/da5/classFreeBoundaryPoissonProblem.html" alt="FreeBoundaryPoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,7224,972,7248"/>
<area href="../../db/da5/classFreeBoundaryPoissonProblem.html" alt="FreeBoundaryPoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,7280,972,7304"/>
<area href="../../d9/d2f/classFreeSurfaceRotationProblem.html" title="Entry flow problem in quarter tube domain." alt="FreeSurfaceRotationProblem&lt; ELEMENT &gt;" shape="rect" coords="491,7336,972,7360"/>
<area href="../../d9/d2f/classFreeSurfaceRotationProblem.html" title="Entry flow problem in quarter tube domain." alt="FreeSurfaceRotationProblem&lt; ELEMENT &gt;" shape="rect" coords="491,7392,972,7416"/>
<area href="../../d6/d09/classGeomObjectAsGeneralisedElementProblem.html" alt="GeomObjectAsGeneralisedElementProblem" shape="rect" coords="491,7448,972,7472"/>
<area href="../../de/dcc/classHarmonicProblem.html" title="1D Harmonic problem in unit interval." alt="HarmonicProblem&lt; ELEMENT, EIGEN_SOLVER &gt;" shape="rect" coords="491,7504,972,7528"/>
<area href="../../de/dcc/classHarmonicProblem.html" title="1D Harmonic problem in unit interval." alt="HarmonicProblem&lt; ELEMENT, EIGEN_SOLVER &gt;" shape="rect" coords="491,7560,972,7584"/>
<area href="../../d7/dd7/classHelmholtzPointSourceProblem.html" title="Problem class." alt="HelmholtzPointSourceProblem&lt; ELEMENT &gt;" shape="rect" coords="491,7616,972,7640"/>
<area href="../../dd/d61/classHomogenisationProblem.html" title="Problem class to simulate viscous inclusion propagating along 2D channel." alt="HomogenisationProblem&lt; ELEMENT &gt;" shape="rect" coords="491,7672,972,7696"/>
<area href="../../dd/d61/classHomogenisationProblem.html" title="Problem class to simulate viscous inclusion propagating along 2D channel." alt="HomogenisationProblem&lt; ELEMENT &gt;" shape="rect" coords="491,7728,972,7752"/>
<area href="../../df/da8/classInclinedPlaneProblem.html" alt="InclinedPlaneProblem&lt; ELEMENT, INTERFACE_ELEMENT &gt;" shape="rect" coords="491,7784,972,7808"/>
<area href="../../d9/d15/classInterfaceProblem.html" title="Single axisymmetric fluid interface problem in rectangular domain." alt="InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;" shape="rect" coords="491,7840,972,7864"/>
<area href="../../d9/d15/classInterfaceProblem.html" title="Single axisymmetric fluid interface problem in rectangular domain." alt="InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;" shape="rect" coords="491,7896,972,7920"/>
<area href="../../d9/d15/classInterfaceProblem.html" title="Single axisymmetric fluid interface problem in rectangular domain." alt="InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;" shape="rect" coords="491,7952,972,7976"/>
<area href="../../d9/d15/classInterfaceProblem.html" title="Single axisymmetric fluid interface problem in rectangular domain." alt="InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;" shape="rect" coords="491,8008,972,8032"/>
<area href="../../d9/d15/classInterfaceProblem.html" title="Single axisymmetric fluid interface problem in rectangular domain." alt="InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;" shape="rect" coords="491,8064,972,8088"/>
<area href="../../d9/d15/classInterfaceProblem.html" title="Single axisymmetric fluid interface problem in rectangular domain." alt="InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;" shape="rect" coords="491,8120,972,8144"/>
<area href="../../d9/d15/classInterfaceProblem.html" title="Single axisymmetric fluid interface problem in rectangular domain." alt="InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;" shape="rect" coords="491,8176,972,8200"/>
<area href="../../d9/d15/classInterfaceProblem.html" title="Single axisymmetric fluid interface problem in rectangular domain." alt="InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;" shape="rect" coords="491,8232,972,8256"/>
<area href="../../d9/d15/classInterfaceProblem.html" title="Single axisymmetric fluid interface problem in rectangular domain." alt="InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;" shape="rect" coords="491,8288,972,8312"/>
<area href="../../d9/d15/classInterfaceProblem.html" title="Single axisymmetric fluid interface problem in rectangular domain." alt="InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;" shape="rect" coords="491,8344,972,8368"/>
<area href="../../d9/d15/classInterfaceProblem.html" title="Single axisymmetric fluid interface problem in rectangular domain." alt="InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;" shape="rect" coords="491,8400,972,8424"/>
<area href="../../d9/d15/classInterfaceProblem.html" title="Single axisymmetric fluid interface problem in rectangular domain." alt="InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;" shape="rect" coords="491,8456,972,8480"/>
<area href="../../d4/db2/classLinearWaveProblem.html" title="LinearWave problem in rectanglular domain." alt="LinearWaveProblem&lt; ELEMENT, TIMESTEPPER &gt;" shape="rect" coords="491,8512,972,8536"/>
<area href="../../d4/db2/classLinearWaveProblem.html" title="LinearWave problem in rectanglular domain." alt="LinearWaveProblem&lt; ELEMENT, TIMESTEPPER &gt;" shape="rect" coords="491,8568,972,8592"/>
<area href="../../d4/db2/classLinearWaveProblem.html" title="LinearWave problem in rectanglular domain." alt="LinearWaveProblem&lt; ELEMENT, TIMESTEPPER &gt;" shape="rect" coords="491,8624,972,8648"/>
<area href="../../d0/d73/classMeltContactProblem.html" title="Problem class." alt="MeltContactProblem&lt; ELEMENT &gt;" shape="rect" coords="491,8680,972,8704"/>
<area href="../../dc/da5/classMeltSpinningProblem.html" title="Melt spinning axisymmetric fluid interface problem in rectangular domain." alt="MeltSpinningProblem&lt; ELEMENT &gt;" shape="rect" coords="491,8736,972,8760"/>
<area href="../../d9/d9c/classMortaringValidationProblem.html" alt="MortaringValidationProblem&lt; ELEMENT, NON_MORTAR_ELEMENT &gt;" shape="rect" coords="491,8792,972,8816"/>
<area href="../../d9/d9c/classMortaringValidationProblem.html" alt="MortaringValidationProblem&lt; ELEMENT, NON_MORTAR_ELEMENT &gt;" shape="rect" coords="491,8848,972,8872"/>
<area href="../../d9/d9c/classMortaringValidationProblem.html" alt="MortaringValidationProblem&lt; ELEMENT, NON_MORTAR_ELEMENT &gt;" shape="rect" coords="491,8904,972,8928"/>
<area href="../../da/d64/classMovingBlockProblem.html" title="Moving block problem." alt="MovingBlockProblem&lt; ELEMENT &gt;" shape="rect" coords="491,8960,972,8984"/>
<area href="../../da/d64/classMovingBlockProblem.html" title="Moving block problem." alt="MovingBlockProblem&lt; ELEMENT &gt;" shape="rect" coords="491,9016,972,9040"/>
<area href="../../d2/d8f/classMultiPoissonProblem.html" alt="MultiPoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,9072,972,9096"/>
<area href="../../d2/d8f/classMultiPoissonProblem.html" alt="MultiPoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,9128,972,9152"/>
<area href="../../d2/dd4/classNavierStokesProblem.html" title="Entry flow problem in quarter tube domain." alt="NavierStokesProblem&lt; ELEMENT &gt;" shape="rect" coords="491,9184,972,9208"/>
<area href="../../d2/dd4/classNavierStokesProblem.html" title="Entry flow problem in quarter tube domain." alt="NavierStokesProblem&lt; ELEMENT &gt;" shape="rect" coords="491,9240,972,9264"/>
<area href="../../d0/dd0/classOneDPoissonProblem.html" title="1D Poisson problem in unit interval." alt="OneDPoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,9296,972,9320"/>
<area href="../../d0/dd0/classOneDPoissonProblem.html" title="1D Poisson problem in unit interval." alt="OneDPoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,9352,972,9376"/>
<area href="../../d0/dd0/classOneDPoissonProblem.html" title="1D Poisson problem in unit interval." alt="OneDPoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,9408,972,9432"/>
<area href="../../d0/dd0/classOneDPoissonProblem.html" title="1D Poisson problem in unit interval." alt="OneDPoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,9464,972,9488"/>
<area href="../../d0/dd0/classOneDPoissonProblem.html" title="1D Poisson problem in unit interval." alt="OneDPoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,9520,972,9544"/>
<area href="../../d0/dd0/classOneDPoissonProblem.html" title="1D Poisson problem in unit interval." alt="OneDPoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,9576,972,9600"/>
<area href="../../d0/dd0/classOneDPoissonProblem.html" title="1D Poisson problem in unit interval." alt="OneDPoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,9632,972,9656"/>
<area href="../../d0/dd0/classOneDPoissonProblem.html" title="1D Poisson problem in unit interval." alt="OneDPoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,9688,972,9712"/>
<area href="../../d0/dd0/classOneDPoissonProblem.html" title="1D Poisson problem in unit interval." alt="OneDPoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,9744,972,9768"/>
<area href="../../dc/db9/classOrrSommerfeldProblem.html" title="OrrSommerfeld problem in unit interval." alt="OrrSommerfeldProblem&lt; ELEMENT &gt;" shape="rect" coords="491,9800,972,9824"/>
<area href="../../db/d50/classOscEllipseProblem.html" title="Navier-Stokes problem in an oscillating ellipse domain." alt="OscEllipseProblem&lt; ELEMENT, TIMESTEPPER &gt;" shape="rect" coords="491,9856,972,9880"/>
<area href="../../dd/d71/classOscRingNStProblem.html" alt="OscRingNStProblem&lt; ELEMENT &gt;" shape="rect" coords="491,9912,972,9936"/>
<area href="../../dd/d71/classOscRingNStProblem.html" alt="OscRingNStProblem&lt; ELEMENT &gt;" shape="rect" coords="491,9968,972,9992"/>
<area href="../../dd/d71/classOscRingNStProblem.html" alt="OscRingNStProblem&lt; ELEMENT &gt;" shape="rect" coords="491,10024,972,10048"/>
<area href="../../dd/d71/classOscRingNStProblem.html" alt="OscRingNStProblem&lt; ELEMENT &gt;" shape="rect" coords="491,10080,972,10104"/>
<area href="../../d5/d17/classPMLFourierDecomposedHelmholtzProblem.html" title="Problem class." alt="PMLFourierDecomposedHelmholtzProblem&lt; ELEMENT &gt;" shape="rect" coords="491,10136,972,10160"/>
<area href="../../d0/dfa/classPMLProblem.html" alt="PMLProblem&lt; ELEMENT &gt;" shape="rect" coords="491,10192,972,10216"/>
<area href="../../d0/dfa/classPMLProblem.html" alt="PMLProblem&lt; ELEMENT &gt;" shape="rect" coords="491,10248,972,10272"/>
<area href="../../dc/d61/classPRefineableDrivenCavityProblem.html" alt="PRefineableDrivenCavityProblem&lt; ELEMENT &gt;" shape="rect" coords="491,10304,972,10328"/>
<area href="../../dc/d61/classPRefineableDrivenCavityProblem.html" alt="PRefineableDrivenCavityProblem&lt; ELEMENT &gt;" shape="rect" coords="491,10360,972,10384"/>
<area href="../../dc/d61/classPRefineableDrivenCavityProblem.html" alt="PRefineableDrivenCavityProblem&lt; ELEMENT &gt;" shape="rect" coords="491,10416,972,10440"/>
<area href="../../d3/d3c/classPRefineableOneDPoissonProblem.html" alt="PRefineableOneDPoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,10472,972,10496"/>
<area href="../../d0/d28/classPeriodicLoadProblem.html" title="Periodic loading problem." alt="PeriodicLoadProblem&lt; ELEMENT &gt;" shape="rect" coords="491,10528,972,10552"/>
<area href="../../d0/d28/classPeriodicLoadProblem.html" title="Periodic loading problem." alt="PeriodicLoadProblem&lt; ELEMENT &gt;" shape="rect" coords="491,10584,972,10608"/>
<area href="../../d5/d62/classPerturbedStateProblem.html" alt="PerturbedStateProblem&lt; BASE_ELEMENT, PERTURBED_ELEMENT &gt;" shape="rect" coords="491,10640,972,10664"/>
<area href="../../d5/d62/classPerturbedStateProblem.html" alt="PerturbedStateProblem&lt; BASE_ELEMENT, PERTURBED_ELEMENT &gt;" shape="rect" coords="491,10696,972,10720"/>
<area href="../../d5/d62/classPerturbedStateProblem.html" alt="PerturbedStateProblem&lt; BASE_ELEMENT, PERTURBED_ELEMENT &gt;" shape="rect" coords="491,10752,972,10776"/>
<area href="../../d5/d62/classPerturbedStateProblem.html" alt="PerturbedStateProblem&lt; BASE_ELEMENT, PERTURBED_ELEMENT &gt;" shape="rect" coords="491,10808,972,10832"/>
<area href="../../d5/d62/classPerturbedStateProblem.html" alt="PerturbedStateProblem&lt; BASE_ELEMENT, PERTURBED_ELEMENT &gt;" shape="rect" coords="491,10864,972,10888"/>
<area href="../../d5/d62/classPerturbedStateProblem.html" alt="PerturbedStateProblem&lt; BASE_ELEMENT, PERTURBED_ELEMENT &gt;" shape="rect" coords="491,10920,972,10944"/>
<area href="../../db/d95/classPlateProblem.html" alt="PlateProblem&lt; ELEMENT &gt;" shape="rect" coords="491,10976,972,11000"/>
<area href="../../d0/d5c/classPoissonProblem.html" title="Micky mouse Poisson problem." alt="PoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,11032,972,11056"/>
<area href="../../d0/d5c/classPoissonProblem.html" title="Micky mouse Poisson problem." alt="PoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,11088,972,11112"/>
<area href="../../d0/d5c/classPoissonProblem.html" title="Micky mouse Poisson problem." alt="PoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,11144,972,11168"/>
<area href="../../d0/d5c/classPoissonProblem.html" title="Micky mouse Poisson problem." alt="PoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,11200,972,11224"/>
<area href="../../d0/d5c/classPoissonProblem.html" title="Micky mouse Poisson problem." alt="PoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,11256,972,11280"/>
<area href="../../d0/d5c/classPoissonProblem.html" title="Micky mouse Poisson problem." alt="PoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,11312,972,11336"/>
<area href="../../d0/d5c/classPoissonProblem.html" title="Micky mouse Poisson problem." alt="PoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,11368,972,11392"/>
<area href="../../d0/d5c/classPoissonProblem.html" title="Micky mouse Poisson problem." alt="PoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,11424,972,11448"/>
<area href="../../d0/d5c/classPoissonProblem.html" title="Micky mouse Poisson problem." alt="PoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,11480,972,11504"/>
<area href="../../d0/d5c/classPoissonProblem.html" title="Micky mouse Poisson problem." alt="PoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,11536,972,11560"/>
<area href="../../d0/d5c/classPoissonProblem.html" title="Micky mouse Poisson problem." alt="PoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,11592,972,11616"/>
<area href="../../d0/d5c/classPoissonProblem.html" title="Micky mouse Poisson problem." alt="PoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,11648,972,11672"/>
<area href="../../d0/d5c/classPoissonProblem.html" title="Micky mouse Poisson problem." alt="PoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,11704,972,11728"/>
<area href="../../d0/d5c/classPoissonProblem.html" title="Micky mouse Poisson problem." alt="PoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,11760,972,11784"/>
<area href="../../d0/d5c/classPoissonProblem.html" title="Micky mouse Poisson problem." alt="PoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,11816,972,11840"/>
<area href="../../d0/d5c/classPoissonProblem.html" title="Micky mouse Poisson problem." alt="PoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,11872,972,11896"/>
<area href="../../d0/d5c/classPoissonProblem.html" title="Micky mouse Poisson problem." alt="PoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,11928,972,11952"/>
<area href="../../d0/d5c/classPoissonProblem.html" title="Micky mouse Poisson problem." alt="PoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,11984,972,12008"/>
<area href="../../d0/d5c/classPoissonProblem.html" title="Micky mouse Poisson problem." alt="PoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,12040,972,12064"/>
<area href="../../d0/d5c/classPoissonProblem.html" title="Micky mouse Poisson problem." alt="PoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,12096,972,12120"/>
<area href="../../d0/d5c/classPoissonProblem.html" title="Micky mouse Poisson problem." alt="PoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,12152,972,12176"/>
<area href="../../d0/d5c/classPoissonProblem.html" title="Micky mouse Poisson problem." alt="PoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,12208,972,12232"/>
<area href="../../d0/d5c/classPoissonProblem.html" title="Micky mouse Poisson problem." alt="PoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,12264,972,12288"/>
<area href="../../d0/d5c/classPoissonProblem.html" title="Micky mouse Poisson problem." alt="PoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,12320,972,12344"/>
<area href="../../d2/d5a/classPolarNSProblem.html" title="Driven cavity problem in rectangular domain." alt="PolarNSProblem&lt; ELEMENT &gt;" shape="rect" coords="491,12376,972,12400"/>
<area href="../../d8/d82/classPredPreyProblem.html" alt="PredPreyProblem&lt; ELEMENT &gt;" shape="rect" coords="491,12432,972,12456"/>
<area href="../../d9/d27/classPrescribedBoundaryDisplacementProblem.html" alt="PrescribedBoundaryDisplacementProblem&lt; ELEMENT &gt;" shape="rect" coords="491,12488,972,12512"/>
<area href="../../d9/d27/classPrescribedBoundaryDisplacementProblem.html" alt="PrescribedBoundaryDisplacementProblem&lt; ELEMENT &gt;" shape="rect" coords="491,12544,972,12568"/>
<area href="../../d9/d27/classPrescribedBoundaryDisplacementProblem.html" alt="PrescribedBoundaryDisplacementProblem&lt; ELEMENT &gt;" shape="rect" coords="491,12600,972,12624"/>
<area href="../../d9/d27/classPrescribedBoundaryDisplacementProblem.html" alt="PrescribedBoundaryDisplacementProblem&lt; ELEMENT &gt;" shape="rect" coords="491,12656,972,12680"/>
<area href="../../d9/d27/classPrescribedBoundaryDisplacementProblem.html" alt="PrescribedBoundaryDisplacementProblem&lt; ELEMENT &gt;" shape="rect" coords="491,12712,972,12736"/>
<area href="../../d9/d27/classPrescribedBoundaryDisplacementProblem.html" alt="PrescribedBoundaryDisplacementProblem&lt; ELEMENT &gt;" shape="rect" coords="491,12768,972,12792"/>
<area href="../../d9/d27/classPrescribedBoundaryDisplacementProblem.html" alt="PrescribedBoundaryDisplacementProblem&lt; ELEMENT &gt;" shape="rect" coords="491,12824,972,12848"/>
<area href="../../d6/d53/classPressureWaveFSIProblem.html" title="Problem class." alt="PressureWaveFSIProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;" shape="rect" coords="491,12880,972,12904"/>
<area href="../../d6/d53/classPressureWaveFSIProblem.html" title="Problem class." alt="PressureWaveFSIProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;" shape="rect" coords="491,12936,972,12960"/>
<area href="../../d3/db4/classPseudoElasticCollapsibleChannelProblem.html" alt="PseudoElasticCollapsibleChannelProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;" shape="rect" coords="491,12992,972,13016"/>
<area href="../../d3/db4/classPseudoElasticCollapsibleChannelProblem.html" alt="PseudoElasticCollapsibleChannelProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;" shape="rect" coords="491,13048,972,13072"/>
<area href="../../d3/db4/classPseudoElasticCollapsibleChannelProblem.html" alt="PseudoElasticCollapsibleChannelProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;" shape="rect" coords="491,13104,972,13128"/>
<area href="../../d8/d17/classPseudoSolidCapProblem.html" alt="PseudoSolidCapProblem&lt; ELEMENT &gt;" shape="rect" coords="491,13160,972,13184"/>
<area href="../../d8/d17/classPseudoSolidCapProblem.html" alt="PseudoSolidCapProblem&lt; ELEMENT &gt;" shape="rect" coords="491,13216,972,13240"/>
<area href="../../d8/d17/classPseudoSolidCapProblem.html" alt="PseudoSolidCapProblem&lt; ELEMENT &gt;" shape="rect" coords="491,13272,972,13296"/>
<area href="../../d1/d35/classQFaceTestProblem.html" title="QFaceTest problem." alt="QFaceTestProblem&lt; ELEMENT &gt;" shape="rect" coords="491,13328,972,13352"/>
<area href="../../d1/d35/classQFaceTestProblem.html" title="QFaceTest problem." alt="QFaceTestProblem&lt; ELEMENT &gt;" shape="rect" coords="491,13384,972,13408"/>
<area href="../../d8/d66/classQuarterCircleDrivenCavityProblem.html" alt="QuarterCircleDrivenCavityProblem&lt; ELEMENT &gt;" shape="rect" coords="491,13440,972,13464"/>
<area href="../../d8/d66/classQuarterCircleDrivenCavityProblem.html" alt="QuarterCircleDrivenCavityProblem&lt; ELEMENT &gt;" shape="rect" coords="491,13496,972,13520"/>
<area href="../../d8/d66/classQuarterCircleDrivenCavityProblem.html" alt="QuarterCircleDrivenCavityProblem&lt; ELEMENT &gt;" shape="rect" coords="491,13552,972,13576"/>
<area href="../../d4/d6c/classQuarterCircleDrivenCavityProblem2.html" alt="QuarterCircleDrivenCavityProblem2&lt; ELEMENT &gt;" shape="rect" coords="491,13608,972,13632"/>
<area href="../../d6/da9/classRayleighProblem.html" alt="RayleighProblem&lt; ELEMENT, TIMESTEPPER &gt;" shape="rect" coords="491,13664,972,13688"/>
<area href="../../d6/da9/classRayleighProblem.html" alt="RayleighProblem&lt; ELEMENT, TIMESTEPPER &gt;" shape="rect" coords="491,13720,972,13744"/>
<area href="../../d6/da9/classRayleighProblem.html" alt="RayleighProblem&lt; ELEMENT, TIMESTEPPER &gt;" shape="rect" coords="491,13776,972,13800"/>
<area href="../../de/d2b/classRayleighTractionProblem.html" title="Rayleigh-type problem: 2D channel flow driven by traction bc." alt="RayleighTractionProblem&lt; ELEMENT, TIMESTEPPER &gt;" shape="rect" coords="491,13832,972,13856"/>
<area href="../../d4/d57/classRectangularDrivenCavityProblem.html" title="Driven cavity problem in rectangular domain." alt="RectangularDrivenCavityProblem&lt; ELEMENT &gt;" shape="rect" coords="491,13888,972,13912"/>
<area href="../../d4/d57/classRectangularDrivenCavityProblem.html" title="Driven cavity problem in rectangular domain." alt="RectangularDrivenCavityProblem&lt; ELEMENT &gt;" shape="rect" coords="491,13944,972,13968"/>
<area href="../../d4/d57/classRectangularDrivenCavityProblem.html" title="Driven cavity problem in rectangular domain." alt="RectangularDrivenCavityProblem&lt; ELEMENT &gt;" shape="rect" coords="491,14000,972,14024"/>
<area href="../../d4/d57/classRectangularDrivenCavityProblem.html" title="Driven cavity problem in rectangular domain." alt="RectangularDrivenCavityProblem&lt; ELEMENT &gt;" shape="rect" coords="491,14056,972,14080"/>
<area href="../../d4/d57/classRectangularDrivenCavityProblem.html" title="Driven cavity problem in rectangular domain." alt="RectangularDrivenCavityProblem&lt; ELEMENT &gt;" shape="rect" coords="491,14112,972,14136"/>
<area href="../../d4/d57/classRectangularDrivenCavityProblem.html" title="Driven cavity problem in rectangular domain." alt="RectangularDrivenCavityProblem&lt; ELEMENT &gt;" shape="rect" coords="491,14168,972,14192"/>
<area href="../../d4/d57/classRectangularDrivenCavityProblem.html" title="Driven cavity problem in rectangular domain." alt="RectangularDrivenCavityProblem&lt; ELEMENT &gt;" shape="rect" coords="491,14224,972,14248"/>
<area href="../../d5/d48/classRefineableActivatorInhibitorProblem.html" alt="RefineableActivatorInhibitorProblem&lt; ELEMENT &gt;" shape="rect" coords="491,14280,972,14304"/>
<area href="../../d5/d48/classRefineableActivatorInhibitorProblem.html" alt="RefineableActivatorInhibitorProblem&lt; ELEMENT &gt;" shape="rect" coords="491,14336,972,14360"/>
<area href="../../d9/dd7/classRefineableAdvectionDiffusionPipeProblem.html" alt="RefineableAdvectionDiffusionPipeProblem&lt; ELEMENT &gt;" shape="rect" coords="491,14392,972,14416"/>
<area href="../../d9/dd7/classRefineableAdvectionDiffusionPipeProblem.html" alt="RefineableAdvectionDiffusionPipeProblem&lt; ELEMENT &gt;" shape="rect" coords="491,14448,972,14472"/>
<area href="../../d1/d21/classRefineableAdvectionDiffusionProblem.html" alt="RefineableAdvectionDiffusionProblem&lt; ELEMENT &gt;" shape="rect" coords="491,14504,972,14528"/>
<area href="../../d1/d21/classRefineableAdvectionDiffusionProblem.html" alt="RefineableAdvectionDiffusionProblem&lt; ELEMENT &gt;" shape="rect" coords="491,14560,972,14584"/>
<area href="../../d1/d21/classRefineableAdvectionDiffusionProblem.html" alt="RefineableAdvectionDiffusionProblem&lt; ELEMENT &gt;" shape="rect" coords="491,14616,972,14640"/>
<area href="../../d1/d1f/classRefineableConvectionProblem.html" alt="RefineableConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;" shape="rect" coords="491,14672,972,14696"/>
<area href="../../d1/d1f/classRefineableConvectionProblem.html" alt="RefineableConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;" shape="rect" coords="491,14728,972,14752"/>
<area href="../../d1/d1f/classRefineableConvectionProblem.html" alt="RefineableConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;" shape="rect" coords="491,14784,972,14808"/>
<area href="../../d1/d1f/classRefineableConvectionProblem.html" alt="RefineableConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;" shape="rect" coords="491,14840,972,14864"/>
<area href="../../d1/d1f/classRefineableConvectionProblem.html" alt="RefineableConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;" shape="rect" coords="491,14896,972,14920"/>
<area href="../../d1/d1f/classRefineableConvectionProblem.html" alt="RefineableConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;" shape="rect" coords="491,14952,972,14976"/>
<area href="../../db/d70/classRefineableDDConvectionProblem.html" alt="RefineableDDConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;" shape="rect" coords="491,15008,972,15032"/>
<area href="../../dd/de5/classRefineableDrivenCavityProblem.html" alt="RefineableDrivenCavityProblem&lt; ELEMENT &gt;" shape="rect" coords="491,15064,972,15088"/>
<area href="../../dd/de5/classRefineableDrivenCavityProblem.html" alt="RefineableDrivenCavityProblem&lt; ELEMENT &gt;" shape="rect" coords="491,15120,972,15144"/>
<area href="../../dd/de5/classRefineableDrivenCavityProblem.html" alt="RefineableDrivenCavityProblem&lt; ELEMENT &gt;" shape="rect" coords="491,15176,972,15200"/>
<area href="../../dd/de5/classRefineableDrivenCavityProblem.html" alt="RefineableDrivenCavityProblem&lt; ELEMENT &gt;" shape="rect" coords="491,15232,972,15256"/>
<area href="../../dd/de5/classRefineableDrivenCavityProblem.html" alt="RefineableDrivenCavityProblem&lt; ELEMENT &gt;" shape="rect" coords="491,15288,972,15312"/>
<area href="../../dd/de5/classRefineableDrivenCavityProblem.html" alt="RefineableDrivenCavityProblem&lt; ELEMENT &gt;" shape="rect" coords="491,15344,972,15368"/>
<area href="../../dd/de5/classRefineableDrivenCavityProblem.html" alt="RefineableDrivenCavityProblem&lt; ELEMENT &gt;" shape="rect" coords="491,15400,972,15424"/>
<area href="../../de/d7c/classRefineableElutingSphereProblem.html" alt="RefineableElutingSphereProblem&lt; ELEMENT &gt;" shape="rect" coords="491,15456,972,15480"/>
<area href="../../de/d23/classRefineableFishPoissonProblem.html" alt="RefineableFishPoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,15512,972,15536"/>
<area href="../../de/d23/classRefineableFishPoissonProblem.html" alt="RefineableFishPoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,15568,972,15592"/>
<area href="../../de/d23/classRefineableFishPoissonProblem.html" alt="RefineableFishPoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,15624,972,15648"/>
<area href="../../de/d23/classRefineableFishPoissonProblem.html" alt="RefineableFishPoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,15680,972,15704"/>
<area href="../../de/d23/classRefineableFishPoissonProblem.html" alt="RefineableFishPoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,15736,972,15760"/>
<area href="../../de/d23/classRefineableFishPoissonProblem.html" alt="RefineableFishPoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,15792,972,15816"/>
<area href="../../de/d23/classRefineableFishPoissonProblem.html" alt="RefineableFishPoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,15848,972,15872"/>
<area href="../../d9/dc8/classRefineableOneDAdvectionDiffusionReactionProblem.html" alt="RefineableOneDAdvectionDiffusionReactionProblem&lt; ELEMENT &gt;" shape="rect" coords="491,15904,972,15928"/>
<area href="../../d3/d40/classRefineableOneDPoissonProblem.html" alt="RefineableOneDPoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,15960,972,15984"/>
<area href="../../d7/dc1/classRefineablePeriodicLoadProblem.html" title="Periodic loading problem." alt="RefineablePeriodicLoadProblem&lt; ELEMENT &gt;" shape="rect" coords="491,16016,972,16040"/>
<area href="../../d8/da8/classRefineablePoissonProblem.html" alt="RefineablePoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,16072,972,16096"/>
<area href="../../d8/da8/classRefineablePoissonProblem.html" alt="RefineablePoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,16128,972,16152"/>
<area href="../../d8/da8/classRefineablePoissonProblem.html" alt="RefineablePoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,16184,972,16208"/>
<area href="../../d8/da8/classRefineablePoissonProblem.html" alt="RefineablePoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,16240,972,16264"/>
<area href="../../d8/da8/classRefineablePoissonProblem.html" alt="RefineablePoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,16296,972,16320"/>
<area href="../../d0/d33/classRefineablePorousChannelProblem.html" title="Porous channel flow on a refineable mesh." alt="RefineablePorousChannelProblem&lt; ELEMENT &gt;" shape="rect" coords="491,16352,972,16376"/>
<area href="../../d2/d3d/classRefineableRotatingCylinderProblem.html" alt="RefineableRotatingCylinderProblem&lt; ELEMENT &gt;" shape="rect" coords="491,16408,972,16432"/>
<area href="../../d8/d6a/classRefineableSphereConvectionProblem.html" title="Convection in a spherical shell." alt="RefineableSphereConvectionProblem&lt; ELEMENT &gt;" shape="rect" coords="491,16464,972,16488"/>
<area href="../../d0/d46/classRefineableSphericalCouetteProblem.html" title="Driven cavity problem in rectangular domain - time dependent version." alt="RefineableSphericalCouetteProblem&lt; ELEMENT &gt;" shape="rect" coords="491,16520,972,16544"/>
<area href="../../d6/df1/classRefineableSphericalSpinUpProblem.html" title="Driven cavity problem in rectangular domain - time dependent version." alt="RefineableSphericalSpinUpProblem&lt; ELEMENT &gt;" shape="rect" coords="491,16576,972,16600"/>
<area href="../../d6/df1/classRefineableSphericalSpinUpProblem.html" title="Driven cavity problem in rectangular domain - time dependent version." alt="RefineableSphericalSpinUpProblem&lt; ELEMENT &gt;" shape="rect" coords="491,16632,972,16656"/>
<area href="../../df/dab/classRefineableTwoDPoissonProblem.html" alt="RefineableTwoDPoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,16688,972,16712"/>
<area href="../../df/dab/classRefineableTwoDPoissonProblem.html" alt="RefineableTwoDPoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,16744,972,16768"/>
<area href="../../dd/d43/classRefineableTwoMeshFluxPoissonProblem.html" alt="RefineableTwoMeshFluxPoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,16800,972,16824"/>
<area href="../../dd/d43/classRefineableTwoMeshFluxPoissonProblem.html" alt="RefineableTwoMeshFluxPoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,16856,972,16880"/>
<area href="../../d4/d68/classRefineableUnsteadyHeatProblem.html" title="Unsteady heat problem in deformable ellipse domain." alt="RefineableUnsteadyHeatProblem&lt; ELEMENT &gt;" shape="rect" coords="491,16912,972,16936"/>
<area href="../../d4/d68/classRefineableUnsteadyHeatProblem.html" title="Unsteady heat problem in deformable ellipse domain." alt="RefineableUnsteadyHeatProblem&lt; ELEMENT &gt;" shape="rect" coords="491,16968,972,16992"/>
<area href="../../d4/d68/classRefineableUnsteadyHeatProblem.html" title="Unsteady heat problem in deformable ellipse domain." alt="RefineableUnsteadyHeatProblem&lt; ELEMENT &gt;" shape="rect" coords="491,17024,972,17048"/>
<area href="../../d4/d68/classRefineableUnsteadyHeatProblem.html" title="Unsteady heat problem in deformable ellipse domain." alt="RefineableUnsteadyHeatProblem&lt; ELEMENT &gt;" shape="rect" coords="491,17080,972,17104"/>
<area href="../../d4/d68/classRefineableUnsteadyHeatProblem.html" title="Unsteady heat problem in deformable ellipse domain." alt="RefineableUnsteadyHeatProblem&lt; ELEMENT &gt;" shape="rect" coords="491,17136,972,17160"/>
<area href="../../d9/d4a/classRefineableYoungLaplaceProblem.html" alt="RefineableYoungLaplaceProblem&lt; ELEMENT &gt;" shape="rect" coords="491,17192,972,17216"/>
<area href="../../d9/d4a/classRefineableYoungLaplaceProblem.html" alt="RefineableYoungLaplaceProblem&lt; ELEMENT &gt;" shape="rect" coords="491,17248,972,17272"/>
<area href="../../d9/d4a/classRefineableYoungLaplaceProblem.html" alt="RefineableYoungLaplaceProblem&lt; ELEMENT &gt;" shape="rect" coords="491,17304,972,17328"/>
<area href="../../df/d2c/classRingWithTRibProblem.html" title="Annular disk." alt="RingWithTRibProblem&lt; ELASTICITY_ELEMENT &gt;" shape="rect" coords="491,17360,972,17384"/>
<area href="../../d9/deb/classRisingBubbleProblem.html" title="Micky mouse problem." alt="RisingBubbleProblem&lt; ELEMENT &gt;" shape="rect" coords="491,17416,972,17440"/>
<area href="../../d0/d94/classRotatingCylinderProblem.html" alt="RotatingCylinderProblem&lt; ELEMENT, TIMESTEPPER &gt;" shape="rect" coords="491,17472,972,17496"/>
<area href="../../da/d79/classRotatingProblem.html" alt="RotatingProblem&lt; ELEMENT &gt;" shape="rect" coords="491,17528,972,17552"/>
<area href="../../da/d79/classRotatingProblem.html" alt="RotatingProblem&lt; ELEMENT &gt;" shape="rect" coords="491,17584,972,17608"/>
<area href="../../da/d79/classRotatingProblem.html" alt="RotatingProblem&lt; ELEMENT &gt;" shape="rect" coords="491,17640,972,17664"/>
<area href="../../d3/d70/classSUPGAdvectionDiffusionProblem.html" alt="SUPGAdvectionDiffusionProblem&lt; ELEMENT &gt;" shape="rect" coords="491,17696,972,17720"/>
<area href="../../d1/dc3/classScatteringProblem.html" title="Problem class to compute scattering of planar wave from unit disk." alt="ScatteringProblem&lt; ELEMENT &gt;" shape="rect" coords="491,17752,972,17776"/>
<area href="../../d1/dc3/classScatteringProblem.html" title="Problem class to compute scattering of planar wave from unit disk." alt="ScatteringProblem&lt; ELEMENT &gt;" shape="rect" coords="491,17808,972,17832"/>
<area href="../../d1/dc3/classScatteringProblem.html" title="Problem class to compute scattering of planar wave from unit disk." alt="ScatteringProblem&lt; ELEMENT &gt;" shape="rect" coords="491,17864,972,17888"/>
<area href="../../d6/d54/classSheetGlueProblem.html" title="Deformation of elastic pouch." alt="SheetGlueProblem&lt; ELEMENT &gt;" shape="rect" coords="491,17920,972,17944"/>
<area href="../../d6/d54/classSheetGlueProblem.html" title="Deformation of elastic pouch." alt="SheetGlueProblem&lt; ELEMENT &gt;" shape="rect" coords="491,17976,972,18000"/>
<area href="../../da/d3f/classShellProblem.html" alt="ShellProblem&lt; ELEMENT &gt;" shape="rect" coords="491,18032,972,18056"/>
<area href="../../da/d3f/classShellProblem.html" alt="ShellProblem&lt; ELEMENT &gt;" shape="rect" coords="491,18088,972,18112"/>
<area href="../../da/d3f/classShellProblem.html" alt="ShellProblem&lt; ELEMENT &gt;" shape="rect" coords="491,18144,972,18168"/>
<area href="../../da/d3f/classShellProblem.html" alt="ShellProblem&lt; ELEMENT &gt;" shape="rect" coords="491,18200,972,18224"/>
<area href="../../da/d3f/classShellProblem.html" alt="ShellProblem&lt; ELEMENT &gt;" shape="rect" coords="491,18256,972,18280"/>
<area href="../../dc/ddb/classSimpleRefineableFishPoissonProblem.html" alt="SimpleRefineableFishPoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,18312,972,18336"/>
<area href="../../dc/dfb/classSimpleShearProblem.html" title="Boundary-driven elastic deformation of fish-shaped domain." alt="SimpleShearProblem&lt; ELEMENT &gt;" shape="rect" coords="491,18368,972,18392"/>
<area href="../../dc/dfb/classSimpleShearProblem.html" title="Boundary-driven elastic deformation of fish-shaped domain." alt="SimpleShearProblem&lt; ELEMENT &gt;" shape="rect" coords="491,18424,972,18448"/>
<area href="../../d2/d8e/classSolarRadiationProblem.html" title="Problem class." alt="SolarRadiationProblem&lt; ELEMENT &gt;" shape="rect" coords="491,18480,972,18504"/>
<area href="../../d7/d67/classSolidFreeSurfaceRotationProblem.html" title="Entry flow problem in quarter tube domain." alt="SolidFreeSurfaceRotationProblem&lt; ELEMENT &gt;" shape="rect" coords="491,18536,972,18560"/>
<area href="../../d5/d79/classSolidProblem.html" alt="SolidProblem&lt; ELEMENT_TYPE &gt;" shape="rect" coords="491,18592,972,18616"/>
<area href="../../d2/da3/classSphericalSpinUpProblem.html" title="SpinUp problem in a sphere." alt="SphericalSpinUpProblem&lt; ELEMENT &gt;" shape="rect" coords="491,18648,972,18672"/>
<area href="../../d2/da3/classSphericalSpinUpProblem.html" title="SpinUp problem in a sphere." alt="SphericalSpinUpProblem&lt; ELEMENT &gt;" shape="rect" coords="491,18704,972,18728"/>
<area href="../../d3/d40/classSphericalSteadyRotationProblem.html" title="SteadyRotation problem in a sphere." alt="SphericalSteadyRotationProblem&lt; ELEMENT &gt;" shape="rect" coords="491,18760,972,18784"/>
<area href="../../d1/d54/classSpikedChannelSpineFlowProblem.html" title="Channel flow, through a non-uniform channel, using Spines." alt="SpikedChannelSpineFlowProblem&lt; ELEMENT &gt;" shape="rect" coords="491,18816,972,18840"/>
<area href="../../de/de5/classStaticDiskCompressionProblem.html" alt="StaticDiskCompressionProblem&lt; ELEMENT &gt;" shape="rect" coords="491,18872,972,18896"/>
<area href="../../d2/da3/classSteadyCurvedTubeProblem.html" title="Entry flow problem in tapered tube domain." alt="SteadyCurvedTubeProblem&lt; ELEMENT &gt;" shape="rect" coords="491,18928,972,18952"/>
<area href="../../dd/dec/classSteadyHelicalProblem.html" title="Entry flow problem in tapered tube domain." alt="SteadyHelicalProblem&lt; ELEMENT &gt;" shape="rect" coords="491,18984,972,19008"/>
<area href="../../d8/d90/classSteadyTubeProblem.html" title="Entry flow problem in tapered tube domain." alt="SteadyTubeProblem&lt; ELEMENT &gt;" shape="rect" coords="491,19040,972,19064"/>
<area href="../../d9/d00/classStefanBoltzmannProblem.html" title="Problem class." alt="StefanBoltzmannProblem&lt; ELEMENT &gt;" shape="rect" coords="491,19096,972,19120"/>
<area href="../../d9/d00/classStefanBoltzmannProblem.html" title="Problem class." alt="StefanBoltzmannProblem&lt; ELEMENT &gt;" shape="rect" coords="491,19152,972,19176"/>
<area href="../../d7/d86/classSurfactantProblem.html" alt="SurfactantProblem&lt; ELEMENT, INTERFACE_ELEMENT &gt;" shape="rect" coords="491,19208,972,19232"/>
<area href="../../d7/d86/classSurfactantProblem.html" alt="SurfactantProblem&lt; ELEMENT, INTERFACE_ELEMENT &gt;" shape="rect" coords="491,19264,972,19288"/>
<area href="../../d7/d86/classSurfactantProblem.html" alt="SurfactantProblem&lt; ELEMENT, INTERFACE_ELEMENT &gt;" shape="rect" coords="491,19320,972,19344"/>
<area href="../../dd/d0a/classTFaceTestProblem.html" title="TFaceTest problem." alt="TFaceTestProblem&lt; ELEMENT &gt;" shape="rect" coords="491,19376,972,19400"/>
<area href="../../d6/df2/classTestPoissonProblem.html" title="Poisson problem on rotatable, refineable cubic brick mesh." alt="TestPoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,19432,972,19456"/>
<area href="../../d6/df2/classTestPoissonProblem.html" title="Poisson problem on rotatable, refineable cubic brick mesh." alt="TestPoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,19488,972,19512"/>
<area href="../../d8/d9f/classTestRefineablePoissonProblem.html" alt="TestRefineablePoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,19544,972,19568"/>
<area href="../../de/d7c/classTetmeshPoissonProblem.html" title="Demo class solves Poisson problem using Gmsh mesh." alt="TetmeshPoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,19600,972,19624"/>
<area href="../../de/d7c/classTetmeshPoissonProblem.html" title="Demo class solves Poisson problem using Gmsh mesh." alt="TetmeshPoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,19656,972,19680"/>
<area href="../../da/d36/classThermalProblem.html" alt="ThermalProblem&lt; ELEMENT &gt;" shape="rect" coords="491,19712,972,19736"/>
<area href="../../dc/d7b/classThreeDPoissonProblem.html" title="Poisson problem." alt="ThreeDPoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,19768,972,19792"/>
<area href="../../d9/d91/classThreeDimBethertonProblem.html" title="Brethreton problem in square tube domain." alt="ThreeDimBethertonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,19824,972,19848"/>
<area href="../../d1/d16/classTiltedCavityProblem.html" alt="TiltedCavityProblem&lt; ELEMENT &gt;" shape="rect" coords="491,19880,972,19904"/>
<area href="../../d6/d07/classTorusProblem.html" title="Solve the Axisymmetric Navier Stokes equations in a torus." alt="TorusProblem&lt; ELEMENT &gt;" shape="rect" coords="491,19936,972,19960"/>
<area href="../../d9/d17/classTriangleFaceTestProblem.html" title="TriangleFaceTest problem." alt="TriangleFaceTestProblem&lt; ELEMENT &gt;" shape="rect" coords="491,19992,972,20016"/>
<area href="../../d7/dcc/classTurekNonFSIProblem.html" title="Flow around a cylinder with flag." alt="TurekNonFSIProblem&lt; ELEMENT &gt;" shape="rect" coords="491,20048,972,20072"/>
<area href="../../d1/dfc/classTurekProblem.html" title="Problem class." alt="TurekProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;" shape="rect" coords="491,20104,972,20128"/>
<area href="../../d1/dfc/classTurekProblem.html" title="Problem class." alt="TurekProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;" shape="rect" coords="491,20160,972,20184"/>
<area href="../../d1/dfc/classTurekProblem.html" title="Problem class." alt="TurekProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;" shape="rect" coords="491,20216,972,20240"/>
<area href="../../de/dbb/classTwoDDGProblem.html" alt="TwoDDGProblem&lt; ELEMENT &gt;" shape="rect" coords="491,20272,972,20296"/>
<area href="../../de/dbb/classTwoDDGProblem.html" alt="TwoDDGProblem&lt; ELEMENT &gt;" shape="rect" coords="491,20328,972,20352"/>
<area href="../../de/dbb/classTwoDDGProblem.html" alt="TwoDDGProblem&lt; ELEMENT &gt;" shape="rect" coords="491,20384,972,20408"/>
<area href="../../de/dbb/classTwoDDGProblem.html" alt="TwoDDGProblem&lt; ELEMENT &gt;" shape="rect" coords="491,20440,972,20464"/>
<area href="../../de/dbb/classTwoDDGProblem.html" alt="TwoDDGProblem&lt; ELEMENT &gt;" shape="rect" coords="491,20496,972,20520"/>
<area href="../../d3/d70/classTwoLayerInterfaceProblem.html" title="Problem class to simulate viscous drop propagating along 2D channel." alt="TwoLayerInterfaceProblem&lt; ELEMENT &gt;" shape="rect" coords="491,20552,972,20576"/>
<area href="../../db/d16/classTwoMeshFluxAdvectionDiffusionProblem.html" alt="TwoMeshFluxAdvectionDiffusionProblem&lt; ELEMENT &gt;" shape="rect" coords="491,20608,972,20632"/>
<area href="../../db/d16/classTwoMeshFluxAdvectionDiffusionProblem.html" alt="TwoMeshFluxAdvectionDiffusionProblem&lt; ELEMENT &gt;" shape="rect" coords="491,20664,972,20688"/>
<area href="../../d0/d27/classTwoMeshFluxPoissonProblem.html" alt="TwoMeshFluxPoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,20720,972,20744"/>
<area href="../../d7/d1b/classTwoMeshFluxSteadyAxisymAdvectionDiffusionProblem.html" alt="TwoMeshFluxSteadyAxisymAdvectionDiffusionProblem&lt; ELEMENT &gt;" shape="rect" coords="491,20776,972,20800"/>
<area href="../../db/d68/classUniformTranspiration.html" alt="UniformTranspiration&lt; ELEMENT &gt;" shape="rect" coords="491,20832,972,20856"/>
<area href="../../db/d68/classUniformTranspiration.html" alt="UniformTranspiration&lt; ELEMENT &gt;" shape="rect" coords="491,20888,972,20912"/>
<area href="../../d4/dcb/classUnsteadyHeatMeltProblem.html" title="UnsteadyHeat problem." alt="UnsteadyHeatMeltProblem&lt; ELEMENT &gt;" shape="rect" coords="491,20944,972,20968"/>
<area href="../../d8/d28/classUnsteadyHeatProblem.html" title="UnsteadyHeat problem." alt="UnsteadyHeatProblem&lt; ELEMENT &gt;" shape="rect" coords="491,21000,972,21024"/>
<area href="../../d8/d28/classUnsteadyHeatProblem.html" title="UnsteadyHeat problem." alt="UnsteadyHeatProblem&lt; ELEMENT &gt;" shape="rect" coords="491,21056,972,21080"/>
<area href="../../d8/d28/classUnsteadyHeatProblem.html" title="UnsteadyHeat problem." alt="UnsteadyHeatProblem&lt; ELEMENT &gt;" shape="rect" coords="491,21112,972,21136"/>
<area href="../../d8/d28/classUnsteadyHeatProblem.html" title="UnsteadyHeat problem." alt="UnsteadyHeatProblem&lt; ELEMENT &gt;" shape="rect" coords="491,21168,972,21192"/>
<area href="../../d8/d28/classUnsteadyHeatProblem.html" title="UnsteadyHeat problem." alt="UnsteadyHeatProblem&lt; ELEMENT &gt;" shape="rect" coords="491,21224,972,21248"/>
<area href="../../d8/d28/classUnsteadyHeatProblem.html" title="UnsteadyHeat problem." alt="UnsteadyHeatProblem&lt; ELEMENT &gt;" shape="rect" coords="491,21280,972,21304"/>
<area href="../../d8/d28/classUnsteadyHeatProblem.html" title="UnsteadyHeat problem." alt="UnsteadyHeatProblem&lt; ELEMENT &gt;" shape="rect" coords="491,21336,972,21360"/>
<area href="../../d8/d28/classUnsteadyHeatProblem.html" title="UnsteadyHeat problem." alt="UnsteadyHeatProblem&lt; ELEMENT &gt;" shape="rect" coords="491,21392,972,21416"/>
<area href="../../d8/d28/classUnsteadyHeatProblem.html" title="UnsteadyHeat problem." alt="UnsteadyHeatProblem&lt; ELEMENT &gt;" shape="rect" coords="491,21448,972,21472"/>
<area href="../../dd/dee/classUnstructuredFSIProblem.html" title="Unstructured 3D FSI problem." alt="UnstructuredFSIProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;" shape="rect" coords="491,21504,972,21528"/>
<area href="../../dd/dee/classUnstructuredFSIProblem.html" title="Unstructured 3D FSI problem." alt="UnstructuredFSIProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;" shape="rect" coords="491,21560,972,21584"/>
<area href="../../dd/dee/classUnstructuredFSIProblem.html" title="Unstructured 3D FSI problem." alt="UnstructuredFSIProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;" shape="rect" coords="491,21616,972,21640"/>
<area href="../../dd/dee/classUnstructuredFSIProblem.html" title="Unstructured 3D FSI problem." alt="UnstructuredFSIProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;" shape="rect" coords="491,21672,972,21696"/>
<area href="../../dd/dee/classUnstructuredFSIProblem.html" title="Unstructured 3D FSI problem." alt="UnstructuredFSIProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;" shape="rect" coords="491,21728,972,21752"/>
<area href="../../d5/d3c/classUnstructuredFluidProblem.html" title="Unstructured Navier-Stokes ALE Problem." alt="UnstructuredFluidProblem&lt; ELEMENT &gt;" shape="rect" coords="491,21784,972,21808"/>
<area href="../../d5/d3c/classUnstructuredFluidProblem.html" title="Unstructured Navier-Stokes ALE Problem." alt="UnstructuredFluidProblem&lt; ELEMENT &gt;" shape="rect" coords="491,21840,972,21864"/>
<area href="../../d5/d3c/classUnstructuredFluidProblem.html" title="Unstructured Navier-Stokes ALE Problem." alt="UnstructuredFluidProblem&lt; ELEMENT &gt;" shape="rect" coords="491,21896,972,21920"/>
<area href="../../d5/d3c/classUnstructuredFluidProblem.html" title="Unstructured Navier-Stokes ALE Problem." alt="UnstructuredFluidProblem&lt; ELEMENT &gt;" shape="rect" coords="491,21952,972,21976"/>
<area href="../../df/d77/classUnstructuredFvKProblem.html" title="Class definition." alt="UnstructuredFvKProblem&lt; ELEMENT &gt;" shape="rect" coords="491,22008,972,22032"/>
<area href="../../df/d77/classUnstructuredFvKProblem.html" title="Class definition." alt="UnstructuredFvKProblem&lt; ELEMENT &gt;" shape="rect" coords="491,22064,972,22088"/>
<area href="../../df/d77/classUnstructuredFvKProblem.html" title="Class definition." alt="UnstructuredFvKProblem&lt; ELEMENT &gt;" shape="rect" coords="491,22120,972,22144"/>
<area href="../../db/dda/classUnstructuredImmersedEllipseProblem.html" alt="UnstructuredImmersedEllipseProblem&lt; ELEMENT &gt;" shape="rect" coords="491,22176,972,22200"/>
<area href="../../df/dcf/classUnstructuredPoissonProblem.html" title="Class definition." alt="UnstructuredPoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,22232,972,22256"/>
<area href="../../df/dcf/classUnstructuredPoissonProblem.html" title="Class definition." alt="UnstructuredPoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,22288,972,22312"/>
<area href="../../df/dcf/classUnstructuredPoissonProblem.html" title="Class definition." alt="UnstructuredPoissonProblem&lt; ELEMENT &gt;" shape="rect" coords="491,22344,972,22368"/>
<area href="../../dc/dff/classUnstructuredSolidProblem.html" title="Unstructured solid problem." alt="UnstructuredSolidProblem&lt; ELEMENT, MESH &gt;" shape="rect" coords="491,22400,972,22424"/>
<area href="../../dc/dff/classUnstructuredSolidProblem.html" title="Unstructured solid problem." alt="UnstructuredSolidProblem&lt; ELEMENT, MESH &gt;" shape="rect" coords="491,22456,972,22480"/>
<area href="../../dc/dff/classUnstructuredSolidProblem.html" title="Unstructured solid problem." alt="UnstructuredSolidProblem&lt; ELEMENT, MESH &gt;" shape="rect" coords="491,22512,972,22536"/>
<area href="../../dc/dff/classUnstructuredSolidProblem.html" title="Unstructured solid problem." alt="UnstructuredSolidProblem&lt; ELEMENT, MESH &gt;" shape="rect" coords="491,22568,972,22592"/>
<area href="../../dc/dff/classUnstructuredSolidProblem.html" title="Unstructured solid problem." alt="UnstructuredSolidProblem&lt; ELEMENT, MESH &gt;" shape="rect" coords="491,22624,972,22648"/>
<area href="../../dc/dff/classUnstructuredSolidProblem.html" title="Unstructured solid problem." alt="UnstructuredSolidProblem&lt; ELEMENT, MESH &gt;" shape="rect" coords="491,22680,972,22704"/>
<area href="../../dc/dff/classUnstructuredSolidProblem.html" title="Unstructured solid problem." alt="UnstructuredSolidProblem&lt; ELEMENT, MESH &gt;" shape="rect" coords="491,22736,972,22760"/>
<area href="../../d3/d84/classUnstructuredTorusProblem.html" title="Solve the Axisymmetric Navier Stokes equations in a torus." alt="UnstructuredTorusProblem&lt; ELEMENT &gt;" shape="rect" coords="491,22792,972,22816"/>
<area href="../../d3/d84/classUnstructuredTorusProblem.html" title="Solve the Axisymmetric Navier Stokes equations in a torus." alt="UnstructuredTorusProblem&lt; ELEMENT &gt;" shape="rect" coords="491,22848,972,22872"/>
<area href="../../dd/d70/classVibratingShellProblem.html" title="Problem class to simulate the settling of a viscous drop." alt="VibratingShellProblem&lt; ELEMENT &gt;" shape="rect" coords="491,22904,972,22928"/>
<area href="../../d3/d26/classVorticityRecoveryProblem.html" title="Problem class for Anne&#39;s MSc problem." alt="VorticityRecoveryProblem&lt; ELEMENT &gt;" shape="rect" coords="491,22960,972,22984"/>
<area href="../../db/d84/classYoungLaplaceProblem.html" alt="YoungLaplaceProblem&lt; ELEMENT &gt;" shape="rect" coords="491,23016,972,23040"/>
<area href="../../db/d84/classYoungLaplaceProblem.html" alt="YoungLaplaceProblem&lt; ELEMENT &gt;" shape="rect" coords="491,23072,972,23096"/>
<area href="../../db/d78/classoomph_1_1BiharmonicFluidProblem.html" alt="oomph::BiharmonicFluidProblem&lt; DIM &gt;" shape="rect" coords="491,23128,972,23152"/>
<area href="../../d9/dc5/classoomph_1_1BiharmonicProblem.html" alt="oomph::BiharmonicProblem&lt; DIM &gt;" shape="rect" coords="491,23184,972,23208"/>
<area href="../../da/dcc/classoomph_1_1FpPressureAdvectionDiffusionProblem.html" alt="oomph::FpPressureAdvectionDiffusionProblem&lt; ELEMENT &gt;" shape="rect" coords="491,23240,972,23264"/>
<area href="../../df/d95/classoomph_1_1HelmholtzMGProblem.html" title="HelmholtzMGProblem class; subclass of Problem." alt="oomph::HelmholtzMGProblem" shape="rect" coords="491,23296,972,23320"/>
<area href="../../de/db1/classoomph_1_1LinearElasticitySmoothMesh.html" alt="oomph::LinearElasticitySmoothMesh&lt; LINEAR_ELASTICITY_ELEMENT &gt;" shape="rect" coords="491,23352,972,23376"/>
<area href="../../d9/d55/classoomph_1_1MGProblem.html" title="MGProblem class; subclass of Problem." alt="oomph::MGProblem" shape="rect" coords="491,23408,972,23432"/>
<area href="../../d4/d94/classoomph_1_1MyProblem.html" alt="oomph::MyProblem" shape="rect" coords="491,23464,972,23488"/>
<area href="../../d6/d69/classoomph_1_1NonLinearElasticitySmoothMesh.html" alt="oomph::NonLinearElasticitySmoothMesh&lt; ELEMENT &gt;" shape="rect" coords="491,23520,972,23544"/>
<area href="../../d5/df9/classoomph_1_1PoissonSmoothMesh.html" alt="oomph::PoissonSmoothMesh&lt; POISSON_ELEMENT &gt;" shape="rect" coords="491,23576,972,23600"/>
<area href="../../d5/dc5/classoomph_1_1ProjectionProblem.html" alt="oomph::ProjectionProblem&lt; PROJECTABLE_ELEMENT &gt;" shape="rect" coords="491,23632,972,23656"/>
<area href="../../de/da7/classoomph_1_1SegregatableFSIProblem.html" alt="oomph::SegregatableFSIProblem" shape="rect" coords="491,23688,972,23712"/>
<area href="../../d2/d5a/classoomph_1_1SolidICProblem.html" alt="oomph::SolidICProblem" shape="rect" coords="491,23744,972,23768"/>
<area href="../../d4/d6f/classoomph_1_1StreamfunctionProblem.html" title="Polar Streamfunction problem class." alt="oomph::StreamfunctionProblem" shape="rect" coords="491,23800,972,23824"/>
<area href="../../d3/d73/classoomph_1_1WomersleyProblem.html" title="Womersley problem." alt="oomph::WomersleyProblem&lt; ELEMENT, DIM &gt;" shape="rect" coords="491,23856,972,23880"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a638b525d7cae45e56160e3c282c8ad09"><td class="memItemLeft" align="right" valign="top">typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a638b525d7cae45e56160e3c282c8ad09">SpatialErrorEstimatorFctPt</a>) (<a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *&amp;<a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;elemental_error)</td></tr>
<tr class="memdesc:a638b525d7cae45e56160e3c282c8ad09"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function pointer for spatial error estimator.  <a href="../../dc/de5/classoomph_1_1Problem.html#a638b525d7cae45e56160e3c282c8ad09">More...</a><br /></td></tr>
<tr class="separator:a638b525d7cae45e56160e3c282c8ad09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a220abfde16b8b1b544b4127e0e4cc9e4"><td class="memItemLeft" align="right" valign="top">typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a220abfde16b8b1b544b4127e0e4cc9e4">SpatialErrorEstimatorWithDocFctPt</a>) (<a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *&amp;<a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;elemental_error, <a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> &amp;doc_info)</td></tr>
<tr class="memdesc:a220abfde16b8b1b544b4127e0e4cc9e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function pointer for spatial error estimator with doc.  <a href="../../dc/de5/classoomph_1_1Problem.html#a220abfde16b8b1b544b4127e0e4cc9e4">More...</a><br /></td></tr>
<tr class="separator:a220abfde16b8b1b544b4127e0e4cc9e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a36c95c8211cc02558118288888aab5e1"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a36c95c8211cc02558118288888aab5e1">debug_hook_fct</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>)</td></tr>
<tr class="separator:a36c95c8211cc02558118288888aab5e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecef49e98bbcede9b8c3137592c2cc5a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aecef49e98bbcede9b8c3137592c2cc5a">set_analytic_dparameter</a> (<a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;parameter_pt)</td></tr>
<tr class="separator:aecef49e98bbcede9b8c3137592c2cc5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff7bcab5505ba482a8c9ba7bace68bc0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aff7bcab5505ba482a8c9ba7bace68bc0">unset_analytic_dparameter</a> (<a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;parameter_pt)</td></tr>
<tr class="separator:aff7bcab5505ba482a8c9ba7bace68bc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41a7b9cf8e6fe1156fc92baa43c3fe4b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a41a7b9cf8e6fe1156fc92baa43c3fe4b">is_dparameter_calculated_analytically</a> (<a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;parameter_pt)</td></tr>
<tr class="separator:a41a7b9cf8e6fe1156fc92baa43c3fe4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45f64c33501e0f9c65927eefed253eef"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a45f64c33501e0f9c65927eefed253eef">set_analytic_hessian_products</a> ()</td></tr>
<tr class="separator:a45f64c33501e0f9c65927eefed253eef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accd672b3da8c5bf28ad6bd856e28d1cf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accd672b3da8c5bf28ad6bd856e28d1cf">unset_analytic_hessian_products</a> ()</td></tr>
<tr class="separator:accd672b3da8c5bf28ad6bd856e28d1cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6235ced9e7e85324f785f2681ab3872"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af6235ced9e7e85324f785f2681ab3872">are_hessian_products_calculated_analytically</a> ()</td></tr>
<tr class="separator:af6235ced9e7e85324f785f2681ab3872"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6aab91bb814a85409648dc87807907e6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6aab91bb814a85409648dc87807907e6">set_pinned_values_to_zero</a> ()</td></tr>
<tr class="separator:a6aab91bb814a85409648dc87807907e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5e9f1623cad361048856a4c0463ea23"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af5e9f1623cad361048856a4c0463ea23">distributed</a> () const</td></tr>
<tr class="separator:af5e9f1623cad361048856a4c0463ea23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6130d5c9a762cdd1569919a601620796"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">actions_before_adapt</a> ()</td></tr>
<tr class="separator:a6130d5c9a762cdd1569919a601620796"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada40ec6730506c01109622c8383fe36e"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">actions_after_adapt</a> ()</td></tr>
<tr class="memdesc:ada40ec6730506c01109622c8383fe36e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Actions that are to be performed after a mesh adaptation.  <a href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">More...</a><br /></td></tr>
<tr class="separator:ada40ec6730506c01109622c8383fe36e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a600bb1740edd0aa07c6d001033bf676a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html">OomphCommunicator</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">communicator_pt</a> ()</td></tr>
<tr class="memdesc:a600bb1740edd0aa07c6d001033bf676a"><td class="mdescLeft">&#160;</td><td class="mdescRight">access function to the oomph-lib communicator  <a href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">More...</a><br /></td></tr>
<tr class="separator:a600bb1740edd0aa07c6d001033bf676a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1875e771e99a2e8f1d344d8b880d0de"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html">OomphCommunicator</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af1875e771e99a2e8f1d344d8b880d0de">communicator_pt</a> () const</td></tr>
<tr class="memdesc:af1875e771e99a2e8f1d344d8b880d0de"><td class="mdescLeft">&#160;</td><td class="mdescRight">access function to the oomph-lib communicator, const version  <a href="../../dc/de5/classoomph_1_1Problem.html#af1875e771e99a2e8f1d344d8b880d0de">More...</a><br /></td></tr>
<tr class="separator:af1875e771e99a2e8f1d344d8b880d0de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9d44f0ef936fb62f0ce41dd200494ac"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad9d44f0ef936fb62f0ce41dd200494ac">Problem</a> ()</td></tr>
<tr class="separator:ad9d44f0ef936fb62f0ce41dd200494ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32f06ae01ba0bf2e827ccd9045c40183"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a32f06ae01ba0bf2e827ccd9045c40183">Problem</a> (const <a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> &amp;dummy)=delete</td></tr>
<tr class="memdesc:a32f06ae01ba0bf2e827ccd9045c40183"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken copy constructor.  <a href="../../dc/de5/classoomph_1_1Problem.html#a32f06ae01ba0bf2e827ccd9045c40183">More...</a><br /></td></tr>
<tr class="separator:a32f06ae01ba0bf2e827ccd9045c40183"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae015f3c07e2218748b347f42abe45da1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae015f3c07e2218748b347f42abe45da1">operator=</a> (const <a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> &amp;)=delete</td></tr>
<tr class="memdesc:ae015f3c07e2218748b347f42abe45da1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken assignment operator.  <a href="../../dc/de5/classoomph_1_1Problem.html#ae015f3c07e2218748b347f42abe45da1">More...</a><br /></td></tr>
<tr class="separator:ae015f3c07e2218748b347f42abe45da1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a839a525ed01c34d57fff42583003d3e7"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a839a525ed01c34d57fff42583003d3e7">~Problem</a> ()</td></tr>
<tr class="memdesc:a839a525ed01c34d57fff42583003d3e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Virtual destructor to clean up memory.  <a href="../../dc/de5/classoomph_1_1Problem.html#a839a525ed01c34d57fff42583003d3e7">More...</a><br /></td></tr>
<tr class="separator:a839a525ed01c34d57fff42583003d3e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad122d70a22dc5302cfd5853d3cf3057"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *&amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a> ()</td></tr>
<tr class="memdesc:aad122d70a22dc5302cfd5853d3cf3057"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return a pointer to the global mesh.  <a href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">More...</a><br /></td></tr>
<tr class="separator:aad122d70a22dc5302cfd5853d3cf3057"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a2e53542288a4140ea5b076ffa648db"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const  &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a3a2e53542288a4140ea5b076ffa648db">mesh_pt</a> () const</td></tr>
<tr class="memdesc:a3a2e53542288a4140ea5b076ffa648db"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return a pointer to the global mesh (const version)  <a href="../../dc/de5/classoomph_1_1Problem.html#a3a2e53542288a4140ea5b076ffa648db">More...</a><br /></td></tr>
<tr class="separator:a3a2e53542288a4140ea5b076ffa648db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9d882b768345fd916079ec184764f72"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *&amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac9d882b768345fd916079ec184764f72">mesh_pt</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;imesh)</td></tr>
<tr class="separator:ac9d882b768345fd916079ec184764f72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35b503d711781552b6b56deb612816c4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const  &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a35b503d711781552b6b56deb612816c4">mesh_pt</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;imesh) const</td></tr>
<tr class="memdesc:a35b503d711781552b6b56deb612816c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return a pointer to the i-th submesh (const version)  <a href="../../dc/de5/classoomph_1_1Problem.html#a35b503d711781552b6b56deb612816c4">More...</a><br /></td></tr>
<tr class="separator:a35b503d711781552b6b56deb612816c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accc4e5a46953800933f07ae6bd67860e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a> () const</td></tr>
<tr class="memdesc:accc4e5a46953800933f07ae6bd67860e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return number of submeshes.  <a href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">More...</a><br /></td></tr>
<tr class="separator:accc4e5a46953800933f07ae6bd67860e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cd05109bc2c003c5c0686e6aa55d847"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a0cd05109bc2c003c5c0686e6aa55d847">add_sub_mesh</a> (<a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;<a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>)</td></tr>
<tr class="separator:a0cd05109bc2c003c5c0686e6aa55d847"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42b2b42a03f9de7d7a4d24edcfa20179"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a42b2b42a03f9de7d7a4d24edcfa20179">flush_sub_meshes</a> ()</td></tr>
<tr class="separator:a42b2b42a03f9de7d7a4d24edcfa20179"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa29176d84610e0273fc823cace91765a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa29176d84610e0273fc823cace91765a">build_global_mesh</a> ()</td></tr>
<tr class="separator:aa29176d84610e0273fc823cace91765a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a266d4d1b2bd4a5cbc028ff5aba79508f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a266d4d1b2bd4a5cbc028ff5aba79508f">rebuild_global_mesh</a> ()</td></tr>
<tr class="separator:a266d4d1b2bd4a5cbc028ff5aba79508f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a689687cacc40dd351430545a7041f44c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html">LinearSolver</a> *&amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a689687cacc40dd351430545a7041f44c">linear_solver_pt</a> ()</td></tr>
<tr class="memdesc:a689687cacc40dd351430545a7041f44c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return a pointer to the linear solver object.  <a href="../../dc/de5/classoomph_1_1Problem.html#a689687cacc40dd351430545a7041f44c">More...</a><br /></td></tr>
<tr class="separator:a689687cacc40dd351430545a7041f44c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50b5365e0de1212b9c07f41ae9deab5a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html">LinearSolver</a> *const  &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a50b5365e0de1212b9c07f41ae9deab5a">linear_solver_pt</a> () const</td></tr>
<tr class="memdesc:a50b5365e0de1212b9c07f41ae9deab5a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return a pointer to the linear solver object (const version)  <a href="../../dc/de5/classoomph_1_1Problem.html#a50b5365e0de1212b9c07f41ae9deab5a">More...</a><br /></td></tr>
<tr class="separator:a50b5365e0de1212b9c07f41ae9deab5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93304d0c6be1022b944f21c0f4c07eab"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html">LinearSolver</a> *&amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a93304d0c6be1022b944f21c0f4c07eab">mass_matrix_solver_for_explicit_timestepper_pt</a> ()</td></tr>
<tr class="separator:a93304d0c6be1022b944f21c0f4c07eab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10ffcfbf305940a05452d950df7a11c3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html">LinearSolver</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a10ffcfbf305940a05452d950df7a11c3">mass_matrix_solver_for_explicit_timestepper_pt</a> () const</td></tr>
<tr class="separator:a10ffcfbf305940a05452d950df7a11c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00efa0059958df35858503e77111c362"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/dba/classoomph_1_1EigenSolver.html">EigenSolver</a> *&amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a00efa0059958df35858503e77111c362">eigen_solver_pt</a> ()</td></tr>
<tr class="memdesc:a00efa0059958df35858503e77111c362"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return a pointer to the eigen solver object.  <a href="../../dc/de5/classoomph_1_1Problem.html#a00efa0059958df35858503e77111c362">More...</a><br /></td></tr>
<tr class="separator:a00efa0059958df35858503e77111c362"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14d44adcbf581d43154be19d127b6183"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/dba/classoomph_1_1EigenSolver.html">EigenSolver</a> *const  &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a14d44adcbf581d43154be19d127b6183">eigen_solver_pt</a> () const</td></tr>
<tr class="memdesc:a14d44adcbf581d43154be19d127b6183"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return a pointer to the eigen solver object (const version)  <a href="../../dc/de5/classoomph_1_1Problem.html#a14d44adcbf581d43154be19d127b6183">More...</a><br /></td></tr>
<tr class="separator:a14d44adcbf581d43154be19d127b6183"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46894b13c582f322082dc471a2485980"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/da1/classoomph_1_1Time.html">Time</a> *&amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a46894b13c582f322082dc471a2485980">time_pt</a> ()</td></tr>
<tr class="memdesc:a46894b13c582f322082dc471a2485980"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return a pointer to the global time object.  <a href="../../dc/de5/classoomph_1_1Problem.html#a46894b13c582f322082dc471a2485980">More...</a><br /></td></tr>
<tr class="separator:a46894b13c582f322082dc471a2485980"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa86b09eac493cfa9fcbe57734985ba19"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/da1/classoomph_1_1Time.html">Time</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa86b09eac493cfa9fcbe57734985ba19">time_pt</a> () const</td></tr>
<tr class="memdesc:aa86b09eac493cfa9fcbe57734985ba19"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return a pointer to the global time object (const version).  <a href="../../dc/de5/classoomph_1_1Problem.html#aa86b09eac493cfa9fcbe57734985ba19">More...</a><br /></td></tr>
<tr class="separator:aa86b09eac493cfa9fcbe57734985ba19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affda31840308a51d36324e6debe1bee7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#affda31840308a51d36324e6debe1bee7">time</a> ()</td></tr>
<tr class="memdesc:affda31840308a51d36324e6debe1bee7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the current value of continuous time.  <a href="../../dc/de5/classoomph_1_1Problem.html#affda31840308a51d36324e6debe1bee7">More...</a><br /></td></tr>
<tr class="separator:affda31840308a51d36324e6debe1bee7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a951ba4d49d9a6788a7bd4e805caf3342"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a951ba4d49d9a6788a7bd4e805caf3342">time</a> () const</td></tr>
<tr class="memdesc:a951ba4d49d9a6788a7bd4e805caf3342"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the current value of continuous time (const version)  <a href="../../dc/de5/classoomph_1_1Problem.html#a951ba4d49d9a6788a7bd4e805caf3342">More...</a><br /></td></tr>
<tr class="separator:a951ba4d49d9a6788a7bd4e805caf3342"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad77413dc70a25d271f582ad3c3d7bf65"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html">TimeStepper</a> *&amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a> ()</td></tr>
<tr class="separator:ad77413dc70a25d271f582ad3c3d7bf65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f952a57b5238978250849c04e2fcbdb"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html">TimeStepper</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a3f952a57b5238978250849c04e2fcbdb">time_stepper_pt</a> () const</td></tr>
<tr class="separator:a3f952a57b5238978250849c04e2fcbdb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76cda2a0a02815a3de446723a2334293"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html">TimeStepper</a> *&amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a76cda2a0a02815a3de446723a2334293">time_stepper_pt</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>)</td></tr>
<tr class="memdesc:a76cda2a0a02815a3de446723a2334293"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return a pointer to the i-th timestepper.  <a href="../../dc/de5/classoomph_1_1Problem.html#a76cda2a0a02815a3de446723a2334293">More...</a><br /></td></tr>
<tr class="separator:a76cda2a0a02815a3de446723a2334293"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac332634783a803c1c21bf5c520af280f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/d0b/classoomph_1_1ExplicitTimeStepper.html">ExplicitTimeStepper</a> *&amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac332634783a803c1c21bf5c520af280f">explicit_time_stepper_pt</a> ()</td></tr>
<tr class="memdesc:ac332634783a803c1c21bf5c520af280f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return a pointer to the explicit timestepper.  <a href="../../dc/de5/classoomph_1_1Problem.html#ac332634783a803c1c21bf5c520af280f">More...</a><br /></td></tr>
<tr class="separator:ac332634783a803c1c21bf5c520af280f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50d54d4b374ea6a8d76798f34b865944"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a50d54d4b374ea6a8d76798f34b865944">set_timestepper_for_all_data</a> (<a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html">TimeStepper</a> *const &amp;<a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;preserve_existing_data=false)</td></tr>
<tr class="separator:a50d54d4b374ea6a8d76798f34b865944"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d3108a38cfbed4087f5b8eb601f38a2"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a3d3108a38cfbed4087f5b8eb601f38a2">shift_time_values</a> ()</td></tr>
<tr class="memdesc:a3d3108a38cfbed4087f5b8eb601f38a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Shift all values along to prepare for next timestep.  <a href="../../dc/de5/classoomph_1_1Problem.html#a3d3108a38cfbed4087f5b8eb601f38a2">More...</a><br /></td></tr>
<tr class="separator:a3d3108a38cfbed4087f5b8eb601f38a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a381c30a8daede5c95bdda7e2efa24f19"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html">AssemblyHandler</a> *&amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a> ()</td></tr>
<tr class="memdesc:a381c30a8daede5c95bdda7e2efa24f19"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return a pointer to the assembly handler object.  <a href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">More...</a><br /></td></tr>
<tr class="separator:a381c30a8daede5c95bdda7e2efa24f19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48905dc6c9a8811969407939b3e4ccb6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html">AssemblyHandler</a> *const  &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a48905dc6c9a8811969407939b3e4ccb6">assembly_handler_pt</a> () const</td></tr>
<tr class="memdesc:a48905dc6c9a8811969407939b3e4ccb6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return a pointer to the assembly handler object (const version)  <a href="../../dc/de5/classoomph_1_1Problem.html#a48905dc6c9a8811969407939b3e4ccb6">More...</a><br /></td></tr>
<tr class="separator:a48905dc6c9a8811969407939b3e4ccb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adffc8921bf61edac68ed017bcdc1d792"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#adffc8921bf61edac68ed017bcdc1d792">minimum_dt</a> ()</td></tr>
<tr class="memdesc:adffc8921bf61edac68ed017bcdc1d792"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access function to min timestep in adaptive timestepping.  <a href="../../dc/de5/classoomph_1_1Problem.html#adffc8921bf61edac68ed017bcdc1d792">More...</a><br /></td></tr>
<tr class="separator:adffc8921bf61edac68ed017bcdc1d792"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5355154d4991ec634e74d4817176f5f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac5355154d4991ec634e74d4817176f5f">maximum_dt</a> ()</td></tr>
<tr class="memdesc:ac5355154d4991ec634e74d4817176f5f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access function to max timestep in adaptive timestepping.  <a href="../../dc/de5/classoomph_1_1Problem.html#ac5355154d4991ec634e74d4817176f5f">More...</a><br /></td></tr>
<tr class="separator:ac5355154d4991ec634e74d4817176f5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa30b2e89f61a327ffb1be4ff30bb868f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa30b2e89f61a327ffb1be4ff30bb868f">max_newton_iterations</a> ()</td></tr>
<tr class="memdesc:aa30b2e89f61a327ffb1be4ff30bb868f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access function to max Newton iterations before giving up.  <a href="../../dc/de5/classoomph_1_1Problem.html#aa30b2e89f61a327ffb1be4ff30bb868f">More...</a><br /></td></tr>
<tr class="separator:aa30b2e89f61a327ffb1be4ff30bb868f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92acc3c193a38f321fc318fafd142f7a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a92acc3c193a38f321fc318fafd142f7a">problem_is_nonlinear</a> (const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;prob_lin)</td></tr>
<tr class="memdesc:a92acc3c193a38f321fc318fafd142f7a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access function to Problem_is_nonlinear.  <a href="../../dc/de5/classoomph_1_1Problem.html#a92acc3c193a38f321fc318fafd142f7a">More...</a><br /></td></tr>
<tr class="separator:a92acc3c193a38f321fc318fafd142f7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ad78241135f621df36bc1b9634845ac"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a2ad78241135f621df36bc1b9634845ac">max_residuals</a> ()</td></tr>
<tr class="separator:a2ad78241135f621df36bc1b9634845ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a42b89a67e0770c68493b9569bffe16"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7a42b89a67e0770c68493b9569bffe16">time_adaptive_newton_crash_on_solve_fail</a> ()</td></tr>
<tr class="memdesc:a7a42b89a67e0770c68493b9569bffe16"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access function for Time_adaptive_newton_crash_on_solve_fail.  <a href="../../dc/de5/classoomph_1_1Problem.html#a7a42b89a67e0770c68493b9569bffe16">More...</a><br /></td></tr>
<tr class="separator:a7a42b89a67e0770c68493b9569bffe16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa43a98d2303f2bce10d0887dc0b2eac5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa43a98d2303f2bce10d0887dc0b2eac5">newton_solver_tolerance</a> ()</td></tr>
<tr class="separator:aa43a98d2303f2bce10d0887dc0b2eac5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05df1c91c6ccffa24e42fda85af156a1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a05df1c91c6ccffa24e42fda85af156a1">add_time_stepper_pt</a> (<a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html">TimeStepper</a> *const &amp;<a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>)</td></tr>
<tr class="separator:a05df1c91c6ccffa24e42fda85af156a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e79846a57705934352b55b6d675d77d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7e79846a57705934352b55b6d675d77d">set_explicit_time_stepper_pt</a> (<a class="el" href="../../df/d0b/classoomph_1_1ExplicitTimeStepper.html">ExplicitTimeStepper</a> *const &amp;<a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac332634783a803c1c21bf5c520af280f">explicit_time_stepper_pt</a>)</td></tr>
<tr class="separator:a7e79846a57705934352b55b6d675d77d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f7e9e91eab83d600c94afdad532a6fb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5f7e9e91eab83d600c94afdad532a6fb">initialise_dt</a> (const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;dt)</td></tr>
<tr class="separator:a5f7e9e91eab83d600c94afdad532a6fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0e7f2cd5d6d7fe4fc16c34acd213f8a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab0e7f2cd5d6d7fe4fc16c34acd213f8a">initialise_dt</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;dt)</td></tr>
<tr class="separator:ab0e7f2cd5d6d7fe4fc16c34acd213f8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae508b2056d532cb8b6eb0dd5c16b9325"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d8/dc5/classoomph_1_1Data.html">Data</a> *&amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae508b2056d532cb8b6eb0dd5c16b9325">global_data_pt</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>)</td></tr>
<tr class="memdesc:ae508b2056d532cb8b6eb0dd5c16b9325"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return a pointer to the the i-th global data object.  <a href="../../dc/de5/classoomph_1_1Problem.html#ae508b2056d532cb8b6eb0dd5c16b9325">More...</a><br /></td></tr>
<tr class="separator:ae508b2056d532cb8b6eb0dd5c16b9325"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f0c24728351d390d4f0a86d07bd8678"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6f0c24728351d390d4f0a86d07bd8678">add_global_data</a> (<a class="el" href="../../d8/dc5/classoomph_1_1Data.html">Data</a> *const &amp;<a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae508b2056d532cb8b6eb0dd5c16b9325">global_data_pt</a>)</td></tr>
<tr class="separator:a6f0c24728351d390d4f0a86d07bd8678"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8df5552c706bd949b29f5601f8c941e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa8df5552c706bd949b29f5601f8c941e">flush_global_data</a> ()</td></tr>
<tr class="separator:aa8df5552c706bd949b29f5601f8c941e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17a5a4886c4213422179fe8346336a4e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> *const  &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a17a5a4886c4213422179fe8346336a4e">dof_distribution_pt</a> () const</td></tr>
<tr class="memdesc:a17a5a4886c4213422179fe8346336a4e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the pointer to the dof distribution (read-only)  <a href="../../dc/de5/classoomph_1_1Problem.html#a17a5a4886c4213422179fe8346336a4e">More...</a><br /></td></tr>
<tr class="separator:a17a5a4886c4213422179fe8346336a4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a218d4dfff74bc14f3f5dc8416236e01d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a> () const</td></tr>
<tr class="memdesc:a218d4dfff74bc14f3f5dc8416236e01d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the number of dofs.  <a href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">More...</a><br /></td></tr>
<tr class="separator:a218d4dfff74bc14f3f5dc8416236e01d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace3cdf55009c3bff21d2b7d3706d522a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ace3cdf55009c3bff21d2b7d3706d522a">ntime_stepper</a> () const</td></tr>
<tr class="memdesc:ace3cdf55009c3bff21d2b7d3706d522a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the number of time steppers.  <a href="../../dc/de5/classoomph_1_1Problem.html#ace3cdf55009c3bff21d2b7d3706d522a">More...</a><br /></td></tr>
<tr class="separator:ace3cdf55009c3bff21d2b7d3706d522a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60a9b6861928cf9115110b5bfc7d11a7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a60a9b6861928cf9115110b5bfc7d11a7">nglobal_data</a> () const</td></tr>
<tr class="memdesc:a60a9b6861928cf9115110b5bfc7d11a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the number of global data values.  <a href="../../dc/de5/classoomph_1_1Problem.html#a60a9b6861928cf9115110b5bfc7d11a7">More...</a><br /></td></tr>
<tr class="separator:a60a9b6861928cf9115110b5bfc7d11a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b7f290d47c78868860cb3561f1c6443"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7b7f290d47c78868860cb3561f1c6443">self_test</a> ()</td></tr>
<tr class="memdesc:a7b7f290d47c78868860cb3561f1c6443"><td class="mdescLeft">&#160;</td><td class="mdescRight">Self-test: Check meshes and global data. Return 0 for OK.  <a href="../../dc/de5/classoomph_1_1Problem.html#a7b7f290d47c78868860cb3561f1c6443">More...</a><br /></td></tr>
<tr class="separator:a7b7f290d47c78868860cb3561f1c6443"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31ba79405993ec52e3017d6ff3a42c8c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a31ba79405993ec52e3017d6ff3a42c8c">enable_store_local_dof_pt_in_elements</a> ()</td></tr>
<tr class="separator:a31ba79405993ec52e3017d6ff3a42c8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac23468bc4101d3038e6b537b6fc87aa6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac23468bc4101d3038e6b537b6fc87aa6">disable_store_local_dof_pt_in_elements</a> ()</td></tr>
<tr class="separator:ac23468bc4101d3038e6b537b6fc87aa6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5340769f2b1051a77d443eb05c8f68c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers</a> (const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;assign_local_eqn_numbers=true)</td></tr>
<tr class="separator:ad5340769f2b1051a77d443eb05c8f68c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74a72dc989531d264ec1959f3015b98c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a74a72dc989531d264ec1959f3015b98c">describe_dofs</a> (std::ostream &amp;<a class="el" href="../../d9/d83/tensor__contract__sycl__bench_8cc.html#acc4949c3e64b4395f74072403ddf6184">out</a>= *(oomph_info.stream_pt())) const</td></tr>
<tr class="separator:a74a72dc989531d264ec1959f3015b98c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4fbd755b3ce6b86fa0f1b1f29bd08f0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af4fbd755b3ce6b86fa0f1b1f29bd08f0">enable_discontinuous_formulation</a> ()</td></tr>
<tr class="separator:af4fbd755b3ce6b86fa0f1b1f29bd08f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa64d728ceff0dd772bbbc8f2adcddfb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#afa64d728ceff0dd772bbbc8f2adcddfb">disable_discontinuous_formulation</a> ()</td></tr>
<tr class="separator:afa64d728ceff0dd772bbbc8f2adcddfb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11c1432869386bb49f16da15545bfee7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a11c1432869386bb49f16da15545bfee7">get_dofs</a> (<a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;dofs) const</td></tr>
<tr class="separator:a11c1432869386bb49f16da15545bfee7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb5998dfed961de76c33ae3b6fa516b4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#adb5998dfed961de76c33ae3b6fa516b4">get_dofs</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;t, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;dofs) const</td></tr>
<tr class="memdesc:adb5998dfed961de76c33ae3b6fa516b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return vector of the t'th history value of all dofs.  <a href="../../dc/de5/classoomph_1_1Problem.html#adb5998dfed961de76c33ae3b6fa516b4">More...</a><br /></td></tr>
<tr class="separator:adb5998dfed961de76c33ae3b6fa516b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07c3df43aef20537f8d192c2fc203836"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a07c3df43aef20537f8d192c2fc203836">set_dofs</a> (const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;dofs)</td></tr>
<tr class="memdesc:a07c3df43aef20537f8d192c2fc203836"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the values of the dofs.  <a href="../../dc/de5/classoomph_1_1Problem.html#a07c3df43aef20537f8d192c2fc203836">More...</a><br /></td></tr>
<tr class="separator:a07c3df43aef20537f8d192c2fc203836"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3ec67f2c633cc414905ade9fa148939"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac3ec67f2c633cc414905ade9fa148939">set_dofs</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;t, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;dofs)</td></tr>
<tr class="memdesc:ac3ec67f2c633cc414905ade9fa148939"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the history values of the dofs.  <a href="../../dc/de5/classoomph_1_1Problem.html#ac3ec67f2c633cc414905ade9fa148939">More...</a><br /></td></tr>
<tr class="separator:ac3ec67f2c633cc414905ade9fa148939"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2119786e1204edeb90ed58f4faf0eae4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a2119786e1204edeb90ed58f4faf0eae4">set_dofs</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;t, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> * &gt; &amp;<a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a02f480ec17e0b9b03c892be5ed0c64d1">dof_pt</a>)</td></tr>
<tr class="separator:a2119786e1204edeb90ed58f4faf0eae4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb1221f3e6605bf134cc6be3ff297016"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#abb1221f3e6605bf134cc6be3ff297016">add_to_dofs</a> (const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;<a class="el" href="../../db/d92/EigenSolver__EigenSolver__MatrixType_8cpp.html#a33aa7f8e323a00a5f56a32cb4ab03561">lambda</a>, const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;increment_dofs)</td></tr>
<tr class="memdesc:abb1221f3e6605bf134cc6be3ff297016"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add lambda x incremenet_dofs[l] to the l-th dof.  <a href="../../dc/de5/classoomph_1_1Problem.html#abb1221f3e6605bf134cc6be3ff297016">More...</a><br /></td></tr>
<tr class="separator:abb1221f3e6605bf134cc6be3ff297016"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a491354401f780ccc114ceb76f5cacef0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a491354401f780ccc114ceb76f5cacef0">global_dof_pt</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>)</td></tr>
<tr class="separator:a491354401f780ccc114ceb76f5cacef0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74d71439b100fb5b66b94d1d69130f7c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a74d71439b100fb5b66b94d1d69130f7c">dof</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>)</td></tr>
<tr class="memdesc:a74d71439b100fb5b66b94d1d69130f7c"><td class="mdescLeft">&#160;</td><td class="mdescRight">i-th dof in the problem  <a href="../../dc/de5/classoomph_1_1Problem.html#a74d71439b100fb5b66b94d1d69130f7c">More...</a><br /></td></tr>
<tr class="separator:a74d71439b100fb5b66b94d1d69130f7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a200cbd03828632d448c3525e9a921f27"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a200cbd03828632d448c3525e9a921f27">dof</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>) const</td></tr>
<tr class="memdesc:a200cbd03828632d448c3525e9a921f27"><td class="mdescLeft">&#160;</td><td class="mdescRight">i-th dof in the problem (const version)  <a href="../../dc/de5/classoomph_1_1Problem.html#a200cbd03828632d448c3525e9a921f27">More...</a><br /></td></tr>
<tr class="separator:a200cbd03828632d448c3525e9a921f27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02f480ec17e0b9b03c892be5ed0c64d1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a> *&amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a02f480ec17e0b9b03c892be5ed0c64d1">dof_pt</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>)</td></tr>
<tr class="memdesc:a02f480ec17e0b9b03c892be5ed0c64d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to i-th dof in the problem.  <a href="../../dc/de5/classoomph_1_1Problem.html#a02f480ec17e0b9b03c892be5ed0c64d1">More...</a><br /></td></tr>
<tr class="separator:a02f480ec17e0b9b03c892be5ed0c64d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf51914cb75a640f82b269493311c187"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acf51914cb75a640f82b269493311c187">dof_pt</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>) const</td></tr>
<tr class="memdesc:acf51914cb75a640f82b269493311c187"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to i-th dof in the problem (const version)  <a href="../../dc/de5/classoomph_1_1Problem.html#acf51914cb75a640f82b269493311c187">More...</a><br /></td></tr>
<tr class="separator:acf51914cb75a640f82b269493311c187"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ee48c16fce89952a019a844ac386655"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5ee48c16fce89952a019a844ac386655">get_inverse_mass_matrix_times_residuals</a> (<a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;Mres)</td></tr>
<tr class="separator:a5ee48c16fce89952a019a844ac386655"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0daf749053a1afb0bdea7faa583dd7c7"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a0daf749053a1afb0bdea7faa583dd7c7">get_dvaluesdt</a> (<a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../de/db9/cxx11__tensor__map_8cpp.html#a7f507fea02198f6cb81c86640c7b1a4e">f</a>)</td></tr>
<tr class="separator:a0daf749053a1afb0bdea7faa583dd7c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0103fe1a09ecf7e23a9083b35ef07aac"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a0103fe1a09ecf7e23a9083b35ef07aac">get_residuals</a> (<a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;residuals)</td></tr>
<tr class="memdesc:a0103fe1a09ecf7e23a9083b35ef07aac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the total residuals Vector for the problem.  <a href="../../dc/de5/classoomph_1_1Problem.html#a0103fe1a09ecf7e23a9083b35ef07aac">More...</a><br /></td></tr>
<tr class="separator:a0103fe1a09ecf7e23a9083b35ef07aac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af660c2c0d10eaea1972314ce80de000e"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af660c2c0d10eaea1972314ce80de000e">get_jacobian</a> (<a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;residuals, <a class="el" href="../../dd/d03/classoomph_1_1DenseDoubleMatrix.html">DenseDoubleMatrix</a> &amp;jacobian)</td></tr>
<tr class="separator:af660c2c0d10eaea1972314ce80de000e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab9533075d11b251636fa1c3a544dba7"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aab9533075d11b251636fa1c3a544dba7">get_jacobian</a> (<a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;residuals, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> &amp;jacobian)</td></tr>
<tr class="separator:aab9533075d11b251636fa1c3a544dba7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9bbce5fdb111ccbab7a6077ac491feb"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae9bbce5fdb111ccbab7a6077ac491feb">get_jacobian</a> (<a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;residuals, <a class="el" href="../../d4/d2d/classoomph_1_1CCDoubleMatrix.html">CCDoubleMatrix</a> &amp;jacobian)</td></tr>
<tr class="separator:ae9bbce5fdb111ccbab7a6077ac491feb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0db16f9bcac7af964d0fecc8b6a5ea63"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a0db16f9bcac7af964d0fecc8b6a5ea63">get_jacobian</a> (<a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;residuals, <a class="el" href="../../d5/d36/classoomph_1_1SumOfMatrices.html">SumOfMatrices</a> &amp;jacobian)</td></tr>
<tr class="separator:a0db16f9bcac7af964d0fecc8b6a5ea63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f3d1c9378e385d7755184a97f5f6f91"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a9f3d1c9378e385d7755184a97f5f6f91">get_fd_jacobian</a> (<a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;residuals, <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;jacobian)</td></tr>
<tr class="memdesc:a9f3d1c9378e385d7755184a97f5f6f91"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the full Jacobian by finite differencing.  <a href="../../dc/de5/classoomph_1_1Problem.html#a9f3d1c9378e385d7755184a97f5f6f91">More...</a><br /></td></tr>
<tr class="separator:a9f3d1c9378e385d7755184a97f5f6f91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc456017cfc4fb4ae6f522973e50f496"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#adc456017cfc4fb4ae6f522973e50f496">get_derivative_wrt_global_parameter</a> (<a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;parameter_pt, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;result)</td></tr>
<tr class="separator:adc456017cfc4fb4ae6f522973e50f496"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a497518acb5d30a28a253890c3d2a5da2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a497518acb5d30a28a253890c3d2a5da2">get_hessian_vector_products</a> (<a class="el" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html">DoubleVectorWithHaloEntries</a> const &amp;<a class="el" href="../../d5/d17/StatisticsVector_8h.html#a25418fa818fbb01cd8c0b2c4b0732cdfa5596231eabd6cf29050967d5ac83ad84">Y</a>, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html">DoubleVectorWithHaloEntries</a> &gt; const &amp;<a class="el" href="../../d8/d3e/bench__gemm_8cpp.html#a3a8dbf45d202c92cb1786477c8315262">C</a>, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html">DoubleVectorWithHaloEntries</a> &gt; &amp;<a class="el" href="../../dc/daa/product_8h.html#a9ea93a3bb5ed3a3517d5db341bae0238">product</a>)</td></tr>
<tr class="separator:a497518acb5d30a28a253890c3d2a5da2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06cf96b1291774eb89517af10f80410a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a06cf96b1291774eb89517af10f80410a">solve_eigenproblem</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;n_eval, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; std::complex&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt;&gt; &amp;eigenvalue, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &gt; &amp;eigenvector, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;steady=true)</td></tr>
<tr class="memdesc:a06cf96b1291774eb89517af10f80410a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solve the eigenproblem.  <a href="../../dc/de5/classoomph_1_1Problem.html#a06cf96b1291774eb89517af10f80410a">More...</a><br /></td></tr>
<tr class="separator:a06cf96b1291774eb89517af10f80410a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad267407d3593871e4b8810ea5380f4ea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad267407d3593871e4b8810ea5380f4ea">solve_eigenproblem</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;n_eval, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; std::complex&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt;&gt; &amp;eigenvalue, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;steady=true)</td></tr>
<tr class="separator:ad267407d3593871e4b8810ea5380f4ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e59f1c854d1258aa2b4eca218405731"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a4e59f1c854d1258aa2b4eca218405731">get_eigenproblem_matrices</a> (<a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> &amp;mass_matrix, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> &amp;main_matrix, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;shift=0.0)</td></tr>
<tr class="separator:a4e59f1c854d1258aa2b4eca218405731"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada703cde7417adda572a72d05ddfa4b9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ada703cde7417adda572a72d05ddfa4b9">assign_eigenvector_to_dofs</a> (<a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;eigenvector)</td></tr>
<tr class="memdesc:ada703cde7417adda572a72d05ddfa4b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assign the eigenvector passed to the function to the dofs.  <a href="../../dc/de5/classoomph_1_1Problem.html#ada703cde7417adda572a72d05ddfa4b9">More...</a><br /></td></tr>
<tr class="separator:ada703cde7417adda572a72d05ddfa4b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3393dfcbf36c6198aead92c08ab95d0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa3393dfcbf36c6198aead92c08ab95d0">add_eigenvector_to_dofs</a> (const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;epsilon, const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;eigenvector)</td></tr>
<tr class="separator:aa3393dfcbf36c6198aead92c08ab95d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3ed0463968bd0fef5d9b97bcb8ca163"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac3ed0463968bd0fef5d9b97bcb8ca163">store_current_dof_values</a> ()</td></tr>
<tr class="memdesc:ac3ed0463968bd0fef5d9b97bcb8ca163"><td class="mdescLeft">&#160;</td><td class="mdescRight">Store the current values of the degrees of freedom.  <a href="../../dc/de5/classoomph_1_1Problem.html#ac3ed0463968bd0fef5d9b97bcb8ca163">More...</a><br /></td></tr>
<tr class="separator:ac3ed0463968bd0fef5d9b97bcb8ca163"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c927ed4f3e79527e0e23ac44779f0f8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a3c927ed4f3e79527e0e23ac44779f0f8">restore_dof_values</a> ()</td></tr>
<tr class="memdesc:a3c927ed4f3e79527e0e23ac44779f0f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Restore the stored values of the degrees of freedom.  <a href="../../dc/de5/classoomph_1_1Problem.html#a3c927ed4f3e79527e0e23ac44779f0f8">More...</a><br /></td></tr>
<tr class="separator:a3c927ed4f3e79527e0e23ac44779f0f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8eb2fedc3f64411cfbe1627a516447f9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a8eb2fedc3f64411cfbe1627a516447f9">enable_jacobian_reuse</a> ()</td></tr>
<tr class="separator:a8eb2fedc3f64411cfbe1627a516447f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52489fed5942629199e4f720a7a86549"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a52489fed5942629199e4f720a7a86549">disable_jacobian_reuse</a> ()</td></tr>
<tr class="memdesc:a52489fed5942629199e4f720a7a86549"><td class="mdescLeft">&#160;</td><td class="mdescRight">Disable recycling of Jacobian in Newton iteration.  <a href="../../dc/de5/classoomph_1_1Problem.html#a52489fed5942629199e4f720a7a86549">More...</a><br /></td></tr>
<tr class="separator:a52489fed5942629199e4f720a7a86549"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c864f0dfc4f0ff33e07935944b7b435"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5c864f0dfc4f0ff33e07935944b7b435">jacobian_reuse_is_enabled</a> ()</td></tr>
<tr class="memdesc:a5c864f0dfc4f0ff33e07935944b7b435"><td class="mdescLeft">&#160;</td><td class="mdescRight">Is recycling of Jacobian in Newton iteration enabled?  <a href="../../dc/de5/classoomph_1_1Problem.html#a5c864f0dfc4f0ff33e07935944b7b435">More...</a><br /></td></tr>
<tr class="separator:a5c864f0dfc4f0ff33e07935944b7b435"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a438bf1c7aafffda56f2acb34ba027fdb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a438bf1c7aafffda56f2acb34ba027fdb">use_predictor_values_as_initial_guess</a> ()</td></tr>
<tr class="separator:a438bf1c7aafffda56f2acb34ba027fdb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae8cf62757e432b625ec81fad1559dc3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aae8cf62757e432b625ec81fad1559dc3">newton_solve</a> ()</td></tr>
<tr class="memdesc:aae8cf62757e432b625ec81fad1559dc3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Use Newton method to solve the problem.  <a href="../../dc/de5/classoomph_1_1Problem.html#aae8cf62757e432b625ec81fad1559dc3">More...</a><br /></td></tr>
<tr class="separator:aae8cf62757e432b625ec81fad1559dc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7c7711978f7c02becb4005414f945be"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac7c7711978f7c02becb4005414f945be">enable_globally_convergent_newton_method</a> ()</td></tr>
<tr class="memdesc:ac7c7711978f7c02becb4005414f945be"><td class="mdescLeft">&#160;</td><td class="mdescRight">enable globally convergent Newton method  <a href="../../dc/de5/classoomph_1_1Problem.html#ac7c7711978f7c02becb4005414f945be">More...</a><br /></td></tr>
<tr class="separator:ac7c7711978f7c02becb4005414f945be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a927d35230db6fc5021b68eadaedac9a6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a927d35230db6fc5021b68eadaedac9a6">disable_globally_convergent_newton_method</a> ()</td></tr>
<tr class="memdesc:a927d35230db6fc5021b68eadaedac9a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">disable globally convergent Newton method  <a href="../../dc/de5/classoomph_1_1Problem.html#a927d35230db6fc5021b68eadaedac9a6">More...</a><br /></td></tr>
<tr class="separator:a927d35230db6fc5021b68eadaedac9a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abdb4fbbb5d658094cfd48e2296c7d3b7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#abdb4fbbb5d658094cfd48e2296c7d3b7">newton_solve</a> (<a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> const &amp;max_adapt)</td></tr>
<tr class="separator:abdb4fbbb5d658094cfd48e2296c7d3b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64b890295532c3a7ff5ad4e4dd5d56e3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a64b890295532c3a7ff5ad4e4dd5d56e3">steady_newton_solve</a> (<a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> const &amp;max_adapt=0)</td></tr>
<tr class="separator:a64b890295532c3a7ff5ad4e4dd5d56e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8b63040a3c6deff68fb2128c2f7fef2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab8b63040a3c6deff68fb2128c2f7fef2">copy</a> (<a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *orig_problem_pt)</td></tr>
<tr class="separator:ab8b63040a3c6deff68fb2128c2f7fef2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b10f0b678c60eaaa8bccb74ed1740f0"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a1b10f0b678c60eaaa8bccb74ed1740f0">make_copy</a> ()</td></tr>
<tr class="separator:a1b10f0b678c60eaaa8bccb74ed1740f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f6011ef141cc68598a9502052129a3f"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a4f6011ef141cc68598a9502052129a3f">read</a> (std::ifstream &amp;restart_file, <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;unsteady_restart)</td></tr>
<tr class="separator:a4f6011ef141cc68598a9502052129a3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a561320c1b8deb3540d260c6c2c5f4fb4"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a561320c1b8deb3540d260c6c2c5f4fb4">read</a> (std::ifstream &amp;restart_file)</td></tr>
<tr class="separator:a561320c1b8deb3540d260c6c2c5f4fb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1756534851a763f35fd5372b4d3723e0"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a1756534851a763f35fd5372b4d3723e0">dump</a> (std::ofstream &amp;dump_file) const</td></tr>
<tr class="separator:a1756534851a763f35fd5372b4d3723e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af94771cdd9de79c17c9cf168f4a67a92"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af94771cdd9de79c17c9cf168f4a67a92">dump</a> (const std::string &amp;dump_file_name) const</td></tr>
<tr class="separator:af94771cdd9de79c17c9cf168f4a67a92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae796d578da9c7578742f7a6e1f5d0c0a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae796d578da9c7578742f7a6e1f5d0c0a">delete_all_external_storage</a> ()</td></tr>
<tr class="separator:ae796d578da9c7578742f7a6e1f5d0c0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f05445558a6128cb24fe441e156aaad"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a0f05445558a6128cb24fe441e156aaad">symmetrise_eigenfunction_for_adaptive_pitchfork_tracking</a> ()</td></tr>
<tr class="separator:a0f05445558a6128cb24fe441e156aaad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a937937da4763c3ed31a84f6b65df6f51"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a937937da4763c3ed31a84f6b65df6f51">bifurcation_parameter_pt</a> () const</td></tr>
<tr class="separator:a937937da4763c3ed31a84f6b65df6f51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82c795d158c119cfde04089b516d6711"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a82c795d158c119cfde04089b516d6711">get_bifurcation_eigenfunction</a> (<a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &gt; &amp;eigenfunction)</td></tr>
<tr class="separator:a82c795d158c119cfde04089b516d6711"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4f954e46b84b13a2bb16a83b3f0ff83"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa4f954e46b84b13a2bb16a83b3f0ff83">activate_fold_tracking</a> (<a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;parameter_pt, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;block_solve=true)</td></tr>
<tr class="separator:aa4f954e46b84b13a2bb16a83b3f0ff83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ed88021ec449655c64191154dd236af"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a9ed88021ec449655c64191154dd236af">activate_bifurcation_tracking</a> (<a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;parameter_pt, const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;eigenvector, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;block_solve=true)</td></tr>
<tr class="separator:a9ed88021ec449655c64191154dd236af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2a142db67f0f417b04cb3c2b88d36fc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae2a142db67f0f417b04cb3c2b88d36fc">activate_bifurcation_tracking</a> (<a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;parameter_pt, const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;eigenvector, const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;normalisation, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;block_solve=true)</td></tr>
<tr class="separator:ae2a142db67f0f417b04cb3c2b88d36fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66fd78008266a4023f450971af444508"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a66fd78008266a4023f450971af444508">activate_pitchfork_tracking</a> (<a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;parameter_pt, const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;symmetry_vector, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;block_solve=true)</td></tr>
<tr class="separator:a66fd78008266a4023f450971af444508"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5202944fe909268c20abcfb4576d147b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5202944fe909268c20abcfb4576d147b">activate_hopf_tracking</a> (<a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;parameter_pt, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;block_solve=true)</td></tr>
<tr class="separator:a5202944fe909268c20abcfb4576d147b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78807475d5e238f2d58a6c36f3795ea0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a78807475d5e238f2d58a6c36f3795ea0">activate_hopf_tracking</a> (<a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;parameter_pt, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;omega, const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;null_real, const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;null_imag, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;block_solve=true)</td></tr>
<tr class="separator:a78807475d5e238f2d58a6c36f3795ea0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5b47ae12ed6445e52c65596dfa97c6d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac5b47ae12ed6445e52c65596dfa97c6d">deactivate_bifurcation_tracking</a> ()</td></tr>
<tr class="separator:ac5b47ae12ed6445e52c65596dfa97c6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b6b29c5e2ae9d4a22dac5b4494b7bc4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a0b6b29c5e2ae9d4a22dac5b4494b7bc4">reset_assembly_handler_to_default</a> ()</td></tr>
<tr class="memdesc:a0b6b29c5e2ae9d4a22dac5b4494b7bc4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset the system to the standard non-augemented state.  <a href="../../dc/de5/classoomph_1_1Problem.html#a0b6b29c5e2ae9d4a22dac5b4494b7bc4">More...</a><br /></td></tr>
<tr class="separator:a0b6b29c5e2ae9d4a22dac5b4494b7bc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee0d9902fd26b600c9519bea2dfc0f54"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aee0d9902fd26b600c9519bea2dfc0f54">arc_length_step_solve</a> (<a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;parameter_pt, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;ds, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;max_adapt=0)</td></tr>
<tr class="separator:aee0d9902fd26b600c9519bea2dfc0f54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f4cbf8b8f2df704ae80f28c01914ddb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a2f4cbf8b8f2df704ae80f28c01914ddb">arc_length_step_solve</a> (<a class="el" href="../../d8/dc5/classoomph_1_1Data.html">Data</a> *const &amp;data_pt, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;data_index, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;ds, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;max_adapt=0)</td></tr>
<tr class="separator:a2f4cbf8b8f2df704ae80f28c01914ddb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6477df6e8184dc78e9d9ff82c7627cef"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6477df6e8184dc78e9d9ff82c7627cef">reset_arc_length_parameters</a> ()</td></tr>
<tr class="separator:a6477df6e8184dc78e9d9ff82c7627cef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a797cb28b5fffe976fc7541421eb423a1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a797cb28b5fffe976fc7541421eb423a1">sign_of_jacobian</a> ()</td></tr>
<tr class="separator:a797cb28b5fffe976fc7541421eb423a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2eff0725bba4f2435bcc4797a9e59ab4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a2eff0725bba4f2435bcc4797a9e59ab4">explicit_timestep</a> (const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;dt, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;shift_values=true)</td></tr>
<tr class="memdesc:a2eff0725bba4f2435bcc4797a9e59ab4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Take an explicit timestep of size dt.  <a href="../../dc/de5/classoomph_1_1Problem.html#a2eff0725bba4f2435bcc4797a9e59ab4">More...</a><br /></td></tr>
<tr class="separator:a2eff0725bba4f2435bcc4797a9e59ab4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb4d5d80b18ea103f71c8013e3384766"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#adb4d5d80b18ea103f71c8013e3384766">unsteady_newton_solve</a> (const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;dt)</td></tr>
<tr class="separator:adb4d5d80b18ea103f71c8013e3384766"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b015281f27d25ee0209cd9b467175b6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a4b015281f27d25ee0209cd9b467175b6">unsteady_newton_solve</a> (const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;dt, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;shift_values)</td></tr>
<tr class="separator:a4b015281f27d25ee0209cd9b467175b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31d279b8e62fc676f25b9b347f4ffd8b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a31d279b8e62fc676f25b9b347f4ffd8b">unsteady_newton_solve</a> (const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;dt, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;max_adapt, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;first, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;shift=true)</td></tr>
<tr class="separator:a31d279b8e62fc676f25b9b347f4ffd8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7561d4f82e1fa625210c58a78294a301"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7561d4f82e1fa625210c58a78294a301">doubly_adaptive_unsteady_newton_solve</a> (const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;dt, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;epsilon, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;max_adapt, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;first, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;shift=true)</td></tr>
<tr class="separator:a7561d4f82e1fa625210c58a78294a301"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6c326bce8647c2a59cf62288ce4902e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae6c326bce8647c2a59cf62288ce4902e">doubly_adaptive_unsteady_newton_solve</a> (const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;dt, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;epsilon, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;max_adapt, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;suppress_resolve_after_spatial_adapt_flag, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;first, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;shift=true)</td></tr>
<tr class="separator:ae6c326bce8647c2a59cf62288ce4902e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b7434598b8a28bf6470f481acef5d5f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a9b7434598b8a28bf6470f481acef5d5f">adaptive_unsteady_newton_solve</a> (const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;dt_desired, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;epsilon)</td></tr>
<tr class="separator:a9b7434598b8a28bf6470f481acef5d5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63805c549e71b7c73107abe6001fae25"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a63805c549e71b7c73107abe6001fae25">adaptive_unsteady_newton_solve</a> (const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;dt_desired, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;epsilon, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;shift_values)</td></tr>
<tr class="separator:a63805c549e71b7c73107abe6001fae25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d966c0bfd336699586057e476bd17d5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7d966c0bfd336699586057e476bd17d5">assign_initial_values_impulsive</a> ()</td></tr>
<tr class="separator:a7d966c0bfd336699586057e476bd17d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6affe0af3093f94c348d9a3d008dde08"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6affe0af3093f94c348d9a3d008dde08">assign_initial_values_impulsive</a> (const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;dt)</td></tr>
<tr class="separator:a6affe0af3093f94c348d9a3d008dde08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbc0b0fc5d5cc76ce8384bc0bd815f26"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acbc0b0fc5d5cc76ce8384bc0bd815f26">calculate_predictions</a> ()</td></tr>
<tr class="memdesc:acbc0b0fc5d5cc76ce8384bc0bd815f26"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate predictions.  <a href="../../dc/de5/classoomph_1_1Problem.html#acbc0b0fc5d5cc76ce8384bc0bd815f26">More...</a><br /></td></tr>
<tr class="separator:acbc0b0fc5d5cc76ce8384bc0bd815f26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add951d12e349d0c220c3dd808962f4ae"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#add951d12e349d0c220c3dd808962f4ae">enable_mass_matrix_reuse</a> ()</td></tr>
<tr class="separator:add951d12e349d0c220c3dd808962f4ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a368ac86b9807c29864de42a872fd534f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a368ac86b9807c29864de42a872fd534f">disable_mass_matrix_reuse</a> ()</td></tr>
<tr class="separator:a368ac86b9807c29864de42a872fd534f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa46c693258868c126503cce3a663a85"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#afa46c693258868c126503cce3a663a85">mass_matrix_reuse_is_enabled</a> ()</td></tr>
<tr class="memdesc:afa46c693258868c126503cce3a663a85"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return whether the mass matrix is being reused.  <a href="../../dc/de5/classoomph_1_1Problem.html#afa46c693258868c126503cce3a663a85">More...</a><br /></td></tr>
<tr class="separator:afa46c693258868c126503cce3a663a85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a181fa92838f77bd6b12b531dca222c41"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a181fa92838f77bd6b12b531dca222c41">refine_uniformly</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;nrefine_for_mesh)</td></tr>
<tr class="separator:a181fa92838f77bd6b12b531dca222c41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14ca1d18e9aa569a6417c45eef70d3ff"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a14ca1d18e9aa569a6417c45eef70d3ff">refine_uniformly</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;nrefine_for_mesh, <a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> &amp;doc_info)</td></tr>
<tr class="separator:a14ca1d18e9aa569a6417c45eef70d3ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3930fc0977bdc33f52100e53f5d878d7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a3930fc0977bdc33f52100e53f5d878d7">refine_uniformly_and_prune</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;nrefine_for_mesh)</td></tr>
<tr class="separator:a3930fc0977bdc33f52100e53f5d878d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adea5168244acebb539fa29e36182ced3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#adea5168244acebb539fa29e36182ced3">refine_uniformly_and_prune</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;nrefine_for_mesh, <a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> &amp;doc_info)</td></tr>
<tr class="separator:adea5168244acebb539fa29e36182ced3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4ccf79fde59556d93af947618b6c80b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae4ccf79fde59556d93af947618b6c80b">refine_uniformly</a> (<a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> &amp;doc_info)</td></tr>
<tr class="separator:ae4ccf79fde59556d93af947618b6c80b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0495df29dde90577e4702fcac496684"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac0495df29dde90577e4702fcac496684">refine_uniformly_and_prune</a> (<a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> &amp;doc_info)</td></tr>
<tr class="separator:ac0495df29dde90577e4702fcac496684"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade208b7d7d8e866d5ba896f03edb1f9a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ade208b7d7d8e866d5ba896f03edb1f9a">refine_uniformly</a> ()</td></tr>
<tr class="separator:ade208b7d7d8e866d5ba896f03edb1f9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ce3a9162aaef9e0a4d86f8de57eb523"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a1ce3a9162aaef9e0a4d86f8de57eb523">refine_uniformly</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;i_mesh, <a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> &amp;doc_info)</td></tr>
<tr class="memdesc:a1ce3a9162aaef9e0a4d86f8de57eb523"><td class="mdescLeft">&#160;</td><td class="mdescRight">Do uniform refinement for submesh i_mesh with documentation.  <a href="../../dc/de5/classoomph_1_1Problem.html#a1ce3a9162aaef9e0a4d86f8de57eb523">More...</a><br /></td></tr>
<tr class="separator:a1ce3a9162aaef9e0a4d86f8de57eb523"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afae401b74b58d6312da32f153b78047d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#afae401b74b58d6312da32f153b78047d">refine_uniformly</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;i_mesh)</td></tr>
<tr class="memdesc:afae401b74b58d6312da32f153b78047d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Do uniform refinement for submesh i_mesh without documentation.  <a href="../../dc/de5/classoomph_1_1Problem.html#afae401b74b58d6312da32f153b78047d">More...</a><br /></td></tr>
<tr class="separator:afae401b74b58d6312da32f153b78047d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3aaea4b1be43f5d4bb187a8c6d3ca16f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a3aaea4b1be43f5d4bb187a8c6d3ca16f">p_refine_uniformly</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;nrefine_for_mesh)</td></tr>
<tr class="separator:a3aaea4b1be43f5d4bb187a8c6d3ca16f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a980d9659db60b113b6d4e7431594b7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a0a980d9659db60b113b6d4e7431594b7">p_refine_uniformly</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;nrefine_for_mesh, <a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> &amp;doc_info)</td></tr>
<tr class="separator:a0a980d9659db60b113b6d4e7431594b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5155b2d5436a95b1ee27f914b4eb8f08"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5155b2d5436a95b1ee27f914b4eb8f08">p_refine_uniformly_and_prune</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;nrefine_for_mesh)</td></tr>
<tr class="separator:a5155b2d5436a95b1ee27f914b4eb8f08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabfa653ef203edf44cf9b6cf558865e1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aabfa653ef203edf44cf9b6cf558865e1">p_refine_uniformly_and_prune</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;nrefine_for_mesh, <a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> &amp;doc_info)</td></tr>
<tr class="separator:aabfa653ef203edf44cf9b6cf558865e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a355caf4c06c3b8b5d399115048453921"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a355caf4c06c3b8b5d399115048453921">p_refine_uniformly</a> (<a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> &amp;doc_info)</td></tr>
<tr class="separator:a355caf4c06c3b8b5d399115048453921"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80ff24a4fc923660f2aabfaa763822bf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a80ff24a4fc923660f2aabfaa763822bf">p_refine_uniformly_and_prune</a> (<a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> &amp;doc_info)</td></tr>
<tr class="separator:a80ff24a4fc923660f2aabfaa763822bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada439afd4d195644e53d6bdbc4b00587"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ada439afd4d195644e53d6bdbc4b00587">p_refine_uniformly</a> ()</td></tr>
<tr class="separator:ada439afd4d195644e53d6bdbc4b00587"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a093b78c1820cf3fe6bd9ec3deb605b49"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a093b78c1820cf3fe6bd9ec3deb605b49">p_refine_uniformly</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;i_mesh, <a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> &amp;doc_info)</td></tr>
<tr class="memdesc:a093b78c1820cf3fe6bd9ec3deb605b49"><td class="mdescLeft">&#160;</td><td class="mdescRight">Do uniform p-refinement for submesh i_mesh with documentation.  <a href="../../dc/de5/classoomph_1_1Problem.html#a093b78c1820cf3fe6bd9ec3deb605b49">More...</a><br /></td></tr>
<tr class="separator:a093b78c1820cf3fe6bd9ec3deb605b49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33dbab01dfa53e4d005818a2940085b0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a33dbab01dfa53e4d005818a2940085b0">p_refine_uniformly</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;i_mesh)</td></tr>
<tr class="memdesc:a33dbab01dfa53e4d005818a2940085b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Do uniform p-refinement for submesh i_mesh without documentation.  <a href="../../dc/de5/classoomph_1_1Problem.html#a33dbab01dfa53e4d005818a2940085b0">More...</a><br /></td></tr>
<tr class="separator:a33dbab01dfa53e4d005818a2940085b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3dcfc37fe1b6c21d694407981830c1e5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a3dcfc37fe1b6c21d694407981830c1e5">refine_selected_elements</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;elements_to_be_refined)</td></tr>
<tr class="separator:a3dcfc37fe1b6c21d694407981830c1e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2c5924864cbe37b94429eb90d58801e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa2c5924864cbe37b94429eb90d58801e">refine_selected_elements</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../dc/d08/classoomph_1_1RefineableElement.html">RefineableElement</a> * &gt; &amp;elements_to_be_refined_pt)</td></tr>
<tr class="separator:aa2c5924864cbe37b94429eb90d58801e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad063e4c93b80ce4d5b22d776bfac5503"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad063e4c93b80ce4d5b22d776bfac5503">refine_selected_elements</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;i_mesh, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;elements_to_be_refined)</td></tr>
<tr class="separator:ad063e4c93b80ce4d5b22d776bfac5503"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9613642f5dca54e33c836e16507a0a7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab9613642f5dca54e33c836e16507a0a7">refine_selected_elements</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;i_mesh, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../dc/d08/classoomph_1_1RefineableElement.html">RefineableElement</a> * &gt; &amp;elements_to_be_refined_pt)</td></tr>
<tr class="separator:ab9613642f5dca54e33c836e16507a0a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5e5ab43882bd549ccbd2d92bb74b2f8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa5e5ab43882bd549ccbd2d92bb74b2f8">refine_selected_elements</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt;&gt; &amp;elements_to_be_refined)</td></tr>
<tr class="separator:aa5e5ab43882bd549ccbd2d92bb74b2f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac52c14f8d7f44565516e2eee16923e8b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac52c14f8d7f44565516e2eee16923e8b">refine_selected_elements</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../dc/d08/classoomph_1_1RefineableElement.html">RefineableElement</a> * &gt;&gt; &amp;elements_to_be_refined_pt)</td></tr>
<tr class="separator:ac52c14f8d7f44565516e2eee16923e8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad73bff32f14763e813cabdcd4c88c06"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad73bff32f14763e813cabdcd4c88c06">p_refine_selected_elements</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;elements_to_be_refined)</td></tr>
<tr class="separator:aad73bff32f14763e813cabdcd4c88c06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66aa88c63c39916dac92a66576624c08"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a66aa88c63c39916dac92a66576624c08">p_refine_selected_elements</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d3/d0c/classoomph_1_1PRefineableElement.html">PRefineableElement</a> * &gt; &amp;elements_to_be_refined_pt)</td></tr>
<tr class="separator:a66aa88c63c39916dac92a66576624c08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac69a6b98a561adcfef0ef369b32e5fbd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac69a6b98a561adcfef0ef369b32e5fbd">p_refine_selected_elements</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;i_mesh, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;elements_to_be_refined)</td></tr>
<tr class="separator:ac69a6b98a561adcfef0ef369b32e5fbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a021ca53709629bd20bcd9fe40fa83ddf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a021ca53709629bd20bcd9fe40fa83ddf">p_refine_selected_elements</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;i_mesh, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d3/d0c/classoomph_1_1PRefineableElement.html">PRefineableElement</a> * &gt; &amp;elements_to_be_refined_pt)</td></tr>
<tr class="separator:a021ca53709629bd20bcd9fe40fa83ddf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2eaf36f52079a4d49d8aa871127c6a2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae2eaf36f52079a4d49d8aa871127c6a2">p_refine_selected_elements</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt;&gt; &amp;elements_to_be_refined)</td></tr>
<tr class="separator:ae2eaf36f52079a4d49d8aa871127c6a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6047e095c774ef0d2850736a0ad03cd2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6047e095c774ef0d2850736a0ad03cd2">p_refine_selected_elements</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d3/d0c/classoomph_1_1PRefineableElement.html">PRefineableElement</a> * &gt;&gt; &amp;elements_to_be_refined_pt)</td></tr>
<tr class="separator:a6047e095c774ef0d2850736a0ad03cd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56429d79e517d59a54cd49949b04d3ae"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a56429d79e517d59a54cd49949b04d3ae">unrefine_uniformly</a> ()</td></tr>
<tr class="separator:a56429d79e517d59a54cd49949b04d3ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac552ccdf3b91079a3c8d223fc5ba3bda"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac552ccdf3b91079a3c8d223fc5ba3bda">unrefine_uniformly</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;i_mesh)</td></tr>
<tr class="separator:ac552ccdf3b91079a3c8d223fc5ba3bda"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa0aab9ca7018bf875c1f3367c6c07e3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#afa0aab9ca7018bf875c1f3367c6c07e3">p_unrefine_uniformly</a> (<a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> &amp;doc_info)</td></tr>
<tr class="separator:afa0aab9ca7018bf875c1f3367c6c07e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1d230109bb9c45604042f5b76bae2dc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af1d230109bb9c45604042f5b76bae2dc">p_unrefine_uniformly</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;i_mesh, <a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> &amp;doc_info)</td></tr>
<tr class="memdesc:af1d230109bb9c45604042f5b76bae2dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Do uniform p-unrefinement for submesh i_mesh without documentation.  <a href="../../dc/de5/classoomph_1_1Problem.html#af1d230109bb9c45604042f5b76bae2dc">More...</a><br /></td></tr>
<tr class="separator:af1d230109bb9c45604042f5b76bae2dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5e60c7b47591bca6b20b0612e119983"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5e60c7b47591bca6b20b0612e119983">adapt</a> (<a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;n_refined, <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;n_unrefined)</td></tr>
<tr class="separator:ad5e60c7b47591bca6b20b0612e119983"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b9e09ddfa2411f14fc723c3207decd1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a0b9e09ddfa2411f14fc723c3207decd1">adapt</a> ()</td></tr>
<tr class="separator:a0b9e09ddfa2411f14fc723c3207decd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a350e611af4847eabfa1d531b14b4439c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a350e611af4847eabfa1d531b14b4439c">p_adapt</a> (<a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;n_refined, <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;n_unrefined)</td></tr>
<tr class="separator:a350e611af4847eabfa1d531b14b4439c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaad4443f87f3f3affe53fa9160802e7c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aaad4443f87f3f3affe53fa9160802e7c">p_adapt</a> ()</td></tr>
<tr class="separator:aaad4443f87f3f3affe53fa9160802e7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a309487c952f108015b53a2d70539ac8b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a309487c952f108015b53a2d70539ac8b">adapt_based_on_error_estimates</a> (<a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;n_refined, <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;n_unrefined, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt;&gt; &amp;elemental_error)</td></tr>
<tr class="separator:a309487c952f108015b53a2d70539ac8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3809e4ec25082a5b8686bd6fa1c61fce"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a3809e4ec25082a5b8686bd6fa1c61fce">adapt_based_on_error_estimates</a> (<a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt;&gt; &amp;elemental_error)</td></tr>
<tr class="separator:a3809e4ec25082a5b8686bd6fa1c61fce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2bd35d5954b6a8d43189b84520adb4b3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a2bd35d5954b6a8d43189b84520adb4b3">get_all_error_estimates</a> (<a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt;&gt; &amp;elemental_error)</td></tr>
<tr class="separator:a2bd35d5954b6a8d43189b84520adb4b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfa6431916fd73b661d8a62706d5137f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#adfa6431916fd73b661d8a62706d5137f">doc_errors</a> (<a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> &amp;doc_info)</td></tr>
<tr class="memdesc:adfa6431916fd73b661d8a62706d5137f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get max and min error for all elements in submeshes.  <a href="../../dc/de5/classoomph_1_1Problem.html#adfa6431916fd73b661d8a62706d5137f">More...</a><br /></td></tr>
<tr class="separator:adfa6431916fd73b661d8a62706d5137f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2a9dfdb7b4f95bb941d48411f955f55"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af2a9dfdb7b4f95bb941d48411f955f55">doc_errors</a> ()</td></tr>
<tr class="memdesc:af2a9dfdb7b4f95bb941d48411f955f55"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get max and min error for all elements in submeshes.  <a href="../../dc/de5/classoomph_1_1Problem.html#af2a9dfdb7b4f95bb941d48411f955f55">More...</a><br /></td></tr>
<tr class="separator:af2a9dfdb7b4f95bb941d48411f955f55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3226bf49118c8a4f02dbe01d22428f20"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a3226bf49118c8a4f02dbe01d22428f20">enable_info_in_newton_solve</a> ()</td></tr>
<tr class="separator:a3226bf49118c8a4f02dbe01d22428f20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af00e3623681347439fe3dac650423bbe"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af00e3623681347439fe3dac650423bbe">disable_info_in_newton_solve</a> ()</td></tr>
<tr class="memdesc:af00e3623681347439fe3dac650423bbe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Disable the output of information when in the newton solver.  <a href="../../dc/de5/classoomph_1_1Problem.html#af00e3623681347439fe3dac650423bbe">More...</a><br /></td></tr>
<tr class="separator:af00e3623681347439fe3dac650423bbe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classoomph_1_1ExplicitTimeSteppableObject"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classoomph_1_1ExplicitTimeSteppableObject')"><img src="../../closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="../../df/d86/classoomph_1_1ExplicitTimeSteppableObject.html">oomph::ExplicitTimeSteppableObject</a></td></tr>
<tr class="memitem:a07e82e7df9f289fc59fbf5ac438ad068 inherit pub_methods_classoomph_1_1ExplicitTimeSteppableObject"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d86/classoomph_1_1ExplicitTimeSteppableObject.html#a07e82e7df9f289fc59fbf5ac438ad068">ExplicitTimeSteppableObject</a> ()</td></tr>
<tr class="memdesc:a07e82e7df9f289fc59fbf5ac438ad068 inherit pub_methods_classoomph_1_1ExplicitTimeSteppableObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">Empty constructor.  <a href="../../df/d86/classoomph_1_1ExplicitTimeSteppableObject.html#a07e82e7df9f289fc59fbf5ac438ad068">More...</a><br /></td></tr>
<tr class="separator:a07e82e7df9f289fc59fbf5ac438ad068 inherit pub_methods_classoomph_1_1ExplicitTimeSteppableObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9e1d1c57792a5540f0d31f3b36b4d7b inherit pub_methods_classoomph_1_1ExplicitTimeSteppableObject"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d86/classoomph_1_1ExplicitTimeSteppableObject.html#af9e1d1c57792a5540f0d31f3b36b4d7b">ExplicitTimeSteppableObject</a> (const <a class="el" href="../../df/d86/classoomph_1_1ExplicitTimeSteppableObject.html">ExplicitTimeSteppableObject</a> &amp;)=delete</td></tr>
<tr class="memdesc:af9e1d1c57792a5540f0d31f3b36b4d7b inherit pub_methods_classoomph_1_1ExplicitTimeSteppableObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken copy constructor.  <a href="../../df/d86/classoomph_1_1ExplicitTimeSteppableObject.html#af9e1d1c57792a5540f0d31f3b36b4d7b">More...</a><br /></td></tr>
<tr class="separator:af9e1d1c57792a5540f0d31f3b36b4d7b inherit pub_methods_classoomph_1_1ExplicitTimeSteppableObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85c2f447b67a0afd64e910b558ac6f90 inherit pub_methods_classoomph_1_1ExplicitTimeSteppableObject"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d86/classoomph_1_1ExplicitTimeSteppableObject.html#a85c2f447b67a0afd64e910b558ac6f90">operator=</a> (const <a class="el" href="../../df/d86/classoomph_1_1ExplicitTimeSteppableObject.html">ExplicitTimeSteppableObject</a> &amp;)=delete</td></tr>
<tr class="memdesc:a85c2f447b67a0afd64e910b558ac6f90 inherit pub_methods_classoomph_1_1ExplicitTimeSteppableObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken assignment operator.  <a href="../../df/d86/classoomph_1_1ExplicitTimeSteppableObject.html#a85c2f447b67a0afd64e910b558ac6f90">More...</a><br /></td></tr>
<tr class="separator:a85c2f447b67a0afd64e910b558ac6f90 inherit pub_methods_classoomph_1_1ExplicitTimeSteppableObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ed68ad4da79ddfdc5b545fa62292304 inherit pub_methods_classoomph_1_1ExplicitTimeSteppableObject"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d86/classoomph_1_1ExplicitTimeSteppableObject.html#a0ed68ad4da79ddfdc5b545fa62292304">~ExplicitTimeSteppableObject</a> ()</td></tr>
<tr class="memdesc:a0ed68ad4da79ddfdc5b545fa62292304 inherit pub_methods_classoomph_1_1ExplicitTimeSteppableObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">Empty destructor.  <a href="../../df/d86/classoomph_1_1ExplicitTimeSteppableObject.html#a0ed68ad4da79ddfdc5b545fa62292304">More...</a><br /></td></tr>
<tr class="separator:a0ed68ad4da79ddfdc5b545fa62292304 inherit pub_methods_classoomph_1_1ExplicitTimeSteppableObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74eb2ebff3fc3066edccdfe4d3b6bc07 inherit pub_methods_classoomph_1_1ExplicitTimeSteppableObject"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d86/classoomph_1_1ExplicitTimeSteppableObject.html#a74eb2ebff3fc3066edccdfe4d3b6bc07">actions_before_explicit_stage</a> ()</td></tr>
<tr class="separator:a74eb2ebff3fc3066edccdfe4d3b6bc07 inherit pub_methods_classoomph_1_1ExplicitTimeSteppableObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1eb700abad36e868a84c475f9866b7d inherit pub_methods_classoomph_1_1ExplicitTimeSteppableObject"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d86/classoomph_1_1ExplicitTimeSteppableObject.html#ad1eb700abad36e868a84c475f9866b7d">actions_after_explicit_stage</a> ()</td></tr>
<tr class="separator:ad1eb700abad36e868a84c475f9866b7d inherit pub_methods_classoomph_1_1ExplicitTimeSteppableObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:ab4a3743c23a2d1eed56981484636c958"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab4a3743c23a2d1eed56981484636c958">Shut_up_in_newton_solve</a></td></tr>
<tr class="separator:ab4a3743c23a2d1eed56981484636c958"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:a36b11f7bc1b7b9413ee4a78eab536df8"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a36b11f7bc1b7b9413ee4a78eab536df8">Suppress_warning_about_actions_before_read_unstructured_meshes</a></td></tr>
<tr class="separator:a36b11f7bc1b7b9413ee4a78eab536df8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-types"></a>
Protected Types</h2></td></tr>
<tr class="memitem:ac793c004113930938730ec04dd2245b7"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac793c004113930938730ec04dd2245b7">Assembly_method</a> { <br />
&#160;&#160;<a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac793c004113930938730ec04dd2245b7aa00e1772bb5ccf1c837a2bad2f240241">Perform_assembly_using_vectors_of_pairs</a>
, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac793c004113930938730ec04dd2245b7a6008d2b6aa449ee405313b49632d18ff">Perform_assembly_using_two_vectors</a>
, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac793c004113930938730ec04dd2245b7a406ad24599e1a59450acdd09bac1d717">Perform_assembly_using_maps</a>
, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac793c004113930938730ec04dd2245b7ad73bb55e4e1f000cfd6930cb8b2a52f8">Perform_assembly_using_lists</a>
, <br />
&#160;&#160;<a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac793c004113930938730ec04dd2245b7a1383f03857ad8602ba7edef43bd947f5">Perform_assembly_using_two_arrays</a>
<br />
 }</td></tr>
<tr class="memdesc:ac793c004113930938730ec04dd2245b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enumerated flags to determine which sparse assembly method is used.  <a href="../../dc/de5/classoomph_1_1Problem.html#ac793c004113930938730ec04dd2245b7">More...</a><br /></td></tr>
<tr class="separator:ac793c004113930938730ec04dd2245b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:aae085671047b62a98ef310d66cc3f412"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aae085671047b62a98ef310d66cc3f412">setup_element_count_per_dof</a> ()</td></tr>
<tr class="separator:aae085671047b62a98ef310d66cc3f412"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9cdd18180be05e4d46bfdbc1acbdbd3"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab9cdd18180be05e4d46bfdbc1acbdbd3">sparse_assemble_row_or_column_compressed</a> (<a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> * &gt; &amp;column_or_row_index, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> * &gt; &amp;row_or_column_start, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> * &gt; &amp;value, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;nnz, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> * &gt; &amp;residual, <a class="el" href="../../d9/db9/classbool.html">bool</a> compressed_row_flag)</td></tr>
<tr class="separator:ab9cdd18180be05e4d46bfdbc1acbdbd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c8d70891f7369bb4bf8412fa1a08ecb"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a0c8d70891f7369bb4bf8412fa1a08ecb">actions_before_newton_solve</a> ()</td></tr>
<tr class="separator:a0c8d70891f7369bb4bf8412fa1a08ecb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a033ec7301123deeb7e56d04c38f9f1da"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a033ec7301123deeb7e56d04c38f9f1da">actions_after_newton_solve</a> ()</td></tr>
<tr class="separator:a033ec7301123deeb7e56d04c38f9f1da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6ad96ddf5d48b517b89c9a9b879bc4b"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae6ad96ddf5d48b517b89c9a9b879bc4b">actions_before_newton_convergence_check</a> ()</td></tr>
<tr class="separator:ae6ad96ddf5d48b517b89c9a9b879bc4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07fc81781c74b25c8a426ec18295b0d0"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a07fc81781c74b25c8a426ec18295b0d0">actions_before_newton_step</a> ()</td></tr>
<tr class="separator:a07fc81781c74b25c8a426ec18295b0d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed8bc6e7b0bb45b86d5b44737b554d50"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aed8bc6e7b0bb45b86d5b44737b554d50">actions_after_newton_step</a> ()</td></tr>
<tr class="separator:aed8bc6e7b0bb45b86d5b44737b554d50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f19896906d2c0274ad6798cd3ac38dc"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a4f19896906d2c0274ad6798cd3ac38dc">actions_before_implicit_timestep</a> ()</td></tr>
<tr class="separator:a4f19896906d2c0274ad6798cd3ac38dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a012692496c968960f4ea27db4e89cc7d"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a012692496c968960f4ea27db4e89cc7d">actions_after_implicit_timestep</a> ()</td></tr>
<tr class="separator:a012692496c968960f4ea27db4e89cc7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38d914a74e7998ddc74c205884d36d57"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a38d914a74e7998ddc74c205884d36d57">actions_after_implicit_timestep_and_error_estimation</a> ()</td></tr>
<tr class="separator:a38d914a74e7998ddc74c205884d36d57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ae06bc0ecba349ebdf76220c1a17546"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6ae06bc0ecba349ebdf76220c1a17546">actions_before_explicit_timestep</a> ()</td></tr>
<tr class="memdesc:a6ae06bc0ecba349ebdf76220c1a17546"><td class="mdescLeft">&#160;</td><td class="mdescRight">Actions that should be performed before each explicit time step.  <a href="../../dc/de5/classoomph_1_1Problem.html#a6ae06bc0ecba349ebdf76220c1a17546">More...</a><br /></td></tr>
<tr class="separator:a6ae06bc0ecba349ebdf76220c1a17546"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51bfd872c45467a65ce977f3753a6d1d"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a51bfd872c45467a65ce977f3753a6d1d">actions_after_explicit_timestep</a> ()</td></tr>
<tr class="memdesc:a51bfd872c45467a65ce977f3753a6d1d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Actions that should be performed after each explicit time step.  <a href="../../dc/de5/classoomph_1_1Problem.html#a51bfd872c45467a65ce977f3753a6d1d">More...</a><br /></td></tr>
<tr class="separator:a51bfd872c45467a65ce977f3753a6d1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af10662119a7a0c3a47879fa0d0644452"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af10662119a7a0c3a47879fa0d0644452">actions_before_read_unstructured_meshes</a> ()</td></tr>
<tr class="separator:af10662119a7a0c3a47879fa0d0644452"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a498317b3e390eddf2169ab989ee8d6b4"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a498317b3e390eddf2169ab989ee8d6b4">actions_after_read_unstructured_meshes</a> ()</td></tr>
<tr class="separator:a498317b3e390eddf2169ab989ee8d6b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e90bbe5d279295b97ae704487259bcc"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a1e90bbe5d279295b97ae704487259bcc">actions_after_change_in_global_parameter</a> (<a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;parameter_pt)</td></tr>
<tr class="separator:a1e90bbe5d279295b97ae704487259bcc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f08629e3c9c72b441ec7f19f175b2c7"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5f08629e3c9c72b441ec7f19f175b2c7">actions_after_change_in_bifurcation_parameter</a> ()</td></tr>
<tr class="separator:a5f08629e3c9c72b441ec7f19f175b2c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54e18ddf6073f9debd478f6b21a717de"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a54e18ddf6073f9debd478f6b21a717de">actions_after_parameter_increase</a> (<a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;parameter_pt)</td></tr>
<tr class="separator:a54e18ddf6073f9debd478f6b21a717de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6df5fb0d282f25df1e94a665dd838e5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad6df5fb0d282f25df1e94a665dd838e5">dof_derivative</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>)</td></tr>
<tr class="separator:ad6df5fb0d282f25df1e94a665dd838e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10fd6457ceceb02a0e11d860ac0017c5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a10fd6457ceceb02a0e11d860ac0017c5">dof_current</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>)</td></tr>
<tr class="separator:a10fd6457ceceb02a0e11d860ac0017c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad48be6d67071f7da5f6feb7c4fc918f0"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad48be6d67071f7da5f6feb7c4fc918f0">set_initial_condition</a> ()</td></tr>
<tr class="separator:ad48be6d67071f7da5f6feb7c4fc918f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7667864b71a3889c95c29307422ac8e"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac7667864b71a3889c95c29307422ac8e">global_temporal_error_norm</a> ()</td></tr>
<tr class="separator:ac7667864b71a3889c95c29307422ac8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07c5f8686a484837a8856efe3024a52c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a07c5f8686a484837a8856efe3024a52c">newton_solve_continuation</a> (<a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;parameter_pt)</td></tr>
<tr class="separator:a07c5f8686a484837a8856efe3024a52c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b86783463433cc9c4cc382b1b40f0e1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7b86783463433cc9c4cc382b1b40f0e1">newton_solve_continuation</a> (<a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;parameter_pt, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;z)</td></tr>
<tr class="separator:a7b86783463433cc9c4cc382b1b40f0e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83463b9e0d3ebf86085c48c0e98c8f10"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a83463b9e0d3ebf86085c48c0e98c8f10">calculate_continuation_derivatives</a> (<a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;parameter_pt)</td></tr>
<tr class="separator:a83463b9e0d3ebf86085c48c0e98c8f10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a533e7f2876442a1660e675aa225cbbe6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a533e7f2876442a1660e675aa225cbbe6">calculate_continuation_derivatives</a> (const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;z)</td></tr>
<tr class="separator:a533e7f2876442a1660e675aa225cbbe6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8978d65572c5ae81f7381fa6a6d56ba0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a8978d65572c5ae81f7381fa6a6d56ba0">calculate_continuation_derivatives_fd</a> (<a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;parameter_pt)</td></tr>
<tr class="separator:a8978d65572c5ae81f7381fa6a6d56ba0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75fe4a89f7dccbd72a67333b3959539d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a75fe4a89f7dccbd72a67333b3959539d">does_pointer_correspond_to_problem_data</a> (<a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;parameter_pt)</td></tr>
<tr class="separator:a75fe4a89f7dccbd72a67333b3959539d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae78e313f1dc3bc956f42a5d0bd06c459"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae78e313f1dc3bc956f42a5d0bd06c459">set_consistent_pinned_values_for_continuation</a> ()</td></tr>
<tr class="separator:ae78e313f1dc3bc956f42a5d0bd06c459"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:aa2e04de221f29c13067e2fe4cf4c70f9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa2e04de221f29c13067e2fe4cf4c70f9">Copy_of_problem_pt</a></td></tr>
<tr class="separator:aa2e04de221f29c13067e2fe4cf4c70f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae22f10c348ef8afeb1bfd8609cd6a319"><td class="memItemLeft" align="right" valign="top">std::map&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> *, <a class="el" href="../../d9/db9/classbool.html">bool</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae22f10c348ef8afeb1bfd8609cd6a319">Calculate_dparameter_analytic</a></td></tr>
<tr class="separator:ae22f10c348ef8afeb1bfd8609cd6a319"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac353f1325a3b411b30fbc19314cc18ce"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac353f1325a3b411b30fbc19314cc18ce">Calculate_hessian_products_analytic</a></td></tr>
<tr class="separator:ac353f1325a3b411b30fbc19314cc18ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade01b88db08dcec1706fe44eaa0090a3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a></td></tr>
<tr class="separator:ade01b88db08dcec1706fe44eaa0090a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9e4cfff7e1dc295036b0e58bc11ae75"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a></td></tr>
<tr class="memdesc:aa9e4cfff7e1dc295036b0e58bc11ae75"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector of pointers to dofs.  <a href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">More...</a><br /></td></tr>
<tr class="separator:aa9e4cfff7e1dc295036b0e58bc11ae75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4177b73a790b80d541b416d1e83c6c3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html">DoubleVectorWithHaloEntries</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae4177b73a790b80d541b416d1e83c6c3">Element_count_per_dof</a></td></tr>
<tr class="separator:ae4177b73a790b80d541b416d1e83c6c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86c4feb98ec982a08dc84fb664f53abc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a86c4feb98ec982a08dc84fb664f53abc">Relaxation_factor</a></td></tr>
<tr class="separator:a86c4feb98ec982a08dc84fb664f53abc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94536b381e949edf5bb4d44434e08925"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a94536b381e949edf5bb4d44434e08925">Newton_solver_tolerance</a></td></tr>
<tr class="separator:a94536b381e949edf5bb4d44434e08925"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52a58a98c3e2e7dbaefcfb1ee7830c35"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a52a58a98c3e2e7dbaefcfb1ee7830c35">Max_newton_iterations</a></td></tr>
<tr class="memdesc:a52a58a98c3e2e7dbaefcfb1ee7830c35"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum number of Newton iterations.  <a href="../../dc/de5/classoomph_1_1Problem.html#a52a58a98c3e2e7dbaefcfb1ee7830c35">More...</a><br /></td></tr>
<tr class="separator:a52a58a98c3e2e7dbaefcfb1ee7830c35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c05eefd6891808a1ef01e51288e0108"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a3c05eefd6891808a1ef01e51288e0108">Nnewton_iter_taken</a></td></tr>
<tr class="separator:a3c05eefd6891808a1ef01e51288e0108"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6f510bea9bdfcaf229415440a0a1c98"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab6f510bea9bdfcaf229415440a0a1c98">Max_res</a></td></tr>
<tr class="memdesc:ab6f510bea9bdfcaf229415440a0a1c98"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum residuals at start and after each newton iteration.  <a href="../../dc/de5/classoomph_1_1Problem.html#ab6f510bea9bdfcaf229415440a0a1c98">More...</a><br /></td></tr>
<tr class="separator:ab6f510bea9bdfcaf229415440a0a1c98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accb8811cdf32f14be497917e922c623e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accb8811cdf32f14be497917e922c623e">Max_residuals</a></td></tr>
<tr class="separator:accb8811cdf32f14be497917e922c623e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e9aecf88bde320bc2d169b5f3c99fee"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a3e9aecf88bde320bc2d169b5f3c99fee">Time_adaptive_newton_crash_on_solve_fail</a></td></tr>
<tr class="separator:a3e9aecf88bde320bc2d169b5f3c99fee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a022796f2c96f2dff6ed1db2338c93aaf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a022796f2c96f2dff6ed1db2338c93aaf">Jacobian_reuse_is_enabled</a></td></tr>
<tr class="memdesc:a022796f2c96f2dff6ed1db2338c93aaf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Is re-use of Jacobian in Newton iteration enabled? Default: false.  <a href="../../dc/de5/classoomph_1_1Problem.html#a022796f2c96f2dff6ed1db2338c93aaf">More...</a><br /></td></tr>
<tr class="separator:a022796f2c96f2dff6ed1db2338c93aaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c4702c75739c967ed582dbd0a7ba56f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a2c4702c75739c967ed582dbd0a7ba56f">Jacobian_has_been_computed</a></td></tr>
<tr class="separator:a2c4702c75739c967ed582dbd0a7ba56f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade2d3efba34f69aafaefc076ddb3b8d4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ade2d3efba34f69aafaefc076ddb3b8d4">Problem_is_nonlinear</a></td></tr>
<tr class="separator:ade2d3efba34f69aafaefc076ddb3b8d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedefa8337ace6043c2fdfd5a2d19afd3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aedefa8337ace6043c2fdfd5a2d19afd3">Pause_at_end_of_sparse_assembly</a></td></tr>
<tr class="separator:aedefa8337ace6043c2fdfd5a2d19afd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a524b68efcaae084ad7144f944cb39c69"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a524b68efcaae084ad7144f944cb39c69">Doc_time_in_distribute</a></td></tr>
<tr class="separator:a524b68efcaae084ad7144f944cb39c69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a447f9d42b248f6c394581ff1a0b02513"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a447f9d42b248f6c394581ff1a0b02513">Sparse_assembly_method</a></td></tr>
<tr class="separator:a447f9d42b248f6c394581ff1a0b02513"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2d5f8e18619fafcff11727b1c55b3eb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad2d5f8e18619fafcff11727b1c55b3eb">Sparse_assemble_with_arrays_initial_allocation</a></td></tr>
<tr class="separator:ad2d5f8e18619fafcff11727b1c55b3eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb58a3cead4d10697c4471523f705130"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aeb58a3cead4d10697c4471523f705130">Sparse_assemble_with_arrays_allocation_increment</a></td></tr>
<tr class="separator:aeb58a3cead4d10697c4471523f705130"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a547c85bfa6a2eb3effc4db1b46ebcdde"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a547c85bfa6a2eb3effc4db1b46ebcdde">Sparse_assemble_with_arrays_previous_allocation</a></td></tr>
<tr class="separator:a547c85bfa6a2eb3effc4db1b46ebcdde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1a1ffc2bd685377ce7213452876b127"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad1a1ffc2bd685377ce7213452876b127">Numerical_zero_for_sparse_assembly</a></td></tr>
<tr class="separator:ad1a1ffc2bd685377ce7213452876b127"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad26c62f5aab816943144ac61fbf7725e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad26c62f5aab816943144ac61fbf7725e">FD_step_used_in_get_hessian_vector_products</a></td></tr>
<tr class="separator:ad26c62f5aab816943144ac61fbf7725e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4d25809ac090102a4d4a398e4ad0e26"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af4d25809ac090102a4d4a398e4ad0e26">Mass_matrix_reuse_is_enabled</a></td></tr>
<tr class="separator:af4d25809ac090102a4d4a398e4ad0e26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6067c6d344363a073fb8d02a99fb7ed0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6067c6d344363a073fb8d02a99fb7ed0">Mass_matrix_has_been_computed</a></td></tr>
<tr class="separator:a6067c6d344363a073fb8d02a99fb7ed0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97ca0078fff6adca318835c11503dc2d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a97ca0078fff6adca318835c11503dc2d">Discontinuous_element_formulation</a></td></tr>
<tr class="separator:a97ca0078fff6adca318835c11503dc2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7456318933aa01114dc78498bfd6d79"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad7456318933aa01114dc78498bfd6d79">Minimum_dt</a></td></tr>
<tr class="memdesc:ad7456318933aa01114dc78498bfd6d79"><td class="mdescLeft">&#160;</td><td class="mdescRight">Minimum desired dt: if dt falls below this value, exit.  <a href="../../dc/de5/classoomph_1_1Problem.html#ad7456318933aa01114dc78498bfd6d79">More...</a><br /></td></tr>
<tr class="separator:ad7456318933aa01114dc78498bfd6d79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b5fde48b00a7fdc5f1fbbee138d0414"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7b5fde48b00a7fdc5f1fbbee138d0414">Maximum_dt</a></td></tr>
<tr class="memdesc:a7b5fde48b00a7fdc5f1fbbee138d0414"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum desired dt.  <a href="../../dc/de5/classoomph_1_1Problem.html#a7b5fde48b00a7fdc5f1fbbee138d0414">More...</a><br /></td></tr>
<tr class="separator:a7b5fde48b00a7fdc5f1fbbee138d0414"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaaeab9469b342a3b849ee5f2ef7051f3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aaaeab9469b342a3b849ee5f2ef7051f3">DTSF_max_increase</a></td></tr>
<tr class="separator:aaaeab9469b342a3b849ee5f2ef7051f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbb93979ed99d40eb845ba7296355965"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#abbb93979ed99d40eb845ba7296355965">DTSF_min_decrease</a></td></tr>
<tr class="separator:abbb93979ed99d40eb845ba7296355965"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abdee700b2cec37540cf1e7e1462df6c3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#abdee700b2cec37540cf1e7e1462df6c3">Minimum_dt_but_still_proceed</a></td></tr>
<tr class="separator:abdee700b2cec37540cf1e7e1462df6c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a708322baf423e373970384006c2ca4db"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a708322baf423e373970384006c2ca4db">Scale_arc_length</a></td></tr>
<tr class="memdesc:a708322baf423e373970384006c2ca4db"><td class="mdescLeft">&#160;</td><td class="mdescRight">Boolean to control whether arc-length should be scaled.  <a href="../../dc/de5/classoomph_1_1Problem.html#a708322baf423e373970384006c2ca4db">More...</a><br /></td></tr>
<tr class="separator:a708322baf423e373970384006c2ca4db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37fb791188428c8186ffd5c52b6cf576"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a37fb791188428c8186ffd5c52b6cf576">Desired_proportion_of_arc_length</a></td></tr>
<tr class="memdesc:a37fb791188428c8186ffd5c52b6cf576"><td class="mdescLeft">&#160;</td><td class="mdescRight">Proportion of the arc-length to taken by the parameter.  <a href="../../dc/de5/classoomph_1_1Problem.html#a37fb791188428c8186ffd5c52b6cf576">More...</a><br /></td></tr>
<tr class="separator:a37fb791188428c8186ffd5c52b6cf576"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a123843ca2ed6384342939ef2b19477ef"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a123843ca2ed6384342939ef2b19477ef">Theta_squared</a></td></tr>
<tr class="separator:a123843ca2ed6384342939ef2b19477ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca97d61840e46edc914e3cb4b98fd437"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aca97d61840e46edc914e3cb4b98fd437">Sign_of_jacobian</a></td></tr>
<tr class="memdesc:aca97d61840e46edc914e3cb4b98fd437"><td class="mdescLeft">&#160;</td><td class="mdescRight">Storage for the sign of the global Jacobian.  <a href="../../dc/de5/classoomph_1_1Problem.html#aca97d61840e46edc914e3cb4b98fd437">More...</a><br /></td></tr>
<tr class="separator:aca97d61840e46edc914e3cb4b98fd437"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6904003416e9a9257db70c009bdc69ed"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6904003416e9a9257db70c009bdc69ed">Continuation_direction</a></td></tr>
<tr class="separator:a6904003416e9a9257db70c009bdc69ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5082325ca4cafe5a9ec03ef79c67a6f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa5082325ca4cafe5a9ec03ef79c67a6f">Parameter_derivative</a></td></tr>
<tr class="memdesc:aa5082325ca4cafe5a9ec03ef79c67a6f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Storage for the derivative of the global parameter wrt arc-length.  <a href="../../dc/de5/classoomph_1_1Problem.html#aa5082325ca4cafe5a9ec03ef79c67a6f">More...</a><br /></td></tr>
<tr class="separator:aa5082325ca4cafe5a9ec03ef79c67a6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e29673eb80559888d1c6148c4f11e57"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a8e29673eb80559888d1c6148c4f11e57">Parameter_current</a></td></tr>
<tr class="memdesc:a8e29673eb80559888d1c6148c4f11e57"><td class="mdescLeft">&#160;</td><td class="mdescRight">Storage for the present value of the global parameter.  <a href="../../dc/de5/classoomph_1_1Problem.html#a8e29673eb80559888d1c6148c4f11e57">More...</a><br /></td></tr>
<tr class="separator:a8e29673eb80559888d1c6148c4f11e57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbecce0cb1bd7b6b21285568e41ee3eb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#adbecce0cb1bd7b6b21285568e41ee3eb">Use_continuation_timestepper</a></td></tr>
<tr class="memdesc:adbecce0cb1bd7b6b21285568e41ee3eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Boolean to control original or new storage of dof stuff.  <a href="../../dc/de5/classoomph_1_1Problem.html#adbecce0cb1bd7b6b21285568e41ee3eb">More...</a><br /></td></tr>
<tr class="separator:adbecce0cb1bd7b6b21285568e41ee3eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0372f742b90bb402c6edc720ceeb421"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af0372f742b90bb402c6edc720ceeb421">Dof_derivative_offset</a></td></tr>
<tr class="separator:af0372f742b90bb402c6edc720ceeb421"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57825be8c76db9e23e6a9aa0d73973b2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a57825be8c76db9e23e6a9aa0d73973b2">Dof_current_offset</a></td></tr>
<tr class="separator:a57825be8c76db9e23e6a9aa0d73973b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1861321b2d129707935bf1191238daca"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a1861321b2d129707935bf1191238daca">Dof_derivative</a></td></tr>
<tr class="memdesc:a1861321b2d129707935bf1191238daca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Storage for the derivative of the problem variables wrt arc-length.  <a href="../../dc/de5/classoomph_1_1Problem.html#a1861321b2d129707935bf1191238daca">More...</a><br /></td></tr>
<tr class="separator:a1861321b2d129707935bf1191238daca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a366b50c490e9fd3ddafa05b2fbd0b883"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a366b50c490e9fd3ddafa05b2fbd0b883">Dof_current</a></td></tr>
<tr class="memdesc:a366b50c490e9fd3ddafa05b2fbd0b883"><td class="mdescLeft">&#160;</td><td class="mdescRight">Storage for the present values of the variables.  <a href="../../dc/de5/classoomph_1_1Problem.html#a366b50c490e9fd3ddafa05b2fbd0b883">More...</a><br /></td></tr>
<tr class="separator:a366b50c490e9fd3ddafa05b2fbd0b883"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad412d49617d0b0998e5eb440c7a20f3f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad412d49617d0b0998e5eb440c7a20f3f">Ds_current</a></td></tr>
<tr class="memdesc:ad412d49617d0b0998e5eb440c7a20f3f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Storage for the current step value.  <a href="../../dc/de5/classoomph_1_1Problem.html#ad412d49617d0b0998e5eb440c7a20f3f">More...</a><br /></td></tr>
<tr class="separator:ad412d49617d0b0998e5eb440c7a20f3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfe8db162a0bda98add0062a45f41cbf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#abfe8db162a0bda98add0062a45f41cbf">Desired_newton_iterations_ds</a></td></tr>
<tr class="separator:abfe8db162a0bda98add0062a45f41cbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0f8bb126a4f5ddeb559c23a8d451d8d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad0f8bb126a4f5ddeb559c23a8d451d8d">Minimum_ds</a></td></tr>
<tr class="memdesc:ad0f8bb126a4f5ddeb559c23a8d451d8d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Minimum desired value of arc-length.  <a href="../../dc/de5/classoomph_1_1Problem.html#ad0f8bb126a4f5ddeb559c23a8d451d8d">More...</a><br /></td></tr>
<tr class="separator:ad0f8bb126a4f5ddeb559c23a8d451d8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08dfc704030bb65cea3d9784c5271af0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a08dfc704030bb65cea3d9784c5271af0">Bifurcation_detection</a></td></tr>
<tr class="memdesc:a08dfc704030bb65cea3d9784c5271af0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Boolean to control bifurcation detection via determinant of Jacobian.  <a href="../../dc/de5/classoomph_1_1Problem.html#a08dfc704030bb65cea3d9784c5271af0">More...</a><br /></td></tr>
<tr class="separator:a08dfc704030bb65cea3d9784c5271af0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab805e5e5fb94f941cc7ff1b850d83269"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab805e5e5fb94f941cc7ff1b850d83269">Bisect_to_find_bifurcation</a></td></tr>
<tr class="memdesc:ab805e5e5fb94f941cc7ff1b850d83269"><td class="mdescLeft">&#160;</td><td class="mdescRight">Boolean to control wheter bisection is used to located bifurcation.  <a href="../../dc/de5/classoomph_1_1Problem.html#ab805e5e5fb94f941cc7ff1b850d83269">More...</a><br /></td></tr>
<tr class="separator:ab805e5e5fb94f941cc7ff1b850d83269"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a643f61299463a3bbf7be3f6a112aa130"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a643f61299463a3bbf7be3f6a112aa130">First_jacobian_sign_change</a></td></tr>
<tr class="memdesc:a643f61299463a3bbf7be3f6a112aa130"><td class="mdescLeft">&#160;</td><td class="mdescRight">Boolean to indicate whether a sign change has occured in the Jacobian.  <a href="../../dc/de5/classoomph_1_1Problem.html#a643f61299463a3bbf7be3f6a112aa130">More...</a><br /></td></tr>
<tr class="separator:a643f61299463a3bbf7be3f6a112aa130"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8109bf56e9203d248ae30a50bb9cfe90"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a8109bf56e9203d248ae30a50bb9cfe90">Arc_length_step_taken</a></td></tr>
<tr class="memdesc:a8109bf56e9203d248ae30a50bb9cfe90"><td class="mdescLeft">&#160;</td><td class="mdescRight">Boolean to indicate whether an arc-length step has been taken.  <a href="../../dc/de5/classoomph_1_1Problem.html#a8109bf56e9203d248ae30a50bb9cfe90">More...</a><br /></td></tr>
<tr class="separator:a8109bf56e9203d248ae30a50bb9cfe90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80dac9f70c77302805bb782cc6f1ad0f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a80dac9f70c77302805bb782cc6f1ad0f">Use_finite_differences_for_continuation_derivatives</a></td></tr>
<tr class="separator:a80dac9f70c77302805bb782cc6f1ad0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a937afdd0d5a039943482f8be9b24c82e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html">OomphCommunicator</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a></td></tr>
<tr class="memdesc:a937afdd0d5a039943482f8be9b24c82e"><td class="mdescLeft">&#160;</td><td class="mdescRight">The communicator for this problem.  <a href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">More...</a><br /></td></tr>
<tr class="separator:a937afdd0d5a039943482f8be9b24c82e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01d7376ab9cc06e4d5619b34fd39dee2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a01d7376ab9cc06e4d5619b34fd39dee2">Always_take_one_newton_step</a></td></tr>
<tr class="separator:a01d7376ab9cc06e4d5619b34fd39dee2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a359d1936bc2146e0a0ce697776efcf91"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a359d1936bc2146e0a0ce697776efcf91">Timestep_reduction_factor_after_nonconvergence</a></td></tr>
<tr class="separator:a359d1936bc2146e0a0ce697776efcf91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab27af4a444de9f59125ee50ac778d97a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab27af4a444de9f59125ee50ac778d97a">Keep_temporal_error_below_tolerance</a></td></tr>
<tr class="separator:ab27af4a444de9f59125ee50ac778d97a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-static-attribs"></a>
Static Protected Attributes</h2></td></tr>
<tr class="memitem:a4c24860f29d64935db86ce5778c7a794"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d1/daa/classoomph_1_1ContinuationStorageScheme.html">ContinuationStorageScheme</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a4c24860f29d64935db86ce5778c7a794">Continuation_time_stepper</a></td></tr>
<tr class="memdesc:a4c24860f29d64935db86ce5778c7a794"><td class="mdescLeft">&#160;</td><td class="mdescRight">Storage for the single static continuation timestorage object.  <a href="../../dc/de5/classoomph_1_1Problem.html#a4c24860f29d64935db86ce5778c7a794">More...</a><br /></td></tr>
<tr class="separator:a4c24860f29d64935db86ce5778c7a794"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a7c23771b77d6da7cbee3c3e3c050be73"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7c23771b77d6da7cbee3c3e3c050be73">doubly_adaptive_unsteady_newton_solve_helper</a> (const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;dt, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;epsilon, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;max_adapt, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;suppress_resolve_after_spatial_adapt, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;first, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;shift=true)</td></tr>
<tr class="separator:a7c23771b77d6da7cbee3c3e3c050be73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affb22db0c6f1e14ae120b153b85831a3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#affb22db0c6f1e14ae120b153b85831a3">refine_uniformly_aux</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;nrefine_for_mesh, <a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> &amp;doc_info, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;prune)</td></tr>
<tr class="separator:affb22db0c6f1e14ae120b153b85831a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7460f9339fd4850112284a86e039ee00"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7460f9339fd4850112284a86e039ee00">p_refine_uniformly_aux</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;nrefine_for_mesh, <a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> &amp;doc_info, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;prune)</td></tr>
<tr class="separator:a7460f9339fd4850112284a86e039ee00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5f60ebc552c00ee681776bc7fa61203"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab5f60ebc552c00ee681776bc7fa61203">setup_base_mesh_info_after_pruning</a> ()</td></tr>
<tr class="separator:ab5f60ebc552c00ee681776bc7fa61203"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7eb5e0e3dc02fa26eec9d023b80b9603"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7eb5e0e3dc02fa26eec9d023b80b9603">sparse_assemble_row_or_column_compressed_with_vectors_of_pairs</a> (<a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> * &gt; &amp;column_or_row_index, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> * &gt; &amp;row_or_column_start, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> * &gt; &amp;value, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;nnz, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> * &gt; &amp;residual, <a class="el" href="../../d9/db9/classbool.html">bool</a> compressed_row_flag)</td></tr>
<tr class="separator:a7eb5e0e3dc02fa26eec9d023b80b9603"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bc761a0dee39437b2ebeba75079856f"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5bc761a0dee39437b2ebeba75079856f">sparse_assemble_row_or_column_compressed_with_two_vectors</a> (<a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> * &gt; &amp;column_or_row_index, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> * &gt; &amp;row_or_column_start, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> * &gt; &amp;value, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;nnz, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> * &gt; &amp;residual, <a class="el" href="../../d9/db9/classbool.html">bool</a> compressed_row_flag)</td></tr>
<tr class="separator:a5bc761a0dee39437b2ebeba75079856f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ba1b95df63f6e7d746a6dae641daa33"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7ba1b95df63f6e7d746a6dae641daa33">sparse_assemble_row_or_column_compressed_with_maps</a> (<a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> * &gt; &amp;column_or_row_index, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> * &gt; &amp;row_or_column_start, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> * &gt; &amp;value, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;nnz, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> * &gt; &amp;residual, <a class="el" href="../../d9/db9/classbool.html">bool</a> compressed_row_flag)</td></tr>
<tr class="separator:a7ba1b95df63f6e7d746a6dae641daa33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa90e41a626a91ee113989afa847c1117"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa90e41a626a91ee113989afa847c1117">sparse_assemble_row_or_column_compressed_with_lists</a> (<a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> * &gt; &amp;column_or_row_index, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> * &gt; &amp;row_or_column_start, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> * &gt; &amp;value, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;nnz, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> * &gt; &amp;residual, <a class="el" href="../../d9/db9/classbool.html">bool</a> compressed_row_flag)</td></tr>
<tr class="separator:aa90e41a626a91ee113989afa847c1117"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23465a0b1944a4bd31b9e0add9cc9875"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a23465a0b1944a4bd31b9e0add9cc9875">sparse_assemble_row_or_column_compressed_with_two_arrays</a> (<a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> * &gt; &amp;column_or_row_index, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> * &gt; &amp;row_or_column_start, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> * &gt; &amp;value, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;nnz, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> * &gt; &amp;residual, <a class="el" href="../../d9/db9/classbool.html">bool</a> compressed_row_flag)</td></tr>
<tr class="separator:a23465a0b1944a4bd31b9e0add9cc9875"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a420904bddcee85ee817dd9fcad0df216"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a420904bddcee85ee817dd9fcad0df216">calculate_continuation_derivatives_helper</a> (const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;z)</td></tr>
<tr class="separator:a420904bddcee85ee817dd9fcad0df216"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a4dac8d3f4f06020b04a4af0a2d7b32"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7a4dac8d3f4f06020b04a4af0a2d7b32">calculate_continuation_derivatives_fd_helper</a> (<a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;parameter_pt)</td></tr>
<tr class="separator:a7a4dac8d3f4f06020b04a4af0a2d7b32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0b4e7868e02e2d12845c9b2dd60cab9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa0b4e7868e02e2d12845c9b2dd60cab9">bifurcation_adapt_helper</a> (<a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;n_refined, <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;n_unrefined, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;bifurcation_type, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;actually_adapt=true)</td></tr>
<tr class="separator:aa0b4e7868e02e2d12845c9b2dd60cab9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b44e70f6ecabd3ee3401a9febd95275"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a0b44e70f6ecabd3ee3401a9febd95275">bifurcation_adapt_doc_errors</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;bifurcation_type)</td></tr>
<tr class="separator:a0b44e70f6ecabd3ee3401a9febd95275"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a466d6110fd791b17e04a4100312787cd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a466d6110fd791b17e04a4100312787cd">globally_convergent_line_search</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;x_old, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;half_residual_squared_old, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;gradient, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;newton_dir, <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;half_residual_squared, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;stpmax)</td></tr>
<tr class="memdesc:a466d6110fd791b17e04a4100312787cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Line search helper for globally convergent Newton method.  <a href="../../dc/de5/classoomph_1_1Problem.html#a466d6110fd791b17e04a4100312787cd">More...</a><br /></td></tr>
<tr class="separator:a466d6110fd791b17e04a4100312787cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc35de219c1c1032a14840021fd8a6b9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acc35de219c1c1032a14840021fd8a6b9">arc_length_step_solve_helper</a> (<a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;parameter_pt, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;ds, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;max_adapt)</td></tr>
<tr class="separator:acc35de219c1c1032a14840021fd8a6b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:aa4a3bf9419e495aaaaea0dcb00ea53e5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a></td></tr>
<tr class="memdesc:aa4a3bf9419e495aaaaea0dcb00ea53e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">The mesh pointer.  <a href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">More...</a><br /></td></tr>
<tr class="separator:aa4a3bf9419e495aaaaea0dcb00ea53e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab65f6fc9c49860e6324457a7e6e76346"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab65f6fc9c49860e6324457a7e6e76346">Sub_mesh_pt</a></td></tr>
<tr class="memdesc:ab65f6fc9c49860e6324457a7e6e76346"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector of pointers to submeshes.  <a href="../../dc/de5/classoomph_1_1Problem.html#ab65f6fc9c49860e6324457a7e6e76346">More...</a><br /></td></tr>
<tr class="separator:ab65f6fc9c49860e6324457a7e6e76346"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a519de6f6f70c8b0f6bacbde5e0a35cd7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html">LinearSolver</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a></td></tr>
<tr class="memdesc:a519de6f6f70c8b0f6bacbde5e0a35cd7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to the linear solver for the problem.  <a href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">More...</a><br /></td></tr>
<tr class="separator:a519de6f6f70c8b0f6bacbde5e0a35cd7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4b9d15269f624044d1730957b0a8c19"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html">LinearSolver</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad4b9d15269f624044d1730957b0a8c19">Mass_matrix_solver_for_explicit_timestepper_pt</a></td></tr>
<tr class="separator:ad4b9d15269f624044d1730957b0a8c19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7938313fa45df9be16515a6b0bfd324"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/dba/classoomph_1_1EigenSolver.html">EigenSolver</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab7938313fa45df9be16515a6b0bfd324">Eigen_solver_pt</a></td></tr>
<tr class="memdesc:ab7938313fa45df9be16515a6b0bfd324"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to the eigen solver for the problem.  <a href="../../dc/de5/classoomph_1_1Problem.html#ab7938313fa45df9be16515a6b0bfd324">More...</a><br /></td></tr>
<tr class="separator:ab7938313fa45df9be16515a6b0bfd324"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefc325e2e116c389a24c9871e41bdb55"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html">AssemblyHandler</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a></td></tr>
<tr class="separator:aefc325e2e116c389a24c9871e41bdb55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad01b385b2b4cd2e0b867754bea7b798a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html">LinearSolver</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad01b385b2b4cd2e0b867754bea7b798a">Default_linear_solver_pt</a></td></tr>
<tr class="memdesc:ad01b385b2b4cd2e0b867754bea7b798a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to the default linear solver.  <a href="../../dc/de5/classoomph_1_1Problem.html#ad01b385b2b4cd2e0b867754bea7b798a">More...</a><br /></td></tr>
<tr class="separator:ad01b385b2b4cd2e0b867754bea7b798a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39fd6a7e05c02befe9f2a09938a7a7a4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/dba/classoomph_1_1EigenSolver.html">EigenSolver</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a39fd6a7e05c02befe9f2a09938a7a7a4">Default_eigen_solver_pt</a></td></tr>
<tr class="memdesc:a39fd6a7e05c02befe9f2a09938a7a7a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to the default eigensolver.  <a href="../../dc/de5/classoomph_1_1Problem.html#a39fd6a7e05c02befe9f2a09938a7a7a4">More...</a><br /></td></tr>
<tr class="separator:a39fd6a7e05c02befe9f2a09938a7a7a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0cebe288c8daddd9663bd10d8f1caa0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html">AssemblyHandler</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae0cebe288c8daddd9663bd10d8f1caa0">Default_assembly_handler_pt</a></td></tr>
<tr class="memdesc:ae0cebe288c8daddd9663bd10d8f1caa0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to the default assembly handler.  <a href="../../dc/de5/classoomph_1_1Problem.html#ae0cebe288c8daddd9663bd10d8f1caa0">More...</a><br /></td></tr>
<tr class="separator:ae0cebe288c8daddd9663bd10d8f1caa0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae33fbf5f34a7d06d88ad2c98538bbbe8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/da1/classoomph_1_1Time.html">Time</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae33fbf5f34a7d06d88ad2c98538bbbe8">Time_pt</a></td></tr>
<tr class="memdesc:ae33fbf5f34a7d06d88ad2c98538bbbe8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to global time for the problem.  <a href="../../dc/de5/classoomph_1_1Problem.html#ae33fbf5f34a7d06d88ad2c98538bbbe8">More...</a><br /></td></tr>
<tr class="separator:ae33fbf5f34a7d06d88ad2c98538bbbe8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1e8f8a739453250eb3744fea2a3b983"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html">TimeStepper</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af1e8f8a739453250eb3744fea2a3b983">Time_stepper_pt</a></td></tr>
<tr class="separator:af1e8f8a739453250eb3744fea2a3b983"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8466091ea4f5b57033bb3ad24831167"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/d0b/classoomph_1_1ExplicitTimeStepper.html">ExplicitTimeStepper</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af8466091ea4f5b57033bb3ad24831167">Explicit_time_stepper_pt</a></td></tr>
<tr class="memdesc:af8466091ea4f5b57033bb3ad24831167"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to a single explicit timestepper.  <a href="../../dc/de5/classoomph_1_1Problem.html#af8466091ea4f5b57033bb3ad24831167">More...</a><br /></td></tr>
<tr class="separator:af8466091ea4f5b57033bb3ad24831167"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeef791a0158657ca7c298ffcb63ed54e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aeef791a0158657ca7c298ffcb63ed54e">Saved_dof_pt</a></td></tr>
<tr class="memdesc:aeef791a0158657ca7c298ffcb63ed54e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to vector for backup of dofs.  <a href="../../dc/de5/classoomph_1_1Problem.html#aeef791a0158657ca7c298ffcb63ed54e">More...</a><br /></td></tr>
<tr class="separator:aeef791a0158657ca7c298ffcb63ed54e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83df3b5fcc3ebbae951021c8e7f03ef7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a83df3b5fcc3ebbae951021c8e7f03ef7">Default_set_initial_condition_called</a></td></tr>
<tr class="separator:a83df3b5fcc3ebbae951021c8e7f03ef7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf8b1ec937efdf2a0f892a41c18c0c53"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acf8b1ec937efdf2a0f892a41c18c0c53">Use_globally_convergent_newton_method</a></td></tr>
<tr class="memdesc:acf8b1ec937efdf2a0f892a41c18c0c53"><td class="mdescLeft">&#160;</td><td class="mdescRight">Use the globally convergent newton method.  <a href="../../dc/de5/classoomph_1_1Problem.html#acf8b1ec937efdf2a0f892a41c18c0c53">More...</a><br /></td></tr>
<tr class="separator:acf8b1ec937efdf2a0f892a41c18c0c53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f13ea67c29022392857b5c19bb3af71"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5f13ea67c29022392857b5c19bb3af71">Empty_actions_before_read_unstructured_meshes_has_been_called</a></td></tr>
<tr class="separator:a5f13ea67c29022392857b5c19bb3af71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71f87e46a571a54abd27a26f6c701c36"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a71f87e46a571a54abd27a26f6c701c36">Empty_actions_after_read_unstructured_meshes_has_been_called</a></td></tr>
<tr class="separator:a71f87e46a571a54abd27a26f6c701c36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a075696d6f4c4260ce860997c8c931de4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a075696d6f4c4260ce860997c8c931de4">Store_local_dof_pt_in_elements</a></td></tr>
<tr class="separator:a075696d6f4c4260ce860997c8c931de4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe6f5bb841832b3c4d1f06c2d939f4a6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#afe6f5bb841832b3c4d1f06c2d939f4a6">Use_predictor_values_as_initial_guess</a></td></tr>
<tr class="memdesc:afe6f5bb841832b3c4d1f06c2d939f4a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Use values from the time stepper predictor as an initial guess.  <a href="../../dc/de5/classoomph_1_1Problem.html#afe6f5bb841832b3c4d1f06c2d939f4a6">More...</a><br /></td></tr>
<tr class="separator:afe6f5bb841832b3c4d1f06c2d939f4a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa963c98e91d135d31cdcfbe1afa64603"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d8/dc5/classoomph_1_1Data.html">Data</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a></td></tr>
<tr class="separator:aa963c98e91d135d31cdcfbe1afa64603"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a1d79584bd556f960d5b92474681e0159"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a1d79584bd556f960d5b92474681e0159">FoldHandler</a></td></tr>
<tr class="separator:a1d79584bd556f960d5b92474681e0159"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58bcd2e5d47842c64018e2c842bff302"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a58bcd2e5d47842c64018e2c842bff302">PitchForkHandler</a></td></tr>
<tr class="separator:a58bcd2e5d47842c64018e2c842bff302"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5653c9ce9d673e348e945594469ce0d3"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5653c9ce9d673e348e945594469ce0d3">HopfHandler</a></td></tr>
<tr class="separator:a5653c9ce9d673e348e945594469ce0d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cbe986bcd27c28d5de7ada068d3d94c"><td class="memTemplParams" colspan="2">template&lt;unsigned NNODE_1D&gt; </td></tr>
<tr class="memitem:a2cbe986bcd27c28d5de7ada068d3d94c"><td class="memTemplItemLeft" align="right" valign="top">class&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a2cbe986bcd27c28d5de7ada068d3d94c">PeriodicOrbitAssemblyHandler</a></td></tr>
<tr class="separator:a2cbe986bcd27c28d5de7ada068d3d94c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32e190795c94d11d2e206e62eb63994b"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a32e190795c94d11d2e206e62eb63994b">BlockFoldLinearSolver</a></td></tr>
<tr class="separator:a32e190795c94d11d2e206e62eb63994b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba62ac8cc057be07657972adc4a78b45"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aba62ac8cc057be07657972adc4a78b45">BlockPitchForkLinearSolver</a></td></tr>
<tr class="separator:aba62ac8cc057be07657972adc4a78b45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29d9c39e6a14d2a4cc4e0d7c716579fe"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a29d9c39e6a14d2a4cc4e0d7c716579fe">AugmentedBlockFoldLinearSolver</a></td></tr>
<tr class="separator:a29d9c39e6a14d2a4cc4e0d7c716579fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a223dd55e02e905ce0ce98e98f50b7e57"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a223dd55e02e905ce0ce98e98f50b7e57">AugmentedBlockPitchForkLinearSolver</a></td></tr>
<tr class="separator:a223dd55e02e905ce0ce98e98f50b7e57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a199677d64d3b2f908690d10a2398b737"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a199677d64d3b2f908690d10a2398b737">BlockHopfLinearSolver</a></td></tr>
<tr class="separator:a199677d64d3b2f908690d10a2398b737"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>////////////////////////////////////////////////////////////////// ////////////////////////////////////////////////////////////////// ////////////////////////////////////////////////////////////////// The Problem class</p>
<p>The main components of a Problem are:</p><ul>
<li>a pointer to the (global) Mesh (which provides ordered access to the nodes, elements, etc of all submeshes in the problem &ndash; if there are any)</li>
<li>pointers to the submeshes (if there are any)</li>
<li>pointers to any global Data</li>
<li>a pointer to the global Time</li>
<li>pointers to the Timestepper used in the problem</li>
<li>a pointer to the linear solver that will be used in Newton's method</li>
<li>pointers to all DOFs in the problem.</li>
</ul>
<p>Obviously, at this level in the code hierarchy, many things become very problem-dependent but when setting up a specific problem (as a class that inherits from Problem), the problem constructor will/should typically have a structure similar to this: </p><div class="fragment"><div class="line"><span class="comment">// Set up a timestepper</span></div>
<div class="line"> TimeStepper* <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>=<span class="keyword">new</span> <a class="code" href="../../d6/d6d/namespaceProblemParameters.html#af9f52ea15f3842425a76a9c05930806d">Steady</a>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Add timestepper to problem</span></div>
<div class="line"> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a05df1c91c6ccffa24e42fda85af156a1">add_time_stepper_pt</a>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Build and assign mesh</span></div>
<div class="line"> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">Problem::mesh_pt</a>() = <span class="keyword">new</span></div>
<div class="line"> SomeMesh&lt;ELEMENT_TYPE&gt;(Nelement,<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Set the boundary conditions for this problem: All nodes are</span></div>
<div class="line"><span class="comment">// free by default -- just pin the ones that have Dirichlet conditions</span></div>
<div class="line"><span class="comment">// here (boundary 0 in this example)</span></div>
<div class="line"><span class="keywordtype">unsigned</span> i_bound = 0</div>
<div class="line"><span class="keywordtype">unsigned</span> num_nod= <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>()-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a034677ceb48c67769acb83f304c84f7d">nboundary_node</a>(ibound);</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> inod=0;inod&lt;num_nod;inod++)</div>
<div class="line">   {</div>
<div class="line">     <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>()-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#aca0a21f4eab2d6fe8c7fa011b5c33c3c">boundary_node_pt</a>(ibound,inod)-&gt;<a class="code" href="../../d8/dc5/classoomph_1_1Data.html#a422231c58e423f0b43822827aa334d79">pin</a>(0);</div>
<div class="line">   }</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Complete the build of all elements so they are fully functional</span></div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Setup equation numbering scheme</span></div>
<div class="line"> <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt;<span class="stringliteral">&quot;Number of equations: &quot;</span> &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers</a>() &lt;&lt;</div>
<div class="line"> std::endl;</div>
<div class="ttc" id="aclassoomph_1_1Data_html_a422231c58e423f0b43822827aa334d79"><div class="ttname"><a href="../../d8/dc5/classoomph_1_1Data.html#a422231c58e423f0b43822827aa334d79">oomph::Data::pin</a></div><div class="ttdeci">void pin(const unsigned &amp;i)</div><div class="ttdoc">Pin the i-th stored variable.</div><div class="ttdef"><b>Definition:</b> nodes.h:385</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_a034677ceb48c67769acb83f304c84f7d"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#a034677ceb48c67769acb83f304c84f7d">oomph::Mesh::nboundary_node</a></div><div class="ttdeci">unsigned long nboundary_node(const unsigned &amp;ibound) const</div><div class="ttdoc">Return number of nodes on a particular boundary.</div><div class="ttdef"><b>Definition:</b> mesh.h:833</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_aca0a21f4eab2d6fe8c7fa011b5c33c3c"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#aca0a21f4eab2d6fe8c7fa011b5c33c3c">oomph::Mesh::boundary_node_pt</a></div><div class="ttdeci">Node *&amp; boundary_node_pt(const unsigned &amp;b, const unsigned &amp;n)</div><div class="ttdoc">Return pointer to node n on boundary b.</div><div class="ttdef"><b>Definition:</b> mesh.h:493</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a05df1c91c6ccffa24e42fda85af156a1"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a05df1c91c6ccffa24e42fda85af156a1">oomph::Problem::add_time_stepper_pt</a></div><div class="ttdeci">void add_time_stepper_pt(TimeStepper *const &amp;time_stepper_pt)</div><div class="ttdef"><b>Definition:</b> problem.cc:1545</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_aad122d70a22dc5302cfd5853d3cf3057"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">oomph::Problem::mesh_pt</a></div><div class="ttdeci">Mesh *&amp; mesh_pt()</div><div class="ttdoc">Return a pointer to the global mesh.</div><div class="ttdef"><b>Definition:</b> problem.h:1280</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_ad5340769f2b1051a77d443eb05c8f68c"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">oomph::Problem::assign_eqn_numbers</a></div><div class="ttdeci">unsigned long assign_eqn_numbers(const bool &amp;assign_local_eqn_numbers=true)</div><div class="ttdef"><b>Definition:</b> problem.cc:1989</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_ad77413dc70a25d271f582ad3c3d7bf65"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">oomph::Problem::time_stepper_pt</a></div><div class="ttdeci">TimeStepper *&amp; time_stepper_pt()</div><div class="ttdef"><b>Definition:</b> problem.h:1524</div></div>
<div class="ttc" id="anamespaceProblemParameters_html_af9f52ea15f3842425a76a9c05930806d"><div class="ttname"><a href="../../d6/d6d/namespaceProblemParameters.html#af9f52ea15f3842425a76a9c05930806d">ProblemParameters::Steady</a></div><div class="ttdeci">bool Steady</div><div class="ttdoc">Steady flag.</div><div class="ttdef"><b>Definition:</b> unstructured_two_d_curved.cc:48</div></div>
<div class="ttc" id="anamespaceoomph_html_aec474227917784dc0a255faf289cfc16"><div class="ttname"><a href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a></div><div class="ttdeci">OomphInfo oomph_info</div><div class="ttdef"><b>Definition:</b> oomph_definitions.cc:319</div></div>
</div><!-- fragment --><p> For time-dependent problems, we can then use </p><div class="fragment"><div class="line"><a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a7d966c0bfd336699586057e476bd17d5">assign_initial_values_impulsive</a> (); </div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a7d966c0bfd336699586057e476bd17d5"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a7d966c0bfd336699586057e476bd17d5">oomph::Problem::assign_initial_values_impulsive</a></div><div class="ttdeci">void assign_initial_values_impulsive()</div><div class="ttdef"><b>Definition:</b> problem.cc:11499</div></div>
</div><!-- fragment --><p> to generate an initial guess (for an impulsive start) and the problem can then be solved, e.g. using the steady or unsteady Newton solvers </p><div class="fragment"><div class="line"><a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aae8cf62757e432b625ec81fad1559dc3">newton_solve</a>() </div>
<div class="ttc" id="aclassoomph_1_1Problem_html_aae8cf62757e432b625ec81fad1559dc3"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#aae8cf62757e432b625ec81fad1559dc3">oomph::Problem::newton_solve</a></div><div class="ttdeci">void newton_solve()</div><div class="ttdoc">Use Newton method to solve the problem.</div><div class="ttdef"><b>Definition:</b> problem.cc:8783</div></div>
</div><!-- fragment --><p> or </p><div class="fragment"><div class="line"><a class="code" href="../../dc/de5/classoomph_1_1Problem.html#adb4d5d80b18ea103f71c8013e3384766">unsteady_newton_solve</a>(...) </div>
<div class="ttc" id="aclassoomph_1_1Problem_html_adb4d5d80b18ea103f71c8013e3384766"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#adb4d5d80b18ea103f71c8013e3384766">oomph::Problem::unsteady_newton_solve</a></div><div class="ttdeci">void unsteady_newton_solve(const double &amp;dt)</div><div class="ttdef"><b>Definition:</b> problem.cc:10953</div></div>
</div><!-- fragment --> </div><h2 class="groupheader">Member Typedef Documentation</h2>
<a id="a638b525d7cae45e56160e3c282c8ad09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a638b525d7cae45e56160e3c282c8ad09">&#9670;&nbsp;</a></span>SpatialErrorEstimatorFctPt</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* oomph::Problem::SpatialErrorEstimatorFctPt) (<a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *&amp;<a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;elemental_error)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function pointer for spatial error estimator. </p>

</div>
</div>
<a id="a220abfde16b8b1b544b4127e0e4cc9e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a220abfde16b8b1b544b4127e0e4cc9e4">&#9670;&nbsp;</a></span>SpatialErrorEstimatorWithDocFctPt</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* oomph::Problem::SpatialErrorEstimatorWithDocFctPt) (<a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *&amp;<a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;elemental_error, <a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> &amp;doc_info)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function pointer for spatial error estimator with doc. </p>

</div>
</div>
<h2 class="groupheader">Member Enumeration Documentation</h2>
<a id="ac793c004113930938730ec04dd2245b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac793c004113930938730ec04dd2245b7">&#9670;&nbsp;</a></span>Assembly_method</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac793c004113930938730ec04dd2245b7">oomph::Problem::Assembly_method</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Enumerated flags to determine which sparse assembly method is used. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="ac793c004113930938730ec04dd2245b7aa00e1772bb5ccf1c837a2bad2f240241"></a>Perform_assembly_using_vectors_of_pairs&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ac793c004113930938730ec04dd2245b7a6008d2b6aa449ee405313b49632d18ff"></a>Perform_assembly_using_two_vectors&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ac793c004113930938730ec04dd2245b7a406ad24599e1a59450acdd09bac1d717"></a>Perform_assembly_using_maps&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ac793c004113930938730ec04dd2245b7ad73bb55e4e1f000cfd6930cb8b2a52f8"></a>Perform_assembly_using_lists&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ac793c004113930938730ec04dd2245b7a1383f03857ad8602ba7edef43bd947f5"></a>Perform_assembly_using_two_arrays&#160;</td><td class="fielddoc"></td></tr>
</table>
<div class="fragment"><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    {</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ac793c004113930938730ec04dd2245b7aa00e1772bb5ccf1c837a2bad2f240241">Perform_assembly_using_vectors_of_pairs</a>,</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ac793c004113930938730ec04dd2245b7a6008d2b6aa449ee405313b49632d18ff">Perform_assembly_using_two_vectors</a>,</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ac793c004113930938730ec04dd2245b7a406ad24599e1a59450acdd09bac1d717">Perform_assembly_using_maps</a>,</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ac793c004113930938730ec04dd2245b7ad73bb55e4e1f000cfd6930cb8b2a52f8">Perform_assembly_using_lists</a>,</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ac793c004113930938730ec04dd2245b7a1383f03857ad8602ba7edef43bd947f5">Perform_assembly_using_two_arrays</a></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    };</div>
<div class="ttc" id="aclassoomph_1_1Problem_html_ac793c004113930938730ec04dd2245b7a1383f03857ad8602ba7edef43bd947f5"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#ac793c004113930938730ec04dd2245b7a1383f03857ad8602ba7edef43bd947f5">oomph::Problem::Perform_assembly_using_two_arrays</a></div><div class="ttdeci">@ Perform_assembly_using_two_arrays</div><div class="ttdef"><b>Definition:</b> problem.h:650</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_ac793c004113930938730ec04dd2245b7a406ad24599e1a59450acdd09bac1d717"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#ac793c004113930938730ec04dd2245b7a406ad24599e1a59450acdd09bac1d717">oomph::Problem::Perform_assembly_using_maps</a></div><div class="ttdeci">@ Perform_assembly_using_maps</div><div class="ttdef"><b>Definition:</b> problem.h:648</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_ac793c004113930938730ec04dd2245b7a6008d2b6aa449ee405313b49632d18ff"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#ac793c004113930938730ec04dd2245b7a6008d2b6aa449ee405313b49632d18ff">oomph::Problem::Perform_assembly_using_two_vectors</a></div><div class="ttdeci">@ Perform_assembly_using_two_vectors</div><div class="ttdef"><b>Definition:</b> problem.h:647</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_ac793c004113930938730ec04dd2245b7aa00e1772bb5ccf1c837a2bad2f240241"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#ac793c004113930938730ec04dd2245b7aa00e1772bb5ccf1c837a2bad2f240241">oomph::Problem::Perform_assembly_using_vectors_of_pairs</a></div><div class="ttdeci">@ Perform_assembly_using_vectors_of_pairs</div><div class="ttdef"><b>Definition:</b> problem.h:646</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_ac793c004113930938730ec04dd2245b7ad73bb55e4e1f000cfd6930cb8b2a52f8"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#ac793c004113930938730ec04dd2245b7ad73bb55e4e1f000cfd6930cb8b2a52f8">oomph::Problem::Perform_assembly_using_lists</a></div><div class="ttdeci">@ Perform_assembly_using_lists</div><div class="ttdef"><b>Definition:</b> problem.h:649</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ad9d44f0ef936fb62f0ce41dd200494ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9d44f0ef936fb62f0ce41dd200494ac">&#9670;&nbsp;</a></span>Problem() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Problem::Problem </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Constructor: Allocate space for one time stepper and set all pointers to NULL and set defaults for all parameters. </p>
<p>Setup terminate helper</p>
<div class="fragment"><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    : <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>(0),</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae33fbf5f34a7d06d88ad2c98538bbbe8">Time_pt</a>(0),</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#af8466091ea4f5b57033bb3ad24831167">Explicit_time_stepper_pt</a>(0),</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aeef791a0158657ca7c298ffcb63ed54e">Saved_dof_pt</a>(0),</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a83df3b5fcc3ebbae951021c8e7f03ef7">Default_set_initial_condition_called</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#acf8b1ec937efdf2a0f892a41c18c0c53">Use_globally_convergent_newton_method</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a5f13ea67c29022392857b5c19bb3af71">Empty_actions_before_read_unstructured_meshes_has_been_called</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a71f87e46a571a54abd27a26f6c701c36">Empty_actions_after_read_unstructured_meshes_has_been_called</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a075696d6f4c4260ce860997c8c931de4">Store_local_dof_pt_in_elements</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ac353f1325a3b411b30fbc19314cc18ce">Calculate_hessian_products_analytic</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      Doc_imbalance_in_parallel_assembly(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      Use_default_partition_in_load_balance(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      Must_recompute_load_balance_for_assembly(<span class="keyword">true</span>),</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      Halo_scheme_pt(0),</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a86c4feb98ec982a08dc84fb664f53abc">Relaxation_factor</a>(1.0),</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a94536b381e949edf5bb4d44434e08925">Newton_solver_tolerance</a>(1.0e-8),</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a52a58a98c3e2e7dbaefcfb1ee7830c35">Max_newton_iterations</a>(10),</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a3c05eefd6891808a1ef01e51288e0108">Nnewton_iter_taken</a>(0),</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accb8811cdf32f14be497917e922c623e">Max_residuals</a>(10.0),</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a3e9aecf88bde320bc2d169b5f3c99fee">Time_adaptive_newton_crash_on_solve_fail</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a022796f2c96f2dff6ed1db2338c93aaf">Jacobian_reuse_is_enabled</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a2c4702c75739c967ed582dbd0a7ba56f">Jacobian_has_been_computed</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade2d3efba34f69aafaefc076ddb3b8d4">Problem_is_nonlinear</a>(<span class="keyword">true</span>),</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aedefa8337ace6043c2fdfd5a2d19afd3">Pause_at_end_of_sparse_assembly</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a524b68efcaae084ad7144f944cb39c69">Doc_time_in_distribute</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a447f9d42b248f6c394581ff1a0b02513">Sparse_assembly_method</a>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ac793c004113930938730ec04dd2245b7aa00e1772bb5ccf1c837a2bad2f240241">Perform_assembly_using_vectors_of_pairs</a>),</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad2d5f8e18619fafcff11727b1c55b3eb">Sparse_assemble_with_arrays_initial_allocation</a>(400),</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aeb58a3cead4d10697c4471523f705130">Sparse_assemble_with_arrays_allocation_increment</a>(150),</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad1a1ffc2bd685377ce7213452876b127">Numerical_zero_for_sparse_assembly</a>(0.0),</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad26c62f5aab816943144ac61fbf7725e">FD_step_used_in_get_hessian_vector_products</a>(1.0e-8),</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#af4d25809ac090102a4d4a398e4ad0e26">Mass_matrix_reuse_is_enabled</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a6067c6d344363a073fb8d02a99fb7ed0">Mass_matrix_has_been_computed</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a97ca0078fff6adca318835c11503dc2d">Discontinuous_element_formulation</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad7456318933aa01114dc78498bfd6d79">Minimum_dt</a>(1.0e-12),</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a7b5fde48b00a7fdc5f1fbbee138d0414">Maximum_dt</a>(1.0e12),</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aaaeab9469b342a3b849ee5f2ef7051f3">DTSF_max_increase</a>(4.0),</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#abbb93979ed99d40eb845ba7296355965">DTSF_min_decrease</a>(0.8),</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#abdee700b2cec37540cf1e7e1462df6c3">Minimum_dt_but_still_proceed</a>(-1.0),</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a708322baf423e373970384006c2ca4db">Scale_arc_length</a>(<span class="keyword">true</span>),</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a37fb791188428c8186ffd5c52b6cf576">Desired_proportion_of_arc_length</a>(0.5),</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a123843ca2ed6384342939ef2b19477ef">Theta_squared</a>(1.0),</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aca97d61840e46edc914e3cb4b98fd437">Sign_of_jacobian</a>(0),</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a6904003416e9a9257db70c009bdc69ed">Continuation_direction</a>(1.0),</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa5082325ca4cafe5a9ec03ef79c67a6f">Parameter_derivative</a>(1.0),</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a8e29673eb80559888d1c6148c4f11e57">Parameter_current</a>(0.0),</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#adbecce0cb1bd7b6b21285568e41ee3eb">Use_continuation_timestepper</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#af0372f742b90bb402c6edc720ceeb421">Dof_derivative_offset</a>(1),</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a57825be8c76db9e23e6a9aa0d73973b2">Dof_current_offset</a>(2),</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad412d49617d0b0998e5eb440c7a20f3f">Ds_current</a>(0.0),</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#abfe8db162a0bda98add0062a45f41cbf">Desired_newton_iterations_ds</a>(5),</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad0f8bb126a4f5ddeb559c23a8d451d8d">Minimum_ds</a>(1.0e-10),</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a08dfc704030bb65cea3d9784c5271af0">Bifurcation_detection</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab805e5e5fb94f941cc7ff1b850d83269">Bisect_to_find_bifurcation</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a643f61299463a3bbf7be3f6a112aa130">First_jacobian_sign_change</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a8109bf56e9203d248ae30a50bb9cfe90">Arc_length_step_taken</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a80dac9f70c77302805bb782cc6f1ad0f">Use_finite_differences_for_continuation_derivatives</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      Dist_problem_matrix_distribution(Uniform_matrix_distribution),</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      Parallel_sparse_assemble_previous_allocation(0),</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      Problem_has_been_distributed(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      Bypass_increase_in_dof_check_during_pruning(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      Max_permitted_error_for_halo_check(1.0e-14),</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab4a3743c23a2d1eed56981484636c958">Shut_up_in_newton_solve</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a01d7376ab9cc06e4d5619b34fd39dee2">Always_take_one_newton_step</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a359d1936bc2146e0a0ce697776efcf91">Timestep_reduction_factor_after_nonconvergence</a>(0.5),</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab27af4a444de9f59125ee50ac778d97a">Keep_temporal_error_below_tolerance</a>(<span class="keyword">true</span>)</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#afe6f5bb841832b3c4d1f06c2d939f4a6">Use_predictor_values_as_initial_guess</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <a class="code" href="../../d0/dd4/namespaceoomph_1_1TerminateHelper.html#a38ec1b047a4438b6eba8a21b669c229d">TerminateHelper::setup</a>();</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="comment">// By default no submeshes:</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab65f6fc9c49860e6324457a7e6e76346">Sub_mesh_pt</a>.resize(0);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="comment">// No timesteppers</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#af1e8f8a739453250eb3744fea2a3b983">Time_stepper_pt</a>.resize(0);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160; </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="comment">// Set the linear solvers, eigensolver and assembly handler</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a> = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad01b385b2b4cd2e0b867754bea7b798a">Default_linear_solver_pt</a> = <span class="keyword">new</span> SuperLUSolver;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad4b9d15269f624044d1730957b0a8c19">Mass_matrix_solver_for_explicit_timestepper_pt</a> = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a>;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab7938313fa45df9be16515a6b0bfd324">Eigen_solver_pt</a> = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a39fd6a7e05c02befe9f2a09938a7a7a4">Default_eigen_solver_pt</a> = <span class="keyword">new</span> ARPACK;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a> = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae0cebe288c8daddd9663bd10d8f1caa0">Default_assembly_handler_pt</a> = <span class="keyword">new</span> AssemblyHandler;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="comment">// setup the communicator</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../df/d58/classoomph_1_1MPI__Helpers.html#aa376d403f6bc99e8595d227135932b0e">MPI_Helpers::mpi_has_been_initialised</a>())</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a> = <span class="keyword">new</span> OomphCommunicator(<a class="code" href="../../df/d58/classoomph_1_1MPI__Helpers.html#ac16964b22bfd4f657490802beb600ffe">MPI_Helpers::communicator_pt</a>());</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    }</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a> = <span class="keyword">new</span> OomphCommunicator();</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    }</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a> = <span class="keyword">new</span> OomphCommunicator();</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="comment">// just create an empty linear algebra distribution for the</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="comment">// DOFs</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="comment">// this is setup when assign_eqn_numbers(...) is called.</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a> = <span class="keyword">new</span> LinearAlgebraDistribution;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1MPI__Helpers_html_aa376d403f6bc99e8595d227135932b0e"><div class="ttname"><a href="../../df/d58/classoomph_1_1MPI__Helpers.html#aa376d403f6bc99e8595d227135932b0e">oomph::MPI_Helpers::mpi_has_been_initialised</a></div><div class="ttdeci">static bool mpi_has_been_initialised()</div><div class="ttdoc">return true if MPI has been initialised</div><div class="ttdef"><b>Definition:</b> oomph_utilities.h:851</div></div>
<div class="ttc" id="aclassoomph_1_1MPI__Helpers_html_ac16964b22bfd4f657490802beb600ffe"><div class="ttname"><a href="../../df/d58/classoomph_1_1MPI__Helpers.html#ac16964b22bfd4f657490802beb600ffe">oomph::MPI_Helpers::communicator_pt</a></div><div class="ttdeci">static OomphCommunicator * communicator_pt()</div><div class="ttdoc">access to the global oomph-lib communicator</div><div class="ttdef"><b>Definition:</b> oomph_utilities.cc:1046</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a01d7376ab9cc06e4d5619b34fd39dee2"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a01d7376ab9cc06e4d5619b34fd39dee2">oomph::Problem::Always_take_one_newton_step</a></div><div class="ttdeci">bool Always_take_one_newton_step</div><div class="ttdef"><b>Definition:</b> problem.h:2197</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a022796f2c96f2dff6ed1db2338c93aaf"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a022796f2c96f2dff6ed1db2338c93aaf">oomph::Problem::Jacobian_reuse_is_enabled</a></div><div class="ttdeci">bool Jacobian_reuse_is_enabled</div><div class="ttdoc">Is re-use of Jacobian in Newton iteration enabled? Default: false.</div><div class="ttdef"><b>Definition:</b> problem.h:618</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a075696d6f4c4260ce860997c8c931de4"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a075696d6f4c4260ce860997c8c931de4">oomph::Problem::Store_local_dof_pt_in_elements</a></div><div class="ttdeci">bool Store_local_dof_pt_in_elements</div><div class="ttdef"><b>Definition:</b> problem.h:226</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a08dfc704030bb65cea3d9784c5271af0"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a08dfc704030bb65cea3d9784c5271af0">oomph::Problem::Bifurcation_detection</a></div><div class="ttdeci">bool Bifurcation_detection</div><div class="ttdoc">Boolean to control bifurcation detection via determinant of Jacobian.</div><div class="ttdef"><b>Definition:</b> problem.h:790</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a123843ca2ed6384342939ef2b19477ef"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a123843ca2ed6384342939ef2b19477ef">oomph::Problem::Theta_squared</a></div><div class="ttdeci">double Theta_squared</div><div class="ttdef"><b>Definition:</b> problem.h:742</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a2c4702c75739c967ed582dbd0a7ba56f"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a2c4702c75739c967ed582dbd0a7ba56f">oomph::Problem::Jacobian_has_been_computed</a></div><div class="ttdeci">bool Jacobian_has_been_computed</div><div class="ttdef"><b>Definition:</b> problem.h:622</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a359d1936bc2146e0a0ce697776efcf91"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a359d1936bc2146e0a0ce697776efcf91">oomph::Problem::Timestep_reduction_factor_after_nonconvergence</a></div><div class="ttdeci">double Timestep_reduction_factor_after_nonconvergence</div><div class="ttdef"><b>Definition:</b> problem.h:2202</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a37fb791188428c8186ffd5c52b6cf576"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a37fb791188428c8186ffd5c52b6cf576">oomph::Problem::Desired_proportion_of_arc_length</a></div><div class="ttdeci">double Desired_proportion_of_arc_length</div><div class="ttdoc">Proportion of the arc-length to taken by the parameter.</div><div class="ttdef"><b>Definition:</b> problem.h:734</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a39fd6a7e05c02befe9f2a09938a7a7a4"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a39fd6a7e05c02befe9f2a09938a7a7a4">oomph::Problem::Default_eigen_solver_pt</a></div><div class="ttdeci">EigenSolver * Default_eigen_solver_pt</div><div class="ttdoc">Pointer to the default eigensolver.</div><div class="ttdef"><b>Definition:</b> problem.h:191</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a3c05eefd6891808a1ef01e51288e0108"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a3c05eefd6891808a1ef01e51288e0108">oomph::Problem::Nnewton_iter_taken</a></div><div class="ttdeci">unsigned Nnewton_iter_taken</div><div class="ttdef"><b>Definition:</b> problem.h:603</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a3e9aecf88bde320bc2d169b5f3c99fee"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a3e9aecf88bde320bc2d169b5f3c99fee">oomph::Problem::Time_adaptive_newton_crash_on_solve_fail</a></div><div class="ttdeci">bool Time_adaptive_newton_crash_on_solve_fail</div><div class="ttdef"><b>Definition:</b> problem.h:615</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a447f9d42b248f6c394581ff1a0b02513"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a447f9d42b248f6c394581ff1a0b02513">oomph::Problem::Sparse_assembly_method</a></div><div class="ttdeci">unsigned Sparse_assembly_method</div><div class="ttdef"><b>Definition:</b> problem.h:641</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a519de6f6f70c8b0f6bacbde5e0a35cd7"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">oomph::Problem::Linear_solver_pt</a></div><div class="ttdeci">LinearSolver * Linear_solver_pt</div><div class="ttdoc">Pointer to the linear solver for the problem.</div><div class="ttdef"><b>Definition:</b> problem.h:173</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a524b68efcaae084ad7144f944cb39c69"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a524b68efcaae084ad7144f944cb39c69">oomph::Problem::Doc_time_in_distribute</a></div><div class="ttdeci">bool Doc_time_in_distribute</div><div class="ttdef"><b>Definition:</b> problem.h:637</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a52a58a98c3e2e7dbaefcfb1ee7830c35"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a52a58a98c3e2e7dbaefcfb1ee7830c35">oomph::Problem::Max_newton_iterations</a></div><div class="ttdeci">unsigned Max_newton_iterations</div><div class="ttdoc">Maximum number of Newton iterations.</div><div class="ttdef"><b>Definition:</b> problem.h:599</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a57825be8c76db9e23e6a9aa0d73973b2"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a57825be8c76db9e23e6a9aa0d73973b2">oomph::Problem::Dof_current_offset</a></div><div class="ttdeci">unsigned Dof_current_offset</div><div class="ttdef"><b>Definition:</b> problem.h:771</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a5f13ea67c29022392857b5c19bb3af71"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a5f13ea67c29022392857b5c19bb3af71">oomph::Problem::Empty_actions_before_read_unstructured_meshes_has_been_called</a></div><div class="ttdeci">bool Empty_actions_before_read_unstructured_meshes_has_been_called</div><div class="ttdef"><b>Definition:</b> problem.h:218</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a6067c6d344363a073fb8d02a99fb7ed0"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a6067c6d344363a073fb8d02a99fb7ed0">oomph::Problem::Mass_matrix_has_been_computed</a></div><div class="ttdeci">bool Mass_matrix_has_been_computed</div><div class="ttdef"><b>Definition:</b> problem.h:695</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a643f61299463a3bbf7be3f6a112aa130"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a643f61299463a3bbf7be3f6a112aa130">oomph::Problem::First_jacobian_sign_change</a></div><div class="ttdeci">bool First_jacobian_sign_change</div><div class="ttdoc">Boolean to indicate whether a sign change has occured in the Jacobian.</div><div class="ttdef"><b>Definition:</b> problem.h:796</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a6904003416e9a9257db70c009bdc69ed"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a6904003416e9a9257db70c009bdc69ed">oomph::Problem::Continuation_direction</a></div><div class="ttdeci">double Continuation_direction</div><div class="ttdef"><b>Definition:</b> problem.h:749</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a708322baf423e373970384006c2ca4db"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a708322baf423e373970384006c2ca4db">oomph::Problem::Scale_arc_length</a></div><div class="ttdeci">bool Scale_arc_length</div><div class="ttdoc">Boolean to control whether arc-length should be scaled.</div><div class="ttdef"><b>Definition:</b> problem.h:731</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a71f87e46a571a54abd27a26f6c701c36"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a71f87e46a571a54abd27a26f6c701c36">oomph::Problem::Empty_actions_after_read_unstructured_meshes_has_been_called</a></div><div class="ttdeci">bool Empty_actions_after_read_unstructured_meshes_has_been_called</div><div class="ttdef"><b>Definition:</b> problem.h:222</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a7b5fde48b00a7fdc5f1fbbee138d0414"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a7b5fde48b00a7fdc5f1fbbee138d0414">oomph::Problem::Maximum_dt</a></div><div class="ttdeci">double Maximum_dt</div><div class="ttdoc">Maximum desired dt.</div><div class="ttdef"><b>Definition:</b> problem.h:709</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a80dac9f70c77302805bb782cc6f1ad0f"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a80dac9f70c77302805bb782cc6f1ad0f">oomph::Problem::Use_finite_differences_for_continuation_derivatives</a></div><div class="ttdeci">bool Use_finite_differences_for_continuation_derivatives</div><div class="ttdef"><b>Definition:</b> problem.h:803</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a8109bf56e9203d248ae30a50bb9cfe90"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a8109bf56e9203d248ae30a50bb9cfe90">oomph::Problem::Arc_length_step_taken</a></div><div class="ttdeci">bool Arc_length_step_taken</div><div class="ttdoc">Boolean to indicate whether an arc-length step has been taken.</div><div class="ttdef"><b>Definition:</b> problem.h:799</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a83df3b5fcc3ebbae951021c8e7f03ef7"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a83df3b5fcc3ebbae951021c8e7f03ef7">oomph::Problem::Default_set_initial_condition_called</a></div><div class="ttdeci">bool Default_set_initial_condition_called</div><div class="ttdef"><b>Definition:</b> problem.h:211</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a86c4feb98ec982a08dc84fb664f53abc"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a86c4feb98ec982a08dc84fb664f53abc">oomph::Problem::Relaxation_factor</a></div><div class="ttdeci">double Relaxation_factor</div><div class="ttdef"><b>Definition:</b> problem.h:592</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a8e29673eb80559888d1c6148c4f11e57"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a8e29673eb80559888d1c6148c4f11e57">oomph::Problem::Parameter_current</a></div><div class="ttdeci">double Parameter_current</div><div class="ttdoc">Storage for the present value of the global parameter.</div><div class="ttdef"><b>Definition:</b> problem.h:755</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a937afdd0d5a039943482f8be9b24c82e"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">oomph::Problem::Communicator_pt</a></div><div class="ttdeci">OomphCommunicator * Communicator_pt</div><div class="ttdoc">The communicator for this problem.</div><div class="ttdef"><b>Definition:</b> problem.h:1242</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a94536b381e949edf5bb4d44434e08925"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a94536b381e949edf5bb4d44434e08925">oomph::Problem::Newton_solver_tolerance</a></div><div class="ttdeci">double Newton_solver_tolerance</div><div class="ttdef"><b>Definition:</b> problem.h:596</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a97ca0078fff6adca318835c11503dc2d"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a97ca0078fff6adca318835c11503dc2d">oomph::Problem::Discontinuous_element_formulation</a></div><div class="ttdeci">bool Discontinuous_element_formulation</div><div class="ttdef"><b>Definition:</b> problem.h:700</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_aa4a3bf9419e495aaaaea0dcb00ea53e5"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">oomph::Problem::Mesh_pt</a></div><div class="ttdeci">Mesh * Mesh_pt</div><div class="ttdoc">The mesh pointer.</div><div class="ttdef"><b>Definition:</b> problem.h:167</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_aa5082325ca4cafe5a9ec03ef79c67a6f"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#aa5082325ca4cafe5a9ec03ef79c67a6f">oomph::Problem::Parameter_derivative</a></div><div class="ttdeci">double Parameter_derivative</div><div class="ttdoc">Storage for the derivative of the global parameter wrt arc-length.</div><div class="ttdef"><b>Definition:</b> problem.h:752</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_aaaeab9469b342a3b849ee5f2ef7051f3"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#aaaeab9469b342a3b849ee5f2ef7051f3">oomph::Problem::DTSF_max_increase</a></div><div class="ttdeci">double DTSF_max_increase</div><div class="ttdef"><b>Definition:</b> problem.h:713</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_ab27af4a444de9f59125ee50ac778d97a"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#ab27af4a444de9f59125ee50ac778d97a">oomph::Problem::Keep_temporal_error_below_tolerance</a></div><div class="ttdeci">bool Keep_temporal_error_below_tolerance</div><div class="ttdef"><b>Definition:</b> problem.h:2209</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_ab4a3743c23a2d1eed56981484636c958"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#ab4a3743c23a2d1eed56981484636c958">oomph::Problem::Shut_up_in_newton_solve</a></div><div class="ttdeci">bool Shut_up_in_newton_solve</div><div class="ttdef"><b>Definition:</b> problem.h:2191</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_ab65f6fc9c49860e6324457a7e6e76346"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#ab65f6fc9c49860e6324457a7e6e76346">oomph::Problem::Sub_mesh_pt</a></div><div class="ttdeci">Vector&lt; Mesh * &gt; Sub_mesh_pt</div><div class="ttdoc">Vector of pointers to submeshes.</div><div class="ttdef"><b>Definition:</b> problem.h:170</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_ab7938313fa45df9be16515a6b0bfd324"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#ab7938313fa45df9be16515a6b0bfd324">oomph::Problem::Eigen_solver_pt</a></div><div class="ttdeci">EigenSolver * Eigen_solver_pt</div><div class="ttdoc">Pointer to the eigen solver for the problem.</div><div class="ttdef"><b>Definition:</b> problem.h:182</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_ab805e5e5fb94f941cc7ff1b850d83269"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#ab805e5e5fb94f941cc7ff1b850d83269">oomph::Problem::Bisect_to_find_bifurcation</a></div><div class="ttdeci">bool Bisect_to_find_bifurcation</div><div class="ttdoc">Boolean to control wheter bisection is used to located bifurcation.</div><div class="ttdef"><b>Definition:</b> problem.h:793</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_abbb93979ed99d40eb845ba7296355965"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#abbb93979ed99d40eb845ba7296355965">oomph::Problem::DTSF_min_decrease</a></div><div class="ttdeci">double DTSF_min_decrease</div><div class="ttdef"><b>Definition:</b> problem.h:718</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_abdee700b2cec37540cf1e7e1462df6c3"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#abdee700b2cec37540cf1e7e1462df6c3">oomph::Problem::Minimum_dt_but_still_proceed</a></div><div class="ttdeci">double Minimum_dt_but_still_proceed</div><div class="ttdef"><b>Definition:</b> problem.h:725</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_abfe8db162a0bda98add0062a45f41cbf"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#abfe8db162a0bda98add0062a45f41cbf">oomph::Problem::Desired_newton_iterations_ds</a></div><div class="ttdeci">unsigned Desired_newton_iterations_ds</div><div class="ttdef"><b>Definition:</b> problem.h:784</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_ac353f1325a3b411b30fbc19314cc18ce"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#ac353f1325a3b411b30fbc19314cc18ce">oomph::Problem::Calculate_hessian_products_analytic</a></div><div class="ttdeci">bool Calculate_hessian_products_analytic</div><div class="ttdef"><b>Definition:</b> problem.h:244</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_aca97d61840e46edc914e3cb4b98fd437"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#aca97d61840e46edc914e3cb4b98fd437">oomph::Problem::Sign_of_jacobian</a></div><div class="ttdeci">int Sign_of_jacobian</div><div class="ttdoc">Storage for the sign of the global Jacobian.</div><div class="ttdef"><b>Definition:</b> problem.h:745</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_accb8811cdf32f14be497917e922c623e"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#accb8811cdf32f14be497917e922c623e">oomph::Problem::Max_residuals</a></div><div class="ttdeci">double Max_residuals</div><div class="ttdef"><b>Definition:</b> problem.h:610</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_acf8b1ec937efdf2a0f892a41c18c0c53"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#acf8b1ec937efdf2a0f892a41c18c0c53">oomph::Problem::Use_globally_convergent_newton_method</a></div><div class="ttdeci">bool Use_globally_convergent_newton_method</div><div class="ttdoc">Use the globally convergent newton method.</div><div class="ttdef"><b>Definition:</b> problem.h:214</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_ad01b385b2b4cd2e0b867754bea7b798a"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#ad01b385b2b4cd2e0b867754bea7b798a">oomph::Problem::Default_linear_solver_pt</a></div><div class="ttdeci">LinearSolver * Default_linear_solver_pt</div><div class="ttdoc">Pointer to the default linear solver.</div><div class="ttdef"><b>Definition:</b> problem.h:188</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_ad0f8bb126a4f5ddeb559c23a8d451d8d"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#ad0f8bb126a4f5ddeb559c23a8d451d8d">oomph::Problem::Minimum_ds</a></div><div class="ttdeci">double Minimum_ds</div><div class="ttdoc">Minimum desired value of arc-length.</div><div class="ttdef"><b>Definition:</b> problem.h:787</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_ad1a1ffc2bd685377ce7213452876b127"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#ad1a1ffc2bd685377ce7213452876b127">oomph::Problem::Numerical_zero_for_sparse_assembly</a></div><div class="ttdeci">double Numerical_zero_for_sparse_assembly</div><div class="ttdef"><b>Definition:</b> problem.h:671</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_ad26c62f5aab816943144ac61fbf7725e"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#ad26c62f5aab816943144ac61fbf7725e">oomph::Problem::FD_step_used_in_get_hessian_vector_products</a></div><div class="ttdeci">double FD_step_used_in_get_hessian_vector_products</div><div class="ttdef"><b>Definition:</b> problem.h:685</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_ad2d5f8e18619fafcff11727b1c55b3eb"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#ad2d5f8e18619fafcff11727b1c55b3eb">oomph::Problem::Sparse_assemble_with_arrays_initial_allocation</a></div><div class="ttdeci">unsigned Sparse_assemble_with_arrays_initial_allocation</div><div class="ttdef"><b>Definition:</b> problem.h:658</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_ad412d49617d0b0998e5eb440c7a20f3f"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#ad412d49617d0b0998e5eb440c7a20f3f">oomph::Problem::Ds_current</a></div><div class="ttdeci">double Ds_current</div><div class="ttdoc">Storage for the current step value.</div><div class="ttdef"><b>Definition:</b> problem.h:780</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_ad4b9d15269f624044d1730957b0a8c19"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#ad4b9d15269f624044d1730957b0a8c19">oomph::Problem::Mass_matrix_solver_for_explicit_timestepper_pt</a></div><div class="ttdeci">LinearSolver * Mass_matrix_solver_for_explicit_timestepper_pt</div><div class="ttdef"><b>Definition:</b> problem.h:179</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_ad7456318933aa01114dc78498bfd6d79"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#ad7456318933aa01114dc78498bfd6d79">oomph::Problem::Minimum_dt</a></div><div class="ttdeci">double Minimum_dt</div><div class="ttdoc">Minimum desired dt: if dt falls below this value, exit.</div><div class="ttdef"><b>Definition:</b> problem.h:706</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_adbecce0cb1bd7b6b21285568e41ee3eb"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#adbecce0cb1bd7b6b21285568e41ee3eb">oomph::Problem::Use_continuation_timestepper</a></div><div class="ttdeci">bool Use_continuation_timestepper</div><div class="ttdoc">Boolean to control original or new storage of dof stuff.</div><div class="ttdef"><b>Definition:</b> problem.h:758</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_ade01b88db08dcec1706fe44eaa0090a3"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">oomph::Problem::Dof_distribution_pt</a></div><div class="ttdeci">LinearAlgebraDistribution * Dof_distribution_pt</div><div class="ttdef"><b>Definition:</b> problem.h:460</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_ade2d3efba34f69aafaefc076ddb3b8d4"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#ade2d3efba34f69aafaefc076ddb3b8d4">oomph::Problem::Problem_is_nonlinear</a></div><div class="ttdeci">bool Problem_is_nonlinear</div><div class="ttdef"><b>Definition:</b> problem.h:628</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_ae0cebe288c8daddd9663bd10d8f1caa0"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#ae0cebe288c8daddd9663bd10d8f1caa0">oomph::Problem::Default_assembly_handler_pt</a></div><div class="ttdeci">AssemblyHandler * Default_assembly_handler_pt</div><div class="ttdoc">Pointer to the default assembly handler.</div><div class="ttdef"><b>Definition:</b> problem.h:194</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_ae33fbf5f34a7d06d88ad2c98538bbbe8"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#ae33fbf5f34a7d06d88ad2c98538bbbe8">oomph::Problem::Time_pt</a></div><div class="ttdeci">Time * Time_pt</div><div class="ttdoc">Pointer to global time for the problem.</div><div class="ttdef"><b>Definition:</b> problem.h:197</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_aeb58a3cead4d10697c4471523f705130"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#aeb58a3cead4d10697c4471523f705130">oomph::Problem::Sparse_assemble_with_arrays_allocation_increment</a></div><div class="ttdeci">unsigned Sparse_assemble_with_arrays_allocation_increment</div><div class="ttdef"><b>Definition:</b> problem.h:663</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_aedefa8337ace6043c2fdfd5a2d19afd3"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#aedefa8337ace6043c2fdfd5a2d19afd3">oomph::Problem::Pause_at_end_of_sparse_assembly</a></div><div class="ttdeci">bool Pause_at_end_of_sparse_assembly</div><div class="ttdef"><b>Definition:</b> problem.h:633</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_aeef791a0158657ca7c298ffcb63ed54e"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#aeef791a0158657ca7c298ffcb63ed54e">oomph::Problem::Saved_dof_pt</a></div><div class="ttdeci">Vector&lt; double &gt; * Saved_dof_pt</div><div class="ttdoc">Pointer to vector for backup of dofs.</div><div class="ttdef"><b>Definition:</b> problem.h:207</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_aefc325e2e116c389a24c9871e41bdb55"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">oomph::Problem::Assembly_handler_pt</a></div><div class="ttdeci">AssemblyHandler * Assembly_handler_pt</div><div class="ttdef"><b>Definition:</b> problem.h:185</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_af0372f742b90bb402c6edc720ceeb421"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#af0372f742b90bb402c6edc720ceeb421">oomph::Problem::Dof_derivative_offset</a></div><div class="ttdeci">unsigned Dof_derivative_offset</div><div class="ttdef"><b>Definition:</b> problem.h:766</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_af1e8f8a739453250eb3744fea2a3b983"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#af1e8f8a739453250eb3744fea2a3b983">oomph::Problem::Time_stepper_pt</a></div><div class="ttdeci">Vector&lt; TimeStepper * &gt; Time_stepper_pt</div><div class="ttdef"><b>Definition:</b> problem.h:201</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_af4d25809ac090102a4d4a398e4ad0e26"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#af4d25809ac090102a4d4a398e4ad0e26">oomph::Problem::Mass_matrix_reuse_is_enabled</a></div><div class="ttdeci">bool Mass_matrix_reuse_is_enabled</div><div class="ttdef"><b>Definition:</b> problem.h:691</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_af8466091ea4f5b57033bb3ad24831167"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#af8466091ea4f5b57033bb3ad24831167">oomph::Problem::Explicit_time_stepper_pt</a></div><div class="ttdeci">ExplicitTimeStepper * Explicit_time_stepper_pt</div><div class="ttdoc">Pointer to a single explicit timestepper.</div><div class="ttdef"><b>Definition:</b> problem.h:204</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_afe6f5bb841832b3c4d1f06c2d939f4a6"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#afe6f5bb841832b3c4d1f06c2d939f4a6">oomph::Problem::Use_predictor_values_as_initial_guess</a></div><div class="ttdeci">bool Use_predictor_values_as_initial_guess</div><div class="ttdoc">Use values from the time stepper predictor as an initial guess.</div><div class="ttdef"><b>Definition:</b> problem.h:229</div></div>
<div class="ttc" id="anamespaceoomph_1_1TerminateHelper_html_a38ec1b047a4438b6eba8a21b669c229d"><div class="ttname"><a href="../../d0/dd4/namespaceoomph_1_1TerminateHelper.html#a38ec1b047a4438b6eba8a21b669c229d">oomph::TerminateHelper::setup</a></div><div class="ttdeci">void setup()</div><div class="ttdoc">Setup terminate helper.</div><div class="ttdef"><b>Definition:</b> oomph_definitions.cc:63</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>, <a class="el" href="../../df/d58/classoomph_1_1MPI__Helpers.html#ac16964b22bfd4f657490802beb600ffe">oomph::MPI_Helpers::communicator_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae0cebe288c8daddd9663bd10d8f1caa0">Default_assembly_handler_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a39fd6a7e05c02befe9f2a09938a7a7a4">Default_eigen_solver_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad01b385b2b4cd2e0b867754bea7b798a">Default_linear_solver_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab7938313fa45df9be16515a6b0bfd324">Eigen_solver_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad4b9d15269f624044d1730957b0a8c19">Mass_matrix_solver_for_explicit_timestepper_pt</a>, <a class="el" href="../../df/d58/classoomph_1_1MPI__Helpers.html#aa376d403f6bc99e8595d227135932b0e">oomph::MPI_Helpers::mpi_has_been_initialised()</a>, <a class="el" href="../../d0/dd4/namespaceoomph_1_1TerminateHelper.html#a38ec1b047a4438b6eba8a21b669c229d">oomph::TerminateHelper::setup()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab65f6fc9c49860e6324457a7e6e76346">Sub_mesh_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af1e8f8a739453250eb3744fea2a3b983">Time_stepper_pt</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#afe6f5bb841832b3c4d1f06c2d939f4a6">Use_predictor_values_as_initial_guess</a>.</p>

</div>
</div>
<a id="a32f06ae01ba0bf2e827ccd9045c40183"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a32f06ae01ba0bf2e827ccd9045c40183">&#9670;&nbsp;</a></span>Problem() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">oomph::Problem::Problem </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> &amp;&#160;</td>
          <td class="paramname"><em>dummy</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Broken copy constructor. </p>

</div>
</div>
<a id="a839a525ed01c34d57fff42583003d3e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a839a525ed01c34d57fff42583003d3e7">&#9670;&nbsp;</a></span>~Problem()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Problem::~Problem </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Virtual destructor to clean up memory. </p>
<p>Destructor to clean up memory. </p>
<div class="fragment"><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="comment">// Delete the memory assigned for the global time</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="comment">// (it&#39;s created on the fly in Problem::add_time_stepper_pt()</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="comment">// so we are entitled to delete it.</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae33fbf5f34a7d06d88ad2c98538bbbe8">Time_pt</a> != 0)</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    {</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="keyword">delete</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae33fbf5f34a7d06d88ad2c98538bbbe8">Time_pt</a>;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae33fbf5f34a7d06d88ad2c98538bbbe8">Time_pt</a> = 0;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    }</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="comment">// We&#39;re not using the default linear solver,</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="comment">// somebody else must have built it, so that person</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="comment">// must be in charge of killing it.</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="comment">// We can safely delete the defaults, however</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keyword">delete</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad01b385b2b4cd2e0b867754bea7b798a">Default_linear_solver_pt</a>;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keyword">delete</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a39fd6a7e05c02befe9f2a09938a7a7a4">Default_eigen_solver_pt</a>;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keyword">delete</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae0cebe288c8daddd9663bd10d8f1caa0">Default_assembly_handler_pt</a>;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keyword">delete</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keyword">delete</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="comment">// Delete any copies of the problem that have been created for</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="comment">// use in adaptive bifurcation tracking.</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="comment">// ALH: This will eventually go</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordtype">unsigned</span> n_copies = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa2e04de221f29c13067e2fe4cf4c70f9">Copy_of_problem_pt</a>.size();</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a> = 0; <a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a> &lt; n_copies; <a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>++)</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      <span class="keyword">delete</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa2e04de221f29c13067e2fe4cf4c70f9">Copy_of_problem_pt</a>[<a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>];</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    }</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="comment">// if this problem has sub meshes then we must delete the Mesh_pt</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab65f6fc9c49860e6324457a7e6e76346">Sub_mesh_pt</a>.size() != 0)</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a38446e721be2f75a64fdaa025b7c23ad">flush_element_and_node_storage</a>();</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      <span class="keyword">delete</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    }</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="comment">// Since we called the TerminateHelper setup function in the constructor,</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="comment">// we need to delete anything that was dynamically allocated (as it&#39;s</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="comment">// just a namespace and so doesn&#39;t have it&#39;s own destructor) in the function</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <a class="code" href="../../d0/dd4/namespaceoomph_1_1TerminateHelper.html#a20615123e22554c3c485484f4c23bfb5">TerminateHelper::clean_up_memory</a>();</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_a38446e721be2f75a64fdaa025b7c23ad"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#a38446e721be2f75a64fdaa025b7c23ad">oomph::Mesh::flush_element_and_node_storage</a></div><div class="ttdeci">void flush_element_and_node_storage()</div><div class="ttdef"><b>Definition:</b> mesh.h:407</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_aa2e04de221f29c13067e2fe4cf4c70f9"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#aa2e04de221f29c13067e2fe4cf4c70f9">oomph::Problem::Copy_of_problem_pt</a></div><div class="ttdeci">Vector&lt; Problem * &gt; Copy_of_problem_pt</div><div class="ttdef"><b>Definition:</b> problem.h:234</div></div>
<div class="ttc" id="anamespacecalibrate_html_a1919e193275bfcb62d1e5b79a3aea213"><div class="ttname"><a href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">calibrate.c</a></div><div class="ttdeci">int c</div><div class="ttdef"><b>Definition:</b> calibrate.py:100</div></div>
<div class="ttc" id="anamespaceoomph_1_1TerminateHelper_html_a20615123e22554c3c485484f4c23bfb5"><div class="ttname"><a href="../../d0/dd4/namespaceoomph_1_1TerminateHelper.html#a20615123e22554c3c485484f4c23bfb5">oomph::TerminateHelper::clean_up_memory</a></div><div class="ttdeci">void clean_up_memory()</div><div class="ttdef"><b>Definition:</b> oomph_definitions.cc:86</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">calibrate::c</a>, <a class="el" href="../../d0/dd4/namespaceoomph_1_1TerminateHelper.html#a20615123e22554c3c485484f4c23bfb5">oomph::TerminateHelper::clean_up_memory()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa2e04de221f29c13067e2fe4cf4c70f9">Copy_of_problem_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae0cebe288c8daddd9663bd10d8f1caa0">Default_assembly_handler_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a39fd6a7e05c02befe9f2a09938a7a7a4">Default_eigen_solver_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad01b385b2b4cd2e0b867754bea7b798a">Default_linear_solver_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a38446e721be2f75a64fdaa025b7c23ad">oomph::Mesh::flush_element_and_node_storage()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab65f6fc9c49860e6324457a7e6e76346">Sub_mesh_pt</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae33fbf5f34a7d06d88ad2c98538bbbe8">Time_pt</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ada40ec6730506c01109622c8383fe36e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada40ec6730506c01109622c8383fe36e">&#9670;&nbsp;</a></span>actions_after_adapt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void oomph::Problem::actions_after_adapt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Actions that are to be performed after a mesh adaptation. </p>

<p>Reimplemented in <a class="el" href="../../d9/d9c/classMortaringValidationProblem.html#a2667dc7f210603233e33a0a48c8fe174">MortaringValidationProblem&lt; ELEMENT, NON_MORTAR_ELEMENT &gt;</a>, <a class="el" href="../../d9/d9c/classMortaringValidationProblem.html#a2667dc7f210603233e33a0a48c8fe174">MortaringValidationProblem&lt; ELEMENT, NON_MORTAR_ELEMENT &gt;</a>, <a class="el" href="../../de/d3f/classDrivenCavityProblem.html#a7807ee4e4454a5b2fca23e99b7817b2d">DrivenCavityProblem&lt; ELEMENT, MESH &gt;</a>, <a class="el" href="../../dd/de5/classRefineableDrivenCavityProblem.html#ad0dd51a90826a15f83edc2d222102852">RefineableDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/dcf/classUnstructuredPoissonProblem.html#a6f3e089824cfbb4f458efd8c8ffd376d">UnstructuredPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/de5/classRefineableDrivenCavityProblem.html#ad0dd51a90826a15f83edc2d222102852">RefineableDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d4a/classRefineableYoungLaplaceProblem.html#aa2eab8da1b83091df804ede7c60fac87">RefineableYoungLaplaceProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d4a/classRefineableYoungLaplaceProblem.html#aa2eab8da1b83091df804ede7c60fac87">RefineableYoungLaplaceProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d8c/classCollapsibleChannelProblem.html#a3ea01d83f0256c588a652741c6c33e0e">CollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d68/classRefineableUnsteadyHeatProblem.html#a1f8a9e91269440c799a2075f989d62b1">RefineableUnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d68/classRefineableUnsteadyHeatProblem.html#a1f8a9e91269440c799a2075f989d62b1">RefineableUnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d68/classRefineableUnsteadyHeatProblem.html#a1f8a9e91269440c799a2075f989d62b1">RefineableUnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d28/classUnsteadyHeatProblem.html#a975ec6de594212b0767ee2fcc4fa1913">UnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d28/classUnsteadyHeatProblem.html#a975ec6de594212b0767ee2fcc4fa1913">UnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d28/classUnsteadyHeatProblem.html#a975ec6de594212b0767ee2fcc4fa1913">UnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/d2c/classRingWithTRibProblem.html#a8749aaf1e46d802c210b51e07093505b">RingWithTRibProblem&lt; ELASTICITY_ELEMENT &gt;</a>, <a class="el" href="../../d8/d28/classAnnularDiskProblem.html#a491ee3537f3b08d9a10942c4744d8d2b">AnnularDiskProblem&lt; ELASTICITY_ELEMENT &gt;</a>, <a class="el" href="../../d6/d48/classFourierDecomposedTimeHarmonicLinearElasticityProblem.html#a5b9d18ea43b802e8a2b1f3b50140054b">FourierDecomposedTimeHarmonicLinearElasticityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d6/d48/classFourierDecomposedTimeHarmonicLinearElasticityProblem.html#a5b9d18ea43b802e8a2b1f3b50140054b">FourierDecomposedTimeHarmonicLinearElasticityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d2/da3/classSphericalSpinUpProblem.html#ae1bee5a918138c0a6733e0880f267561">SphericalSpinUpProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d6/df1/classRefineableSphericalSpinUpProblem.html#ac911035672b28d4a75d5296a43ebccbb">RefineableSphericalSpinUpProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d6/df1/classRefineableSphericalSpinUpProblem.html#ac911035672b28d4a75d5296a43ebccbb">RefineableSphericalSpinUpProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d46/classRefineableSphericalCouetteProblem.html#aba28b3df6a7779fc899bd9c5ea54632d">RefineableSphericalCouetteProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dc/dff/classUnstructuredSolidProblem.html#a1c25e6828b6b36fb9e04158bef3c2ee5">UnstructuredSolidProblem&lt; ELEMENT, MESH &gt;</a>, <a class="el" href="../../d5/d7a/classBlockCompressionProblem.html#a73a673ee39b3ee01844737f546232ba7">BlockCompressionProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d27/classPrescribedBoundaryDisplacementProblem.html#aae7225db18ad5c8429c0eb96fa37b585">PrescribedBoundaryDisplacementProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/d16/classCantileverProblem.html#af4d135ace3eac657b38de362e1644c75">CantileverProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d0a/classElasticFishProblem.html#ae54b974caafe717309ce7abc5e7f824d">ElasticFishProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dc/dfb/classSimpleShearProblem.html#a9b493680096cdbccb0cfa18b35787165">SimpleShearProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/d9b/classDiskShockWaveProblem.html#ac2a22a8399355e461d1a9ad1e5425c9a">DiskShockWaveProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d1/d8c/classCollapsibleChannelProblem.html#a3ea01d83f0256c588a652741c6c33e0e">CollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d27/classPrescribedBoundaryDisplacementProblem.html#aae7225db18ad5c8429c0eb96fa37b585">PrescribedBoundaryDisplacementProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d27/classPrescribedBoundaryDisplacementProblem.html#aae7225db18ad5c8429c0eb96fa37b585">PrescribedBoundaryDisplacementProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d27/classPrescribedBoundaryDisplacementProblem.html#aae7225db18ad5c8429c0eb96fa37b585">PrescribedBoundaryDisplacementProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/d16/classCantileverProblem.html#af4d135ace3eac657b38de362e1644c75">CantileverProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/d16/classCantileverProblem.html#af4d135ace3eac657b38de362e1644c75">CantileverProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d5/d48/classRefineableActivatorInhibitorProblem.html#a37a4c173ebf9dc724e3cb8e4971e7716">RefineableActivatorInhibitorProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d6f/classoomph_1_1StreamfunctionProblem.html#aa6322ca3bb39fd5166963c4bd8b6a891">oomph::StreamfunctionProblem</a>, <a class="el" href="../../d2/d5a/classPolarNSProblem.html#ae619ad778d0f042db5bb1124905e4944">PolarNSProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d43/classRefineableTwoMeshFluxPoissonProblem.html#a0140155529861f5e63ab32feece3c9b6">RefineableTwoMeshFluxPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/de1/classEighthSpherePoissonProblem.html#a2a40dd021fd90e40c0bf64cd62d7d512">EighthSpherePoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/de5/classElasticAnnulusProblem.html#aa47beeedeac662b19c0f992daf77ef25">ElasticAnnulusProblem&lt; ELASTICITY_ELEMENT &gt;</a>, <a class="el" href="../../df/de5/classElasticAnnulusProblem.html#aa47beeedeac662b19c0f992daf77ef25">ElasticAnnulusProblem&lt; ELASTICITY_ELEMENT &gt;</a>, <a class="el" href="../../d4/d68/classRefineableUnsteadyHeatProblem.html#a1f8a9e91269440c799a2075f989d62b1">RefineableUnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d6/da9/classRayleighProblem.html#aae9b7e814b2a8563b191ec3ff3fc28b2">RayleighProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d3/d26/classVorticityRecoveryProblem.html#a948108fd9061fd237b09cc44dab71935">VorticityRecoveryProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/dee/classDropInChannelProblem.html#af5cc96bc60c2fd2386d16eac3ee5f83a">DropInChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../da/def/classBubbleInChannelProblem.html#a67d2650bfca3775800784379938a35bc">BubbleInChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d5/d3c/classUnstructuredFluidProblem.html#a5f09afe0b2b1716bb0668859fa432c89">UnstructuredFluidProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/deb/classRisingBubbleProblem.html#a45a99743ddbcf614bceba669aa7cc18e">RisingBubbleProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d6a/classFallingBlockProblem.html#a55d20df0e89e104608ea6200c9707f6b">FallingBlockProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d3/d70/classTwoLayerInterfaceProblem.html#a496c283472765b000a0348137c1b560b">TwoLayerInterfaceProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d15/classInterfaceProblem.html#a1c8a5dee970dccc3f1da993cf531872d">InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d7/dcc/classTurekNonFSIProblem.html#a88ed5ef8b1be34f5176c29ffec20eedd">TurekNonFSIProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../db/d31/classEntryFlowProblem.html#ae472a4319c372d33ee22dac8fb32d9a2">EntryFlowProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d90/classSteadyTubeProblem.html#ae598a2a0ec9bbfb563a1c78aa159561f">SteadyTubeProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../de/da5/classFpTestProblem.html#abec14e85d19cbcb2909f405d171e8613">FpTestProblem</a>, <a class="el" href="../../de/da5/classFpTestProblem.html#abec14e85d19cbcb2909f405d171e8613">FpTestProblem</a>, <a class="el" href="../../dd/d71/classOscRingNStProblem.html#a2dd1cb9b211f2cbd2ea9aea625685bcb">OscRingNStProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../db/d50/classOscEllipseProblem.html#a6044661f75986848484df2c04bfe7aab">OscEllipseProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../dd/de5/classRefineableDrivenCavityProblem.html#ad0dd51a90826a15f83edc2d222102852">RefineableDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../db/dda/classUnstructuredImmersedEllipseProblem.html#ab1558b409285aea617f4abf7d3a64b3d">UnstructuredImmersedEllipseProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dc/d61/classPRefineableDrivenCavityProblem.html#ad5fac31cf95a02b9c282f4cdf59ec4e9">PRefineableDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d66/classQuarterCircleDrivenCavityProblem.html#a4873f31ccf76e340abb284b17430c407">QuarterCircleDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d8c/classCollapsibleChannelProblem.html#a3ea01d83f0256c588a652741c6c33e0e">CollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dc/d83/classFlowAroundCylinderProblem.html#a7f4e152b708722549bc0110e5530701a">FlowAroundCylinderProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dc/d83/classFlowAroundCylinderProblem.html#a7f4e152b708722549bc0110e5530701a">FlowAroundCylinderProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../db/d31/classEntryFlowProblem.html#ae472a4319c372d33ee22dac8fb32d9a2">EntryFlowProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/dec/classSteadyHelicalProblem.html#a7fb3fb4cfb399e20ac52816f9cdfc68d">SteadyHelicalProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d2/da3/classSteadyCurvedTubeProblem.html#a536ebee9cdb86bb1533531c85e5fd125">SteadyCurvedTubeProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d8c/classCollapsibleChannelProblem.html#a3ea01d83f0256c588a652741c6c33e0e">CollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d8c/classCollapsibleChannelProblem.html#a3ea01d83f0256c588a652741c6c33e0e">CollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d6c/classQuarterCircleDrivenCavityProblem2.html#a51d108d18f50d81bad0da998741254a9">QuarterCircleDrivenCavityProblem2&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d66/classQuarterCircleDrivenCavityProblem.html#a4873f31ccf76e340abb284b17430c407">QuarterCircleDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d2/d1f/classChannelWithLeafletProblem.html#a7978755f073d950e5012951ced9e455e">ChannelWithLeafletProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d2/d3d/classRefineableRotatingCylinderProblem.html#af914476e487ad5ed623384adb7c68c66">RefineableRotatingCylinderProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/de5/classRefineableDrivenCavityProblem.html#ad0dd51a90826a15f83edc2d222102852">RefineableDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../de/d9e/classFluxPoissonMGProblem.html#a9f9851b5184cf0043c97c74aeec5b339">FluxPoissonMGProblem&lt; ELEMENT, MESH &gt;</a>, <a class="el" href="../../de/d9e/classFluxPoissonMGProblem.html#a9f9851b5184cf0043c97c74aeec5b339">FluxPoissonMGProblem&lt; ELEMENT, MESH &gt;</a>, <a class="el" href="../../dc/d88/classPMLHelmholtzMGProblem.html#a529da534d8bef52eae9224bc2d3ddfc1">PMLHelmholtzMGProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d22/classPMLStructuredCubicHelmholtz.html#ac66d247515235d853c1155c769e301ee">PMLStructuredCubicHelmholtz&lt; ELEMENT &gt;</a>, <a class="el" href="../../d7/d86/classSurfactantProblem.html#afaef2e85727df1c2f6e0ad712ebaa3c0">SurfactantProblem&lt; ELEMENT, INTERFACE_ELEMENT &gt;</a>, <a class="el" href="../../d7/d86/classSurfactantProblem.html#afaef2e85727df1c2f6e0ad712ebaa3c0">SurfactantProblem&lt; ELEMENT, INTERFACE_ELEMENT &gt;</a>, <a class="el" href="../../d8/d6a/classRefineableSphereConvectionProblem.html#a573aa5a1bc19010b00fcba5b43834d41">RefineableSphereConvectionProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../db/d70/classRefineableDDConvectionProblem.html#add2623a8fcf64e4986832c6de1606ad2">RefineableDDConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d1/d1f/classRefineableConvectionProblem.html#a9baa484155212df5ad2137dd5a348def">RefineableConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d1/d1f/classRefineableConvectionProblem.html#a9baa484155212df5ad2137dd5a348def">RefineableConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d8/d48/classFlowAroundHalfCylinderProblem.html#a873a17fde3ccb353d0d0a6fbe5b57c1e">FlowAroundHalfCylinderProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d48/classFlowAroundHalfCylinderProblem.html#a873a17fde3ccb353d0d0a6fbe5b57c1e">FlowAroundHalfCylinderProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d48/classFlowAroundHalfCylinderProblem.html#a873a17fde3ccb353d0d0a6fbe5b57c1e">FlowAroundHalfCylinderProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d48/classFlowAroundHalfCylinderProblem.html#a873a17fde3ccb353d0d0a6fbe5b57c1e">FlowAroundHalfCylinderProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d1f/classRefineableConvectionProblem.html#a9baa484155212df5ad2137dd5a348def">RefineableConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d1/d1f/classRefineableConvectionProblem.html#a9baa484155212df5ad2137dd5a348def">RefineableConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../dd/d4a/classFSIChannelWithLeafletProblem.html#acc3f4745ea9b4524aebbc4f2556d1286">FSIChannelWithLeafletProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d57/classRectangularDrivenCavityProblem.html#a9c0204d6871a62b07b239d54697d8644">RectangularDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/d16/classCantileverProblem.html#af4d135ace3eac657b38de362e1644c75">CantileverProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/dfc/classTurekProblem.html#a39df0332d7606a5befe89bb0e581184b">TurekProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;</a>, <a class="el" href="../../d1/dfc/classTurekProblem.html#a39df0332d7606a5befe89bb0e581184b">TurekProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;</a>, <a class="el" href="../../d3/db4/classPseudoElasticCollapsibleChannelProblem.html#a32c96be4a8f9bd3600fbcacde079d0e6">PseudoElasticCollapsibleChannelProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;</a>, <a class="el" href="../../da/db6/classFSIRingProblem.html#af4ffa3d628230ef064a84b7c6e6a5fb8">FSIRingProblem</a>, <a class="el" href="../../dd/da6/classFSICollapsibleChannelProblem.html#ae20eb7ed895e0063ade5a6d0c6f9af2f">FSICollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d4a/classFSIChannelWithLeafletProblem.html#acc3f4745ea9b4524aebbc4f2556d1286">FSIChannelWithLeafletProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d1f/classRefineableConvectionProblem.html#a9baa484155212df5ad2137dd5a348def">RefineableConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d1/d1f/classRefineableConvectionProblem.html#a9baa484155212df5ad2137dd5a348def">RefineableConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#ada7322b2e49e240033a2c3c974ddf0ca">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#ada7322b2e49e240033a2c3c974ddf0ca">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#ada7322b2e49e240033a2c3c974ddf0ca">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d43/classRefineableTwoMeshFluxPoissonProblem.html#a0140155529861f5e63ab32feece3c9b6">RefineableTwoMeshFluxPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d27/classPrescribedBoundaryDisplacementProblem.html#aae7225db18ad5c8429c0eb96fa37b585">PrescribedBoundaryDisplacementProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../db/d31/classEntryFlowProblem.html#ae472a4319c372d33ee22dac8fb32d9a2">EntryFlowProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/d16/classCantileverProblem.html#af4d135ace3eac657b38de362e1644c75">CantileverProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d68/classRefineableUnsteadyHeatProblem.html#a1f8a9e91269440c799a2075f989d62b1">RefineableUnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d27/classPrescribedBoundaryDisplacementProblem.html#aae7225db18ad5c8429c0eb96fa37b585">PrescribedBoundaryDisplacementProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d27/classPrescribedBoundaryDisplacementProblem.html#aae7225db18ad5c8429c0eb96fa37b585">PrescribedBoundaryDisplacementProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dc/d61/classPRefineableDrivenCavityProblem.html#ad5fac31cf95a02b9c282f4cdf59ec4e9">PRefineableDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dc/d61/classPRefineableDrivenCavityProblem.html#ad5fac31cf95a02b9c282f4cdf59ec4e9">PRefineableDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/de5/classRefineableDrivenCavityProblem.html#ad0dd51a90826a15f83edc2d222102852">RefineableDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d66/classQuarterCircleDrivenCavityProblem.html#a4873f31ccf76e340abb284b17430c407">QuarterCircleDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/d16/classCantileverProblem.html#af4d135ace3eac657b38de362e1644c75">CantileverProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/de5/classRefineableDrivenCavityProblem.html#ad0dd51a90826a15f83edc2d222102852">RefineableDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/de5/classRefineableDrivenCavityProblem.html#ad0dd51a90826a15f83edc2d222102852">RefineableDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dc/dff/classUnstructuredSolidProblem.html#acf0bbf57534a1516a633d702d9fd21ab">UnstructuredSolidProblem&lt; ELEMENT, MESH &gt;</a>, <a class="el" href="../../d1/dc3/classScatteringProblem.html#a13d8f85e74666c260de7364917359ed5">ScatteringProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../da/d64/classMovingBlockProblem.html#a23744977b6f270e8445671c955c0f4aa">MovingBlockProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/dcf/classUnstructuredPoissonProblem.html#a6f3e089824cfbb4f458efd8c8ffd376d">UnstructuredPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../de/d7c/classTetmeshPoissonProblem.html#ac68b78f0e3f81c5aeabe7c2ea1df6b39">TetmeshPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../de/d7c/classTetmeshPoissonProblem.html#ac68b78f0e3f81c5aeabe7c2ea1df6b39">TetmeshPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d5/d62/classPerturbedStateProblem.html#a1c10d91da1115a1c8737de1321bfb91e">PerturbedStateProblem&lt; BASE_ELEMENT, PERTURBED_ELEMENT &gt;</a>, <a class="el" href="../../d2/d3b/classBaseStateProblem.html#aab9de2c013f07dc9c92e1be57964d5f2">BaseStateProblem&lt; BASE_ELEMENT &gt;</a>, <a class="el" href="../../db/d16/classTwoMeshFluxAdvectionDiffusionProblem.html#aa02be21b629b8d9809be106b27afcb59">TwoMeshFluxAdvectionDiffusionProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d7/dc1/classRefineablePeriodicLoadProblem.html#ad4fdb5d3805ea8dec6cedf515e5a73d7">RefineablePeriodicLoadProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/dee/classUnstructuredFSIProblem.html#ae91b90874744a5eb1870da3873841e09">UnstructuredFSIProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;</a>, <a class="el" href="../../d1/dfc/classTurekProblem.html#a39df0332d7606a5befe89bb0e581184b">TurekProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;</a>, <a class="el" href="../../d3/db4/classPseudoElasticCollapsibleChannelProblem.html#a32c96be4a8f9bd3600fbcacde079d0e6">PseudoElasticCollapsibleChannelProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;</a>, <a class="el" href="../../d3/db4/classPseudoElasticCollapsibleChannelProblem.html#a32c96be4a8f9bd3600fbcacde079d0e6">PseudoElasticCollapsibleChannelProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;</a>, <a class="el" href="../../dd/d71/classOscRingNStProblem.html#a2dd1cb9b211f2cbd2ea9aea625685bcb">OscRingNStProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d71/classOscRingNStProblem.html#a2dd1cb9b211f2cbd2ea9aea625685bcb">OscRingNStProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../da/db6/classFSIRingProblem.html#af4ffa3d628230ef064a84b7c6e6a5fb8">FSIRingProblem</a>, <a class="el" href="../../da/db6/classFSIRingProblem.html#af4ffa3d628230ef064a84b7c6e6a5fb8">FSIRingProblem</a>, <a class="el" href="../../dd/da6/classFSICollapsibleChannelProblem.html#ae20eb7ed895e0063ade5a6d0c6f9af2f">FSICollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/da6/classFSICollapsibleChannelProblem.html#ae20eb7ed895e0063ade5a6d0c6f9af2f">FSICollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d4a/classFSIChannelWithLeafletProblem.html#acc3f4745ea9b4524aebbc4f2556d1286">FSIChannelWithLeafletProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/dcd/classDeformableFishPoissonProblem.html#ada340a31a3b019116ecb7c0bb1d4c779">DeformableFishPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/dcd/classDeformableFishPoissonProblem.html#ada340a31a3b019116ecb7c0bb1d4c779">DeformableFishPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d5/d09/classCoatedSphereProblem.html#a77906dadd8ceb1d1d3182f298a0ca2d2">CoatedSphereProblem&lt; ELASTICITY_ELEMENT, HELMHOLTZ_ELEMENT &gt;</a>, <a class="el" href="../../d3/d0f/classCoatedDiskProblem.html#a93f9d34cd24f08ca1ec726ae0057b939">CoatedDiskProblem&lt; ELASTICITY_ELEMENT, HELMHOLTZ_ELEMENT &gt;</a>, <a class="el" href="../../d3/d0f/classCoatedDiskProblem.html#a93f9d34cd24f08ca1ec726ae0057b939">CoatedDiskProblem&lt; ELASTICITY_ELEMENT, HELMHOLTZ_ELEMENT &gt;</a>, <a class="el" href="../../d1/dc3/classScatteringProblem.html#a13d8f85e74666c260de7364917359ed5">ScatteringProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/dc3/classScatteringProblem.html#a6eb23d8fb493345f2f11ae17124082ec">ScatteringProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d7/dd7/classHelmholtzPointSourceProblem.html#abbfe8c130a31fcb6bb70fe7841ffa8b1">HelmholtzPointSourceProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/dec/classContactProblem.html#ad5916aab223b6836f09397ca8430fee0">ContactProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/dec/classContactProblem.html#ad5916aab223b6836f09397ca8430fee0">ContactProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d28/classUnsteadyHeatProblem.html#a975ec6de594212b0767ee2fcc4fa1913">UnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/dcb/classUnsteadyHeatMeltProblem.html#acba0230e3213f3cb0c006f2dccde39b3">UnsteadyHeatMeltProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/dec/classContactProblem.html#ad5916aab223b6836f09397ca8430fee0">ContactProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/dec/classContactProblem.html#ad5916aab223b6836f09397ca8430fee0">ContactProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d2/d8e/classSolarRadiationProblem.html#ad82420d66e20e4a6a7323dde5a1e9fb8">SolarRadiationProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d73/classMeltContactProblem.html#add8f6a224d5eb763d56dd8070f859d79">MeltContactProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d70/classVibratingShellProblem.html#aa0f63bd1d7dde58a1b40f00c0e315da3">VibratingShellProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d7d/classAxisymmetricVibratingShellProblem.html#a932d411d8e29b590b8f193cff179acd2">AxisymmetricVibratingShellProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d32/classFourierDecomposedHelmholtzProblem.html#a3258e3817d8747aac0409eca1a24d14b">FourierDecomposedHelmholtzProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/d77/classUnstructuredFvKProblem.html#a051e3232d310fe19a9d1835828c6331c">UnstructuredFvKProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d5/d2f/classExtrudedMovingCylinderProblem.html#ab82d195b792e124ecf88500251fb3f24">ExtrudedMovingCylinderProblem&lt; TWO_D_ELEMENT, THREE_D_ELEMENT &gt;</a>, <a class="el" href="../../da/d64/classMovingBlockProblem.html#a23744977b6f270e8445671c955c0f4aa">MovingBlockProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d33/classRefineablePorousChannelProblem.html#a6aaf140febe0a567385a30ea153fc877">RefineablePorousChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dc/d83/classFlowAroundCylinderProblem.html#a7f4e152b708722549bc0110e5530701a">FlowAroundCylinderProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dc/d83/classFlowAroundCylinderProblem.html#a7f4e152b708722549bc0110e5530701a">FlowAroundCylinderProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d3/d84/classUnstructuredTorusProblem.html#af9c3034d2bb67c35cb2acc3dd39aab16">UnstructuredTorusProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d3/d84/classUnstructuredTorusProblem.html#af9c3034d2bb67c35cb2acc3dd39aab16">UnstructuredTorusProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d15/classInterfaceProblem.html#a1c8a5dee970dccc3f1da993cf531872d">InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d6/d07/classTorusProblem.html#a228b4fc8d047c76b53ca20ecf99b9d7a">TorusProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d94/classRotatingCylinderProblem.html#a7d2fc60789ca6e2458be45b94ee40a1c">RotatingCylinderProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d5/d62/classPerturbedStateProblem.html#a1c10d91da1115a1c8737de1321bfb91e">PerturbedStateProblem&lt; BASE_ELEMENT, PERTURBED_ELEMENT &gt;</a>, <a class="el" href="../../d2/d3b/classBaseStateProblem.html#aab9de2c013f07dc9c92e1be57964d5f2">BaseStateProblem&lt; BASE_ELEMENT &gt;</a>, <a class="el" href="../../db/d16/classTwoMeshFluxAdvectionDiffusionProblem.html#aa02be21b629b8d9809be106b27afcb59">TwoMeshFluxAdvectionDiffusionProblem&lt; ELEMENT &gt;</a>, and <a class="el" href="../../d9/d9c/classMortaringValidationProblem.html#afbc1cee73cb28293a45132c668193079">MortaringValidationProblem&lt; ELEMENT, NON_MORTAR_ELEMENT &gt;</a>.</p>
<div class="fragment"><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;{}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5e60c7b47591bca6b20b0612e119983">adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a309487c952f108015b53a2d70539ac8b">adapt_based_on_error_estimates()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a350e611af4847eabfa1d531b14b4439c">p_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad73bff32f14763e813cabdcd4c88c06">p_refine_selected_elements()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a093b78c1820cf3fe6bd9ec3deb605b49">p_refine_uniformly()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7460f9339fd4850112284a86e039ee00">p_refine_uniformly_aux()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#afa0aab9ca7018bf875c1f3367c6c07e3">p_unrefine_uniformly()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a4f6011ef141cc68598a9502052129a3f">read()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a3dcfc37fe1b6c21d694407981830c1e5">refine_selected_elements()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a1ce3a9162aaef9e0a4d86f8de57eb523">refine_uniformly()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#affb22db0c6f1e14ae120b153b85831a3">refine_uniformly_aux()</a>, <a class="el" href="../../dc/d2e/classoomph_1_1MGSolver.html#a8b25ea9a7781f95ddf46b4b8d427d3d0">oomph::MGSolver&lt; DIM &gt;::setup_mg_hierarchy()</a>, <a class="el" href="../../da/d32/classoomph_1_1HelmholtzMGPreconditioner.html#ad811c870bf06b25f3237c84b5037e089">oomph::HelmholtzMGPreconditioner&lt; DIM &gt;::setup_mg_hierarchy()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a56429d79e517d59a54cd49949b04d3ae">unrefine_uniformly()</a>.</p>

</div>
</div>
<a id="a5f08629e3c9c72b441ec7f19f175b2c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f08629e3c9c72b441ec7f19f175b2c7">&#9670;&nbsp;</a></span>actions_after_change_in_bifurcation_parameter()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void oomph::Problem::actions_after_change_in_bifurcation_parameter </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Actions that are to be performed after a change in the parameter that is being varied as part of the solution of a bifurcation detection problem. The default is to call actions_before_newton_solve(), actions_before_newton_convergence_check() and actions_after_newton_solve(). This could be amazingly inefficient in certain problems and should be overloaded in such cases. An example would be when a remesh is required in general, but the global parameter does not affect the mesh directly. </p>

<p>Reimplemented in <a class="el" href="../../da/d79/classRotatingProblem.html#ab5941951adb2e48544d08960cf3ffc1d">RotatingProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../da/d79/classRotatingProblem.html#ab5941951adb2e48544d08960cf3ffc1d">RotatingProblem&lt; ELEMENT &gt;</a>, and <a class="el" href="../../d0/d33/classRefineablePorousChannelProblem.html#a3fc7e471879c4b5d59522efde8fb6a47">RefineablePorousChannelProblem&lt; ELEMENT &gt;</a>.</p>
<div class="fragment"><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    {</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;      <span class="comment">// Default action should cover all possibilities</span></div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a0c8d70891f7369bb4bf8412fa1a08ecb">actions_before_newton_solve</a>();</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae6ad96ddf5d48b517b89c9a9b879bc4b">actions_before_newton_convergence_check</a>();</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a033ec7301123deeb7e56d04c38f9f1da">actions_after_newton_solve</a>();</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a033ec7301123deeb7e56d04c38f9f1da"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a033ec7301123deeb7e56d04c38f9f1da">oomph::Problem::actions_after_newton_solve</a></div><div class="ttdeci">virtual void actions_after_newton_solve()</div><div class="ttdef"><b>Definition:</b> problem.h:1038</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a0c8d70891f7369bb4bf8412fa1a08ecb"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a0c8d70891f7369bb4bf8412fa1a08ecb">oomph::Problem::actions_before_newton_solve</a></div><div class="ttdeci">virtual void actions_before_newton_solve()</div><div class="ttdef"><b>Definition:</b> problem.h:1032</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_ae6ad96ddf5d48b517b89c9a9b879bc4b"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#ae6ad96ddf5d48b517b89c9a9b879bc4b">oomph::Problem::actions_before_newton_convergence_check</a></div><div class="ttdeci">virtual void actions_before_newton_convergence_check()</div><div class="ttdef"><b>Definition:</b> problem.h:1048</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a033ec7301123deeb7e56d04c38f9f1da">actions_after_newton_solve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae6ad96ddf5d48b517b89c9a9b879bc4b">actions_before_newton_convergence_check()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a0c8d70891f7369bb4bf8412fa1a08ecb">actions_before_newton_solve()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/dcb/classoomph_1_1FoldHandler.html#ad1bec54a2e0c5bd483ff0bf633bd6542">oomph::FoldHandler::get_jacobian()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aa6728813a099111bee2b6c79dec20fc4">oomph::PitchForkHandler::get_jacobian()</a>, <a class="el" href="../../d4/da2/classoomph_1_1HopfHandler.html#ab36c50421f53accced01dd9e04d904ef">oomph::HopfHandler::get_jacobian()</a>, <a class="el" href="../../dd/d4b/classoomph_1_1AugmentedBlockFoldLinearSolver.html#a7728fc74802b6802ed966765bc1e62d9">oomph::AugmentedBlockFoldLinearSolver::resolve()</a>, <a class="el" href="../../de/d72/classoomph_1_1AugmentedBlockPitchForkLinearSolver.html#a1d617896a3f1c1b1236ff18dc87ed8d7">oomph::AugmentedBlockPitchForkLinearSolver::resolve()</a>, <a class="el" href="../../dd/d4b/classoomph_1_1AugmentedBlockFoldLinearSolver.html#a11690b33089e999d0c894b4e4b0646d9">oomph::AugmentedBlockFoldLinearSolver::solve()</a>, <a class="el" href="../../de/d72/classoomph_1_1AugmentedBlockPitchForkLinearSolver.html#a0cbeb150ac83d5be1a1e30c0f728a70b">oomph::AugmentedBlockPitchForkLinearSolver::solve()</a>, <a class="el" href="../../df/dbd/classoomph_1_1BlockHopfLinearSolver.html#a5e9ff24466ec138cca8264e5befc31fe">oomph::BlockHopfLinearSolver::solve()</a>, and <a class="el" href="../../df/dbd/classoomph_1_1BlockHopfLinearSolver.html#a9a7cc6bda9ab1a8baf83d5d8e1fe5eea">oomph::BlockHopfLinearSolver::solve_for_two_rhs()</a>.</p>

</div>
</div>
<a id="a1e90bbe5d279295b97ae704487259bcc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e90bbe5d279295b97ae704487259bcc">&#9670;&nbsp;</a></span>actions_after_change_in_global_parameter()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void oomph::Problem::actions_after_change_in_global_parameter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;&#160;</td>
          <td class="paramname"><em>parameter_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Actions that are to be performed when the global parameter addressed by parameter_pt has been changed in the function get_derivative_wrt_global_parameter() The default is to call actions_before_newton_solve(), actions_before_newton_convergence_check() and actions_after_newton_solve(). This could be amazingly inefficient in certain problems and should be overloaded in such cases. An example would be when a remesh is required in general, but the global parameter does not affect the mesh directly. </p>

<p>Reimplemented in <a class="el" href="../../dd/dfa/classAirwayReopeningProblem.html#a3935e42d6fa4fb0b89567a4696da2fcb">AirwayReopeningProblem&lt; ELEMENT &gt;</a>.</p>
<div class="fragment"><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    {</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;      <span class="comment">// Default action should cover all possibilities</span></div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a0c8d70891f7369bb4bf8412fa1a08ecb">actions_before_newton_solve</a>();</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae6ad96ddf5d48b517b89c9a9b879bc4b">actions_before_newton_convergence_check</a>();</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a033ec7301123deeb7e56d04c38f9f1da">actions_after_newton_solve</a>();</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a033ec7301123deeb7e56d04c38f9f1da">actions_after_newton_solve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae6ad96ddf5d48b517b89c9a9b879bc4b">actions_before_newton_convergence_check()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a0c8d70891f7369bb4bf8412fa1a08ecb">actions_before_newton_solve()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#adc456017cfc4fb4ae6f522973e50f496">get_derivative_wrt_global_parameter()</a>.</p>

</div>
</div>
<a id="a51bfd872c45467a65ce977f3753a6d1d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51bfd872c45467a65ce977f3753a6d1d">&#9670;&nbsp;</a></span>actions_after_explicit_timestep()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void oomph::Problem::actions_after_explicit_timestep </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Actions that should be performed after each explicit time step. </p>

<p>Reimplemented from <a class="el" href="../../df/d86/classoomph_1_1ExplicitTimeSteppableObject.html#a22371b17397f74660c8e9d54ed50ccea">oomph::ExplicitTimeSteppableObject</a>.</p>

<p>Reimplemented in <a class="el" href="../../d4/d94/classoomph_1_1MyProblem.html#a3cfcfad616da35ca5ee71d039431c90e">oomph::MyProblem</a>.</p>
<div class="fragment"><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;{}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a012692496c968960f4ea27db4e89cc7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a012692496c968960f4ea27db4e89cc7d">&#9670;&nbsp;</a></span>actions_after_implicit_timestep()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void oomph::Problem::actions_after_implicit_timestep </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Actions that should be performed after each implicit time step. This is needed when one wants to solve a steady problem before timestepping and needs to distinguish between the two cases </p>

<p>Reimplemented in <a class="el" href="../../d8/d28/classUnsteadyHeatProblem.html#afd14cbe343adfa39e3b8b2ca681c5020">UnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d68/classRefineableUnsteadyHeatProblem.html#aa740f2eb1b3909100a04709b401c0b41">RefineableUnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d68/classRefineableUnsteadyHeatProblem.html#aa740f2eb1b3909100a04709b401c0b41">RefineableUnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d68/classRefineableUnsteadyHeatProblem.html#aa740f2eb1b3909100a04709b401c0b41">RefineableUnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d28/classUnsteadyHeatProblem.html#afd14cbe343adfa39e3b8b2ca681c5020">UnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d28/classUnsteadyHeatProblem.html#afd14cbe343adfa39e3b8b2ca681c5020">UnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d6/df1/classRefineableSphericalSpinUpProblem.html#a112e6cb37f6a6af2ee3dddd8a619c67a">RefineableSphericalSpinUpProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d6/df1/classRefineableSphericalSpinUpProblem.html#a112e6cb37f6a6af2ee3dddd8a619c67a">RefineableSphericalSpinUpProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d68/classRefineableUnsteadyHeatProblem.html#aa740f2eb1b3909100a04709b401c0b41">RefineableUnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d28/classUnsteadyHeatProblem.html#afd14cbe343adfa39e3b8b2ca681c5020">UnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d94/classoomph_1_1MyProblem.html#a7d3d510808fae9a404ea77d807b01359">oomph::MyProblem</a>, <a class="el" href="../../db/d50/classOscEllipseProblem.html#a80b50009a6aba4b6920c11b86b06f0f9">OscEllipseProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d4/d68/classRefineableUnsteadyHeatProblem.html#aa740f2eb1b3909100a04709b401c0b41">RefineableUnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d5/d62/classPerturbedStateProblem.html#acb4c5bcb4acdadc8260dfb10a536f9c0">PerturbedStateProblem&lt; BASE_ELEMENT, PERTURBED_ELEMENT &gt;</a>, <a class="el" href="../../d5/d62/classPerturbedStateProblem.html#acb4c5bcb4acdadc8260dfb10a536f9c0">PerturbedStateProblem&lt; BASE_ELEMENT, PERTURBED_ELEMENT &gt;</a>, <a class="el" href="../../d2/d3b/classBaseStateProblem.html#a8020fc6b584adb2ff9ada1174fbc4eb9">BaseStateProblem&lt; BASE_ELEMENT &gt;</a>, <a class="el" href="../../d5/d62/classPerturbedStateProblem.html#acb4c5bcb4acdadc8260dfb10a536f9c0">PerturbedStateProblem&lt; BASE_ELEMENT, PERTURBED_ELEMENT &gt;</a>, <a class="el" href="../../d2/d3b/classBaseStateProblem.html#a8020fc6b584adb2ff9ada1174fbc4eb9">BaseStateProblem&lt; BASE_ELEMENT &gt;</a>, <a class="el" href="../../d5/d62/classPerturbedStateProblem.html#acb4c5bcb4acdadc8260dfb10a536f9c0">PerturbedStateProblem&lt; BASE_ELEMENT, PERTURBED_ELEMENT &gt;</a>, <a class="el" href="../../d2/d3b/classBaseStateProblem.html#a8020fc6b584adb2ff9ada1174fbc4eb9">BaseStateProblem&lt; BASE_ELEMENT &gt;</a>, <a class="el" href="../../d4/db2/classLinearWaveProblem.html#a521290f43f9aac37c9604e744fa71075">LinearWaveProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d4/db2/classLinearWaveProblem.html#a521290f43f9aac37c9604e744fa71075">LinearWaveProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d4/db2/classLinearWaveProblem.html#a521290f43f9aac37c9604e744fa71075">LinearWaveProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d8/d28/classUnsteadyHeatProblem.html#afd14cbe343adfa39e3b8b2ca681c5020">UnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d5/d62/classPerturbedStateProblem.html#acb4c5bcb4acdadc8260dfb10a536f9c0">PerturbedStateProblem&lt; BASE_ELEMENT, PERTURBED_ELEMENT &gt;</a>, <a class="el" href="../../d2/d3b/classBaseStateProblem.html#a8020fc6b584adb2ff9ada1174fbc4eb9">BaseStateProblem&lt; BASE_ELEMENT &gt;</a>, <a class="el" href="../../d5/d62/classPerturbedStateProblem.html#acb4c5bcb4acdadc8260dfb10a536f9c0">PerturbedStateProblem&lt; BASE_ELEMENT, PERTURBED_ELEMENT &gt;</a>, and <a class="el" href="../../d2/d3b/classBaseStateProblem.html#a8020fc6b584adb2ff9ada1174fbc4eb9">BaseStateProblem&lt; BASE_ELEMENT &gt;</a>.</p>
<div class="fragment"><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;{}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a63805c549e71b7c73107abe6001fae25">adaptive_unsteady_newton_solve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a4b015281f27d25ee0209cd9b467175b6">unsteady_newton_solve()</a>, and <a class="el" href="../../de/da7/classoomph_1_1SegregatableFSIProblem.html#a17f019ebaf83e170219bf605a8554111">oomph::SegregatableFSIProblem::unsteady_segregated_solve()</a>.</p>

</div>
</div>
<a id="a38d914a74e7998ddc74c205884d36d57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38d914a74e7998ddc74c205884d36d57">&#9670;&nbsp;</a></span>actions_after_implicit_timestep_and_error_estimation()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void oomph::Problem::actions_after_implicit_timestep_and_error_estimation </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Actions that should be performed after each implicit time step. This is needed if your actions_after_implicit_timestep() modify the solution in a way that affects the error estimate. </p>
<div class="fragment"><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;{}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a63805c549e71b7c73107abe6001fae25">adaptive_unsteady_newton_solve()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a4b015281f27d25ee0209cd9b467175b6">unsteady_newton_solve()</a>.</p>

</div>
</div>
<a id="a033ec7301123deeb7e56d04c38f9f1da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a033ec7301123deeb7e56d04c38f9f1da">&#9670;&nbsp;</a></span>actions_after_newton_solve()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void oomph::Problem::actions_after_newton_solve </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Any actions that are to be performed after a complete Newton solve, e.g. post processing. CAREFUL: This step should (and if the FD-based LinearSolver FD_LU is used, must) only update values that are pinned! </p>

<p>Reimplemented in <a class="el" href="../../d0/dd0/classOneDPoissonProblem.html#ab023d367cc68b77a7828536333c924ed">OneDPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/dd0/classOneDPoissonProblem.html#ab023d367cc68b77a7828536333c924ed">OneDPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/dd0/classOneDPoissonProblem.html#ab023d367cc68b77a7828536333c924ed">OneDPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d3/d73/classoomph_1_1WomersleyProblem.html#a248ab44d5058e1e29dab4fbfc52bf942">oomph::WomersleyProblem&lt; ELEMENT, DIM &gt;</a>, <a class="el" href="../../d2/d5a/classoomph_1_1SolidICProblem.html#afef1ae777a009afd2329dcb091862f69">oomph::SolidICProblem</a>, <a class="el" href="../../db/d78/classoomph_1_1BiharmonicFluidProblem.html#a6a69be0763564ffd22f598d734d11a26">oomph::BiharmonicFluidProblem&lt; DIM &gt;</a>, <a class="el" href="../../d9/dc5/classoomph_1_1BiharmonicProblem.html#ad685995c81201b8e5dfa7136e1858713">oomph::BiharmonicProblem&lt; DIM &gt;</a>, <a class="el" href="../../d9/dc5/classoomph_1_1BiharmonicProblem.html#ad685995c81201b8e5dfa7136e1858713">oomph::BiharmonicProblem&lt; 2 &gt;</a>, <a class="el" href="../../d6/df2/classTestPoissonProblem.html#ad642dd97a55abe0bd75f4087ac67cfd8">TestPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d9f/classTestRefineablePoissonProblem.html#a3bc0896fb240f313b3b505fc96965090">TestRefineablePoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d6/df2/classTestPoissonProblem.html#ad642dd97a55abe0bd75f4087ac67cfd8">TestPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d0a/classTFaceTestProblem.html#a0094a1c40f823f7c3af7a28ff86039a2">TFaceTestProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d17/classTriangleFaceTestProblem.html#a6a1443a6818ded95e7d4a6686b5acdf3">TriangleFaceTestProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d35/classQFaceTestProblem.html#a3cf8cd602aa31920b961f2ad9dfad60b">QFaceTestProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d35/classQFaceTestProblem.html#a3cf8cd602aa31920b961f2ad9dfad60b">QFaceTestProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a7a9478d8e1e5c7d3a886b00ab7d50bbd">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a7a9478d8e1e5c7d3a886b00ab7d50bbd">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/de1/classEighthSpherePoissonProblem.html#a480189fe5d2f42fe3ff6062d5f151ea3">EighthSpherePoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a7a9478d8e1e5c7d3a886b00ab7d50bbd">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../de/d3f/classDrivenCavityProblem.html#ae6af0dd8a66bce8632414f1ef1b5d946">DrivenCavityProblem&lt; ELEMENT, MESH &gt;</a>, <a class="el" href="../../d8/da8/classRefineablePoissonProblem.html#ac4d433dad09bce5bd9be21e86d347e38">RefineablePoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dc/d7b/classThreeDPoissonProblem.html#aa99b09ec919aa7132f1ca9a4e2d077ea">ThreeDPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/de5/classRefineableDrivenCavityProblem.html#a168df1ad7b08cf8b760b6d56e9920479">RefineableDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/dd0/classOneDPoissonProblem.html#ab023d367cc68b77a7828536333c924ed">OneDPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d57/classRectangularDrivenCavityProblem.html#abfe87f7dec89dcf897f4df475685e039">RectangularDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/dcf/classUnstructuredPoissonProblem.html#a822bd18e50ebeefd6d1c196fad7c0bf1">UnstructuredPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a7a9478d8e1e5c7d3a886b00ab7d50bbd">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/de1/classEighthSpherePoissonProblem.html#a480189fe5d2f42fe3ff6062d5f151ea3">EighthSpherePoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/da8/classRefineablePoissonProblem.html#ac4d433dad09bce5bd9be21e86d347e38">RefineablePoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/de5/classRefineableDrivenCavityProblem.html#a168df1ad7b08cf8b760b6d56e9920479">RefineableDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../db/d84/classYoungLaplaceProblem.html#a8eed49ad1c6247cc293a584ab9262efc">YoungLaplaceProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d4a/classRefineableYoungLaplaceProblem.html#a0791c90a16016372e09faf3f5721ecbe">RefineableYoungLaplaceProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d4a/classRefineableYoungLaplaceProblem.html#a0791c90a16016372e09faf3f5721ecbe">RefineableYoungLaplaceProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../db/d84/classYoungLaplaceProblem.html#a8eed49ad1c6247cc293a584ab9262efc">YoungLaplaceProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d8c/classCollapsibleChannelProblem.html#a34299672cba0f3c1db3901427eb4da4a">CollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d28/classUnsteadyHeatProblem.html#a88e3d534b5904f7c10ce6a8fbd6df0ea">UnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d68/classRefineableUnsteadyHeatProblem.html#ada522772b79e92a75edf3724d0a273da">RefineableUnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d68/classRefineableUnsteadyHeatProblem.html#ada522772b79e92a75edf3724d0a273da">RefineableUnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d68/classRefineableUnsteadyHeatProblem.html#ada522772b79e92a75edf3724d0a273da">RefineableUnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d28/classUnsteadyHeatProblem.html#a88e3d534b5904f7c10ce6a8fbd6df0ea">UnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d28/classUnsteadyHeatProblem.html#a88e3d534b5904f7c10ce6a8fbd6df0ea">UnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d28/classUnsteadyHeatProblem.html#a88e3d534b5904f7c10ce6a8fbd6df0ea">UnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d28/classUnsteadyHeatProblem.html#a88e3d534b5904f7c10ce6a8fbd6df0ea">UnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d28/classUnsteadyHeatProblem.html#a88e3d534b5904f7c10ce6a8fbd6df0ea">UnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/d2c/classRingWithTRibProblem.html#a5d9f7b05cc71c02275f6c3c1a465fd20">RingWithTRibProblem&lt; ELASTICITY_ELEMENT &gt;</a>, <a class="el" href="../../d8/d28/classAnnularDiskProblem.html#a35d3a481c66849a57b9797c2338b8fc2">AnnularDiskProblem&lt; ELASTICITY_ELEMENT &gt;</a>, <a class="el" href="../../d6/d48/classFourierDecomposedTimeHarmonicLinearElasticityProblem.html#ac5c25fb4658eaef91104ef7be1b0d25e">FourierDecomposedTimeHarmonicLinearElasticityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d6/d48/classFourierDecomposedTimeHarmonicLinearElasticityProblem.html#ac5c25fb4658eaef91104ef7be1b0d25e">FourierDecomposedTimeHarmonicLinearElasticityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d6/d48/classFourierDecomposedTimeHarmonicLinearElasticityProblem.html#ac5c25fb4658eaef91104ef7be1b0d25e">FourierDecomposedTimeHarmonicLinearElasticityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d3/d40/classSphericalSteadyRotationProblem.html#ab5b4949695870ca54f92dad6fb4ed8a2">SphericalSteadyRotationProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d2/da3/classSphericalSpinUpProblem.html#aa81f46982662e36e0e2e0b4afb6a3821">SphericalSpinUpProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d2/da3/classSphericalSpinUpProblem.html#aa81f46982662e36e0e2e0b4afb6a3821">SphericalSpinUpProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d6/df1/classRefineableSphericalSpinUpProblem.html#a43c0334e62eb7f88888649a5b0d8c110">RefineableSphericalSpinUpProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d6/df1/classRefineableSphericalSpinUpProblem.html#a43c0334e62eb7f88888649a5b0d8c110">RefineableSphericalSpinUpProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dc/dff/classUnstructuredSolidProblem.html#a093458a298c2761d1ac194d02f520893">UnstructuredSolidProblem&lt; ELEMENT, MESH &gt;</a>, <a class="el" href="../../dc/dff/classUnstructuredSolidProblem.html#a093458a298c2761d1ac194d02f520893">UnstructuredSolidProblem&lt; ELEMENT, MESH &gt;</a>, <a class="el" href="../../d5/d7a/classBlockCompressionProblem.html#a14802395892943eeee6201c9da7931f3">BlockCompressionProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d27/classPrescribedBoundaryDisplacementProblem.html#a53e7d18d9d748388160d6c4106f1d493">PrescribedBoundaryDisplacementProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/d16/classCantileverProblem.html#a4a70a4328d287aaa15c7811562122013">CantileverProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d0a/classElasticFishProblem.html#a41badf8aa60bf52d888338039168fcb3">ElasticFishProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dc/dfb/classSimpleShearProblem.html#ab476064967687537e335dfd40d770dbc">SimpleShearProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dc/dfb/classSimpleShearProblem.html#ab476064967687537e335dfd40d770dbc">SimpleShearProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/d9b/classDiskShockWaveProblem.html#a46f6a25da58128f6abfdbbe92ea49d11">DiskShockWaveProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d1/d8c/classCollapsibleChannelProblem.html#a34299672cba0f3c1db3901427eb4da4a">CollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d27/classPrescribedBoundaryDisplacementProblem.html#a53e7d18d9d748388160d6c4106f1d493">PrescribedBoundaryDisplacementProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d27/classPrescribedBoundaryDisplacementProblem.html#a53e7d18d9d748388160d6c4106f1d493">PrescribedBoundaryDisplacementProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d27/classPrescribedBoundaryDisplacementProblem.html#a53e7d18d9d748388160d6c4106f1d493">PrescribedBoundaryDisplacementProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d08/classDiskOscillationProblem.html#a84fdc4311e8cc1fa5f80dc5568c88413">DiskOscillationProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../de/de5/classStaticDiskCompressionProblem.html#a484b47d6a10a91cbd30cb807a49b1f58">StaticDiskCompressionProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d11/classCompressedSquareProblem.html#afef46d13ff7c8b2845e96a84762077dc">CompressedSquareProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/d16/classCantileverProblem.html#a4a70a4328d287aaa15c7811562122013">CantileverProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/d16/classCantileverProblem.html#a4a70a4328d287aaa15c7811562122013">CantileverProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../db/d95/classPlateProblem.html#aef1dfbdffcee81632af385733cb534f7">PlateProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../da/d3f/classShellProblem.html#a65636b791c99203ecbb09ba2a2eec214">ShellProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../da/d3f/classShellProblem.html#a65636b791c99203ecbb09ba2a2eec214">ShellProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../da/d3f/classShellProblem.html#a65636b791c99203ecbb09ba2a2eec214">ShellProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../da/d3f/classShellProblem.html#a65636b791c99203ecbb09ba2a2eec214">ShellProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d5/d48/classRefineableActivatorInhibitorProblem.html#a7d3afe3b0453d5af75ca5a2401b41d03">RefineableActivatorInhibitorProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d5/d48/classRefineableActivatorInhibitorProblem.html#a7d3afe3b0453d5af75ca5a2401b41d03">RefineableActivatorInhibitorProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d2c/classActivatorInhibitorProblem.html#af0a223379cc29835bf2e22e29a504c11">ActivatorInhibitorProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/dab/classRefineableTwoDPoissonProblem.html#adc58858db16fb9643a412987a2275351">RefineableTwoDPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d43/classRefineableTwoMeshFluxPoissonProblem.html#ab8b04db3dab6297f609a9a028b1c4473">RefineableTwoMeshFluxPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d27/classTwoMeshFluxPoissonProblem.html#a9b3da753ba1d924b920e2e67779e7453">TwoMeshFluxPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/da7/classFluxPoissonProblem.html#aa52ae9abbe805520a697929ab115f114">FluxPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/da8/classRefineablePoissonProblem.html#ac4d433dad09bce5bd9be21e86d347e38">RefineablePoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a7a9478d8e1e5c7d3a886b00ab7d50bbd">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a7a9478d8e1e5c7d3a886b00ab7d50bbd">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a7a9478d8e1e5c7d3a886b00ab7d50bbd">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/da8/classRefineablePoissonProblem.html#ac4d433dad09bce5bd9be21e86d347e38">RefineablePoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/de1/classEighthSpherePoissonProblem.html#a480189fe5d2f42fe3ff6062d5f151ea3">EighthSpherePoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/dd0/classOneDPoissonProblem.html#ab023d367cc68b77a7828536333c924ed">OneDPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a7a9478d8e1e5c7d3a886b00ab7d50bbd">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d3/d3c/classPRefineableOneDPoissonProblem.html#aa3cf4fcd56402962260845877d680627">PRefineableOneDPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/d58/classDemoPoissonProblem.html#a489eb1f0dd6d34ba73ff2ad134474c3c">DemoPoissonProblem</a>, <a class="el" href="../../d3/d40/classRefineableOneDPoissonProblem.html#a15d7e6e5918c003599265ff7084b0c74">RefineableOneDPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/dd0/classOneDPoissonProblem.html#ab023d367cc68b77a7828536333c924ed">OneDPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dc/ddb/classSimpleRefineableFishPoissonProblem.html#a68d717e7c5b403236fdce799599b8c29">SimpleRefineableFishPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../de/d23/classRefineableFishPoissonProblem.html#a7f6c356f7c8bd0130de957297e999f40">RefineableFishPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d6/d10/classFishPoissonProblem.html#a76f4ada436ceaa1d0ba96289503d99aa">FishPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../de/d23/classRefineableFishPoissonProblem.html#a7f6c356f7c8bd0130de957297e999f40">RefineableFishPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d6/d10/classFishPoissonProblem.html#a76f4ada436ceaa1d0ba96289503d99aa">FishPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../de/d23/classRefineableFishPoissonProblem.html#a7f6c356f7c8bd0130de957297e999f40">RefineableFishPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../de/d23/classRefineableFishPoissonProblem.html#a7f6c356f7c8bd0130de957297e999f40">RefineableFishPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/de1/classEighthSpherePoissonProblem.html#a480189fe5d2f42fe3ff6062d5f151ea3">EighthSpherePoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/de1/classEighthSpherePoissonProblem.html#a480189fe5d2f42fe3ff6062d5f151ea3">EighthSpherePoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/de5/classElasticAnnulusProblem.html#adfb87876ac9981899c6c0b4caf0786f9">ElasticAnnulusProblem&lt; ELASTICITY_ELEMENT &gt;</a>, <a class="el" href="../../df/de5/classElasticAnnulusProblem.html#adfb87876ac9981899c6c0b4caf0786f9">ElasticAnnulusProblem&lt; ELASTICITY_ELEMENT &gt;</a>, <a class="el" href="../../d0/dfa/classPMLProblem.html#ac171a6a2ff881984b3e057036cbbc414">PMLProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/dfa/classPMLProblem.html#ac171a6a2ff881984b3e057036cbbc414">PMLProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d5/d17/classPMLFourierDecomposedHelmholtzProblem.html#a013d95d489b85e326a71bb744af4a40f">PMLFourierDecomposedHelmholtzProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/da8/classRefineablePoissonProblem.html#ac4d433dad09bce5bd9be21e86d347e38">RefineablePoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a7a9478d8e1e5c7d3a886b00ab7d50bbd">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d57/classRectangularDrivenCavityProblem.html#abfe87f7dec89dcf897f4df475685e039">RectangularDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a7a9478d8e1e5c7d3a886b00ab7d50bbd">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/da6/classFSICollapsibleChannelProblem.html#a49780267c05f4c6ecbed11bfc6b9956b">FSICollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d68/classRefineableUnsteadyHeatProblem.html#ada522772b79e92a75edf3724d0a273da">RefineableUnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d28/classUnsteadyHeatProblem.html#a88e3d534b5904f7c10ce6a8fbd6df0ea">UnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d6/da9/classRayleighProblem.html#a833938f3e1b592571729b2bbea3bb9d2">RayleighProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d6/da9/classRayleighProblem.html#a833938f3e1b592571729b2bbea3bb9d2">RayleighProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d3/d26/classVorticityRecoveryProblem.html#af166a189a0527114c07f8bf101247c39">VorticityRecoveryProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d5/d3c/classUnstructuredFluidProblem.html#af6811af7c3d4241254278ec246733d93">UnstructuredFluidProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/dee/classDropInChannelProblem.html#ab38a14018a4093afe7cc0d9db9f1fc3b">DropInChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../da/def/classBubbleInChannelProblem.html#a566685b0a4f5dda91adbf9c781f9eafb">BubbleInChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d5/d3c/classUnstructuredFluidProblem.html#af6811af7c3d4241254278ec246733d93">UnstructuredFluidProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/deb/classRisingBubbleProblem.html#ad74058cfa8faa1720c91e0f359c34239">RisingBubbleProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d6a/classFallingBlockProblem.html#a3b901166944a8153f69300014d7b7afb">FallingBlockProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d15/classInterfaceProblem.html#aedc2e58b3d2f5f8c898a21ba2d245cee">InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d3/d70/classTwoLayerInterfaceProblem.html#aa3798e4cbf4cfebf7652aea3fd2fbdff">TwoLayerInterfaceProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d15/classInterfaceProblem.html#aedc2e58b3d2f5f8c898a21ba2d245cee">InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d7/dcc/classTurekNonFSIProblem.html#a161cfe46817a5129dcc33c7ce3a17173">TurekNonFSIProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d2f/classFreeSurfaceRotationProblem.html#a19fce31baef5e08c2cefc3382c138b06">FreeSurfaceRotationProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../db/d31/classEntryFlowProblem.html#a034e6085f31de2c44419090b64d503db">EntryFlowProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d54/classSpikedChannelSpineFlowProblem.html#a4aca63a902ad477dbe1cb9d170aebbc2">SpikedChannelSpineFlowProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d5/db8/classChannelSpineFlowProblem.html#a419a80ef3d19438f193bd7843f72446a">ChannelSpineFlowProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d5/db8/classChannelSpineFlowProblem.html#a419a80ef3d19438f193bd7843f72446a">ChannelSpineFlowProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d2/dd4/classNavierStokesProblem.html#aaf0ba897bf867aeb91dd557a577cb391">NavierStokesProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d15/classInterfaceProblem.html#aedc2e58b3d2f5f8c898a21ba2d245cee">InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d9/d15/classInterfaceProblem.html#aedc2e58b3d2f5f8c898a21ba2d245cee">InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../de/da5/classFpTestProblem.html#a1d1d931985d138249f5f32fb35b1b11d">FpTestProblem</a>, <a class="el" href="../../de/da5/classFpTestProblem.html#a1d1d931985d138249f5f32fb35b1b11d">FpTestProblem</a>, <a class="el" href="../../de/d2b/classRayleighTractionProblem.html#ad85c20559eec76d54ebf666f62507d2e">RayleighTractionProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d6/da9/classRayleighProblem.html#a833938f3e1b592571729b2bbea3bb9d2">RayleighProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../dd/d71/classOscRingNStProblem.html#a6e4be6a46ab263941b76ab4e6706f63a">OscRingNStProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d71/classOscRingNStProblem.html#a6e4be6a46ab263941b76ab4e6706f63a">OscRingNStProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../db/d50/classOscEllipseProblem.html#a268e14b24e3ac922e7362bbb37ccde1f">OscEllipseProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d4/d57/classRectangularDrivenCavityProblem.html#abfe87f7dec89dcf897f4df475685e039">RectangularDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/de5/classRefineableDrivenCavityProblem.html#a168df1ad7b08cf8b760b6d56e9920479">RefineableDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dc/d61/classPRefineableDrivenCavityProblem.html#ae6f8fbf1433fa968feebbf04c29ea98d">PRefineableDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d66/classQuarterCircleDrivenCavityProblem.html#ad2ed0b3e89e1cd0e28cc61ae4fd129bc">QuarterCircleDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d2f/classFreeSurfaceRotationProblem.html#a19fce31baef5e08c2cefc3382c138b06">FreeSurfaceRotationProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d8c/classCollapsibleChannelProblem.html#a34299672cba0f3c1db3901427eb4da4a">CollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dc/d83/classFlowAroundCylinderProblem.html#aa8e50d7a99ad8daf5dfc363883af2b65">FlowAroundCylinderProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dc/d83/classFlowAroundCylinderProblem.html#aa8e50d7a99ad8daf5dfc363883af2b65">FlowAroundCylinderProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../db/d31/classEntryFlowProblem.html#a034e6085f31de2c44419090b64d503db">EntryFlowProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d57/classRectangularDrivenCavityProblem.html#abfe87f7dec89dcf897f4df475685e039">RectangularDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d8c/classCollapsibleChannelProblem.html#a34299672cba0f3c1db3901427eb4da4a">CollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d8c/classCollapsibleChannelProblem.html#a34299672cba0f3c1db3901427eb4da4a">CollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d6c/classQuarterCircleDrivenCavityProblem2.html#a1417ca3cc4a838d407c8bf85372dfc8f">QuarterCircleDrivenCavityProblem2&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d66/classQuarterCircleDrivenCavityProblem.html#ad2ed0b3e89e1cd0e28cc61ae4fd129bc">QuarterCircleDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d2/d1f/classChannelWithLeafletProblem.html#a2fcba9dc98f40bbca1919a715fa087d7">ChannelWithLeafletProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5b/classBrethertonProblem.html#a2e84e3ce784b0f0de5eeefe1175d48ff">BrethertonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d2/d3d/classRefineableRotatingCylinderProblem.html#af559552a0c8cba56b883cd8b5b283b7f">RefineableRotatingCylinderProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/de5/classRefineableDrivenCavityProblem.html#a168df1ad7b08cf8b760b6d56e9920479">RefineableDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d2a/classUnitCubePoissonMGProblem.html#aae18302eb813694f27673611e11aa4ee">UnitCubePoissonMGProblem&lt; ELEMENT, MESH &gt;</a>, <a class="el" href="../../d4/d2a/classUnitCubePoissonMGProblem.html#aae18302eb813694f27673611e11aa4ee">UnitCubePoissonMGProblem&lt; ELEMENT, MESH &gt;</a>, <a class="el" href="../../de/d9e/classFluxPoissonMGProblem.html#a83475e4589a9c9838dc460c6e6e4a412">FluxPoissonMGProblem&lt; ELEMENT, MESH &gt;</a>, <a class="el" href="../../de/d9e/classFluxPoissonMGProblem.html#a83475e4589a9c9838dc460c6e6e4a412">FluxPoissonMGProblem&lt; ELEMENT, MESH &gt;</a>, <a class="el" href="../../dc/d88/classPMLHelmholtzMGProblem.html#a59c7ce5747a71aef6a264720e83cfca6">PMLHelmholtzMGProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d22/classPMLStructuredCubicHelmholtz.html#a868f1d53e99c5de32a63bfde6f7e04a1">PMLStructuredCubicHelmholtz&lt; ELEMENT &gt;</a>, <a class="el" href="../../d7/d86/classSurfactantProblem.html#a854631d93039556cce349c7accc93f44">SurfactantProblem&lt; ELEMENT, INTERFACE_ELEMENT &gt;</a>, <a class="el" href="../../d7/d86/classSurfactantProblem.html#a854631d93039556cce349c7accc93f44">SurfactantProblem&lt; ELEMENT, INTERFACE_ELEMENT &gt;</a>, <a class="el" href="../../d7/d86/classSurfactantProblem.html#a854631d93039556cce349c7accc93f44">SurfactantProblem&lt; ELEMENT, INTERFACE_ELEMENT &gt;</a>, <a class="el" href="../../da/d36/classThermalProblem.html#ad38edfd46e049fdbc5b00bafb661f8e2">ThermalProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/d37/classAxisymFreeSurfaceNozzleAdvDiffRobinProblem.html#acccb5b311ac9220c1ffc4e54d7d1211a">AxisymFreeSurfaceNozzleAdvDiffRobinProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d3/d00/classConvectionProblem.html#a430aacb7a3077904ab72fbae6c8c9250">ConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d3/d00/classConvectionProblem.html#a430aacb7a3077904ab72fbae6c8c9250">ConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d3/d00/classConvectionProblem.html#a430aacb7a3077904ab72fbae6c8c9250">ConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d3/d00/classConvectionProblem.html#a430aacb7a3077904ab72fbae6c8c9250">ConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d1/d6e/classDDConvectionProblem.html#a0c198e511ae826799fd3423c1455bc55">DDConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d3/d00/classConvectionProblem.html#a430aacb7a3077904ab72fbae6c8c9250">ConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d1/d1f/classRefineableConvectionProblem.html#a13bda5e5e75928efa88433902ccab7ee">RefineableConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d1/d1f/classRefineableConvectionProblem.html#a13bda5e5e75928efa88433902ccab7ee">RefineableConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d3/d00/classConvectionProblem.html#a430aacb7a3077904ab72fbae6c8c9250">ConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d3/d00/classConvectionProblem.html#a430aacb7a3077904ab72fbae6c8c9250">ConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d8/d48/classFlowAroundHalfCylinderProblem.html#aea683175449d23dadf4df7f83011d086">FlowAroundHalfCylinderProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d48/classFlowAroundHalfCylinderProblem.html#aea683175449d23dadf4df7f83011d086">FlowAroundHalfCylinderProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d48/classFlowAroundHalfCylinderProblem.html#aea683175449d23dadf4df7f83011d086">FlowAroundHalfCylinderProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d48/classFlowAroundHalfCylinderProblem.html#aea683175449d23dadf4df7f83011d086">FlowAroundHalfCylinderProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d1f/classRefineableConvectionProblem.html#a13bda5e5e75928efa88433902ccab7ee">RefineableConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d1/d1f/classRefineableConvectionProblem.html#a13bda5e5e75928efa88433902ccab7ee">RefineableConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d2/d8f/classMultiPoissonProblem.html#a44901431b0ced6ab9ca11849046d252d">MultiPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a7a9478d8e1e5c7d3a886b00ab7d50bbd">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d4a/classFSIChannelWithLeafletProblem.html#abff6e46a940263c9255a61f649bb4239">FSIChannelWithLeafletProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d57/classRectangularDrivenCavityProblem.html#abfe87f7dec89dcf897f4df475685e039">RectangularDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/dd0/classOneDPoissonProblem.html#ab023d367cc68b77a7828536333c924ed">OneDPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/d16/classCantileverProblem.html#a4a70a4328d287aaa15c7811562122013">CantileverProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/dfc/classTurekProblem.html#ae97d3bad44e12274168e883c966b3983">TurekProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;</a>, <a class="el" href="../../d1/dfc/classTurekProblem.html#ae97d3bad44e12274168e883c966b3983">TurekProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;</a>, <a class="el" href="../../da/db6/classFSIRingProblem.html#a63a3da079b167ccdc288372bee6bdbc3">FSIRingProblem</a>, <a class="el" href="../../dd/da6/classFSICollapsibleChannelProblem.html#a49780267c05f4c6ecbed11bfc6b9956b">FSICollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d4a/classFSIChannelWithLeafletProblem.html#abff6e46a940263c9255a61f649bb4239">FSIChannelWithLeafletProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d1f/classRefineableConvectionProblem.html#a13bda5e5e75928efa88433902ccab7ee">RefineableConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d1/d1f/classRefineableConvectionProblem.html#a13bda5e5e75928efa88433902ccab7ee">RefineableConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d3/d00/classConvectionProblem.html#a430aacb7a3077904ab72fbae6c8c9250">ConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a7a9478d8e1e5c7d3a886b00ab7d50bbd">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a7a9478d8e1e5c7d3a886b00ab7d50bbd">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a7a9478d8e1e5c7d3a886b00ab7d50bbd">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d43/classRefineableTwoMeshFluxPoissonProblem.html#ab8b04db3dab6297f609a9a028b1c4473">RefineableTwoMeshFluxPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d27/classPrescribedBoundaryDisplacementProblem.html#a53e7d18d9d748388160d6c4106f1d493">PrescribedBoundaryDisplacementProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../db/d31/classEntryFlowProblem.html#a034e6085f31de2c44419090b64d503db">EntryFlowProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/d16/classCantileverProblem.html#a4a70a4328d287aaa15c7811562122013">CantileverProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d68/classRefineableUnsteadyHeatProblem.html#ada522772b79e92a75edf3724d0a273da">RefineableUnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d27/classPrescribedBoundaryDisplacementProblem.html#a53e7d18d9d748388160d6c4106f1d493">PrescribedBoundaryDisplacementProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d27/classPrescribedBoundaryDisplacementProblem.html#a53e7d18d9d748388160d6c4106f1d493">PrescribedBoundaryDisplacementProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/dab/classRefineableTwoDPoissonProblem.html#adc58858db16fb9643a412987a2275351">RefineableTwoDPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dc/d61/classPRefineableDrivenCavityProblem.html#ae6f8fbf1433fa968feebbf04c29ea98d">PRefineableDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dc/d61/classPRefineableDrivenCavityProblem.html#ae6f8fbf1433fa968feebbf04c29ea98d">PRefineableDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/de5/classRefineableDrivenCavityProblem.html#a168df1ad7b08cf8b760b6d56e9920479">RefineableDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../de/d23/classRefineableFishPoissonProblem.html#a7f6c356f7c8bd0130de957297e999f40">RefineableFishPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../de/dcc/classHarmonicProblem.html#a6ec6fc5b584f66a20911acaa1762e07c">HarmonicProblem&lt; ELEMENT, EIGEN_SOLVER &gt;</a>, <a class="el" href="../../da/d3f/classShellProblem.html#a65636b791c99203ecbb09ba2a2eec214">ShellProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d66/classQuarterCircleDrivenCavityProblem.html#ad2ed0b3e89e1cd0e28cc61ae4fd129bc">QuarterCircleDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../da/d79/classRotatingProblem.html#a86f02f2f63f3b8f23539a0cf95fd5f0d">RotatingProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../db/d68/classUniformTranspiration.html#a40e9c40f35bae05060e16d3d6e23e469">UniformTranspiration&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/d16/classCantileverProblem.html#a4a70a4328d287aaa15c7811562122013">CantileverProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/de5/classRefineableDrivenCavityProblem.html#a168df1ad7b08cf8b760b6d56e9920479">RefineableDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/de5/classRefineableDrivenCavityProblem.html#a168df1ad7b08cf8b760b6d56e9920479">RefineableDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/dc3/classScatteringProblem.html#abf1e7b97518c94e12802205dec08b15e">ScatteringProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../da/d64/classMovingBlockProblem.html#a69c134973179315e46d64e256013c650">MovingBlockProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a7a9478d8e1e5c7d3a886b00ab7d50bbd">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../da/d13/classFlowPastBoxProblem.html#a5d226368814cfbf84f274a63b3c0b20c">FlowPastBoxProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a7a9478d8e1e5c7d3a886b00ab7d50bbd">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../da/d13/classFlowPastBoxProblem.html#a5d226368814cfbf84f274a63b3c0b20c">FlowPastBoxProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a7a9478d8e1e5c7d3a886b00ab7d50bbd">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d2/dd4/classNavierStokesProblem.html#aaf0ba897bf867aeb91dd557a577cb391">NavierStokesProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a7a9478d8e1e5c7d3a886b00ab7d50bbd">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a7a9478d8e1e5c7d3a886b00ab7d50bbd">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/dcf/classUnstructuredPoissonProblem.html#a822bd18e50ebeefd6d1c196fad7c0bf1">UnstructuredPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/dcf/classUnstructuredPoissonProblem.html#a822bd18e50ebeefd6d1c196fad7c0bf1">UnstructuredPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a7a9478d8e1e5c7d3a886b00ab7d50bbd">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../de/d7c/classTetmeshPoissonProblem.html#ab91bd1c7045a11cf3b919c9c0faa982e">TetmeshPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../de/d7c/classTetmeshPoissonProblem.html#ab91bd1c7045a11cf3b919c9c0faa982e">TetmeshPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/dd0/classOneDPoissonProblem.html#ab023d367cc68b77a7828536333c924ed">OneDPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d5/d62/classPerturbedStateProblem.html#a4c7cc39dbedc2f4d549a724f8eb31cb7">PerturbedStateProblem&lt; BASE_ELEMENT, PERTURBED_ELEMENT &gt;</a>, <a class="el" href="../../d2/d3b/classBaseStateProblem.html#ab764d24a3d9262519c62034ceb0e1c30">BaseStateProblem&lt; BASE_ELEMENT &gt;</a>, <a class="el" href="../../d5/d62/classPerturbedStateProblem.html#a4c7cc39dbedc2f4d549a724f8eb31cb7">PerturbedStateProblem&lt; BASE_ELEMENT, PERTURBED_ELEMENT &gt;</a>, <a class="el" href="../../d2/d3b/classBaseStateProblem.html#ab764d24a3d9262519c62034ceb0e1c30">BaseStateProblem&lt; BASE_ELEMENT &gt;</a>, <a class="el" href="../../d5/d62/classPerturbedStateProblem.html#a4c7cc39dbedc2f4d549a724f8eb31cb7">PerturbedStateProblem&lt; BASE_ELEMENT, PERTURBED_ELEMENT &gt;</a>, <a class="el" href="../../d2/d3b/classBaseStateProblem.html#ab764d24a3d9262519c62034ceb0e1c30">BaseStateProblem&lt; BASE_ELEMENT &gt;</a>, <a class="el" href="../../d5/d62/classPerturbedStateProblem.html#a4c7cc39dbedc2f4d549a724f8eb31cb7">PerturbedStateProblem&lt; BASE_ELEMENT, PERTURBED_ELEMENT &gt;</a>, <a class="el" href="../../d2/d3b/classBaseStateProblem.html#ab764d24a3d9262519c62034ceb0e1c30">BaseStateProblem&lt; BASE_ELEMENT &gt;</a>, <a class="el" href="../../d4/db2/classLinearWaveProblem.html#a5b45c619af141b19162f990a95490e80">LinearWaveProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d4/db2/classLinearWaveProblem.html#a5b45c619af141b19162f990a95490e80">LinearWaveProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d4/db2/classLinearWaveProblem.html#a5b45c619af141b19162f990a95490e80">LinearWaveProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a7a9478d8e1e5c7d3a886b00ab7d50bbd">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a7a9478d8e1e5c7d3a886b00ab7d50bbd">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d2/d8f/classMultiPoissonProblem.html#a44901431b0ced6ab9ca11849046d252d">MultiPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d28/classPeriodicLoadProblem.html#aad99d153549e1ec0b5504e486039ef5e">PeriodicLoadProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a7a9478d8e1e5c7d3a886b00ab7d50bbd">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a7a9478d8e1e5c7d3a886b00ab7d50bbd">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d57/classRectangularDrivenCavityProblem.html#abfe87f7dec89dcf897f4df475685e039">RectangularDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d57/classRectangularDrivenCavityProblem.html#abfe87f7dec89dcf897f4df475685e039">RectangularDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/dd0/classOneDPoissonProblem.html#ab023d367cc68b77a7828536333c924ed">OneDPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../db/d16/classTwoMeshFluxAdvectionDiffusionProblem.html#ae5e1314c6772586f0fa0bc628adab7c0">TwoMeshFluxAdvectionDiffusionProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d7/dc1/classRefineablePeriodicLoadProblem.html#a5b1bd71066266f1eb1cc36d524d57894">RefineablePeriodicLoadProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d28/classPeriodicLoadProblem.html#aad99d153549e1ec0b5504e486039ef5e">PeriodicLoadProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/dfc/classTurekProblem.html#ae97d3bad44e12274168e883c966b3983">TurekProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;</a>, <a class="el" href="../../dd/d4a/classFSIChannelWithLeafletProblem.html#abff6e46a940263c9255a61f649bb4239">FSIChannelWithLeafletProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d71/classOscRingNStProblem.html#a6e4be6a46ab263941b76ab4e6706f63a">OscRingNStProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d71/classOscRingNStProblem.html#a6e4be6a46ab263941b76ab4e6706f63a">OscRingNStProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../da/db6/classFSIRingProblem.html#a63a3da079b167ccdc288372bee6bdbc3">FSIRingProblem</a>, <a class="el" href="../../da/db6/classFSIRingProblem.html#a63a3da079b167ccdc288372bee6bdbc3">FSIRingProblem</a>, <a class="el" href="../../df/dac/classSegregatedFSIDrivenCavityProblem.html#ad69adbd703062a917fde8210984ecc38">SegregatedFSIDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d5/df4/classFSIDrivenCavityProblem.html#a38417a8f5085e5adb58c532ba64ca205">FSIDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/da6/classFSICollapsibleChannelProblem.html#a49780267c05f4c6ecbed11bfc6b9956b">FSICollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/da6/classFSICollapsibleChannelProblem.html#a49780267c05f4c6ecbed11bfc6b9956b">FSICollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/da6/classFSICollapsibleChannelProblem.html#a49780267c05f4c6ecbed11bfc6b9956b">FSICollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/da6/classFSICollapsibleChannelProblem.html#a49780267c05f4c6ecbed11bfc6b9956b">FSICollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d4a/classFSIChannelWithLeafletProblem.html#abff6e46a940263c9255a61f649bb4239">FSIChannelWithLeafletProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/da6/classFSICollapsibleChannelProblem.html#a49780267c05f4c6ecbed11bfc6b9956b">FSICollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d9d/classPreconditionedFSICollapsibleChannelProblem.html#a3992360dfd001c2dc597522ca565b892">PreconditionedFSICollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../de/d23/classRefineableFishPoissonProblem.html#a7f6c356f7c8bd0130de957297e999f40">RefineableFishPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../db/da5/classFreeBoundaryPoissonProblem.html#aa18df6c9a9287f67ae1bff0f67aaa625">FreeBoundaryPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../db/da5/classFreeBoundaryPoissonProblem.html#aa18df6c9a9287f67ae1bff0f67aaa625">FreeBoundaryPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d6/d09/classGeomObjectAsGeneralisedElementProblem.html#af396d1789e2552c43e0c68561d88d473">GeomObjectAsGeneralisedElementProblem</a>, <a class="el" href="../../d9/dcd/classDeformableFishPoissonProblem.html#a18fdfaadd9ae10257088b9533f139182">DeformableFishPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/dcd/classDeformableFishPoissonProblem.html#a18fdfaadd9ae10257088b9533f139182">DeformableFishPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../de/d23/classRefineableFishPoissonProblem.html#a7f6c356f7c8bd0130de957297e999f40">RefineableFishPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d5/d09/classCoatedSphereProblem.html#ae5287efab54b16ec1bd5cced98971c9c">CoatedSphereProblem&lt; ELASTICITY_ELEMENT, HELMHOLTZ_ELEMENT &gt;</a>, <a class="el" href="../../d5/d09/classCoatedSphereProblem.html#ae5287efab54b16ec1bd5cced98971c9c">CoatedSphereProblem&lt; ELASTICITY_ELEMENT, HELMHOLTZ_ELEMENT &gt;</a>, <a class="el" href="../../dd/dfa/classAirwayReopeningProblem.html#ae9aa248752f8204a7f9cbc31e8e11edc">AirwayReopeningProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d3/d0f/classCoatedDiskProblem.html#aa0b9b4e706cdb1b31738c3db8759e9ee">CoatedDiskProblem&lt; ELASTICITY_ELEMENT, HELMHOLTZ_ELEMENT &gt;</a>, <a class="el" href="../../d3/d0f/classCoatedDiskProblem.html#aa0b9b4e706cdb1b31738c3db8759e9ee">CoatedDiskProblem&lt; ELASTICITY_ELEMENT, HELMHOLTZ_ELEMENT &gt;</a>, <a class="el" href="../../dd/d61/classHomogenisationProblem.html#aa06e686107b95aaed9a5c76d98eaf778">HomogenisationProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d61/classHomogenisationProblem.html#aa06e686107b95aaed9a5c76d98eaf778">HomogenisationProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/dc3/classScatteringProblem.html#abf1e7b97518c94e12802205dec08b15e">ScatteringProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/dc3/classScatteringProblem.html#abf1e7b97518c94e12802205dec08b15e">ScatteringProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d7/dd7/classHelmholtzPointSourceProblem.html#a11908f9dbe04da82df4481ce3a9cf537">HelmholtzPointSourceProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d28/classUnsteadyHeatProblem.html#a88e3d534b5904f7c10ce6a8fbd6df0ea">UnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d00/classStefanBoltzmannProblem.html#aedc47168a091e435bcbb1e1ab20c7ec2">StefanBoltzmannProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d00/classStefanBoltzmannProblem.html#aedc47168a091e435bcbb1e1ab20c7ec2">StefanBoltzmannProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/dec/classContactProblem.html#a282f4316bbcc042cdca52fddee79515d">ContactProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/dec/classContactProblem.html#a282f4316bbcc042cdca52fddee79515d">ContactProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d28/classUnsteadyHeatProblem.html#a88e3d534b5904f7c10ce6a8fbd6df0ea">UnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/dcb/classUnsteadyHeatMeltProblem.html#a046c583fc5b4a571fc8456ade773c7a8">UnsteadyHeatMeltProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/dec/classContactProblem.html#a282f4316bbcc042cdca52fddee79515d">ContactProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/dec/classContactProblem.html#a282f4316bbcc042cdca52fddee79515d">ContactProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d2/d8e/classSolarRadiationProblem.html#ad165d28833fdf533bea95db6ece2f524">SolarRadiationProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d73/classMeltContactProblem.html#af45ff777dc2b06014e4a74e9be1a074e">MeltContactProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d70/classVibratingShellProblem.html#abe6e9ee8c6091f37098f16943c3fd01e">VibratingShellProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d7d/classAxisymmetricVibratingShellProblem.html#a33f14c78428dadf0bc9a48fff00cf75a">AxisymmetricVibratingShellProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d32/classFourierDecomposedHelmholtzProblem.html#a5a37ba3fcf8563764f80108c9a657929">FourierDecomposedHelmholtzProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d32/classFourierDecomposedHelmholtzProblem.html#a5a37ba3fcf8563764f80108c9a657929">FourierDecomposedHelmholtzProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/d77/classUnstructuredFvKProblem.html#a22a99d4ac0107bd4fab9a75bc051e0a3">UnstructuredFvKProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d5/d2f/classExtrudedMovingCylinderProblem.html#a746d206a4fa5bc0077df12d636e1770d">ExtrudedMovingCylinderProblem&lt; TWO_D_ELEMENT, THREE_D_ELEMENT &gt;</a>, <a class="el" href="../../da/d64/classMovingBlockProblem.html#a69c134973179315e46d64e256013c650">MovingBlockProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d67/classContinuationProblem.html#a5da83aa286b59cfa8b24b033829d6350">ContinuationProblem</a>, <a class="el" href="../../dc/db9/classOrrSommerfeldProblem.html#ae91e063a7f00bc823019388a0aa95b9c">OrrSommerfeldProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../da/d79/classRotatingProblem.html#a86f02f2f63f3b8f23539a0cf95fd5f0d">RotatingProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../db/d68/classUniformTranspiration.html#a40e9c40f35bae05060e16d3d6e23e469">UniformTranspiration&lt; ELEMENT &gt;</a>, <a class="el" href="../../da/dec/classABCProblem.html#a0495cf2e2f19a8187a8d0275135ba852">ABCProblem&lt; ELEMENT, TIMESTEPPERT &gt;</a>, <a class="el" href="../../d8/d82/classPredPreyProblem.html#a7380d44a546b55784b6f36952e9b7afe">PredPreyProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d3/d41/classBratuProblem.html#a22d3633933d26c1f14839d1df691016c">BratuProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dc/d83/classFlowAroundCylinderProblem.html#aa8e50d7a99ad8daf5dfc363883af2b65">FlowAroundCylinderProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dc/d83/classFlowAroundCylinderProblem.html#aa8e50d7a99ad8daf5dfc363883af2b65">FlowAroundCylinderProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d2/d06/classElasticRingProblem.html#a58c2889fd4db8c17f4a4d964a5a7a90d">ElasticRingProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d2/d06/classElasticRingProblem.html#a58c2889fd4db8c17f4a4d964a5a7a90d">ElasticRingProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/ddc/classElasticBeamProblem.html#a30dde8d0101a3d3994965d6e560cb585">ElasticBeamProblem</a>, <a class="el" href="../../d2/d06/classElasticRingProblem.html#a58c2889fd4db8c17f4a4d964a5a7a90d">ElasticRingProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d2/d06/classElasticRingProblem.html#a58c2889fd4db8c17f4a4d964a5a7a90d">ElasticRingProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d3/d7a/classAxiPoroProblem.html#a03f6a74ac61bf484ef356f80727f2bb0">AxiPoroProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d9/d15/classInterfaceProblem.html#aedc2e58b3d2f5f8c898a21ba2d245cee">InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d9/d15/classInterfaceProblem.html#aedc2e58b3d2f5f8c898a21ba2d245cee">InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d0/d94/classRotatingCylinderProblem.html#a2cac6acd0607a98fd1b5f2c155335dbd">RotatingCylinderProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d9/d15/classInterfaceProblem.html#aedc2e58b3d2f5f8c898a21ba2d245cee">InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../da/d79/classRotatingProblem.html#a86f02f2f63f3b8f23539a0cf95fd5f0d">RotatingProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d15/classInterfaceProblem.html#aedc2e58b3d2f5f8c898a21ba2d245cee">InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../dc/da5/classMeltSpinningProblem.html#aaa5f52b28161bfbc34fccd641ca17989">MeltSpinningProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d5/d62/classPerturbedStateProblem.html#a4c7cc39dbedc2f4d549a724f8eb31cb7">PerturbedStateProblem&lt; BASE_ELEMENT, PERTURBED_ELEMENT &gt;</a>, <a class="el" href="../../d2/d3b/classBaseStateProblem.html#ab764d24a3d9262519c62034ceb0e1c30">BaseStateProblem&lt; BASE_ELEMENT &gt;</a>, <a class="el" href="../../d5/d62/classPerturbedStateProblem.html#a4c7cc39dbedc2f4d549a724f8eb31cb7">PerturbedStateProblem&lt; BASE_ELEMENT, PERTURBED_ELEMENT &gt;</a>, <a class="el" href="../../d2/d3b/classBaseStateProblem.html#ab764d24a3d9262519c62034ceb0e1c30">BaseStateProblem&lt; BASE_ELEMENT &gt;</a>, <a class="el" href="../../d7/d9c/classAxisymmetricLinearElasticityProblem.html#af9b01e082da514668a89df9213afbbd5">AxisymmetricLinearElasticityProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d1/d4b/classAxisymFvKProblem.html#a555d821decda1b7407a5f19d745d9236">AxisymFvKProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d4b/classAxisymFvKProblem.html#a555d821decda1b7407a5f19d745d9236">AxisymFvKProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/dd7/classRefineableAdvectionDiffusionPipeProblem.html#a448c0f3adab19a227282990287fc710c">RefineableAdvectionDiffusionPipeProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/d77/classUnstructuredFvKProblem.html#a22a99d4ac0107bd4fab9a75bc051e0a3">UnstructuredFvKProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/d77/classUnstructuredFvKProblem.html#a22a99d4ac0107bd4fab9a75bc051e0a3">UnstructuredFvKProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d4b/classAxisymFvKProblem.html#a555d821decda1b7407a5f19d745d9236">AxisymFvKProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d4b/classAxisymFvKProblem.html#a555d821decda1b7407a5f19d745d9236">AxisymFvKProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d21/classRefineableAdvectionDiffusionProblem.html#a949296e60bc661fbd523974055a93f8b">RefineableAdvectionDiffusionProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d3/d70/classSUPGAdvectionDiffusionProblem.html#a7ca10f3d82af3c3fec4c1a3260062ff2">SUPGAdvectionDiffusionProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../db/d16/classTwoMeshFluxAdvectionDiffusionProblem.html#ae5e1314c6772586f0fa0bc628adab7c0">TwoMeshFluxAdvectionDiffusionProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d21/classRefineableAdvectionDiffusionProblem.html#a949296e60bc661fbd523974055a93f8b">RefineableAdvectionDiffusionProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d21/classRefineableAdvectionDiffusionProblem.html#a949296e60bc661fbd523974055a93f8b">RefineableAdvectionDiffusionProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d6/d54/classSheetGlueProblem.html#acea357d2e5e7eeaa2dfcd1127334ba47">SheetGlueProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d6/d54/classSheetGlueProblem.html#acea357d2e5e7eeaa2dfcd1127334ba47">SheetGlueProblem&lt; ELEMENT &gt;</a>, and <a class="el" href="../../da/d4b/classBendingCantileverProblem.html#a6096bf6fd3323f8299c1e3882b6de8aa">BendingCantileverProblem&lt; ELEMENT &gt;</a>.</p>
<div class="fragment"><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;{}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5f08629e3c9c72b441ec7f19f175b2c7">actions_after_change_in_bifurcation_parameter()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a1e90bbe5d279295b97ae704487259bcc">actions_after_change_in_global_parameter()</a>, <a class="el" href="../../d4/d94/classoomph_1_1MyProblem.html#a3cfcfad616da35ca5ee71d039431c90e">oomph::MyProblem::actions_after_explicit_timestep()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a63805c549e71b7c73107abe6001fae25">adaptive_unsteady_newton_solve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a9f3d1c9378e385d7755184a97f5f6f91">get_fd_jacobian()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aae8cf62757e432b625ec81fad1559dc3">newton_solve()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7b86783463433cc9c4cc382b1b40f0e1">newton_solve_continuation()</a>.</p>

</div>
</div>
<a id="aed8bc6e7b0bb45b86d5b44737b554d50"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed8bc6e7b0bb45b86d5b44737b554d50">&#9670;&nbsp;</a></span>actions_after_newton_step()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void oomph::Problem::actions_after_newton_step </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Any actions that are to be performed after each individual Newton step. Most likely to be used for diagnostic purposes to doc the solution during a non-converging iteration, say. </p>

<p>Reimplemented in <a class="el" href="../../d4/d94/classoomph_1_1MyProblem.html#a6470a605e8693e68fd0239326d08ab41">oomph::MyProblem</a>, <a class="el" href="../../de/da5/classFpTestProblem.html#ab7eb9a3fce6ecdd54d67e2d3bf04fcb8">FpTestProblem</a>, <a class="el" href="../../de/da5/classFpTestProblem.html#ab7eb9a3fce6ecdd54d67e2d3bf04fcb8">FpTestProblem</a>, and <a class="el" href="../../d1/d16/classTiltedCavityProblem.html#a839ef5425dd831dfcd0ed2cf992be0c8">TiltedCavityProblem&lt; ELEMENT &gt;</a>.</p>
<div class="fragment"><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;{}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a63805c549e71b7c73107abe6001fae25">adaptive_unsteady_newton_solve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aae8cf62757e432b625ec81fad1559dc3">newton_solve()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7b86783463433cc9c4cc382b1b40f0e1">newton_solve_continuation()</a>.</p>

</div>
</div>
<a id="a54e18ddf6073f9debd478f6b21a717de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54e18ddf6073f9debd478f6b21a717de">&#9670;&nbsp;</a></span>actions_after_parameter_increase()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void oomph::Problem::actions_after_parameter_increase </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;&#160;</td>
          <td class="paramname"><em>parameter_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Empty virtual function; provides hook to perform actions after the increase in the arclength parameter (during continuation) </p>

<p>Reimplemented in <a class="el" href="../../d2/dd4/classNavierStokesProblem.html#a6e173414836372d88f387a0f6eb0cd64">NavierStokesProblem&lt; ELEMENT &gt;</a>.</p>
<div class="fragment"><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    {</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acc35de219c1c1032a14840021fd8a6b9">arc_length_step_solve_helper()</a>.</p>

</div>
</div>
<a id="a498317b3e390eddf2169ab989ee8d6b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a498317b3e390eddf2169ab989ee8d6b4">&#9670;&nbsp;</a></span>actions_after_read_unstructured_meshes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void oomph::Problem::actions_after_read_unstructured_meshes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Actions that are to be performed before reading in restart data for problems involving unstructured bulk meshes. Typically used to re-attach FaceElements, say, that were stripped out in actions_before_read_unstructured_meshes(). This function is virtual and (practically) empty but toggles a flag to indicate that it has been called. This is used to issue a warning, prompting the user to consider overloading it if the problem is found to contain unstructured bulk meshes during restarts. </p>
<div class="fragment"><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    {</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a71f87e46a571a54abd27a26f6c701c36">Empty_actions_after_read_unstructured_meshes_has_been_called</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a71f87e46a571a54abd27a26f6c701c36">Empty_actions_after_read_unstructured_meshes_has_been_called</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a4f6011ef141cc68598a9502052129a3f">read()</a>.</p>

</div>
</div>
<a id="a6130d5c9a762cdd1569919a601620796"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6130d5c9a762cdd1569919a601620796">&#9670;&nbsp;</a></span>actions_before_adapt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void oomph::Problem::actions_before_adapt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Actions that are to be performed before a mesh adaptation. These might include removing any additional elements, such as traction boundary elements before the adaptation. </p>

<p>Reimplemented in <a class="el" href="../../d9/d9c/classMortaringValidationProblem.html#a8307c014aa30e14af64d999df59ddac7">MortaringValidationProblem&lt; ELEMENT, NON_MORTAR_ELEMENT &gt;</a>, <a class="el" href="../../d9/d9c/classMortaringValidationProblem.html#a8307c014aa30e14af64d999df59ddac7">MortaringValidationProblem&lt; ELEMENT, NON_MORTAR_ELEMENT &gt;</a>, <a class="el" href="../../dd/de5/classRefineableDrivenCavityProblem.html#aca48dbdc9bd03e20770aece019a4dd2e">RefineableDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/dcf/classUnstructuredPoissonProblem.html#ac9627efd3c311156e5347ed37d4ea4b0">UnstructuredPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/de5/classRefineableDrivenCavityProblem.html#aca48dbdc9bd03e20770aece019a4dd2e">RefineableDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d4a/classRefineableYoungLaplaceProblem.html#ab64eb0b58beb3bb096ecc81b1a3f8a4f">RefineableYoungLaplaceProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d4a/classRefineableYoungLaplaceProblem.html#ab64eb0b58beb3bb096ecc81b1a3f8a4f">RefineableYoungLaplaceProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d8c/classCollapsibleChannelProblem.html#a54abc5259d590154e5dfa458d885c16c">CollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d68/classRefineableUnsteadyHeatProblem.html#a4419fcea0ccbf0509f1d5dd37d8301de">RefineableUnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d68/classRefineableUnsteadyHeatProblem.html#a4419fcea0ccbf0509f1d5dd37d8301de">RefineableUnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d68/classRefineableUnsteadyHeatProblem.html#a4419fcea0ccbf0509f1d5dd37d8301de">RefineableUnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d28/classUnsteadyHeatProblem.html#a1e8b4bd0f6d4a6662aba0592d6942d9c">UnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d28/classUnsteadyHeatProblem.html#a1e8b4bd0f6d4a6662aba0592d6942d9c">UnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d28/classUnsteadyHeatProblem.html#a1e8b4bd0f6d4a6662aba0592d6942d9c">UnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/d2c/classRingWithTRibProblem.html#a7a170199d58390ae43a044294bfc7ac5">RingWithTRibProblem&lt; ELASTICITY_ELEMENT &gt;</a>, <a class="el" href="../../d8/d28/classAnnularDiskProblem.html#a83c987045b1bdc704ed336072b8ceb16">AnnularDiskProblem&lt; ELASTICITY_ELEMENT &gt;</a>, <a class="el" href="../../d6/d48/classFourierDecomposedTimeHarmonicLinearElasticityProblem.html#a36fdaec8cffb1f6ac313515a86010d8d">FourierDecomposedTimeHarmonicLinearElasticityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d6/d48/classFourierDecomposedTimeHarmonicLinearElasticityProblem.html#a36fdaec8cffb1f6ac313515a86010d8d">FourierDecomposedTimeHarmonicLinearElasticityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dc/dff/classUnstructuredSolidProblem.html#aee583aa35ce76585230f92c9b0e84a4f">UnstructuredSolidProblem&lt; ELEMENT, MESH &gt;</a>, <a class="el" href="../../d5/d7a/classBlockCompressionProblem.html#a1ef3c8481f624020ff59b14df2a3a94e">BlockCompressionProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d27/classPrescribedBoundaryDisplacementProblem.html#a2e9f335e8680b0f2338b579e37e9d38a">PrescribedBoundaryDisplacementProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/d16/classCantileverProblem.html#a50f8964219c507562945655e0ed5fc23">CantileverProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d8c/classCollapsibleChannelProblem.html#a54abc5259d590154e5dfa458d885c16c">CollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d27/classPrescribedBoundaryDisplacementProblem.html#a2e9f335e8680b0f2338b579e37e9d38a">PrescribedBoundaryDisplacementProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d27/classPrescribedBoundaryDisplacementProblem.html#a2e9f335e8680b0f2338b579e37e9d38a">PrescribedBoundaryDisplacementProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/d16/classCantileverProblem.html#a50f8964219c507562945655e0ed5fc23">CantileverProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/d16/classCantileverProblem.html#a50f8964219c507562945655e0ed5fc23">CantileverProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d5/d48/classRefineableActivatorInhibitorProblem.html#ae1ecd9cb75ac89bc1ba45aa1db58e9f5">RefineableActivatorInhibitorProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d6f/classoomph_1_1StreamfunctionProblem.html#ac137b1f5835c3834086e5dbfe0ac2f64">oomph::StreamfunctionProblem</a>, <a class="el" href="../../d2/d5a/classPolarNSProblem.html#ae0a9f2fc2142f97891d7ca62c01ee841">PolarNSProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d43/classRefineableTwoMeshFluxPoissonProblem.html#a10d2a67a5ac599161ddcf876b31334f6">RefineableTwoMeshFluxPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/de1/classEighthSpherePoissonProblem.html#a99f5500a244f5891e76e82cf227208e8">EighthSpherePoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/de5/classElasticAnnulusProblem.html#abc8f38dd49a37b06212c168588301900">ElasticAnnulusProblem&lt; ELASTICITY_ELEMENT &gt;</a>, <a class="el" href="../../df/de5/classElasticAnnulusProblem.html#abc8f38dd49a37b06212c168588301900">ElasticAnnulusProblem&lt; ELASTICITY_ELEMENT &gt;</a>, <a class="el" href="../../d4/d68/classRefineableUnsteadyHeatProblem.html#a4419fcea0ccbf0509f1d5dd37d8301de">RefineableUnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d3/d26/classVorticityRecoveryProblem.html#a5811b395aacf019a5382f6da3ec1cfb7">VorticityRecoveryProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/dee/classDropInChannelProblem.html#a4d4ae7fdef14f9838a46cc45278c7920">DropInChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../da/def/classBubbleInChannelProblem.html#aae0753340720453a44622c4dbb8807fb">BubbleInChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d5/d3c/classUnstructuredFluidProblem.html#abd48f5ffcc8f1a98d029045ab81f3131">UnstructuredFluidProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d3/d70/classTwoLayerInterfaceProblem.html#a89431a4ad9400976c295c4cfd04b3727">TwoLayerInterfaceProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d15/classInterfaceProblem.html#a944e5754e9b3f3394211b6c62f705abe">InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../db/d50/classOscEllipseProblem.html#a97c1b0056acbb9a6ec6157b6e7ad258a">OscEllipseProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../db/dda/classUnstructuredImmersedEllipseProblem.html#aa560217a33a9a9bc150fbdf15dbf1877">UnstructuredImmersedEllipseProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d8c/classCollapsibleChannelProblem.html#a54abc5259d590154e5dfa458d885c16c">CollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dc/d83/classFlowAroundCylinderProblem.html#a630fc1d0c4eb7e1a48726d712084d8b0">FlowAroundCylinderProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d8c/classCollapsibleChannelProblem.html#a54abc5259d590154e5dfa458d885c16c">CollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d8c/classCollapsibleChannelProblem.html#a54abc5259d590154e5dfa458d885c16c">CollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d2/d3d/classRefineableRotatingCylinderProblem.html#a705922ef2d96697ea5a110a412db5287">RefineableRotatingCylinderProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../de/d9e/classFluxPoissonMGProblem.html#a37d6136f64cfb9d03d74b7bafa5932a4">FluxPoissonMGProblem&lt; ELEMENT, MESH &gt;</a>, <a class="el" href="../../de/d9e/classFluxPoissonMGProblem.html#a37d6136f64cfb9d03d74b7bafa5932a4">FluxPoissonMGProblem&lt; ELEMENT, MESH &gt;</a>, <a class="el" href="../../dc/d88/classPMLHelmholtzMGProblem.html#a267af72b7eed2a0b41b37a4671103d4e">PMLHelmholtzMGProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d22/classPMLStructuredCubicHelmholtz.html#a8bbdc16499e23973b90763feed42fb39">PMLStructuredCubicHelmholtz&lt; ELEMENT &gt;</a>, <a class="el" href="../../d7/d86/classSurfactantProblem.html#a334842cf2e76cff096cf119c627d5769">SurfactantProblem&lt; ELEMENT, INTERFACE_ELEMENT &gt;</a>, <a class="el" href="../../d7/d86/classSurfactantProblem.html#a334842cf2e76cff096cf119c627d5769">SurfactantProblem&lt; ELEMENT, INTERFACE_ELEMENT &gt;</a>, <a class="el" href="../../da/d36/classThermalProblem.html#a40bda0a4d45851f7e45dc461107d7c0f">ThermalProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d3/d00/classConvectionProblem.html#a755dab4b831cc5cedbbfaa3ac9b8a47b">ConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../db/d70/classRefineableDDConvectionProblem.html#a60c3507f185e343b6dc4256cea544b43">RefineableDDConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d1/d6e/classDDConvectionProblem.html#aadcbbf889c3349dd2505e7e7df154e96">DDConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d3/d00/classConvectionProblem.html#a755dab4b831cc5cedbbfaa3ac9b8a47b">ConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d1/d1f/classRefineableConvectionProblem.html#a962499683ada1233e20055e46b15fdb0">RefineableConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d1/d1f/classRefineableConvectionProblem.html#a962499683ada1233e20055e46b15fdb0">RefineableConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d3/d00/classConvectionProblem.html#a755dab4b831cc5cedbbfaa3ac9b8a47b">ConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d3/d00/classConvectionProblem.html#a755dab4b831cc5cedbbfaa3ac9b8a47b">ConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d1/d1f/classRefineableConvectionProblem.html#a962499683ada1233e20055e46b15fdb0">RefineableConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d1/d1f/classRefineableConvectionProblem.html#a962499683ada1233e20055e46b15fdb0">RefineableConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d4/d57/classRectangularDrivenCavityProblem.html#af6670e872dbd31019a814b61fdcb3843">RectangularDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/d16/classCantileverProblem.html#a50f8964219c507562945655e0ed5fc23">CantileverProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d3/db4/classPseudoElasticCollapsibleChannelProblem.html#a3a1d51547afa5d495e15e337715d8634">PseudoElasticCollapsibleChannelProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;</a>, <a class="el" href="../../dd/da6/classFSICollapsibleChannelProblem.html#a91b30b3d0369c178d3a79f5658644f1b">FSICollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d1f/classRefineableConvectionProblem.html#a962499683ada1233e20055e46b15fdb0">RefineableConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d1/d1f/classRefineableConvectionProblem.html#a962499683ada1233e20055e46b15fdb0">RefineableConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d3/d00/classConvectionProblem.html#a755dab4b831cc5cedbbfaa3ac9b8a47b">ConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a2b6eb16cd453906d65154351466222f0">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a2b6eb16cd453906d65154351466222f0">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a2b6eb16cd453906d65154351466222f0">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d43/classRefineableTwoMeshFluxPoissonProblem.html#a10d2a67a5ac599161ddcf876b31334f6">RefineableTwoMeshFluxPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d27/classPrescribedBoundaryDisplacementProblem.html#a2e9f335e8680b0f2338b579e37e9d38a">PrescribedBoundaryDisplacementProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/d16/classCantileverProblem.html#a50f8964219c507562945655e0ed5fc23">CantileverProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d68/classRefineableUnsteadyHeatProblem.html#a4419fcea0ccbf0509f1d5dd37d8301de">RefineableUnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d27/classPrescribedBoundaryDisplacementProblem.html#a2e9f335e8680b0f2338b579e37e9d38a">PrescribedBoundaryDisplacementProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d27/classPrescribedBoundaryDisplacementProblem.html#a2e9f335e8680b0f2338b579e37e9d38a">PrescribedBoundaryDisplacementProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../de/d23/classRefineableFishPoissonProblem.html#a442ca4b32e05db1c6f5b6bb3b20be85e">RefineableFishPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/d16/classCantileverProblem.html#a50f8964219c507562945655e0ed5fc23">CantileverProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dc/dff/classUnstructuredSolidProblem.html#a463b4b976fdd12129ac2bd23bece1b8b">UnstructuredSolidProblem&lt; ELEMENT, MESH &gt;</a>, <a class="el" href="../../d1/dc3/classScatteringProblem.html#aca1b756a307f9c1d8a70c7b7e68a296b">ScatteringProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/dcf/classUnstructuredPoissonProblem.html#ac9627efd3c311156e5347ed37d4ea4b0">UnstructuredPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../de/d7c/classTetmeshPoissonProblem.html#a2ae5b971edab003ec9fbc2349e55a1aa">TetmeshPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../de/d7c/classTetmeshPoissonProblem.html#a2ae5b971edab003ec9fbc2349e55a1aa">TetmeshPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../db/d16/classTwoMeshFluxAdvectionDiffusionProblem.html#a3ea654224e481f37e8bde4edb38993cc">TwoMeshFluxAdvectionDiffusionProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d7/dc1/classRefineablePeriodicLoadProblem.html#aae144ae04342a103a870d9dfbf29c188">RefineablePeriodicLoadProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/dee/classUnstructuredFSIProblem.html#a47a4307323e4dd598fdca542144f4bd2">UnstructuredFSIProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;</a>, <a class="el" href="../../d3/db4/classPseudoElasticCollapsibleChannelProblem.html#a3a1d51547afa5d495e15e337715d8634">PseudoElasticCollapsibleChannelProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;</a>, <a class="el" href="../../d3/db4/classPseudoElasticCollapsibleChannelProblem.html#a3a1d51547afa5d495e15e337715d8634">PseudoElasticCollapsibleChannelProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;</a>, <a class="el" href="../../dd/da6/classFSICollapsibleChannelProblem.html#a91b30b3d0369c178d3a79f5658644f1b">FSICollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/da6/classFSICollapsibleChannelProblem.html#a91b30b3d0369c178d3a79f5658644f1b">FSICollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d5/d09/classCoatedSphereProblem.html#a0cd5d4eea9d34eefd829f7539c41c998">CoatedSphereProblem&lt; ELASTICITY_ELEMENT, HELMHOLTZ_ELEMENT &gt;</a>, <a class="el" href="../../d3/d0f/classCoatedDiskProblem.html#a89e972df172b024b1358f0fac7646d6d">CoatedDiskProblem&lt; ELASTICITY_ELEMENT, HELMHOLTZ_ELEMENT &gt;</a>, <a class="el" href="../../d3/d0f/classCoatedDiskProblem.html#a89e972df172b024b1358f0fac7646d6d">CoatedDiskProblem&lt; ELASTICITY_ELEMENT, HELMHOLTZ_ELEMENT &gt;</a>, <a class="el" href="../../d1/dc3/classScatteringProblem.html#aca1b756a307f9c1d8a70c7b7e68a296b">ScatteringProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/dc3/classScatteringProblem.html#af93e4dffd466ad20ecd8a9b61bee1080">ScatteringProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d7/dd7/classHelmholtzPointSourceProblem.html#a0ee7e7fd35b585ae57d5c59588e8093b">HelmholtzPointSourceProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/dec/classContactProblem.html#a0710e91dbedb87196e16a438ae8c9ebe">ContactProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/dec/classContactProblem.html#a0710e91dbedb87196e16a438ae8c9ebe">ContactProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d28/classUnsteadyHeatProblem.html#a1e8b4bd0f6d4a6662aba0592d6942d9c">UnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/dcb/classUnsteadyHeatMeltProblem.html#a00debdbf7c25123a389c530340a685ac">UnsteadyHeatMeltProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/dec/classContactProblem.html#a0710e91dbedb87196e16a438ae8c9ebe">ContactProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/dec/classContactProblem.html#a0710e91dbedb87196e16a438ae8c9ebe">ContactProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d2/d8e/classSolarRadiationProblem.html#a6498559cb554ca0882b8b1c71c97ea80">SolarRadiationProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d73/classMeltContactProblem.html#aaf3de2f9f7f393c2db019bac4d24cc13">MeltContactProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d70/classVibratingShellProblem.html#a964faf2b0d743d671125542b36bdba3c">VibratingShellProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d7d/classAxisymmetricVibratingShellProblem.html#a01e5727e6198bacdf8144a044d60f808">AxisymmetricVibratingShellProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d32/classFourierDecomposedHelmholtzProblem.html#acbc6f3c692463e5a098ccec7fe9029c1">FourierDecomposedHelmholtzProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/d77/classUnstructuredFvKProblem.html#aaa7eda48b5e97f752fed099ac3661cc3">UnstructuredFvKProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d3/d84/classUnstructuredTorusProblem.html#a9cb46ef37254fbc2de457a4016f4862e">UnstructuredTorusProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d15/classInterfaceProblem.html#a944e5754e9b3f3394211b6c62f705abe">InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d9/dd7/classRefineableAdvectionDiffusionPipeProblem.html#ae9f53c49f22474c7bce5afcdd91109b7">RefineableAdvectionDiffusionPipeProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d21/classRefineableAdvectionDiffusionProblem.html#a3470a408c458e5500ac614b8f0e65634">RefineableAdvectionDiffusionProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../db/d16/classTwoMeshFluxAdvectionDiffusionProblem.html#a3ea654224e481f37e8bde4edb38993cc">TwoMeshFluxAdvectionDiffusionProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d21/classRefineableAdvectionDiffusionProblem.html#a3470a408c458e5500ac614b8f0e65634">RefineableAdvectionDiffusionProblem&lt; ELEMENT &gt;</a>, and <a class="el" href="../../d9/d9c/classMortaringValidationProblem.html#a4fdeb498eaa64a059bbda50d739b81a4">MortaringValidationProblem&lt; ELEMENT, NON_MORTAR_ELEMENT &gt;</a>.</p>
<div class="fragment"><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;{}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5e60c7b47591bca6b20b0612e119983">adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a309487c952f108015b53a2d70539ac8b">adapt_based_on_error_estimates()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a350e611af4847eabfa1d531b14b4439c">p_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad73bff32f14763e813cabdcd4c88c06">p_refine_selected_elements()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a093b78c1820cf3fe6bd9ec3deb605b49">p_refine_uniformly()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7460f9339fd4850112284a86e039ee00">p_refine_uniformly_aux()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#afa0aab9ca7018bf875c1f3367c6c07e3">p_unrefine_uniformly()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a4f6011ef141cc68598a9502052129a3f">read()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a3dcfc37fe1b6c21d694407981830c1e5">refine_selected_elements()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a1ce3a9162aaef9e0a4d86f8de57eb523">refine_uniformly()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#affb22db0c6f1e14ae120b153b85831a3">refine_uniformly_aux()</a>, <a class="el" href="../../dc/d2e/classoomph_1_1MGSolver.html#a8b25ea9a7781f95ddf46b4b8d427d3d0">oomph::MGSolver&lt; DIM &gt;::setup_mg_hierarchy()</a>, <a class="el" href="../../da/d32/classoomph_1_1HelmholtzMGPreconditioner.html#ad811c870bf06b25f3237c84b5037e089">oomph::HelmholtzMGPreconditioner&lt; DIM &gt;::setup_mg_hierarchy()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a56429d79e517d59a54cd49949b04d3ae">unrefine_uniformly()</a>.</p>

</div>
</div>
<a id="a6ae06bc0ecba349ebdf76220c1a17546"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ae06bc0ecba349ebdf76220c1a17546">&#9670;&nbsp;</a></span>actions_before_explicit_timestep()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void oomph::Problem::actions_before_explicit_timestep </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Actions that should be performed before each explicit time step. </p>

<p>Reimplemented from <a class="el" href="../../df/d86/classoomph_1_1ExplicitTimeSteppableObject.html#ae169b713aa971921bfd1269de898b934">oomph::ExplicitTimeSteppableObject</a>.</p>

<p>Reimplemented in <a class="el" href="../../d4/d94/classoomph_1_1MyProblem.html#af1df06486179dc7734494f5c88ab4754">oomph::MyProblem</a>.</p>
<div class="fragment"><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;{}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4f19896906d2c0274ad6798cd3ac38dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f19896906d2c0274ad6798cd3ac38dc">&#9670;&nbsp;</a></span>actions_before_implicit_timestep()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void oomph::Problem::actions_before_implicit_timestep </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Actions that should be performed before each implicit time step. This is needed when one wants to solve a steady problem before timestepping and needs to distinguish between the two cases </p>

<p>Reimplemented in <a class="el" href="../../d3/d73/classoomph_1_1WomersleyProblem.html#af87f80658aaadaee2d7c8d0c06ad159e">oomph::WomersleyProblem&lt; ELEMENT, DIM &gt;</a>, <a class="el" href="../../d1/d8c/classCollapsibleChannelProblem.html#a4c365050b11c184007b8e1cd6079147f">CollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d28/classUnsteadyHeatProblem.html#a7074e52f6a3a791549687e1b4ddd059a">UnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d68/classRefineableUnsteadyHeatProblem.html#ac754f1313cd6d684c149443beb5bcf9e">RefineableUnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d68/classRefineableUnsteadyHeatProblem.html#ac754f1313cd6d684c149443beb5bcf9e">RefineableUnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d68/classRefineableUnsteadyHeatProblem.html#ac754f1313cd6d684c149443beb5bcf9e">RefineableUnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d28/classUnsteadyHeatProblem.html#a7074e52f6a3a791549687e1b4ddd059a">UnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d28/classUnsteadyHeatProblem.html#a7074e52f6a3a791549687e1b4ddd059a">UnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d2/da3/classSphericalSpinUpProblem.html#a1d5d21edb3dc41549e5b717a896dcac1">SphericalSpinUpProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d2/da3/classSphericalSpinUpProblem.html#a1d5d21edb3dc41549e5b717a896dcac1">SphericalSpinUpProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d6/df1/classRefineableSphericalSpinUpProblem.html#a1578a52c5b09bcb1a3f19f65c91a7a32">RefineableSphericalSpinUpProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d6/df1/classRefineableSphericalSpinUpProblem.html#a1578a52c5b09bcb1a3f19f65c91a7a32">RefineableSphericalSpinUpProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d8c/classCollapsibleChannelProblem.html#a4c365050b11c184007b8e1cd6079147f">CollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d68/classRefineableUnsteadyHeatProblem.html#ac754f1313cd6d684c149443beb5bcf9e">RefineableUnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d28/classUnsteadyHeatProblem.html#a7074e52f6a3a791549687e1b4ddd059a">UnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d6/da9/classRayleighProblem.html#a873a81442a28c7616fbe616d9068f8b9">RayleighProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d6/da9/classRayleighProblem.html#a873a81442a28c7616fbe616d9068f8b9">RayleighProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d4/d94/classoomph_1_1MyProblem.html#a4069aa5760c5170e3df458b257c21e16">oomph::MyProblem</a>, <a class="el" href="../../d5/d3c/classUnstructuredFluidProblem.html#a310271696178d94145ede15c4887a9c4">UnstructuredFluidProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d15/classInterfaceProblem.html#ae3ec75fcc8ccca97207dc7eca23b1cce">InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d7/dcc/classTurekNonFSIProblem.html#a29725cde9071c3a83792469787ea6c7d">TurekNonFSIProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d15/classInterfaceProblem.html#ae3ec75fcc8ccca97207dc7eca23b1cce">InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../de/d2b/classRayleighTractionProblem.html#aea3e470265c0e98a8b5bdabedd28eb82">RayleighTractionProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d6/da9/classRayleighProblem.html#a873a81442a28c7616fbe616d9068f8b9">RayleighProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../dd/d71/classOscRingNStProblem.html#a8c5c9c3c87c4e48249090a3c554fcb85">OscRingNStProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../db/d50/classOscEllipseProblem.html#a7b12b4fdfcb46c3f00885f0a1f9965b3">OscEllipseProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../db/dda/classUnstructuredImmersedEllipseProblem.html#a368c412c4c9a9e9403b4e67d3582e3a5">UnstructuredImmersedEllipseProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/da8/classInclinedPlaneProblem.html#af9cf7a9677e823c52f1646105dfa7937">InclinedPlaneProblem&lt; ELEMENT, INTERFACE_ELEMENT &gt;</a>, <a class="el" href="../../d1/d8c/classCollapsibleChannelProblem.html#a4c365050b11c184007b8e1cd6079147f">CollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dc/d83/classFlowAroundCylinderProblem.html#aea8798539805a2dfe99eb47503ce0071">FlowAroundCylinderProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d8c/classCollapsibleChannelProblem.html#a4c365050b11c184007b8e1cd6079147f">CollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d8c/classCollapsibleChannelProblem.html#a4c365050b11c184007b8e1cd6079147f">CollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d2/d1f/classChannelWithLeafletProblem.html#acef6ec771775162f77295a8f92d695ac">ChannelWithLeafletProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d7/d86/classSurfactantProblem.html#a84cb75a6a6e73465adaa1786e4dc8da2">SurfactantProblem&lt; ELEMENT, INTERFACE_ELEMENT &gt;</a>, <a class="el" href="../../d7/d86/classSurfactantProblem.html#a84cb75a6a6e73465adaa1786e4dc8da2">SurfactantProblem&lt; ELEMENT, INTERFACE_ELEMENT &gt;</a>, <a class="el" href="../../d7/d86/classSurfactantProblem.html#a84cb75a6a6e73465adaa1786e4dc8da2">SurfactantProblem&lt; ELEMENT, INTERFACE_ELEMENT &gt;</a>, <a class="el" href="../../d8/d6a/classRefineableSphereConvectionProblem.html#afd599a1a0f4bb27306678bd6e279c32b">RefineableSphereConvectionProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d3/d00/classConvectionProblem.html#a07cc945f4457985d1ededfc768761466">ConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d3/d00/classConvectionProblem.html#a07cc945f4457985d1ededfc768761466">ConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d3/d00/classConvectionProblem.html#a07cc945f4457985d1ededfc768761466">ConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d3/d00/classConvectionProblem.html#a07cc945f4457985d1ededfc768761466">ConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../db/d70/classRefineableDDConvectionProblem.html#ae3d06ff7d65490d2a7729bf2361200db">RefineableDDConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d1/d6e/classDDConvectionProblem.html#a0153ff1072e744533928ca81c3abff03">DDConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d3/d00/classConvectionProblem.html#a07cc945f4457985d1ededfc768761466">ConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d3/d00/classConvectionProblem.html#a07cc945f4457985d1ededfc768761466">ConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d3/d00/classConvectionProblem.html#a07cc945f4457985d1ededfc768761466">ConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../dd/d4a/classFSIChannelWithLeafletProblem.html#ac73220fa534cf2409bb0ebcf2fb5e1d5">FSIChannelWithLeafletProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/dfc/classTurekProblem.html#a4ad226ceec27cb3c3ea4d1ecfd4e573f">TurekProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;</a>, <a class="el" href="../../d1/dfc/classTurekProblem.html#a4ad226ceec27cb3c3ea4d1ecfd4e573f">TurekProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;</a>, <a class="el" href="../../d3/db4/classPseudoElasticCollapsibleChannelProblem.html#af8c1dde2ab554ade4fa78496dca68b1b">PseudoElasticCollapsibleChannelProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;</a>, <a class="el" href="../../dd/d4a/classFSIChannelWithLeafletProblem.html#ac73220fa534cf2409bb0ebcf2fb5e1d5">FSIChannelWithLeafletProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d3/d00/classConvectionProblem.html#a07cc945f4457985d1ededfc768761466">ConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d4/d68/classRefineableUnsteadyHeatProblem.html#ac754f1313cd6d684c149443beb5bcf9e">RefineableUnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d5/d62/classPerturbedStateProblem.html#a3d9f3af45bbfc6d8d50f865ef3c2009c">PerturbedStateProblem&lt; BASE_ELEMENT, PERTURBED_ELEMENT &gt;</a>, <a class="el" href="../../d2/d3b/classBaseStateProblem.html#a8464499d773ea30add57cbf3b6449a61">BaseStateProblem&lt; BASE_ELEMENT &gt;</a>, <a class="el" href="../../d5/d62/classPerturbedStateProblem.html#a3d9f3af45bbfc6d8d50f865ef3c2009c">PerturbedStateProblem&lt; BASE_ELEMENT, PERTURBED_ELEMENT &gt;</a>, <a class="el" href="../../d2/d3b/classBaseStateProblem.html#a8464499d773ea30add57cbf3b6449a61">BaseStateProblem&lt; BASE_ELEMENT &gt;</a>, <a class="el" href="../../d5/d62/classPerturbedStateProblem.html#a3d9f3af45bbfc6d8d50f865ef3c2009c">PerturbedStateProblem&lt; BASE_ELEMENT, PERTURBED_ELEMENT &gt;</a>, <a class="el" href="../../d2/d3b/classBaseStateProblem.html#a8464499d773ea30add57cbf3b6449a61">BaseStateProblem&lt; BASE_ELEMENT &gt;</a>, <a class="el" href="../../d5/d62/classPerturbedStateProblem.html#a3d9f3af45bbfc6d8d50f865ef3c2009c">PerturbedStateProblem&lt; BASE_ELEMENT, PERTURBED_ELEMENT &gt;</a>, <a class="el" href="../../d2/d3b/classBaseStateProblem.html#a8464499d773ea30add57cbf3b6449a61">BaseStateProblem&lt; BASE_ELEMENT &gt;</a>, <a class="el" href="../../d4/db2/classLinearWaveProblem.html#a39cfcb8ce06463ace1ac09fa43afa00a">LinearWaveProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d4/db2/classLinearWaveProblem.html#a39cfcb8ce06463ace1ac09fa43afa00a">LinearWaveProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d4/db2/classLinearWaveProblem.html#a39cfcb8ce06463ace1ac09fa43afa00a">LinearWaveProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../dd/dee/classUnstructuredFSIProblem.html#af801b29e73db6ab56cb73208f894a7f7">UnstructuredFSIProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;</a>, <a class="el" href="../../d1/dfc/classTurekProblem.html#a4ad226ceec27cb3c3ea4d1ecfd4e573f">TurekProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;</a>, <a class="el" href="../../dd/d4a/classFSIChannelWithLeafletProblem.html#ac73220fa534cf2409bb0ebcf2fb5e1d5">FSIChannelWithLeafletProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d3/db4/classPseudoElasticCollapsibleChannelProblem.html#af8c1dde2ab554ade4fa78496dca68b1b">PseudoElasticCollapsibleChannelProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;</a>, <a class="el" href="../../d3/db4/classPseudoElasticCollapsibleChannelProblem.html#af8c1dde2ab554ade4fa78496dca68b1b">PseudoElasticCollapsibleChannelProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;</a>, <a class="el" href="../../d6/d53/classPressureWaveFSIProblem.html#aaf5bc54f4dd28b34c2147268033f72a4">PressureWaveFSIProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;</a>, <a class="el" href="../../d6/d53/classPressureWaveFSIProblem.html#aaf5bc54f4dd28b34c2147268033f72a4">PressureWaveFSIProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;</a>, <a class="el" href="../../d5/df4/classFSIDrivenCavityProblem.html#af95b7c6d9f775dff32f4593212c2868f">FSIDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d4a/classFSIChannelWithLeafletProblem.html#ac73220fa534cf2409bb0ebcf2fb5e1d5">FSIChannelWithLeafletProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d28/classUnsteadyHeatProblem.html#a7074e52f6a3a791549687e1b4ddd059a">UnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d00/classStefanBoltzmannProblem.html#ab9981dc2301b2d0c7d44ab69d7e10f1a">StefanBoltzmannProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/dec/classContactProblem.html#a8ef9fde35a92e90c6cfdb130847218b7">ContactProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/dec/classContactProblem.html#a8ef9fde35a92e90c6cfdb130847218b7">ContactProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d2/d8e/classSolarRadiationProblem.html#a03ef113d06178f98e24f0ae9028a9263">SolarRadiationProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d73/classMeltContactProblem.html#a46fb5cf86c259f50d323100d2d07cf7c">MeltContactProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d33/classRefineablePorousChannelProblem.html#a95479e1f7b8bc9b1fc643cef795a9908">RefineablePorousChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d3/d7a/classAxiPoroProblem.html#a1dacac0bc7da7e5ba8ffd87743df8e77">AxiPoroProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d3/d84/classUnstructuredTorusProblem.html#a0a05b5501bdc60ed2d67ca5f7ec320c9">UnstructuredTorusProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d3/d84/classUnstructuredTorusProblem.html#a0a05b5501bdc60ed2d67ca5f7ec320c9">UnstructuredTorusProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d15/classInterfaceProblem.html#ae3ec75fcc8ccca97207dc7eca23b1cce">InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d6/d07/classTorusProblem.html#a197f900b79b2314d762faf3598bf5540">TorusProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d5/d62/classPerturbedStateProblem.html#a3d9f3af45bbfc6d8d50f865ef3c2009c">PerturbedStateProblem&lt; BASE_ELEMENT, PERTURBED_ELEMENT &gt;</a>, <a class="el" href="../../d2/d3b/classBaseStateProblem.html#a8464499d773ea30add57cbf3b6449a61">BaseStateProblem&lt; BASE_ELEMENT &gt;</a>, <a class="el" href="../../d5/d62/classPerturbedStateProblem.html#a3d9f3af45bbfc6d8d50f865ef3c2009c">PerturbedStateProblem&lt; BASE_ELEMENT, PERTURBED_ELEMENT &gt;</a>, <a class="el" href="../../d2/d3b/classBaseStateProblem.html#a8464499d773ea30add57cbf3b6449a61">BaseStateProblem&lt; BASE_ELEMENT &gt;</a>, and <a class="el" href="../../d7/d9c/classAxisymmetricLinearElasticityProblem.html#a6ea18ecd60fd5878522ae6024cb57dee">AxisymmetricLinearElasticityProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>.</p>
<div class="fragment"><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;{}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a63805c549e71b7c73107abe6001fae25">adaptive_unsteady_newton_solve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a4b015281f27d25ee0209cd9b467175b6">unsteady_newton_solve()</a>, and <a class="el" href="../../de/da7/classoomph_1_1SegregatableFSIProblem.html#a17f019ebaf83e170219bf605a8554111">oomph::SegregatableFSIProblem::unsteady_segregated_solve()</a>.</p>

</div>
</div>
<a id="ae6ad96ddf5d48b517b89c9a9b879bc4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6ad96ddf5d48b517b89c9a9b879bc4b">&#9670;&nbsp;</a></span>actions_before_newton_convergence_check()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void oomph::Problem::actions_before_newton_convergence_check </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Any actions that are to be performed before the residual is checked in the Newton method, e.g. update any boundary conditions that depend upon variables of the problem; update any &lsquo;dependent&rsquo; variables; or perform an update of the nodal positions in SpineMeshes etc. CAREFUL: This step should (and if the FD-based LinearSolver FD_LU is used, must) only update values that are pinned! </p>

<p>Reimplemented in <a class="el" href="../../d1/d8c/classCollapsibleChannelProblem.html#ae98da2352f60b510d4edb914902542bb">CollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d2/d5a/classPolarNSProblem.html#a18548e8c0ce57fb6c5da2176b2e4d2ec">PolarNSProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../de/d23/classRefineableFishPoissonProblem.html#a8d8fb7ef1c571c57c02073edab4a7759">RefineableFishPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/da6/classFSICollapsibleChannelProblem.html#ace5343d2e6e6e0480d077d4f17365288">FSICollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d5/d3c/classUnstructuredFluidProblem.html#ae3198435727e6da49fd814f81f7923b2">UnstructuredFluidProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d15/classInterfaceProblem.html#ab4193771472aefce4cd67261491cc344">InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d9/d2f/classFreeSurfaceRotationProblem.html#a3b0c1d46235f3bf2bcd9cffa653eafc0">FreeSurfaceRotationProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d15/classInterfaceProblem.html#ab4193771472aefce4cd67261491cc344">InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d9/d91/classThreeDimBethertonProblem.html#ae45792bf8f193e26ce3f7636b9641724">ThreeDimBethertonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/de6/classCapProblem.html#ac852570b51489f4bf744b6063fbfa01a">CapProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/de6/classCapProblem.html#ac852570b51489f4bf744b6063fbfa01a">CapProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d15/classInterfaceProblem.html#ab4193771472aefce4cd67261491cc344">InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../dd/d71/classOscRingNStProblem.html#a98d4c847cd9d53ab3569b8418ecb0c6b">OscRingNStProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../db/dda/classUnstructuredImmersedEllipseProblem.html#afa51876a2af9dd7640ff1f5a434804bf">UnstructuredImmersedEllipseProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d2f/classFreeSurfaceRotationProblem.html#a3b0c1d46235f3bf2bcd9cffa653eafc0">FreeSurfaceRotationProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5b/classBrethertonProblem.html#a6a3e76e4900715d8c2fd15d0e350d724">BrethertonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d7/d86/classSurfactantProblem.html#a015e8b3fd78a7b58673eed46b30720bb">SurfactantProblem&lt; ELEMENT, INTERFACE_ELEMENT &gt;</a>, <a class="el" href="../../d7/d86/classSurfactantProblem.html#a015e8b3fd78a7b58673eed46b30720bb">SurfactantProblem&lt; ELEMENT, INTERFACE_ELEMENT &gt;</a>, <a class="el" href="../../d7/d86/classSurfactantProblem.html#a015e8b3fd78a7b58673eed46b30720bb">SurfactantProblem&lt; ELEMENT, INTERFACE_ELEMENT &gt;</a>, <a class="el" href="../../df/d37/classAxisymFreeSurfaceNozzleAdvDiffRobinProblem.html#a3fe5c291465078cc11e2addc926c55f1">AxisymFreeSurfaceNozzleAdvDiffRobinProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d3/d00/classConvectionProblem.html#a0abae5756e93db96bb49fd5271b6057d">ConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d9/d15/classInterfaceProblem.html#ab4193771472aefce4cd67261491cc344">InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d9/d15/classInterfaceProblem.html#ab4193771472aefce4cd67261491cc344">InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d3/d00/classConvectionProblem.html#a0abae5756e93db96bb49fd5271b6057d">ConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d3/d00/classConvectionProblem.html#a0abae5756e93db96bb49fd5271b6057d">ConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d3/d00/classConvectionProblem.html#a0abae5756e93db96bb49fd5271b6057d">ConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a1f763a4c1e9497a3f6170b37ff6b2405">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d4a/classFSIChannelWithLeafletProblem.html#aff02228eddae18ef3d57306ba1e61495">FSIChannelWithLeafletProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/dfc/classTurekProblem.html#aa896171b1a817ca35cba9b723bb15ed2">TurekProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;</a>, <a class="el" href="../../d1/dfc/classTurekProblem.html#aa896171b1a817ca35cba9b723bb15ed2">TurekProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;</a>, <a class="el" href="../../d3/db4/classPseudoElasticCollapsibleChannelProblem.html#ac41f0bbdd6ac27dcf26417a8d79c29f1">PseudoElasticCollapsibleChannelProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;</a>, <a class="el" href="../../da/db6/classFSIRingProblem.html#afaf315a9b0feb319cf66b21f959e465e">FSIRingProblem</a>, <a class="el" href="../../dd/da6/classFSICollapsibleChannelProblem.html#ace5343d2e6e6e0480d077d4f17365288">FSICollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d4a/classFSIChannelWithLeafletProblem.html#aff02228eddae18ef3d57306ba1e61495">FSIChannelWithLeafletProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../da/d79/classRotatingProblem.html#a4dbea5085c92e8c5a924c22fadd34de6">RotatingProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/dc3/classScatteringProblem.html#ad096c311ee474d23514656d2ba76a4b8">ScatteringProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d5/d62/classPerturbedStateProblem.html#a820a9b042e3d4362c54aaae0d3685736">PerturbedStateProblem&lt; BASE_ELEMENT, PERTURBED_ELEMENT &gt;</a>, <a class="el" href="../../d2/d3b/classBaseStateProblem.html#a03fbb718142912eeeaed34e698c46f70">BaseStateProblem&lt; BASE_ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a1f763a4c1e9497a3f6170b37ff6b2405">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a1f763a4c1e9497a3f6170b37ff6b2405">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/dee/classUnstructuredFSIProblem.html#a1e70ec736dc0f7b03c3c991ba8737212">UnstructuredFSIProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;</a>, <a class="el" href="../../d1/dfc/classTurekProblem.html#aa896171b1a817ca35cba9b723bb15ed2">TurekProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;</a>, <a class="el" href="../../dd/d4a/classFSIChannelWithLeafletProblem.html#aff02228eddae18ef3d57306ba1e61495">FSIChannelWithLeafletProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d3/db4/classPseudoElasticCollapsibleChannelProblem.html#ac41f0bbdd6ac27dcf26417a8d79c29f1">PseudoElasticCollapsibleChannelProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;</a>, <a class="el" href="../../d3/db4/classPseudoElasticCollapsibleChannelProblem.html#ac41f0bbdd6ac27dcf26417a8d79c29f1">PseudoElasticCollapsibleChannelProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;</a>, <a class="el" href="../../dd/d71/classOscRingNStProblem.html#a98d4c847cd9d53ab3569b8418ecb0c6b">OscRingNStProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d71/classOscRingNStProblem.html#a98d4c847cd9d53ab3569b8418ecb0c6b">OscRingNStProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../da/db6/classFSIRingProblem.html#afaf315a9b0feb319cf66b21f959e465e">FSIRingProblem</a>, <a class="el" href="../../da/db6/classFSIRingProblem.html#afaf315a9b0feb319cf66b21f959e465e">FSIRingProblem</a>, <a class="el" href="../../df/dac/classSegregatedFSIDrivenCavityProblem.html#aea1216733b95e737ddc76f2c4093ba6e">SegregatedFSIDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d5/df4/classFSIDrivenCavityProblem.html#ac705b4de5cf1feb302fdfba69a1d4adc">FSIDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/da6/classFSICollapsibleChannelProblem.html#ace5343d2e6e6e0480d077d4f17365288">FSICollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/da6/classFSICollapsibleChannelProblem.html#ace5343d2e6e6e0480d077d4f17365288">FSICollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/da6/classFSICollapsibleChannelProblem.html#ace5343d2e6e6e0480d077d4f17365288">FSICollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/da6/classFSICollapsibleChannelProblem.html#ace5343d2e6e6e0480d077d4f17365288">FSICollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d4a/classFSIChannelWithLeafletProblem.html#aff02228eddae18ef3d57306ba1e61495">FSIChannelWithLeafletProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d96/classSegregatedFSICollapsibleChannelProblem.html#a2613090b2abf3809de381da12f1cd0d2">SegregatedFSICollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d96/classSegregatedFSICollapsibleChannelProblem.html#a2613090b2abf3809de381da12f1cd0d2">SegregatedFSICollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/da6/classFSICollapsibleChannelProblem.html#ace5343d2e6e6e0480d077d4f17365288">FSICollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d9d/classPreconditionedFSICollapsibleChannelProblem.html#a5c801b6aaaeb5a6647b42516a0936262">PreconditionedFSICollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../de/d23/classRefineableFishPoissonProblem.html#a8d8fb7ef1c571c57c02073edab4a7759">RefineableFishPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../db/da5/classFreeBoundaryPoissonProblem.html#a885a6e3a4efd1f02314806dced566569">FreeBoundaryPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../db/da5/classFreeBoundaryPoissonProblem.html#a885a6e3a4efd1f02314806dced566569">FreeBoundaryPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../de/d23/classRefineableFishPoissonProblem.html#a8d8fb7ef1c571c57c02073edab4a7759">RefineableFishPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d5/d09/classCoatedSphereProblem.html#a2f55bc904971ca96eb9af3451ef5b4c4">CoatedSphereProblem&lt; ELASTICITY_ELEMENT, HELMHOLTZ_ELEMENT &gt;</a>, <a class="el" href="../../d5/d09/classCoatedSphereProblem.html#a2f55bc904971ca96eb9af3451ef5b4c4">CoatedSphereProblem&lt; ELASTICITY_ELEMENT, HELMHOLTZ_ELEMENT &gt;</a>, <a class="el" href="../../dd/dfa/classAirwayReopeningProblem.html#ae01a10d180ad4e9c8933804282e76d0d">AirwayReopeningProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d3/d0f/classCoatedDiskProblem.html#a8f52f13933fba3b053d50de544d8cafc">CoatedDiskProblem&lt; ELASTICITY_ELEMENT, HELMHOLTZ_ELEMENT &gt;</a>, <a class="el" href="../../d1/dc3/classScatteringProblem.html#ad096c311ee474d23514656d2ba76a4b8">ScatteringProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/dc3/classScatteringProblem.html#ad096c311ee474d23514656d2ba76a4b8">ScatteringProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d7/dd7/classHelmholtzPointSourceProblem.html#a53434ca7ad31bdfa089f2c4849673bd8">HelmholtzPointSourceProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d2/d8e/classSolarRadiationProblem.html#aad1144fab812f914c139b73acd76cf0e">SolarRadiationProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d73/classMeltContactProblem.html#a2608b8fe166ca8f5310ee411029975d9">MeltContactProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d70/classVibratingShellProblem.html#af3ea541689a2dbed7f3c26db264deaff">VibratingShellProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d7d/classAxisymmetricVibratingShellProblem.html#ae7976a14a042f66c69c4c2a3dba2bcdf">AxisymmetricVibratingShellProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d32/classFourierDecomposedHelmholtzProblem.html#ae80673ef299e4935ddcac177ed919da3">FourierDecomposedHelmholtzProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d32/classFourierDecomposedHelmholtzProblem.html#ae80673ef299e4935ddcac177ed919da3">FourierDecomposedHelmholtzProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../da/d79/classRotatingProblem.html#a4dbea5085c92e8c5a924c22fadd34de6">RotatingProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../da/dec/classABCProblem.html#a704534835d8e27123046186a96fd3454">ABCProblem&lt; ELEMENT, TIMESTEPPERT &gt;</a>, <a class="el" href="../../d8/d82/classPredPreyProblem.html#af27e56d77ed384cec601f9153fefec5a">PredPreyProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dc/d83/classFlowAroundCylinderProblem.html#a840d8ba65d033643a8d3c93406125f82">FlowAroundCylinderProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dc/d83/classFlowAroundCylinderProblem.html#a840d8ba65d033643a8d3c93406125f82">FlowAroundCylinderProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d15/classInterfaceProblem.html#ab4193771472aefce4cd67261491cc344">InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../df/de6/classCapProblem.html#ac852570b51489f4bf744b6063fbfa01a">CapProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d15/classInterfaceProblem.html#ab4193771472aefce4cd67261491cc344">InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d9/d15/classInterfaceProblem.html#ab4193771472aefce4cd67261491cc344">InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../dc/da5/classMeltSpinningProblem.html#a9865345e05dd0a3997d7915aed423d18">MeltSpinningProblem&lt; ELEMENT &gt;</a>, and <a class="el" href="../../df/de6/classCapProblem.html#ac852570b51489f4bf744b6063fbfa01a">CapProblem&lt; ELEMENT &gt;</a>.</p>
<div class="fragment"><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;{}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5f08629e3c9c72b441ec7f19f175b2c7">actions_after_change_in_bifurcation_parameter()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a1e90bbe5d279295b97ae704487259bcc">actions_after_change_in_global_parameter()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a63805c549e71b7c73107abe6001fae25">adaptive_unsteady_newton_solve()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a6510803afcbcfce1ae5b1c1c5d82a541">oomph::PitchForkHandler::get_dresiduals_dparameter()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a9f3d1c9378e385d7755184a97f5f6f91">get_fd_jacobian()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a497518acb5d30a28a253890c3d2a5da2">get_hessian_vector_products()</a>, <a class="el" href="../../d4/dcb/classoomph_1_1FoldHandler.html#ad1bec54a2e0c5bd483ff0bf633bd6542">oomph::FoldHandler::get_jacobian()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aa6728813a099111bee2b6c79dec20fc4">oomph::PitchForkHandler::get_jacobian()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aae8cf62757e432b625ec81fad1559dc3">newton_solve()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7b86783463433cc9c4cc382b1b40f0e1">newton_solve_continuation()</a>.</p>

</div>
</div>
<a id="a0c8d70891f7369bb4bf8412fa1a08ecb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c8d70891f7369bb4bf8412fa1a08ecb">&#9670;&nbsp;</a></span>actions_before_newton_solve()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void oomph::Problem::actions_before_newton_solve </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Any actions that are to be performed before a complete Newton solve (e.g. adjust boundary conditions). CAREFUL: This step should (and if the FD-based LinearSolver FD_LU is used, must) only update values that are pinned! </p>

<p>Reimplemented in <a class="el" href="../../d0/dd0/classOneDPoissonProblem.html#a6e42423869771fbd216326cba516a76b">OneDPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/dd0/classOneDPoissonProblem.html#a6e42423869771fbd216326cba516a76b">OneDPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/dd0/classOneDPoissonProblem.html#a6e42423869771fbd216326cba516a76b">OneDPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d3/d73/classoomph_1_1WomersleyProblem.html#a7aa82fe18099c9770edf9fa8e79a2028">oomph::WomersleyProblem&lt; ELEMENT, DIM &gt;</a>, <a class="el" href="../../d6/d69/classoomph_1_1NonLinearElasticitySmoothMesh.html#a778763122903088b5234fcf7ca35a0b5">oomph::NonLinearElasticitySmoothMesh&lt; ELEMENT &gt;</a>, <a class="el" href="../../d2/d5a/classoomph_1_1SolidICProblem.html#ad234d3268b330cd2f532548103cb60fc">oomph::SolidICProblem</a>, <a class="el" href="../../db/d78/classoomph_1_1BiharmonicFluidProblem.html#ad62b36f8b36faae1324fe29fcd8e0875">oomph::BiharmonicFluidProblem&lt; DIM &gt;</a>, <a class="el" href="../../d9/dc5/classoomph_1_1BiharmonicProblem.html#a161f8a00ca635684bfd54880925cd5bf">oomph::BiharmonicProblem&lt; DIM &gt;</a>, <a class="el" href="../../d9/dc5/classoomph_1_1BiharmonicProblem.html#a161f8a00ca635684bfd54880925cd5bf">oomph::BiharmonicProblem&lt; 2 &gt;</a>, <a class="el" href="../../d6/df2/classTestPoissonProblem.html#acf537075d617da2ff3b45c1d25e8056e">TestPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d9f/classTestRefineablePoissonProblem.html#ae54ba13e6fcbb05597b838c1f6063324">TestRefineablePoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d6/df2/classTestPoissonProblem.html#acf537075d617da2ff3b45c1d25e8056e">TestPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d0a/classTFaceTestProblem.html#a189543d14d02cd247ab9cb3481305822">TFaceTestProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d17/classTriangleFaceTestProblem.html#a1956f099857b04707d74f37a5d80e9fa">TriangleFaceTestProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d35/classQFaceTestProblem.html#afa5705d4723cb1fd36c442e6fc7bf98d">QFaceTestProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d35/classQFaceTestProblem.html#afa5705d4723cb1fd36c442e6fc7bf98d">QFaceTestProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a398608a5ff73b74c5a387b3f794c58df">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a398608a5ff73b74c5a387b3f794c58df">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/de1/classEighthSpherePoissonProblem.html#af82dd7abdf631950a68c997af314be5d">EighthSpherePoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a398608a5ff73b74c5a387b3f794c58df">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../de/d3f/classDrivenCavityProblem.html#aa33f7bd6a53dd3188c393983af7195cd">DrivenCavityProblem&lt; ELEMENT, MESH &gt;</a>, <a class="el" href="../../d8/da8/classRefineablePoissonProblem.html#a883906ab6c06ffa10ed55dc4fc02ce96">RefineablePoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dc/d7b/classThreeDPoissonProblem.html#a5fb2cd241dc149bf7100cbcf1b863b3e">ThreeDPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/de5/classRefineableDrivenCavityProblem.html#af83cad4653c7ac633538ebf46657659a">RefineableDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/dd0/classOneDPoissonProblem.html#a6e42423869771fbd216326cba516a76b">OneDPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d57/classRectangularDrivenCavityProblem.html#ab60d1a663d82616c27b9d11bc46c05a4">RectangularDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/dcf/classUnstructuredPoissonProblem.html#a2ab9d23c0e6e6631ffe1a761f6bdf026">UnstructuredPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a398608a5ff73b74c5a387b3f794c58df">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/de1/classEighthSpherePoissonProblem.html#af82dd7abdf631950a68c997af314be5d">EighthSpherePoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/da8/classRefineablePoissonProblem.html#a883906ab6c06ffa10ed55dc4fc02ce96">RefineablePoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/de5/classRefineableDrivenCavityProblem.html#af83cad4653c7ac633538ebf46657659a">RefineableDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../db/d84/classYoungLaplaceProblem.html#a93dd45313d28c3b9b0b51e34d14ebd24">YoungLaplaceProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d4a/classRefineableYoungLaplaceProblem.html#a2807bb8cddbfa553df9f5dd170c8645d">RefineableYoungLaplaceProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d4a/classRefineableYoungLaplaceProblem.html#a2807bb8cddbfa553df9f5dd170c8645d">RefineableYoungLaplaceProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../db/d84/classYoungLaplaceProblem.html#a93dd45313d28c3b9b0b51e34d14ebd24">YoungLaplaceProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d8c/classCollapsibleChannelProblem.html#ad7597f95eb755184ec1f9581c713ff78">CollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d28/classUnsteadyHeatProblem.html#aa1ee8fbe2a5439d1cacb37131e0f81c6">UnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d68/classRefineableUnsteadyHeatProblem.html#aac1935e15c67b196e6db97dd058511b5">RefineableUnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d68/classRefineableUnsteadyHeatProblem.html#aac1935e15c67b196e6db97dd058511b5">RefineableUnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d68/classRefineableUnsteadyHeatProblem.html#aac1935e15c67b196e6db97dd058511b5">RefineableUnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d28/classUnsteadyHeatProblem.html#aa1ee8fbe2a5439d1cacb37131e0f81c6">UnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d28/classUnsteadyHeatProblem.html#aa1ee8fbe2a5439d1cacb37131e0f81c6">UnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d28/classUnsteadyHeatProblem.html#aa1ee8fbe2a5439d1cacb37131e0f81c6">UnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d28/classUnsteadyHeatProblem.html#aa1ee8fbe2a5439d1cacb37131e0f81c6">UnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d28/classUnsteadyHeatProblem.html#aa1ee8fbe2a5439d1cacb37131e0f81c6">UnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/d2c/classRingWithTRibProblem.html#aa74a20d5bd6d7f16eb00080734dde0d1">RingWithTRibProblem&lt; ELASTICITY_ELEMENT &gt;</a>, <a class="el" href="../../d8/d28/classAnnularDiskProblem.html#a147e5fbe37f7132bbace2b713acb03a5">AnnularDiskProblem&lt; ELASTICITY_ELEMENT &gt;</a>, <a class="el" href="../../d6/d48/classFourierDecomposedTimeHarmonicLinearElasticityProblem.html#ad9a3f48c3b399c4595f73d3f1e9a14ef">FourierDecomposedTimeHarmonicLinearElasticityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d6/d48/classFourierDecomposedTimeHarmonicLinearElasticityProblem.html#ad9a3f48c3b399c4595f73d3f1e9a14ef">FourierDecomposedTimeHarmonicLinearElasticityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d6/d48/classFourierDecomposedTimeHarmonicLinearElasticityProblem.html#ad9a3f48c3b399c4595f73d3f1e9a14ef">FourierDecomposedTimeHarmonicLinearElasticityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d3/d40/classSphericalSteadyRotationProblem.html#a5b20620ea2c5b271bd8b72e4f2bb20e9">SphericalSteadyRotationProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d2/da3/classSphericalSpinUpProblem.html#a902c16b5ad59d8f5153c9f52fef35016">SphericalSpinUpProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d2/da3/classSphericalSpinUpProblem.html#a902c16b5ad59d8f5153c9f52fef35016">SphericalSpinUpProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d6/df1/classRefineableSphericalSpinUpProblem.html#a99368193551ba37e060b26aff1822e54">RefineableSphericalSpinUpProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d6/df1/classRefineableSphericalSpinUpProblem.html#a99368193551ba37e060b26aff1822e54">RefineableSphericalSpinUpProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dc/dff/classUnstructuredSolidProblem.html#a17b60a37c6b3b2807e09bb92b22271d9">UnstructuredSolidProblem&lt; ELEMENT, MESH &gt;</a>, <a class="el" href="../../dc/dff/classUnstructuredSolidProblem.html#a17b60a37c6b3b2807e09bb92b22271d9">UnstructuredSolidProblem&lt; ELEMENT, MESH &gt;</a>, <a class="el" href="../../d5/d7a/classBlockCompressionProblem.html#a1db66a9aabad95a8e9289fda1820c27f">BlockCompressionProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d27/classPrescribedBoundaryDisplacementProblem.html#ad2184bb8d7391da21bec62d4aacf5c20">PrescribedBoundaryDisplacementProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/d16/classCantileverProblem.html#a293902b825898ce043ffce3f0691f5a5">CantileverProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d0a/classElasticFishProblem.html#a7c22fcff8d94166797e87d70017540d6">ElasticFishProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dc/dfb/classSimpleShearProblem.html#a2c63e1a6c120da147b0c4ec9764e1510">SimpleShearProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dc/dfb/classSimpleShearProblem.html#a2c63e1a6c120da147b0c4ec9764e1510">SimpleShearProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/d9b/classDiskShockWaveProblem.html#a50ba8e9b29ff7796fa9cb7ede8598376">DiskShockWaveProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d1/d8c/classCollapsibleChannelProblem.html#ad7597f95eb755184ec1f9581c713ff78">CollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d27/classPrescribedBoundaryDisplacementProblem.html#ad2184bb8d7391da21bec62d4aacf5c20">PrescribedBoundaryDisplacementProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d27/classPrescribedBoundaryDisplacementProblem.html#ad2184bb8d7391da21bec62d4aacf5c20">PrescribedBoundaryDisplacementProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d27/classPrescribedBoundaryDisplacementProblem.html#ad2184bb8d7391da21bec62d4aacf5c20">PrescribedBoundaryDisplacementProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d08/classDiskOscillationProblem.html#afea297af1844657099dec3d717fcccc5">DiskOscillationProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../de/de5/classStaticDiskCompressionProblem.html#a2b00608d2992b40217248e01b2294153">StaticDiskCompressionProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d11/classCompressedSquareProblem.html#aed8338e212b31c56a5df20c222385e15">CompressedSquareProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/d16/classCantileverProblem.html#a293902b825898ce043ffce3f0691f5a5">CantileverProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/d16/classCantileverProblem.html#a293902b825898ce043ffce3f0691f5a5">CantileverProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../db/d95/classPlateProblem.html#a3be5bbf9e7473c75b8f752e0d77f5955">PlateProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../da/d3f/classShellProblem.html#a379156a43ce05fe0e2dcf8a986a2ac64">ShellProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../da/d3f/classShellProblem.html#a379156a43ce05fe0e2dcf8a986a2ac64">ShellProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../da/d3f/classShellProblem.html#a379156a43ce05fe0e2dcf8a986a2ac64">ShellProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../da/d3f/classShellProblem.html#a379156a43ce05fe0e2dcf8a986a2ac64">ShellProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d5/d48/classRefineableActivatorInhibitorProblem.html#ab3273041fa9ac4840cb660c8ef7dcd4f">RefineableActivatorInhibitorProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d5/d48/classRefineableActivatorInhibitorProblem.html#ab3273041fa9ac4840cb660c8ef7dcd4f">RefineableActivatorInhibitorProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d2c/classActivatorInhibitorProblem.html#a4c2343ce963a8ad6287e7313298e4c08">ActivatorInhibitorProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/dab/classRefineableTwoDPoissonProblem.html#a95f4643a6bfeea8701e3366e21a0f8f4">RefineableTwoDPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d43/classRefineableTwoMeshFluxPoissonProblem.html#a209506229c491a8cec4e1dce387e18c3">RefineableTwoMeshFluxPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d27/classTwoMeshFluxPoissonProblem.html#a520768a954d00d3972115ccf0b304854">TwoMeshFluxPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/da7/classFluxPoissonProblem.html#aaea8f7f6f7a2e1aedfd2854e1ae12338">FluxPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/da8/classRefineablePoissonProblem.html#a883906ab6c06ffa10ed55dc4fc02ce96">RefineablePoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a398608a5ff73b74c5a387b3f794c58df">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a398608a5ff73b74c5a387b3f794c58df">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a398608a5ff73b74c5a387b3f794c58df">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/da8/classRefineablePoissonProblem.html#a883906ab6c06ffa10ed55dc4fc02ce96">RefineablePoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/de1/classEighthSpherePoissonProblem.html#af82dd7abdf631950a68c997af314be5d">EighthSpherePoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/dd0/classOneDPoissonProblem.html#a6e42423869771fbd216326cba516a76b">OneDPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a398608a5ff73b74c5a387b3f794c58df">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d3/d3c/classPRefineableOneDPoissonProblem.html#ae1c3d92c6d8a5ae963b250de56543888">PRefineableOneDPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/d58/classDemoPoissonProblem.html#af796c73ccd0d3a827b15775389dcea00">DemoPoissonProblem</a>, <a class="el" href="../../d3/d40/classRefineableOneDPoissonProblem.html#a371c4be158a32312aa1a8c7568f62145">RefineableOneDPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/dd0/classOneDPoissonProblem.html#a6e42423869771fbd216326cba516a76b">OneDPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dc/ddb/classSimpleRefineableFishPoissonProblem.html#af1b13d49ace6c248a0a8021103f139a5">SimpleRefineableFishPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../de/d23/classRefineableFishPoissonProblem.html#a58098181f3b88c2fc65f24fb15c1a529">RefineableFishPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d6/d10/classFishPoissonProblem.html#a4f3ddd6ae8117d36cace040a2cad68a3">FishPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../de/d23/classRefineableFishPoissonProblem.html#a58098181f3b88c2fc65f24fb15c1a529">RefineableFishPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d6/d10/classFishPoissonProblem.html#a4f3ddd6ae8117d36cace040a2cad68a3">FishPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../de/d23/classRefineableFishPoissonProblem.html#a58098181f3b88c2fc65f24fb15c1a529">RefineableFishPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../de/d23/classRefineableFishPoissonProblem.html#a58098181f3b88c2fc65f24fb15c1a529">RefineableFishPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/de1/classEighthSpherePoissonProblem.html#af82dd7abdf631950a68c997af314be5d">EighthSpherePoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/de1/classEighthSpherePoissonProblem.html#af82dd7abdf631950a68c997af314be5d">EighthSpherePoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/de5/classElasticAnnulusProblem.html#af50a0dc2601e1a5e884166941d2cb9ce">ElasticAnnulusProblem&lt; ELASTICITY_ELEMENT &gt;</a>, <a class="el" href="../../df/de5/classElasticAnnulusProblem.html#af50a0dc2601e1a5e884166941d2cb9ce">ElasticAnnulusProblem&lt; ELASTICITY_ELEMENT &gt;</a>, <a class="el" href="../../d0/dfa/classPMLProblem.html#a13feb001d09f64dcfe44bbe3c6fe3d97">PMLProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/dfa/classPMLProblem.html#a13feb001d09f64dcfe44bbe3c6fe3d97">PMLProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d5/d17/classPMLFourierDecomposedHelmholtzProblem.html#af87810cbe164981cc14ee779793a69fb">PMLFourierDecomposedHelmholtzProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/da8/classRefineablePoissonProblem.html#a883906ab6c06ffa10ed55dc4fc02ce96">RefineablePoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a398608a5ff73b74c5a387b3f794c58df">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d57/classRectangularDrivenCavityProblem.html#ab60d1a663d82616c27b9d11bc46c05a4">RectangularDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a398608a5ff73b74c5a387b3f794c58df">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/da6/classFSICollapsibleChannelProblem.html#ad10b2d12be052c6b1bc5005dc27cd229">FSICollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d68/classRefineableUnsteadyHeatProblem.html#aac1935e15c67b196e6db97dd058511b5">RefineableUnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d28/classUnsteadyHeatProblem.html#aa1ee8fbe2a5439d1cacb37131e0f81c6">UnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d6/da9/classRayleighProblem.html#ab49bdf4a3c9fcb57fa04db8892875668">RayleighProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d6/da9/classRayleighProblem.html#ab49bdf4a3c9fcb57fa04db8892875668">RayleighProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d4/d94/classoomph_1_1MyProblem.html#a85210852d03afbc3935edd4bd2071d99">oomph::MyProblem</a>, <a class="el" href="../../d3/d26/classVorticityRecoveryProblem.html#a7e387b4acff9aec37a4bc4e51140e127">VorticityRecoveryProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d5/d3c/classUnstructuredFluidProblem.html#a3d93e13193cd466fa0901a470e281765">UnstructuredFluidProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/dee/classDropInChannelProblem.html#a0e229343783fd73768dfa0a2672e9ad1">DropInChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../da/def/classBubbleInChannelProblem.html#aef53cd0e961bd899e50806ec39f5a3fd">BubbleInChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d5/d3c/classUnstructuredFluidProblem.html#a3d93e13193cd466fa0901a470e281765">UnstructuredFluidProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/deb/classRisingBubbleProblem.html#a34ab0e97ec43e966e5dc341ff9ccaa9d">RisingBubbleProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d6a/classFallingBlockProblem.html#a6cc19e5d7a6994aa227540686310ce28">FallingBlockProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d15/classInterfaceProblem.html#ade63c8a74f666edf530460b989968b4f">InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d3/d70/classTwoLayerInterfaceProblem.html#aa34b7c3a13847571a9fedc2465daab30">TwoLayerInterfaceProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d15/classInterfaceProblem.html#ade63c8a74f666edf530460b989968b4f">InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d7/dcc/classTurekNonFSIProblem.html#ae5881b3424aee1ba7b947fff96493d2f">TurekNonFSIProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d2f/classFreeSurfaceRotationProblem.html#a88dad34876ba4ed0b0a5530651598efe">FreeSurfaceRotationProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../db/d31/classEntryFlowProblem.html#ae4dde95573350d8fdb19463849991130">EntryFlowProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d90/classSteadyTubeProblem.html#a5c5277cac2a887dc6c85892e9f851f97">SteadyTubeProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d54/classSpikedChannelSpineFlowProblem.html#a98e464ea1ab1c14d703415d63e89115e">SpikedChannelSpineFlowProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d5/db8/classChannelSpineFlowProblem.html#aaf6dd8a8a472ccd938df579aba61ec97">ChannelSpineFlowProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d5/db8/classChannelSpineFlowProblem.html#aaf6dd8a8a472ccd938df579aba61ec97">ChannelSpineFlowProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d2/dd4/classNavierStokesProblem.html#a61feda03c9972cae62cfa1c3486bf17a">NavierStokesProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d15/classInterfaceProblem.html#ade63c8a74f666edf530460b989968b4f">InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d9/d15/classInterfaceProblem.html#ade63c8a74f666edf530460b989968b4f">InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../de/da5/classFpTestProblem.html#ae8ac3854380d5db606f130ba05ded569">FpTestProblem</a>, <a class="el" href="../../de/da5/classFpTestProblem.html#ae8ac3854380d5db606f130ba05ded569">FpTestProblem</a>, <a class="el" href="../../de/d2b/classRayleighTractionProblem.html#ad8f0e846280b0dd56f90c6d40808d3ea">RayleighTractionProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d6/da9/classRayleighProblem.html#ab49bdf4a3c9fcb57fa04db8892875668">RayleighProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../dd/d71/classOscRingNStProblem.html#a7d8ff9543c042752b649ed326d6c5915">OscRingNStProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d71/classOscRingNStProblem.html#a7d8ff9543c042752b649ed326d6c5915">OscRingNStProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../db/d50/classOscEllipseProblem.html#a18bbd70aa8c140637637053a5f839c11">OscEllipseProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d4/d57/classRectangularDrivenCavityProblem.html#ab60d1a663d82616c27b9d11bc46c05a4">RectangularDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/de5/classRefineableDrivenCavityProblem.html#af83cad4653c7ac633538ebf46657659a">RefineableDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d16/classTiltedCavityProblem.html#a0721e7d60e6353ee426c23c8b38fca06">TiltedCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dc/d61/classPRefineableDrivenCavityProblem.html#ae083a502d819cee6a6312e3410407c52">PRefineableDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d66/classQuarterCircleDrivenCavityProblem.html#aa1d9cfd27fc1abe2a85e756009781547">QuarterCircleDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d2f/classFreeSurfaceRotationProblem.html#a88dad34876ba4ed0b0a5530651598efe">FreeSurfaceRotationProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d8c/classCollapsibleChannelProblem.html#ad7597f95eb755184ec1f9581c713ff78">CollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dc/d83/classFlowAroundCylinderProblem.html#a050be2f9105940ef33389365598e6e21">FlowAroundCylinderProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dc/d83/classFlowAroundCylinderProblem.html#a050be2f9105940ef33389365598e6e21">FlowAroundCylinderProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../db/d31/classEntryFlowProblem.html#ae4dde95573350d8fdb19463849991130">EntryFlowProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d57/classRectangularDrivenCavityProblem.html#ab60d1a663d82616c27b9d11bc46c05a4">RectangularDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/dec/classSteadyHelicalProblem.html#a446b8b3e090f8349dc2c5de68190d6a4">SteadyHelicalProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d2/da3/classSteadyCurvedTubeProblem.html#a90f3197b2cd58a6d24d7064018db3bac">SteadyCurvedTubeProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d8c/classCollapsibleChannelProblem.html#ad7597f95eb755184ec1f9581c713ff78">CollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d8c/classCollapsibleChannelProblem.html#ad7597f95eb755184ec1f9581c713ff78">CollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d6c/classQuarterCircleDrivenCavityProblem2.html#aed64247640938ca570da33238e9696ac">QuarterCircleDrivenCavityProblem2&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d66/classQuarterCircleDrivenCavityProblem.html#aa1d9cfd27fc1abe2a85e756009781547">QuarterCircleDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d2/d1f/classChannelWithLeafletProblem.html#a5721dfad66d13a1ae60adce7801dcb12">ChannelWithLeafletProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5b/classBrethertonProblem.html#a7112e0efe4c0cd0269cf47f02df4fe22">BrethertonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d2/d3d/classRefineableRotatingCylinderProblem.html#a382bc388316b410c45f337558b5ad577">RefineableRotatingCylinderProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/de5/classRefineableDrivenCavityProblem.html#af83cad4653c7ac633538ebf46657659a">RefineableDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d2a/classUnitCubePoissonMGProblem.html#a51b65255b009acf1856ab1e57c44a10c">UnitCubePoissonMGProblem&lt; ELEMENT, MESH &gt;</a>, <a class="el" href="../../d4/d2a/classUnitCubePoissonMGProblem.html#a51b65255b009acf1856ab1e57c44a10c">UnitCubePoissonMGProblem&lt; ELEMENT, MESH &gt;</a>, <a class="el" href="../../de/d9e/classFluxPoissonMGProblem.html#af6d8372e17b8df58d2a1b8c44057b4b4">FluxPoissonMGProblem&lt; ELEMENT, MESH &gt;</a>, <a class="el" href="../../de/d9e/classFluxPoissonMGProblem.html#af6d8372e17b8df58d2a1b8c44057b4b4">FluxPoissonMGProblem&lt; ELEMENT, MESH &gt;</a>, <a class="el" href="../../dc/d88/classPMLHelmholtzMGProblem.html#a10fe805bb42cb6a7e092613ef10b470d">PMLHelmholtzMGProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d22/classPMLStructuredCubicHelmholtz.html#afa195562cb019f9452373333dae00a7d">PMLStructuredCubicHelmholtz&lt; ELEMENT &gt;</a>, <a class="el" href="../../d7/d86/classSurfactantProblem.html#a1c33e2fbbb676daaaa556d6162fc7016">SurfactantProblem&lt; ELEMENT, INTERFACE_ELEMENT &gt;</a>, <a class="el" href="../../d7/d86/classSurfactantProblem.html#a1c33e2fbbb676daaaa556d6162fc7016">SurfactantProblem&lt; ELEMENT, INTERFACE_ELEMENT &gt;</a>, <a class="el" href="../../d7/d86/classSurfactantProblem.html#a1c33e2fbbb676daaaa556d6162fc7016">SurfactantProblem&lt; ELEMENT, INTERFACE_ELEMENT &gt;</a>, <a class="el" href="../../da/d36/classThermalProblem.html#ab2d2efaf155756144c9796b76af3ee8d">ThermalProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/d37/classAxisymFreeSurfaceNozzleAdvDiffRobinProblem.html#a8286ad9f9484a2bb76f3ad3bc2eeb741">AxisymFreeSurfaceNozzleAdvDiffRobinProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d3/d00/classConvectionProblem.html#adbb792dbece64e71dbfb7f5ec64f360d">ConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d3/d00/classConvectionProblem.html#adbb792dbece64e71dbfb7f5ec64f360d">ConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d3/d00/classConvectionProblem.html#adbb792dbece64e71dbfb7f5ec64f360d">ConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d3/d00/classConvectionProblem.html#adbb792dbece64e71dbfb7f5ec64f360d">ConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d1/d6e/classDDConvectionProblem.html#aa6c1fc7e395c0488ff86c3d1f31b58a4">DDConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d3/d00/classConvectionProblem.html#adbb792dbece64e71dbfb7f5ec64f360d">ConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d1/d1f/classRefineableConvectionProblem.html#ae0e627f882cd8faa305392e615331e51">RefineableConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d1/d1f/classRefineableConvectionProblem.html#ae0e627f882cd8faa305392e615331e51">RefineableConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d3/d00/classConvectionProblem.html#adbb792dbece64e71dbfb7f5ec64f360d">ConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d3/d00/classConvectionProblem.html#adbb792dbece64e71dbfb7f5ec64f360d">ConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d8/d48/classFlowAroundHalfCylinderProblem.html#a3737fcb22125e16109db129f44804cd8">FlowAroundHalfCylinderProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d48/classFlowAroundHalfCylinderProblem.html#a3737fcb22125e16109db129f44804cd8">FlowAroundHalfCylinderProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d48/classFlowAroundHalfCylinderProblem.html#a3737fcb22125e16109db129f44804cd8">FlowAroundHalfCylinderProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d48/classFlowAroundHalfCylinderProblem.html#a3737fcb22125e16109db129f44804cd8">FlowAroundHalfCylinderProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d1f/classRefineableConvectionProblem.html#ae0e627f882cd8faa305392e615331e51">RefineableConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d1/d1f/classRefineableConvectionProblem.html#ae0e627f882cd8faa305392e615331e51">RefineableConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d2/d8f/classMultiPoissonProblem.html#acf721a758c0b4b1f38a1c928c6b21368">MultiPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a398608a5ff73b74c5a387b3f794c58df">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d4a/classFSIChannelWithLeafletProblem.html#a8a32ef77f32b3283b4b509669deb0a11">FSIChannelWithLeafletProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d57/classRectangularDrivenCavityProblem.html#ab60d1a663d82616c27b9d11bc46c05a4">RectangularDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/dd0/classOneDPoissonProblem.html#a6e42423869771fbd216326cba516a76b">OneDPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/d16/classCantileverProblem.html#a293902b825898ce043ffce3f0691f5a5">CantileverProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/dfc/classTurekProblem.html#a889518fdaf0c4215e21981afbfc669bd">TurekProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;</a>, <a class="el" href="../../d1/dfc/classTurekProblem.html#a889518fdaf0c4215e21981afbfc669bd">TurekProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;</a>, <a class="el" href="../../d3/db4/classPseudoElasticCollapsibleChannelProblem.html#a7722c99ca799948fe194cc87ec577fd8">PseudoElasticCollapsibleChannelProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;</a>, <a class="el" href="../../da/db6/classFSIRingProblem.html#a9fd26120e4e078bca685a5c94482ee12">FSIRingProblem</a>, <a class="el" href="../../dd/da6/classFSICollapsibleChannelProblem.html#ad10b2d12be052c6b1bc5005dc27cd229">FSICollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d4a/classFSIChannelWithLeafletProblem.html#a8a32ef77f32b3283b4b509669deb0a11">FSIChannelWithLeafletProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d1f/classRefineableConvectionProblem.html#ae0e627f882cd8faa305392e615331e51">RefineableConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d1/d1f/classRefineableConvectionProblem.html#a694f0be87fe09a30d94e92acfce85eee">RefineableConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d3/d00/classConvectionProblem.html#adbb792dbece64e71dbfb7f5ec64f360d">ConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a398608a5ff73b74c5a387b3f794c58df">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a398608a5ff73b74c5a387b3f794c58df">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a398608a5ff73b74c5a387b3f794c58df">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d43/classRefineableTwoMeshFluxPoissonProblem.html#a209506229c491a8cec4e1dce387e18c3">RefineableTwoMeshFluxPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d27/classPrescribedBoundaryDisplacementProblem.html#ad2184bb8d7391da21bec62d4aacf5c20">PrescribedBoundaryDisplacementProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../db/d31/classEntryFlowProblem.html#ae4dde95573350d8fdb19463849991130">EntryFlowProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/d16/classCantileverProblem.html#a293902b825898ce043ffce3f0691f5a5">CantileverProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d68/classRefineableUnsteadyHeatProblem.html#aac1935e15c67b196e6db97dd058511b5">RefineableUnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d27/classPrescribedBoundaryDisplacementProblem.html#ad2184bb8d7391da21bec62d4aacf5c20">PrescribedBoundaryDisplacementProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d27/classPrescribedBoundaryDisplacementProblem.html#ad2184bb8d7391da21bec62d4aacf5c20">PrescribedBoundaryDisplacementProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/dab/classRefineableTwoDPoissonProblem.html#a95f4643a6bfeea8701e3366e21a0f8f4">RefineableTwoDPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dc/d61/classPRefineableDrivenCavityProblem.html#ae083a502d819cee6a6312e3410407c52">PRefineableDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dc/d61/classPRefineableDrivenCavityProblem.html#ae083a502d819cee6a6312e3410407c52">PRefineableDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/de5/classRefineableDrivenCavityProblem.html#af83cad4653c7ac633538ebf46657659a">RefineableDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../de/d23/classRefineableFishPoissonProblem.html#a58098181f3b88c2fc65f24fb15c1a529">RefineableFishPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../de/dcc/classHarmonicProblem.html#a2dda1cd43424751898748e0cb89e7b43">HarmonicProblem&lt; ELEMENT, EIGEN_SOLVER &gt;</a>, <a class="el" href="../../da/d3f/classShellProblem.html#a379156a43ce05fe0e2dcf8a986a2ac64">ShellProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d66/classQuarterCircleDrivenCavityProblem.html#aa1d9cfd27fc1abe2a85e756009781547">QuarterCircleDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../da/d79/classRotatingProblem.html#ad48158250a7b99d06c93024828fd4d5c">RotatingProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../db/d68/classUniformTranspiration.html#a0b83abe193d1bbfb682e3c52b29ca6d0">UniformTranspiration&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/d16/classCantileverProblem.html#a293902b825898ce043ffce3f0691f5a5">CantileverProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/de5/classRefineableDrivenCavityProblem.html#af83cad4653c7ac633538ebf46657659a">RefineableDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/de5/classRefineableDrivenCavityProblem.html#af83cad4653c7ac633538ebf46657659a">RefineableDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/dc3/classScatteringProblem.html#a91ce14b928ec6edbb9d85515a310b1fb">ScatteringProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../da/d64/classMovingBlockProblem.html#a9fd7ddd6bcb7896c9ca889f34a4a007f">MovingBlockProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a398608a5ff73b74c5a387b3f794c58df">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../da/d13/classFlowPastBoxProblem.html#a602772b5e37d5bd426d64e46cc3f59ea">FlowPastBoxProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a398608a5ff73b74c5a387b3f794c58df">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../da/d13/classFlowPastBoxProblem.html#a602772b5e37d5bd426d64e46cc3f59ea">FlowPastBoxProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a398608a5ff73b74c5a387b3f794c58df">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d2/dd4/classNavierStokesProblem.html#a61feda03c9972cae62cfa1c3486bf17a">NavierStokesProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a398608a5ff73b74c5a387b3f794c58df">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a398608a5ff73b74c5a387b3f794c58df">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/dcf/classUnstructuredPoissonProblem.html#a2ab9d23c0e6e6631ffe1a761f6bdf026">UnstructuredPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/dcf/classUnstructuredPoissonProblem.html#a2ab9d23c0e6e6631ffe1a761f6bdf026">UnstructuredPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a398608a5ff73b74c5a387b3f794c58df">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../de/d7c/classTetmeshPoissonProblem.html#a8d0462bd9c6ad5be99b627c221859f0d">TetmeshPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../de/d7c/classTetmeshPoissonProblem.html#a8d0462bd9c6ad5be99b627c221859f0d">TetmeshPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/dd0/classOneDPoissonProblem.html#a6e42423869771fbd216326cba516a76b">OneDPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d5/d62/classPerturbedStateProblem.html#a4b7773591fa2b0efcc2e99c06bd01370">PerturbedStateProblem&lt; BASE_ELEMENT, PERTURBED_ELEMENT &gt;</a>, <a class="el" href="../../d2/d3b/classBaseStateProblem.html#a8aaf9cd973cfa14c621aa7a3cb11a537">BaseStateProblem&lt; BASE_ELEMENT &gt;</a>, <a class="el" href="../../d5/d62/classPerturbedStateProblem.html#a4b7773591fa2b0efcc2e99c06bd01370">PerturbedStateProblem&lt; BASE_ELEMENT, PERTURBED_ELEMENT &gt;</a>, <a class="el" href="../../d2/d3b/classBaseStateProblem.html#a8aaf9cd973cfa14c621aa7a3cb11a537">BaseStateProblem&lt; BASE_ELEMENT &gt;</a>, <a class="el" href="../../d5/d62/classPerturbedStateProblem.html#a4b7773591fa2b0efcc2e99c06bd01370">PerturbedStateProblem&lt; BASE_ELEMENT, PERTURBED_ELEMENT &gt;</a>, <a class="el" href="../../d2/d3b/classBaseStateProblem.html#a8aaf9cd973cfa14c621aa7a3cb11a537">BaseStateProblem&lt; BASE_ELEMENT &gt;</a>, <a class="el" href="../../d5/d62/classPerturbedStateProblem.html#a4b7773591fa2b0efcc2e99c06bd01370">PerturbedStateProblem&lt; BASE_ELEMENT, PERTURBED_ELEMENT &gt;</a>, <a class="el" href="../../d2/d3b/classBaseStateProblem.html#a8aaf9cd973cfa14c621aa7a3cb11a537">BaseStateProblem&lt; BASE_ELEMENT &gt;</a>, <a class="el" href="../../d4/db2/classLinearWaveProblem.html#a66e87510f6fa8af693cede514cb7a62e">LinearWaveProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d4/db2/classLinearWaveProblem.html#a66e87510f6fa8af693cede514cb7a62e">LinearWaveProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d4/db2/classLinearWaveProblem.html#a66e87510f6fa8af693cede514cb7a62e">LinearWaveProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a398608a5ff73b74c5a387b3f794c58df">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a398608a5ff73b74c5a387b3f794c58df">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d2/d8f/classMultiPoissonProblem.html#acf721a758c0b4b1f38a1c928c6b21368">MultiPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d28/classPeriodicLoadProblem.html#aad83601d810e4cc135f83c1308a0449b">PeriodicLoadProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a398608a5ff73b74c5a387b3f794c58df">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a398608a5ff73b74c5a387b3f794c58df">PoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d57/classRectangularDrivenCavityProblem.html#ab60d1a663d82616c27b9d11bc46c05a4">RectangularDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d57/classRectangularDrivenCavityProblem.html#ab60d1a663d82616c27b9d11bc46c05a4">RectangularDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/dd0/classOneDPoissonProblem.html#a6e42423869771fbd216326cba516a76b">OneDPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../db/d16/classTwoMeshFluxAdvectionDiffusionProblem.html#a05c049ca4714c5f4866d70f8bbe0f134">TwoMeshFluxAdvectionDiffusionProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d7/dc1/classRefineablePeriodicLoadProblem.html#aece9eef8c0bf14527ea1fb6902820cb4">RefineablePeriodicLoadProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d28/classPeriodicLoadProblem.html#aad83601d810e4cc135f83c1308a0449b">PeriodicLoadProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/dfc/classTurekProblem.html#a889518fdaf0c4215e21981afbfc669bd">TurekProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;</a>, <a class="el" href="../../dd/d4a/classFSIChannelWithLeafletProblem.html#a8a32ef77f32b3283b4b509669deb0a11">FSIChannelWithLeafletProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d3/db4/classPseudoElasticCollapsibleChannelProblem.html#a7722c99ca799948fe194cc87ec577fd8">PseudoElasticCollapsibleChannelProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;</a>, <a class="el" href="../../d3/db4/classPseudoElasticCollapsibleChannelProblem.html#a7722c99ca799948fe194cc87ec577fd8">PseudoElasticCollapsibleChannelProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;</a>, <a class="el" href="../../dd/d71/classOscRingNStProblem.html#a7d8ff9543c042752b649ed326d6c5915">OscRingNStProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d71/classOscRingNStProblem.html#a7d8ff9543c042752b649ed326d6c5915">OscRingNStProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../da/db6/classFSIRingProblem.html#a9fd26120e4e078bca685a5c94482ee12">FSIRingProblem</a>, <a class="el" href="../../da/db6/classFSIRingProblem.html#a9fd26120e4e078bca685a5c94482ee12">FSIRingProblem</a>, <a class="el" href="../../df/dac/classSegregatedFSIDrivenCavityProblem.html#a7d25cb352981328dafc914f42ae91db8">SegregatedFSIDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d5/df4/classFSIDrivenCavityProblem.html#ab39b6bbf225ed86976c361279a6dd887">FSIDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/da6/classFSICollapsibleChannelProblem.html#ad10b2d12be052c6b1bc5005dc27cd229">FSICollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/da6/classFSICollapsibleChannelProblem.html#ad10b2d12be052c6b1bc5005dc27cd229">FSICollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/da6/classFSICollapsibleChannelProblem.html#ad10b2d12be052c6b1bc5005dc27cd229">FSICollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/da6/classFSICollapsibleChannelProblem.html#ad10b2d12be052c6b1bc5005dc27cd229">FSICollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d4a/classFSIChannelWithLeafletProblem.html#a8a32ef77f32b3283b4b509669deb0a11">FSIChannelWithLeafletProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d96/classSegregatedFSICollapsibleChannelProblem.html#a7ab8afe6f05bbee50960cba1fe4c9c79">SegregatedFSICollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/da6/classFSICollapsibleChannelProblem.html#ad10b2d12be052c6b1bc5005dc27cd229">FSICollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d9d/classPreconditionedFSICollapsibleChannelProblem.html#aaa78dac4a24d0ab428d91012f600e06b">PreconditionedFSICollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../de/d23/classRefineableFishPoissonProblem.html#a58098181f3b88c2fc65f24fb15c1a529">RefineableFishPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../db/da5/classFreeBoundaryPoissonProblem.html#aeef57bd5dc79b6aba9eeadcd0c01a2e0">FreeBoundaryPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../db/da5/classFreeBoundaryPoissonProblem.html#aeef57bd5dc79b6aba9eeadcd0c01a2e0">FreeBoundaryPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d6/d09/classGeomObjectAsGeneralisedElementProblem.html#a4ae01862ddbbeeacca1ce7a444e28931">GeomObjectAsGeneralisedElementProblem</a>, <a class="el" href="../../d9/dcd/classDeformableFishPoissonProblem.html#ad9d03c8349a059430f7329354033b450">DeformableFishPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/dcd/classDeformableFishPoissonProblem.html#ad9d03c8349a059430f7329354033b450">DeformableFishPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../de/d23/classRefineableFishPoissonProblem.html#a58098181f3b88c2fc65f24fb15c1a529">RefineableFishPoissonProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d5/d09/classCoatedSphereProblem.html#aa268009485d4d2bb6b4856bfa318aaa9">CoatedSphereProblem&lt; ELASTICITY_ELEMENT, HELMHOLTZ_ELEMENT &gt;</a>, <a class="el" href="../../d5/d09/classCoatedSphereProblem.html#aa268009485d4d2bb6b4856bfa318aaa9">CoatedSphereProblem&lt; ELASTICITY_ELEMENT, HELMHOLTZ_ELEMENT &gt;</a>, <a class="el" href="../../dd/dfa/classAirwayReopeningProblem.html#a22eec94ca478f56ac49eeaacf883fe9d">AirwayReopeningProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d3/d0f/classCoatedDiskProblem.html#a3b94aaddee6a8f386ba249f418813963">CoatedDiskProblem&lt; ELASTICITY_ELEMENT, HELMHOLTZ_ELEMENT &gt;</a>, <a class="el" href="../../d3/d0f/classCoatedDiskProblem.html#a3b94aaddee6a8f386ba249f418813963">CoatedDiskProblem&lt; ELASTICITY_ELEMENT, HELMHOLTZ_ELEMENT &gt;</a>, <a class="el" href="../../dd/d61/classHomogenisationProblem.html#a68bf320c8d1b29ea59e54ff688c47562">HomogenisationProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d61/classHomogenisationProblem.html#a68bf320c8d1b29ea59e54ff688c47562">HomogenisationProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/dc3/classScatteringProblem.html#a91ce14b928ec6edbb9d85515a310b1fb">ScatteringProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/dc3/classScatteringProblem.html#a91ce14b928ec6edbb9d85515a310b1fb">ScatteringProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d7/dd7/classHelmholtzPointSourceProblem.html#af738cae74e3d2325ce694ae837480037">HelmholtzPointSourceProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d28/classUnsteadyHeatProblem.html#aa1ee8fbe2a5439d1cacb37131e0f81c6">UnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d00/classStefanBoltzmannProblem.html#a375d4a86d22b9b9755763dc1513bc9b7">StefanBoltzmannProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d00/classStefanBoltzmannProblem.html#a375d4a86d22b9b9755763dc1513bc9b7">StefanBoltzmannProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/dec/classContactProblem.html#a3ca2dc72185afa47ca6f9fc1a955ca6a">ContactProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/dec/classContactProblem.html#a3ca2dc72185afa47ca6f9fc1a955ca6a">ContactProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d28/classUnsteadyHeatProblem.html#aa1ee8fbe2a5439d1cacb37131e0f81c6">UnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/dcb/classUnsteadyHeatMeltProblem.html#a8d5bc128e9899102ebc92647a5f5ae38">UnsteadyHeatMeltProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/dec/classContactProblem.html#a3ca2dc72185afa47ca6f9fc1a955ca6a">ContactProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/dec/classContactProblem.html#a3ca2dc72185afa47ca6f9fc1a955ca6a">ContactProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d2/d8e/classSolarRadiationProblem.html#a0fcfda982856948f145834869c2d00ae">SolarRadiationProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d73/classMeltContactProblem.html#ad222913afd7c6cd3773eb2e7365067f8">MeltContactProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d70/classVibratingShellProblem.html#a805b1a52659509bdaaa2e94843995e8d">VibratingShellProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d7d/classAxisymmetricVibratingShellProblem.html#a10708e144a9d7d66d2cea8d6cd250fa5">AxisymmetricVibratingShellProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d32/classFourierDecomposedHelmholtzProblem.html#a82ef5a969f4404fc1acb35c38c800ce6">FourierDecomposedHelmholtzProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d32/classFourierDecomposedHelmholtzProblem.html#a82ef5a969f4404fc1acb35c38c800ce6">FourierDecomposedHelmholtzProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/d77/classUnstructuredFvKProblem.html#a149195de6df19e7b080c5cf54c03ccc9">UnstructuredFvKProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d5/d2f/classExtrudedMovingCylinderProblem.html#ad3ee7218fdb69ae76c83b728d7b8d70b">ExtrudedMovingCylinderProblem&lt; TWO_D_ELEMENT, THREE_D_ELEMENT &gt;</a>, <a class="el" href="../../da/d64/classMovingBlockProblem.html#a9fd7ddd6bcb7896c9ca889f34a4a007f">MovingBlockProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d67/classContinuationProblem.html#ab021f72038e6fdab66233afb4ba9be22">ContinuationProblem</a>, <a class="el" href="../../dc/db9/classOrrSommerfeldProblem.html#ae5f89b436b091f9212970a9972a5f661">OrrSommerfeldProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d3/d78/classDarcyProblem.html#ae997a43bcb46210c90b1cb0fc75f373c">DarcyProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../da/d79/classRotatingProblem.html#ad48158250a7b99d06c93024828fd4d5c">RotatingProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../db/d68/classUniformTranspiration.html#a0b83abe193d1bbfb682e3c52b29ca6d0">UniformTranspiration&lt; ELEMENT &gt;</a>, <a class="el" href="../../da/dec/classABCProblem.html#a4b43b9bc5b97b7a0db858c17df87200a">ABCProblem&lt; ELEMENT, TIMESTEPPERT &gt;</a>, <a class="el" href="../../d8/d82/classPredPreyProblem.html#abc6eb2911e5de7445e564f0e3cfed054">PredPreyProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d3/d41/classBratuProblem.html#a7f87d51372daec06faa6edd070619760">BratuProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dc/d83/classFlowAroundCylinderProblem.html#a050be2f9105940ef33389365598e6e21">FlowAroundCylinderProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dc/d83/classFlowAroundCylinderProblem.html#a050be2f9105940ef33389365598e6e21">FlowAroundCylinderProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d2/d06/classElasticRingProblem.html#a6d084ac04c73a116f5ece449935a31d3">ElasticRingProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d2/d06/classElasticRingProblem.html#a6d084ac04c73a116f5ece449935a31d3">ElasticRingProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/ddc/classElasticBeamProblem.html#a5b534c11d9b1d54123bf587aad5f98f6">ElasticBeamProblem</a>, <a class="el" href="../../d2/d06/classElasticRingProblem.html#a6d084ac04c73a116f5ece449935a31d3">ElasticRingProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d2/d06/classElasticRingProblem.html#a6d084ac04c73a116f5ece449935a31d3">ElasticRingProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d3/d7a/classAxiPoroProblem.html#a0cdf5f11ff8b4bff97450674fa635a21">AxiPoroProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d9/d15/classInterfaceProblem.html#ade63c8a74f666edf530460b989968b4f">InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d9/d15/classInterfaceProblem.html#ade63c8a74f666edf530460b989968b4f">InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d0/d94/classRotatingCylinderProblem.html#af6678f4329624865484d52058d8902a3">RotatingCylinderProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d9/d15/classInterfaceProblem.html#ade63c8a74f666edf530460b989968b4f">InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../da/d79/classRotatingProblem.html#ad48158250a7b99d06c93024828fd4d5c">RotatingProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d15/classInterfaceProblem.html#ade63c8a74f666edf530460b989968b4f">InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../dc/da5/classMeltSpinningProblem.html#adc6ccf55b43b19ee4bd6393295589521">MeltSpinningProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d5/d62/classPerturbedStateProblem.html#a4b7773591fa2b0efcc2e99c06bd01370">PerturbedStateProblem&lt; BASE_ELEMENT, PERTURBED_ELEMENT &gt;</a>, <a class="el" href="../../d2/d3b/classBaseStateProblem.html#a8aaf9cd973cfa14c621aa7a3cb11a537">BaseStateProblem&lt; BASE_ELEMENT &gt;</a>, <a class="el" href="../../d5/d62/classPerturbedStateProblem.html#a4b7773591fa2b0efcc2e99c06bd01370">PerturbedStateProblem&lt; BASE_ELEMENT, PERTURBED_ELEMENT &gt;</a>, <a class="el" href="../../d2/d3b/classBaseStateProblem.html#a8aaf9cd973cfa14c621aa7a3cb11a537">BaseStateProblem&lt; BASE_ELEMENT &gt;</a>, <a class="el" href="../../d7/d9c/classAxisymmetricLinearElasticityProblem.html#a25da062bc76af5ef30619a3f3ff3718f">AxisymmetricLinearElasticityProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d1/d4b/classAxisymFvKProblem.html#af2be622281b2983c08f933f9300096fb">AxisymFvKProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d4b/classAxisymFvKProblem.html#af2be622281b2983c08f933f9300096fb">AxisymFvKProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/dd7/classRefineableAdvectionDiffusionPipeProblem.html#a2e08fe02da8f42bb8f4a41561450ab6a">RefineableAdvectionDiffusionPipeProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/d77/classUnstructuredFvKProblem.html#a149195de6df19e7b080c5cf54c03ccc9">UnstructuredFvKProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/d77/classUnstructuredFvKProblem.html#a149195de6df19e7b080c5cf54c03ccc9">UnstructuredFvKProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d4b/classAxisymFvKProblem.html#af2be622281b2983c08f933f9300096fb">AxisymFvKProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d4b/classAxisymFvKProblem.html#af2be622281b2983c08f933f9300096fb">AxisymFvKProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d21/classRefineableAdvectionDiffusionProblem.html#a7cbcaa45fd7e932f335cc07a83b4d3e2">RefineableAdvectionDiffusionProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d3/d70/classSUPGAdvectionDiffusionProblem.html#affa45863033de517e1fba088aaae7eb5">SUPGAdvectionDiffusionProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../db/d16/classTwoMeshFluxAdvectionDiffusionProblem.html#a05c049ca4714c5f4866d70f8bbe0f134">TwoMeshFluxAdvectionDiffusionProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d21/classRefineableAdvectionDiffusionProblem.html#a7cbcaa45fd7e932f335cc07a83b4d3e2">RefineableAdvectionDiffusionProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d21/classRefineableAdvectionDiffusionProblem.html#a7cbcaa45fd7e932f335cc07a83b4d3e2">RefineableAdvectionDiffusionProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d6/d54/classSheetGlueProblem.html#aa03fc2761aa0cbe584d6086537b25f42">SheetGlueProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d6/d54/classSheetGlueProblem.html#aa03fc2761aa0cbe584d6086537b25f42">SheetGlueProblem&lt; ELEMENT &gt;</a>, and <a class="el" href="../../da/d4b/classBendingCantileverProblem.html#a5a281a81d220c70fea9182a539e1cb6c">BendingCantileverProblem&lt; ELEMENT &gt;</a>.</p>
<div class="fragment"><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;{}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5f08629e3c9c72b441ec7f19f175b2c7">actions_after_change_in_bifurcation_parameter()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a1e90bbe5d279295b97ae704487259bcc">actions_after_change_in_global_parameter()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a9f3d1c9378e385d7755184a97f5f6f91">get_fd_jacobian()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aae8cf62757e432b625ec81fad1559dc3">newton_solve()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7b86783463433cc9c4cc382b1b40f0e1">newton_solve_continuation()</a>.</p>

</div>
</div>
<a id="a07fc81781c74b25c8a426ec18295b0d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07fc81781c74b25c8a426ec18295b0d0">&#9670;&nbsp;</a></span>actions_before_newton_step()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void oomph::Problem::actions_before_newton_step </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Any actions that are to be performed before each individual Newton step. Most likely to be used for diagnostic purposes to doc the solution during a non-converging iteration, say. </p>

<p>Reimplemented in <a class="el" href="../../d4/d94/classoomph_1_1MyProblem.html#ab22571b4816d5c2be352b9caf09cb21b">oomph::MyProblem</a>, <a class="el" href="../../d4/d57/classRectangularDrivenCavityProblem.html#ac55f5f49f01c5c939ddc8cc352d4ea8e">RectangularDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../df/dac/classSegregatedFSIDrivenCavityProblem.html#a7901fb047f4aecb30ee4a3eb9ff299d0">SegregatedFSIDrivenCavityProblem&lt; ELEMENT &gt;</a>, and <a class="el" href="../../d1/d96/classSegregatedFSICollapsibleChannelProblem.html#abbd22f1782957882d99838171166da2e">SegregatedFSICollapsibleChannelProblem&lt; ELEMENT &gt;</a>.</p>
<div class="fragment"><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;{}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aae8cf62757e432b625ec81fad1559dc3">newton_solve()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7b86783463433cc9c4cc382b1b40f0e1">newton_solve_continuation()</a>.</p>

</div>
</div>
<a id="af10662119a7a0c3a47879fa0d0644452"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af10662119a7a0c3a47879fa0d0644452">&#9670;&nbsp;</a></span>actions_before_read_unstructured_meshes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void oomph::Problem::actions_before_read_unstructured_meshes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Actions that are to be performed before reading in restart data for problems involving unstructured bulk meshes. If the problem contains such meshes we need to strip out any face elements that are attached to them because restart of unstructured meshes re-creates their elements and nodes from scratch, leading to dangling pointers from the face elements to the old elements and nodes. This function is virtual and (practically) empty but toggles a flag to indicate that it has been called. This is used to issue a warning, prompting the user to consider overloading it if the problem is found to contain unstructured bulk meshes during restarts. </p>
<div class="fragment"><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    {</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a5f13ea67c29022392857b5c19bb3af71">Empty_actions_before_read_unstructured_meshes_has_been_called</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5f13ea67c29022392857b5c19bb3af71">Empty_actions_before_read_unstructured_meshes_has_been_called</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a4f6011ef141cc68598a9502052129a3f">read()</a>.</p>

</div>
</div>
<a id="a9ed88021ec449655c64191154dd236af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ed88021ec449655c64191154dd236af">&#9670;&nbsp;</a></span>activate_bifurcation_tracking() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::activate_bifurcation_tracking </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;&#160;</td>
          <td class="paramname"><em>parameter_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;&#160;</td>
          <td class="paramname"><em>eigenvector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;&#160;</td>
          <td class="paramname"><em>block_solve</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Activate generic bifurcation tracking for a single (real) eigenvalue where the initial guess for the eigenvector can be specified.</p>
<p>Activate the generic bifurcation ///tracking system by changing the assembly handler and initialising it using the parameter addressed by parameter_pt. </p>
<div class="fragment"><div class="line"><a name="l10132"></a><span class="lineno">10132</span>&#160;  {</div>
<div class="line"><a name="l10133"></a><span class="lineno">10133</span>&#160;    <span class="comment">// Reset the assembly handler to default</span></div>
<div class="line"><a name="l10134"></a><span class="lineno">10134</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a0b6b29c5e2ae9d4a22dac5b4494b7bc4">reset_assembly_handler_to_default</a>();</div>
<div class="line"><a name="l10135"></a><span class="lineno">10135</span>&#160;    <span class="comment">// Set the new assembly handler. Note that the constructor actually</span></div>
<div class="line"><a name="l10136"></a><span class="lineno">10136</span>&#160;    <span class="comment">// solves the original problem to get some initial conditions, but</span></div>
<div class="line"><a name="l10137"></a><span class="lineno">10137</span>&#160;    <span class="comment">// this is OK because the RHS is always evaluated before assignment.</span></div>
<div class="line"><a name="l10138"></a><span class="lineno">10138</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a> = <span class="keyword">new</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a1d79584bd556f960d5b92474681e0159">FoldHandler</a>(<span class="keyword">this</span>, parameter_pt, eigenvector);</div>
<div class="line"><a name="l10139"></a><span class="lineno">10139</span>&#160; </div>
<div class="line"><a name="l10140"></a><span class="lineno">10140</span>&#160;    <span class="comment">// If we are using a block solver, we must set the linear solver pointer</span></div>
<div class="line"><a name="l10141"></a><span class="lineno">10141</span>&#160;    <span class="comment">// to the block fold solver. The present linear solver is</span></div>
<div class="line"><a name="l10142"></a><span class="lineno">10142</span>&#160;    <span class="comment">// used by the block solver and so must be passed as an argument.</span></div>
<div class="line"><a name="l10143"></a><span class="lineno">10143</span>&#160;    <span class="comment">// The destructor of the Fold handler returns the linear</span></div>
<div class="line"><a name="l10144"></a><span class="lineno">10144</span>&#160;    <span class="comment">// solver to the original non-block version.</span></div>
<div class="line"><a name="l10145"></a><span class="lineno">10145</span>&#160;    <span class="keywordflow">if</span> (block_solve)</div>
<div class="line"><a name="l10146"></a><span class="lineno">10146</span>&#160;    {</div>
<div class="line"><a name="l10147"></a><span class="lineno">10147</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a> = <span class="keyword">new</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a29d9c39e6a14d2a4cc4e0d7c716579fe">AugmentedBlockFoldLinearSolver</a>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a>);</div>
<div class="line"><a name="l10148"></a><span class="lineno">10148</span>&#160;    }</div>
<div class="line"><a name="l10149"></a><span class="lineno">10149</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a0b6b29c5e2ae9d4a22dac5b4494b7bc4"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a0b6b29c5e2ae9d4a22dac5b4494b7bc4">oomph::Problem::reset_assembly_handler_to_default</a></div><div class="ttdeci">void reset_assembly_handler_to_default()</div><div class="ttdoc">Reset the system to the standard non-augemented state.</div><div class="ttdef"><b>Definition:</b> problem.cc:10275</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a1d79584bd556f960d5b92474681e0159"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a1d79584bd556f960d5b92474681e0159">oomph::Problem::FoldHandler</a></div><div class="ttdeci">friend class FoldHandler</div><div class="ttdef"><b>Definition:</b> problem.h:153</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a29d9c39e6a14d2a4cc4e0d7c716579fe"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a29d9c39e6a14d2a4cc4e0d7c716579fe">oomph::Problem::AugmentedBlockFoldLinearSolver</a></div><div class="ttdeci">friend class AugmentedBlockFoldLinearSolver</div><div class="ttdef"><b>Definition:</b> problem.h:160</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a29d9c39e6a14d2a4cc4e0d7c716579fe">AugmentedBlockFoldLinearSolver</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a1d79584bd556f960d5b92474681e0159">FoldHandler</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a0b6b29c5e2ae9d4a22dac5b4494b7bc4">reset_assembly_handler_to_default()</a>.</p>

</div>
</div>
<a id="ae2a142db67f0f417b04cb3c2b88d36fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2a142db67f0f417b04cb3c2b88d36fc">&#9670;&nbsp;</a></span>activate_bifurcation_tracking() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::activate_bifurcation_tracking </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;&#160;</td>
          <td class="paramname"><em>parameter_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;&#160;</td>
          <td class="paramname"><em>eigenvector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;&#160;</td>
          <td class="paramname"><em>normalisation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;&#160;</td>
          <td class="paramname"><em>block_solve</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Activate generic bifurcation tracking for a single (real) eigenvalue where the initial guess for the eigenvector can be specified and the normalisation condition can also be specified.</p>
<p>Activate the generic bifurcation ///tracking system by changing the assembly handler and initialising it using the parameter addressed by parameter_pt. </p>
<div class="fragment"><div class="line"><a name="l10161"></a><span class="lineno">10161</span>&#160;  {</div>
<div class="line"><a name="l10162"></a><span class="lineno">10162</span>&#160;    <span class="comment">// Reset the assembly handler to default</span></div>
<div class="line"><a name="l10163"></a><span class="lineno">10163</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a0b6b29c5e2ae9d4a22dac5b4494b7bc4">reset_assembly_handler_to_default</a>();</div>
<div class="line"><a name="l10164"></a><span class="lineno">10164</span>&#160;    <span class="comment">// Set the new assembly handler. Note that the constructor actually</span></div>
<div class="line"><a name="l10165"></a><span class="lineno">10165</span>&#160;    <span class="comment">// solves the original problem to get some initial conditions, but</span></div>
<div class="line"><a name="l10166"></a><span class="lineno">10166</span>&#160;    <span class="comment">// this is OK because the RHS is always evaluated before assignment.</span></div>
<div class="line"><a name="l10167"></a><span class="lineno">10167</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a> =</div>
<div class="line"><a name="l10168"></a><span class="lineno">10168</span>&#160;      <span class="keyword">new</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a1d79584bd556f960d5b92474681e0159">FoldHandler</a>(<span class="keyword">this</span>, parameter_pt, eigenvector, normalisation);</div>
<div class="line"><a name="l10169"></a><span class="lineno">10169</span>&#160; </div>
<div class="line"><a name="l10170"></a><span class="lineno">10170</span>&#160;    <span class="comment">// If we are using a block solver, we must set the linear solver pointer</span></div>
<div class="line"><a name="l10171"></a><span class="lineno">10171</span>&#160;    <span class="comment">// to the block fold solver. The present linear solver is</span></div>
<div class="line"><a name="l10172"></a><span class="lineno">10172</span>&#160;    <span class="comment">// used by the block solver and so must be passed as an argument.</span></div>
<div class="line"><a name="l10173"></a><span class="lineno">10173</span>&#160;    <span class="comment">// The destructor of the Fold handler returns the linear</span></div>
<div class="line"><a name="l10174"></a><span class="lineno">10174</span>&#160;    <span class="comment">// solver to the original non-block version.</span></div>
<div class="line"><a name="l10175"></a><span class="lineno">10175</span>&#160;    <span class="keywordflow">if</span> (block_solve)</div>
<div class="line"><a name="l10176"></a><span class="lineno">10176</span>&#160;    {</div>
<div class="line"><a name="l10177"></a><span class="lineno">10177</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a> = <span class="keyword">new</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a29d9c39e6a14d2a4cc4e0d7c716579fe">AugmentedBlockFoldLinearSolver</a>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a>);</div>
<div class="line"><a name="l10178"></a><span class="lineno">10178</span>&#160;    }</div>
<div class="line"><a name="l10179"></a><span class="lineno">10179</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a29d9c39e6a14d2a4cc4e0d7c716579fe">AugmentedBlockFoldLinearSolver</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a1d79584bd556f960d5b92474681e0159">FoldHandler</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a0b6b29c5e2ae9d4a22dac5b4494b7bc4">reset_assembly_handler_to_default()</a>.</p>

</div>
</div>
<a id="aa4f954e46b84b13a2bb16a83b3f0ff83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4f954e46b84b13a2bb16a83b3f0ff83">&#9670;&nbsp;</a></span>activate_fold_tracking()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::activate_fold_tracking </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;&#160;</td>
          <td class="paramname"><em>parameter_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;&#160;</td>
          <td class="paramname"><em>block_solve</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Turn on fold tracking using the augmented system specified in the FoldHandler class. After a call to this function subsequent calls of the standard solution methods will converge to a fold (limit) point at a particular value of the variable addressed by parameter_pt. The system may not converge if the initial guess is sufficiently poor or, alternatively, if finite differencing is used to calculate the jacobian matrix in the elements. If the boolean flag block_solver is true (the default) then a block factorisation is used to solve the augmented system which is both faster and uses less memory.</p>
<p>Activate the fold tracking system by changing the assembly handler and initialising it using the parameter addressed by parameter_pt. </p>
<div class="fragment"><div class="line"><a name="l10105"></a><span class="lineno">10105</span>&#160;  {</div>
<div class="line"><a name="l10106"></a><span class="lineno">10106</span>&#160;    <span class="comment">// Reset the assembly handler to default</span></div>
<div class="line"><a name="l10107"></a><span class="lineno">10107</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a0b6b29c5e2ae9d4a22dac5b4494b7bc4">reset_assembly_handler_to_default</a>();</div>
<div class="line"><a name="l10108"></a><span class="lineno">10108</span>&#160;    <span class="comment">// Set the new assembly handler. Note that the constructor actually</span></div>
<div class="line"><a name="l10109"></a><span class="lineno">10109</span>&#160;    <span class="comment">// solves the original problem to get some initial conditions, but</span></div>
<div class="line"><a name="l10110"></a><span class="lineno">10110</span>&#160;    <span class="comment">// this is OK because the RHS is always evaluated before assignment.</span></div>
<div class="line"><a name="l10111"></a><span class="lineno">10111</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a> = <span class="keyword">new</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a1d79584bd556f960d5b92474681e0159">FoldHandler</a>(<span class="keyword">this</span>, parameter_pt);</div>
<div class="line"><a name="l10112"></a><span class="lineno">10112</span>&#160; </div>
<div class="line"><a name="l10113"></a><span class="lineno">10113</span>&#160;    <span class="comment">// If we are using a block solver, we must set the linear solver pointer</span></div>
<div class="line"><a name="l10114"></a><span class="lineno">10114</span>&#160;    <span class="comment">// to the block fold solver. The present linear solver is</span></div>
<div class="line"><a name="l10115"></a><span class="lineno">10115</span>&#160;    <span class="comment">// used by the block solver and so must be passed as an argument.</span></div>
<div class="line"><a name="l10116"></a><span class="lineno">10116</span>&#160;    <span class="comment">// The destructor of the Fold handler returns the linear</span></div>
<div class="line"><a name="l10117"></a><span class="lineno">10117</span>&#160;    <span class="comment">// solver to the original non-block version.</span></div>
<div class="line"><a name="l10118"></a><span class="lineno">10118</span>&#160;    <span class="keywordflow">if</span> (block_solve)</div>
<div class="line"><a name="l10119"></a><span class="lineno">10119</span>&#160;    {</div>
<div class="line"><a name="l10120"></a><span class="lineno">10120</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a> = <span class="keyword">new</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a29d9c39e6a14d2a4cc4e0d7c716579fe">AugmentedBlockFoldLinearSolver</a>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a>);</div>
<div class="line"><a name="l10121"></a><span class="lineno">10121</span>&#160;    }</div>
<div class="line"><a name="l10122"></a><span class="lineno">10122</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a29d9c39e6a14d2a4cc4e0d7c716579fe">AugmentedBlockFoldLinearSolver</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a1d79584bd556f960d5b92474681e0159">FoldHandler</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a0b6b29c5e2ae9d4a22dac5b4494b7bc4">reset_assembly_handler_to_default()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa0b4e7868e02e2d12845c9b2dd60cab9">bifurcation_adapt_helper()</a>.</p>

</div>
</div>
<a id="a5202944fe909268c20abcfb4576d147b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5202944fe909268c20abcfb4576d147b">&#9670;&nbsp;</a></span>activate_hopf_tracking() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::activate_hopf_tracking </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;&#160;</td>
          <td class="paramname"><em>parameter_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;&#160;</td>
          <td class="paramname"><em>block_solve</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Turn on Hopf bifurcation tracking using the augmented system specified in the HopfHandler class. After a call to this function subsequent calls of the standard solution methods will converge to a Hopf bifuraction at a particular value of the variable addressed by parameter_pt. The system may not converge if the initial guess is sufficiently poor or, alternatively, if finite differencing is used to calculate the jacobian matrix in the elements.</p>
<p>Activate the hopf tracking system by changing the assembly handler and initialising it using the parameter addressed by parameter_pt. </p>
<div class="fragment"><div class="line"><a name="l10220"></a><span class="lineno">10220</span>&#160;  {</div>
<div class="line"><a name="l10221"></a><span class="lineno">10221</span>&#160;    <span class="comment">// Reset the assembly handler to default</span></div>
<div class="line"><a name="l10222"></a><span class="lineno">10222</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a0b6b29c5e2ae9d4a22dac5b4494b7bc4">reset_assembly_handler_to_default</a>();</div>
<div class="line"><a name="l10223"></a><span class="lineno">10223</span>&#160;    <span class="comment">// Set the new assembly handler. Note that the constructor actually</span></div>
<div class="line"><a name="l10224"></a><span class="lineno">10224</span>&#160;    <span class="comment">// solves the original problem to get some initial conditions, but</span></div>
<div class="line"><a name="l10225"></a><span class="lineno">10225</span>&#160;    <span class="comment">// this is OK because the RHS is always evaluated before assignment.</span></div>
<div class="line"><a name="l10226"></a><span class="lineno">10226</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a> = <span class="keyword">new</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a5653c9ce9d673e348e945594469ce0d3">HopfHandler</a>(<span class="keyword">this</span>, parameter_pt);</div>
<div class="line"><a name="l10227"></a><span class="lineno">10227</span>&#160; </div>
<div class="line"><a name="l10228"></a><span class="lineno">10228</span>&#160;    <span class="comment">// If we are using a block solver, we must set the linear solver pointer</span></div>
<div class="line"><a name="l10229"></a><span class="lineno">10229</span>&#160;    <span class="comment">// to the block hopf solver. The present linear solver is</span></div>
<div class="line"><a name="l10230"></a><span class="lineno">10230</span>&#160;    <span class="comment">// used by the block solver and so must be passed as an argument.</span></div>
<div class="line"><a name="l10231"></a><span class="lineno">10231</span>&#160;    <span class="comment">// The destructor of the Hopf handler returns the linear</span></div>
<div class="line"><a name="l10232"></a><span class="lineno">10232</span>&#160;    <span class="comment">// solver to the original non-block version.</span></div>
<div class="line"><a name="l10233"></a><span class="lineno">10233</span>&#160;    <span class="keywordflow">if</span> (block_solve)</div>
<div class="line"><a name="l10234"></a><span class="lineno">10234</span>&#160;    {</div>
<div class="line"><a name="l10235"></a><span class="lineno">10235</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a> = <span class="keyword">new</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a199677d64d3b2f908690d10a2398b737">BlockHopfLinearSolver</a>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a>);</div>
<div class="line"><a name="l10236"></a><span class="lineno">10236</span>&#160;    }</div>
<div class="line"><a name="l10237"></a><span class="lineno">10237</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a199677d64d3b2f908690d10a2398b737"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a199677d64d3b2f908690d10a2398b737">oomph::Problem::BlockHopfLinearSolver</a></div><div class="ttdeci">friend class BlockHopfLinearSolver</div><div class="ttdef"><b>Definition:</b> problem.h:162</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a5653c9ce9d673e348e945594469ce0d3"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a5653c9ce9d673e348e945594469ce0d3">oomph::Problem::HopfHandler</a></div><div class="ttdeci">friend class HopfHandler</div><div class="ttdef"><b>Definition:</b> problem.h:155</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a199677d64d3b2f908690d10a2398b737">BlockHopfLinearSolver</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5653c9ce9d673e348e945594469ce0d3">HopfHandler</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a0b6b29c5e2ae9d4a22dac5b4494b7bc4">reset_assembly_handler_to_default()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa0b4e7868e02e2d12845c9b2dd60cab9">bifurcation_adapt_helper()</a>.</p>

</div>
</div>
<a id="a78807475d5e238f2d58a6c36f3795ea0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78807475d5e238f2d58a6c36f3795ea0">&#9670;&nbsp;</a></span>activate_hopf_tracking() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::activate_hopf_tracking </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;&#160;</td>
          <td class="paramname"><em>parameter_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>omega</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;&#160;</td>
          <td class="paramname"><em>null_real</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;&#160;</td>
          <td class="paramname"><em>null_imag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;&#160;</td>
          <td class="paramname"><em>block_solve</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Turn on Hopf bifurcation tracking using the augmented system specified in the HopfHandler class. After a call to this function subsequent calls of the standard solution methods will converge to a Hopf bifuraction at a particular value of the variable addressed by parameter_pt. The system may not converge if the initial guess is sufficiently poor or, alternatively, if finite differencing is used to calculate the jacobian matrix in the elements. This interface allows specification of an inital guess for the frequency and real and imaginary parts of the null vector, such as might be obtained from an eigensolve</p>
<p>Activate the hopf tracking system by changing the assembly handler and initialising it using the parameter addressed by parameter_pt and the frequency and null vectors specified. </p>
<div class="fragment"><div class="line"><a name="l10251"></a><span class="lineno">10251</span>&#160;  {</div>
<div class="line"><a name="l10252"></a><span class="lineno">10252</span>&#160;    <span class="comment">// Reset the assembly handler to default</span></div>
<div class="line"><a name="l10253"></a><span class="lineno">10253</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a0b6b29c5e2ae9d4a22dac5b4494b7bc4">reset_assembly_handler_to_default</a>();</div>
<div class="line"><a name="l10254"></a><span class="lineno">10254</span>&#160;    <span class="comment">// Set the new assembly handler. Note that the constructor actually</span></div>
<div class="line"><a name="l10255"></a><span class="lineno">10255</span>&#160;    <span class="comment">// solves the original problem to get some initial conditions, but</span></div>
<div class="line"><a name="l10256"></a><span class="lineno">10256</span>&#160;    <span class="comment">// this is OK because the RHS is always evaluated before assignment.</span></div>
<div class="line"><a name="l10257"></a><span class="lineno">10257</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a> =</div>
<div class="line"><a name="l10258"></a><span class="lineno">10258</span>&#160;      <span class="keyword">new</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a5653c9ce9d673e348e945594469ce0d3">HopfHandler</a>(<span class="keyword">this</span>, parameter_pt, <a class="code" href="../../de/d37/namespaceEigen_1_1internal.html#af27bc4062e9730cfcb357e88c05e9e6c">omega</a>, null_real, null_imag);</div>
<div class="line"><a name="l10259"></a><span class="lineno">10259</span>&#160; </div>
<div class="line"><a name="l10260"></a><span class="lineno">10260</span>&#160;    <span class="comment">// If we are using a block solver, we must set the linear solver pointer</span></div>
<div class="line"><a name="l10261"></a><span class="lineno">10261</span>&#160;    <span class="comment">// to the block hopf solver. The present linear solver is</span></div>
<div class="line"><a name="l10262"></a><span class="lineno">10262</span>&#160;    <span class="comment">// used by the block solver and so must be passed as an argument.</span></div>
<div class="line"><a name="l10263"></a><span class="lineno">10263</span>&#160;    <span class="comment">// The destructor of the Hopf handler returns the linear</span></div>
<div class="line"><a name="l10264"></a><span class="lineno">10264</span>&#160;    <span class="comment">// solver to the original non-block version.</span></div>
<div class="line"><a name="l10265"></a><span class="lineno">10265</span>&#160;    <span class="keywordflow">if</span> (block_solve)</div>
<div class="line"><a name="l10266"></a><span class="lineno">10266</span>&#160;    {</div>
<div class="line"><a name="l10267"></a><span class="lineno">10267</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a> = <span class="keyword">new</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a199677d64d3b2f908690d10a2398b737">BlockHopfLinearSolver</a>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a>);</div>
<div class="line"><a name="l10268"></a><span class="lineno">10268</span>&#160;    }</div>
<div class="line"><a name="l10269"></a><span class="lineno">10269</span>&#160;  }</div>
<div class="ttc" id="anamespaceEigen_1_1internal_html_af27bc4062e9730cfcb357e88c05e9e6c"><div class="ttname"><a href="../../de/d37/namespaceEigen_1_1internal.html#af27bc4062e9730cfcb357e88c05e9e6c">Eigen::internal::omega</a></div><div class="ttdeci">Vector::Scalar omega(const Vector &amp;t, const Vector &amp;s, RealScalar angle)</div><div class="ttdef"><b>Definition:</b> IDRS.h:36</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a199677d64d3b2f908690d10a2398b737">BlockHopfLinearSolver</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5653c9ce9d673e348e945594469ce0d3">HopfHandler</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a>, <a class="el" href="../../de/d37/namespaceEigen_1_1internal.html#af27bc4062e9730cfcb357e88c05e9e6c">Eigen::internal::omega()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a0b6b29c5e2ae9d4a22dac5b4494b7bc4">reset_assembly_handler_to_default()</a>.</p>

</div>
</div>
<a id="a66fd78008266a4023f450971af444508"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66fd78008266a4023f450971af444508">&#9670;&nbsp;</a></span>activate_pitchfork_tracking()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::activate_pitchfork_tracking </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;&#160;</td>
          <td class="paramname"><em>parameter_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;&#160;</td>
          <td class="paramname"><em>symmetry_vector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;&#160;</td>
          <td class="paramname"><em>block_solve</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Turn on pitchfork tracking using the augmented system specified in the PitchForkHandler class. After a call to this function subsequent calls of the standard solution methods will converge to a pitchfork bifurcation at a particular value of the variable addressed by parameter_pt. The symmetry that is to be broken must be specified by supplying a symmetry_vector(ndof). The easiest way to determine such a vector is to solve the associated eigenproblem \( Jx = \lambda M x\) and pass in the eigenvector. This is not always necessary however, if the symmetry is easy to construct. The system may not converge if the initial guess is sufficiently poor or, alternatively, if finite differencing is used to calculate the jacobian matrix in the elements. If the boolean flag block_solver is true (the default) then a block factorisation is used to solve the augmented system which is both faster and requires less memory.</p>
<p>Activate the pitchfork tracking system by changing the assembly handler and initialising it using the parameter addressed by parameter_pt and a symmetry vector. The boolean flag is used to specify whether a block solver is used, default is true. </p>
<div class="fragment"><div class="line"><a name="l10191"></a><span class="lineno">10191</span>&#160;  {</div>
<div class="line"><a name="l10192"></a><span class="lineno">10192</span>&#160;    <span class="comment">// Reset the assembly handler to default</span></div>
<div class="line"><a name="l10193"></a><span class="lineno">10193</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a0b6b29c5e2ae9d4a22dac5b4494b7bc4">reset_assembly_handler_to_default</a>();</div>
<div class="line"><a name="l10194"></a><span class="lineno">10194</span>&#160; </div>
<div class="line"><a name="l10195"></a><span class="lineno">10195</span>&#160;    <span class="comment">// Set the new assembly handler. Note that the constructor actually</span></div>
<div class="line"><a name="l10196"></a><span class="lineno">10196</span>&#160;    <span class="comment">// solves the original problem to get some initial conditions, but</span></div>
<div class="line"><a name="l10197"></a><span class="lineno">10197</span>&#160;    <span class="comment">// this is OK because the RHS is always evaluated before assignment.</span></div>
<div class="line"><a name="l10198"></a><span class="lineno">10198</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a> = <span class="keyword">new</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a58bcd2e5d47842c64018e2c842bff302">PitchForkHandler</a>(</div>
<div class="line"><a name="l10199"></a><span class="lineno">10199</span>&#160;      <span class="keyword">this</span>, this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>(), parameter_pt, symmetry_vector);</div>
<div class="line"><a name="l10200"></a><span class="lineno">10200</span>&#160; </div>
<div class="line"><a name="l10201"></a><span class="lineno">10201</span>&#160;    <span class="comment">// If we are using a block solver, we must set the linear solver pointer</span></div>
<div class="line"><a name="l10202"></a><span class="lineno">10202</span>&#160;    <span class="comment">// to the block pitchfork solver. The present linear solver is</span></div>
<div class="line"><a name="l10203"></a><span class="lineno">10203</span>&#160;    <span class="comment">// used by the block solver and so must be passed as an argument.</span></div>
<div class="line"><a name="l10204"></a><span class="lineno">10204</span>&#160;    <span class="comment">// The destructor of the PitchFork handler returns the linear</span></div>
<div class="line"><a name="l10205"></a><span class="lineno">10205</span>&#160;    <span class="comment">// solver to the original non-block version.</span></div>
<div class="line"><a name="l10206"></a><span class="lineno">10206</span>&#160;    <span class="keywordflow">if</span> (block_solve)</div>
<div class="line"><a name="l10207"></a><span class="lineno">10207</span>&#160;    {</div>
<div class="line"><a name="l10208"></a><span class="lineno">10208</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a> = <span class="keyword">new</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aba62ac8cc057be07657972adc4a78b45">BlockPitchForkLinearSolver</a>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a>);</div>
<div class="line"><a name="l10209"></a><span class="lineno">10209</span>&#160;    }</div>
<div class="line"><a name="l10210"></a><span class="lineno">10210</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a381c30a8daede5c95bdda7e2efa24f19"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">oomph::Problem::assembly_handler_pt</a></div><div class="ttdeci">AssemblyHandler *&amp; assembly_handler_pt()</div><div class="ttdoc">Return a pointer to the assembly handler object.</div><div class="ttdef"><b>Definition:</b> problem.h:1570</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a58bcd2e5d47842c64018e2c842bff302"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a58bcd2e5d47842c64018e2c842bff302">oomph::Problem::PitchForkHandler</a></div><div class="ttdeci">friend class PitchForkHandler</div><div class="ttdef"><b>Definition:</b> problem.h:154</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_aba62ac8cc057be07657972adc4a78b45"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#aba62ac8cc057be07657972adc4a78b45">oomph::Problem::BlockPitchForkLinearSolver</a></div><div class="ttdeci">friend class BlockPitchForkLinearSolver</div><div class="ttdef"><b>Definition:</b> problem.h:159</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aba62ac8cc057be07657972adc4a78b45">BlockPitchForkLinearSolver</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a58bcd2e5d47842c64018e2c842bff302">PitchForkHandler</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a0b6b29c5e2ae9d4a22dac5b4494b7bc4">reset_assembly_handler_to_default()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa0b4e7868e02e2d12845c9b2dd60cab9">bifurcation_adapt_helper()</a>.</p>

</div>
</div>
<a id="a0b9e09ddfa2411f14fc723c3207decd1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b9e09ddfa2411f14fc723c3207decd1">&#9670;&nbsp;</a></span>adapt() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Problem::adapt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Adapt problem: Perform mesh adaptation for (all) refineable (sub)mesh(es), based on their own error estimates and the target errors specified in the mesh(es). Following mesh adaptation, update global mesh, and re-assign equation numbers. On return from this function, Problem can immediately be solved again. [Argument-free wrapper] </p>
<div class="fragment"><div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;    {</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;      <span class="keywordtype">unsigned</span> n_refined, n_unrefined;</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a0b9e09ddfa2411f14fc723c3207decd1">adapt</a>(n_refined, n_unrefined);</div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a0b9e09ddfa2411f14fc723c3207decd1"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a0b9e09ddfa2411f14fc723c3207decd1">oomph::Problem::adapt</a></div><div class="ttdeci">void adapt()</div><div class="ttdef"><b>Definition:</b> problem.h:2859</div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../d8/d28/classUnsteadyHeatProblem.html#a092accae60c9c4f22a730d883ac2cbed">UnsteadyHeatProblem&lt; ELEMENT &gt;::adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acc35de219c1c1032a14840021fd8a6b9">arc_length_step_solve_helper()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7c23771b77d6da7cbee3c3e3c050be73">doubly_adaptive_unsteady_newton_solve_helper()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#abdb4fbbb5d658094cfd48e2296c7d3b7">newton_solve()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a31d279b8e62fc676f25b9b347f4ffd8b">unsteady_newton_solve()</a>.</p>

</div>
</div>
<a id="ad5e60c7b47591bca6b20b0612e119983"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5e60c7b47591bca6b20b0612e119983">&#9670;&nbsp;</a></span>adapt() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::adapt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>n_refined</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>n_unrefined</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Adapt problem: Perform mesh adaptation for (all) refineable (sub)mesh(es), based on their own error estimates and the target errors specified in the mesh(es). Following mesh adaptation, update global mesh, and re-assign equation numbers. Return # of refined/unrefined elements. On return from this function, Problem can immediately be solved again. </p>
<div class="fragment"><div class="line"><a name="l13667"></a><span class="lineno">13667</span>&#160;  {</div>
<div class="line"><a name="l13668"></a><span class="lineno">13668</span>&#160;    <span class="keywordtype">double</span> t_start_total = 0.0;</div>
<div class="line"><a name="l13669"></a><span class="lineno">13669</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l13670"></a><span class="lineno">13670</span>&#160;    {</div>
<div class="line"><a name="l13671"></a><span class="lineno">13671</span>&#160;      t_start_total = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l13672"></a><span class="lineno">13672</span>&#160;    }</div>
<div class="line"><a name="l13673"></a><span class="lineno">13673</span>&#160; </div>
<div class="line"><a name="l13674"></a><span class="lineno">13674</span>&#160;    <span class="comment">// Get the bifurcation type</span></div>
<div class="line"><a name="l13675"></a><span class="lineno">13675</span>&#160;    <span class="keywordtype">int</span> bifurcation_type = this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>-&gt;<a class="code" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a22c5f240674e4f6cee12006790c11dae">bifurcation_type</a>();</div>
<div class="line"><a name="l13676"></a><span class="lineno">13676</span>&#160; </div>
<div class="line"><a name="l13677"></a><span class="lineno">13677</span>&#160;    <span class="keywordtype">bool</span> continuation_problem = <span class="keyword">false</span>;</div>
<div class="line"><a name="l13678"></a><span class="lineno">13678</span>&#160; </div>
<div class="line"><a name="l13679"></a><span class="lineno">13679</span>&#160;    <span class="comment">// If we have continuation data then we need to project that across to the</span></div>
<div class="line"><a name="l13680"></a><span class="lineno">13680</span>&#160;    <span class="comment">// new mesh</span></div>
<div class="line"><a name="l13681"></a><span class="lineno">13681</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#adbecce0cb1bd7b6b21285568e41ee3eb">Use_continuation_timestepper</a>)</div>
<div class="line"><a name="l13682"></a><span class="lineno">13682</span>&#160;    {</div>
<div class="line"><a name="l13683"></a><span class="lineno">13683</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a1861321b2d129707935bf1191238daca">Dof_derivative</a>.size() != 0)</div>
<div class="line"><a name="l13684"></a><span class="lineno">13684</span>&#160;      {</div>
<div class="line"><a name="l13685"></a><span class="lineno">13685</span>&#160;        continuation_problem = <span class="keyword">true</span>;</div>
<div class="line"><a name="l13686"></a><span class="lineno">13686</span>&#160;      }</div>
<div class="line"><a name="l13687"></a><span class="lineno">13687</span>&#160;    }</div>
<div class="line"><a name="l13688"></a><span class="lineno">13688</span>&#160; </div>
<div class="line"><a name="l13689"></a><span class="lineno">13689</span>&#160;    <span class="comment">// If we are tracking a bifurcation then call the bifurcation adapt function</span></div>
<div class="line"><a name="l13690"></a><span class="lineno">13690</span>&#160;    <span class="keywordflow">if</span> (bifurcation_type != 0)</div>
<div class="line"><a name="l13691"></a><span class="lineno">13691</span>&#160;    {</div>
<div class="line"><a name="l13692"></a><span class="lineno">13692</span>&#160;      this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa0b4e7868e02e2d12845c9b2dd60cab9">bifurcation_adapt_helper</a>(n_refined, n_unrefined, bifurcation_type);</div>
<div class="line"><a name="l13693"></a><span class="lineno">13693</span>&#160;      <span class="comment">// Return immediately</span></div>
<div class="line"><a name="l13694"></a><span class="lineno">13694</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l13695"></a><span class="lineno">13695</span>&#160;    }</div>
<div class="line"><a name="l13696"></a><span class="lineno">13696</span>&#160; </div>
<div class="line"><a name="l13697"></a><span class="lineno">13697</span>&#160;    <span class="keywordflow">if</span> (continuation_problem)</div>
<div class="line"><a name="l13698"></a><span class="lineno">13698</span>&#160;    {</div>
<div class="line"><a name="l13699"></a><span class="lineno">13699</span>&#160;      <span class="comment">// Create a copy of the problem</span></div>
<div class="line"><a name="l13700"></a><span class="lineno">13700</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa2e04de221f29c13067e2fe4cf4c70f9">Copy_of_problem_pt</a>.resize(2);</div>
<div class="line"><a name="l13701"></a><span class="lineno">13701</span>&#160;      <span class="comment">// If we don&#39;t already have a copy</span></div>
<div class="line"><a name="l13702"></a><span class="lineno">13702</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a> = 0; <a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a> &lt; 2; <a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>++)</div>
<div class="line"><a name="l13703"></a><span class="lineno">13703</span>&#160;      {</div>
<div class="line"><a name="l13704"></a><span class="lineno">13704</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa2e04de221f29c13067e2fe4cf4c70f9">Copy_of_problem_pt</a>[<a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>] == 0)</div>
<div class="line"><a name="l13705"></a><span class="lineno">13705</span>&#160;        {</div>
<div class="line"><a name="l13706"></a><span class="lineno">13706</span>&#160;          <span class="comment">// Create the copy</span></div>
<div class="line"><a name="l13707"></a><span class="lineno">13707</span>&#160;          <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa2e04de221f29c13067e2fe4cf4c70f9">Copy_of_problem_pt</a>[<a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>] = this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a1b10f0b678c60eaaa8bccb74ed1740f0">make_copy</a>();</div>
<div class="line"><a name="l13708"></a><span class="lineno">13708</span>&#160; </div>
<div class="line"><a name="l13709"></a><span class="lineno">13709</span>&#160;          <span class="comment">// Refine the copy to the same level as the current problem</span></div>
<div class="line"><a name="l13710"></a><span class="lineno">13710</span>&#160;          <span class="comment">// Must call actions before adapt</span></div>
<div class="line"><a name="l13711"></a><span class="lineno">13711</span>&#160;          <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa2e04de221f29c13067e2fe4cf4c70f9">Copy_of_problem_pt</a>[<a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>]-&gt;actions_before_adapt();</div>
<div class="line"><a name="l13712"></a><span class="lineno">13712</span>&#160; </div>
<div class="line"><a name="l13713"></a><span class="lineno">13713</span>&#160;          <span class="comment">// Find number of submeshes</span></div>
<div class="line"><a name="l13714"></a><span class="lineno">13714</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> N_mesh = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa2e04de221f29c13067e2fe4cf4c70f9">Copy_of_problem_pt</a>[<a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>]-&gt;nsub_mesh();</div>
<div class="line"><a name="l13715"></a><span class="lineno">13715</span>&#160; </div>
<div class="line"><a name="l13716"></a><span class="lineno">13716</span>&#160;          <span class="comment">// If there is only one mesh</span></div>
<div class="line"><a name="l13717"></a><span class="lineno">13717</span>&#160;          <span class="keywordflow">if</span> (N_mesh == 0)</div>
<div class="line"><a name="l13718"></a><span class="lineno">13718</span>&#160;          {</div>
<div class="line"><a name="l13719"></a><span class="lineno">13719</span>&#160;            <span class="comment">// Can we refine the mesh</span></div>
<div class="line"><a name="l13720"></a><span class="lineno">13720</span>&#160;            <span class="keywordflow">if</span> (TreeBasedRefineableMeshBase* mmesh_pt =</div>
<div class="line"><a name="l13721"></a><span class="lineno">13721</span>&#160;                  <span class="keyword">dynamic_cast&lt;</span>TreeBasedRefineableMeshBase*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l13722"></a><span class="lineno">13722</span>&#160;                    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa2e04de221f29c13067e2fe4cf4c70f9">Copy_of_problem_pt</a>[<a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>]-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(0)))</div>
<div class="line"><a name="l13723"></a><span class="lineno">13723</span>&#160;            {</div>
<div class="line"><a name="l13724"></a><span class="lineno">13724</span>&#160;              <span class="comment">// Is the adapt flag set</span></div>
<div class="line"><a name="l13725"></a><span class="lineno">13725</span>&#160;              <span class="keywordflow">if</span> (mmesh_pt-&gt;is_adaptation_enabled())</div>
<div class="line"><a name="l13726"></a><span class="lineno">13726</span>&#160;              {</div>
<div class="line"><a name="l13727"></a><span class="lineno">13727</span>&#160;                <span class="comment">// Now get the original problem&#39;s mesh if it&#39;s refineable</span></div>
<div class="line"><a name="l13728"></a><span class="lineno">13728</span>&#160;                <span class="keywordflow">if</span> (TreeBasedRefineableMeshBase* original_mesh_pt =</div>
<div class="line"><a name="l13729"></a><span class="lineno">13729</span>&#160;                      <span class="keyword">dynamic_cast&lt;</span>TreeBasedRefineableMeshBase*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l13730"></a><span class="lineno">13730</span>&#160;                        this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(0)))</div>
<div class="line"><a name="l13731"></a><span class="lineno">13731</span>&#160;                {</div>
<div class="line"><a name="l13732"></a><span class="lineno">13732</span>&#160;                  <span class="keywordflow">if</span> (<span class="keyword">dynamic_cast&lt;</span>SolidMesh*<span class="keyword">&gt;</span>(original_mesh_pt) != 0)</div>
<div class="line"><a name="l13733"></a><span class="lineno">13733</span>&#160;                  {</div>
<div class="line"><a name="l13734"></a><span class="lineno">13734</span>&#160;                    <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a></div>
<div class="line"><a name="l13735"></a><span class="lineno">13735</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Adaptive Continuation is broken in &quot;</span></div>
<div class="line"><a name="l13736"></a><span class="lineno">13736</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;SolidElement&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l13737"></a><span class="lineno">13737</span>&#160;                  }</div>
<div class="line"><a name="l13738"></a><span class="lineno">13738</span>&#160;                  mmesh_pt-&gt;refine_base_mesh_as_in_reference_mesh(</div>
<div class="line"><a name="l13739"></a><span class="lineno">13739</span>&#160;                    original_mesh_pt);</div>
<div class="line"><a name="l13740"></a><span class="lineno">13740</span>&#160;                }</div>
<div class="line"><a name="l13741"></a><span class="lineno">13741</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l13742"></a><span class="lineno">13742</span>&#160;                {</div>
<div class="line"><a name="l13743"></a><span class="lineno">13743</span>&#160;                  <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Mesh in orginal problem is not &quot;</span></div>
<div class="line"><a name="l13744"></a><span class="lineno">13744</span>&#160;                                <span class="stringliteral">&quot;refineable.&quot;</span></div>
<div class="line"><a name="l13745"></a><span class="lineno">13745</span>&#160;                             &lt;&lt; std::endl;</div>
<div class="line"><a name="l13746"></a><span class="lineno">13746</span>&#160;                }</div>
<div class="line"><a name="l13747"></a><span class="lineno">13747</span>&#160;              }</div>
<div class="line"><a name="l13748"></a><span class="lineno">13748</span>&#160;              <span class="keywordflow">else</span></div>
<div class="line"><a name="l13749"></a><span class="lineno">13749</span>&#160;              {</div>
<div class="line"><a name="l13750"></a><span class="lineno">13750</span>&#160;                <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a></div>
<div class="line"><a name="l13751"></a><span class="lineno">13751</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Mesh adaptation is disabled in copy.&quot;</span></div>
<div class="line"><a name="l13752"></a><span class="lineno">13752</span>&#160;                  &lt;&lt; std::endl;</div>
<div class="line"><a name="l13753"></a><span class="lineno">13753</span>&#160;              }</div>
<div class="line"><a name="l13754"></a><span class="lineno">13754</span>&#160;            }</div>
<div class="line"><a name="l13755"></a><span class="lineno">13755</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (TriangleMeshBase* tmesh_pt =</div>
<div class="line"><a name="l13756"></a><span class="lineno">13756</span>&#160;                       <span class="keyword">dynamic_cast&lt;</span>TriangleMeshBase*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l13757"></a><span class="lineno">13757</span>&#160;                         <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa2e04de221f29c13067e2fe4cf4c70f9">Copy_of_problem_pt</a>[<a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>]-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(0)))</div>
<div class="line"><a name="l13758"></a><span class="lineno">13758</span>&#160;            {</div>
<div class="line"><a name="l13759"></a><span class="lineno">13759</span>&#160;              <span class="keywordflow">if</span> (TriangleMeshBase* original_mesh_pt =</div>
<div class="line"><a name="l13760"></a><span class="lineno">13760</span>&#160;                    <span class="keyword">dynamic_cast&lt;</span>TriangleMeshBase*<span class="keyword">&gt;</span>(this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(0)))</div>
<div class="line"><a name="l13761"></a><span class="lineno">13761</span>&#160;              {</div>
<div class="line"><a name="l13762"></a><span class="lineno">13762</span>&#160;                <span class="keywordflow">if</span> (<span class="keyword">dynamic_cast&lt;</span>SolidMesh*<span class="keyword">&gt;</span>(original_mesh_pt) != 0)</div>
<div class="line"><a name="l13763"></a><span class="lineno">13763</span>&#160;                {</div>
<div class="line"><a name="l13764"></a><span class="lineno">13764</span>&#160;                  <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a></div>
<div class="line"><a name="l13765"></a><span class="lineno">13765</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Adaptive Continuation is broken in &quot;</span></div>
<div class="line"><a name="l13766"></a><span class="lineno">13766</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;SolidElement&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l13767"></a><span class="lineno">13767</span>&#160;                }</div>
<div class="line"><a name="l13768"></a><span class="lineno">13768</span>&#160; </div>
<div class="line"><a name="l13769"></a><span class="lineno">13769</span>&#160;                <span class="comment">// Remesh using the triangulateIO of the base mesh</span></div>
<div class="line"><a name="l13770"></a><span class="lineno">13770</span>&#160;                <span class="comment">// Done via a file, so a bit hacky but this will be</span></div>
<div class="line"><a name="l13771"></a><span class="lineno">13771</span>&#160;                <span class="comment">// superseded very soon</span></div>
<div class="line"><a name="l13772"></a><span class="lineno">13772</span>&#160;                std::ofstream tri_dump(<span class="stringliteral">&quot;triangle_mesh.dmp&quot;</span>);</div>
<div class="line"><a name="l13773"></a><span class="lineno">13773</span>&#160;                original_mesh_pt-&gt;dump_triangulateio(tri_dump);</div>
<div class="line"><a name="l13774"></a><span class="lineno">13774</span>&#160;                tri_dump.close();</div>
<div class="line"><a name="l13775"></a><span class="lineno">13775</span>&#160;                std::ifstream tri_read(<span class="stringliteral">&quot;triangle_mesh.dmp&quot;</span>);</div>
<div class="line"><a name="l13776"></a><span class="lineno">13776</span>&#160;                tmesh_pt-&gt;remesh_from_triangulateio(tri_read);</div>
<div class="line"><a name="l13777"></a><span class="lineno">13777</span>&#160;                tri_read.close();</div>
<div class="line"><a name="l13778"></a><span class="lineno">13778</span>&#160; </div>
<div class="line"><a name="l13779"></a><span class="lineno">13779</span>&#160; </div>
<div class="line"><a name="l13780"></a><span class="lineno">13780</span>&#160;                <span class="comment">// Set the nodes to be at the same positions</span></div>
<div class="line"><a name="l13781"></a><span class="lineno">13781</span>&#160;                <span class="comment">// as the original just in case the</span></div>
<div class="line"><a name="l13782"></a><span class="lineno">13782</span>&#160;                <span class="comment">// triangulatio is out of sync with the real data</span></div>
<div class="line"><a name="l13783"></a><span class="lineno">13783</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_node = original_mesh_pt-&gt;nnode();</div>
<div class="line"><a name="l13784"></a><span class="lineno">13784</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_node; ++<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>)</div>
<div class="line"><a name="l13785"></a><span class="lineno">13785</span>&#160;                {</div>
<div class="line"><a name="l13786"></a><span class="lineno">13786</span>&#160;                  Node* <span class="keyword">const</span> nod_pt = original_mesh_pt-&gt;node_pt(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>);</div>
<div class="line"><a name="l13787"></a><span class="lineno">13787</span>&#160;                  Node* <span class="keyword">const</span> new_node_pt = tmesh_pt-&gt;node_pt(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>);</div>
<div class="line"><a name="l13788"></a><span class="lineno">13788</span>&#160;                  <span class="keywordtype">unsigned</span> n_dim = nod_pt-&gt;ndim();</div>
<div class="line"><a name="l13789"></a><span class="lineno">13789</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_dim; ++<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><a name="l13790"></a><span class="lineno">13790</span>&#160;                  {</div>
<div class="line"><a name="l13791"></a><span class="lineno">13791</span>&#160;                    new_node_pt-&gt;x(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = nod_pt-&gt;x(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l13792"></a><span class="lineno">13792</span>&#160;                  }</div>
<div class="line"><a name="l13793"></a><span class="lineno">13793</span>&#160;                }</div>
<div class="line"><a name="l13794"></a><span class="lineno">13794</span>&#160;              }</div>
<div class="line"><a name="l13795"></a><span class="lineno">13795</span>&#160;              <span class="keywordflow">else</span></div>
<div class="line"><a name="l13796"></a><span class="lineno">13796</span>&#160;              {</div>
<div class="line"><a name="l13797"></a><span class="lineno">13797</span>&#160;                <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a></div>
<div class="line"><a name="l13798"></a><span class="lineno">13798</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;Info/warning: Original Mesh is not TriangleBased\n&quot;</span></div>
<div class="line"><a name="l13799"></a><span class="lineno">13799</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;... but the copy is!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l13800"></a><span class="lineno">13800</span>&#160;              }</div>
<div class="line"><a name="l13801"></a><span class="lineno">13801</span>&#160;            }</div>
<div class="line"><a name="l13802"></a><span class="lineno">13802</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l13803"></a><span class="lineno">13803</span>&#160;            {</div>
<div class="line"><a name="l13804"></a><span class="lineno">13804</span>&#160;              <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Mesh cannot be adapted in copy.&quot;</span></div>
<div class="line"><a name="l13805"></a><span class="lineno">13805</span>&#160;                         &lt;&lt; std::endl;</div>
<div class="line"><a name="l13806"></a><span class="lineno">13806</span>&#160;            }</div>
<div class="line"><a name="l13807"></a><span class="lineno">13807</span>&#160;          } <span class="comment">// End of single mesh case</span></div>
<div class="line"><a name="l13808"></a><span class="lineno">13808</span>&#160;          <span class="comment">// Otherwise loop over the submeshes</span></div>
<div class="line"><a name="l13809"></a><span class="lineno">13809</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l13810"></a><span class="lineno">13810</span>&#160;          {</div>
<div class="line"><a name="l13811"></a><span class="lineno">13811</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> = 0; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> &lt; N_mesh; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>++)</div>
<div class="line"><a name="l13812"></a><span class="lineno">13812</span>&#160;            {</div>
<div class="line"><a name="l13813"></a><span class="lineno">13813</span>&#160;              <span class="comment">// Can we refine the submesh</span></div>
<div class="line"><a name="l13814"></a><span class="lineno">13814</span>&#160;              <span class="keywordflow">if</span> (TreeBasedRefineableMeshBase* mmesh_pt =</div>
<div class="line"><a name="l13815"></a><span class="lineno">13815</span>&#160;                    <span class="keyword">dynamic_cast&lt;</span>TreeBasedRefineableMeshBase*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l13816"></a><span class="lineno">13816</span>&#160;                      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa2e04de221f29c13067e2fe4cf4c70f9">Copy_of_problem_pt</a>[<a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>]-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>)))</div>
<div class="line"><a name="l13817"></a><span class="lineno">13817</span>&#160;              {</div>
<div class="line"><a name="l13818"></a><span class="lineno">13818</span>&#160;                <span class="comment">// Is the adapt flag set</span></div>
<div class="line"><a name="l13819"></a><span class="lineno">13819</span>&#160;                <span class="keywordflow">if</span> (mmesh_pt-&gt;is_adaptation_enabled())</div>
<div class="line"><a name="l13820"></a><span class="lineno">13820</span>&#160;                {</div>
<div class="line"><a name="l13821"></a><span class="lineno">13821</span>&#160;                  <span class="comment">// Now get the original problem&#39;s mesh</span></div>
<div class="line"><a name="l13822"></a><span class="lineno">13822</span>&#160;                  <span class="keywordflow">if</span> (TreeBasedRefineableMeshBase* original_mesh_pt =</div>
<div class="line"><a name="l13823"></a><span class="lineno">13823</span>&#160;                        <span class="keyword">dynamic_cast&lt;</span>TreeBasedRefineableMeshBase*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l13824"></a><span class="lineno">13824</span>&#160;                          this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>)))</div>
<div class="line"><a name="l13825"></a><span class="lineno">13825</span>&#160;                  {</div>
<div class="line"><a name="l13826"></a><span class="lineno">13826</span>&#160;                    <span class="keywordflow">if</span> (<span class="keyword">dynamic_cast&lt;</span>SolidMesh*<span class="keyword">&gt;</span>(original_mesh_pt) != 0)</div>
<div class="line"><a name="l13827"></a><span class="lineno">13827</span>&#160;                    {</div>
<div class="line"><a name="l13828"></a><span class="lineno">13828</span>&#160;                      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a></div>
<div class="line"><a name="l13829"></a><span class="lineno">13829</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Adaptive Continuation is broken in &quot;</span></div>
<div class="line"><a name="l13830"></a><span class="lineno">13830</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot;SolidElement&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l13831"></a><span class="lineno">13831</span>&#160;                    }</div>
<div class="line"><a name="l13832"></a><span class="lineno">13832</span>&#160; </div>
<div class="line"><a name="l13833"></a><span class="lineno">13833</span>&#160;                    mmesh_pt-&gt;refine_base_mesh_as_in_reference_mesh(</div>
<div class="line"><a name="l13834"></a><span class="lineno">13834</span>&#160;                      original_mesh_pt);</div>
<div class="line"><a name="l13835"></a><span class="lineno">13835</span>&#160;                  }</div>
<div class="line"><a name="l13836"></a><span class="lineno">13836</span>&#160;                  <span class="keywordflow">else</span></div>
<div class="line"><a name="l13837"></a><span class="lineno">13837</span>&#160;                  {</div>
<div class="line"><a name="l13838"></a><span class="lineno">13838</span>&#160;                    <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Mesh in orginal problem is &quot;</span></div>
<div class="line"><a name="l13839"></a><span class="lineno">13839</span>&#160;                                  <span class="stringliteral">&quot;not refineable.&quot;</span></div>
<div class="line"><a name="l13840"></a><span class="lineno">13840</span>&#160;                               &lt;&lt; std::endl;</div>
<div class="line"><a name="l13841"></a><span class="lineno">13841</span>&#160;                  }</div>
<div class="line"><a name="l13842"></a><span class="lineno">13842</span>&#160;                }</div>
<div class="line"><a name="l13843"></a><span class="lineno">13843</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l13844"></a><span class="lineno">13844</span>&#160;                {</div>
<div class="line"><a name="l13845"></a><span class="lineno">13845</span>&#160;                  <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a></div>
<div class="line"><a name="l13846"></a><span class="lineno">13846</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Mesh adaptation is disabled in copy.&quot;</span></div>
<div class="line"><a name="l13847"></a><span class="lineno">13847</span>&#160;                    &lt;&lt; std::endl;</div>
<div class="line"><a name="l13848"></a><span class="lineno">13848</span>&#160;                }</div>
<div class="line"><a name="l13849"></a><span class="lineno">13849</span>&#160;              }</div>
<div class="line"><a name="l13850"></a><span class="lineno">13850</span>&#160;              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (TriangleMeshBase* tmesh_pt =</div>
<div class="line"><a name="l13851"></a><span class="lineno">13851</span>&#160;                         <span class="keyword">dynamic_cast&lt;</span>TriangleMeshBase*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l13852"></a><span class="lineno">13852</span>&#160;                           <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa2e04de221f29c13067e2fe4cf4c70f9">Copy_of_problem_pt</a>[<a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>]-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>)))</div>
<div class="line"><a name="l13853"></a><span class="lineno">13853</span>&#160;              {</div>
<div class="line"><a name="l13854"></a><span class="lineno">13854</span>&#160;                <span class="keywordflow">if</span> (TriangleMeshBase* original_mesh_pt =</div>
<div class="line"><a name="l13855"></a><span class="lineno">13855</span>&#160;                      <span class="keyword">dynamic_cast&lt;</span>TriangleMeshBase*<span class="keyword">&gt;</span>(this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>)))</div>
<div class="line"><a name="l13856"></a><span class="lineno">13856</span>&#160;                {</div>
<div class="line"><a name="l13857"></a><span class="lineno">13857</span>&#160;                  <span class="keywordflow">if</span> (<span class="keyword">dynamic_cast&lt;</span>SolidMesh*<span class="keyword">&gt;</span>(original_mesh_pt) != 0)</div>
<div class="line"><a name="l13858"></a><span class="lineno">13858</span>&#160;                  {</div>
<div class="line"><a name="l13859"></a><span class="lineno">13859</span>&#160;                    <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a></div>
<div class="line"><a name="l13860"></a><span class="lineno">13860</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Adaptive Continuation is broken in &quot;</span></div>
<div class="line"><a name="l13861"></a><span class="lineno">13861</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;SolidElement&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l13862"></a><span class="lineno">13862</span>&#160;                  }</div>
<div class="line"><a name="l13863"></a><span class="lineno">13863</span>&#160; </div>
<div class="line"><a name="l13864"></a><span class="lineno">13864</span>&#160;                  <span class="comment">// Remesh using the triangulateIO of the base mesh</span></div>
<div class="line"><a name="l13865"></a><span class="lineno">13865</span>&#160;                  <span class="comment">// Done via a file, so a bit hacky but this will be</span></div>
<div class="line"><a name="l13866"></a><span class="lineno">13866</span>&#160;                  <span class="comment">// superseded very soon</span></div>
<div class="line"><a name="l13867"></a><span class="lineno">13867</span>&#160;                  std::ofstream tri_dump(<span class="stringliteral">&quot;triangle_mesh.dmp&quot;</span>);</div>
<div class="line"><a name="l13868"></a><span class="lineno">13868</span>&#160;                  original_mesh_pt-&gt;dump_triangulateio(tri_dump);</div>
<div class="line"><a name="l13869"></a><span class="lineno">13869</span>&#160;                  tri_dump.close();</div>
<div class="line"><a name="l13870"></a><span class="lineno">13870</span>&#160;                  std::ifstream tri_read(<span class="stringliteral">&quot;triangle_mesh.dmp&quot;</span>);</div>
<div class="line"><a name="l13871"></a><span class="lineno">13871</span>&#160;                  tmesh_pt-&gt;remesh_from_triangulateio(tri_read);</div>
<div class="line"><a name="l13872"></a><span class="lineno">13872</span>&#160;                  tri_read.close();</div>
<div class="line"><a name="l13873"></a><span class="lineno">13873</span>&#160; </div>
<div class="line"><a name="l13874"></a><span class="lineno">13874</span>&#160;                  <span class="comment">// Set the nodes to be at the same positions</span></div>
<div class="line"><a name="l13875"></a><span class="lineno">13875</span>&#160;                  <span class="comment">// as the original just in case the</span></div>
<div class="line"><a name="l13876"></a><span class="lineno">13876</span>&#160;                  <span class="comment">// triangulatio is out of sync with the real data</span></div>
<div class="line"><a name="l13877"></a><span class="lineno">13877</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_node = original_mesh_pt-&gt;nnode();</div>
<div class="line"><a name="l13878"></a><span class="lineno">13878</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_node; ++<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>)</div>
<div class="line"><a name="l13879"></a><span class="lineno">13879</span>&#160;                  {</div>
<div class="line"><a name="l13880"></a><span class="lineno">13880</span>&#160;                    Node* <span class="keyword">const</span> nod_pt = original_mesh_pt-&gt;node_pt(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>);</div>
<div class="line"><a name="l13881"></a><span class="lineno">13881</span>&#160;                    Node* <span class="keyword">const</span> new_node_pt = tmesh_pt-&gt;node_pt(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>);</div>
<div class="line"><a name="l13882"></a><span class="lineno">13882</span>&#160;                    <span class="keywordtype">unsigned</span> n_dim = nod_pt-&gt;ndim();</div>
<div class="line"><a name="l13883"></a><span class="lineno">13883</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_dim; ++<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><a name="l13884"></a><span class="lineno">13884</span>&#160;                    {</div>
<div class="line"><a name="l13885"></a><span class="lineno">13885</span>&#160;                      new_node_pt-&gt;x(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = nod_pt-&gt;x(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l13886"></a><span class="lineno">13886</span>&#160;                    }</div>
<div class="line"><a name="l13887"></a><span class="lineno">13887</span>&#160;                  }</div>
<div class="line"><a name="l13888"></a><span class="lineno">13888</span>&#160;                }</div>
<div class="line"><a name="l13889"></a><span class="lineno">13889</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l13890"></a><span class="lineno">13890</span>&#160;                {</div>
<div class="line"><a name="l13891"></a><span class="lineno">13891</span>&#160;                  <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a></div>
<div class="line"><a name="l13892"></a><span class="lineno">13892</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;Info/warning: Original Mesh is not TriangleBased\n&quot;</span></div>
<div class="line"><a name="l13893"></a><span class="lineno">13893</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;... but the copy is!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l13894"></a><span class="lineno">13894</span>&#160;                }</div>
<div class="line"><a name="l13895"></a><span class="lineno">13895</span>&#160;              }</div>
<div class="line"><a name="l13896"></a><span class="lineno">13896</span>&#160;              <span class="keywordflow">else</span></div>
<div class="line"><a name="l13897"></a><span class="lineno">13897</span>&#160;              {</div>
<div class="line"><a name="l13898"></a><span class="lineno">13898</span>&#160;                <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Mesh cannot be adapted in copy.&quot;</span></div>
<div class="line"><a name="l13899"></a><span class="lineno">13899</span>&#160;                           &lt;&lt; std::endl;</div>
<div class="line"><a name="l13900"></a><span class="lineno">13900</span>&#160;              }</div>
<div class="line"><a name="l13901"></a><span class="lineno">13901</span>&#160;            }</div>
<div class="line"><a name="l13902"></a><span class="lineno">13902</span>&#160; </div>
<div class="line"><a name="l13903"></a><span class="lineno">13903</span>&#160; </div>
<div class="line"><a name="l13904"></a><span class="lineno">13904</span>&#160;            <span class="comment">// Must call actions after adapt</span></div>
<div class="line"><a name="l13905"></a><span class="lineno">13905</span>&#160;            <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa2e04de221f29c13067e2fe4cf4c70f9">Copy_of_problem_pt</a>[<a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>]-&gt;actions_after_adapt();</div>
<div class="line"><a name="l13906"></a><span class="lineno">13906</span>&#160; </div>
<div class="line"><a name="l13907"></a><span class="lineno">13907</span>&#160;            <span class="comment">// rebuild the global mesh in the copy</span></div>
<div class="line"><a name="l13908"></a><span class="lineno">13908</span>&#160;            <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa2e04de221f29c13067e2fe4cf4c70f9">Copy_of_problem_pt</a>[<a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>]-&gt;rebuild_global_mesh();</div>
<div class="line"><a name="l13909"></a><span class="lineno">13909</span>&#160; </div>
<div class="line"><a name="l13910"></a><span class="lineno">13910</span>&#160;          } <span class="comment">// End of multiple mesh case</span></div>
<div class="line"><a name="l13911"></a><span class="lineno">13911</span>&#160; </div>
<div class="line"><a name="l13912"></a><span class="lineno">13912</span>&#160;          <span class="comment">// Must call actions after adapt</span></div>
<div class="line"><a name="l13913"></a><span class="lineno">13913</span>&#160;          <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa2e04de221f29c13067e2fe4cf4c70f9">Copy_of_problem_pt</a>[<a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>]-&gt;actions_after_adapt();</div>
<div class="line"><a name="l13914"></a><span class="lineno">13914</span>&#160; </div>
<div class="line"><a name="l13915"></a><span class="lineno">13915</span>&#160;          <span class="comment">// Assign the equation numbers to the copy (quietly)</span></div>
<div class="line"><a name="l13916"></a><span class="lineno">13916</span>&#160;          (void)<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa2e04de221f29c13067e2fe4cf4c70f9">Copy_of_problem_pt</a>[<a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>]-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers</a>();</div>
<div class="line"><a name="l13917"></a><span class="lineno">13917</span>&#160;        }</div>
<div class="line"><a name="l13918"></a><span class="lineno">13918</span>&#160; </div>
<div class="line"><a name="l13919"></a><span class="lineno">13919</span>&#160;        <span class="comment">// Check that the dofs match for each copy</span></div>
<div class="line"><a name="l13920"></a><span class="lineno">13920</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l13921"></a><span class="lineno">13921</span>&#160;        <span class="comment">// If the problems don&#39;t match then complain</span></div>
<div class="line"><a name="l13922"></a><span class="lineno">13922</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa2e04de221f29c13067e2fe4cf4c70f9">Copy_of_problem_pt</a>[<a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>]-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>() != this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>())</div>
<div class="line"><a name="l13923"></a><span class="lineno">13923</span>&#160;        {</div>
<div class="line"><a name="l13924"></a><span class="lineno">13924</span>&#160;          std::ostringstream error_stream;</div>
<div class="line"><a name="l13925"></a><span class="lineno">13925</span>&#160;          error_stream &lt;&lt; <span class="stringliteral">&quot;Number of unknowns in the problem copy &quot;</span> &lt;&lt; <a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l13926"></a><span class="lineno">13926</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot;not equal to number in the original:\n&quot;</span></div>
<div class="line"><a name="l13927"></a><span class="lineno">13927</span>&#160;                       &lt;&lt; this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>() &lt;&lt; <span class="stringliteral">&quot; (original) &quot;</span></div>
<div class="line"><a name="l13928"></a><span class="lineno">13928</span>&#160;                       &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa2e04de221f29c13067e2fe4cf4c70f9">Copy_of_problem_pt</a>[<a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>]-&gt;ndof() &lt;&lt; <span class="stringliteral">&quot; (copy)\n&quot;</span>;</div>
<div class="line"><a name="l13929"></a><span class="lineno">13929</span>&#160; </div>
<div class="line"><a name="l13930"></a><span class="lineno">13930</span>&#160;          <span class="keywordflow">throw</span> OomphLibError(error_stream.str(),</div>
<div class="line"><a name="l13931"></a><span class="lineno">13931</span>&#160;                              <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l13932"></a><span class="lineno">13932</span>&#160;                              <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l13933"></a><span class="lineno">13933</span>&#160;        }</div>
<div class="line"><a name="l13934"></a><span class="lineno">13934</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l13935"></a><span class="lineno">13935</span>&#160;      }</div>
<div class="line"><a name="l13936"></a><span class="lineno">13936</span>&#160; </div>
<div class="line"><a name="l13937"></a><span class="lineno">13937</span>&#160;      <span class="comment">// Need to set the Dof derivatives to the copied problem</span></div>
<div class="line"><a name="l13938"></a><span class="lineno">13938</span>&#160;      <span class="comment">// Assign the eigenfunction(s) to the copied problems</span></div>
<div class="line"><a name="l13939"></a><span class="lineno">13939</span>&#160;      <span class="keywordtype">unsigned</span> ndof_local = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">nrow_local</a>();</div>
<div class="line"><a name="l13940"></a><span class="lineno">13940</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; ndof_local; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l13941"></a><span class="lineno">13941</span>&#160;      {</div>
<div class="line"><a name="l13942"></a><span class="lineno">13942</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa2e04de221f29c13067e2fe4cf4c70f9">Copy_of_problem_pt</a>[0]-&gt;dof(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad6df5fb0d282f25df1e94a665dd838e5">dof_derivative</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l13943"></a><span class="lineno">13943</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa2e04de221f29c13067e2fe4cf4c70f9">Copy_of_problem_pt</a>[1]-&gt;dof(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a10fd6457ceceb02a0e11d860ac0017c5">dof_current</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l13944"></a><span class="lineno">13944</span>&#160;      }</div>
<div class="line"><a name="l13945"></a><span class="lineno">13945</span>&#160;      <span class="comment">// Set all pinned values to zero</span></div>
<div class="line"><a name="l13946"></a><span class="lineno">13946</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa2e04de221f29c13067e2fe4cf4c70f9">Copy_of_problem_pt</a>[0]-&gt;set_pinned_values_to_zero();</div>
<div class="line"><a name="l13947"></a><span class="lineno">13947</span>&#160;      <span class="comment">// Don&#39;t need to for the current dofs that are actuall the dofs</span></div>
<div class="line"><a name="l13948"></a><span class="lineno">13948</span>&#160; </div>
<div class="line"><a name="l13949"></a><span class="lineno">13949</span>&#160;      <span class="comment">// Now adapt</span></div>
<div class="line"><a name="l13950"></a><span class="lineno">13950</span>&#160;      Vector&lt;Vector&lt;double&gt;&gt; base_error;</div>
<div class="line"><a name="l13951"></a><span class="lineno">13951</span>&#160;      this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a2bd35d5954b6a8d43189b84520adb4b3">get_all_error_estimates</a>(base_error);</div>
<div class="line"><a name="l13952"></a><span class="lineno">13952</span>&#160;      this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a309487c952f108015b53a2d70539ac8b">adapt_based_on_error_estimates</a>(n_refined, n_unrefined, base_error);</div>
<div class="line"><a name="l13953"></a><span class="lineno">13953</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa2e04de221f29c13067e2fe4cf4c70f9">Copy_of_problem_pt</a>[0]-&gt;adapt_based_on_error_estimates(</div>
<div class="line"><a name="l13954"></a><span class="lineno">13954</span>&#160;        n_refined, n_unrefined, base_error);</div>
<div class="line"><a name="l13955"></a><span class="lineno">13955</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa2e04de221f29c13067e2fe4cf4c70f9">Copy_of_problem_pt</a>[1]-&gt;adapt_based_on_error_estimates(</div>
<div class="line"><a name="l13956"></a><span class="lineno">13956</span>&#160;        n_refined, n_unrefined, base_error);</div>
<div class="line"><a name="l13957"></a><span class="lineno">13957</span>&#160; </div>
<div class="line"><a name="l13958"></a><span class="lineno">13958</span>&#160;      <span class="comment">// Now sort out the Dof pointer</span></div>
<div class="line"><a name="l13959"></a><span class="lineno">13959</span>&#160;      ndof_local = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">nrow_local</a>();</div>
<div class="line"><a name="l13960"></a><span class="lineno">13960</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a1861321b2d129707935bf1191238daca">Dof_derivative</a>.size() != ndof_local)</div>
<div class="line"><a name="l13961"></a><span class="lineno">13961</span>&#160;      {</div>
<div class="line"><a name="l13962"></a><span class="lineno">13962</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a1861321b2d129707935bf1191238daca">Dof_derivative</a>.resize(ndof_local, 0.0);</div>
<div class="line"><a name="l13963"></a><span class="lineno">13963</span>&#160;      }</div>
<div class="line"><a name="l13964"></a><span class="lineno">13964</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a366b50c490e9fd3ddafa05b2fbd0b883">Dof_current</a>.size() != ndof_local)</div>
<div class="line"><a name="l13965"></a><span class="lineno">13965</span>&#160;      {</div>
<div class="line"><a name="l13966"></a><span class="lineno">13966</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a366b50c490e9fd3ddafa05b2fbd0b883">Dof_current</a>.resize(ndof_local, 0.0);</div>
<div class="line"><a name="l13967"></a><span class="lineno">13967</span>&#160;      }</div>
<div class="line"><a name="l13968"></a><span class="lineno">13968</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; ndof_local; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l13969"></a><span class="lineno">13969</span>&#160;      {</div>
<div class="line"><a name="l13970"></a><span class="lineno">13970</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a1861321b2d129707935bf1191238daca">Dof_derivative</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa2e04de221f29c13067e2fe4cf4c70f9">Copy_of_problem_pt</a>[0]-&gt;dof(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l13971"></a><span class="lineno">13971</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a366b50c490e9fd3ddafa05b2fbd0b883">Dof_current</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa2e04de221f29c13067e2fe4cf4c70f9">Copy_of_problem_pt</a>[1]-&gt;dof(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l13972"></a><span class="lineno">13972</span>&#160;      }</div>
<div class="line"><a name="l13973"></a><span class="lineno">13973</span>&#160;      <span class="comment">// Return immediately</span></div>
<div class="line"><a name="l13974"></a><span class="lineno">13974</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l13975"></a><span class="lineno">13975</span>&#160;    }</div>
<div class="line"><a name="l13976"></a><span class="lineno">13976</span>&#160; </div>
<div class="line"><a name="l13977"></a><span class="lineno">13977</span>&#160;    <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; std::endl &lt;&lt; std::endl;</div>
<div class="line"><a name="l13978"></a><span class="lineno">13978</span>&#160;    <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Adapting problem:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l13979"></a><span class="lineno">13979</span>&#160;    <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;=================&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l13980"></a><span class="lineno">13980</span>&#160; </div>
<div class="line"><a name="l13981"></a><span class="lineno">13981</span>&#160;    <span class="keywordtype">double</span> t_start = 0.0;</div>
<div class="line"><a name="l13982"></a><span class="lineno">13982</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l13983"></a><span class="lineno">13983</span>&#160;    {</div>
<div class="line"><a name="l13984"></a><span class="lineno">13984</span>&#160;      t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l13985"></a><span class="lineno">13985</span>&#160;    }</div>
<div class="line"><a name="l13986"></a><span class="lineno">13986</span>&#160; </div>
<div class="line"><a name="l13987"></a><span class="lineno">13987</span>&#160;    <span class="comment">// Call the actions before adaptation</span></div>
<div class="line"><a name="l13988"></a><span class="lineno">13988</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">actions_before_adapt</a>();</div>
<div class="line"><a name="l13989"></a><span class="lineno">13989</span>&#160; </div>
<div class="line"><a name="l13990"></a><span class="lineno">13990</span>&#160;    <span class="keywordtype">double</span> t_end = 0.0;</div>
<div class="line"><a name="l13991"></a><span class="lineno">13991</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l13992"></a><span class="lineno">13992</span>&#160;    {</div>
<div class="line"><a name="l13993"></a><span class="lineno">13993</span>&#160;      t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l13994"></a><span class="lineno">13994</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for actions before adapt: &quot;</span> &lt;&lt; t_end - t_start</div>
<div class="line"><a name="l13995"></a><span class="lineno">13995</span>&#160;                 &lt;&lt; std::endl;</div>
<div class="line"><a name="l13996"></a><span class="lineno">13996</span>&#160;      t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l13997"></a><span class="lineno">13997</span>&#160;    }</div>
<div class="line"><a name="l13998"></a><span class="lineno">13998</span>&#160; </div>
<div class="line"><a name="l13999"></a><span class="lineno">13999</span>&#160;    <span class="comment">// Initialise counters</span></div>
<div class="line"><a name="l14000"></a><span class="lineno">14000</span>&#160;    n_refined = 0;</div>
<div class="line"><a name="l14001"></a><span class="lineno">14001</span>&#160;    n_unrefined = 0;</div>
<div class="line"><a name="l14002"></a><span class="lineno">14002</span>&#160; </div>
<div class="line"><a name="l14003"></a><span class="lineno">14003</span>&#160;    <span class="comment">// Number of submeshes?</span></div>
<div class="line"><a name="l14004"></a><span class="lineno">14004</span>&#160;    <span class="keywordtype">unsigned</span> Nmesh = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>();</div>
<div class="line"><a name="l14005"></a><span class="lineno">14005</span>&#160; </div>
<div class="line"><a name="l14006"></a><span class="lineno">14006</span>&#160;    <span class="comment">// Single mesh:</span></div>
<div class="line"><a name="l14007"></a><span class="lineno">14007</span>&#160;    <span class="comment">//------------</span></div>
<div class="line"><a name="l14008"></a><span class="lineno">14008</span>&#160;    <span class="keywordflow">if</span> (Nmesh == 0)</div>
<div class="line"><a name="l14009"></a><span class="lineno">14009</span>&#160;    {</div>
<div class="line"><a name="l14010"></a><span class="lineno">14010</span>&#160;      <span class="comment">// Refine single mesh if possible</span></div>
<div class="line"><a name="l14011"></a><span class="lineno">14011</span>&#160;      <span class="keywordflow">if</span> (RefineableMeshBase* mmesh_pt =</div>
<div class="line"><a name="l14012"></a><span class="lineno">14012</span>&#160;            <span class="keyword">dynamic_cast&lt;</span>RefineableMeshBase*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(0)))</div>
<div class="line"><a name="l14013"></a><span class="lineno">14013</span>&#160;      {</div>
<div class="line"><a name="l14014"></a><span class="lineno">14014</span>&#160;        <span class="keywordflow">if</span> (mmesh_pt-&gt;is_adaptation_enabled())</div>
<div class="line"><a name="l14015"></a><span class="lineno">14015</span>&#160;        {</div>
<div class="line"><a name="l14016"></a><span class="lineno">14016</span>&#160;          <span class="keywordtype">double</span> t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l14017"></a><span class="lineno">14017</span>&#160; </div>
<div class="line"><a name="l14018"></a><span class="lineno">14018</span>&#160;          <span class="comment">// Get pointer to error estimator</span></div>
<div class="line"><a name="l14019"></a><span class="lineno">14019</span>&#160;          ErrorEstimator* <a class="code" href="../../d8/d32/namespaceMeshRefinement.html#a9dade531077f055da144a85e19e67263">error_estimator_pt</a> =</div>
<div class="line"><a name="l14020"></a><span class="lineno">14020</span>&#160;            mmesh_pt-&gt;spatial_error_estimator_pt();</div>
<div class="line"><a name="l14021"></a><span class="lineno">14021</span>&#160; </div>
<div class="line"><a name="l14022"></a><span class="lineno">14022</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l14023"></a><span class="lineno">14023</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d8/d32/namespaceMeshRefinement.html#a9dade531077f055da144a85e19e67263">error_estimator_pt</a> == 0)</div>
<div class="line"><a name="l14024"></a><span class="lineno">14024</span>&#160;          {</div>
<div class="line"><a name="l14025"></a><span class="lineno">14025</span>&#160;            <span class="keywordflow">throw</span> OomphLibError(<span class="stringliteral">&quot;Error estimator hasn&#39;t been set yet&quot;</span>,</div>
<div class="line"><a name="l14026"></a><span class="lineno">14026</span>&#160;                                <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l14027"></a><span class="lineno">14027</span>&#160;                                <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l14028"></a><span class="lineno">14028</span>&#160;          }</div>
<div class="line"><a name="l14029"></a><span class="lineno">14029</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l14030"></a><span class="lineno">14030</span>&#160; </div>
<div class="line"><a name="l14031"></a><span class="lineno">14031</span>&#160;          <span class="comment">// Get error for all elements</span></div>
<div class="line"><a name="l14032"></a><span class="lineno">14032</span>&#160;          Vector&lt;double&gt; elemental_error(mmesh_pt-&gt;nelement());</div>
<div class="line"><a name="l14033"></a><span class="lineno">14033</span>&#160; </div>
<div class="line"><a name="l14034"></a><span class="lineno">14034</span>&#160;          <span class="keywordflow">if</span> (mmesh_pt-&gt;doc_info_pt() == 0)</div>
<div class="line"><a name="l14035"></a><span class="lineno">14035</span>&#160;          {</div>
<div class="line"><a name="l14036"></a><span class="lineno">14036</span>&#160;            <a class="code" href="../../d8/d32/namespaceMeshRefinement.html#a9dade531077f055da144a85e19e67263">error_estimator_pt</a>-&gt;get_element_errors(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(0), elemental_error);</div>
<div class="line"><a name="l14037"></a><span class="lineno">14037</span>&#160;          }</div>
<div class="line"><a name="l14038"></a><span class="lineno">14038</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l14039"></a><span class="lineno">14039</span>&#160;          {</div>
<div class="line"><a name="l14040"></a><span class="lineno">14040</span>&#160;            <a class="code" href="../../d8/d32/namespaceMeshRefinement.html#a9dade531077f055da144a85e19e67263">error_estimator_pt</a>-&gt;get_element_errors(</div>
<div class="line"><a name="l14041"></a><span class="lineno">14041</span>&#160;              <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(0), elemental_error, *mmesh_pt-&gt;doc_info_pt());</div>
<div class="line"><a name="l14042"></a><span class="lineno">14042</span>&#160;          }</div>
<div class="line"><a name="l14043"></a><span class="lineno">14043</span>&#160; </div>
<div class="line"><a name="l14044"></a><span class="lineno">14044</span>&#160;          <span class="comment">// Store max./min actual error</span></div>
<div class="line"><a name="l14045"></a><span class="lineno">14045</span>&#160;          mmesh_pt-&gt;max_error() = <a class="code" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">std::fabs</a>(*std::max_element(</div>
<div class="line"><a name="l14046"></a><span class="lineno">14046</span>&#160;            elemental_error.begin(), elemental_error.end(), AbsCmp&lt;double&gt;()));</div>
<div class="line"><a name="l14047"></a><span class="lineno">14047</span>&#160; </div>
<div class="line"><a name="l14048"></a><span class="lineno">14048</span>&#160;          mmesh_pt-&gt;min_error() = <a class="code" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">std::fabs</a>(*std::min_element(</div>
<div class="line"><a name="l14049"></a><span class="lineno">14049</span>&#160;            elemental_error.begin(), elemental_error.end(), AbsCmp&lt;double&gt;()));</div>
<div class="line"><a name="l14050"></a><span class="lineno">14050</span>&#160; </div>
<div class="line"><a name="l14051"></a><span class="lineno">14051</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;\n Max/min error: &quot;</span> &lt;&lt; mmesh_pt-&gt;max_error() &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l14052"></a><span class="lineno">14052</span>&#160;                     &lt;&lt; mmesh_pt-&gt;min_error() &lt;&lt; std::endl</div>
<div class="line"><a name="l14053"></a><span class="lineno">14053</span>&#160;                     &lt;&lt; std::endl;</div>
<div class="line"><a name="l14054"></a><span class="lineno">14054</span>&#160; </div>
<div class="line"><a name="l14055"></a><span class="lineno">14055</span>&#160; </div>
<div class="line"><a name="l14056"></a><span class="lineno">14056</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l14057"></a><span class="lineno">14057</span>&#160;          {</div>
<div class="line"><a name="l14058"></a><span class="lineno">14058</span>&#160;            t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l14059"></a><span class="lineno">14059</span>&#160;            <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for error estimation: &quot;</span> &lt;&lt; t_end - t_start</div>
<div class="line"><a name="l14060"></a><span class="lineno">14060</span>&#160;                       &lt;&lt; std::endl;</div>
<div class="line"><a name="l14061"></a><span class="lineno">14061</span>&#160;            t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l14062"></a><span class="lineno">14062</span>&#160;          }</div>
<div class="line"><a name="l14063"></a><span class="lineno">14063</span>&#160; </div>
<div class="line"><a name="l14064"></a><span class="lineno">14064</span>&#160;          <span class="comment">// Adapt mesh</span></div>
<div class="line"><a name="l14065"></a><span class="lineno">14065</span>&#160;          mmesh_pt-&gt;adapt(elemental_error);</div>
<div class="line"><a name="l14066"></a><span class="lineno">14066</span>&#160; </div>
<div class="line"><a name="l14067"></a><span class="lineno">14067</span>&#160;          <span class="comment">// Add to counters</span></div>
<div class="line"><a name="l14068"></a><span class="lineno">14068</span>&#160;          n_refined += mmesh_pt-&gt;nrefined();</div>
<div class="line"><a name="l14069"></a><span class="lineno">14069</span>&#160;          n_unrefined += mmesh_pt-&gt;nunrefined();</div>
<div class="line"><a name="l14070"></a><span class="lineno">14070</span>&#160; </div>
<div class="line"><a name="l14071"></a><span class="lineno">14071</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l14072"></a><span class="lineno">14072</span>&#160;          {</div>
<div class="line"><a name="l14073"></a><span class="lineno">14073</span>&#160;            t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l14074"></a><span class="lineno">14074</span>&#160;            <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for complete mesh adaptation &quot;</span></div>
<div class="line"><a name="l14075"></a><span class="lineno">14075</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot;(but excluding comp of error estimate): &quot;</span></div>
<div class="line"><a name="l14076"></a><span class="lineno">14076</span>&#160;                       &lt;&lt; t_end - t_start &lt;&lt; std::endl;</div>
<div class="line"><a name="l14077"></a><span class="lineno">14077</span>&#160;            t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l14078"></a><span class="lineno">14078</span>&#160;          }</div>
<div class="line"><a name="l14079"></a><span class="lineno">14079</span>&#160;        }</div>
<div class="line"><a name="l14080"></a><span class="lineno">14080</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l14081"></a><span class="lineno">14081</span>&#160;        {</div>
<div class="line"><a name="l14082"></a><span class="lineno">14082</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Mesh adaptation is disabled.&quot;</span></div>
<div class="line"><a name="l14083"></a><span class="lineno">14083</span>&#160;                     &lt;&lt; std::endl;</div>
<div class="line"><a name="l14084"></a><span class="lineno">14084</span>&#160;        }</div>
<div class="line"><a name="l14085"></a><span class="lineno">14085</span>&#160;      }</div>
<div class="line"><a name="l14086"></a><span class="lineno">14086</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l14087"></a><span class="lineno">14087</span>&#160;      {</div>
<div class="line"><a name="l14088"></a><span class="lineno">14088</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Mesh cannot be adapted&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l14089"></a><span class="lineno">14089</span>&#160;      }</div>
<div class="line"><a name="l14090"></a><span class="lineno">14090</span>&#160;    }</div>
<div class="line"><a name="l14091"></a><span class="lineno">14091</span>&#160;    <span class="comment">// Multiple submeshes</span></div>
<div class="line"><a name="l14092"></a><span class="lineno">14092</span>&#160;    <span class="comment">//------------------</span></div>
<div class="line"><a name="l14093"></a><span class="lineno">14093</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l14094"></a><span class="lineno">14094</span>&#160;    {</div>
<div class="line"><a name="l14095"></a><span class="lineno">14095</span>&#160;      <span class="comment">// Loop over submeshes</span></div>
<div class="line"><a name="l14096"></a><span class="lineno">14096</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> imesh = 0; imesh &lt; Nmesh; imesh++)</div>
<div class="line"><a name="l14097"></a><span class="lineno">14097</span>&#160;      {</div>
<div class="line"><a name="l14098"></a><span class="lineno">14098</span>&#160;        <span class="comment">// Refine single mesh uniformly if possible</span></div>
<div class="line"><a name="l14099"></a><span class="lineno">14099</span>&#160;        <span class="keywordflow">if</span> (RefineableMeshBase* mmesh_pt =</div>
<div class="line"><a name="l14100"></a><span class="lineno">14100</span>&#160;              <span class="keyword">dynamic_cast&lt;</span>RefineableMeshBase*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(imesh)))</div>
<div class="line"><a name="l14101"></a><span class="lineno">14101</span>&#160;        {</div>
<div class="line"><a name="l14102"></a><span class="lineno">14102</span>&#160;          <span class="keywordtype">double</span> t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l14103"></a><span class="lineno">14103</span>&#160; </div>
<div class="line"><a name="l14104"></a><span class="lineno">14104</span>&#160;          <span class="comment">// Get pointer to error estimator</span></div>
<div class="line"><a name="l14105"></a><span class="lineno">14105</span>&#160;          ErrorEstimator* <a class="code" href="../../d8/d32/namespaceMeshRefinement.html#a9dade531077f055da144a85e19e67263">error_estimator_pt</a> =</div>
<div class="line"><a name="l14106"></a><span class="lineno">14106</span>&#160;            mmesh_pt-&gt;spatial_error_estimator_pt();</div>
<div class="line"><a name="l14107"></a><span class="lineno">14107</span>&#160; </div>
<div class="line"><a name="l14108"></a><span class="lineno">14108</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l14109"></a><span class="lineno">14109</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d8/d32/namespaceMeshRefinement.html#a9dade531077f055da144a85e19e67263">error_estimator_pt</a> == 0)</div>
<div class="line"><a name="l14110"></a><span class="lineno">14110</span>&#160;          {</div>
<div class="line"><a name="l14111"></a><span class="lineno">14111</span>&#160;            <span class="keywordflow">throw</span> OomphLibError(<span class="stringliteral">&quot;Error estimator hasn&#39;t been set yet&quot;</span>,</div>
<div class="line"><a name="l14112"></a><span class="lineno">14112</span>&#160;                                <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l14113"></a><span class="lineno">14113</span>&#160;                                <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l14114"></a><span class="lineno">14114</span>&#160;          }</div>
<div class="line"><a name="l14115"></a><span class="lineno">14115</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l14116"></a><span class="lineno">14116</span>&#160; </div>
<div class="line"><a name="l14117"></a><span class="lineno">14117</span>&#160;          <span class="keywordflow">if</span> (mmesh_pt-&gt;is_adaptation_enabled())</div>
<div class="line"><a name="l14118"></a><span class="lineno">14118</span>&#160;          {</div>
<div class="line"><a name="l14119"></a><span class="lineno">14119</span>&#160;            <span class="comment">// Get error for all elements</span></div>
<div class="line"><a name="l14120"></a><span class="lineno">14120</span>&#160;            Vector&lt;double&gt; elemental_error(mmesh_pt-&gt;nelement());</div>
<div class="line"><a name="l14121"></a><span class="lineno">14121</span>&#160;            <span class="keywordflow">if</span> (mmesh_pt-&gt;doc_info_pt() == 0)</div>
<div class="line"><a name="l14122"></a><span class="lineno">14122</span>&#160;            {</div>
<div class="line"><a name="l14123"></a><span class="lineno">14123</span>&#160;              <a class="code" href="../../d8/d32/namespaceMeshRefinement.html#a9dade531077f055da144a85e19e67263">error_estimator_pt</a>-&gt;get_element_errors(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(imesh),</div>
<div class="line"><a name="l14124"></a><span class="lineno">14124</span>&#160;                                                     elemental_error);</div>
<div class="line"><a name="l14125"></a><span class="lineno">14125</span>&#160;            }</div>
<div class="line"><a name="l14126"></a><span class="lineno">14126</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l14127"></a><span class="lineno">14127</span>&#160;            {</div>
<div class="line"><a name="l14128"></a><span class="lineno">14128</span>&#160;              <a class="code" href="../../d8/d32/namespaceMeshRefinement.html#a9dade531077f055da144a85e19e67263">error_estimator_pt</a>-&gt;get_element_errors(</div>
<div class="line"><a name="l14129"></a><span class="lineno">14129</span>&#160;                <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(imesh), elemental_error, *mmesh_pt-&gt;doc_info_pt());</div>
<div class="line"><a name="l14130"></a><span class="lineno">14130</span>&#160;            }</div>
<div class="line"><a name="l14131"></a><span class="lineno">14131</span>&#160; </div>
<div class="line"><a name="l14132"></a><span class="lineno">14132</span>&#160;            <span class="comment">// Store max./min error if the mesh has any elements</span></div>
<div class="line"><a name="l14133"></a><span class="lineno">14133</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(imesh)-&gt;nelement() &gt; 0)</div>
<div class="line"><a name="l14134"></a><span class="lineno">14134</span>&#160;            {</div>
<div class="line"><a name="l14135"></a><span class="lineno">14135</span>&#160;              mmesh_pt-&gt;max_error() =</div>
<div class="line"><a name="l14136"></a><span class="lineno">14136</span>&#160;                <a class="code" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">std::fabs</a>(*std::max_element(elemental_error.begin(),</div>
<div class="line"><a name="l14137"></a><span class="lineno">14137</span>&#160;                                            elemental_error.end(),</div>
<div class="line"><a name="l14138"></a><span class="lineno">14138</span>&#160;                                            AbsCmp&lt;double&gt;()));</div>
<div class="line"><a name="l14139"></a><span class="lineno">14139</span>&#160; </div>
<div class="line"><a name="l14140"></a><span class="lineno">14140</span>&#160;              mmesh_pt-&gt;min_error() =</div>
<div class="line"><a name="l14141"></a><span class="lineno">14141</span>&#160;                <a class="code" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">std::fabs</a>(*std::min_element(elemental_error.begin(),</div>
<div class="line"><a name="l14142"></a><span class="lineno">14142</span>&#160;                                            elemental_error.end(),</div>
<div class="line"><a name="l14143"></a><span class="lineno">14143</span>&#160;                                            AbsCmp&lt;double&gt;()));</div>
<div class="line"><a name="l14144"></a><span class="lineno">14144</span>&#160;            }</div>
<div class="line"><a name="l14145"></a><span class="lineno">14145</span>&#160; </div>
<div class="line"><a name="l14146"></a><span class="lineno">14146</span>&#160;            <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;\n Max/min error: &quot;</span> &lt;&lt; mmesh_pt-&gt;max_error() &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l14147"></a><span class="lineno">14147</span>&#160;                       &lt;&lt; mmesh_pt-&gt;min_error() &lt;&lt; std::endl;</div>
<div class="line"><a name="l14148"></a><span class="lineno">14148</span>&#160; </div>
<div class="line"><a name="l14149"></a><span class="lineno">14149</span>&#160; </div>
<div class="line"><a name="l14150"></a><span class="lineno">14150</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l14151"></a><span class="lineno">14151</span>&#160;            {</div>
<div class="line"><a name="l14152"></a><span class="lineno">14152</span>&#160;              t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l14153"></a><span class="lineno">14153</span>&#160;              <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for error estimation: &quot;</span> &lt;&lt; t_end - t_start</div>
<div class="line"><a name="l14154"></a><span class="lineno">14154</span>&#160;                         &lt;&lt; std::endl;</div>
<div class="line"><a name="l14155"></a><span class="lineno">14155</span>&#160;              t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l14156"></a><span class="lineno">14156</span>&#160;            }</div>
<div class="line"><a name="l14157"></a><span class="lineno">14157</span>&#160; </div>
<div class="line"><a name="l14158"></a><span class="lineno">14158</span>&#160;            <span class="comment">// Adapt mesh</span></div>
<div class="line"><a name="l14159"></a><span class="lineno">14159</span>&#160;            mmesh_pt-&gt;adapt(elemental_error);</div>
<div class="line"><a name="l14160"></a><span class="lineno">14160</span>&#160; </div>
<div class="line"><a name="l14161"></a><span class="lineno">14161</span>&#160;            <span class="comment">// Add to counters</span></div>
<div class="line"><a name="l14162"></a><span class="lineno">14162</span>&#160;            n_refined += mmesh_pt-&gt;nrefined();</div>
<div class="line"><a name="l14163"></a><span class="lineno">14163</span>&#160;            n_unrefined += mmesh_pt-&gt;nunrefined();</div>
<div class="line"><a name="l14164"></a><span class="lineno">14164</span>&#160; </div>
<div class="line"><a name="l14165"></a><span class="lineno">14165</span>&#160; </div>
<div class="line"><a name="l14166"></a><span class="lineno">14166</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l14167"></a><span class="lineno">14167</span>&#160;            {</div>
<div class="line"><a name="l14168"></a><span class="lineno">14168</span>&#160;              t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l14169"></a><span class="lineno">14169</span>&#160;              <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for complete mesh adaptation &quot;</span></div>
<div class="line"><a name="l14170"></a><span class="lineno">14170</span>&#160;                         &lt;&lt; <span class="stringliteral">&quot;(but excluding comp of error estimate): &quot;</span></div>
<div class="line"><a name="l14171"></a><span class="lineno">14171</span>&#160;                         &lt;&lt; t_end - t_start &lt;&lt; std::endl;</div>
<div class="line"><a name="l14172"></a><span class="lineno">14172</span>&#160;              t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l14173"></a><span class="lineno">14173</span>&#160;            }</div>
<div class="line"><a name="l14174"></a><span class="lineno">14174</span>&#160;          }</div>
<div class="line"><a name="l14175"></a><span class="lineno">14175</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l14176"></a><span class="lineno">14176</span>&#160;          {</div>
<div class="line"><a name="l14177"></a><span class="lineno">14177</span>&#160;            <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Mesh adaptation is disabled.&quot;</span></div>
<div class="line"><a name="l14178"></a><span class="lineno">14178</span>&#160;                       &lt;&lt; std::endl;</div>
<div class="line"><a name="l14179"></a><span class="lineno">14179</span>&#160;          }</div>
<div class="line"><a name="l14180"></a><span class="lineno">14180</span>&#160;        }</div>
<div class="line"><a name="l14181"></a><span class="lineno">14181</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l14182"></a><span class="lineno">14182</span>&#160;        {</div>
<div class="line"><a name="l14183"></a><span class="lineno">14183</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Mesh cannot be adapted.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l14184"></a><span class="lineno">14184</span>&#160;        }</div>
<div class="line"><a name="l14185"></a><span class="lineno">14185</span>&#160; </div>
<div class="line"><a name="l14186"></a><span class="lineno">14186</span>&#160;      } <span class="comment">// End of loop over submeshes</span></div>
<div class="line"><a name="l14187"></a><span class="lineno">14187</span>&#160; </div>
<div class="line"><a name="l14188"></a><span class="lineno">14188</span>&#160;      <span class="comment">// Rebuild the global mesh</span></div>
<div class="line"><a name="l14189"></a><span class="lineno">14189</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a266d4d1b2bd4a5cbc028ff5aba79508f">rebuild_global_mesh</a>();</div>
<div class="line"><a name="l14190"></a><span class="lineno">14190</span>&#160;    }</div>
<div class="line"><a name="l14191"></a><span class="lineno">14191</span>&#160; </div>
<div class="line"><a name="l14192"></a><span class="lineno">14192</span>&#160; </div>
<div class="line"><a name="l14193"></a><span class="lineno">14193</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l14194"></a><span class="lineno">14194</span>&#160;    {</div>
<div class="line"><a name="l14195"></a><span class="lineno">14195</span>&#160;      t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l14196"></a><span class="lineno">14196</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Total time for actual adaptation &quot;</span></div>
<div class="line"><a name="l14197"></a><span class="lineno">14197</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;(all meshes; incl error estimates): &quot;</span> &lt;&lt; t_end - t_start</div>
<div class="line"><a name="l14198"></a><span class="lineno">14198</span>&#160;                 &lt;&lt; std::endl;</div>
<div class="line"><a name="l14199"></a><span class="lineno">14199</span>&#160;      t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l14200"></a><span class="lineno">14200</span>&#160;    }</div>
<div class="line"><a name="l14201"></a><span class="lineno">14201</span>&#160; </div>
<div class="line"><a name="l14202"></a><span class="lineno">14202</span>&#160;    <span class="comment">// Any actions after adapt</span></div>
<div class="line"><a name="l14203"></a><span class="lineno">14203</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">actions_after_adapt</a>();</div>
<div class="line"><a name="l14204"></a><span class="lineno">14204</span>&#160; </div>
<div class="line"><a name="l14205"></a><span class="lineno">14205</span>&#160; </div>
<div class="line"><a name="l14206"></a><span class="lineno">14206</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l14207"></a><span class="lineno">14207</span>&#160;    {</div>
<div class="line"><a name="l14208"></a><span class="lineno">14208</span>&#160;      t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l14209"></a><span class="lineno">14209</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for actions after adapt: &quot;</span> &lt;&lt; t_end - t_start</div>
<div class="line"><a name="l14210"></a><span class="lineno">14210</span>&#160;                 &lt;&lt; std::endl;</div>
<div class="line"><a name="l14211"></a><span class="lineno">14211</span>&#160;      t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l14212"></a><span class="lineno">14212</span>&#160; </div>
<div class="line"><a name="l14213"></a><span class="lineno">14213</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;About to start re-assigning eqn numbers &quot;</span></div>
<div class="line"><a name="l14214"></a><span class="lineno">14214</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;with Problem::assign_eqn_numbers() at end of &quot;</span></div>
<div class="line"><a name="l14215"></a><span class="lineno">14215</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;Problem::adapt().\n&quot;</span>;</div>
<div class="line"><a name="l14216"></a><span class="lineno">14216</span>&#160;    }</div>
<div class="line"><a name="l14217"></a><span class="lineno">14217</span>&#160; </div>
<div class="line"><a name="l14218"></a><span class="lineno">14218</span>&#160;    <span class="comment">// Attach the boundary conditions to the mesh</span></div>
<div class="line"><a name="l14219"></a><span class="lineno">14219</span>&#160;    <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;\nNumber of equations: &quot;</span> &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers</a>() &lt;&lt; std::endl</div>
<div class="line"><a name="l14220"></a><span class="lineno">14220</span>&#160;               &lt;&lt; std::endl;</div>
<div class="line"><a name="l14221"></a><span class="lineno">14221</span>&#160; </div>
<div class="line"><a name="l14222"></a><span class="lineno">14222</span>&#160; </div>
<div class="line"><a name="l14223"></a><span class="lineno">14223</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l14224"></a><span class="lineno">14224</span>&#160;    {</div>
<div class="line"><a name="l14225"></a><span class="lineno">14225</span>&#160;      t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l14226"></a><span class="lineno">14226</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for re-assigning eqn numbers with &quot;</span></div>
<div class="line"><a name="l14227"></a><span class="lineno">14227</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;Problem::assign_eqn_numbers() at end of Problem::adapt(): &quot;</span></div>
<div class="line"><a name="l14228"></a><span class="lineno">14228</span>&#160;                 &lt;&lt; t_end - t_start &lt;&lt; std::endl;</div>
<div class="line"><a name="l14229"></a><span class="lineno">14229</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Total time for adapt: &quot;</span> &lt;&lt; t_end - t_start_total</div>
<div class="line"><a name="l14230"></a><span class="lineno">14230</span>&#160;                 &lt;&lt; std::endl;</div>
<div class="line"><a name="l14231"></a><span class="lineno">14231</span>&#160;    }</div>
<div class="line"><a name="l14232"></a><span class="lineno">14232</span>&#160;  }</div>
<div class="ttc" id="aBiCGSTAB__step__by__step_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> BiCGSTAB_step_by_step.cpp:9</div></div>
<div class="ttc" id="aCG3DPackingUnitTest_8cpp_html_a7026fd16370249ce97cb3d062326baf9"><div class="ttname"><a href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a></div><div class="ttdeci">const unsigned n</div><div class="ttdef"><b>Definition:</b> CG3DPackingUnitTest.cpp:11</div></div>
<div class="ttc" id="aclassoomph_1_1AssemblyHandler_html_a22c5f240674e4f6cee12006790c11dae"><div class="ttname"><a href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a22c5f240674e4f6cee12006790c11dae">oomph::AssemblyHandler::bifurcation_type</a></div><div class="ttdeci">virtual int bifurcation_type() const</div><div class="ttdef"><b>Definition:</b> assembly_handler.h:134</div></div>
<div class="ttc" id="aclassoomph_1_1LinearAlgebraDistribution_html_ac9310de740f9c3a61f8d5dab9bef88ca"><div class="ttname"><a href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">oomph::LinearAlgebraDistribution::nrow_local</a></div><div class="ttdeci">unsigned nrow_local() const</div><div class="ttdef"><b>Definition:</b> linear_algebra_distribution.h:193</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a10fd6457ceceb02a0e11d860ac0017c5"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a10fd6457ceceb02a0e11d860ac0017c5">oomph::Problem::dof_current</a></div><div class="ttdeci">double &amp; dof_current(const unsigned &amp;i)</div><div class="ttdef"><b>Definition:</b> problem.h:1182</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a1861321b2d129707935bf1191238daca"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a1861321b2d129707935bf1191238daca">oomph::Problem::Dof_derivative</a></div><div class="ttdeci">Vector&lt; double &gt; Dof_derivative</div><div class="ttdoc">Storage for the derivative of the problem variables wrt arc-length.</div><div class="ttdef"><b>Definition:</b> problem.h:774</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a1b10f0b678c60eaaa8bccb74ed1740f0"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a1b10f0b678c60eaaa8bccb74ed1740f0">oomph::Problem::make_copy</a></div><div class="ttdeci">virtual Problem * make_copy()</div><div class="ttdef"><b>Definition:</b> problem.cc:12011</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a218d4dfff74bc14f3f5dc8416236e01d"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">oomph::Problem::ndof</a></div><div class="ttdeci">unsigned long ndof() const</div><div class="ttdoc">Return the number of dofs.</div><div class="ttdef"><b>Definition:</b> problem.h:1674</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a266d4d1b2bd4a5cbc028ff5aba79508f"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a266d4d1b2bd4a5cbc028ff5aba79508f">oomph::Problem::rebuild_global_mesh</a></div><div class="ttdeci">void rebuild_global_mesh()</div><div class="ttdef"><b>Definition:</b> problem.cc:1533</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a2bd35d5954b6a8d43189b84520adb4b3"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a2bd35d5954b6a8d43189b84520adb4b3">oomph::Problem::get_all_error_estimates</a></div><div class="ttdeci">void get_all_error_estimates(Vector&lt; Vector&lt; double &gt;&gt; &amp;elemental_error)</div><div class="ttdef"><b>Definition:</b> problem.cc:14627</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a309487c952f108015b53a2d70539ac8b"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a309487c952f108015b53a2d70539ac8b">oomph::Problem::adapt_based_on_error_estimates</a></div><div class="ttdeci">void adapt_based_on_error_estimates(unsigned &amp;n_refined, unsigned &amp;n_unrefined, Vector&lt; Vector&lt; double &gt;&gt; &amp;elemental_error)</div><div class="ttdef"><b>Definition:</b> problem.cc:14528</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a366b50c490e9fd3ddafa05b2fbd0b883"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a366b50c490e9fd3ddafa05b2fbd0b883">oomph::Problem::Dof_current</a></div><div class="ttdeci">Vector&lt; double &gt; Dof_current</div><div class="ttdoc">Storage for the present values of the variables.</div><div class="ttdef"><b>Definition:</b> problem.h:777</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a6130d5c9a762cdd1569919a601620796"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">oomph::Problem::actions_before_adapt</a></div><div class="ttdeci">virtual void actions_before_adapt()</div><div class="ttdef"><b>Definition:</b> problem.h:1022</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_aa0b4e7868e02e2d12845c9b2dd60cab9"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#aa0b4e7868e02e2d12845c9b2dd60cab9">oomph::Problem::bifurcation_adapt_helper</a></div><div class="ttdeci">void bifurcation_adapt_helper(unsigned &amp;n_refined, unsigned &amp;n_unrefined, const unsigned &amp;bifurcation_type, const bool &amp;actually_adapt=true)</div><div class="ttdef"><b>Definition:</b> problem.cc:13354</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_accc4e5a46953800933f07ae6bd67860e"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">oomph::Problem::nsub_mesh</a></div><div class="ttdeci">unsigned nsub_mesh() const</div><div class="ttdoc">Return number of submeshes.</div><div class="ttdef"><b>Definition:</b> problem.h:1323</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_ad6df5fb0d282f25df1e94a665dd838e5"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#ad6df5fb0d282f25df1e94a665dd838e5">oomph::Problem::dof_derivative</a></div><div class="ttdeci">double &amp; dof_derivative(const unsigned &amp;i)</div><div class="ttdef"><b>Definition:</b> problem.h:1168</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_ada40ec6730506c01109622c8383fe36e"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">oomph::Problem::actions_after_adapt</a></div><div class="ttdeci">virtual void actions_after_adapt()</div><div class="ttdoc">Actions that are to be performed after a mesh adaptation.</div><div class="ttdef"><b>Definition:</b> problem.h:1025</div></div>
<div class="ttc" id="alevel2__cplx__impl_8h_html_a8d334fd8388055a029936c59d361ff00"><div class="ttname"><a href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a></div><div class="ttdeci">int * m</div><div class="ttdef"><b>Definition:</b> level2_cplx_impl.h:294</div></div>
<div class="ttc" id="anamespaceMeshRefinement_html_a9dade531077f055da144a85e19e67263"><div class="ttname"><a href="../../d8/d32/namespaceMeshRefinement.html#a9dade531077f055da144a85e19e67263">MeshRefinement::error_estimator_pt</a></div><div class="ttdeci">Z2ErrorEstimator * error_estimator_pt</div><div class="ttdef"><b>Definition:</b> MortaringCantileverCompareToNonMortaring.cpp:190</div></div>
<div class="ttc" id="anamespaceboost_1_1multiprecision_html_ab6f80ccf8e1d88df8a8e3acd039d63eb"><div class="ttname"><a href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">boost::multiprecision::fabs</a></div><div class="ttdeci">Real fabs(const Real &amp;a)</div><div class="ttdef"><b>Definition:</b> boostmultiprec.cpp:117</div></div>
<div class="ttc" id="anamespaceoomph_1_1Global__timings_html_af25dd181537f6e338daadd0a73d269a0"><div class="ttname"><a href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">oomph::Global_timings::Doc_comprehensive_timings</a></div><div class="ttdeci">bool Doc_comprehensive_timings</div><div class="ttdef"><b>Definition:</b> oomph_definitions.cc:49</div></div>
<div class="ttc" id="anamespaceoomph_1_1TimingHelpers_html_a9fb6ad7e2e01b0914e9f7072ef9ebfa6"><div class="ttname"><a href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">oomph::TimingHelpers::timer</a></div><div class="ttdeci">double timer()</div><div class="ttdoc">returns the time in seconds after some point in past</div><div class="ttdef"><b>Definition:</b> oomph_utilities.cc:1295</div></div>
<div class="ttc" id="aoomph__definitions_8h_html_a25c6813cc7341d125e2502f8923fb6c4"><div class="ttname"><a href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a></div><div class="ttdeci">#define OOMPH_EXCEPTION_LOCATION</div><div class="ttdef"><b>Definition:</b> oomph_definitions.h:61</div></div>
<div class="ttc" id="aoomph__definitions_8h_html_aa260cc4af589e30cea7fde997ae16667"><div class="ttname"><a href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a></div><div class="ttdeci">#define OOMPH_CURRENT_FUNCTION</div><div class="ttdef"><b>Definition:</b> oomph_definitions.h:86</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">actions_after_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">actions_before_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a309487c952f108015b53a2d70539ac8b">adapt_based_on_error_estimates()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa0b4e7868e02e2d12845c9b2dd60cab9">bifurcation_adapt_helper()</a>, <a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a22c5f240674e4f6cee12006790c11dae">oomph::AssemblyHandler::bifurcation_type()</a>, <a class="el" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">calibrate::c</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa2e04de221f29c13067e2fe4cf4c70f9">Copy_of_problem_pt</a>, <a class="el" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">oomph::Global_timings::Doc_comprehensive_timings</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a366b50c490e9fd3ddafa05b2fbd0b883">Dof_current</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a10fd6457ceceb02a0e11d860ac0017c5">dof_current()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a1861321b2d129707935bf1191238daca">Dof_derivative</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad6df5fb0d282f25df1e94a665dd838e5">dof_derivative()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>, <a class="el" href="../../d8/d32/namespaceMeshRefinement.html#a9dade531077f055da144a85e19e67263">MeshRefinement::error_estimator_pt</a>, <a class="el" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">boost::multiprecision::fabs()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a2bd35d5954b6a8d43189b84520adb4b3">get_all_error_estimates()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a1b10f0b678c60eaaa8bccb74ed1740f0">make_copy()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt()</a>, <a class="el" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>, <a class="el" href="../../dc/db7/classoomph_1_1Node.html#a786c96a8e46eb27a03b2b31f629d41b3">oomph::Node::ndim()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">oomph::LinearAlgebraDistribution::nrow_local()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a266d4d1b2bd4a5cbc028ff5aba79508f">rebuild_global_mesh()</a>, <a class="el" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">oomph::TimingHelpers::timer()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#adbecce0cb1bd7b6b21285568e41ee3eb">Use_continuation_timestepper</a>, and <a class="el" href="../../dc/db7/classoomph_1_1Node.html#a056f8e82da938369cd38541c5cdc598a">oomph::Node::x()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/d1e/one__d__poisson__hp__adapt_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main()</a>.</p>

</div>
</div>
<a id="a309487c952f108015b53a2d70539ac8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a309487c952f108015b53a2d70539ac8b">&#9670;&nbsp;</a></span>adapt_based_on_error_estimates() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::adapt_based_on_error_estimates </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>n_refined</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>n_unrefined</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>elemental_error</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Adapt problem: Perform mesh adaptation for (all) refineable (sub)mesh(es), based on the error estimates in elemental_error and the target errors specified in the mesh(es). Following mesh adaptation, update global mesh, and re-assign equation numbers. Return # of refined/unrefined elements. On return from this function, Problem can immediately be solved again.</p>
<p>Perform mesh adaptation for (all) refineable (sub)mesh(es), based on the error estimates in elemental_error and the target errors specified in the mesh(es). Following mesh adaptation, update global mesh, and re-assign equation numbers. Return # of refined/unrefined elements. On return from this function, Problem can immediately be solved again. </p>
<div class="fragment"><div class="line"><a name="l14532"></a><span class="lineno">14532</span>&#160;  {</div>
<div class="line"><a name="l14533"></a><span class="lineno">14533</span>&#160;    <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; std::endl &lt;&lt; std::endl;</div>
<div class="line"><a name="l14534"></a><span class="lineno">14534</span>&#160;    <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Adapting problem:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l14535"></a><span class="lineno">14535</span>&#160;    <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;=================&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l14536"></a><span class="lineno">14536</span>&#160; </div>
<div class="line"><a name="l14537"></a><span class="lineno">14537</span>&#160;    <span class="comment">// Call the actions before adaptation</span></div>
<div class="line"><a name="l14538"></a><span class="lineno">14538</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">actions_before_adapt</a>();</div>
<div class="line"><a name="l14539"></a><span class="lineno">14539</span>&#160; </div>
<div class="line"><a name="l14540"></a><span class="lineno">14540</span>&#160;    <span class="comment">// Initialise counters</span></div>
<div class="line"><a name="l14541"></a><span class="lineno">14541</span>&#160;    n_refined = 0;</div>
<div class="line"><a name="l14542"></a><span class="lineno">14542</span>&#160;    n_unrefined = 0;</div>
<div class="line"><a name="l14543"></a><span class="lineno">14543</span>&#160; </div>
<div class="line"><a name="l14544"></a><span class="lineno">14544</span>&#160;    <span class="comment">// Number of submeshes?</span></div>
<div class="line"><a name="l14545"></a><span class="lineno">14545</span>&#160;    <span class="keywordtype">unsigned</span> Nmesh = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>();</div>
<div class="line"><a name="l14546"></a><span class="lineno">14546</span>&#160; </div>
<div class="line"><a name="l14547"></a><span class="lineno">14547</span>&#160;    <span class="comment">// Single mesh:</span></div>
<div class="line"><a name="l14548"></a><span class="lineno">14548</span>&#160;    <span class="comment">//------------</span></div>
<div class="line"><a name="l14549"></a><span class="lineno">14549</span>&#160;    <span class="keywordflow">if</span> (Nmesh == 0)</div>
<div class="line"><a name="l14550"></a><span class="lineno">14550</span>&#160;    {</div>
<div class="line"><a name="l14551"></a><span class="lineno">14551</span>&#160;      <span class="comment">// Refine single mesh uniformly if possible</span></div>
<div class="line"><a name="l14552"></a><span class="lineno">14552</span>&#160;      <span class="keywordflow">if</span> (RefineableMeshBase* mmesh_pt =</div>
<div class="line"><a name="l14553"></a><span class="lineno">14553</span>&#160;            <span class="keyword">dynamic_cast&lt;</span>RefineableMeshBase*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">Problem::mesh_pt</a>(0)))</div>
<div class="line"><a name="l14554"></a><span class="lineno">14554</span>&#160;      {</div>
<div class="line"><a name="l14555"></a><span class="lineno">14555</span>&#160;        <span class="keywordflow">if</span> (mmesh_pt-&gt;is_adaptation_enabled())</div>
<div class="line"><a name="l14556"></a><span class="lineno">14556</span>&#160;        {</div>
<div class="line"><a name="l14557"></a><span class="lineno">14557</span>&#160;          <span class="comment">// Adapt mesh</span></div>
<div class="line"><a name="l14558"></a><span class="lineno">14558</span>&#160;          mmesh_pt-&gt;adapt(elemental_error[0]);</div>
<div class="line"><a name="l14559"></a><span class="lineno">14559</span>&#160; </div>
<div class="line"><a name="l14560"></a><span class="lineno">14560</span>&#160;          <span class="comment">// Add to counters</span></div>
<div class="line"><a name="l14561"></a><span class="lineno">14561</span>&#160;          n_refined += mmesh_pt-&gt;nrefined();</div>
<div class="line"><a name="l14562"></a><span class="lineno">14562</span>&#160;          n_unrefined += mmesh_pt-&gt;nunrefined();</div>
<div class="line"><a name="l14563"></a><span class="lineno">14563</span>&#160;        }</div>
<div class="line"><a name="l14564"></a><span class="lineno">14564</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l14565"></a><span class="lineno">14565</span>&#160;        {</div>
<div class="line"><a name="l14566"></a><span class="lineno">14566</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Mesh adaptation is disabled.&quot;</span></div>
<div class="line"><a name="l14567"></a><span class="lineno">14567</span>&#160;                     &lt;&lt; std::endl;</div>
<div class="line"><a name="l14568"></a><span class="lineno">14568</span>&#160;        }</div>
<div class="line"><a name="l14569"></a><span class="lineno">14569</span>&#160;      }</div>
<div class="line"><a name="l14570"></a><span class="lineno">14570</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l14571"></a><span class="lineno">14571</span>&#160;      {</div>
<div class="line"><a name="l14572"></a><span class="lineno">14572</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Mesh cannot be adapted&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l14573"></a><span class="lineno">14573</span>&#160;      }</div>
<div class="line"><a name="l14574"></a><span class="lineno">14574</span>&#160;    }</div>
<div class="line"><a name="l14575"></a><span class="lineno">14575</span>&#160; </div>
<div class="line"><a name="l14576"></a><span class="lineno">14576</span>&#160;    <span class="comment">// Multiple submeshes</span></div>
<div class="line"><a name="l14577"></a><span class="lineno">14577</span>&#160;    <span class="comment">//------------------</span></div>
<div class="line"><a name="l14578"></a><span class="lineno">14578</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l14579"></a><span class="lineno">14579</span>&#160;    {</div>
<div class="line"><a name="l14580"></a><span class="lineno">14580</span>&#160;      <span class="comment">// Loop over submeshes</span></div>
<div class="line"><a name="l14581"></a><span class="lineno">14581</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> imesh = 0; imesh &lt; Nmesh; imesh++)</div>
<div class="line"><a name="l14582"></a><span class="lineno">14582</span>&#160;      {</div>
<div class="line"><a name="l14583"></a><span class="lineno">14583</span>&#160;        <span class="comment">// Refine single mesh uniformly if possible</span></div>
<div class="line"><a name="l14584"></a><span class="lineno">14584</span>&#160;        <span class="keywordflow">if</span> (RefineableMeshBase* mmesh_pt =</div>
<div class="line"><a name="l14585"></a><span class="lineno">14585</span>&#160;              <span class="keyword">dynamic_cast&lt;</span>RefineableMeshBase*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">Problem::mesh_pt</a>(imesh)))</div>
<div class="line"><a name="l14586"></a><span class="lineno">14586</span>&#160;        {</div>
<div class="line"><a name="l14587"></a><span class="lineno">14587</span>&#160;          <span class="keywordflow">if</span> (mmesh_pt-&gt;is_adaptation_enabled())</div>
<div class="line"><a name="l14588"></a><span class="lineno">14588</span>&#160;          {</div>
<div class="line"><a name="l14589"></a><span class="lineno">14589</span>&#160;            <span class="comment">// Adapt mesh</span></div>
<div class="line"><a name="l14590"></a><span class="lineno">14590</span>&#160;            mmesh_pt-&gt;adapt(elemental_error[imesh]);</div>
<div class="line"><a name="l14591"></a><span class="lineno">14591</span>&#160; </div>
<div class="line"><a name="l14592"></a><span class="lineno">14592</span>&#160;            <span class="comment">// Add to counters</span></div>
<div class="line"><a name="l14593"></a><span class="lineno">14593</span>&#160;            n_refined += mmesh_pt-&gt;nrefined();</div>
<div class="line"><a name="l14594"></a><span class="lineno">14594</span>&#160;            n_unrefined += mmesh_pt-&gt;nunrefined();</div>
<div class="line"><a name="l14595"></a><span class="lineno">14595</span>&#160;          }</div>
<div class="line"><a name="l14596"></a><span class="lineno">14596</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l14597"></a><span class="lineno">14597</span>&#160;          {</div>
<div class="line"><a name="l14598"></a><span class="lineno">14598</span>&#160;            <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Mesh adaptation is disabled.&quot;</span></div>
<div class="line"><a name="l14599"></a><span class="lineno">14599</span>&#160;                       &lt;&lt; std::endl;</div>
<div class="line"><a name="l14600"></a><span class="lineno">14600</span>&#160;          }</div>
<div class="line"><a name="l14601"></a><span class="lineno">14601</span>&#160;        }</div>
<div class="line"><a name="l14602"></a><span class="lineno">14602</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l14603"></a><span class="lineno">14603</span>&#160;        {</div>
<div class="line"><a name="l14604"></a><span class="lineno">14604</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Mesh cannot be adapted.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l14605"></a><span class="lineno">14605</span>&#160;        }</div>
<div class="line"><a name="l14606"></a><span class="lineno">14606</span>&#160; </div>
<div class="line"><a name="l14607"></a><span class="lineno">14607</span>&#160;      } <span class="comment">// End of loop over submeshes</span></div>
<div class="line"><a name="l14608"></a><span class="lineno">14608</span>&#160; </div>
<div class="line"><a name="l14609"></a><span class="lineno">14609</span>&#160;      <span class="comment">// Rebuild the global mesh</span></div>
<div class="line"><a name="l14610"></a><span class="lineno">14610</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a266d4d1b2bd4a5cbc028ff5aba79508f">rebuild_global_mesh</a>();</div>
<div class="line"><a name="l14611"></a><span class="lineno">14611</span>&#160;    }</div>
<div class="line"><a name="l14612"></a><span class="lineno">14612</span>&#160; </div>
<div class="line"><a name="l14613"></a><span class="lineno">14613</span>&#160;    <span class="comment">// Any actions after adapt</span></div>
<div class="line"><a name="l14614"></a><span class="lineno">14614</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">actions_after_adapt</a>();</div>
<div class="line"><a name="l14615"></a><span class="lineno">14615</span>&#160; </div>
<div class="line"><a name="l14616"></a><span class="lineno">14616</span>&#160;    <span class="comment">// Attach the boundary conditions to the mesh</span></div>
<div class="line"><a name="l14617"></a><span class="lineno">14617</span>&#160;    <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;\nNumber of equations: &quot;</span> &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers</a>() &lt;&lt; std::endl</div>
<div class="line"><a name="l14618"></a><span class="lineno">14618</span>&#160;               &lt;&lt; std::endl;</div>
<div class="line"><a name="l14619"></a><span class="lineno">14619</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">actions_after_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">actions_before_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh()</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a266d4d1b2bd4a5cbc028ff5aba79508f">rebuild_global_mesh()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5e60c7b47591bca6b20b0612e119983">adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a3809e4ec25082a5b8686bd6fa1c61fce">adapt_based_on_error_estimates()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa0b4e7868e02e2d12845c9b2dd60cab9">bifurcation_adapt_helper()</a>.</p>

</div>
</div>
<a id="a3809e4ec25082a5b8686bd6fa1c61fce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3809e4ec25082a5b8686bd6fa1c61fce">&#9670;&nbsp;</a></span>adapt_based_on_error_estimates() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Problem::adapt_based_on_error_estimates </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>elemental_error</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Adapt problem: Perform mesh adaptation for (all) refineable (sub)mesh(es), based on the error estimates in elemental_error and the target errors specified in the mesh(es). Following mesh adaptation, update global mesh, and re-assign equation numbers. Return # of refined/unrefined elements. On return from this function, Problem can immediately be solved again. [Wrapper without n_refined and n_unrefined arguments] </p>
<div class="fragment"><div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;    {</div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;      <span class="keywordtype">unsigned</span> n_refined, n_unrefined;</div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a309487c952f108015b53a2d70539ac8b">adapt_based_on_error_estimates</a>(n_refined, n_unrefined, elemental_error);</div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a309487c952f108015b53a2d70539ac8b">adapt_based_on_error_estimates()</a>.</p>

</div>
</div>
<a id="a9b7434598b8a28bf6470f481acef5d5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b7434598b8a28bf6470f481acef5d5f">&#9670;&nbsp;</a></span>adaptive_unsteady_newton_solve() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> Problem::adaptive_unsteady_newton_solve </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>dt_desired</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>epsilon</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Attempt to advance timestep by dt_desired. If the solution fails the timestep will be halved until convergence is achieved, or the timestep falls below NewtonSolverParameters::Minimum_time_step. The error control parameter epsilon represents the (approximate) desired magnitude of the global error at each timestep. The routine returns a double that is the suggested next timestep and should be passed as dt_desired the next time the routine is called. This version always shifts the time values.</p>
<p>Attempt to take one timestep forward using dt_desired. The error control parameter, epsilon, is used to specify the desired approximate value of the global error norm per timestep. The routine returns the value an estimate of the next value of dt that should be taken. </p>
<div class="fragment"><div class="line"><a name="l11058"></a><span class="lineno">11058</span>&#160;  {</div>
<div class="line"><a name="l11059"></a><span class="lineno">11059</span>&#160;    <span class="comment">// We always want to shift the time values</span></div>
<div class="line"><a name="l11060"></a><span class="lineno">11060</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a9b7434598b8a28bf6470f481acef5d5f">adaptive_unsteady_newton_solve</a>(dt_desired, <a class="code" href="../../d5/d34/namespaceoomph_1_1SarahBL.html#a21bfe7e71f0baa62022d1ecc9bd175de">epsilon</a>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l11061"></a><span class="lineno">11061</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a9b7434598b8a28bf6470f481acef5d5f"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a9b7434598b8a28bf6470f481acef5d5f">oomph::Problem::adaptive_unsteady_newton_solve</a></div><div class="ttdeci">double adaptive_unsteady_newton_solve(const double &amp;dt_desired, const double &amp;epsilon)</div><div class="ttdef"><b>Definition:</b> problem.cc:11056</div></div>
<div class="ttc" id="anamespaceoomph_1_1SarahBL_html_a21bfe7e71f0baa62022d1ecc9bd175de"><div class="ttname"><a href="../../d5/d34/namespaceoomph_1_1SarahBL.html#a21bfe7e71f0baa62022d1ecc9bd175de">oomph::SarahBL::epsilon</a></div><div class="ttdeci">double epsilon</div><div class="ttdef"><b>Definition:</b> osc_ring_sarah_asymptotics.h:43</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d5/d34/namespaceoomph_1_1SarahBL.html#a21bfe7e71f0baa62022d1ecc9bd175de">oomph::SarahBL::epsilon</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7c23771b77d6da7cbee3c3e3c050be73">doubly_adaptive_unsteady_newton_solve_helper()</a>.</p>

</div>
</div>
<a id="a63805c549e71b7c73107abe6001fae25"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63805c549e71b7c73107abe6001fae25">&#9670;&nbsp;</a></span>adaptive_unsteady_newton_solve() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> Problem::adaptive_unsteady_newton_solve </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>dt_desired</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>epsilon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;&#160;</td>
          <td class="paramname"><em>shift_values</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Attempt to advance timestep by dt_desired. If the solution fails the timestep will be halved until convergence is achieved, or the timestep falls below NewtonSolverParameters::Minimum_time_step. The error control parameter epsilon represents the (approximate) desired magnitude of the global error at each timestep. The routine returns a double that is the suggested next timestep and should be passed as dt_desired the next time the routine is called. Once again the boolean flag, shift_values, is used to control whether the time values are shifted.</p>
<p>Attempt to take one timestep forward using the dt_desired. This is the driver for a number of adaptive solvers. If the solution fails to converge at a given timestep, the routine will automatically halve the time step and try again, until the time step falls below the specified minimum value. The routine returns the value an estimate of the next value of dt that should be taken. Timestep is also rejected if the error estimate post-solve (computed by global_temporal_error_norm()) exceeds epsilon. This behaviour can be over-ruled by setting the protected boolean Problem::Keep_temporal_error_below_tolerance to false. </p>
<div class="fragment"><div class="line"><a name="l11079"></a><span class="lineno">11079</span>&#160;  {</div>
<div class="line"><a name="l11080"></a><span class="lineno">11080</span>&#160;    <span class="comment">// First, we need to backup the existing dofs, in case the timestep is</span></div>
<div class="line"><a name="l11081"></a><span class="lineno">11081</span>&#160;    <span class="comment">// rejected</span></div>
<div class="line"><a name="l11082"></a><span class="lineno">11082</span>&#160; </div>
<div class="line"><a name="l11083"></a><span class="lineno">11083</span>&#160;    <span class="comment">// Find total number of dofs on current processor</span></div>
<div class="line"><a name="l11084"></a><span class="lineno">11084</span>&#160;    <span class="keywordtype">unsigned</span> n_dof_local = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a17a5a4886c4213422179fe8346336a4e">dof_distribution_pt</a>()-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">nrow_local</a>();</div>
<div class="line"><a name="l11085"></a><span class="lineno">11085</span>&#160; </div>
<div class="line"><a name="l11086"></a><span class="lineno">11086</span>&#160;    <span class="comment">// Now set up a Vector to hold current values</span></div>
<div class="line"><a name="l11087"></a><span class="lineno">11087</span>&#160;    Vector&lt;double&gt; dofs_current(n_dof_local);</div>
<div class="line"><a name="l11088"></a><span class="lineno">11088</span>&#160; </div>
<div class="line"><a name="l11089"></a><span class="lineno">11089</span>&#160;    <span class="comment">// Load values into dofs_current</span></div>
<div class="line"><a name="l11090"></a><span class="lineno">11090</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_dof_local; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++) dofs_current[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a74d71439b100fb5b66b94d1d69130f7c">dof</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l11091"></a><span class="lineno">11091</span>&#160; </div>
<div class="line"><a name="l11092"></a><span class="lineno">11092</span>&#160;    <span class="comment">// Store the time</span></div>
<div class="line"><a name="l11093"></a><span class="lineno">11093</span>&#160;    <span class="keywordtype">double</span> time_current = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a46894b13c582f322082dc471a2485980">time_pt</a>()-&gt;<a class="code" href="../../d0/da1/classoomph_1_1Time.html#a6e28ea7a6664a2f5f5e1be871304a2c7">time</a>();</div>
<div class="line"><a name="l11094"></a><span class="lineno">11094</span>&#160; </div>
<div class="line"><a name="l11095"></a><span class="lineno">11095</span>&#160;    <span class="comment">// Flag to detect whether the timestep has been rejected or not</span></div>
<div class="line"><a name="l11096"></a><span class="lineno">11096</span>&#160;    <span class="keywordtype">bool</span> reject_timestep = 0;</div>
<div class="line"><a name="l11097"></a><span class="lineno">11097</span>&#160; </div>
<div class="line"><a name="l11098"></a><span class="lineno">11098</span>&#160;    <span class="comment">// Flag to detect whether any of the timesteppers are adaptive</span></div>
<div class="line"><a name="l11099"></a><span class="lineno">11099</span>&#160;    <span class="keywordtype">unsigned</span> adaptive_flag = 0;</div>
<div class="line"><a name="l11100"></a><span class="lineno">11100</span>&#160; </div>
<div class="line"><a name="l11101"></a><span class="lineno">11101</span>&#160;    <span class="comment">// The value of the actual timestep, by default the same as desired timestep</span></div>
<div class="line"><a name="l11102"></a><span class="lineno">11102</span>&#160;    <span class="keywordtype">double</span> dt_actual = dt_desired;</div>
<div class="line"><a name="l11103"></a><span class="lineno">11103</span>&#160; </div>
<div class="line"><a name="l11104"></a><span class="lineno">11104</span>&#160;    <span class="comment">// Find out whether any of the timesteppers are adaptive</span></div>
<div class="line"><a name="l11105"></a><span class="lineno">11105</span>&#160;    <span class="keywordtype">unsigned</span> n_time_steppers = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ace3cdf55009c3bff21d2b7d3706d522a">ntime_stepper</a>();</div>
<div class="line"><a name="l11106"></a><span class="lineno">11106</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_time_steppers; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l11107"></a><span class="lineno">11107</span>&#160;    {</div>
<div class="line"><a name="l11108"></a><span class="lineno">11108</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)-&gt;adaptive_flag())</div>
<div class="line"><a name="l11109"></a><span class="lineno">11109</span>&#160;      {</div>
<div class="line"><a name="l11110"></a><span class="lineno">11110</span>&#160;        adaptive_flag = 1;</div>
<div class="line"><a name="l11111"></a><span class="lineno">11111</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l11112"></a><span class="lineno">11112</span>&#160;      }</div>
<div class="line"><a name="l11113"></a><span class="lineno">11113</span>&#160;    }</div>
<div class="line"><a name="l11114"></a><span class="lineno">11114</span>&#160; </div>
<div class="line"><a name="l11115"></a><span class="lineno">11115</span>&#160;    <span class="comment">// Shift the time_values according to the control flag</span></div>
<div class="line"><a name="l11116"></a><span class="lineno">11116</span>&#160;    <span class="keywordflow">if</span> (shift_values)</div>
<div class="line"><a name="l11117"></a><span class="lineno">11117</span>&#160;    {</div>
<div class="line"><a name="l11118"></a><span class="lineno">11118</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a3d3108a38cfbed4087f5b8eb601f38a2">shift_time_values</a>();</div>
<div class="line"><a name="l11119"></a><span class="lineno">11119</span>&#160;    }</div>
<div class="line"><a name="l11120"></a><span class="lineno">11120</span>&#160; </div>
<div class="line"><a name="l11121"></a><span class="lineno">11121</span>&#160;    <span class="comment">// This loop surrounds the adaptive time-stepping and will not be broken</span></div>
<div class="line"><a name="l11122"></a><span class="lineno">11122</span>&#160;    <span class="comment">// until a timestep is accepted</span></div>
<div class="line"><a name="l11123"></a><span class="lineno">11123</span>&#160;    <span class="keywordflow">do</span></div>
<div class="line"><a name="l11124"></a><span class="lineno">11124</span>&#160;    {</div>
<div class="line"><a name="l11125"></a><span class="lineno">11125</span>&#160;      <span class="comment">// Initially we assume that this step will succeed and that this dt</span></div>
<div class="line"><a name="l11126"></a><span class="lineno">11126</span>&#160;      <span class="comment">// value is ok.</span></div>
<div class="line"><a name="l11127"></a><span class="lineno">11127</span>&#160;      reject_timestep = 0;</div>
<div class="line"><a name="l11128"></a><span class="lineno">11128</span>&#160;      <span class="keywordtype">double</span> dt_rescaling_factor = 1.0;</div>
<div class="line"><a name="l11129"></a><span class="lineno">11129</span>&#160; </div>
<div class="line"><a name="l11130"></a><span class="lineno">11130</span>&#160;      <span class="comment">// Set the new time and value of dt</span></div>
<div class="line"><a name="l11131"></a><span class="lineno">11131</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a46894b13c582f322082dc471a2485980">time_pt</a>()-&gt;<a class="code" href="../../d0/da1/classoomph_1_1Time.html#a6e28ea7a6664a2f5f5e1be871304a2c7">time</a>() += dt_actual;</div>
<div class="line"><a name="l11132"></a><span class="lineno">11132</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a46894b13c582f322082dc471a2485980">time_pt</a>()-&gt;<a class="code" href="../../d0/da1/classoomph_1_1Time.html#a2c684e0a69db7adde90f1f052e424a6b">dt</a>() = dt_actual;</div>
<div class="line"><a name="l11133"></a><span class="lineno">11133</span>&#160; </div>
<div class="line"><a name="l11134"></a><span class="lineno">11134</span>&#160;      <span class="comment">// Loop over all timesteppers and set the weights and predictor weights</span></div>
<div class="line"><a name="l11135"></a><span class="lineno">11135</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_time_steppers; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l11136"></a><span class="lineno">11136</span>&#160;      {</div>
<div class="line"><a name="l11137"></a><span class="lineno">11137</span>&#160;        <span class="comment">// If the time_stepper is non-adaptive, this will be zero</span></div>
<div class="line"><a name="l11138"></a><span class="lineno">11138</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)-&gt;<a class="code" href="../../d5/d19/classoomph_1_1TimeStepper.html#a2dfb949155ba433066fd69dc427ba1ce">set_predictor_weights</a>();</div>
<div class="line"><a name="l11139"></a><span class="lineno">11139</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)-&gt;<a class="code" href="../../d5/d19/classoomph_1_1TimeStepper.html#a028fa3a8d3c6db6b0ddf580cb0468d55">set_weights</a>();</div>
<div class="line"><a name="l11140"></a><span class="lineno">11140</span>&#160;      }</div>
<div class="line"><a name="l11141"></a><span class="lineno">11141</span>&#160; </div>
<div class="line"><a name="l11142"></a><span class="lineno">11142</span>&#160;      <span class="comment">// Now calculate the predicted values for the all data and all positions</span></div>
<div class="line"><a name="l11143"></a><span class="lineno">11143</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#acbc0b0fc5d5cc76ce8384bc0bd815f26">calculate_predictions</a>();</div>
<div class="line"><a name="l11144"></a><span class="lineno">11144</span>&#160; </div>
<div class="line"><a name="l11145"></a><span class="lineno">11145</span>&#160;      <span class="comment">// Run the individual timesteppers actions before timestep. These need to</span></div>
<div class="line"><a name="l11146"></a><span class="lineno">11146</span>&#160;      <span class="comment">// be before the problem&#39;s actions_before_implicit_timestep so that the</span></div>
<div class="line"><a name="l11147"></a><span class="lineno">11147</span>&#160;      <span class="comment">// boundary conditions are set consistently.</span></div>
<div class="line"><a name="l11148"></a><span class="lineno">11148</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_time_steppers; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l11149"></a><span class="lineno">11149</span>&#160;      {</div>
<div class="line"><a name="l11150"></a><span class="lineno">11150</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)-&gt;<a class="code" href="../../d5/d19/classoomph_1_1TimeStepper.html#a36cbcee0c1127085ba3aa2331bfc0f74">actions_before_timestep</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l11151"></a><span class="lineno">11151</span>&#160;      }</div>
<div class="line"><a name="l11152"></a><span class="lineno">11152</span>&#160; </div>
<div class="line"><a name="l11153"></a><span class="lineno">11153</span>&#160;      <span class="comment">// Do any updates/boundary conditions changes here</span></div>
<div class="line"><a name="l11154"></a><span class="lineno">11154</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a4f19896906d2c0274ad6798cd3ac38dc">actions_before_implicit_timestep</a>();</div>
<div class="line"><a name="l11155"></a><span class="lineno">11155</span>&#160; </div>
<div class="line"><a name="l11156"></a><span class="lineno">11156</span>&#160;      <span class="comment">// Attempt to solve the non-linear system</span></div>
<div class="line"><a name="l11157"></a><span class="lineno">11157</span>&#160;      <span class="keywordflow">try</span></div>
<div class="line"><a name="l11158"></a><span class="lineno">11158</span>&#160;      {</div>
<div class="line"><a name="l11159"></a><span class="lineno">11159</span>&#160;        <span class="comment">// Solve the non-linear problem at this timestep</span></div>
<div class="line"><a name="l11160"></a><span class="lineno">11160</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aae8cf62757e432b625ec81fad1559dc3">newton_solve</a>();</div>
<div class="line"><a name="l11161"></a><span class="lineno">11161</span>&#160;      }</div>
<div class="line"><a name="l11162"></a><span class="lineno">11162</span>&#160;      <span class="comment">// Catch any exceptions thrown</span></div>
<div class="line"><a name="l11163"></a><span class="lineno">11163</span>&#160;      <span class="keywordflow">catch</span> (NewtonSolverError&amp; <a class="code" href="../../d9/d33/namespacecalibrate.html#a4dbebf21da853ac368a3a9af2fbab442">error</a>)</div>
<div class="line"><a name="l11164"></a><span class="lineno">11164</span>&#160;      {</div>
<div class="line"><a name="l11165"></a><span class="lineno">11165</span>&#160;        <span class="comment">// If it&#39;s a solver error then die</span></div>
<div class="line"><a name="l11166"></a><span class="lineno">11166</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d9/d33/namespacecalibrate.html#a4dbebf21da853ac368a3a9af2fbab442">error</a>.linear_solver_error ||</div>
<div class="line"><a name="l11167"></a><span class="lineno">11167</span>&#160;            <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a3e9aecf88bde320bc2d169b5f3c99fee">Time_adaptive_newton_crash_on_solve_fail</a>)</div>
<div class="line"><a name="l11168"></a><span class="lineno">11168</span>&#160;        {</div>
<div class="line"><a name="l11169"></a><span class="lineno">11169</span>&#160;          <a class="code" href="../../d2/dc3/namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">std::string</a> error_message = <span class="stringliteral">&quot;USER-DEFINED ERROR IN NEWTON SOLVER\n&quot;</span>;</div>
<div class="line"><a name="l11170"></a><span class="lineno">11170</span>&#160;          error_message += <span class="stringliteral">&quot;ERROR IN THE LINEAR SOLVER\n&quot;</span>;</div>
<div class="line"><a name="l11171"></a><span class="lineno">11171</span>&#160; </div>
<div class="line"><a name="l11172"></a><span class="lineno">11172</span>&#160;          <span class="comment">// Die</span></div>
<div class="line"><a name="l11173"></a><span class="lineno">11173</span>&#160;          <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l11174"></a><span class="lineno">11174</span>&#160;            error_message, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l11175"></a><span class="lineno">11175</span>&#160;        }</div>
<div class="line"><a name="l11176"></a><span class="lineno">11176</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l11177"></a><span class="lineno">11177</span>&#160;        {</div>
<div class="line"><a name="l11178"></a><span class="lineno">11178</span>&#160;          <span class="comment">// Reject the timestep, if we have an exception</span></div>
<div class="line"><a name="l11179"></a><span class="lineno">11179</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;TIMESTEP REJECTED&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l11180"></a><span class="lineno">11180</span>&#160;          reject_timestep = 1;</div>
<div class="line"><a name="l11181"></a><span class="lineno">11181</span>&#160; </div>
<div class="line"><a name="l11182"></a><span class="lineno">11182</span>&#160;          <span class="comment">// Half the time step</span></div>
<div class="line"><a name="l11183"></a><span class="lineno">11183</span>&#160;          dt_rescaling_factor = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a359d1936bc2146e0a0ce697776efcf91">Timestep_reduction_factor_after_nonconvergence</a>;</div>
<div class="line"><a name="l11184"></a><span class="lineno">11184</span>&#160;        }</div>
<div class="line"><a name="l11185"></a><span class="lineno">11185</span>&#160;      }</div>
<div class="line"><a name="l11186"></a><span class="lineno">11186</span>&#160; </div>
<div class="line"><a name="l11187"></a><span class="lineno">11187</span>&#160;      <span class="comment">// Run the individual timesteppers actions, these need to be before the</span></div>
<div class="line"><a name="l11188"></a><span class="lineno">11188</span>&#160;      <span class="comment">// problem&#39;s actions_after_implicit_timestep so that the time step is</span></div>
<div class="line"><a name="l11189"></a><span class="lineno">11189</span>&#160;      <span class="comment">// finished before the problem does any auxiliary calculations (e.g. in</span></div>
<div class="line"><a name="l11190"></a><span class="lineno">11190</span>&#160;      <span class="comment">// semi-implicit micromagnetics the calculation of magnetostatic field).</span></div>
<div class="line"><a name="l11191"></a><span class="lineno">11191</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_time_steppers; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l11192"></a><span class="lineno">11192</span>&#160;      {</div>
<div class="line"><a name="l11193"></a><span class="lineno">11193</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)-&gt;<a class="code" href="../../d5/d19/classoomph_1_1TimeStepper.html#a3a0fabf83f9bdc89800cd3501df2c586">actions_after_timestep</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l11194"></a><span class="lineno">11194</span>&#160;      }</div>
<div class="line"><a name="l11195"></a><span class="lineno">11195</span>&#160; </div>
<div class="line"><a name="l11196"></a><span class="lineno">11196</span>&#160;      <span class="comment">// Update anything that needs updating after the timestep</span></div>
<div class="line"><a name="l11197"></a><span class="lineno">11197</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a012692496c968960f4ea27db4e89cc7d">actions_after_implicit_timestep</a>();</div>
<div class="line"><a name="l11198"></a><span class="lineno">11198</span>&#160; </div>
<div class="line"><a name="l11199"></a><span class="lineno">11199</span>&#160;      <span class="comment">// If we have an adapative timestepper (and we haven&#39;t already failed)</span></div>
<div class="line"><a name="l11200"></a><span class="lineno">11200</span>&#160;      <span class="comment">// then calculate the error estimate and rescaling factor.</span></div>
<div class="line"><a name="l11201"></a><span class="lineno">11201</span>&#160;      <span class="keywordflow">if</span> (adaptive_flag &amp;&amp; !reject_timestep)</div>
<div class="line"><a name="l11202"></a><span class="lineno">11202</span>&#160;      {</div>
<div class="line"><a name="l11203"></a><span class="lineno">11203</span>&#160;        <span class="comment">// Once timestep has been accepted can do fancy error processing</span></div>
<div class="line"><a name="l11204"></a><span class="lineno">11204</span>&#160;        <span class="comment">// Set the error weights</span></div>
<div class="line"><a name="l11205"></a><span class="lineno">11205</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_time_steppers; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l11206"></a><span class="lineno">11206</span>&#160;        {</div>
<div class="line"><a name="l11207"></a><span class="lineno">11207</span>&#160;          <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)-&gt;<a class="code" href="../../d5/d19/classoomph_1_1TimeStepper.html#aee0c1da870a603e64efebb51dfc96a3d">set_error_weights</a>();</div>
<div class="line"><a name="l11208"></a><span class="lineno">11208</span>&#160;        }</div>
<div class="line"><a name="l11209"></a><span class="lineno">11209</span>&#160; </div>
<div class="line"><a name="l11210"></a><span class="lineno">11210</span>&#160;        <span class="comment">// Get a global error norm to use in adaptivity (as specified by the</span></div>
<div class="line"><a name="l11211"></a><span class="lineno">11211</span>&#160;        <span class="comment">// problem sub-class writer). Prevent a divide by zero if the solution</span></div>
<div class="line"><a name="l11212"></a><span class="lineno">11212</span>&#160;        <span class="comment">// gives very close to zero error. Error norm should never be negative</span></div>
<div class="line"><a name="l11213"></a><span class="lineno">11213</span>&#160;        <span class="comment">// but use absolute value just in case.</span></div>
<div class="line"><a name="l11214"></a><span class="lineno">11214</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="../../d9/d33/namespacecalibrate.html#a4dbebf21da853ac368a3a9af2fbab442">error</a> = <a class="code" href="../../dc/d51/datatypes_8h.html#affe776513b24d84b39af8ab0930fef7f">std::max</a>(<a class="code" href="../../d8/de9/AnnoyingScalar_8h.html#a0b723dc4b77525f0cc278538ff494e29">std::abs</a>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ac7667864b71a3889c95c29307422ac8e">global_temporal_error_norm</a>()), 1<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>-12);</div>
<div class="line"><a name="l11215"></a><span class="lineno">11215</span>&#160; </div>
<div class="line"><a name="l11216"></a><span class="lineno">11216</span>&#160;        <span class="comment">// Calculate the scaling  factor</span></div>
<div class="line"><a name="l11217"></a><span class="lineno">11217</span>&#160;        dt_rescaling_factor = <a class="code" href="../../db/d6f/namespaceEigen_1_1bfloat16__impl.html#aadf08601dbe94964a06487ba453a0436">std::pow</a>(</div>
<div class="line"><a name="l11218"></a><span class="lineno">11218</span>&#160;          (<a class="code" href="../../d5/d34/namespaceoomph_1_1SarahBL.html#a21bfe7e71f0baa62022d1ecc9bd175de">epsilon</a> / <a class="code" href="../../d9/d33/namespacecalibrate.html#a4dbebf21da853ac368a3a9af2fbab442">error</a>), (1.0 / (1.0 + <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>()-&gt;order())));</div>
<div class="line"><a name="l11219"></a><span class="lineno">11219</span>&#160; </div>
<div class="line"><a name="l11220"></a><span class="lineno">11220</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Timestep scaling factor is  &quot;</span> &lt;&lt; dt_rescaling_factor</div>
<div class="line"><a name="l11221"></a><span class="lineno">11221</span>&#160;                   &lt;&lt; std::endl;</div>
<div class="line"><a name="l11222"></a><span class="lineno">11222</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Estimated timestepping error is &quot;</span> &lt;&lt; <a class="code" href="../../d9/d33/namespacecalibrate.html#a4dbebf21da853ac368a3a9af2fbab442">error</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l11223"></a><span class="lineno">11223</span>&#160; </div>
<div class="line"><a name="l11224"></a><span class="lineno">11224</span>&#160; </div>
<div class="line"><a name="l11225"></a><span class="lineno">11225</span>&#160;        <span class="comment">// Do we have to do it again?</span></div>
<div class="line"><a name="l11226"></a><span class="lineno">11226</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d9/d33/namespacecalibrate.html#a4dbebf21da853ac368a3a9af2fbab442">error</a> &gt; <a class="code" href="../../d5/d34/namespaceoomph_1_1SarahBL.html#a21bfe7e71f0baa62022d1ecc9bd175de">epsilon</a>)</div>
<div class="line"><a name="l11227"></a><span class="lineno">11227</span>&#160;        {</div>
<div class="line"><a name="l11228"></a><span class="lineno">11228</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Estimated timestepping error &quot;</span> &lt;&lt; <a class="code" href="../../d9/d33/namespacecalibrate.html#a4dbebf21da853ac368a3a9af2fbab442">error</a></div>
<div class="line"><a name="l11229"></a><span class="lineno">11229</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot; exceeds tolerance &quot;</span> &lt;&lt; <a class="code" href="../../d5/d34/namespaceoomph_1_1SarahBL.html#a21bfe7e71f0baa62022d1ecc9bd175de">epsilon</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l11230"></a><span class="lineno">11230</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab27af4a444de9f59125ee50ac778d97a">Keep_temporal_error_below_tolerance</a>)</div>
<div class="line"><a name="l11231"></a><span class="lineno">11231</span>&#160;          {</div>
<div class="line"><a name="l11232"></a><span class="lineno">11232</span>&#160;            <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot; --&gt; rejecting timestep.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l11233"></a><span class="lineno">11233</span>&#160;            reject_timestep = 1;</div>
<div class="line"><a name="l11234"></a><span class="lineno">11234</span>&#160;          }</div>
<div class="line"><a name="l11235"></a><span class="lineno">11235</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l11236"></a><span class="lineno">11236</span>&#160;          {</div>
<div class="line"><a name="l11237"></a><span class="lineno">11237</span>&#160;            <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot; ...but we&#39;re not rejecting the timestep&quot;</span></div>
<div class="line"><a name="l11238"></a><span class="lineno">11238</span>&#160;                       &lt;&lt; std::endl;</div>
<div class="line"><a name="l11239"></a><span class="lineno">11239</span>&#160;          }</div>
<div class="line"><a name="l11240"></a><span class="lineno">11240</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a></div>
<div class="line"><a name="l11241"></a><span class="lineno">11241</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;Note: This behaviour can be adjusted by changing the protected &quot;</span></div>
<div class="line"><a name="l11242"></a><span class="lineno">11242</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;boolean&quot;</span> &lt;&lt; std::endl</div>
<div class="line"><a name="l11243"></a><span class="lineno">11243</span>&#160;            &lt;&lt; std::endl</div>
<div class="line"><a name="l11244"></a><span class="lineno">11244</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;    Problem::Keep_temporal_error_below_tolerance&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l11245"></a><span class="lineno">11245</span>&#160;        }</div>
<div class="line"><a name="l11246"></a><span class="lineno">11246</span>&#160; </div>
<div class="line"><a name="l11247"></a><span class="lineno">11247</span>&#160; </div>
<div class="line"><a name="l11248"></a><span class="lineno">11248</span>&#160;      } <span class="comment">// End of if adaptive flag</span></div>
<div class="line"><a name="l11249"></a><span class="lineno">11249</span>&#160; </div>
<div class="line"><a name="l11250"></a><span class="lineno">11250</span>&#160; </div>
<div class="line"><a name="l11251"></a><span class="lineno">11251</span>&#160;      <span class="comment">// Calculate the next time step size and check it&#39;s ok</span></div>
<div class="line"><a name="l11252"></a><span class="lineno">11252</span>&#160;      <span class="comment">// ============================================================</span></div>
<div class="line"><a name="l11253"></a><span class="lineno">11253</span>&#160; </div>
<div class="line"><a name="l11254"></a><span class="lineno">11254</span>&#160;      <span class="comment">// Calculate the possible next time step, if no error conditions</span></div>
<div class="line"><a name="l11255"></a><span class="lineno">11255</span>&#160;      <span class="comment">// trigger.</span></div>
<div class="line"><a name="l11256"></a><span class="lineno">11256</span>&#160;      <span class="keywordtype">double</span> new_dt_candidate = dt_rescaling_factor * dt_actual;</div>
<div class="line"><a name="l11257"></a><span class="lineno">11257</span>&#160; </div>
<div class="line"><a name="l11258"></a><span class="lineno">11258</span>&#160;      <span class="comment">// Check that the scaling factor is within the allowed range</span></div>
<div class="line"><a name="l11259"></a><span class="lineno">11259</span>&#160;      <span class="keywordflow">if</span> (dt_rescaling_factor &gt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aaaeab9469b342a3b849ee5f2ef7051f3">DTSF_max_increase</a>)</div>
<div class="line"><a name="l11260"></a><span class="lineno">11260</span>&#160;      {</div>
<div class="line"><a name="l11261"></a><span class="lineno">11261</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Tried to increase dt by the ratio &quot;</span></div>
<div class="line"><a name="l11262"></a><span class="lineno">11262</span>&#160;                   &lt;&lt; dt_rescaling_factor &lt;&lt; <span class="stringliteral">&quot; which is above the maximum (&quot;</span></div>
<div class="line"><a name="l11263"></a><span class="lineno">11263</span>&#160;                   &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aaaeab9469b342a3b849ee5f2ef7051f3">DTSF_max_increase</a></div>
<div class="line"><a name="l11264"></a><span class="lineno">11264</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;). Attempting to increase by the maximum ratio instead.&quot;</span></div>
<div class="line"><a name="l11265"></a><span class="lineno">11265</span>&#160;                   &lt;&lt; std::endl;</div>
<div class="line"><a name="l11266"></a><span class="lineno">11266</span>&#160;        new_dt_candidate = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aaaeab9469b342a3b849ee5f2ef7051f3">DTSF_max_increase</a> * dt_actual;</div>
<div class="line"><a name="l11267"></a><span class="lineno">11267</span>&#160;      }</div>
<div class="line"><a name="l11268"></a><span class="lineno">11268</span>&#160;      <span class="comment">// If we have already rejected the timestep then don&#39;t do this check</span></div>
<div class="line"><a name="l11269"></a><span class="lineno">11269</span>&#160;      <span class="comment">// because DTSF will definitely be too small.</span></div>
<div class="line"><a name="l11270"></a><span class="lineno">11270</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((!reject_timestep) &amp;&amp; (dt_rescaling_factor &lt;= <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#abbb93979ed99d40eb845ba7296355965">DTSF_min_decrease</a>))</div>
<div class="line"><a name="l11271"></a><span class="lineno">11271</span>&#160;      {</div>
<div class="line"><a name="l11272"></a><span class="lineno">11272</span>&#160;        <span class="comment">// Handle this special case where we want to continue anyway (usually</span></div>
<div class="line"><a name="l11273"></a><span class="lineno">11273</span>&#160;        <span class="comment">// Minimum_dt_but_still_proceed = -1 so this has no effect).</span></div>
<div class="line"><a name="l11274"></a><span class="lineno">11274</span>&#160;        <span class="keywordflow">if</span> (new_dt_candidate &lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#abdee700b2cec37540cf1e7e1462df6c3">Minimum_dt_but_still_proceed</a>)</div>
<div class="line"><a name="l11275"></a><span class="lineno">11275</span>&#160;        {</div>
<div class="line"><a name="l11276"></a><span class="lineno">11276</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a></div>
<div class="line"><a name="l11277"></a><span class="lineno">11277</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;Warning: Adaptation of timestep to ensure satisfaction\n&quot;</span></div>
<div class="line"><a name="l11278"></a><span class="lineno">11278</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;         of error bounds during adaptive timestepping\n&quot;</span></div>
<div class="line"><a name="l11279"></a><span class="lineno">11279</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;         would lower dt below \n&quot;</span></div>
<div class="line"><a name="l11280"></a><span class="lineno">11280</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;         Problem::Minimum_dt_but_still_proceed=&quot;</span></div>
<div class="line"><a name="l11281"></a><span class="lineno">11281</span>&#160;            &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#abdee700b2cec37540cf1e7e1462df6c3">Minimum_dt_but_still_proceed</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l11282"></a><span class="lineno">11282</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;         ---&gt; We&#39;re continuing with present timestep.\n&quot;</span></div>
<div class="line"><a name="l11283"></a><span class="lineno">11283</span>&#160;            &lt;&lt; std::endl;</div>
<div class="line"><a name="l11284"></a><span class="lineno">11284</span>&#160;          dt_rescaling_factor = 1.0;</div>
<div class="line"><a name="l11285"></a><span class="lineno">11285</span>&#160;          <span class="comment">// ??ds shouldn&#39;t we set new_dt_candidate =</span></div>
<div class="line"><a name="l11286"></a><span class="lineno">11286</span>&#160;          <span class="comment">// Minimum_dt_but_still_proceed here, rather than not changing dt at</span></div>
<div class="line"><a name="l11287"></a><span class="lineno">11287</span>&#160;          <span class="comment">// all?</span></div>
<div class="line"><a name="l11288"></a><span class="lineno">11288</span>&#160;        }</div>
<div class="line"><a name="l11289"></a><span class="lineno">11289</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l11290"></a><span class="lineno">11290</span>&#160;        {</div>
<div class="line"><a name="l11291"></a><span class="lineno">11291</span>&#160;          <span class="comment">// Otherwise reject</span></div>
<div class="line"><a name="l11292"></a><span class="lineno">11292</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Timestep would decrease by &quot;</span> &lt;&lt; dt_rescaling_factor</div>
<div class="line"><a name="l11293"></a><span class="lineno">11293</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot; which is less than the minimum scaling factor &quot;</span></div>
<div class="line"><a name="l11294"></a><span class="lineno">11294</span>&#160;                     &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#abbb93979ed99d40eb845ba7296355965">DTSF_min_decrease</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l11295"></a><span class="lineno">11295</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;TIMESTEP REJECTED&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l11296"></a><span class="lineno">11296</span>&#160;          reject_timestep = 1;</div>
<div class="line"><a name="l11297"></a><span class="lineno">11297</span>&#160;        }</div>
<div class="line"><a name="l11298"></a><span class="lineno">11298</span>&#160;      }</div>
<div class="line"><a name="l11299"></a><span class="lineno">11299</span>&#160; </div>
<div class="line"><a name="l11300"></a><span class="lineno">11300</span>&#160;      <span class="comment">// Now check that the new dt is within the allowed range</span></div>
<div class="line"><a name="l11301"></a><span class="lineno">11301</span>&#160;      <span class="keywordflow">if</span> (new_dt_candidate &gt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a7b5fde48b00a7fdc5f1fbbee138d0414">Maximum_dt</a>)</div>
<div class="line"><a name="l11302"></a><span class="lineno">11302</span>&#160;      {</div>
<div class="line"><a name="l11303"></a><span class="lineno">11303</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Tried to increase dt to &quot;</span> &lt;&lt; new_dt_candidate</div>
<div class="line"><a name="l11304"></a><span class="lineno">11304</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot; which is above the maximum (&quot;</span> &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a7b5fde48b00a7fdc5f1fbbee138d0414">Maximum_dt</a></div>
<div class="line"><a name="l11305"></a><span class="lineno">11305</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;). I increased it to the maximum value instead.&quot;</span>;</div>
<div class="line"><a name="l11306"></a><span class="lineno">11306</span>&#160;        dt_actual = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a7b5fde48b00a7fdc5f1fbbee138d0414">Maximum_dt</a>;</div>
<div class="line"><a name="l11307"></a><span class="lineno">11307</span>&#160;      }</div>
<div class="line"><a name="l11308"></a><span class="lineno">11308</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (new_dt_candidate &lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad7456318933aa01114dc78498bfd6d79">Minimum_dt</a>)</div>
<div class="line"><a name="l11309"></a><span class="lineno">11309</span>&#160;      {</div>
<div class="line"><a name="l11310"></a><span class="lineno">11310</span>&#160;        std::ostringstream err;</div>
<div class="line"><a name="l11311"></a><span class="lineno">11311</span>&#160;        err &lt;&lt; <span class="stringliteral">&quot;Tried to reduce dt to &quot;</span> &lt;&lt; new_dt_candidate</div>
<div class="line"><a name="l11312"></a><span class="lineno">11312</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; which is less than the minimum dt (&quot;</span> &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad7456318933aa01114dc78498bfd6d79">Minimum_dt</a> &lt;&lt; <span class="stringliteral">&quot;).&quot;</span></div>
<div class="line"><a name="l11313"></a><span class="lineno">11313</span>&#160;            &lt;&lt; std::endl;</div>
<div class="line"><a name="l11314"></a><span class="lineno">11314</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l11315"></a><span class="lineno">11315</span>&#160;          err.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>);</div>
<div class="line"><a name="l11316"></a><span class="lineno">11316</span>&#160;      }</div>
<div class="line"><a name="l11317"></a><span class="lineno">11317</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l11318"></a><span class="lineno">11318</span>&#160;      {</div>
<div class="line"><a name="l11319"></a><span class="lineno">11319</span>&#160;        dt_actual = new_dt_candidate;</div>
<div class="line"><a name="l11320"></a><span class="lineno">11320</span>&#160;      }</div>
<div class="line"><a name="l11321"></a><span class="lineno">11321</span>&#160; </div>
<div class="line"><a name="l11322"></a><span class="lineno">11322</span>&#160; </div>
<div class="line"><a name="l11323"></a><span class="lineno">11323</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a38d914a74e7998ddc74c205884d36d57">actions_after_implicit_timestep_and_error_estimation</a>();</div>
<div class="line"><a name="l11324"></a><span class="lineno">11324</span>&#160; </div>
<div class="line"><a name="l11325"></a><span class="lineno">11325</span>&#160; </div>
<div class="line"><a name="l11326"></a><span class="lineno">11326</span>&#160;      <span class="comment">// If we are rejecting this attempt then revert the dofs etc.</span></div>
<div class="line"><a name="l11327"></a><span class="lineno">11327</span>&#160;      <span class="keywordflow">if</span> (reject_timestep)</div>
<div class="line"><a name="l11328"></a><span class="lineno">11328</span>&#160;      {</div>
<div class="line"><a name="l11329"></a><span class="lineno">11329</span>&#160;        <span class="comment">// Reset the time</span></div>
<div class="line"><a name="l11330"></a><span class="lineno">11330</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a46894b13c582f322082dc471a2485980">time_pt</a>()-&gt;<a class="code" href="../../d0/da1/classoomph_1_1Time.html#a6e28ea7a6664a2f5f5e1be871304a2c7">time</a>() = time_current;</div>
<div class="line"><a name="l11331"></a><span class="lineno">11331</span>&#160; </div>
<div class="line"><a name="l11332"></a><span class="lineno">11332</span>&#160;        <span class="comment">// Reload the dofs</span></div>
<div class="line"><a name="l11333"></a><span class="lineno">11333</span>&#160;        <span class="keywordtype">unsigned</span> ni = dofs_current.size();</div>
<div class="line"><a name="l11334"></a><span class="lineno">11334</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; ni; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l11335"></a><span class="lineno">11335</span>&#160;        {</div>
<div class="line"><a name="l11336"></a><span class="lineno">11336</span>&#160;          <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a74d71439b100fb5b66b94d1d69130f7c">dof</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = dofs_current[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l11337"></a><span class="lineno">11337</span>&#160;        }</div>
<div class="line"><a name="l11338"></a><span class="lineno">11338</span>&#160; </div>
<div class="line"><a name="l11339"></a><span class="lineno">11339</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l11340"></a><span class="lineno">11340</span>&#160;        <span class="comment">// Synchronise the solution on different processors (on each submesh)</span></div>
<div class="line"><a name="l11341"></a><span class="lineno">11341</span>&#160;        this-&gt;synchronise_all_dofs();</div>
<div class="line"><a name="l11342"></a><span class="lineno">11342</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l11343"></a><span class="lineno">11343</span>&#160; </div>
<div class="line"><a name="l11344"></a><span class="lineno">11344</span>&#160;        <span class="comment">// Call all &quot;after&quot; actions, e.g. to handle mesh updates</span></div>
<div class="line"><a name="l11345"></a><span class="lineno">11345</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aed8bc6e7b0bb45b86d5b44737b554d50">actions_after_newton_step</a>();</div>
<div class="line"><a name="l11346"></a><span class="lineno">11346</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae6ad96ddf5d48b517b89c9a9b879bc4b">actions_before_newton_convergence_check</a>();</div>
<div class="line"><a name="l11347"></a><span class="lineno">11347</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a033ec7301123deeb7e56d04c38f9f1da">actions_after_newton_solve</a>();</div>
<div class="line"><a name="l11348"></a><span class="lineno">11348</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a012692496c968960f4ea27db4e89cc7d">actions_after_implicit_timestep</a>();</div>
<div class="line"><a name="l11349"></a><span class="lineno">11349</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a38d914a74e7998ddc74c205884d36d57">actions_after_implicit_timestep_and_error_estimation</a>();</div>
<div class="line"><a name="l11350"></a><span class="lineno">11350</span>&#160;      }</div>
<div class="line"><a name="l11351"></a><span class="lineno">11351</span>&#160; </div>
<div class="line"><a name="l11352"></a><span class="lineno">11352</span>&#160;    }</div>
<div class="line"><a name="l11353"></a><span class="lineno">11353</span>&#160;    <span class="comment">// Keep this loop going until we accept the timestep</span></div>
<div class="line"><a name="l11354"></a><span class="lineno">11354</span>&#160;    <span class="keywordflow">while</span> (reject_timestep);</div>
<div class="line"><a name="l11355"></a><span class="lineno">11355</span>&#160; </div>
<div class="line"><a name="l11356"></a><span class="lineno">11356</span>&#160;    <span class="comment">// Once the timestep has been accepted, return the time step that should be</span></div>
<div class="line"><a name="l11357"></a><span class="lineno">11357</span>&#160;    <span class="comment">// used next time.</span></div>
<div class="line"><a name="l11358"></a><span class="lineno">11358</span>&#160;    <span class="keywordflow">return</span> dt_actual;</div>
<div class="line"><a name="l11359"></a><span class="lineno">11359</span>&#160;  }</div>
<div class="ttc" id="aAnnoyingScalar_8h_html_a0b723dc4b77525f0cc278538ff494e29"><div class="ttname"><a href="../../d8/de9/AnnoyingScalar_8h.html#a0b723dc4b77525f0cc278538ff494e29">abs</a></div><div class="ttdeci">AnnoyingScalar abs(const AnnoyingScalar &amp;x)</div><div class="ttdef"><b>Definition:</b> AnnoyingScalar.h:135</div></div>
<div class="ttc" id="aCwise__array__power__array_8cpp_html_a9eb5e92d9d691c1393e5e7c914731dbf"><div class="ttname"><a href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a></div><div class="ttdeci">Array&lt; double, 1, 3 &gt; e(1./3., 0.5, 2.)</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a012692496c968960f4ea27db4e89cc7d"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a012692496c968960f4ea27db4e89cc7d">oomph::Problem::actions_after_implicit_timestep</a></div><div class="ttdeci">virtual void actions_after_implicit_timestep()</div><div class="ttdef"><b>Definition:</b> problem.h:1070</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a17a5a4886c4213422179fe8346336a4e"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a17a5a4886c4213422179fe8346336a4e">oomph::Problem::dof_distribution_pt</a></div><div class="ttdeci">LinearAlgebraDistribution *const  &amp; dof_distribution_pt() const</div><div class="ttdoc">Return the pointer to the dof distribution (read-only)</div><div class="ttdef"><b>Definition:</b> problem.h:1668</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a38d914a74e7998ddc74c205884d36d57"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a38d914a74e7998ddc74c205884d36d57">oomph::Problem::actions_after_implicit_timestep_and_error_estimation</a></div><div class="ttdeci">virtual void actions_after_implicit_timestep_and_error_estimation()</div><div class="ttdef"><b>Definition:</b> problem.h:1075</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a3d3108a38cfbed4087f5b8eb601f38a2"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a3d3108a38cfbed4087f5b8eb601f38a2">oomph::Problem::shift_time_values</a></div><div class="ttdeci">virtual void shift_time_values()</div><div class="ttdoc">Shift all values along to prepare for next timestep.</div><div class="ttdef"><b>Definition:</b> problem.cc:11634</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a46894b13c582f322082dc471a2485980"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a46894b13c582f322082dc471a2485980">oomph::Problem::time_pt</a></div><div class="ttdeci">Time *&amp; time_pt()</div><div class="ttdoc">Return a pointer to the global time object.</div><div class="ttdef"><b>Definition:</b> problem.h:1504</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a4f19896906d2c0274ad6798cd3ac38dc"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a4f19896906d2c0274ad6798cd3ac38dc">oomph::Problem::actions_before_implicit_timestep</a></div><div class="ttdeci">virtual void actions_before_implicit_timestep()</div><div class="ttdef"><b>Definition:</b> problem.h:1064</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a74d71439b100fb5b66b94d1d69130f7c"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a74d71439b100fb5b66b94d1d69130f7c">oomph::Problem::dof</a></div><div class="ttdeci">double &amp; dof(const unsigned &amp;i)</div><div class="ttdoc">i-th dof in the problem</div><div class="ttdef"><b>Definition:</b> problem.h:1813</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_ac7667864b71a3889c95c29307422ac8e"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#ac7667864b71a3889c95c29307422ac8e">oomph::Problem::global_temporal_error_norm</a></div><div class="ttdeci">virtual double global_temporal_error_norm()</div><div class="ttdef"><b>Definition:</b> problem.h:1230</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_acbc0b0fc5d5cc76ce8384bc0bd815f26"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#acbc0b0fc5d5cc76ce8384bc0bd815f26">oomph::Problem::calculate_predictions</a></div><div class="ttdeci">void calculate_predictions()</div><div class="ttdoc">Calculate predictions.</div><div class="ttdef"><b>Definition:</b> problem.cc:11656</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_ace3cdf55009c3bff21d2b7d3706d522a"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#ace3cdf55009c3bff21d2b7d3706d522a">oomph::Problem::ntime_stepper</a></div><div class="ttdeci">unsigned ntime_stepper() const</div><div class="ttdoc">Return the number of time steppers.</div><div class="ttdef"><b>Definition:</b> problem.h:1680</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_aed8bc6e7b0bb45b86d5b44737b554d50"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#aed8bc6e7b0bb45b86d5b44737b554d50">oomph::Problem::actions_after_newton_step</a></div><div class="ttdeci">virtual void actions_after_newton_step()</div><div class="ttdef"><b>Definition:</b> problem.h:1058</div></div>
<div class="ttc" id="aclassoomph_1_1TimeStepper_html_a028fa3a8d3c6db6b0ddf580cb0468d55"><div class="ttname"><a href="../../d5/d19/classoomph_1_1TimeStepper.html#a028fa3a8d3c6db6b0ddf580cb0468d55">oomph::TimeStepper::set_weights</a></div><div class="ttdeci">virtual void set_weights()=0</div></div>
<div class="ttc" id="aclassoomph_1_1TimeStepper_html_a2dfb949155ba433066fd69dc427ba1ce"><div class="ttname"><a href="../../d5/d19/classoomph_1_1TimeStepper.html#a2dfb949155ba433066fd69dc427ba1ce">oomph::TimeStepper::set_predictor_weights</a></div><div class="ttdeci">virtual void set_predictor_weights()</div><div class="ttdef"><b>Definition:</b> timesteppers.h:630</div></div>
<div class="ttc" id="aclassoomph_1_1TimeStepper_html_a36cbcee0c1127085ba3aa2331bfc0f74"><div class="ttname"><a href="../../d5/d19/classoomph_1_1TimeStepper.html#a36cbcee0c1127085ba3aa2331bfc0f74">oomph::TimeStepper::actions_before_timestep</a></div><div class="ttdeci">virtual void actions_before_timestep(Problem *problem_pt)</div><div class="ttdef"><b>Definition:</b> timesteppers.h:662</div></div>
<div class="ttc" id="aclassoomph_1_1TimeStepper_html_a3a0fabf83f9bdc89800cd3501df2c586"><div class="ttname"><a href="../../d5/d19/classoomph_1_1TimeStepper.html#a3a0fabf83f9bdc89800cd3501df2c586">oomph::TimeStepper::actions_after_timestep</a></div><div class="ttdeci">virtual void actions_after_timestep(Problem *problem_pt)</div><div class="ttdef"><b>Definition:</b> timesteppers.h:666</div></div>
<div class="ttc" id="aclassoomph_1_1TimeStepper_html_aee0c1da870a603e64efebb51dfc96a3d"><div class="ttname"><a href="../../d5/d19/classoomph_1_1TimeStepper.html#aee0c1da870a603e64efebb51dfc96a3d">oomph::TimeStepper::set_error_weights</a></div><div class="ttdeci">virtual void set_error_weights()</div><div class="ttdef"><b>Definition:</b> timesteppers.h:642</div></div>
<div class="ttc" id="aclassoomph_1_1Time_html_a2c684e0a69db7adde90f1f052e424a6b"><div class="ttname"><a href="../../d0/da1/classoomph_1_1Time.html#a2c684e0a69db7adde90f1f052e424a6b">oomph::Time::dt</a></div><div class="ttdeci">double &amp; dt(const unsigned &amp;t=0)</div><div class="ttdef"><b>Definition:</b> timesteppers.h:136</div></div>
<div class="ttc" id="aclassoomph_1_1Time_html_a6e28ea7a6664a2f5f5e1be871304a2c7"><div class="ttname"><a href="../../d0/da1/classoomph_1_1Time.html#a6e28ea7a6664a2f5f5e1be871304a2c7">oomph::Time::time</a></div><div class="ttdeci">double &amp; time()</div><div class="ttdoc">Return the current value of the continuous time.</div><div class="ttdef"><b>Definition:</b> timesteppers.h:123</div></div>
<div class="ttc" id="adatatypes_8h_html_affe776513b24d84b39af8ab0930fef7f"><div class="ttname"><a href="../../dc/d51/datatypes_8h.html#affe776513b24d84b39af8ab0930fef7f">max</a></div><div class="ttdeci">#define max(a, b)</div><div class="ttdef"><b>Definition:</b> datatypes.h:23</div></div>
<div class="ttc" id="anamespaceEigen_1_1bfloat16__impl_html_aadf08601dbe94964a06487ba453a0436"><div class="ttname"><a href="../../db/d6f/namespaceEigen_1_1bfloat16__impl.html#aadf08601dbe94964a06487ba453a0436">Eigen::bfloat16_impl::pow</a></div><div class="ttdeci">EIGEN_STRONG_INLINE EIGEN_DEVICE_FUNC bfloat16 pow(const bfloat16 &amp;a, const bfloat16 &amp;b)</div><div class="ttdef"><b>Definition:</b> BFloat16.h:625</div></div>
<div class="ttc" id="anamespacecalibrate_html_a4dbebf21da853ac368a3a9af2fbab442"><div class="ttname"><a href="../../d9/d33/namespacecalibrate.html#a4dbebf21da853ac368a3a9af2fbab442">calibrate.error</a></div><div class="ttdeci">int error</div><div class="ttdef"><b>Definition:</b> calibrate.py:297</div></div>
<div class="ttc" id="anamespaceoomph_1_1Global__string__for__annotation_html_ac5379de2fa7fe44f2cb31785fc208135"><div class="ttname"><a href="../../d2/dc3/namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">oomph::Global_string_for_annotation::string</a></div><div class="ttdeci">std::string string(const unsigned &amp;i)</div><div class="ttdef"><b>Definition:</b> oomph_definitions.cc:286</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d8/de9/AnnoyingScalar_8h.html#a0b723dc4b77525f0cc278538ff494e29">abs()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a012692496c968960f4ea27db4e89cc7d">actions_after_implicit_timestep()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a38d914a74e7998ddc74c205884d36d57">actions_after_implicit_timestep_and_error_estimation()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a033ec7301123deeb7e56d04c38f9f1da">actions_after_newton_solve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aed8bc6e7b0bb45b86d5b44737b554d50">actions_after_newton_step()</a>, <a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html#a3a0fabf83f9bdc89800cd3501df2c586">oomph::TimeStepper::actions_after_timestep()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a4f19896906d2c0274ad6798cd3ac38dc">actions_before_implicit_timestep()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae6ad96ddf5d48b517b89c9a9b879bc4b">actions_before_newton_convergence_check()</a>, <a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html#a36cbcee0c1127085ba3aa2331bfc0f74">oomph::TimeStepper::actions_before_timestep()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acbc0b0fc5d5cc76ce8384bc0bd815f26">calculate_predictions()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a74d71439b100fb5b66b94d1d69130f7c">dof()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a17a5a4886c4213422179fe8346336a4e">dof_distribution_pt()</a>, <a class="el" href="../../d0/da1/classoomph_1_1Time.html#a2c684e0a69db7adde90f1f052e424a6b">oomph::Time::dt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aaaeab9469b342a3b849ee5f2ef7051f3">DTSF_max_increase</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#abbb93979ed99d40eb845ba7296355965">DTSF_min_decrease</a>, <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../d5/d34/namespaceoomph_1_1SarahBL.html#a21bfe7e71f0baa62022d1ecc9bd175de">oomph::SarahBL::epsilon</a>, <a class="el" href="../../d9/d33/namespacecalibrate.html#a4dbebf21da853ac368a3a9af2fbab442">calibrate::error</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac7667864b71a3889c95c29307422ac8e">global_temporal_error_norm()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab27af4a444de9f59125ee50ac778d97a">Keep_temporal_error_below_tolerance</a>, <a class="el" href="../../dc/d51/datatypes_8h.html#affe776513b24d84b39af8ab0930fef7f">max</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7b5fde48b00a7fdc5f1fbbee138d0414">Maximum_dt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad7456318933aa01114dc78498bfd6d79">Minimum_dt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#abdee700b2cec37540cf1e7e1462df6c3">Minimum_dt_but_still_proceed</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aae8cf62757e432b625ec81fad1559dc3">newton_solve()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">oomph::LinearAlgebraDistribution::nrow_local()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ace3cdf55009c3bff21d2b7d3706d522a">ntime_stepper()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, <a class="el" href="../../db/d6f/namespaceEigen_1_1bfloat16__impl.html#aadf08601dbe94964a06487ba453a0436">Eigen::bfloat16_impl::pow()</a>, <a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html#aee0c1da870a603e64efebb51dfc96a3d">oomph::TimeStepper::set_error_weights()</a>, <a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html#a2dfb949155ba433066fd69dc427ba1ce">oomph::TimeStepper::set_predictor_weights()</a>, <a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html#a028fa3a8d3c6db6b0ddf580cb0468d55">oomph::TimeStepper::set_weights()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a3d3108a38cfbed4087f5b8eb601f38a2">shift_time_values()</a>, <a class="el" href="../../d2/dc3/namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">oomph::Global_string_for_annotation::string()</a>, <a class="el" href="../../d0/da1/classoomph_1_1Time.html#a6e28ea7a6664a2f5f5e1be871304a2c7">oomph::Time::time()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a3e9aecf88bde320bc2d169b5f3c99fee">Time_adaptive_newton_crash_on_solve_fail</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a46894b13c582f322082dc471a2485980">time_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a359d1936bc2146e0a0ce697776efcf91">Timestep_reduction_factor_after_nonconvergence</a>.</p>

</div>
</div>
<a id="aa3393dfcbf36c6198aead92c08ab95d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3393dfcbf36c6198aead92c08ab95d0">&#9670;&nbsp;</a></span>add_eigenvector_to_dofs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::add_eigenvector_to_dofs </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>epsilon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;&#160;</td>
          <td class="paramname"><em>eigenvector</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add the eigenvector passed to the function scaled by the constat epsilon to the dofs in the problem so that it can be output by the usual routines</p>
<p>Add the eigenvector passed to the function to the dofs with magnitude epsilon </p>
<div class="fragment"><div class="line"><a name="l08749"></a><span class="lineno"> 8749</span>&#160;  {</div>
<div class="line"><a name="l08750"></a><span class="lineno"> 8750</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n_dof = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>();</div>
<div class="line"><a name="l08751"></a><span class="lineno"> 8751</span>&#160;    <span class="comment">// Check that the eigenvector has the correct size</span></div>
<div class="line"><a name="l08752"></a><span class="lineno"> 8752</span>&#160;    <span class="keywordflow">if</span> (eigenvector.nrow() != n_dof)</div>
<div class="line"><a name="l08753"></a><span class="lineno"> 8753</span>&#160;    {</div>
<div class="line"><a name="l08754"></a><span class="lineno"> 8754</span>&#160;      std::ostringstream error_message;</div>
<div class="line"><a name="l08755"></a><span class="lineno"> 8755</span>&#160;      error_message &lt;&lt; <span class="stringliteral">&quot;Eigenvector has size &quot;</span> &lt;&lt; eigenvector.nrow()</div>
<div class="line"><a name="l08756"></a><span class="lineno"> 8756</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;, not equal to the number of dofs in the problem,&quot;</span></div>
<div class="line"><a name="l08757"></a><span class="lineno"> 8757</span>&#160;                    &lt;&lt; n_dof &lt;&lt; std::endl;</div>
<div class="line"><a name="l08758"></a><span class="lineno"> 8758</span>&#160; </div>
<div class="line"><a name="l08759"></a><span class="lineno"> 8759</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l08760"></a><span class="lineno"> 8760</span>&#160;        error_message.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l08761"></a><span class="lineno"> 8761</span>&#160;    }</div>
<div class="line"><a name="l08762"></a><span class="lineno"> 8762</span>&#160; </div>
<div class="line"><a name="l08763"></a><span class="lineno"> 8763</span>&#160;    <span class="comment">// Loop over the dofs and add the eigenvector</span></div>
<div class="line"><a name="l08764"></a><span class="lineno"> 8764</span>&#160;    <span class="comment">// Only use local values</span></div>
<div class="line"><a name="l08765"></a><span class="lineno"> 8765</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; eigenvector.nrow_local(); <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l08766"></a><span class="lineno"> 8766</span>&#160;    {</div>
<div class="line"><a name="l08767"></a><span class="lineno"> 8767</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a74d71439b100fb5b66b94d1d69130f7c">dof</a>(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>) += <a class="code" href="../../d5/d34/namespaceoomph_1_1SarahBL.html#a21bfe7e71f0baa62022d1ecc9bd175de">epsilon</a> * eigenvector[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>];</div>
<div class="line"><a name="l08768"></a><span class="lineno"> 8768</span>&#160;    }</div>
<div class="line"><a name="l08769"></a><span class="lineno"> 8769</span>&#160;<span class="comment">// Of course we now need to synchronise</span></div>
<div class="line"><a name="l08770"></a><span class="lineno"> 8770</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l08771"></a><span class="lineno"> 8771</span>&#160;    this-&gt;synchronise_all_dofs();</div>
<div class="line"><a name="l08772"></a><span class="lineno"> 8772</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l08773"></a><span class="lineno"> 8773</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a74d71439b100fb5b66b94d1d69130f7c">dof()</a>, <a class="el" href="../../d5/d34/namespaceoomph_1_1SarahBL.html#a21bfe7e71f0baa62022d1ecc9bd175de">oomph::SarahBL::epsilon</a>, <a class="el" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a7569556f14fd68b28508920e89bd5eee">oomph::DistributableLinearAlgebraObject::nrow()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">oomph::DistributableLinearAlgebraObject::nrow_local()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, and <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>.</p>

</div>
</div>
<a id="a6f0c24728351d390d4f0a86d07bd8678"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f0c24728351d390d4f0a86d07bd8678">&#9670;&nbsp;</a></span>add_global_data()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Problem::add_global_data </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d8/dc5/classoomph_1_1Data.html">Data</a> *const &amp;&#160;</td>
          <td class="paramname"><em>global_data_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Add Data to the Problem's global data &ndash; the Problem will perform equation numbering etc. for such Data </p>
<div class="fragment"><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;    {</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>.push_back(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae508b2056d532cb8b6eb0dd5c16b9325">global_data_pt</a>);</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1Problem_html_aa963c98e91d135d31cdcfbe1afa64603"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">oomph::Problem::Global_data_pt</a></div><div class="ttdeci">Vector&lt; Data * &gt; Global_data_pt</div><div class="ttdef"><b>Definition:</b> problem.h:425</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_ae508b2056d532cb8b6eb0dd5c16b9325"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#ae508b2056d532cb8b6eb0dd5c16b9325">oomph::Problem::global_data_pt</a></div><div class="ttdeci">Data *&amp; global_data_pt(const unsigned &amp;i)</div><div class="ttdoc">Return a pointer to the the i-th global data object.</div><div class="ttdef"><b>Definition:</b> problem.h:1647</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae508b2056d532cb8b6eb0dd5c16b9325">global_data_pt()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../df/de6/classCapProblem.html#ab03ed8e2c1b44911d11209e00cb28a42">CapProblem&lt; ELEMENT &gt;::CapProblem()</a>, <a class="el" href="../../d2/d06/classElasticRingProblem.html#a46779ff320754561750e22216f7605e3">ElasticRingProblem&lt; ELEMENT &gt;::ElasticRingProblem()</a>, <a class="el" href="../../d9/d2f/classFreeSurfaceRotationProblem.html#ae13ffa99e2bb7a011562929acfd033ec">FreeSurfaceRotationProblem&lt; ELEMENT &gt;::FreeSurfaceRotationProblem()</a>, <a class="el" href="../../d8/d17/classPseudoSolidCapProblem.html#a4ac05a07dd55950bb67f7f79cb9fbb77">PseudoSolidCapProblem&lt; ELEMENT &gt;::PseudoSolidCapProblem()</a>, <a class="el" href="../../d2/d3d/classRefineableRotatingCylinderProblem.html#aa597c4240ce9affbd7540998167c8f21">RefineableRotatingCylinderProblem&lt; ELEMENT &gt;::RefineableRotatingCylinderProblem()</a>, and <a class="el" href="../../d7/d67/classSolidFreeSurfaceRotationProblem.html#aeccfc9698ea6b1ce021224453929691e">SolidFreeSurfaceRotationProblem&lt; ELEMENT &gt;::SolidFreeSurfaceRotationProblem()</a>.</p>

</div>
</div>
<a id="a0cd05109bc2c003c5c0686e6aa55d847"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0cd05109bc2c003c5c0686e6aa55d847">&#9670;&nbsp;</a></span>add_sub_mesh()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> oomph::Problem::add_sub_mesh </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;&#160;</td>
          <td class="paramname"><em>mesh_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Add a submesh to the problem and return its number, i, by which it can be accessed via mesh_pt(i). </p>
<div class="fragment"><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;    {</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab65f6fc9c49860e6324457a7e6e76346">Sub_mesh_pt</a>.push_back(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>);</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab65f6fc9c49860e6324457a7e6e76346">Sub_mesh_pt</a>.size() - 1;</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab65f6fc9c49860e6324457a7e6e76346">Sub_mesh_pt</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../df/d37/classAxisymFreeSurfaceNozzleAdvDiffRobinProblem.html#a146f67b5dfa4b8e11f09ac9e57827077">AxisymFreeSurfaceNozzleAdvDiffRobinProblem&lt; ELEMENT &gt;::AxisymFreeSurfaceNozzleAdvDiffRobinProblem()</a>, <a class="el" href="../../d9/dc5/classoomph_1_1BiharmonicProblem.html#a2ed9f3c94a3609638042089251476bcf">oomph::BiharmonicProblem&lt; DIM &gt;::build_global_mesh_and_assign_eqn_numbers()</a>, <a class="el" href="../../df/de6/classCapProblem.html#ab03ed8e2c1b44911d11209e00cb28a42">CapProblem&lt; ELEMENT &gt;::CapProblem()</a>, <a class="el" href="../../d3/d00/classConvectionProblem.html#ae2ffcac64ed8c4bfcdfdf4aeec0b6f7f">ConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;::ConvectionProblem()</a>, <a class="el" href="../../d4/d8b/classElasticInterfaceProblem.html#ad92614ce2754af8f1cd7080274e43489">ElasticInterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;::ElasticInterfaceProblem()</a>, <a class="el" href="../../de/d9e/classFluxPoissonMGProblem.html#a02a9d4cb72c1a873c4325335a19b8e69">FluxPoissonMGProblem&lt; ELEMENT, MESH &gt;::FluxPoissonMGProblem()</a>, <a class="el" href="../../d9/d2f/classFreeSurfaceRotationProblem.html#ae13ffa99e2bb7a011562929acfd033ec">FreeSurfaceRotationProblem&lt; ELEMENT &gt;::FreeSurfaceRotationProblem()</a>, <a class="el" href="../../dd/d4a/classFSIChannelWithLeafletProblem.html#aaa0a455e91c4fb2dd9696607b802d01b">FSIChannelWithLeafletProblem&lt; ELEMENT &gt;::FSIChannelWithLeafletProblem()</a>, <a class="el" href="../../da/db6/classFSIRingProblem.html#a8f4969c6397bebe8afa2b9285ec908e6">FSIRingProblem::FSIRingProblem()</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ac3f40f62d33d33616cdb4bed48aaccde">oomph::NavierStokesSchurComplementPreconditioner::get_pressure_advection_diffusion_matrix()</a>, <a class="el" href="../../dd/d61/classHomogenisationProblem.html#a1224c22c4b4a4b64277b60d31da3bc52">HomogenisationProblem&lt; ELEMENT &gt;::HomogenisationProblem()</a>, <a class="el" href="../../d9/d15/classInterfaceProblem.html#a2ecc265740dba1626344fc090fad5fa6">InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;::InterfaceProblem()</a>, <a class="el" href="../../dc/da5/classMeltSpinningProblem.html#a860a4d236b8d4cd19558b48082a0c6ee">MeltSpinningProblem&lt; ELEMENT &gt;::MeltSpinningProblem()</a>, <a class="el" href="../../d6/d69/classoomph_1_1NonLinearElasticitySmoothMesh.html#a426905484f20903c02c995b297df36a6">oomph::NonLinearElasticitySmoothMesh&lt; ELEMENT &gt;::operator()()</a>, <a class="el" href="../../dd/d71/classOscRingNStProblem.html#a33023787bdd34ada9fae40f1b32ca339">OscRingNStProblem&lt; ELEMENT &gt;::OscRingNStProblem()</a>, <a class="el" href="../../d5/d62/classPerturbedStateProblem.html#a7fd730e7b1f73e4e9976510021bd488d">PerturbedStateProblem&lt; BASE_ELEMENT, PERTURBED_ELEMENT &gt;::PerturbedStateProblem()</a>, <a class="el" href="../../d8/d17/classPseudoSolidCapProblem.html#a4ac05a07dd55950bb67f7f79cb9fbb77">PseudoSolidCapProblem&lt; ELEMENT &gt;::PseudoSolidCapProblem()</a>, <a class="el" href="../../de/da7/classoomph_1_1SegregatableFSIProblem.html#a61cad9a0a75f2999c0529caa9cac2b73">oomph::SegregatableFSIProblem::rebuild_monolithic_mesh()</a>, <a class="el" href="../../de/d23/classRefineableFishPoissonProblem.html#a2585d906fab348e09bfb9b4c111ac161">RefineableFishPoissonProblem&lt; ELEMENT &gt;::RefineableFishPoissonProblem()</a>, <a class="el" href="../../d2/d3d/classRefineableRotatingCylinderProblem.html#aa597c4240ce9affbd7540998167c8f21">RefineableRotatingCylinderProblem&lt; ELEMENT &gt;::RefineableRotatingCylinderProblem()</a>, <a class="el" href="../../dd/d43/classRefineableTwoMeshFluxPoissonProblem.html#a6568980564c4e39544b1c2bcb71cf3b6">RefineableTwoMeshFluxPoissonProblem&lt; ELEMENT &gt;::RefineableTwoMeshFluxPoissonProblem()</a>, <a class="el" href="../../d4/d68/classRefineableUnsteadyHeatProblem.html#a981eb6e1c3ac8386b02eeef299099d86">RefineableUnsteadyHeatProblem&lt; ELEMENT &gt;::RefineableUnsteadyHeatProblem()</a>, <a class="el" href="../../d7/d67/classSolidFreeSurfaceRotationProblem.html#aeccfc9698ea6b1ce021224453929691e">SolidFreeSurfaceRotationProblem&lt; ELEMENT &gt;::SolidFreeSurfaceRotationProblem()</a>, <a class="el" href="../../d7/d86/classSurfactantProblem.html#a7728f025db0a13dd910db96d6fb66832">SurfactantProblem&lt; ELEMENT, INTERFACE_ELEMENT &gt;::SurfactantProblem()</a>, <a class="el" href="../../d1/dfc/classTurekProblem.html#a69f6624fd854393f0c0e5303603ec749">TurekProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;::TurekProblem()</a>, <a class="el" href="../../db/d16/classTwoMeshFluxAdvectionDiffusionProblem.html#a7f3ec24317465521cb84212d1c2dc662">TwoMeshFluxAdvectionDiffusionProblem&lt; ELEMENT &gt;::TwoMeshFluxAdvectionDiffusionProblem()</a>, <a class="el" href="../../d0/d27/classTwoMeshFluxPoissonProblem.html#ace5a47aa61da5fd2a8761a16ffb3711c">TwoMeshFluxPoissonProblem&lt; ELEMENT &gt;::TwoMeshFluxPoissonProblem()</a>, <a class="el" href="../../d8/d28/classUnsteadyHeatProblem.html#abd3a46eea132b1e5872be6a6309a51b2">UnsteadyHeatProblem&lt; ELEMENT &gt;::UnsteadyHeatProblem()</a>, <a class="el" href="../../df/d77/classUnstructuredFvKProblem.html#ad2c3164bbc76c6ac35e4c090a8784f1e">UnstructuredFvKProblem&lt; ELEMENT &gt;::UnstructuredFvKProblem()</a>, <a class="el" href="../../dc/dff/classUnstructuredSolidProblem.html#a18ce02b6e4bbc86403c9e1b32c095772">UnstructuredSolidProblem&lt; ELEMENT, MESH &gt;::UnstructuredSolidProblem()</a>, <a class="el" href="../../de/da7/classoomph_1_1SegregatableFSIProblem.html#a13a9841e0aa05bf57ec228b49b311a26">oomph::SegregatableFSIProblem::use_only_fluid_elements()</a>, and <a class="el" href="../../de/da7/classoomph_1_1SegregatableFSIProblem.html#a330660bc7b69c9c128bfed62b54dcf62">oomph::SegregatableFSIProblem::use_only_solid_elements()</a>.</p>

</div>
</div>
<a id="a05df1c91c6ccffa24e42fda85af156a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05df1c91c6ccffa24e42fda85af156a1">&#9670;&nbsp;</a></span>add_time_stepper_pt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::add_time_stepper_pt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html">TimeStepper</a> *const &amp;&#160;</td>
          <td class="paramname"><em>time_stepper_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add a timestepper to the problem. The function will automatically create or resize the Time object so that it contains the appropriate number of levels of storage. </p>
<div class="fragment"><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;  {</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;    <span class="comment">// Add the timestepper to the vector</span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#af1e8f8a739453250eb3744fea2a3b983">Time_stepper_pt</a>.push_back(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>);</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160; </div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;    <span class="comment">// Find the number of timesteps required by the timestepper</span></div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;    <span class="keywordtype">unsigned</span> ndt = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>-&gt;<a class="code" href="../../d5/d19/classoomph_1_1TimeStepper.html#a00e57b6436cff4fc82af481b81a78a1a">ndt</a>();</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160; </div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;    <span class="comment">// If time has not been allocated, create time object with the</span></div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;    <span class="comment">// required number of time steps</span></div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae33fbf5f34a7d06d88ad2c98538bbbe8">Time_pt</a> == 0)</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;    {</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae33fbf5f34a7d06d88ad2c98538bbbe8">Time_pt</a> = <span class="keyword">new</span> <a class="code" href="../../da/d66/classTime.html">Time</a>(ndt);</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Created Time with &quot;</span> &lt;&lt; ndt &lt;&lt; <span class="stringliteral">&quot; timesteps&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;    }</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;    {</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;      <span class="comment">// If the required number of time steps is greater than currently stored</span></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;      <span class="comment">// resize the time storage</span></div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;      <span class="keywordflow">if</span> (ndt &gt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae33fbf5f34a7d06d88ad2c98538bbbe8">Time_pt</a>-&gt;<a class="code" href="../../d0/da1/classoomph_1_1Time.html#ad40953c471eb3ce59921e6870ed755f3">ndt</a>())</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;      {</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae33fbf5f34a7d06d88ad2c98538bbbe8">Time_pt</a>-&gt;<a class="code" href="../../d0/da1/classoomph_1_1Time.html#aeab1acb1e182797c4194af84c0583c3f">resize</a>(ndt);</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Resized Time to include &quot;</span> &lt;&lt; ndt &lt;&lt; <span class="stringliteral">&quot; timesteps&quot;</span></div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;                   &lt;&lt; std::endl;</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;      }</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;      <span class="comment">// Otherwise report that we are OK</span></div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;      {</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time object already has storage for &quot;</span> &lt;&lt; ndt</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot; timesteps&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;      }</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;    }</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160; </div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;    <span class="comment">// Pass the pointer to time to the timestepper</span></div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>-&gt;<a class="code" href="../../d5/d19/classoomph_1_1TimeStepper.html#af85e8103c08de76d5a9399d30fc2211c">time_pt</a>() = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae33fbf5f34a7d06d88ad2c98538bbbe8">Time_pt</a>;</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;  }</div>
<div class="ttc" id="aclassTime_html"><div class="ttname"><a href="../../da/d66/classTime.html">Time</a></div><div class="ttdoc">Allows for timing the algorithms; accurate up to 0.01 sec.</div><div class="ttdef"><b>Definition:</b> MercuryTime.h:25</div></div>
<div class="ttc" id="aclassoomph_1_1TimeStepper_html_a00e57b6436cff4fc82af481b81a78a1a"><div class="ttname"><a href="../../d5/d19/classoomph_1_1TimeStepper.html#a00e57b6436cff4fc82af481b81a78a1a">oomph::TimeStepper::ndt</a></div><div class="ttdeci">virtual unsigned ndt() const =0</div><div class="ttdoc">Number of timestep increments that are required by the scheme.</div></div>
<div class="ttc" id="aclassoomph_1_1TimeStepper_html_af85e8103c08de76d5a9399d30fc2211c"><div class="ttname"><a href="../../d5/d19/classoomph_1_1TimeStepper.html#af85e8103c08de76d5a9399d30fc2211c">oomph::TimeStepper::time_pt</a></div><div class="ttdeci">Time *const  &amp; time_pt() const</div><div class="ttdoc">Access function for the pointer to time (const version)</div><div class="ttdef"><b>Definition:</b> timesteppers.h:572</div></div>
<div class="ttc" id="aclassoomph_1_1Time_html_ad40953c471eb3ce59921e6870ed755f3"><div class="ttname"><a href="../../d0/da1/classoomph_1_1Time.html#ad40953c471eb3ce59921e6870ed755f3">oomph::Time::ndt</a></div><div class="ttdeci">unsigned ndt() const</div><div class="ttdoc">Return the number of timesteps stored.</div><div class="ttdef"><b>Definition:</b> timesteppers.h:129</div></div>
<div class="ttc" id="aclassoomph_1_1Time_html_aeab1acb1e182797c4194af84c0583c3f"><div class="ttname"><a href="../../d0/da1/classoomph_1_1Time.html#aeab1acb1e182797c4194af84c0583c3f">oomph::Time::resize</a></div><div class="ttdeci">void resize(const unsigned &amp;n_dt)</div><div class="ttdef"><b>Definition:</b> timesteppers.h:93</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d0/da1/classoomph_1_1Time.html#ad40953c471eb3ce59921e6870ed755f3">oomph::Time::ndt()</a>, <a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html#a00e57b6436cff4fc82af481b81a78a1a">oomph::TimeStepper::ndt()</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, <a class="el" href="../../d0/da1/classoomph_1_1Time.html#aeab1acb1e182797c4194af84c0583c3f">oomph::Time::resize()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae33fbf5f34a7d06d88ad2c98538bbbe8">Time_pt</a>, <a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html#af85e8103c08de76d5a9399d30fc2211c">oomph::TimeStepper::time_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af1e8f8a739453250eb3744fea2a3b983">Time_stepper_pt</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aee0d9902fd26b600c9519bea2dfc0f54">arc_length_step_solve()</a>, <a class="el" href="../../d3/d00/classConvectionProblem.html#ae2ffcac64ed8c4bfcdfdf4aeec0b6f7f">ConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;::ConvectionProblem()</a>, <a class="el" href="../../d4/d8b/classElasticInterfaceProblem.html#ad92614ce2754af8f1cd7080274e43489">ElasticInterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;::ElasticInterfaceProblem()</a>, <a class="el" href="../../d2/d06/classElasticRingProblem.html#a57be33a379c1ec4418a7fb3e8db8ef2b">ElasticRingProblem&lt; ELEMENT &gt;::ElasticRingProblem()</a>, <a class="el" href="../../dc/d83/classFlowAroundCylinderProblem.html#af48274c0e0cf81f60b52c77be3b28601">FlowAroundCylinderProblem&lt; ELEMENT &gt;::FlowAroundCylinderProblem()</a>, <a class="el" href="../../dd/d4a/classFSIChannelWithLeafletProblem.html#aaa0a455e91c4fb2dd9696607b802d01b">FSIChannelWithLeafletProblem&lt; ELEMENT &gt;::FSIChannelWithLeafletProblem()</a>, <a class="el" href="../../da/db6/classFSIRingProblem.html#a8f4969c6397bebe8afa2b9285ec908e6">FSIRingProblem::FSIRingProblem()</a>, <a class="el" href="../../dd/d61/classHomogenisationProblem.html#a1224c22c4b4a4b64277b60d31da3bc52">HomogenisationProblem&lt; ELEMENT &gt;::HomogenisationProblem()</a>, <a class="el" href="../../d9/d15/classInterfaceProblem.html#a2ecc265740dba1626344fc090fad5fa6">InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;::InterfaceProblem()</a>, <a class="el" href="../../d4/db2/classLinearWaveProblem.html#a459a58b7afd588cfa78a5e1e98c3c41e">LinearWaveProblem&lt; ELEMENT, TIMESTEPPER &gt;::LinearWaveProblem()</a>, <a class="el" href="../../dd/d71/classOscRingNStProblem.html#a33023787bdd34ada9fae40f1b32ca339">OscRingNStProblem&lt; ELEMENT &gt;::OscRingNStProblem()</a>, <a class="el" href="../../d5/d62/classPerturbedStateProblem.html#a49c677252dd9ecfdc115a72167663b37">PerturbedStateProblem&lt; BASE_ELEMENT, PERTURBED_ELEMENT &gt;::PerturbedStateProblem()</a>, <a class="el" href="../../d6/da9/classRayleighProblem.html#a870eafe497219141a67fa06246ad41ee">RayleighProblem&lt; ELEMENT, TIMESTEPPER &gt;::RayleighProblem()</a>, <a class="el" href="../../d5/d48/classRefineableActivatorInhibitorProblem.html#ad0d45934b01decd3282fb27ddcc5412d">RefineableActivatorInhibitorProblem&lt; ELEMENT &gt;::RefineableActivatorInhibitorProblem()</a>, <a class="el" href="../../d2/d3d/classRefineableRotatingCylinderProblem.html#aa597c4240ce9affbd7540998167c8f21">RefineableRotatingCylinderProblem&lt; ELEMENT &gt;::RefineableRotatingCylinderProblem()</a>, <a class="el" href="../../d4/d68/classRefineableUnsteadyHeatProblem.html#a894f3bd6c1c23c307a736de6898e4e98">RefineableUnsteadyHeatProblem&lt; ELEMENT &gt;::RefineableUnsteadyHeatProblem()</a>, <a class="el" href="../../d7/d86/classSurfactantProblem.html#a7728f025db0a13dd910db96d6fb66832">SurfactantProblem&lt; ELEMENT, INTERFACE_ELEMENT &gt;::SurfactantProblem()</a>, <a class="el" href="../../d7/dcc/classTurekNonFSIProblem.html#aacb3214544ef81c2f8b49777457e8be6">TurekNonFSIProblem&lt; ELEMENT &gt;::TurekNonFSIProblem()</a>, <a class="el" href="../../d1/dfc/classTurekProblem.html#a69f6624fd854393f0c0e5303603ec749">TurekProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;::TurekProblem()</a>, <a class="el" href="../../d8/d28/classUnsteadyHeatProblem.html#abd3a46eea132b1e5872be6a6309a51b2">UnsteadyHeatProblem&lt; ELEMENT &gt;::UnsteadyHeatProblem()</a>, and <a class="el" href="../../d3/d73/classoomph_1_1WomersleyProblem.html#adc4074cd09df4505feb27e22abb6922a">oomph::WomersleyProblem&lt; ELEMENT, DIM &gt;::WomersleyProblem()</a>.</p>

</div>
</div>
<a id="abb1221f3e6605bf134cc6be3ff297016"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb1221f3e6605bf134cc6be3ff297016">&#9670;&nbsp;</a></span>add_to_dofs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::add_to_dofs </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>lambda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;&#160;</td>
          <td class="paramname"><em>increment_dofs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Add lambda x incremenet_dofs[l] to the l-th dof. </p>
<p>Function that adds the values to the dofs. </p>

<p>Reimplemented from <a class="el" href="../../df/d86/classoomph_1_1ExplicitTimeSteppableObject.html#a00f10d9ad6de867dd72ba175a5f0ec89">oomph::ExplicitTimeSteppableObject</a>.</p>
<div class="fragment"><div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;  {</div>
<div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n_dof = this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>();</div>
<div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l = 0; l &lt; n_dof; l++)</div>
<div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;    {</div>
<div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;      *<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>[l] += <a class="code" href="../../d6/d41/ComplexEigenSolver__compute_8cpp.html#a8a21c18d4aa23228bc1b89f9b12182be">lambda</a> * increment_dofs[l];</div>
<div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;    }</div>
<div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;  }</div>
<div class="ttc" id="aComplexEigenSolver__compute_8cpp_html_a8a21c18d4aa23228bc1b89f9b12182be"><div class="ttname"><a href="../../d6/d41/ComplexEigenSolver__compute_8cpp.html#a8a21c18d4aa23228bc1b89f9b12182be">lambda</a></div><div class="ttdeci">cout&lt;&lt; &quot;The eigenvalues of A are:&quot;&lt;&lt; endl&lt;&lt; ces.eigenvalues()&lt;&lt; endl;cout&lt;&lt; &quot;The matrix of eigenvectors, V, is:&quot;&lt;&lt; endl&lt;&lt; ces.eigenvectors()&lt;&lt; endl&lt;&lt; endl;complex&lt; float &gt; lambda</div><div class="ttdef"><b>Definition:</b> ComplexEigenSolver_compute.cpp:9</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_aa9e4cfff7e1dc295036b0e58bc11ae75"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">oomph::Problem::Dof_pt</a></div><div class="ttdeci">Vector&lt; double * &gt; Dof_pt</div><div class="ttdoc">Vector of pointers to dofs.</div><div class="ttdef"><b>Definition:</b> problem.h:554</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>, <a class="el" href="../../d6/d41/ComplexEigenSolver__compute_8cpp.html#a8a21c18d4aa23228bc1b89f9b12182be">lambda</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof()</a>.</p>

</div>
</div>
<a id="a2f4cbf8b8f2df704ae80f28c01914ddb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f4cbf8b8f2df704ae80f28c01914ddb">&#9670;&nbsp;</a></span>arc_length_step_solve() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> Problem::arc_length_step_solve </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d8/dc5/classoomph_1_1Data.html">Data</a> *const &amp;&#160;</td>
          <td class="paramname"><em>data_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>data_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>ds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>max_adapt</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Solve a steady problem using arc-length continuation, when the variable corresponding to the arc-length constraint equation is already stored in data used in the problem: data_pt is a pointer to the appropriate data object, data_index is the index of the value that will be traded for the constriant, ds is the desired arc_length and max_adapt is the maximum number of spatial adaptations (default zero, no adaptation). Note that the value must be pinned in order for this formulation to work</p>
<p>This function takes one step of length ds in pseudo-arclength.The argument data_pt is a pointer to the data that holds the parameter (global variable) that is being traded for arc-length. The exact value is located at the location given by data_index. The function returns the next desired arc-length according to criteria based upon the desired number of Newton Iterations per solve. </p>
<div class="fragment"><div class="line"><a name="l10386"></a><span class="lineno">10386</span>&#160;  {</div>
<div class="line"><a name="l10387"></a><span class="lineno">10387</span>&#160;    <span class="comment">// Firstly check that the data is pinned</span></div>
<div class="line"><a name="l10388"></a><span class="lineno">10388</span>&#160;    <span class="keywordflow">if</span> (!data_pt-&gt;is_pinned(data_index))</div>
<div class="line"><a name="l10389"></a><span class="lineno">10389</span>&#160;    {</div>
<div class="line"><a name="l10390"></a><span class="lineno">10390</span>&#160;      std::ostringstream error_stream;</div>
<div class="line"><a name="l10391"></a><span class="lineno">10391</span>&#160;      error_stream &lt;&lt; <span class="stringliteral">&quot;The value at index &quot;</span> &lt;&lt; data_index</div>
<div class="line"><a name="l10392"></a><span class="lineno">10392</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot; in the data object to be used for continuation\n&quot;</span></div>
<div class="line"><a name="l10393"></a><span class="lineno">10393</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;is not pinned, which means that it is already a\n&quot;</span></div>
<div class="line"><a name="l10394"></a><span class="lineno">10394</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;variable in the problem &quot;</span></div>
<div class="line"><a name="l10395"></a><span class="lineno">10395</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;and cannot be used for continuation.\n\n&quot;</span></div>
<div class="line"><a name="l10396"></a><span class="lineno">10396</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;Please correct your formulation by either:\n&quot;</span></div>
<div class="line"><a name="l10397"></a><span class="lineno">10397</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;A. Pinning the value&quot;</span></div>
<div class="line"><a name="l10398"></a><span class="lineno">10398</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;\n or \n&quot;</span></div>
<div class="line"><a name="l10399"></a><span class="lineno">10399</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;B. Using a different parameter for continuation&quot;</span></div>
<div class="line"><a name="l10400"></a><span class="lineno">10400</span>&#160;                   &lt;&lt; std::endl;</div>
<div class="line"><a name="l10401"></a><span class="lineno">10401</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l10402"></a><span class="lineno">10402</span>&#160;        error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l10403"></a><span class="lineno">10403</span>&#160;    }</div>
<div class="line"><a name="l10404"></a><span class="lineno">10404</span>&#160; </div>
<div class="line"><a name="l10405"></a><span class="lineno">10405</span>&#160; </div>
<div class="line"><a name="l10406"></a><span class="lineno">10406</span>&#160;    <span class="comment">// If we are using the continuation timestepper</span></div>
<div class="line"><a name="l10407"></a><span class="lineno">10407</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#adbecce0cb1bd7b6b21285568e41ee3eb">Use_continuation_timestepper</a>)</div>
<div class="line"><a name="l10408"></a><span class="lineno">10408</span>&#160;    {</div>
<div class="line"><a name="l10409"></a><span class="lineno">10409</span>&#160;      <span class="comment">// Has the timestepper already been added to the problem</span></div>
<div class="line"><a name="l10410"></a><span class="lineno">10410</span>&#160;      <span class="keywordtype">bool</span> continuation_time_stepper_added = <span class="keyword">false</span>;</div>
<div class="line"><a name="l10411"></a><span class="lineno">10411</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_time_steppers = this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ace3cdf55009c3bff21d2b7d3706d522a">ntime_stepper</a>();</div>
<div class="line"><a name="l10412"></a><span class="lineno">10412</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_time_steppers; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l10413"></a><span class="lineno">10413</span>&#160;      {</div>
<div class="line"><a name="l10414"></a><span class="lineno">10414</span>&#160;        <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) == &amp;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a4c24860f29d64935db86ce5778c7a794">Continuation_time_stepper</a>)</div>
<div class="line"><a name="l10415"></a><span class="lineno">10415</span>&#160;        {</div>
<div class="line"><a name="l10416"></a><span class="lineno">10416</span>&#160;          continuation_time_stepper_added = <span class="keyword">true</span>;</div>
<div class="line"><a name="l10417"></a><span class="lineno">10417</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l10418"></a><span class="lineno">10418</span>&#160;        }</div>
<div class="line"><a name="l10419"></a><span class="lineno">10419</span>&#160;      }</div>
<div class="line"><a name="l10420"></a><span class="lineno">10420</span>&#160; </div>
<div class="line"><a name="l10421"></a><span class="lineno">10421</span>&#160;      <span class="comment">// If not add it</span></div>
<div class="line"><a name="l10422"></a><span class="lineno">10422</span>&#160;      <span class="keywordflow">if</span> (!continuation_time_stepper_added)</div>
<div class="line"><a name="l10423"></a><span class="lineno">10423</span>&#160;      {</div>
<div class="line"><a name="l10424"></a><span class="lineno">10424</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Adding the continuation time stepper\n&quot;</span>;</div>
<div class="line"><a name="l10425"></a><span class="lineno">10425</span>&#160;        this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a05df1c91c6ccffa24e42fda85af156a1">add_time_stepper_pt</a>(&amp;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a4c24860f29d64935db86ce5778c7a794">Continuation_time_stepper</a>);</div>
<div class="line"><a name="l10426"></a><span class="lineno">10426</span>&#160;      }</div>
<div class="line"><a name="l10427"></a><span class="lineno">10427</span>&#160; </div>
<div class="line"><a name="l10428"></a><span class="lineno">10428</span>&#160;      <span class="comment">// Need to treat case of eigenproblems and bifurcation detection/tracking</span></div>
<div class="line"><a name="l10429"></a><span class="lineno">10429</span>&#160;      <span class="comment">// here</span></div>
<div class="line"><a name="l10430"></a><span class="lineno">10430</span>&#160; </div>
<div class="line"><a name="l10431"></a><span class="lineno">10431</span>&#160; </div>
<div class="line"><a name="l10432"></a><span class="lineno">10432</span>&#160;      <span class="comment">// Backup the current timesteppers for each mesh!</span></div>
<div class="line"><a name="l10433"></a><span class="lineno">10433</span>&#160; </div>
<div class="line"><a name="l10434"></a><span class="lineno">10434</span>&#160; </div>
<div class="line"><a name="l10435"></a><span class="lineno">10435</span>&#160;      <span class="comment">// If an arc length step has not been taken then set the timestepper</span></div>
<div class="line"><a name="l10436"></a><span class="lineno">10436</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a8109bf56e9203d248ae30a50bb9cfe90">Arc_length_step_taken</a>)</div>
<div class="line"><a name="l10437"></a><span class="lineno">10437</span>&#160;      {</div>
<div class="line"><a name="l10438"></a><span class="lineno">10438</span>&#160;        <span class="comment">// Set the continuation timestepper for all data in the problem</span></div>
<div class="line"><a name="l10439"></a><span class="lineno">10439</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a50d54d4b374ea6a8d76798f34b865944">set_timestepper_for_all_data</a>(</div>
<div class="line"><a name="l10440"></a><span class="lineno">10440</span>&#160;                        &amp;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a4c24860f29d64935db86ce5778c7a794">Continuation_time_stepper</a>)</div>
<div class="line"><a name="l10441"></a><span class="lineno">10441</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot; equation numbers allocated for continuation\n&quot;</span>;</div>
<div class="line"><a name="l10442"></a><span class="lineno">10442</span>&#160;      }</div>
<div class="line"><a name="l10443"></a><span class="lineno">10443</span>&#160; </div>
<div class="line"><a name="l10444"></a><span class="lineno">10444</span>&#160; </div>
<div class="line"><a name="l10445"></a><span class="lineno">10445</span>&#160;    } <span class="comment">// End of continuation time stepper case</span></div>
<div class="line"><a name="l10446"></a><span class="lineno">10446</span>&#160; </div>
<div class="line"><a name="l10447"></a><span class="lineno">10447</span>&#160; </div>
<div class="line"><a name="l10448"></a><span class="lineno">10448</span>&#160;    <span class="comment">// Now make a pointer to the (newly allocated) data object</span></div>
<div class="line"><a name="l10449"></a><span class="lineno">10449</span>&#160;    <span class="keywordtype">double</span>* parameter_pt = data_pt-&gt;value_pt(data_index);</div>
<div class="line"><a name="l10450"></a><span class="lineno">10450</span>&#160;    <span class="comment">// Call the helper function, this will change the parameter_pt if</span></div>
<div class="line"><a name="l10451"></a><span class="lineno">10451</span>&#160;    <span class="comment">// the data storage is changed (if the timestepper has to be changed,</span></div>
<div class="line"><a name="l10452"></a><span class="lineno">10452</span>&#160;    <span class="comment">// which happens if this is the first time that a continuation step is</span></div>
<div class="line"><a name="l10453"></a><span class="lineno">10453</span>&#160;    <span class="comment">// taken)</span></div>
<div class="line"><a name="l10454"></a><span class="lineno">10454</span>&#160;    <span class="comment">// ALH: Don&#39;t think this is true because it has happened above....</span></div>
<div class="line"><a name="l10455"></a><span class="lineno">10455</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#acc35de219c1c1032a14840021fd8a6b9">arc_length_step_solve_helper</a>(parameter_pt, ds, max_adapt);</div>
<div class="line"><a name="l10456"></a><span class="lineno">10456</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a4c24860f29d64935db86ce5778c7a794"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a4c24860f29d64935db86ce5778c7a794">oomph::Problem::Continuation_time_stepper</a></div><div class="ttdeci">static ContinuationStorageScheme Continuation_time_stepper</div><div class="ttdoc">Storage for the single static continuation timestorage object.</div><div class="ttdef"><b>Definition:</b> problem.h:761</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a50d54d4b374ea6a8d76798f34b865944"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a50d54d4b374ea6a8d76798f34b865944">oomph::Problem::set_timestepper_for_all_data</a></div><div class="ttdeci">unsigned long set_timestepper_for_all_data(TimeStepper *const &amp;time_stepper_pt, const bool &amp;preserve_existing_data=false)</div><div class="ttdef"><b>Definition:</b> problem.cc:11572</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_acc35de219c1c1032a14840021fd8a6b9"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#acc35de219c1c1032a14840021fd8a6b9">oomph::Problem::arc_length_step_solve_helper</a></div><div class="ttdeci">double arc_length_step_solve_helper(double *const &amp;parameter_pt, const double &amp;ds, const unsigned &amp;max_adapt)</div><div class="ttdef"><b>Definition:</b> problem.cc:10515</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a05df1c91c6ccffa24e42fda85af156a1">add_time_stepper_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acc35de219c1c1032a14840021fd8a6b9">arc_length_step_solve_helper()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a8109bf56e9203d248ae30a50bb9cfe90">Arc_length_step_taken</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a4c24860f29d64935db86ce5778c7a794">Continuation_time_stepper</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../d8/dc5/classoomph_1_1Data.html#aedd0c445396ddcd650c814d17fef77dc">oomph::Data::is_pinned()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ace3cdf55009c3bff21d2b7d3706d522a">ntime_stepper()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a50d54d4b374ea6a8d76798f34b865944">set_timestepper_for_all_data()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#adbecce0cb1bd7b6b21285568e41ee3eb">Use_continuation_timestepper</a>, and <a class="el" href="../../d8/dc5/classoomph_1_1Data.html#a559dc196abee87cad34d655c8d6dac1e">oomph::Data::value_pt()</a>.</p>

</div>
</div>
<a id="aee0d9902fd26b600c9519bea2dfc0f54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee0d9902fd26b600c9519bea2dfc0f54">&#9670;&nbsp;</a></span>arc_length_step_solve() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> Problem::arc_length_step_solve </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;&#160;</td>
          <td class="paramname"><em>parameter_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>ds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>max_adapt</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Solve a steady problem using arc-length continuation, when the parameter that becomes a variable corresponding to the arc-length constraint equation is an external double: parameter_pt is a pointer to that double, ds is the desired arc_length and max_adapt is the maximum number of spatial adaptations (default zero, no adaptation).</p>
<p>This function takes one step of length ds in pseudo-arclength.The argument parameter_pt is a pointer to the parameter (global variable) that is being traded for arc-length. The function returns the next desired arc-length according to criteria based upon the desired number of Newton Iterations per solve. </p>
<div class="fragment"><div class="line"><a name="l10297"></a><span class="lineno">10297</span>&#160;  {</div>
<div class="line"><a name="l10298"></a><span class="lineno">10298</span>&#160;    <span class="comment">// First check that we shouldn&#39;t use the other interface</span></div>
<div class="line"><a name="l10299"></a><span class="lineno">10299</span>&#160;    <span class="comment">// by checking that the parameter isn&#39;t already stored as data</span></div>
<div class="line"><a name="l10300"></a><span class="lineno">10300</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a75fe4a89f7dccbd72a67333b3959539d">does_pointer_correspond_to_problem_data</a>(parameter_pt))</div>
<div class="line"><a name="l10301"></a><span class="lineno">10301</span>&#160;    {</div>
<div class="line"><a name="l10302"></a><span class="lineno">10302</span>&#160;      std::ostringstream error_message;</div>
<div class="line"><a name="l10303"></a><span class="lineno">10303</span>&#160;      error_message</div>
<div class="line"><a name="l10304"></a><span class="lineno">10304</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;The parameter addressed by &quot;</span> &lt;&lt; parameter_pt &lt;&lt; <span class="stringliteral">&quot; with the value &quot;</span></div>
<div class="line"><a name="l10305"></a><span class="lineno">10305</span>&#160;        &lt;&lt; *parameter_pt</div>
<div class="line"><a name="l10306"></a><span class="lineno">10306</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;\n is supposed to be used for arc-length contiunation,\n&quot;</span></div>
<div class="line"><a name="l10307"></a><span class="lineno">10307</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; but it is stored in a Data object used by the problem.\n\n&quot;</span></div>
<div class="line"><a name="l10308"></a><span class="lineno">10308</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;This is bad for two reasons:\n&quot;</span></div>
<div class="line"><a name="l10309"></a><span class="lineno">10309</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;1. If it&#39;s a variable in the problem, it must already have an\n&quot;</span></div>
<div class="line"><a name="l10310"></a><span class="lineno">10310</span>&#160;           <span class="stringliteral">&quot;associated equation, so it can&#39;t be used for continuation;\n&quot;</span></div>
<div class="line"><a name="l10311"></a><span class="lineno">10311</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;2. The problem data will be reorganised in memory during &quot;</span></div>
<div class="line"><a name="l10312"></a><span class="lineno">10312</span>&#160;           <span class="stringliteral">&quot;continuation,\n&quot;</span></div>
<div class="line"><a name="l10313"></a><span class="lineno">10313</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;   which means that the pointer will become invalid.\n\n&quot;</span></div>
<div class="line"><a name="l10314"></a><span class="lineno">10314</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;If you are sure that this is what you want to do you must:\n&quot;</span></div>
<div class="line"><a name="l10315"></a><span class="lineno">10315</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;A. Ensure that the value is pinned (don&#39;t worry we&#39;ll shout again &quot;</span></div>
<div class="line"><a name="l10316"></a><span class="lineno">10316</span>&#160;           <span class="stringliteral">&quot;if not)\n&quot;</span></div>
<div class="line"><a name="l10317"></a><span class="lineno">10317</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;B. Use the alternative interface\n&quot;</span></div>
<div class="line"><a name="l10318"></a><span class="lineno">10318</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;   Problem::arc_length_step_solve(Data*,unsigned,...)\n&quot;</span></div>
<div class="line"><a name="l10319"></a><span class="lineno">10319</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;   which uses a pointer to the data object and not the raw double &quot;</span></div>
<div class="line"><a name="l10320"></a><span class="lineno">10320</span>&#160;           <span class="stringliteral">&quot;pointer.&quot;</span></div>
<div class="line"><a name="l10321"></a><span class="lineno">10321</span>&#160;        &lt;&lt; std::endl;</div>
<div class="line"><a name="l10322"></a><span class="lineno">10322</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l10323"></a><span class="lineno">10323</span>&#160;        error_message.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l10324"></a><span class="lineno">10324</span>&#160;    }</div>
<div class="line"><a name="l10325"></a><span class="lineno">10325</span>&#160; </div>
<div class="line"><a name="l10326"></a><span class="lineno">10326</span>&#160; </div>
<div class="line"><a name="l10327"></a><span class="lineno">10327</span>&#160;    <span class="comment">// If we are using the continuation timestepper</span></div>
<div class="line"><a name="l10328"></a><span class="lineno">10328</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#adbecce0cb1bd7b6b21285568e41ee3eb">Use_continuation_timestepper</a>)</div>
<div class="line"><a name="l10329"></a><span class="lineno">10329</span>&#160;    {</div>
<div class="line"><a name="l10330"></a><span class="lineno">10330</span>&#160;      <span class="comment">// Has the timestepper already been added to the problem</span></div>
<div class="line"><a name="l10331"></a><span class="lineno">10331</span>&#160;      <span class="keywordtype">bool</span> continuation_time_stepper_added = <span class="keyword">false</span>;</div>
<div class="line"><a name="l10332"></a><span class="lineno">10332</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_time_steppers = this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ace3cdf55009c3bff21d2b7d3706d522a">ntime_stepper</a>();</div>
<div class="line"><a name="l10333"></a><span class="lineno">10333</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_time_steppers; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l10334"></a><span class="lineno">10334</span>&#160;      {</div>
<div class="line"><a name="l10335"></a><span class="lineno">10335</span>&#160;        <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) == &amp;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a4c24860f29d64935db86ce5778c7a794">Continuation_time_stepper</a>)</div>
<div class="line"><a name="l10336"></a><span class="lineno">10336</span>&#160;        {</div>
<div class="line"><a name="l10337"></a><span class="lineno">10337</span>&#160;          continuation_time_stepper_added = <span class="keyword">true</span>;</div>
<div class="line"><a name="l10338"></a><span class="lineno">10338</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l10339"></a><span class="lineno">10339</span>&#160;        }</div>
<div class="line"><a name="l10340"></a><span class="lineno">10340</span>&#160;      }</div>
<div class="line"><a name="l10341"></a><span class="lineno">10341</span>&#160; </div>
<div class="line"><a name="l10342"></a><span class="lineno">10342</span>&#160;      <span class="comment">// If not add it</span></div>
<div class="line"><a name="l10343"></a><span class="lineno">10343</span>&#160;      <span class="keywordflow">if</span> (!continuation_time_stepper_added)</div>
<div class="line"><a name="l10344"></a><span class="lineno">10344</span>&#160;      {</div>
<div class="line"><a name="l10345"></a><span class="lineno">10345</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Adding the continuation time stepper\n&quot;</span>;</div>
<div class="line"><a name="l10346"></a><span class="lineno">10346</span>&#160;        this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a05df1c91c6ccffa24e42fda85af156a1">add_time_stepper_pt</a>(&amp;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a4c24860f29d64935db86ce5778c7a794">Continuation_time_stepper</a>);</div>
<div class="line"><a name="l10347"></a><span class="lineno">10347</span>&#160;      }</div>
<div class="line"><a name="l10348"></a><span class="lineno">10348</span>&#160; </div>
<div class="line"><a name="l10349"></a><span class="lineno">10349</span>&#160;      <span class="comment">// Need to treat case of eigenproblems and bifurcation detection/tracking</span></div>
<div class="line"><a name="l10350"></a><span class="lineno">10350</span>&#160;      <span class="comment">// here</span></div>
<div class="line"><a name="l10351"></a><span class="lineno">10351</span>&#160; </div>
<div class="line"><a name="l10352"></a><span class="lineno">10352</span>&#160;      <span class="comment">// Backup the current timesteppers for each mesh!</span></div>
<div class="line"><a name="l10353"></a><span class="lineno">10353</span>&#160; </div>
<div class="line"><a name="l10354"></a><span class="lineno">10354</span>&#160; </div>
<div class="line"><a name="l10355"></a><span class="lineno">10355</span>&#160;      <span class="comment">// If an arc length step has not been taken then set the timestepper</span></div>
<div class="line"><a name="l10356"></a><span class="lineno">10356</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a8109bf56e9203d248ae30a50bb9cfe90">Arc_length_step_taken</a>)</div>
<div class="line"><a name="l10357"></a><span class="lineno">10357</span>&#160;      {</div>
<div class="line"><a name="l10358"></a><span class="lineno">10358</span>&#160;        <span class="comment">// Set the continuation timestepper for all data in the problem</span></div>
<div class="line"><a name="l10359"></a><span class="lineno">10359</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a50d54d4b374ea6a8d76798f34b865944">set_timestepper_for_all_data</a>(</div>
<div class="line"><a name="l10360"></a><span class="lineno">10360</span>&#160;                        &amp;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a4c24860f29d64935db86ce5778c7a794">Continuation_time_stepper</a>)</div>
<div class="line"><a name="l10361"></a><span class="lineno">10361</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot; equation numbers allocated for continuation\n&quot;</span>;</div>
<div class="line"><a name="l10362"></a><span class="lineno">10362</span>&#160;      }</div>
<div class="line"><a name="l10363"></a><span class="lineno">10363</span>&#160; </div>
<div class="line"><a name="l10364"></a><span class="lineno">10364</span>&#160;    } <span class="comment">// End of continuation time stepper case</span></div>
<div class="line"><a name="l10365"></a><span class="lineno">10365</span>&#160; </div>
<div class="line"><a name="l10366"></a><span class="lineno">10366</span>&#160; </div>
<div class="line"><a name="l10367"></a><span class="lineno">10367</span>&#160;    <span class="comment">// Just call the helper function (parameter is not from data)</span></div>
<div class="line"><a name="l10368"></a><span class="lineno">10368</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#acc35de219c1c1032a14840021fd8a6b9">arc_length_step_solve_helper</a>(parameter_pt, ds, max_adapt);</div>
<div class="line"><a name="l10369"></a><span class="lineno">10369</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a75fe4a89f7dccbd72a67333b3959539d"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a75fe4a89f7dccbd72a67333b3959539d">oomph::Problem::does_pointer_correspond_to_problem_data</a></div><div class="ttdeci">bool does_pointer_correspond_to_problem_data(double *const &amp;parameter_pt)</div><div class="ttdef"><b>Definition:</b> problem.cc:9846</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a05df1c91c6ccffa24e42fda85af156a1">add_time_stepper_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acc35de219c1c1032a14840021fd8a6b9">arc_length_step_solve_helper()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a8109bf56e9203d248ae30a50bb9cfe90">Arc_length_step_taken</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a4c24860f29d64935db86ce5778c7a794">Continuation_time_stepper</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a75fe4a89f7dccbd72a67333b3959539d">does_pointer_correspond_to_problem_data()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ace3cdf55009c3bff21d2b7d3706d522a">ntime_stepper()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a50d54d4b374ea6a8d76798f34b865944">set_timestepper_for_all_data()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#adbecce0cb1bd7b6b21285568e41ee3eb">Use_continuation_timestepper</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/d67/classContinuationProblem.html#aec4c7c69bc55331cbacd89efb0141501">ContinuationProblem::solve()</a>.</p>

</div>
</div>
<a id="acc35de219c1c1032a14840021fd8a6b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc35de219c1c1032a14840021fd8a6b9">&#9670;&nbsp;</a></span>arc_length_step_solve_helper()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> Problem::arc_length_step_solve_helper </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;&#160;</td>
          <td class="paramname"><em>parameter_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>ds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>max_adapt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Private helper function that actually contains the guts of the arc-length stepping, parameter_pt is a pointer to the parameter that is traded for the arc-length constraint, ds is the desired arc length and max_adapt is the maximum number of spatial adaptations. The pointer to the parameter may be changed if this is called from the Data-based interface</p>
<p>This function takes one step of length ds in pseudo-arclength.The argument parameter_pt is a pointer to the parameter (global variable) that is being traded for arc-length. The function returns the next desired arc-length according to criteria based upon the desired number of Newton Iterations per solve. </p>
<p>end of adaptation loop</p>
<div class="fragment"><div class="line"><a name="l10518"></a><span class="lineno">10518</span>&#160;  {</div>
<div class="line"><a name="l10519"></a><span class="lineno">10519</span>&#160;    <span class="comment">//----------------------MAKE THE PROBLEM STEADY-----------------------</span></div>
<div class="line"><a name="l10520"></a><span class="lineno">10520</span>&#160;    <span class="comment">// Loop over the timesteppers and make them (temporarily) steady.</span></div>
<div class="line"><a name="l10521"></a><span class="lineno">10521</span>&#160;    <span class="comment">// We can only do continuation for steady problems!</span></div>
<div class="line"><a name="l10522"></a><span class="lineno">10522</span>&#160;    <span class="keywordtype">unsigned</span> n_time_steppers = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ace3cdf55009c3bff21d2b7d3706d522a">ntime_stepper</a>();</div>
<div class="line"><a name="l10523"></a><span class="lineno">10523</span>&#160;    <span class="comment">// Vector of bools to store the is_steady status of the various</span></div>
<div class="line"><a name="l10524"></a><span class="lineno">10524</span>&#160;    <span class="comment">// timesteppers when we came in here</span></div>
<div class="line"><a name="l10525"></a><span class="lineno">10525</span>&#160;    std::vector&lt;bool&gt; was_steady(n_time_steppers);</div>
<div class="line"><a name="l10526"></a><span class="lineno">10526</span>&#160; </div>
<div class="line"><a name="l10527"></a><span class="lineno">10527</span>&#160;    <span class="comment">// Loop over them all and make them (temporarily) static</span></div>
<div class="line"><a name="l10528"></a><span class="lineno">10528</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_time_steppers; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l10529"></a><span class="lineno">10529</span>&#160;    {</div>
<div class="line"><a name="l10530"></a><span class="lineno">10530</span>&#160;      was_steady[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)-&gt;<a class="code" href="../../d5/d19/classoomph_1_1TimeStepper.html#ad341ba9e80265e1c26c1cda0f40c8292">is_steady</a>();</div>
<div class="line"><a name="l10531"></a><span class="lineno">10531</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)-&gt;<a class="code" href="../../d5/d19/classoomph_1_1TimeStepper.html#a81ea0ff2e66cef5e0184b616c608e418">make_steady</a>();</div>
<div class="line"><a name="l10532"></a><span class="lineno">10532</span>&#160;    }</div>
<div class="line"><a name="l10533"></a><span class="lineno">10533</span>&#160; </div>
<div class="line"><a name="l10534"></a><span class="lineno">10534</span>&#160; </div>
<div class="line"><a name="l10535"></a><span class="lineno">10535</span>&#160;    <span class="comment">// Max number of solves</span></div>
<div class="line"><a name="l10536"></a><span class="lineno">10536</span>&#160;    <span class="keywordtype">unsigned</span> max_solve = max_adapt + 1;</div>
<div class="line"><a name="l10537"></a><span class="lineno">10537</span>&#160;    <span class="comment">// Storage for newton steps in each adaptation</span></div>
<div class="line"><a name="l10538"></a><span class="lineno">10538</span>&#160;    <span class="keywordtype">unsigned</span> max_count_in_adapt_loop = 0;</div>
<div class="line"><a name="l10539"></a><span class="lineno">10539</span>&#160; </div>
<div class="line"><a name="l10540"></a><span class="lineno">10540</span>&#160; </div>
<div class="line"><a name="l10541"></a><span class="lineno">10541</span>&#160;    <span class="comment">//----SET UP MEMORY FOR QUANTITIES THAT ARE REQUIRED OUTSIDE THE LOOP----</span></div>
<div class="line"><a name="l10542"></a><span class="lineno">10542</span>&#160; </div>
<div class="line"><a name="l10543"></a><span class="lineno">10543</span>&#160;    <span class="comment">// Assign memory for solutions of the equations Jz = du/dparameter</span></div>
<div class="line"><a name="l10544"></a><span class="lineno">10544</span>&#160;    <span class="comment">// This is needed here (outside the loop), so that we can save on</span></div>
<div class="line"><a name="l10545"></a><span class="lineno">10545</span>&#160;    <span class="comment">// one linear solve when calculating the derivatives wrt the arc-length</span></div>
<div class="line"><a name="l10546"></a><span class="lineno">10546</span>&#160;    <a class="code" href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a> z;</div>
<div class="line"><a name="l10547"></a><span class="lineno">10547</span>&#160; </div>
<div class="line"><a name="l10548"></a><span class="lineno">10548</span>&#160; </div>
<div class="line"><a name="l10549"></a><span class="lineno">10549</span>&#160;    <span class="comment">// Store sign of the Jacobian, used for bifurcation detection</span></div>
<div class="line"><a name="l10550"></a><span class="lineno">10550</span>&#160;    <span class="comment">// If this is the first time that we are calling the arc-length solver,</span></div>
<div class="line"><a name="l10551"></a><span class="lineno">10551</span>&#160;    <span class="comment">// this should not be used.</span></div>
<div class="line"><a name="l10552"></a><span class="lineno">10552</span>&#160;    <span class="keywordtype">int</span> previous_sign = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aca97d61840e46edc914e3cb4b98fd437">Sign_of_jacobian</a>;</div>
<div class="line"><a name="l10553"></a><span class="lineno">10553</span>&#160; </div>
<div class="line"><a name="l10554"></a><span class="lineno">10554</span>&#160;    <span class="comment">// Flag to indicate a sign change</span></div>
<div class="line"><a name="l10555"></a><span class="lineno">10555</span>&#160;    <span class="keywordtype">bool</span> SIGN_CHANGE = <span class="keyword">false</span>;</div>
<div class="line"><a name="l10556"></a><span class="lineno">10556</span>&#160; </div>
<div class="line"><a name="l10557"></a><span class="lineno">10557</span>&#160; </div>
<div class="line"><a name="l10558"></a><span class="lineno">10558</span>&#160;    <span class="comment">// Adaptation loop</span></div>
<div class="line"><a name="l10559"></a><span class="lineno">10559</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> isolve = 0; isolve &lt; max_solve; ++isolve)</div>
<div class="line"><a name="l10560"></a><span class="lineno">10560</span>&#160;    {</div>
<div class="line"><a name="l10561"></a><span class="lineno">10561</span>&#160;      <span class="comment">// Only adapt after the first solve has been done</span></div>
<div class="line"><a name="l10562"></a><span class="lineno">10562</span>&#160;      <span class="keywordflow">if</span> (isolve &gt; 0)</div>
<div class="line"><a name="l10563"></a><span class="lineno">10563</span>&#160;      {</div>
<div class="line"><a name="l10564"></a><span class="lineno">10564</span>&#160;        <span class="keywordtype">unsigned</span> n_refined;</div>
<div class="line"><a name="l10565"></a><span class="lineno">10565</span>&#160;        <span class="keywordtype">unsigned</span> n_unrefined;</div>
<div class="line"><a name="l10566"></a><span class="lineno">10566</span>&#160; </div>
<div class="line"><a name="l10567"></a><span class="lineno">10567</span>&#160;        <span class="comment">// Adapt problem</span></div>
<div class="line"><a name="l10568"></a><span class="lineno">10568</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a0b9e09ddfa2411f14fc723c3207decd1">adapt</a>(n_refined, n_unrefined);</div>
<div class="line"><a name="l10569"></a><span class="lineno">10569</span>&#160; </div>
<div class="line"><a name="l10570"></a><span class="lineno">10570</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l10571"></a><span class="lineno">10571</span>&#160;        <span class="comment">// Adaptation only converges if ALL the processes have no</span></div>
<div class="line"><a name="l10572"></a><span class="lineno">10572</span>&#160;        <span class="comment">// refinement or unrefinement to perform</span></div>
<div class="line"><a name="l10573"></a><span class="lineno">10573</span>&#160;        <span class="keywordtype">unsigned</span> total_refined = 0;</div>
<div class="line"><a name="l10574"></a><span class="lineno">10574</span>&#160;        <span class="keywordtype">unsigned</span> total_unrefined = 0;</div>
<div class="line"><a name="l10575"></a><span class="lineno">10575</span>&#160;        <span class="keywordflow">if</span> (Problem_has_been_distributed)</div>
<div class="line"><a name="l10576"></a><span class="lineno">10576</span>&#160;        {</div>
<div class="line"><a name="l10577"></a><span class="lineno">10577</span>&#160;          MPI_Allreduce(&amp;n_refined,</div>
<div class="line"><a name="l10578"></a><span class="lineno">10578</span>&#160;                        &amp;total_refined,</div>
<div class="line"><a name="l10579"></a><span class="lineno">10579</span>&#160;                        1,</div>
<div class="line"><a name="l10580"></a><span class="lineno">10580</span>&#160;                        MPI_UNSIGNED,</div>
<div class="line"><a name="l10581"></a><span class="lineno">10581</span>&#160;                        MPI_SUM,</div>
<div class="line"><a name="l10582"></a><span class="lineno">10582</span>&#160;                        this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">communicator_pt</a>()-&gt;mpi_comm());</div>
<div class="line"><a name="l10583"></a><span class="lineno">10583</span>&#160;          n_refined = total_refined;</div>
<div class="line"><a name="l10584"></a><span class="lineno">10584</span>&#160;          MPI_Allreduce(&amp;n_unrefined,</div>
<div class="line"><a name="l10585"></a><span class="lineno">10585</span>&#160;                        &amp;total_unrefined,</div>
<div class="line"><a name="l10586"></a><span class="lineno">10586</span>&#160;                        1,</div>
<div class="line"><a name="l10587"></a><span class="lineno">10587</span>&#160;                        MPI_UNSIGNED,</div>
<div class="line"><a name="l10588"></a><span class="lineno">10588</span>&#160;                        MPI_SUM,</div>
<div class="line"><a name="l10589"></a><span class="lineno">10589</span>&#160;                        this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">communicator_pt</a>()-&gt;mpi_comm());</div>
<div class="line"><a name="l10590"></a><span class="lineno">10590</span>&#160;          n_unrefined = total_unrefined;</div>
<div class="line"><a name="l10591"></a><span class="lineno">10591</span>&#160;        }</div>
<div class="line"><a name="l10592"></a><span class="lineno">10592</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l10593"></a><span class="lineno">10593</span>&#160; </div>
<div class="line"><a name="l10594"></a><span class="lineno">10594</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;---&gt; &quot;</span> &lt;&lt; n_refined &lt;&lt; <span class="stringliteral">&quot; elements were refined, and &quot;</span></div>
<div class="line"><a name="l10595"></a><span class="lineno">10595</span>&#160;                   &lt;&lt; n_unrefined &lt;&lt; <span class="stringliteral">&quot; were unrefined&quot;</span></div>
<div class="line"><a name="l10596"></a><span class="lineno">10596</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l10597"></a><span class="lineno">10597</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;, in total (over all processors).\n&quot;</span>;</div>
<div class="line"><a name="l10598"></a><span class="lineno">10598</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l10599"></a><span class="lineno">10599</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;.\n&quot;</span>;</div>
<div class="line"><a name="l10600"></a><span class="lineno">10600</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l10601"></a><span class="lineno">10601</span>&#160; </div>
<div class="line"><a name="l10602"></a><span class="lineno">10602</span>&#160; </div>
<div class="line"><a name="l10603"></a><span class="lineno">10603</span>&#160;        <span class="comment">// Check convergence of adaptation cycle</span></div>
<div class="line"><a name="l10604"></a><span class="lineno">10604</span>&#160;        <span class="keywordflow">if</span> ((n_refined == 0) &amp;&amp; (n_unrefined == 0))</div>
<div class="line"><a name="l10605"></a><span class="lineno">10605</span>&#160;        {</div>
<div class="line"><a name="l10606"></a><span class="lineno">10606</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;\n \n Solution is fully converged in &quot;</span></div>
<div class="line"><a name="l10607"></a><span class="lineno">10607</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;Problem::newton_solver(). \n \n &quot;</span>;</div>
<div class="line"><a name="l10608"></a><span class="lineno">10608</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l10609"></a><span class="lineno">10609</span>&#160;        }</div>
<div class="line"><a name="l10610"></a><span class="lineno">10610</span>&#160;      }</div>
<div class="line"><a name="l10611"></a><span class="lineno">10611</span>&#160; </div>
<div class="line"><a name="l10612"></a><span class="lineno">10612</span>&#160;      <span class="comment">//----------SAVE THE INITIAL VALUES, IN CASE THE STEP FAILS-----------</span></div>
<div class="line"><a name="l10613"></a><span class="lineno">10613</span>&#160; </div>
<div class="line"><a name="l10614"></a><span class="lineno">10614</span>&#160;      <span class="comment">// Find the number of local dofs</span></div>
<div class="line"><a name="l10615"></a><span class="lineno">10615</span>&#160;      <span class="keywordtype">unsigned</span> ndof_local = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">nrow_local</a>();</div>
<div class="line"><a name="l10616"></a><span class="lineno">10616</span>&#160; </div>
<div class="line"><a name="l10617"></a><span class="lineno">10617</span>&#160;      <span class="comment">// Only need to do this in the first loop</span></div>
<div class="line"><a name="l10618"></a><span class="lineno">10618</span>&#160;      <span class="keywordflow">if</span> (isolve == 0)</div>
<div class="line"><a name="l10619"></a><span class="lineno">10619</span>&#160;      {</div>
<div class="line"><a name="l10620"></a><span class="lineno">10620</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#adbecce0cb1bd7b6b21285568e41ee3eb">Use_continuation_timestepper</a>)</div>
<div class="line"><a name="l10621"></a><span class="lineno">10621</span>&#160;        {</div>
<div class="line"><a name="l10622"></a><span class="lineno">10622</span>&#160;          <span class="comment">// Safety check, set up the array of dof derivatives, if necessary</span></div>
<div class="line"><a name="l10623"></a><span class="lineno">10623</span>&#160;          <span class="comment">// The distribution is the same as the (natural) distribution of the</span></div>
<div class="line"><a name="l10624"></a><span class="lineno">10624</span>&#160;          <span class="comment">// dofs</span></div>
<div class="line"><a name="l10625"></a><span class="lineno">10625</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a1861321b2d129707935bf1191238daca">Dof_derivative</a>.size() != ndof_local)</div>
<div class="line"><a name="l10626"></a><span class="lineno">10626</span>&#160;          {</div>
<div class="line"><a name="l10627"></a><span class="lineno">10627</span>&#160;            <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a1861321b2d129707935bf1191238daca">Dof_derivative</a>.resize(ndof_local, 0.0);</div>
<div class="line"><a name="l10628"></a><span class="lineno">10628</span>&#160;          }</div>
<div class="line"><a name="l10629"></a><span class="lineno">10629</span>&#160; </div>
<div class="line"><a name="l10630"></a><span class="lineno">10630</span>&#160;          <span class="comment">// Safety check, set up the array of curren values, if necessary</span></div>
<div class="line"><a name="l10631"></a><span class="lineno">10631</span>&#160;          <span class="comment">// Again the distribution reflects the (natural) distribution of the</span></div>
<div class="line"><a name="l10632"></a><span class="lineno">10632</span>&#160;          <span class="comment">// dofs</span></div>
<div class="line"><a name="l10633"></a><span class="lineno">10633</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a366b50c490e9fd3ddafa05b2fbd0b883">Dof_current</a>.size() != ndof_local)</div>
<div class="line"><a name="l10634"></a><span class="lineno">10634</span>&#160;          {</div>
<div class="line"><a name="l10635"></a><span class="lineno">10635</span>&#160;            <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a366b50c490e9fd3ddafa05b2fbd0b883">Dof_current</a>.resize(ndof_local);</div>
<div class="line"><a name="l10636"></a><span class="lineno">10636</span>&#160;          }</div>
<div class="line"><a name="l10637"></a><span class="lineno">10637</span>&#160;        }</div>
<div class="line"><a name="l10638"></a><span class="lineno">10638</span>&#160; </div>
<div class="line"><a name="l10639"></a><span class="lineno">10639</span>&#160;        <span class="comment">// Save the current value of the parameter</span></div>
<div class="line"><a name="l10640"></a><span class="lineno">10640</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a8e29673eb80559888d1c6148c4f11e57">Parameter_current</a> = *parameter_pt;</div>
<div class="line"><a name="l10641"></a><span class="lineno">10641</span>&#160; </div>
<div class="line"><a name="l10642"></a><span class="lineno">10642</span>&#160;        <span class="comment">// Save the current values of the degrees of freedom</span></div>
<div class="line"><a name="l10643"></a><span class="lineno">10643</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l = 0; l &lt; ndof_local; l++)</div>
<div class="line"><a name="l10644"></a><span class="lineno">10644</span>&#160;        {</div>
<div class="line"><a name="l10645"></a><span class="lineno">10645</span>&#160;          <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a10fd6457ceceb02a0e11d860ac0017c5">dof_current</a>(l) = *<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>[l];</div>
<div class="line"><a name="l10646"></a><span class="lineno">10646</span>&#160;        }</div>
<div class="line"><a name="l10647"></a><span class="lineno">10647</span>&#160; </div>
<div class="line"><a name="l10648"></a><span class="lineno">10648</span>&#160;        <span class="comment">// Set the value of ds_current</span></div>
<div class="line"><a name="l10649"></a><span class="lineno">10649</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad412d49617d0b0998e5eb440c7a20f3f">Ds_current</a> = ds;</div>
<div class="line"><a name="l10650"></a><span class="lineno">10650</span>&#160;      }</div>
<div class="line"><a name="l10651"></a><span class="lineno">10651</span>&#160; </div>
<div class="line"><a name="l10652"></a><span class="lineno">10652</span>&#160;      <span class="comment">// Counter for the number of newton steps</span></div>
<div class="line"><a name="l10653"></a><span class="lineno">10653</span>&#160;      <span class="keywordtype">unsigned</span> count = 0;</div>
<div class="line"><a name="l10654"></a><span class="lineno">10654</span>&#160; </div>
<div class="line"><a name="l10655"></a><span class="lineno">10655</span>&#160;      <span class="comment">// Flag to indicate a successful step</span></div>
<div class="line"><a name="l10656"></a><span class="lineno">10656</span>&#160;      <span class="keywordtype">bool</span> STEP_REJECTED = <span class="keyword">false</span>;</div>
<div class="line"><a name="l10657"></a><span class="lineno">10657</span>&#160; </div>
<div class="line"><a name="l10658"></a><span class="lineno">10658</span>&#160; </div>
<div class="line"><a name="l10659"></a><span class="lineno">10659</span>&#160;      <span class="comment">// Set the appropriate initial conditions for the pinned data</span></div>
<div class="line"><a name="l10660"></a><span class="lineno">10660</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#adbecce0cb1bd7b6b21285568e41ee3eb">Use_continuation_timestepper</a>)</div>
<div class="line"><a name="l10661"></a><span class="lineno">10661</span>&#160;      {</div>
<div class="line"><a name="l10662"></a><span class="lineno">10662</span>&#160;        this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae78e313f1dc3bc956f42a5d0bd06c459">set_consistent_pinned_values_for_continuation</a>();</div>
<div class="line"><a name="l10663"></a><span class="lineno">10663</span>&#160;      }</div>
<div class="line"><a name="l10664"></a><span class="lineno">10664</span>&#160; </div>
<div class="line"><a name="l10665"></a><span class="lineno">10665</span>&#160;      <span class="comment">// Loop around the step in arc-length</span></div>
<div class="line"><a name="l10666"></a><span class="lineno">10666</span>&#160;      <span class="keywordflow">do</span></div>
<div class="line"><a name="l10667"></a><span class="lineno">10667</span>&#160;      {</div>
<div class="line"><a name="l10668"></a><span class="lineno">10668</span>&#160;        <span class="comment">// Check that the step has not fallen below the minimum tolerance</span></div>
<div class="line"><a name="l10669"></a><span class="lineno">10669</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">std::fabs</a>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad412d49617d0b0998e5eb440c7a20f3f">Ds_current</a>) &lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad0f8bb126a4f5ddeb559c23a8d451d8d">Minimum_ds</a>)</div>
<div class="line"><a name="l10670"></a><span class="lineno">10670</span>&#160;        {</div>
<div class="line"><a name="l10671"></a><span class="lineno">10671</span>&#160;          std::ostringstream error_message;</div>
<div class="line"><a name="l10672"></a><span class="lineno">10672</span>&#160;          error_message &lt;&lt; <span class="stringliteral">&quot;DESIRED ARC-LENGTH STEP &quot;</span> &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad412d49617d0b0998e5eb440c7a20f3f">Ds_current</a></div>
<div class="line"><a name="l10673"></a><span class="lineno">10673</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot; HAS FALLEN BELOW MINIMUM TOLERANCE, &quot;</span> &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad0f8bb126a4f5ddeb559c23a8d451d8d">Minimum_ds</a></div>
<div class="line"><a name="l10674"></a><span class="lineno">10674</span>&#160;                        &lt;&lt; std::endl;</div>
<div class="line"><a name="l10675"></a><span class="lineno">10675</span>&#160; </div>
<div class="line"><a name="l10676"></a><span class="lineno">10676</span>&#160;          <span class="keywordflow">throw</span> OomphLibError(error_message.str(),</div>
<div class="line"><a name="l10677"></a><span class="lineno">10677</span>&#160;                              <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l10678"></a><span class="lineno">10678</span>&#160;                              <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l10679"></a><span class="lineno">10679</span>&#160;        }</div>
<div class="line"><a name="l10680"></a><span class="lineno">10680</span>&#160; </div>
<div class="line"><a name="l10681"></a><span class="lineno">10681</span>&#160;        <span class="comment">// Assume that we shall accept the step</span></div>
<div class="line"><a name="l10682"></a><span class="lineno">10682</span>&#160;        STEP_REJECTED = <span class="keyword">false</span>;</div>
<div class="line"><a name="l10683"></a><span class="lineno">10683</span>&#160; </div>
<div class="line"><a name="l10684"></a><span class="lineno">10684</span>&#160;        <span class="comment">// Set initial value of the parameter</span></div>
<div class="line"><a name="l10685"></a><span class="lineno">10685</span>&#160;        *parameter_pt = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a8e29673eb80559888d1c6148c4f11e57">Parameter_current</a> + <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa5082325ca4cafe5a9ec03ef79c67a6f">Parameter_derivative</a> * <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad412d49617d0b0998e5eb440c7a20f3f">Ds_current</a>;</div>
<div class="line"><a name="l10686"></a><span class="lineno">10686</span>&#160; </div>
<div class="line"><a name="l10687"></a><span class="lineno">10687</span>&#160;        <span class="comment">// Perform any actions...</span></div>
<div class="line"><a name="l10688"></a><span class="lineno">10688</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a54e18ddf6073f9debd478f6b21a717de">actions_after_parameter_increase</a>(parameter_pt);</div>
<div class="line"><a name="l10689"></a><span class="lineno">10689</span>&#160; </div>
<div class="line"><a name="l10690"></a><span class="lineno">10690</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad412d49617d0b0998e5eb440c7a20f3f">Ds_current</a> = (*parameter_pt - <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a8e29673eb80559888d1c6148c4f11e57">Parameter_current</a>) / <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa5082325ca4cafe5a9ec03ef79c67a6f">Parameter_derivative</a>;</div>
<div class="line"><a name="l10691"></a><span class="lineno">10691</span>&#160; </div>
<div class="line"><a name="l10692"></a><span class="lineno">10692</span>&#160;        <span class="comment">// Loop over the (local) variables and set their initial values</span></div>
<div class="line"><a name="l10693"></a><span class="lineno">10693</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l = 0; l &lt; ndof_local; l++)</div>
<div class="line"><a name="l10694"></a><span class="lineno">10694</span>&#160;        {</div>
<div class="line"><a name="l10695"></a><span class="lineno">10695</span>&#160;          *<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>[l] = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a10fd6457ceceb02a0e11d860ac0017c5">dof_current</a>(l) + <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad6df5fb0d282f25df1e94a665dd838e5">dof_derivative</a>(l) * <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad412d49617d0b0998e5eb440c7a20f3f">Ds_current</a>;</div>
<div class="line"><a name="l10696"></a><span class="lineno">10696</span>&#160;        }</div>
<div class="line"><a name="l10697"></a><span class="lineno">10697</span>&#160; </div>
<div class="line"><a name="l10698"></a><span class="lineno">10698</span>&#160;        <span class="comment">// Actually do the newton solve stage for the continuation problem</span></div>
<div class="line"><a name="l10699"></a><span class="lineno">10699</span>&#160;        <span class="keywordflow">try</span></div>
<div class="line"><a name="l10700"></a><span class="lineno">10700</span>&#160;        {</div>
<div class="line"><a name="l10701"></a><span class="lineno">10701</span>&#160;          count = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a07c5f8686a484837a8856efe3024a52c">newton_solve_continuation</a>(parameter_pt, z);</div>
<div class="line"><a name="l10702"></a><span class="lineno">10702</span>&#160;        }</div>
<div class="line"><a name="l10703"></a><span class="lineno">10703</span>&#160;        <span class="comment">// Catch any exceptions thrown in the Newton solver</span></div>
<div class="line"><a name="l10704"></a><span class="lineno">10704</span>&#160;        <span class="keywordflow">catch</span> (NewtonSolverError&amp; <a class="code" href="../../d9/d33/namespacecalibrate.html#a4dbebf21da853ac368a3a9af2fbab442">error</a>)</div>
<div class="line"><a name="l10705"></a><span class="lineno">10705</span>&#160;        {</div>
<div class="line"><a name="l10706"></a><span class="lineno">10706</span>&#160;          <span class="comment">// Check whether it&#39;s the linear solver</span></div>
<div class="line"><a name="l10707"></a><span class="lineno">10707</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d9/d33/namespacecalibrate.html#a4dbebf21da853ac368a3a9af2fbab442">error</a>.linear_solver_error)</div>
<div class="line"><a name="l10708"></a><span class="lineno">10708</span>&#160;          {</div>
<div class="line"><a name="l10709"></a><span class="lineno">10709</span>&#160;            std::ostringstream error_stream;</div>
<div class="line"><a name="l10710"></a><span class="lineno">10710</span>&#160;            error_stream &lt;&lt; std::endl</div>
<div class="line"><a name="l10711"></a><span class="lineno">10711</span>&#160;                         &lt;&lt; <span class="stringliteral">&quot;USER-DEFINED ERROR IN NEWTON SOLVER &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l10712"></a><span class="lineno">10712</span>&#160;            <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;ERROR IN THE LINEAR SOLVER&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l10713"></a><span class="lineno">10713</span>&#160;            <span class="keywordflow">throw</span> OomphLibError(error_stream.str(),</div>
<div class="line"><a name="l10714"></a><span class="lineno">10714</span>&#160;                                <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l10715"></a><span class="lineno">10715</span>&#160;                                <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l10716"></a><span class="lineno">10716</span>&#160;          }</div>
<div class="line"><a name="l10717"></a><span class="lineno">10717</span>&#160;          <span class="comment">// Otherwise mark the step as having failed</span></div>
<div class="line"><a name="l10718"></a><span class="lineno">10718</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l10719"></a><span class="lineno">10719</span>&#160;          {</div>
<div class="line"><a name="l10720"></a><span class="lineno">10720</span>&#160;            <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;STEP REJECTED --- TRYING AGAIN&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l10721"></a><span class="lineno">10721</span>&#160;            STEP_REJECTED = <span class="keyword">true</span>;</div>
<div class="line"><a name="l10722"></a><span class="lineno">10722</span>&#160;            <span class="comment">// Let&#39;s take a smaller step</span></div>
<div class="line"><a name="l10723"></a><span class="lineno">10723</span>&#160;            <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad412d49617d0b0998e5eb440c7a20f3f">Ds_current</a> *= (2.0 / 3.0);</div>
<div class="line"><a name="l10724"></a><span class="lineno">10724</span>&#160;          }</div>
<div class="line"><a name="l10725"></a><span class="lineno">10725</span>&#160;        }</div>
<div class="line"><a name="l10726"></a><span class="lineno">10726</span>&#160;      } <span class="keywordflow">while</span> (STEP_REJECTED); <span class="comment">// continue until a step is accepted</span></div>
<div class="line"><a name="l10727"></a><span class="lineno">10727</span>&#160; </div>
<div class="line"><a name="l10728"></a><span class="lineno">10728</span>&#160;      <span class="comment">// Set the maximum count</span></div>
<div class="line"><a name="l10729"></a><span class="lineno">10729</span>&#160;      <span class="keywordflow">if</span> (count &gt; max_count_in_adapt_loop)</div>
<div class="line"><a name="l10730"></a><span class="lineno">10730</span>&#160;      {</div>
<div class="line"><a name="l10731"></a><span class="lineno">10731</span>&#160;        max_count_in_adapt_loop = count;</div>
<div class="line"><a name="l10732"></a><span class="lineno">10732</span>&#160;      }</div>
<div class="line"><a name="l10733"></a><span class="lineno">10733</span>&#160;    } </div>
<div class="line"><a name="l10734"></a><span class="lineno">10734</span>&#160; </div>
<div class="line"><a name="l10735"></a><span class="lineno">10735</span>&#160;    <span class="comment">// Only recalculate the derivatives if there has been a Newton solve</span></div>
<div class="line"><a name="l10736"></a><span class="lineno">10736</span>&#160;    <span class="comment">// If not, the previous values should be close enough</span></div>
<div class="line"><a name="l10737"></a><span class="lineno">10737</span>&#160;    <span class="keywordflow">if</span> (max_count_in_adapt_loop &gt; 0)</div>
<div class="line"><a name="l10738"></a><span class="lineno">10738</span>&#160;    {</div>
<div class="line"><a name="l10739"></a><span class="lineno">10739</span>&#160;      <span class="comment">//--------------------CHECK FOR POTENTIAL BIFURCATIONS-------------</span></div>
<div class="line"><a name="l10740"></a><span class="lineno">10740</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a08dfc704030bb65cea3d9784c5271af0">Bifurcation_detection</a>)</div>
<div class="line"><a name="l10741"></a><span class="lineno">10741</span>&#160;      {</div>
<div class="line"><a name="l10742"></a><span class="lineno">10742</span>&#160;        <span class="comment">// If the sign of the jacobian is zero issue a warning</span></div>
<div class="line"><a name="l10743"></a><span class="lineno">10743</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aca97d61840e46edc914e3cb4b98fd437">Sign_of_jacobian</a> == 0)</div>
<div class="line"><a name="l10744"></a><span class="lineno">10744</span>&#160;        {</div>
<div class="line"><a name="l10745"></a><span class="lineno">10745</span>&#160;          <a class="code" href="../../d2/dc3/namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">std::string</a> error_message =</div>
<div class="line"><a name="l10746"></a><span class="lineno">10746</span>&#160;            <span class="stringliteral">&quot;The sign of the jacobian is zero after a linear solve\n&quot;</span>;</div>
<div class="line"><a name="l10747"></a><span class="lineno">10747</span>&#160;          error_message += <span class="stringliteral">&quot;Either the matrix is singular (unlikely),\n&quot;</span>;</div>
<div class="line"><a name="l10748"></a><span class="lineno">10748</span>&#160;          error_message += <span class="stringliteral">&quot;or the linear solver cannot compute the &quot;</span></div>
<div class="line"><a name="l10749"></a><span class="lineno">10749</span>&#160;                           <span class="stringliteral">&quot;determinant of the matrix;\n&quot;</span>;</div>
<div class="line"><a name="l10750"></a><span class="lineno">10750</span>&#160;          error_message += <span class="stringliteral">&quot;e.g. an iterative linear solver.\n&quot;</span>;</div>
<div class="line"><a name="l10751"></a><span class="lineno">10751</span>&#160;          error_message +=</div>
<div class="line"><a name="l10752"></a><span class="lineno">10752</span>&#160;            <span class="stringliteral">&quot;If the latter, bifurcation detection must be via an eigensolver\n&quot;</span>;</div>
<div class="line"><a name="l10753"></a><span class="lineno">10753</span>&#160;          OomphLibWarning(error_message,</div>
<div class="line"><a name="l10754"></a><span class="lineno">10754</span>&#160;                          <span class="stringliteral">&quot;Problem::arc_length_step_solve&quot;</span>,</div>
<div class="line"><a name="l10755"></a><span class="lineno">10755</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l10756"></a><span class="lineno">10756</span>&#160;        }</div>
<div class="line"><a name="l10757"></a><span class="lineno">10757</span>&#160;        <span class="comment">// If this is the first step, we cannot rely on the previous value</span></div>
<div class="line"><a name="l10758"></a><span class="lineno">10758</span>&#160;        <span class="comment">// of the jacobian so set the previous sign to the present sign</span></div>
<div class="line"><a name="l10759"></a><span class="lineno">10759</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a8109bf56e9203d248ae30a50bb9cfe90">Arc_length_step_taken</a>)</div>
<div class="line"><a name="l10760"></a><span class="lineno">10760</span>&#160;        {</div>
<div class="line"><a name="l10761"></a><span class="lineno">10761</span>&#160;          previous_sign = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aca97d61840e46edc914e3cb4b98fd437">Sign_of_jacobian</a>;</div>
<div class="line"><a name="l10762"></a><span class="lineno">10762</span>&#160;        }</div>
<div class="line"><a name="l10763"></a><span class="lineno">10763</span>&#160;        <span class="comment">// If we have detected a sign change in the last converged Jacobian,</span></div>
<div class="line"><a name="l10764"></a><span class="lineno">10764</span>&#160;        <span class="comment">// it must be a turning point or bifurcation</span></div>
<div class="line"><a name="l10765"></a><span class="lineno">10765</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aca97d61840e46edc914e3cb4b98fd437">Sign_of_jacobian</a> != previous_sign)</div>
<div class="line"><a name="l10766"></a><span class="lineno">10766</span>&#160;        {</div>
<div class="line"><a name="l10767"></a><span class="lineno">10767</span>&#160;          <span class="comment">// There has been, at least, one sign change</span></div>
<div class="line"><a name="l10768"></a><span class="lineno">10768</span>&#160;          <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a643f61299463a3bbf7be3f6a112aa130">First_jacobian_sign_change</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l10769"></a><span class="lineno">10769</span>&#160; </div>
<div class="line"><a name="l10770"></a><span class="lineno">10770</span>&#160;          <span class="comment">// The sign has changed this time</span></div>
<div class="line"><a name="l10771"></a><span class="lineno">10771</span>&#160;          SIGN_CHANGE = <span class="keyword">true</span>;</div>
<div class="line"><a name="l10772"></a><span class="lineno">10772</span>&#160; </div>
<div class="line"><a name="l10773"></a><span class="lineno">10773</span>&#160;          <span class="comment">// Calculate the dot product of the approximate null vector</span></div>
<div class="line"><a name="l10774"></a><span class="lineno">10774</span>&#160;          <span class="comment">// of the Jacobian matrix ((badly) approximated by z)</span></div>
<div class="line"><a name="l10775"></a><span class="lineno">10775</span>&#160;          <span class="comment">// and the vectors of derivatives of the residuals wrt the</span></div>
<div class="line"><a name="l10776"></a><span class="lineno">10776</span>&#160;          <span class="comment">// global parameter</span></div>
<div class="line"><a name="l10777"></a><span class="lineno">10777</span>&#160;          <span class="comment">// If this is small it is a bifurcation rather than a turning point.</span></div>
<div class="line"><a name="l10778"></a><span class="lineno">10778</span>&#160;          <span class="comment">// Get the derivative wrt global parameter</span></div>
<div class="line"><a name="l10779"></a><span class="lineno">10779</span>&#160;          <span class="comment">// DoubleVector dparam;</span></div>
<div class="line"><a name="l10780"></a><span class="lineno">10780</span>&#160;          <span class="comment">// get_derivative_wrt_global_parameter(parameter_pt,dparam);</span></div>
<div class="line"><a name="l10781"></a><span class="lineno">10781</span>&#160;          <span class="comment">// Calculate the dot product</span></div>
<div class="line"><a name="l10782"></a><span class="lineno">10782</span>&#160;          <span class="comment">// double dot=0.0;</span></div>
<div class="line"><a name="l10783"></a><span class="lineno">10783</span>&#160;          <span class="comment">// for(unsigned long n=0;n&lt;n_dofs;++n) {dot += dparam[n]*z[n];}</span></div>
<div class="line"><a name="l10784"></a><span class="lineno">10784</span>&#160;          <span class="comment">// z.dot(dparam);</span></div>
<div class="line"><a name="l10785"></a><span class="lineno">10785</span>&#160; </div>
<div class="line"><a name="l10786"></a><span class="lineno">10786</span>&#160;          <span class="comment">// Write the output message</span></div>
<div class="line"><a name="l10787"></a><span class="lineno">10787</span>&#160;          std::ostringstream message;</div>
<div class="line"><a name="l10788"></a><span class="lineno">10788</span>&#160;          message</div>
<div class="line"><a name="l10789"></a><span class="lineno">10789</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------------------------&quot;</span>;</div>
<div class="line"><a name="l10790"></a><span class="lineno">10790</span>&#160;          message &lt;&lt; std::endl</div>
<div class="line"><a name="l10791"></a><span class="lineno">10791</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;SIGN CHANGE IN DETERMINANT OF JACOBIAN: &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l10792"></a><span class="lineno">10792</span>&#160;          message &lt;&lt; <span class="stringliteral">&quot;BIFURCATION OR TURNING POINT DETECTED BETWEEN &quot;</span></div>
<div class="line"><a name="l10793"></a><span class="lineno">10793</span>&#160;                  &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a8e29673eb80559888d1c6148c4f11e57">Parameter_current</a> &lt;&lt; <span class="stringliteral">&quot; AND &quot;</span> &lt;&lt; *parameter_pt &lt;&lt; std::endl;</div>
<div class="line"><a name="l10794"></a><span class="lineno">10794</span>&#160;          <span class="comment">// message &lt;&lt; &quot;APPROXIMATE DOT PRODUCT : &quot; &lt;&lt; dot &lt;&lt; &quot;,&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l10795"></a><span class="lineno">10795</span>&#160;          <span class="comment">// message &lt;&lt; &quot;IF CLOSE TO ZERO WE HAVE A BIFURCATION; &quot;;</span></div>
<div class="line"><a name="l10796"></a><span class="lineno">10796</span>&#160;          <span class="comment">// message &lt;&lt; &quot;OTHERWISE A TURNING POINT&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l10797"></a><span class="lineno">10797</span>&#160;          message</div>
<div class="line"><a name="l10798"></a><span class="lineno">10798</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------------------------&quot;</span></div>
<div class="line"><a name="l10799"></a><span class="lineno">10799</span>&#160;            &lt;&lt; std::endl;</div>
<div class="line"><a name="l10800"></a><span class="lineno">10800</span>&#160; </div>
<div class="line"><a name="l10801"></a><span class="lineno">10801</span>&#160;          <span class="comment">// Write the message to standard output</span></div>
<div class="line"><a name="l10802"></a><span class="lineno">10802</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; message.str();</div>
<div class="line"><a name="l10803"></a><span class="lineno">10803</span>&#160; </div>
<div class="line"><a name="l10804"></a><span class="lineno">10804</span>&#160;          <span class="comment">// Open the information file for appending</span></div>
<div class="line"><a name="l10805"></a><span class="lineno">10805</span>&#160;          std::ofstream bifurcation_info(<span class="stringliteral">&quot;bifurcation_info&quot;</span>,</div>
<div class="line"><a name="l10806"></a><span class="lineno">10806</span>&#160;                                         std::ios_base::app);</div>
<div class="line"><a name="l10807"></a><span class="lineno">10807</span>&#160;          <span class="comment">// Write the message to the file</span></div>
<div class="line"><a name="l10808"></a><span class="lineno">10808</span>&#160;          bifurcation_info &lt;&lt; message.str();</div>
<div class="line"><a name="l10809"></a><span class="lineno">10809</span>&#160;          bifurcation_info.close();</div>
<div class="line"><a name="l10810"></a><span class="lineno">10810</span>&#160;        }</div>
<div class="line"><a name="l10811"></a><span class="lineno">10811</span>&#160;      }</div>
<div class="line"><a name="l10812"></a><span class="lineno">10812</span>&#160; </div>
<div class="line"><a name="l10813"></a><span class="lineno">10813</span>&#160;      <span class="comment">// Calculate the derivatives required for the next stage of continuation</span></div>
<div class="line"><a name="l10814"></a><span class="lineno">10814</span>&#160;      <span class="comment">// In this we pass the last value of z (i.e. approximation)</span></div>
<div class="line"><a name="l10815"></a><span class="lineno">10815</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a80dac9f70c77302805bb782cc6f1ad0f">Use_finite_differences_for_continuation_derivatives</a>)</div>
<div class="line"><a name="l10816"></a><span class="lineno">10816</span>&#160;      {</div>
<div class="line"><a name="l10817"></a><span class="lineno">10817</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a83463b9e0d3ebf86085c48c0e98c8f10">calculate_continuation_derivatives</a>(z);</div>
<div class="line"><a name="l10818"></a><span class="lineno">10818</span>&#160;      }</div>
<div class="line"><a name="l10819"></a><span class="lineno">10819</span>&#160;      <span class="comment">// Or use finite differences</span></div>
<div class="line"><a name="l10820"></a><span class="lineno">10820</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l10821"></a><span class="lineno">10821</span>&#160;      {</div>
<div class="line"><a name="l10822"></a><span class="lineno">10822</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a8978d65572c5ae81f7381fa6a6d56ba0">calculate_continuation_derivatives_fd</a>(parameter_pt);</div>
<div class="line"><a name="l10823"></a><span class="lineno">10823</span>&#160;      }</div>
<div class="line"><a name="l10824"></a><span class="lineno">10824</span>&#160; </div>
<div class="line"><a name="l10825"></a><span class="lineno">10825</span>&#160;      <span class="comment">// If it&#39;s the first step then the value of the next step should</span></div>
<div class="line"><a name="l10826"></a><span class="lineno">10826</span>&#160;      <span class="comment">// be the change in parameter divided by the parameter derivative</span></div>
<div class="line"><a name="l10827"></a><span class="lineno">10827</span>&#160;      <span class="comment">// to obtain approximately the same parameter change</span></div>
<div class="line"><a name="l10828"></a><span class="lineno">10828</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a8109bf56e9203d248ae30a50bb9cfe90">Arc_length_step_taken</a>)</div>
<div class="line"><a name="l10829"></a><span class="lineno">10829</span>&#160;      {</div>
<div class="line"><a name="l10830"></a><span class="lineno">10830</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad412d49617d0b0998e5eb440c7a20f3f">Ds_current</a> = (*parameter_pt - <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a8e29673eb80559888d1c6148c4f11e57">Parameter_current</a>) / <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa5082325ca4cafe5a9ec03ef79c67a6f">Parameter_derivative</a>;</div>
<div class="line"><a name="l10831"></a><span class="lineno">10831</span>&#160;      }</div>
<div class="line"><a name="l10832"></a><span class="lineno">10832</span>&#160; </div>
<div class="line"><a name="l10833"></a><span class="lineno">10833</span>&#160;      <span class="comment">// We have taken our first step</span></div>
<div class="line"><a name="l10834"></a><span class="lineno">10834</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a8109bf56e9203d248ae30a50bb9cfe90">Arc_length_step_taken</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l10835"></a><span class="lineno">10835</span>&#160;    }</div>
<div class="line"><a name="l10836"></a><span class="lineno">10836</span>&#160;    <span class="comment">// If there has not been a newton step then we still need to estimate</span></div>
<div class="line"><a name="l10837"></a><span class="lineno">10837</span>&#160;    <span class="comment">// the derivatives in the arc length direction</span></div>
<div class="line"><a name="l10838"></a><span class="lineno">10838</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l10839"></a><span class="lineno">10839</span>&#160;    {</div>
<div class="line"><a name="l10840"></a><span class="lineno">10840</span>&#160;      <span class="comment">// Default is to calculate the continuation derivatives by solving the</span></div>
<div class="line"><a name="l10841"></a><span class="lineno">10841</span>&#160;      <span class="comment">// linear system. We must do this to ensure that the derivatives are in</span></div>
<div class="line"><a name="l10842"></a><span class="lineno">10842</span>&#160;      <span class="comment">// sync It could lead to problems near turning points when we should</span></div>
<div class="line"><a name="l10843"></a><span class="lineno">10843</span>&#160;      <span class="comment">// really be solving an eigenproblem, but seems OK so far!</span></div>
<div class="line"><a name="l10844"></a><span class="lineno">10844</span>&#160; </div>
<div class="line"><a name="l10845"></a><span class="lineno">10845</span>&#160;      <span class="comment">// Save the current sign of the jacobian</span></div>
<div class="line"><a name="l10846"></a><span class="lineno">10846</span>&#160;      <span class="keywordtype">int</span> temp_sign = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aca97d61840e46edc914e3cb4b98fd437">Sign_of_jacobian</a>;</div>
<div class="line"><a name="l10847"></a><span class="lineno">10847</span>&#160; </div>
<div class="line"><a name="l10848"></a><span class="lineno">10848</span>&#160;      <span class="comment">// Calculate the continuation derivatives, which includes a solve</span></div>
<div class="line"><a name="l10849"></a><span class="lineno">10849</span>&#160;      <span class="comment">// of the linear system if not using finite differences</span></div>
<div class="line"><a name="l10850"></a><span class="lineno">10850</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a80dac9f70c77302805bb782cc6f1ad0f">Use_finite_differences_for_continuation_derivatives</a>)</div>
<div class="line"><a name="l10851"></a><span class="lineno">10851</span>&#160;      {</div>
<div class="line"><a name="l10852"></a><span class="lineno">10852</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a83463b9e0d3ebf86085c48c0e98c8f10">calculate_continuation_derivatives</a>(parameter_pt);</div>
<div class="line"><a name="l10853"></a><span class="lineno">10853</span>&#160;      }</div>
<div class="line"><a name="l10854"></a><span class="lineno">10854</span>&#160;      <span class="comment">// Otherwise use finite differences</span></div>
<div class="line"><a name="l10855"></a><span class="lineno">10855</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l10856"></a><span class="lineno">10856</span>&#160;      {</div>
<div class="line"><a name="l10857"></a><span class="lineno">10857</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a8978d65572c5ae81f7381fa6a6d56ba0">calculate_continuation_derivatives_fd</a>(parameter_pt);</div>
<div class="line"><a name="l10858"></a><span class="lineno">10858</span>&#160;      }</div>
<div class="line"><a name="l10859"></a><span class="lineno">10859</span>&#160; </div>
<div class="line"><a name="l10860"></a><span class="lineno">10860</span>&#160;      <span class="comment">// Reset the sign of the jacobian, just in case the sign has changed when</span></div>
<div class="line"><a name="l10861"></a><span class="lineno">10861</span>&#160;      <span class="comment">// solving the continuation derivatives. The sign change will be picked</span></div>
<div class="line"><a name="l10862"></a><span class="lineno">10862</span>&#160;      <span class="comment">// up on the next continuation step.</span></div>
<div class="line"><a name="l10863"></a><span class="lineno">10863</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aca97d61840e46edc914e3cb4b98fd437">Sign_of_jacobian</a> = temp_sign;</div>
<div class="line"><a name="l10864"></a><span class="lineno">10864</span>&#160;    }</div>
<div class="line"><a name="l10865"></a><span class="lineno">10865</span>&#160; </div>
<div class="line"><a name="l10866"></a><span class="lineno">10866</span>&#160;    <span class="comment">// Reset the is_steady status of all timesteppers that</span></div>
<div class="line"><a name="l10867"></a><span class="lineno">10867</span>&#160;    <span class="comment">// weren&#39;t already steady when we came in here and reset their</span></div>
<div class="line"><a name="l10868"></a><span class="lineno">10868</span>&#160;    <span class="comment">// weights</span></div>
<div class="line"><a name="l10869"></a><span class="lineno">10869</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_time_steppers; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l10870"></a><span class="lineno">10870</span>&#160;    {</div>
<div class="line"><a name="l10871"></a><span class="lineno">10871</span>&#160;      <span class="keywordflow">if</span> (!was_steady[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><a name="l10872"></a><span class="lineno">10872</span>&#160;      {</div>
<div class="line"><a name="l10873"></a><span class="lineno">10873</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)-&gt;<a class="code" href="../../d5/d19/classoomph_1_1TimeStepper.html#aada05f89e86aae352bd5b32bfb173b18">undo_make_steady</a>();</div>
<div class="line"><a name="l10874"></a><span class="lineno">10874</span>&#160;      }</div>
<div class="line"><a name="l10875"></a><span class="lineno">10875</span>&#160;    }</div>
<div class="line"><a name="l10876"></a><span class="lineno">10876</span>&#160; </div>
<div class="line"><a name="l10877"></a><span class="lineno">10877</span>&#160;    <span class="comment">// If we are trying to find a bifurcation and the first sign change</span></div>
<div class="line"><a name="l10878"></a><span class="lineno">10878</span>&#160;    <span class="comment">// has occured, use bisection</span></div>
<div class="line"><a name="l10879"></a><span class="lineno">10879</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a08dfc704030bb65cea3d9784c5271af0">Bifurcation_detection</a>) &amp;&amp; (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab805e5e5fb94f941cc7ff1b850d83269">Bisect_to_find_bifurcation</a>) &amp;&amp;</div>
<div class="line"><a name="l10880"></a><span class="lineno">10880</span>&#160;        (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a643f61299463a3bbf7be3f6a112aa130">First_jacobian_sign_change</a>))</div>
<div class="line"><a name="l10881"></a><span class="lineno">10881</span>&#160;    {</div>
<div class="line"><a name="l10882"></a><span class="lineno">10882</span>&#160;      <span class="comment">// If there has been a sign change we need to half the step size</span></div>
<div class="line"><a name="l10883"></a><span class="lineno">10883</span>&#160;      <span class="comment">// and reverse the direction</span></div>
<div class="line"><a name="l10884"></a><span class="lineno">10884</span>&#160;      <span class="keywordflow">if</span> (SIGN_CHANGE)</div>
<div class="line"><a name="l10885"></a><span class="lineno">10885</span>&#160;      {</div>
<div class="line"><a name="l10886"></a><span class="lineno">10886</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad412d49617d0b0998e5eb440c7a20f3f">Ds_current</a> *= -0.5;</div>
<div class="line"><a name="l10887"></a><span class="lineno">10887</span>&#160;      }</div>
<div class="line"><a name="l10888"></a><span class="lineno">10888</span>&#160;      <span class="comment">// Otherwise</span></div>
<div class="line"><a name="l10889"></a><span class="lineno">10889</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l10890"></a><span class="lineno">10890</span>&#160;      {</div>
<div class="line"><a name="l10891"></a><span class="lineno">10891</span>&#160;        <span class="comment">// The size of the bracketed interval is always</span></div>
<div class="line"><a name="l10892"></a><span class="lineno">10892</span>&#160;        <span class="comment">// 2ds - Ds_current (this will work even if the original step failed)</span></div>
<div class="line"><a name="l10893"></a><span class="lineno">10893</span>&#160;        <span class="comment">// We want our new step size to be half this</span></div>
<div class="line"><a name="l10894"></a><span class="lineno">10894</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad412d49617d0b0998e5eb440c7a20f3f">Ds_current</a> = ds - 0.5 * <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad412d49617d0b0998e5eb440c7a20f3f">Ds_current</a>;</div>
<div class="line"><a name="l10895"></a><span class="lineno">10895</span>&#160;      }</div>
<div class="line"><a name="l10896"></a><span class="lineno">10896</span>&#160;      <span class="comment">// Return the desired value of the step</span></div>
<div class="line"><a name="l10897"></a><span class="lineno">10897</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad412d49617d0b0998e5eb440c7a20f3f">Ds_current</a>;</div>
<div class="line"><a name="l10898"></a><span class="lineno">10898</span>&#160;    }</div>
<div class="line"><a name="l10899"></a><span class="lineno">10899</span>&#160; </div>
<div class="line"><a name="l10900"></a><span class="lineno">10900</span>&#160;    <span class="comment">// If fewer than the desired number of Newton Iterations, increase the step</span></div>
<div class="line"><a name="l10901"></a><span class="lineno">10901</span>&#160;    <span class="keywordflow">if</span> (max_count_in_adapt_loop &lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#abfe8db162a0bda98add0062a45f41cbf">Desired_newton_iterations_ds</a>)</div>
<div class="line"><a name="l10902"></a><span class="lineno">10902</span>&#160;    {</div>
<div class="line"><a name="l10903"></a><span class="lineno">10903</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad412d49617d0b0998e5eb440c7a20f3f">Ds_current</a> * 1.5;</div>
<div class="line"><a name="l10904"></a><span class="lineno">10904</span>&#160;    }</div>
<div class="line"><a name="l10905"></a><span class="lineno">10905</span>&#160;    <span class="comment">// If more than the desired number of Newton Iterations, reduce the step</span></div>
<div class="line"><a name="l10906"></a><span class="lineno">10906</span>&#160;    <span class="keywordflow">if</span> (max_count_in_adapt_loop &gt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#abfe8db162a0bda98add0062a45f41cbf">Desired_newton_iterations_ds</a>)</div>
<div class="line"><a name="l10907"></a><span class="lineno">10907</span>&#160;    {</div>
<div class="line"><a name="l10908"></a><span class="lineno">10908</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad412d49617d0b0998e5eb440c7a20f3f">Ds_current</a> * (2.0 / 3.0);</div>
<div class="line"><a name="l10909"></a><span class="lineno">10909</span>&#160;    }</div>
<div class="line"><a name="l10910"></a><span class="lineno">10910</span>&#160;    <span class="comment">// Otherwise return the step just taken</span></div>
<div class="line"><a name="l10911"></a><span class="lineno">10911</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad412d49617d0b0998e5eb440c7a20f3f">Ds_current</a>;</div>
<div class="line"><a name="l10912"></a><span class="lineno">10912</span>&#160;  }</div>
<div class="ttc" id="aClumpInput_8h_html_a82f6bc76e1c7a0f51bf3e95ad5d3c590"><div class="ttname"><a href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a></div><div class="ttdeci">std::vector&lt; double &gt; DoubleVector</div><div class="ttdoc">loads clump configuration</div><div class="ttdef"><b>Definition:</b> ClumpInput.h:26</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a07c5f8686a484837a8856efe3024a52c"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a07c5f8686a484837a8856efe3024a52c">oomph::Problem::newton_solve_continuation</a></div><div class="ttdeci">unsigned newton_solve_continuation(double *const &amp;parameter_pt)</div><div class="ttdef"><b>Definition:</b> problem.cc:9376</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a54e18ddf6073f9debd478f6b21a717de"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a54e18ddf6073f9debd478f6b21a717de">oomph::Problem::actions_after_parameter_increase</a></div><div class="ttdeci">virtual void actions_after_parameter_increase(double *const &amp;parameter_pt)</div><div class="ttdef"><b>Definition:</b> problem.h:1161</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a600bb1740edd0aa07c6d001033bf676a"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">oomph::Problem::communicator_pt</a></div><div class="ttdeci">OomphCommunicator * communicator_pt()</div><div class="ttdoc">access function to the oomph-lib communicator</div><div class="ttdef"><b>Definition:</b> problem.h:1246</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a83463b9e0d3ebf86085c48c0e98c8f10"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a83463b9e0d3ebf86085c48c0e98c8f10">oomph::Problem::calculate_continuation_derivatives</a></div><div class="ttdeci">void calculate_continuation_derivatives(double *const &amp;parameter_pt)</div><div class="ttdef"><b>Definition:</b> problem.cc:9715</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a8978d65572c5ae81f7381fa6a6d56ba0"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a8978d65572c5ae81f7381fa6a6d56ba0">oomph::Problem::calculate_continuation_derivatives_fd</a></div><div class="ttdeci">void calculate_continuation_derivatives_fd(double *const &amp;parameter_pt)</div><div class="ttdef"><b>Definition:</b> problem.cc:9818</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_ae78e313f1dc3bc956f42a5d0bd06c459"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#ae78e313f1dc3bc956f42a5d0bd06c459">oomph::Problem::set_consistent_pinned_values_for_continuation</a></div><div class="ttdeci">void set_consistent_pinned_values_for_continuation()</div><div class="ttdef"><b>Definition:</b> problem.cc:10466</div></div>
<div class="ttc" id="aclassoomph_1_1TimeStepper_html_a81ea0ff2e66cef5e0184b616c608e418"><div class="ttname"><a href="../../d5/d19/classoomph_1_1TimeStepper.html#a81ea0ff2e66cef5e0184b616c608e418">oomph::TimeStepper::make_steady</a></div><div class="ttdeci">void make_steady()</div><div class="ttdef"><b>Definition:</b> timesteppers.h:374</div></div>
<div class="ttc" id="aclassoomph_1_1TimeStepper_html_aada05f89e86aae352bd5b32bfb173b18"><div class="ttname"><a href="../../d5/d19/classoomph_1_1TimeStepper.html#aada05f89e86aae352bd5b32bfb173b18">oomph::TimeStepper::undo_make_steady</a></div><div class="ttdeci">virtual void undo_make_steady()</div><div class="ttdef"><b>Definition:</b> timesteppers.h:482</div></div>
<div class="ttc" id="aclassoomph_1_1TimeStepper_html_ad341ba9e80265e1c26c1cda0f40c8292"><div class="ttname"><a href="../../d5/d19/classoomph_1_1TimeStepper.html#ad341ba9e80265e1c26c1cda0f40c8292">oomph::TimeStepper::is_steady</a></div><div class="ttdeci">bool is_steady() const</div><div class="ttdef"><b>Definition:</b> timesteppers.h:389</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a54e18ddf6073f9debd478f6b21a717de">actions_after_parameter_increase()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a0b9e09ddfa2411f14fc723c3207decd1">adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a8109bf56e9203d248ae30a50bb9cfe90">Arc_length_step_taken</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a08dfc704030bb65cea3d9784c5271af0">Bifurcation_detection</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab805e5e5fb94f941cc7ff1b850d83269">Bisect_to_find_bifurcation</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a83463b9e0d3ebf86085c48c0e98c8f10">calculate_continuation_derivatives()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a8978d65572c5ae81f7381fa6a6d56ba0">calculate_continuation_derivatives_fd()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">communicator_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#abfe8db162a0bda98add0062a45f41cbf">Desired_newton_iterations_ds</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a366b50c490e9fd3ddafa05b2fbd0b883">Dof_current</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a10fd6457ceceb02a0e11d860ac0017c5">dof_current()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a1861321b2d129707935bf1191238daca">Dof_derivative</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad6df5fb0d282f25df1e94a665dd838e5">dof_derivative()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad412d49617d0b0998e5eb440c7a20f3f">Ds_current</a>, <a class="el" href="../../d9/d33/namespacecalibrate.html#a4dbebf21da853ac368a3a9af2fbab442">calibrate::error</a>, <a class="el" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">boost::multiprecision::fabs()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a643f61299463a3bbf7be3f6a112aa130">First_jacobian_sign_change</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html#ad341ba9e80265e1c26c1cda0f40c8292">oomph::TimeStepper::is_steady()</a>, <a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html#a81ea0ff2e66cef5e0184b616c608e418">oomph::TimeStepper::make_steady()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad0f8bb126a4f5ddeb559c23a8d451d8d">Minimum_ds</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a07c5f8686a484837a8856efe3024a52c">newton_solve_continuation()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">oomph::LinearAlgebraDistribution::nrow_local()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ace3cdf55009c3bff21d2b7d3706d522a">ntime_stepper()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a8e29673eb80559888d1c6148c4f11e57">Parameter_current</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa5082325ca4cafe5a9ec03ef79c67a6f">Parameter_derivative</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae78e313f1dc3bc956f42a5d0bd06c459">set_consistent_pinned_values_for_continuation()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aca97d61840e46edc914e3cb4b98fd437">Sign_of_jacobian</a>, <a class="el" href="../../d2/dc3/namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">oomph::Global_string_for_annotation::string()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt()</a>, <a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html#aada05f89e86aae352bd5b32bfb173b18">oomph::TimeStepper::undo_make_steady()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#adbecce0cb1bd7b6b21285568e41ee3eb">Use_continuation_timestepper</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a80dac9f70c77302805bb782cc6f1ad0f">Use_finite_differences_for_continuation_derivatives</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aee0d9902fd26b600c9519bea2dfc0f54">arc_length_step_solve()</a>.</p>

</div>
</div>
<a id="af6235ced9e7e85324f785f2681ab3872"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6235ced9e7e85324f785f2681ab3872">&#9670;&nbsp;</a></span>are_hessian_products_calculated_analytically()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::Problem::are_hessian_products_calculated_analytically </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Function to determine whether the hessian products are calculated analytically </p>
<div class="fragment"><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    {</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ac353f1325a3b411b30fbc19314cc18ce">Calculate_hessian_products_analytic</a>;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac353f1325a3b411b30fbc19314cc18ce">Calculate_hessian_products_analytic</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a497518acb5d30a28a253890c3d2a5da2">get_hessian_vector_products()</a>.</p>

</div>
</div>
<a id="a381c30a8daede5c95bdda7e2efa24f19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a381c30a8daede5c95bdda7e2efa24f19">&#9670;&nbsp;</a></span>assembly_handler_pt() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html">AssemblyHandler</a>*&amp; oomph::Problem::assembly_handler_pt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return a pointer to the assembly handler object. </p>
<div class="fragment"><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;    {</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>;</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a66fd78008266a4023f450971af444508">activate_pitchfork_tracking()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa0b4e7868e02e2d12845c9b2dd60cab9">bifurcation_adapt_helper()</a>, <a class="el" href="../../da/dcc/classoomph_1_1FpPressureAdvectionDiffusionProblem.html#a6e592be14db55b57bf8045c5c7d1993b">oomph::FpPressureAdvectionDiffusionProblem&lt; ELEMENT &gt;::FpPressureAdvectionDiffusionProblem()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a497518acb5d30a28a253890c3d2a5da2">get_hessian_vector_products()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5ee48c16fce89952a019a844ac386655">get_inverse_mass_matrix_times_residuals()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af660c2c0d10eaea1972314ce80de000e">get_jacobian()</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ac3f40f62d33d33616cdb4bed48aaccde">oomph::NavierStokesSchurComplementPreconditioner::get_pressure_advection_diffusion_matrix()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a0103fe1a09ecf7e23a9083b35ef07aac">get_residuals()</a>, <a class="el" href="../../da/d5c/two__d__biharmonic_8cc.html#a17b0c8d4bd94d77ee7f90bfb24cb068c">print_elemental_jacobian()</a>, <a class="el" href="../../de/d04/classoomph_1_1HSL__MA42.html#a6ea4a5adf63088f155b81ab650f44347">oomph::HSL_MA42::reorder_elements()</a>, <a class="el" href="../../dd/d4b/classoomph_1_1AugmentedBlockFoldLinearSolver.html#a7728fc74802b6802ed966765bc1e62d9">oomph::AugmentedBlockFoldLinearSolver::resolve()</a>, <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a9a424fd2ae0b67ef8c3ff59f16030786">oomph::BlockPitchForkLinearSolver::resolve()</a>, <a class="el" href="../../de/d72/classoomph_1_1AugmentedBlockPitchForkLinearSolver.html#a1d617896a3f1c1b1236ff18dc87ed8d7">oomph::AugmentedBlockPitchForkLinearSolver::resolve()</a>, <a class="el" href="../../dd/d4b/classoomph_1_1AugmentedBlockFoldLinearSolver.html#a11690b33089e999d0c894b4e4b0646d9">oomph::AugmentedBlockFoldLinearSolver::solve()</a>, <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#ad196867613954a8fabd318b50e2aadc6">oomph::BlockPitchForkLinearSolver::solve()</a>, <a class="el" href="../../de/d72/classoomph_1_1AugmentedBlockPitchForkLinearSolver.html#a0cbeb150ac83d5be1a1e30c0f728a70b">oomph::AugmentedBlockPitchForkLinearSolver::solve()</a>, <a class="el" href="../../df/dbd/classoomph_1_1BlockHopfLinearSolver.html#a5e9ff24466ec138cca8264e5befc31fe">oomph::BlockHopfLinearSolver::solve()</a>, <a class="el" href="../../de/d04/classoomph_1_1HSL__MA42.html#ae796a6b14c13d1cdb7bf49ca3c7c5aec">oomph::HSL_MA42::solve()</a>, <a class="el" href="../../de/d04/classoomph_1_1HSL__MA42.html#a79fca4aba6935fc5376cd9fa33a05f6a">oomph::HSL_MA42::solve_for_one_dof()</a>, <a class="el" href="../../df/dbd/classoomph_1_1BlockHopfLinearSolver.html#a9a7cc6bda9ab1a8baf83d5d8e1fe5eea">oomph::BlockHopfLinearSolver::solve_for_two_rhs()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa90e41a626a91ee113989afa847c1117">sparse_assemble_row_or_column_compressed_with_lists()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7ba1b95df63f6e7d746a6dae641daa33">sparse_assemble_row_or_column_compressed_with_maps()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a23465a0b1944a4bd31b9e0add9cc9875">sparse_assemble_row_or_column_compressed_with_two_arrays()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5bc761a0dee39437b2ebeba75079856f">sparse_assemble_row_or_column_compressed_with_two_vectors()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7eb5e0e3dc02fa26eec9d023b80b9603">sparse_assemble_row_or_column_compressed_with_vectors_of_pairs()</a>.</p>

</div>
</div>
<a id="a48905dc6c9a8811969407939b3e4ccb6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48905dc6c9a8811969407939b3e4ccb6">&#9670;&nbsp;</a></span>assembly_handler_pt() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html">AssemblyHandler</a>* const&amp; oomph::Problem::assembly_handler_pt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return a pointer to the assembly handler object (const version) </p>
<div class="fragment"><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;    {</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>;</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>.</p>

</div>
</div>
<a id="ada703cde7417adda572a72d05ddfa4b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada703cde7417adda572a72d05ddfa4b9">&#9670;&nbsp;</a></span>assign_eigenvector_to_dofs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::assign_eigenvector_to_dofs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;&#160;</td>
          <td class="paramname"><em>eigenvector</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Assign the eigenvector passed to the function to the dofs. </p>
<p>Assign the eigenvector passed to the function to the dofs in the problem so that it can be output by the usual routines. </p>
<div class="fragment"><div class="line"><a name="l08717"></a><span class="lineno"> 8717</span>&#160;  {</div>
<div class="line"><a name="l08718"></a><span class="lineno"> 8718</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n_dof = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>();</div>
<div class="line"><a name="l08719"></a><span class="lineno"> 8719</span>&#160;    <span class="comment">// Check that the eigenvector has the correct size</span></div>
<div class="line"><a name="l08720"></a><span class="lineno"> 8720</span>&#160;    <span class="keywordflow">if</span> (eigenvector.nrow() != n_dof)</div>
<div class="line"><a name="l08721"></a><span class="lineno"> 8721</span>&#160;    {</div>
<div class="line"><a name="l08722"></a><span class="lineno"> 8722</span>&#160;      std::ostringstream error_message;</div>
<div class="line"><a name="l08723"></a><span class="lineno"> 8723</span>&#160;      error_message &lt;&lt; <span class="stringliteral">&quot;Eigenvector has size &quot;</span> &lt;&lt; eigenvector.nrow()</div>
<div class="line"><a name="l08724"></a><span class="lineno"> 8724</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;, not equal to the number of dofs in the problem,&quot;</span></div>
<div class="line"><a name="l08725"></a><span class="lineno"> 8725</span>&#160;                    &lt;&lt; n_dof &lt;&lt; std::endl;</div>
<div class="line"><a name="l08726"></a><span class="lineno"> 8726</span>&#160; </div>
<div class="line"><a name="l08727"></a><span class="lineno"> 8727</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l08728"></a><span class="lineno"> 8728</span>&#160;        error_message.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l08729"></a><span class="lineno"> 8729</span>&#160;    }</div>
<div class="line"><a name="l08730"></a><span class="lineno"> 8730</span>&#160; </div>
<div class="line"><a name="l08731"></a><span class="lineno"> 8731</span>&#160;    <span class="comment">// Loop over the dofs and assign the eigenvector</span></div>
<div class="line"><a name="l08732"></a><span class="lineno"> 8732</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; eigenvector.nrow_local(); <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l08733"></a><span class="lineno"> 8733</span>&#160;    {</div>
<div class="line"><a name="l08734"></a><span class="lineno"> 8734</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a74d71439b100fb5b66b94d1d69130f7c">dof</a>(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>) = eigenvector[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>];</div>
<div class="line"><a name="l08735"></a><span class="lineno"> 8735</span>&#160;    }</div>
<div class="line"><a name="l08736"></a><span class="lineno"> 8736</span>&#160;<span class="comment">// Of course we now need to synchronise</span></div>
<div class="line"><a name="l08737"></a><span class="lineno"> 8737</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l08738"></a><span class="lineno"> 8738</span>&#160;    this-&gt;synchronise_all_dofs();</div>
<div class="line"><a name="l08739"></a><span class="lineno"> 8739</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l08740"></a><span class="lineno"> 8740</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a74d71439b100fb5b66b94d1d69130f7c">dof()</a>, <a class="el" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a7569556f14fd68b28508920e89bd5eee">oomph::DistributableLinearAlgebraObject::nrow()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">oomph::DistributableLinearAlgebraObject::nrow_local()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, and <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>.</p>

</div>
</div>
<a id="ad5340769f2b1051a77d443eb05c8f68c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5340769f2b1051a77d443eb05c8f68c">&#9670;&nbsp;</a></span>assign_eqn_numbers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long Problem::assign_eqn_numbers </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;&#160;</td>
          <td class="paramname"><em>assign_local_eqn_numbers</em> = <code>true</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Assign all equation numbers for problem: Deals with global data (= data that isn't attached to any elements) and then does the equation numbering for the elements. Virtual so it can be overloaded in MPI problems. Bool argument can be set to false to ignore assigning local equation numbers (found to be necessary in the parallel implementation of locate_zeta between multiple meshes).</p>
<p>Assign all equation numbers for problem: Deals with global data (= data that isn't attached to any elements) and then does the equation numbering for the elements. Bool argument can be set to false to ignore assigning local equation numbers (necessary in the parallel implementation of locate_zeta between multiple meshes). </p>
<div class="fragment"><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;  {</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;    <span class="comment">// Check that the global mesh has been build</span></div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a> == 0)</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;    {</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;      std::ostringstream error_stream;</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;      error_stream &lt;&lt; <span class="stringliteral">&quot;Global mesh does not exist, so equation numbers cannot &quot;</span></div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;                      <span class="stringliteral">&quot;be assigned.\n&quot;</span>;</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;      <span class="comment">// Check for sub meshes</span></div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>() == 0)</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;      {</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;        error_stream &lt;&lt; <span class="stringliteral">&quot;There aren&#39;t even any sub-meshes in the Problem.\n&quot;</span></div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;You can set the global mesh directly by using\n&quot;</span></div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;Problem::mesh_pt() = my_mesh_pt;\n&quot;</span></div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;OR you can use Problem::add_sub_mesh(mesh_pt); &quot;</span></div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;to add a sub mesh.\n&quot;</span>;</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;      }</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;      {</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;        error_stream &lt;&lt; <span class="stringliteral">&quot;There are &quot;</span> &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>() &lt;&lt; <span class="stringliteral">&quot; sub-meshes.\n&quot;</span>;</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;      }</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;      error_stream &lt;&lt; <span class="stringliteral">&quot;You need to call Problem::build_global_mesh() to create &quot;</span></div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;                      <span class="stringliteral">&quot;a global mesh\n&quot;</span></div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;from the sub-meshes.\n\n&quot;</span>;</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160; </div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;        error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;    }</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160; </div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;    <span class="comment">// Number of submeshes</span></div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;    <span class="keywordtype">unsigned</span> n_sub_mesh = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab65f6fc9c49860e6324457a7e6e76346">Sub_mesh_pt</a>.size();</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160; </div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160; </div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;    <span class="comment">// Storage for number of processors</span></div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;    <span class="keywordtype">int</span> n_proc = this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">communicator_pt</a>()-&gt;<a class="code" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a6c78c72666f4b102c2bccf200f0853b7">nproc</a>();</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160; </div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160; </div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;    <span class="keywordflow">if</span> (n_proc &gt; 1)</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;    {</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;      <span class="comment">// Force re-analysis of time spent on assembly each</span></div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;      <span class="comment">// elemental Jacobian</span></div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;      Must_recompute_load_balance_for_assembly = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;      Elemental_assembly_time.clear();</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;    }</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;    {</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;      Must_recompute_load_balance_for_assembly = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;    }</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160; </div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;    <span class="comment">// Re-distribution of elements over processors during assembly</span></div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;    <span class="comment">// must be recomputed</span></div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;    <span class="keywordflow">if</span> (!Problem_has_been_distributed)</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;    {</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;      <span class="comment">// Set default first and last elements for parallel assembly</span></div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;      <span class="comment">// of non-distributed problem.</span></div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;      set_default_first_and_last_element_for_assembly();</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;    }</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160; </div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160; </div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160; </div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;    <span class="keywordtype">double</span> t_start = 0.0;</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;    {</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;      t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;    }</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160; </div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;    <span class="comment">// Loop over all elements in the mesh and set up any additional</span></div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;    <span class="comment">// dependencies that they may have (e.g. storing the geometric</span></div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;    <span class="comment">// Data, i.e. Data that affects an element&#39;s shape in elements</span></div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;    <span class="comment">// with algebraic node-update functions</span></div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;    <span class="keywordtype">unsigned</span> nel = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">nelement</a>();</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; nel; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;    {</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">element_pt</a>(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>)-&gt;<a class="code" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#af03c43b9df873659a6ca91e39566256e">complete_setup_of_dependencies</a>();</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;    }</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160; </div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;    <span class="comment">// Complete setup of dependencies for external halo elements too</span></div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;    <span class="keywordtype">unsigned</span> n_mesh = this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>();</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i_mesh = 0; i_mesh &lt; n_mesh; i_mesh++)</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;    {</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iproc = 0; iproc &lt; n_proc; iproc++)</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;      {</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;        <span class="keywordtype">unsigned</span> n_ext_halo_el = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(i_mesh)-&gt;nexternal_halo_element(iproc);</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; n_ext_halo_el; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;        {</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;          <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(i_mesh)</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;            -&gt;external_halo_element_pt(iproc, <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>)</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;            -&gt;complete_setup_of_dependencies();</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;        }</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;      }</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;    }</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160; </div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160; </div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;    <span class="keywordtype">double</span> t_end = 0.0;</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;    {</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;      t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a></div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;Time for complete setup of dependencies in assign_eqn_numbers: &quot;</span></div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;        &lt;&lt; t_end - t_start &lt;&lt; std::endl;</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;    }</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160; </div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160; </div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;    <span class="comment">// Initialise number of dofs for reserve below</span></div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;    <span class="keywordtype">unsigned</span> n_dof = 0;</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160; </div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;    <span class="comment">// Potentially loop over remainder of routine, possible re-visiting all</span></div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;    <span class="comment">// those parts that must be redone, following the removal of duplicate</span></div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;    <span class="comment">// external halo data.</span></div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> loop_count = 0; loop_count &lt; 2; loop_count++)</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;    {</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;      <span class="comment">//(Re)-set the dof pointer to zero length because entries are</span></div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;      <span class="comment">// pushed back onto it -- if it&#39;s not reset here then we get into</span></div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;      <span class="comment">// trouble during mesh refinement when we reassign all dofs</span></div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>.resize(0);</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160; </div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;      <span class="comment">// Reserve from previous allocation if we&#39;re going around again</span></div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>.reserve(n_dof);</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160; </div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;      <span class="comment">// Reset the equation number</span></div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> equation_number = 0;</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160; </div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;      <span class="comment">// Now set equation numbers for the global Data</span></div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;      <span class="keywordtype">unsigned</span> Nglobal_data = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a60a9b6861928cf9115110b5bfc7d11a7">nglobal_data</a>();</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; Nglobal_data; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;      {</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;assign_eqn_numbers(equation_number, <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>);</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;      }</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160; </div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;      {</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;        t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;      }</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160; </div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;      <span class="comment">// Call assign equation numbers on the global mesh</span></div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;      n_dof = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#addf84f5fbe29d45259c36acf5f01d330">assign_global_eqn_numbers</a>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>);</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160; </div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;      <span class="comment">// Deal with the spine meshes additional numbering</span></div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;      <span class="comment">// If there is only one mesh</span></div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;      <span class="keywordflow">if</span> (n_sub_mesh == 0)</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;      {</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;        <span class="keywordflow">if</span> (SpineMesh* <span class="keyword">const</span> spine_mesh_pt = <span class="keyword">dynamic_cast&lt;</span>SpineMesh*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>))</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;        {</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;          n_dof = spine_mesh_pt-&gt;assign_global_spine_eqn_numbers(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>);</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;        }</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;      }</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;      <span class="comment">// Otherwise loop over the sub meshes</span></div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;      {</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;        <span class="comment">// Assign global equation numbers first</span></div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_sub_mesh; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;        {</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;          <span class="keywordflow">if</span> (SpineMesh* <span class="keyword">const</span> spine_mesh_pt =</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;                <span class="keyword">dynamic_cast&lt;</span>SpineMesh*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab65f6fc9c49860e6324457a7e6e76346">Sub_mesh_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]))</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;          {</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;            n_dof = spine_mesh_pt-&gt;assign_global_spine_eqn_numbers(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>);</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;          }</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;        }</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;      }</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160; </div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;      {</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;        t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a></div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;Time for assign_global_eqn_numbers in assign_eqn_numbers: &quot;</span></div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;          &lt;&lt; t_end - t_start &lt;&lt; std::endl;</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;        t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;      }</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160; </div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160; </div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160; </div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;      <span class="comment">// reset previous allocation</span></div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;      Parallel_sparse_assemble_previous_allocation = 0;</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160; </div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;      <span class="comment">// Only synchronise if the problem has actually been</span></div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;      <span class="comment">// distributed.</span></div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;      <span class="keywordflow">if</span> (Problem_has_been_distributed)</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;      {</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;        <span class="comment">// Synchronise the equation numbers and return the total</span></div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;        <span class="comment">// number of degrees of freedom in the overall problem</span></div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;        <span class="comment">// Do not assign local equation numbers -- we&#39;re doing this</span></div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;        <span class="comment">// below.</span></div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;        n_dof = synchronise_eqn_numbers(<span class="keyword">false</span>);</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;      }</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;      <span class="comment">// ..else just setup the Dof_distribution_pt</span></div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;      <span class="comment">// NOTE: this is setup by synchronise_eqn_numbers(...)</span></div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;      <span class="comment">// if Problem_has_been_distributed</span></div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;      {</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a3cab441019e738e4c6db6ee22dd71515">build</a>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>, n_dof, <span class="keyword">false</span>);</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;      }</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160; </div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;      {</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;        t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for Problem::synchronise_eqn_numbers in &quot;</span></div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;Problem::assign_eqn_numbers: &quot;</span> &lt;&lt; t_end - t_start</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;                   &lt;&lt; std::endl;</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;      }</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160; </div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160; </div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160; </div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160; </div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;      <span class="comment">// Now remove duplicate data in external halo elements</span></div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;      <span class="keywordflow">if</span> (Problem_has_been_distributed)</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;      {</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;        {</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;          t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;        }</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160; </div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;        <span class="comment">// Monitor if we&#39;ve actually changed anything</span></div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;        <span class="keywordtype">bool</span> actually_removed_some_data = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160; </div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;        <span class="comment">// Only do it once!</span></div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;        <span class="keywordflow">if</span> (loop_count == 0)</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;        {</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;          <span class="keywordflow">if</span> (n_sub_mesh == 0)</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;          {</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;            remove_duplicate_data(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>, actually_removed_some_data);</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;          }</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;          {</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_sub_mesh; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;            {</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;              <span class="keywordtype">bool</span> tmp_actually_removed_some_data = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;              remove_duplicate_data(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab65f6fc9c49860e6324457a7e6e76346">Sub_mesh_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>],</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;                                    tmp_actually_removed_some_data);</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;              <span class="keywordflow">if</span> (tmp_actually_removed_some_data)</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;                actually_removed_some_data = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;            }</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;          }</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;        }</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160; </div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160; </div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;        {</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;          t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;          std::stringstream <a class="code" href="../../da/d67/level3__impl_8h.html#a0ab86207641c152874beced8f77894d0">tmp</a>;</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;          <a class="code" href="../../da/d67/level3__impl_8h.html#a0ab86207641c152874beced8f77894d0">tmp</a> &lt;&lt; <span class="stringliteral">&quot;Time for calls to Problem::remove_duplicate_data in &quot;</span></div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;Problem::assign_eqn_numbers: &quot;</span> &lt;&lt; t_end - t_start</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;              &lt;&lt; <span class="stringliteral">&quot; ; have &quot;</span>;</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;          <span class="keywordflow">if</span> (!actually_removed_some_data)</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;          {</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;            <a class="code" href="../../da/d67/level3__impl_8h.html#a0ab86207641c152874beced8f77894d0">tmp</a> &lt;&lt; <span class="stringliteral">&quot; not &quot;</span>;</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;          }</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;          <a class="code" href="../../da/d67/level3__impl_8h.html#a0ab86207641c152874beced8f77894d0">tmp</a> &lt;&lt; <span class="stringliteral">&quot; removed some/any data.\n&quot;</span>;</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <a class="code" href="../../da/d67/level3__impl_8h.html#a0ab86207641c152874beced8f77894d0">tmp</a>.str();</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;          t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;        }</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160; </div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;        <span class="comment">// Break out of the loop if we haven&#39;t done anything here.</span></div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;        <span class="keywordtype">unsigned</span> status = 0;</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;        <span class="keywordflow">if</span> (actually_removed_some_data) status = 1;</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160; </div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;        <span class="comment">// Allreduce to check if anyone has removed any data</span></div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;        <span class="keywordtype">unsigned</span> overall_status = 0;</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;        MPI_Allreduce(&amp;status,</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;                      &amp;overall_status,</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;                      1,</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;                      MPI_UNSIGNED,</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;                      MPI_MAX,</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;                      this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">communicator_pt</a>()-&gt;mpi_comm());</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160; </div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160; </div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;        {</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;          t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;          std::stringstream <a class="code" href="../../da/d67/level3__impl_8h.html#a0ab86207641c152874beced8f77894d0">tmp</a>;</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;          <a class="code" href="../../da/d67/level3__impl_8h.html#a0ab86207641c152874beced8f77894d0">tmp</a></div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;Time for MPI_Allreduce after Problem::remove_duplicate_data in &quot;</span></div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;Problem::assign_eqn_numbers: &quot;</span> &lt;&lt; t_end - t_start &lt;&lt; std::endl;</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <a class="code" href="../../da/d67/level3__impl_8h.html#a0ab86207641c152874beced8f77894d0">tmp</a>.str();</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;          t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;        }</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160; </div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;        <span class="comment">// Bail out if we haven&#39;t done anything here</span></div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;        <span class="keywordflow">if</span> (overall_status != 1)</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;        {</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;        }</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160; </div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;        <span class="comment">// Big tidy up: Remove null pointers from halo/haloed node storage</span></div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;        <span class="comment">// for all meshes (this involves comms and therefore must be</span></div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;        <span class="comment">// performed outside loop over meshes so the all-to-all is only</span></div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;        <span class="comment">// done once)</span></div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;        remove_null_pointers_from_external_halo_node_storage();</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160; </div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;        <span class="comment">// Time it...</span></div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;        {</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;          <span class="keywordtype">double</span> t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Total time for &quot;</span></div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;Problem::remove_null_pointers_from_external_halo_node_&quot;</span></div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;                        <span class="stringliteral">&quot;storage(): &quot;</span></div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;                     &lt;&lt; t_end - t_start &lt;&lt; std::endl;</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;        }</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;      }</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;      {</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;        <span class="comment">// Problem not distributed; no need for another loop</span></div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;      }</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160; </div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160; </div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;      <span class="comment">// Serial run: Again no need for a second loop</span></div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160; </div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160; </div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;    } <span class="comment">// end of loop over fcts that need to be re-executed if</span></div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;    <span class="comment">// we&#39;ve removed duplicate external data</span></div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160; </div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160; </div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;    <span class="comment">// Resize the sparse assemble with arrays previous allocation</span></div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a547c85bfa6a2eb3effc4db1b46ebcdde">Sparse_assemble_with_arrays_previous_allocation</a>.resize(0);</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160; </div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160; </div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;    {</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;      t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;    }</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160; </div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;    <span class="comment">// Finally assign local equations</span></div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;    <span class="keywordflow">if</span> (assign_local_eqn_numbers)</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;    {</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;      <span class="keywordflow">if</span> (n_sub_mesh == 0)</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;      {</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ab73d03d38e9b94b15f21b2c12f5dc3bc">assign_local_eqn_numbers</a>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a075696d6f4c4260ce860997c8c931de4">Store_local_dof_pt_in_elements</a>);</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;      }</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;      {</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_sub_mesh; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;        {</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;          <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab65f6fc9c49860e6324457a7e6e76346">Sub_mesh_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;assign_local_eqn_numbers(</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;            <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a075696d6f4c4260ce860997c8c931de4">Store_local_dof_pt_in_elements</a>);</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;        }</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;      }</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;    }</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160; </div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;    {</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;      t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Total time for all Mesh::assign_local_eqn_numbers in &quot;</span></div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;Problem::assign_eqn_numbers: &quot;</span> &lt;&lt; t_end - t_start</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;                 &lt;&lt; std::endl;</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;    }</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160; </div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160; </div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;    <span class="comment">// and return the total number of DOFs</span></div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;    <span class="keywordflow">return</span> n_dof;</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1GeneralisedElement_html_af03c43b9df873659a6ca91e39566256e"><div class="ttname"><a href="../../dd/d46/classoomph_1_1GeneralisedElement.html#af03c43b9df873659a6ca91e39566256e">oomph::GeneralisedElement::complete_setup_of_dependencies</a></div><div class="ttdeci">virtual void complete_setup_of_dependencies()</div><div class="ttdef"><b>Definition:</b> elements.h:974</div></div>
<div class="ttc" id="aclassoomph_1_1LinearAlgebraDistribution_html_a3cab441019e738e4c6db6ee22dd71515"><div class="ttname"><a href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a3cab441019e738e4c6db6ee22dd71515">oomph::LinearAlgebraDistribution::build</a></div><div class="ttdeci">void build(const OomphCommunicator *const comm_pt, const unsigned &amp;first_row, const unsigned &amp;nrow_local, const unsigned &amp;nrow=0)</div><div class="ttdef"><b>Definition:</b> linear_algebra_distribution.cc:35</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_a876faf1f87b24b220ea21a38d6adde5b"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">oomph::Mesh::element_pt</a></div><div class="ttdeci">GeneralisedElement *&amp; element_pt(const unsigned long &amp;e)</div><div class="ttdoc">Return pointer to element e.</div><div class="ttdef"><b>Definition:</b> mesh.h:448</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_ab73d03d38e9b94b15f21b2c12f5dc3bc"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#ab73d03d38e9b94b15f21b2c12f5dc3bc">oomph::Mesh::assign_local_eqn_numbers</a></div><div class="ttdeci">void assign_local_eqn_numbers(const bool &amp;store_local_dof_pt)</div><div class="ttdoc">Assign local equation numbers in all elements.</div><div class="ttdef"><b>Definition:</b> mesh.cc:765</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_addf84f5fbe29d45259c36acf5f01d330"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#addf84f5fbe29d45259c36acf5f01d330">oomph::Mesh::assign_global_eqn_numbers</a></div><div class="ttdeci">unsigned long assign_global_eqn_numbers(Vector&lt; double * &gt; &amp;Dof_pt)</div><div class="ttdoc">Assign (global) equation numbers to the nodes.</div><div class="ttdef"><b>Definition:</b> mesh.cc:677</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_af01dfefb66c15579b540be62999d93ee"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">oomph::Mesh::nelement</a></div><div class="ttdeci">unsigned long nelement() const</div><div class="ttdoc">Return number of elements in the mesh.</div><div class="ttdef"><b>Definition:</b> mesh.h:590</div></div>
<div class="ttc" id="aclassoomph_1_1OomphCommunicator_html_a6c78c72666f4b102c2bccf200f0853b7"><div class="ttname"><a href="../../de/d83/classoomph_1_1OomphCommunicator.html#a6c78c72666f4b102c2bccf200f0853b7">oomph::OomphCommunicator::nproc</a></div><div class="ttdeci">int nproc() const</div><div class="ttdoc">number of processors</div><div class="ttdef"><b>Definition:</b> communicator.h:157</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a547c85bfa6a2eb3effc4db1b46ebcdde"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a547c85bfa6a2eb3effc4db1b46ebcdde">oomph::Problem::Sparse_assemble_with_arrays_previous_allocation</a></div><div class="ttdeci">Vector&lt; Vector&lt; unsigned &gt; &gt; Sparse_assemble_with_arrays_previous_allocation</div><div class="ttdef"><b>Definition:</b> problem.h:667</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a60a9b6861928cf9115110b5bfc7d11a7"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a60a9b6861928cf9115110b5bfc7d11a7">oomph::Problem::nglobal_data</a></div><div class="ttdeci">unsigned nglobal_data() const</div><div class="ttdoc">Return the number of global data values.</div><div class="ttdef"><b>Definition:</b> problem.h:1686</div></div>
<div class="ttc" id="alevel3__impl_8h_html_a0ab86207641c152874beced8f77894d0"><div class="ttname"><a href="../../da/d67/level3__impl_8h.html#a0ab86207641c152874beced8f77894d0">tmp</a></div><div class="ttdeci">Eigen::Matrix&lt; Scalar, Dynamic, Dynamic, ColMajor &gt; tmp</div><div class="ttdef"><b>Definition:</b> level3_impl.h:365</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#addf84f5fbe29d45259c36acf5f01d330">oomph::Mesh::assign_global_eqn_numbers()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ab73d03d38e9b94b15f21b2c12f5dc3bc">oomph::Mesh::assign_local_eqn_numbers()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a3cab441019e738e4c6db6ee22dd71515">oomph::LinearAlgebraDistribution::build()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">communicator_pt()</a>, <a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#af03c43b9df873659a6ca91e39566256e">oomph::GeneralisedElement::complete_setup_of_dependencies()</a>, <a class="el" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">oomph::Global_timings::Doc_comprehensive_timings</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>, <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">oomph::Mesh::element_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">oomph::Mesh::nelement()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a60a9b6861928cf9115110b5bfc7d11a7">nglobal_data()</a>, <a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a6c78c72666f4b102c2bccf200f0853b7">oomph::OomphCommunicator::nproc()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a547c85bfa6a2eb3effc4db1b46ebcdde">Sparse_assemble_with_arrays_previous_allocation</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a075696d6f4c4260ce860997c8c931de4">Store_local_dof_pt_in_elements</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab65f6fc9c49860e6324457a7e6e76346">Sub_mesh_pt</a>, <a class="el" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">oomph::TimingHelpers::timer()</a>, and <a class="el" href="../../da/d67/level3__impl_8h.html#a0ab86207641c152874beced8f77894d0">tmp</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5e60c7b47591bca6b20b0612e119983">adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a309487c952f108015b53a2d70539ac8b">adapt_based_on_error_estimates()</a>, <a class="el" href="../../d2/da2/classoomph_1_1PeriodicOrbitAssemblyHandler.html#a358d1749faa8ac7dd0de87340d878088">oomph::PeriodicOrbitAssemblyHandler&lt; NNODE_1D &gt;::adapt_temporal_mesh()</a>, <a class="el" href="../../df/d37/classAxisymFreeSurfaceNozzleAdvDiffRobinProblem.html#a146f67b5dfa4b8e11f09ac9e57827077">AxisymFreeSurfaceNozzleAdvDiffRobinProblem&lt; ELEMENT &gt;::AxisymFreeSurfaceNozzleAdvDiffRobinProblem()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa0b4e7868e02e2d12845c9b2dd60cab9">bifurcation_adapt_helper()</a>, <a class="el" href="../../dc/dcc/classoomph_1_1ODEProblem.html#a5a65df4e54b467fe55881669f5edeac3">oomph::ODEProblem::build()</a>, <a class="el" href="../../d9/dc5/classoomph_1_1BiharmonicProblem.html#a2ed9f3c94a3609638042089251476bcf">oomph::BiharmonicProblem&lt; DIM &gt;::build_global_mesh_and_assign_eqn_numbers()</a>, <a class="el" href="../../df/de6/classCapProblem.html#ab03ed8e2c1b44911d11209e00cb28a42">CapProblem&lt; ELEMENT &gt;::CapProblem()</a>, <a class="el" href="../../d1/d67/classContinuationProblem.html#a1623b61c6120511aab039894891a14ab">ContinuationProblem::ContinuationProblem()</a>, <a class="el" href="../../d3/d00/classConvectionProblem.html#ae2ffcac64ed8c4bfcdfdf4aeec0b6f7f">ConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;::ConvectionProblem()</a>, <a class="el" href="../../d8/de1/classEighthSpherePoissonProblem.html#ae51db2c3e80f0d5628e4d81eb1c11db4">EighthSpherePoissonProblem&lt; ELEMENT &gt;::EighthSpherePoissonProblem()</a>, <a class="el" href="../../dd/ddc/classElasticBeamProblem.html#a1c62c2a14c9a5528a649700d16dac2ea">ElasticBeamProblem::ElasticBeamProblem()</a>, <a class="el" href="../../d4/d8b/classElasticInterfaceProblem.html#ad92614ce2754af8f1cd7080274e43489">ElasticInterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;::ElasticInterfaceProblem()</a>, <a class="el" href="../../d2/d06/classElasticRingProblem.html#a57be33a379c1ec4418a7fb3e8db8ef2b">ElasticRingProblem&lt; ELEMENT &gt;::ElasticRingProblem()</a>, <a class="el" href="../../db/d31/classEntryFlowProblem.html#a0d527811321d270d769224dcbac8d240">EntryFlowProblem&lt; ELEMENT &gt;::EntryFlowProblem()</a>, <a class="el" href="../../d5/d2f/classExtrudedMovingCylinderProblem.html#ab768c6dfc194175a79d20458278b3eae">ExtrudedMovingCylinderProblem&lt; TWO_D_ELEMENT, THREE_D_ELEMENT &gt;::ExtrudedMovingCylinderProblem()</a>, <a class="el" href="../../dc/d83/classFlowAroundCylinderProblem.html#af48274c0e0cf81f60b52c77be3b28601">FlowAroundCylinderProblem&lt; ELEMENT &gt;::FlowAroundCylinderProblem()</a>, <a class="el" href="../../de/d9e/classFluxPoissonMGProblem.html#a02a9d4cb72c1a873c4325335a19b8e69">FluxPoissonMGProblem&lt; ELEMENT, MESH &gt;::FluxPoissonMGProblem()</a>, <a class="el" href="../../df/da7/classFluxPoissonProblem.html#a1b57e0c67634586cb69fbeeec7874e36">FluxPoissonProblem&lt; ELEMENT &gt;::FluxPoissonProblem()</a>, <a class="el" href="../../d9/d2f/classFreeSurfaceRotationProblem.html#ae13ffa99e2bb7a011562929acfd033ec">FreeSurfaceRotationProblem&lt; ELEMENT &gt;::FreeSurfaceRotationProblem()</a>, <a class="el" href="../../dd/d4a/classFSIChannelWithLeafletProblem.html#aaa0a455e91c4fb2dd9696607b802d01b">FSIChannelWithLeafletProblem&lt; ELEMENT &gt;::FSIChannelWithLeafletProblem()</a>, <a class="el" href="../../da/db6/classFSIRingProblem.html#a8f4969c6397bebe8afa2b9285ec908e6">FSIRingProblem::FSIRingProblem()</a>, <a class="el" href="../../da/dcc/classoomph_1_1FpPressureAdvectionDiffusionProblem.html#a54b59cff41c3b0cca9524e202bd49453">oomph::FpPressureAdvectionDiffusionProblem&lt; ELEMENT &gt;::get_pressure_advection_diffusion_jacobian()</a>, <a class="el" href="../../dd/d61/classHomogenisationProblem.html#a1224c22c4b4a4b64277b60d31da3bc52">HomogenisationProblem&lt; ELEMENT &gt;::HomogenisationProblem()</a>, <a class="el" href="../../d9/d15/classInterfaceProblem.html#a2ecc265740dba1626344fc090fad5fa6">InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;::InterfaceProblem()</a>, <a class="el" href="../../d4/db2/classLinearWaveProblem.html#a459a58b7afd588cfa78a5e1e98c3c41e">LinearWaveProblem&lt; ELEMENT, TIMESTEPPER &gt;::LinearWaveProblem()</a>, <a class="el" href="../../d7/d5d/two__layer__interface__nonaxisym__perturbations_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, <a class="el" href="../../dc/da5/classMeltSpinningProblem.html#a860a4d236b8d4cd19558b48082a0c6ee">MeltSpinningProblem&lt; ELEMENT &gt;::MeltSpinningProblem()</a>, <a class="el" href="../../d2/dd4/classNavierStokesProblem.html#a46835b845a017b66b7cbb45dad10bd17">NavierStokesProblem&lt; ELEMENT &gt;::NavierStokesProblem()</a>, <a class="el" href="../../d0/dd0/classOneDPoissonProblem.html#ab814af5dfd3b7ae665cd20e27da5d9ae">OneDPoissonProblem&lt; ELEMENT &gt;::OneDPoissonProblem()</a>, <a class="el" href="../../d6/d69/classoomph_1_1NonLinearElasticitySmoothMesh.html#a426905484f20903c02c995b297df36a6">oomph::NonLinearElasticitySmoothMesh&lt; ELEMENT &gt;::operator()()</a>, <a class="el" href="../../de/db1/classoomph_1_1LinearElasticitySmoothMesh.html#a7546b06ebbc89a348df4c2a8774147ec">oomph::LinearElasticitySmoothMesh&lt; LINEAR_ELASTICITY_ELEMENT &gt;::operator()()</a>, <a class="el" href="../../d5/df9/classoomph_1_1PoissonSmoothMesh.html#ad0a3d661fd2048fa4967e68ffeb1d630">oomph::PoissonSmoothMesh&lt; POISSON_ELEMENT &gt;::operator()()</a>, <a class="el" href="../../dc/db9/classOrrSommerfeldProblem.html#aaa5b04805113cefc7a352483c53e149e">OrrSommerfeldProblem&lt; ELEMENT &gt;::OrrSommerfeldProblem()</a>, <a class="el" href="../../dd/d71/classOscRingNStProblem.html#a33023787bdd34ada9fae40f1b32ca339">OscRingNStProblem&lt; ELEMENT &gt;::OscRingNStProblem()</a>, <a class="el" href="../../d2/d5a/classPolarNSProblem.html#a6b3674a72f007efd9b8ee6b5218485b5">PolarNSProblem&lt; ELEMENT &gt;::output_streamfunction()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a350e611af4847eabfa1d531b14b4439c">p_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad73bff32f14763e813cabdcd4c88c06">p_refine_selected_elements()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a093b78c1820cf3fe6bd9ec3deb605b49">p_refine_uniformly()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7460f9339fd4850112284a86e039ee00">p_refine_uniformly_aux()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#afa0aab9ca7018bf875c1f3367c6c07e3">p_unrefine_uniformly()</a>, <a class="el" href="../../d5/d62/classPerturbedStateProblem.html#a49c677252dd9ecfdc115a72167663b37">PerturbedStateProblem&lt; BASE_ELEMENT, PERTURBED_ELEMENT &gt;::PerturbedStateProblem()</a>, <a class="el" href="../../d0/d5c/classPoissonProblem.html#a9c28346c473d246d8f61022365e742ea">PoissonProblem&lt; ELEMENT &gt;::PoissonProblem()</a>, <a class="el" href="../../d3/d3c/classPRefineableOneDPoissonProblem.html#a450a7d9d10ddc309032caeb8db321e67">PRefineableOneDPoissonProblem&lt; ELEMENT &gt;::PRefineableOneDPoissonProblem()</a>, <a class="el" href="../../d5/dc5/classoomph_1_1ProjectionProblem.html#ad972f78212e515a03d1018996115265a">oomph::ProjectionProblem&lt; PROJECTABLE_ELEMENT &gt;::project()</a>, <a class="el" href="../../d8/d17/classPseudoSolidCapProblem.html#a4ac05a07dd55950bb67f7f79cb9fbb77">PseudoSolidCapProblem&lt; ELEMENT &gt;::PseudoSolidCapProblem()</a>, <a class="el" href="../../d8/d66/classQuarterCircleDrivenCavityProblem.html#ae5fd69acf7d28a600cb6aa0bbb6a341c">QuarterCircleDrivenCavityProblem&lt; ELEMENT &gt;::QuarterCircleDrivenCavityProblem()</a>, <a class="el" href="../../d4/d6c/classQuarterCircleDrivenCavityProblem2.html#a301f6d2c50e2d266126a80956397d78d">QuarterCircleDrivenCavityProblem2&lt; ELEMENT &gt;::QuarterCircleDrivenCavityProblem2()</a>, <a class="el" href="../../d6/da9/classRayleighProblem.html#a870eafe497219141a67fa06246ad41ee">RayleighProblem&lt; ELEMENT, TIMESTEPPER &gt;::RayleighProblem()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a4f6011ef141cc68598a9502052129a3f">read()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a3dcfc37fe1b6c21d694407981830c1e5">refine_selected_elements()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a1ce3a9162aaef9e0a4d86f8de57eb523">refine_uniformly()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#affb22db0c6f1e14ae120b153b85831a3">refine_uniformly_aux()</a>, <a class="el" href="../../d5/d48/classRefineableActivatorInhibitorProblem.html#ad0d45934b01decd3282fb27ddcc5412d">RefineableActivatorInhibitorProblem&lt; ELEMENT &gt;::RefineableActivatorInhibitorProblem()</a>, <a class="el" href="../../d1/d21/classRefineableAdvectionDiffusionProblem.html#a515147bf0907ad339811955edb89817c">RefineableAdvectionDiffusionProblem&lt; ELEMENT &gt;::RefineableAdvectionDiffusionProblem()</a>, <a class="el" href="../../de/d23/classRefineableFishPoissonProblem.html#a2585d906fab348e09bfb9b4c111ac161">RefineableFishPoissonProblem&lt; ELEMENT &gt;::RefineableFishPoissonProblem()</a>, <a class="el" href="../../d3/d40/classRefineableOneDPoissonProblem.html#a6f7abbff87dd4e17c981fa5ddf89c019">RefineableOneDPoissonProblem&lt; ELEMENT &gt;::RefineableOneDPoissonProblem()</a>, <a class="el" href="../../d8/da8/classRefineablePoissonProblem.html#a8dbfb91c0cfffeec18e6a154d7c8cbbc">RefineablePoissonProblem&lt; ELEMENT &gt;::RefineablePoissonProblem()</a>, <a class="el" href="../../d2/d3d/classRefineableRotatingCylinderProblem.html#aa597c4240ce9affbd7540998167c8f21">RefineableRotatingCylinderProblem&lt; ELEMENT &gt;::RefineableRotatingCylinderProblem()</a>, <a class="el" href="../../df/dab/classRefineableTwoDPoissonProblem.html#a98444356585600ed281f3d21c220f199">RefineableTwoDPoissonProblem&lt; ELEMENT &gt;::RefineableTwoDPoissonProblem()</a>, <a class="el" href="../../dd/d43/classRefineableTwoMeshFluxPoissonProblem.html#a6568980564c4e39544b1c2bcb71cf3b6">RefineableTwoMeshFluxPoissonProblem&lt; ELEMENT &gt;::RefineableTwoMeshFluxPoissonProblem()</a>, <a class="el" href="../../d4/d68/classRefineableUnsteadyHeatProblem.html#a894f3bd6c1c23c307a736de6898e4e98">RefineableUnsteadyHeatProblem&lt; ELEMENT &gt;::RefineableUnsteadyHeatProblem()</a>, <a class="el" href="../../da/d79/classRotatingProblem.html#af05ef530d374cdf4339ee76f314420ab">RotatingProblem&lt; ELEMENT &gt;::RotatingProblem()</a>, <a class="el" href="../../de/da7/classoomph_1_1SegregatableFSIProblem.html#a87a69561674c1e596bb205e0fc4a387f">oomph::SegregatableFSIProblem::segregated_solve()</a>, <a class="el" href="../../d2/d5a/classoomph_1_1SolidICProblem.html#a07e954c951e4eefa7ac7c99ba74e81cc">oomph::SolidICProblem::set_newmark_initial_condition_consistently()</a>, <a class="el" href="../../d2/d5a/classoomph_1_1SolidICProblem.html#ac88248cf3c1b9353724deb2e0d0e1f39">oomph::SolidICProblem::set_newmark_initial_condition_directly()</a>, <a class="el" href="../../d2/d5a/classoomph_1_1SolidICProblem.html#a60e1dccbc8627a07bfcb38a55b0669ca">oomph::SolidICProblem::set_static_initial_condition()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a50d54d4b374ea6a8d76798f34b865944">set_timestepper_for_all_data()</a>, <a class="el" href="../../dc/d2e/classoomph_1_1MGSolver.html#a8b25ea9a7781f95ddf46b4b8d427d3d0">oomph::MGSolver&lt; DIM &gt;::setup_mg_hierarchy()</a>, <a class="el" href="../../da/d32/classoomph_1_1HelmholtzMGPreconditioner.html#ad811c870bf06b25f3237c84b5037e089">oomph::HelmholtzMGPreconditioner&lt; DIM &gt;::setup_mg_hierarchy()</a>, <a class="el" href="../../d2/d5a/classoomph_1_1SolidICProblem.html#a4bbb8c404d1f4ea3827a2c64ae9e06de">oomph::SolidICProblem::setup_problem()</a>, <a class="el" href="../../dc/dfb/classSimpleShearProblem.html#ada0881781b3332f88362528be39613d2">SimpleShearProblem&lt; ELEMENT &gt;::SimpleShearProblem()</a>, <a class="el" href="../../d7/d67/classSolidFreeSurfaceRotationProblem.html#aeccfc9698ea6b1ce021224453929691e">SolidFreeSurfaceRotationProblem&lt; ELEMENT &gt;::SolidFreeSurfaceRotationProblem()</a>, <a class="el" href="../../d3/d40/classSphericalSteadyRotationProblem.html#a8ef7aaad8db655e7c7f4bde7faca2d60">SphericalSteadyRotationProblem&lt; ELEMENT &gt;::SphericalSteadyRotationProblem()</a>, <a class="el" href="../../d2/da3/classSteadyCurvedTubeProblem.html#ac276276fa87e57ff486e3af24b72e38b">SteadyCurvedTubeProblem&lt; ELEMENT &gt;::SteadyCurvedTubeProblem()</a>, <a class="el" href="../../dd/dec/classSteadyHelicalProblem.html#adbf13f3b2ffbcaaef6465d0d6583a1c9">SteadyHelicalProblem&lt; ELEMENT &gt;::SteadyHelicalProblem()</a>, <a class="el" href="../../d8/d90/classSteadyTubeProblem.html#a333c59fbeb36a2a5cbb170fc34783ec4">SteadyTubeProblem&lt; ELEMENT &gt;::SteadyTubeProblem()</a>, <a class="el" href="../../d4/d6f/classoomph_1_1StreamfunctionProblem.html#aa5e022deaab5947d7df85040dc6e8135">oomph::StreamfunctionProblem::StreamfunctionProblem()</a>, <a class="el" href="../../d3/d70/classSUPGAdvectionDiffusionProblem.html#a95aa4192c1b42327b12cdbb75295d192">SUPGAdvectionDiffusionProblem&lt; ELEMENT &gt;::SUPGAdvectionDiffusionProblem()</a>, <a class="el" href="../../d7/d86/classSurfactantProblem.html#a7728f025db0a13dd910db96d6fb66832">SurfactantProblem&lt; ELEMENT, INTERFACE_ELEMENT &gt;::SurfactantProblem()</a>, <a class="el" href="../../d0/dec/classContactProblem.html#abbeafc5cccf44e9470c0d93a64619f80">ContactProblem&lt; ELEMENT &gt;::switch_to_force_control()</a>, <a class="el" href="../../d8/d9f/classTestRefineablePoissonProblem.html#ae13d25a2b4421ef62eb876a208849754">TestRefineablePoissonProblem&lt; ELEMENT &gt;::TestRefineablePoissonProblem()</a>, <a class="el" href="../../dc/d7b/classThreeDPoissonProblem.html#a91d4a60568fd06697a1b49eec1dd7abf">ThreeDPoissonProblem&lt; ELEMENT &gt;::ThreeDPoissonProblem()</a>, <a class="el" href="../../d7/dcc/classTurekNonFSIProblem.html#aacb3214544ef81c2f8b49777457e8be6">TurekNonFSIProblem&lt; ELEMENT &gt;::TurekNonFSIProblem()</a>, <a class="el" href="../../d1/dfc/classTurekProblem.html#a69f6624fd854393f0c0e5303603ec749">TurekProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;::TurekProblem()</a>, <a class="el" href="../../db/d16/classTwoMeshFluxAdvectionDiffusionProblem.html#a7f3ec24317465521cb84212d1c2dc662">TwoMeshFluxAdvectionDiffusionProblem&lt; ELEMENT &gt;::TwoMeshFluxAdvectionDiffusionProblem()</a>, <a class="el" href="../../d0/d27/classTwoMeshFluxPoissonProblem.html#ace5a47aa61da5fd2a8761a16ffb3711c">TwoMeshFluxPoissonProblem&lt; ELEMENT &gt;::TwoMeshFluxPoissonProblem()</a>, <a class="el" href="../../db/d68/classUniformTranspiration.html#a8f0cdd50d06f8a16cf9fd75a9d39ecf1">UniformTranspiration&lt; ELEMENT &gt;::UniformTranspiration()</a>, <a class="el" href="../../d4/d2a/classUnitCubePoissonMGProblem.html#aae32a152e56b4c7d387e0ac29446432e">UnitCubePoissonMGProblem&lt; ELEMENT, MESH &gt;::UnitCubePoissonMGProblem()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a56429d79e517d59a54cd49949b04d3ae">unrefine_uniformly()</a>, <a class="el" href="../../d8/d28/classUnsteadyHeatProblem.html#a949060820c4acdb2c5b73e45ba2c037c">UnsteadyHeatProblem&lt; ELEMENT &gt;::UnsteadyHeatProblem()</a>, <a class="el" href="../../df/d77/classUnstructuredFvKProblem.html#ad2c3164bbc76c6ac35e4c090a8784f1e">UnstructuredFvKProblem&lt; ELEMENT &gt;::UnstructuredFvKProblem()</a>, <a class="el" href="../../dc/dff/classUnstructuredSolidProblem.html#a18ce02b6e4bbc86403c9e1b32c095772">UnstructuredSolidProblem&lt; ELEMENT, MESH &gt;::UnstructuredSolidProblem()</a>, <a class="el" href="../../da/dcc/classoomph_1_1FpPressureAdvectionDiffusionProblem.html#ae24eef02cff52b57dca6c1daf274bab2">oomph::FpPressureAdvectionDiffusionProblem&lt; ELEMENT &gt;::validate()</a>, and <a class="el" href="../../d3/d73/classoomph_1_1WomersleyProblem.html#adc4074cd09df4505feb27e22abb6922a">oomph::WomersleyProblem&lt; ELEMENT, DIM &gt;::WomersleyProblem()</a>.</p>

</div>
</div>
<a id="a7d966c0bfd336699586057e476bd17d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d966c0bfd336699586057e476bd17d5">&#9670;&nbsp;</a></span>assign_initial_values_impulsive() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::assign_initial_values_impulsive </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialise data and nodal positions to simulate impulsive start from initial configuration/solution</p>
<p>Initialise the previous values of the variables for time stepping corresponding to an impulsive start. Previous history for all data is generated by the appropriate timesteppers. Previous nodal positions are simply copied backwards. </p>
<div class="fragment"><div class="line"><a name="l11500"></a><span class="lineno">11500</span>&#160;  {</div>
<div class="line"><a name="l11501"></a><span class="lineno">11501</span>&#160;    <span class="comment">// Assign the impulsive values in the &quot;master&quot; mesh</span></div>
<div class="line"><a name="l11502"></a><span class="lineno">11502</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ab1ceceaadc7114773f5a70cb52e67081">assign_initial_values_impulsive</a>();</div>
<div class="line"><a name="l11503"></a><span class="lineno">11503</span>&#160; </div>
<div class="line"><a name="l11504"></a><span class="lineno">11504</span>&#160;    <span class="comment">// Loop over global data</span></div>
<div class="line"><a name="l11505"></a><span class="lineno">11505</span>&#160;    <span class="keywordtype">unsigned</span> Nglobal = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>.size();</div>
<div class="line"><a name="l11506"></a><span class="lineno">11506</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> iglobal = 0; iglobal &lt; Nglobal; iglobal++)</div>
<div class="line"><a name="l11507"></a><span class="lineno">11507</span>&#160;    {</div>
<div class="line"><a name="l11508"></a><span class="lineno">11508</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>[iglobal]</div>
<div class="line"><a name="l11509"></a><span class="lineno">11509</span>&#160;        -&gt;time_stepper_pt()</div>
<div class="line"><a name="l11510"></a><span class="lineno">11510</span>&#160;        -&gt;assign_initial_values_impulsive(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>[iglobal]);</div>
<div class="line"><a name="l11511"></a><span class="lineno">11511</span>&#160;    }</div>
<div class="line"><a name="l11512"></a><span class="lineno">11512</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_ab1ceceaadc7114773f5a70cb52e67081"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#ab1ceceaadc7114773f5a70cb52e67081">oomph::Mesh::assign_initial_values_impulsive</a></div><div class="ttdeci">void assign_initial_values_impulsive()</div><div class="ttdoc">Assign initial values for an impulsive start.</div><div class="ttdef"><b>Definition:</b> mesh.cc:2288</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ab1ceceaadc7114773f5a70cb52e67081">oomph::Mesh::assign_initial_values_impulsive()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6affe0af3093f94c348d9a3d008dde08">assign_initial_values_impulsive()</a>, <a class="el" href="../../d2/d5a/classoomph_1_1SolidICProblem.html#a60e1dccbc8627a07bfcb38a55b0669ca">oomph::SolidICProblem::set_static_initial_condition()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a64b890295532c3a7ff5ad4e4dd5d56e3">steady_newton_solve()</a>, and <a class="el" href="../../de/da7/classoomph_1_1SegregatableFSIProblem.html#a8f8145df86358916df505e2b513caf6a">oomph::SegregatableFSIProblem::steady_segregated_solve()</a>.</p>

</div>
</div>
<a id="a6affe0af3093f94c348d9a3d008dde08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6affe0af3093f94c348d9a3d008dde08">&#9670;&nbsp;</a></span>assign_initial_values_impulsive() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::assign_initial_values_impulsive </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>dt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialise data and nodal positions to simulate an impulsive start and also set the initial and previous values of dt</p>
<p>Assign the values for an impulsive start and also set the initial values of the previous dts to both be dt </p>
<div class="fragment"><div class="line"><a name="l11520"></a><span class="lineno">11520</span>&#160;  {</div>
<div class="line"><a name="l11521"></a><span class="lineno">11521</span>&#160;    <span class="comment">// First initialise the dts and set the weights</span></div>
<div class="line"><a name="l11522"></a><span class="lineno">11522</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a5f7e9e91eab83d600c94afdad532a6fb">initialise_dt</a>(dt);</div>
<div class="line"><a name="l11523"></a><span class="lineno">11523</span>&#160;    <span class="comment">// Now call assign_initial_values_impulsive</span></div>
<div class="line"><a name="l11524"></a><span class="lineno">11524</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a7d966c0bfd336699586057e476bd17d5">assign_initial_values_impulsive</a>();</div>
<div class="line"><a name="l11525"></a><span class="lineno">11525</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a5f7e9e91eab83d600c94afdad532a6fb"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a5f7e9e91eab83d600c94afdad532a6fb">oomph::Problem::initialise_dt</a></div><div class="ttdeci">void initialise_dt(const double &amp;dt)</div><div class="ttdef"><b>Definition:</b> problem.cc:13231</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7d966c0bfd336699586057e476bd17d5">assign_initial_values_impulsive()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5f7e9e91eab83d600c94afdad532a6fb">initialise_dt()</a>.</p>

</div>
</div>
<a id="a0b44e70f6ecabd3ee3401a9febd95275"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b44e70f6ecabd3ee3401a9febd95275">&#9670;&nbsp;</a></span>bifurcation_adapt_doc_errors()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::bifurcation_adapt_doc_errors </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>bifurcation_type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>A function that is used to document the errors used in the adaptive solution of bifurcation problems.</p>
<p>A function that is used to document the errors when adapting a bifurcation-tracking problem, which requires separate interpolation of the associated eigenfunction. The error measure is chosen to be a suitable combination of the errors in the base flow and the eigenfunction. The bifurcation type is passed as an argument </p>
<div class="fragment"><div class="line"><a name="l13649"></a><span class="lineno">13649</span>&#160;  {</div>
<div class="line"><a name="l13650"></a><span class="lineno">13650</span>&#160;    <span class="comment">// Dummy arguments</span></div>
<div class="line"><a name="l13651"></a><span class="lineno">13651</span>&#160;    <span class="keywordtype">unsigned</span> n_refined, n_unrefined;</div>
<div class="line"><a name="l13652"></a><span class="lineno">13652</span>&#160;    <span class="comment">// Just call the bifurcation helper without actually adapting</span></div>
<div class="line"><a name="l13653"></a><span class="lineno">13653</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa0b4e7868e02e2d12845c9b2dd60cab9">bifurcation_adapt_helper</a>(n_refined, n_unrefined, bifurcation_type, <span class="keyword">false</span>);</div>
<div class="line"><a name="l13654"></a><span class="lineno">13654</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa0b4e7868e02e2d12845c9b2dd60cab9">bifurcation_adapt_helper()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#adfa6431916fd73b661d8a62706d5137f">doc_errors()</a>.</p>

</div>
</div>
<a id="aa0b4e7868e02e2d12845c9b2dd60cab9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0b4e7868e02e2d12845c9b2dd60cab9">&#9670;&nbsp;</a></span>bifurcation_adapt_helper()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::bifurcation_adapt_helper </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>n_refined</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>n_unrefined</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>bifurcation_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;&#160;</td>
          <td class="paramname"><em>actually_adapt</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>A function that is used to adapt a bifurcation-tracking problem, which requires separate interpolation of the associated eigenfunction. The error measure is chosen to be a suitable combination of the errors in the base flow and the eigenfunction</p>
<p>A function that is used to adapt a bifurcation-tracking problem, which requires separate interpolation of the associated eigenfunction. The error measure is chosen to be a suitable combination of the errors in the base flow and the eigenfunction. The bifurcation type is passed as an argument </p>
<div class="fragment"><div class="line"><a name="l13358"></a><span class="lineno">13358</span>&#160;  {</div>
<div class="line"><a name="l13359"></a><span class="lineno">13359</span>&#160;    <span class="comment">// Storage for eigenfunction from the problem</span></div>
<div class="line"><a name="l13360"></a><span class="lineno">13360</span>&#160;    Vector&lt;DoubleVector&gt; eigenfunction;</div>
<div class="line"><a name="l13361"></a><span class="lineno">13361</span>&#160;    <span class="comment">// Get the eigenfunction from the problem</span></div>
<div class="line"><a name="l13362"></a><span class="lineno">13362</span>&#160;    this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a82c795d158c119cfde04089b516d6711">get_bifurcation_eigenfunction</a>(eigenfunction);</div>
<div class="line"><a name="l13363"></a><span class="lineno">13363</span>&#160; </div>
<div class="line"><a name="l13364"></a><span class="lineno">13364</span>&#160;    <span class="comment">// Get the bifurcation parameter</span></div>
<div class="line"><a name="l13365"></a><span class="lineno">13365</span>&#160;    <span class="keywordtype">double</span>* parameter_pt = this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937937da4763c3ed31a84f6b65df6f51">bifurcation_parameter_pt</a>();</div>
<div class="line"><a name="l13366"></a><span class="lineno">13366</span>&#160; </div>
<div class="line"><a name="l13367"></a><span class="lineno">13367</span>&#160;    <span class="comment">// Get the frequency parameter if tracking a Hopf bifurcation</span></div>
<div class="line"><a name="l13368"></a><span class="lineno">13368</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../de/d37/namespaceEigen_1_1internal.html#af27bc4062e9730cfcb357e88c05e9e6c">omega</a> = 0.0;</div>
<div class="line"><a name="l13369"></a><span class="lineno">13369</span>&#160;    <span class="comment">// If we&#39;re tracking a Hopf then also get the frequency</span></div>
<div class="line"><a name="l13370"></a><span class="lineno">13370</span>&#160;    <span class="keywordflow">if</span> (bifurcation_type == 3)</div>
<div class="line"><a name="l13371"></a><span class="lineno">13371</span>&#160;    {</div>
<div class="line"><a name="l13372"></a><span class="lineno">13372</span>&#160;      <a class="code" href="../../de/d37/namespaceEigen_1_1internal.html#af27bc4062e9730cfcb357e88c05e9e6c">omega</a> = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a5653c9ce9d673e348e945594469ce0d3">HopfHandler</a>*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>())-&gt;<a class="code" href="../../de/d37/namespaceEigen_1_1internal.html#af27bc4062e9730cfcb357e88c05e9e6c">omega</a>();</div>
<div class="line"><a name="l13373"></a><span class="lineno">13373</span>&#160;    }</div>
<div class="line"><a name="l13374"></a><span class="lineno">13374</span>&#160; </div>
<div class="line"><a name="l13375"></a><span class="lineno">13375</span>&#160;    <span class="comment">// If we&#39;re tracking a Pitchfork get the slack parameter (Hack)</span></div>
<div class="line"><a name="l13376"></a><span class="lineno">13376</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d9/d33/namespacecalibrate.html#a6caaf28555dab8f7d970d42592f6bc44">sigma</a> = 0.0;</div>
<div class="line"><a name="l13377"></a><span class="lineno">13377</span>&#160;    <span class="keywordflow">if</span> (bifurcation_type == 2)</div>
<div class="line"><a name="l13378"></a><span class="lineno">13378</span>&#160;    {</div>
<div class="line"><a name="l13379"></a><span class="lineno">13379</span>&#160;      <a class="code" href="../../d9/d33/namespacecalibrate.html#a6caaf28555dab8f7d970d42592f6bc44">sigma</a> = this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a74d71439b100fb5b66b94d1d69130f7c">dof</a>(this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>() - 1);</div>
<div class="line"><a name="l13380"></a><span class="lineno">13380</span>&#160;    }</div>
<div class="line"><a name="l13381"></a><span class="lineno">13381</span>&#160; </div>
<div class="line"><a name="l13382"></a><span class="lineno">13382</span>&#160;    <span class="comment">// We can now deactivate the bifurcation tracking in the problem</span></div>
<div class="line"><a name="l13383"></a><span class="lineno">13383</span>&#160;    <span class="comment">// to restore the degrees of freedom to the unaugmented value</span></div>
<div class="line"><a name="l13384"></a><span class="lineno">13384</span>&#160;    this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ac5b47ae12ed6445e52c65596dfa97c6d">deactivate_bifurcation_tracking</a>();</div>
<div class="line"><a name="l13385"></a><span class="lineno">13385</span>&#160; </div>
<div class="line"><a name="l13386"></a><span class="lineno">13386</span>&#160;    <span class="comment">// Next, we create copies of the present problem</span></div>
<div class="line"><a name="l13387"></a><span class="lineno">13387</span>&#160;    <span class="comment">// The number of copies depends on the number of eigenfunctions</span></div>
<div class="line"><a name="l13388"></a><span class="lineno">13388</span>&#160;    <span class="comment">// One copy for each eigenfunction</span></div>
<div class="line"><a name="l13389"></a><span class="lineno">13389</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_copies = eigenfunction.size();</div>
<div class="line"><a name="l13390"></a><span class="lineno">13390</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa2e04de221f29c13067e2fe4cf4c70f9">Copy_of_problem_pt</a>.resize(n_copies);</div>
<div class="line"><a name="l13391"></a><span class="lineno">13391</span>&#160; </div>
<div class="line"><a name="l13392"></a><span class="lineno">13392</span>&#160;    <span class="comment">// Loop over the number of copies</span></div>
<div class="line"><a name="l13393"></a><span class="lineno">13393</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a> = 0; <a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a> &lt; n_copies; <a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>++)</div>
<div class="line"><a name="l13394"></a><span class="lineno">13394</span>&#160;    {</div>
<div class="line"><a name="l13395"></a><span class="lineno">13395</span>&#160;      <span class="comment">// If we don&#39;t already have a copy</span></div>
<div class="line"><a name="l13396"></a><span class="lineno">13396</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa2e04de221f29c13067e2fe4cf4c70f9">Copy_of_problem_pt</a>[<a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>] == 0)</div>
<div class="line"><a name="l13397"></a><span class="lineno">13397</span>&#160;      {</div>
<div class="line"><a name="l13398"></a><span class="lineno">13398</span>&#160;        <span class="comment">// Create the copy</span></div>
<div class="line"><a name="l13399"></a><span class="lineno">13399</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa2e04de221f29c13067e2fe4cf4c70f9">Copy_of_problem_pt</a>[<a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>] = this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a1b10f0b678c60eaaa8bccb74ed1740f0">make_copy</a>();</div>
<div class="line"><a name="l13400"></a><span class="lineno">13400</span>&#160; </div>
<div class="line"><a name="l13401"></a><span class="lineno">13401</span>&#160;        <span class="comment">// Refine the copy to the same level as the current problem</span></div>
<div class="line"><a name="l13402"></a><span class="lineno">13402</span>&#160; </div>
<div class="line"><a name="l13403"></a><span class="lineno">13403</span>&#160;        <span class="comment">// Find number of submeshes</span></div>
<div class="line"><a name="l13404"></a><span class="lineno">13404</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> N_mesh = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa2e04de221f29c13067e2fe4cf4c70f9">Copy_of_problem_pt</a>[<a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>]-&gt;nsub_mesh();</div>
<div class="line"><a name="l13405"></a><span class="lineno">13405</span>&#160;        <span class="comment">// If there is only one mesh</span></div>
<div class="line"><a name="l13406"></a><span class="lineno">13406</span>&#160;        <span class="keywordflow">if</span> (N_mesh == 0)</div>
<div class="line"><a name="l13407"></a><span class="lineno">13407</span>&#160;        {</div>
<div class="line"><a name="l13408"></a><span class="lineno">13408</span>&#160;          <span class="comment">// Can we refine the mesh</span></div>
<div class="line"><a name="l13409"></a><span class="lineno">13409</span>&#160;          <span class="keywordflow">if</span> (TreeBasedRefineableMeshBase* mmesh_pt =</div>
<div class="line"><a name="l13410"></a><span class="lineno">13410</span>&#160;                <span class="keyword">dynamic_cast&lt;</span>TreeBasedRefineableMeshBase*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l13411"></a><span class="lineno">13411</span>&#160;                  <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa2e04de221f29c13067e2fe4cf4c70f9">Copy_of_problem_pt</a>[<a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>]-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(0)))</div>
<div class="line"><a name="l13412"></a><span class="lineno">13412</span>&#160;          {</div>
<div class="line"><a name="l13413"></a><span class="lineno">13413</span>&#160;            <span class="comment">// Is the adapt flag set</span></div>
<div class="line"><a name="l13414"></a><span class="lineno">13414</span>&#160;            <span class="keywordflow">if</span> (mmesh_pt-&gt;is_adaptation_enabled())</div>
<div class="line"><a name="l13415"></a><span class="lineno">13415</span>&#160;            {</div>
<div class="line"><a name="l13416"></a><span class="lineno">13416</span>&#160;              <span class="comment">// Now get the original problem&#39;s mesh if it&#39;s refineable</span></div>
<div class="line"><a name="l13417"></a><span class="lineno">13417</span>&#160;              <span class="keywordflow">if</span> (TreeBasedRefineableMeshBase* original_mesh_pt =</div>
<div class="line"><a name="l13418"></a><span class="lineno">13418</span>&#160;                    <span class="keyword">dynamic_cast&lt;</span>TreeBasedRefineableMeshBase*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l13419"></a><span class="lineno">13419</span>&#160;                      this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(0)))</div>
<div class="line"><a name="l13420"></a><span class="lineno">13420</span>&#160;              {</div>
<div class="line"><a name="l13421"></a><span class="lineno">13421</span>&#160;                mmesh_pt-&gt;refine_base_mesh_as_in_reference_mesh(</div>
<div class="line"><a name="l13422"></a><span class="lineno">13422</span>&#160;                  original_mesh_pt);</div>
<div class="line"><a name="l13423"></a><span class="lineno">13423</span>&#160;              }</div>
<div class="line"><a name="l13424"></a><span class="lineno">13424</span>&#160;              <span class="keywordflow">else</span></div>
<div class="line"><a name="l13425"></a><span class="lineno">13425</span>&#160;              {</div>
<div class="line"><a name="l13426"></a><span class="lineno">13426</span>&#160;                <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a></div>
<div class="line"><a name="l13427"></a><span class="lineno">13427</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Mesh in orginal problem is not refineable.&quot;</span></div>
<div class="line"><a name="l13428"></a><span class="lineno">13428</span>&#160;                  &lt;&lt; std::endl;</div>
<div class="line"><a name="l13429"></a><span class="lineno">13429</span>&#160;              }</div>
<div class="line"><a name="l13430"></a><span class="lineno">13430</span>&#160;            }</div>
<div class="line"><a name="l13431"></a><span class="lineno">13431</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l13432"></a><span class="lineno">13432</span>&#160;            {</div>
<div class="line"><a name="l13433"></a><span class="lineno">13433</span>&#160;              <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Mesh adaptation is disabled in copy.&quot;</span></div>
<div class="line"><a name="l13434"></a><span class="lineno">13434</span>&#160;                         &lt;&lt; std::endl;</div>
<div class="line"><a name="l13435"></a><span class="lineno">13435</span>&#160;            }</div>
<div class="line"><a name="l13436"></a><span class="lineno">13436</span>&#160;          }</div>
<div class="line"><a name="l13437"></a><span class="lineno">13437</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l13438"></a><span class="lineno">13438</span>&#160;          {</div>
<div class="line"><a name="l13439"></a><span class="lineno">13439</span>&#160;            <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Mesh cannot be adapted in copy.&quot;</span></div>
<div class="line"><a name="l13440"></a><span class="lineno">13440</span>&#160;                       &lt;&lt; std::endl;</div>
<div class="line"><a name="l13441"></a><span class="lineno">13441</span>&#160;          }</div>
<div class="line"><a name="l13442"></a><span class="lineno">13442</span>&#160;        } <span class="comment">// End of single mesh case</span></div>
<div class="line"><a name="l13443"></a><span class="lineno">13443</span>&#160;        <span class="comment">// Otherwise loop over the submeshes</span></div>
<div class="line"><a name="l13444"></a><span class="lineno">13444</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l13445"></a><span class="lineno">13445</span>&#160;        {</div>
<div class="line"><a name="l13446"></a><span class="lineno">13446</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> = 0; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> &lt; N_mesh; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>++)</div>
<div class="line"><a name="l13447"></a><span class="lineno">13447</span>&#160;          {</div>
<div class="line"><a name="l13448"></a><span class="lineno">13448</span>&#160;            <span class="comment">// Can we refine the submesh</span></div>
<div class="line"><a name="l13449"></a><span class="lineno">13449</span>&#160;            <span class="keywordflow">if</span> (TreeBasedRefineableMeshBase* mmesh_pt =</div>
<div class="line"><a name="l13450"></a><span class="lineno">13450</span>&#160;                  <span class="keyword">dynamic_cast&lt;</span>TreeBasedRefineableMeshBase*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l13451"></a><span class="lineno">13451</span>&#160;                    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa2e04de221f29c13067e2fe4cf4c70f9">Copy_of_problem_pt</a>[<a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>]-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>)))</div>
<div class="line"><a name="l13452"></a><span class="lineno">13452</span>&#160;            {</div>
<div class="line"><a name="l13453"></a><span class="lineno">13453</span>&#160;              <span class="comment">// Is the adapt flag set</span></div>
<div class="line"><a name="l13454"></a><span class="lineno">13454</span>&#160;              <span class="keywordflow">if</span> (mmesh_pt-&gt;is_adaptation_enabled())</div>
<div class="line"><a name="l13455"></a><span class="lineno">13455</span>&#160;              {</div>
<div class="line"><a name="l13456"></a><span class="lineno">13456</span>&#160;                <span class="comment">// Now get the original problem&#39;s mesh</span></div>
<div class="line"><a name="l13457"></a><span class="lineno">13457</span>&#160;                <span class="keywordflow">if</span> (TreeBasedRefineableMeshBase* original_mesh_pt =</div>
<div class="line"><a name="l13458"></a><span class="lineno">13458</span>&#160;                      <span class="keyword">dynamic_cast&lt;</span>TreeBasedRefineableMeshBase*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l13459"></a><span class="lineno">13459</span>&#160;                        this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>)))</div>
<div class="line"><a name="l13460"></a><span class="lineno">13460</span>&#160;                {</div>
<div class="line"><a name="l13461"></a><span class="lineno">13461</span>&#160;                  mmesh_pt-&gt;refine_base_mesh_as_in_reference_mesh(</div>
<div class="line"><a name="l13462"></a><span class="lineno">13462</span>&#160;                    original_mesh_pt);</div>
<div class="line"><a name="l13463"></a><span class="lineno">13463</span>&#160;                }</div>
<div class="line"><a name="l13464"></a><span class="lineno">13464</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l13465"></a><span class="lineno">13465</span>&#160;                {</div>
<div class="line"><a name="l13466"></a><span class="lineno">13466</span>&#160;                  <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Mesh in orginal problem is not &quot;</span></div>
<div class="line"><a name="l13467"></a><span class="lineno">13467</span>&#160;                                <span class="stringliteral">&quot;refineable.&quot;</span></div>
<div class="line"><a name="l13468"></a><span class="lineno">13468</span>&#160;                             &lt;&lt; std::endl;</div>
<div class="line"><a name="l13469"></a><span class="lineno">13469</span>&#160;                }</div>
<div class="line"><a name="l13470"></a><span class="lineno">13470</span>&#160;              }</div>
<div class="line"><a name="l13471"></a><span class="lineno">13471</span>&#160;              <span class="keywordflow">else</span></div>
<div class="line"><a name="l13472"></a><span class="lineno">13472</span>&#160;              {</div>
<div class="line"><a name="l13473"></a><span class="lineno">13473</span>&#160;                <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a></div>
<div class="line"><a name="l13474"></a><span class="lineno">13474</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Mesh adaptation is disabled in copy.&quot;</span></div>
<div class="line"><a name="l13475"></a><span class="lineno">13475</span>&#160;                  &lt;&lt; std::endl;</div>
<div class="line"><a name="l13476"></a><span class="lineno">13476</span>&#160;              }</div>
<div class="line"><a name="l13477"></a><span class="lineno">13477</span>&#160;            }</div>
<div class="line"><a name="l13478"></a><span class="lineno">13478</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l13479"></a><span class="lineno">13479</span>&#160;            {</div>
<div class="line"><a name="l13480"></a><span class="lineno">13480</span>&#160;              <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Mesh cannot be adapted in copy.&quot;</span></div>
<div class="line"><a name="l13481"></a><span class="lineno">13481</span>&#160;                         &lt;&lt; std::endl;</div>
<div class="line"><a name="l13482"></a><span class="lineno">13482</span>&#160;            }</div>
<div class="line"><a name="l13483"></a><span class="lineno">13483</span>&#160;          }</div>
<div class="line"><a name="l13484"></a><span class="lineno">13484</span>&#160;          <span class="comment">// rebuild the global mesh in the copy</span></div>
<div class="line"><a name="l13485"></a><span class="lineno">13485</span>&#160;          <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa2e04de221f29c13067e2fe4cf4c70f9">Copy_of_problem_pt</a>[<a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>]-&gt;rebuild_global_mesh();</div>
<div class="line"><a name="l13486"></a><span class="lineno">13486</span>&#160; </div>
<div class="line"><a name="l13487"></a><span class="lineno">13487</span>&#160;        } <span class="comment">// End of multiple mesh case</span></div>
<div class="line"><a name="l13488"></a><span class="lineno">13488</span>&#160; </div>
<div class="line"><a name="l13489"></a><span class="lineno">13489</span>&#160;        <span class="comment">// Must call actions after adapt</span></div>
<div class="line"><a name="l13490"></a><span class="lineno">13490</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa2e04de221f29c13067e2fe4cf4c70f9">Copy_of_problem_pt</a>[<a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>]-&gt;actions_after_adapt();</div>
<div class="line"><a name="l13491"></a><span class="lineno">13491</span>&#160; </div>
<div class="line"><a name="l13492"></a><span class="lineno">13492</span>&#160;        <span class="comment">// Assign the equation numbers to the copy (quietly)</span></div>
<div class="line"><a name="l13493"></a><span class="lineno">13493</span>&#160;        (void)<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa2e04de221f29c13067e2fe4cf4c70f9">Copy_of_problem_pt</a>[<a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>]-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers</a>();</div>
<div class="line"><a name="l13494"></a><span class="lineno">13494</span>&#160;      }</div>
<div class="line"><a name="l13495"></a><span class="lineno">13495</span>&#160;    } <span class="comment">// End of creation of copies</span></div>
<div class="line"><a name="l13496"></a><span class="lineno">13496</span>&#160; </div>
<div class="line"><a name="l13497"></a><span class="lineno">13497</span>&#160; </div>
<div class="line"><a name="l13498"></a><span class="lineno">13498</span>&#160;    <span class="comment">// Now check some numbers</span></div>
<div class="line"><a name="l13499"></a><span class="lineno">13499</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a> = 0; <a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a> &lt; n_copies; <a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>++)</div>
<div class="line"><a name="l13500"></a><span class="lineno">13500</span>&#160;    {</div>
<div class="line"><a name="l13501"></a><span class="lineno">13501</span>&#160;      <span class="comment">// Check that the dofs match for each copy</span></div>
<div class="line"><a name="l13502"></a><span class="lineno">13502</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l13503"></a><span class="lineno">13503</span>&#160;      <span class="comment">// If the problems don&#39;t match then complain</span></div>
<div class="line"><a name="l13504"></a><span class="lineno">13504</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa2e04de221f29c13067e2fe4cf4c70f9">Copy_of_problem_pt</a>[<a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>]-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>() != this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>())</div>
<div class="line"><a name="l13505"></a><span class="lineno">13505</span>&#160;      {</div>
<div class="line"><a name="l13506"></a><span class="lineno">13506</span>&#160;        std::ostringstream error_stream;</div>
<div class="line"><a name="l13507"></a><span class="lineno">13507</span>&#160;        error_stream &lt;&lt; <span class="stringliteral">&quot;Number of unknowns in the problem copy &quot;</span> &lt;&lt; <a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l13508"></a><span class="lineno">13508</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;not equal to number in the original:\n&quot;</span></div>
<div class="line"><a name="l13509"></a><span class="lineno">13509</span>&#160;                     &lt;&lt; this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>() &lt;&lt; <span class="stringliteral">&quot; (original) &quot;</span></div>
<div class="line"><a name="l13510"></a><span class="lineno">13510</span>&#160;                     &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa2e04de221f29c13067e2fe4cf4c70f9">Copy_of_problem_pt</a>[<a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>]-&gt;ndof() &lt;&lt; <span class="stringliteral">&quot; (copy)\n&quot;</span>;</div>
<div class="line"><a name="l13511"></a><span class="lineno">13511</span>&#160; </div>
<div class="line"><a name="l13512"></a><span class="lineno">13512</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l13513"></a><span class="lineno">13513</span>&#160;          error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l13514"></a><span class="lineno">13514</span>&#160;      }</div>
<div class="line"><a name="l13515"></a><span class="lineno">13515</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l13516"></a><span class="lineno">13516</span>&#160; </div>
<div class="line"><a name="l13517"></a><span class="lineno">13517</span>&#160;      <span class="comment">// Assign the eigenfunction(s) to the copied problems</span></div>
<div class="line"><a name="l13518"></a><span class="lineno">13518</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa2e04de221f29c13067e2fe4cf4c70f9">Copy_of_problem_pt</a>[<a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>]-&gt;assign_eigenvector_to_dofs(eigenfunction[<a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>]);</div>
<div class="line"><a name="l13519"></a><span class="lineno">13519</span>&#160;      <span class="comment">// Set all pinned values to zero</span></div>
<div class="line"><a name="l13520"></a><span class="lineno">13520</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa2e04de221f29c13067e2fe4cf4c70f9">Copy_of_problem_pt</a>[<a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>]-&gt;set_pinned_values_to_zero();</div>
<div class="line"><a name="l13521"></a><span class="lineno">13521</span>&#160;    }</div>
<div class="line"><a name="l13522"></a><span class="lineno">13522</span>&#160; </div>
<div class="line"><a name="l13523"></a><span class="lineno">13523</span>&#160;    <span class="comment">// Symmetrise the problem if we are solving a pitchfork</span></div>
<div class="line"><a name="l13524"></a><span class="lineno">13524</span>&#160;    <span class="keywordflow">if</span> (bifurcation_type == 2)</div>
<div class="line"><a name="l13525"></a><span class="lineno">13525</span>&#160;    {</div>
<div class="line"><a name="l13526"></a><span class="lineno">13526</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa2e04de221f29c13067e2fe4cf4c70f9">Copy_of_problem_pt</a>[0]</div>
<div class="line"><a name="l13527"></a><span class="lineno">13527</span>&#160;        -&gt;symmetrise_eigenfunction_for_adaptive_pitchfork_tracking();</div>
<div class="line"><a name="l13528"></a><span class="lineno">13528</span>&#160;    }</div>
<div class="line"><a name="l13529"></a><span class="lineno">13529</span>&#160; </div>
<div class="line"><a name="l13530"></a><span class="lineno">13530</span>&#160;    <span class="comment">// Find error estimates based on current problem and eigenproblem</span></div>
<div class="line"><a name="l13531"></a><span class="lineno">13531</span>&#160;    <span class="comment">// Now we need to get the error estimates for both problems.</span></div>
<div class="line"><a name="l13532"></a><span class="lineno">13532</span>&#160;    Vector&lt;Vector&lt;double&gt;&gt; base_error, eigenfunction_error;</div>
<div class="line"><a name="l13533"></a><span class="lineno">13533</span>&#160;    this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a2bd35d5954b6a8d43189b84520adb4b3">get_all_error_estimates</a>(base_error);</div>
<div class="line"><a name="l13534"></a><span class="lineno">13534</span>&#160;    <span class="comment">// Loop over the copies</span></div>
<div class="line"><a name="l13535"></a><span class="lineno">13535</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a> = 0; <a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a> &lt; n_copies; <a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>++)</div>
<div class="line"><a name="l13536"></a><span class="lineno">13536</span>&#160;    {</div>
<div class="line"><a name="l13537"></a><span class="lineno">13537</span>&#160;      <span class="comment">// Get the error estimates for the copy</span></div>
<div class="line"><a name="l13538"></a><span class="lineno">13538</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa2e04de221f29c13067e2fe4cf4c70f9">Copy_of_problem_pt</a>[<a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>]-&gt;get_all_error_estimates(eigenfunction_error);</div>
<div class="line"><a name="l13539"></a><span class="lineno">13539</span>&#160; </div>
<div class="line"><a name="l13540"></a><span class="lineno">13540</span>&#160;      <span class="comment">// Find the number of meshes</span></div>
<div class="line"><a name="l13541"></a><span class="lineno">13541</span>&#160;      <span class="keywordtype">unsigned</span> n_mesh = base_error.size();</div>
<div class="line"><a name="l13542"></a><span class="lineno">13542</span>&#160; </div>
<div class="line"><a name="l13543"></a><span class="lineno">13543</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l13544"></a><span class="lineno">13544</span>&#160;      <span class="keywordflow">if</span> (n_mesh != eigenfunction_error.size())</div>
<div class="line"><a name="l13545"></a><span class="lineno">13545</span>&#160;      {</div>
<div class="line"><a name="l13546"></a><span class="lineno">13546</span>&#160;        std::ostringstream error_stream;</div>
<div class="line"><a name="l13547"></a><span class="lineno">13547</span>&#160;        error_stream &lt;&lt; <span class="stringliteral">&quot;Problems do not have the same number of meshes\n&quot;</span></div>
<div class="line"><a name="l13548"></a><span class="lineno">13548</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;Base : &quot;</span> &lt;&lt; n_mesh</div>
<div class="line"><a name="l13549"></a><span class="lineno">13549</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot; : Eigenproblem : &quot;</span> &lt;&lt; eigenfunction_error.size()</div>
<div class="line"><a name="l13550"></a><span class="lineno">13550</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l13551"></a><span class="lineno">13551</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l13552"></a><span class="lineno">13552</span>&#160;          error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l13553"></a><span class="lineno">13553</span>&#160;      }</div>
<div class="line"><a name="l13554"></a><span class="lineno">13554</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l13555"></a><span class="lineno">13555</span>&#160; </div>
<div class="line"><a name="l13556"></a><span class="lineno">13556</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> = 0; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> &lt; n_mesh; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>++)</div>
<div class="line"><a name="l13557"></a><span class="lineno">13557</span>&#160;      {</div>
<div class="line"><a name="l13558"></a><span class="lineno">13558</span>&#160;        <span class="comment">// Check the number of elements is the same</span></div>
<div class="line"><a name="l13559"></a><span class="lineno">13559</span>&#160;        <span class="keywordtype">unsigned</span> n_element = base_error[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>].size();</div>
<div class="line"><a name="l13560"></a><span class="lineno">13560</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l13561"></a><span class="lineno">13561</span>&#160;        <span class="keywordflow">if</span> (n_element != eigenfunction_error[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>].<a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>())</div>
<div class="line"><a name="l13562"></a><span class="lineno">13562</span>&#160;        {</div>
<div class="line"><a name="l13563"></a><span class="lineno">13563</span>&#160;          std::ostringstream error_stream;</div>
<div class="line"><a name="l13564"></a><span class="lineno">13564</span>&#160;          error_stream &lt;&lt; <span class="stringliteral">&quot;Mesh &quot;</span> &lt;&lt; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a></div>
<div class="line"><a name="l13565"></a><span class="lineno">13565</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot; does not have the same number of elements in the &quot;</span></div>
<div class="line"><a name="l13566"></a><span class="lineno">13566</span>&#160;                          <span class="stringliteral">&quot;two problems:\n&quot;</span></div>
<div class="line"><a name="l13567"></a><span class="lineno">13567</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot;Base: &quot;</span> &lt;&lt; n_element</div>
<div class="line"><a name="l13568"></a><span class="lineno">13568</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot; :  Eigenproblem: &quot;</span> &lt;&lt; eigenfunction_error[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>].size()</div>
<div class="line"><a name="l13569"></a><span class="lineno">13569</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l13570"></a><span class="lineno">13570</span>&#160;          <span class="keywordflow">throw</span> OomphLibError(error_stream.str(),</div>
<div class="line"><a name="l13571"></a><span class="lineno">13571</span>&#160;                              <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l13572"></a><span class="lineno">13572</span>&#160;                              <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l13573"></a><span class="lineno">13573</span>&#160;        }</div>
<div class="line"><a name="l13574"></a><span class="lineno">13574</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l13575"></a><span class="lineno">13575</span>&#160;        <span class="comment">// Now add all the error esimates together</span></div>
<div class="line"><a name="l13576"></a><span class="lineno">13576</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; n_element; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l13577"></a><span class="lineno">13577</span>&#160;        {</div>
<div class="line"><a name="l13578"></a><span class="lineno">13578</span>&#160;          <span class="comment">// Add the error estimates (lazy)</span></div>
<div class="line"><a name="l13579"></a><span class="lineno">13579</span>&#160;          base_error[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>] += eigenfunction_error[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>];</div>
<div class="line"><a name="l13580"></a><span class="lineno">13580</span>&#160;        }</div>
<div class="line"><a name="l13581"></a><span class="lineno">13581</span>&#160;      }</div>
<div class="line"><a name="l13582"></a><span class="lineno">13582</span>&#160;    } <span class="comment">// End of loop over copies</span></div>
<div class="line"><a name="l13583"></a><span class="lineno">13583</span>&#160; </div>
<div class="line"><a name="l13584"></a><span class="lineno">13584</span>&#160;    <span class="comment">// Then refine all problems based on the combined measure</span></div>
<div class="line"><a name="l13585"></a><span class="lineno">13585</span>&#160;    <span class="comment">// if we are actually adapting (not just estimating the errors)</span></div>
<div class="line"><a name="l13586"></a><span class="lineno">13586</span>&#160;    <span class="keywordflow">if</span> (actually_adapt)</div>
<div class="line"><a name="l13587"></a><span class="lineno">13587</span>&#160;    {</div>
<div class="line"><a name="l13588"></a><span class="lineno">13588</span>&#160;      this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a309487c952f108015b53a2d70539ac8b">adapt_based_on_error_estimates</a>(n_refined, n_unrefined, base_error);</div>
<div class="line"><a name="l13589"></a><span class="lineno">13589</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a> = 0; <a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a> &lt; n_copies; <a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>++)</div>
<div class="line"><a name="l13590"></a><span class="lineno">13590</span>&#160;      {</div>
<div class="line"><a name="l13591"></a><span class="lineno">13591</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa2e04de221f29c13067e2fe4cf4c70f9">Copy_of_problem_pt</a>[<a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>]-&gt;adapt_based_on_error_estimates(</div>
<div class="line"><a name="l13592"></a><span class="lineno">13592</span>&#160;          n_refined, n_unrefined, base_error);</div>
<div class="line"><a name="l13593"></a><span class="lineno">13593</span>&#160;      }</div>
<div class="line"><a name="l13594"></a><span class="lineno">13594</span>&#160;      <span class="comment">// Symmetrise the problem (again) if we are solving for a pitchfork</span></div>
<div class="line"><a name="l13595"></a><span class="lineno">13595</span>&#160;      <span class="keywordflow">if</span> (bifurcation_type == 2)</div>
<div class="line"><a name="l13596"></a><span class="lineno">13596</span>&#160;      {</div>
<div class="line"><a name="l13597"></a><span class="lineno">13597</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa2e04de221f29c13067e2fe4cf4c70f9">Copy_of_problem_pt</a>[0]</div>
<div class="line"><a name="l13598"></a><span class="lineno">13598</span>&#160;          -&gt;symmetrise_eigenfunction_for_adaptive_pitchfork_tracking();</div>
<div class="line"><a name="l13599"></a><span class="lineno">13599</span>&#160;      }</div>
<div class="line"><a name="l13600"></a><span class="lineno">13600</span>&#160; </div>
<div class="line"><a name="l13601"></a><span class="lineno">13601</span>&#160;      <span class="comment">// Now get the refined guess for the eigenvector</span></div>
<div class="line"><a name="l13602"></a><span class="lineno">13602</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a> = 0; <a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a> &lt; n_copies; <a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>++)</div>
<div class="line"><a name="l13603"></a><span class="lineno">13603</span>&#160;      {</div>
<div class="line"><a name="l13604"></a><span class="lineno">13604</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa2e04de221f29c13067e2fe4cf4c70f9">Copy_of_problem_pt</a>[<a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>]-&gt;get_dofs(eigenfunction[<a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>]);</div>
<div class="line"><a name="l13605"></a><span class="lineno">13605</span>&#160;      }</div>
<div class="line"><a name="l13606"></a><span class="lineno">13606</span>&#160;    }</div>
<div class="line"><a name="l13607"></a><span class="lineno">13607</span>&#160; </div>
<div class="line"><a name="l13608"></a><span class="lineno">13608</span>&#160;    <span class="comment">// Reactivate the tracking</span></div>
<div class="line"><a name="l13609"></a><span class="lineno">13609</span>&#160;    <span class="keywordflow">switch</span> (bifurcation_type)</div>
<div class="line"><a name="l13610"></a><span class="lineno">13610</span>&#160;    {</div>
<div class="line"><a name="l13611"></a><span class="lineno">13611</span>&#160;        <span class="comment">// Fold tracking</span></div>
<div class="line"><a name="l13612"></a><span class="lineno">13612</span>&#160;      <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l13613"></a><span class="lineno">13613</span>&#160;        this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa4f954e46b84b13a2bb16a83b3f0ff83">activate_fold_tracking</a>(parameter_pt);</div>
<div class="line"><a name="l13614"></a><span class="lineno">13614</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l13615"></a><span class="lineno">13615</span>&#160; </div>
<div class="line"><a name="l13616"></a><span class="lineno">13616</span>&#160;        <span class="comment">// Pitchfork</span></div>
<div class="line"><a name="l13617"></a><span class="lineno">13617</span>&#160;      <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l13618"></a><span class="lineno">13618</span>&#160;        this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a66fd78008266a4023f450971af444508">activate_pitchfork_tracking</a>(parameter_pt, eigenfunction[0]);</div>
<div class="line"><a name="l13619"></a><span class="lineno">13619</span>&#160;        <span class="comment">// reset the slack parameter</span></div>
<div class="line"><a name="l13620"></a><span class="lineno">13620</span>&#160;        this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a74d71439b100fb5b66b94d1d69130f7c">dof</a>(this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>() - 1) = <a class="code" href="../../d9/d33/namespacecalibrate.html#a6caaf28555dab8f7d970d42592f6bc44">sigma</a>;</div>
<div class="line"><a name="l13621"></a><span class="lineno">13621</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l13622"></a><span class="lineno">13622</span>&#160; </div>
<div class="line"><a name="l13623"></a><span class="lineno">13623</span>&#160;        <span class="comment">// Hopf</span></div>
<div class="line"><a name="l13624"></a><span class="lineno">13624</span>&#160;      <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l13625"></a><span class="lineno">13625</span>&#160;        this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a5202944fe909268c20abcfb4576d147b">activate_hopf_tracking</a>(</div>
<div class="line"><a name="l13626"></a><span class="lineno">13626</span>&#160;          parameter_pt, <a class="code" href="../../de/d37/namespaceEigen_1_1internal.html#af27bc4062e9730cfcb357e88c05e9e6c">omega</a>, eigenfunction[0], eigenfunction[1]);</div>
<div class="line"><a name="l13627"></a><span class="lineno">13627</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l13628"></a><span class="lineno">13628</span>&#160; </div>
<div class="line"><a name="l13629"></a><span class="lineno">13629</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l13630"></a><span class="lineno">13630</span>&#160;        std::ostringstream error_stream;</div>
<div class="line"><a name="l13631"></a><span class="lineno">13631</span>&#160;        error_stream &lt;&lt; <span class="stringliteral">&quot;Bifurcation type &quot;</span> &lt;&lt; bifurcation_type</div>
<div class="line"><a name="l13632"></a><span class="lineno">13632</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot; not known\n&quot;</span></div>
<div class="line"><a name="l13633"></a><span class="lineno">13633</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;1: Fold, 2: Pitchfork, 3: Hopf\n&quot;</span>;</div>
<div class="line"><a name="l13634"></a><span class="lineno">13634</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l13635"></a><span class="lineno">13635</span>&#160;          error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l13636"></a><span class="lineno">13636</span>&#160;    }</div>
<div class="line"><a name="l13637"></a><span class="lineno">13637</span>&#160;  }</div>
<div class="ttc" id="abenchVecAdd_8cpp_html_a439227feff9d7f55384e8780cfc2eb82"><div class="ttname"><a href="../../db/ddc/benchVecAdd_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a></div><div class="ttdeci">Scalar Scalar int size</div><div class="ttdef"><b>Definition:</b> benchVecAdd.cpp:17</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a5202944fe909268c20abcfb4576d147b"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a5202944fe909268c20abcfb4576d147b">oomph::Problem::activate_hopf_tracking</a></div><div class="ttdeci">void activate_hopf_tracking(double *const &amp;parameter_pt, const bool &amp;block_solve=true)</div><div class="ttdef"><b>Definition:</b> problem.cc:10218</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a66fd78008266a4023f450971af444508"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a66fd78008266a4023f450971af444508">oomph::Problem::activate_pitchfork_tracking</a></div><div class="ttdeci">void activate_pitchfork_tracking(double *const &amp;parameter_pt, const DoubleVector &amp;symmetry_vector, const bool &amp;block_solve=true)</div><div class="ttdef"><b>Definition:</b> problem.cc:10188</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a82c795d158c119cfde04089b516d6711"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a82c795d158c119cfde04089b516d6711">oomph::Problem::get_bifurcation_eigenfunction</a></div><div class="ttdeci">void get_bifurcation_eigenfunction(Vector&lt; DoubleVector &gt; &amp;eigenfunction)</div><div class="ttdef"><b>Definition:</b> problem.cc:10091</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a937937da4763c3ed31a84f6b65df6f51"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a937937da4763c3ed31a84f6b65df6f51">oomph::Problem::bifurcation_parameter_pt</a></div><div class="ttdeci">double * bifurcation_parameter_pt() const</div><div class="ttdef"><b>Definition:</b> problem.cc:10081</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_aa4f954e46b84b13a2bb16a83b3f0ff83"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#aa4f954e46b84b13a2bb16a83b3f0ff83">oomph::Problem::activate_fold_tracking</a></div><div class="ttdeci">void activate_fold_tracking(double *const &amp;parameter_pt, const bool &amp;block_solve=true)</div><div class="ttdef"><b>Definition:</b> problem.cc:10103</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_ac5b47ae12ed6445e52c65596dfa97c6d"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#ac5b47ae12ed6445e52c65596dfa97c6d">oomph::Problem::deactivate_bifurcation_tracking</a></div><div class="ttdeci">void deactivate_bifurcation_tracking()</div><div class="ttdef"><b>Definition:</b> problem.h:2353</div></div>
<div class="ttc" id="anamespacecalibrate_html_a6caaf28555dab8f7d970d42592f6bc44"><div class="ttname"><a href="../../d9/d33/namespacecalibrate.html#a6caaf28555dab8f7d970d42592f6bc44">calibrate.sigma</a></div><div class="ttdeci">int sigma</div><div class="ttdef"><b>Definition:</b> calibrate.py:179</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa4f954e46b84b13a2bb16a83b3f0ff83">activate_fold_tracking()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5202944fe909268c20abcfb4576d147b">activate_hopf_tracking()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a66fd78008266a4023f450971af444508">activate_pitchfork_tracking()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a309487c952f108015b53a2d70539ac8b">adapt_based_on_error_estimates()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a937937da4763c3ed31a84f6b65df6f51">bifurcation_parameter_pt()</a>, <a class="el" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">calibrate::c</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa2e04de221f29c13067e2fe4cf4c70f9">Copy_of_problem_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac5b47ae12ed6445e52c65596dfa97c6d">deactivate_bifurcation_tracking()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a74d71439b100fb5b66b94d1d69130f7c">dof()</a>, <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a2bd35d5954b6a8d43189b84520adb4b3">get_all_error_estimates()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a82c795d158c119cfde04089b516d6711">get_bifurcation_eigenfunction()</a>, <a class="el" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a1b10f0b678c60eaaa8bccb74ed1740f0">make_copy()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof()</a>, <a class="el" href="../../de/d37/namespaceEigen_1_1internal.html#af27bc4062e9730cfcb357e88c05e9e6c">Eigen::internal::omega()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, <a class="el" href="../../d9/d33/namespacecalibrate.html#a6caaf28555dab8f7d970d42592f6bc44">calibrate::sigma</a>, and <a class="el" href="../../db/ddc/benchVecAdd_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5e60c7b47591bca6b20b0612e119983">adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a0b44e70f6ecabd3ee3401a9febd95275">bifurcation_adapt_doc_errors()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a350e611af4847eabfa1d531b14b4439c">p_adapt()</a>.</p>

</div>
</div>
<a id="a937937da4763c3ed31a84f6b65df6f51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a937937da4763c3ed31a84f6b65df6f51">&#9670;&nbsp;</a></span>bifurcation_parameter_pt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> * Problem::bifurcation_parameter_pt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return pointer to the parameter that is used in the bifurcation detection. If we are not tracking a bifurcation then an error will be thrown by the AssemblyHandler </p>
<div class="fragment"><div class="line"><a name="l10082"></a><span class="lineno">10082</span>&#160;  {</div>
<div class="line"><a name="l10083"></a><span class="lineno">10083</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>-&gt;<a class="code" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a3e369ec692c3d36a4a2a8a64dab7fe2b">bifurcation_parameter_pt</a>();</div>
<div class="line"><a name="l10084"></a><span class="lineno">10084</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1AssemblyHandler_html_a3e369ec692c3d36a4a2a8a64dab7fe2b"><div class="ttname"><a href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a3e369ec692c3d36a4a2a8a64dab7fe2b">oomph::AssemblyHandler::bifurcation_parameter_pt</a></div><div class="ttdeci">virtual double * bifurcation_parameter_pt() const</div><div class="ttdef"><b>Definition:</b> assembly_handler.cc:168</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>, and <a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a3e369ec692c3d36a4a2a8a64dab7fe2b">oomph::AssemblyHandler::bifurcation_parameter_pt()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa0b4e7868e02e2d12845c9b2dd60cab9">bifurcation_adapt_helper()</a>.</p>

</div>
</div>
<a id="aa29176d84610e0273fc823cace91765a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa29176d84610e0273fc823cace91765a">&#9670;&nbsp;</a></span>build_global_mesh()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::build_global_mesh </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Build the global mesh by combining the all the submeshes. <b>Note:</b> The nodes boundary information refers to the boundary numbers within the submesh!</p>
<p>Build a single (global) mesh from a number of submeshes which are passed as a vector of pointers to the submeshes. The ordering is not necessarily optimal. </p>
<div class="fragment"><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;  {</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    <span class="comment">// Has a global mesh already been built</span></div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a> != 0)</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    {</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;      <a class="code" href="../../d2/dc3/namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">std::string</a> error_message = <span class="stringliteral">&quot;Problem::build_global_mesh() called,\n&quot;</span>;</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;      error_message += <span class="stringliteral">&quot; but a global mesh has already been built:\n&quot;</span>;</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;      error_message += <span class="stringliteral">&quot;Problem::Mesh_pt is not zero!\n&quot;</span>;</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160; </div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;        error_message, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    }</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;    <span class="comment">// Check that there are submeshes</span></div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab65f6fc9c49860e6324457a7e6e76346">Sub_mesh_pt</a>.size() == 0)</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;    {</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;      <a class="code" href="../../d2/dc3/namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">std::string</a> error_message = <span class="stringliteral">&quot;Problem::build_global_mesh() called,\n&quot;</span>;</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;      error_message += <span class="stringliteral">&quot; but there are no submeshes:\n&quot;</span>;</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;      error_message += <span class="stringliteral">&quot;Problem::Sub_mesh_pt has no entries\n&quot;</span>;</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160; </div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;        error_message, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;    }</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160; </div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;    <span class="comment">// Create an empty mesh</span></div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a> = <span class="keyword">new</span> Mesh();</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160; </div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;    <span class="comment">// Call the rebuild function to construct the mesh</span></div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a266d4d1b2bd4a5cbc028ff5aba79508f">rebuild_global_mesh</a>();</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a266d4d1b2bd4a5cbc028ff5aba79508f">rebuild_global_mesh()</a>, <a class="el" href="../../d2/dc3/namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">oomph::Global_string_for_annotation::string()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab65f6fc9c49860e6324457a7e6e76346">Sub_mesh_pt</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../df/d37/classAxisymFreeSurfaceNozzleAdvDiffRobinProblem.html#a146f67b5dfa4b8e11f09ac9e57827077">AxisymFreeSurfaceNozzleAdvDiffRobinProblem&lt; ELEMENT &gt;::AxisymFreeSurfaceNozzleAdvDiffRobinProblem()</a>, <a class="el" href="../../dc/dcc/classoomph_1_1ODEProblem.html#a5a65df4e54b467fe55881669f5edeac3">oomph::ODEProblem::build()</a>, <a class="el" href="../../d9/dc5/classoomph_1_1BiharmonicProblem.html#a2ed9f3c94a3609638042089251476bcf">oomph::BiharmonicProblem&lt; DIM &gt;::build_global_mesh_and_assign_eqn_numbers()</a>, <a class="el" href="../../df/de6/classCapProblem.html#ab03ed8e2c1b44911d11209e00cb28a42">CapProblem&lt; ELEMENT &gt;::CapProblem()</a>, <a class="el" href="../../d3/d00/classConvectionProblem.html#ae2ffcac64ed8c4bfcdfdf4aeec0b6f7f">ConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;::ConvectionProblem()</a>, <a class="el" href="../../d4/d8b/classElasticInterfaceProblem.html#ad92614ce2754af8f1cd7080274e43489">ElasticInterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;::ElasticInterfaceProblem()</a>, <a class="el" href="../../de/d9e/classFluxPoissonMGProblem.html#a02a9d4cb72c1a873c4325335a19b8e69">FluxPoissonMGProblem&lt; ELEMENT, MESH &gt;::FluxPoissonMGProblem()</a>, <a class="el" href="../../d9/d2f/classFreeSurfaceRotationProblem.html#ae13ffa99e2bb7a011562929acfd033ec">FreeSurfaceRotationProblem&lt; ELEMENT &gt;::FreeSurfaceRotationProblem()</a>, <a class="el" href="../../dd/d4a/classFSIChannelWithLeafletProblem.html#aaa0a455e91c4fb2dd9696607b802d01b">FSIChannelWithLeafletProblem&lt; ELEMENT &gt;::FSIChannelWithLeafletProblem()</a>, <a class="el" href="../../da/db6/classFSIRingProblem.html#a8f4969c6397bebe8afa2b9285ec908e6">FSIRingProblem::FSIRingProblem()</a>, <a class="el" href="../../dd/d61/classHomogenisationProblem.html#a1224c22c4b4a4b64277b60d31da3bc52">HomogenisationProblem&lt; ELEMENT &gt;::HomogenisationProblem()</a>, <a class="el" href="../../d9/d15/classInterfaceProblem.html#a2ecc265740dba1626344fc090fad5fa6">InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;::InterfaceProblem()</a>, <a class="el" href="../../dc/da5/classMeltSpinningProblem.html#a860a4d236b8d4cd19558b48082a0c6ee">MeltSpinningProblem&lt; ELEMENT &gt;::MeltSpinningProblem()</a>, <a class="el" href="../../d6/d69/classoomph_1_1NonLinearElasticitySmoothMesh.html#a426905484f20903c02c995b297df36a6">oomph::NonLinearElasticitySmoothMesh&lt; ELEMENT &gt;::operator()()</a>, <a class="el" href="../../dd/d71/classOscRingNStProblem.html#a33023787bdd34ada9fae40f1b32ca339">OscRingNStProblem&lt; ELEMENT &gt;::OscRingNStProblem()</a>, <a class="el" href="../../d5/d62/classPerturbedStateProblem.html#a7fd730e7b1f73e4e9976510021bd488d">PerturbedStateProblem&lt; BASE_ELEMENT, PERTURBED_ELEMENT &gt;::PerturbedStateProblem()</a>, <a class="el" href="../../d8/d17/classPseudoSolidCapProblem.html#a4ac05a07dd55950bb67f7f79cb9fbb77">PseudoSolidCapProblem&lt; ELEMENT &gt;::PseudoSolidCapProblem()</a>, <a class="el" href="../../de/d23/classRefineableFishPoissonProblem.html#a2585d906fab348e09bfb9b4c111ac161">RefineableFishPoissonProblem&lt; ELEMENT &gt;::RefineableFishPoissonProblem()</a>, <a class="el" href="../../d2/d3d/classRefineableRotatingCylinderProblem.html#aa597c4240ce9affbd7540998167c8f21">RefineableRotatingCylinderProblem&lt; ELEMENT &gt;::RefineableRotatingCylinderProblem()</a>, <a class="el" href="../../dd/d43/classRefineableTwoMeshFluxPoissonProblem.html#a6568980564c4e39544b1c2bcb71cf3b6">RefineableTwoMeshFluxPoissonProblem&lt; ELEMENT &gt;::RefineableTwoMeshFluxPoissonProblem()</a>, <a class="el" href="../../d4/d68/classRefineableUnsteadyHeatProblem.html#a981eb6e1c3ac8386b02eeef299099d86">RefineableUnsteadyHeatProblem&lt; ELEMENT &gt;::RefineableUnsteadyHeatProblem()</a>, <a class="el" href="../../d7/d67/classSolidFreeSurfaceRotationProblem.html#aeccfc9698ea6b1ce021224453929691e">SolidFreeSurfaceRotationProblem&lt; ELEMENT &gt;::SolidFreeSurfaceRotationProblem()</a>, <a class="el" href="../../d7/d86/classSurfactantProblem.html#a7728f025db0a13dd910db96d6fb66832">SurfactantProblem&lt; ELEMENT, INTERFACE_ELEMENT &gt;::SurfactantProblem()</a>, <a class="el" href="../../d1/dfc/classTurekProblem.html#a69f6624fd854393f0c0e5303603ec749">TurekProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;::TurekProblem()</a>, <a class="el" href="../../db/d16/classTwoMeshFluxAdvectionDiffusionProblem.html#a7f3ec24317465521cb84212d1c2dc662">TwoMeshFluxAdvectionDiffusionProblem&lt; ELEMENT &gt;::TwoMeshFluxAdvectionDiffusionProblem()</a>, <a class="el" href="../../d0/d27/classTwoMeshFluxPoissonProblem.html#ace5a47aa61da5fd2a8761a16ffb3711c">TwoMeshFluxPoissonProblem&lt; ELEMENT &gt;::TwoMeshFluxPoissonProblem()</a>, <a class="el" href="../../d8/d28/classUnsteadyHeatProblem.html#abd3a46eea132b1e5872be6a6309a51b2">UnsteadyHeatProblem&lt; ELEMENT &gt;::UnsteadyHeatProblem()</a>, <a class="el" href="../../df/d77/classUnstructuredFvKProblem.html#ad2c3164bbc76c6ac35e4c090a8784f1e">UnstructuredFvKProblem&lt; ELEMENT &gt;::UnstructuredFvKProblem()</a>, and <a class="el" href="../../dc/dff/classUnstructuredSolidProblem.html#a18ce02b6e4bbc86403c9e1b32c095772">UnstructuredSolidProblem&lt; ELEMENT, MESH &gt;::UnstructuredSolidProblem()</a>.</p>

</div>
</div>
<a id="a533e7f2876442a1660e675aa225cbbe6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a533e7f2876442a1660e675aa225cbbe6">&#9670;&nbsp;</a></span>calculate_continuation_derivatives() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::calculate_continuation_derivatives </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;&#160;</td>
          <td class="paramname"><em>z</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>A function to calculate the derivatives with respect to the arc-length required for continuation. The arguments is the solution of the linear system, Jz = dR/dparameter, that gives du/dparameter and the direction output from the newton_solve_continuation function. The derivatives are stored in the ContinuationParameters namespace. </p>
<div class="fragment"><div class="line"><a name="l09793"></a><span class="lineno"> 9793</span>&#160;  {</div>
<div class="line"><a name="l09794"></a><span class="lineno"> 9794</span>&#160;    <span class="comment">// Calculate the continuation derivatives</span></div>
<div class="line"><a name="l09795"></a><span class="lineno"> 9795</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a420904bddcee85ee817dd9fcad0df216">calculate_continuation_derivatives_helper</a>(z);</div>
<div class="line"><a name="l09796"></a><span class="lineno"> 9796</span>&#160; </div>
<div class="line"><a name="l09797"></a><span class="lineno"> 9797</span>&#160;    <span class="comment">// Scale the value of theta if the control flag is set</span></div>
<div class="line"><a name="l09798"></a><span class="lineno"> 9798</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a708322baf423e373970384006c2ca4db">Scale_arc_length</a>)</div>
<div class="line"><a name="l09799"></a><span class="lineno"> 9799</span>&#160;    {</div>
<div class="line"><a name="l09800"></a><span class="lineno"> 9800</span>&#160;      <span class="comment">// Don&#39;t divide by zero!</span></div>
<div class="line"><a name="l09801"></a><span class="lineno"> 9801</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa5082325ca4cafe5a9ec03ef79c67a6f">Parameter_derivative</a> != 1.0)</div>
<div class="line"><a name="l09802"></a><span class="lineno"> 9802</span>&#160;      {</div>
<div class="line"><a name="l09803"></a><span class="lineno"> 9803</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a123843ca2ed6384342939ef2b19477ef">Theta_squared</a> *= (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa5082325ca4cafe5a9ec03ef79c67a6f">Parameter_derivative</a> * <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa5082325ca4cafe5a9ec03ef79c67a6f">Parameter_derivative</a> /</div>
<div class="line"><a name="l09804"></a><span class="lineno"> 9804</span>&#160;                          <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a37fb791188428c8186ffd5c52b6cf576">Desired_proportion_of_arc_length</a>) *</div>
<div class="line"><a name="l09805"></a><span class="lineno"> 9805</span>&#160;                         ((1.0 - <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a37fb791188428c8186ffd5c52b6cf576">Desired_proportion_of_arc_length</a>) /</div>
<div class="line"><a name="l09806"></a><span class="lineno"> 9806</span>&#160;                          (1.0 - <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa5082325ca4cafe5a9ec03ef79c67a6f">Parameter_derivative</a> * <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa5082325ca4cafe5a9ec03ef79c67a6f">Parameter_derivative</a>));</div>
<div class="line"><a name="l09807"></a><span class="lineno"> 9807</span>&#160; </div>
<div class="line"><a name="l09808"></a><span class="lineno"> 9808</span>&#160;        <span class="comment">// Recalculate the continuation derivatives with the new scaled values</span></div>
<div class="line"><a name="l09809"></a><span class="lineno"> 9809</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a420904bddcee85ee817dd9fcad0df216">calculate_continuation_derivatives_helper</a>(z);</div>
<div class="line"><a name="l09810"></a><span class="lineno"> 9810</span>&#160;      }</div>
<div class="line"><a name="l09811"></a><span class="lineno"> 9811</span>&#160;    }</div>
<div class="line"><a name="l09812"></a><span class="lineno"> 9812</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a420904bddcee85ee817dd9fcad0df216"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a420904bddcee85ee817dd9fcad0df216">oomph::Problem::calculate_continuation_derivatives_helper</a></div><div class="ttdeci">void calculate_continuation_derivatives_helper(const DoubleVector &amp;z)</div><div class="ttdef"><b>Definition:</b> problem.cc:9912</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a420904bddcee85ee817dd9fcad0df216">calculate_continuation_derivatives_helper()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a37fb791188428c8186ffd5c52b6cf576">Desired_proportion_of_arc_length</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa5082325ca4cafe5a9ec03ef79c67a6f">Parameter_derivative</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a708322baf423e373970384006c2ca4db">Scale_arc_length</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a123843ca2ed6384342939ef2b19477ef">Theta_squared</a>.</p>

</div>
</div>
<a id="a83463b9e0d3ebf86085c48c0e98c8f10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83463b9e0d3ebf86085c48c0e98c8f10">&#9670;&nbsp;</a></span>calculate_continuation_derivatives() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::calculate_continuation_derivatives </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;&#160;</td>
          <td class="paramname"><em>parameter_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>A function to calculate the derivatives wrt the arc-length. This version of the function actually does a linear solve so that the derivatives are calculated "exactly" rather than using the values at the Newton step just before convergence. This is necessary in spatially adaptive problems, in which the number of degrees of freedom changes and so the appropriate derivatives must be calculated for the new variables. This function is called if no Newton steps were taken in the continuation routine ... i.e. the initial residuals were sufficiently small.</p>
<p>A function to calculate the derivatives wrt the arc-length. This version of the function actually does a linear solve so that the derivatives are calculated "exactly" rather than using the values at the Newton step just before convergence. This is only necessary in spatially adaptive problems, in which the number of degrees of freedom changes and so the appropriate derivatives must be calculated for the new variables. </p>
<div class="fragment"><div class="line"><a name="l09716"></a><span class="lineno"> 9716</span>&#160;  {</div>
<div class="line"><a name="l09717"></a><span class="lineno"> 9717</span>&#160;    <span class="comment">// Find the number of degrees of freedom in the problem</span></div>
<div class="line"><a name="l09718"></a><span class="lineno"> 9718</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n_dofs = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>();</div>
<div class="line"><a name="l09719"></a><span class="lineno"> 9719</span>&#160; </div>
<div class="line"><a name="l09720"></a><span class="lineno"> 9720</span>&#160;    <span class="comment">// create a non-distributed z vector</span></div>
<div class="line"><a name="l09721"></a><span class="lineno"> 9721</span>&#160;    LinearAlgebraDistribution dist(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>, n_dofs, <span class="keyword">false</span>);</div>
<div class="line"><a name="l09722"></a><span class="lineno"> 9722</span>&#160; </div>
<div class="line"><a name="l09723"></a><span class="lineno"> 9723</span>&#160;    <span class="comment">// Assign memory for solutions of the equations</span></div>
<div class="line"><a name="l09724"></a><span class="lineno"> 9724</span>&#160;    <a class="code" href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a> z(&amp;dist, 0.0);</div>
<div class="line"><a name="l09725"></a><span class="lineno"> 9725</span>&#160; </div>
<div class="line"><a name="l09726"></a><span class="lineno"> 9726</span>&#160;    <span class="comment">// If it&#39;s the block hopf solver need to solve for both RHS</span></div>
<div class="line"><a name="l09727"></a><span class="lineno"> 9727</span>&#160;    <span class="comment">// at once, but this would all be alleviated if we have the solve</span></div>
<div class="line"><a name="l09728"></a><span class="lineno"> 9728</span>&#160;    <span class="comment">// for the non-residuals RHS.</span></div>
<div class="line"><a name="l09729"></a><span class="lineno"> 9729</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a199677d64d3b2f908690d10a2398b737">BlockHopfLinearSolver</a>*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a>))</div>
<div class="line"><a name="l09730"></a><span class="lineno"> 9730</span>&#160;    {</div>
<div class="line"><a name="l09731"></a><span class="lineno"> 9731</span>&#160;      <span class="comment">// Get the vector dresiduals/dparameter</span></div>
<div class="line"><a name="l09732"></a><span class="lineno"> 9732</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#adc456017cfc4fb4ae6f522973e50f496">get_derivative_wrt_global_parameter</a>(parameter_pt, z);</div>
<div class="line"><a name="l09733"></a><span class="lineno"> 9733</span>&#160; </div>
<div class="line"><a name="l09734"></a><span class="lineno"> 9734</span>&#160;      <span class="comment">// Copy rhs vector into local storage so it doesn&#39;t get overwritten</span></div>
<div class="line"><a name="l09735"></a><span class="lineno"> 9735</span>&#160;      <span class="comment">// if the linear solver decides to initialise the solution vector, say,</span></div>
<div class="line"><a name="l09736"></a><span class="lineno"> 9736</span>&#160;      <span class="comment">// which it&#39;s quite entitled to do!</span></div>
<div class="line"><a name="l09737"></a><span class="lineno"> 9737</span>&#160;      <a class="code" href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a> dummy(&amp;dist, 0.0), input_z(z);</div>
<div class="line"><a name="l09738"></a><span class="lineno"> 9738</span>&#160; </div>
<div class="line"><a name="l09739"></a><span class="lineno"> 9739</span>&#160;      <span class="comment">// Solve for the two RHSs</span></div>
<div class="line"><a name="l09740"></a><span class="lineno"> 9740</span>&#160;      <span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a199677d64d3b2f908690d10a2398b737">BlockHopfLinearSolver</a>*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a>)</div>
<div class="line"><a name="l09741"></a><span class="lineno"> 9741</span>&#160;        -&gt;solve_for_two_rhs(<span class="keyword">this</span>, dummy, input_z, z);</div>
<div class="line"><a name="l09742"></a><span class="lineno"> 9742</span>&#160;    }</div>
<div class="line"><a name="l09743"></a><span class="lineno"> 9743</span>&#160;    <span class="comment">// Otherwise we can use the normal resolve</span></div>
<div class="line"><a name="l09744"></a><span class="lineno"> 9744</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l09745"></a><span class="lineno"> 9745</span>&#160;    {</div>
<div class="line"><a name="l09746"></a><span class="lineno"> 9746</span>&#160;      <span class="comment">// Save the status before entry to this routine</span></div>
<div class="line"><a name="l09747"></a><span class="lineno"> 9747</span>&#160;      <span class="keywordtype">bool</span> enable_resolve = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a>-&gt;<a class="code" href="../../d5/dd7/classoomph_1_1LinearSolver.html#ae1e4d34a7e2b1537d36153f87e8a62a6">is_resolve_enabled</a>();</div>
<div class="line"><a name="l09748"></a><span class="lineno"> 9748</span>&#160; </div>
<div class="line"><a name="l09749"></a><span class="lineno"> 9749</span>&#160;      <span class="comment">// We need to do resolves</span></div>
<div class="line"><a name="l09750"></a><span class="lineno"> 9750</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a>-&gt;<a class="code" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a3000ebd9becb3468d8a6a821a9cc0cd9">enable_resolve</a>();</div>
<div class="line"><a name="l09751"></a><span class="lineno"> 9751</span>&#160; </div>
<div class="line"><a name="l09752"></a><span class="lineno"> 9752</span>&#160;      <span class="comment">// Solve the standard problem, we only want to make sure that</span></div>
<div class="line"><a name="l09753"></a><span class="lineno"> 9753</span>&#160;      <span class="comment">// we factorise the matrix, if it has not been factorised. We shall</span></div>
<div class="line"><a name="l09754"></a><span class="lineno"> 9754</span>&#160;      <span class="comment">// ignore the return value of z.</span></div>
<div class="line"><a name="l09755"></a><span class="lineno"> 9755</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a>-&gt;<a class="code" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a15ce22542b74ed1826ea485edacbeb6e">solve</a>(<span class="keyword">this</span>, z);</div>
<div class="line"><a name="l09756"></a><span class="lineno"> 9756</span>&#160; </div>
<div class="line"><a name="l09757"></a><span class="lineno"> 9757</span>&#160;      <span class="comment">// Get the vector dresiduals/dparameter</span></div>
<div class="line"><a name="l09758"></a><span class="lineno"> 9758</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#adc456017cfc4fb4ae6f522973e50f496">get_derivative_wrt_global_parameter</a>(parameter_pt, z);</div>
<div class="line"><a name="l09759"></a><span class="lineno"> 9759</span>&#160; </div>
<div class="line"><a name="l09760"></a><span class="lineno"> 9760</span>&#160; </div>
<div class="line"><a name="l09761"></a><span class="lineno"> 9761</span>&#160;      <span class="comment">// Copy rhs vector into local storage so it doesn&#39;t get overwritten</span></div>
<div class="line"><a name="l09762"></a><span class="lineno"> 9762</span>&#160;      <span class="comment">// if the linear solver decides to initialise the solution vector, say,</span></div>
<div class="line"><a name="l09763"></a><span class="lineno"> 9763</span>&#160;      <span class="comment">// which it&#39;s quite entitled to do!</span></div>
<div class="line"><a name="l09764"></a><span class="lineno"> 9764</span>&#160;      <a class="code" href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a> input_z(z);</div>
<div class="line"><a name="l09765"></a><span class="lineno"> 9765</span>&#160; </div>
<div class="line"><a name="l09766"></a><span class="lineno"> 9766</span>&#160;      <span class="comment">// Now resolve the system with the new RHS and overwrite the solution</span></div>
<div class="line"><a name="l09767"></a><span class="lineno"> 9767</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a>-&gt;<a class="code" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a3b310d08333033edc119b2a5bd7dcbfb">resolve</a>(input_z, z);</div>
<div class="line"><a name="l09768"></a><span class="lineno"> 9768</span>&#160; </div>
<div class="line"><a name="l09769"></a><span class="lineno"> 9769</span>&#160;      <span class="comment">// Restore the storage status of the linear solver</span></div>
<div class="line"><a name="l09770"></a><span class="lineno"> 9770</span>&#160;      <span class="keywordflow">if</span> (enable_resolve)</div>
<div class="line"><a name="l09771"></a><span class="lineno"> 9771</span>&#160;      {</div>
<div class="line"><a name="l09772"></a><span class="lineno"> 9772</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a>-&gt;<a class="code" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a3000ebd9becb3468d8a6a821a9cc0cd9">enable_resolve</a>();</div>
<div class="line"><a name="l09773"></a><span class="lineno"> 9773</span>&#160;      }</div>
<div class="line"><a name="l09774"></a><span class="lineno"> 9774</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l09775"></a><span class="lineno"> 9775</span>&#160;      {</div>
<div class="line"><a name="l09776"></a><span class="lineno"> 9776</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a>-&gt;<a class="code" href="../../d5/dd7/classoomph_1_1LinearSolver.html#ad61c63af94c5961830bd9807225a48d6">disable_resolve</a>();</div>
<div class="line"><a name="l09777"></a><span class="lineno"> 9777</span>&#160;      }</div>
<div class="line"><a name="l09778"></a><span class="lineno"> 9778</span>&#160;    }</div>
<div class="line"><a name="l09779"></a><span class="lineno"> 9779</span>&#160; </div>
<div class="line"><a name="l09780"></a><span class="lineno"> 9780</span>&#160;    <span class="comment">// Now, we can calculate the derivatives, etc</span></div>
<div class="line"><a name="l09781"></a><span class="lineno"> 9781</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a83463b9e0d3ebf86085c48c0e98c8f10">calculate_continuation_derivatives</a>(z);</div>
<div class="line"><a name="l09782"></a><span class="lineno"> 9782</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1LinearSolver_html_a15ce22542b74ed1826ea485edacbeb6e"><div class="ttname"><a href="../../d5/dd7/classoomph_1_1LinearSolver.html#a15ce22542b74ed1826ea485edacbeb6e">oomph::LinearSolver::solve</a></div><div class="ttdeci">virtual void solve(Problem *const &amp;problem_pt, DoubleVector &amp;result)=0</div></div>
<div class="ttc" id="aclassoomph_1_1LinearSolver_html_a3000ebd9becb3468d8a6a821a9cc0cd9"><div class="ttname"><a href="../../d5/dd7/classoomph_1_1LinearSolver.html#a3000ebd9becb3468d8a6a821a9cc0cd9">oomph::LinearSolver::enable_resolve</a></div><div class="ttdeci">virtual void enable_resolve()</div><div class="ttdef"><b>Definition:</b> linear_solver.h:135</div></div>
<div class="ttc" id="aclassoomph_1_1LinearSolver_html_a3b310d08333033edc119b2a5bd7dcbfb"><div class="ttname"><a href="../../d5/dd7/classoomph_1_1LinearSolver.html#a3b310d08333033edc119b2a5bd7dcbfb">oomph::LinearSolver::resolve</a></div><div class="ttdeci">virtual void resolve(const DoubleVector &amp;rhs, DoubleVector &amp;result)</div><div class="ttdef"><b>Definition:</b> linear_solver.h:225</div></div>
<div class="ttc" id="aclassoomph_1_1LinearSolver_html_ad61c63af94c5961830bd9807225a48d6"><div class="ttname"><a href="../../d5/dd7/classoomph_1_1LinearSolver.html#ad61c63af94c5961830bd9807225a48d6">oomph::LinearSolver::disable_resolve</a></div><div class="ttdeci">virtual void disable_resolve()</div><div class="ttdef"><b>Definition:</b> linear_solver.h:144</div></div>
<div class="ttc" id="aclassoomph_1_1LinearSolver_html_ae1e4d34a7e2b1537d36153f87e8a62a6"><div class="ttname"><a href="../../d5/dd7/classoomph_1_1LinearSolver.html#ae1e4d34a7e2b1537d36153f87e8a62a6">oomph::LinearSolver::is_resolve_enabled</a></div><div class="ttdeci">bool is_resolve_enabled() const</div><div class="ttdoc">Boolean flag indicating if resolves are enabled.</div><div class="ttdef"><b>Definition:</b> linear_solver.h:128</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_adc456017cfc4fb4ae6f522973e50f496"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#adc456017cfc4fb4ae6f522973e50f496">oomph::Problem::get_derivative_wrt_global_parameter</a></div><div class="ttdeci">void get_derivative_wrt_global_parameter(double *const &amp;parameter_pt, DoubleVector &amp;result)</div><div class="ttdef"><b>Definition:</b> problem.cc:7887</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>, <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#ad61c63af94c5961830bd9807225a48d6">oomph::LinearSolver::disable_resolve()</a>, <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a3000ebd9becb3468d8a6a821a9cc0cd9">oomph::LinearSolver::enable_resolve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#adc456017cfc4fb4ae6f522973e50f496">get_derivative_wrt_global_parameter()</a>, <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#ae1e4d34a7e2b1537d36153f87e8a62a6">oomph::LinearSolver::is_resolve_enabled()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof()</a>, <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a3b310d08333033edc119b2a5bd7dcbfb">oomph::LinearSolver::resolve()</a>, and <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a15ce22542b74ed1826ea485edacbeb6e">oomph::LinearSolver::solve()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acc35de219c1c1032a14840021fd8a6b9">arc_length_step_solve_helper()</a>.</p>

</div>
</div>
<a id="a8978d65572c5ae81f7381fa6a6d56ba0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8978d65572c5ae81f7381fa6a6d56ba0">&#9670;&nbsp;</a></span>calculate_continuation_derivatives_fd()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::calculate_continuation_derivatives_fd </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;&#160;</td>
          <td class="paramname"><em>parameter_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>A function to calculate the derivatives with respect to the arc-length required for continuation by finite differences, using the previous values of the solution. The derivatives are stored in the ContinuationParameters namespace.</p>
<p>A function to calculate the derivatives with respect to the arc-length required for continuation using finite differences. </p>
<div class="fragment"><div class="line"><a name="l09820"></a><span class="lineno"> 9820</span>&#160;  {</div>
<div class="line"><a name="l09821"></a><span class="lineno"> 9821</span>&#160;    <span class="comment">// Calculate the continuation derivatives</span></div>
<div class="line"><a name="l09822"></a><span class="lineno"> 9822</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a7a4dac8d3f4f06020b04a4af0a2d7b32">calculate_continuation_derivatives_fd_helper</a>(parameter_pt);</div>
<div class="line"><a name="l09823"></a><span class="lineno"> 9823</span>&#160; </div>
<div class="line"><a name="l09824"></a><span class="lineno"> 9824</span>&#160;    <span class="comment">// Scale the value of theta if the control flag is set</span></div>
<div class="line"><a name="l09825"></a><span class="lineno"> 9825</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a708322baf423e373970384006c2ca4db">Scale_arc_length</a>)</div>
<div class="line"><a name="l09826"></a><span class="lineno"> 9826</span>&#160;    {</div>
<div class="line"><a name="l09827"></a><span class="lineno"> 9827</span>&#160;      <span class="comment">// Don&#39;t divide by zero!</span></div>
<div class="line"><a name="l09828"></a><span class="lineno"> 9828</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa5082325ca4cafe5a9ec03ef79c67a6f">Parameter_derivative</a> != 1.0)</div>
<div class="line"><a name="l09829"></a><span class="lineno"> 9829</span>&#160;      {</div>
<div class="line"><a name="l09830"></a><span class="lineno"> 9830</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a123843ca2ed6384342939ef2b19477ef">Theta_squared</a> *= (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa5082325ca4cafe5a9ec03ef79c67a6f">Parameter_derivative</a> * <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa5082325ca4cafe5a9ec03ef79c67a6f">Parameter_derivative</a> /</div>
<div class="line"><a name="l09831"></a><span class="lineno"> 9831</span>&#160;                          <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a37fb791188428c8186ffd5c52b6cf576">Desired_proportion_of_arc_length</a>) *</div>
<div class="line"><a name="l09832"></a><span class="lineno"> 9832</span>&#160;                         ((1.0 - <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a37fb791188428c8186ffd5c52b6cf576">Desired_proportion_of_arc_length</a>) /</div>
<div class="line"><a name="l09833"></a><span class="lineno"> 9833</span>&#160;                          (1.0 - <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa5082325ca4cafe5a9ec03ef79c67a6f">Parameter_derivative</a> * <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa5082325ca4cafe5a9ec03ef79c67a6f">Parameter_derivative</a>));</div>
<div class="line"><a name="l09834"></a><span class="lineno"> 9834</span>&#160; </div>
<div class="line"><a name="l09835"></a><span class="lineno"> 9835</span>&#160;        <span class="comment">// Recalculate the continuation derivatives with the new scaled values</span></div>
<div class="line"><a name="l09836"></a><span class="lineno"> 9836</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a7a4dac8d3f4f06020b04a4af0a2d7b32">calculate_continuation_derivatives_fd_helper</a>(parameter_pt);</div>
<div class="line"><a name="l09837"></a><span class="lineno"> 9837</span>&#160;      }</div>
<div class="line"><a name="l09838"></a><span class="lineno"> 9838</span>&#160;    }</div>
<div class="line"><a name="l09839"></a><span class="lineno"> 9839</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a7a4dac8d3f4f06020b04a4af0a2d7b32"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a7a4dac8d3f4f06020b04a4af0a2d7b32">oomph::Problem::calculate_continuation_derivatives_fd_helper</a></div><div class="ttdeci">void calculate_continuation_derivatives_fd_helper(double *const &amp;parameter_pt)</div><div class="ttdef"><b>Definition:</b> problem.cc:10004</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7a4dac8d3f4f06020b04a4af0a2d7b32">calculate_continuation_derivatives_fd_helper()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a37fb791188428c8186ffd5c52b6cf576">Desired_proportion_of_arc_length</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa5082325ca4cafe5a9ec03ef79c67a6f">Parameter_derivative</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a708322baf423e373970384006c2ca4db">Scale_arc_length</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a123843ca2ed6384342939ef2b19477ef">Theta_squared</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acc35de219c1c1032a14840021fd8a6b9">arc_length_step_solve_helper()</a>.</p>

</div>
</div>
<a id="a7a4dac8d3f4f06020b04a4af0a2d7b32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a4dac8d3f4f06020b04a4af0a2d7b32">&#9670;&nbsp;</a></span>calculate_continuation_derivatives_fd_helper()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::calculate_continuation_derivatives_fd_helper </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;&#160;</td>
          <td class="paramname"><em>parameter_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>A function that performs the guts of the continuation derivative calculation in arc-length continuation problems using finite differences</p>
<p>A private helper function to calculate the derivatives with respect to the arc-length required for continuation using finite differences. </p>
<div class="fragment"><div class="line"><a name="l10006"></a><span class="lineno">10006</span>&#160;  {</div>
<div class="line"><a name="l10007"></a><span class="lineno">10007</span>&#160;    <span class="comment">// Find the number of values</span></div>
<div class="line"><a name="l10008"></a><span class="lineno">10008</span>&#160;    <span class="comment">// const unsigned long n_dofs = this-&gt;ndof();</span></div>
<div class="line"><a name="l10009"></a><span class="lineno">10009</span>&#160;    <span class="comment">// Find the number of local dofs in the problem</span></div>
<div class="line"><a name="l10010"></a><span class="lineno">10010</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ndof_local = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">nrow_local</a>();</div>
<div class="line"><a name="l10011"></a><span class="lineno">10011</span>&#160; </div>
<div class="line"><a name="l10012"></a><span class="lineno">10012</span>&#160;    <span class="comment">// Temporary storage for the finite-difference approximation to the helper</span></div>
<div class="line"><a name="l10013"></a><span class="lineno">10013</span>&#160;    Vector&lt;double&gt; z(ndof_local);</div>
<div class="line"><a name="l10014"></a><span class="lineno">10014</span>&#160;    <span class="keywordtype">double</span> length = 0.0;</div>
<div class="line"><a name="l10015"></a><span class="lineno">10015</span>&#160;    <span class="comment">// Calculate the change in values and contribution to total length</span></div>
<div class="line"><a name="l10016"></a><span class="lineno">10016</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l = 0; l &lt; ndof_local; l++)</div>
<div class="line"><a name="l10017"></a><span class="lineno">10017</span>&#160;    {</div>
<div class="line"><a name="l10018"></a><span class="lineno">10018</span>&#160;      z[l] = (*<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>[l] - <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a366b50c490e9fd3ddafa05b2fbd0b883">Dof_current</a>[l]) / <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad412d49617d0b0998e5eb440c7a20f3f">Ds_current</a>;</div>
<div class="line"><a name="l10019"></a><span class="lineno">10019</span>&#160;      length += <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a123843ca2ed6384342939ef2b19477ef">Theta_squared</a> * z[l] * z[l];</div>
<div class="line"><a name="l10020"></a><span class="lineno">10020</span>&#160;    }</div>
<div class="line"><a name="l10021"></a><span class="lineno">10021</span>&#160; </div>
<div class="line"><a name="l10022"></a><span class="lineno">10022</span>&#160;    <span class="comment">// Reduce if parallel</span></div>
<div class="line"><a name="l10023"></a><span class="lineno">10023</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l10024"></a><span class="lineno">10024</span>&#160;    <span class="keywordtype">double</span> length2 = length;</div>
<div class="line"><a name="l10025"></a><span class="lineno">10025</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a05842d032d28880ae37951deae804ad8">distributed</a>()) &amp;&amp;</div>
<div class="line"><a name="l10026"></a><span class="lineno">10026</span>&#160;        (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a2e4736826a65253f574d4f6f152ab514">communicator_pt</a>()-&gt;<a class="code" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a6c78c72666f4b102c2bccf200f0853b7">nproc</a>() &gt; 1))</div>
<div class="line"><a name="l10027"></a><span class="lineno">10027</span>&#160;    {</div>
<div class="line"><a name="l10028"></a><span class="lineno">10028</span>&#160;      MPI_Allreduce(&amp;length,</div>
<div class="line"><a name="l10029"></a><span class="lineno">10029</span>&#160;                    &amp;length2,</div>
<div class="line"><a name="l10030"></a><span class="lineno">10030</span>&#160;                    1,</div>
<div class="line"><a name="l10031"></a><span class="lineno">10031</span>&#160;                    MPI_DOUBLE,</div>
<div class="line"><a name="l10032"></a><span class="lineno">10032</span>&#160;                    MPI_SUM,</div>
<div class="line"><a name="l10033"></a><span class="lineno">10033</span>&#160;                    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a2e4736826a65253f574d4f6f152ab514">communicator_pt</a>()-&gt;mpi_comm());</div>
<div class="line"><a name="l10034"></a><span class="lineno">10034</span>&#160;    }</div>
<div class="line"><a name="l10035"></a><span class="lineno">10035</span>&#160;    length = length2;</div>
<div class="line"><a name="l10036"></a><span class="lineno">10036</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l10037"></a><span class="lineno">10037</span>&#160; </div>
<div class="line"><a name="l10038"></a><span class="lineno">10038</span>&#160;    <span class="comment">// Calculate change in parameter</span></div>
<div class="line"><a name="l10039"></a><span class="lineno">10039</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d5/d2c/icosphere_8cpp.html#a51591cf51bdd6c1f6015532422e7770e">Z</a> = (*parameter_pt - <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a8e29673eb80559888d1c6148c4f11e57">Parameter_current</a>) / <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad412d49617d0b0998e5eb440c7a20f3f">Ds_current</a>;</div>
<div class="line"><a name="l10040"></a><span class="lineno">10040</span>&#160;    length += <a class="code" href="../../d5/d2c/icosphere_8cpp.html#a51591cf51bdd6c1f6015532422e7770e">Z</a> * <a class="code" href="../../d5/d2c/icosphere_8cpp.html#a51591cf51bdd6c1f6015532422e7770e">Z</a>;</div>
<div class="line"><a name="l10041"></a><span class="lineno">10041</span>&#160; </div>
<div class="line"><a name="l10042"></a><span class="lineno">10042</span>&#160;    <span class="comment">// Scale the approximations to the derivatives</span></div>
<div class="line"><a name="l10043"></a><span class="lineno">10043</span>&#160;    length = <a class="code" href="../../d8/de9/AnnoyingScalar_8h.html#abe7b2405f1f05f9997193c680e8e2fe0">sqrt</a>(length);</div>
<div class="line"><a name="l10044"></a><span class="lineno">10044</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l = 0; l &lt; ndof_local; l++)</div>
<div class="line"><a name="l10045"></a><span class="lineno">10045</span>&#160;    {</div>
<div class="line"><a name="l10046"></a><span class="lineno">10046</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad6df5fb0d282f25df1e94a665dd838e5">dof_derivative</a>(l) = z[l] / length;</div>
<div class="line"><a name="l10047"></a><span class="lineno">10047</span>&#160;    }</div>
<div class="line"><a name="l10048"></a><span class="lineno">10048</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa5082325ca4cafe5a9ec03ef79c67a6f">Parameter_derivative</a> = <a class="code" href="../../d5/d2c/icosphere_8cpp.html#a51591cf51bdd6c1f6015532422e7770e">Z</a> / length;</div>
<div class="line"><a name="l10049"></a><span class="lineno">10049</span>&#160;  }</div>
<div class="ttc" id="aAnnoyingScalar_8h_html_abe7b2405f1f05f9997193c680e8e2fe0"><div class="ttname"><a href="../../d8/de9/AnnoyingScalar_8h.html#abe7b2405f1f05f9997193c680e8e2fe0">sqrt</a></div><div class="ttdeci">AnnoyingScalar sqrt(const AnnoyingScalar &amp;x)</div><div class="ttdef"><b>Definition:</b> AnnoyingScalar.h:134</div></div>
<div class="ttc" id="aclassoomph_1_1LinearAlgebraDistribution_html_a05842d032d28880ae37951deae804ad8"><div class="ttname"><a href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a05842d032d28880ae37951deae804ad8">oomph::LinearAlgebraDistribution::distributed</a></div><div class="ttdeci">bool distributed() const</div><div class="ttdef"><b>Definition:</b> linear_algebra_distribution.h:329</div></div>
<div class="ttc" id="aclassoomph_1_1LinearAlgebraDistribution_html_a2e4736826a65253f574d4f6f152ab514"><div class="ttname"><a href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a2e4736826a65253f574d4f6f152ab514">oomph::LinearAlgebraDistribution::communicator_pt</a></div><div class="ttdeci">OomphCommunicator * communicator_pt() const</div><div class="ttdoc">const access to the communicator pointer</div><div class="ttdef"><b>Definition:</b> linear_algebra_distribution.h:335</div></div>
<div class="ttc" id="aicosphere_8cpp_html_a51591cf51bdd6c1f6015532422e7770e"><div class="ttname"><a href="../../d5/d2c/icosphere_8cpp.html#a51591cf51bdd6c1f6015532422e7770e">Z</a></div><div class="ttdeci">#define Z</div><div class="ttdef"><b>Definition:</b> icosphere.cpp:21</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a2e4736826a65253f574d4f6f152ab514">oomph::LinearAlgebraDistribution::communicator_pt()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a05842d032d28880ae37951deae804ad8">oomph::LinearAlgebraDistribution::distributed()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a366b50c490e9fd3ddafa05b2fbd0b883">Dof_current</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad6df5fb0d282f25df1e94a665dd838e5">dof_derivative()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad412d49617d0b0998e5eb440c7a20f3f">Ds_current</a>, <a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a6c78c72666f4b102c2bccf200f0853b7">oomph::OomphCommunicator::nproc()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">oomph::LinearAlgebraDistribution::nrow_local()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a8e29673eb80559888d1c6148c4f11e57">Parameter_current</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa5082325ca4cafe5a9ec03ef79c67a6f">Parameter_derivative</a>, <a class="el" href="../../d8/de9/AnnoyingScalar_8h.html#abe7b2405f1f05f9997193c680e8e2fe0">sqrt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a123843ca2ed6384342939ef2b19477ef">Theta_squared</a>, and <a class="el" href="../../d5/d2c/icosphere_8cpp.html#a51591cf51bdd6c1f6015532422e7770e">Z</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a8978d65572c5ae81f7381fa6a6d56ba0">calculate_continuation_derivatives_fd()</a>.</p>

</div>
</div>
<a id="a420904bddcee85ee817dd9fcad0df216"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a420904bddcee85ee817dd9fcad0df216">&#9670;&nbsp;</a></span>calculate_continuation_derivatives_helper()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::calculate_continuation_derivatives_helper </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;&#160;</td>
          <td class="paramname"><em>z</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>A function that performs the guts of the continuation derivative calculation in arc length continuation problems.</p>
<p>A private helper function to calculate the derivatives with respect to the arc-length required for continuation. The arguments is the solution of the linear system, Jz = dR/dparameter, that gives du/dparameter and the direction output from the newton_solve_continuation function. The derivatives are stored in the ContinuationParameters namespace. </p>
<div class="fragment"><div class="line"><a name="l09913"></a><span class="lineno"> 9913</span>&#160;  {</div>
<div class="line"><a name="l09914"></a><span class="lineno"> 9914</span>&#160;    <span class="comment">// Find the number of degrees of freedom in the problem</span></div>
<div class="line"><a name="l09915"></a><span class="lineno"> 9915</span>&#160;    <span class="comment">// unsigned long n_dofs = ndof();</span></div>
<div class="line"><a name="l09916"></a><span class="lineno"> 9916</span>&#160;    <span class="comment">// Find the number of local dofs in the problem</span></div>
<div class="line"><a name="l09917"></a><span class="lineno"> 9917</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ndof_local = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">nrow_local</a>();</div>
<div class="line"><a name="l09918"></a><span class="lineno"> 9918</span>&#160; </div>
<div class="line"><a name="l09919"></a><span class="lineno"> 9919</span>&#160;    <span class="comment">// Work out the continuation direction</span></div>
<div class="line"><a name="l09920"></a><span class="lineno"> 9920</span>&#160;    <span class="comment">// The idea is that (du/ds)_{old} . (du/ds)_{new} &gt;= 0</span></div>
<div class="line"><a name="l09921"></a><span class="lineno"> 9921</span>&#160;    <span class="comment">// if the direction is to remain the same.</span></div>
<div class="line"><a name="l09922"></a><span class="lineno"> 9922</span>&#160;    <span class="comment">// du/ds_{new} = [dlambda/ds; du/ds] = [dlambda/ds ; - dlambda/ds z]</span></div>
<div class="line"><a name="l09923"></a><span class="lineno"> 9923</span>&#160;    <span class="comment">// so (du/ds)_{new} . (du/ds)_{old}</span></div>
<div class="line"><a name="l09924"></a><span class="lineno"> 9924</span>&#160;    <span class="comment">// = dlambda/ds [1 ; - z] . [ Parameter_derivative ; Dof_derivatives]</span></div>
<div class="line"><a name="l09925"></a><span class="lineno"> 9925</span>&#160;    <span class="comment">// = dlambda/ds (Parameter_derivative - Dof_derivative . z)</span></div>
<div class="line"><a name="l09926"></a><span class="lineno"> 9926</span>&#160; </div>
<div class="line"><a name="l09927"></a><span class="lineno"> 9927</span>&#160;    <span class="comment">// Create a local copy of z that can be redistributed without breaking</span></div>
<div class="line"><a name="l09928"></a><span class="lineno"> 9928</span>&#160;    <span class="comment">// the constness of z</span></div>
<div class="line"><a name="l09929"></a><span class="lineno"> 9929</span>&#160;    <a class="code" href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a> local_z(z);</div>
<div class="line"><a name="l09930"></a><span class="lineno"> 9930</span>&#160; </div>
<div class="line"><a name="l09931"></a><span class="lineno"> 9931</span>&#160;    <span class="comment">// Redistribute z so that it has the (natural) dof distribution</span></div>
<div class="line"><a name="l09932"></a><span class="lineno"> 9932</span>&#160;    local_z.redistribute(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>);</div>
<div class="line"><a name="l09933"></a><span class="lineno"> 9933</span>&#160; </div>
<div class="line"><a name="l09934"></a><span class="lineno"> 9934</span>&#160;    <span class="comment">// Calculate the local contribution to the Continuation direction</span></div>
<div class="line"><a name="l09935"></a><span class="lineno"> 9935</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a6904003416e9a9257db70c009bdc69ed">Continuation_direction</a> = 0.0;</div>
<div class="line"><a name="l09936"></a><span class="lineno"> 9936</span>&#160;    <span class="comment">// Cache the pointer to z</span></div>
<div class="line"><a name="l09937"></a><span class="lineno"> 9937</span>&#160;    <span class="keywordtype">double</span>* <span class="keyword">const</span> local_z_pt = local_z.values_pt();</div>
<div class="line"><a name="l09938"></a><span class="lineno"> 9938</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l = 0; l &lt; ndof_local; l++)</div>
<div class="line"><a name="l09939"></a><span class="lineno"> 9939</span>&#160;    {</div>
<div class="line"><a name="l09940"></a><span class="lineno"> 9940</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a6904003416e9a9257db70c009bdc69ed">Continuation_direction</a> -= <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad6df5fb0d282f25df1e94a665dd838e5">dof_derivative</a>(l) * local_z_pt[l];</div>
<div class="line"><a name="l09941"></a><span class="lineno"> 9941</span>&#160;    }</div>
<div class="line"><a name="l09942"></a><span class="lineno"> 9942</span>&#160; </div>
<div class="line"><a name="l09943"></a><span class="lineno"> 9943</span>&#160;    <span class="comment">// Now reduce if we have been distributed</span></div>
<div class="line"><a name="l09944"></a><span class="lineno"> 9944</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l09945"></a><span class="lineno"> 9945</span>&#160;    <span class="keywordtype">double</span> cont_dir2 = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a6904003416e9a9257db70c009bdc69ed">Continuation_direction</a>;</div>
<div class="line"><a name="l09946"></a><span class="lineno"> 9946</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a05842d032d28880ae37951deae804ad8">distributed</a>()) &amp;&amp;</div>
<div class="line"><a name="l09947"></a><span class="lineno"> 9947</span>&#160;        (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a2e4736826a65253f574d4f6f152ab514">communicator_pt</a>()-&gt;<a class="code" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a6c78c72666f4b102c2bccf200f0853b7">nproc</a>() &gt; 1))</div>
<div class="line"><a name="l09948"></a><span class="lineno"> 9948</span>&#160;    {</div>
<div class="line"><a name="l09949"></a><span class="lineno"> 9949</span>&#160;      MPI_Allreduce(&amp;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a6904003416e9a9257db70c009bdc69ed">Continuation_direction</a>,</div>
<div class="line"><a name="l09950"></a><span class="lineno"> 9950</span>&#160;                    &amp;cont_dir2,</div>
<div class="line"><a name="l09951"></a><span class="lineno"> 9951</span>&#160;                    1,</div>
<div class="line"><a name="l09952"></a><span class="lineno"> 9952</span>&#160;                    MPI_DOUBLE,</div>
<div class="line"><a name="l09953"></a><span class="lineno"> 9953</span>&#160;                    MPI_SUM,</div>
<div class="line"><a name="l09954"></a><span class="lineno"> 9954</span>&#160;                    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a2e4736826a65253f574d4f6f152ab514">communicator_pt</a>()-&gt;mpi_comm());</div>
<div class="line"><a name="l09955"></a><span class="lineno"> 9955</span>&#160;    }</div>
<div class="line"><a name="l09956"></a><span class="lineno"> 9956</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a6904003416e9a9257db70c009bdc69ed">Continuation_direction</a> = cont_dir2;</div>
<div class="line"><a name="l09957"></a><span class="lineno"> 9957</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l09958"></a><span class="lineno"> 9958</span>&#160; </div>
<div class="line"><a name="l09959"></a><span class="lineno"> 9959</span>&#160;    <span class="comment">// Add parameter derivative</span></div>
<div class="line"><a name="l09960"></a><span class="lineno"> 9960</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a6904003416e9a9257db70c009bdc69ed">Continuation_direction</a> += <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa5082325ca4cafe5a9ec03ef79c67a6f">Parameter_derivative</a>;</div>
<div class="line"><a name="l09961"></a><span class="lineno"> 9961</span>&#160; </div>
<div class="line"><a name="l09962"></a><span class="lineno"> 9962</span>&#160;    <span class="comment">// Calculate the magnitude of the du/ds Vector</span></div>
<div class="line"><a name="l09963"></a><span class="lineno"> 9963</span>&#160; </div>
<div class="line"><a name="l09964"></a><span class="lineno"> 9964</span>&#160;    <span class="comment">// Note that actually, we are usually approximating by using the value at</span></div>
<div class="line"><a name="l09965"></a><span class="lineno"> 9965</span>&#160;    <span class="comment">// newton step just before convergence, which saves one additional</span></div>
<div class="line"><a name="l09966"></a><span class="lineno"> 9966</span>&#160;    <span class="comment">// Newton solve.</span></div>
<div class="line"><a name="l09967"></a><span class="lineno"> 9967</span>&#160; </div>
<div class="line"><a name="l09968"></a><span class="lineno"> 9968</span>&#160;    <span class="comment">// First calculate the magnitude of du/dparameter, chi</span></div>
<div class="line"><a name="l09969"></a><span class="lineno"> 9969</span>&#160;    <span class="keywordtype">double</span> chi = local_z.dot(local_z);</div>
<div class="line"><a name="l09970"></a><span class="lineno"> 9970</span>&#160; </div>
<div class="line"><a name="l09971"></a><span class="lineno"> 9971</span>&#160;    <span class="comment">// Calculate the current derivative of the parameter wrt the arc-length</span></div>
<div class="line"><a name="l09972"></a><span class="lineno"> 9972</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa5082325ca4cafe5a9ec03ef79c67a6f">Parameter_derivative</a> = 1.0 / <a class="code" href="../../d8/de9/AnnoyingScalar_8h.html#abe7b2405f1f05f9997193c680e8e2fe0">sqrt</a>(1.0 + <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a123843ca2ed6384342939ef2b19477ef">Theta_squared</a> * chi);</div>
<div class="line"><a name="l09973"></a><span class="lineno"> 9973</span>&#160; </div>
<div class="line"><a name="l09974"></a><span class="lineno"> 9974</span>&#160;    <span class="comment">// If the dot product of the current derivative wrt the Direction</span></div>
<div class="line"><a name="l09975"></a><span class="lineno"> 9975</span>&#160;    <span class="comment">// is less than zero, switch the sign of the derivative to ensure</span></div>
<div class="line"><a name="l09976"></a><span class="lineno"> 9976</span>&#160;    <span class="comment">// smooth continuation</span></div>
<div class="line"><a name="l09977"></a><span class="lineno"> 9977</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa5082325ca4cafe5a9ec03ef79c67a6f">Parameter_derivative</a> * <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a6904003416e9a9257db70c009bdc69ed">Continuation_direction</a> &lt; 0.0)</div>
<div class="line"><a name="l09978"></a><span class="lineno"> 9978</span>&#160;    {</div>
<div class="line"><a name="l09979"></a><span class="lineno"> 9979</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa5082325ca4cafe5a9ec03ef79c67a6f">Parameter_derivative</a> *= -1.0;</div>
<div class="line"><a name="l09980"></a><span class="lineno"> 9980</span>&#160;    }</div>
<div class="line"><a name="l09981"></a><span class="lineno"> 9981</span>&#160; </div>
<div class="line"><a name="l09982"></a><span class="lineno"> 9982</span>&#160;    <span class="comment">// Resize the derivatives array, if necessary</span></div>
<div class="line"><a name="l09983"></a><span class="lineno"> 9983</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#adbecce0cb1bd7b6b21285568e41ee3eb">Use_continuation_timestepper</a>)</div>
<div class="line"><a name="l09984"></a><span class="lineno"> 9984</span>&#160;    {</div>
<div class="line"><a name="l09985"></a><span class="lineno"> 9985</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a1861321b2d129707935bf1191238daca">Dof_derivative</a>.size() != ndof_local)</div>
<div class="line"><a name="l09986"></a><span class="lineno"> 9986</span>&#160;      {</div>
<div class="line"><a name="l09987"></a><span class="lineno"> 9987</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a1861321b2d129707935bf1191238daca">Dof_derivative</a>.resize(ndof_local, 0.0);</div>
<div class="line"><a name="l09988"></a><span class="lineno"> 9988</span>&#160;      }</div>
<div class="line"><a name="l09989"></a><span class="lineno"> 9989</span>&#160;    }</div>
<div class="line"><a name="l09990"></a><span class="lineno"> 9990</span>&#160;    <span class="comment">// Calculate the new derivatives wrt the arc-length</span></div>
<div class="line"><a name="l09991"></a><span class="lineno"> 9991</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l = 0; l &lt; ndof_local; l++)</div>
<div class="line"><a name="l09992"></a><span class="lineno"> 9992</span>&#160;    {</div>
<div class="line"><a name="l09993"></a><span class="lineno"> 9993</span>&#160;      <span class="comment">// This comes from the formulation J u_dot + dr/dlambda  lambda_dot = 0</span></div>
<div class="line"><a name="l09994"></a><span class="lineno"> 9994</span>&#160;      <span class="comment">// on the curve and then it follows that.</span></div>
<div class="line"><a name="l09995"></a><span class="lineno"> 9995</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad6df5fb0d282f25df1e94a665dd838e5">dof_derivative</a>(l) = -<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa5082325ca4cafe5a9ec03ef79c67a6f">Parameter_derivative</a> * local_z_pt[l];</div>
<div class="line"><a name="l09996"></a><span class="lineno"> 9996</span>&#160;    }</div>
<div class="line"><a name="l09997"></a><span class="lineno"> 9997</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a2e4736826a65253f574d4f6f152ab514">oomph::LinearAlgebraDistribution::communicator_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6904003416e9a9257db70c009bdc69ed">Continuation_direction</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a05842d032d28880ae37951deae804ad8">oomph::LinearAlgebraDistribution::distributed()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a1861321b2d129707935bf1191238daca">Dof_derivative</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad6df5fb0d282f25df1e94a665dd838e5">dof_derivative()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#abd20e2e394c8e08749ed34c7228c8506">oomph::DoubleVector::dot()</a>, <a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a6c78c72666f4b102c2bccf200f0853b7">oomph::OomphCommunicator::nproc()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">oomph::LinearAlgebraDistribution::nrow_local()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa5082325ca4cafe5a9ec03ef79c67a6f">Parameter_derivative</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#a9396b861977c16606d8eca39056976c8">oomph::DoubleVector::redistribute()</a>, <a class="el" href="../../d8/de9/AnnoyingScalar_8h.html#abe7b2405f1f05f9997193c680e8e2fe0">sqrt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a123843ca2ed6384342939ef2b19477ef">Theta_squared</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#adbecce0cb1bd7b6b21285568e41ee3eb">Use_continuation_timestepper</a>, and <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#a8c3dcdf8a602a1f266bbe72d98fde2e7">oomph::DoubleVector::values_pt()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a533e7f2876442a1660e675aa225cbbe6">calculate_continuation_derivatives()</a>.</p>

</div>
</div>
<a id="acbc0b0fc5d5cc76ce8384bc0bd815f26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acbc0b0fc5d5cc76ce8384bc0bd815f26">&#9670;&nbsp;</a></span>calculate_predictions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::calculate_predictions </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate predictions. </p>
<p>Calculate the predictions of all variables in problem. </p>
<div class="fragment"><div class="line"><a name="l11657"></a><span class="lineno">11657</span>&#160;  {</div>
<div class="line"><a name="l11658"></a><span class="lineno">11658</span>&#160;<span class="comment">// Check that if we have multiple time steppers none of them want to</span></div>
<div class="line"><a name="l11659"></a><span class="lineno">11659</span>&#160;<span class="comment">// predict by calling an explicit timestepper (as opposed to doing</span></div>
<div class="line"><a name="l11660"></a><span class="lineno">11660</span>&#160;<span class="comment">// something like an explicit step by combining known history values, as</span></div>
<div class="line"><a name="l11661"></a><span class="lineno">11661</span>&#160;<span class="comment">// done in BDF).</span></div>
<div class="line"><a name="l11662"></a><span class="lineno">11662</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l11663"></a><span class="lineno">11663</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#af1e8f8a739453250eb3744fea2a3b983">Time_stepper_pt</a>.size() != 1)</div>
<div class="line"><a name="l11664"></a><span class="lineno">11664</span>&#160;    {</div>
<div class="line"><a name="l11665"></a><span class="lineno">11665</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#af1e8f8a739453250eb3744fea2a3b983">Time_stepper_pt</a>.size(); <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l11666"></a><span class="lineno">11666</span>&#160;      {</div>
<div class="line"><a name="l11667"></a><span class="lineno">11667</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>()-&gt;predict_by_explicit_step())</div>
<div class="line"><a name="l11668"></a><span class="lineno">11668</span>&#160;        {</div>
<div class="line"><a name="l11669"></a><span class="lineno">11669</span>&#160;          <a class="code" href="../../d2/dc3/namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">std::string</a> err = <span class="stringliteral">&quot;Prediction by explicit step only works for &quot;</span></div>
<div class="line"><a name="l11670"></a><span class="lineno">11670</span>&#160;                            <span class="stringliteral">&quot;problems with a simple time&quot;</span>;</div>
<div class="line"><a name="l11671"></a><span class="lineno">11671</span>&#160;          err += <span class="stringliteral">&quot;stepper. I think implementing anything more general will&quot;</span>;</div>
<div class="line"><a name="l11672"></a><span class="lineno">11672</span>&#160;          err += <span class="stringliteral">&quot;require a rewrite of explicit time steppers. - David&quot;</span>;</div>
<div class="line"><a name="l11673"></a><span class="lineno">11673</span>&#160;          <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l11674"></a><span class="lineno">11674</span>&#160;            err, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>);</div>
<div class="line"><a name="l11675"></a><span class="lineno">11675</span>&#160;        }</div>
<div class="line"><a name="l11676"></a><span class="lineno">11676</span>&#160;      }</div>
<div class="line"><a name="l11677"></a><span class="lineno">11677</span>&#160;    }</div>
<div class="line"><a name="l11678"></a><span class="lineno">11678</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l11679"></a><span class="lineno">11679</span>&#160; </div>
<div class="line"><a name="l11680"></a><span class="lineno">11680</span>&#160; </div>
<div class="line"><a name="l11681"></a><span class="lineno">11681</span>&#160;    <span class="comment">// Predict using an explicit timestepper (don&#39;t do it if adaptive = false</span></div>
<div class="line"><a name="l11682"></a><span class="lineno">11682</span>&#160;    <span class="comment">// because pointers probably aren&#39;t set up).</span></div>
<div class="line"><a name="l11683"></a><span class="lineno">11683</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>()-&gt;predict_by_explicit_step() &amp;&amp;</div>
<div class="line"><a name="l11684"></a><span class="lineno">11684</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>()-&gt;adaptive_flag())</div>
<div class="line"><a name="l11685"></a><span class="lineno">11685</span>&#160;    {</div>
<div class="line"><a name="l11686"></a><span class="lineno">11686</span>&#160;      <span class="comment">// Copy the time stepper&#39;s predictor pt into problem&#39;s explicit time</span></div>
<div class="line"><a name="l11687"></a><span class="lineno">11687</span>&#160;      <span class="comment">// stepper pt (unless problem already has its own explicit time</span></div>
<div class="line"><a name="l11688"></a><span class="lineno">11688</span>&#160;      <span class="comment">// stepper).</span></div>
<div class="line"><a name="l11689"></a><span class="lineno">11689</span>&#160;      ExplicitTimeStepper* ets_pt = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>()-&gt;<a class="code" href="../../d5/d19/classoomph_1_1TimeStepper.html#ab570dfd6a22d73079599a97d462de9ef">explicit_predictor_pt</a>();</div>
<div class="line"><a name="l11690"></a><span class="lineno">11690</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l11691"></a><span class="lineno">11691</span>&#160;      <span class="keywordflow">if</span> (ets_pt == 0)</div>
<div class="line"><a name="l11692"></a><span class="lineno">11692</span>&#160;      {</div>
<div class="line"><a name="l11693"></a><span class="lineno">11693</span>&#160;        <a class="code" href="../../d2/dc3/namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">std::string</a> err = <span class="stringliteral">&quot;Requested predictions by explicit step but explicit&quot;</span>;</div>
<div class="line"><a name="l11694"></a><span class="lineno">11694</span>&#160;        err += <span class="stringliteral">&quot; predictor pt is null.&quot;</span>;</div>
<div class="line"><a name="l11695"></a><span class="lineno">11695</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l11696"></a><span class="lineno">11696</span>&#160;          err, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l11697"></a><span class="lineno">11697</span>&#160;      }</div>
<div class="line"><a name="l11698"></a><span class="lineno">11698</span>&#160; </div>
<div class="line"><a name="l11699"></a><span class="lineno">11699</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ac332634783a803c1c21bf5c520af280f">explicit_time_stepper_pt</a>() != ets_pt) &amp;&amp;</div>
<div class="line"><a name="l11700"></a><span class="lineno">11700</span>&#160;          (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ac332634783a803c1c21bf5c520af280f">explicit_time_stepper_pt</a>() != 0))</div>
<div class="line"><a name="l11701"></a><span class="lineno">11701</span>&#160;      {</div>
<div class="line"><a name="l11702"></a><span class="lineno">11702</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(<span class="stringliteral">&quot;Problem has explicit time stepper other than &quot;</span></div>
<div class="line"><a name="l11703"></a><span class="lineno">11703</span>&#160;                            <span class="stringliteral">&quot;predictor, not sure how to handle this yet ??ds&quot;</span>,</div>
<div class="line"><a name="l11704"></a><span class="lineno">11704</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>,</div>
<div class="line"><a name="l11705"></a><span class="lineno">11705</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>);</div>
<div class="line"><a name="l11706"></a><span class="lineno">11706</span>&#160;      }</div>
<div class="line"><a name="l11707"></a><span class="lineno">11707</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l11708"></a><span class="lineno">11708</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ac332634783a803c1c21bf5c520af280f">explicit_time_stepper_pt</a>() = ets_pt;</div>
<div class="line"><a name="l11709"></a><span class="lineno">11709</span>&#160; </div>
<div class="line"><a name="l11710"></a><span class="lineno">11710</span>&#160;      <span class="comment">// Backup dofs and time</span></div>
<div class="line"><a name="l11711"></a><span class="lineno">11711</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ac3ed0463968bd0fef5d9b97bcb8ca163">store_current_dof_values</a>();</div>
<div class="line"><a name="l11712"></a><span class="lineno">11712</span>&#160; </div>
<div class="line"><a name="l11713"></a><span class="lineno">11713</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l11714"></a><span class="lineno">11714</span>&#160;      <span class="keywordtype">double</span> backup_time = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#affda31840308a51d36324e6debe1bee7">time</a>();</div>
<div class="line"><a name="l11715"></a><span class="lineno">11715</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l11716"></a><span class="lineno">11716</span>&#160; </div>
<div class="line"><a name="l11717"></a><span class="lineno">11717</span>&#160;      <span class="comment">// Move time back so that we are at the start of the timestep (as</span></div>
<div class="line"><a name="l11718"></a><span class="lineno">11718</span>&#160;      <span class="comment">// explicit_timestep functions expect). This is needed because the</span></div>
<div class="line"><a name="l11719"></a><span class="lineno">11719</span>&#160;      <span class="comment">// predictor calculations are done after unsteady newton solve has</span></div>
<div class="line"><a name="l11720"></a><span class="lineno">11720</span>&#160;      <span class="comment">// started, and it has already moved time forwards.</span></div>
<div class="line"><a name="l11721"></a><span class="lineno">11721</span>&#160;      <span class="keywordtype">double</span> dt = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a46894b13c582f322082dc471a2485980">time_pt</a>()-&gt;<a class="code" href="../../d0/da1/classoomph_1_1Time.html#a2c684e0a69db7adde90f1f052e424a6b">dt</a>();</div>
<div class="line"><a name="l11722"></a><span class="lineno">11722</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#affda31840308a51d36324e6debe1bee7">time</a>() -= dt;</div>
<div class="line"><a name="l11723"></a><span class="lineno">11723</span>&#160; </div>
<div class="line"><a name="l11724"></a><span class="lineno">11724</span>&#160;      <span class="comment">// Explicit step</span></div>
<div class="line"><a name="l11725"></a><span class="lineno">11725</span>&#160;      this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a2eff0725bba4f2435bcc4797a9e59ab4">explicit_timestep</a>(dt, <span class="keyword">false</span>);</div>
<div class="line"><a name="l11726"></a><span class="lineno">11726</span>&#160; </div>
<div class="line"><a name="l11727"></a><span class="lineno">11727</span>&#160;      <span class="comment">// Copy predicted dofs and time to their storage slots.</span></div>
<div class="line"><a name="l11728"></a><span class="lineno">11728</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a07c3df43aef20537f8d192c2fc203836">set_dofs</a>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>()-&gt;predictor_storage_index(), <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>);</div>
<div class="line"><a name="l11729"></a><span class="lineno">11729</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>()-&gt;<a class="code" href="../../d5/d19/classoomph_1_1TimeStepper.html#ab9813c8ea8ad981f0db9a467302b9cd0">update_predicted_time</a>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#affda31840308a51d36324e6debe1bee7">time</a>());</div>
<div class="line"><a name="l11730"></a><span class="lineno">11730</span>&#160; </div>
<div class="line"><a name="l11731"></a><span class="lineno">11731</span>&#160;      <span class="comment">// Check we got the times right</span></div>
<div class="line"><a name="l11732"></a><span class="lineno">11732</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l11733"></a><span class="lineno">11733</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d8/de9/AnnoyingScalar_8h.html#a0b723dc4b77525f0cc278538ff494e29">std::abs</a>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#affda31840308a51d36324e6debe1bee7">time</a>() - backup_time) &gt; 1<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>-12)</div>
<div class="line"><a name="l11734"></a><span class="lineno">11734</span>&#160;      {</div>
<div class="line"><a name="l11735"></a><span class="lineno">11735</span>&#160;        <span class="keyword">using namespace </span>StringConversion;</div>
<div class="line"><a name="l11736"></a><span class="lineno">11736</span>&#160;        <a class="code" href="../../d2/dc3/namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">std::string</a> err = <span class="stringliteral">&quot;Predictor landed at the wrong time!&quot;</span>;</div>
<div class="line"><a name="l11737"></a><span class="lineno">11737</span>&#160;        err += <span class="stringliteral">&quot; Expected time &quot;</span> + <a class="code" href="../../d0/d49/namespaceoomph_1_1StringConversion.html#a9d30fabdc1a0694bdb91dddd2833bbd6">to_string</a>(backup_time, 14) + <span class="stringliteral">&quot; but got &quot;</span>;</div>
<div class="line"><a name="l11738"></a><span class="lineno">11738</span>&#160;        err += <a class="code" href="../../d0/d49/namespaceoomph_1_1StringConversion.html#a9d30fabdc1a0694bdb91dddd2833bbd6">to_string</a>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#affda31840308a51d36324e6debe1bee7">time</a>(), 14);</div>
<div class="line"><a name="l11739"></a><span class="lineno">11739</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l11740"></a><span class="lineno">11740</span>&#160;          err, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>);</div>
<div class="line"><a name="l11741"></a><span class="lineno">11741</span>&#160;      }</div>
<div class="line"><a name="l11742"></a><span class="lineno">11742</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l11743"></a><span class="lineno">11743</span>&#160; </div>
<div class="line"><a name="l11744"></a><span class="lineno">11744</span>&#160;      <span class="comment">// Restore dofs and time</span></div>
<div class="line"><a name="l11745"></a><span class="lineno">11745</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a3c927ed4f3e79527e0e23ac44779f0f8">restore_dof_values</a>();</div>
<div class="line"><a name="l11746"></a><span class="lineno">11746</span>&#160;    }</div>
<div class="line"><a name="l11747"></a><span class="lineno">11747</span>&#160; </div>
<div class="line"><a name="l11748"></a><span class="lineno">11748</span>&#160;    <span class="comment">// Otherwise we can do predictions in a more object oriented way using</span></div>
<div class="line"><a name="l11749"></a><span class="lineno">11749</span>&#160;    <span class="comment">// whatever timestepper the data provides (this is the normal case).</span></div>
<div class="line"><a name="l11750"></a><span class="lineno">11750</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l11751"></a><span class="lineno">11751</span>&#160;    {</div>
<div class="line"><a name="l11752"></a><span class="lineno">11752</span>&#160;      <span class="comment">// Calculate all predictions in the &quot;master&quot; mesh</span></div>
<div class="line"><a name="l11753"></a><span class="lineno">11753</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a823b11b11e6a0c3c22ea86dc60a3da65">calculate_predictions</a>();</div>
<div class="line"><a name="l11754"></a><span class="lineno">11754</span>&#160; </div>
<div class="line"><a name="l11755"></a><span class="lineno">11755</span>&#160;      <span class="comment">// Calculate predictions for global data with their own timesteppers</span></div>
<div class="line"><a name="l11756"></a><span class="lineno">11756</span>&#160;      <span class="keywordtype">unsigned</span> Nglobal = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>.size();</div>
<div class="line"><a name="l11757"></a><span class="lineno">11757</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> iglobal = 0; iglobal &lt; Nglobal; iglobal++)</div>
<div class="line"><a name="l11758"></a><span class="lineno">11758</span>&#160;      {</div>
<div class="line"><a name="l11759"></a><span class="lineno">11759</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>[iglobal]-&gt;time_stepper_pt()-&gt;calculate_predicted_values(</div>
<div class="line"><a name="l11760"></a><span class="lineno">11760</span>&#160;          <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>[iglobal]);</div>
<div class="line"><a name="l11761"></a><span class="lineno">11761</span>&#160;      }</div>
<div class="line"><a name="l11762"></a><span class="lineno">11762</span>&#160;    }</div>
<div class="line"><a name="l11763"></a><span class="lineno">11763</span>&#160; </div>
<div class="line"><a name="l11764"></a><span class="lineno">11764</span>&#160;    <span class="comment">// If requested then copy the predicted value into the current time data</span></div>
<div class="line"><a name="l11765"></a><span class="lineno">11765</span>&#160;    <span class="comment">// slots, ready for the newton solver to use as an initial guess.</span></div>
<div class="line"><a name="l11766"></a><span class="lineno">11766</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a438bf1c7aafffda56f2acb34ba027fdb">use_predictor_values_as_initial_guess</a>())</div>
<div class="line"><a name="l11767"></a><span class="lineno">11767</span>&#160;    {</div>
<div class="line"><a name="l11768"></a><span class="lineno">11768</span>&#160;      <span class="comment">// Not sure I know enough about distributed problems to implement</span></div>
<div class="line"><a name="l11769"></a><span class="lineno">11769</span>&#160;      <span class="comment">// this. Probably you just need to loop over ndof_local or something,</span></div>
<div class="line"><a name="l11770"></a><span class="lineno">11770</span>&#160;      <span class="comment">// but I can&#39;t really test it...</span></div>
<div class="line"><a name="l11771"></a><span class="lineno">11771</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l11772"></a><span class="lineno">11772</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#af5e9f1623cad361048856a4c0463ea23">distributed</a>())</div>
<div class="line"><a name="l11773"></a><span class="lineno">11773</span>&#160;      {</div>
<div class="line"><a name="l11774"></a><span class="lineno">11774</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(<span class="stringliteral">&quot;Not yet implemented for distributed problems&quot;</span>,</div>
<div class="line"><a name="l11775"></a><span class="lineno">11775</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>,</div>
<div class="line"><a name="l11776"></a><span class="lineno">11776</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>);</div>
<div class="line"><a name="l11777"></a><span class="lineno">11777</span>&#160;      }</div>
<div class="line"><a name="l11778"></a><span class="lineno">11778</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l11779"></a><span class="lineno">11779</span>&#160; </div>
<div class="line"><a name="l11780"></a><span class="lineno">11780</span>&#160;      <span class="comment">// With multiple time steppers this is much more complex becuase you</span></div>
<div class="line"><a name="l11781"></a><span class="lineno">11781</span>&#160;      <span class="comment">// need to check the time stepper for each data to get the</span></div>
<div class="line"><a name="l11782"></a><span class="lineno">11782</span>&#160;      <span class="comment">// predictor_storage_index(). Do-able if you need it though.</span></div>
<div class="line"><a name="l11783"></a><span class="lineno">11783</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#af1e8f8a739453250eb3744fea2a3b983">Time_stepper_pt</a>.size() != 1)</div>
<div class="line"><a name="l11784"></a><span class="lineno">11784</span>&#160;      {</div>
<div class="line"><a name="l11785"></a><span class="lineno">11785</span>&#160;        <a class="code" href="../../d2/dc3/namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">std::string</a> err = <span class="stringliteral">&quot;Not implemented for multiple time steppers&quot;</span>;</div>
<div class="line"><a name="l11786"></a><span class="lineno">11786</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l11787"></a><span class="lineno">11787</span>&#160;          err, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>);</div>
<div class="line"><a name="l11788"></a><span class="lineno">11788</span>&#160;      }</div>
<div class="line"><a name="l11789"></a><span class="lineno">11789</span>&#160; </div>
<div class="line"><a name="l11790"></a><span class="lineno">11790</span>&#160;      <span class="comment">// Get predicted values</span></div>
<div class="line"><a name="l11791"></a><span class="lineno">11791</span>&#160;      <a class="code" href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a> predicted_dofs;</div>
<div class="line"><a name="l11792"></a><span class="lineno">11792</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a11c1432869386bb49f16da15545bfee7">get_dofs</a>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>()-&gt;predictor_storage_index(), predicted_dofs);</div>
<div class="line"><a name="l11793"></a><span class="lineno">11793</span>&#160; </div>
<div class="line"><a name="l11794"></a><span class="lineno">11794</span>&#160;      <span class="comment">// Update dofs at current step</span></div>
<div class="line"><a name="l11795"></a><span class="lineno">11795</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>(); <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l11796"></a><span class="lineno">11796</span>&#160;      {</div>
<div class="line"><a name="l11797"></a><span class="lineno">11797</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a74d71439b100fb5b66b94d1d69130f7c">dof</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = predicted_dofs[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l11798"></a><span class="lineno">11798</span>&#160;      }</div>
<div class="line"><a name="l11799"></a><span class="lineno">11799</span>&#160;    }</div>
<div class="line"><a name="l11800"></a><span class="lineno">11800</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_a823b11b11e6a0c3c22ea86dc60a3da65"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#a823b11b11e6a0c3c22ea86dc60a3da65">oomph::Mesh::calculate_predictions</a></div><div class="ttdeci">void calculate_predictions()</div><div class="ttdef"><b>Definition:</b> mesh.cc:2366</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a07c3df43aef20537f8d192c2fc203836"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a07c3df43aef20537f8d192c2fc203836">oomph::Problem::set_dofs</a></div><div class="ttdeci">void set_dofs(const DoubleVector &amp;dofs)</div><div class="ttdoc">Set the values of the dofs.</div><div class="ttdef"><b>Definition:</b> problem.cc:3411</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a11c1432869386bb49f16da15545bfee7"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a11c1432869386bb49f16da15545bfee7">oomph::Problem::get_dofs</a></div><div class="ttdeci">void get_dofs(DoubleVector &amp;dofs) const</div><div class="ttdef"><b>Definition:</b> problem.cc:2479</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a2eff0725bba4f2435bcc4797a9e59ab4"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a2eff0725bba4f2435bcc4797a9e59ab4">oomph::Problem::explicit_timestep</a></div><div class="ttdeci">void explicit_timestep(const double &amp;dt, const bool &amp;shift_values=true)</div><div class="ttdoc">Take an explicit timestep of size dt.</div><div class="ttdef"><b>Definition:</b> problem.cc:10918</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a3c927ed4f3e79527e0e23ac44779f0f8"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a3c927ed4f3e79527e0e23ac44779f0f8">oomph::Problem::restore_dof_values</a></div><div class="ttdeci">void restore_dof_values()</div><div class="ttdoc">Restore the stored values of the degrees of freedom.</div><div class="ttdef"><b>Definition:</b> problem.cc:8653</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a438bf1c7aafffda56f2acb34ba027fdb"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a438bf1c7aafffda56f2acb34ba027fdb">oomph::Problem::use_predictor_values_as_initial_guess</a></div><div class="ttdeci">bool &amp; use_predictor_values_as_initial_guess()</div><div class="ttdef"><b>Definition:</b> problem.h:1994</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_ac332634783a803c1c21bf5c520af280f"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#ac332634783a803c1c21bf5c520af280f">oomph::Problem::explicit_time_stepper_pt</a></div><div class="ttdeci">ExplicitTimeStepper *&amp; explicit_time_stepper_pt()</div><div class="ttdoc">Return a pointer to the explicit timestepper.</div><div class="ttdef"><b>Definition:</b> problem.h:1555</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_ac3ed0463968bd0fef5d9b97bcb8ca163"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#ac3ed0463968bd0fef5d9b97bcb8ca163">oomph::Problem::store_current_dof_values</a></div><div class="ttdeci">void store_current_dof_values()</div><div class="ttdoc">Store the current values of the degrees of freedom.</div><div class="ttdef"><b>Definition:</b> problem.cc:8607</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_af5e9f1623cad361048856a4c0463ea23"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#af5e9f1623cad361048856a4c0463ea23">oomph::Problem::distributed</a></div><div class="ttdeci">bool distributed() const</div><div class="ttdef"><b>Definition:</b> problem.h:808</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_affda31840308a51d36324e6debe1bee7"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#affda31840308a51d36324e6debe1bee7">oomph::Problem::time</a></div><div class="ttdeci">double &amp; time()</div><div class="ttdoc">Return the current value of continuous time.</div><div class="ttdef"><b>Definition:</b> problem.cc:11531</div></div>
<div class="ttc" id="aclassoomph_1_1TimeStepper_html_ab570dfd6a22d73079599a97d462de9ef"><div class="ttname"><a href="../../d5/d19/classoomph_1_1TimeStepper.html#ab570dfd6a22d73079599a97d462de9ef">oomph::TimeStepper::explicit_predictor_pt</a></div><div class="ttdeci">ExplicitTimeStepper * explicit_predictor_pt()</div><div class="ttdef"><b>Definition:</b> timesteppers.h:403</div></div>
<div class="ttc" id="aclassoomph_1_1TimeStepper_html_ab9813c8ea8ad981f0db9a467302b9cd0"><div class="ttname"><a href="../../d5/d19/classoomph_1_1TimeStepper.html#ab9813c8ea8ad981f0db9a467302b9cd0">oomph::TimeStepper::update_predicted_time</a></div><div class="ttdeci">void update_predicted_time(const double &amp;new_time)</div><div class="ttdef"><b>Definition:</b> timesteppers.h:417</div></div>
<div class="ttc" id="anamespaceoomph_1_1StringConversion_html_a9d30fabdc1a0694bdb91dddd2833bbd6"><div class="ttname"><a href="../../d0/d49/namespaceoomph_1_1StringConversion.html#a9d30fabdc1a0694bdb91dddd2833bbd6">oomph::StringConversion::to_string</a></div><div class="ttdeci">std::string to_string(T object, unsigned float_precision=8)</div><div class="ttdef"><b>Definition:</b> oomph_utilities.h:189</div></div>
<div class="ttc" id="atut__arithmetic__redux__minmax_8cpp_html_a39513f0f8d942bf9ef17b2e87ac6d34e"><div class="ttname"><a href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a></div><div class="ttdeci">std::ptrdiff_t j</div><div class="ttdef"><b>Definition:</b> tut_arithmetic_redux_minmax.cpp:2</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d8/de9/AnnoyingScalar_8h.html#a0b723dc4b77525f0cc278538ff494e29">abs()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a823b11b11e6a0c3c22ea86dc60a3da65">oomph::Mesh::calculate_predictions()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af5e9f1623cad361048856a4c0463ea23">distributed()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a74d71439b100fb5b66b94d1d69130f7c">dof()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>, <a class="el" href="../../d0/da1/classoomph_1_1Time.html#a2c684e0a69db7adde90f1f052e424a6b">oomph::Time::dt()</a>, <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html#ab570dfd6a22d73079599a97d462de9ef">oomph::TimeStepper::explicit_predictor_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac332634783a803c1c21bf5c520af280f">explicit_time_stepper_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a2eff0725bba4f2435bcc4797a9e59ab4">explicit_timestep()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a11c1432869386bb49f16da15545bfee7">get_dofs()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a3c927ed4f3e79527e0e23ac44779f0f8">restore_dof_values()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a07c3df43aef20537f8d192c2fc203836">set_dofs()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac3ed0463968bd0fef5d9b97bcb8ca163">store_current_dof_values()</a>, <a class="el" href="../../d2/dc3/namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">oomph::Global_string_for_annotation::string()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#affda31840308a51d36324e6debe1bee7">time()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a46894b13c582f322082dc471a2485980">time_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af1e8f8a739453250eb3744fea2a3b983">Time_stepper_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt()</a>, <a class="el" href="../../d0/d49/namespaceoomph_1_1StringConversion.html#a9d30fabdc1a0694bdb91dddd2833bbd6">oomph::StringConversion::to_string()</a>, <a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html#ab9813c8ea8ad981f0db9a467302b9cd0">oomph::TimeStepper::update_predicted_time()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a438bf1c7aafffda56f2acb34ba027fdb">use_predictor_values_as_initial_guess()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a63805c549e71b7c73107abe6001fae25">adaptive_unsteady_newton_solve()</a>.</p>

</div>
</div>
<a id="a600bb1740edd0aa07c6d001033bf676a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a600bb1740edd0aa07c6d001033bf676a">&#9670;&nbsp;</a></span>communicator_pt() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html">OomphCommunicator</a>* oomph::Problem::communicator_pt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>access function to the oomph-lib communicator </p>
<div class="fragment"><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    {</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>;</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/da2/classoomph_1_1PeriodicOrbitAssemblyHandler.html#a358d1749faa8ac7dd0de87340d878088">oomph::PeriodicOrbitAssemblyHandler&lt; NNODE_1D &gt;::adapt_temporal_mesh()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acc35de219c1c1032a14840021fd8a6b9">arc_length_step_solve_helper()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers()</a>, <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#af84f07f5b4632433203f4c4abf57da5f">oomph::Multi_domain_functions::aux_setup_multi_domain_interaction()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7c23771b77d6da7cbee3c3e3c050be73">doubly_adaptive_unsteady_newton_solve_helper()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a1756534851a763f35fd5372b4d3723e0">dump()</a>, <a class="el" href="../../d4/dcb/classoomph_1_1FoldHandler.html#add39896d007559f4fb801f1c95e4ab16">oomph::FoldHandler::FoldHandler()</a>, <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a81f7a581bfb6abfcce009546b80b9898">oomph::Multi_domain_functions::get_dim_helper()</a>, <a class="el" href="../../d4/dcb/classoomph_1_1FoldHandler.html#aca97058722ccc1482ae8180ea8dde74c">oomph::FoldHandler::get_eigenfunction()</a>, <a class="el" href="../../d4/da2/classoomph_1_1HopfHandler.html#a9d1ee586e6274cfa0baa15f82b9fa0ae">oomph::HopfHandler::get_eigenfunction()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a497518acb5d30a28a253890c3d2a5da2">get_hessian_vector_products()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5ee48c16fce89952a019a844ac386655">get_inverse_mass_matrix_times_residuals()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae9bbce5fdb111ccbab7a6077ac491feb">get_jacobian()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a0103fe1a09ecf7e23a9083b35ef07aac">get_residuals()</a>, <a class="el" href="../../d4/da2/classoomph_1_1HopfHandler.html#ac219516b8263300eb5102d38baab05d7">oomph::HopfHandler::HopfHandler()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#abdb4fbbb5d658094cfd48e2296c7d3b7">newton_solve()</a>, <a class="el" href="../../d4/d6b/three__d__mesh__dist_8cc.html#a3e9491dd4f7081f92d170df562503838">parallel_test()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a96e0343c261d087f5d67a49f68561d96">oomph::PitchForkHandler::PitchForkHandler()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a4f6011ef141cc68598a9502052129a3f">read()</a>, <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a9a424fd2ae0b67ef8c3ff59f16030786">oomph::BlockPitchForkLinearSolver::resolve()</a>, <a class="el" href="../../de/d72/classoomph_1_1AugmentedBlockPitchForkLinearSolver.html#a1d617896a3f1c1b1236ff18dc87ed8d7">oomph::AugmentedBlockPitchForkLinearSolver::resolve()</a>, <a class="el" href="../../d2/d5a/classoomph_1_1SolidICProblem.html#a60e1dccbc8627a07bfcb38a55b0669ca">oomph::SolidICProblem::set_static_initial_condition()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aae085671047b62a98ef310d66cc3f412">setup_element_count_per_dof()</a>, <a class="el" href="../../dd/d4b/classoomph_1_1AugmentedBlockFoldLinearSolver.html#a11690b33089e999d0c894b4e4b0646d9">oomph::AugmentedBlockFoldLinearSolver::solve()</a>, <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#ad196867613954a8fabd318b50e2aadc6">oomph::BlockPitchForkLinearSolver::solve()</a>, <a class="el" href="../../de/d72/classoomph_1_1AugmentedBlockPitchForkLinearSolver.html#a0cbeb150ac83d5be1a1e30c0f728a70b">oomph::AugmentedBlockPitchForkLinearSolver::solve()</a>, <a class="el" href="../../df/dbd/classoomph_1_1BlockHopfLinearSolver.html#a5e9ff24466ec138cca8264e5befc31fe">oomph::BlockHopfLinearSolver::solve()</a>, <a class="el" href="../../de/d04/classoomph_1_1HSL__MA42.html#ae796a6b14c13d1cdb7bf49ca3c7c5aec">oomph::HSL_MA42::solve()</a>, <a class="el" href="../../d3/d90/classoomph_1_1GS.html#ad7d1bfb3d25a194d2875e266e104dc9f">oomph::GS&lt; MATRIX &gt;::solve()</a>, <a class="el" href="../../dc/df6/classoomph_1_1GS_3_01CRDoubleMatrix_01_4.html#a85164d55db2ab10404d5679657e8f6de">oomph::GS&lt; CRDoubleMatrix &gt;::solve()</a>, <a class="el" href="../../d7/d2e/classoomph_1_1DampedJacobi.html#ace422835d94b7d465d08cc1f4df192ea">oomph::DampedJacobi&lt; MATRIX &gt;::solve()</a>, <a class="el" href="../../d5/dee/classoomph_1_1GMRES.html#ade0f569ecda6b63d3e77dfe07a19cb13">oomph::GMRES&lt; MATRIX &gt;::solve()</a>, <a class="el" href="../../d2/d08/classoomph_1_1AugmentedProblemGMRES.html#a73d8d3d8b161084e6291560cdd7984dc">oomph::AugmentedProblemGMRES::solve()</a>, <a class="el" href="../../d7/db1/classoomph_1_1SuperLUSolver.html#a5a121df89c72a8741d051aa176b12255">oomph::SuperLUSolver::solve()</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#ae0346a464f3ed74bfcca4063bdeed3ad">oomph::MumpsSolver::solve()</a>, <a class="el" href="../../d7/d86/classoomph_1_1HelmholtzGMRESMG.html#a5806236b991ac2d7fe4bc7a4f19e98fb">oomph::HelmholtzGMRESMG&lt; MATRIX &gt;::solve()</a>, <a class="el" href="../../df/df9/classoomph_1_1HelmholtzFGMRESMG.html#a36a1d601676df2ebe39fcdb7a0837864">oomph::HelmholtzFGMRESMG&lt; MATRIX &gt;::solve()</a>, <a class="el" href="../../d4/dcb/classoomph_1_1FoldHandler.html#a7718a18444f6e328953dd5d5e73802f8">oomph::FoldHandler::solve_augmented_block_system()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ad0b0920383bcbdab5df1f43db5affa47">oomph::PitchForkHandler::solve_augmented_block_system()</a>, <a class="el" href="../../d4/dcb/classoomph_1_1FoldHandler.html#abf0c7293014112731f0482e464f4daa3">oomph::FoldHandler::solve_block_system()</a>, <a class="el" href="../../d4/da2/classoomph_1_1HopfHandler.html#ac7feecfa644ae33b4a4a9fa8d1d993af">oomph::HopfHandler::solve_complex_system()</a>, <a class="el" href="../../d6/d35/classoomph_1_1ARPACK.html#a22a914045a51a8ad89158cffd81127fe">oomph::ARPACK::solve_eigenproblem()</a>, <a class="el" href="../../d0/d43/classoomph_1_1LAPACK__QZ.html#a6f06580f8907d38c7e7c36e12da44b59">oomph::LAPACK_QZ::solve_eigenproblem()</a>, <a class="el" href="../../df/dbd/classoomph_1_1BlockHopfLinearSolver.html#a9a7cc6bda9ab1a8baf83d5d8e1fe5eea">oomph::BlockHopfLinearSolver::solve_for_two_rhs()</a>, <a class="el" href="../../d4/dcb/classoomph_1_1FoldHandler.html#a506c9a7bb372c6d8799c6dabc9448f46">oomph::FoldHandler::solve_full_system()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a27325616f4342d159f6f5e7c82ccdf98">oomph::PitchForkHandler::solve_full_system()</a>, <a class="el" href="../../d4/da2/classoomph_1_1HopfHandler.html#a507681043126f6bea58cc90deed16d1d">oomph::HopfHandler::solve_full_system()</a>, <a class="el" href="../../d4/da2/classoomph_1_1HopfHandler.html#acd2149152659deef1d938739222dbcf2">oomph::HopfHandler::solve_standard_system()</a>, <a class="el" href="../../d7/db1/classoomph_1_1SuperLUSolver.html#a10bdce2b176a3ca514b82f66cd50e037">oomph::SuperLUSolver::solve_transpose()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a31d279b8e62fc676f25b9b347f4ffd8b">unsteady_newton_solve()</a>, <a class="el" href="../../d4/dcb/classoomph_1_1FoldHandler.html#ab582d9ac969e0f7779a285d21a6d8e45">oomph::FoldHandler::~FoldHandler()</a>, and <a class="el" href="../../d4/da2/classoomph_1_1HopfHandler.html#a2b2822861fc417fea32cbba38f9dd650">oomph::HopfHandler::~HopfHandler()</a>.</p>

</div>
</div>
<a id="af1875e771e99a2e8f1d344d8b880d0de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1875e771e99a2e8f1d344d8b880d0de">&#9670;&nbsp;</a></span>communicator_pt() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html">OomphCommunicator</a>* oomph::Problem::communicator_pt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>access function to the oomph-lib communicator, const version </p>
<div class="fragment"><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    {</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>;</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>.</p>

</div>
</div>
<a id="ab8b63040a3c6deff68fb2128c2f7fef2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8b63040a3c6deff68fb2128c2f7fef2">&#9670;&nbsp;</a></span>copy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::copy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *&#160;</td>
          <td class="paramname"><em>orig_problem_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Copy Data values, nodal positions etc from specified problem. Note: This is not a copy constructor. We assume that the current and the "original" problem have both been created by calling the same problem constructor so that all Data objects, time steppers etc. in the two problems are completely independent. This function copies the nodal, internal and global values, and the time parameters from the original problem into "this" one. This functionality is required, e.g. for multigrid computations.</p>
<p>Copy Data values, nodal positions etc from specified problem. Note: This is not a copy constructor. We assume that the current and the "original" problem have both been created by calling the same problem constructor so that all Data objects, time steppers etc. in the two problems are completely independent. This function copies the nodal, internal and global values and the time parameters from the original problem into "this" one. This functionality is required, e.g. for multigrid computations. </p>
<div class="fragment"><div class="line"><a name="l11866"></a><span class="lineno">11866</span>&#160;  {</div>
<div class="line"><a name="l11867"></a><span class="lineno">11867</span>&#160;    <span class="comment">// Copy time</span></div>
<div class="line"><a name="l11868"></a><span class="lineno">11868</span>&#160;    <span class="comment">//----------</span></div>
<div class="line"><a name="l11869"></a><span class="lineno">11869</span>&#160; </div>
<div class="line"><a name="l11870"></a><span class="lineno">11870</span>&#160;    <span class="comment">// Flag to indicate that orig problem is unsteady problem</span></div>
<div class="line"><a name="l11871"></a><span class="lineno">11871</span>&#160;    <span class="keywordtype">bool</span> unsteady_flag = (orig_problem_pt-&gt;time_pt() != 0);</div>
<div class="line"><a name="l11872"></a><span class="lineno">11872</span>&#160; </div>
<div class="line"><a name="l11873"></a><span class="lineno">11873</span>&#160;    <span class="comment">// Copy current time and previous time increments for proper unsteady run</span></div>
<div class="line"><a name="l11874"></a><span class="lineno">11874</span>&#160;    <span class="keywordflow">if</span> (unsteady_flag)</div>
<div class="line"><a name="l11875"></a><span class="lineno">11875</span>&#160;    {</div>
<div class="line"><a name="l11876"></a><span class="lineno">11876</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Copying an unsteady problem.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l11877"></a><span class="lineno">11877</span>&#160;      <span class="comment">// Current time</span></div>
<div class="line"><a name="l11878"></a><span class="lineno">11878</span>&#160;      this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a46894b13c582f322082dc471a2485980">time_pt</a>()-&gt;<a class="code" href="../../d0/da1/classoomph_1_1Time.html#a6e28ea7a6664a2f5f5e1be871304a2c7">time</a>() = orig_problem_pt-&gt;time_pt()-&gt;time();</div>
<div class="line"><a name="l11879"></a><span class="lineno">11879</span>&#160;      <span class="comment">// Timesteps</span></div>
<div class="line"><a name="l11880"></a><span class="lineno">11880</span>&#160;      <span class="keywordtype">unsigned</span> n_dt = orig_problem_pt-&gt;time_pt()-&gt;ndt();</div>
<div class="line"><a name="l11881"></a><span class="lineno">11881</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a46894b13c582f322082dc471a2485980">time_pt</a>()-&gt;<a class="code" href="../../d0/da1/classoomph_1_1Time.html#aeab1acb1e182797c4194af84c0583c3f">resize</a>(n_dt);</div>
<div class="line"><a name="l11882"></a><span class="lineno">11882</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_dt; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l11883"></a><span class="lineno">11883</span>&#160;      {</div>
<div class="line"><a name="l11884"></a><span class="lineno">11884</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a46894b13c582f322082dc471a2485980">time_pt</a>()-&gt;<a class="code" href="../../d0/da1/classoomph_1_1Time.html#a2c684e0a69db7adde90f1f052e424a6b">dt</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = orig_problem_pt-&gt;time_pt()-&gt;dt(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l11885"></a><span class="lineno">11885</span>&#160;      }</div>
<div class="line"><a name="l11886"></a><span class="lineno">11886</span>&#160; </div>
<div class="line"><a name="l11887"></a><span class="lineno">11887</span>&#160;      <span class="comment">// Find out how many timesteppers there are</span></div>
<div class="line"><a name="l11888"></a><span class="lineno">11888</span>&#160;      <span class="keywordtype">unsigned</span> n_time_steppers = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ace3cdf55009c3bff21d2b7d3706d522a">ntime_stepper</a>();</div>
<div class="line"><a name="l11889"></a><span class="lineno">11889</span>&#160; </div>
<div class="line"><a name="l11890"></a><span class="lineno">11890</span>&#160;      <span class="comment">// Loop over them all and set the weights</span></div>
<div class="line"><a name="l11891"></a><span class="lineno">11891</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_time_steppers; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l11892"></a><span class="lineno">11892</span>&#160;      {</div>
<div class="line"><a name="l11893"></a><span class="lineno">11893</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)-&gt;<a class="code" href="../../d5/d19/classoomph_1_1TimeStepper.html#a028fa3a8d3c6db6b0ddf580cb0468d55">set_weights</a>();</div>
<div class="line"><a name="l11894"></a><span class="lineno">11894</span>&#160;      }</div>
<div class="line"><a name="l11895"></a><span class="lineno">11895</span>&#160;    }</div>
<div class="line"><a name="l11896"></a><span class="lineno">11896</span>&#160; </div>
<div class="line"><a name="l11897"></a><span class="lineno">11897</span>&#160;    <span class="comment">// Copy nodes</span></div>
<div class="line"><a name="l11898"></a><span class="lineno">11898</span>&#160;    <span class="comment">//-----------</span></div>
<div class="line"><a name="l11899"></a><span class="lineno">11899</span>&#160; </div>
<div class="line"><a name="l11900"></a><span class="lineno">11900</span>&#160;    <span class="comment">// Loop over submeshes:</span></div>
<div class="line"><a name="l11901"></a><span class="lineno">11901</span>&#160;    <span class="keywordtype">unsigned</span> nmesh = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>();</div>
<div class="line"><a name="l11902"></a><span class="lineno">11902</span>&#160;    <span class="keywordflow">if</span> (nmesh == 0) nmesh = 1;</div>
<div class="line"><a name="l11903"></a><span class="lineno">11903</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> = 0; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> &lt; nmesh; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>++)</div>
<div class="line"><a name="l11904"></a><span class="lineno">11904</span>&#160;    {</div>
<div class="line"><a name="l11905"></a><span class="lineno">11905</span>&#160;      <span class="comment">// Find number of nodes in present mesh</span></div>
<div class="line"><a name="l11906"></a><span class="lineno">11906</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n_node = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>)-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a945e7823d1a2af243b5b7f7866aaff5e">nnode</a>();</div>
<div class="line"><a name="l11907"></a><span class="lineno">11907</span>&#160; </div>
<div class="line"><a name="l11908"></a><span class="lineno">11908</span>&#160;      <span class="comment">// Check # of nodes:</span></div>
<div class="line"><a name="l11909"></a><span class="lineno">11909</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n_node_orig = orig_problem_pt-&gt;mesh_pt(<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>)-&gt;nnode();</div>
<div class="line"><a name="l11910"></a><span class="lineno">11910</span>&#160;      <span class="keywordflow">if</span> (n_node != n_node_orig)</div>
<div class="line"><a name="l11911"></a><span class="lineno">11911</span>&#160;      {</div>
<div class="line"><a name="l11912"></a><span class="lineno">11912</span>&#160;        std::ostringstream error_message;</div>
<div class="line"><a name="l11913"></a><span class="lineno">11913</span>&#160;        error_message &lt;&lt; <span class="stringliteral">&quot;Number of nodes in copy &quot;</span> &lt;&lt; n_node</div>
<div class="line"><a name="l11914"></a><span class="lineno">11914</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot; not equal to the number in the original &quot;</span></div>
<div class="line"><a name="l11915"></a><span class="lineno">11915</span>&#160;                      &lt;&lt; n_node_orig &lt;&lt; std::endl;</div>
<div class="line"><a name="l11916"></a><span class="lineno">11916</span>&#160; </div>
<div class="line"><a name="l11917"></a><span class="lineno">11917</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(error_message.str(),</div>
<div class="line"><a name="l11918"></a><span class="lineno">11918</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l11919"></a><span class="lineno">11919</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l11920"></a><span class="lineno">11920</span>&#160;      }</div>
<div class="line"><a name="l11921"></a><span class="lineno">11921</span>&#160; </div>
<div class="line"><a name="l11922"></a><span class="lineno">11922</span>&#160;      <span class="comment">// Loop over the nodes</span></div>
<div class="line"><a name="l11923"></a><span class="lineno">11923</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_node; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l11924"></a><span class="lineno">11924</span>&#160;      {</div>
<div class="line"><a name="l11925"></a><span class="lineno">11925</span>&#160;        <span class="comment">// Try to cast to elastic node</span></div>
<div class="line"><a name="l11926"></a><span class="lineno">11926</span>&#160;        SolidNode* el_node_pt =</div>
<div class="line"><a name="l11927"></a><span class="lineno">11927</span>&#160;          <span class="keyword">dynamic_cast&lt;</span>SolidNode*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>)-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">node_pt</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div>
<div class="line"><a name="l11928"></a><span class="lineno">11928</span>&#160;        <span class="keywordflow">if</span> (el_node_pt != 0)</div>
<div class="line"><a name="l11929"></a><span class="lineno">11929</span>&#160;        {</div>
<div class="line"><a name="l11930"></a><span class="lineno">11930</span>&#160;          SolidNode* el_node_orig_pt =</div>
<div class="line"><a name="l11931"></a><span class="lineno">11931</span>&#160;            <span class="keyword">dynamic_cast&lt;</span>SolidNode*<span class="keyword">&gt;</span>(orig_problem_pt-&gt;mesh_pt(<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>)-&gt;node_pt(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div>
<div class="line"><a name="l11932"></a><span class="lineno">11932</span>&#160;          el_node_pt-&gt;copy(el_node_orig_pt);</div>
<div class="line"><a name="l11933"></a><span class="lineno">11933</span>&#160;        }</div>
<div class="line"><a name="l11934"></a><span class="lineno">11934</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l11935"></a><span class="lineno">11935</span>&#160;        {</div>
<div class="line"><a name="l11936"></a><span class="lineno">11936</span>&#160;          <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>)-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">node_pt</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)-&gt;<a class="code" href="../../dc/db7/classoomph_1_1Node.html#a103b12afe541e9bbe5c0790c1c0efe55">copy</a>(orig_problem_pt-&gt;mesh_pt(<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>)-&gt;node_pt(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div>
<div class="line"><a name="l11937"></a><span class="lineno">11937</span>&#160;        }</div>
<div class="line"><a name="l11938"></a><span class="lineno">11938</span>&#160;      }</div>
<div class="line"><a name="l11939"></a><span class="lineno">11939</span>&#160;    }</div>
<div class="line"><a name="l11940"></a><span class="lineno">11940</span>&#160; </div>
<div class="line"><a name="l11941"></a><span class="lineno">11941</span>&#160; </div>
<div class="line"><a name="l11942"></a><span class="lineno">11942</span>&#160;    <span class="comment">// Copy global data:</span></div>
<div class="line"><a name="l11943"></a><span class="lineno">11943</span>&#160;    <span class="comment">//------------------</span></div>
<div class="line"><a name="l11944"></a><span class="lineno">11944</span>&#160; </div>
<div class="line"><a name="l11945"></a><span class="lineno">11945</span>&#160;    <span class="comment">// Number of global data</span></div>
<div class="line"><a name="l11946"></a><span class="lineno">11946</span>&#160;    <span class="keywordtype">unsigned</span> n_global = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>.size();</div>
<div class="line"><a name="l11947"></a><span class="lineno">11947</span>&#160; </div>
<div class="line"><a name="l11948"></a><span class="lineno">11948</span>&#160;    <span class="comment">// Check # of nodes in orig problem</span></div>
<div class="line"><a name="l11949"></a><span class="lineno">11949</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n_global_orig = orig_problem_pt-&gt;nglobal_data();</div>
<div class="line"><a name="l11950"></a><span class="lineno">11950</span>&#160;    <span class="keywordflow">if</span> (n_global != n_global_orig)</div>
<div class="line"><a name="l11951"></a><span class="lineno">11951</span>&#160;    {</div>
<div class="line"><a name="l11952"></a><span class="lineno">11952</span>&#160;      std::ostringstream error_message;</div>
<div class="line"><a name="l11953"></a><span class="lineno">11953</span>&#160;      error_message &lt;&lt; <span class="stringliteral">&quot;Number of global data in copy &quot;</span> &lt;&lt; n_global</div>
<div class="line"><a name="l11954"></a><span class="lineno">11954</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot; not equal to the number in the original &quot;</span></div>
<div class="line"><a name="l11955"></a><span class="lineno">11955</span>&#160;                    &lt;&lt; n_global_orig &lt;&lt; std::endl;</div>
<div class="line"><a name="l11956"></a><span class="lineno">11956</span>&#160; </div>
<div class="line"><a name="l11957"></a><span class="lineno">11957</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l11958"></a><span class="lineno">11958</span>&#160;        error_message.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l11959"></a><span class="lineno">11959</span>&#160;    }</div>
<div class="line"><a name="l11960"></a><span class="lineno">11960</span>&#160; </div>
<div class="line"><a name="l11961"></a><span class="lineno">11961</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> iglobal = 0; iglobal &lt; n_global; iglobal++)</div>
<div class="line"><a name="l11962"></a><span class="lineno">11962</span>&#160;    {</div>
<div class="line"><a name="l11963"></a><span class="lineno">11963</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>[iglobal]-&gt;copy(orig_problem_pt-&gt;global_data_pt(iglobal));</div>
<div class="line"><a name="l11964"></a><span class="lineno">11964</span>&#160;    }</div>
<div class="line"><a name="l11965"></a><span class="lineno">11965</span>&#160; </div>
<div class="line"><a name="l11966"></a><span class="lineno">11966</span>&#160; </div>
<div class="line"><a name="l11967"></a><span class="lineno">11967</span>&#160;    <span class="comment">// Copy internal data of elements:</span></div>
<div class="line"><a name="l11968"></a><span class="lineno">11968</span>&#160;    <span class="comment">//--------------------------------</span></div>
<div class="line"><a name="l11969"></a><span class="lineno">11969</span>&#160; </div>
<div class="line"><a name="l11970"></a><span class="lineno">11970</span>&#160;    <span class="comment">// Loop over submeshes:</span></div>
<div class="line"><a name="l11971"></a><span class="lineno">11971</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> = 0; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> &lt; nmesh; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>++)</div>
<div class="line"><a name="l11972"></a><span class="lineno">11972</span>&#160;    {</div>
<div class="line"><a name="l11973"></a><span class="lineno">11973</span>&#160;      <span class="comment">// Loop over elements and deal with internal data</span></div>
<div class="line"><a name="l11974"></a><span class="lineno">11974</span>&#160;      <span class="keywordtype">unsigned</span> n_element = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>)-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">nelement</a>();</div>
<div class="line"><a name="l11975"></a><span class="lineno">11975</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; n_element; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l11976"></a><span class="lineno">11976</span>&#160;      {</div>
<div class="line"><a name="l11977"></a><span class="lineno">11977</span>&#160;        GeneralisedElement* el_pt = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>)-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">element_pt</a>(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>);</div>
<div class="line"><a name="l11978"></a><span class="lineno">11978</span>&#160;        <span class="keywordtype">unsigned</span> n_internal = el_pt-&gt;<a class="code" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a6b736de0af4c92831968636479b3480e">ninternal_data</a>();</div>
<div class="line"><a name="l11979"></a><span class="lineno">11979</span>&#160;        <span class="keywordflow">if</span> (n_internal &gt; 0)</div>
<div class="line"><a name="l11980"></a><span class="lineno">11980</span>&#160;        {</div>
<div class="line"><a name="l11981"></a><span class="lineno">11981</span>&#160;          <span class="comment">// Check # of internals :</span></div>
<div class="line"><a name="l11982"></a><span class="lineno">11982</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n_internal_orig =</div>
<div class="line"><a name="l11983"></a><span class="lineno">11983</span>&#160;            orig_problem_pt-&gt;mesh_pt(<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>)-&gt;element_pt(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>)-&gt;ninternal_data();</div>
<div class="line"><a name="l11984"></a><span class="lineno">11984</span>&#160;          <span class="keywordflow">if</span> (n_internal != n_internal_orig)</div>
<div class="line"><a name="l11985"></a><span class="lineno">11985</span>&#160;          {</div>
<div class="line"><a name="l11986"></a><span class="lineno">11986</span>&#160;            std::ostringstream error_message;</div>
<div class="line"><a name="l11987"></a><span class="lineno">11987</span>&#160;            error_message &lt;&lt; <span class="stringliteral">&quot;Number of internal data in copy &quot;</span> &lt;&lt; n_internal</div>
<div class="line"><a name="l11988"></a><span class="lineno">11988</span>&#160;                          &lt;&lt; <span class="stringliteral">&quot; not equal to the number in the original &quot;</span></div>
<div class="line"><a name="l11989"></a><span class="lineno">11989</span>&#160;                          &lt;&lt; n_internal_orig &lt;&lt; std::endl;</div>
<div class="line"><a name="l11990"></a><span class="lineno">11990</span>&#160; </div>
<div class="line"><a name="l11991"></a><span class="lineno">11991</span>&#160;            <span class="keywordflow">throw</span> OomphLibError(error_message.str(),</div>
<div class="line"><a name="l11992"></a><span class="lineno">11992</span>&#160;                                <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l11993"></a><span class="lineno">11993</span>&#160;                                <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l11994"></a><span class="lineno">11994</span>&#160;          }</div>
<div class="line"><a name="l11995"></a><span class="lineno">11995</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_internal; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l11996"></a><span class="lineno">11996</span>&#160;          {</div>
<div class="line"><a name="l11997"></a><span class="lineno">11997</span>&#160;            el_pt-&gt;internal_data_pt(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)-&gt;copy(</div>
<div class="line"><a name="l11998"></a><span class="lineno">11998</span>&#160;              orig_problem_pt-&gt;mesh_pt(<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>)-&gt;element_pt(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>)-&gt;internal_data_pt(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div>
<div class="line"><a name="l11999"></a><span class="lineno">11999</span>&#160;          }</div>
<div class="line"><a name="l12000"></a><span class="lineno">12000</span>&#160;        }</div>
<div class="line"><a name="l12001"></a><span class="lineno">12001</span>&#160;      }</div>
<div class="line"><a name="l12002"></a><span class="lineno">12002</span>&#160;    }</div>
<div class="line"><a name="l12003"></a><span class="lineno">12003</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1GeneralisedElement_html_a6b736de0af4c92831968636479b3480e"><div class="ttname"><a href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a6b736de0af4c92831968636479b3480e">oomph::GeneralisedElement::ninternal_data</a></div><div class="ttdeci">unsigned ninternal_data() const</div><div class="ttdoc">Return the number of internal data objects.</div><div class="ttdef"><b>Definition:</b> elements.h:823</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_a945e7823d1a2af243b5b7f7866aaff5e"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#a945e7823d1a2af243b5b7f7866aaff5e">oomph::Mesh::nnode</a></div><div class="ttdeci">unsigned long nnode() const</div><div class="ttdoc">Return number of nodes in the mesh.</div><div class="ttdef"><b>Definition:</b> mesh.h:596</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_ab3c2b72c8ef4e9fd35f5998a5e7dc93b"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">oomph::Mesh::node_pt</a></div><div class="ttdeci">Node *&amp; node_pt(const unsigned long &amp;n)</div><div class="ttdoc">Return pointer to global node n.</div><div class="ttdef"><b>Definition:</b> mesh.h:436</div></div>
<div class="ttc" id="aclassoomph_1_1Node_html_a103b12afe541e9bbe5c0790c1c0efe55"><div class="ttname"><a href="../../dc/db7/classoomph_1_1Node.html#a103b12afe541e9bbe5c0790c1c0efe55">oomph::Node::copy</a></div><div class="ttdeci">void copy(Node *orig_node_pt)</div><div class="ttdoc">Copy all nodal data from specified Node object.</div><div class="ttdef"><b>Definition:</b> nodes.cc:1916</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d8/dc5/classoomph_1_1Data.html#a57889a9db7ca009434f0268173fcf3f8">oomph::Data::copy()</a>, <a class="el" href="../../dc/db7/classoomph_1_1Node.html#a103b12afe541e9bbe5c0790c1c0efe55">oomph::Node::copy()</a>, <a class="el" href="../../dc/dfd/classoomph_1_1SolidNode.html#ae4dfa5355b84b58745b0c6a3fef60112">oomph::SolidNode::copy()</a>, <a class="el" href="../../d0/da1/classoomph_1_1Time.html#a2c684e0a69db7adde90f1f052e424a6b">oomph::Time::dt()</a>, <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">oomph::Mesh::element_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae508b2056d532cb8b6eb0dd5c16b9325">global_data_pt()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a45e32d895d4b3686e0f15fe455f4ed44">oomph::GeneralisedElement::internal_data_pt()</a>, <a class="el" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt()</a>, <a class="el" href="../../d0/da1/classoomph_1_1Time.html#ad40953c471eb3ce59921e6870ed755f3">oomph::Time::ndt()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">oomph::Mesh::nelement()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a60a9b6861928cf9115110b5bfc7d11a7">nglobal_data()</a>, <a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a6b736de0af4c92831968636479b3480e">oomph::GeneralisedElement::ninternal_data()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a945e7823d1a2af243b5b7f7866aaff5e">oomph::Mesh::nnode()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">oomph::Mesh::node_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ace3cdf55009c3bff21d2b7d3706d522a">ntime_stepper()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, <a class="el" href="../../d0/da1/classoomph_1_1Time.html#aeab1acb1e182797c4194af84c0583c3f">oomph::Time::resize()</a>, <a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html#a028fa3a8d3c6db6b0ddf580cb0468d55">oomph::TimeStepper::set_weights()</a>, <a class="el" href="../../d0/da1/classoomph_1_1Time.html#a6e28ea7a6664a2f5f5e1be871304a2c7">oomph::Time::time()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a46894b13c582f322082dc471a2485980">time_pt()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt()</a>.</p>

</div>
</div>
<a id="ac5b47ae12ed6445e52c65596dfa97c6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5b47ae12ed6445e52c65596dfa97c6d">&#9670;&nbsp;</a></span>deactivate_bifurcation_tracking()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Problem::deactivate_bifurcation_tracking </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Deactivate all bifuraction tracking, by reseting the assembly handler to the default </p>
<div class="fragment"><div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;    {</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a0b6b29c5e2ae9d4a22dac5b4494b7bc4">reset_assembly_handler_to_default</a>();</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a0b6b29c5e2ae9d4a22dac5b4494b7bc4">reset_assembly_handler_to_default()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa0b4e7868e02e2d12845c9b2dd60cab9">bifurcation_adapt_helper()</a>.</p>

</div>
</div>
<a id="a36c95c8211cc02558118288888aab5e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36c95c8211cc02558118288888aab5e1">&#9670;&nbsp;</a></span>debug_hook_fct()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void oomph::Problem::debug_hook_fct </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Hook for debugging. Can be overloaded in driver code; argument allows identification of where we're coming from </p>
<div class="fragment"><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    {</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Called empty hook fct with i=&quot;</span> &lt;&lt; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, and <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>.</p>

</div>
</div>
<a id="ae796d578da9c7578742f7a6e1f5d0c0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae796d578da9c7578742f7a6e1f5d0c0a">&#9670;&nbsp;</a></span>delete_all_external_storage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::delete_all_external_storage </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Wrapper function to delete external storage for each submesh of the problem</p>
<p>Delete any external storage for any submeshes NB this would ordinarily take place within the adaptation procedure for each submesh (See RefineableMesh::adapt_mesh(...)), but there are instances where the actions_before/after_adapt routines are used and no adaptive routines are called in between (e.g. when doc-ing errors at the end of an adaptive newton solver) </p>
<div class="fragment"><div class="line"><a name="l16356"></a><span class="lineno">16356</span>&#160;  {</div>
<div class="line"><a name="l16357"></a><span class="lineno">16357</span>&#160;    <span class="comment">// Number of submeshes</span></div>
<div class="line"><a name="l16358"></a><span class="lineno">16358</span>&#160;    <span class="keywordtype">unsigned</span> n_mesh = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>();</div>
<div class="line"><a name="l16359"></a><span class="lineno">16359</span>&#160; </div>
<div class="line"><a name="l16360"></a><span class="lineno">16360</span>&#160;    <span class="comment">// External storage will only exist if there is more than one (sub)mesh</span></div>
<div class="line"><a name="l16361"></a><span class="lineno">16361</span>&#160;    <span class="keywordflow">if</span> (n_mesh &gt; 1)</div>
<div class="line"><a name="l16362"></a><span class="lineno">16362</span>&#160;    {</div>
<div class="line"><a name="l16363"></a><span class="lineno">16363</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i_mesh = 0; i_mesh &lt; n_mesh; i_mesh++)</div>
<div class="line"><a name="l16364"></a><span class="lineno">16364</span>&#160;      {</div>
<div class="line"><a name="l16365"></a><span class="lineno">16365</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(i_mesh)-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a9e3ecb07dc622cf37ce0085446ff9aa6">delete_all_external_storage</a>();</div>
<div class="line"><a name="l16366"></a><span class="lineno">16366</span>&#160;      }</div>
<div class="line"><a name="l16367"></a><span class="lineno">16367</span>&#160;    }</div>
<div class="line"><a name="l16368"></a><span class="lineno">16368</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_a9e3ecb07dc622cf37ce0085446ff9aa6"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#a9e3ecb07dc622cf37ce0085446ff9aa6">oomph::Mesh::delete_all_external_storage</a></div><div class="ttdeci">void delete_all_external_storage()</div><div class="ttdoc">Wipe the storage for all externally-based elements.</div><div class="ttdef"><b>Definition:</b> mesh.cc:9190</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a9e3ecb07dc622cf37ce0085446ff9aa6">oomph::Mesh::delete_all_external_storage()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh()</a>.</p>

</div>
</div>
<a id="a74a72dc989531d264ec1959f3015b98c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74a72dc989531d264ec1959f3015b98c">&#9670;&nbsp;</a></span>describe_dofs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::describe_dofs </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>out</em> = <code>*(oomph_info.stream_pt())</code></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function to describe the dofs in terms of the global equation number, i.e. what type of value (nodal value of a Node; value in a Data object; value of internal Data in an element; etc) is the unknown with a certain global equation number. Output stream defaults to oomph_info. </p>
<div class="fragment"><div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;  {</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;    <span class="comment">// Check that the global mesh has been build</span></div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a> == 0)</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;    {</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;      std::ostringstream error_stream;</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;      error_stream</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;Global mesh does not exist, so equation numbers cannot be found.\n&quot;</span>;</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;      <span class="comment">// Check for sub meshes</span></div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>() == 0)</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;      {</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;        error_stream &lt;&lt; <span class="stringliteral">&quot;There aren&#39;t even any sub-meshes in the Problem.\n&quot;</span></div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;You can set the global mesh directly by using\n&quot;</span></div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;Problem::mesh_pt() = my_mesh_pt;\n&quot;</span></div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;OR you can use Problem::add_sub_mesh(mesh_pt); &quot;</span></div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;to add a sub mesh.\n&quot;</span>;</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;      }</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;      {</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;        error_stream &lt;&lt; <span class="stringliteral">&quot;There are &quot;</span> &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>() &lt;&lt; <span class="stringliteral">&quot; sub-meshes.\n&quot;</span>;</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;      }</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;      error_stream &lt;&lt; <span class="stringliteral">&quot;You need to call Problem::build_global_mesh() to create &quot;</span></div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;                      <span class="stringliteral">&quot;a global mesh\n&quot;</span></div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;from the sub-meshes.\n\n&quot;</span>;</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160; </div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;        error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;    }</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160; </div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;    <a class="code" href="../../d9/d83/tensor__contract__sycl__bench_8cc.html#acc4949c3e64b4395f74072403ddf6184">out</a></div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;Although this program will describe the degrees of freedom in the \n&quot;</span></div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;problem, it will do so using the typedef for the elements. This is \n&quot;</span></div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;not neccesarily human readable, but there is a solution.\n&quot;</span></div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;Pipe your program&#39;s output through c++filt, with the argument -t.\n&quot;</span></div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;e.g. \&quot;./two_d_multi_poisson | c++filt -t &gt; ReadableOutput.txt\&quot;.\n &quot;</span></div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;(Disregarding the quotes)\n\n\n&quot;</span>;</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160; </div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;    <a class="code" href="../../d9/d83/tensor__contract__sycl__bench_8cc.html#acc4949c3e64b4395f74072403ddf6184">out</a> &lt;&lt; <span class="stringliteral">&quot;Classifying Global Equation Numbers&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;    <a class="code" href="../../d9/d83/tensor__contract__sycl__bench_8cc.html#acc4949c3e64b4395f74072403ddf6184">out</a> &lt;&lt; <a class="code" href="../../d2/dc3/namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">std::string</a>(80, <span class="charliteral">&#39;-&#39;</span>) &lt;&lt; std::endl;</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160; </div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;    <span class="comment">// Number of submeshes</span></div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;    <span class="keywordtype">unsigned</span> n_sub_mesh = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab65f6fc9c49860e6324457a7e6e76346">Sub_mesh_pt</a>.size();</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160; </div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;    <span class="comment">// Classify Global dofs</span></div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;    <span class="keywordtype">unsigned</span> Nglobal_data = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a60a9b6861928cf9115110b5bfc7d11a7">nglobal_data</a>();</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; Nglobal_data; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;    {</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;      std::stringstream conversion;</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;      conversion &lt;&lt; <span class="stringliteral">&quot; in Global Data &quot;</span> &lt;&lt; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>;</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;      <a class="code" href="../../d2/dc3/namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">std::string</a> in(conversion.str());</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;describe_dofs(<a class="code" href="../../d9/d83/tensor__contract__sycl__bench_8cc.html#acc4949c3e64b4395f74072403ddf6184">out</a>, in);</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;    }</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160; </div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;    <span class="comment">// Put string in limiting scope.</span></div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;    {</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;      <span class="comment">// Descend into assignment for mesh.</span></div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;      <a class="code" href="../../d2/dc3/namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">std::string</a> in(<span class="stringliteral">&quot; in Problem&#39;s Only Mesh.&quot;</span>);</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a86d000c45f6d29fa215b98051cc2d23f">describe_dofs</a>(<a class="code" href="../../d9/d83/tensor__contract__sycl__bench_8cc.html#acc4949c3e64b4395f74072403ddf6184">out</a>, in);</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;    }</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160; </div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;    <span class="comment">// Deal with the spine meshes additional numbering:</span></div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;    <span class="comment">// If there is only one mesh:</span></div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;    <span class="keywordflow">if</span> (n_sub_mesh == 0)</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;    {</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;      <span class="keywordflow">if</span> (SpineMesh* <span class="keyword">const</span> spine_mesh_pt = <span class="keyword">dynamic_cast&lt;</span>SpineMesh*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>))</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;      {</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;        <a class="code" href="../../d2/dc3/namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">std::string</a> in(<span class="stringliteral">&quot; in Problem&#39;s Only SpineMesh.&quot;</span>);</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;        spine_mesh_pt-&gt;describe_spine_dofs(<a class="code" href="../../d9/d83/tensor__contract__sycl__bench_8cc.html#acc4949c3e64b4395f74072403ddf6184">out</a>, in);</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;      }</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;    }</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;    <span class="comment">// Otherwise loop over the sub meshes</span></div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;    {</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;      <span class="comment">// Assign global equation numbers first</span></div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_sub_mesh; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;      {</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;        <span class="keywordflow">if</span> (SpineMesh* <span class="keyword">const</span> spine_mesh_pt =</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;              <span class="keyword">dynamic_cast&lt;</span>SpineMesh*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab65f6fc9c49860e6324457a7e6e76346">Sub_mesh_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]))</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;        {</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;          std::stringstream conversion;</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;          conversion &lt;&lt; <span class="stringliteral">&quot; in Sub-SpineMesh &quot;</span> &lt;&lt; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>;</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;          <a class="code" href="../../d2/dc3/namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">std::string</a> in(conversion.str());</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;          spine_mesh_pt-&gt;describe_spine_dofs(<a class="code" href="../../d9/d83/tensor__contract__sycl__bench_8cc.html#acc4949c3e64b4395f74072403ddf6184">out</a>, in);</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;        } <span class="comment">// end if.</span></div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;      } <span class="comment">// end for.</span></div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;    } <span class="comment">// end else.</span></div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160; </div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160; </div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;    <a class="code" href="../../d9/d83/tensor__contract__sycl__bench_8cc.html#acc4949c3e64b4395f74072403ddf6184">out</a> &lt;&lt; <a class="code" href="../../d2/dc3/namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">std::string</a>(80, <span class="charliteral">&#39;\\&#39;</span>) &lt;&lt; std::endl;</div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;    <a class="code" href="../../d9/d83/tensor__contract__sycl__bench_8cc.html#acc4949c3e64b4395f74072403ddf6184">out</a> &lt;&lt; <a class="code" href="../../d2/dc3/namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">std::string</a>(80, <span class="charliteral">&#39;\\&#39;</span>) &lt;&lt; std::endl;</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;    <a class="code" href="../../d9/d83/tensor__contract__sycl__bench_8cc.html#acc4949c3e64b4395f74072403ddf6184">out</a> &lt;&lt; <a class="code" href="../../d2/dc3/namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">std::string</a>(80, <span class="charliteral">&#39;\\&#39;</span>) &lt;&lt; std::endl;</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;    <a class="code" href="../../d9/d83/tensor__contract__sycl__bench_8cc.html#acc4949c3e64b4395f74072403ddf6184">out</a> &lt;&lt; <span class="stringliteral">&quot;Classifying global eqn numbers in terms of elements.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;    <a class="code" href="../../d9/d83/tensor__contract__sycl__bench_8cc.html#acc4949c3e64b4395f74072403ddf6184">out</a> &lt;&lt; <a class="code" href="../../d2/dc3/namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">std::string</a>(80, <span class="charliteral">&#39;-&#39;</span>) &lt;&lt; std::endl;</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;    <a class="code" href="../../d9/d83/tensor__contract__sycl__bench_8cc.html#acc4949c3e64b4395f74072403ddf6184">out</a> &lt;&lt; <span class="stringliteral">&quot;Eqns   | Source&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;    <a class="code" href="../../d9/d83/tensor__contract__sycl__bench_8cc.html#acc4949c3e64b4395f74072403ddf6184">out</a> &lt;&lt; <a class="code" href="../../d2/dc3/namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">std::string</a>(80, <span class="charliteral">&#39;-&#39;</span>) &lt;&lt; std::endl;</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160; </div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;    <span class="keywordflow">if</span> (n_sub_mesh == 0)</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;    {</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;      <a class="code" href="../../d2/dc3/namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">std::string</a> in(<span class="stringliteral">&quot; in Problem&#39;s Only Mesh.&quot;</span>);</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a57d57b7b6d7a32fadafb03e7055c5ad4">describe_local_dofs</a>(<a class="code" href="../../d9/d83/tensor__contract__sycl__bench_8cc.html#acc4949c3e64b4395f74072403ddf6184">out</a>, in);</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;    }</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;    {</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_sub_mesh; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;      {</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;        std::stringstream conversion;</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;        conversion &lt;&lt; <span class="stringliteral">&quot; in Sub-Mesh &quot;</span> &lt;&lt; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>;</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;        <a class="code" href="../../d2/dc3/namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">std::string</a> in(conversion.str());</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab65f6fc9c49860e6324457a7e6e76346">Sub_mesh_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;describe_local_dofs(<a class="code" href="../../d9/d83/tensor__contract__sycl__bench_8cc.html#acc4949c3e64b4395f74072403ddf6184">out</a>, in);</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;      } <span class="comment">// End for</span></div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;    } <span class="comment">// End else</span></div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;  } <span class="comment">// End problem::describe_dofs(...)</span></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_a57d57b7b6d7a32fadafb03e7055c5ad4"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#a57d57b7b6d7a32fadafb03e7055c5ad4">oomph::Mesh::describe_local_dofs</a></div><div class="ttdeci">void describe_local_dofs(std::ostream &amp;out, const std::string &amp;current_string) const</div><div class="ttdef"><b>Definition:</b> mesh.cc:746</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_a86d000c45f6d29fa215b98051cc2d23f"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#a86d000c45f6d29fa215b98051cc2d23f">oomph::Mesh::describe_dofs</a></div><div class="ttdeci">void describe_dofs(std::ostream &amp;out, const std::string &amp;current_string) const</div><div class="ttdef"><b>Definition:</b> mesh.cc:711</div></div>
<div class="ttc" id="atensor__contract__sycl__bench_8cc_html_acc4949c3e64b4395f74072403ddf6184"><div class="ttname"><a href="../../d9/d83/tensor__contract__sycl__bench_8cc.html#acc4949c3e64b4395f74072403ddf6184">out</a></div><div class="ttdeci">std::ofstream out(&quot;Result.txt&quot;)</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a86d000c45f6d29fa215b98051cc2d23f">oomph::Mesh::describe_dofs()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a57d57b7b6d7a32fadafb03e7055c5ad4">oomph::Mesh::describe_local_dofs()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a60a9b6861928cf9115110b5bfc7d11a7">nglobal_data()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../d9/d83/tensor__contract__sycl__bench_8cc.html#acc4949c3e64b4395f74072403ddf6184">out()</a>, <a class="el" href="../../d2/dc3/namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">oomph::Global_string_for_annotation::string()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab65f6fc9c49860e6324457a7e6e76346">Sub_mesh_pt</a>.</p>

</div>
</div>
<a id="afa64d728ceff0dd772bbbc8f2adcddfb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa64d728ceff0dd772bbbc8f2adcddfb">&#9670;&nbsp;</a></span>disable_discontinuous_formulation()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Problem::disable_discontinuous_formulation </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Disable the use of a discontinuous-element formulation. Note that the methods will all still work even if the elements are discontinuous, we will just be assembling a larger system matrix than necessary. </p>
<div class="fragment"><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;    {</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a97ca0078fff6adca318835c11503dc2d">Discontinuous_element_formulation</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a97ca0078fff6adca318835c11503dc2d">Discontinuous_element_formulation</a>.</p>

</div>
</div>
<a id="a927d35230db6fc5021b68eadaedac9a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a927d35230db6fc5021b68eadaedac9a6">&#9670;&nbsp;</a></span>disable_globally_convergent_newton_method()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Problem::disable_globally_convergent_newton_method </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>disable globally convergent Newton method </p>
<div class="fragment"><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;    {</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#acf8b1ec937efdf2a0f892a41c18c0c53">Use_globally_convergent_newton_method</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acf8b1ec937efdf2a0f892a41c18c0c53">Use_globally_convergent_newton_method</a>.</p>

</div>
</div>
<a id="af00e3623681347439fe3dac650423bbe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af00e3623681347439fe3dac650423bbe">&#9670;&nbsp;</a></span>disable_info_in_newton_solve()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Problem::disable_info_in_newton_solve </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Disable the output of information when in the newton solver. </p>
<div class="fragment"><div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;    {</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab4a3743c23a2d1eed56981484636c958">Shut_up_in_newton_solve</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab4a3743c23a2d1eed56981484636c958">Shut_up_in_newton_solve</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d62/classPerturbedStateProblem.html#a49c677252dd9ecfdc115a72167663b37">PerturbedStateProblem&lt; BASE_ELEMENT, PERTURBED_ELEMENT &gt;::PerturbedStateProblem()</a>, and <a class="el" href="../../d5/dc5/classoomph_1_1ProjectionProblem.html#ad972f78212e515a03d1018996115265a">oomph::ProjectionProblem&lt; PROJECTABLE_ELEMENT &gt;::project()</a>.</p>

</div>
</div>
<a id="a52489fed5942629199e4f720a7a86549"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52489fed5942629199e4f720a7a86549">&#9670;&nbsp;</a></span>disable_jacobian_reuse()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Problem::disable_jacobian_reuse </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Disable recycling of Jacobian in Newton iteration. </p>
<div class="fragment"><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;    {</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a022796f2c96f2dff6ed1db2338c93aaf">Jacobian_reuse_is_enabled</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a2c4702c75739c967ed582dbd0a7ba56f">Jacobian_has_been_computed</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a2c4702c75739c967ed582dbd0a7ba56f">Jacobian_has_been_computed</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a022796f2c96f2dff6ed1db2338c93aaf">Jacobian_reuse_is_enabled</a>.</p>

</div>
</div>
<a id="a368ac86b9807c29864de42a872fd534f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a368ac86b9807c29864de42a872fd534f">&#9670;&nbsp;</a></span>disable_mass_matrix_reuse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::disable_mass_matrix_reuse </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Turn off recyling of the mass matrix in explicit timestepping schemes</p>
<p>Turn off the recyling of the mass matrix in explicit time-stepping schemes </p>
<div class="fragment"><div class="line"><a name="l11833"></a><span class="lineno">11833</span>&#160;  {</div>
<div class="line"><a name="l11834"></a><span class="lineno">11834</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#af4d25809ac090102a4d4a398e4ad0e26">Mass_matrix_reuse_is_enabled</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l11835"></a><span class="lineno">11835</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a6067c6d344363a073fb8d02a99fb7ed0">Mass_matrix_has_been_computed</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l11836"></a><span class="lineno">11836</span>&#160; </div>
<div class="line"><a name="l11837"></a><span class="lineno">11837</span>&#160;    <span class="comment">// If we have a discontinuous formulation set the element-level</span></div>
<div class="line"><a name="l11838"></a><span class="lineno">11838</span>&#160;    <span class="comment">// function</span></div>
<div class="line"><a name="l11839"></a><span class="lineno">11839</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a97ca0078fff6adca318835c11503dc2d">Discontinuous_element_formulation</a>)</div>
<div class="line"><a name="l11840"></a><span class="lineno">11840</span>&#160;    {</div>
<div class="line"><a name="l11841"></a><span class="lineno">11841</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_element = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">Problem::mesh_pt</a>()-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">nelement</a>();</div>
<div class="line"><a name="l11842"></a><span class="lineno">11842</span>&#160;      <span class="comment">// Loop over the other elements</span></div>
<div class="line"><a name="l11843"></a><span class="lineno">11843</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; n_element; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l11844"></a><span class="lineno">11844</span>&#160;      {</div>
<div class="line"><a name="l11845"></a><span class="lineno">11845</span>&#160;        <span class="comment">// Cache the element</span></div>
<div class="line"><a name="l11846"></a><span class="lineno">11846</span>&#160;        DGElement* <span class="keyword">const</span> elem_pt =</div>
<div class="line"><a name="l11847"></a><span class="lineno">11847</span>&#160;          <span class="keyword">dynamic_cast&lt;</span>DGElement*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">Problem::mesh_pt</a>()-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">element_pt</a>(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>));</div>
<div class="line"><a name="l11848"></a><span class="lineno">11848</span>&#160;        elem_pt-&gt;disable_mass_matrix_reuse();</div>
<div class="line"><a name="l11849"></a><span class="lineno">11849</span>&#160;      }</div>
<div class="line"><a name="l11850"></a><span class="lineno">11850</span>&#160;    }</div>
<div class="line"><a name="l11851"></a><span class="lineno">11851</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../db/d5d/classoomph_1_1DGElement.html#a1fb4172f65716e0b5277efc65b182d44">oomph::DGElement::disable_mass_matrix_reuse()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a97ca0078fff6adca318835c11503dc2d">Discontinuous_element_formulation</a>, <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">oomph::Mesh::element_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6067c6d344363a073fb8d02a99fb7ed0">Mass_matrix_has_been_computed</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af4d25809ac090102a4d4a398e4ad0e26">Mass_matrix_reuse_is_enabled</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt()</a>, and <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">oomph::Mesh::nelement()</a>.</p>

</div>
</div>
<a id="ac23468bc4101d3038e6b537b6fc87aa6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac23468bc4101d3038e6b537b6fc87aa6">&#9670;&nbsp;</a></span>disable_store_local_dof_pt_in_elements()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Problem::disable_store_local_dof_pt_in_elements </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Insist that local dof pointers are NOT set up in each element when equation numbering takes place (the default) </p>
<div class="fragment"><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;    {</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a075696d6f4c4260ce860997c8c931de4">Store_local_dof_pt_in_elements</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a075696d6f4c4260ce860997c8c931de4">Store_local_dof_pt_in_elements</a>.</p>

</div>
</div>
<a id="af5e9f1623cad361048856a4c0463ea23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5e9f1623cad361048856a4c0463ea23">&#9670;&nbsp;</a></span>distributed()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::Problem::distributed </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>If we have MPI return the "problem has been distributed" flag, otherwise it can't be distributed so return false. </p>
<div class="fragment"><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    {</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;      <span class="keywordflow">return</span> Problem_has_been_distributed;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acbc0b0fc5d5cc76ce8384bc0bd815f26">calculate_predictions()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#adb5998dfed961de76c33ae3b6fa516b4">get_dofs()</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ac3f40f62d33d33616cdb4bed48aaccde">oomph::NavierStokesSchurComplementPreconditioner::get_pressure_advection_diffusion_matrix()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a96e0343c261d087f5d67a49f68561d96">oomph::PitchForkHandler::PitchForkHandler()</a>, <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a9a424fd2ae0b67ef8c3ff59f16030786">oomph::BlockPitchForkLinearSolver::resolve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac3ec67f2c633cc414905ade9fa148939">set_dofs()</a>, and <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#ad196867613954a8fabd318b50e2aadc6">oomph::BlockPitchForkLinearSolver::solve()</a>.</p>

</div>
</div>
<a id="af2a9dfdb7b4f95bb941d48411f955f55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2a9dfdb7b4f95bb941d48411f955f55">&#9670;&nbsp;</a></span>doc_errors() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Problem::doc_errors </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get max and min error for all elements in submeshes. </p>
<div class="fragment"><div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;    {</div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;      DocInfo tmp_doc_info;</div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;      tmp_doc_info.disable_doc();</div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#af2a9dfdb7b4f95bb941d48411f955f55">doc_errors</a>(tmp_doc_info);</div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1Problem_html_af2a9dfdb7b4f95bb941d48411f955f55"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#af2a9dfdb7b4f95bb941d48411f955f55">oomph::Problem::doc_errors</a></div><div class="ttdeci">void doc_errors()</div><div class="ttdoc">Get max and min error for all elements in submeshes.</div><div class="ttdef"><b>Definition:</b> problem.h:2926</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html#a666a20817ab9c396b225d8652bc0a338">oomph::DocInfo::disable_doc()</a>.</p>

</div>
</div>
<a id="adfa6431916fd73b661d8a62706d5137f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adfa6431916fd73b661d8a62706d5137f">&#9670;&nbsp;</a></span>doc_errors() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::doc_errors </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>doc_info</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get max and min error for all elements in submeshes. </p>
<div class="fragment"><div class="line"><a name="l14775"></a><span class="lineno">14775</span>&#160;  {</div>
<div class="line"><a name="l14776"></a><span class="lineno">14776</span>&#160;    <span class="comment">// Get the bifurcation type</span></div>
<div class="line"><a name="l14777"></a><span class="lineno">14777</span>&#160;    <span class="keywordtype">int</span> bifurcation_type = this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>-&gt;<a class="code" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a22c5f240674e4f6cee12006790c11dae">bifurcation_type</a>();</div>
<div class="line"><a name="l14778"></a><span class="lineno">14778</span>&#160;    <span class="comment">// If we are tracking a bifurcation then call the bifurcation adapt function</span></div>
<div class="line"><a name="l14779"></a><span class="lineno">14779</span>&#160;    <span class="keywordflow">if</span> (bifurcation_type != 0)</div>
<div class="line"><a name="l14780"></a><span class="lineno">14780</span>&#160;    {</div>
<div class="line"><a name="l14781"></a><span class="lineno">14781</span>&#160;      this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a0b44e70f6ecabd3ee3401a9febd95275">bifurcation_adapt_doc_errors</a>(bifurcation_type);</div>
<div class="line"><a name="l14782"></a><span class="lineno">14782</span>&#160;      <span class="comment">// Return immediately</span></div>
<div class="line"><a name="l14783"></a><span class="lineno">14783</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l14784"></a><span class="lineno">14784</span>&#160;    }</div>
<div class="line"><a name="l14785"></a><span class="lineno">14785</span>&#160; </div>
<div class="line"><a name="l14786"></a><span class="lineno">14786</span>&#160;    <span class="comment">// Number of submeshes?</span></div>
<div class="line"><a name="l14787"></a><span class="lineno">14787</span>&#160;    <span class="keywordtype">unsigned</span> Nmesh = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>();</div>
<div class="line"><a name="l14788"></a><span class="lineno">14788</span>&#160; </div>
<div class="line"><a name="l14789"></a><span class="lineno">14789</span>&#160;    <span class="comment">// Single mesh:</span></div>
<div class="line"><a name="l14790"></a><span class="lineno">14790</span>&#160;    <span class="comment">//------------</span></div>
<div class="line"><a name="l14791"></a><span class="lineno">14791</span>&#160;    <span class="keywordflow">if</span> (Nmesh == 0)</div>
<div class="line"><a name="l14792"></a><span class="lineno">14792</span>&#160;    {</div>
<div class="line"><a name="l14793"></a><span class="lineno">14793</span>&#160;      <span class="comment">// Is the single mesh refineable?</span></div>
<div class="line"><a name="l14794"></a><span class="lineno">14794</span>&#160;      <span class="keywordflow">if</span> (RefineableMeshBase* mmesh_pt =</div>
<div class="line"><a name="l14795"></a><span class="lineno">14795</span>&#160;            <span class="keyword">dynamic_cast&lt;</span>RefineableMeshBase*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(0)))</div>
<div class="line"><a name="l14796"></a><span class="lineno">14796</span>&#160;      {</div>
<div class="line"><a name="l14797"></a><span class="lineno">14797</span>&#160;        <span class="comment">// Get pointer to error estimator</span></div>
<div class="line"><a name="l14798"></a><span class="lineno">14798</span>&#160;        ErrorEstimator* <a class="code" href="../../d8/d32/namespaceMeshRefinement.html#a9dade531077f055da144a85e19e67263">error_estimator_pt</a> =</div>
<div class="line"><a name="l14799"></a><span class="lineno">14799</span>&#160;          mmesh_pt-&gt;spatial_error_estimator_pt();</div>
<div class="line"><a name="l14800"></a><span class="lineno">14800</span>&#160; </div>
<div class="line"><a name="l14801"></a><span class="lineno">14801</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l14802"></a><span class="lineno">14802</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d8/d32/namespaceMeshRefinement.html#a9dade531077f055da144a85e19e67263">error_estimator_pt</a> == 0)</div>
<div class="line"><a name="l14803"></a><span class="lineno">14803</span>&#160;        {</div>
<div class="line"><a name="l14804"></a><span class="lineno">14804</span>&#160;          <span class="keywordflow">throw</span> OomphLibError(<span class="stringliteral">&quot;Error estimator hasn&#39;t been set yet&quot;</span>,</div>
<div class="line"><a name="l14805"></a><span class="lineno">14805</span>&#160;                              <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l14806"></a><span class="lineno">14806</span>&#160;                              <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l14807"></a><span class="lineno">14807</span>&#160;        }</div>
<div class="line"><a name="l14808"></a><span class="lineno">14808</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l14809"></a><span class="lineno">14809</span>&#160; </div>
<div class="line"><a name="l14810"></a><span class="lineno">14810</span>&#160;        <span class="comment">// Get error for all elements</span></div>
<div class="line"><a name="l14811"></a><span class="lineno">14811</span>&#160;        Vector&lt;double&gt; elemental_error(mmesh_pt-&gt;nelement());</div>
<div class="line"><a name="l14812"></a><span class="lineno">14812</span>&#160;        <span class="keywordflow">if</span> (!doc_info.is_doc_enabled())</div>
<div class="line"><a name="l14813"></a><span class="lineno">14813</span>&#160;        {</div>
<div class="line"><a name="l14814"></a><span class="lineno">14814</span>&#160;          <a class="code" href="../../d8/d32/namespaceMeshRefinement.html#a9dade531077f055da144a85e19e67263">error_estimator_pt</a>-&gt;get_element_errors(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(0), elemental_error);</div>
<div class="line"><a name="l14815"></a><span class="lineno">14815</span>&#160;        }</div>
<div class="line"><a name="l14816"></a><span class="lineno">14816</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l14817"></a><span class="lineno">14817</span>&#160;        {</div>
<div class="line"><a name="l14818"></a><span class="lineno">14818</span>&#160;          <a class="code" href="../../d8/d32/namespaceMeshRefinement.html#a9dade531077f055da144a85e19e67263">error_estimator_pt</a>-&gt;get_element_errors(</div>
<div class="line"><a name="l14819"></a><span class="lineno">14819</span>&#160;            <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(0), elemental_error, doc_info);</div>
<div class="line"><a name="l14820"></a><span class="lineno">14820</span>&#160;        }</div>
<div class="line"><a name="l14821"></a><span class="lineno">14821</span>&#160; </div>
<div class="line"><a name="l14822"></a><span class="lineno">14822</span>&#160;        <span class="comment">// Store max./min actual error</span></div>
<div class="line"><a name="l14823"></a><span class="lineno">14823</span>&#160;        mmesh_pt-&gt;max_error() = <a class="code" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">std::fabs</a>(*std::max_element(</div>
<div class="line"><a name="l14824"></a><span class="lineno">14824</span>&#160;          elemental_error.begin(), elemental_error.end(), AbsCmp&lt;double&gt;()));</div>
<div class="line"><a name="l14825"></a><span class="lineno">14825</span>&#160; </div>
<div class="line"><a name="l14826"></a><span class="lineno">14826</span>&#160;        mmesh_pt-&gt;min_error() = <a class="code" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">std::fabs</a>(*std::min_element(</div>
<div class="line"><a name="l14827"></a><span class="lineno">14827</span>&#160;          elemental_error.begin(), elemental_error.end(), AbsCmp&lt;double&gt;()));</div>
<div class="line"><a name="l14828"></a><span class="lineno">14828</span>&#160; </div>
<div class="line"><a name="l14829"></a><span class="lineno">14829</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;\n Max/min error: &quot;</span> &lt;&lt; mmesh_pt-&gt;max_error() &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l14830"></a><span class="lineno">14830</span>&#160;                   &lt;&lt; mmesh_pt-&gt;min_error() &lt;&lt; std::endl;</div>
<div class="line"><a name="l14831"></a><span class="lineno">14831</span>&#160;      }</div>
<div class="line"><a name="l14832"></a><span class="lineno">14832</span>&#160;    }</div>
<div class="line"><a name="l14833"></a><span class="lineno">14833</span>&#160; </div>
<div class="line"><a name="l14834"></a><span class="lineno">14834</span>&#160;    <span class="comment">// Multiple submeshes</span></div>
<div class="line"><a name="l14835"></a><span class="lineno">14835</span>&#160;    <span class="comment">//------------------</span></div>
<div class="line"><a name="l14836"></a><span class="lineno">14836</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l14837"></a><span class="lineno">14837</span>&#160;    {</div>
<div class="line"><a name="l14838"></a><span class="lineno">14838</span>&#160;      <span class="comment">// Loop over submeshes</span></div>
<div class="line"><a name="l14839"></a><span class="lineno">14839</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> imesh = 0; imesh &lt; Nmesh; imesh++)</div>
<div class="line"><a name="l14840"></a><span class="lineno">14840</span>&#160;      {</div>
<div class="line"><a name="l14841"></a><span class="lineno">14841</span>&#160;        <span class="comment">// Is the single mesh refineable?</span></div>
<div class="line"><a name="l14842"></a><span class="lineno">14842</span>&#160;        <span class="keywordflow">if</span> (RefineableMeshBase* mmesh_pt =</div>
<div class="line"><a name="l14843"></a><span class="lineno">14843</span>&#160;              <span class="keyword">dynamic_cast&lt;</span>RefineableMeshBase*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(imesh)))</div>
<div class="line"><a name="l14844"></a><span class="lineno">14844</span>&#160;        {</div>
<div class="line"><a name="l14845"></a><span class="lineno">14845</span>&#160;          <span class="comment">// Get pointer to error estimator</span></div>
<div class="line"><a name="l14846"></a><span class="lineno">14846</span>&#160;          ErrorEstimator* <a class="code" href="../../d8/d32/namespaceMeshRefinement.html#a9dade531077f055da144a85e19e67263">error_estimator_pt</a> =</div>
<div class="line"><a name="l14847"></a><span class="lineno">14847</span>&#160;            mmesh_pt-&gt;spatial_error_estimator_pt();</div>
<div class="line"><a name="l14848"></a><span class="lineno">14848</span>&#160; </div>
<div class="line"><a name="l14849"></a><span class="lineno">14849</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l14850"></a><span class="lineno">14850</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d8/d32/namespaceMeshRefinement.html#a9dade531077f055da144a85e19e67263">error_estimator_pt</a> == 0)</div>
<div class="line"><a name="l14851"></a><span class="lineno">14851</span>&#160;          {</div>
<div class="line"><a name="l14852"></a><span class="lineno">14852</span>&#160;            <span class="keywordflow">throw</span> OomphLibError(<span class="stringliteral">&quot;Error estimator hasn&#39;t been set yet&quot;</span>,</div>
<div class="line"><a name="l14853"></a><span class="lineno">14853</span>&#160;                                <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l14854"></a><span class="lineno">14854</span>&#160;                                <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l14855"></a><span class="lineno">14855</span>&#160;          }</div>
<div class="line"><a name="l14856"></a><span class="lineno">14856</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l14857"></a><span class="lineno">14857</span>&#160; </div>
<div class="line"><a name="l14858"></a><span class="lineno">14858</span>&#160;          <span class="comment">// Get error for all elements</span></div>
<div class="line"><a name="l14859"></a><span class="lineno">14859</span>&#160;          Vector&lt;double&gt; elemental_error(mmesh_pt-&gt;nelement());</div>
<div class="line"><a name="l14860"></a><span class="lineno">14860</span>&#160;          <span class="keywordflow">if</span> (mmesh_pt-&gt;doc_info_pt() == 0)</div>
<div class="line"><a name="l14861"></a><span class="lineno">14861</span>&#160;          {</div>
<div class="line"><a name="l14862"></a><span class="lineno">14862</span>&#160;            <a class="code" href="../../d8/d32/namespaceMeshRefinement.html#a9dade531077f055da144a85e19e67263">error_estimator_pt</a>-&gt;get_element_errors(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(imesh),</div>
<div class="line"><a name="l14863"></a><span class="lineno">14863</span>&#160;                                                   elemental_error);</div>
<div class="line"><a name="l14864"></a><span class="lineno">14864</span>&#160;          }</div>
<div class="line"><a name="l14865"></a><span class="lineno">14865</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l14866"></a><span class="lineno">14866</span>&#160;          {</div>
<div class="line"><a name="l14867"></a><span class="lineno">14867</span>&#160;            <a class="code" href="../../d8/d32/namespaceMeshRefinement.html#a9dade531077f055da144a85e19e67263">error_estimator_pt</a>-&gt;get_element_errors(</div>
<div class="line"><a name="l14868"></a><span class="lineno">14868</span>&#160;              <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(imesh), elemental_error, *mmesh_pt-&gt;doc_info_pt());</div>
<div class="line"><a name="l14869"></a><span class="lineno">14869</span>&#160;          }</div>
<div class="line"><a name="l14870"></a><span class="lineno">14870</span>&#160; </div>
<div class="line"><a name="l14871"></a><span class="lineno">14871</span>&#160;          <span class="comment">// Store max./min error if the mesh has any elements</span></div>
<div class="line"><a name="l14872"></a><span class="lineno">14872</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(imesh)-&gt;nelement() &gt; 0)</div>
<div class="line"><a name="l14873"></a><span class="lineno">14873</span>&#160;          {</div>
<div class="line"><a name="l14874"></a><span class="lineno">14874</span>&#160;            mmesh_pt-&gt;max_error() =</div>
<div class="line"><a name="l14875"></a><span class="lineno">14875</span>&#160;              <a class="code" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">std::fabs</a>(*std::max_element(elemental_error.begin(),</div>
<div class="line"><a name="l14876"></a><span class="lineno">14876</span>&#160;                                          elemental_error.end(),</div>
<div class="line"><a name="l14877"></a><span class="lineno">14877</span>&#160;                                          AbsCmp&lt;double&gt;()));</div>
<div class="line"><a name="l14878"></a><span class="lineno">14878</span>&#160; </div>
<div class="line"><a name="l14879"></a><span class="lineno">14879</span>&#160;            mmesh_pt-&gt;min_error() =</div>
<div class="line"><a name="l14880"></a><span class="lineno">14880</span>&#160;              <a class="code" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">std::fabs</a>(*std::min_element(elemental_error.begin(),</div>
<div class="line"><a name="l14881"></a><span class="lineno">14881</span>&#160;                                          elemental_error.end(),</div>
<div class="line"><a name="l14882"></a><span class="lineno">14882</span>&#160;                                          AbsCmp&lt;double&gt;()));</div>
<div class="line"><a name="l14883"></a><span class="lineno">14883</span>&#160;          }</div>
<div class="line"><a name="l14884"></a><span class="lineno">14884</span>&#160; </div>
<div class="line"><a name="l14885"></a><span class="lineno">14885</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;\n Max/min error: &quot;</span> &lt;&lt; mmesh_pt-&gt;max_error() &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l14886"></a><span class="lineno">14886</span>&#160;                     &lt;&lt; mmesh_pt-&gt;min_error() &lt;&lt; std::endl;</div>
<div class="line"><a name="l14887"></a><span class="lineno">14887</span>&#160;        }</div>
<div class="line"><a name="l14888"></a><span class="lineno">14888</span>&#160; </div>
<div class="line"><a name="l14889"></a><span class="lineno">14889</span>&#160;      } <span class="comment">// End of loop over submeshes</span></div>
<div class="line"><a name="l14890"></a><span class="lineno">14890</span>&#160;    }</div>
<div class="line"><a name="l14891"></a><span class="lineno">14891</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a0b44e70f6ecabd3ee3401a9febd95275"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a0b44e70f6ecabd3ee3401a9febd95275">oomph::Problem::bifurcation_adapt_doc_errors</a></div><div class="ttdeci">void bifurcation_adapt_doc_errors(const unsigned &amp;bifurcation_type)</div><div class="ttdef"><b>Definition:</b> problem.cc:13648</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a0b44e70f6ecabd3ee3401a9febd95275">bifurcation_adapt_doc_errors()</a>, <a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a22c5f240674e4f6cee12006790c11dae">oomph::AssemblyHandler::bifurcation_type()</a>, <a class="el" href="../../d8/d32/namespaceMeshRefinement.html#a9dade531077f055da144a85e19e67263">MeshRefinement::error_estimator_pt</a>, <a class="el" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">boost::multiprecision::fabs()</a>, <a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html#a2ce90cf54f24b4ab523c624031fbb76b">oomph::DocInfo::is_doc_enabled()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, and <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>.</p>

</div>
</div>
<a id="a75fe4a89f7dccbd72a67333b3959539d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75fe4a89f7dccbd72a67333b3959539d">&#9670;&nbsp;</a></span>does_pointer_correspond_to_problem_data()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> Problem::does_pointer_correspond_to_problem_data </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;&#160;</td>
          <td class="paramname"><em>parameter_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Return a boolean flag to indicate whether the pointer parameter_pt refers to values stored in a Data object that is contained within the problem</p>
<p>Function that returns a boolean flag to indicate whether the pointer parameter_pt refers to memory that is a value in a Data object used within the problem </p>
<div class="fragment"><div class="line"><a name="l09848"></a><span class="lineno"> 9848</span>&#160;  {</div>
<div class="line"><a name="l09849"></a><span class="lineno"> 9849</span>&#160;    <span class="comment">// Firstly check the global data</span></div>
<div class="line"><a name="l09850"></a><span class="lineno"> 9850</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_global = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>.size();</div>
<div class="line"><a name="l09851"></a><span class="lineno"> 9851</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_global; ++<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><a name="l09852"></a><span class="lineno"> 9852</span>&#160;    {</div>
<div class="line"><a name="l09853"></a><span class="lineno"> 9853</span>&#160;      <span class="comment">// If we find it then return true</span></div>
<div class="line"><a name="l09854"></a><span class="lineno"> 9854</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;does_pointer_correspond_to_value(parameter_pt))</div>
<div class="line"><a name="l09855"></a><span class="lineno"> 9855</span>&#160;      {</div>
<div class="line"><a name="l09856"></a><span class="lineno"> 9856</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l09857"></a><span class="lineno"> 9857</span>&#160;      }</div>
<div class="line"><a name="l09858"></a><span class="lineno"> 9858</span>&#160;    }</div>
<div class="line"><a name="l09859"></a><span class="lineno"> 9859</span>&#160; </div>
<div class="line"><a name="l09860"></a><span class="lineno"> 9860</span>&#160;    <span class="comment">// If we find the pointer in the mesh data return true</span></div>
<div class="line"><a name="l09861"></a><span class="lineno"> 9861</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a13712b3fb8f01107772db51e01dbeee0">does_pointer_correspond_to_mesh_data</a>(parameter_pt))</div>
<div class="line"><a name="l09862"></a><span class="lineno"> 9862</span>&#160;    {</div>
<div class="line"><a name="l09863"></a><span class="lineno"> 9863</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l09864"></a><span class="lineno"> 9864</span>&#160;    }</div>
<div class="line"><a name="l09865"></a><span class="lineno"> 9865</span>&#160; </div>
<div class="line"><a name="l09866"></a><span class="lineno"> 9866</span>&#160;    <span class="comment">// Loop over the submeshes to handle the case of spine data</span></div>
<div class="line"><a name="l09867"></a><span class="lineno"> 9867</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_sub_mesh = this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>();</div>
<div class="line"><a name="l09868"></a><span class="lineno"> 9868</span>&#160;    <span class="comment">// If there is only one mesh</span></div>
<div class="line"><a name="l09869"></a><span class="lineno"> 9869</span>&#160;    <span class="keywordflow">if</span> (n_sub_mesh == 0)</div>
<div class="line"><a name="l09870"></a><span class="lineno"> 9870</span>&#160;    {</div>
<div class="line"><a name="l09871"></a><span class="lineno"> 9871</span>&#160;      <span class="keywordflow">if</span> (SpineMesh* <span class="keyword">const</span> spine_mesh_pt = <span class="keyword">dynamic_cast&lt;</span>SpineMesh*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>))</div>
<div class="line"><a name="l09872"></a><span class="lineno"> 9872</span>&#160;      {</div>
<div class="line"><a name="l09873"></a><span class="lineno"> 9873</span>&#160;        <span class="keywordflow">if</span> (spine_mesh_pt-&gt;does_pointer_correspond_to_spine_data(parameter_pt))</div>
<div class="line"><a name="l09874"></a><span class="lineno"> 9874</span>&#160;        {</div>
<div class="line"><a name="l09875"></a><span class="lineno"> 9875</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l09876"></a><span class="lineno"> 9876</span>&#160;        }</div>
<div class="line"><a name="l09877"></a><span class="lineno"> 9877</span>&#160;      }</div>
<div class="line"><a name="l09878"></a><span class="lineno"> 9878</span>&#160;    }</div>
<div class="line"><a name="l09879"></a><span class="lineno"> 9879</span>&#160;    <span class="comment">// Otherwise loop over the sub meshes</span></div>
<div class="line"><a name="l09880"></a><span class="lineno"> 9880</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l09881"></a><span class="lineno"> 9881</span>&#160;    {</div>
<div class="line"><a name="l09882"></a><span class="lineno"> 9882</span>&#160;      <span class="comment">// Assign global equation numbers first</span></div>
<div class="line"><a name="l09883"></a><span class="lineno"> 9883</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_sub_mesh; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l09884"></a><span class="lineno"> 9884</span>&#160;      {</div>
<div class="line"><a name="l09885"></a><span class="lineno"> 9885</span>&#160;        <span class="keywordflow">if</span> (SpineMesh* <span class="keyword">const</span> spine_mesh_pt =</div>
<div class="line"><a name="l09886"></a><span class="lineno"> 9886</span>&#160;              <span class="keyword">dynamic_cast&lt;</span>SpineMesh*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab65f6fc9c49860e6324457a7e6e76346">Sub_mesh_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]))</div>
<div class="line"><a name="l09887"></a><span class="lineno"> 9887</span>&#160;        {</div>
<div class="line"><a name="l09888"></a><span class="lineno"> 9888</span>&#160;          <span class="keywordflow">if</span> (spine_mesh_pt-&gt;does_pointer_correspond_to_spine_data(</div>
<div class="line"><a name="l09889"></a><span class="lineno"> 9889</span>&#160;                parameter_pt))</div>
<div class="line"><a name="l09890"></a><span class="lineno"> 9890</span>&#160;          {</div>
<div class="line"><a name="l09891"></a><span class="lineno"> 9891</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l09892"></a><span class="lineno"> 9892</span>&#160;          }</div>
<div class="line"><a name="l09893"></a><span class="lineno"> 9893</span>&#160;        }</div>
<div class="line"><a name="l09894"></a><span class="lineno"> 9894</span>&#160;      }</div>
<div class="line"><a name="l09895"></a><span class="lineno"> 9895</span>&#160;    }</div>
<div class="line"><a name="l09896"></a><span class="lineno"> 9896</span>&#160; </div>
<div class="line"><a name="l09897"></a><span class="lineno"> 9897</span>&#160;    <span class="comment">// If we have got here then the data is not stored in the problem, so return</span></div>
<div class="line"><a name="l09898"></a><span class="lineno"> 9898</span>&#160;    <span class="comment">// false</span></div>
<div class="line"><a name="l09899"></a><span class="lineno"> 9899</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l09900"></a><span class="lineno"> 9900</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_a13712b3fb8f01107772db51e01dbeee0"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#a13712b3fb8f01107772db51e01dbeee0">oomph::Mesh::does_pointer_correspond_to_mesh_data</a></div><div class="ttdeci">bool does_pointer_correspond_to_mesh_data(double *const &amp;parameter_pt)</div><div class="ttdoc">Does the double pointer correspond to any mesh data.</div><div class="ttdef"><b>Definition:</b> mesh.cc:2471</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a13712b3fb8f01107772db51e01dbeee0">oomph::Mesh::does_pointer_correspond_to_mesh_data()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab65f6fc9c49860e6324457a7e6e76346">Sub_mesh_pt</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aee0d9902fd26b600c9519bea2dfc0f54">arc_length_step_solve()</a>.</p>

</div>
</div>
<a id="a74d71439b100fb5b66b94d1d69130f7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74d71439b100fb5b66b94d1d69130f7c">&#9670;&nbsp;</a></span>dof() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a>&amp; oomph::Problem::dof </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>i-th dof in the problem </p>
<div class="fragment"><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;    {</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;      <span class="keywordflow">return</span> *(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>, and <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d9e/classoomph_1_1IMRByBDF.html#abc155a68889d297f732a083d911b4627">oomph::IMRByBDF::actions_before_timestep()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a63805c549e71b7c73107abe6001fae25">adaptive_unsteady_newton_solve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa3393dfcbf36c6198aead92c08ab95d0">add_eigenvector_to_dofs()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ada703cde7417adda572a72d05ddfa4b9">assign_eigenvector_to_dofs()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa0b4e7868e02e2d12845c9b2dd60cab9">bifurcation_adapt_helper()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acbc0b0fc5d5cc76ce8384bc0bd815f26">calculate_predictions()</a>, <a class="el" href="../../d2/da2/classoomph_1_1PeriodicOrbitAssemblyHandler.html#a9e8d41c8ad79134466a1a50c11c62dc3">oomph::PeriodicOrbitAssemblyHandler&lt; NNODE_1D &gt;::get_dofs_for_element()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a497518acb5d30a28a253890c3d2a5da2">get_hessian_vector_products()</a>, <a class="el" href="../../dd/d4b/classoomph_1_1AugmentedBlockFoldLinearSolver.html#a7728fc74802b6802ed966765bc1e62d9">oomph::AugmentedBlockFoldLinearSolver::resolve()</a>, <a class="el" href="../../de/d72/classoomph_1_1AugmentedBlockPitchForkLinearSolver.html#a1d617896a3f1c1b1236ff18dc87ed8d7">oomph::AugmentedBlockPitchForkLinearSolver::resolve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a3c927ed4f3e79527e0e23ac44779f0f8">restore_dof_values()</a>, <a class="el" href="../../d2/da2/classoomph_1_1PeriodicOrbitAssemblyHandler.html#a3d1d9f709e983495dac3113b8e716843">oomph::PeriodicOrbitAssemblyHandler&lt; NNODE_1D &gt;::set_dofs_for_element()</a>, <a class="el" href="../../d2/da2/classoomph_1_1PeriodicOrbitAssemblyHandler.html#ac3296942fb40f5ca642521db38d44988">oomph::PeriodicOrbitAssemblyHandler&lt; NNODE_1D &gt;::set_previous_dofs_to_current_dofs()</a>, <a class="el" href="../../dd/d4b/classoomph_1_1AugmentedBlockFoldLinearSolver.html#a11690b33089e999d0c894b4e4b0646d9">oomph::AugmentedBlockFoldLinearSolver::solve()</a>, <a class="el" href="../../de/d72/classoomph_1_1AugmentedBlockPitchForkLinearSolver.html#a0cbeb150ac83d5be1a1e30c0f728a70b">oomph::AugmentedBlockPitchForkLinearSolver::solve()</a>, <a class="el" href="../../df/dbd/classoomph_1_1BlockHopfLinearSolver.html#a5e9ff24466ec138cca8264e5befc31fe">oomph::BlockHopfLinearSolver::solve()</a>, <a class="el" href="../../df/dbd/classoomph_1_1BlockHopfLinearSolver.html#a9a7cc6bda9ab1a8baf83d5d8e1fe5eea">oomph::BlockHopfLinearSolver::solve_for_two_rhs()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac3ed0463968bd0fef5d9b97bcb8ca163">store_current_dof_values()</a>.</p>

</div>
</div>
<a id="a200cbd03828632d448c3525e9a921f27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a200cbd03828632d448c3525e9a921f27">&#9670;&nbsp;</a></span>dof() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> oomph::Problem::dof </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>i-th dof in the problem (const version) </p>
<div class="fragment"><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;    {</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;      <span class="keywordflow">return</span> *(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>, and <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>.</p>

</div>
</div>
<a id="a10fd6457ceceb02a0e11d860ac0017c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10fd6457ceceb02a0e11d860ac0017c5">&#9670;&nbsp;</a></span>dof_current()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a>&amp; oomph::Problem::dof_current </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Access function to the current value of the i-th (local) dof at the start of a continuation step </p>
<div class="fragment"><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    {</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#adbecce0cb1bd7b6b21285568e41ee3eb">Use_continuation_timestepper</a>)</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;      {</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a366b50c490e9fd3ddafa05b2fbd0b883">Dof_current</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;      }</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;      {</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;        <span class="keywordflow">return</span> (*(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] + <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a57825be8c76db9e23e6a9aa0d73973b2">Dof_current_offset</a>));</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;      }</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a366b50c490e9fd3ddafa05b2fbd0b883">Dof_current</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a57825be8c76db9e23e6a9aa0d73973b2">Dof_current_offset</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#adbecce0cb1bd7b6b21285568e41ee3eb">Use_continuation_timestepper</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5e60c7b47591bca6b20b0612e119983">adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acc35de219c1c1032a14840021fd8a6b9">arc_length_step_solve_helper()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7b86783463433cc9c4cc382b1b40f0e1">newton_solve_continuation()</a>.</p>

</div>
</div>
<a id="ad6df5fb0d282f25df1e94a665dd838e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6df5fb0d282f25df1e94a665dd838e5">&#9670;&nbsp;</a></span>dof_derivative()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a>&amp; oomph::Problem::dof_derivative </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Access function to the derivative of the i-th (local) dof with respect to the arc length, used in continuation </p>
<div class="fragment"><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;    {</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#adbecce0cb1bd7b6b21285568e41ee3eb">Use_continuation_timestepper</a>)</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;      {</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a1861321b2d129707935bf1191238daca">Dof_derivative</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;      }</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;      {</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;        <span class="keywordflow">return</span> (*(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] + <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#af0372f742b90bb402c6edc720ceeb421">Dof_derivative_offset</a>));</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;      }</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a1861321b2d129707935bf1191238daca">Dof_derivative</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af0372f742b90bb402c6edc720ceeb421">Dof_derivative_offset</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#adbecce0cb1bd7b6b21285568e41ee3eb">Use_continuation_timestepper</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5e60c7b47591bca6b20b0612e119983">adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acc35de219c1c1032a14840021fd8a6b9">arc_length_step_solve_helper()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7a4dac8d3f4f06020b04a4af0a2d7b32">calculate_continuation_derivatives_fd_helper()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a420904bddcee85ee817dd9fcad0df216">calculate_continuation_derivatives_helper()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7b86783463433cc9c4cc382b1b40f0e1">newton_solve_continuation()</a>.</p>

</div>
</div>
<a id="a17a5a4886c4213422179fe8346336a4e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17a5a4886c4213422179fe8346336a4e">&#9670;&nbsp;</a></span>dof_distribution_pt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a>* const&amp; oomph::Problem::dof_distribution_pt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the pointer to the dof distribution (read-only) </p>
<div class="fragment"><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;    {</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>;</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a63805c549e71b7c73107abe6001fae25">adaptive_unsteady_newton_solve()</a>, <a class="el" href="../../d6/dcc/classoomph_1_1ProblemBasedShiftInvertOperator.html#a2a25d70c81543acf3c97ae7fbe32648e">oomph::ProblemBasedShiftInvertOperator::ProblemBasedShiftInvertOperator()</a>, and <a class="el" href="../../d1/d59/classoomph_1_1ANASAZI.html#af3084c6ec6fc86b5758bb853088c7f8a">oomph::ANASAZI::solve_eigenproblem()</a>.</p>

</div>
</div>
<a id="a02f480ec17e0b9b03c892be5ed0c64d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02f480ec17e0b9b03c892be5ed0c64d1">&#9670;&nbsp;</a></span>dof_pt() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a>*&amp; oomph::Problem::dof_pt </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pointer to i-th dof in the problem. </p>
<div class="fragment"><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;    {</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>, and <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#ab61559fc5df46871c1eebd103f7bf08b">oomph::AssemblyHandler::local_problem_dof()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a2119786e1204edeb90ed58f4faf0eae4">set_dofs()</a>.</p>

</div>
</div>
<a id="acf51914cb75a640f82b269493311c187"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf51914cb75a640f82b269493311c187">&#9670;&nbsp;</a></span>dof_pt() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a>* oomph::Problem::dof_pt </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pointer to i-th dof in the problem (const version) </p>
<div class="fragment"><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;    {</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>, and <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>.</p>

</div>
</div>
<a id="a7561d4f82e1fa625210c58a78294a301"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7561d4f82e1fa625210c58a78294a301">&#9670;&nbsp;</a></span>doubly_adaptive_unsteady_newton_solve() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> oomph::Problem::doubly_adaptive_unsteady_newton_solve </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>epsilon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>max_adapt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;&#160;</td>
          <td class="paramname"><em>first</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;&#160;</td>
          <td class="paramname"><em>shift</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Unsteady "doubly" adaptive Newton solve: Does temporal adaptation first, i.e. we try to do a timestep with an increment of dt, and adjusting dt until the solution on the given mesh satisfies the temporal error measure with tolerance epsilon. Following this, we do up to max_adapt spatial adaptions (without re-examining the temporal error). If first==true, the initial conditions are re-assigned after the mesh adaptations. Shifting of time can be suppressed by overwriting the default value of shift (true). [Shifting must be done if first_timestep==true because we're constantly re-assigning the initial conditions; if first_timestep==true and shift==false shifting is performed anyway and a warning is issued. </p>
<div class="fragment"><div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;    {</div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;      <span class="comment">// Call helper function with default setting (do re-solve after</span></div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;      <span class="comment">// spatial adaptation)</span></div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;      <span class="keywordtype">unsigned</span> suppress_resolve_after_spatial_adapt_flag = 0;</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a7c23771b77d6da7cbee3c3e3c050be73">doubly_adaptive_unsteady_newton_solve_helper</a>(</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;        dt,</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;        <a class="code" href="../../d5/d34/namespaceoomph_1_1SarahBL.html#a21bfe7e71f0baa62022d1ecc9bd175de">epsilon</a>,</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;        max_adapt,</div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;        suppress_resolve_after_spatial_adapt_flag,</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;        first,</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;        shift);</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a7c23771b77d6da7cbee3c3e3c050be73"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a7c23771b77d6da7cbee3c3e3c050be73">oomph::Problem::doubly_adaptive_unsteady_newton_solve_helper</a></div><div class="ttdeci">double doubly_adaptive_unsteady_newton_solve_helper(const double &amp;dt, const double &amp;epsilon, const unsigned &amp;max_adapt, const unsigned &amp;suppress_resolve_after_spatial_adapt, const bool &amp;first, const bool &amp;shift=true)</div><div class="ttdef"><b>Definition:</b> problem.cc:11379</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7c23771b77d6da7cbee3c3e3c050be73">doubly_adaptive_unsteady_newton_solve_helper()</a>, and <a class="el" href="../../d5/d34/namespaceoomph_1_1SarahBL.html#a21bfe7e71f0baa62022d1ecc9bd175de">oomph::SarahBL::epsilon</a>.</p>

</div>
</div>
<a id="ae6c326bce8647c2a59cf62288ce4902e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6c326bce8647c2a59cf62288ce4902e">&#9670;&nbsp;</a></span>doubly_adaptive_unsteady_newton_solve() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> oomph::Problem::doubly_adaptive_unsteady_newton_solve </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>epsilon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>max_adapt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>suppress_resolve_after_spatial_adapt_flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;&#160;</td>
          <td class="paramname"><em>first</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;&#160;</td>
          <td class="paramname"><em>shift</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Unsteady "doubly" adaptive Newton solve: Does temporal adaptation first, i.e. we try to do a timestep with an increment of dt, and adjusting dt until the solution on the given mesh satisfies the temporal error measure with tolerance epsilon. Following this, we do up to max_adapt spatial adaptions (without re-examining the temporal error). If first==true, the initial conditions are re-assigned after the mesh adaptations. Shifting of time can be suppressed by overwriting the default value of shift (true). [Shifting must be done if first_timestep==true because we're constantly re-assigning the initial conditions; if first_timestep==true and shift==false shifting is performed anyway and a warning is issued. Pseudo-Boolean flag suppress_resolve_after_spatial_adapt [0: false; 1: true] does what it says.] </p>
<div class="fragment"><div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;    {</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;      <span class="comment">// Call helper function</span></div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a7c23771b77d6da7cbee3c3e3c050be73">doubly_adaptive_unsteady_newton_solve_helper</a>(</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;        dt,</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;        <a class="code" href="../../d5/d34/namespaceoomph_1_1SarahBL.html#a21bfe7e71f0baa62022d1ecc9bd175de">epsilon</a>,</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;        max_adapt,</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;        suppress_resolve_after_spatial_adapt_flag,</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;        first,</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;        shift);</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7c23771b77d6da7cbee3c3e3c050be73">doubly_adaptive_unsteady_newton_solve_helper()</a>, and <a class="el" href="../../d5/d34/namespaceoomph_1_1SarahBL.html#a21bfe7e71f0baa62022d1ecc9bd175de">oomph::SarahBL::epsilon</a>.</p>

</div>
</div>
<a id="a7c23771b77d6da7cbee3c3e3c050be73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c23771b77d6da7cbee3c3e3c050be73">&#9670;&nbsp;</a></span>doubly_adaptive_unsteady_newton_solve_helper()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> Problem::doubly_adaptive_unsteady_newton_solve_helper </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>dt_desired</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>epsilon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>max_adapt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>suppress_resolve_after_spatial_adapt_flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;&#160;</td>
          <td class="paramname"><em>first</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;&#160;</td>
          <td class="paramname"><em>shift_values</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Private helper function that actually performs the unsteady "doubly" adaptive Newton solve. See actual (non-helper) functions for description of parameters.</p>
<p>Private helper function to perform unsteady "doubly" adaptive Newton solve: Does temporal adaptation first, i.e. we try to do a timestep with an increment of dt, and adjusting dt until the solution on the given mesh satisfies the temporal error measure with tolerance epsilon. Following this, we do up to max_adapt spatial adaptions (without re-examining the temporal error). If first==true, the initial conditions are re-assigned after the mesh adaptations. Shifting of time can be suppressed by overwriting the default value of shift (true). [Shifting must be done if first_timestep==true because we're constantly re-assigning the initial conditions; if first_timestep==true and shift==false shifting is performed anyway and a warning is issued. Pseudo-Boolean flag suppress_resolve_after_spatial_adapt [0: false; 1: true] does what it says.] </p>
<div class="fragment"><div class="line"><a name="l11386"></a><span class="lineno">11386</span>&#160;  {</div>
<div class="line"><a name="l11387"></a><span class="lineno">11387</span>&#160;    <span class="comment">// Store the initial time</span></div>
<div class="line"><a name="l11388"></a><span class="lineno">11388</span>&#160;    <span class="keywordtype">double</span> initial_time = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a46894b13c582f322082dc471a2485980">time_pt</a>()-&gt;<a class="code" href="../../d0/da1/classoomph_1_1Time.html#a6e28ea7a6664a2f5f5e1be871304a2c7">time</a>();</div>
<div class="line"><a name="l11389"></a><span class="lineno">11389</span>&#160; </div>
<div class="line"><a name="l11390"></a><span class="lineno">11390</span>&#160;    <span class="comment">// Take adaptive timestep, adjusting dt until tolerance is satisfied</span></div>
<div class="line"><a name="l11391"></a><span class="lineno">11391</span>&#160;    <span class="keywordtype">double</span> new_dt =</div>
<div class="line"><a name="l11392"></a><span class="lineno">11392</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a9b7434598b8a28bf6470f481acef5d5f">adaptive_unsteady_newton_solve</a>(dt_desired, <a class="code" href="../../d5/d34/namespaceoomph_1_1SarahBL.html#a21bfe7e71f0baa62022d1ecc9bd175de">epsilon</a>, shift_values);</div>
<div class="line"><a name="l11393"></a><span class="lineno">11393</span>&#160;    <span class="keywordtype">double</span> dt_taken = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a46894b13c582f322082dc471a2485980">time_pt</a>()-&gt;<a class="code" href="../../d0/da1/classoomph_1_1Time.html#a2c684e0a69db7adde90f1f052e424a6b">dt</a>();</div>
<div class="line"><a name="l11394"></a><span class="lineno">11394</span>&#160;    <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Accepted solution taken with timestep: &quot;</span> &lt;&lt; dt_taken</div>
<div class="line"><a name="l11395"></a><span class="lineno">11395</span>&#160;               &lt;&lt; std::endl;</div>
<div class="line"><a name="l11396"></a><span class="lineno">11396</span>&#160; </div>
<div class="line"><a name="l11397"></a><span class="lineno">11397</span>&#160; </div>
<div class="line"><a name="l11398"></a><span class="lineno">11398</span>&#160;    <span class="comment">// Bail out straightaway if no spatial adaptation allowed</span></div>
<div class="line"><a name="l11399"></a><span class="lineno">11399</span>&#160;    <span class="keywordflow">if</span> (max_adapt == 0)</div>
<div class="line"><a name="l11400"></a><span class="lineno">11400</span>&#160;    {</div>
<div class="line"><a name="l11401"></a><span class="lineno">11401</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;No spatial refinement allowed; max_adapt=0\n&quot;</span>;</div>
<div class="line"><a name="l11402"></a><span class="lineno">11402</span>&#160;      <span class="keywordflow">return</span> new_dt;</div>
<div class="line"><a name="l11403"></a><span class="lineno">11403</span>&#160;    }</div>
<div class="line"><a name="l11404"></a><span class="lineno">11404</span>&#160; </div>
<div class="line"><a name="l11405"></a><span class="lineno">11405</span>&#160;    <span class="comment">// Adapt problem/mesh</span></div>
<div class="line"><a name="l11406"></a><span class="lineno">11406</span>&#160;    <span class="keywordtype">unsigned</span> n_refined = 0;</div>
<div class="line"><a name="l11407"></a><span class="lineno">11407</span>&#160;    <span class="keywordtype">unsigned</span> n_unrefined = 0;</div>
<div class="line"><a name="l11408"></a><span class="lineno">11408</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a0b9e09ddfa2411f14fc723c3207decd1">adapt</a>(n_refined, n_unrefined);</div>
<div class="line"><a name="l11409"></a><span class="lineno">11409</span>&#160; </div>
<div class="line"><a name="l11410"></a><span class="lineno">11410</span>&#160;    <span class="comment">// Check if mesh has been adapted on other processors</span></div>
<div class="line"><a name="l11411"></a><span class="lineno">11411</span>&#160;    Vector&lt;int&gt; total_ref_count(2);</div>
<div class="line"><a name="l11412"></a><span class="lineno">11412</span>&#160;    total_ref_count[0] = n_refined;</div>
<div class="line"><a name="l11413"></a><span class="lineno">11413</span>&#160;    total_ref_count[1] = n_unrefined;</div>
<div class="line"><a name="l11414"></a><span class="lineno">11414</span>&#160; </div>
<div class="line"><a name="l11415"></a><span class="lineno">11415</span>&#160; </div>
<div class="line"><a name="l11416"></a><span class="lineno">11416</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l11417"></a><span class="lineno">11417</span>&#160;    <span class="keywordflow">if</span> (Problem_has_been_distributed)</div>
<div class="line"><a name="l11418"></a><span class="lineno">11418</span>&#160;    {</div>
<div class="line"><a name="l11419"></a><span class="lineno">11419</span>&#160;      <span class="comment">// Sum n_refine across all processors</span></div>
<div class="line"><a name="l11420"></a><span class="lineno">11420</span>&#160;      Vector&lt;int&gt; ref_count(2);</div>
<div class="line"><a name="l11421"></a><span class="lineno">11421</span>&#160;      ref_count[0] = n_refined;</div>
<div class="line"><a name="l11422"></a><span class="lineno">11422</span>&#160;      ref_count[1] = n_unrefined;</div>
<div class="line"><a name="l11423"></a><span class="lineno">11423</span>&#160;      MPI_Allreduce(&amp;ref_count[0],</div>
<div class="line"><a name="l11424"></a><span class="lineno">11424</span>&#160;                    &amp;total_ref_count[0],</div>
<div class="line"><a name="l11425"></a><span class="lineno">11425</span>&#160;                    2,</div>
<div class="line"><a name="l11426"></a><span class="lineno">11426</span>&#160;                    MPI_INT,</div>
<div class="line"><a name="l11427"></a><span class="lineno">11427</span>&#160;                    MPI_SUM,</div>
<div class="line"><a name="l11428"></a><span class="lineno">11428</span>&#160;                    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">communicator_pt</a>()-&gt;mpi_comm());</div>
<div class="line"><a name="l11429"></a><span class="lineno">11429</span>&#160;    }</div>
<div class="line"><a name="l11430"></a><span class="lineno">11430</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l11431"></a><span class="lineno">11431</span>&#160; </div>
<div class="line"><a name="l11432"></a><span class="lineno">11432</span>&#160; </div>
<div class="line"><a name="l11433"></a><span class="lineno">11433</span>&#160;    <span class="comment">// Re-solve the problem if the adaptation has changed anything</span></div>
<div class="line"><a name="l11434"></a><span class="lineno">11434</span>&#160;    <span class="keywordflow">if</span> ((total_ref_count[0] != 0) || (total_ref_count[1] != 0))</div>
<div class="line"><a name="l11435"></a><span class="lineno">11435</span>&#160;    {</div>
<div class="line"><a name="l11436"></a><span class="lineno">11436</span>&#160;      <span class="keywordflow">if</span> (suppress_resolve_after_spatial_adapt_flag == 1)</div>
<div class="line"><a name="l11437"></a><span class="lineno">11437</span>&#160;      {</div>
<div class="line"><a name="l11438"></a><span class="lineno">11438</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Mesh was adapted but re-solve has been suppressed.&quot;</span></div>
<div class="line"><a name="l11439"></a><span class="lineno">11439</span>&#160;                   &lt;&lt; std::endl;</div>
<div class="line"><a name="l11440"></a><span class="lineno">11440</span>&#160;      }</div>
<div class="line"><a name="l11441"></a><span class="lineno">11441</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l11442"></a><span class="lineno">11442</span>&#160;      {</div>
<div class="line"><a name="l11443"></a><span class="lineno">11443</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a></div>
<div class="line"><a name="l11444"></a><span class="lineno">11444</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;Mesh was adapted --&gt; we&#39;ll re-solve for current timestep.&quot;</span></div>
<div class="line"><a name="l11445"></a><span class="lineno">11445</span>&#160;          &lt;&lt; std::endl;</div>
<div class="line"><a name="l11446"></a><span class="lineno">11446</span>&#160; </div>
<div class="line"><a name="l11447"></a><span class="lineno">11447</span>&#160;        <span class="comment">// Reset time to what it was when we entered here</span></div>
<div class="line"><a name="l11448"></a><span class="lineno">11448</span>&#160;        <span class="comment">// because it will be incremented again by dt_taken.</span></div>
<div class="line"><a name="l11449"></a><span class="lineno">11449</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a46894b13c582f322082dc471a2485980">time_pt</a>()-&gt;<a class="code" href="../../d0/da1/classoomph_1_1Time.html#a6e28ea7a6664a2f5f5e1be871304a2c7">time</a>() = initial_time;</div>
<div class="line"><a name="l11450"></a><span class="lineno">11450</span>&#160; </div>
<div class="line"><a name="l11451"></a><span class="lineno">11451</span>&#160;        <span class="comment">// Shift the timesteps? No! They&#39;ve been shifted already when we</span></div>
<div class="line"><a name="l11452"></a><span class="lineno">11452</span>&#160;        <span class="comment">// called the solve with pure temporal adaptivity...</span></div>
<div class="line"><a name="l11453"></a><span class="lineno">11453</span>&#160;        <span class="keywordtype">bool</span> shift = <span class="keyword">false</span>;</div>
<div class="line"><a name="l11454"></a><span class="lineno">11454</span>&#160; </div>
<div class="line"><a name="l11455"></a><span class="lineno">11455</span>&#160;        <span class="comment">// Reset the inital condition on refined meshes</span></div>
<div class="line"><a name="l11456"></a><span class="lineno">11456</span>&#160;        <span class="keywordflow">if</span> (first)</div>
<div class="line"><a name="l11457"></a><span class="lineno">11457</span>&#160;        {</div>
<div class="line"><a name="l11458"></a><span class="lineno">11458</span>&#160;          <span class="comment">// Reset default set_initial_condition has been called flag to false</span></div>
<div class="line"><a name="l11459"></a><span class="lineno">11459</span>&#160;          <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a83df3b5fcc3ebbae951021c8e7f03ef7">Default_set_initial_condition_called</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l11460"></a><span class="lineno">11460</span>&#160; </div>
<div class="line"><a name="l11461"></a><span class="lineno">11461</span>&#160;          <span class="comment">// Reset the initial conditions</span></div>
<div class="line"><a name="l11462"></a><span class="lineno">11462</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Re-assigning initial condition at time=&quot;</span></div>
<div class="line"><a name="l11463"></a><span class="lineno">11463</span>&#160;                     &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a46894b13c582f322082dc471a2485980">time_pt</a>()-&gt;<a class="code" href="../../d0/da1/classoomph_1_1Time.html#a6e28ea7a6664a2f5f5e1be871304a2c7">time</a>() &lt;&lt; std::endl;</div>
<div class="line"><a name="l11464"></a><span class="lineno">11464</span>&#160;          <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad48be6d67071f7da5f6feb7c4fc918f0">set_initial_condition</a>();</div>
<div class="line"><a name="l11465"></a><span class="lineno">11465</span>&#160; </div>
<div class="line"><a name="l11466"></a><span class="lineno">11466</span>&#160;          <span class="comment">// This is the first timestep so shifting</span></div>
<div class="line"><a name="l11467"></a><span class="lineno">11467</span>&#160;          <span class="comment">// has to be done following the assignment of initial conditions,</span></div>
<div class="line"><a name="l11468"></a><span class="lineno">11468</span>&#160;          <span class="comment">// providing the default set_initial_condition function has not</span></div>
<div class="line"><a name="l11469"></a><span class="lineno">11469</span>&#160;          <span class="comment">// been called.</span></div>
<div class="line"><a name="l11470"></a><span class="lineno">11470</span>&#160;          <span class="comment">// In fact, unsteady_newton_solve(...) does that automatically.</span></div>
<div class="line"><a name="l11471"></a><span class="lineno">11471</span>&#160;          <span class="comment">// We&#39;re changing the flag here to avoid warning messages.</span></div>
<div class="line"><a name="l11472"></a><span class="lineno">11472</span>&#160;          <span class="keywordflow">if</span> (!<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a83df3b5fcc3ebbae951021c8e7f03ef7">Default_set_initial_condition_called</a>)</div>
<div class="line"><a name="l11473"></a><span class="lineno">11473</span>&#160;          {</div>
<div class="line"><a name="l11474"></a><span class="lineno">11474</span>&#160;            shift = <span class="keyword">true</span>;</div>
<div class="line"><a name="l11475"></a><span class="lineno">11475</span>&#160;          }</div>
<div class="line"><a name="l11476"></a><span class="lineno">11476</span>&#160;        }</div>
<div class="line"><a name="l11477"></a><span class="lineno">11477</span>&#160; </div>
<div class="line"><a name="l11478"></a><span class="lineno">11478</span>&#160;        <span class="comment">// Now take the step again on the refined mesh, using the same</span></div>
<div class="line"><a name="l11479"></a><span class="lineno">11479</span>&#160;        <span class="comment">// timestep as used before.</span></div>
<div class="line"><a name="l11480"></a><span class="lineno">11480</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#adb4d5d80b18ea103f71c8013e3384766">unsteady_newton_solve</a>(dt_taken, max_adapt, first, shift);</div>
<div class="line"><a name="l11481"></a><span class="lineno">11481</span>&#160;      }</div>
<div class="line"><a name="l11482"></a><span class="lineno">11482</span>&#160;    }</div>
<div class="line"><a name="l11483"></a><span class="lineno">11483</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l11484"></a><span class="lineno">11484</span>&#160;    {</div>
<div class="line"><a name="l11485"></a><span class="lineno">11485</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Mesh wasn&#39;t adapted --&gt; we&#39;ll accept spatial refinement.&quot;</span></div>
<div class="line"><a name="l11486"></a><span class="lineno">11486</span>&#160;                 &lt;&lt; std::endl;</div>
<div class="line"><a name="l11487"></a><span class="lineno">11487</span>&#160;    }</div>
<div class="line"><a name="l11488"></a><span class="lineno">11488</span>&#160; </div>
<div class="line"><a name="l11489"></a><span class="lineno">11489</span>&#160;    <span class="keywordflow">return</span> new_dt;</div>
<div class="line"><a name="l11490"></a><span class="lineno">11490</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1Problem_html_ad48be6d67071f7da5f6feb7c4fc918f0"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#ad48be6d67071f7da5f6feb7c4fc918f0">oomph::Problem::set_initial_condition</a></div><div class="ttdeci">virtual void set_initial_condition()</div><div class="ttdef"><b>Definition:</b> problem.h:1198</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a0b9e09ddfa2411f14fc723c3207decd1">adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a9b7434598b8a28bf6470f481acef5d5f">adaptive_unsteady_newton_solve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">communicator_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a83df3b5fcc3ebbae951021c8e7f03ef7">Default_set_initial_condition_called</a>, <a class="el" href="../../d0/da1/classoomph_1_1Time.html#a2c684e0a69db7adde90f1f052e424a6b">oomph::Time::dt()</a>, <a class="el" href="../../d5/d34/namespaceoomph_1_1SarahBL.html#a21bfe7e71f0baa62022d1ecc9bd175de">oomph::SarahBL::epsilon</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad48be6d67071f7da5f6feb7c4fc918f0">set_initial_condition()</a>, <a class="el" href="../../d0/da1/classoomph_1_1Time.html#a6e28ea7a6664a2f5f5e1be871304a2c7">oomph::Time::time()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a46894b13c582f322082dc471a2485980">time_pt()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#adb4d5d80b18ea103f71c8013e3384766">unsteady_newton_solve()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7561d4f82e1fa625210c58a78294a301">doubly_adaptive_unsteady_newton_solve()</a>.</p>

</div>
</div>
<a id="af94771cdd9de79c17c9cf168f4a67a92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af94771cdd9de79c17c9cf168f4a67a92">&#9670;&nbsp;</a></span>dump() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Problem::dump </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>dump_file_name</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Dump refinement pattern of all refineable meshes and all generic Problem data to file for restart. </p>
<div class="fragment"><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;    {</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;      std::ofstream dump_stream(dump_file_name.c_str());</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;      <span class="keywordflow">if</span> (!dump_stream.is_open())</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;      {</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;        <a class="code" href="../../d2/dc3/namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">std::string</a> err = <span class="stringliteral">&quot;Couldn&#39;t open file &quot;</span> + dump_file_name;</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;          err, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>);</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;      }</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a1756534851a763f35fd5372b4d3723e0">dump</a>(dump_stream);</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a1756534851a763f35fd5372b4d3723e0"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a1756534851a763f35fd5372b4d3723e0">oomph::Problem::dump</a></div><div class="ttdeci">virtual void dump(std::ofstream &amp;dump_file) const</div><div class="ttdef"><b>Definition:</b> problem.cc:12029</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a1756534851a763f35fd5372b4d3723e0">dump()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, and <a class="el" href="../../d2/dc3/namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">oomph::Global_string_for_annotation::string()</a>.</p>

</div>
</div>
<a id="a1756534851a763f35fd5372b4d3723e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1756534851a763f35fd5372b4d3723e0">&#9670;&nbsp;</a></span>dump() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::dump </td>
          <td>(</td>
          <td class="paramtype">std::ofstream &amp;&#160;</td>
          <td class="paramname"><em>dump_file</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Dump refinement pattern of all refineable meshes and all generic Problem data to file for restart. </p>

<p>Reimplemented in <a class="el" href="../../d4/d94/classoomph_1_1MyProblem.html#a911d6a6c610df9739e00b5ef3bc9f8f2">oomph::MyProblem</a>, and <a class="el" href="../../dd/dfa/classAirwayReopeningProblem.html#ae86903e5bbd3f3a6fe9d540404cf26c0">AirwayReopeningProblem&lt; ELEMENT &gt;</a>.</p>
<div class="fragment"><div class="line"><a name="l12030"></a><span class="lineno">12030</span>&#160;  {</div>
<div class="line"><a name="l12031"></a><span class="lineno">12031</span>&#160;    <span class="comment">// Number of submeshes?</span></div>
<div class="line"><a name="l12032"></a><span class="lineno">12032</span>&#160;    <span class="keywordtype">unsigned</span> n_mesh = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>();</div>
<div class="line"><a name="l12033"></a><span class="lineno">12033</span>&#160; </div>
<div class="line"><a name="l12034"></a><span class="lineno">12034</span>&#160;    dump_file &lt;&lt; <a class="code" href="../../dc/d51/datatypes_8h.html#affe776513b24d84b39af8ab0930fef7f">std::max</a>(<span class="keywordtype">unsigned</span>(1), n_mesh) &lt;&lt; <span class="stringliteral">&quot; # number of (sub)meshes &quot;</span></div>
<div class="line"><a name="l12035"></a><span class="lineno">12035</span>&#160;              &lt;&lt; std::endl;</div>
<div class="line"><a name="l12036"></a><span class="lineno">12036</span>&#160; </div>
<div class="line"><a name="l12037"></a><span class="lineno">12037</span>&#160;    <span class="comment">// Single mesh:</span></div>
<div class="line"><a name="l12038"></a><span class="lineno">12038</span>&#160;    <span class="comment">//------------</span></div>
<div class="line"><a name="l12039"></a><span class="lineno">12039</span>&#160;    <span class="keywordflow">if</span> (n_mesh == 0)</div>
<div class="line"><a name="l12040"></a><span class="lineno">12040</span>&#160;    {</div>
<div class="line"><a name="l12041"></a><span class="lineno">12041</span>&#160;      <span class="comment">// Dump level of refinement before pruning</span></div>
<div class="line"><a name="l12042"></a><span class="lineno">12042</span>&#160;      <span class="keywordflow">if</span> (TreeBasedRefineableMeshBase* mmesh_pt =</div>
<div class="line"><a name="l12043"></a><span class="lineno">12043</span>&#160;            <span class="keyword">dynamic_cast&lt;</span>TreeBasedRefineableMeshBase*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(0)))</div>
<div class="line"><a name="l12044"></a><span class="lineno">12044</span>&#160;      {</div>
<div class="line"><a name="l12045"></a><span class="lineno">12045</span>&#160;        dump_file &lt;&lt; mmesh_pt-&gt;uniform_refinement_level_when_pruned()</div>
<div class="line"><a name="l12046"></a><span class="lineno">12046</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot; # uniform refinement when pruned &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l12047"></a><span class="lineno">12047</span>&#160;      }</div>
<div class="line"><a name="l12048"></a><span class="lineno">12048</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l12049"></a><span class="lineno">12049</span>&#160;      {</div>
<div class="line"><a name="l12050"></a><span class="lineno">12050</span>&#160;        dump_file &lt;&lt; 0 &lt;&lt; <span class="stringliteral">&quot; # (fake) uniform refinement when pruned &quot;</span></div>
<div class="line"><a name="l12051"></a><span class="lineno">12051</span>&#160;                  &lt;&lt; std::endl;</div>
<div class="line"><a name="l12052"></a><span class="lineno">12052</span>&#160;      }</div>
<div class="line"><a name="l12053"></a><span class="lineno">12053</span>&#160;      dump_file &lt;&lt; 9999 &lt;&lt; <span class="stringliteral">&quot; # test flag for end of sub-meshes &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l12054"></a><span class="lineno">12054</span>&#160;    }</div>
<div class="line"><a name="l12055"></a><span class="lineno">12055</span>&#160; </div>
<div class="line"><a name="l12056"></a><span class="lineno">12056</span>&#160;    <span class="comment">// Multiple submeshes</span></div>
<div class="line"><a name="l12057"></a><span class="lineno">12057</span>&#160;    <span class="comment">//------------------</span></div>
<div class="line"><a name="l12058"></a><span class="lineno">12058</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l12059"></a><span class="lineno">12059</span>&#160;    {</div>
<div class="line"><a name="l12060"></a><span class="lineno">12060</span>&#160;      <span class="comment">// Loop over submeshes to dump level of refinement before pruning</span></div>
<div class="line"><a name="l12061"></a><span class="lineno">12061</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> imesh = 0; imesh &lt; n_mesh; imesh++)</div>
<div class="line"><a name="l12062"></a><span class="lineno">12062</span>&#160;      {</div>
<div class="line"><a name="l12063"></a><span class="lineno">12063</span>&#160;        <span class="keywordflow">if</span> (TreeBasedRefineableMeshBase* mmesh_pt =</div>
<div class="line"><a name="l12064"></a><span class="lineno">12064</span>&#160;              <span class="keyword">dynamic_cast&lt;</span>TreeBasedRefineableMeshBase*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(imesh)))</div>
<div class="line"><a name="l12065"></a><span class="lineno">12065</span>&#160;        {</div>
<div class="line"><a name="l12066"></a><span class="lineno">12066</span>&#160;          dump_file &lt;&lt; mmesh_pt-&gt;uniform_refinement_level_when_pruned()</div>
<div class="line"><a name="l12067"></a><span class="lineno">12067</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot; # uniform refinement when pruned &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l12068"></a><span class="lineno">12068</span>&#160;        }</div>
<div class="line"><a name="l12069"></a><span class="lineno">12069</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l12070"></a><span class="lineno">12070</span>&#160;        {</div>
<div class="line"><a name="l12071"></a><span class="lineno">12071</span>&#160;          dump_file &lt;&lt; 0 &lt;&lt; <span class="stringliteral">&quot; # (fake) uniform refinement when pruned &quot;</span></div>
<div class="line"><a name="l12072"></a><span class="lineno">12072</span>&#160;                    &lt;&lt; std::endl;</div>
<div class="line"><a name="l12073"></a><span class="lineno">12073</span>&#160;        }</div>
<div class="line"><a name="l12074"></a><span class="lineno">12074</span>&#160;      }</div>
<div class="line"><a name="l12075"></a><span class="lineno">12075</span>&#160;      dump_file &lt;&lt; 9999 &lt;&lt; <span class="stringliteral">&quot; # test flag for end of sub-meshes &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l12076"></a><span class="lineno">12076</span>&#160;    }</div>
<div class="line"><a name="l12077"></a><span class="lineno">12077</span>&#160; </div>
<div class="line"><a name="l12078"></a><span class="lineno">12078</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l12079"></a><span class="lineno">12079</span>&#160; </div>
<div class="line"><a name="l12080"></a><span class="lineno">12080</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> my_rank = this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">communicator_pt</a>()-&gt;<a class="code" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a670b34aab05bfe0b96d0e0fabf583c7a">my_rank</a>();</div>
<div class="line"><a name="l12081"></a><span class="lineno">12081</span>&#160; </div>
<div class="line"><a name="l12082"></a><span class="lineno">12082</span>&#160;    <span class="comment">// Record destination of all base elements</span></div>
<div class="line"><a name="l12083"></a><span class="lineno">12083</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = Base_mesh_element_pt.size();</div>
<div class="line"><a name="l12084"></a><span class="lineno">12084</span>&#160;    Vector&lt;int&gt; local_base_element_processor(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>, -1);</div>
<div class="line"><a name="l12085"></a><span class="lineno">12085</span>&#160;    Vector&lt;int&gt; base_element_processor(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>, -1);</div>
<div class="line"><a name="l12086"></a><span class="lineno">12086</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l12087"></a><span class="lineno">12087</span>&#160;    {</div>
<div class="line"><a name="l12088"></a><span class="lineno">12088</span>&#160;      GeneralisedElement* el_pt = Base_mesh_element_pt[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>];</div>
<div class="line"><a name="l12089"></a><span class="lineno">12089</span>&#160;      <span class="keywordflow">if</span> (el_pt != 0)</div>
<div class="line"><a name="l12090"></a><span class="lineno">12090</span>&#160;      {</div>
<div class="line"><a name="l12091"></a><span class="lineno">12091</span>&#160;        <span class="keywordflow">if</span> (!el_pt-&gt;is_halo())</div>
<div class="line"><a name="l12092"></a><span class="lineno">12092</span>&#160;        {</div>
<div class="line"><a name="l12093"></a><span class="lineno">12093</span>&#160;          local_base_element_processor[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>] = my_rank;</div>
<div class="line"><a name="l12094"></a><span class="lineno">12094</span>&#160;        }</div>
<div class="line"><a name="l12095"></a><span class="lineno">12095</span>&#160;      }</div>
<div class="line"><a name="l12096"></a><span class="lineno">12096</span>&#160;    }</div>
<div class="line"><a name="l12097"></a><span class="lineno">12097</span>&#160; </div>
<div class="line"><a name="l12098"></a><span class="lineno">12098</span>&#160; </div>
<div class="line"><a name="l12099"></a><span class="lineno">12099</span>&#160;    <span class="comment">// Get target for all base elements by reduction</span></div>
<div class="line"><a name="l12100"></a><span class="lineno">12100</span>&#160;    <span class="keywordflow">if</span> (Problem_has_been_distributed)</div>
<div class="line"><a name="l12101"></a><span class="lineno">12101</span>&#160;    {</div>
<div class="line"><a name="l12102"></a><span class="lineno">12102</span>&#160;      <span class="comment">// Check that the base elements have been associated to a processor</span></div>
<div class="line"><a name="l12103"></a><span class="lineno">12103</span>&#160;      <span class="comment">// (the Base_mesh_elemen_pt is only used for structured meshes,</span></div>
<div class="line"><a name="l12104"></a><span class="lineno">12104</span>&#160;      <span class="comment">// therefore, if there are no ustructured meshes as part of the</span></div>
<div class="line"><a name="l12105"></a><span class="lineno">12105</span>&#160;      <span class="comment">// problem this container will be empty)</span></div>
<div class="line"><a name="l12106"></a><span class="lineno">12106</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &gt; 0)</div>
<div class="line"><a name="l12107"></a><span class="lineno">12107</span>&#160;      {</div>
<div class="line"><a name="l12108"></a><span class="lineno">12108</span>&#160;        MPI_Allreduce(&amp;local_base_element_processor[0],</div>
<div class="line"><a name="l12109"></a><span class="lineno">12109</span>&#160;                      &amp;base_element_processor[0],</div>
<div class="line"><a name="l12110"></a><span class="lineno">12110</span>&#160;                      <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>,</div>
<div class="line"><a name="l12111"></a><span class="lineno">12111</span>&#160;                      MPI_INT,</div>
<div class="line"><a name="l12112"></a><span class="lineno">12112</span>&#160;                      MPI_MAX,</div>
<div class="line"><a name="l12113"></a><span class="lineno">12113</span>&#160;                      this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">communicator_pt</a>()-&gt;mpi_comm());</div>
<div class="line"><a name="l12114"></a><span class="lineno">12114</span>&#160;      }</div>
<div class="line"><a name="l12115"></a><span class="lineno">12115</span>&#160;    }</div>
<div class="line"><a name="l12116"></a><span class="lineno">12116</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l12117"></a><span class="lineno">12117</span>&#160;    {</div>
<div class="line"><a name="l12118"></a><span class="lineno">12118</span>&#160;      <span class="comment">// All the same...</span></div>
<div class="line"><a name="l12119"></a><span class="lineno">12119</span>&#160;      base_element_processor = local_base_element_processor;</div>
<div class="line"><a name="l12120"></a><span class="lineno">12120</span>&#160;    }</div>
<div class="line"><a name="l12121"></a><span class="lineno">12121</span>&#160; </div>
<div class="line"><a name="l12122"></a><span class="lineno">12122</span>&#160; </div>
<div class="line"><a name="l12123"></a><span class="lineno">12123</span>&#160;    dump_file &lt;&lt; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt;&lt; <span class="stringliteral">&quot; # Number of base elements; partitioning follows.\n&quot;</span>;</div>
<div class="line"><a name="l12124"></a><span class="lineno">12124</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l12125"></a><span class="lineno">12125</span>&#160;    {</div>
<div class="line"><a name="l12126"></a><span class="lineno">12126</span>&#160;      dump_file &lt;&lt; base_element_processor[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l12127"></a><span class="lineno">12127</span>&#160;    }</div>
<div class="line"><a name="l12128"></a><span class="lineno">12128</span>&#160;    dump_file &lt;&lt; <span class="stringliteral">&quot;8888 #test flag for end of base element distribution\n&quot;</span>;</div>
<div class="line"><a name="l12129"></a><span class="lineno">12129</span>&#160; </div>
<div class="line"><a name="l12130"></a><span class="lineno">12130</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l12131"></a><span class="lineno">12131</span>&#160; </div>
<div class="line"><a name="l12132"></a><span class="lineno">12132</span>&#160;    <span class="comment">// Single mesh:</span></div>
<div class="line"><a name="l12133"></a><span class="lineno">12133</span>&#160;    <span class="comment">//------------</span></div>
<div class="line"><a name="l12134"></a><span class="lineno">12134</span>&#160;    <span class="keywordflow">if</span> (n_mesh == 0)</div>
<div class="line"><a name="l12135"></a><span class="lineno">12135</span>&#160;    {</div>
<div class="line"><a name="l12136"></a><span class="lineno">12136</span>&#160;      <span class="comment">// Dump single mesh refinement pattern (if mesh is refineable)</span></div>
<div class="line"><a name="l12137"></a><span class="lineno">12137</span>&#160;      <span class="keywordflow">if</span> (TreeBasedRefineableMeshBase* mmesh_pt =</div>
<div class="line"><a name="l12138"></a><span class="lineno">12138</span>&#160;            <span class="keyword">dynamic_cast&lt;</span>TreeBasedRefineableMeshBase*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(0)))</div>
<div class="line"><a name="l12139"></a><span class="lineno">12139</span>&#160;      {</div>
<div class="line"><a name="l12140"></a><span class="lineno">12140</span>&#160;        mmesh_pt-&gt;dump_refinement(dump_file);</div>
<div class="line"><a name="l12141"></a><span class="lineno">12141</span>&#160;      }</div>
<div class="line"><a name="l12142"></a><span class="lineno">12142</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_TRIANGLE_LIB</span></div>
<div class="line"><a name="l12143"></a><span class="lineno">12143</span>&#160;      <span class="comment">// Dump triangle mesh TriangulateIO which represents mesh topology</span></div>
<div class="line"><a name="l12144"></a><span class="lineno">12144</span>&#160;      TriangleMeshBase* mmesh_pt = <span class="keyword">dynamic_cast&lt;</span>TriangleMeshBase*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(0));</div>
<div class="line"><a name="l12145"></a><span class="lineno">12145</span>&#160;      <span class="keywordflow">if</span> (mmesh_pt != 0 &amp;&amp; mmesh_pt-&gt;use_triangulateio_restart())</div>
<div class="line"><a name="l12146"></a><span class="lineno">12146</span>&#160;      {</div>
<div class="line"><a name="l12147"></a><span class="lineno">12147</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l12148"></a><span class="lineno">12148</span>&#160;        <span class="comment">// Check if the mesh is distributed, if that is the case then</span></div>
<div class="line"><a name="l12149"></a><span class="lineno">12149</span>&#160;        <span class="comment">// additional info. needs to be saved</span></div>
<div class="line"><a name="l12150"></a><span class="lineno">12150</span>&#160;        <span class="keywordflow">if</span> (mmesh_pt-&gt;is_mesh_distributed())</div>
<div class="line"><a name="l12151"></a><span class="lineno">12151</span>&#160;        {</div>
<div class="line"><a name="l12152"></a><span class="lineno">12152</span>&#160;          <span class="comment">// Dump the info. related with the distribution of the mesh</span></div>
<div class="line"><a name="l12153"></a><span class="lineno">12153</span>&#160;          mmesh_pt-&gt;dump_distributed_info_for_restart(dump_file);</div>
<div class="line"><a name="l12154"></a><span class="lineno">12154</span>&#160;        }</div>
<div class="line"><a name="l12155"></a><span class="lineno">12155</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l12156"></a><span class="lineno">12156</span>&#160;        mmesh_pt-&gt;dump_triangulateio(dump_file);</div>
<div class="line"><a name="l12157"></a><span class="lineno">12157</span>&#160;      }</div>
<div class="line"><a name="l12158"></a><span class="lineno">12158</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l12159"></a><span class="lineno">12159</span>&#160;    }</div>
<div class="line"><a name="l12160"></a><span class="lineno">12160</span>&#160; </div>
<div class="line"><a name="l12161"></a><span class="lineno">12161</span>&#160;    <span class="comment">// Multiple submeshes</span></div>
<div class="line"><a name="l12162"></a><span class="lineno">12162</span>&#160;    <span class="comment">//------------------</span></div>
<div class="line"><a name="l12163"></a><span class="lineno">12163</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l12164"></a><span class="lineno">12164</span>&#160;    {</div>
<div class="line"><a name="l12165"></a><span class="lineno">12165</span>&#160;      <span class="comment">// Loop over submeshes</span></div>
<div class="line"><a name="l12166"></a><span class="lineno">12166</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> imesh = 0; imesh &lt; n_mesh; imesh++)</div>
<div class="line"><a name="l12167"></a><span class="lineno">12167</span>&#160;      {</div>
<div class="line"><a name="l12168"></a><span class="lineno">12168</span>&#160;        <span class="comment">// Dump single mesh refinement pattern (if mesh is refineable)</span></div>
<div class="line"><a name="l12169"></a><span class="lineno">12169</span>&#160;        <span class="keywordflow">if</span> (TreeBasedRefineableMeshBase* mmesh_pt =</div>
<div class="line"><a name="l12170"></a><span class="lineno">12170</span>&#160;              <span class="keyword">dynamic_cast&lt;</span>TreeBasedRefineableMeshBase*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(imesh)))</div>
<div class="line"><a name="l12171"></a><span class="lineno">12171</span>&#160;        {</div>
<div class="line"><a name="l12172"></a><span class="lineno">12172</span>&#160;          mmesh_pt-&gt;dump_refinement(dump_file);</div>
<div class="line"><a name="l12173"></a><span class="lineno">12173</span>&#160;        }</div>
<div class="line"><a name="l12174"></a><span class="lineno">12174</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_TRIANGLE_LIB</span></div>
<div class="line"><a name="l12175"></a><span class="lineno">12175</span>&#160;        <span class="comment">// Dump triangle mesh TriangulateIO which represents mesh topology</span></div>
<div class="line"><a name="l12176"></a><span class="lineno">12176</span>&#160;        TriangleMeshBase* mmesh_pt =</div>
<div class="line"><a name="l12177"></a><span class="lineno">12177</span>&#160;          <span class="keyword">dynamic_cast&lt;</span>TriangleMeshBase*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(imesh));</div>
<div class="line"><a name="l12178"></a><span class="lineno">12178</span>&#160;        <span class="keywordflow">if</span> (mmesh_pt != 0 &amp;&amp; mmesh_pt-&gt;use_triangulateio_restart())</div>
<div class="line"><a name="l12179"></a><span class="lineno">12179</span>&#160;        {</div>
<div class="line"><a name="l12180"></a><span class="lineno">12180</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l12181"></a><span class="lineno">12181</span>&#160;          <span class="comment">// Check if the mesh is distributed, if that is the case then</span></div>
<div class="line"><a name="l12182"></a><span class="lineno">12182</span>&#160;          <span class="comment">// additional info. needs to be saved</span></div>
<div class="line"><a name="l12183"></a><span class="lineno">12183</span>&#160;          <span class="keywordflow">if</span> (mmesh_pt-&gt;is_mesh_distributed())</div>
<div class="line"><a name="l12184"></a><span class="lineno">12184</span>&#160;          {</div>
<div class="line"><a name="l12185"></a><span class="lineno">12185</span>&#160;            <span class="comment">// Dump the info. related with the distribution of the mesh</span></div>
<div class="line"><a name="l12186"></a><span class="lineno">12186</span>&#160;            mmesh_pt-&gt;dump_distributed_info_for_restart(dump_file);</div>
<div class="line"><a name="l12187"></a><span class="lineno">12187</span>&#160;          }</div>
<div class="line"><a name="l12188"></a><span class="lineno">12188</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l12189"></a><span class="lineno">12189</span>&#160;          mmesh_pt-&gt;dump_triangulateio(dump_file);</div>
<div class="line"><a name="l12190"></a><span class="lineno">12190</span>&#160;        }</div>
<div class="line"><a name="l12191"></a><span class="lineno">12191</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l12192"></a><span class="lineno">12192</span>&#160;      } <span class="comment">// End of loop over submeshes</span></div>
<div class="line"><a name="l12193"></a><span class="lineno">12193</span>&#160;    }</div>
<div class="line"><a name="l12194"></a><span class="lineno">12194</span>&#160; </div>
<div class="line"><a name="l12195"></a><span class="lineno">12195</span>&#160; </div>
<div class="line"><a name="l12196"></a><span class="lineno">12196</span>&#160;    <span class="comment">// Dump time</span></div>
<div class="line"><a name="l12197"></a><span class="lineno">12197</span>&#160;    <span class="comment">// ---------</span></div>
<div class="line"><a name="l12198"></a><span class="lineno">12198</span>&#160; </div>
<div class="line"><a name="l12199"></a><span class="lineno">12199</span>&#160;    <span class="comment">// Flag to indicate unsteady run</span></div>
<div class="line"><a name="l12200"></a><span class="lineno">12200</span>&#160;    <span class="keywordtype">bool</span> unsteady_flag = (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a46894b13c582f322082dc471a2485980">time_pt</a>() != 0);</div>
<div class="line"><a name="l12201"></a><span class="lineno">12201</span>&#160;    dump_file &lt;&lt; unsteady_flag &lt;&lt; <span class="stringliteral">&quot; # bool flag for unsteady&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l12202"></a><span class="lineno">12202</span>&#160; </div>
<div class="line"><a name="l12203"></a><span class="lineno">12203</span>&#160;    <span class="comment">// Current time and previous time increments for proper unsteady run</span></div>
<div class="line"><a name="l12204"></a><span class="lineno">12204</span>&#160;    <span class="keywordflow">if</span> (unsteady_flag)</div>
<div class="line"><a name="l12205"></a><span class="lineno">12205</span>&#160;    {</div>
<div class="line"><a name="l12206"></a><span class="lineno">12206</span>&#160;      <span class="comment">// Current time</span></div>
<div class="line"><a name="l12207"></a><span class="lineno">12207</span>&#160;      dump_file &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a46894b13c582f322082dc471a2485980">time_pt</a>()-&gt;<a class="code" href="../../d0/da1/classoomph_1_1Time.html#a6e28ea7a6664a2f5f5e1be871304a2c7">time</a>() &lt;&lt; <span class="stringliteral">&quot; # Time &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l12208"></a><span class="lineno">12208</span>&#160;      <span class="comment">// Timesteps</span></div>
<div class="line"><a name="l12209"></a><span class="lineno">12209</span>&#160;      <span class="keywordtype">unsigned</span> n_dt = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a46894b13c582f322082dc471a2485980">time_pt</a>()-&gt;<a class="code" href="../../d0/da1/classoomph_1_1Time.html#ad40953c471eb3ce59921e6870ed755f3">ndt</a>();</div>
<div class="line"><a name="l12210"></a><span class="lineno">12210</span>&#160;      dump_file &lt;&lt; n_dt &lt;&lt; <span class="stringliteral">&quot; # Number of timesteps &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l12211"></a><span class="lineno">12211</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_dt; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l12212"></a><span class="lineno">12212</span>&#160;      {</div>
<div class="line"><a name="l12213"></a><span class="lineno">12213</span>&#160;        dump_file &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a46894b13c582f322082dc471a2485980">time_pt</a>()-&gt;<a class="code" href="../../d0/da1/classoomph_1_1Time.html#a2c684e0a69db7adde90f1f052e424a6b">dt</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) &lt;&lt; <span class="stringliteral">&quot; # dt &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l12214"></a><span class="lineno">12214</span>&#160;      }</div>
<div class="line"><a name="l12215"></a><span class="lineno">12215</span>&#160;    }</div>
<div class="line"><a name="l12216"></a><span class="lineno">12216</span>&#160;    <span class="comment">// Dummy time and previous time increments for steady run</span></div>
<div class="line"><a name="l12217"></a><span class="lineno">12217</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l12218"></a><span class="lineno">12218</span>&#160;    {</div>
<div class="line"><a name="l12219"></a><span class="lineno">12219</span>&#160;      <span class="comment">// Current time</span></div>
<div class="line"><a name="l12220"></a><span class="lineno">12220</span>&#160;      dump_file &lt;&lt; <span class="stringliteral">&quot;0.0 # Dummy time from steady run &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l12221"></a><span class="lineno">12221</span>&#160;      <span class="comment">// Timesteps</span></div>
<div class="line"><a name="l12222"></a><span class="lineno">12222</span>&#160;      dump_file &lt;&lt; <span class="stringliteral">&quot;0 # Dummy number of timesteps from steady run&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l12223"></a><span class="lineno">12223</span>&#160;    }</div>
<div class="line"><a name="l12224"></a><span class="lineno">12224</span>&#160; </div>
<div class="line"><a name="l12225"></a><span class="lineno">12225</span>&#160;    <span class="comment">// Loop over submeshes and dump their data</span></div>
<div class="line"><a name="l12226"></a><span class="lineno">12226</span>&#160;    <span class="keywordtype">unsigned</span> nmesh = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>();</div>
<div class="line"><a name="l12227"></a><span class="lineno">12227</span>&#160;    <span class="keywordflow">if</span> (nmesh == 0) nmesh = 1;</div>
<div class="line"><a name="l12228"></a><span class="lineno">12228</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> = 0; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> &lt; nmesh; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>++)</div>
<div class="line"><a name="l12229"></a><span class="lineno">12229</span>&#160;    {</div>
<div class="line"><a name="l12230"></a><span class="lineno">12230</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>)-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#af821b936768868ea5dd91495e9ae3bc0">dump</a>(dump_file);</div>
<div class="line"><a name="l12231"></a><span class="lineno">12231</span>&#160;    }</div>
<div class="line"><a name="l12232"></a><span class="lineno">12232</span>&#160; </div>
<div class="line"><a name="l12233"></a><span class="lineno">12233</span>&#160;    <span class="comment">// Dump global data</span></div>
<div class="line"><a name="l12234"></a><span class="lineno">12234</span>&#160; </div>
<div class="line"><a name="l12235"></a><span class="lineno">12235</span>&#160;    <span class="comment">// Loop over global data</span></div>
<div class="line"><a name="l12236"></a><span class="lineno">12236</span>&#160;    <span class="keywordtype">unsigned</span> Nglobal = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>.size();</div>
<div class="line"><a name="l12237"></a><span class="lineno">12237</span>&#160;    dump_file &lt;&lt; Nglobal &lt;&lt; <span class="stringliteral">&quot; # number of global Data items &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l12238"></a><span class="lineno">12238</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> iglobal = 0; iglobal &lt; Nglobal; iglobal++)</div>
<div class="line"><a name="l12239"></a><span class="lineno">12239</span>&#160;    {</div>
<div class="line"><a name="l12240"></a><span class="lineno">12240</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>[iglobal]-&gt;dump(dump_file);</div>
<div class="line"><a name="l12241"></a><span class="lineno">12241</span>&#160;      dump_file &lt;&lt; std::endl;</div>
<div class="line"><a name="l12242"></a><span class="lineno">12242</span>&#160;    }</div>
<div class="line"><a name="l12243"></a><span class="lineno">12243</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_af821b936768868ea5dd91495e9ae3bc0"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#af821b936768868ea5dd91495e9ae3bc0">oomph::Mesh::dump</a></div><div class="ttdeci">virtual void dump(std::ofstream &amp;dump_file, const bool &amp;use_old_ordering=true) const</div><div class="ttdoc">Dump the data in the mesh into a file for restart.</div><div class="ttdef"><b>Definition:</b> mesh.cc:1088</div></div>
<div class="ttc" id="aclassoomph_1_1OomphCommunicator_html_a670b34aab05bfe0b96d0e0fabf583c7a"><div class="ttname"><a href="../../de/d83/classoomph_1_1OomphCommunicator.html#a670b34aab05bfe0b96d0e0fabf583c7a">oomph::OomphCommunicator::my_rank</a></div><div class="ttdeci">int my_rank() const</div><div class="ttdoc">my rank</div><div class="ttdef"><b>Definition:</b> communicator.h:176</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">communicator_pt()</a>, <a class="el" href="../../d0/da1/classoomph_1_1Time.html#a2c684e0a69db7adde90f1f052e424a6b">oomph::Time::dt()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af821b936768868ea5dd91495e9ae3bc0">oomph::Mesh::dump()</a>, <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a1ab35b022b95f2d28c53aa58859bd6b5">oomph::Mesh::is_mesh_distributed()</a>, <a class="el" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>, <a class="el" href="../../dc/d51/datatypes_8h.html#affe776513b24d84b39af8ab0930fef7f">max</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt()</a>, <a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a670b34aab05bfe0b96d0e0fabf583c7a">oomph::OomphCommunicator::my_rank()</a>, <a class="el" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>, <a class="el" href="../../d0/da1/classoomph_1_1Time.html#ad40953c471eb3ce59921e6870ed755f3">oomph::Time::ndt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh()</a>, <a class="el" href="../../d0/da1/classoomph_1_1Time.html#a6e28ea7a6664a2f5f5e1be871304a2c7">oomph::Time::time()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a46894b13c582f322082dc471a2485980">time_pt()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af94771cdd9de79c17c9cf168f4a67a92">dump()</a>, and <a class="el" href="../../d4/d94/classoomph_1_1MyProblem.html#a911d6a6c610df9739e00b5ef3bc9f8f2">oomph::MyProblem::dump()</a>.</p>

</div>
</div>
<a id="a00efa0059958df35858503e77111c362"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00efa0059958df35858503e77111c362">&#9670;&nbsp;</a></span>eigen_solver_pt() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../de/dba/classoomph_1_1EigenSolver.html">EigenSolver</a>*&amp; oomph::Problem::eigen_solver_pt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return a pointer to the eigen solver object. </p>
<div class="fragment"><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;    {</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab7938313fa45df9be16515a6b0bfd324">Eigen_solver_pt</a>;</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab7938313fa45df9be16515a6b0bfd324">Eigen_solver_pt</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d83/classFlowAroundCylinderProblem.html#a03cfbffae1e834d5b95097f9ea408f40">FlowAroundCylinderProblem&lt; ELEMENT &gt;::FlowAroundCylinderProblem()</a>, and <a class="el" href="../../dc/db9/classOrrSommerfeldProblem.html#aaa5b04805113cefc7a352483c53e149e">OrrSommerfeldProblem&lt; ELEMENT &gt;::OrrSommerfeldProblem()</a>.</p>

</div>
</div>
<a id="a14d44adcbf581d43154be19d127b6183"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14d44adcbf581d43154be19d127b6183">&#9670;&nbsp;</a></span>eigen_solver_pt() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../de/dba/classoomph_1_1EigenSolver.html">EigenSolver</a>* const&amp; oomph::Problem::eigen_solver_pt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return a pointer to the eigen solver object (const version) </p>
<div class="fragment"><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;    {</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab7938313fa45df9be16515a6b0bfd324">Eigen_solver_pt</a>;</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab7938313fa45df9be16515a6b0bfd324">Eigen_solver_pt</a>.</p>

</div>
</div>
<a id="af4fbd755b3ce6b86fa0f1b1f29bd08f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4fbd755b3ce6b86fa0f1b1f29bd08f0">&#9670;&nbsp;</a></span>enable_discontinuous_formulation()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Problem::enable_discontinuous_formulation </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Indicate that the problem involves discontinuous elements This allows for a more efficiently assembly and inversion of the mass matrix </p>
<div class="fragment"><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;    {</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a97ca0078fff6adca318835c11503dc2d">Discontinuous_element_formulation</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a97ca0078fff6adca318835c11503dc2d">Discontinuous_element_formulation</a>.</p>

</div>
</div>
<a id="ac7c7711978f7c02becb4005414f945be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7c7711978f7c02becb4005414f945be">&#9670;&nbsp;</a></span>enable_globally_convergent_newton_method()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Problem::enable_globally_convergent_newton_method </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>enable globally convergent Newton method </p>
<div class="fragment"><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;    {</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#acf8b1ec937efdf2a0f892a41c18c0c53">Use_globally_convergent_newton_method</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acf8b1ec937efdf2a0f892a41c18c0c53">Use_globally_convergent_newton_method</a>.</p>

</div>
</div>
<a id="a3226bf49118c8a4f02dbe01d22428f20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3226bf49118c8a4f02dbe01d22428f20">&#9670;&nbsp;</a></span>enable_info_in_newton_solve()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Problem::enable_info_in_newton_solve </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Enable the output of information when in the newton solver (Default) </p>
<div class="fragment"><div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;    {</div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab4a3743c23a2d1eed56981484636c958">Shut_up_in_newton_solve</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab4a3743c23a2d1eed56981484636c958">Shut_up_in_newton_solve</a>.</p>

</div>
</div>
<a id="a8eb2fedc3f64411cfbe1627a516447f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8eb2fedc3f64411cfbe1627a516447f9">&#9670;&nbsp;</a></span>enable_jacobian_reuse()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Problem::enable_jacobian_reuse </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Enable recycling of Jacobian in Newton iteration (if the linear solver allows it). Useful for linear problems with constant Jacobians or nonlinear problems where you're willing to risk the trade-off between faster solve times and degraded Newton convergence rate </p>
<div class="fragment"><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;    {</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a022796f2c96f2dff6ed1db2338c93aaf">Jacobian_reuse_is_enabled</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a2c4702c75739c967ed582dbd0a7ba56f">Jacobian_has_been_computed</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a2c4702c75739c967ed582dbd0a7ba56f">Jacobian_has_been_computed</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a022796f2c96f2dff6ed1db2338c93aaf">Jacobian_reuse_is_enabled</a>.</p>

</div>
</div>
<a id="add951d12e349d0c220c3dd808962f4ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add951d12e349d0c220c3dd808962f4ae">&#9670;&nbsp;</a></span>enable_mass_matrix_reuse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::enable_mass_matrix_reuse </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Enable recycling of the mass matrix in explicit timestepping schemes. Useful for timestepping on fixed meshes when you want to avoid the linear solve phase. </p>
<div class="fragment"><div class="line"><a name="l11808"></a><span class="lineno">11808</span>&#160;  {</div>
<div class="line"><a name="l11809"></a><span class="lineno">11809</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#af4d25809ac090102a4d4a398e4ad0e26">Mass_matrix_reuse_is_enabled</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l11810"></a><span class="lineno">11810</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a6067c6d344363a073fb8d02a99fb7ed0">Mass_matrix_has_been_computed</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l11811"></a><span class="lineno">11811</span>&#160; </div>
<div class="line"><a name="l11812"></a><span class="lineno">11812</span>&#160;    <span class="comment">// If we have a discontinuous formulation set the elements to reuse</span></div>
<div class="line"><a name="l11813"></a><span class="lineno">11813</span>&#160;    <span class="comment">// their own mass matrices</span></div>
<div class="line"><a name="l11814"></a><span class="lineno">11814</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a97ca0078fff6adca318835c11503dc2d">Discontinuous_element_formulation</a>)</div>
<div class="line"><a name="l11815"></a><span class="lineno">11815</span>&#160;    {</div>
<div class="line"><a name="l11816"></a><span class="lineno">11816</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_element = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">Problem::mesh_pt</a>()-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">nelement</a>();</div>
<div class="line"><a name="l11817"></a><span class="lineno">11817</span>&#160;      <span class="comment">// Loop over the other elements</span></div>
<div class="line"><a name="l11818"></a><span class="lineno">11818</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; n_element; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l11819"></a><span class="lineno">11819</span>&#160;      {</div>
<div class="line"><a name="l11820"></a><span class="lineno">11820</span>&#160;        <span class="comment">// Cache the element</span></div>
<div class="line"><a name="l11821"></a><span class="lineno">11821</span>&#160;        DGElement* <span class="keyword">const</span> elem_pt =</div>
<div class="line"><a name="l11822"></a><span class="lineno">11822</span>&#160;          <span class="keyword">dynamic_cast&lt;</span>DGElement*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">Problem::mesh_pt</a>()-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">element_pt</a>(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>));</div>
<div class="line"><a name="l11823"></a><span class="lineno">11823</span>&#160;        elem_pt-&gt;enable_mass_matrix_reuse();</div>
<div class="line"><a name="l11824"></a><span class="lineno">11824</span>&#160;      }</div>
<div class="line"><a name="l11825"></a><span class="lineno">11825</span>&#160;    }</div>
<div class="line"><a name="l11826"></a><span class="lineno">11826</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a97ca0078fff6adca318835c11503dc2d">Discontinuous_element_formulation</a>, <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">oomph::Mesh::element_pt()</a>, <a class="el" href="../../db/d5d/classoomph_1_1DGElement.html#a62c5daa21324a839419ec4feec8e0685">oomph::DGElement::enable_mass_matrix_reuse()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6067c6d344363a073fb8d02a99fb7ed0">Mass_matrix_has_been_computed</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af4d25809ac090102a4d4a398e4ad0e26">Mass_matrix_reuse_is_enabled</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt()</a>, and <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">oomph::Mesh::nelement()</a>.</p>

</div>
</div>
<a id="a31ba79405993ec52e3017d6ff3a42c8c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31ba79405993ec52e3017d6ff3a42c8c">&#9670;&nbsp;</a></span>enable_store_local_dof_pt_in_elements()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Problem::enable_store_local_dof_pt_in_elements </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Insist that local dof pointers are set up in each element when equation numbering takes place </p>
<div class="fragment"><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;    {</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a075696d6f4c4260ce860997c8c931de4">Store_local_dof_pt_in_elements</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a075696d6f4c4260ce860997c8c931de4">Store_local_dof_pt_in_elements</a>.</p>

</div>
</div>
<a id="ac332634783a803c1c21bf5c520af280f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac332634783a803c1c21bf5c520af280f">&#9670;&nbsp;</a></span>explicit_time_stepper_pt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/d0b/classoomph_1_1ExplicitTimeStepper.html">ExplicitTimeStepper</a>*&amp; oomph::Problem::explicit_time_stepper_pt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return a pointer to the explicit timestepper. </p>
<div class="fragment"><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;    {</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#af8466091ea4f5b57033bb3ad24831167">Explicit_time_stepper_pt</a>;</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af8466091ea4f5b57033bb3ad24831167">Explicit_time_stepper_pt</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acbc0b0fc5d5cc76ce8384bc0bd815f26">calculate_predictions()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a2eff0725bba4f2435bcc4797a9e59ab4">explicit_timestep()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7e79846a57705934352b55b6d675d77d">set_explicit_time_stepper_pt()</a>.</p>

</div>
</div>
<a id="a2eff0725bba4f2435bcc4797a9e59ab4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2eff0725bba4f2435bcc4797a9e59ab4">&#9670;&nbsp;</a></span>explicit_timestep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::explicit_timestep </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;&#160;</td>
          <td class="paramname"><em>shift_values</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Take an explicit timestep of size dt. </p>
<p>Take an explicit timestep of size dt and optionally shift any stored values of the time history </p>
<div class="fragment"><div class="line"><a name="l10919"></a><span class="lineno">10919</span>&#160;  {</div>
<div class="line"><a name="l10920"></a><span class="lineno">10920</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l10921"></a><span class="lineno">10921</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ac332634783a803c1c21bf5c520af280f">explicit_time_stepper_pt</a>() == 0)</div>
<div class="line"><a name="l10922"></a><span class="lineno">10922</span>&#160;    {</div>
<div class="line"><a name="l10923"></a><span class="lineno">10923</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(<span class="stringliteral">&quot;Explicit time stepper pointer is null in problem.&quot;</span>,</div>
<div class="line"><a name="l10924"></a><span class="lineno">10924</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>,</div>
<div class="line"><a name="l10925"></a><span class="lineno">10925</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>);</div>
<div class="line"><a name="l10926"></a><span class="lineno">10926</span>&#160;    }</div>
<div class="line"><a name="l10927"></a><span class="lineno">10927</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l10928"></a><span class="lineno">10928</span>&#160; </div>
<div class="line"><a name="l10929"></a><span class="lineno">10929</span>&#160;    <span class="comment">// Firstly we shift the time values</span></div>
<div class="line"><a name="l10930"></a><span class="lineno">10930</span>&#160;    <span class="keywordflow">if</span> (shift_values)</div>
<div class="line"><a name="l10931"></a><span class="lineno">10931</span>&#160;    {</div>
<div class="line"><a name="l10932"></a><span class="lineno">10932</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a3d3108a38cfbed4087f5b8eb601f38a2">shift_time_values</a>();</div>
<div class="line"><a name="l10933"></a><span class="lineno">10933</span>&#160;    }</div>
<div class="line"><a name="l10934"></a><span class="lineno">10934</span>&#160;    <span class="comment">// Set the current value of dt, if we can</span></div>
<div class="line"><a name="l10935"></a><span class="lineno">10935</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a46894b13c582f322082dc471a2485980">time_pt</a>()-&gt;ndt() &gt; 0)</div>
<div class="line"><a name="l10936"></a><span class="lineno">10936</span>&#160;    {</div>
<div class="line"><a name="l10937"></a><span class="lineno">10937</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a46894b13c582f322082dc471a2485980">time_pt</a>()-&gt;<a class="code" href="../../d0/da1/classoomph_1_1Time.html#a2c684e0a69db7adde90f1f052e424a6b">dt</a>() = dt;</div>
<div class="line"><a name="l10938"></a><span class="lineno">10938</span>&#160;    }</div>
<div class="line"><a name="l10939"></a><span class="lineno">10939</span>&#160; </div>
<div class="line"><a name="l10940"></a><span class="lineno">10940</span>&#160;    <span class="comment">// Take the explicit step</span></div>
<div class="line"><a name="l10941"></a><span class="lineno">10941</span>&#160;    this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ac332634783a803c1c21bf5c520af280f">explicit_time_stepper_pt</a>()-&gt;<a class="code" href="../../df/d0b/classoomph_1_1ExplicitTimeStepper.html#ab43bbab17960d0f50b8842e996f5c765">timestep</a>(<span class="keyword">this</span>, dt);</div>
<div class="line"><a name="l10942"></a><span class="lineno">10942</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1ExplicitTimeStepper_html_ab43bbab17960d0f50b8842e996f5c765"><div class="ttname"><a href="../../df/d0b/classoomph_1_1ExplicitTimeStepper.html#ab43bbab17960d0f50b8842e996f5c765">oomph::ExplicitTimeStepper::timestep</a></div><div class="ttdeci">virtual void timestep(ExplicitTimeSteppableObject *const &amp;object_pt, const double &amp;dt)=0</div><div class="ttdoc">Pure virtual function that is used to advance time in the object.</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d0/da1/classoomph_1_1Time.html#a2c684e0a69db7adde90f1f052e424a6b">oomph::Time::dt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac332634783a803c1c21bf5c520af280f">explicit_time_stepper_pt()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a3d3108a38cfbed4087f5b8eb601f38a2">shift_time_values()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a46894b13c582f322082dc471a2485980">time_pt()</a>, and <a class="el" href="../../df/d0b/classoomph_1_1ExplicitTimeStepper.html#ab43bbab17960d0f50b8842e996f5c765">oomph::ExplicitTimeStepper::timestep()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acbc0b0fc5d5cc76ce8384bc0bd815f26">calculate_predictions()</a>.</p>

</div>
</div>
<a id="aa8df5552c706bd949b29f5601f8c941e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8df5552c706bd949b29f5601f8c941e">&#9670;&nbsp;</a></span>flush_global_data()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Problem::flush_global_data </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Flush the Problem's global data &ndash; resizes container to zero. Data objects are not deleted! </p>
<div class="fragment"><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;    {</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>.resize(0);</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../df/de6/classCapProblem.html#a5d06fe7f9ea8590d4752d893ded3614e">CapProblem&lt; ELEMENT &gt;::CapProblem()</a>.</p>

</div>
</div>
<a id="a42b2b42a03f9de7d7a4d24edcfa20179"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42b2b42a03f9de7d7a4d24edcfa20179">&#9670;&nbsp;</a></span>flush_sub_meshes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Problem::flush_sub_meshes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Flush the problem's collection of sub-meshes. Must be followed by call to rebuild_global_mesh(). </p>
<div class="fragment"><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    {</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab65f6fc9c49860e6324457a7e6e76346">Sub_mesh_pt</a>.clear();</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab65f6fc9c49860e6324457a7e6e76346">Sub_mesh_pt</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ac3f40f62d33d33616cdb4bed48aaccde">oomph::NavierStokesSchurComplementPreconditioner::get_pressure_advection_diffusion_matrix()</a>, <a class="el" href="../../de/da7/classoomph_1_1SegregatableFSIProblem.html#a61cad9a0a75f2999c0529caa9cac2b73">oomph::SegregatableFSIProblem::rebuild_monolithic_mesh()</a>, <a class="el" href="../../de/da7/classoomph_1_1SegregatableFSIProblem.html#a13a9841e0aa05bf57ec228b49b311a26">oomph::SegregatableFSIProblem::use_only_fluid_elements()</a>, and <a class="el" href="../../de/da7/classoomph_1_1SegregatableFSIProblem.html#a330660bc7b69c9c128bfed62b54dcf62">oomph::SegregatableFSIProblem::use_only_solid_elements()</a>.</p>

</div>
</div>
<a id="a2bd35d5954b6a8d43189b84520adb4b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2bd35d5954b6a8d43189b84520adb4b3">&#9670;&nbsp;</a></span>get_all_error_estimates()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::get_all_error_estimates </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>elemental_error</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the error estimates computed by (all) refineable (sub)mesh(es) in the elemental_error structure, which consists of a vector of vectors of elemental errors, one vector for each (sub)mesh.</p>
<p>Return the error estimates computed by (all) refineable (sub)mesh(es) in the elemental_error structure, which consists of a vector of elemental errors for each (sub)mesh. </p>
<div class="fragment"><div class="line"><a name="l14628"></a><span class="lineno">14628</span>&#160;  {</div>
<div class="line"><a name="l14629"></a><span class="lineno">14629</span>&#160;    <span class="comment">// Number of submeshes?</span></div>
<div class="line"><a name="l14630"></a><span class="lineno">14630</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> Nmesh = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>();</div>
<div class="line"><a name="l14631"></a><span class="lineno">14631</span>&#160; </div>
<div class="line"><a name="l14632"></a><span class="lineno">14632</span>&#160;    <span class="comment">// Single mesh:</span></div>
<div class="line"><a name="l14633"></a><span class="lineno">14633</span>&#160;    <span class="comment">//------------</span></div>
<div class="line"><a name="l14634"></a><span class="lineno">14634</span>&#160;    <span class="keywordflow">if</span> (Nmesh == 0)</div>
<div class="line"><a name="l14635"></a><span class="lineno">14635</span>&#160;    {</div>
<div class="line"><a name="l14636"></a><span class="lineno">14636</span>&#160;      <span class="comment">// There is only one mesh</span></div>
<div class="line"><a name="l14637"></a><span class="lineno">14637</span>&#160;      elemental_error.resize(1);</div>
<div class="line"><a name="l14638"></a><span class="lineno">14638</span>&#160;      <span class="comment">// Refine single mesh uniformly if possible</span></div>
<div class="line"><a name="l14639"></a><span class="lineno">14639</span>&#160;      <span class="keywordflow">if</span> (RefineableMeshBase* mmesh_pt =</div>
<div class="line"><a name="l14640"></a><span class="lineno">14640</span>&#160;            <span class="keyword">dynamic_cast&lt;</span>RefineableMeshBase*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">Problem::mesh_pt</a>(0)))</div>
<div class="line"><a name="l14641"></a><span class="lineno">14641</span>&#160;      {</div>
<div class="line"><a name="l14642"></a><span class="lineno">14642</span>&#160;        <span class="comment">// If we can adapt the mesh</span></div>
<div class="line"><a name="l14643"></a><span class="lineno">14643</span>&#160;        <span class="keywordflow">if</span> (mmesh_pt-&gt;is_adaptation_enabled())</div>
<div class="line"><a name="l14644"></a><span class="lineno">14644</span>&#160;        {</div>
<div class="line"><a name="l14645"></a><span class="lineno">14645</span>&#160;          <span class="comment">// Get pointer to error estimator</span></div>
<div class="line"><a name="l14646"></a><span class="lineno">14646</span>&#160;          ErrorEstimator* <a class="code" href="../../d8/d32/namespaceMeshRefinement.html#a9dade531077f055da144a85e19e67263">error_estimator_pt</a> =</div>
<div class="line"><a name="l14647"></a><span class="lineno">14647</span>&#160;            mmesh_pt-&gt;spatial_error_estimator_pt();</div>
<div class="line"><a name="l14648"></a><span class="lineno">14648</span>&#160; </div>
<div class="line"><a name="l14649"></a><span class="lineno">14649</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l14650"></a><span class="lineno">14650</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d8/d32/namespaceMeshRefinement.html#a9dade531077f055da144a85e19e67263">error_estimator_pt</a> == 0)</div>
<div class="line"><a name="l14651"></a><span class="lineno">14651</span>&#160;          {</div>
<div class="line"><a name="l14652"></a><span class="lineno">14652</span>&#160;            <span class="keywordflow">throw</span> OomphLibError(<span class="stringliteral">&quot;Error estimator hasn&#39;t been set yet&quot;</span>,</div>
<div class="line"><a name="l14653"></a><span class="lineno">14653</span>&#160;                                <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l14654"></a><span class="lineno">14654</span>&#160;                                <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l14655"></a><span class="lineno">14655</span>&#160;          }</div>
<div class="line"><a name="l14656"></a><span class="lineno">14656</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l14657"></a><span class="lineno">14657</span>&#160; </div>
<div class="line"><a name="l14658"></a><span class="lineno">14658</span>&#160;          <span class="comment">// Get error for all elements</span></div>
<div class="line"><a name="l14659"></a><span class="lineno">14659</span>&#160;          elemental_error[0].resize(mmesh_pt-&gt;nelement());</div>
<div class="line"><a name="l14660"></a><span class="lineno">14660</span>&#160;          <span class="comment">// Are we documenting the errors or not</span></div>
<div class="line"><a name="l14661"></a><span class="lineno">14661</span>&#160;          <span class="keywordflow">if</span> (mmesh_pt-&gt;doc_info_pt() == 0)</div>
<div class="line"><a name="l14662"></a><span class="lineno">14662</span>&#160;          {</div>
<div class="line"><a name="l14663"></a><span class="lineno">14663</span>&#160;            <a class="code" href="../../d8/d32/namespaceMeshRefinement.html#a9dade531077f055da144a85e19e67263">error_estimator_pt</a>-&gt;get_element_errors(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">Problem::mesh_pt</a>(0),</div>
<div class="line"><a name="l14664"></a><span class="lineno">14664</span>&#160;                                                   elemental_error[0]);</div>
<div class="line"><a name="l14665"></a><span class="lineno">14665</span>&#160;          }</div>
<div class="line"><a name="l14666"></a><span class="lineno">14666</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l14667"></a><span class="lineno">14667</span>&#160;          {</div>
<div class="line"><a name="l14668"></a><span class="lineno">14668</span>&#160;            <a class="code" href="../../d8/d32/namespaceMeshRefinement.html#a9dade531077f055da144a85e19e67263">error_estimator_pt</a>-&gt;get_element_errors(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">Problem::mesh_pt</a>(0),</div>
<div class="line"><a name="l14669"></a><span class="lineno">14669</span>&#160;                                                   elemental_error[0],</div>
<div class="line"><a name="l14670"></a><span class="lineno">14670</span>&#160;                                                   *mmesh_pt-&gt;doc_info_pt());</div>
<div class="line"><a name="l14671"></a><span class="lineno">14671</span>&#160;          }</div>
<div class="line"><a name="l14672"></a><span class="lineno">14672</span>&#160; </div>
<div class="line"><a name="l14673"></a><span class="lineno">14673</span>&#160;          <span class="comment">// Store max./min actual error</span></div>
<div class="line"><a name="l14674"></a><span class="lineno">14674</span>&#160;          mmesh_pt-&gt;max_error() =</div>
<div class="line"><a name="l14675"></a><span class="lineno">14675</span>&#160;            <a class="code" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">std::fabs</a>(*std::max_element(elemental_error[0].begin(),</div>
<div class="line"><a name="l14676"></a><span class="lineno">14676</span>&#160;                                        elemental_error[0].<a class="code" href="../../df/d04/group__Core__Module.html#ga0e45b6b2adead7c6a29815b99f9f14dd">end</a>(),</div>
<div class="line"><a name="l14677"></a><span class="lineno">14677</span>&#160;                                        AbsCmp&lt;double&gt;()));</div>
<div class="line"><a name="l14678"></a><span class="lineno">14678</span>&#160; </div>
<div class="line"><a name="l14679"></a><span class="lineno">14679</span>&#160;          mmesh_pt-&gt;min_error() =</div>
<div class="line"><a name="l14680"></a><span class="lineno">14680</span>&#160;            <a class="code" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">std::fabs</a>(*std::min_element(elemental_error[0].begin(),</div>
<div class="line"><a name="l14681"></a><span class="lineno">14681</span>&#160;                                        elemental_error[0].<a class="code" href="../../df/d04/group__Core__Module.html#ga0e45b6b2adead7c6a29815b99f9f14dd">end</a>(),</div>
<div class="line"><a name="l14682"></a><span class="lineno">14682</span>&#160;                                        AbsCmp&lt;double&gt;()));</div>
<div class="line"><a name="l14683"></a><span class="lineno">14683</span>&#160; </div>
<div class="line"><a name="l14684"></a><span class="lineno">14684</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;\n Max/min error: &quot;</span> &lt;&lt; mmesh_pt-&gt;max_error() &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l14685"></a><span class="lineno">14685</span>&#160;                     &lt;&lt; mmesh_pt-&gt;min_error() &lt;&lt; std::endl;</div>
<div class="line"><a name="l14686"></a><span class="lineno">14686</span>&#160;        }</div>
<div class="line"><a name="l14687"></a><span class="lineno">14687</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l14688"></a><span class="lineno">14688</span>&#160;        {</div>
<div class="line"><a name="l14689"></a><span class="lineno">14689</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Mesh adaptation is disabled.&quot;</span></div>
<div class="line"><a name="l14690"></a><span class="lineno">14690</span>&#160;                     &lt;&lt; std::endl;</div>
<div class="line"><a name="l14691"></a><span class="lineno">14691</span>&#160;        }</div>
<div class="line"><a name="l14692"></a><span class="lineno">14692</span>&#160;      }</div>
<div class="line"><a name="l14693"></a><span class="lineno">14693</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l14694"></a><span class="lineno">14694</span>&#160;      {</div>
<div class="line"><a name="l14695"></a><span class="lineno">14695</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Mesh cannot be adapted&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l14696"></a><span class="lineno">14696</span>&#160;      }</div>
<div class="line"><a name="l14697"></a><span class="lineno">14697</span>&#160;    }</div>
<div class="line"><a name="l14698"></a><span class="lineno">14698</span>&#160; </div>
<div class="line"><a name="l14699"></a><span class="lineno">14699</span>&#160;    <span class="comment">// Multiple submeshes</span></div>
<div class="line"><a name="l14700"></a><span class="lineno">14700</span>&#160;    <span class="comment">//------------------</span></div>
<div class="line"><a name="l14701"></a><span class="lineno">14701</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l14702"></a><span class="lineno">14702</span>&#160;    {</div>
<div class="line"><a name="l14703"></a><span class="lineno">14703</span>&#160;      <span class="comment">// Resize to the number of submeshes</span></div>
<div class="line"><a name="l14704"></a><span class="lineno">14704</span>&#160;      elemental_error.resize(Nmesh);</div>
<div class="line"><a name="l14705"></a><span class="lineno">14705</span>&#160; </div>
<div class="line"><a name="l14706"></a><span class="lineno">14706</span>&#160;      <span class="comment">// Loop over submeshes</span></div>
<div class="line"><a name="l14707"></a><span class="lineno">14707</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> imesh = 0; imesh &lt; Nmesh; imesh++)</div>
<div class="line"><a name="l14708"></a><span class="lineno">14708</span>&#160;      {</div>
<div class="line"><a name="l14709"></a><span class="lineno">14709</span>&#160;        <span class="comment">// Refine single mesh uniformly if possible</span></div>
<div class="line"><a name="l14710"></a><span class="lineno">14710</span>&#160;        <span class="keywordflow">if</span> (RefineableMeshBase* mmesh_pt =</div>
<div class="line"><a name="l14711"></a><span class="lineno">14711</span>&#160;              <span class="keyword">dynamic_cast&lt;</span>RefineableMeshBase*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">Problem::mesh_pt</a>(imesh)))</div>
<div class="line"><a name="l14712"></a><span class="lineno">14712</span>&#160;        {</div>
<div class="line"><a name="l14713"></a><span class="lineno">14713</span>&#160;          <span class="comment">// Get pointer to error estimator</span></div>
<div class="line"><a name="l14714"></a><span class="lineno">14714</span>&#160;          ErrorEstimator* <a class="code" href="../../d8/d32/namespaceMeshRefinement.html#a9dade531077f055da144a85e19e67263">error_estimator_pt</a> =</div>
<div class="line"><a name="l14715"></a><span class="lineno">14715</span>&#160;            mmesh_pt-&gt;spatial_error_estimator_pt();</div>
<div class="line"><a name="l14716"></a><span class="lineno">14716</span>&#160; </div>
<div class="line"><a name="l14717"></a><span class="lineno">14717</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l14718"></a><span class="lineno">14718</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d8/d32/namespaceMeshRefinement.html#a9dade531077f055da144a85e19e67263">error_estimator_pt</a> == 0)</div>
<div class="line"><a name="l14719"></a><span class="lineno">14719</span>&#160;          {</div>
<div class="line"><a name="l14720"></a><span class="lineno">14720</span>&#160;            <span class="keywordflow">throw</span> OomphLibError(<span class="stringliteral">&quot;Error estimator hasn&#39;t been set yet&quot;</span>,</div>
<div class="line"><a name="l14721"></a><span class="lineno">14721</span>&#160;                                <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l14722"></a><span class="lineno">14722</span>&#160;                                <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l14723"></a><span class="lineno">14723</span>&#160;          }</div>
<div class="line"><a name="l14724"></a><span class="lineno">14724</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l14725"></a><span class="lineno">14725</span>&#160;          <span class="comment">// If we can adapt the mesh</span></div>
<div class="line"><a name="l14726"></a><span class="lineno">14726</span>&#160;          <span class="keywordflow">if</span> (mmesh_pt-&gt;is_adaptation_enabled())</div>
<div class="line"><a name="l14727"></a><span class="lineno">14727</span>&#160;          {</div>
<div class="line"><a name="l14728"></a><span class="lineno">14728</span>&#160;            <span class="comment">// Get error for all elements</span></div>
<div class="line"><a name="l14729"></a><span class="lineno">14729</span>&#160;            elemental_error[imesh].resize(mmesh_pt-&gt;nelement());</div>
<div class="line"><a name="l14730"></a><span class="lineno">14730</span>&#160;            <span class="keywordflow">if</span> (mmesh_pt-&gt;doc_info_pt() == 0)</div>
<div class="line"><a name="l14731"></a><span class="lineno">14731</span>&#160;            {</div>
<div class="line"><a name="l14732"></a><span class="lineno">14732</span>&#160;              <a class="code" href="../../d8/d32/namespaceMeshRefinement.html#a9dade531077f055da144a85e19e67263">error_estimator_pt</a>-&gt;get_element_errors(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">Problem::mesh_pt</a>(imesh),</div>
<div class="line"><a name="l14733"></a><span class="lineno">14733</span>&#160;                                                     elemental_error[imesh]);</div>
<div class="line"><a name="l14734"></a><span class="lineno">14734</span>&#160;            }</div>
<div class="line"><a name="l14735"></a><span class="lineno">14735</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l14736"></a><span class="lineno">14736</span>&#160;            {</div>
<div class="line"><a name="l14737"></a><span class="lineno">14737</span>&#160;              <a class="code" href="../../d8/d32/namespaceMeshRefinement.html#a9dade531077f055da144a85e19e67263">error_estimator_pt</a>-&gt;get_element_errors(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">Problem::mesh_pt</a>(imesh),</div>
<div class="line"><a name="l14738"></a><span class="lineno">14738</span>&#160;                                                     elemental_error[imesh],</div>
<div class="line"><a name="l14739"></a><span class="lineno">14739</span>&#160;                                                     *mmesh_pt-&gt;doc_info_pt());</div>
<div class="line"><a name="l14740"></a><span class="lineno">14740</span>&#160;            }</div>
<div class="line"><a name="l14741"></a><span class="lineno">14741</span>&#160; </div>
<div class="line"><a name="l14742"></a><span class="lineno">14742</span>&#160;            <span class="comment">// Store max./min error</span></div>
<div class="line"><a name="l14743"></a><span class="lineno">14743</span>&#160;            mmesh_pt-&gt;max_error() =</div>
<div class="line"><a name="l14744"></a><span class="lineno">14744</span>&#160;              <a class="code" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">std::fabs</a>(*std::max_element(elemental_error[imesh].begin(),</div>
<div class="line"><a name="l14745"></a><span class="lineno">14745</span>&#160;                                          elemental_error[imesh].<a class="code" href="../../df/d04/group__Core__Module.html#ga0e45b6b2adead7c6a29815b99f9f14dd">end</a>(),</div>
<div class="line"><a name="l14746"></a><span class="lineno">14746</span>&#160;                                          AbsCmp&lt;double&gt;()));</div>
<div class="line"><a name="l14747"></a><span class="lineno">14747</span>&#160; </div>
<div class="line"><a name="l14748"></a><span class="lineno">14748</span>&#160;            mmesh_pt-&gt;min_error() =</div>
<div class="line"><a name="l14749"></a><span class="lineno">14749</span>&#160;              <a class="code" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">std::fabs</a>(*std::min_element(elemental_error[imesh].begin(),</div>
<div class="line"><a name="l14750"></a><span class="lineno">14750</span>&#160;                                          elemental_error[imesh].<a class="code" href="../../df/d04/group__Core__Module.html#ga0e45b6b2adead7c6a29815b99f9f14dd">end</a>(),</div>
<div class="line"><a name="l14751"></a><span class="lineno">14751</span>&#160;                                          AbsCmp&lt;double&gt;()));</div>
<div class="line"><a name="l14752"></a><span class="lineno">14752</span>&#160; </div>
<div class="line"><a name="l14753"></a><span class="lineno">14753</span>&#160;            <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;\n Max/min error: &quot;</span> &lt;&lt; mmesh_pt-&gt;max_error() &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l14754"></a><span class="lineno">14754</span>&#160;                       &lt;&lt; mmesh_pt-&gt;min_error() &lt;&lt; std::endl;</div>
<div class="line"><a name="l14755"></a><span class="lineno">14755</span>&#160;          }</div>
<div class="line"><a name="l14756"></a><span class="lineno">14756</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l14757"></a><span class="lineno">14757</span>&#160;          {</div>
<div class="line"><a name="l14758"></a><span class="lineno">14758</span>&#160;            <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Mesh adaptation is disabled.&quot;</span></div>
<div class="line"><a name="l14759"></a><span class="lineno">14759</span>&#160;                       &lt;&lt; std::endl;</div>
<div class="line"><a name="l14760"></a><span class="lineno">14760</span>&#160;          }</div>
<div class="line"><a name="l14761"></a><span class="lineno">14761</span>&#160;        }</div>
<div class="line"><a name="l14762"></a><span class="lineno">14762</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l14763"></a><span class="lineno">14763</span>&#160;        {</div>
<div class="line"><a name="l14764"></a><span class="lineno">14764</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Mesh cannot be adapted.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l14765"></a><span class="lineno">14765</span>&#160;        }</div>
<div class="line"><a name="l14766"></a><span class="lineno">14766</span>&#160; </div>
<div class="line"><a name="l14767"></a><span class="lineno">14767</span>&#160;      } <span class="comment">// End of loop over submeshes</span></div>
<div class="line"><a name="l14768"></a><span class="lineno">14768</span>&#160;    }</div>
<div class="line"><a name="l14769"></a><span class="lineno">14769</span>&#160;  }</div>
<div class="ttc" id="agroup__Core__Module_html_ga0e45b6b2adead7c6a29815b99f9f14dd"><div class="ttname"><a href="../../df/d04/group__Core__Module.html#ga0e45b6b2adead7c6a29815b99f9f14dd">Eigen::placeholders::end</a></div><div class="ttdeci">static constexpr lastp1_t end</div><div class="ttdef"><b>Definition:</b> IndexedViewHelper.h:79</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../df/d04/group__Core__Module.html#ga0e45b6b2adead7c6a29815b99f9f14dd">Eigen::placeholders::end</a>, <a class="el" href="../../d8/d32/namespaceMeshRefinement.html#a9dade531077f055da144a85e19e67263">MeshRefinement::error_estimator_pt</a>, <a class="el" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">boost::multiprecision::fabs()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, and <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5e60c7b47591bca6b20b0612e119983">adapt()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa0b4e7868e02e2d12845c9b2dd60cab9">bifurcation_adapt_helper()</a>.</p>

</div>
</div>
<a id="a82c795d158c119cfde04089b516d6711"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82c795d158c119cfde04089b516d6711">&#9670;&nbsp;</a></span>get_bifurcation_eigenfunction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::get_bifurcation_eigenfunction </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>eigenfunction</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the eigenfunction calculated as part of a bifurcation tracking process. If we are not tracking a bifurcation then an error will be thrown by the AssemblyHandler </p>
<div class="fragment"><div class="line"><a name="l10093"></a><span class="lineno">10093</span>&#160;  {</div>
<div class="line"><a name="l10094"></a><span class="lineno">10094</span>&#160;    <span class="comment">// Simply call the appropriate assembly handler function</span></div>
<div class="line"><a name="l10095"></a><span class="lineno">10095</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>-&gt;<a class="code" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a6d614b1b3809d0eb7ceb393e3ae9594f">get_eigenfunction</a>(eigenfunction);</div>
<div class="line"><a name="l10096"></a><span class="lineno">10096</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1AssemblyHandler_html_a6d614b1b3809d0eb7ceb393e3ae9594f"><div class="ttname"><a href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a6d614b1b3809d0eb7ceb393e3ae9594f">oomph::AssemblyHandler::get_eigenfunction</a></div><div class="ttdeci">virtual void get_eigenfunction(Vector&lt; DoubleVector &gt; &amp;eigenfunction)</div><div class="ttdef"><b>Definition:</b> assembly_handler.cc:188</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>, and <a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a6d614b1b3809d0eb7ceb393e3ae9594f">oomph::AssemblyHandler::get_eigenfunction()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa0b4e7868e02e2d12845c9b2dd60cab9">bifurcation_adapt_helper()</a>.</p>

</div>
</div>
<a id="adc456017cfc4fb4ae6f522973e50f496"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc456017cfc4fb4ae6f522973e50f496">&#9670;&nbsp;</a></span>get_derivative_wrt_global_parameter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::get_derivative_wrt_global_parameter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;&#160;</td>
          <td class="paramname"><em>parameter_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the derivative of the entire residuals vector wrt a global parameter, used in continuation problems</p>
<p>Get derivative of the residuals vector wrt a global parameter This is required in continuation problems </p>
<div class="fragment"><div class="line"><a name="l07889"></a><span class="lineno"> 7889</span>&#160;  {</div>
<div class="line"><a name="l07890"></a><span class="lineno"> 7890</span>&#160;    <span class="comment">// If we are doing the calculation analytically then call the appropriate</span></div>
<div class="line"><a name="l07891"></a><span class="lineno"> 7891</span>&#160;    <span class="comment">// handler and then calling get_residuals</span></div>
<div class="line"><a name="l07892"></a><span class="lineno"> 7892</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a41a7b9cf8e6fe1156fc92baa43c3fe4b">is_dparameter_calculated_analytically</a>(parameter_pt))</div>
<div class="line"><a name="l07893"></a><span class="lineno"> 7893</span>&#160;    {</div>
<div class="line"><a name="l07894"></a><span class="lineno"> 7894</span>&#160;      <span class="comment">// Locally cache pointer to assembly handler</span></div>
<div class="line"><a name="l07895"></a><span class="lineno"> 7895</span>&#160;      AssemblyHandler* <span class="keyword">const</span> old_assembly_handler_pt = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>;</div>
<div class="line"><a name="l07896"></a><span class="lineno"> 7896</span>&#160;      <span class="comment">// Create a new assembly handler that replaces get_residuals by</span></div>
<div class="line"><a name="l07897"></a><span class="lineno"> 7897</span>&#160;      <span class="comment">// get_dresiduals_dparameter for each element</span></div>
<div class="line"><a name="l07898"></a><span class="lineno"> 7898</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a> =</div>
<div class="line"><a name="l07899"></a><span class="lineno"> 7899</span>&#160;        <span class="keyword">new</span> ParameterDerivativeHandler(old_assembly_handler_pt, parameter_pt);</div>
<div class="line"><a name="l07900"></a><span class="lineno"> 7900</span>&#160;      <span class="comment">// Get the residuals, which will be dresiduals by dparameter</span></div>
<div class="line"><a name="l07901"></a><span class="lineno"> 7901</span>&#160;      this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a0103fe1a09ecf7e23a9083b35ef07aac">get_residuals</a>(result);</div>
<div class="line"><a name="l07902"></a><span class="lineno"> 7902</span>&#160;      <span class="comment">// Delete the parameter derivative handler</span></div>
<div class="line"><a name="l07903"></a><span class="lineno"> 7903</span>&#160;      <span class="keyword">delete</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>;</div>
<div class="line"><a name="l07904"></a><span class="lineno"> 7904</span>&#160;      <span class="comment">// Reset the assembly handler to the original handler</span></div>
<div class="line"><a name="l07905"></a><span class="lineno"> 7905</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a> = old_assembly_handler_pt;</div>
<div class="line"><a name="l07906"></a><span class="lineno"> 7906</span>&#160; </div>
<div class="line"><a name="l07907"></a><span class="lineno"> 7907</span>&#160;      <span class="comment">/*AssemblyHandler* const assembly_handler_pt = Assembly_handler_pt;</span></div>
<div class="line"><a name="l07908"></a><span class="lineno"> 7908</span>&#160;<span class="comment">      //Loop over all the elements</span></div>
<div class="line"><a name="l07909"></a><span class="lineno"> 7909</span>&#160;<span class="comment">      unsigned long Element_pt_range = Mesh_pt-&gt;nelement();</span></div>
<div class="line"><a name="l07910"></a><span class="lineno"> 7910</span>&#160;<span class="comment">      for(unsigned long e=0;e&lt;Element_pt_range;e++)</span></div>
<div class="line"><a name="l07911"></a><span class="lineno"> 7911</span>&#160;<span class="comment">       {</span></div>
<div class="line"><a name="l07912"></a><span class="lineno"> 7912</span>&#160;<span class="comment">        //Get the pointer to the element</span></div>
<div class="line"><a name="l07913"></a><span class="lineno"> 7913</span>&#160;<span class="comment">        GeneralisedElement* elem_pt = Mesh_pt-&gt;element_pt(e);</span></div>
<div class="line"><a name="l07914"></a><span class="lineno"> 7914</span>&#160;<span class="comment">        //Find number of dofs in the element</span></div>
<div class="line"><a name="l07915"></a><span class="lineno"> 7915</span>&#160;<span class="comment">        unsigned n_element_dofs = assembly_handler_pt-&gt;ndof(elem_pt);</span></div>
<div class="line"><a name="l07916"></a><span class="lineno"> 7916</span>&#160;<span class="comment">        //Set up an array</span></div>
<div class="line"><a name="l07917"></a><span class="lineno"> 7917</span>&#160;<span class="comment">        Vector&lt;double&gt; element_residuals(n_element_dofs);</span></div>
<div class="line"><a name="l07918"></a><span class="lineno"> 7918</span>&#160;<span class="comment">        //Fill the array</span></div>
<div class="line"><a name="l07919"></a><span class="lineno"> 7919</span>&#160;<span class="comment">        assembly_handler_pt-&gt;get_dresiduals_dparameter(elem_pt,parameter_pt,</span></div>
<div class="line"><a name="l07920"></a><span class="lineno"> 7920</span>&#160;<span class="comment">                                                       element_residuals);</span></div>
<div class="line"><a name="l07921"></a><span class="lineno"> 7921</span>&#160;<span class="comment">        //Now loop over the dofs and assign values to global Vector</span></div>
<div class="line"><a name="l07922"></a><span class="lineno"> 7922</span>&#160;<span class="comment">        for(unsigned l=0;l&lt;n_element_dofs;l++)</span></div>
<div class="line"><a name="l07923"></a><span class="lineno"> 7923</span>&#160;<span class="comment">         {</span></div>
<div class="line"><a name="l07924"></a><span class="lineno"> 7924</span>&#160;<span class="comment">          result[assembly_handler_pt-&gt;eqn_number(elem_pt,l)]</span></div>
<div class="line"><a name="l07925"></a><span class="lineno"> 7925</span>&#160;<span class="comment">           += element_residuals[l];</span></div>
<div class="line"><a name="l07926"></a><span class="lineno"> 7926</span>&#160;<span class="comment">          }</span></div>
<div class="line"><a name="l07927"></a><span class="lineno"> 7927</span>&#160;<span class="comment">          }*/</span></div>
<div class="line"><a name="l07928"></a><span class="lineno"> 7928</span>&#160; </div>
<div class="line"><a name="l07929"></a><span class="lineno"> 7929</span>&#160;      <span class="comment">// for(unsigned n=0;n&lt;n_dof;n++)</span></div>
<div class="line"><a name="l07930"></a><span class="lineno"> 7930</span>&#160;      <span class="comment">// {std::cout &lt;&lt; &quot;BLA &quot; &lt;&lt; n &lt;&lt; &quot; &quot; &lt;&lt;  result[n] &lt;&lt; &quot;\n&quot;;}</span></div>
<div class="line"><a name="l07931"></a><span class="lineno"> 7931</span>&#160;    }</div>
<div class="line"><a name="l07932"></a><span class="lineno"> 7932</span>&#160;    <span class="comment">// Otherwise use the finite difference default</span></div>
<div class="line"><a name="l07933"></a><span class="lineno"> 7933</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l07934"></a><span class="lineno"> 7934</span>&#160;    {</div>
<div class="line"><a name="l07935"></a><span class="lineno"> 7935</span>&#160;      <span class="comment">// Get the (global) residuals and store in the result vector</span></div>
<div class="line"><a name="l07936"></a><span class="lineno"> 7936</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a0103fe1a09ecf7e23a9083b35ef07aac">get_residuals</a>(result);</div>
<div class="line"><a name="l07937"></a><span class="lineno"> 7937</span>&#160; </div>
<div class="line"><a name="l07938"></a><span class="lineno"> 7938</span>&#160;      <span class="comment">// Storage for the new residuals</span></div>
<div class="line"><a name="l07939"></a><span class="lineno"> 7939</span>&#160;      <a class="code" href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a> newres;</div>
<div class="line"><a name="l07940"></a><span class="lineno"> 7940</span>&#160; </div>
<div class="line"><a name="l07941"></a><span class="lineno"> 7941</span>&#160;      <span class="comment">// Increase the global parameter</span></div>
<div class="line"><a name="l07942"></a><span class="lineno"> 7942</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="../../d5/d65/namespaceoomph_1_1BlackBoxFDNewtonSolver.html#a6f0d2ceb4451e66bb7ef4ab4fdb62bcf">FD_step</a> = 1.0e-8;</div>
<div class="line"><a name="l07943"></a><span class="lineno"> 7943</span>&#160; </div>
<div class="line"><a name="l07944"></a><span class="lineno"> 7944</span>&#160;      <span class="comment">// Store the current value of the parameter</span></div>
<div class="line"><a name="l07945"></a><span class="lineno"> 7945</span>&#160;      <span class="keywordtype">double</span> param_value = *parameter_pt;</div>
<div class="line"><a name="l07946"></a><span class="lineno"> 7946</span>&#160; </div>
<div class="line"><a name="l07947"></a><span class="lineno"> 7947</span>&#160;      <span class="comment">// Increase the parameter</span></div>
<div class="line"><a name="l07948"></a><span class="lineno"> 7948</span>&#160;      *parameter_pt += <a class="code" href="../../d5/d65/namespaceoomph_1_1BlackBoxFDNewtonSolver.html#a6f0d2ceb4451e66bb7ef4ab4fdb62bcf">FD_step</a>;</div>
<div class="line"><a name="l07949"></a><span class="lineno"> 7949</span>&#160; </div>
<div class="line"><a name="l07950"></a><span class="lineno"> 7950</span>&#160;      <span class="comment">// Do any possible updates</span></div>
<div class="line"><a name="l07951"></a><span class="lineno"> 7951</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a1e90bbe5d279295b97ae704487259bcc">actions_after_change_in_global_parameter</a>(parameter_pt);</div>
<div class="line"><a name="l07952"></a><span class="lineno"> 7952</span>&#160; </div>
<div class="line"><a name="l07953"></a><span class="lineno"> 7953</span>&#160;      <span class="comment">// Get the new residuals</span></div>
<div class="line"><a name="l07954"></a><span class="lineno"> 7954</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a0103fe1a09ecf7e23a9083b35ef07aac">get_residuals</a>(newres);</div>
<div class="line"><a name="l07955"></a><span class="lineno"> 7955</span>&#160; </div>
<div class="line"><a name="l07956"></a><span class="lineno"> 7956</span>&#160;      <span class="comment">// Find the number of local rows</span></div>
<div class="line"><a name="l07957"></a><span class="lineno"> 7957</span>&#160;      <span class="comment">//(I think it&#39;s a global vector, so that should be fine)</span></div>
<div class="line"><a name="l07958"></a><span class="lineno"> 7958</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> ndof_local = result.nrow_local();</div>
<div class="line"><a name="l07959"></a><span class="lineno"> 7959</span>&#160; </div>
<div class="line"><a name="l07960"></a><span class="lineno"> 7960</span>&#160;      <span class="comment">// Do the finite differencing in the local variables</span></div>
<div class="line"><a name="l07961"></a><span class="lineno"> 7961</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; ndof_local; ++<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>)</div>
<div class="line"><a name="l07962"></a><span class="lineno"> 7962</span>&#160;      {</div>
<div class="line"><a name="l07963"></a><span class="lineno"> 7963</span>&#160;        result[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>] = (newres[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>] - result[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>]) / <a class="code" href="../../d5/d65/namespaceoomph_1_1BlackBoxFDNewtonSolver.html#a6f0d2ceb4451e66bb7ef4ab4fdb62bcf">FD_step</a>;</div>
<div class="line"><a name="l07964"></a><span class="lineno"> 7964</span>&#160;      }</div>
<div class="line"><a name="l07965"></a><span class="lineno"> 7965</span>&#160; </div>
<div class="line"><a name="l07966"></a><span class="lineno"> 7966</span>&#160;      <span class="comment">// Reset the value of the parameter</span></div>
<div class="line"><a name="l07967"></a><span class="lineno"> 7967</span>&#160;      *parameter_pt = param_value;</div>
<div class="line"><a name="l07968"></a><span class="lineno"> 7968</span>&#160; </div>
<div class="line"><a name="l07969"></a><span class="lineno"> 7969</span>&#160;      <span class="comment">// Do any possible updates</span></div>
<div class="line"><a name="l07970"></a><span class="lineno"> 7970</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a1e90bbe5d279295b97ae704487259bcc">actions_after_change_in_global_parameter</a>(parameter_pt);</div>
<div class="line"><a name="l07971"></a><span class="lineno"> 7971</span>&#160;    }</div>
<div class="line"><a name="l07972"></a><span class="lineno"> 7972</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a0103fe1a09ecf7e23a9083b35ef07aac"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a0103fe1a09ecf7e23a9083b35ef07aac">oomph::Problem::get_residuals</a></div><div class="ttdeci">virtual void get_residuals(DoubleVector &amp;residuals)</div><div class="ttdoc">Get the total residuals Vector for the problem.</div><div class="ttdef"><b>Definition:</b> problem.cc:3714</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a1e90bbe5d279295b97ae704487259bcc"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a1e90bbe5d279295b97ae704487259bcc">oomph::Problem::actions_after_change_in_global_parameter</a></div><div class="ttdeci">virtual void actions_after_change_in_global_parameter(double *const &amp;parameter_pt)</div><div class="ttdef"><b>Definition:</b> problem.h:1133</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a41a7b9cf8e6fe1156fc92baa43c3fe4b"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a41a7b9cf8e6fe1156fc92baa43c3fe4b">oomph::Problem::is_dparameter_calculated_analytically</a></div><div class="ttdeci">bool is_dparameter_calculated_analytically(double *const &amp;parameter_pt)</div><div class="ttdef"><b>Definition:</b> problem.h:277</div></div>
<div class="ttc" id="anamespaceoomph_1_1BlackBoxFDNewtonSolver_html_a6f0d2ceb4451e66bb7ef4ab4fdb62bcf"><div class="ttname"><a href="../../d5/d65/namespaceoomph_1_1BlackBoxFDNewtonSolver.html#a6f0d2ceb4451e66bb7ef4ab4fdb62bcf">oomph::BlackBoxFDNewtonSolver::FD_step</a></div><div class="ttdeci">double FD_step</div><div class="ttdoc">FD step.</div><div class="ttdef"><b>Definition:</b> black_box_newton_solver.cc:54</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a1e90bbe5d279295b97ae704487259bcc">actions_after_change_in_global_parameter()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>, <a class="el" href="../../d5/d65/namespaceoomph_1_1BlackBoxFDNewtonSolver.html#a6f0d2ceb4451e66bb7ef4ab4fdb62bcf">oomph::BlackBoxFDNewtonSolver::FD_step</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a0103fe1a09ecf7e23a9083b35ef07aac">get_residuals()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a41a7b9cf8e6fe1156fc92baa43c3fe4b">is_dparameter_calculated_analytically()</a>, <a class="el" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>, and <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">oomph::DistributableLinearAlgebraObject::nrow_local()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a83463b9e0d3ebf86085c48c0e98c8f10">calculate_continuation_derivatives()</a>, <a class="el" href="../../d4/dcb/classoomph_1_1FoldHandler.html#add39896d007559f4fb801f1c95e4ab16">oomph::FoldHandler::FoldHandler()</a>, <a class="el" href="../../d4/da2/classoomph_1_1HopfHandler.html#ac219516b8263300eb5102d38baab05d7">oomph::HopfHandler::HopfHandler()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7b86783463433cc9c4cc382b1b40f0e1">newton_solve_continuation()</a>, and <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#ad196867613954a8fabd318b50e2aadc6">oomph::BlockPitchForkLinearSolver::solve()</a>.</p>

</div>
</div>
<a id="adb5998dfed961de76c33ae3b6fa516b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb5998dfed961de76c33ae3b6fa516b4">&#9670;&nbsp;</a></span>get_dofs() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::get_dofs </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;&#160;</td>
          <td class="paramname"><em>dofs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return vector of the t'th history value of all dofs. </p>
<p>Get history values of dofs in a double vector. </p>

<p>Reimplemented from <a class="el" href="../../df/d86/classoomph_1_1ExplicitTimeSteppableObject.html#a370d8d077bb5e07290f4c2f31183d8d2">oomph::ExplicitTimeSteppableObject</a>.</p>
<div class="fragment"><div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;  {</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#af5e9f1623cad361048856a4c0463ea23">distributed</a>())</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;    {</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(<span class="stringliteral">&quot;Not designed for distributed problems&quot;</span>,</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>,</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>);</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;      <span class="comment">// might work, not sure</span></div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;    }</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160; </div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;    <span class="comment">// Resize the vector</span></div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;    dofs.build(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>, 0.0);</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160; </div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;    <span class="comment">// First deal with global data</span></div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;    <span class="keywordtype">unsigned</span> Nglobal_data = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a60a9b6861928cf9115110b5bfc7d11a7">nglobal_data</a>();</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; Nglobal_data; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;    {</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0, nj = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;nvalue(); <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; nj; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;      {</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;        <span class="comment">// For each data get the equation number and copy out the value.</span></div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;        <span class="keywordtype">int</span> eqn_number = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;eqn_number(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;        <span class="keywordflow">if</span> (eqn_number &gt;= 0)</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;        {</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;          dofs[eqn_number] = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;value(<a class="code" href="../../dd/ddd/namespaceplotPSD.html#a112f38a9c28b7e27fed13fb3ebf10362">t</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;        }</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;      }</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;    }</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160; </div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;    <span class="comment">// Next element internal data</span></div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, ni = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>()-&gt;nelement(); <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; ni; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;    {</div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;      GeneralisedElement* ele_pt = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>()-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">element_pt</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0, nj = ele_pt-&gt;ninternal_data(); <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; nj; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;      {</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;        Data* d_pt = ele_pt-&gt;<a class="code" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a45e32d895d4b3686e0f15fe455f4ed44">internal_data_pt</a>(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> = 0, nk = d_pt-&gt;nvalue(); <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> &lt; nk; <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>++)</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;        {</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;          <span class="keywordtype">int</span> eqn_number = d_pt-&gt;<a class="code" href="../../d8/dc5/classoomph_1_1Data.html#a13206dcb7a088db0ef845ab71af505d2">eqn_number</a>(<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>);</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;          <span class="keywordflow">if</span> (eqn_number &gt;= 0)</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;          {</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;            dofs[eqn_number] = d_pt-&gt;value(<a class="code" href="../../dd/ddd/namespaceplotPSD.html#a112f38a9c28b7e27fed13fb3ebf10362">t</a>, <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>);</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;          }</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;        }</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;      }</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;    }</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160; </div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;    <span class="comment">// Now the nodes</span></div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, ni = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>()-&gt;nnode(); <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; ni; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;    {</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;      Node* node_pt = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>()-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">node_pt</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0, nj = node_pt-&gt;nvalue(); <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; nj; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;      {</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;        <span class="comment">// For each node get the equation number and copy out the value.</span></div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;        <span class="keywordtype">int</span> eqn_number = node_pt-&gt;<a class="code" href="../../d8/dc5/classoomph_1_1Data.html#a13206dcb7a088db0ef845ab71af505d2">eqn_number</a>(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;        <span class="keywordflow">if</span> (eqn_number &gt;= 0)</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;        {</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;          dofs[eqn_number] = node_pt-&gt;value(<a class="code" href="../../dd/ddd/namespaceplotPSD.html#a112f38a9c28b7e27fed13fb3ebf10362">t</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;        }</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;      }</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;    }</div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1Data_html_a13206dcb7a088db0ef845ab71af505d2"><div class="ttname"><a href="../../d8/dc5/classoomph_1_1Data.html#a13206dcb7a088db0ef845ab71af505d2">oomph::Data::eqn_number</a></div><div class="ttdeci">long &amp; eqn_number(const unsigned &amp;i)</div><div class="ttdoc">Return the equation number of the i-th stored variable.</div><div class="ttdef"><b>Definition:</b> nodes.h:367</div></div>
<div class="ttc" id="aclassoomph_1_1GeneralisedElement_html_a45e32d895d4b3686e0f15fe455f4ed44"><div class="ttname"><a href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a45e32d895d4b3686e0f15fe455f4ed44">oomph::GeneralisedElement::internal_data_pt</a></div><div class="ttdeci">Data *&amp; internal_data_pt(const unsigned &amp;i)</div><div class="ttdoc">Return a pointer to i-th internal data object.</div><div class="ttdef"><b>Definition:</b> elements.h:622</div></div>
<div class="ttc" id="alevel2__impl_8h_html_ad46ea6bf5745e72b985b11878e46a45d"><div class="ttname"><a href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a></div><div class="ttdeci">char char char int int * k</div><div class="ttdef"><b>Definition:</b> level2_impl.h:374</div></div>
<div class="ttc" id="anamespaceplotPSD_html_a112f38a9c28b7e27fed13fb3ebf10362"><div class="ttname"><a href="../../dd/ddd/namespaceplotPSD.html#a112f38a9c28b7e27fed13fb3ebf10362">plotPSD.t</a></div><div class="ttdeci">t</div><div class="ttdef"><b>Definition:</b> plotPSD.py:36</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#a7bcc94c157d6853a0f0502e8a76ed380">oomph::DoubleVector::build()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af5e9f1623cad361048856a4c0463ea23">distributed()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">oomph::Mesh::element_pt()</a>, <a class="el" href="../../d8/dc5/classoomph_1_1Data.html#a13206dcb7a088db0ef845ab71af505d2">oomph::Data::eqn_number()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a45e32d895d4b3686e0f15fe455f4ed44">oomph::GeneralisedElement::internal_data_pt()</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a60a9b6861928cf9115110b5bfc7d11a7">nglobal_data()</a>, <a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a6b736de0af4c92831968636479b3480e">oomph::GeneralisedElement::ninternal_data()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">oomph::Mesh::node_pt()</a>, <a class="el" href="../../d8/dc5/classoomph_1_1Data.html#a7e67fc78a2e8a2fd6eb75bd292d42ff8">oomph::Data::nvalue()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../dd/ddd/namespaceplotPSD.html#a112f38a9c28b7e27fed13fb3ebf10362">plotPSD::t</a>, <a class="el" href="../../d8/dc5/classoomph_1_1Data.html#a9383101536882db34e618cbe30dba2da">oomph::Data::value()</a>, and <a class="el" href="../../dc/db7/classoomph_1_1Node.html#afcc5cdba40bca251826ae5bee5ca15b4">oomph::Node::value()</a>.</p>

</div>
</div>
<a id="a11c1432869386bb49f16da15545bfee7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11c1432869386bb49f16da15545bfee7">&#9670;&nbsp;</a></span>get_dofs() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::get_dofs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;&#160;</td>
          <td class="paramname"><em>dofs</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Return the vector of dofs, i.e. a vector containing the current values of all unknowns.</p>
<p>Get the vector of dofs, i.e. a vector containing the current values of all unknowns. </p>

<p>Reimplemented from <a class="el" href="../../df/d86/classoomph_1_1ExplicitTimeSteppableObject.html#a0fcf43487590dd723f25184067f26219">oomph::ExplicitTimeSteppableObject</a>.</p>
<div class="fragment"><div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;  {</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;    <span class="comment">// Find number of dofs</span></div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n_dof = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>();</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160; </div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;    <span class="comment">// Resize the vector</span></div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;    dofs.build(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>, 0.0);</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160; </div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;    <span class="comment">// Copy dofs into vector</span></div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l = 0; l &lt; n_dof; l++)</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;    {</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;      dofs[l] = *<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>[l];</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;    }</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#a7bcc94c157d6853a0f0502e8a76ed380">oomph::DoubleVector::build()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d9e/classoomph_1_1IMRByBDF.html#a1eb1b47643bf37e27c478c6987c7716d">oomph::IMRByBDF::actions_after_timestep()</a>, <a class="el" href="../../dd/d9e/classoomph_1_1IMRByBDF.html#abc155a68889d297f732a083d911b4627">oomph::IMRByBDF::actions_before_timestep()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acbc0b0fc5d5cc76ce8384bc0bd815f26">calculate_predictions()</a>.</p>

</div>
</div>
<a id="a0daf749053a1afb0bdea7faa583dd7c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0daf749053a1afb0bdea7faa583dd7c7">&#9670;&nbsp;</a></span>get_dvaluesdt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::get_dvaluesdt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;&#160;</td>
          <td class="paramname"><em>f</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get the time derivative of all values (using get_inverse_mass_matrix_times_residuals(..) with all time steppers set to steady) e.g. for use in explicit time steps. The approach used is slighty hacky, beware if you have a residual which is non-linear or implicit in the derivative or if you have overloaded get_jacobian(...). </p>

<p>Reimplemented from <a class="el" href="../../df/d86/classoomph_1_1ExplicitTimeSteppableObject.html#ab1e7d8d7ec548b26ed039b61a9eba9c4">oomph::ExplicitTimeSteppableObject</a>.</p>
<div class="fragment"><div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;  {</div>
<div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;    <span class="comment">// Loop over timesteppers: make them (temporarily) steady and store their</span></div>
<div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;    <span class="comment">// is_steady status.</span></div>
<div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;    <span class="keywordtype">unsigned</span> n_time_steppers = this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ace3cdf55009c3bff21d2b7d3706d522a">ntime_stepper</a>();</div>
<div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;    std::vector&lt;bool&gt; was_steady(n_time_steppers);</div>
<div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_time_steppers; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;    {</div>
<div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;      was_steady[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)-&gt;<a class="code" href="../../d5/d19/classoomph_1_1TimeStepper.html#ad341ba9e80265e1c26c1cda0f40c8292">is_steady</a>();</div>
<div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)-&gt;<a class="code" href="../../d5/d19/classoomph_1_1TimeStepper.html#a81ea0ff2e66cef5e0184b616c608e418">make_steady</a>();</div>
<div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;    }</div>
<div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160; </div>
<div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;    <span class="comment">// Calculate f using the residual/jacobian machinary.</span></div>
<div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a5ee48c16fce89952a019a844ac386655">get_inverse_mass_matrix_times_residuals</a>(<a class="code" href="../../de/db9/cxx11__tensor__map_8cpp.html#a7f507fea02198f6cb81c86640c7b1a4e">f</a>);</div>
<div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160; </div>
<div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;    <span class="comment">// Reset the is_steady status of all timesteppers that weren&#39;t already</span></div>
<div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;    <span class="comment">// steady when we came in here and reset their weights</span></div>
<div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_time_steppers; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;    {</div>
<div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;      <span class="keywordflow">if</span> (!was_steady[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;      {</div>
<div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)-&gt;<a class="code" href="../../d5/d19/classoomph_1_1TimeStepper.html#aada05f89e86aae352bd5b32bfb173b18">undo_make_steady</a>();</div>
<div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;      }</div>
<div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;    }</div>
<div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a5ee48c16fce89952a019a844ac386655"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a5ee48c16fce89952a019a844ac386655">oomph::Problem::get_inverse_mass_matrix_times_residuals</a></div><div class="ttdeci">virtual void get_inverse_mass_matrix_times_residuals(DoubleVector &amp;Mres)</div><div class="ttdef"><b>Definition:</b> problem.cc:3579</div></div>
<div class="ttc" id="acxx11__tensor__map_8cpp_html_a7f507fea02198f6cb81c86640c7b1a4e"><div class="ttname"><a href="../../de/db9/cxx11__tensor__map_8cpp.html#a7f507fea02198f6cb81c86640c7b1a4e">f</a></div><div class="ttdeci">static int f(const TensorMap&lt; Tensor&lt; int, 3 &gt; &gt; &amp;tensor)</div><div class="ttdef"><b>Definition:</b> cxx11_tensor_map.cpp:237</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../de/db9/cxx11__tensor__map_8cpp.html#a7f507fea02198f6cb81c86640c7b1a4e">f()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5ee48c16fce89952a019a844ac386655">get_inverse_mass_matrix_times_residuals()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html#ad341ba9e80265e1c26c1cda0f40c8292">oomph::TimeStepper::is_steady()</a>, <a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html#a81ea0ff2e66cef5e0184b616c608e418">oomph::TimeStepper::make_steady()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ace3cdf55009c3bff21d2b7d3706d522a">ntime_stepper()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt()</a>, and <a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html#aada05f89e86aae352bd5b32bfb173b18">oomph::TimeStepper::undo_make_steady()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d0b/classoomph_1_1TR.html#abde5c3804dd51162f11c50dacb65b315">oomph::TR::setup_initial_derivative()</a>.</p>

</div>
</div>
<a id="a4e59f1c854d1258aa2b4eca218405731"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e59f1c854d1258aa2b4eca218405731">&#9670;&nbsp;</a></span>get_eigenproblem_matrices()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::get_eigenproblem_matrices </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>mass_matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>main_matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>shift</em> = <code>0.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get the matrices required by a eigensolver. If the shift parameter is non-zero the second matrix will be shifted</p>
<p>Get the matrices required to solve an eigenproblem WARNING: temporarily this method only works with non-distributed matrices </p>
<div class="fragment"><div class="line"><a name="l08371"></a><span class="lineno"> 8371</span>&#160;  {</div>
<div class="line"><a name="l08372"></a><span class="lineno"> 8372</span>&#160;    <span class="comment">// Three different cases again here:</span></div>
<div class="line"><a name="l08373"></a><span class="lineno"> 8373</span>&#160;    <span class="comment">// 1) Compiled with MPI, but run in serial</span></div>
<div class="line"><a name="l08374"></a><span class="lineno"> 8374</span>&#160;    <span class="comment">// 2) Compiled with MPI, but MPI not initialised in driver</span></div>
<div class="line"><a name="l08375"></a><span class="lineno"> 8375</span>&#160;    <span class="comment">// 3) Serial version</span></div>
<div class="line"><a name="l08376"></a><span class="lineno"> 8376</span>&#160; </div>
<div class="line"><a name="l08377"></a><span class="lineno"> 8377</span>&#160; </div>
<div class="line"><a name="l08378"></a><span class="lineno"> 8378</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l08379"></a><span class="lineno"> 8379</span>&#160;    <span class="keywordflow">if</span> (mass_matrix.distribution_built() &amp;&amp; main_matrix.distribution_built())</div>
<div class="line"><a name="l08380"></a><span class="lineno"> 8380</span>&#160;    {</div>
<div class="line"><a name="l08381"></a><span class="lineno"> 8381</span>&#160;      <span class="comment">// Check that the distribution of the mass matrix and jacobian match</span></div>
<div class="line"><a name="l08382"></a><span class="lineno"> 8382</span>&#160;      <span class="keywordflow">if</span> (!(*mass_matrix.distribution_pt() == *main_matrix.distribution_pt()))</div>
<div class="line"><a name="l08383"></a><span class="lineno"> 8383</span>&#160;      {</div>
<div class="line"><a name="l08384"></a><span class="lineno"> 8384</span>&#160;        std::ostringstream error_stream;</div>
<div class="line"><a name="l08385"></a><span class="lineno"> 8385</span>&#160;        error_stream</div>
<div class="line"><a name="l08386"></a><span class="lineno"> 8386</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;The distributions of the jacobian and mass matrix are\n&quot;</span></div>
<div class="line"><a name="l08387"></a><span class="lineno"> 8387</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;not the same and they must be.\n&quot;</span>;</div>
<div class="line"><a name="l08388"></a><span class="lineno"> 8388</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l08389"></a><span class="lineno"> 8389</span>&#160;          error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l08390"></a><span class="lineno"> 8390</span>&#160;      }</div>
<div class="line"><a name="l08391"></a><span class="lineno"> 8391</span>&#160; </div>
<div class="line"><a name="l08392"></a><span class="lineno"> 8392</span>&#160;      <span class="keywordflow">if</span> (mass_matrix.nrow() != this-&gt;ndof())</div>
<div class="line"><a name="l08393"></a><span class="lineno"> 8393</span>&#160;      {</div>
<div class="line"><a name="l08394"></a><span class="lineno"> 8394</span>&#160;        std::ostringstream error_stream;</div>
<div class="line"><a name="l08395"></a><span class="lineno"> 8395</span>&#160;        error_stream</div>
<div class="line"><a name="l08396"></a><span class="lineno"> 8396</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;mass_matrix has a distribution, but the number of rows is not &quot;</span></div>
<div class="line"><a name="l08397"></a><span class="lineno"> 8397</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;equal to the number of degrees of freedom in the problem.&quot;</span>;</div>
<div class="line"><a name="l08398"></a><span class="lineno"> 8398</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l08399"></a><span class="lineno"> 8399</span>&#160;          error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l08400"></a><span class="lineno"> 8400</span>&#160;      }</div>
<div class="line"><a name="l08401"></a><span class="lineno"> 8401</span>&#160; </div>
<div class="line"><a name="l08402"></a><span class="lineno"> 8402</span>&#160;      <span class="keywordflow">if</span> (main_matrix.nrow() != this-&gt;ndof())</div>
<div class="line"><a name="l08403"></a><span class="lineno"> 8403</span>&#160;      {</div>
<div class="line"><a name="l08404"></a><span class="lineno"> 8404</span>&#160;        std::ostringstream error_stream;</div>
<div class="line"><a name="l08405"></a><span class="lineno"> 8405</span>&#160;        error_stream</div>
<div class="line"><a name="l08406"></a><span class="lineno"> 8406</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;main_matrix has a distribution, but the number of rows is not &quot;</span></div>
<div class="line"><a name="l08407"></a><span class="lineno"> 8407</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;equal to the number of degrees of freedom in the problem.&quot;</span>;</div>
<div class="line"><a name="l08408"></a><span class="lineno"> 8408</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l08409"></a><span class="lineno"> 8409</span>&#160;          error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l08410"></a><span class="lineno"> 8410</span>&#160;      }</div>
<div class="line"><a name="l08411"></a><span class="lineno"> 8411</span>&#160;    }</div>
<div class="line"><a name="l08412"></a><span class="lineno"> 8412</span>&#160;    <span class="comment">// If the distributions are not the same, then complain</span></div>
<div class="line"><a name="l08413"></a><span class="lineno"> 8413</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (main_matrix.distribution_built() !=</div>
<div class="line"><a name="l08414"></a><span class="lineno"> 8414</span>&#160;             mass_matrix.distribution_built())</div>
<div class="line"><a name="l08415"></a><span class="lineno"> 8415</span>&#160;    {</div>
<div class="line"><a name="l08416"></a><span class="lineno"> 8416</span>&#160;      std::ostringstream error_stream;</div>
<div class="line"><a name="l08417"></a><span class="lineno"> 8417</span>&#160;      error_stream &lt;&lt; <span class="stringliteral">&quot;The distribution of the jacobian and mass matrix must &quot;</span></div>
<div class="line"><a name="l08418"></a><span class="lineno"> 8418</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;both be setup or both not setup&quot;</span>;</div>
<div class="line"><a name="l08419"></a><span class="lineno"> 8419</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l08420"></a><span class="lineno"> 8420</span>&#160;        error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l08421"></a><span class="lineno"> 8421</span>&#160;    }</div>
<div class="line"><a name="l08422"></a><span class="lineno"> 8422</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l08423"></a><span class="lineno"> 8423</span>&#160; </div>
<div class="line"><a name="l08424"></a><span class="lineno"> 8424</span>&#160;    <span class="comment">// Store the old assembly handler</span></div>
<div class="line"><a name="l08425"></a><span class="lineno"> 8425</span>&#160;    AssemblyHandler* old_assembly_handler_pt = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>;</div>
<div class="line"><a name="l08426"></a><span class="lineno"> 8426</span>&#160;    <span class="comment">// Now setup the eigenproblem handler, pass in the value of the shift</span></div>
<div class="line"><a name="l08427"></a><span class="lineno"> 8427</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a> = <span class="keyword">new</span> EigenProblemHandler(shift);</div>
<div class="line"><a name="l08428"></a><span class="lineno"> 8428</span>&#160; </div>
<div class="line"><a name="l08429"></a><span class="lineno"> 8429</span>&#160;    <span class="comment">// Prepare the storage formats.</span></div>
<div class="line"><a name="l08430"></a><span class="lineno"> 8430</span>&#160;    Vector&lt;int*&gt; column_or_row_index(2);</div>
<div class="line"><a name="l08431"></a><span class="lineno"> 8431</span>&#160;    Vector&lt;int*&gt; row_or_column_start(2);</div>
<div class="line"><a name="l08432"></a><span class="lineno"> 8432</span>&#160;    Vector&lt;double*&gt; <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>(2);</div>
<div class="line"><a name="l08433"></a><span class="lineno"> 8433</span>&#160;    Vector&lt;unsigned&gt; nnz(2);</div>
<div class="line"><a name="l08434"></a><span class="lineno"> 8434</span>&#160;    <span class="comment">// Allocate pointer to residuals, although not used in these problems</span></div>
<div class="line"><a name="l08435"></a><span class="lineno"> 8435</span>&#160;    Vector&lt;double*&gt; residuals_vectors(0);</div>
<div class="line"><a name="l08436"></a><span class="lineno"> 8436</span>&#160; </div>
<div class="line"><a name="l08437"></a><span class="lineno"> 8437</span>&#160;    <span class="comment">// total number of rows in each matrix</span></div>
<div class="line"><a name="l08438"></a><span class="lineno"> 8438</span>&#160;    <span class="keywordtype">unsigned</span> nrow = this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>();</div>
<div class="line"><a name="l08439"></a><span class="lineno"> 8439</span>&#160; </div>
<div class="line"><a name="l08440"></a><span class="lineno"> 8440</span>&#160;    <span class="comment">// determine the distribution for the jacobian (main matrix)</span></div>
<div class="line"><a name="l08441"></a><span class="lineno"> 8441</span>&#160;    <span class="comment">// IF the jacobian has distribution setup then use that</span></div>
<div class="line"><a name="l08442"></a><span class="lineno"> 8442</span>&#160;    <span class="comment">// ELSE determine the distribution based on the</span></div>
<div class="line"><a name="l08443"></a><span class="lineno"> 8443</span>&#160;    <span class="comment">// distributed_matrix_distribution enum</span></div>
<div class="line"><a name="l08444"></a><span class="lineno"> 8444</span>&#160;    LinearAlgebraDistribution* dist_pt = 0;</div>
<div class="line"><a name="l08445"></a><span class="lineno"> 8445</span>&#160;    <span class="keywordflow">if</span> (main_matrix.distribution_built())</div>
<div class="line"><a name="l08446"></a><span class="lineno"> 8446</span>&#160;    {</div>
<div class="line"><a name="l08447"></a><span class="lineno"> 8447</span>&#160;      dist_pt = <span class="keyword">new</span> LinearAlgebraDistribution(main_matrix.distribution_pt());</div>
<div class="line"><a name="l08448"></a><span class="lineno"> 8448</span>&#160;    }</div>
<div class="line"><a name="l08449"></a><span class="lineno"> 8449</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l08450"></a><span class="lineno"> 8450</span>&#160;    {</div>
<div class="line"><a name="l08451"></a><span class="lineno"> 8451</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l08452"></a><span class="lineno"> 8452</span>&#160;      <span class="comment">// if problem is only one one processor</span></div>
<div class="line"><a name="l08453"></a><span class="lineno"> 8453</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>-&gt;<a class="code" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a6c78c72666f4b102c2bccf200f0853b7">nproc</a>() == 1)</div>
<div class="line"><a name="l08454"></a><span class="lineno"> 8454</span>&#160;      {</div>
<div class="line"><a name="l08455"></a><span class="lineno"> 8455</span>&#160;        dist_pt = <span class="keyword">new</span> LinearAlgebraDistribution(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>, nrow, <span class="keyword">false</span>);</div>
<div class="line"><a name="l08456"></a><span class="lineno"> 8456</span>&#160;      }</div>
<div class="line"><a name="l08457"></a><span class="lineno"> 8457</span>&#160;      <span class="comment">// if the problem is not distributed then assemble the matrices with</span></div>
<div class="line"><a name="l08458"></a><span class="lineno"> 8458</span>&#160;      <span class="comment">// a uniform distributed distribution</span></div>
<div class="line"><a name="l08459"></a><span class="lineno"> 8459</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!Problem_has_been_distributed)</div>
<div class="line"><a name="l08460"></a><span class="lineno"> 8460</span>&#160;      {</div>
<div class="line"><a name="l08461"></a><span class="lineno"> 8461</span>&#160;        dist_pt = <span class="keyword">new</span> LinearAlgebraDistribution(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>, nrow, <span class="keyword">true</span>);</div>
<div class="line"><a name="l08462"></a><span class="lineno"> 8462</span>&#160;      }</div>
<div class="line"><a name="l08463"></a><span class="lineno"> 8463</span>&#160;      <span class="comment">// otherwise the problem is a distributed problem</span></div>
<div class="line"><a name="l08464"></a><span class="lineno"> 8464</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l08465"></a><span class="lineno"> 8465</span>&#160;      {</div>
<div class="line"><a name="l08466"></a><span class="lineno"> 8466</span>&#160;        <span class="keywordflow">switch</span> (Dist_problem_matrix_distribution)</div>
<div class="line"><a name="l08467"></a><span class="lineno"> 8467</span>&#160;        {</div>
<div class="line"><a name="l08468"></a><span class="lineno"> 8468</span>&#160;          <span class="keywordflow">case</span> Uniform_matrix_distribution:</div>
<div class="line"><a name="l08469"></a><span class="lineno"> 8469</span>&#160;            dist_pt =</div>
<div class="line"><a name="l08470"></a><span class="lineno"> 8470</span>&#160;              <span class="keyword">new</span> LinearAlgebraDistribution(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>, nrow, <span class="keyword">true</span>);</div>
<div class="line"><a name="l08471"></a><span class="lineno"> 8471</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08472"></a><span class="lineno"> 8472</span>&#160;          <span class="keywordflow">case</span> Problem_matrix_distribution:</div>
<div class="line"><a name="l08473"></a><span class="lineno"> 8473</span>&#160;            dist_pt = <span class="keyword">new</span> LinearAlgebraDistribution(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>);</div>
<div class="line"><a name="l08474"></a><span class="lineno"> 8474</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08475"></a><span class="lineno"> 8475</span>&#160;          <span class="keywordflow">case</span> Default_matrix_distribution:</div>
<div class="line"><a name="l08476"></a><span class="lineno"> 8476</span>&#160;            LinearAlgebraDistribution* uniform_dist_pt =</div>
<div class="line"><a name="l08477"></a><span class="lineno"> 8477</span>&#160;              <span class="keyword">new</span> LinearAlgebraDistribution(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>, nrow, <span class="keyword">true</span>);</div>
<div class="line"><a name="l08478"></a><span class="lineno"> 8478</span>&#160;            <span class="keywordtype">bool</span> use_problem_dist = <span class="keyword">true</span>;</div>
<div class="line"><a name="l08479"></a><span class="lineno"> 8479</span>&#160;            <span class="keywordtype">unsigned</span> nproc = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>-&gt;<a class="code" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a6c78c72666f4b102c2bccf200f0853b7">nproc</a>();</div>
<div class="line"><a name="l08480"></a><span class="lineno"> 8480</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> = 0; <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> &lt; nproc; <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>++)</div>
<div class="line"><a name="l08481"></a><span class="lineno"> 8481</span>&#160;            {</div>
<div class="line"><a name="l08482"></a><span class="lineno"> 8482</span>&#160;              <span class="keywordflow">if</span> ((<span class="keywordtype">double</span>)<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">nrow_local</a>(<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>) &gt;</div>
<div class="line"><a name="l08483"></a><span class="lineno"> 8483</span>&#160;                  ((<span class="keywordtype">double</span>)uniform_dist_pt-&gt;nrow_local(<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>)) * 1.1)</div>
<div class="line"><a name="l08484"></a><span class="lineno"> 8484</span>&#160;              {</div>
<div class="line"><a name="l08485"></a><span class="lineno"> 8485</span>&#160;                use_problem_dist = <span class="keyword">false</span>;</div>
<div class="line"><a name="l08486"></a><span class="lineno"> 8486</span>&#160;              }</div>
<div class="line"><a name="l08487"></a><span class="lineno"> 8487</span>&#160;            }</div>
<div class="line"><a name="l08488"></a><span class="lineno"> 8488</span>&#160;            <span class="keywordflow">if</span> (use_problem_dist)</div>
<div class="line"><a name="l08489"></a><span class="lineno"> 8489</span>&#160;            {</div>
<div class="line"><a name="l08490"></a><span class="lineno"> 8490</span>&#160;              dist_pt = <span class="keyword">new</span> LinearAlgebraDistribution(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>);</div>
<div class="line"><a name="l08491"></a><span class="lineno"> 8491</span>&#160;            }</div>
<div class="line"><a name="l08492"></a><span class="lineno"> 8492</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l08493"></a><span class="lineno"> 8493</span>&#160;            {</div>
<div class="line"><a name="l08494"></a><span class="lineno"> 8494</span>&#160;              dist_pt = <span class="keyword">new</span> LinearAlgebraDistribution(uniform_dist_pt);</div>
<div class="line"><a name="l08495"></a><span class="lineno"> 8495</span>&#160;            }</div>
<div class="line"><a name="l08496"></a><span class="lineno"> 8496</span>&#160;            <span class="keyword">delete</span> uniform_dist_pt;</div>
<div class="line"><a name="l08497"></a><span class="lineno"> 8497</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08498"></a><span class="lineno"> 8498</span>&#160;        }</div>
<div class="line"><a name="l08499"></a><span class="lineno"> 8499</span>&#160;      }</div>
<div class="line"><a name="l08500"></a><span class="lineno"> 8500</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l08501"></a><span class="lineno"> 8501</span>&#160;      dist_pt = <span class="keyword">new</span> LinearAlgebraDistribution(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>, nrow, <span class="keyword">false</span>);</div>
<div class="line"><a name="l08502"></a><span class="lineno"> 8502</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l08503"></a><span class="lineno"> 8503</span>&#160;    }</div>
<div class="line"><a name="l08504"></a><span class="lineno"> 8504</span>&#160; </div>
<div class="line"><a name="l08505"></a><span class="lineno"> 8505</span>&#160; </div>
<div class="line"><a name="l08506"></a><span class="lineno"> 8506</span>&#160;    <span class="comment">// The matrix is in compressed row format</span></div>
<div class="line"><a name="l08507"></a><span class="lineno"> 8507</span>&#160;    <span class="keywordtype">bool</span> compressed_row_flag = <span class="keyword">true</span>;</div>
<div class="line"><a name="l08508"></a><span class="lineno"> 8508</span>&#160; </div>
<div class="line"><a name="l08509"></a><span class="lineno"> 8509</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l08510"></a><span class="lineno"> 8510</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l08511"></a><span class="lineno"> 8511</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>-&gt;<a class="code" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a6c78c72666f4b102c2bccf200f0853b7">nproc</a>() == 1)</div>
<div class="line"><a name="l08512"></a><span class="lineno"> 8512</span>&#160;    {</div>
<div class="line"><a name="l08513"></a><span class="lineno"> 8513</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l08514"></a><span class="lineno"> 8514</span>&#160; </div>
<div class="line"><a name="l08515"></a><span class="lineno"> 8515</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab9cdd18180be05e4d46bfdbc1acbdbd3">sparse_assemble_row_or_column_compressed</a>(column_or_row_index,</div>
<div class="line"><a name="l08516"></a><span class="lineno"> 8516</span>&#160;                                               row_or_column_start,</div>
<div class="line"><a name="l08517"></a><span class="lineno"> 8517</span>&#160;                                               <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>,</div>
<div class="line"><a name="l08518"></a><span class="lineno"> 8518</span>&#160;                                               nnz,</div>
<div class="line"><a name="l08519"></a><span class="lineno"> 8519</span>&#160;                                               residuals_vectors,</div>
<div class="line"><a name="l08520"></a><span class="lineno"> 8520</span>&#160;                                               compressed_row_flag);</div>
<div class="line"><a name="l08521"></a><span class="lineno"> 8521</span>&#160; </div>
<div class="line"><a name="l08522"></a><span class="lineno"> 8522</span>&#160;      <span class="comment">// The main matrix is the first entry</span></div>
<div class="line"><a name="l08523"></a><span class="lineno"> 8523</span>&#160;      main_matrix.build(dist_pt);</div>
<div class="line"><a name="l08524"></a><span class="lineno"> 8524</span>&#160;      main_matrix.build_without_copy(dist_pt-&gt;nrow(),</div>
<div class="line"><a name="l08525"></a><span class="lineno"> 8525</span>&#160;                                     nnz[0],</div>
<div class="line"><a name="l08526"></a><span class="lineno"> 8526</span>&#160;                                     <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>[0],</div>
<div class="line"><a name="l08527"></a><span class="lineno"> 8527</span>&#160;                                     column_or_row_index[0],</div>
<div class="line"><a name="l08528"></a><span class="lineno"> 8528</span>&#160;                                     row_or_column_start[0]);</div>
<div class="line"><a name="l08529"></a><span class="lineno"> 8529</span>&#160;      <span class="comment">// The mass matrix is the second entry</span></div>
<div class="line"><a name="l08530"></a><span class="lineno"> 8530</span>&#160;      mass_matrix.build(dist_pt);</div>
<div class="line"><a name="l08531"></a><span class="lineno"> 8531</span>&#160;      mass_matrix.build_without_copy(dist_pt-&gt;nrow(),</div>
<div class="line"><a name="l08532"></a><span class="lineno"> 8532</span>&#160;                                     nnz[1],</div>
<div class="line"><a name="l08533"></a><span class="lineno"> 8533</span>&#160;                                     <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>[1],</div>
<div class="line"><a name="l08534"></a><span class="lineno"> 8534</span>&#160;                                     column_or_row_index[1],</div>
<div class="line"><a name="l08535"></a><span class="lineno"> 8535</span>&#160;                                     row_or_column_start[1]);</div>
<div class="line"><a name="l08536"></a><span class="lineno"> 8536</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l08537"></a><span class="lineno"> 8537</span>&#160;    }</div>
<div class="line"><a name="l08538"></a><span class="lineno"> 8538</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l08539"></a><span class="lineno"> 8539</span>&#160;    {</div>
<div class="line"><a name="l08540"></a><span class="lineno"> 8540</span>&#160;      <span class="keywordflow">if</span> (dist_pt-&gt;distributed())</div>
<div class="line"><a name="l08541"></a><span class="lineno"> 8541</span>&#160;      {</div>
<div class="line"><a name="l08542"></a><span class="lineno"> 8542</span>&#160;        parallel_sparse_assemble(dist_pt,</div>
<div class="line"><a name="l08543"></a><span class="lineno"> 8543</span>&#160;                                 column_or_row_index,</div>
<div class="line"><a name="l08544"></a><span class="lineno"> 8544</span>&#160;                                 row_or_column_start,</div>
<div class="line"><a name="l08545"></a><span class="lineno"> 8545</span>&#160;                                 <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>,</div>
<div class="line"><a name="l08546"></a><span class="lineno"> 8546</span>&#160;                                 nnz,</div>
<div class="line"><a name="l08547"></a><span class="lineno"> 8547</span>&#160;                                 residuals_vectors);</div>
<div class="line"><a name="l08548"></a><span class="lineno"> 8548</span>&#160;        <span class="comment">// The main matrix is the first entry</span></div>
<div class="line"><a name="l08549"></a><span class="lineno"> 8549</span>&#160;        main_matrix.build(dist_pt);</div>
<div class="line"><a name="l08550"></a><span class="lineno"> 8550</span>&#160;        main_matrix.build_without_copy(dist_pt-&gt;nrow(),</div>
<div class="line"><a name="l08551"></a><span class="lineno"> 8551</span>&#160;                                       nnz[0],</div>
<div class="line"><a name="l08552"></a><span class="lineno"> 8552</span>&#160;                                       <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>[0],</div>
<div class="line"><a name="l08553"></a><span class="lineno"> 8553</span>&#160;                                       column_or_row_index[0],</div>
<div class="line"><a name="l08554"></a><span class="lineno"> 8554</span>&#160;                                       row_or_column_start[0]);</div>
<div class="line"><a name="l08555"></a><span class="lineno"> 8555</span>&#160;        <span class="comment">// The mass matrix is the second entry</span></div>
<div class="line"><a name="l08556"></a><span class="lineno"> 8556</span>&#160;        mass_matrix.build(dist_pt);</div>
<div class="line"><a name="l08557"></a><span class="lineno"> 8557</span>&#160;        mass_matrix.build_without_copy(dist_pt-&gt;nrow(),</div>
<div class="line"><a name="l08558"></a><span class="lineno"> 8558</span>&#160;                                       nnz[1],</div>
<div class="line"><a name="l08559"></a><span class="lineno"> 8559</span>&#160;                                       <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>[1],</div>
<div class="line"><a name="l08560"></a><span class="lineno"> 8560</span>&#160;                                       column_or_row_index[1],</div>
<div class="line"><a name="l08561"></a><span class="lineno"> 8561</span>&#160;                                       row_or_column_start[1]);</div>
<div class="line"><a name="l08562"></a><span class="lineno"> 8562</span>&#160;      }</div>
<div class="line"><a name="l08563"></a><span class="lineno"> 8563</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l08564"></a><span class="lineno"> 8564</span>&#160;      {</div>
<div class="line"><a name="l08565"></a><span class="lineno"> 8565</span>&#160;        LinearAlgebraDistribution* temp_dist_pt =</div>
<div class="line"><a name="l08566"></a><span class="lineno"> 8566</span>&#160;          <span class="keyword">new</span> LinearAlgebraDistribution(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>, dist_pt-&gt;nrow(), <span class="keyword">true</span>);</div>
<div class="line"><a name="l08567"></a><span class="lineno"> 8567</span>&#160;        parallel_sparse_assemble(temp_dist_pt,</div>
<div class="line"><a name="l08568"></a><span class="lineno"> 8568</span>&#160;                                 column_or_row_index,</div>
<div class="line"><a name="l08569"></a><span class="lineno"> 8569</span>&#160;                                 row_or_column_start,</div>
<div class="line"><a name="l08570"></a><span class="lineno"> 8570</span>&#160;                                 <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>,</div>
<div class="line"><a name="l08571"></a><span class="lineno"> 8571</span>&#160;                                 nnz,</div>
<div class="line"><a name="l08572"></a><span class="lineno"> 8572</span>&#160;                                 residuals_vectors);</div>
<div class="line"><a name="l08573"></a><span class="lineno"> 8573</span>&#160;        <span class="comment">// The main matrix is the first entry</span></div>
<div class="line"><a name="l08574"></a><span class="lineno"> 8574</span>&#160;        main_matrix.build(temp_dist_pt);</div>
<div class="line"><a name="l08575"></a><span class="lineno"> 8575</span>&#160;        main_matrix.build_without_copy(dist_pt-&gt;nrow(),</div>
<div class="line"><a name="l08576"></a><span class="lineno"> 8576</span>&#160;                                       nnz[0],</div>
<div class="line"><a name="l08577"></a><span class="lineno"> 8577</span>&#160;                                       <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>[0],</div>
<div class="line"><a name="l08578"></a><span class="lineno"> 8578</span>&#160;                                       column_or_row_index[0],</div>
<div class="line"><a name="l08579"></a><span class="lineno"> 8579</span>&#160;                                       row_or_column_start[0]);</div>
<div class="line"><a name="l08580"></a><span class="lineno"> 8580</span>&#160;        main_matrix.redistribute(dist_pt);</div>
<div class="line"><a name="l08581"></a><span class="lineno"> 8581</span>&#160;        <span class="comment">// The mass matrix is the second entry</span></div>
<div class="line"><a name="l08582"></a><span class="lineno"> 8582</span>&#160;        mass_matrix.build(temp_dist_pt);</div>
<div class="line"><a name="l08583"></a><span class="lineno"> 8583</span>&#160;        mass_matrix.build_without_copy(dist_pt-&gt;nrow(),</div>
<div class="line"><a name="l08584"></a><span class="lineno"> 8584</span>&#160;                                       nnz[1],</div>
<div class="line"><a name="l08585"></a><span class="lineno"> 8585</span>&#160;                                       <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>[1],</div>
<div class="line"><a name="l08586"></a><span class="lineno"> 8586</span>&#160;                                       column_or_row_index[1],</div>
<div class="line"><a name="l08587"></a><span class="lineno"> 8587</span>&#160;                                       row_or_column_start[1]);</div>
<div class="line"><a name="l08588"></a><span class="lineno"> 8588</span>&#160;        mass_matrix.redistribute(dist_pt);</div>
<div class="line"><a name="l08589"></a><span class="lineno"> 8589</span>&#160;        <span class="keyword">delete</span> temp_dist_pt;</div>
<div class="line"><a name="l08590"></a><span class="lineno"> 8590</span>&#160;      }</div>
<div class="line"><a name="l08591"></a><span class="lineno"> 8591</span>&#160;    }</div>
<div class="line"><a name="l08592"></a><span class="lineno"> 8592</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l08593"></a><span class="lineno"> 8593</span>&#160; </div>
<div class="line"><a name="l08594"></a><span class="lineno"> 8594</span>&#160;    <span class="comment">// clean up dist_pt and residuals_vector pt</span></div>
<div class="line"><a name="l08595"></a><span class="lineno"> 8595</span>&#160;    <span class="keyword">delete</span> dist_pt;</div>
<div class="line"><a name="l08596"></a><span class="lineno"> 8596</span>&#160; </div>
<div class="line"><a name="l08597"></a><span class="lineno"> 8597</span>&#160;    <span class="comment">// Delete the eigenproblem handler</span></div>
<div class="line"><a name="l08598"></a><span class="lineno"> 8598</span>&#160;    <span class="keyword">delete</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>;</div>
<div class="line"><a name="l08599"></a><span class="lineno"> 8599</span>&#160;    <span class="comment">// Reset the assembly handler to the original handler</span></div>
<div class="line"><a name="l08600"></a><span class="lineno"> 8600</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a> = old_assembly_handler_pt;</div>
<div class="line"><a name="l08601"></a><span class="lineno"> 8601</span>&#160;  }</div>
<div class="ttc" id="aTutorial__Map__using_8cpp_html_a7fe964f6b1afd4591f637999272ab9a2"><div class="ttname"><a href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a></div><div class="ttdeci">float * p</div><div class="ttdef"><b>Definition:</b> Tutorial_Map_using.cpp:9</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_ab9cdd18180be05e4d46bfdbc1acbdbd3"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#ab9cdd18180be05e4d46bfdbc1acbdbd3">oomph::Problem::sparse_assemble_row_or_column_compressed</a></div><div class="ttdeci">virtual void sparse_assemble_row_or_column_compressed(Vector&lt; int * &gt; &amp;column_or_row_index, Vector&lt; int * &gt; &amp;row_or_column_start, Vector&lt; double * &gt; &amp;value, Vector&lt; unsigned &gt; &amp;nnz, Vector&lt; double * &gt; &amp;residual, bool compressed_row_flag)</div><div class="ttdef"><b>Definition:</b> problem.cc:4484</div></div>
<div class="ttc" id="anamespaceEigen_html_a242ccf5e6e80154bbf36d63acf6e458a"><div class="ttname"><a href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">Eigen::value</a></div><div class="ttdeci">squared absolute value</div><div class="ttdef"><b>Definition:</b> GlobalFunctions.h:87</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#af44bac2acd071317f96dae49cbb0d977">oomph::CRDoubleMatrix::build()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aafb4d7de0a87b4bda560928e6a128060">oomph::CRDoubleMatrix::build_without_copy()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a05842d032d28880ae37951deae804ad8">oomph::LinearAlgebraDistribution::distributed()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a8c35baa65e335043f62954c92c090a5a">oomph::DistributableLinearAlgebraObject::distribution_built()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">oomph::DistributableLinearAlgebraObject::distribution_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof()</a>, <a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a6c78c72666f4b102c2bccf200f0853b7">oomph::OomphCommunicator::nproc()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#aafad0b69de2284808366b65bd63e493b">oomph::LinearAlgebraDistribution::nrow()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#abd8d231b0549540144b4739a667b1e75">oomph::CRDoubleMatrix::nrow()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">oomph::LinearAlgebraDistribution::nrow_local()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a9ba295a04e08e3153ae06bc0556f507d">oomph::CRDoubleMatrix::redistribute()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab9cdd18180be05e4d46bfdbc1acbdbd3">sparse_assemble_row_or_column_compressed()</a>, and <a class="el" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">Eigen::value</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/dcc/classoomph_1_1ProblemBasedShiftInvertOperator.html#a2a25d70c81543acf3c97ae7fbe32648e">oomph::ProblemBasedShiftInvertOperator::ProblemBasedShiftInvertOperator()</a>, <a class="el" href="../../d6/d35/classoomph_1_1ARPACK.html#a22a914045a51a8ad89158cffd81127fe">oomph::ARPACK::solve_eigenproblem()</a>, and <a class="el" href="../../d0/d43/classoomph_1_1LAPACK__QZ.html#a6f06580f8907d38c7e7c36e12da44b59">oomph::LAPACK_QZ::solve_eigenproblem()</a>.</p>

</div>
</div>
<a id="a9f3d1c9378e385d7755184a97f5f6f91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f3d1c9378e385d7755184a97f5f6f91">&#9670;&nbsp;</a></span>get_fd_jacobian()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::get_fd_jacobian </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;&#160;</td>
          <td class="paramname"><em>residuals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>jacobian</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the full Jacobian by finite differencing. </p>
<p>Return the fully-assembled Jacobian and residuals, generated by finite differences </p>
<div class="fragment"><div class="line"><a name="l07825"></a><span class="lineno"> 7825</span>&#160;  {</div>
<div class="line"><a name="l07826"></a><span class="lineno"> 7826</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l07827"></a><span class="lineno"> 7827</span>&#160; </div>
<div class="line"><a name="l07828"></a><span class="lineno"> 7828</span>&#160;    <span class="keywordflow">if</span> (Problem_has_been_distributed)</div>
<div class="line"><a name="l07829"></a><span class="lineno"> 7829</span>&#160;    {</div>
<div class="line"><a name="l07830"></a><span class="lineno"> 7830</span>&#160;      OomphLibWarning(<span class="stringliteral">&quot;This is unlikely to work with a distributed problem&quot;</span>,</div>
<div class="line"><a name="l07831"></a><span class="lineno"> 7831</span>&#160;                      <span class="stringliteral">&quot; Problem::get_fd_jacobian()&quot;</span>,</div>
<div class="line"><a name="l07832"></a><span class="lineno"> 7832</span>&#160;                      <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l07833"></a><span class="lineno"> 7833</span>&#160;    }</div>
<div class="line"><a name="l07834"></a><span class="lineno"> 7834</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l07835"></a><span class="lineno"> 7835</span>&#160; </div>
<div class="line"><a name="l07836"></a><span class="lineno"> 7836</span>&#160; </div>
<div class="line"><a name="l07837"></a><span class="lineno"> 7837</span>&#160;    <span class="comment">// Find number of dofs</span></div>
<div class="line"><a name="l07838"></a><span class="lineno"> 7838</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n_dof = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>();</div>
<div class="line"><a name="l07839"></a><span class="lineno"> 7839</span>&#160; </div>
<div class="line"><a name="l07840"></a><span class="lineno"> 7840</span>&#160;    <span class="comment">// Advanced residuals</span></div>
<div class="line"><a name="l07841"></a><span class="lineno"> 7841</span>&#160;    <a class="code" href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a> residuals_pls;</div>
<div class="line"><a name="l07842"></a><span class="lineno"> 7842</span>&#160; </div>
<div class="line"><a name="l07843"></a><span class="lineno"> 7843</span>&#160;    <span class="comment">// Get reference residuals</span></div>
<div class="line"><a name="l07844"></a><span class="lineno"> 7844</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a0103fe1a09ecf7e23a9083b35ef07aac">get_residuals</a>(residuals);</div>
<div class="line"><a name="l07845"></a><span class="lineno"> 7845</span>&#160; </div>
<div class="line"><a name="l07846"></a><span class="lineno"> 7846</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="../../d5/d65/namespaceoomph_1_1BlackBoxFDNewtonSolver.html#a6f0d2ceb4451e66bb7ef4ab4fdb62bcf">FD_step</a> = 1.0e-8;</div>
<div class="line"><a name="l07847"></a><span class="lineno"> 7847</span>&#160; </div>
<div class="line"><a name="l07848"></a><span class="lineno"> 7848</span>&#160;    <span class="comment">// Make sure the Jacobian is the right size (since we don&#39;t care about</span></div>
<div class="line"><a name="l07849"></a><span class="lineno"> 7849</span>&#160;    <span class="comment">// speed).</span></div>
<div class="line"><a name="l07850"></a><span class="lineno"> 7850</span>&#160;    jacobian.<a class="code" href="../../d6/d13/classoomph_1_1DenseMatrix.html#adec1ef741b1c5048a12ba9a540c2719c">resize</a>(n_dof, n_dof);</div>
<div class="line"><a name="l07851"></a><span class="lineno"> 7851</span>&#160; </div>
<div class="line"><a name="l07852"></a><span class="lineno"> 7852</span>&#160;    <span class="comment">// Loop over all dofs</span></div>
<div class="line"><a name="l07853"></a><span class="lineno"> 7853</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> jdof = 0; jdof &lt; n_dof; jdof++)</div>
<div class="line"><a name="l07854"></a><span class="lineno"> 7854</span>&#160;    {</div>
<div class="line"><a name="l07855"></a><span class="lineno"> 7855</span>&#160;      <span class="keywordtype">double</span> backup = *<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>[jdof];</div>
<div class="line"><a name="l07856"></a><span class="lineno"> 7856</span>&#160;      *<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>[jdof] += <a class="code" href="../../d5/d65/namespaceoomph_1_1BlackBoxFDNewtonSolver.html#a6f0d2ceb4451e66bb7ef4ab4fdb62bcf">FD_step</a>;</div>
<div class="line"><a name="l07857"></a><span class="lineno"> 7857</span>&#160; </div>
<div class="line"><a name="l07858"></a><span class="lineno"> 7858</span>&#160;      <span class="comment">// We&#39;re checking if the new values for Dof_pt[] actually</span></div>
<div class="line"><a name="l07859"></a><span class="lineno"> 7859</span>&#160;      <span class="comment">// solve the entire problem --&gt; update as if problem had</span></div>
<div class="line"><a name="l07860"></a><span class="lineno"> 7860</span>&#160;      <span class="comment">// been solved</span></div>
<div class="line"><a name="l07861"></a><span class="lineno"> 7861</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a0c8d70891f7369bb4bf8412fa1a08ecb">actions_before_newton_solve</a>();</div>
<div class="line"><a name="l07862"></a><span class="lineno"> 7862</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae6ad96ddf5d48b517b89c9a9b879bc4b">actions_before_newton_convergence_check</a>();</div>
<div class="line"><a name="l07863"></a><span class="lineno"> 7863</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a033ec7301123deeb7e56d04c38f9f1da">actions_after_newton_solve</a>();</div>
<div class="line"><a name="l07864"></a><span class="lineno"> 7864</span>&#160; </div>
<div class="line"><a name="l07865"></a><span class="lineno"> 7865</span>&#160;      <span class="comment">// Get advanced residuals</span></div>
<div class="line"><a name="l07866"></a><span class="lineno"> 7866</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a0103fe1a09ecf7e23a9083b35ef07aac">get_residuals</a>(residuals_pls);</div>
<div class="line"><a name="l07867"></a><span class="lineno"> 7867</span>&#160; </div>
<div class="line"><a name="l07868"></a><span class="lineno"> 7868</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ieqn = 0; ieqn &lt; n_dof; ieqn++)</div>
<div class="line"><a name="l07869"></a><span class="lineno"> 7869</span>&#160;      {</div>
<div class="line"><a name="l07870"></a><span class="lineno"> 7870</span>&#160;        jacobian(ieqn, jdof) =</div>
<div class="line"><a name="l07871"></a><span class="lineno"> 7871</span>&#160;          (residuals_pls[ieqn] - residuals[ieqn]) / <a class="code" href="../../d5/d65/namespaceoomph_1_1BlackBoxFDNewtonSolver.html#a6f0d2ceb4451e66bb7ef4ab4fdb62bcf">FD_step</a>;</div>
<div class="line"><a name="l07872"></a><span class="lineno"> 7872</span>&#160;      }</div>
<div class="line"><a name="l07873"></a><span class="lineno"> 7873</span>&#160; </div>
<div class="line"><a name="l07874"></a><span class="lineno"> 7874</span>&#160;      *<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>[jdof] = backup;</div>
<div class="line"><a name="l07875"></a><span class="lineno"> 7875</span>&#160;    }</div>
<div class="line"><a name="l07876"></a><span class="lineno"> 7876</span>&#160; </div>
<div class="line"><a name="l07877"></a><span class="lineno"> 7877</span>&#160;    <span class="comment">// Reset problem to state it was in</span></div>
<div class="line"><a name="l07878"></a><span class="lineno"> 7878</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a0c8d70891f7369bb4bf8412fa1a08ecb">actions_before_newton_solve</a>();</div>
<div class="line"><a name="l07879"></a><span class="lineno"> 7879</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae6ad96ddf5d48b517b89c9a9b879bc4b">actions_before_newton_convergence_check</a>();</div>
<div class="line"><a name="l07880"></a><span class="lineno"> 7880</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a033ec7301123deeb7e56d04c38f9f1da">actions_after_newton_solve</a>();</div>
<div class="line"><a name="l07881"></a><span class="lineno"> 7881</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1DenseMatrix_html_adec1ef741b1c5048a12ba9a540c2719c"><div class="ttname"><a href="../../d6/d13/classoomph_1_1DenseMatrix.html#adec1ef741b1c5048a12ba9a540c2719c">oomph::DenseMatrix::resize</a></div><div class="ttdeci">void resize(const unsigned long &amp;n)</div><div class="ttdef"><b>Definition:</b> matrices.h:498</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a033ec7301123deeb7e56d04c38f9f1da">actions_after_newton_solve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae6ad96ddf5d48b517b89c9a9b879bc4b">actions_before_newton_convergence_check()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a0c8d70891f7369bb4bf8412fa1a08ecb">actions_before_newton_solve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>, <a class="el" href="../../d5/d65/namespaceoomph_1_1BlackBoxFDNewtonSolver.html#a6f0d2ceb4451e66bb7ef4ab4fdb62bcf">oomph::BlackBoxFDNewtonSolver::FD_step</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a0103fe1a09ecf7e23a9083b35ef07aac">get_residuals()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, and <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html#adec1ef741b1c5048a12ba9a540c2719c">oomph::DenseMatrix&lt; T &gt;::resize()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/d00/classoomph_1_1FD__LU.html#a6fd251bef9cdb7efbed4927f005eda2f">oomph::FD_LU::solve()</a>.</p>

</div>
</div>
<a id="a497518acb5d30a28a253890c3d2a5da2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a497518acb5d30a28a253890c3d2a5da2">&#9670;&nbsp;</a></span>get_hessian_vector_products()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::get_hessian_vector_products </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html">DoubleVectorWithHaloEntries</a> const &amp;&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html">DoubleVectorWithHaloEntries</a> &gt; const &amp;&#160;</td>
          <td class="paramname"><em>C</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html">DoubleVectorWithHaloEntries</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>product</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the product of the global hessian (derivative of Jacobian matrix with respect to all variables) with an eigenvector, Y, and any number of other specified vectors C (d(J_{ij})/d u_{k}) Y_{j} C_{k}. This function is used in assembling and solving the augmented systems associated with bifurcation tracking. The default implementation is to use finite differences at the global level. </p>
<p>Alice: My bifurcation tracking converges better with this FD_step as 1.0e-5. The default value remains at 1.0e-8.</p>
<div class="fragment"><div class="line"><a name="l07989"></a><span class="lineno"> 7989</span>&#160;  {</div>
<div class="line"><a name="l07990"></a><span class="lineno"> 7990</span>&#160;    <span class="comment">// How many vector products must we construct</span></div>
<div class="line"><a name="l07991"></a><span class="lineno"> 7991</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_vec = <a class="code" href="../../d6/d74/classoomph_1_1Matrix.html">C</a>.size();</div>
<div class="line"><a name="l07992"></a><span class="lineno"> 7992</span>&#160; </div>
<div class="line"><a name="l07993"></a><span class="lineno"> 7993</span>&#160;    <span class="comment">// currently only global (non-distributed) distributions are allowed</span></div>
<div class="line"><a name="l07994"></a><span class="lineno"> 7994</span>&#160;    <span class="comment">// LinearAlgebraDistribution* dist_pt = new</span></div>
<div class="line"><a name="l07995"></a><span class="lineno"> 7995</span>&#160;    <span class="comment">// LinearAlgebraDistribution(Communicator_pt,n_dof,false);</span></div>
<div class="line"><a name="l07996"></a><span class="lineno"> 7996</span>&#160; </div>
<div class="line"><a name="l07997"></a><span class="lineno"> 7997</span>&#160;    <span class="comment">// Cache the assembly hander</span></div>
<div class="line"><a name="l07998"></a><span class="lineno"> 7998</span>&#160;    AssemblyHandler* <span class="keyword">const</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a> = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>;</div>
<div class="line"><a name="l07999"></a><span class="lineno"> 7999</span>&#160; </div>
<div class="line"><a name="l08000"></a><span class="lineno"> 8000</span>&#160;    <span class="comment">// Rebuild the results vectors and initialise to zero</span></div>
<div class="line"><a name="l08001"></a><span class="lineno"> 8001</span>&#160;    <span class="comment">// use the same distribution of the vector Y</span></div>
<div class="line"><a name="l08002"></a><span class="lineno"> 8002</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_vec; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l08003"></a><span class="lineno"> 8003</span>&#160;    {</div>
<div class="line"><a name="l08004"></a><span class="lineno"> 8004</span>&#160;      <a class="code" href="../../dc/daa/product_8h.html#a9ea93a3bb5ed3a3517d5db341bae0238">product</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].build(<a class="code" href="../../d8/d42/test_2EulerAngles_8cpp.html#aecb7a48bf527ac0585250551f77b2657">Y</a>.distribution_pt(), 0.0);</div>
<div class="line"><a name="l08005"></a><span class="lineno"> 8005</span>&#160;      <a class="code" href="../../dc/daa/product_8h.html#a9ea93a3bb5ed3a3517d5db341bae0238">product</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].initialise(0.0);</div>
<div class="line"><a name="l08006"></a><span class="lineno"> 8006</span>&#160;    }</div>
<div class="line"><a name="l08007"></a><span class="lineno"> 8007</span>&#160; </div>
<div class="line"><a name="l08008"></a><span class="lineno"> 8008</span>&#160;<span class="comment">// Setup the halo schemes for the result</span></div>
<div class="line"><a name="l08009"></a><span class="lineno"> 8009</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l08010"></a><span class="lineno"> 8010</span>&#160;    <span class="keywordflow">if</span> (Problem_has_been_distributed)</div>
<div class="line"><a name="l08011"></a><span class="lineno"> 8011</span>&#160;    {</div>
<div class="line"><a name="l08012"></a><span class="lineno"> 8012</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_vec; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l08013"></a><span class="lineno"> 8013</span>&#160;      {</div>
<div class="line"><a name="l08014"></a><span class="lineno"> 8014</span>&#160;        <a class="code" href="../../dc/daa/product_8h.html#a9ea93a3bb5ed3a3517d5db341bae0238">product</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].build_halo_scheme(this-&gt;Halo_scheme_pt);</div>
<div class="line"><a name="l08015"></a><span class="lineno"> 8015</span>&#160;      }</div>
<div class="line"><a name="l08016"></a><span class="lineno"> 8016</span>&#160;    }</div>
<div class="line"><a name="l08017"></a><span class="lineno"> 8017</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l08018"></a><span class="lineno"> 8018</span>&#160; </div>
<div class="line"><a name="l08019"></a><span class="lineno"> 8019</span>&#160;    <span class="comment">// If we are doing the calculation analytically then call the appropriate</span></div>
<div class="line"><a name="l08020"></a><span class="lineno"> 8020</span>&#160;    <span class="comment">// handler</span></div>
<div class="line"><a name="l08021"></a><span class="lineno"> 8021</span>&#160;    <span class="comment">// A better way to do this is probably to hook into the get_residuals</span></div>
<div class="line"><a name="l08022"></a><span class="lineno"> 8022</span>&#160;    <span class="comment">// framework but with a different member function of the assembly</span></div>
<div class="line"><a name="l08023"></a><span class="lineno"> 8023</span>&#160;    <span class="comment">// handler</span></div>
<div class="line"><a name="l08024"></a><span class="lineno"> 8024</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#af6235ced9e7e85324f785f2681ab3872">are_hessian_products_calculated_analytically</a>())</div>
<div class="line"><a name="l08025"></a><span class="lineno"> 8025</span>&#160;    {</div>
<div class="line"><a name="l08026"></a><span class="lineno"> 8026</span>&#160;      <span class="comment">// Loop over all the elements</span></div>
<div class="line"><a name="l08027"></a><span class="lineno"> 8027</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> Element_pt_range = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">nelement</a>();</div>
<div class="line"><a name="l08028"></a><span class="lineno"> 8028</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; Element_pt_range; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l08029"></a><span class="lineno"> 8029</span>&#160;      {</div>
<div class="line"><a name="l08030"></a><span class="lineno"> 8030</span>&#160;        <span class="comment">// Get the pointer to the element</span></div>
<div class="line"><a name="l08031"></a><span class="lineno"> 8031</span>&#160;        GeneralisedElement* elem_pt = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">element_pt</a>(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>);</div>
<div class="line"><a name="l08032"></a><span class="lineno"> 8032</span>&#160;<span class="comment">// Do not loop over halo elements</span></div>
<div class="line"><a name="l08033"></a><span class="lineno"> 8033</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l08034"></a><span class="lineno"> 8034</span>&#160;        <span class="keywordflow">if</span> (!elem_pt-&gt;is_halo())</div>
<div class="line"><a name="l08035"></a><span class="lineno"> 8035</span>&#160;        {</div>
<div class="line"><a name="l08036"></a><span class="lineno"> 8036</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l08037"></a><span class="lineno"> 8037</span>&#160;          <span class="comment">// Find number of dofs in the element</span></div>
<div class="line"><a name="l08038"></a><span class="lineno"> 8038</span>&#160;          <span class="keywordtype">unsigned</span> n_var = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>-&gt;<a class="code" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a09213be8f4aa009e0366460a7ed78e68">ndof</a>(elem_pt);</div>
<div class="line"><a name="l08039"></a><span class="lineno"> 8039</span>&#160;          <span class="comment">// Set up a matrix for the input and output</span></div>
<div class="line"><a name="l08040"></a><span class="lineno"> 8040</span>&#160;          Vector&lt;double&gt; Y_local(n_var);</div>
<div class="line"><a name="l08041"></a><span class="lineno"> 8041</span>&#160;          <a class="code" href="../../dc/d34/classEigen_1_1Matrix.html">DenseMatrix&lt;double&gt;</a> C_local(n_vec, n_var);</div>
<div class="line"><a name="l08042"></a><span class="lineno"> 8042</span>&#160;          <a class="code" href="../../dc/d34/classEigen_1_1Matrix.html">DenseMatrix&lt;double&gt;</a> product_local(n_vec, n_var);</div>
<div class="line"><a name="l08043"></a><span class="lineno"> 8043</span>&#160; </div>
<div class="line"><a name="l08044"></a><span class="lineno"> 8044</span>&#160;          <span class="comment">// Translate the global input vectors into the local storage</span></div>
<div class="line"><a name="l08045"></a><span class="lineno"> 8045</span>&#160;          <span class="comment">// Probably horribly inefficient, but otherwise things get really</span></div>
<div class="line"><a name="l08046"></a><span class="lineno"> 8046</span>&#160;          <span class="comment">// messy at the elemental level</span></div>
<div class="line"><a name="l08047"></a><span class="lineno"> 8047</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> l = 0; l &lt; n_var; l++)</div>
<div class="line"><a name="l08048"></a><span class="lineno"> 8048</span>&#160;          {</div>
<div class="line"><a name="l08049"></a><span class="lineno"> 8049</span>&#160;            <span class="comment">// Cache the global equation number</span></div>
<div class="line"><a name="l08050"></a><span class="lineno"> 8050</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> eqn_number =</div>
<div class="line"><a name="l08051"></a><span class="lineno"> 8051</span>&#160;              <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>-&gt;<a class="code" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a94d28e2de2559cde803d1ba2195b5290">eqn_number</a>(elem_pt, l);</div>
<div class="line"><a name="l08052"></a><span class="lineno"> 8052</span>&#160; </div>
<div class="line"><a name="l08053"></a><span class="lineno"> 8053</span>&#160;            Y_local[l] = <a class="code" href="../../d8/d42/test_2EulerAngles_8cpp.html#aecb7a48bf527ac0585250551f77b2657">Y</a>.global_value(eqn_number);</div>
<div class="line"><a name="l08054"></a><span class="lineno"> 8054</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_vec; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l08055"></a><span class="lineno"> 8055</span>&#160;            {</div>
<div class="line"><a name="l08056"></a><span class="lineno"> 8056</span>&#160;              C_local(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, l) = <a class="code" href="../../d6/d74/classoomph_1_1Matrix.html">C</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].global_value(eqn_number);</div>
<div class="line"><a name="l08057"></a><span class="lineno"> 8057</span>&#160;            }</div>
<div class="line"><a name="l08058"></a><span class="lineno"> 8058</span>&#160;          }</div>
<div class="line"><a name="l08059"></a><span class="lineno"> 8059</span>&#160; </div>
<div class="line"><a name="l08060"></a><span class="lineno"> 8060</span>&#160;          <span class="comment">// Fill the array</span></div>
<div class="line"><a name="l08061"></a><span class="lineno"> 8061</span>&#160;          <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>-&gt;<a class="code" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a296bef49838d23522bb660c4c5207f03">get_hessian_vector_products</a>(</div>
<div class="line"><a name="l08062"></a><span class="lineno"> 8062</span>&#160;            elem_pt, Y_local, C_local, product_local);</div>
<div class="line"><a name="l08063"></a><span class="lineno"> 8063</span>&#160; </div>
<div class="line"><a name="l08064"></a><span class="lineno"> 8064</span>&#160;          <span class="comment">// Assign the local results to the global vector</span></div>
<div class="line"><a name="l08065"></a><span class="lineno"> 8065</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> l = 0; l &lt; n_var; l++)</div>
<div class="line"><a name="l08066"></a><span class="lineno"> 8066</span>&#160;          {</div>
<div class="line"><a name="l08067"></a><span class="lineno"> 8067</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> eqn_number =</div>
<div class="line"><a name="l08068"></a><span class="lineno"> 8068</span>&#160;              <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>-&gt;<a class="code" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a94d28e2de2559cde803d1ba2195b5290">eqn_number</a>(elem_pt, l);</div>
<div class="line"><a name="l08069"></a><span class="lineno"> 8069</span>&#160; </div>
<div class="line"><a name="l08070"></a><span class="lineno"> 8070</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_vec; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l08071"></a><span class="lineno"> 8071</span>&#160;            {</div>
<div class="line"><a name="l08072"></a><span class="lineno"> 8072</span>&#160;              <a class="code" href="../../dc/daa/product_8h.html#a9ea93a3bb5ed3a3517d5db341bae0238">product</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].global_value(eqn_number) += product_local(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, l);</div>
<div class="line"><a name="l08073"></a><span class="lineno"> 8073</span>&#160;              <span class="comment">// std::cout &lt;&lt; &quot;BLA &quot; &lt;&lt; e &lt;&lt; &quot; &quot; &lt;&lt; i &lt;&lt; &quot; &quot;</span></div>
<div class="line"><a name="l08074"></a><span class="lineno"> 8074</span>&#160;              <span class="comment">//          &lt;&lt; l &lt;&lt; &quot; &quot; &lt;&lt; product_local(i,l) &lt;&lt; &quot;\n&quot;;</span></div>
<div class="line"><a name="l08075"></a><span class="lineno"> 8075</span>&#160;            }</div>
<div class="line"><a name="l08076"></a><span class="lineno"> 8076</span>&#160;          }</div>
<div class="line"><a name="l08077"></a><span class="lineno"> 8077</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l08078"></a><span class="lineno"> 8078</span>&#160;        }</div>
<div class="line"><a name="l08079"></a><span class="lineno"> 8079</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l08080"></a><span class="lineno"> 8080</span>&#160;      }</div>
<div class="line"><a name="l08081"></a><span class="lineno"> 8081</span>&#160;    }</div>
<div class="line"><a name="l08082"></a><span class="lineno"> 8082</span>&#160;    <span class="comment">// Otherwise calculate using finite differences by</span></div>
<div class="line"><a name="l08083"></a><span class="lineno"> 8083</span>&#160;    <span class="comment">// perturbing the jacobian along a particular direction</span></div>
<div class="line"><a name="l08084"></a><span class="lineno"> 8084</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l08085"></a><span class="lineno"> 8085</span>&#160;    {</div>
<div class="line"><a name="l08086"></a><span class="lineno"> 8086</span>&#160;      <span class="comment">// Cache the finite difference step</span></div>
<div class="line"><a name="l08089"></a><span class="lineno"> 8089</span>&#160;<span class="comment"></span>      <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="../../d5/d65/namespaceoomph_1_1BlackBoxFDNewtonSolver.html#a6f0d2ceb4451e66bb7ef4ab4fdb62bcf">FD_step</a> = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad26c62f5aab816943144ac61fbf7725e">FD_step_used_in_get_hessian_vector_products</a>;</div>
<div class="line"><a name="l08090"></a><span class="lineno"> 8090</span>&#160; </div>
<div class="line"><a name="l08091"></a><span class="lineno"> 8091</span>&#160;      <span class="comment">// We can now construct our multipliers</span></div>
<div class="line"><a name="l08092"></a><span class="lineno"> 8092</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_dof_local = this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">nrow_local</a>();</div>
<div class="line"><a name="l08093"></a><span class="lineno"> 8093</span>&#160;      <span class="comment">// Prepare to scale</span></div>
<div class="line"><a name="l08094"></a><span class="lineno"> 8094</span>&#160;      <span class="keywordtype">double</span> dof_length = 0.0;</div>
<div class="line"><a name="l08095"></a><span class="lineno"> 8095</span>&#160;      Vector&lt;double&gt; C_length(n_vec, 0.0);</div>
<div class="line"><a name="l08096"></a><span class="lineno"> 8096</span>&#160; </div>
<div class="line"><a name="l08097"></a><span class="lineno"> 8097</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_dof_local; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l08098"></a><span class="lineno"> 8098</span>&#160;      {</div>
<div class="line"><a name="l08099"></a><span class="lineno"> 8099</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">std::fabs</a>(this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a74d71439b100fb5b66b94d1d69130f7c">dof</a>(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>)) &gt; dof_length)</div>
<div class="line"><a name="l08100"></a><span class="lineno"> 8100</span>&#160;        {</div>
<div class="line"><a name="l08101"></a><span class="lineno"> 8101</span>&#160;          dof_length = <a class="code" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">std::fabs</a>(this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a74d71439b100fb5b66b94d1d69130f7c">dof</a>(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>));</div>
<div class="line"><a name="l08102"></a><span class="lineno"> 8102</span>&#160;        }</div>
<div class="line"><a name="l08103"></a><span class="lineno"> 8103</span>&#160;      }</div>
<div class="line"><a name="l08104"></a><span class="lineno"> 8104</span>&#160; </div>
<div class="line"><a name="l08105"></a><span class="lineno"> 8105</span>&#160;      <span class="comment">// C is assumed to have the same distribution as the dofs</span></div>
<div class="line"><a name="l08106"></a><span class="lineno"> 8106</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_vec; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l08107"></a><span class="lineno"> 8107</span>&#160;      {</div>
<div class="line"><a name="l08108"></a><span class="lineno"> 8108</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_dof_local; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l08109"></a><span class="lineno"> 8109</span>&#160;        {</div>
<div class="line"><a name="l08110"></a><span class="lineno"> 8110</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">std::fabs</a>(<a class="code" href="../../d6/d74/classoomph_1_1Matrix.html">C</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>]) &gt; C_length[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><a name="l08111"></a><span class="lineno"> 8111</span>&#160;          {</div>
<div class="line"><a name="l08112"></a><span class="lineno"> 8112</span>&#160;            C_length[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">std::fabs</a>(<a class="code" href="../../d6/d74/classoomph_1_1Matrix.html">C</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>]);</div>
<div class="line"><a name="l08113"></a><span class="lineno"> 8113</span>&#160;          }</div>
<div class="line"><a name="l08114"></a><span class="lineno"> 8114</span>&#160;        }</div>
<div class="line"><a name="l08115"></a><span class="lineno"> 8115</span>&#160;      }</div>
<div class="line"><a name="l08116"></a><span class="lineno"> 8116</span>&#160; </div>
<div class="line"><a name="l08117"></a><span class="lineno"> 8117</span>&#160;      <span class="comment">// Now broadcast the information, if distributed</span></div>
<div class="line"><a name="l08118"></a><span class="lineno"> 8118</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l08119"></a><span class="lineno"> 8119</span>&#160;      <span class="keywordflow">if</span> (Problem_has_been_distributed)</div>
<div class="line"><a name="l08120"></a><span class="lineno"> 8120</span>&#160;      {</div>
<div class="line"><a name="l08121"></a><span class="lineno"> 8121</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_length = n_vec + 1;</div>
<div class="line"><a name="l08122"></a><span class="lineno"> 8122</span>&#160;        <span class="keywordtype">double</span> all_length[n_length];</div>
<div class="line"><a name="l08123"></a><span class="lineno"> 8123</span>&#160;        all_length[0] = dof_length;</div>
<div class="line"><a name="l08124"></a><span class="lineno"> 8124</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_vec; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l08125"></a><span class="lineno"> 8125</span>&#160;        {</div>
<div class="line"><a name="l08126"></a><span class="lineno"> 8126</span>&#160;          all_length[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1] = C_length[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l08127"></a><span class="lineno"> 8127</span>&#160;        }</div>
<div class="line"><a name="l08128"></a><span class="lineno"> 8128</span>&#160; </div>
<div class="line"><a name="l08129"></a><span class="lineno"> 8129</span>&#160;        <span class="comment">// Do the MPI call</span></div>
<div class="line"><a name="l08130"></a><span class="lineno"> 8130</span>&#160;        <span class="keywordtype">double</span> all_length_reduce[n_length];</div>
<div class="line"><a name="l08131"></a><span class="lineno"> 8131</span>&#160;        MPI_Allreduce(all_length,</div>
<div class="line"><a name="l08132"></a><span class="lineno"> 8132</span>&#160;                      all_length_reduce,</div>
<div class="line"><a name="l08133"></a><span class="lineno"> 8133</span>&#160;                      n_length,</div>
<div class="line"><a name="l08134"></a><span class="lineno"> 8134</span>&#160;                      MPI_DOUBLE,</div>
<div class="line"><a name="l08135"></a><span class="lineno"> 8135</span>&#160;                      MPI_MAX,</div>
<div class="line"><a name="l08136"></a><span class="lineno"> 8136</span>&#160;                      this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">communicator_pt</a>()-&gt;mpi_comm());</div>
<div class="line"><a name="l08137"></a><span class="lineno"> 8137</span>&#160; </div>
<div class="line"><a name="l08138"></a><span class="lineno"> 8138</span>&#160;        <span class="comment">// Read out the information</span></div>
<div class="line"><a name="l08139"></a><span class="lineno"> 8139</span>&#160;        dof_length = all_length_reduce[0];</div>
<div class="line"><a name="l08140"></a><span class="lineno"> 8140</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_vec; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l08141"></a><span class="lineno"> 8141</span>&#160;        {</div>
<div class="line"><a name="l08142"></a><span class="lineno"> 8142</span>&#160;          C_length[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = all_length_reduce[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1];</div>
<div class="line"><a name="l08143"></a><span class="lineno"> 8143</span>&#160;        }</div>
<div class="line"><a name="l08144"></a><span class="lineno"> 8144</span>&#160;      }</div>
<div class="line"><a name="l08145"></a><span class="lineno"> 8145</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l08146"></a><span class="lineno"> 8146</span>&#160; </div>
<div class="line"><a name="l08147"></a><span class="lineno"> 8147</span>&#160;      <span class="comment">// Form the multipliers</span></div>
<div class="line"><a name="l08148"></a><span class="lineno"> 8148</span>&#160;      Vector&lt;double&gt; C_mult(n_vec, 0.0);</div>
<div class="line"><a name="l08149"></a><span class="lineno"> 8149</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_vec; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l08150"></a><span class="lineno"> 8150</span>&#160;      {</div>
<div class="line"><a name="l08151"></a><span class="lineno"> 8151</span>&#160;        C_mult[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = dof_length / C_length[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l08152"></a><span class="lineno"> 8152</span>&#160;        C_mult[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] += <a class="code" href="../../d5/d65/namespaceoomph_1_1BlackBoxFDNewtonSolver.html#a6f0d2ceb4451e66bb7ef4ab4fdb62bcf">FD_step</a>;</div>
<div class="line"><a name="l08153"></a><span class="lineno"> 8153</span>&#160;        C_mult[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] *= <a class="code" href="../../d5/d65/namespaceoomph_1_1BlackBoxFDNewtonSolver.html#a6f0d2ceb4451e66bb7ef4ab4fdb62bcf">FD_step</a>;</div>
<div class="line"><a name="l08154"></a><span class="lineno"> 8154</span>&#160;      }</div>
<div class="line"><a name="l08155"></a><span class="lineno"> 8155</span>&#160; </div>
<div class="line"><a name="l08156"></a><span class="lineno"> 8156</span>&#160; </div>
<div class="line"><a name="l08157"></a><span class="lineno"> 8157</span>&#160;      <span class="comment">// Dummy vector to stand in the place of the residuals</span></div>
<div class="line"><a name="l08158"></a><span class="lineno"> 8158</span>&#160;      Vector&lt;double&gt; dummy_res;</div>
<div class="line"><a name="l08159"></a><span class="lineno"> 8159</span>&#160; </div>
<div class="line"><a name="l08160"></a><span class="lineno"> 8160</span>&#160;      <span class="comment">// Calculate the product of the jacobian matrices, etc by looping over the</span></div>
<div class="line"><a name="l08161"></a><span class="lineno"> 8161</span>&#160;      <span class="comment">// elements</span></div>
<div class="line"><a name="l08162"></a><span class="lineno"> 8162</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n_element = this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>()-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">nelement</a>();</div>
<div class="line"><a name="l08163"></a><span class="lineno"> 8163</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; n_element; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l08164"></a><span class="lineno"> 8164</span>&#160;      {</div>
<div class="line"><a name="l08165"></a><span class="lineno"> 8165</span>&#160;        GeneralisedElement* elem_pt = this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>()-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">element_pt</a>(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>);</div>
<div class="line"><a name="l08166"></a><span class="lineno"> 8166</span>&#160;        <span class="comment">// Ignore halo&#39;s of course</span></div>
<div class="line"><a name="l08167"></a><span class="lineno"> 8167</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l08168"></a><span class="lineno"> 8168</span>&#160;        <span class="keywordflow">if</span> (!elem_pt-&gt;is_halo())</div>
<div class="line"><a name="l08169"></a><span class="lineno"> 8169</span>&#160;        {</div>
<div class="line"><a name="l08170"></a><span class="lineno"> 8170</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l08171"></a><span class="lineno"> 8171</span>&#160;          <span class="comment">// Loop over the ndofs in each element</span></div>
<div class="line"><a name="l08172"></a><span class="lineno"> 8172</span>&#160;          <span class="keywordtype">unsigned</span> n_var = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>-&gt;<a class="code" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a09213be8f4aa009e0366460a7ed78e68">ndof</a>(elem_pt);</div>
<div class="line"><a name="l08173"></a><span class="lineno"> 8173</span>&#160;          <span class="comment">// Resize the dummy residuals vector</span></div>
<div class="line"><a name="l08174"></a><span class="lineno"> 8174</span>&#160;          dummy_res.resize(n_var);</div>
<div class="line"><a name="l08175"></a><span class="lineno"> 8175</span>&#160;          <span class="comment">// Allocate storage for the unperturbed jacobian matrix</span></div>
<div class="line"><a name="l08176"></a><span class="lineno"> 8176</span>&#160;          <a class="code" href="../../dc/d34/classEigen_1_1Matrix.html">DenseMatrix&lt;double&gt;</a> jac(n_var);</div>
<div class="line"><a name="l08177"></a><span class="lineno"> 8177</span>&#160;          <span class="comment">// Get unperturbed jacobian</span></div>
<div class="line"><a name="l08178"></a><span class="lineno"> 8178</span>&#160;          <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>-&gt;<a class="code" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#ad43c3d8760be0ba6ebee8d82509458e5">get_jacobian</a>(elem_pt, dummy_res, jac);</div>
<div class="line"><a name="l08179"></a><span class="lineno"> 8179</span>&#160; </div>
<div class="line"><a name="l08180"></a><span class="lineno"> 8180</span>&#160;          <span class="comment">// Backup the dofs</span></div>
<div class="line"><a name="l08181"></a><span class="lineno"> 8181</span>&#160;          Vector&lt;double&gt; dof_bac(n_var);</div>
<div class="line"><a name="l08182"></a><span class="lineno"> 8182</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_var; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l08183"></a><span class="lineno"> 8183</span>&#160;          {</div>
<div class="line"><a name="l08184"></a><span class="lineno"> 8184</span>&#160;            <span class="keywordtype">unsigned</span> eqn_number = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>-&gt;<a class="code" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a94d28e2de2559cde803d1ba2195b5290">eqn_number</a>(elem_pt, <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>);</div>
<div class="line"><a name="l08185"></a><span class="lineno"> 8185</span>&#160;            dof_bac[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>] = *this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a491354401f780ccc114ceb76f5cacef0">global_dof_pt</a>(eqn_number);</div>
<div class="line"><a name="l08186"></a><span class="lineno"> 8186</span>&#160;          }</div>
<div class="line"><a name="l08187"></a><span class="lineno"> 8187</span>&#160; </div>
<div class="line"><a name="l08188"></a><span class="lineno"> 8188</span>&#160;          <span class="comment">// Now loop over all vectors C</span></div>
<div class="line"><a name="l08189"></a><span class="lineno"> 8189</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_vec; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l08190"></a><span class="lineno"> 8190</span>&#160;          {</div>
<div class="line"><a name="l08191"></a><span class="lineno"> 8191</span>&#160;            <span class="comment">// Perturb the dofs by the appropriate vector</span></div>
<div class="line"><a name="l08192"></a><span class="lineno"> 8192</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_var; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l08193"></a><span class="lineno"> 8193</span>&#160;            {</div>
<div class="line"><a name="l08194"></a><span class="lineno"> 8194</span>&#160;              <span class="keywordtype">unsigned</span> eqn_number = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>-&gt;<a class="code" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a94d28e2de2559cde803d1ba2195b5290">eqn_number</a>(elem_pt, <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>);</div>
<div class="line"><a name="l08195"></a><span class="lineno"> 8195</span>&#160;              <span class="comment">// Perturb by vector C[i]</span></div>
<div class="line"><a name="l08196"></a><span class="lineno"> 8196</span>&#160;              *this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a491354401f780ccc114ceb76f5cacef0">global_dof_pt</a>(eqn_number) +=</div>
<div class="line"><a name="l08197"></a><span class="lineno"> 8197</span>&#160;                C_mult[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] * <a class="code" href="../../d6/d74/classoomph_1_1Matrix.html">C</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].global_value(eqn_number);</div>
<div class="line"><a name="l08198"></a><span class="lineno"> 8198</span>&#160;            }</div>
<div class="line"><a name="l08199"></a><span class="lineno"> 8199</span>&#160;            <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae6ad96ddf5d48b517b89c9a9b879bc4b">actions_before_newton_convergence_check</a>();</div>
<div class="line"><a name="l08200"></a><span class="lineno"> 8200</span>&#160; </div>
<div class="line"><a name="l08201"></a><span class="lineno"> 8201</span>&#160;            <span class="comment">// Allocate storage for the perturbed jacobian</span></div>
<div class="line"><a name="l08202"></a><span class="lineno"> 8202</span>&#160;            <a class="code" href="../../dc/d34/classEigen_1_1Matrix.html">DenseMatrix&lt;double&gt;</a> jac_C(n_var);</div>
<div class="line"><a name="l08203"></a><span class="lineno"> 8203</span>&#160; </div>
<div class="line"><a name="l08204"></a><span class="lineno"> 8204</span>&#160;            <span class="comment">// Now get the new jacobian</span></div>
<div class="line"><a name="l08205"></a><span class="lineno"> 8205</span>&#160;            <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>-&gt;<a class="code" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#ad43c3d8760be0ba6ebee8d82509458e5">get_jacobian</a>(elem_pt, dummy_res, jac_C);</div>
<div class="line"><a name="l08206"></a><span class="lineno"> 8206</span>&#160; </div>
<div class="line"><a name="l08207"></a><span class="lineno"> 8207</span>&#160;            <span class="comment">// Reset the dofs</span></div>
<div class="line"><a name="l08208"></a><span class="lineno"> 8208</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_var; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l08209"></a><span class="lineno"> 8209</span>&#160;            {</div>
<div class="line"><a name="l08210"></a><span class="lineno"> 8210</span>&#160;              <span class="keywordtype">unsigned</span> eqn_number = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>-&gt;<a class="code" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a94d28e2de2559cde803d1ba2195b5290">eqn_number</a>(elem_pt, <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>);</div>
<div class="line"><a name="l08211"></a><span class="lineno"> 8211</span>&#160;              *this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a491354401f780ccc114ceb76f5cacef0">global_dof_pt</a>(eqn_number) = dof_bac[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>];</div>
<div class="line"><a name="l08212"></a><span class="lineno"> 8212</span>&#160;            }</div>
<div class="line"><a name="l08213"></a><span class="lineno"> 8213</span>&#160;            <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae6ad96ddf5d48b517b89c9a9b879bc4b">actions_before_newton_convergence_check</a>();</div>
<div class="line"><a name="l08214"></a><span class="lineno"> 8214</span>&#160; </div>
<div class="line"><a name="l08215"></a><span class="lineno"> 8215</span>&#160;            <span class="comment">// Now work out the products</span></div>
<div class="line"><a name="l08216"></a><span class="lineno"> 8216</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_var; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l08217"></a><span class="lineno"> 8217</span>&#160;            {</div>
<div class="line"><a name="l08218"></a><span class="lineno"> 8218</span>&#160;              <span class="keywordtype">unsigned</span> eqn_number = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>-&gt;<a class="code" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a94d28e2de2559cde803d1ba2195b5290">eqn_number</a>(elem_pt, <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>);</div>
<div class="line"><a name="l08219"></a><span class="lineno"> 8219</span>&#160;              <span class="keywordtype">double</span> prod_c = 0.0;</div>
<div class="line"><a name="l08220"></a><span class="lineno"> 8220</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> = 0; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> &lt; n_var; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>++)</div>
<div class="line"><a name="l08221"></a><span class="lineno"> 8221</span>&#160;              {</div>
<div class="line"><a name="l08222"></a><span class="lineno"> 8222</span>&#160;                <span class="keywordtype">unsigned</span> unknown = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>-&gt;<a class="code" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a94d28e2de2559cde803d1ba2195b5290">eqn_number</a>(elem_pt, <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>);</div>
<div class="line"><a name="l08223"></a><span class="lineno"> 8223</span>&#160;                prod_c += (jac_C(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>, <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>) - jac(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>, <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>)) * <a class="code" href="../../d8/d42/test_2EulerAngles_8cpp.html#aecb7a48bf527ac0585250551f77b2657">Y</a>.global_value(unknown);</div>
<div class="line"><a name="l08224"></a><span class="lineno"> 8224</span>&#160;              }</div>
<div class="line"><a name="l08225"></a><span class="lineno"> 8225</span>&#160;              <span class="comment">// std::cout &lt;&lt; &quot;FD   &quot; &lt;&lt; e &lt;&lt; &quot; &quot; &lt;&lt; i &lt;&lt; &quot; &quot;</span></div>
<div class="line"><a name="l08226"></a><span class="lineno"> 8226</span>&#160;              <span class="comment">//          &lt;&lt; n &lt;&lt; &quot; &quot; &lt;&lt; prod_c/C_mult[i] &lt;&lt; &quot;\n&quot;;</span></div>
<div class="line"><a name="l08227"></a><span class="lineno"> 8227</span>&#160;              <a class="code" href="../../dc/daa/product_8h.html#a9ea93a3bb5ed3a3517d5db341bae0238">product</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].global_value(eqn_number) += prod_c / C_mult[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l08228"></a><span class="lineno"> 8228</span>&#160;            }</div>
<div class="line"><a name="l08229"></a><span class="lineno"> 8229</span>&#160;          }</div>
<div class="line"><a name="l08230"></a><span class="lineno"> 8230</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l08231"></a><span class="lineno"> 8231</span>&#160;        }</div>
<div class="line"><a name="l08232"></a><span class="lineno"> 8232</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l08233"></a><span class="lineno"> 8233</span>&#160;      } <span class="comment">// End of loop over elements</span></div>
<div class="line"><a name="l08234"></a><span class="lineno"> 8234</span>&#160;    }</div>
<div class="line"><a name="l08235"></a><span class="lineno"> 8235</span>&#160; </div>
<div class="line"><a name="l08236"></a><span class="lineno"> 8236</span>&#160;    <span class="comment">// If we have a distributed problem then gather all</span></div>
<div class="line"><a name="l08237"></a><span class="lineno"> 8237</span>&#160;    <span class="comment">// values</span></div>
<div class="line"><a name="l08238"></a><span class="lineno"> 8238</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l08239"></a><span class="lineno"> 8239</span>&#160;    <span class="keywordflow">if</span> (Problem_has_been_distributed)</div>
<div class="line"><a name="l08240"></a><span class="lineno"> 8240</span>&#160;    {</div>
<div class="line"><a name="l08241"></a><span class="lineno"> 8241</span>&#160;      <span class="comment">// Sum all values if distributed</span></div>
<div class="line"><a name="l08242"></a><span class="lineno"> 8242</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_vec; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l08243"></a><span class="lineno"> 8243</span>&#160;      {</div>
<div class="line"><a name="l08244"></a><span class="lineno"> 8244</span>&#160;        <a class="code" href="../../dc/daa/product_8h.html#a9ea93a3bb5ed3a3517d5db341bae0238">product</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].sum_all_halo_and_haloed_values();</div>
<div class="line"><a name="l08245"></a><span class="lineno"> 8245</span>&#160;      }</div>
<div class="line"><a name="l08246"></a><span class="lineno"> 8246</span>&#160;    }</div>
<div class="line"><a name="l08247"></a><span class="lineno"> 8247</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l08248"></a><span class="lineno"> 8248</span>&#160;  }</div>
<div class="ttc" id="aclassEigen_1_1Matrix_html"><div class="ttname"><a href="../../dc/d34/classEigen_1_1Matrix.html">Eigen::Matrix&lt; Scalar, Dynamic, Dynamic &gt;</a></div></div>
<div class="ttc" id="aclassoomph_1_1AssemblyHandler_html_a09213be8f4aa009e0366460a7ed78e68"><div class="ttname"><a href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a09213be8f4aa009e0366460a7ed78e68">oomph::AssemblyHandler::ndof</a></div><div class="ttdeci">virtual unsigned ndof(GeneralisedElement *const &amp;elem_pt)</div><div class="ttdoc">Return the number of degrees of freedom in the element elem_pt.</div><div class="ttdef"><b>Definition:</b> assembly_handler.cc:42</div></div>
<div class="ttc" id="aclassoomph_1_1AssemblyHandler_html_a296bef49838d23522bb660c4c5207f03"><div class="ttname"><a href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a296bef49838d23522bb660c4c5207f03">oomph::AssemblyHandler::get_hessian_vector_products</a></div><div class="ttdeci">virtual void get_hessian_vector_products(GeneralisedElement *const &amp;elem_pt, Vector&lt; double &gt; const &amp;Y, DenseMatrix&lt; double &gt; const &amp;C, DenseMatrix&lt; double &gt; &amp;product)</div><div class="ttdef"><b>Definition:</b> assembly_handler.cc:153</div></div>
<div class="ttc" id="aclassoomph_1_1AssemblyHandler_html_a94d28e2de2559cde803d1ba2195b5290"><div class="ttname"><a href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a94d28e2de2559cde803d1ba2195b5290">oomph::AssemblyHandler::eqn_number</a></div><div class="ttdeci">virtual unsigned long eqn_number(GeneralisedElement *const &amp;elem_pt, const unsigned &amp;ieqn_local)</div><div class="ttdef"><b>Definition:</b> assembly_handler.cc:82</div></div>
<div class="ttc" id="aclassoomph_1_1AssemblyHandler_html_ad43c3d8760be0ba6ebee8d82509458e5"><div class="ttname"><a href="../../d4/db6/classoomph_1_1AssemblyHandler.html#ad43c3d8760be0ba6ebee8d82509458e5">oomph::AssemblyHandler::get_jacobian</a></div><div class="ttdeci">virtual void get_jacobian(GeneralisedElement *const &amp;elem_pt, Vector&lt; double &gt; &amp;residuals, DenseMatrix&lt; double &gt; &amp;jacobian)</div><div class="ttdef"><b>Definition:</b> assembly_handler.cc:102</div></div>
<div class="ttc" id="aclassoomph_1_1Matrix_html"><div class="ttname"><a href="../../d6/d74/classoomph_1_1Matrix.html">oomph::Matrix</a></div><div class="ttdef"><b>Definition:</b> matrices.h:74</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a491354401f780ccc114ceb76f5cacef0"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a491354401f780ccc114ceb76f5cacef0">oomph::Problem::global_dof_pt</a></div><div class="ttdeci">double * global_dof_pt(const unsigned &amp;i)</div><div class="ttdef"><b>Definition:</b> problem.h:1764</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_af6235ced9e7e85324f785f2681ab3872"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#af6235ced9e7e85324f785f2681ab3872">oomph::Problem::are_hessian_products_calculated_analytically</a></div><div class="ttdeci">bool are_hessian_products_calculated_analytically()</div><div class="ttdef"><b>Definition:</b> problem.h:303</div></div>
<div class="ttc" id="aproduct_8h_html_a9ea93a3bb5ed3a3517d5db341bae0238"><div class="ttname"><a href="../../dc/daa/product_8h.html#a9ea93a3bb5ed3a3517d5db341bae0238">product</a></div><div class="ttdeci">void product(const MatrixType &amp;m)</div><div class="ttdef"><b>Definition:</b> product.h:42</div></div>
<div class="ttc" id="atest_2EulerAngles_8cpp_html_aecb7a48bf527ac0585250551f77b2657"><div class="ttname"><a href="../../d8/d42/test_2EulerAngles_8cpp.html#aecb7a48bf527ac0585250551f77b2657">Y</a></div><div class="ttdeci">const char Y</div><div class="ttdef"><b>Definition:</b> test/EulerAngles.cpp:32</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae6ad96ddf5d48b517b89c9a9b879bc4b">actions_before_newton_convergence_check()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af6235ced9e7e85324f785f2681ab3872">are_hessian_products_calculated_analytically()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">communicator_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a74d71439b100fb5b66b94d1d69130f7c">dof()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>, <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">oomph::Mesh::element_pt()</a>, <a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a94d28e2de2559cde803d1ba2195b5290">oomph::AssemblyHandler::eqn_number()</a>, <a class="el" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">boost::multiprecision::fabs()</a>, <a class="el" href="../../d5/d65/namespaceoomph_1_1BlackBoxFDNewtonSolver.html#a6f0d2ceb4451e66bb7ef4ab4fdb62bcf">oomph::BlackBoxFDNewtonSolver::FD_step</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad26c62f5aab816943144ac61fbf7725e">FD_step_used_in_get_hessian_vector_products</a>, <a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a296bef49838d23522bb660c4c5207f03">oomph::AssemblyHandler::get_hessian_vector_products()</a>, <a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#ad43c3d8760be0ba6ebee8d82509458e5">oomph::AssemblyHandler::get_jacobian()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a491354401f780ccc114ceb76f5cacef0">global_dof_pt()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt()</a>, <a class="el" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>, <a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a09213be8f4aa009e0366460a7ed78e68">oomph::AssemblyHandler::ndof()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">oomph::Mesh::nelement()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">oomph::LinearAlgebraDistribution::nrow_local()</a>, <a class="el" href="../../dc/daa/product_8h.html#a9ea93a3bb5ed3a3517d5db341bae0238">product()</a>, and <a class="el" href="../../d8/d42/test_2EulerAngles_8cpp.html#aecb7a48bf527ac0585250551f77b2657">Y</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a9a424fd2ae0b67ef8c3ff59f16030786">oomph::BlockPitchForkLinearSolver::resolve()</a>, and <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#ad196867613954a8fabd318b50e2aadc6">oomph::BlockPitchForkLinearSolver::solve()</a>.</p>

</div>
</div>
<a id="a5ee48c16fce89952a019a844ac386655"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ee48c16fce89952a019a844ac386655">&#9670;&nbsp;</a></span>get_inverse_mass_matrix_times_residuals()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::get_inverse_mass_matrix_times_residuals </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;&#160;</td>
          <td class="paramname"><em>Mres</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Return the residual vector multiplied by the inverse mass matrix Virtual so that it can be overloaded for mpi problems </p>
<div class="fragment"><div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;  {</div>
<div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;    <span class="comment">// This function does not make sense for assembly handlers other than the</span></div>
<div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;    <span class="comment">// default, so complain if we try to call it with another handler</span></div>
<div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160; </div>
<div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;    <span class="comment">// If we are not the default, then complain</span></div>
<div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>() != <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae0cebe288c8daddd9663bd10d8f1caa0">Default_assembly_handler_pt</a>)</div>
<div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;    {</div>
<div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;      std::ostringstream error_stream;</div>
<div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;      error_stream &lt;&lt; <span class="stringliteral">&quot;The function get_inverse_mass_matrix_times_residuals() &quot;</span></div>
<div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;                      <span class="stringliteral">&quot;can only be\n&quot;</span></div>
<div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;used with the default assembly handler\n\n&quot;</span>;</div>
<div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;        error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;    }</div>
<div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160; </div>
<div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;    <span class="comment">// Find the number of degrees of freedom in the problem</span></div>
<div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_dof = this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>();</div>
<div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160; </div>
<div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;    <span class="comment">// Resize the vector</span></div>
<div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;    LinearAlgebraDistribution dist(this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">communicator_pt</a>(), n_dof, <span class="keyword">false</span>);</div>
<div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;    Mres.build(&amp;dist, 0.0);</div>
<div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160; </div>
<div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;    <span class="comment">// If we have discontinuous formulation</span></div>
<div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;    <span class="comment">// We can invert the mass matrix element by element</span></div>
<div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a97ca0078fff6adca318835c11503dc2d">Discontinuous_element_formulation</a>)</div>
<div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;    {</div>
<div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;      <span class="comment">// Loop over the elements and get their residuals</span></div>
<div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_element = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">Problem::mesh_pt</a>()-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">nelement</a>();</div>
<div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;      Vector&lt;double&gt; element_Mres;</div>
<div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; n_element; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;      {</div>
<div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;        <span class="comment">// Cache the element</span></div>
<div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;        DGElement* <span class="keyword">const</span> elem_pt =</div>
<div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;          <span class="keyword">dynamic_cast&lt;</span>DGElement*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">Problem::mesh_pt</a>()-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">element_pt</a>(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>));</div>
<div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160; </div>
<div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;        <span class="comment">// Find the elemental inverse mass matrix times residuals</span></div>
<div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_el_dofs = elem_pt-&gt;ndof();</div>
<div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;        elem_pt-&gt;get_inverse_mass_matrix_times_residuals(element_Mres);</div>
<div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160; </div>
<div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;        <span class="comment">// Add contribution to global matrix</span></div>
<div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_el_dofs; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;        {</div>
<div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;          Mres[elem_pt-&gt;eqn_number(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)] = element_Mres[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;        }</div>
<div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;      }</div>
<div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;    }</div>
<div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;    <span class="comment">// Otherwise it&#39;s continous and we must invert the full</span></div>
<div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;    <span class="comment">// mass matrix via a global linear solve.</span></div>
<div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;    {</div>
<div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;      <span class="comment">// Now do the linear solve -- recycling Mass matrix if requested</span></div>
<div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;      <span class="comment">// If we already have the factorised mass matrix, then resolve</span></div>
<div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#af4d25809ac090102a4d4a398e4ad0e26">Mass_matrix_reuse_is_enabled</a> &amp;&amp; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a6067c6d344363a073fb8d02a99fb7ed0">Mass_matrix_has_been_computed</a>)</div>
<div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;      {</div>
<div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab4a3743c23a2d1eed56981484636c958">Shut_up_in_newton_solve</a>)</div>
<div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;        {</div>
<div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Not recomputing Mass Matrix &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;        }</div>
<div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160; </div>
<div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;        <span class="comment">// Get the residuals</span></div>
<div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;        <a class="code" href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a> residuals(&amp;dist, 0.0);</div>
<div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;        this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a0103fe1a09ecf7e23a9083b35ef07aac">get_residuals</a>(residuals);</div>
<div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160; </div>
<div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;        <span class="comment">// Resolve the linear system</span></div>
<div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;        this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a93304d0c6be1022b944f21c0f4c07eab">mass_matrix_solver_for_explicit_timestepper_pt</a>()-&gt;<a class="code" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a3b310d08333033edc119b2a5bd7dcbfb">resolve</a>(</div>
<div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;          residuals, Mres);</div>
<div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;      }</div>
<div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;      <span class="comment">// Otherwise solve for the first time</span></div>
<div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;      {</div>
<div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;        <span class="comment">// If we wish to reuse the mass matrix, then enable resolve</span></div>
<div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#af4d25809ac090102a4d4a398e4ad0e26">Mass_matrix_reuse_is_enabled</a>)</div>
<div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;        {</div>
<div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;          <span class="keywordflow">if</span> (!<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab4a3743c23a2d1eed56981484636c958">Shut_up_in_newton_solve</a>)</div>
<div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;          {</div>
<div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;            <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Enabling resolve in explicit timestep&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;          }</div>
<div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;          this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a93304d0c6be1022b944f21c0f4c07eab">mass_matrix_solver_for_explicit_timestepper_pt</a>()</div>
<div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;            -&gt;<a class="code" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a3000ebd9becb3468d8a6a821a9cc0cd9">enable_resolve</a>();</div>
<div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;        }</div>
<div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160; </div>
<div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;        <span class="comment">// Use a custom assembly handler to assemble and invert the mass matrix</span></div>
<div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160; </div>
<div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;        <span class="comment">// Store the old assembly handler</span></div>
<div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;        AssemblyHandler* old_assembly_handler_pt = this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>();</div>
<div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;        <span class="comment">// Set the assembly handler to the explicit timestep handler</span></div>
<div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;        this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>() = <span class="keyword">new</span> ExplicitTimeStepHandler;</div>
<div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160; </div>
<div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;        <span class="comment">// Solve the linear system</span></div>
<div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;        this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a93304d0c6be1022b944f21c0f4c07eab">mass_matrix_solver_for_explicit_timestepper_pt</a>()-&gt;<a class="code" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a15ce22542b74ed1826ea485edacbeb6e">solve</a>(<span class="keyword">this</span>,</div>
<div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;                                                                      Mres);</div>
<div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;        <span class="comment">// The mass matrix has now been computed</span></div>
<div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a6067c6d344363a073fb8d02a99fb7ed0">Mass_matrix_has_been_computed</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160; </div>
<div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;        <span class="comment">// Delete the Explicit Timestep handler</span></div>
<div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;        <span class="keyword">delete</span> this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>();</div>
<div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;        <span class="comment">// Reset the assembly handler to the original handler</span></div>
<div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;        this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>() = old_assembly_handler_pt;</div>
<div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;      }</div>
<div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;    }</div>
<div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a93304d0c6be1022b944f21c0f4c07eab"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a93304d0c6be1022b944f21c0f4c07eab">oomph::Problem::mass_matrix_solver_for_explicit_timestepper_pt</a></div><div class="ttdeci">LinearSolver *&amp; mass_matrix_solver_for_explicit_timestepper_pt()</div><div class="ttdef"><b>Definition:</b> problem.h:1479</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt()</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#a7bcc94c157d6853a0f0502e8a76ed380">oomph::DoubleVector::build()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">communicator_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae0cebe288c8daddd9663bd10d8f1caa0">Default_assembly_handler_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a97ca0078fff6adca318835c11503dc2d">Discontinuous_element_formulation</a>, <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">oomph::Mesh::element_pt()</a>, <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a3000ebd9becb3468d8a6a821a9cc0cd9">oomph::LinearSolver::enable_resolve()</a>, <a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a37ac5a1d5234fa931ab710c0c74d55d2">oomph::GeneralisedElement::eqn_number()</a>, <a class="el" href="../../db/d5d/classoomph_1_1DGElement.html#ad2247a9d65eb229dbf30d709c7b28d6d">oomph::DGElement::get_inverse_mass_matrix_times_residuals()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a0103fe1a09ecf7e23a9083b35ef07aac">get_residuals()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6067c6d344363a073fb8d02a99fb7ed0">Mass_matrix_has_been_computed</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af4d25809ac090102a4d4a398e4ad0e26">Mass_matrix_reuse_is_enabled</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a93304d0c6be1022b944f21c0f4c07eab">mass_matrix_solver_for_explicit_timestepper_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt()</a>, <a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a37204f67b37d212fd170c68d48f6da57">oomph::GeneralisedElement::ndof()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">oomph::Mesh::nelement()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a3b310d08333033edc119b2a5bd7dcbfb">oomph::LinearSolver::resolve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab4a3743c23a2d1eed56981484636c958">Shut_up_in_newton_solve</a>, and <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a15ce22542b74ed1826ea485edacbeb6e">oomph::LinearSolver::solve()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a0daf749053a1afb0bdea7faa583dd7c7">get_dvaluesdt()</a>.</p>

</div>
</div>
<a id="ae9bbce5fdb111ccbab7a6077ac491feb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9bbce5fdb111ccbab7a6077ac491feb">&#9670;&nbsp;</a></span>get_jacobian() <span class="overload">[1/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::get_jacobian </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;&#160;</td>
          <td class="paramname"><em>residuals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/d2d/classoomph_1_1CCDoubleMatrix.html">CCDoubleMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>jacobian</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Return the fully-assembled Jacobian and residuals for the problem. Interface for the case when the Jacobian is in column-compressed storage format. This is virtual so, if we feel like it (e.g. for testing iterative solvers with specific test matrices), we can bypass the default assembly procedure for the Jacobian and the residual vector.</p>
<p>Return the fully-assembled Jacobian and residuals for the problem, in the case when the jacobian matrix is in column-compressed storage format. </p>
<div class="fragment"><div class="line"><a name="l04186"></a><span class="lineno"> 4186</span>&#160;  {</div>
<div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160;    <span class="comment">// Three different cases; if MPI_Helpers::MPI_has_been_initialised=true</span></div>
<div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160;    <span class="comment">// this means MPI_Helpers::setup() has been called.  This could happen on a</span></div>
<div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;    <span class="comment">// code compiled with MPI but run serially; in this instance the</span></div>
<div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;    <span class="comment">// get_residuals function still works on one processor.</span></div>
<div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;    <span class="comment">// Secondly, if a code has been compiled with MPI, but MPI_Helpers::setup()</span></div>
<div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;    <span class="comment">// has not been called, then MPI_Helpers::MPI_has_been_initialised=false</span></div>
<div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;    <span class="comment">// and the code calls...</span></div>
<div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;    <span class="comment">// Thirdly, the serial version (compiled by all, but only run when compiled</span></div>
<div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160;    <span class="comment">// with MPI if MPI_Helpers::MPI_has_been_5Binitialised=false</span></div>
<div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;    <span class="comment">// The only case where an MPI code cannot run serially at present</span></div>
<div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160;    <span class="comment">// is one where the distribute function is used (i.e. METIS is called)</span></div>
<div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160; </div>
<div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;    <span class="comment">// get the number of degrees of freedom</span></div>
<div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;    <span class="keywordtype">unsigned</span> n_dof = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>();</div>
<div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160; </div>
<div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;    <span class="comment">// PARANOID checks : if the distribution of residuals is setup then it must</span></div>
<div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;    <span class="comment">// must not be distributed, have the right number of rows, and the same</span></div>
<div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160;    <span class="comment">// communicator as the problem</span></div>
<div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;    <span class="keywordflow">if</span> (residuals.built())</div>
<div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160;    {</div>
<div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;      <span class="keywordflow">if</span> (residuals.distribution_pt()-&gt;distributed())</div>
<div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160;      {</div>
<div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;        std::ostringstream error_stream;</div>
<div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160;        error_stream</div>
<div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;If the DoubleVector residuals is setup then it must not &quot;</span></div>
<div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;be distributed.&quot;</span>;</div>
<div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;          error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;      }</div>
<div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;      <span class="keywordflow">if</span> (residuals.distribution_pt()-&gt;nrow() != n_dof)</div>
<div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160;      {</div>
<div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;        std::ostringstream error_stream;</div>
<div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;        error_stream</div>
<div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;If the DoubleVector residuals is setup then it must have&quot;</span></div>
<div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;          &lt;&lt; <span class="stringliteral">&quot; the correct number of rows&quot;</span>;</div>
<div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;          error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;      }</div>
<div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;      <span class="keywordflow">if</span> (!(*<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a> ==</div>
<div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;            *residuals.distribution_pt()-&gt;communicator_pt()))</div>
<div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;      {</div>
<div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;        std::ostringstream error_stream;</div>
<div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;        error_stream</div>
<div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;If the DoubleVector residuals is setup then it must have&quot;</span></div>
<div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160;          &lt;&lt; <span class="stringliteral">&quot; the same communicator as the problem.&quot;</span>;</div>
<div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;          error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160;      }</div>
<div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160;    }</div>
<div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160; </div>
<div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160;    <span class="comment">// Allocate storage for the matrix entries</span></div>
<div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;    <span class="comment">// The generalised Vector&lt;Vector&lt;&gt;&gt; structure is required</span></div>
<div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;    <span class="comment">// for the most general interface to sparse_assemble() which allows</span></div>
<div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160;    <span class="comment">// the assembly of multiple matrices at once.</span></div>
<div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160;    Vector&lt;int*&gt; row_index(1);</div>
<div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;    Vector&lt;int*&gt; column_start(1);</div>
<div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;    Vector&lt;double*&gt; <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>(1);</div>
<div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160; </div>
<div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;    <span class="comment">// Allocate generalised storage format for passing to sparse_assemble()</span></div>
<div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160;    Vector&lt;double*&gt; <a class="code" href="../../d8/dcc/PartialRedux__count_8cpp.html#acbe60897559b79afc28b79b0687b5f29">res</a>(1);</div>
<div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160; </div>
<div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;    <span class="comment">// allocate storage for the number of non-zeros in each matrix</span></div>
<div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;    Vector&lt;unsigned&gt; nnz(1);</div>
<div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160; </div>
<div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;    <span class="comment">// The matrix is in compressed column format</span></div>
<div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;    <span class="keywordtype">bool</span> compressed_row_flag = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160; </div>
<div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;    <span class="comment">// get the distribution for the residuals</span></div>
<div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;    LinearAlgebraDistribution* dist_pt;</div>
<div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;    <span class="keywordflow">if</span> (!residuals.built())</div>
<div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;    {</div>
<div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;      dist_pt =</div>
<div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;        <span class="keyword">new</span> LinearAlgebraDistribution(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>, this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>(), <span class="keyword">false</span>);</div>
<div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;    }</div>
<div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;    {</div>
<div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;      dist_pt = <span class="keyword">new</span> LinearAlgebraDistribution(residuals.distribution_pt());</div>
<div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160;    }</div>
<div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160; </div>
<div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l04272"></a><span class="lineno"> 4272</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">communicator_pt</a>()-&gt;nproc() == 1)</div>
<div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160;    {</div>
<div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab9cdd18180be05e4d46bfdbc1acbdbd3">sparse_assemble_row_or_column_compressed</a>(</div>
<div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160;        row_index, column_start, <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>, nnz, <a class="code" href="../../d8/dcc/PartialRedux__count_8cpp.html#acbe60897559b79afc28b79b0687b5f29">res</a>, compressed_row_flag);</div>
<div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;      jacobian.build_without_copy(</div>
<div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;        <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>[0], row_index[0], column_start[0], nnz[0], n_dof, n_dof);</div>
<div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160;      residuals.build(dist_pt, 0.0);</div>
<div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;      residuals.set_external_values(<a class="code" href="../../d8/dcc/PartialRedux__count_8cpp.html#acbe60897559b79afc28b79b0687b5f29">res</a>[0], <span class="keyword">true</span>);</div>
<div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;    }</div>
<div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;    {</div>
<div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160;      std::ostringstream error_stream;</div>
<div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;      error_stream &lt;&lt; <span class="stringliteral">&quot;Cannot assemble a CCDoubleMatrix Jacobian on more &quot;</span></div>
<div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;than one processor.&quot;</span>;</div>
<div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160;        error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160;    }</div>
<div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160; </div>
<div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;    <span class="comment">// clean up</span></div>
<div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160;    <span class="keyword">delete</span> dist_pt;</div>
<div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160;  }</div>
<div class="ttc" id="aPartialRedux__count_8cpp_html_acbe60897559b79afc28b79b0687b5f29"><div class="ttname"><a href="../../d8/dcc/PartialRedux__count_8cpp.html#acbe60897559b79afc28b79b0687b5f29">res</a></div><div class="ttdeci">cout&lt;&lt; &quot;Here is the matrix m:&quot;&lt;&lt; endl&lt;&lt; m&lt;&lt; endl;Matrix&lt; ptrdiff_t, 3, 1 &gt; res</div><div class="ttdef"><b>Definition:</b> PartialRedux_count.cpp:3</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#a7bcc94c157d6853a0f0502e8a76ed380">oomph::DoubleVector::build()</a>, <a class="el" href="../../d8/d33/classoomph_1_1CCMatrix.html#a57eddb79a6a3af698a1c92196482335a">oomph::CCMatrix&lt; T &gt;::build_without_copy()</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#aae402d422ec4344a4a45cdb7659b7161">oomph::DoubleVector::built()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a2e4736826a65253f574d4f6f152ab514">oomph::LinearAlgebraDistribution::communicator_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">communicator_pt()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a05842d032d28880ae37951deae804ad8">oomph::LinearAlgebraDistribution::distributed()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">oomph::DistributableLinearAlgebraObject::distribution_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#aafad0b69de2284808366b65bd63e493b">oomph::LinearAlgebraDistribution::nrow()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../d8/dcc/PartialRedux__count_8cpp.html#acbe60897559b79afc28b79b0687b5f29">res</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#a4715c8cf47f9fc56d95889343d1a3b82">oomph::DoubleVector::set_external_values()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab9cdd18180be05e4d46bfdbc1acbdbd3">sparse_assemble_row_or_column_compressed()</a>, and <a class="el" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">Eigen::value</a>.</p>

</div>
</div>
<a id="aab9533075d11b251636fa1c3a544dba7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab9533075d11b251636fa1c3a544dba7">&#9670;&nbsp;</a></span>get_jacobian() <span class="overload">[2/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::get_jacobian </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;&#160;</td>
          <td class="paramname"><em>residuals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>jacobian</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Return the fully-assembled Jacobian and residuals for the problem. Interface for the case when the Jacobian is in row-compressed storage format. This is virtual so, if we feel like it (e.g. for testing iterative solvers with specific test matrices), we can bypass the default assembly procedure for the Jacobian and the residual vector.</p>
<p>Return the fully-assembled Jacobian and residuals for the problem, in the case where the Jacobian matrix is in a distributable row compressed storage format.</p><ol type="1">
<li>If the distribution of the jacobian and residuals is setup then, they will be returned with that distribution. Note. the jacobian and residuals must have the same distribution.</li>
<li>If the distribution of the jacobian and residuals are not setup then their distribution will computed based on: Distributed_problem_matrix_distribution. </li>
</ol>
<div class="fragment"><div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;  {</div>
<div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;    <span class="comment">// Three different cases; if MPI_Helpers::MPI_has_been_initialised=true</span></div>
<div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;    <span class="comment">// this means MPI_Helpers::setup() has been called.  This could happen on a</span></div>
<div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;    <span class="comment">// code compiled with MPI but run serially; in this instance the</span></div>
<div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;    <span class="comment">// get_residuals function still works on one processor.</span></div>
<div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;    <span class="comment">// Secondly, if a code has been compiled with MPI, but MPI_Helpers::setup()</span></div>
<div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;    <span class="comment">// has not been called, then MPI_Helpers::MPI_has_been_initialised=false</span></div>
<div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;    <span class="comment">// and the code calls...</span></div>
<div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;    <span class="comment">// Thirdly, the serial version (compiled by all, but only run when compiled</span></div>
<div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;    <span class="comment">// with MPI if MPI_Helpers::MPI_has_been_initialised=false</span></div>
<div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;    <span class="comment">// The only case where an MPI code cannot run serially at present</span></div>
<div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;    <span class="comment">// is one where the distribute function is used (i.e. METIS is called)</span></div>
<div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160; </div>
<div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;    <span class="comment">// Allocate storage for the matrix entries</span></div>
<div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;    <span class="comment">// The generalised Vector&lt;Vector&lt;&gt;&gt; structure is required</span></div>
<div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;    <span class="comment">// for the most general interface to sparse_assemble() which allows</span></div>
<div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;    <span class="comment">// the assembly of multiple matrices at once.</span></div>
<div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;    Vector&lt;int*&gt; column_index(1);</div>
<div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;    Vector&lt;int*&gt; row_start(1);</div>
<div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;    Vector&lt;double*&gt; <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>(1);</div>
<div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;    Vector&lt;unsigned&gt; nnz(1);</div>
<div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160; </div>
<div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;    <span class="comment">// PARANOID checks that the distribution of the jacobian matches that of the</span></div>
<div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;    <span class="comment">// residuals (if they are setup) and that they have the right number of rows</span></div>
<div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;    <span class="keywordflow">if</span> (residuals.built() &amp;&amp; jacobian.distribution_built())</div>
<div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;    {</div>
<div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;      <span class="keywordflow">if</span> (!(*residuals.distribution_pt() == *jacobian.distribution_pt()))</div>
<div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;      {</div>
<div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;        std::ostringstream error_stream;</div>
<div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;        error_stream &lt;&lt; <span class="stringliteral">&quot;The distribution of the residuals must &quot;</span></div>
<div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;be the same as the distribution of the jacobian.&quot;</span>;</div>
<div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;          error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;      }</div>
<div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;      <span class="keywordflow">if</span> (jacobian.distribution_pt()-&gt;nrow() != this-&gt;ndof())</div>
<div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;      {</div>
<div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;        std::ostringstream error_stream;</div>
<div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;        error_stream</div>
<div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;The distribution of the jacobian and residuals does not&quot;</span></div>
<div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;have the correct number of global rows.&quot;</span>;</div>
<div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;          error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;      }</div>
<div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;    }</div>
<div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (residuals.built() != jacobian.distribution_built())</div>
<div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;    {</div>
<div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;      std::ostringstream error_stream;</div>
<div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;      error_stream &lt;&lt; <span class="stringliteral">&quot;The distribution of the jacobian and residuals must &quot;</span></div>
<div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;both be setup or both not setup&quot;</span>;</div>
<div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;        error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;    }</div>
<div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160; </div>
<div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160; </div>
<div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;    <span class="comment">// Allocate generalised storage format for passing to sparse_assemble()</span></div>
<div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;    Vector&lt;double*&gt; <a class="code" href="../../d8/dcc/PartialRedux__count_8cpp.html#acbe60897559b79afc28b79b0687b5f29">res</a>(1);</div>
<div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160; </div>
<div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;    <span class="comment">// number of rows</span></div>
<div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;    <span class="keywordtype">unsigned</span> nrow = this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>();</div>
<div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160; </div>
<div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;    <span class="comment">// determine the distribution for the jacobian.</span></div>
<div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;    <span class="comment">// IF the jacobian has distribution setup then use that</span></div>
<div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;    <span class="comment">// ELSE determine the distribution based on the</span></div>
<div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;    <span class="comment">// distributed_matrix_distribution enum</span></div>
<div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;    LinearAlgebraDistribution* dist_pt = 0;</div>
<div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;    <span class="keywordflow">if</span> (jacobian.distribution_built())</div>
<div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;    {</div>
<div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;      dist_pt = <span class="keyword">new</span> LinearAlgebraDistribution(jacobian.distribution_pt());</div>
<div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;    }</div>
<div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;    {</div>
<div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;      <span class="comment">// if problem is only one one processor</span></div>
<div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>-&gt;<a class="code" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a6c78c72666f4b102c2bccf200f0853b7">nproc</a>() == 1)</div>
<div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;      {</div>
<div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;        dist_pt = <span class="keyword">new</span> LinearAlgebraDistribution(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>, nrow, <span class="keyword">false</span>);</div>
<div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;      }</div>
<div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;      <span class="comment">// if the problem is not distributed then assemble the jacobian with</span></div>
<div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;      <span class="comment">// a uniform distributed distribution</span></div>
<div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!Problem_has_been_distributed)</div>
<div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;      {</div>
<div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;        dist_pt = <span class="keyword">new</span> LinearAlgebraDistribution(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>, nrow, <span class="keyword">true</span>);</div>
<div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;      }</div>
<div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;      <span class="comment">// otherwise the problem is a distributed problem</span></div>
<div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;      {</div>
<div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;        <span class="keywordflow">switch</span> (Dist_problem_matrix_distribution)</div>
<div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;        {</div>
<div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;          <span class="keywordflow">case</span> Uniform_matrix_distribution:</div>
<div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;            dist_pt =</div>
<div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;              <span class="keyword">new</span> LinearAlgebraDistribution(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>, nrow, <span class="keyword">true</span>);</div>
<div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;          <span class="keywordflow">case</span> Problem_matrix_distribution:</div>
<div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;            dist_pt = <span class="keyword">new</span> LinearAlgebraDistribution(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>);</div>
<div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;          <span class="keywordflow">case</span> Default_matrix_distribution:</div>
<div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;            LinearAlgebraDistribution* uniform_dist_pt =</div>
<div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;              <span class="keyword">new</span> LinearAlgebraDistribution(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>, nrow, <span class="keyword">true</span>);</div>
<div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;            <span class="keywordtype">bool</span> use_problem_dist = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;            <span class="keywordtype">unsigned</span> nproc = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>-&gt;<a class="code" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a6c78c72666f4b102c2bccf200f0853b7">nproc</a>();</div>
<div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> = 0; <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> &lt; nproc; <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>++)</div>
<div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;            {</div>
<div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;              <span class="keywordflow">if</span> ((<span class="keywordtype">double</span>)<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">nrow_local</a>(<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>) &gt;</div>
<div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;                  ((<span class="keywordtype">double</span>)uniform_dist_pt-&gt;nrow_local(<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>)) * 1.1)</div>
<div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;              {</div>
<div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;                use_problem_dist = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;              }</div>
<div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;            }</div>
<div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160;            <span class="keywordflow">if</span> (use_problem_dist)</div>
<div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;            {</div>
<div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;              dist_pt = <span class="keyword">new</span> LinearAlgebraDistribution(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>);</div>
<div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160;            }</div>
<div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;            {</div>
<div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;              dist_pt = <span class="keyword">new</span> LinearAlgebraDistribution(uniform_dist_pt);</div>
<div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;            }</div>
<div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;            <span class="keyword">delete</span> uniform_dist_pt;</div>
<div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;        }</div>
<div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;      }</div>
<div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;      dist_pt = <span class="keyword">new</span> LinearAlgebraDistribution(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>, nrow, <span class="keyword">false</span>);</div>
<div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;    }</div>
<div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160; </div>
<div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160; </div>
<div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;    <span class="comment">// The matrix is in compressed row format</span></div>
<div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;    <span class="keywordtype">bool</span> compressed_row_flag = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160; </div>
<div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>-&gt;<a class="code" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a6c78c72666f4b102c2bccf200f0853b7">nproc</a>() == 1)</div>
<div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;    {</div>
<div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab9cdd18180be05e4d46bfdbc1acbdbd3">sparse_assemble_row_or_column_compressed</a>(</div>
<div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;        column_index, row_start, <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>, nnz, <a class="code" href="../../d8/dcc/PartialRedux__count_8cpp.html#acbe60897559b79afc28b79b0687b5f29">res</a>, compressed_row_flag);</div>
<div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;      jacobian.build(dist_pt);</div>
<div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;      jacobian.build_without_copy(</div>
<div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;        dist_pt-&gt;nrow(), nnz[0], <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>[0], column_index[0], row_start[0]);</div>
<div class="line"><a name="l04142"></a><span class="lineno"> 4142</span>&#160;      residuals.build(dist_pt, 0.0);</div>
<div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;      residuals.set_external_values(<a class="code" href="../../d8/dcc/PartialRedux__count_8cpp.html#acbe60897559b79afc28b79b0687b5f29">res</a>[0], <span class="keyword">true</span>);</div>
<div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;    }</div>
<div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;    {</div>
<div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160;      <span class="keywordflow">if</span> (dist_pt-&gt;distributed())</div>
<div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;      {</div>
<div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;        parallel_sparse_assemble(</div>
<div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;          dist_pt, column_index, row_start, <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>, nnz, <a class="code" href="../../d8/dcc/PartialRedux__count_8cpp.html#acbe60897559b79afc28b79b0687b5f29">res</a>);</div>
<div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;        jacobian.build(dist_pt);</div>
<div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;        jacobian.build_without_copy(</div>
<div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;          dist_pt-&gt;nrow(), nnz[0], <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>[0], column_index[0], row_start[0]);</div>
<div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;        residuals.build(dist_pt, 0.0);</div>
<div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160;        residuals.set_external_values(<a class="code" href="../../d8/dcc/PartialRedux__count_8cpp.html#acbe60897559b79afc28b79b0687b5f29">res</a>[0], <span class="keyword">true</span>);</div>
<div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;      }</div>
<div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160;      {</div>
<div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;        LinearAlgebraDistribution* temp_dist_pt =</div>
<div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;          <span class="keyword">new</span> LinearAlgebraDistribution(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>, dist_pt-&gt;nrow(), <span class="keyword">true</span>);</div>
<div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;        parallel_sparse_assemble(</div>
<div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;          temp_dist_pt, column_index, row_start, <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>, nnz, <a class="code" href="../../d8/dcc/PartialRedux__count_8cpp.html#acbe60897559b79afc28b79b0687b5f29">res</a>);</div>
<div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;        jacobian.build(temp_dist_pt);</div>
<div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160;        jacobian.build_without_copy(</div>
<div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;          dist_pt-&gt;nrow(), nnz[0], <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>[0], column_index[0], row_start[0]);</div>
<div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;        jacobian.redistribute(dist_pt);</div>
<div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;        residuals.build(temp_dist_pt, 0.0);</div>
<div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;        residuals.set_external_values(<a class="code" href="../../d8/dcc/PartialRedux__count_8cpp.html#acbe60897559b79afc28b79b0687b5f29">res</a>[0], <span class="keyword">true</span>);</div>
<div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;        residuals.redistribute(dist_pt);</div>
<div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;        <span class="keyword">delete</span> temp_dist_pt;</div>
<div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;      }</div>
<div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;    }</div>
<div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160; </div>
<div class="line"><a name="l04176"></a><span class="lineno"> 4176</span>&#160;    <span class="comment">// clean up dist_pt and residuals_vector pt</span></div>
<div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;    <span class="keyword">delete</span> dist_pt;</div>
<div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#a7bcc94c157d6853a0f0502e8a76ed380">oomph::DoubleVector::build()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#af44bac2acd071317f96dae49cbb0d977">oomph::CRDoubleMatrix::build()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aafb4d7de0a87b4bda560928e6a128060">oomph::CRDoubleMatrix::build_without_copy()</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#aae402d422ec4344a4a45cdb7659b7161">oomph::DoubleVector::built()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a05842d032d28880ae37951deae804ad8">oomph::LinearAlgebraDistribution::distributed()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a8c35baa65e335043f62954c92c090a5a">oomph::DistributableLinearAlgebraObject::distribution_built()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">oomph::DistributableLinearAlgebraObject::distribution_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof()</a>, <a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a6c78c72666f4b102c2bccf200f0853b7">oomph::OomphCommunicator::nproc()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#aafad0b69de2284808366b65bd63e493b">oomph::LinearAlgebraDistribution::nrow()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">oomph::LinearAlgebraDistribution::nrow_local()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#a9396b861977c16606d8eca39056976c8">oomph::DoubleVector::redistribute()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a9ba295a04e08e3153ae06bc0556f507d">oomph::CRDoubleMatrix::redistribute()</a>, <a class="el" href="../../d8/dcc/PartialRedux__count_8cpp.html#acbe60897559b79afc28b79b0687b5f29">res</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#a4715c8cf47f9fc56d95889343d1a3b82">oomph::DoubleVector::set_external_values()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab9cdd18180be05e4d46bfdbc1acbdbd3">sparse_assemble_row_or_column_compressed()</a>, and <a class="el" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">Eigen::value</a>.</p>

</div>
</div>
<a id="af660c2c0d10eaea1972314ce80de000e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af660c2c0d10eaea1972314ce80de000e">&#9670;&nbsp;</a></span>get_jacobian() <span class="overload">[3/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::get_jacobian </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;&#160;</td>
          <td class="paramname"><em>residuals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/d03/classoomph_1_1DenseDoubleMatrix.html">DenseDoubleMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>jacobian</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Return the fully-assembled Jacobian and residuals for the problem Interface for the case when the Jacobian matrix is dense. This is virtual so, if we feel like it (e.g. for testing iterative solvers with specific test matrices, we can bypass the default assembly procedure for the Jacobian and the residual vector.</p>
<p>Get the fully assembled residual vector and Jacobian matrix in dense storage. The DoubleVector residuals returned will be non-distributed. If on calling this method the DoubleVector residuals is setup then it must be non-distributed and of the correct length. The matrix type DenseDoubleMatrix is not distributable and therefore the residual vector is also assumed to be non distributable. </p>
<div class="fragment"><div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;  {</div>
<div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;    <span class="comment">// get the number of degrees of freedom</span></div>
<div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;    <span class="keywordtype">unsigned</span> n_dof = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>();</div>
<div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160; </div>
<div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;    <span class="comment">// PARANOID checks : if the distribution of residuals is setup then it must</span></div>
<div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;    <span class="comment">// must not be distributed, have the right number of rows, and the same</span></div>
<div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;    <span class="comment">// communicator as the problem</span></div>
<div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;    <span class="keywordflow">if</span> (residuals.built())</div>
<div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;    {</div>
<div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;      <span class="keywordflow">if</span> (residuals.distribution_pt()-&gt;distributed())</div>
<div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;      {</div>
<div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;        std::ostringstream error_stream;</div>
<div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;        error_stream</div>
<div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;If the DoubleVector residuals is setup then it must not &quot;</span></div>
<div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;be distributed.&quot;</span>;</div>
<div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;          error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;      }</div>
<div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;      <span class="keywordflow">if</span> (residuals.distribution_pt()-&gt;nrow() != n_dof)</div>
<div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;      {</div>
<div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;        std::ostringstream error_stream;</div>
<div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;        error_stream</div>
<div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;If the DoubleVector residuals is setup then it must have&quot;</span></div>
<div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;          &lt;&lt; <span class="stringliteral">&quot; the correct number of rows&quot;</span>;</div>
<div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;          error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;      }</div>
<div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;      <span class="keywordflow">if</span> (!(*<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a> ==</div>
<div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;            *residuals.distribution_pt()-&gt;communicator_pt()))</div>
<div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;      {</div>
<div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;        std::ostringstream error_stream;</div>
<div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;        error_stream</div>
<div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;If the DoubleVector residuals is setup then it must have&quot;</span></div>
<div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;          &lt;&lt; <span class="stringliteral">&quot; the same communicator as the problem.&quot;</span>;</div>
<div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;          error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;      }</div>
<div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;    }</div>
<div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160; </div>
<div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;    <span class="comment">// set the residuals distribution if it is not setup</span></div>
<div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;    <span class="keywordflow">if</span> (!residuals.built())</div>
<div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;    {</div>
<div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;      LinearAlgebraDistribution dist(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>, n_dof, <span class="keyword">false</span>);</div>
<div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;      residuals.build(&amp;dist, 0.0);</div>
<div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;    }</div>
<div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;    <span class="comment">// else just zero the residuals</span></div>
<div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;    {</div>
<div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;      residuals.initialise(0.0);</div>
<div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;    }</div>
<div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160; </div>
<div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;    <span class="comment">// Resize the matrices -- this cannot always be done externally</span></div>
<div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;    <span class="comment">// because get_jacobian exists in many different versions for</span></div>
<div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;    <span class="comment">// different storage formats -- resizing a CC or CR matrix doesn&#39;t</span></div>
<div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;    <span class="comment">// make sense.</span></div>
<div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160; </div>
<div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;    <span class="comment">// resize the jacobian</span></div>
<div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;    jacobian.resize(n_dof, n_dof);</div>
<div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;    jacobian.initialise(0.0);</div>
<div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160; </div>
<div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;    <span class="comment">// Locally cache pointer to assembly handler</span></div>
<div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;    AssemblyHandler* <span class="keyword">const</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a> = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>;</div>
<div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160; </div>
<div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;    <span class="comment">// Loop over all the elements</span></div>
<div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n_element = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">nelement</a>();</div>
<div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; n_element; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;    {</div>
<div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;      <span class="comment">// Get the pointer to the element</span></div>
<div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;      GeneralisedElement* elem_pt = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">element_pt</a>(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>);</div>
<div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;      <span class="comment">// Find number of dofs in the element</span></div>
<div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;      <span class="keywordtype">unsigned</span> n_element_dofs = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>-&gt;<a class="code" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a09213be8f4aa009e0366460a7ed78e68">ndof</a>(elem_pt);</div>
<div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;      <span class="comment">// Set up an array</span></div>
<div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;      Vector&lt;double&gt; element_residuals(n_element_dofs);</div>
<div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;      <span class="comment">// Set up a matrix</span></div>
<div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;      <a class="code" href="../../dc/d34/classEigen_1_1Matrix.html">DenseMatrix&lt;double&gt;</a> element_jacobian(n_element_dofs);</div>
<div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;      <span class="comment">// Fill the array</span></div>
<div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>-&gt;<a class="code" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#ad43c3d8760be0ba6ebee8d82509458e5">get_jacobian</a>(</div>
<div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;        elem_pt, element_residuals, element_jacobian);</div>
<div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;      <span class="comment">// Now loop over the dofs and assign values to global Vector</span></div>
<div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> l = 0; l &lt; n_element_dofs; l++)</div>
<div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;      {</div>
<div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> eqn_number = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>-&gt;<a class="code" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a94d28e2de2559cde803d1ba2195b5290">eqn_number</a>(elem_pt, l);</div>
<div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;        residuals[eqn_number] += element_residuals[l];</div>
<div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> l2 = 0; l2 &lt; n_element_dofs; l2++)</div>
<div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;        {</div>
<div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;          jacobian(eqn_number, <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>-&gt;<a class="code" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a94d28e2de2559cde803d1ba2195b5290">eqn_number</a>(elem_pt, l2)) +=</div>
<div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;            element_jacobian(l, l2);</div>
<div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;        }</div>
<div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;      }</div>
<div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;    }</div>
<div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt()</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#a7bcc94c157d6853a0f0502e8a76ed380">oomph::DoubleVector::build()</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#aae402d422ec4344a4a45cdb7659b7161">oomph::DoubleVector::built()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a2e4736826a65253f574d4f6f152ab514">oomph::LinearAlgebraDistribution::communicator_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a05842d032d28880ae37951deae804ad8">oomph::LinearAlgebraDistribution::distributed()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">oomph::DistributableLinearAlgebraObject::distribution_pt()</a>, <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">oomph::Mesh::element_pt()</a>, <a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a94d28e2de2559cde803d1ba2195b5290">oomph::AssemblyHandler::eqn_number()</a>, <a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#ad43c3d8760be0ba6ebee8d82509458e5">oomph::AssemblyHandler::get_jacobian()</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#a180c1057a29f4ed721da46040a619ecd">oomph::DoubleVector::initialise()</a>, <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html#aafcfbb0309fdcbd84f8654fe1b5601fd">oomph::DenseMatrix&lt; T &gt;::initialise()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof()</a>, <a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a09213be8f4aa009e0366460a7ed78e68">oomph::AssemblyHandler::ndof()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">oomph::Mesh::nelement()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#aafad0b69de2284808366b65bd63e493b">oomph::LinearAlgebraDistribution::nrow()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, and <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html#adec1ef741b1c5048a12ba9a540c2719c">oomph::DenseMatrix&lt; T &gt;::resize()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/dcc/classoomph_1_1FpPressureAdvectionDiffusionProblem.html#a54b59cff41c3b0cca9524e202bd49453">oomph::FpPressureAdvectionDiffusionProblem&lt; ELEMENT &gt;::get_pressure_advection_diffusion_jacobian()</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ac3f40f62d33d33616cdb4bed48aaccde">oomph::NavierStokesSchurComplementPreconditioner::get_pressure_advection_diffusion_matrix()</a>, <a class="el" href="../../da/d85/matrix__multiply__test_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main()</a>, <a class="el" href="../../d9/d4b/classoomph_1_1CG.html#a3f04910b9c9c4d6b83413ecfd578ee12">oomph::CG&lt; MATRIX &gt;::solve()</a>, <a class="el" href="../../d7/dfa/classoomph_1_1BiCGStab.html#a56e2df052fee2e26ffec644ad9161864">oomph::BiCGStab&lt; MATRIX &gt;::solve()</a>, <a class="el" href="../../d3/d90/classoomph_1_1GS.html#ad7d1bfb3d25a194d2875e266e104dc9f">oomph::GS&lt; MATRIX &gt;::solve()</a>, <a class="el" href="../../dc/df6/classoomph_1_1GS_3_01CRDoubleMatrix_01_4.html#a85164d55db2ab10404d5679657e8f6de">oomph::GS&lt; CRDoubleMatrix &gt;::solve()</a>, <a class="el" href="../../d7/d2e/classoomph_1_1DampedJacobi.html#ace422835d94b7d465d08cc1f4df192ea">oomph::DampedJacobi&lt; MATRIX &gt;::solve()</a>, <a class="el" href="../../d5/dee/classoomph_1_1GMRES.html#ade0f569ecda6b63d3e77dfe07a19cb13">oomph::GMRES&lt; MATRIX &gt;::solve()</a>, <a class="el" href="../../d2/d08/classoomph_1_1AugmentedProblemGMRES.html#a73d8d3d8b161084e6291560cdd7984dc">oomph::AugmentedProblemGMRES::solve()</a>, <a class="el" href="../../d3/d06/classoomph_1_1DenseLU.html#ac354b224819146618ce8a1396f8f980e">oomph::DenseLU::solve()</a>, <a class="el" href="../../d7/db1/classoomph_1_1SuperLUSolver.html#a5a121df89c72a8741d051aa176b12255">oomph::SuperLUSolver::solve()</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#ae0346a464f3ed74bfcca4063bdeed3ad">oomph::MumpsSolver::solve()</a>, <a class="el" href="../../d7/d86/classoomph_1_1HelmholtzGMRESMG.html#a5806236b991ac2d7fe4bc7a4f19e98fb">oomph::HelmholtzGMRESMG&lt; MATRIX &gt;::solve()</a>, <a class="el" href="../../df/df9/classoomph_1_1HelmholtzFGMRESMG.html#a36a1d601676df2ebe39fcdb7a0837864">oomph::HelmholtzFGMRESMG&lt; MATRIX &gt;::solve()</a>, <a class="el" href="../../d6/dba/classoomph_1_1HypreSolver.html#a3a42a158a390f24d7d91ee78aa53e960">oomph::HypreSolver::solve()</a>, <a class="el" href="../../db/dfc/classoomph_1_1TrilinosAztecOOSolver.html#a7dc1ae7f05e8a50416b8df700f832eb9">oomph::TrilinosAztecOOSolver::solve()</a>, and <a class="el" href="../../d7/db1/classoomph_1_1SuperLUSolver.html#a10bdce2b176a3ca514b82f66cd50e037">oomph::SuperLUSolver::solve_transpose()</a>.</p>

</div>
</div>
<a id="a0db16f9bcac7af964d0fecc8b6a5ea63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0db16f9bcac7af964d0fecc8b6a5ea63">&#9670;&nbsp;</a></span>get_jacobian() <span class="overload">[4/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void oomph::Problem::get_jacobian </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;&#160;</td>
          <td class="paramname"><em>residuals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/d36/classoomph_1_1SumOfMatrices.html">SumOfMatrices</a> &amp;&#160;</td>
          <td class="paramname"><em>jacobian</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Dummy virtual function that must be overloaded by the problem to specify which matrices should be summed to give the final Jacobian. </p>
<div class="fragment"><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;    {</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;      std::ostringstream error_stream;</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;      error_stream</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;You must overload this function in your problem class to specify\n&quot;</span></div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;which matrices should be summed to give the final Jacobian.&quot;</span>;</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;        error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, and <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>.</p>

</div>
</div>
<a id="a0103fe1a09ecf7e23a9083b35ef07aac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0103fe1a09ecf7e23a9083b35ef07aac">&#9670;&nbsp;</a></span>get_residuals()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::get_residuals </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;&#160;</td>
          <td class="paramname"><em>residuals</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the total residuals Vector for the problem. </p>
<p>Return the fully-assembled residuals Vector for the problem: Virtual so it can be overloaded in for mpi problems </p>
<div class="fragment"><div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;  {</div>
<div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;    <span class="comment">// Three different cases; if MPI_Helpers::MPI_has_been_initialised=true</span></div>
<div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;    <span class="comment">// this means MPI_Helpers::init() has been called.  This could happen on a</span></div>
<div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;    <span class="comment">// code compiled with MPI but run serially; in this instance the</span></div>
<div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;    <span class="comment">// get_residuals function still works on one processor.</span></div>
<div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;    <span class="comment">// Secondly, if a code has been compiled with MPI, but MPI_Helpers::init()</span></div>
<div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;    <span class="comment">// has not been called, then MPI_Helpers::MPI_has_been_initialised=false</span></div>
<div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;    <span class="comment">// and the code calls...</span></div>
<div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;    <span class="comment">// Thirdly, the serial version (compiled by all, but only run when compiled</span></div>
<div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;    <span class="comment">// with MPI if MPI_Helpers::MPI_has_been_initialised=false</span></div>
<div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160; </div>
<div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;    <span class="comment">// Check that the residuals has the correct number of rows if it has been</span></div>
<div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;    <span class="comment">// setup</span></div>
<div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;    <span class="keywordflow">if</span> (residuals.built())</div>
<div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;    {</div>
<div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;      <span class="keywordflow">if</span> (residuals.distribution_pt()-&gt;nrow() != this-&gt;ndof())</div>
<div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160;      {</div>
<div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;        std::ostringstream error_stream;</div>
<div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;        error_stream &lt;&lt; <span class="stringliteral">&quot;The distribution of the residuals vector does not &quot;</span></div>
<div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;                        <span class="stringliteral">&quot;have the correct\n&quot;</span></div>
<div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;number of global rows\n&quot;</span>;</div>
<div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160; </div>
<div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;          error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;      }</div>
<div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;    }</div>
<div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160; </div>
<div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;    <span class="comment">// Find the number of rows</span></div>
<div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> nrow = this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>();</div>
<div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160; </div>
<div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;    <span class="comment">// Determine the distribution for the residuals vector</span></div>
<div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;    <span class="comment">// IF the vector has distribution setup then use that</span></div>
<div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;    <span class="comment">// ELSE determine the distribution based on the</span></div>
<div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160;    <span class="comment">// distributed_matrix_distribution enum</span></div>
<div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;    LinearAlgebraDistribution* dist_pt = 0;</div>
<div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;    <span class="keywordflow">if</span> (residuals.built())</div>
<div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;    {</div>
<div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;      dist_pt = <span class="keyword">new</span> LinearAlgebraDistribution(residuals.distribution_pt());</div>
<div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;    }</div>
<div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;    {</div>
<div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;      <span class="comment">// if problem is only one one processor assemble non-distributed</span></div>
<div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;      <span class="comment">// distribution</span></div>
<div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>-&gt;<a class="code" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a6c78c72666f4b102c2bccf200f0853b7">nproc</a>() == 1)</div>
<div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;      {</div>
<div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;        dist_pt = <span class="keyword">new</span> LinearAlgebraDistribution(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>, nrow, <span class="keyword">false</span>);</div>
<div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;      }</div>
<div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;      <span class="comment">// if the problem is not distributed then assemble the jacobian with</span></div>
<div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;      <span class="comment">// a uniform distributed distribution</span></div>
<div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!Problem_has_been_distributed)</div>
<div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;      {</div>
<div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;        dist_pt = <span class="keyword">new</span> LinearAlgebraDistribution(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>, nrow, <span class="keyword">true</span>);</div>
<div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;      }</div>
<div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;      <span class="comment">// otherwise the problem is a distributed problem</span></div>
<div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;      {</div>
<div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;        <span class="keywordflow">switch</span> (Dist_problem_matrix_distribution)</div>
<div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;        {</div>
<div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;          <span class="keywordflow">case</span> Uniform_matrix_distribution:</div>
<div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;            dist_pt =</div>
<div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;              <span class="keyword">new</span> LinearAlgebraDistribution(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>, nrow, <span class="keyword">true</span>);</div>
<div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;          <span class="keywordflow">case</span> Problem_matrix_distribution:</div>
<div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;            dist_pt = <span class="keyword">new</span> LinearAlgebraDistribution(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>);</div>
<div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;          <span class="keywordflow">case</span> Default_matrix_distribution:</div>
<div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;            LinearAlgebraDistribution* uniform_dist_pt =</div>
<div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;              <span class="keyword">new</span> LinearAlgebraDistribution(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>, nrow, <span class="keyword">true</span>);</div>
<div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;            <span class="keywordtype">bool</span> use_problem_dist = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;            <span class="keywordtype">unsigned</span> nproc = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>-&gt;<a class="code" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a6c78c72666f4b102c2bccf200f0853b7">nproc</a>();</div>
<div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> = 0; <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> &lt; nproc; <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>++)</div>
<div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;            {</div>
<div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;              <span class="keywordflow">if</span> ((<span class="keywordtype">double</span>)<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">nrow_local</a>(<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>) &gt;</div>
<div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;                  ((<span class="keywordtype">double</span>)uniform_dist_pt-&gt;nrow_local(<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>)) * 1.1)</div>
<div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;              {</div>
<div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;                use_problem_dist = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;              }</div>
<div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;            }</div>
<div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;            <span class="keywordflow">if</span> (use_problem_dist)</div>
<div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;            {</div>
<div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;              dist_pt = <span class="keyword">new</span> LinearAlgebraDistribution(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>);</div>
<div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;            }</div>
<div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;            {</div>
<div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;              dist_pt = <span class="keyword">new</span> LinearAlgebraDistribution(uniform_dist_pt);</div>
<div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;            }</div>
<div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;            <span class="keyword">delete</span> uniform_dist_pt;</div>
<div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;        }</div>
<div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;      }</div>
<div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;      dist_pt = <span class="keyword">new</span> LinearAlgebraDistribution(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>, nrow, <span class="keyword">false</span>);</div>
<div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;    }</div>
<div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160; </div>
<div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;    <span class="comment">// Locally cache pointer to assembly handler</span></div>
<div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;    AssemblyHandler* <span class="keyword">const</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a> = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>;</div>
<div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160; </div>
<div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;    <span class="comment">// Build and zero the residuals</span></div>
<div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;    residuals.build(dist_pt, 0.0);</div>
<div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160; </div>
<div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;    <span class="comment">// Serial (or one processor case)</span></div>
<div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">communicator_pt</a>()-&gt;nproc() == 1)</div>
<div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;    {</div>
<div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;      <span class="comment">// Loop over all the elements</span></div>
<div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> Element_pt_range = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">nelement</a>();</div>
<div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; Element_pt_range; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;      {</div>
<div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;        <span class="comment">// Get the pointer to the element</span></div>
<div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;        GeneralisedElement* elem_pt = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">element_pt</a>(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>);</div>
<div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;        <span class="comment">// Find number of dofs in the element</span></div>
<div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;        <span class="keywordtype">unsigned</span> n_element_dofs = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>-&gt;<a class="code" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a09213be8f4aa009e0366460a7ed78e68">ndof</a>(elem_pt);</div>
<div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;        <span class="comment">// Set up an array</span></div>
<div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;        Vector&lt;double&gt; element_residuals(n_element_dofs);</div>
<div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;        <span class="comment">// Fill the array</span></div>
<div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>-&gt;<a class="code" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a7a6203b0ab90da62b4da2af8a26d08b3">get_residuals</a>(elem_pt, element_residuals);</div>
<div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;        <span class="comment">// Now loop over the dofs and assign values to global Vector</span></div>
<div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> l = 0; l &lt; n_element_dofs; l++)</div>
<div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;        {</div>
<div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;          residuals[<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>-&gt;<a class="code" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a94d28e2de2559cde803d1ba2195b5290">eqn_number</a>(elem_pt, l)] +=</div>
<div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;            element_residuals[l];</div>
<div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;        }</div>
<div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;      }</div>
<div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;      <span class="comment">// Otherwise parallel case</span></div>
<div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;    }</div>
<div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;    {</div>
<div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;      <span class="comment">// Store the current assembly handler</span></div>
<div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;      AssemblyHandler* <span class="keyword">const</span> old_assembly_handler_pt = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>;</div>
<div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;      <span class="comment">// Create a new assembly handler that only assembles the residuals</span></div>
<div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a> =</div>
<div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;        <span class="keyword">new</span> ParallelResidualsHandler(old_assembly_handler_pt);</div>
<div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160; </div>
<div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;      <span class="comment">// Setup memory for parallel sparse assemble</span></div>
<div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;      <span class="comment">// No matrix so all size zero</span></div>
<div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;      Vector&lt;int*&gt; column_index;</div>
<div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;      Vector&lt;int*&gt; row_start;</div>
<div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;      Vector&lt;double*&gt; <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>;</div>
<div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;      Vector&lt;unsigned&gt; nnz;</div>
<div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;      <span class="comment">// One set of residuals of sizer one</span></div>
<div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;      Vector&lt;double*&gt; <a class="code" href="../../d8/dcc/PartialRedux__count_8cpp.html#acbe60897559b79afc28b79b0687b5f29">res</a>(1);</div>
<div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160; </div>
<div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;      <span class="comment">// Call the parallel sparse assemble, that should only assemble residuals</span></div>
<div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;      parallel_sparse_assemble(</div>
<div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;        dist_pt, column_index, row_start, <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>, nnz, <a class="code" href="../../d8/dcc/PartialRedux__count_8cpp.html#acbe60897559b79afc28b79b0687b5f29">res</a>);</div>
<div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;      <span class="comment">// Fill in the residuals data</span></div>
<div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;      residuals.set_external_values(<a class="code" href="../../d8/dcc/PartialRedux__count_8cpp.html#acbe60897559b79afc28b79b0687b5f29">res</a>[0], <span class="keyword">true</span>);</div>
<div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160; </div>
<div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;      <span class="comment">// Delete new assembly handler</span></div>
<div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;      <span class="keyword">delete</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>;</div>
<div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;      <span class="comment">// Reset the assembly handler to the original</span></div>
<div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a> = old_assembly_handler_pt;</div>
<div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;    }</div>
<div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160; </div>
<div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;    <span class="comment">// Delete the distribution</span></div>
<div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;    <span class="keyword">delete</span> dist_pt;</div>
<div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1AssemblyHandler_html_a7a6203b0ab90da62b4da2af8a26d08b3"><div class="ttname"><a href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a7a6203b0ab90da62b4da2af8a26d08b3">oomph::AssemblyHandler::get_residuals</a></div><div class="ttdeci">virtual void get_residuals(GeneralisedElement *const &amp;elem_pt, Vector&lt; double &gt; &amp;residuals)</div><div class="ttdoc">Return the contribution to the residuals of the element elem_pt.</div><div class="ttdef"><b>Definition:</b> assembly_handler.cc:92</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt()</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#a7bcc94c157d6853a0f0502e8a76ed380">oomph::DoubleVector::build()</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#aae402d422ec4344a4a45cdb7659b7161">oomph::DoubleVector::built()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">communicator_pt()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">oomph::DistributableLinearAlgebraObject::distribution_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>, <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">oomph::Mesh::element_pt()</a>, <a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a94d28e2de2559cde803d1ba2195b5290">oomph::AssemblyHandler::eqn_number()</a>, <a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a7a6203b0ab90da62b4da2af8a26d08b3">oomph::AssemblyHandler::get_residuals()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof()</a>, <a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a09213be8f4aa009e0366460a7ed78e68">oomph::AssemblyHandler::ndof()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">oomph::Mesh::nelement()</a>, <a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a6c78c72666f4b102c2bccf200f0853b7">oomph::OomphCommunicator::nproc()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#aafad0b69de2284808366b65bd63e493b">oomph::LinearAlgebraDistribution::nrow()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">oomph::LinearAlgebraDistribution::nrow_local()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>, <a class="el" href="../../d8/dcc/PartialRedux__count_8cpp.html#acbe60897559b79afc28b79b0687b5f29">res</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#a4715c8cf47f9fc56d95889343d1a3b82">oomph::DoubleVector::set_external_values()</a>, and <a class="el" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">Eigen::value</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#adc456017cfc4fb4ae6f522973e50f496">get_derivative_wrt_global_parameter()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a9f3d1c9378e385d7755184a97f5f6f91">get_fd_jacobian()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5ee48c16fce89952a019a844ac386655">get_inverse_mass_matrix_times_residuals()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a466d6110fd791b17e04a4100312787cd">globally_convergent_line_search()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aae8cf62757e432b625ec81fad1559dc3">newton_solve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7b86783463433cc9c4cc382b1b40f0e1">newton_solve_continuation()</a>, <a class="el" href="../../d2/d37/classoomph_1_1UnsteadyHeatFluxPseudoMeltElement.html#a101ef48214def2f7d577a0b2b4efc471">oomph::UnsteadyHeatFluxPseudoMeltElement&lt; ELEMENT &gt;::plot_residual_landscape()</a>, <a class="el" href="../../de/da7/classoomph_1_1SegregatableFSIProblem.html#a87a69561674c1e596bb205e0fc4a387f">oomph::SegregatableFSIProblem::segregated_solve()</a>, <a class="el" href="../../d2/d5a/classoomph_1_1SolidICProblem.html#a07e954c951e4eefa7ac7c99ba74e81cc">oomph::SolidICProblem::set_newmark_initial_condition_consistently()</a>, <a class="el" href="../../df/dbd/classoomph_1_1BlockHopfLinearSolver.html#a5e9ff24466ec138cca8264e5befc31fe">oomph::BlockHopfLinearSolver::solve()</a>, and <a class="el" href="../../df/dbd/classoomph_1_1BlockHopfLinearSolver.html#a9a7cc6bda9ab1a8baf83d5d8e1fe5eea">oomph::BlockHopfLinearSolver::solve_for_two_rhs()</a>.</p>

</div>
</div>
<a id="ae508b2056d532cb8b6eb0dd5c16b9325"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae508b2056d532cb8b6eb0dd5c16b9325">&#9670;&nbsp;</a></span>global_data_pt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d8/dc5/classoomph_1_1Data.html">Data</a>*&amp; oomph::Problem::global_data_pt </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return a pointer to the the i-th global data object. </p>
<div class="fragment"><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;    {</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>, and <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d9e/classoomph_1_1IMRByBDF.html#a1eb1b47643bf37e27c478c6987c7716d">oomph::IMRByBDF::actions_after_timestep()</a>, <a class="el" href="../../d2/da2/classoomph_1_1PeriodicOrbitAssemblyHandler.html#a358d1749faa8ac7dd0de87340d878088">oomph::PeriodicOrbitAssemblyHandler&lt; NNODE_1D &gt;::adapt_temporal_mesh()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6f0c24728351d390d4f0a86d07bd8678">add_global_data()</a>, <a class="el" href="../../df/de6/classCapProblem.html#a5d06fe7f9ea8590d4752d893ded3614e">CapProblem&lt; ELEMENT &gt;::CapProblem()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab8b63040a3c6deff68fb2128c2f7fef2">copy()</a>.</p>

</div>
</div>
<a id="a491354401f780ccc114ceb76f5cacef0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a491354401f780ccc114ceb76f5cacef0">&#9670;&nbsp;</a></span>global_dof_pt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a>* oomph::Problem::global_dof_pt </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Return a pointer to the dof, indexed by global equation number which may be haloed or stored locally. If it is haloed, a local copy must have been requested on this processor in the Halo_scheme_pt. </p>
<div class="fragment"><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;    {</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;      <span class="comment">// If the problem is distributed I have to do something different</span></div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;      <span class="keywordflow">if</span> (Problem_has_been_distributed)</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;      {</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;        <span class="keywordflow">if</span> (Halo_scheme_pt == 0)</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;        {</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;          std::ostringstream error_stream;</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;          error_stream</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;Direct access to global dofs in a distributed problem is only\n&quot;</span></div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;possible if the function setup_dof_halo_scheme() has been &quot;</span></div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;               <span class="stringliteral">&quot;called.\n&quot;</span></div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;You can access local dofs via Problem::dof(i).\n&quot;</span>;</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;          <span class="keywordflow">throw</span> OomphLibError(error_stream.str(),</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;                              <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;                              <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;        }</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160; </div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;        <span class="comment">// Work out the local coordinate of the dof</span></div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;        <span class="comment">// based on the original distribution stored in the Halo_scheme</span></div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> first_row_local =</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;          Halo_scheme_pt-&gt;distribution_pt()-&gt;first_row();</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_row_local =</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;          Halo_scheme_pt-&gt;distribution_pt()-&gt;nrow_local();</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160; </div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;        <span class="comment">// If we are in range then just call the local value</span></div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &gt;= first_row_local) &amp;&amp; (<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; first_row_local + n_row_local))</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;        {</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;          <span class="keywordflow">return</span> this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>[i - first_row_local];</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;        }</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;        <span class="comment">// Otherwise the entry is not stored in the local processor</span></div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;        <span class="comment">// and we must have haloed it</span></div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;        {</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;          <span class="keywordflow">return</span> Halo_dof_pt[Halo_scheme_pt-&gt;local_index(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)];</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;        }</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;      }</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;      <span class="comment">// Otherwise just return the dof</span></div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;      {</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;        <span class="keywordflow">return</span> this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;      }</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d3/d20/classoomph_1_1DoubleVectorHaloScheme.html#a384d5485423108add22f8d539d6a3e3e">oomph::DoubleVectorHaloScheme::distribution_pt()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a2634e540a78fe1ee3f5c907aff500b58">oomph::LinearAlgebraDistribution::first_row()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../d3/d20/classoomph_1_1DoubleVectorHaloScheme.html#ad589a203cdd37bc2508930d8db845a49">oomph::DoubleVectorHaloScheme::local_index()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">oomph::LinearAlgebraDistribution::nrow_local()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, and <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a497518acb5d30a28a253890c3d2a5da2">get_hessian_vector_products()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aa6728813a099111bee2b6c79dec20fc4">oomph::PitchForkHandler::get_jacobian()</a>, and <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a461b24284da88b9489d720e484a6925c">oomph::PitchForkHandler::get_residuals()</a>.</p>

</div>
</div>
<a id="ac7667864b71a3889c95c29307422ac8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7667864b71a3889c95c29307422ac8e">&#9670;&nbsp;</a></span>global_temporal_error_norm()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="../../df/de6/classdouble.html">double</a> oomph::Problem::global_temporal_error_norm </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Function to calculate a global error norm, used in adaptive timestepping to control the change in timestep. Individual errors for each data object can be obtained via the data timestepper's temporal_error_in_value or temporal_error_in_position functions and should be combined to construct a global norm. For example, in fluids problems a suitable norm is usually the weighted sum of the errors in the velocities; for moving mesh problems is it usually better to use the weighted sum of the errors in position. </p>

<p>Reimplemented in <a class="el" href="../../d8/d28/classUnsteadyHeatProblem.html#a888e25dd97e89d31e485cb188721dbe1">UnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d68/classRefineableUnsteadyHeatProblem.html#a8db7ec06bde33713effabef4d4c4018d">RefineableUnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dc/dcc/classoomph_1_1ODEProblem.html#a19947f23aec606bd2176de8f02de904c">oomph::ODEProblem</a>, <a class="el" href="../../d7/d86/classSurfactantProblem.html#a3b52bc4385b5ece05f50f39de6297ffe">SurfactantProblem&lt; ELEMENT, INTERFACE_ELEMENT &gt;</a>, <a class="el" href="../../d7/d86/classSurfactantProblem.html#a3b52bc4385b5ece05f50f39de6297ffe">SurfactantProblem&lt; ELEMENT, INTERFACE_ELEMENT &gt;</a>, <a class="el" href="../../d7/d86/classSurfactantProblem.html#a3b52bc4385b5ece05f50f39de6297ffe">SurfactantProblem&lt; ELEMENT, INTERFACE_ELEMENT &gt;</a>, <a class="el" href="../../d9/d15/classInterfaceProblem.html#a5eb5fa3bf4e7884984f285e24ba3ee7b">InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d9/d15/classInterfaceProblem.html#a5eb5fa3bf4e7884984f285e24ba3ee7b">InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d4/d68/classRefineableUnsteadyHeatProblem.html#a8db7ec06bde33713effabef4d4c4018d">RefineableUnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/dec/classContactProblem.html#a43aaa820e0b6ae79cdafc9ec7f736dc3">ContactProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/dcb/classUnsteadyHeatMeltProblem.html#a6b561bcee148d213bfd2712a4e6eb0e4">UnsteadyHeatMeltProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d2/d8e/classSolarRadiationProblem.html#a51349f8e2191a77eb91fd3bad773dd8d">SolarRadiationProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d73/classMeltContactProblem.html#a659f14dbec78a3a4e5dcec54d3b68fb9">MeltContactProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d70/classVibratingShellProblem.html#a99dc30121e690b8df45af25100df70cf">VibratingShellProblem&lt; ELEMENT &gt;</a>, and <a class="el" href="../../dd/d7d/classAxisymmetricVibratingShellProblem.html#a52a857e14956dc7e23c62a8ccdd62141">AxisymmetricVibratingShellProblem&lt; ELEMENT &gt;</a>.</p>
<div class="fragment"><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    {</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;      <a class="code" href="../../d2/dc3/namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">std::string</a> error_message =</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;        <span class="stringliteral">&quot;The global_temporal_error_norm function will be problem-specific:\n&quot;</span>;</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;      error_message += <span class="stringliteral">&quot;Please write your own in your Problem class&quot;</span>;</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160; </div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;        error_message, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;      <span class="keywordflow">return</span> 0.0;</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, and <a class="el" href="../../d2/dc3/namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">oomph::Global_string_for_annotation::string()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a63805c549e71b7c73107abe6001fae25">adaptive_unsteady_newton_solve()</a>.</p>

</div>
</div>
<a id="a466d6110fd791b17e04a4100312787cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a466d6110fd791b17e04a4100312787cd">&#9670;&nbsp;</a></span>globally_convergent_line_search()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::globally_convergent_line_search </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>x_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>half_residual_squared_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;&#160;</td>
          <td class="paramname"><em>gradient</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;&#160;</td>
          <td class="paramname"><em>newton_dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>half_residual_squared</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>stpmax</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Line search helper for globally convergent Newton method. </p>
<p>Helper function for the globally convergent Newton solver. </p>
<div class="fragment"><div class="line"><a name="l09153"></a><span class="lineno"> 9153</span>&#160;  {</div>
<div class="line"><a name="l09154"></a><span class="lineno"> 9154</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> min_fct_decrease = 1.0e-4;</div>
<div class="line"><a name="l09155"></a><span class="lineno"> 9155</span>&#160;    <span class="keywordtype">double</span> convergence_tol_on_x = 1.0e-16;</div>
<div class="line"><a name="l09156"></a><span class="lineno"> 9156</span>&#160;    <span class="keywordtype">double</span> f_aux = 0.0;</div>
<div class="line"><a name="l09157"></a><span class="lineno"> 9157</span>&#160;    <span class="keywordtype">double</span> lambda_aux = 0.0;</div>
<div class="line"><a name="l09158"></a><span class="lineno"> 9158</span>&#160;    <span class="keywordtype">double</span> proposed_lambda;</div>
<div class="line"><a name="l09159"></a><span class="lineno"> 9159</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n_dof = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>();</div>
<div class="line"><a name="l09160"></a><span class="lineno"> 9160</span>&#160;    <span class="keywordtype">double</span> sum = 0.0;</div>
<div class="line"><a name="l09161"></a><span class="lineno"> 9161</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_dof; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l09162"></a><span class="lineno"> 9162</span>&#160;    {</div>
<div class="line"><a name="l09163"></a><span class="lineno"> 9163</span>&#160;      sum += newton_dir[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] * newton_dir[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l09164"></a><span class="lineno"> 9164</span>&#160;    }</div>
<div class="line"><a name="l09165"></a><span class="lineno"> 9165</span>&#160;    sum = <a class="code" href="../../d8/de9/AnnoyingScalar_8h.html#abe7b2405f1f05f9997193c680e8e2fe0">sqrt</a>(sum);</div>
<div class="line"><a name="l09166"></a><span class="lineno"> 9166</span>&#160;    <span class="keywordflow">if</span> (sum &gt; stpmax)</div>
<div class="line"><a name="l09167"></a><span class="lineno"> 9167</span>&#160;    {</div>
<div class="line"><a name="l09168"></a><span class="lineno"> 9168</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_dof; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l09169"></a><span class="lineno"> 9169</span>&#160;      {</div>
<div class="line"><a name="l09170"></a><span class="lineno"> 9170</span>&#160;        newton_dir[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] *= stpmax / sum;</div>
<div class="line"><a name="l09171"></a><span class="lineno"> 9171</span>&#160;      }</div>
<div class="line"><a name="l09172"></a><span class="lineno"> 9172</span>&#160;    }</div>
<div class="line"><a name="l09173"></a><span class="lineno"> 9173</span>&#160;    <span class="keywordtype">double</span> slope = 0.0;</div>
<div class="line"><a name="l09174"></a><span class="lineno"> 9174</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_dof; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l09175"></a><span class="lineno"> 9175</span>&#160;    {</div>
<div class="line"><a name="l09176"></a><span class="lineno"> 9176</span>&#160;      slope += gradient[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] * newton_dir[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l09177"></a><span class="lineno"> 9177</span>&#160;    }</div>
<div class="line"><a name="l09178"></a><span class="lineno"> 9178</span>&#160;    <span class="keywordflow">if</span> (slope &gt;= 0.0)</div>
<div class="line"><a name="l09179"></a><span class="lineno"> 9179</span>&#160;    {</div>
<div class="line"><a name="l09180"></a><span class="lineno"> 9180</span>&#160;      std::ostringstream warn_message;</div>
<div class="line"><a name="l09181"></a><span class="lineno"> 9181</span>&#160;      warn_message &lt;&lt; <span class="stringliteral">&quot;WARNING: Non-negative slope, probably due to a &quot;</span></div>
<div class="line"><a name="l09182"></a><span class="lineno"> 9182</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot; roundoff \nproblem in the linesearch: slope=&quot;</span> &lt;&lt; slope</div>
<div class="line"><a name="l09183"></a><span class="lineno"> 9183</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09184"></a><span class="lineno"> 9184</span>&#160;      OomphLibWarning(warn_message.str(),</div>
<div class="line"><a name="l09185"></a><span class="lineno"> 9185</span>&#160;                      <span class="stringliteral">&quot;Problem::globally_convergent_line_search()&quot;</span>,</div>
<div class="line"><a name="l09186"></a><span class="lineno"> 9186</span>&#160;                      <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l09187"></a><span class="lineno"> 9187</span>&#160;    }</div>
<div class="line"><a name="l09188"></a><span class="lineno"> 9188</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../df/d04/namespacetest.html">test</a> = 0.0;</div>
<div class="line"><a name="l09189"></a><span class="lineno"> 9189</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_dof; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l09190"></a><span class="lineno"> 9190</span>&#160;    {</div>
<div class="line"><a name="l09191"></a><span class="lineno"> 9191</span>&#160;      <span class="keywordtype">double</span> temp =</div>
<div class="line"><a name="l09192"></a><span class="lineno"> 9192</span>&#160;        <a class="code" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">std::fabs</a>(newton_dir[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]) / <a class="code" href="../../dc/d51/datatypes_8h.html#affe776513b24d84b39af8ab0930fef7f">std::max</a>(<a class="code" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">std::fabs</a>(x_old[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]), 1.0);</div>
<div class="line"><a name="l09193"></a><span class="lineno"> 9193</span>&#160;      <span class="keywordflow">if</span> (temp &gt; <a class="code" href="../../df/d04/namespacetest.html">test</a>) <a class="code" href="../../df/d04/namespacetest.html">test</a> = temp;</div>
<div class="line"><a name="l09194"></a><span class="lineno"> 9194</span>&#160;    }</div>
<div class="line"><a name="l09195"></a><span class="lineno"> 9195</span>&#160;    <span class="keywordtype">double</span> lambda_min = convergence_tol_on_x / <a class="code" href="../../d1/d62/namespaceEigen.html#ab92f68c35918b3afc48e0056a81ac1b3">test</a>;</div>
<div class="line"><a name="l09196"></a><span class="lineno"> 9196</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d6/d41/ComplexEigenSolver__compute_8cpp.html#a8a21c18d4aa23228bc1b89f9b12182be">lambda</a> = 1.0;</div>
<div class="line"><a name="l09197"></a><span class="lineno"> 9197</span>&#160;    <span class="keywordflow">while</span> (<span class="keyword">true</span>)</div>
<div class="line"><a name="l09198"></a><span class="lineno"> 9198</span>&#160;    {</div>
<div class="line"><a name="l09199"></a><span class="lineno"> 9199</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_dof; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l09200"></a><span class="lineno"> 9200</span>&#160;      {</div>
<div class="line"><a name="l09201"></a><span class="lineno"> 9201</span>&#160;        *<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = x_old[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] + <a class="code" href="../../d6/d41/ComplexEigenSolver__compute_8cpp.html#a8a21c18d4aa23228bc1b89f9b12182be">lambda</a> * newton_dir[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l09202"></a><span class="lineno"> 9202</span>&#160;      }</div>
<div class="line"><a name="l09203"></a><span class="lineno"> 9203</span>&#160; </div>
<div class="line"><a name="l09204"></a><span class="lineno"> 9204</span>&#160;      <span class="comment">// Evaluate current residuals</span></div>
<div class="line"><a name="l09205"></a><span class="lineno"> 9205</span>&#160;      <a class="code" href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a> residuals;</div>
<div class="line"><a name="l09206"></a><span class="lineno"> 9206</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a0103fe1a09ecf7e23a9083b35ef07aac">get_residuals</a>(residuals);</div>
<div class="line"><a name="l09207"></a><span class="lineno"> 9207</span>&#160;      half_residual_squared = 0.0;</div>
<div class="line"><a name="l09208"></a><span class="lineno"> 9208</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_dof; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l09209"></a><span class="lineno"> 9209</span>&#160;      {</div>
<div class="line"><a name="l09210"></a><span class="lineno"> 9210</span>&#160;        half_residual_squared += residuals[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] * residuals[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l09211"></a><span class="lineno"> 9211</span>&#160;      }</div>
<div class="line"><a name="l09212"></a><span class="lineno"> 9212</span>&#160;      half_residual_squared *= 0.5;</div>
<div class="line"><a name="l09213"></a><span class="lineno"> 9213</span>&#160; </div>
<div class="line"><a name="l09214"></a><span class="lineno"> 9214</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d41/ComplexEigenSolver__compute_8cpp.html#a8a21c18d4aa23228bc1b89f9b12182be">lambda</a> &lt; lambda_min)</div>
<div class="line"><a name="l09215"></a><span class="lineno"> 9215</span>&#160;      {</div>
<div class="line"><a name="l09216"></a><span class="lineno"> 9216</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_dof; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++) *<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = x_old[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l09217"></a><span class="lineno"> 9217</span>&#160; </div>
<div class="line"><a name="l09218"></a><span class="lineno"> 9218</span>&#160;        std::ostringstream warn_message;</div>
<div class="line"><a name="l09219"></a><span class="lineno"> 9219</span>&#160;        warn_message &lt;&lt; <span class="stringliteral">&quot;WARNING: Line search converged on x only!\n&quot;</span>;</div>
<div class="line"><a name="l09220"></a><span class="lineno"> 9220</span>&#160;        OomphLibWarning(warn_message.str(),</div>
<div class="line"><a name="l09221"></a><span class="lineno"> 9221</span>&#160;                        <span class="stringliteral">&quot;Problem::globally_convergent_line_search()&quot;</span>,</div>
<div class="line"><a name="l09222"></a><span class="lineno"> 9222</span>&#160;                        <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l09223"></a><span class="lineno"> 9223</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l09224"></a><span class="lineno"> 9224</span>&#160;      }</div>
<div class="line"><a name="l09225"></a><span class="lineno"> 9225</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (half_residual_squared &lt;=</div>
<div class="line"><a name="l09226"></a><span class="lineno"> 9226</span>&#160;               half_residual_squared_old + min_fct_decrease * <a class="code" href="../../d6/d41/ComplexEigenSolver__compute_8cpp.html#a8a21c18d4aa23228bc1b89f9b12182be">lambda</a> * slope)</div>
<div class="line"><a name="l09227"></a><span class="lineno"> 9227</span>&#160;      {</div>
<div class="line"><a name="l09228"></a><span class="lineno"> 9228</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Returning from linesearch with lambda=&quot;</span> &lt;&lt; <a class="code" href="../../d6/d41/ComplexEigenSolver__compute_8cpp.html#a8a21c18d4aa23228bc1b89f9b12182be">lambda</a></div>
<div class="line"><a name="l09229"></a><span class="lineno"> 9229</span>&#160;                   &lt;&lt; std::endl;</div>
<div class="line"><a name="l09230"></a><span class="lineno"> 9230</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l09231"></a><span class="lineno"> 9231</span>&#160;      }</div>
<div class="line"><a name="l09232"></a><span class="lineno"> 9232</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l09233"></a><span class="lineno"> 9233</span>&#160;      {</div>
<div class="line"><a name="l09234"></a><span class="lineno"> 9234</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d6/d41/ComplexEigenSolver__compute_8cpp.html#a8a21c18d4aa23228bc1b89f9b12182be">lambda</a> == 1.0)</div>
<div class="line"><a name="l09235"></a><span class="lineno"> 9235</span>&#160;        {</div>
<div class="line"><a name="l09236"></a><span class="lineno"> 9236</span>&#160;          proposed_lambda =</div>
<div class="line"><a name="l09237"></a><span class="lineno"> 9237</span>&#160;            -slope /</div>
<div class="line"><a name="l09238"></a><span class="lineno"> 9238</span>&#160;            (2.0 * (half_residual_squared - half_residual_squared_old - slope));</div>
<div class="line"><a name="l09239"></a><span class="lineno"> 9239</span>&#160;        }</div>
<div class="line"><a name="l09240"></a><span class="lineno"> 9240</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l09241"></a><span class="lineno"> 9241</span>&#160;        {</div>
<div class="line"><a name="l09242"></a><span class="lineno"> 9242</span>&#160;          <span class="keywordtype">double</span> r1 =</div>
<div class="line"><a name="l09243"></a><span class="lineno"> 9243</span>&#160;            half_residual_squared - half_residual_squared_old - <a class="code" href="../../d6/d41/ComplexEigenSolver__compute_8cpp.html#a8a21c18d4aa23228bc1b89f9b12182be">lambda</a> * slope;</div>
<div class="line"><a name="l09244"></a><span class="lineno"> 9244</span>&#160;          <span class="keywordtype">double</span> r2 = f_aux - half_residual_squared_old - lambda_aux * slope;</div>
<div class="line"><a name="l09245"></a><span class="lineno"> 9245</span>&#160;          <span class="keywordtype">double</span> a_poly =</div>
<div class="line"><a name="l09246"></a><span class="lineno"> 9246</span>&#160;            (r1 / (<a class="code" href="../../d6/d41/ComplexEigenSolver__compute_8cpp.html#a8a21c18d4aa23228bc1b89f9b12182be">lambda</a> * <a class="code" href="../../d6/d41/ComplexEigenSolver__compute_8cpp.html#a8a21c18d4aa23228bc1b89f9b12182be">lambda</a>) - r2 / (lambda_aux * lambda_aux)) /</div>
<div class="line"><a name="l09247"></a><span class="lineno"> 9247</span>&#160;            (<a class="code" href="../../d6/d41/ComplexEigenSolver__compute_8cpp.html#a8a21c18d4aa23228bc1b89f9b12182be">lambda</a> - lambda_aux);</div>
<div class="line"><a name="l09248"></a><span class="lineno"> 9248</span>&#160;          <span class="keywordtype">double</span> b_poly = (-lambda_aux * r1 / (<a class="code" href="../../d6/d41/ComplexEigenSolver__compute_8cpp.html#a8a21c18d4aa23228bc1b89f9b12182be">lambda</a> * <a class="code" href="../../d6/d41/ComplexEigenSolver__compute_8cpp.html#a8a21c18d4aa23228bc1b89f9b12182be">lambda</a>) +</div>
<div class="line"><a name="l09249"></a><span class="lineno"> 9249</span>&#160;                           <a class="code" href="../../d6/d41/ComplexEigenSolver__compute_8cpp.html#a8a21c18d4aa23228bc1b89f9b12182be">lambda</a> * r2 / (lambda_aux * lambda_aux)) /</div>
<div class="line"><a name="l09250"></a><span class="lineno"> 9250</span>&#160;                          (<a class="code" href="../../d6/d41/ComplexEigenSolver__compute_8cpp.html#a8a21c18d4aa23228bc1b89f9b12182be">lambda</a> - lambda_aux);</div>
<div class="line"><a name="l09251"></a><span class="lineno"> 9251</span>&#160;          <span class="keywordflow">if</span> (a_poly == 0.0)</div>
<div class="line"><a name="l09252"></a><span class="lineno"> 9252</span>&#160;          {</div>
<div class="line"><a name="l09253"></a><span class="lineno"> 9253</span>&#160;            proposed_lambda = -slope / (2.0 * b_poly);</div>
<div class="line"><a name="l09254"></a><span class="lineno"> 9254</span>&#160;          }</div>
<div class="line"><a name="l09255"></a><span class="lineno"> 9255</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l09256"></a><span class="lineno"> 9256</span>&#160;          {</div>
<div class="line"><a name="l09257"></a><span class="lineno"> 9257</span>&#160;            <span class="keywordtype">double</span> discriminant = b_poly * b_poly - 3.0 * a_poly * slope;</div>
<div class="line"><a name="l09258"></a><span class="lineno"> 9258</span>&#160;            <span class="keywordflow">if</span> (discriminant &lt; 0.0)</div>
<div class="line"><a name="l09259"></a><span class="lineno"> 9259</span>&#160;            {</div>
<div class="line"><a name="l09260"></a><span class="lineno"> 9260</span>&#160;              proposed_lambda = 0.5 * <a class="code" href="../../d6/d41/ComplexEigenSolver__compute_8cpp.html#a8a21c18d4aa23228bc1b89f9b12182be">lambda</a>;</div>
<div class="line"><a name="l09261"></a><span class="lineno"> 9261</span>&#160;            }</div>
<div class="line"><a name="l09262"></a><span class="lineno"> 9262</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (b_poly &lt;= 0.0)</div>
<div class="line"><a name="l09263"></a><span class="lineno"> 9263</span>&#160;            {</div>
<div class="line"><a name="l09264"></a><span class="lineno"> 9264</span>&#160;              proposed_lambda = (-b_poly + <a class="code" href="../../d8/de9/AnnoyingScalar_8h.html#abe7b2405f1f05f9997193c680e8e2fe0">sqrt</a>(discriminant)) / (3.0 * a_poly);</div>
<div class="line"><a name="l09265"></a><span class="lineno"> 9265</span>&#160;            }</div>
<div class="line"><a name="l09266"></a><span class="lineno"> 9266</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l09267"></a><span class="lineno"> 9267</span>&#160;            {</div>
<div class="line"><a name="l09268"></a><span class="lineno"> 9268</span>&#160;              proposed_lambda = -slope / (b_poly + <a class="code" href="../../d8/de9/AnnoyingScalar_8h.html#abe7b2405f1f05f9997193c680e8e2fe0">sqrt</a>(discriminant));</div>
<div class="line"><a name="l09269"></a><span class="lineno"> 9269</span>&#160;            }</div>
<div class="line"><a name="l09270"></a><span class="lineno"> 9270</span>&#160;          }</div>
<div class="line"><a name="l09271"></a><span class="lineno"> 9271</span>&#160;          <span class="keywordflow">if</span> (proposed_lambda &gt; 0.5 * <a class="code" href="../../d6/d41/ComplexEigenSolver__compute_8cpp.html#a8a21c18d4aa23228bc1b89f9b12182be">lambda</a>)</div>
<div class="line"><a name="l09272"></a><span class="lineno"> 9272</span>&#160;          {</div>
<div class="line"><a name="l09273"></a><span class="lineno"> 9273</span>&#160;            proposed_lambda = 0.5 * <a class="code" href="../../d6/d41/ComplexEigenSolver__compute_8cpp.html#a8a21c18d4aa23228bc1b89f9b12182be">lambda</a>;</div>
<div class="line"><a name="l09274"></a><span class="lineno"> 9274</span>&#160;          }</div>
<div class="line"><a name="l09275"></a><span class="lineno"> 9275</span>&#160;        }</div>
<div class="line"><a name="l09276"></a><span class="lineno"> 9276</span>&#160;      }</div>
<div class="line"><a name="l09277"></a><span class="lineno"> 9277</span>&#160;      lambda_aux = <a class="code" href="../../d6/d41/ComplexEigenSolver__compute_8cpp.html#a8a21c18d4aa23228bc1b89f9b12182be">lambda</a>;</div>
<div class="line"><a name="l09278"></a><span class="lineno"> 9278</span>&#160;      f_aux = half_residual_squared;</div>
<div class="line"><a name="l09279"></a><span class="lineno"> 9279</span>&#160;      <a class="code" href="../../d6/d41/ComplexEigenSolver__compute_8cpp.html#a8a21c18d4aa23228bc1b89f9b12182be">lambda</a> = <a class="code" href="../../dc/d51/datatypes_8h.html#affe776513b24d84b39af8ab0930fef7f">std::max</a>(proposed_lambda, 0.1 * <a class="code" href="../../d6/d41/ComplexEigenSolver__compute_8cpp.html#a8a21c18d4aa23228bc1b89f9b12182be">lambda</a>);</div>
<div class="line"><a name="l09280"></a><span class="lineno"> 9280</span>&#160;    }</div>
<div class="line"><a name="l09281"></a><span class="lineno"> 9281</span>&#160;  }</div>
<div class="ttc" id="anamespaceEigen_html_ab92f68c35918b3afc48e0056a81ac1b3"><div class="ttname"><a href="../../d1/d62/namespaceEigen.html#ab92f68c35918b3afc48e0056a81ac1b3">Eigen::test</a></div><div class="ttdeci">squared absolute sa ArrayBase::abs2 DOXCOMMA MatrixBase::cwiseAbs2 sa Eigen::abs2 DOXCOMMA Eigen::pow DOXCOMMA ArrayBase::square nearest sa Eigen::floor DOXCOMMA Eigen::ceil DOXCOMMA ArrayBase::round nearest integer not less than the given sa Eigen::floor DOXCOMMA ArrayBase::ceil not a number test</div><div class="ttdef"><b>Definition:</b> GlobalFunctions.h:109</div></div>
<div class="ttc" id="anamespacetest_html"><div class="ttname"><a href="../../df/d04/namespacetest.html">test</a></div><div class="ttdef"><b>Definition:</b> indexed_view.cpp:20</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>, <a class="el" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">boost::multiprecision::fabs()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a0103fe1a09ecf7e23a9083b35ef07aac">get_residuals()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../d6/d41/ComplexEigenSolver__compute_8cpp.html#a8a21c18d4aa23228bc1b89f9b12182be">lambda</a>, <a class="el" href="../../dc/d51/datatypes_8h.html#affe776513b24d84b39af8ab0930fef7f">max</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, <a class="el" href="../../d8/de9/AnnoyingScalar_8h.html#abe7b2405f1f05f9997193c680e8e2fe0">sqrt()</a>, and <a class="el" href="../../d1/d62/namespaceEigen.html#ab92f68c35918b3afc48e0056a81ac1b3">Eigen::test</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aae8cf62757e432b625ec81fad1559dc3">newton_solve()</a>.</p>

</div>
</div>
<a id="a5f7e9e91eab83d600c94afdad532a6fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f7e9e91eab83d600c94afdad532a6fb">&#9670;&nbsp;</a></span>initialise_dt() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::initialise_dt </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>dt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set all timesteps to the same value, dt, and assign weights for all timesteppers in the problem</p>
<p>Set all timesteps to the same value, dt, and assign weights for all timesteppers in the problem. </p>
<div class="fragment"><div class="line"><a name="l13232"></a><span class="lineno">13232</span>&#160;  {</div>
<div class="line"><a name="l13233"></a><span class="lineno">13233</span>&#160;    <span class="comment">// Initialise the timesteps in the Problem&#39;s time object</span></div>
<div class="line"><a name="l13234"></a><span class="lineno">13234</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae33fbf5f34a7d06d88ad2c98538bbbe8">Time_pt</a>-&gt;<a class="code" href="../../d0/da1/classoomph_1_1Time.html#abc1e02cc2988b603bd5e1f6747381546">initialise_dt</a>(dt);</div>
<div class="line"><a name="l13235"></a><span class="lineno">13235</span>&#160; </div>
<div class="line"><a name="l13236"></a><span class="lineno">13236</span>&#160;    <span class="comment">// Find out how many timesteppers there are</span></div>
<div class="line"><a name="l13237"></a><span class="lineno">13237</span>&#160;    <span class="keywordtype">unsigned</span> n_time_steppers = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ace3cdf55009c3bff21d2b7d3706d522a">ntime_stepper</a>();</div>
<div class="line"><a name="l13238"></a><span class="lineno">13238</span>&#160; </div>
<div class="line"><a name="l13239"></a><span class="lineno">13239</span>&#160;    <span class="comment">// Loop over them all and set the weights</span></div>
<div class="line"><a name="l13240"></a><span class="lineno">13240</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_time_steppers; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l13241"></a><span class="lineno">13241</span>&#160;    {</div>
<div class="line"><a name="l13242"></a><span class="lineno">13242</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)-&gt;<a class="code" href="../../d5/d19/classoomph_1_1TimeStepper.html#a028fa3a8d3c6db6b0ddf580cb0468d55">set_weights</a>();</div>
<div class="line"><a name="l13243"></a><span class="lineno">13243</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)-&gt;adaptive_flag())</div>
<div class="line"><a name="l13244"></a><span class="lineno">13244</span>&#160;      {</div>
<div class="line"><a name="l13245"></a><span class="lineno">13245</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)-&gt;<a class="code" href="../../d5/d19/classoomph_1_1TimeStepper.html#aee0c1da870a603e64efebb51dfc96a3d">set_error_weights</a>();</div>
<div class="line"><a name="l13246"></a><span class="lineno">13246</span>&#160;      }</div>
<div class="line"><a name="l13247"></a><span class="lineno">13247</span>&#160;    }</div>
<div class="line"><a name="l13248"></a><span class="lineno">13248</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1Time_html_abc1e02cc2988b603bd5e1f6747381546"><div class="ttname"><a href="../../d0/da1/classoomph_1_1Time.html#abc1e02cc2988b603bd5e1f6747381546">oomph::Time::initialise_dt</a></div><div class="ttdeci">void initialise_dt(const double &amp;dt_)</div><div class="ttdoc">Set all timesteps to the same value, dt.</div><div class="ttdef"><b>Definition:</b> timesteppers.h:99</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../d0/da1/classoomph_1_1Time.html#abc1e02cc2988b603bd5e1f6747381546">oomph::Time::initialise_dt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ace3cdf55009c3bff21d2b7d3706d522a">ntime_stepper()</a>, <a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html#aee0c1da870a603e64efebb51dfc96a3d">oomph::TimeStepper::set_error_weights()</a>, <a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html#a028fa3a8d3c6db6b0ddf580cb0468d55">oomph::TimeStepper::set_weights()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae33fbf5f34a7d06d88ad2c98538bbbe8">Time_pt</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6affe0af3093f94c348d9a3d008dde08">assign_initial_values_impulsive()</a>, <a class="el" href="../../da/db6/classFSIRingProblem.html#acbb3bc5cd6d16cfee7a2f19a3b984ce7">FSIRingProblem::dynamic_run()</a>, <a class="el" href="../../d7/d5d/two__layer__interface__nonaxisym__perturbations_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, <a class="el" href="../../dd/d71/classOscRingNStProblem.html#a33023787bdd34ada9fae40f1b32ca339">OscRingNStProblem&lt; ELEMENT &gt;::OscRingNStProblem()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a4f6011ef141cc68598a9502052129a3f">read()</a>.</p>

</div>
</div>
<a id="ab0e7f2cd5d6d7fe4fc16c34acd213f8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0e7f2cd5d6d7fe4fc16c34acd213f8a">&#9670;&nbsp;</a></span>initialise_dt() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::initialise_dt </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>dt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the value of the timesteps to be equal to the values passed in a vector and assign weights for all timesteppers in the problem </p>
<div class="fragment"><div class="line"><a name="l13255"></a><span class="lineno">13255</span>&#160;  {</div>
<div class="line"><a name="l13256"></a><span class="lineno">13256</span>&#160;    <span class="comment">// Initialise the timesteps in the Problem&#39;s time object</span></div>
<div class="line"><a name="l13257"></a><span class="lineno">13257</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae33fbf5f34a7d06d88ad2c98538bbbe8">Time_pt</a>-&gt;<a class="code" href="../../d0/da1/classoomph_1_1Time.html#abc1e02cc2988b603bd5e1f6747381546">initialise_dt</a>(dt);</div>
<div class="line"><a name="l13258"></a><span class="lineno">13258</span>&#160; </div>
<div class="line"><a name="l13259"></a><span class="lineno">13259</span>&#160;    <span class="comment">// Find out how many timesteppers there are</span></div>
<div class="line"><a name="l13260"></a><span class="lineno">13260</span>&#160;    <span class="keywordtype">unsigned</span> n_time_steppers = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ace3cdf55009c3bff21d2b7d3706d522a">ntime_stepper</a>();</div>
<div class="line"><a name="l13261"></a><span class="lineno">13261</span>&#160; </div>
<div class="line"><a name="l13262"></a><span class="lineno">13262</span>&#160;    <span class="comment">// Loop over them all and set the weights</span></div>
<div class="line"><a name="l13263"></a><span class="lineno">13263</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_time_steppers; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l13264"></a><span class="lineno">13264</span>&#160;    {</div>
<div class="line"><a name="l13265"></a><span class="lineno">13265</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)-&gt;<a class="code" href="../../d5/d19/classoomph_1_1TimeStepper.html#a028fa3a8d3c6db6b0ddf580cb0468d55">set_weights</a>();</div>
<div class="line"><a name="l13266"></a><span class="lineno">13266</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)-&gt;adaptive_flag())</div>
<div class="line"><a name="l13267"></a><span class="lineno">13267</span>&#160;      {</div>
<div class="line"><a name="l13268"></a><span class="lineno">13268</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)-&gt;<a class="code" href="../../d5/d19/classoomph_1_1TimeStepper.html#aee0c1da870a603e64efebb51dfc96a3d">set_error_weights</a>();</div>
<div class="line"><a name="l13269"></a><span class="lineno">13269</span>&#160;      }</div>
<div class="line"><a name="l13270"></a><span class="lineno">13270</span>&#160;    }</div>
<div class="line"><a name="l13271"></a><span class="lineno">13271</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../d0/da1/classoomph_1_1Time.html#abc1e02cc2988b603bd5e1f6747381546">oomph::Time::initialise_dt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ace3cdf55009c3bff21d2b7d3706d522a">ntime_stepper()</a>, <a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html#aee0c1da870a603e64efebb51dfc96a3d">oomph::TimeStepper::set_error_weights()</a>, <a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html#a028fa3a8d3c6db6b0ddf580cb0468d55">oomph::TimeStepper::set_weights()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae33fbf5f34a7d06d88ad2c98538bbbe8">Time_pt</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt()</a>.</p>

</div>
</div>
<a id="a41a7b9cf8e6fe1156fc92baa43c3fe4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41a7b9cf8e6fe1156fc92baa43c3fe4b">&#9670;&nbsp;</a></span>is_dparameter_calculated_analytically()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::Problem::is_dparameter_calculated_analytically </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;&#160;</td>
          <td class="paramname"><em>parameter_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Function to determine whether the parameter derivatives are calculated analytically </p>
<div class="fragment"><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    {</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      <span class="comment">// If the entry is found then the iterator returned from the find</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      <span class="comment">// command will NOT be equal to the end and the expression will</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      <span class="comment">// return true, otherwise it will return false</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      <span class="keywordflow">return</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae22f10c348ef8afeb1bfd8609cd6a319">Calculate_dparameter_analytic</a>.find(parameter_pt) !=</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;              <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae22f10c348ef8afeb1bfd8609cd6a319">Calculate_dparameter_analytic</a>.end());</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1Problem_html_ae22f10c348ef8afeb1bfd8609cd6a319"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#ae22f10c348ef8afeb1bfd8609cd6a319">oomph::Problem::Calculate_dparameter_analytic</a></div><div class="ttdeci">std::map&lt; double *, bool &gt; Calculate_dparameter_analytic</div><div class="ttdef"><b>Definition:</b> problem.h:239</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae22f10c348ef8afeb1bfd8609cd6a319">Calculate_dparameter_analytic</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#adc456017cfc4fb4ae6f522973e50f496">get_derivative_wrt_global_parameter()</a>.</p>

</div>
</div>
<a id="a5c864f0dfc4f0ff33e07935944b7b435"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c864f0dfc4f0ff33e07935944b7b435">&#9670;&nbsp;</a></span>jacobian_reuse_is_enabled()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::Problem::jacobian_reuse_is_enabled </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Is recycling of Jacobian in Newton iteration enabled? </p>
<div class="fragment"><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;    {</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a022796f2c96f2dff6ed1db2338c93aaf">Jacobian_reuse_is_enabled</a>;</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a022796f2c96f2dff6ed1db2338c93aaf">Jacobian_reuse_is_enabled</a>.</p>

</div>
</div>
<a id="a689687cacc40dd351430545a7041f44c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a689687cacc40dd351430545a7041f44c">&#9670;&nbsp;</a></span>linear_solver_pt() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html">LinearSolver</a>*&amp; oomph::Problem::linear_solver_pt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return a pointer to the linear solver object. </p>
<div class="fragment"><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    {</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a>;</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/dcb/classoomph_1_1FoldHandler.html#add39896d007559f4fb801f1c95e4ab16">oomph::FoldHandler::FoldHandler()</a>, <a class="el" href="../../dd/d4a/classFSIChannelWithLeafletProblem.html#aaa0a455e91c4fb2dd9696607b802d01b">FSIChannelWithLeafletProblem&lt; ELEMENT &gt;::FSIChannelWithLeafletProblem()</a>, <a class="el" href="../../d4/da2/classoomph_1_1HopfHandler.html#ac219516b8263300eb5102d38baab05d7">oomph::HopfHandler::HopfHandler()</a>, <a class="el" href="../../d4/d6b/three__d__mesh__dist_8cc.html#a3e9491dd4f7081f92d170df562503838">parallel_test()</a>, <a class="el" href="../../d5/d62/classPerturbedStateProblem.html#a49c677252dd9ecfdc115a72167663b37">PerturbedStateProblem&lt; BASE_ELEMENT, PERTURBED_ELEMENT &gt;::PerturbedStateProblem()</a>, <a class="el" href="../../d5/dc5/classoomph_1_1ProjectionProblem.html#ad972f78212e515a03d1018996115265a">oomph::ProjectionProblem&lt; PROJECTABLE_ELEMENT &gt;::project()</a>, <a class="el" href="../../d2/d5a/classoomph_1_1SolidICProblem.html#a07e954c951e4eefa7ac7c99ba74e81cc">oomph::SolidICProblem::set_newmark_initial_condition_consistently()</a>, <a class="el" href="../../d1/d59/classoomph_1_1ANASAZI.html#af3084c6ec6fc86b5758bb853088c7f8a">oomph::ANASAZI::solve_eigenproblem()</a>, <a class="el" href="../../d1/dfc/classTurekProblem.html#a69f6624fd854393f0c0e5303603ec749">TurekProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;::TurekProblem()</a>, <a class="el" href="../../d4/dcb/classoomph_1_1FoldHandler.html#ab582d9ac969e0f7779a285d21a6d8e45">oomph::FoldHandler::~FoldHandler()</a>, <a class="el" href="../../d4/da2/classoomph_1_1HopfHandler.html#a2b2822861fc417fea32cbba38f9dd650">oomph::HopfHandler::~HopfHandler()</a>, and <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a69c6b0b6aedd03d828d295531fd61820">oomph::PitchForkHandler::~PitchForkHandler()</a>.</p>

</div>
</div>
<a id="a50b5365e0de1212b9c07f41ae9deab5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50b5365e0de1212b9c07f41ae9deab5a">&#9670;&nbsp;</a></span>linear_solver_pt() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html">LinearSolver</a>* const&amp; oomph::Problem::linear_solver_pt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return a pointer to the linear solver object (const version) </p>
<div class="fragment"><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;    {</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a>;</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a>.</p>

</div>
</div>
<a id="a1b10f0b678c60eaaa8bccb74ed1740f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b10f0b678c60eaaa8bccb74ed1740f0">&#9670;&nbsp;</a></span>make_copy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> * Problem::make_copy </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Make and return a pointer to the copy of the problem. A virtual function that must be filled in by the user is they wish to perform adaptive refinement in bifurcation tracking or in multigrid problems. ALH: WILL NOT BE NECESSARY IN BIFURCATION TRACKING IN LONG RUN... </p>

<p>Reimplemented in <a class="el" href="../../da/dec/classABCProblem.html#a2aac1ffe0fee1582976fb95e74ffc159">ABCProblem&lt; ELEMENT, TIMESTEPPERT &gt;</a>, <a class="el" href="../../d0/d33/classRefineablePorousChannelProblem.html#adc6469d9c18d35a4803b8efab415cc28">RefineablePorousChannelProblem&lt; ELEMENT &gt;</a>, and <a class="el" href="../../dc/d83/classFlowAroundCylinderProblem.html#aabb31c44d75aa5e5bbddfdaae2f53ec6">FlowAroundCylinderProblem&lt; ELEMENT &gt;</a>.</p>
<div class="fragment"><div class="line"><a name="l12012"></a><span class="lineno">12012</span>&#160;  {</div>
<div class="line"><a name="l12013"></a><span class="lineno">12013</span>&#160;    std::ostringstream error_stream;</div>
<div class="line"><a name="l12014"></a><span class="lineno">12014</span>&#160;    error_stream</div>
<div class="line"><a name="l12015"></a><span class="lineno">12015</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;This function must be overloaded in your specific problem, and must\n&quot;</span></div>
<div class="line"><a name="l12016"></a><span class="lineno">12016</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;create an exact copy of your problem. Usually this will be achieved\n&quot;</span></div>
<div class="line"><a name="l12017"></a><span class="lineno">12017</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;by a call to the constructor with exactly the same arguments as &quot;</span></div>
<div class="line"><a name="l12018"></a><span class="lineno">12018</span>&#160;         <span class="stringliteral">&quot;used\n&quot;</span>;</div>
<div class="line"><a name="l12019"></a><span class="lineno">12019</span>&#160; </div>
<div class="line"><a name="l12020"></a><span class="lineno">12020</span>&#160;    <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l12021"></a><span class="lineno">12021</span>&#160;      error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l12022"></a><span class="lineno">12022</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, and <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5e60c7b47591bca6b20b0612e119983">adapt()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa0b4e7868e02e2d12845c9b2dd60cab9">bifurcation_adapt_helper()</a>.</p>

</div>
</div>
<a id="afa46c693258868c126503cce3a663a85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa46c693258868c126503cce3a663a85">&#9670;&nbsp;</a></span>mass_matrix_reuse_is_enabled()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::Problem::mass_matrix_reuse_is_enabled </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return whether the mass matrix is being reused. </p>
<div class="fragment"><div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;    {</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#af4d25809ac090102a4d4a398e4ad0e26">Mass_matrix_reuse_is_enabled</a>;</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af4d25809ac090102a4d4a398e4ad0e26">Mass_matrix_reuse_is_enabled</a>.</p>

</div>
</div>
<a id="a93304d0c6be1022b944f21c0f4c07eab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93304d0c6be1022b944f21c0f4c07eab">&#9670;&nbsp;</a></span>mass_matrix_solver_for_explicit_timestepper_pt() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html">LinearSolver</a>*&amp; oomph::Problem::mass_matrix_solver_for_explicit_timestepper_pt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Return a pointer to the linear solver object used for explicit time stepping. </p>
<div class="fragment"><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;    {</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad4b9d15269f624044d1730957b0a8c19">Mass_matrix_solver_for_explicit_timestepper_pt</a>;</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad4b9d15269f624044d1730957b0a8c19">Mass_matrix_solver_for_explicit_timestepper_pt</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5ee48c16fce89952a019a844ac386655">get_inverse_mass_matrix_times_residuals()</a>.</p>

</div>
</div>
<a id="a10ffcfbf305940a05452d950df7a11c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10ffcfbf305940a05452d950df7a11c3">&#9670;&nbsp;</a></span>mass_matrix_solver_for_explicit_timestepper_pt() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html">LinearSolver</a>* oomph::Problem::mass_matrix_solver_for_explicit_timestepper_pt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Return a pointer to the linear solver object used for explicit time stepping (const version). </p>
<div class="fragment"><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;    {</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad4b9d15269f624044d1730957b0a8c19">Mass_matrix_solver_for_explicit_timestepper_pt</a>;</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad4b9d15269f624044d1730957b0a8c19">Mass_matrix_solver_for_explicit_timestepper_pt</a>.</p>

</div>
</div>
<a id="aa30b2e89f61a327ffb1be4ff30bb868f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa30b2e89f61a327ffb1be4ff30bb868f">&#9670;&nbsp;</a></span>max_newton_iterations()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&amp; oomph::Problem::max_newton_iterations </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Access function to max Newton iterations before giving up. </p>
<div class="fragment"><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;    {</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a52a58a98c3e2e7dbaefcfb1ee7830c35">Max_newton_iterations</a>;</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a52a58a98c3e2e7dbaefcfb1ee7830c35">Max_newton_iterations</a>.</p>

</div>
</div>
<a id="a2ad78241135f621df36bc1b9634845ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ad78241135f621df36bc1b9634845ac">&#9670;&nbsp;</a></span>max_residuals()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a>&amp; oomph::Problem::max_residuals </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Access function to max residuals in Newton iterations before giving up. </p>
<div class="fragment"><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;    {</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accb8811cdf32f14be497917e922c623e">Max_residuals</a>;</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accb8811cdf32f14be497917e922c623e">Max_residuals</a>.</p>

</div>
</div>
<a id="ac5355154d4991ec634e74d4817176f5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5355154d4991ec634e74d4817176f5f">&#9670;&nbsp;</a></span>maximum_dt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a>&amp; oomph::Problem::maximum_dt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Access function to max timestep in adaptive timestepping. </p>
<div class="fragment"><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;    {</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a7b5fde48b00a7fdc5f1fbbee138d0414">Maximum_dt</a>;</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7b5fde48b00a7fdc5f1fbbee138d0414">Maximum_dt</a>.</p>

</div>
</div>
<a id="aad122d70a22dc5302cfd5853d3cf3057"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad122d70a22dc5302cfd5853d3cf3057">&#9670;&nbsp;</a></span>mesh_pt() <span class="overload">[1/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a>*&amp; oomph::Problem::mesh_pt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return a pointer to the global mesh. </p>
<div class="fragment"><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;    {</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>;</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d9e/classoomph_1_1IMRByBDF.html#a1eb1b47643bf37e27c478c6987c7716d">oomph::IMRByBDF::actions_after_timestep()</a>, <a class="el" href="../../df/d5e/classoomph_1_1RefineableTetgenMesh.html#ad75ff5f1e088e611311c3f6a30feea5b">oomph::RefineableTetgenMesh&lt; ELEMENT &gt;::adapt()</a>, <a class="el" href="../../de/dbb/classoomph_1_1RefineableGmshTetMesh.html#ad3ee00690d125ab8211f64d5c85dd3b9">oomph::RefineableGmshTetMesh&lt; ELEMENT &gt;::adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5e60c7b47591bca6b20b0612e119983">adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a309487c952f108015b53a2d70539ac8b">adapt_based_on_error_estimates()</a>, <a class="el" href="../../d2/da2/classoomph_1_1PeriodicOrbitAssemblyHandler.html#a358d1749faa8ac7dd0de87340d878088">oomph::PeriodicOrbitAssemblyHandler&lt; NNODE_1D &gt;::adapt_temporal_mesh()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a0cd05109bc2c003c5c0686e6aa55d847">add_sub_mesh()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers()</a>, <a class="el" href="../../d2/d5a/classoomph_1_1SolidICProblem.html#a14343410dca129169282dd6d5081813d">oomph::SolidICProblem::backup_original_state()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa0b4e7868e02e2d12845c9b2dd60cab9">bifurcation_adapt_helper()</a>, <a class="el" href="../../dd/dce/classBoussinesqPreconditioner.html#a38c8274448d271efec45bfa92a042233">BoussinesqPreconditioner::BoussinesqPreconditioner()</a>, <a class="el" href="../../d9/d2f/classAdvectionProblem.html#a3fa094d9b4c982556adeed274d26a14d">AdvectionProblem::compute_error()</a>, <a class="el" href="../../de/dbb/classTwoDDGProblem.html#a26e781658acb9e4461272d1a7b64d85a">TwoDDGProblem&lt; ELEMENT &gt;::compute_error()</a>, <a class="el" href="../../d1/d67/classContinuationProblem.html#a1623b61c6120511aab039894891a14ab">ContinuationProblem::ContinuationProblem()</a>, <a class="el" href="../../d2/da4/classContProblem.html#a6f3dba73bd8553bf9eff4bbf5a47f65f">ContProblem&lt; ELEMENT &gt;::ContProblem()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab8b63040a3c6deff68fb2128c2f7fef2">copy()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae796d578da9c7578742f7a6e1f5d0c0a">delete_all_external_storage()</a>, <a class="el" href="../../db/d7a/classDGProblem.html#afa5d7c1e44e2aaf57030a340d72b4d6b">DGProblem&lt; ELEMENT &gt;::DGProblem()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a368ac86b9807c29864de42a872fd534f">disable_mass_matrix_reuse()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#adfa6431916fd73b661d8a62706d5137f">doc_errors()</a>, <a class="el" href="../../da/dcc/classoomph_1_1FpPressureAdvectionDiffusionProblem.html#aa58589dc1ce278655255588f0006b530">oomph::FpPressureAdvectionDiffusionProblem&lt; ELEMENT &gt;::doc_solution()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a1756534851a763f35fd5372b4d3723e0">dump()</a>, <a class="el" href="../../dc/dcc/classoomph_1_1ODEProblem.html#a8abfcac4c5c916ed5e40b60db48763cd">oomph::ODEProblem::element_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#add951d12e349d0c220c3dd808962f4ae">enable_mass_matrix_reuse()</a>, <a class="el" href="../../dc/dcc/classoomph_1_1ODEProblem.html#a4f329a17f568a3a1a243ffee8a51886d">oomph::ODEProblem::exact_solution()</a>, <a class="el" href="../../de/da7/classoomph_1_1SegregatableFSIProblem.html#a0e67b39cdae35ea25ef97e5e768aa60a">oomph::SegregatableFSIProblem::extrapolate_solid_data()</a>, <a class="el" href="../../df/da7/classFluxPoissonProblem.html#a1b57e0c67634586cb69fbeeec7874e36">FluxPoissonProblem&lt; ELEMENT &gt;::FluxPoissonProblem()</a>, <a class="el" href="../../d4/dcb/classoomph_1_1FoldHandler.html#add39896d007559f4fb801f1c95e4ab16">oomph::FoldHandler::FoldHandler()</a>, <a class="el" href="../../da/dcc/classoomph_1_1FpPressureAdvectionDiffusionProblem.html#a6e592be14db55b57bf8045c5c7d1993b">oomph::FpPressureAdvectionDiffusionProblem&lt; ELEMENT &gt;::FpPressureAdvectionDiffusionProblem()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a2bd35d5954b6a8d43189b84520adb4b3">get_all_error_estimates()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#adb5998dfed961de76c33ae3b6fa516b4">get_dofs()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a497518acb5d30a28a253890c3d2a5da2">get_hessian_vector_products()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5ee48c16fce89952a019a844ac386655">get_inverse_mass_matrix_times_residuals()</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ac3f40f62d33d33616cdb4bed48aaccde">oomph::NavierStokesSchurComplementPreconditioner::get_pressure_advection_diffusion_matrix()</a>, <a class="el" href="../../d4/dcb/classoomph_1_1FoldHandler.html#abfbec6da3dffeaf3b4df0ee4955101fd">oomph::FoldHandler::get_residuals()</a>, <a class="el" href="../../d4/da2/classoomph_1_1HopfHandler.html#a61a4006161da6532a9acfec0f979aafa">oomph::HopfHandler::get_residuals()</a>, <a class="el" href="../../dc/dcc/classoomph_1_1ODEProblem.html#a19947f23aec606bd2176de8f02de904c">oomph::ODEProblem::global_temporal_error_norm()</a>, <a class="el" href="../../d4/da2/classoomph_1_1HopfHandler.html#ac219516b8263300eb5102d38baab05d7">oomph::HopfHandler::HopfHandler()</a>, <a class="el" href="../../d9/d15/classInterfaceProblem.html#a2ecc265740dba1626344fc090fad5fa6">InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;::InterfaceProblem()</a>, <a class="el" href="../../dc/d83/classFlowAroundCylinderProblem.html#abd9ac1ddbdfaccd75064b7d42af5a484">FlowAroundCylinderProblem&lt; ELEMENT &gt;::mesh_pt()</a>, <a class="el" href="../../d0/d33/classRefineablePorousChannelProblem.html#a8e571bb501e221e214549cbc18036296">RefineablePorousChannelProblem&lt; ELEMENT &gt;::mesh_pt()</a>, <a class="el" href="../../de/dbb/classTwoDDGProblem.html#ad3abae2d3b7ce9a7abb10ae8f7443548">TwoDDGProblem&lt; ELEMENT &gt;::mesh_pt()</a>, <a class="el" href="../../d1/d1f/classRefineableConvectionProblem.html#ada1c6ce04ae80af75c24b7fd409826cf">RefineableConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;::mesh_pt()</a>, <a class="el" href="../../d3/d00/classConvectionProblem.html#a3d31d8f0136d88a9880f59c889dd2bcc">ConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;::mesh_pt()</a>, <a class="el" href="../../da/d36/classThermalProblem.html#ac1ebc681e22c65c384aa63a7e9da6129">ThermalProblem&lt; ELEMENT &gt;::mesh_pt()</a>, <a class="el" href="../../d4/d6f/classoomph_1_1StreamfunctionProblem.html#a799907c3712b34ef62780e4e3c1a389e">oomph::StreamfunctionProblem::mesh_pt()</a>, <a class="el" href="../../d6/df2/classTestPoissonProblem.html#a7cf149040f8e6512d63f3d52e18976fa">TestPoissonProblem&lt; ELEMENT &gt;::mesh_pt()</a>, <a class="el" href="../../d8/d9f/classTestRefineablePoissonProblem.html#a4f7e3ff1d28426eed95fa94e022ed8ad">TestRefineablePoissonProblem&lt; ELEMENT &gt;::mesh_pt()</a>, <a class="el" href="../../dc/dcc/classoomph_1_1ODEProblem.html#aa55d25af220a29969ad9b2ce91f8d56a">oomph::ODEProblem::my_set_initial_condition()</a>, <a class="el" href="../../d0/dd0/classOneDPoissonProblem.html#ab814af5dfd3b7ae665cd20e27da5d9ae">OneDPoissonProblem&lt; ELEMENT &gt;::OneDPoissonProblem()</a>, <a class="el" href="../../de/db1/classoomph_1_1LinearElasticitySmoothMesh.html#a7546b06ebbc89a348df4c2a8774147ec">oomph::LinearElasticitySmoothMesh&lt; LINEAR_ELASTICITY_ELEMENT &gt;::operator()()</a>, <a class="el" href="../../d5/df9/classoomph_1_1PoissonSmoothMesh.html#ad0a3d661fd2048fa4967e68ffeb1d630">oomph::PoissonSmoothMesh&lt; POISSON_ELEMENT &gt;::operator()()</a>, <a class="el" href="../../d2/da2/classoomph_1_1PeriodicOrbitAssemblyHandler.html#a51b7db6467c46b417b3e630d0ef96a8f">oomph::PeriodicOrbitAssemblyHandler&lt; NNODE_1D &gt;::orbit_output()</a>, <a class="el" href="../../dc/db9/classOrrSommerfeldProblem.html#aaa5b04805113cefc7a352483c53e149e">OrrSommerfeldProblem&lt; ELEMENT &gt;::OrrSommerfeldProblem()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a350e611af4847eabfa1d531b14b4439c">p_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad73bff32f14763e813cabdcd4c88c06">p_refine_selected_elements()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a093b78c1820cf3fe6bd9ec3deb605b49">p_refine_uniformly()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7460f9339fd4850112284a86e039ee00">p_refine_uniformly_aux()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#afa0aab9ca7018bf875c1f3367c6c07e3">p_unrefine_uniformly()</a>, <a class="el" href="../../d7/db6/namespaceoomph_1_1METIS.html#aa3c7e4be46d6148cc60f43354127fc94">oomph::METIS::partition_mesh()</a>, <a class="el" href="../../d5/dc5/classoomph_1_1ProjectionProblem.html#a9c24751d48a454956517a8541c423cf2">oomph::ProjectionProblem&lt; PROJECTABLE_ELEMENT &gt;::pin_all()</a>, <a class="el" href="../../da/dcc/classoomph_1_1FpPressureAdvectionDiffusionProblem.html#a7c1c429ed80863d9de3f3dd1bf8d1b3c">oomph::FpPressureAdvectionDiffusionProblem&lt; ELEMENT &gt;::pin_all_non_pressure_dofs()</a>, <a class="el" href="../../d5/dc5/classoomph_1_1ProjectionProblem.html#ade05dce90814098ec0af15324b758730">oomph::ProjectionProblem&lt; PROJECTABLE_ELEMENT &gt;::pin_dofs_of_coordinate()</a>, <a class="el" href="../../d5/dc5/classoomph_1_1ProjectionProblem.html#acff96fd0e3dda445ba806e253988c547">oomph::ProjectionProblem&lt; PROJECTABLE_ELEMENT &gt;::pin_dofs_of_field()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a96e0343c261d087f5d67a49f68561d96">oomph::PitchForkHandler::PitchForkHandler()</a>, <a class="el" href="../../da/d5c/two__d__biharmonic_8cc.html#aaf86cbb9382472f2caf899c2372dba7c">print_connectivity_matrix()</a>, <a class="el" href="../../da/d5c/two__d__biharmonic_8cc.html#a17b0c8d4bd94d77ee7f90bfb24cb068c">print_elemental_jacobian()</a>, <a class="el" href="../../d5/dc5/classoomph_1_1ProjectionProblem.html#ad972f78212e515a03d1018996115265a">oomph::ProjectionProblem&lt; PROJECTABLE_ELEMENT &gt;::project()</a>, <a class="el" href="../../d1/d35/classQFaceTestProblem.html#a2b557ca660a98fbe5d7f566c9ae32fa6">QFaceTestProblem&lt; ELEMENT &gt;::QFaceTestProblem()</a>, <a class="el" href="../../d8/d66/classQuarterCircleDrivenCavityProblem.html#ae5fd69acf7d28a600cb6aa0bbb6a341c">QuarterCircleDrivenCavityProblem&lt; ELEMENT &gt;::QuarterCircleDrivenCavityProblem()</a>, <a class="el" href="../../d4/d6c/classQuarterCircleDrivenCavityProblem2.html#a301f6d2c50e2d266126a80956397d78d">QuarterCircleDrivenCavityProblem2&lt; ELEMENT &gt;::QuarterCircleDrivenCavityProblem2()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a4f6011ef141cc68598a9502052129a3f">read()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a3dcfc37fe1b6c21d694407981830c1e5">refine_selected_elements()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a1ce3a9162aaef9e0a4d86f8de57eb523">refine_uniformly()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#affb22db0c6f1e14ae120b153b85831a3">refine_uniformly_aux()</a>, <a class="el" href="../../d0/d33/classRefineablePorousChannelProblem.html#a7097b6a1b320844fce84f8761f6c8585">RefineablePorousChannelProblem&lt; ELEMENT &gt;::RefineablePorousChannelProblem()</a>, <a class="el" href="../../de/d04/classoomph_1_1HSL__MA42.html#a6ea4a5adf63088f155b81ab650f44347">oomph::HSL_MA42::reorder_elements()</a>, <a class="el" href="../../d2/d5a/classoomph_1_1SolidICProblem.html#aa2cb88ac90e7d24cdd63a08a8a35eed6">oomph::SolidICProblem::reset_original_state()</a>, <a class="el" href="../../da/dcc/classoomph_1_1FpPressureAdvectionDiffusionProblem.html#ad7d514f813007a3b381a2eb7a930f19e">oomph::FpPressureAdvectionDiffusionProblem&lt; ELEMENT &gt;::reset_pin_status()</a>, <a class="el" href="../../dd/d4b/classoomph_1_1AugmentedBlockFoldLinearSolver.html#a7728fc74802b6802ed966765bc1e62d9">oomph::AugmentedBlockFoldLinearSolver::resolve()</a>, <a class="el" href="../../de/d72/classoomph_1_1AugmentedBlockPitchForkLinearSolver.html#a1d617896a3f1c1b1236ff18dc87ed8d7">oomph::AugmentedBlockPitchForkLinearSolver::resolve()</a>, <a class="el" href="../../d5/dc5/classoomph_1_1ProjectionProblem.html#aeb3c03ed8381f389d3d598487b6fb987">oomph::ProjectionProblem&lt; PROJECTABLE_ELEMENT &gt;::restore_positions()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7b7f290d47c78868860cb3561f1c6443">self_test()</a>, <a class="el" href="../../d5/dc5/classoomph_1_1ProjectionProblem.html#ad8f93fb7e51a0e427b634d4dac8e96a3">oomph::ProjectionProblem&lt; PROJECTABLE_ELEMENT &gt;::set_coordinate_for_projection()</a>, <a class="el" href="../../d5/dc5/classoomph_1_1ProjectionProblem.html#a616f08ea08e8f1ba6be018e966f38830">oomph::ProjectionProblem&lt; PROJECTABLE_ELEMENT &gt;::set_current_field_for_projection()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac3ec67f2c633cc414905ade9fa148939">set_dofs()</a>, <a class="el" href="../../d9/d2f/classAdvectionProblem.html#ad9c951370b2014cb081cc09b1f3f4a03">AdvectionProblem::set_initial_conditions()</a>, <a class="el" href="../../d4/dbc/classEulerProblem.html#a712eb74fc9ce4d6d55ec0ce39dec676b">EulerProblem::set_initial_conditions()</a>, <a class="el" href="../../d5/dc5/classoomph_1_1ProjectionProblem.html#a944bed6fe67a6e683d3c7eb242705b6e">oomph::ProjectionProblem&lt; PROJECTABLE_ELEMENT &gt;::set_lagrangian_coordinate_for_projection()</a>, <a class="el" href="../../d2/d5a/classoomph_1_1SolidICProblem.html#a07e954c951e4eefa7ac7c99ba74e81cc">oomph::SolidICProblem::set_newmark_initial_condition_consistently()</a>, <a class="el" href="../../d2/d5a/classoomph_1_1SolidICProblem.html#ac88248cf3c1b9353724deb2e0d0e1f39">oomph::SolidICProblem::set_newmark_initial_condition_directly()</a>, <a class="el" href="../../d2/d5a/classoomph_1_1SolidICProblem.html#a60e1dccbc8627a07bfcb38a55b0669ca">oomph::SolidICProblem::set_static_initial_condition()</a>, <a class="el" href="../../d5/dc5/classoomph_1_1ProjectionProblem.html#a935983de617d4fb2feeef674af13d473">oomph::ProjectionProblem&lt; PROJECTABLE_ELEMENT &gt;::set_time_level_for_projection()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aae085671047b62a98ef310d66cc3f412">setup_element_count_per_dof()</a>, <a class="el" href="../../d2/d5a/classoomph_1_1SolidICProblem.html#a4bbb8c404d1f4ea3827a2c64ae9e06de">oomph::SolidICProblem::setup_problem()</a>, <a class="el" href="../../de/da7/classoomph_1_1SegregatableFSIProblem.html#a12e662227e5daf656244a531f40022f9">oomph::SegregatableFSIProblem::setup_segregated_solver()</a>, <a class="el" href="../../d2/d5a/classoomph_1_1SolidICProblem.html#ae1dd84a4e5df9eb444dd82531847ab79">oomph::SolidICProblem::SolidICProblem()</a>, <a class="el" href="../../dc/dcc/classoomph_1_1ODEProblem.html#a4fc4bb7b4c17fadcd1a2bdce6e6e74e2">oomph::ODEProblem::solution()</a>, <a class="el" href="../../dd/d4b/classoomph_1_1AugmentedBlockFoldLinearSolver.html#a11690b33089e999d0c894b4e4b0646d9">oomph::AugmentedBlockFoldLinearSolver::solve()</a>, <a class="el" href="../../de/d72/classoomph_1_1AugmentedBlockPitchForkLinearSolver.html#a0cbeb150ac83d5be1a1e30c0f728a70b">oomph::AugmentedBlockPitchForkLinearSolver::solve()</a>, <a class="el" href="../../df/dbd/classoomph_1_1BlockHopfLinearSolver.html#a5e9ff24466ec138cca8264e5befc31fe">oomph::BlockHopfLinearSolver::solve()</a>, <a class="el" href="../../de/d04/classoomph_1_1HSL__MA42.html#ae796a6b14c13d1cdb7bf49ca3c7c5aec">oomph::HSL_MA42::solve()</a>, <a class="el" href="../../dc/d2e/classoomph_1_1MGSolver.html#a68f8c874b922c5b67e73c836048e34f5">oomph::MGSolver&lt; DIM &gt;::solve()</a>, <a class="el" href="../../d7/d86/classoomph_1_1HelmholtzGMRESMG.html#a5806236b991ac2d7fe4bc7a4f19e98fb">oomph::HelmholtzGMRESMG&lt; MATRIX &gt;::solve()</a>, <a class="el" href="../../df/df9/classoomph_1_1HelmholtzFGMRESMG.html#a36a1d601676df2ebe39fcdb7a0837864">oomph::HelmholtzFGMRESMG&lt; MATRIX &gt;::solve()</a>, <a class="el" href="../../de/d04/classoomph_1_1HSL__MA42.html#a79fca4aba6935fc5376cd9fa33a05f6a">oomph::HSL_MA42::solve_for_one_dof()</a>, <a class="el" href="../../df/dbd/classoomph_1_1BlockHopfLinearSolver.html#a9a7cc6bda9ab1a8baf83d5d8e1fe5eea">oomph::BlockHopfLinearSolver::solve_for_two_rhs()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa90e41a626a91ee113989afa847c1117">sparse_assemble_row_or_column_compressed_with_lists()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7ba1b95df63f6e7d746a6dae641daa33">sparse_assemble_row_or_column_compressed_with_maps()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a23465a0b1944a4bd31b9e0add9cc9875">sparse_assemble_row_or_column_compressed_with_two_arrays()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5bc761a0dee39437b2ebeba75079856f">sparse_assemble_row_or_column_compressed_with_two_vectors()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7eb5e0e3dc02fa26eec9d023b80b9603">sparse_assemble_row_or_column_compressed_with_vectors_of_pairs()</a>, <a class="el" href="../../d5/dc5/classoomph_1_1ProjectionProblem.html#a5518d9926a396536ea3d24a13e0a6a71">oomph::ProjectionProblem&lt; PROJECTABLE_ELEMENT &gt;::store_positions()</a>, <a class="el" href="../../d4/d6f/classoomph_1_1StreamfunctionProblem.html#aa5e022deaab5947d7df85040dc6e8135">oomph::StreamfunctionProblem::StreamfunctionProblem()</a>, <a class="el" href="../../dd/d0a/classTFaceTestProblem.html#aa2512908d333be36b33491f3542bfb4c">TFaceTestProblem&lt; ELEMENT &gt;::TFaceTestProblem()</a>, <a class="el" href="../../da/d36/classThermalProblem.html#a12ad5d383929b1ef4ed29503c5a271b0">ThermalProblem&lt; ELEMENT &gt;::ThermalProblem()</a>, <a class="el" href="../../d9/d17/classTriangleFaceTestProblem.html#af1db34f37e47b1f744870cf2e38633dc">TriangleFaceTestProblem&lt; ELEMENT &gt;::TriangleFaceTestProblem()</a>, <a class="el" href="../../d1/dfc/classTurekProblem.html#a69f6624fd854393f0c0e5303603ec749">TurekProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;::TurekProblem()</a>, <a class="el" href="../../de/dbb/classTwoDDGProblem.html#ab7c1060d1118024f7db31fd9bf7bd90e">TwoDDGProblem&lt; ELEMENT &gt;::TwoDDGProblem()</a>, <a class="el" href="../../d7/db6/namespaceoomph_1_1METIS.html#a58831157b0cfadc57485c3de01df7d78">oomph::METIS::uniform_partition_mesh()</a>, <a class="el" href="../../d5/dc5/classoomph_1_1ProjectionProblem.html#ac0b06207d156be752a3fccfab654826e">oomph::ProjectionProblem&lt; PROJECTABLE_ELEMENT &gt;::unpin_all()</a>, <a class="el" href="../../d5/dc5/classoomph_1_1ProjectionProblem.html#a50b3643c4e6942755e1ede1c0ab417ec">oomph::ProjectionProblem&lt; PROJECTABLE_ELEMENT &gt;::unpin_dofs_of_coordinate()</a>, <a class="el" href="../../d5/dc5/classoomph_1_1ProjectionProblem.html#a36847f48bff4081b5db0c038ddba1260">oomph::ProjectionProblem&lt; PROJECTABLE_ELEMENT &gt;::unpin_dofs_of_field()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a56429d79e517d59a54cd49949b04d3ae">unrefine_uniformly()</a>, <a class="el" href="../../da/dcc/classoomph_1_1FpPressureAdvectionDiffusionProblem.html#ae24eef02cff52b57dca6c1daf274bab2">oomph::FpPressureAdvectionDiffusionProblem&lt; ELEMENT &gt;::validate()</a>, <a class="el" href="../../d3/d73/classoomph_1_1WomersleyProblem.html#adc4074cd09df4505feb27e22abb6922a">oomph::WomersleyProblem&lt; ELEMENT, DIM &gt;::WomersleyProblem()</a>, <a class="el" href="../../d9/d2f/classAdvectionProblem.html#a39cb875aeae961753edec474bd465020">AdvectionProblem::~AdvectionProblem()</a>, <a class="el" href="../../d4/dbc/classEulerProblem.html#a0fc9120cd4f110e98501bcbf82e96307">EulerProblem::~EulerProblem()</a>, <a class="el" href="../../d1/d1f/classRefineableConvectionProblem.html#a43fc2693230601928578d5b0c6380943">RefineableConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;::~RefineableConvectionProblem()</a>, and <a class="el" href="../../de/dbb/classTwoDDGProblem.html#a5761276a5f00fa4705f7f3640a192b7b">TwoDDGProblem&lt; ELEMENT &gt;::~TwoDDGProblem()</a>.</p>

</div>
</div>
<a id="a3a2e53542288a4140ea5b076ffa648db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a2e53542288a4140ea5b076ffa648db">&#9670;&nbsp;</a></span>mesh_pt() <span class="overload">[2/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a>* const&amp; oomph::Problem::mesh_pt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return a pointer to the global mesh (const version) </p>
<div class="fragment"><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    {</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>;</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>.</p>

</div>
</div>
<a id="ac9d882b768345fd916079ec184764f72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9d882b768345fd916079ec184764f72">&#9670;&nbsp;</a></span>mesh_pt() <span class="overload">[3/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a>*&amp; oomph::Problem::mesh_pt </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>imesh</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Return a pointer to the i-th submesh. If there are no submeshes, the 0-th submesh is the global mesh itself. </p>
<div class="fragment"><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    {</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;      <span class="comment">// If there are no submeshes then the zero-th submesh is the</span></div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;      <span class="comment">// mesh itself</span></div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab65f6fc9c49860e6324457a7e6e76346">Sub_mesh_pt</a>.size() == 0) &amp;&amp; (imesh == 0))</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;      {</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>;</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;      }</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;      {</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab65f6fc9c49860e6324457a7e6e76346">Sub_mesh_pt</a>[imesh];</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;      }</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab65f6fc9c49860e6324457a7e6e76346">Sub_mesh_pt</a>.</p>

</div>
</div>
<a id="a35b503d711781552b6b56deb612816c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35b503d711781552b6b56deb612816c4">&#9670;&nbsp;</a></span>mesh_pt() <span class="overload">[4/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a>* const&amp; oomph::Problem::mesh_pt </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>imesh</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return a pointer to the i-th submesh (const version) </p>
<div class="fragment"><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    {</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;      <span class="comment">// If there are no submeshes then the zero-th submesh is the</span></div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;      <span class="comment">// mesh itself</span></div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab65f6fc9c49860e6324457a7e6e76346">Sub_mesh_pt</a>.size() == 0) &amp;&amp; (imesh == 0))</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;      {</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>;</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;      }</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;      {</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab65f6fc9c49860e6324457a7e6e76346">Sub_mesh_pt</a>[imesh];</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;      }</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab65f6fc9c49860e6324457a7e6e76346">Sub_mesh_pt</a>.</p>

</div>
</div>
<a id="adffc8921bf61edac68ed017bcdc1d792"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adffc8921bf61edac68ed017bcdc1d792">&#9670;&nbsp;</a></span>minimum_dt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a>&amp; oomph::Problem::minimum_dt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Access function to min timestep in adaptive timestepping. </p>
<div class="fragment"><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;    {</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad7456318933aa01114dc78498bfd6d79">Minimum_dt</a>;</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad7456318933aa01114dc78498bfd6d79">Minimum_dt</a>.</p>

</div>
</div>
<a id="a218d4dfff74bc14f3f5dc8416236e01d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a218d4dfff74bc14f3f5dc8416236e01d">&#9670;&nbsp;</a></span>ndof()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long oomph::Problem::ndof </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the number of dofs. </p>
<div class="fragment"><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;    {</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#aafad0b69de2284808366b65bd63e493b">nrow</a>();</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1LinearAlgebraDistribution_html_aafad0b69de2284808366b65bd63e493b"><div class="ttname"><a href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#aafad0b69de2284808366b65bd63e493b">oomph::LinearAlgebraDistribution::nrow</a></div><div class="ttdeci">unsigned nrow() const</div><div class="ttdoc">access function to the number of global rows.</div><div class="ttdef"><b>Definition:</b> linear_algebra_distribution.h:186</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>, and <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#aafad0b69de2284808366b65bd63e493b">oomph::LinearAlgebraDistribution::nrow()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d9e/classoomph_1_1IMRByBDF.html#a1eb1b47643bf37e27c478c6987c7716d">oomph::IMRByBDF::actions_after_timestep()</a>, <a class="el" href="../../dd/d9e/classoomph_1_1IMRByBDF.html#abc155a68889d297f732a083d911b4627">oomph::IMRByBDF::actions_before_timestep()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5e60c7b47591bca6b20b0612e119983">adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa3393dfcbf36c6198aead92c08ab95d0">add_eigenvector_to_dofs()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#abb1221f3e6605bf134cc6be3ff297016">add_to_dofs()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ada703cde7417adda572a72d05ddfa4b9">assign_eigenvector_to_dofs()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa0b4e7868e02e2d12845c9b2dd60cab9">bifurcation_adapt_helper()</a>, <a class="el" href="../../dc/dcc/classoomph_1_1ODEProblem.html#a5a65df4e54b467fe55881669f5edeac3">oomph::ODEProblem::build()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a83463b9e0d3ebf86085c48c0e98c8f10">calculate_continuation_derivatives()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acbc0b0fc5d5cc76ce8384bc0bd815f26">calculate_predictions()</a>, <a class="el" href="../../d4/dcb/classoomph_1_1FoldHandler.html#add39896d007559f4fb801f1c95e4ab16">oomph::FoldHandler::FoldHandler()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a11c1432869386bb49f16da15545bfee7">get_dofs()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a4e59f1c854d1258aa2b4eca218405731">get_eigenproblem_matrices()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a9f3d1c9378e385d7755184a97f5f6f91">get_fd_jacobian()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5ee48c16fce89952a019a844ac386655">get_inverse_mass_matrix_times_residuals()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af660c2c0d10eaea1972314ce80de000e">get_jacobian()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a0103fe1a09ecf7e23a9083b35ef07aac">get_residuals()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a466d6110fd791b17e04a4100312787cd">globally_convergent_line_search()</a>, <a class="el" href="../../d4/da2/classoomph_1_1HopfHandler.html#ac219516b8263300eb5102d38baab05d7">oomph::HopfHandler::HopfHandler()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aae8cf62757e432b625ec81fad1559dc3">newton_solve()</a>, <a class="el" href="../../d4/d6b/three__d__mesh__dist_8cc.html#a3e9491dd4f7081f92d170df562503838">parallel_test()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a96e0343c261d087f5d67a49f68561d96">oomph::PitchForkHandler::PitchForkHandler()</a>, <a class="el" href="../../db/dc7/classoomph_1_1MGPreconditioner.html#afa4c545cc49e9712e4d68f5c0275aefe">oomph::MGPreconditioner&lt; DIM &gt;::preconditioner_solve()</a>, <a class="el" href="../../de/d04/classoomph_1_1HSL__MA42.html#a6ea4a5adf63088f155b81ab650f44347">oomph::HSL_MA42::reorder_elements()</a>, <a class="el" href="../../dd/d4b/classoomph_1_1AugmentedBlockFoldLinearSolver.html#a7728fc74802b6802ed966765bc1e62d9">oomph::AugmentedBlockFoldLinearSolver::resolve()</a>, <a class="el" href="../../de/d72/classoomph_1_1AugmentedBlockPitchForkLinearSolver.html#a1d617896a3f1c1b1236ff18dc87ed8d7">oomph::AugmentedBlockPitchForkLinearSolver::resolve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a3c927ed4f3e79527e0e23ac44779f0f8">restore_dof_values()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a07c3df43aef20537f8d192c2fc203836">set_dofs()</a>, <a class="el" href="../../dd/d4b/classoomph_1_1AugmentedBlockFoldLinearSolver.html#a11690b33089e999d0c894b4e4b0646d9">oomph::AugmentedBlockFoldLinearSolver::solve()</a>, <a class="el" href="../../de/d72/classoomph_1_1AugmentedBlockPitchForkLinearSolver.html#a0cbeb150ac83d5be1a1e30c0f728a70b">oomph::AugmentedBlockPitchForkLinearSolver::solve()</a>, <a class="el" href="../../df/dbd/classoomph_1_1BlockHopfLinearSolver.html#a5e9ff24466ec138cca8264e5befc31fe">oomph::BlockHopfLinearSolver::solve()</a>, <a class="el" href="../../de/d04/classoomph_1_1HSL__MA42.html#ae796a6b14c13d1cdb7bf49ca3c7c5aec">oomph::HSL_MA42::solve()</a>, <a class="el" href="../../d3/d90/classoomph_1_1GS.html#ad7d1bfb3d25a194d2875e266e104dc9f">oomph::GS&lt; MATRIX &gt;::solve()</a>, <a class="el" href="../../dc/df6/classoomph_1_1GS_3_01CRDoubleMatrix_01_4.html#a85164d55db2ab10404d5679657e8f6de">oomph::GS&lt; CRDoubleMatrix &gt;::solve()</a>, <a class="el" href="../../d7/d2e/classoomph_1_1DampedJacobi.html#ace422835d94b7d465d08cc1f4df192ea">oomph::DampedJacobi&lt; MATRIX &gt;::solve()</a>, <a class="el" href="../../d5/dee/classoomph_1_1GMRES.html#ade0f569ecda6b63d3e77dfe07a19cb13">oomph::GMRES&lt; MATRIX &gt;::solve()</a>, <a class="el" href="../../d2/d08/classoomph_1_1AugmentedProblemGMRES.html#a73d8d3d8b161084e6291560cdd7984dc">oomph::AugmentedProblemGMRES::solve()</a>, <a class="el" href="../../d3/d06/classoomph_1_1DenseLU.html#ac354b224819146618ce8a1396f8f980e">oomph::DenseLU::solve()</a>, <a class="el" href="../../d0/d00/classoomph_1_1FD__LU.html#a6fd251bef9cdb7efbed4927f005eda2f">oomph::FD_LU::solve()</a>, <a class="el" href="../../d7/db1/classoomph_1_1SuperLUSolver.html#a5a121df89c72a8741d051aa176b12255">oomph::SuperLUSolver::solve()</a>, <a class="el" href="../../d6/d11/classoomph_1_1MumpsSolver.html#ae0346a464f3ed74bfcca4063bdeed3ad">oomph::MumpsSolver::solve()</a>, <a class="el" href="../../d7/d86/classoomph_1_1HelmholtzGMRESMG.html#a5806236b991ac2d7fe4bc7a4f19e98fb">oomph::HelmholtzGMRESMG&lt; MATRIX &gt;::solve()</a>, <a class="el" href="../../df/df9/classoomph_1_1HelmholtzFGMRESMG.html#a36a1d601676df2ebe39fcdb7a0837864">oomph::HelmholtzFGMRESMG&lt; MATRIX &gt;::solve()</a>, <a class="el" href="../../d6/d35/classoomph_1_1ARPACK.html#a22a914045a51a8ad89158cffd81127fe">oomph::ARPACK::solve_eigenproblem()</a>, <a class="el" href="../../d0/d43/classoomph_1_1LAPACK__QZ.html#a6f06580f8907d38c7e7c36e12da44b59">oomph::LAPACK_QZ::solve_eigenproblem()</a>, <a class="el" href="../../de/d04/classoomph_1_1HSL__MA42.html#a79fca4aba6935fc5376cd9fa33a05f6a">oomph::HSL_MA42::solve_for_one_dof()</a>, <a class="el" href="../../df/dbd/classoomph_1_1BlockHopfLinearSolver.html#a9a7cc6bda9ab1a8baf83d5d8e1fe5eea">oomph::BlockHopfLinearSolver::solve_for_two_rhs()</a>, <a class="el" href="../../d7/db1/classoomph_1_1SuperLUSolver.html#a10bdce2b176a3ca514b82f66cd50e037">oomph::SuperLUSolver::solve_transpose()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa90e41a626a91ee113989afa847c1117">sparse_assemble_row_or_column_compressed_with_lists()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7ba1b95df63f6e7d746a6dae641daa33">sparse_assemble_row_or_column_compressed_with_maps()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a23465a0b1944a4bd31b9e0add9cc9875">sparse_assemble_row_or_column_compressed_with_two_arrays()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5bc761a0dee39437b2ebeba75079856f">sparse_assemble_row_or_column_compressed_with_two_vectors()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7eb5e0e3dc02fa26eec9d023b80b9603">sparse_assemble_row_or_column_compressed_with_vectors_of_pairs()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac3ed0463968bd0fef5d9b97bcb8ca163">store_current_dof_values()</a>.</p>

</div>
</div>
<a id="aae8cf62757e432b625ec81fad1559dc3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae8cf62757e432b625ec81fad1559dc3">&#9670;&nbsp;</a></span>newton_solve() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::newton_solve </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Use Newton method to solve the problem. </p>
<p>General Newton solver. Requires only a convergence tolerance. The linear solver takes a pointer to the problem (which defines the Jacobian <b>J</b> and the residual Vector <b>r</b>) and returns the solution <b>x</b> of the system </p><p class="formulaDsp">
\[ {\bf J} {\bf x} = - \bf{r} \]
</p>
<p>. </p>
<div class="fragment"><div class="line"><a name="l08784"></a><span class="lineno"> 8784</span>&#160;  {</div>
<div class="line"><a name="l08785"></a><span class="lineno"> 8785</span>&#160;    <span class="comment">// Initialise timers</span></div>
<div class="line"><a name="l08786"></a><span class="lineno"> 8786</span>&#160;    <span class="keywordtype">double</span> total_linear_solver_time = 0.0;</div>
<div class="line"><a name="l08787"></a><span class="lineno"> 8787</span>&#160;    <span class="keywordtype">double</span> t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l08788"></a><span class="lineno"> 8788</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab6f510bea9bdfcaf229415440a0a1c98">Max_res</a>.clear();</div>
<div class="line"><a name="l08789"></a><span class="lineno"> 8789</span>&#160; </div>
<div class="line"><a name="l08790"></a><span class="lineno"> 8790</span>&#160;    <span class="comment">// Find total number of dofs</span></div>
<div class="line"><a name="l08791"></a><span class="lineno"> 8791</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n_dofs = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>();</div>
<div class="line"><a name="l08792"></a><span class="lineno"> 8792</span>&#160; </div>
<div class="line"><a name="l08793"></a><span class="lineno"> 8793</span>&#160;    <span class="comment">// Set up the Vector to hold the solution</span></div>
<div class="line"><a name="l08794"></a><span class="lineno"> 8794</span>&#160;    <a class="code" href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a> dx;</div>
<div class="line"><a name="l08795"></a><span class="lineno"> 8795</span>&#160; </div>
<div class="line"><a name="l08796"></a><span class="lineno"> 8796</span>&#160;    <span class="comment">//-----Variables for the globally convergent Newton method------</span></div>
<div class="line"><a name="l08797"></a><span class="lineno"> 8797</span>&#160; </div>
<div class="line"><a name="l08798"></a><span class="lineno"> 8798</span>&#160;    <span class="comment">// Set up the vector to hold the gradient</span></div>
<div class="line"><a name="l08799"></a><span class="lineno"> 8799</span>&#160;    <a class="code" href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a> gradient;</div>
<div class="line"><a name="l08800"></a><span class="lineno"> 8800</span>&#160; </div>
<div class="line"><a name="l08801"></a><span class="lineno"> 8801</span>&#160;    <span class="comment">// Other variables</span></div>
<div class="line"><a name="l08802"></a><span class="lineno"> 8802</span>&#160;    <span class="keywordtype">double</span> half_residual_squared = 0.0;</div>
<div class="line"><a name="l08803"></a><span class="lineno"> 8803</span>&#160;    <span class="keywordtype">double</span> max_step = 0.0;</div>
<div class="line"><a name="l08804"></a><span class="lineno"> 8804</span>&#160; </div>
<div class="line"><a name="l08805"></a><span class="lineno"> 8805</span>&#160;    <span class="comment">//--------------------------------------------------------------</span></div>
<div class="line"><a name="l08806"></a><span class="lineno"> 8806</span>&#160; </div>
<div class="line"><a name="l08807"></a><span class="lineno"> 8807</span>&#160;    <span class="comment">// Set the counter</span></div>
<div class="line"><a name="l08808"></a><span class="lineno"> 8808</span>&#160;    <span class="keywordtype">unsigned</span> count = 0;</div>
<div class="line"><a name="l08809"></a><span class="lineno"> 8809</span>&#160;    <span class="comment">// Set the loop flag</span></div>
<div class="line"><a name="l08810"></a><span class="lineno"> 8810</span>&#160;    <span class="keywordtype">unsigned</span> LOOP_FLAG = 1;</div>
<div class="line"><a name="l08811"></a><span class="lineno"> 8811</span>&#160; </div>
<div class="line"><a name="l08812"></a><span class="lineno"> 8812</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#acf8b1ec937efdf2a0f892a41c18c0c53">Use_globally_convergent_newton_method</a>)</div>
<div class="line"><a name="l08813"></a><span class="lineno"> 8813</span>&#160;    {</div>
<div class="line"><a name="l08814"></a><span class="lineno"> 8814</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l08815"></a><span class="lineno"> 8815</span>&#160;      <span class="comment">// Break if running in parallel</span></div>
<div class="line"><a name="l08816"></a><span class="lineno"> 8816</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../df/d58/classoomph_1_1MPI__Helpers.html#aa376d403f6bc99e8595d227135932b0e">MPI_Helpers::mpi_has_been_initialised</a>())</div>
<div class="line"><a name="l08817"></a><span class="lineno"> 8817</span>&#160;      {</div>
<div class="line"><a name="l08818"></a><span class="lineno"> 8818</span>&#160;        std::ostringstream error_stream;</div>
<div class="line"><a name="l08819"></a><span class="lineno"> 8819</span>&#160;        error_stream &lt;&lt; <span class="stringliteral">&quot;Globally convergent Newton method has not been &quot;</span></div>
<div class="line"><a name="l08820"></a><span class="lineno"> 8820</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;implemented in parallel yet!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l08821"></a><span class="lineno"> 8821</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l08822"></a><span class="lineno"> 8822</span>&#160;          error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l08823"></a><span class="lineno"> 8823</span>&#160;      }</div>
<div class="line"><a name="l08824"></a><span class="lineno"> 8824</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l08825"></a><span class="lineno"> 8825</span>&#160; </div>
<div class="line"><a name="l08826"></a><span class="lineno"> 8826</span>&#160;      <span class="comment">// Get gradient</span></div>
<div class="line"><a name="l08827"></a><span class="lineno"> 8827</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a>-&gt;<a class="code" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a37f1f8b8c6d45115e649739abd5d2f5d">enable_computation_of_gradient</a>();</div>
<div class="line"><a name="l08828"></a><span class="lineno"> 8828</span>&#160;      <span class="comment">// Reset the gradient (clear it), since the number of dofs and</span></div>
<div class="line"><a name="l08829"></a><span class="lineno"> 8829</span>&#160;      <span class="comment">// hence the size of the DoubleVector might have changed</span></div>
<div class="line"><a name="l08830"></a><span class="lineno"> 8830</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a>-&gt;<a class="code" href="../../d5/dd7/classoomph_1_1LinearSolver.html#aceef502cbdf826cdf6aa31f5803982e0">reset_gradient</a>();</div>
<div class="line"><a name="l08831"></a><span class="lineno"> 8831</span>&#160;    }</div>
<div class="line"><a name="l08832"></a><span class="lineno"> 8832</span>&#160; </div>
<div class="line"><a name="l08833"></a><span class="lineno"> 8833</span>&#160;    <span class="comment">// Update anything that needs updating</span></div>
<div class="line"><a name="l08834"></a><span class="lineno"> 8834</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a0c8d70891f7369bb4bf8412fa1a08ecb">actions_before_newton_solve</a>();</div>
<div class="line"><a name="l08835"></a><span class="lineno"> 8835</span>&#160; </div>
<div class="line"><a name="l08836"></a><span class="lineno"> 8836</span>&#160;    <span class="comment">// Reset number of Newton iterations taken</span></div>
<div class="line"><a name="l08837"></a><span class="lineno"> 8837</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a3c05eefd6891808a1ef01e51288e0108">Nnewton_iter_taken</a> = 0;</div>
<div class="line"><a name="l08838"></a><span class="lineno"> 8838</span>&#160; </div>
<div class="line"><a name="l08839"></a><span class="lineno"> 8839</span>&#160;    <span class="comment">// Now do the Newton loop</span></div>
<div class="line"><a name="l08840"></a><span class="lineno"> 8840</span>&#160;    <span class="keywordflow">do</span></div>
<div class="line"><a name="l08841"></a><span class="lineno"> 8841</span>&#160;    {</div>
<div class="line"><a name="l08842"></a><span class="lineno"> 8842</span>&#160;      count++;</div>
<div class="line"><a name="l08843"></a><span class="lineno"> 8843</span>&#160; </div>
<div class="line"><a name="l08844"></a><span class="lineno"> 8844</span>&#160;      <span class="comment">// Do any updates that are required</span></div>
<div class="line"><a name="l08845"></a><span class="lineno"> 8845</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a07fc81781c74b25c8a426ec18295b0d0">actions_before_newton_step</a>();</div>
<div class="line"><a name="l08846"></a><span class="lineno"> 8846</span>&#160; </div>
<div class="line"><a name="l08847"></a><span class="lineno"> 8847</span>&#160; </div>
<div class="line"><a name="l08848"></a><span class="lineno"> 8848</span>&#160;      <span class="comment">// No degrees of freedom? What are you solving for?</span></div>
<div class="line"><a name="l08849"></a><span class="lineno"> 8849</span>&#160;      <span class="keywordflow">if</span> (n_dofs == 0)</div>
<div class="line"><a name="l08850"></a><span class="lineno"> 8850</span>&#160;      {</div>
<div class="line"><a name="l08851"></a><span class="lineno"> 8851</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; std::endl &lt;&lt; std::endl &lt;&lt; std::endl;</div>
<div class="line"><a name="l08852"></a><span class="lineno"> 8852</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;This is a bit bizarre: The problem has no dofs.&quot;</span></div>
<div class="line"><a name="l08853"></a><span class="lineno"> 8853</span>&#160;                   &lt;&lt; std::endl;</div>
<div class="line"><a name="l08854"></a><span class="lineno"> 8854</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a></div>
<div class="line"><a name="l08855"></a><span class="lineno"> 8855</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;I&#39;ll just return from the Newton solver without doing anything.&quot;</span></div>
<div class="line"><a name="l08856"></a><span class="lineno"> 8856</span>&#160;          &lt;&lt; std::endl;</div>
<div class="line"><a name="l08857"></a><span class="lineno"> 8857</span>&#160; </div>
<div class="line"><a name="l08858"></a><span class="lineno"> 8858</span>&#160;        <span class="comment">// Do any updates that would have been performed</span></div>
<div class="line"><a name="l08859"></a><span class="lineno"> 8859</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae6ad96ddf5d48b517b89c9a9b879bc4b">actions_before_newton_convergence_check</a>();</div>
<div class="line"><a name="l08860"></a><span class="lineno"> 8860</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aed8bc6e7b0bb45b86d5b44737b554d50">actions_after_newton_step</a>();</div>
<div class="line"><a name="l08861"></a><span class="lineno"> 8861</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae6ad96ddf5d48b517b89c9a9b879bc4b">actions_before_newton_convergence_check</a>();</div>
<div class="line"><a name="l08862"></a><span class="lineno"> 8862</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a033ec7301123deeb7e56d04c38f9f1da">actions_after_newton_solve</a>();</div>
<div class="line"><a name="l08863"></a><span class="lineno"> 8863</span>&#160; </div>
<div class="line"><a name="l08864"></a><span class="lineno"> 8864</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;I hope this is what you intended me to do...&quot;</span></div>
<div class="line"><a name="l08865"></a><span class="lineno"> 8865</span>&#160;                   &lt;&lt; std::endl;</div>
<div class="line"><a name="l08866"></a><span class="lineno"> 8866</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; std::endl</div>
<div class="line"><a name="l08867"></a><span class="lineno"> 8867</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;Note: All actions_...() functions were called&quot;</span></div>
<div class="line"><a name="l08868"></a><span class="lineno"> 8868</span>&#160;                   &lt;&lt; std::endl;</div>
<div class="line"><a name="l08869"></a><span class="lineno"> 8869</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;      before returning.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l08870"></a><span class="lineno"> 8870</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; std::endl &lt;&lt; std::endl &lt;&lt; std::endl;</div>
<div class="line"><a name="l08871"></a><span class="lineno"> 8871</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l08872"></a><span class="lineno"> 8872</span>&#160;      }</div>
<div class="line"><a name="l08873"></a><span class="lineno"> 8873</span>&#160; </div>
<div class="line"><a name="l08874"></a><span class="lineno"> 8874</span>&#160;      <span class="comment">// Calculate initial residuals</span></div>
<div class="line"><a name="l08875"></a><span class="lineno"> 8875</span>&#160;      <span class="keywordflow">if</span> (count == 1)</div>
<div class="line"><a name="l08876"></a><span class="lineno"> 8876</span>&#160;      {</div>
<div class="line"><a name="l08877"></a><span class="lineno"> 8877</span>&#160;        <span class="comment">// Is the problem nonlinear? If not ignore the pre-iteration</span></div>
<div class="line"><a name="l08878"></a><span class="lineno"> 8878</span>&#160;        <span class="comment">// convergence check.</span></div>
<div class="line"><a name="l08879"></a><span class="lineno"> 8879</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade2d3efba34f69aafaefc076ddb3b8d4">Problem_is_nonlinear</a>)</div>
<div class="line"><a name="l08880"></a><span class="lineno"> 8880</span>&#160;        {</div>
<div class="line"><a name="l08881"></a><span class="lineno"> 8881</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l08882"></a><span class="lineno"> 8882</span>&#160;          <span class="comment">// Synchronise the solution on different processors (on each submesh)</span></div>
<div class="line"><a name="l08883"></a><span class="lineno"> 8883</span>&#160;          this-&gt;synchronise_all_dofs();</div>
<div class="line"><a name="l08884"></a><span class="lineno"> 8884</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l08885"></a><span class="lineno"> 8885</span>&#160; </div>
<div class="line"><a name="l08886"></a><span class="lineno"> 8886</span>&#160;          <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae6ad96ddf5d48b517b89c9a9b879bc4b">actions_before_newton_convergence_check</a>();</div>
<div class="line"><a name="l08887"></a><span class="lineno"> 8887</span>&#160;          dx.clear();</div>
<div class="line"><a name="l08888"></a><span class="lineno"> 8888</span>&#160;          <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a0103fe1a09ecf7e23a9083b35ef07aac">get_residuals</a>(dx);</div>
<div class="line"><a name="l08889"></a><span class="lineno"> 8889</span>&#160; </div>
<div class="line"><a name="l08890"></a><span class="lineno"> 8890</span>&#160;          <span class="comment">// Get half of squared residual and find maximum step length</span></div>
<div class="line"><a name="l08891"></a><span class="lineno"> 8891</span>&#160;          <span class="comment">// for step length control</span></div>
<div class="line"><a name="l08892"></a><span class="lineno"> 8892</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#acf8b1ec937efdf2a0f892a41c18c0c53">Use_globally_convergent_newton_method</a>)</div>
<div class="line"><a name="l08893"></a><span class="lineno"> 8893</span>&#160;          {</div>
<div class="line"><a name="l08894"></a><span class="lineno"> 8894</span>&#160;            half_residual_squared = 0.0;</div>
<div class="line"><a name="l08895"></a><span class="lineno"> 8895</span>&#160;            <span class="keywordtype">double</span> sum = 0.0;</div>
<div class="line"><a name="l08896"></a><span class="lineno"> 8896</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_dofs; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l08897"></a><span class="lineno"> 8897</span>&#160;            {</div>
<div class="line"><a name="l08898"></a><span class="lineno"> 8898</span>&#160;              sum += (*<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]) * (*<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l08899"></a><span class="lineno"> 8899</span>&#160;              half_residual_squared += dx[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] * dx[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l08900"></a><span class="lineno"> 8900</span>&#160;            }</div>
<div class="line"><a name="l08901"></a><span class="lineno"> 8901</span>&#160;            half_residual_squared *= 0.5;</div>
<div class="line"><a name="l08902"></a><span class="lineno"> 8902</span>&#160;            max_step = 100.0 * <a class="code" href="../../dc/d51/datatypes_8h.html#affe776513b24d84b39af8ab0930fef7f">std::max</a>(<a class="code" href="../../d8/de9/AnnoyingScalar_8h.html#abe7b2405f1f05f9997193c680e8e2fe0">sqrt</a>(sum), <span class="keywordtype">double</span>(n_dofs));</div>
<div class="line"><a name="l08903"></a><span class="lineno"> 8903</span>&#160;          }</div>
<div class="line"><a name="l08904"></a><span class="lineno"> 8904</span>&#160; </div>
<div class="line"><a name="l08905"></a><span class="lineno"> 8905</span>&#160;          <span class="comment">// Get maximum residuals</span></div>
<div class="line"><a name="l08906"></a><span class="lineno"> 8906</span>&#160;          <span class="keywordtype">double</span> maxres = dx.max();</div>
<div class="line"><a name="l08907"></a><span class="lineno"> 8907</span>&#160;          <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab6f510bea9bdfcaf229415440a0a1c98">Max_res</a>.push_back(maxres);</div>
<div class="line"><a name="l08908"></a><span class="lineno"> 8908</span>&#160; </div>
<div class="line"><a name="l08909"></a><span class="lineno"> 8909</span>&#160;          <span class="keywordflow">if</span> (!<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab4a3743c23a2d1eed56981484636c958">Shut_up_in_newton_solve</a>)</div>
<div class="line"><a name="l08910"></a><span class="lineno"> 8910</span>&#160;          {</div>
<div class="line"><a name="l08911"></a><span class="lineno"> 8911</span>&#160;            <span class="comment">// Let&#39;s output the residuals</span></div>
<div class="line"><a name="l08912"></a><span class="lineno"> 8912</span>&#160;            <span class="comment">// unsigned n_row_local = dx.distribution_pt()-&gt;nrow_local();</span></div>
<div class="line"><a name="l08913"></a><span class="lineno"> 8913</span>&#160;            <span class="comment">// unsigned first_row = dx.distribution_pt()-&gt;first_row();</span></div>
<div class="line"><a name="l08914"></a><span class="lineno"> 8914</span>&#160;            <span class="comment">// for(unsigned n=0;n&lt;n_row_local;n++)</span></div>
<div class="line"><a name="l08915"></a><span class="lineno"> 8915</span>&#160;            <span class="comment">//{</span></div>
<div class="line"><a name="l08916"></a><span class="lineno"> 8916</span>&#160;            <span class="comment">// oomph_info &lt;&lt; &quot;residual: &quot; &lt;&lt; n + first_row &lt;&lt; &quot; &quot; &lt;&lt; dx[n] &lt;&lt;</span></div>
<div class="line"><a name="l08917"></a><span class="lineno"> 8917</span>&#160;            <span class="comment">// &quot;\n&quot;;</span></div>
<div class="line"><a name="l08918"></a><span class="lineno"> 8918</span>&#160;            <span class="comment">//}</span></div>
<div class="line"><a name="l08919"></a><span class="lineno"> 8919</span>&#160; </div>
<div class="line"><a name="l08920"></a><span class="lineno"> 8920</span>&#160;            <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;\nInitial Maximum residuals &quot;</span> &lt;&lt; maxres &lt;&lt; std::endl;</div>
<div class="line"><a name="l08921"></a><span class="lineno"> 8921</span>&#160;          }</div>
<div class="line"><a name="l08922"></a><span class="lineno"> 8922</span>&#160; </div>
<div class="line"><a name="l08923"></a><span class="lineno"> 8923</span>&#160;          <span class="keywordflow">if</span> ((maxres &lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a94536b381e949edf5bb4d44434e08925">Newton_solver_tolerance</a>) &amp;&amp;</div>
<div class="line"><a name="l08924"></a><span class="lineno"> 8924</span>&#160;              (!<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a01d7376ab9cc06e4d5619b34fd39dee2">Always_take_one_newton_step</a>))</div>
<div class="line"><a name="l08925"></a><span class="lineno"> 8925</span>&#160;          {</div>
<div class="line"><a name="l08926"></a><span class="lineno"> 8926</span>&#160;            LOOP_FLAG = 0;</div>
<div class="line"><a name="l08927"></a><span class="lineno"> 8927</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l08928"></a><span class="lineno"> 8928</span>&#160;          }</div>
<div class="line"><a name="l08929"></a><span class="lineno"> 8929</span>&#160;        }</div>
<div class="line"><a name="l08930"></a><span class="lineno"> 8930</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l08931"></a><span class="lineno"> 8931</span>&#160;        {</div>
<div class="line"><a name="l08932"></a><span class="lineno"> 8932</span>&#160;          <span class="keywordflow">if</span> (!<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab4a3743c23a2d1eed56981484636c958">Shut_up_in_newton_solve</a>)</div>
<div class="line"><a name="l08933"></a><span class="lineno"> 8933</span>&#160;          {</div>
<div class="line"><a name="l08934"></a><span class="lineno"> 8934</span>&#160;            <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a></div>
<div class="line"><a name="l08935"></a><span class="lineno"> 8935</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;Linear problem -- convergence in one iteration assumed.&quot;</span></div>
<div class="line"><a name="l08936"></a><span class="lineno"> 8936</span>&#160;              &lt;&lt; std::endl;</div>
<div class="line"><a name="l08937"></a><span class="lineno"> 8937</span>&#160;          }</div>
<div class="line"><a name="l08938"></a><span class="lineno"> 8938</span>&#160;        }</div>
<div class="line"><a name="l08939"></a><span class="lineno"> 8939</span>&#160;      }</div>
<div class="line"><a name="l08940"></a><span class="lineno"> 8940</span>&#160; </div>
<div class="line"><a name="l08941"></a><span class="lineno"> 8941</span>&#160; </div>
<div class="line"><a name="l08942"></a><span class="lineno"> 8942</span>&#160;      <span class="comment">// Increment number of Newton iterations taken</span></div>
<div class="line"><a name="l08943"></a><span class="lineno"> 8943</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a3c05eefd6891808a1ef01e51288e0108">Nnewton_iter_taken</a>++;</div>
<div class="line"><a name="l08944"></a><span class="lineno"> 8944</span>&#160; </div>
<div class="line"><a name="l08945"></a><span class="lineno"> 8945</span>&#160;      <span class="comment">// Initialise timer for linear solver</span></div>
<div class="line"><a name="l08946"></a><span class="lineno"> 8946</span>&#160;      <span class="keywordtype">double</span> t_solver_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l08947"></a><span class="lineno"> 8947</span>&#160; </div>
<div class="line"><a name="l08948"></a><span class="lineno"> 8948</span>&#160;      <span class="comment">// Now do the linear solve -- recycling Jacobian if requested</span></div>
<div class="line"><a name="l08949"></a><span class="lineno"> 8949</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a022796f2c96f2dff6ed1db2338c93aaf">Jacobian_reuse_is_enabled</a> &amp;&amp; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a2c4702c75739c967ed582dbd0a7ba56f">Jacobian_has_been_computed</a>)</div>
<div class="line"><a name="l08950"></a><span class="lineno"> 8950</span>&#160;      {</div>
<div class="line"><a name="l08951"></a><span class="lineno"> 8951</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab4a3743c23a2d1eed56981484636c958">Shut_up_in_newton_solve</a>)</div>
<div class="line"><a name="l08952"></a><span class="lineno"> 8952</span>&#160;        {</div>
<div class="line"><a name="l08953"></a><span class="lineno"> 8953</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Not recomputing Jacobian! &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l08954"></a><span class="lineno"> 8954</span>&#160;        }</div>
<div class="line"><a name="l08955"></a><span class="lineno"> 8955</span>&#160; </div>
<div class="line"><a name="l08956"></a><span class="lineno"> 8956</span>&#160;        <span class="comment">// If we&#39;re doing the first iteration and the problem is nonlinear,</span></div>
<div class="line"><a name="l08957"></a><span class="lineno"> 8957</span>&#160;        <span class="comment">// the residuals have already been computed above during the</span></div>
<div class="line"><a name="l08958"></a><span class="lineno"> 8958</span>&#160;        <span class="comment">// initial convergence check. Otherwise compute them here.</span></div>
<div class="line"><a name="l08959"></a><span class="lineno"> 8959</span>&#160;        <span class="keywordflow">if</span> ((count != 1) || (!<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade2d3efba34f69aafaefc076ddb3b8d4">Problem_is_nonlinear</a>)) <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a0103fe1a09ecf7e23a9083b35ef07aac">get_residuals</a>(dx);</div>
<div class="line"><a name="l08960"></a><span class="lineno"> 8960</span>&#160; </div>
<div class="line"><a name="l08961"></a><span class="lineno"> 8961</span>&#160;        <span class="comment">// Backup residuals</span></div>
<div class="line"><a name="l08962"></a><span class="lineno"> 8962</span>&#160;        <a class="code" href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a> resid(dx);</div>
<div class="line"><a name="l08963"></a><span class="lineno"> 8963</span>&#160; </div>
<div class="line"><a name="l08964"></a><span class="lineno"> 8964</span>&#160;        <span class="comment">// Resolve</span></div>
<div class="line"><a name="l08965"></a><span class="lineno"> 8965</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a>-&gt;<a class="code" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a3b310d08333033edc119b2a5bd7dcbfb">resolve</a>(resid, dx);</div>
<div class="line"><a name="l08966"></a><span class="lineno"> 8966</span>&#160;      }</div>
<div class="line"><a name="l08967"></a><span class="lineno"> 8967</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l08968"></a><span class="lineno"> 8968</span>&#160;      {</div>
<div class="line"><a name="l08969"></a><span class="lineno"> 8969</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a022796f2c96f2dff6ed1db2338c93aaf">Jacobian_reuse_is_enabled</a>)</div>
<div class="line"><a name="l08970"></a><span class="lineno"> 8970</span>&#160;        {</div>
<div class="line"><a name="l08971"></a><span class="lineno"> 8971</span>&#160;          <span class="keywordflow">if</span> (!<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab4a3743c23a2d1eed56981484636c958">Shut_up_in_newton_solve</a>)</div>
<div class="line"><a name="l08972"></a><span class="lineno"> 8972</span>&#160;          {</div>
<div class="line"><a name="l08973"></a><span class="lineno"> 8973</span>&#160;            <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Enabling resolve&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l08974"></a><span class="lineno"> 8974</span>&#160;          }</div>
<div class="line"><a name="l08975"></a><span class="lineno"> 8975</span>&#160;          <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a>-&gt;<a class="code" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a3000ebd9becb3468d8a6a821a9cc0cd9">enable_resolve</a>();</div>
<div class="line"><a name="l08976"></a><span class="lineno"> 8976</span>&#160;        }</div>
<div class="line"><a name="l08977"></a><span class="lineno"> 8977</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a>-&gt;<a class="code" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a15ce22542b74ed1826ea485edacbeb6e">solve</a>(<span class="keyword">this</span>, dx);</div>
<div class="line"><a name="l08978"></a><span class="lineno"> 8978</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a2c4702c75739c967ed582dbd0a7ba56f">Jacobian_has_been_computed</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l08979"></a><span class="lineno"> 8979</span>&#160;      }</div>
<div class="line"><a name="l08980"></a><span class="lineno"> 8980</span>&#160; </div>
<div class="line"><a name="l08981"></a><span class="lineno"> 8981</span>&#160;      <span class="comment">// End of linear solver</span></div>
<div class="line"><a name="l08982"></a><span class="lineno"> 8982</span>&#160;      <span class="keywordtype">double</span> t_solver_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l08983"></a><span class="lineno"> 8983</span>&#160;      total_linear_solver_time += t_solver_end - t_solver_start;</div>
<div class="line"><a name="l08984"></a><span class="lineno"> 8984</span>&#160; </div>
<div class="line"><a name="l08985"></a><span class="lineno"> 8985</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab4a3743c23a2d1eed56981484636c958">Shut_up_in_newton_solve</a>)</div>
<div class="line"><a name="l08986"></a><span class="lineno"> 8986</span>&#160;      {</div>
<div class="line"><a name="l08987"></a><span class="lineno"> 8987</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l08988"></a><span class="lineno"> 8988</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for linear solver (ndof=&quot;</span> &lt;&lt; n_dofs &lt;&lt; <span class="stringliteral">&quot;): &quot;</span></div>
<div class="line"><a name="l08989"></a><span class="lineno"> 8989</span>&#160;                   &lt;&lt; <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#ae746b756dfb86c00c7cf37558a7870f3">TimingHelpers::convert_secs_to_formatted_string</a>(</div>
<div class="line"><a name="l08990"></a><span class="lineno"> 8990</span>&#160;                        t_solver_end - t_solver_start)</div>
<div class="line"><a name="l08991"></a><span class="lineno"> 8991</span>&#160;                   &lt;&lt; std::endl</div>
<div class="line"><a name="l08992"></a><span class="lineno"> 8992</span>&#160;                   &lt;&lt; std::endl;</div>
<div class="line"><a name="l08993"></a><span class="lineno"> 8993</span>&#160;      }</div>
<div class="line"><a name="l08994"></a><span class="lineno"> 8994</span>&#160; </div>
<div class="line"><a name="l08995"></a><span class="lineno"> 8995</span>&#160;      <span class="comment">// Subtract the new values from the true dofs</span></div>
<div class="line"><a name="l08996"></a><span class="lineno"> 8996</span>&#160;      dx.redistribute(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>);</div>
<div class="line"><a name="l08997"></a><span class="lineno"> 8997</span>&#160;      <span class="keywordtype">double</span>* dx_pt = dx.values_pt();</div>
<div class="line"><a name="l08998"></a><span class="lineno"> 8998</span>&#160;      <span class="keywordtype">unsigned</span> ndof_local = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">nrow_local</a>();</div>
<div class="line"><a name="l08999"></a><span class="lineno"> 8999</span>&#160; </div>
<div class="line"><a name="l09000"></a><span class="lineno"> 9000</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#acf8b1ec937efdf2a0f892a41c18c0c53">Use_globally_convergent_newton_method</a>)</div>
<div class="line"><a name="l09001"></a><span class="lineno"> 9001</span>&#160;      {</div>
<div class="line"><a name="l09002"></a><span class="lineno"> 9002</span>&#160;        <span class="comment">// Get the gradient</span></div>
<div class="line"><a name="l09003"></a><span class="lineno"> 9003</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a>-&gt;<a class="code" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a6733411e85f0a1d6d82200c802481681">get_gradient</a>(gradient);</div>
<div class="line"><a name="l09004"></a><span class="lineno"> 9004</span>&#160; </div>
<div class="line"><a name="l09005"></a><span class="lineno"> 9005</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; ndof_local; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l09006"></a><span class="lineno"> 9006</span>&#160;        {</div>
<div class="line"><a name="l09007"></a><span class="lineno"> 9007</span>&#160;          dx_pt[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] *= -1.0;</div>
<div class="line"><a name="l09008"></a><span class="lineno"> 9008</span>&#160;        }</div>
<div class="line"><a name="l09009"></a><span class="lineno"> 9009</span>&#160; </div>
<div class="line"><a name="l09010"></a><span class="lineno"> 9010</span>&#160;        <span class="comment">// Update with steplength control</span></div>
<div class="line"><a name="l09011"></a><span class="lineno"> 9011</span>&#160;        Vector&lt;double&gt; unknowns_old(ndof_local);</div>
<div class="line"><a name="l09012"></a><span class="lineno"> 9012</span>&#160; </div>
<div class="line"><a name="l09013"></a><span class="lineno"> 9013</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; ndof_local; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l09014"></a><span class="lineno"> 9014</span>&#160;        {</div>
<div class="line"><a name="l09015"></a><span class="lineno"> 9015</span>&#160;          unknowns_old[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = *<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l09016"></a><span class="lineno"> 9016</span>&#160;        }</div>
<div class="line"><a name="l09017"></a><span class="lineno"> 9017</span>&#160; </div>
<div class="line"><a name="l09018"></a><span class="lineno"> 9018</span>&#160;        <span class="keywordtype">double</span> half_residual_squared_old = half_residual_squared;</div>
<div class="line"><a name="l09019"></a><span class="lineno"> 9019</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a466d6110fd791b17e04a4100312787cd">globally_convergent_line_search</a>(unknowns_old,</div>
<div class="line"><a name="l09020"></a><span class="lineno"> 9020</span>&#160;                                        half_residual_squared_old,</div>
<div class="line"><a name="l09021"></a><span class="lineno"> 9021</span>&#160;                                        gradient,</div>
<div class="line"><a name="l09022"></a><span class="lineno"> 9022</span>&#160;                                        dx,</div>
<div class="line"><a name="l09023"></a><span class="lineno"> 9023</span>&#160;                                        half_residual_squared,</div>
<div class="line"><a name="l09024"></a><span class="lineno"> 9024</span>&#160;                                        max_step);</div>
<div class="line"><a name="l09025"></a><span class="lineno"> 9025</span>&#160;      }</div>
<div class="line"><a name="l09026"></a><span class="lineno"> 9026</span>&#160;      <span class="comment">// direct Newton update</span></div>
<div class="line"><a name="l09027"></a><span class="lineno"> 9027</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l09028"></a><span class="lineno"> 9028</span>&#160;      {</div>
<div class="line"><a name="l09029"></a><span class="lineno"> 9029</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> l = 0; l &lt; ndof_local; l++)</div>
<div class="line"><a name="l09030"></a><span class="lineno"> 9030</span>&#160;        {</div>
<div class="line"><a name="l09031"></a><span class="lineno"> 9031</span>&#160;          *<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>[l] -= <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a86c4feb98ec982a08dc84fb664f53abc">Relaxation_factor</a> * dx_pt[l];</div>
<div class="line"><a name="l09032"></a><span class="lineno"> 9032</span>&#160;        }</div>
<div class="line"><a name="l09033"></a><span class="lineno"> 9033</span>&#160;      }</div>
<div class="line"><a name="l09034"></a><span class="lineno"> 9034</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l09035"></a><span class="lineno"> 9035</span>&#160;      <span class="comment">// Synchronise the solution on different processors (on each submesh)</span></div>
<div class="line"><a name="l09036"></a><span class="lineno"> 9036</span>&#160;      this-&gt;synchronise_all_dofs();</div>
<div class="line"><a name="l09037"></a><span class="lineno"> 9037</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l09038"></a><span class="lineno"> 9038</span>&#160; </div>
<div class="line"><a name="l09039"></a><span class="lineno"> 9039</span>&#160;      <span class="comment">// Do any updates that are required</span></div>
<div class="line"><a name="l09040"></a><span class="lineno"> 9040</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aed8bc6e7b0bb45b86d5b44737b554d50">actions_after_newton_step</a>();</div>
<div class="line"><a name="l09041"></a><span class="lineno"> 9041</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae6ad96ddf5d48b517b89c9a9b879bc4b">actions_before_newton_convergence_check</a>();</div>
<div class="line"><a name="l09042"></a><span class="lineno"> 9042</span>&#160; </div>
<div class="line"><a name="l09043"></a><span class="lineno"> 9043</span>&#160;      <span class="comment">// Maximum residuals</span></div>
<div class="line"><a name="l09044"></a><span class="lineno"> 9044</span>&#160;      <span class="keywordtype">double</span> maxres = 0.0;</div>
<div class="line"><a name="l09045"></a><span class="lineno"> 9045</span>&#160;      <span class="comment">// If the user has declared that the Problem is linear</span></div>
<div class="line"><a name="l09046"></a><span class="lineno"> 9046</span>&#160;      <span class="comment">// we ignore the convergence check</span></div>
<div class="line"><a name="l09047"></a><span class="lineno"> 9047</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade2d3efba34f69aafaefc076ddb3b8d4">Problem_is_nonlinear</a>)</div>
<div class="line"><a name="l09048"></a><span class="lineno"> 9048</span>&#160;      {</div>
<div class="line"><a name="l09049"></a><span class="lineno"> 9049</span>&#160;        <span class="comment">// Get the maximum residuals</span></div>
<div class="line"><a name="l09050"></a><span class="lineno"> 9050</span>&#160;        <span class="comment">// maxres = std::fabs(*std::max_element(dx.begin(),dx.end(),</span></div>
<div class="line"><a name="l09051"></a><span class="lineno"> 9051</span>&#160;        <span class="comment">//                                    AbsCmp&lt;double&gt;()));</span></div>
<div class="line"><a name="l09052"></a><span class="lineno"> 9052</span>&#160;        <span class="comment">// oomph_info &lt;&lt; &quot;Maxres correction &quot; &lt;&lt; maxres &lt;&lt; &quot;\n&quot;;</span></div>
<div class="line"><a name="l09053"></a><span class="lineno"> 9053</span>&#160; </div>
<div class="line"><a name="l09054"></a><span class="lineno"> 9054</span>&#160;        <span class="comment">// Calculate the new residuals</span></div>
<div class="line"><a name="l09055"></a><span class="lineno"> 9055</span>&#160;        dx.clear();</div>
<div class="line"><a name="l09056"></a><span class="lineno"> 9056</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a0103fe1a09ecf7e23a9083b35ef07aac">get_residuals</a>(dx);</div>
<div class="line"><a name="l09057"></a><span class="lineno"> 9057</span>&#160; </div>
<div class="line"><a name="l09058"></a><span class="lineno"> 9058</span>&#160;        <span class="comment">// Get the maximum residuals</span></div>
<div class="line"><a name="l09059"></a><span class="lineno"> 9059</span>&#160;        maxres = dx.max();</div>
<div class="line"><a name="l09060"></a><span class="lineno"> 9060</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab6f510bea9bdfcaf229415440a0a1c98">Max_res</a>.push_back(maxres);</div>
<div class="line"><a name="l09061"></a><span class="lineno"> 9061</span>&#160; </div>
<div class="line"><a name="l09062"></a><span class="lineno"> 9062</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab4a3743c23a2d1eed56981484636c958">Shut_up_in_newton_solve</a>)</div>
<div class="line"><a name="l09063"></a><span class="lineno"> 9063</span>&#160;        {</div>
<div class="line"><a name="l09064"></a><span class="lineno"> 9064</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Newton Step &quot;</span> &lt;&lt; count &lt;&lt; <span class="stringliteral">&quot;: Maximum residuals &quot;</span></div>
<div class="line"><a name="l09065"></a><span class="lineno"> 9065</span>&#160;                     &lt;&lt; maxres &lt;&lt; std::endl</div>
<div class="line"><a name="l09066"></a><span class="lineno"> 9066</span>&#160;                     &lt;&lt; std::endl;</div>
<div class="line"><a name="l09067"></a><span class="lineno"> 9067</span>&#160;        }</div>
<div class="line"><a name="l09068"></a><span class="lineno"> 9068</span>&#160;      }</div>
<div class="line"><a name="l09069"></a><span class="lineno"> 9069</span>&#160; </div>
<div class="line"><a name="l09070"></a><span class="lineno"> 9070</span>&#160;      <span class="comment">// If we have converged jump straight to the test at the end of the loop</span></div>
<div class="line"><a name="l09071"></a><span class="lineno"> 9071</span>&#160;      <span class="keywordflow">if</span> (maxres &lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a94536b381e949edf5bb4d44434e08925">Newton_solver_tolerance</a>)</div>
<div class="line"><a name="l09072"></a><span class="lineno"> 9072</span>&#160;      {</div>
<div class="line"><a name="l09073"></a><span class="lineno"> 9073</span>&#160;        LOOP_FLAG = 0;</div>
<div class="line"><a name="l09074"></a><span class="lineno"> 9074</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l09075"></a><span class="lineno"> 9075</span>&#160;      }</div>
<div class="line"><a name="l09076"></a><span class="lineno"> 9076</span>&#160; </div>
<div class="line"><a name="l09077"></a><span class="lineno"> 9077</span>&#160;      <span class="comment">// This section will not be reached if we have converged already</span></div>
<div class="line"><a name="l09078"></a><span class="lineno"> 9078</span>&#160;      <span class="comment">// If the maximum number of residuals is too high or the maximum number</span></div>
<div class="line"><a name="l09079"></a><span class="lineno"> 9079</span>&#160;      <span class="comment">// of iterations has been reached</span></div>
<div class="line"><a name="l09080"></a><span class="lineno"> 9080</span>&#160;      <span class="keywordflow">if</span> ((maxres &gt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accb8811cdf32f14be497917e922c623e">Max_residuals</a>) || (count == <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a52a58a98c3e2e7dbaefcfb1ee7830c35">Max_newton_iterations</a>))</div>
<div class="line"><a name="l09081"></a><span class="lineno"> 9081</span>&#160;      {</div>
<div class="line"><a name="l09082"></a><span class="lineno"> 9082</span>&#160;        <span class="comment">// Print a warning -- regardless of what the throw does</span></div>
<div class="line"><a name="l09083"></a><span class="lineno"> 9083</span>&#160;        <span class="keywordflow">if</span> (maxres &gt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accb8811cdf32f14be497917e922c623e">Max_residuals</a>)</div>
<div class="line"><a name="l09084"></a><span class="lineno"> 9084</span>&#160;        {</div>
<div class="line"><a name="l09085"></a><span class="lineno"> 9085</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Max. residual (&quot;</span> &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accb8811cdf32f14be497917e922c623e">Max_residuals</a></div>
<div class="line"><a name="l09086"></a><span class="lineno"> 9086</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;) has been exceeded in Newton solver.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l09087"></a><span class="lineno"> 9087</span>&#160;        }</div>
<div class="line"><a name="l09088"></a><span class="lineno"> 9088</span>&#160;        <span class="keywordflow">if</span> (count == <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a52a58a98c3e2e7dbaefcfb1ee7830c35">Max_newton_iterations</a>)</div>
<div class="line"><a name="l09089"></a><span class="lineno"> 9089</span>&#160;        {</div>
<div class="line"><a name="l09090"></a><span class="lineno"> 9090</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Reached max. number of iterations (&quot;</span></div>
<div class="line"><a name="l09091"></a><span class="lineno"> 9091</span>&#160;                     &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a52a58a98c3e2e7dbaefcfb1ee7830c35">Max_newton_iterations</a> &lt;&lt; <span class="stringliteral">&quot;) in Newton solver.&quot;</span></div>
<div class="line"><a name="l09092"></a><span class="lineno"> 9092</span>&#160;                     &lt;&lt; std::endl;</div>
<div class="line"><a name="l09093"></a><span class="lineno"> 9093</span>&#160;        }</div>
<div class="line"><a name="l09094"></a><span class="lineno"> 9094</span>&#160;        <span class="comment">// Now throw...</span></div>
<div class="line"><a name="l09095"></a><span class="lineno"> 9095</span>&#160;        <span class="keywordflow">throw</span> NewtonSolverError(count, maxres);</div>
<div class="line"><a name="l09096"></a><span class="lineno"> 9096</span>&#160;      }</div>
<div class="line"><a name="l09097"></a><span class="lineno"> 9097</span>&#160; </div>
<div class="line"><a name="l09098"></a><span class="lineno"> 9098</span>&#160;    } <span class="keywordflow">while</span> (LOOP_FLAG);</div>
<div class="line"><a name="l09099"></a><span class="lineno"> 9099</span>&#160; </div>
<div class="line"><a name="l09100"></a><span class="lineno"> 9100</span>&#160;    <span class="comment">// Now update anything that needs updating</span></div>
<div class="line"><a name="l09101"></a><span class="lineno"> 9101</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a033ec7301123deeb7e56d04c38f9f1da">actions_after_newton_solve</a>();</div>
<div class="line"><a name="l09102"></a><span class="lineno"> 9102</span>&#160; </div>
<div class="line"><a name="l09103"></a><span class="lineno"> 9103</span>&#160;    <span class="comment">// Finalise/doc timings</span></div>
<div class="line"><a name="l09104"></a><span class="lineno"> 9104</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab4a3743c23a2d1eed56981484636c958">Shut_up_in_newton_solve</a>)</div>
<div class="line"><a name="l09105"></a><span class="lineno"> 9105</span>&#160;    {</div>
<div class="line"><a name="l09106"></a><span class="lineno"> 9106</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l09107"></a><span class="lineno"> 9107</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Total time for linear solver (ndof=&quot;</span> &lt;&lt; n_dofs &lt;&lt; <span class="stringliteral">&quot;): &quot;</span></div>
<div class="line"><a name="l09108"></a><span class="lineno"> 9108</span>&#160;                 &lt;&lt; <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#ae746b756dfb86c00c7cf37558a7870f3">TimingHelpers::convert_secs_to_formatted_string</a>(</div>
<div class="line"><a name="l09109"></a><span class="lineno"> 9109</span>&#160;                      total_linear_solver_time)</div>
<div class="line"><a name="l09110"></a><span class="lineno"> 9110</span>&#160;                 &lt;&lt; std::endl;</div>
<div class="line"><a name="l09111"></a><span class="lineno"> 9111</span>&#160;    }</div>
<div class="line"><a name="l09112"></a><span class="lineno"> 9112</span>&#160; </div>
<div class="line"><a name="l09113"></a><span class="lineno"> 9113</span>&#160;    <span class="keywordtype">double</span> t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l09114"></a><span class="lineno"> 9114</span>&#160;    <span class="keywordtype">double</span> total_time = t_end - t_start;</div>
<div class="line"><a name="l09115"></a><span class="lineno"> 9115</span>&#160; </div>
<div class="line"><a name="l09116"></a><span class="lineno"> 9116</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab4a3743c23a2d1eed56981484636c958">Shut_up_in_newton_solve</a>)</div>
<div class="line"><a name="l09117"></a><span class="lineno"> 9117</span>&#160;    {</div>
<div class="line"><a name="l09118"></a><span class="lineno"> 9118</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Total time for Newton solver (ndof=&quot;</span> &lt;&lt; n_dofs &lt;&lt; <span class="stringliteral">&quot;): &quot;</span></div>
<div class="line"><a name="l09119"></a><span class="lineno"> 9119</span>&#160;                 &lt;&lt; <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#ae746b756dfb86c00c7cf37558a7870f3">TimingHelpers::convert_secs_to_formatted_string</a>(total_time)</div>
<div class="line"><a name="l09120"></a><span class="lineno"> 9120</span>&#160;                 &lt;&lt; std::endl;</div>
<div class="line"><a name="l09121"></a><span class="lineno"> 9121</span>&#160;    }</div>
<div class="line"><a name="l09122"></a><span class="lineno"> 9122</span>&#160;    <span class="keywordflow">if</span> (total_time &gt; 0.0)</div>
<div class="line"><a name="l09123"></a><span class="lineno"> 9123</span>&#160;    {</div>
<div class="line"><a name="l09124"></a><span class="lineno"> 9124</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab4a3743c23a2d1eed56981484636c958">Shut_up_in_newton_solve</a>)</div>
<div class="line"><a name="l09125"></a><span class="lineno"> 9125</span>&#160;      {</div>
<div class="line"><a name="l09126"></a><span class="lineno"> 9126</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time outside linear solver        : &quot;</span></div>
<div class="line"><a name="l09127"></a><span class="lineno"> 9127</span>&#160;                   &lt;&lt; (total_time - total_linear_solver_time) / total_time *</div>
<div class="line"><a name="l09128"></a><span class="lineno"> 9128</span>&#160;                        100.0</div>
<div class="line"><a name="l09129"></a><span class="lineno"> 9129</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot; %&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l09130"></a><span class="lineno"> 9130</span>&#160;      }</div>
<div class="line"><a name="l09131"></a><span class="lineno"> 9131</span>&#160;    }</div>
<div class="line"><a name="l09132"></a><span class="lineno"> 9132</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l09133"></a><span class="lineno"> 9133</span>&#160;    {</div>
<div class="line"><a name="l09134"></a><span class="lineno"> 9134</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab4a3743c23a2d1eed56981484636c958">Shut_up_in_newton_solve</a>)</div>
<div class="line"><a name="l09135"></a><span class="lineno"> 9135</span>&#160;      {</div>
<div class="line"><a name="l09136"></a><span class="lineno"> 9136</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time outside linear solver        : &quot;</span></div>
<div class="line"><a name="l09137"></a><span class="lineno"> 9137</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;[too fast]&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l09138"></a><span class="lineno"> 9138</span>&#160;      }</div>
<div class="line"><a name="l09139"></a><span class="lineno"> 9139</span>&#160;    }</div>
<div class="line"><a name="l09140"></a><span class="lineno"> 9140</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab4a3743c23a2d1eed56981484636c958">Shut_up_in_newton_solve</a>) <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l09141"></a><span class="lineno"> 9141</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1LinearSolver_html_a37f1f8b8c6d45115e649739abd5d2f5d"><div class="ttname"><a href="../../d5/dd7/classoomph_1_1LinearSolver.html#a37f1f8b8c6d45115e649739abd5d2f5d">oomph::LinearSolver::enable_computation_of_gradient</a></div><div class="ttdeci">virtual void enable_computation_of_gradient()</div><div class="ttdef"><b>Definition:</b> linear_solver.h:282</div></div>
<div class="ttc" id="aclassoomph_1_1LinearSolver_html_a6733411e85f0a1d6d82200c802481681"><div class="ttname"><a href="../../d5/dd7/classoomph_1_1LinearSolver.html#a6733411e85f0a1d6d82200c802481681">oomph::LinearSolver::get_gradient</a></div><div class="ttdeci">void get_gradient(DoubleVector &amp;gradient)</div><div class="ttdoc">function to access the gradient, provided it has been computed</div><div class="ttdef"><b>Definition:</b> linear_solver.h:306</div></div>
<div class="ttc" id="aclassoomph_1_1LinearSolver_html_aceef502cbdf826cdf6aa31f5803982e0"><div class="ttname"><a href="../../d5/dd7/classoomph_1_1LinearSolver.html#aceef502cbdf826cdf6aa31f5803982e0">oomph::LinearSolver::reset_gradient</a></div><div class="ttdeci">void reset_gradient()</div><div class="ttdef"><b>Definition:</b> linear_solver.h:300</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a07fc81781c74b25c8a426ec18295b0d0"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a07fc81781c74b25c8a426ec18295b0d0">oomph::Problem::actions_before_newton_step</a></div><div class="ttdeci">virtual void actions_before_newton_step()</div><div class="ttdef"><b>Definition:</b> problem.h:1053</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a466d6110fd791b17e04a4100312787cd"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a466d6110fd791b17e04a4100312787cd">oomph::Problem::globally_convergent_line_search</a></div><div class="ttdeci">void globally_convergent_line_search(const Vector&lt; double &gt; &amp;x_old, const double &amp;half_residual_squared_old, DoubleVector &amp;gradient, DoubleVector &amp;newton_dir, double &amp;half_residual_squared, const double &amp;stpmax)</div><div class="ttdoc">Line search helper for globally convergent Newton method.</div><div class="ttdef"><b>Definition:</b> problem.cc:9146</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_ab6f510bea9bdfcaf229415440a0a1c98"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#ab6f510bea9bdfcaf229415440a0a1c98">oomph::Problem::Max_res</a></div><div class="ttdeci">Vector&lt; double &gt; Max_res</div><div class="ttdoc">Maximum residuals at start and after each newton iteration.</div><div class="ttdef"><b>Definition:</b> problem.h:606</div></div>
<div class="ttc" id="anamespaceoomph_1_1TimingHelpers_html_ae746b756dfb86c00c7cf37558a7870f3"><div class="ttname"><a href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#ae746b756dfb86c00c7cf37558a7870f3">oomph::TimingHelpers::convert_secs_to_formatted_string</a></div><div class="ttdeci">std::string convert_secs_to_formatted_string(const double &amp;time_in_sec)</div><div class="ttdef"><b>Definition:</b> oomph_utilities.cc:1316</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a033ec7301123deeb7e56d04c38f9f1da">actions_after_newton_solve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aed8bc6e7b0bb45b86d5b44737b554d50">actions_after_newton_step()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae6ad96ddf5d48b517b89c9a9b879bc4b">actions_before_newton_convergence_check()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a0c8d70891f7369bb4bf8412fa1a08ecb">actions_before_newton_solve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a07fc81781c74b25c8a426ec18295b0d0">actions_before_newton_step()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a01d7376ab9cc06e4d5619b34fd39dee2">Always_take_one_newton_step</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#af1677445056759263b1b076966e7bfae">oomph::DoubleVector::clear()</a>, <a class="el" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#ae746b756dfb86c00c7cf37558a7870f3">oomph::TimingHelpers::convert_secs_to_formatted_string()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>, <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a37f1f8b8c6d45115e649739abd5d2f5d">oomph::LinearSolver::enable_computation_of_gradient()</a>, <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a3000ebd9becb3468d8a6a821a9cc0cd9">oomph::LinearSolver::enable_resolve()</a>, <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a6733411e85f0a1d6d82200c802481681">oomph::LinearSolver::get_gradient()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a0103fe1a09ecf7e23a9083b35ef07aac">get_residuals()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a466d6110fd791b17e04a4100312787cd">globally_convergent_line_search()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a2c4702c75739c967ed582dbd0a7ba56f">Jacobian_has_been_computed</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a022796f2c96f2dff6ed1db2338c93aaf">Jacobian_reuse_is_enabled</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#a4c176b562f503701d65882a930d5b8f5">oomph::DoubleVector::max()</a>, <a class="el" href="../../dc/d51/datatypes_8h.html#affe776513b24d84b39af8ab0930fef7f">max</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a52a58a98c3e2e7dbaefcfb1ee7830c35">Max_newton_iterations</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab6f510bea9bdfcaf229415440a0a1c98">Max_res</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accb8811cdf32f14be497917e922c623e">Max_residuals</a>, <a class="el" href="../../df/d58/classoomph_1_1MPI__Helpers.html#aa376d403f6bc99e8595d227135932b0e">oomph::MPI_Helpers::mpi_has_been_initialised()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a94536b381e949edf5bb4d44434e08925">Newton_solver_tolerance</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a3c05eefd6891808a1ef01e51288e0108">Nnewton_iter_taken</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">oomph::LinearAlgebraDistribution::nrow_local()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ade2d3efba34f69aafaefc076ddb3b8d4">Problem_is_nonlinear</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#a9396b861977c16606d8eca39056976c8">oomph::DoubleVector::redistribute()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a86c4feb98ec982a08dc84fb664f53abc">Relaxation_factor</a>, <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#aceef502cbdf826cdf6aa31f5803982e0">oomph::LinearSolver::reset_gradient()</a>, <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a3b310d08333033edc119b2a5bd7dcbfb">oomph::LinearSolver::resolve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab4a3743c23a2d1eed56981484636c958">Shut_up_in_newton_solve</a>, <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a15ce22542b74ed1826ea485edacbeb6e">oomph::LinearSolver::solve()</a>, <a class="el" href="../../d8/de9/AnnoyingScalar_8h.html#abe7b2405f1f05f9997193c680e8e2fe0">sqrt()</a>, <a class="el" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">oomph::TimingHelpers::timer()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acf8b1ec937efdf2a0f892a41c18c0c53">Use_globally_convergent_newton_method</a>, and <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#a8c3dcdf8a602a1f266bbe72d98fde2e7">oomph::DoubleVector::values_pt()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a63805c549e71b7c73107abe6001fae25">adaptive_unsteady_newton_solve()</a>, <a class="el" href="../../d1/d1e/one__d__poisson__hp__adapt_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#abdb4fbbb5d658094cfd48e2296c7d3b7">newton_solve()</a>, <a class="el" href="../../d6/d69/classoomph_1_1NonLinearElasticitySmoothMesh.html#a426905484f20903c02c995b297df36a6">oomph::NonLinearElasticitySmoothMesh&lt; ELEMENT &gt;::operator()()</a>, <a class="el" href="../../de/db1/classoomph_1_1LinearElasticitySmoothMesh.html#a7546b06ebbc89a348df4c2a8774147ec">oomph::LinearElasticitySmoothMesh&lt; LINEAR_ELASTICITY_ELEMENT &gt;::operator()()</a>, <a class="el" href="../../d5/df9/classoomph_1_1PoissonSmoothMesh.html#ad0a3d661fd2048fa4967e68ffeb1d630">oomph::PoissonSmoothMesh&lt; POISSON_ELEMENT &gt;::operator()()</a>, <a class="el" href="../../d2/d5a/classPolarNSProblem.html#a6b3674a72f007efd9b8ee6b5218485b5">PolarNSProblem&lt; ELEMENT &gt;::output_streamfunction()</a>, <a class="el" href="../../d4/d6b/three__d__mesh__dist_8cc.html#a3e9491dd4f7081f92d170df562503838">parallel_test()</a>, <a class="el" href="../../dd/ddc/classElasticBeamProblem.html#a2da3cb02ce953da67fb27742e20774a5">ElasticBeamProblem::parameter_study()</a>, <a class="el" href="../../d5/dc5/classoomph_1_1ProjectionProblem.html#ad972f78212e515a03d1018996115265a">oomph::ProjectionProblem&lt; PROJECTABLE_ELEMENT &gt;::project()</a>, <a class="el" href="../../de/da7/classoomph_1_1SegregatableFSIProblem.html#a87a69561674c1e596bb205e0fc4a387f">oomph::SegregatableFSIProblem::segregated_solve()</a>, <a class="el" href="../../d2/d5a/classoomph_1_1SolidICProblem.html#a07e954c951e4eefa7ac7c99ba74e81cc">oomph::SolidICProblem::set_newmark_initial_condition_consistently()</a>, <a class="el" href="../../d2/d5a/classoomph_1_1SolidICProblem.html#ac88248cf3c1b9353724deb2e0d0e1f39">oomph::SolidICProblem::set_newmark_initial_condition_directly()</a>, <a class="el" href="../../d2/d5a/classoomph_1_1SolidICProblem.html#a60e1dccbc8627a07bfcb38a55b0669ca">oomph::SolidICProblem::set_static_initial_condition()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a64b890295532c3a7ff5ad4e4dd5d56e3">steady_newton_solve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a4b015281f27d25ee0209cd9b467175b6">unsteady_newton_solve()</a>, and <a class="el" href="../../da/dcc/classoomph_1_1FpPressureAdvectionDiffusionProblem.html#ae24eef02cff52b57dca6c1daf274bab2">oomph::FpPressureAdvectionDiffusionProblem&lt; ELEMENT &gt;::validate()</a>.</p>

</div>
</div>
<a id="abdb4fbbb5d658094cfd48e2296c7d3b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abdb4fbbb5d658094cfd48e2296c7d3b7">&#9670;&nbsp;</a></span>newton_solve() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::newton_solve </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> const &amp;&#160;</td>
          <td class="paramname"><em>max_adapt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Adaptive Newton solve: up to max_adapt adaptations of all refineable submeshes are performed to achieve the the error targets specified in the refineable submeshes.</p>
<p>Adaptive Newton solver. The linear solver takes a pointer to the problem (which defines the Jacobian <b>J</b> and the residual Vector <b>r</b>) and returns the solution <b>x</b> of the system </p><p class="formulaDsp">
\[ {\bf J} {\bf x} = - \bf{r} \]
</p>
<p>. Performs at most max_adapt adaptations on all meshes. </p>
<div class="fragment"><div class="line"><a name="l16224"></a><span class="lineno">16224</span>&#160;  {</div>
<div class="line"><a name="l16225"></a><span class="lineno">16225</span>&#160;    <span class="comment">// Max number of solves</span></div>
<div class="line"><a name="l16226"></a><span class="lineno">16226</span>&#160;    <span class="keywordtype">unsigned</span> max_solve = max_adapt + 1;</div>
<div class="line"><a name="l16227"></a><span class="lineno">16227</span>&#160; </div>
<div class="line"><a name="l16228"></a><span class="lineno">16228</span>&#160;    <span class="comment">// Adaptation loop</span></div>
<div class="line"><a name="l16229"></a><span class="lineno">16229</span>&#160;    <span class="comment">//----------------</span></div>
<div class="line"><a name="l16230"></a><span class="lineno">16230</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> isolve = 0; isolve &lt; max_solve; isolve++)</div>
<div class="line"><a name="l16231"></a><span class="lineno">16231</span>&#160;    {</div>
<div class="line"><a name="l16232"></a><span class="lineno">16232</span>&#160;      <span class="comment">// Only adapt after the first solve has been done!</span></div>
<div class="line"><a name="l16233"></a><span class="lineno">16233</span>&#160;      <span class="keywordflow">if</span> (isolve &gt; 0)</div>
<div class="line"><a name="l16234"></a><span class="lineno">16234</span>&#160;      {</div>
<div class="line"><a name="l16235"></a><span class="lineno">16235</span>&#160;        <span class="keywordtype">unsigned</span> n_refined;</div>
<div class="line"><a name="l16236"></a><span class="lineno">16236</span>&#160;        <span class="keywordtype">unsigned</span> n_unrefined;</div>
<div class="line"><a name="l16237"></a><span class="lineno">16237</span>&#160; </div>
<div class="line"><a name="l16238"></a><span class="lineno">16238</span>&#160;        <span class="comment">// Adapt problem</span></div>
<div class="line"><a name="l16239"></a><span class="lineno">16239</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a0b9e09ddfa2411f14fc723c3207decd1">adapt</a>(n_refined, n_unrefined);</div>
<div class="line"><a name="l16240"></a><span class="lineno">16240</span>&#160; </div>
<div class="line"><a name="l16241"></a><span class="lineno">16241</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l16242"></a><span class="lineno">16242</span>&#160;        <span class="comment">// Adaptation only converges if ALL the processes have no</span></div>
<div class="line"><a name="l16243"></a><span class="lineno">16243</span>&#160;        <span class="comment">// refinement or unrefinement to perform</span></div>
<div class="line"><a name="l16244"></a><span class="lineno">16244</span>&#160;        <span class="keywordtype">unsigned</span> total_refined = 0;</div>
<div class="line"><a name="l16245"></a><span class="lineno">16245</span>&#160;        <span class="keywordtype">unsigned</span> total_unrefined = 0;</div>
<div class="line"><a name="l16246"></a><span class="lineno">16246</span>&#160;        <span class="keywordflow">if</span> (Problem_has_been_distributed)</div>
<div class="line"><a name="l16247"></a><span class="lineno">16247</span>&#160;        {</div>
<div class="line"><a name="l16248"></a><span class="lineno">16248</span>&#160;          MPI_Allreduce(&amp;n_refined,</div>
<div class="line"><a name="l16249"></a><span class="lineno">16249</span>&#160;                        &amp;total_refined,</div>
<div class="line"><a name="l16250"></a><span class="lineno">16250</span>&#160;                        1,</div>
<div class="line"><a name="l16251"></a><span class="lineno">16251</span>&#160;                        MPI_UNSIGNED,</div>
<div class="line"><a name="l16252"></a><span class="lineno">16252</span>&#160;                        MPI_SUM,</div>
<div class="line"><a name="l16253"></a><span class="lineno">16253</span>&#160;                        this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">communicator_pt</a>()-&gt;mpi_comm());</div>
<div class="line"><a name="l16254"></a><span class="lineno">16254</span>&#160;          n_refined = total_refined;</div>
<div class="line"><a name="l16255"></a><span class="lineno">16255</span>&#160;          MPI_Allreduce(&amp;n_unrefined,</div>
<div class="line"><a name="l16256"></a><span class="lineno">16256</span>&#160;                        &amp;total_unrefined,</div>
<div class="line"><a name="l16257"></a><span class="lineno">16257</span>&#160;                        1,</div>
<div class="line"><a name="l16258"></a><span class="lineno">16258</span>&#160;                        MPI_UNSIGNED,</div>
<div class="line"><a name="l16259"></a><span class="lineno">16259</span>&#160;                        MPI_SUM,</div>
<div class="line"><a name="l16260"></a><span class="lineno">16260</span>&#160;                        this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">communicator_pt</a>()-&gt;mpi_comm());</div>
<div class="line"><a name="l16261"></a><span class="lineno">16261</span>&#160;          n_unrefined = total_unrefined;</div>
<div class="line"><a name="l16262"></a><span class="lineno">16262</span>&#160;        }</div>
<div class="line"><a name="l16263"></a><span class="lineno">16263</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l16264"></a><span class="lineno">16264</span>&#160; </div>
<div class="line"><a name="l16265"></a><span class="lineno">16265</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;---&gt; &quot;</span> &lt;&lt; n_refined &lt;&lt; <span class="stringliteral">&quot; elements were refined, and &quot;</span></div>
<div class="line"><a name="l16266"></a><span class="lineno">16266</span>&#160;                   &lt;&lt; n_unrefined &lt;&lt; <span class="stringliteral">&quot; were unrefined&quot;</span></div>
<div class="line"><a name="l16267"></a><span class="lineno">16267</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l16268"></a><span class="lineno">16268</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;, in total (over all processors).\n&quot;</span>;</div>
<div class="line"><a name="l16269"></a><span class="lineno">16269</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l16270"></a><span class="lineno">16270</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;.\n&quot;</span>;</div>
<div class="line"><a name="l16271"></a><span class="lineno">16271</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l16272"></a><span class="lineno">16272</span>&#160; </div>
<div class="line"><a name="l16273"></a><span class="lineno">16273</span>&#160; </div>
<div class="line"><a name="l16274"></a><span class="lineno">16274</span>&#160;        <span class="comment">// Check convergence of adaptation cycle</span></div>
<div class="line"><a name="l16275"></a><span class="lineno">16275</span>&#160;        <span class="keywordflow">if</span> ((n_refined == 0) &amp;&amp; (n_unrefined == 0))</div>
<div class="line"><a name="l16276"></a><span class="lineno">16276</span>&#160;        {</div>
<div class="line"><a name="l16277"></a><span class="lineno">16277</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;\n \n Solution is fully converged in &quot;</span></div>
<div class="line"><a name="l16278"></a><span class="lineno">16278</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;Problem::newton_solver(). \n \n &quot;</span>;</div>
<div class="line"><a name="l16279"></a><span class="lineno">16279</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l16280"></a><span class="lineno">16280</span>&#160;        }</div>
<div class="line"><a name="l16281"></a><span class="lineno">16281</span>&#160;      }</div>
<div class="line"><a name="l16282"></a><span class="lineno">16282</span>&#160; </div>
<div class="line"><a name="l16283"></a><span class="lineno">16283</span>&#160; </div>
<div class="line"><a name="l16284"></a><span class="lineno">16284</span>&#160;      <span class="comment">// Do actual solve</span></div>
<div class="line"><a name="l16285"></a><span class="lineno">16285</span>&#160;      <span class="comment">//----------------</span></div>
<div class="line"><a name="l16286"></a><span class="lineno">16286</span>&#160;      {</div>
<div class="line"><a name="l16287"></a><span class="lineno">16287</span>&#160;        <span class="comment">// Now update anything that needs updating</span></div>
<div class="line"><a name="l16288"></a><span class="lineno">16288</span>&#160;        <span class="comment">// NOT NEEDED -- IS CALLED IN newton_solve BELOW! #</span></div>
<div class="line"><a name="l16289"></a><span class="lineno">16289</span>&#160;        <span class="comment">// actions_before_newton_solve();</span></div>
<div class="line"><a name="l16290"></a><span class="lineno">16290</span>&#160; </div>
<div class="line"><a name="l16291"></a><span class="lineno">16291</span>&#160;        <span class="keywordflow">try</span></div>
<div class="line"><a name="l16292"></a><span class="lineno">16292</span>&#160;        {</div>
<div class="line"><a name="l16293"></a><span class="lineno">16293</span>&#160;          <span class="comment">// Solve the non-linear problem for this timestep with Newton&#39;s method</span></div>
<div class="line"><a name="l16294"></a><span class="lineno">16294</span>&#160;          <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aae8cf62757e432b625ec81fad1559dc3">newton_solve</a>();</div>
<div class="line"><a name="l16295"></a><span class="lineno">16295</span>&#160;        }</div>
<div class="line"><a name="l16296"></a><span class="lineno">16296</span>&#160;        <span class="comment">// Catch any exceptions thrown in the Newton solver</span></div>
<div class="line"><a name="l16297"></a><span class="lineno">16297</span>&#160;        <span class="keywordflow">catch</span> (NewtonSolverError&amp; <a class="code" href="../../d9/d33/namespacecalibrate.html#a4dbebf21da853ac368a3a9af2fbab442">error</a>)</div>
<div class="line"><a name="l16298"></a><span class="lineno">16298</span>&#160;        {</div>
<div class="line"><a name="l16299"></a><span class="lineno">16299</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; std::endl</div>
<div class="line"><a name="l16300"></a><span class="lineno">16300</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;USER-DEFINED ERROR IN NEWTON SOLVER &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l16301"></a><span class="lineno">16301</span>&#160;          <span class="comment">// Check to see whether we have reached Max_iterations</span></div>
<div class="line"><a name="l16302"></a><span class="lineno">16302</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d9/d33/namespacecalibrate.html#a4dbebf21da853ac368a3a9af2fbab442">error</a>.iterations == <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a52a58a98c3e2e7dbaefcfb1ee7830c35">Max_newton_iterations</a>)</div>
<div class="line"><a name="l16303"></a><span class="lineno">16303</span>&#160;          {</div>
<div class="line"><a name="l16304"></a><span class="lineno">16304</span>&#160;            <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;MAXIMUM NUMBER OF ITERATIONS (&quot;</span> &lt;&lt; <a class="code" href="../../d9/d33/namespacecalibrate.html#a4dbebf21da853ac368a3a9af2fbab442">error</a>.iterations</div>
<div class="line"><a name="l16305"></a><span class="lineno">16305</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot;) REACHED WITHOUT CONVERGENCE &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l16306"></a><span class="lineno">16306</span>&#160;          }</div>
<div class="line"><a name="l16307"></a><span class="lineno">16307</span>&#160;          <span class="comment">// If not, it must be that we have exceeded the maximum residuals</span></div>
<div class="line"><a name="l16308"></a><span class="lineno">16308</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l16309"></a><span class="lineno">16309</span>&#160;          {</div>
<div class="line"><a name="l16310"></a><span class="lineno">16310</span>&#160;            <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;MAXIMUM RESIDUALS: &quot;</span> &lt;&lt; <a class="code" href="../../d9/d33/namespacecalibrate.html#a4dbebf21da853ac368a3a9af2fbab442">error</a>.maxres</div>
<div class="line"><a name="l16311"></a><span class="lineno">16311</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot;EXCEEDS PREDEFINED MAXIMUM &quot;</span> &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accb8811cdf32f14be497917e922c623e">Max_residuals</a></div>
<div class="line"><a name="l16312"></a><span class="lineno">16312</span>&#160;                       &lt;&lt; std::endl;</div>
<div class="line"><a name="l16313"></a><span class="lineno">16313</span>&#160;          }</div>
<div class="line"><a name="l16314"></a><span class="lineno">16314</span>&#160; </div>
<div class="line"><a name="l16315"></a><span class="lineno">16315</span>&#160;          <span class="comment">// Die horribly!!</span></div>
<div class="line"><a name="l16316"></a><span class="lineno">16316</span>&#160;          std::ostringstream error_stream;</div>
<div class="line"><a name="l16317"></a><span class="lineno">16317</span>&#160;          error_stream &lt;&lt; <span class="stringliteral">&quot;Error occured in adaptive Newton solver. &quot;</span></div>
<div class="line"><a name="l16318"></a><span class="lineno">16318</span>&#160;                       &lt;&lt; std::endl;</div>
<div class="line"><a name="l16319"></a><span class="lineno">16319</span>&#160;          <span class="keywordflow">throw</span> OomphLibError(error_stream.str(),</div>
<div class="line"><a name="l16320"></a><span class="lineno">16320</span>&#160;                              <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l16321"></a><span class="lineno">16321</span>&#160;                              <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l16322"></a><span class="lineno">16322</span>&#160;        }</div>
<div class="line"><a name="l16323"></a><span class="lineno">16323</span>&#160; </div>
<div class="line"><a name="l16324"></a><span class="lineno">16324</span>&#160;        <span class="comment">// Now update anything that needs updating</span></div>
<div class="line"><a name="l16325"></a><span class="lineno">16325</span>&#160;        <span class="comment">// NOT NEEDED -- WAS CALLED IN newton_solve ABOVE</span></div>
<div class="line"><a name="l16326"></a><span class="lineno">16326</span>&#160;        <span class="comment">// !actions_after_newton_solve();</span></div>
<div class="line"><a name="l16327"></a><span class="lineno">16327</span>&#160; </div>
<div class="line"><a name="l16328"></a><span class="lineno">16328</span>&#160;      } <span class="comment">// End of solve block</span></div>
<div class="line"><a name="l16329"></a><span class="lineno">16329</span>&#160; </div>
<div class="line"><a name="l16330"></a><span class="lineno">16330</span>&#160; </div>
<div class="line"><a name="l16331"></a><span class="lineno">16331</span>&#160;      <span class="keywordflow">if</span> (isolve == max_solve - 1)</div>
<div class="line"><a name="l16332"></a><span class="lineno">16332</span>&#160;      {</div>
<div class="line"><a name="l16333"></a><span class="lineno">16333</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a></div>
<div class="line"><a name="l16334"></a><span class="lineno">16334</span>&#160;          &lt;&lt; std::endl</div>
<div class="line"><a name="l16335"></a><span class="lineno">16335</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------------&quot;</span></div>
<div class="line"><a name="l16336"></a><span class="lineno">16336</span>&#160;          &lt;&lt; std::endl</div>
<div class="line"><a name="l16337"></a><span class="lineno">16337</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;Reached max. number of adaptations in \n&quot;</span></div>
<div class="line"><a name="l16338"></a><span class="lineno">16338</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;Problem::newton_solver().\n&quot;</span></div>
<div class="line"><a name="l16339"></a><span class="lineno">16339</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------------&quot;</span></div>
<div class="line"><a name="l16340"></a><span class="lineno">16340</span>&#160;          &lt;&lt; std::endl</div>
<div class="line"><a name="l16341"></a><span class="lineno">16341</span>&#160;          &lt;&lt; std::endl;</div>
<div class="line"><a name="l16342"></a><span class="lineno">16342</span>&#160;      }</div>
<div class="line"><a name="l16343"></a><span class="lineno">16343</span>&#160; </div>
<div class="line"><a name="l16344"></a><span class="lineno">16344</span>&#160;    } <span class="comment">// End of adaptation loop</span></div>
<div class="line"><a name="l16345"></a><span class="lineno">16345</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a0b9e09ddfa2411f14fc723c3207decd1">adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">communicator_pt()</a>, <a class="el" href="../../d9/d33/namespacecalibrate.html#a4dbebf21da853ac368a3a9af2fbab442">calibrate::error</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a52a58a98c3e2e7dbaefcfb1ee7830c35">Max_newton_iterations</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accb8811cdf32f14be497917e922c623e">Max_residuals</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aae8cf62757e432b625ec81fad1559dc3">newton_solve()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, and <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>.</p>

</div>
</div>
<a id="a07c5f8686a484837a8856efe3024a52c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07c5f8686a484837a8856efe3024a52c">&#9670;&nbsp;</a></span>newton_solve_continuation() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> Problem::newton_solve_continuation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;&#160;</td>
          <td class="paramname"><em>parameter_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Perform a basic arc-length continuation step using Newton's method. Returns number of Newton steps taken.</p>
<p>Perform a basic continuation step using Newton's method. The governing parameter of the problem is passed as a pointer to the routine. The number of Newton steps taken is returned </p>
<div class="fragment"><div class="line"><a name="l09377"></a><span class="lineno"> 9377</span>&#160;  {</div>
<div class="line"><a name="l09378"></a><span class="lineno"> 9378</span>&#160;    <span class="comment">// Set up memory for z</span></div>
<div class="line"><a name="l09379"></a><span class="lineno"> 9379</span>&#160;    <span class="comment">// unsigned long n_dofs = ndof();</span></div>
<div class="line"><a name="l09380"></a><span class="lineno"> 9380</span>&#160;    <span class="comment">// LinearAlgebraDistribution dist(Communicator_pt,n_dofs,false);</span></div>
<div class="line"><a name="l09381"></a><span class="lineno"> 9381</span>&#160;    <span class="comment">// DoubleVector z(&amp;dist,0.0);</span></div>
<div class="line"><a name="l09382"></a><span class="lineno"> 9382</span>&#160;    <a class="code" href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a> z;</div>
<div class="line"><a name="l09383"></a><span class="lineno"> 9383</span>&#160;    <span class="comment">// Call the solver</span></div>
<div class="line"><a name="l09384"></a><span class="lineno"> 9384</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a07c5f8686a484837a8856efe3024a52c">newton_solve_continuation</a>(parameter_pt, z);</div>
<div class="line"><a name="l09385"></a><span class="lineno"> 9385</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acc35de219c1c1032a14840021fd8a6b9">arc_length_step_solve_helper()</a>.</p>

</div>
</div>
<a id="a7b86783463433cc9c4cc382b1b40f0e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b86783463433cc9c4cc382b1b40f0e1">&#9670;&nbsp;</a></span>newton_solve_continuation() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> Problem::newton_solve_continuation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;&#160;</td>
          <td class="paramname"><em>parameter_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;&#160;</td>
          <td class="paramname"><em>z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This function performs a basic continuation step using the Newton method. The number of Newton steps taken is returned, to be used in any external step-size control routines. The governing parameter of the problem is passed as a pointer to the routine, as is a vector in which to store the derivatives wrt the parameter, if required.</p>
<p>This function performs a basic continuation step using the Newton method. The number of Newton steps taken is returned, to be used in any external step-size control routines. The governing parameter of the problem is passed as a pointer to the routine, as is the sign of the Jacobian and a Vector in which to store the derivatives wrt the parameter, if required. </p>
<div class="fragment"><div class="line"><a name="l09398"></a><span class="lineno"> 9398</span>&#160;  {</div>
<div class="line"><a name="l09399"></a><span class="lineno"> 9399</span>&#160;    <span class="comment">// Find the total number of dofs</span></div>
<div class="line"><a name="l09400"></a><span class="lineno"> 9400</span>&#160;    <span class="comment">// unsigned long n_dofs = ndof();</span></div>
<div class="line"><a name="l09401"></a><span class="lineno"> 9401</span>&#160; </div>
<div class="line"><a name="l09402"></a><span class="lineno"> 9402</span>&#160;    <span class="comment">// Find the local number of dofs</span></div>
<div class="line"><a name="l09403"></a><span class="lineno"> 9403</span>&#160;    <span class="keywordtype">unsigned</span> ndof_local = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">nrow_local</a>();</div>
<div class="line"><a name="l09404"></a><span class="lineno"> 9404</span>&#160; </div>
<div class="line"><a name="l09405"></a><span class="lineno"> 9405</span>&#160;    <span class="comment">// create the distribution (not distributed)</span></div>
<div class="line"><a name="l09406"></a><span class="lineno"> 9406</span>&#160;    <span class="comment">// LinearAlgebraDistribution dist(this-&gt;communicator_pt(),n_dofs,false);</span></div>
<div class="line"><a name="l09407"></a><span class="lineno"> 9407</span>&#160; </div>
<div class="line"><a name="l09408"></a><span class="lineno"> 9408</span>&#160;    <span class="comment">// Assign memory for solutions of the equations</span></div>
<div class="line"><a name="l09409"></a><span class="lineno"> 9409</span>&#160;    <span class="comment">// DoubleVector y(&amp;dist,0.0);</span></div>
<div class="line"><a name="l09410"></a><span class="lineno"> 9410</span>&#160;    <a class="code" href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a> <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a068041cb6b3b60d76ee64be754bedcbe">y</a>;</div>
<div class="line"><a name="l09411"></a><span class="lineno"> 9411</span>&#160; </div>
<div class="line"><a name="l09412"></a><span class="lineno"> 9412</span>&#160;    <span class="comment">// Assign memory for the dot products of the uderivatives and y and z</span></div>
<div class="line"><a name="l09413"></a><span class="lineno"> 9413</span>&#160;    <span class="keywordtype">double</span> uderiv_dot_y = 0.0, uderiv_dot_z = 0.0;</div>
<div class="line"><a name="l09414"></a><span class="lineno"> 9414</span>&#160;    <span class="comment">// Set and initialise the counter</span></div>
<div class="line"><a name="l09415"></a><span class="lineno"> 9415</span>&#160;    <span class="keywordtype">unsigned</span> count = 0;</div>
<div class="line"><a name="l09416"></a><span class="lineno"> 9416</span>&#160;    <span class="comment">// Set the loop flag</span></div>
<div class="line"><a name="l09417"></a><span class="lineno"> 9417</span>&#160;    <span class="keywordtype">unsigned</span> LOOP_FLAG = 1;</div>
<div class="line"><a name="l09418"></a><span class="lineno"> 9418</span>&#160; </div>
<div class="line"><a name="l09419"></a><span class="lineno"> 9419</span>&#160;    <span class="comment">// Update anything that needs updating</span></div>
<div class="line"><a name="l09420"></a><span class="lineno"> 9420</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a0c8d70891f7369bb4bf8412fa1a08ecb">actions_before_newton_solve</a>();</div>
<div class="line"><a name="l09421"></a><span class="lineno"> 9421</span>&#160; </div>
<div class="line"><a name="l09422"></a><span class="lineno"> 9422</span>&#160;    <span class="comment">// Check the arc-length constraint</span></div>
<div class="line"><a name="l09423"></a><span class="lineno"> 9423</span>&#160;    <span class="keywordtype">double</span> arc_length_constraint_residual = 0.0;</div>
<div class="line"><a name="l09424"></a><span class="lineno"> 9424</span>&#160; </div>
<div class="line"><a name="l09425"></a><span class="lineno"> 9425</span>&#160;    <span class="comment">// Are we storing the matrix in the linear solve</span></div>
<div class="line"><a name="l09426"></a><span class="lineno"> 9426</span>&#160;    <span class="keywordtype">bool</span> enable_resolve = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a>-&gt;<a class="code" href="../../d5/dd7/classoomph_1_1LinearSolver.html#ae1e4d34a7e2b1537d36153f87e8a62a6">is_resolve_enabled</a>();</div>
<div class="line"><a name="l09427"></a><span class="lineno"> 9427</span>&#160; </div>
<div class="line"><a name="l09428"></a><span class="lineno"> 9428</span>&#160;    <span class="comment">// For this problem, we must store the residuals</span></div>
<div class="line"><a name="l09429"></a><span class="lineno"> 9429</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a>-&gt;<a class="code" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a3000ebd9becb3468d8a6a821a9cc0cd9">enable_resolve</a>();</div>
<div class="line"><a name="l09430"></a><span class="lineno"> 9430</span>&#160; </div>
<div class="line"><a name="l09431"></a><span class="lineno"> 9431</span>&#160;    <span class="comment">// Now do the Newton loop</span></div>
<div class="line"><a name="l09432"></a><span class="lineno"> 9432</span>&#160;    <span class="keywordflow">do</span></div>
<div class="line"><a name="l09433"></a><span class="lineno"> 9433</span>&#160;    {</div>
<div class="line"><a name="l09434"></a><span class="lineno"> 9434</span>&#160;      count++;</div>
<div class="line"><a name="l09435"></a><span class="lineno"> 9435</span>&#160; </div>
<div class="line"><a name="l09436"></a><span class="lineno"> 9436</span>&#160;      <span class="comment">// Do any updates that are required</span></div>
<div class="line"><a name="l09437"></a><span class="lineno"> 9437</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a07fc81781c74b25c8a426ec18295b0d0">actions_before_newton_step</a>();</div>
<div class="line"><a name="l09438"></a><span class="lineno"> 9438</span>&#160; </div>
<div class="line"><a name="l09439"></a><span class="lineno"> 9439</span>&#160;      <span class="comment">// Calculate initial residuals</span></div>
<div class="line"><a name="l09440"></a><span class="lineno"> 9440</span>&#160;      <span class="keywordflow">if</span> (count == 1)</div>
<div class="line"><a name="l09441"></a><span class="lineno"> 9441</span>&#160;      {</div>
<div class="line"><a name="l09442"></a><span class="lineno"> 9442</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l09443"></a><span class="lineno"> 9443</span>&#160;        <span class="comment">// Synchronise the solution on different processors (on each submesh)</span></div>
<div class="line"><a name="l09444"></a><span class="lineno"> 9444</span>&#160;        this-&gt;synchronise_all_dofs();</div>
<div class="line"><a name="l09445"></a><span class="lineno"> 9445</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l09446"></a><span class="lineno"> 9446</span>&#160; </div>
<div class="line"><a name="l09447"></a><span class="lineno"> 9447</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae6ad96ddf5d48b517b89c9a9b879bc4b">actions_before_newton_convergence_check</a>();</div>
<div class="line"><a name="l09448"></a><span class="lineno"> 9448</span>&#160;        <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a068041cb6b3b60d76ee64be754bedcbe">y</a>.clear();</div>
<div class="line"><a name="l09449"></a><span class="lineno"> 9449</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a0103fe1a09ecf7e23a9083b35ef07aac">get_residuals</a>(<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a068041cb6b3b60d76ee64be754bedcbe">y</a>);</div>
<div class="line"><a name="l09450"></a><span class="lineno"> 9450</span>&#160;        <span class="comment">// Get maximum residuals, using our own abscmp function</span></div>
<div class="line"><a name="l09451"></a><span class="lineno"> 9451</span>&#160;        <span class="keywordtype">double</span> maxres = <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a068041cb6b3b60d76ee64be754bedcbe">y</a>.max();</div>
<div class="line"><a name="l09452"></a><span class="lineno"> 9452</span>&#160; </div>
<div class="line"><a name="l09453"></a><span class="lineno"> 9453</span>&#160;        <span class="comment">// Assemble the residuals for the arc-length step</span></div>
<div class="line"><a name="l09454"></a><span class="lineno"> 9454</span>&#160;        arc_length_constraint_residual = 0.0;</div>
<div class="line"><a name="l09455"></a><span class="lineno"> 9455</span>&#160;        <span class="comment">// Add the variables</span></div>
<div class="line"><a name="l09456"></a><span class="lineno"> 9456</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l = 0; l &lt; ndof_local; l++)</div>
<div class="line"><a name="l09457"></a><span class="lineno"> 9457</span>&#160;        {</div>
<div class="line"><a name="l09458"></a><span class="lineno"> 9458</span>&#160;          arc_length_constraint_residual +=</div>
<div class="line"><a name="l09459"></a><span class="lineno"> 9459</span>&#160;            <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad6df5fb0d282f25df1e94a665dd838e5">dof_derivative</a>(l) * (*<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>[l] - <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a10fd6457ceceb02a0e11d860ac0017c5">dof_current</a>(l));</div>
<div class="line"><a name="l09460"></a><span class="lineno"> 9460</span>&#160;        }</div>
<div class="line"><a name="l09461"></a><span class="lineno"> 9461</span>&#160; </div>
<div class="line"><a name="l09462"></a><span class="lineno"> 9462</span>&#160;        <span class="comment">// Now reduce if we have been distributed</span></div>
<div class="line"><a name="l09463"></a><span class="lineno"> 9463</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l09464"></a><span class="lineno"> 9464</span>&#160;        <span class="keywordtype">double</span> arc_length_cons_res2 = arc_length_constraint_residual;</div>
<div class="line"><a name="l09465"></a><span class="lineno"> 9465</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a05842d032d28880ae37951deae804ad8">distributed</a>()) &amp;&amp;</div>
<div class="line"><a name="l09466"></a><span class="lineno"> 9466</span>&#160;            (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a2e4736826a65253f574d4f6f152ab514">communicator_pt</a>()-&gt;<a class="code" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a6c78c72666f4b102c2bccf200f0853b7">nproc</a>() &gt; 1))</div>
<div class="line"><a name="l09467"></a><span class="lineno"> 9467</span>&#160;        {</div>
<div class="line"><a name="l09468"></a><span class="lineno"> 9468</span>&#160;          MPI_Allreduce(&amp;arc_length_constraint_residual,</div>
<div class="line"><a name="l09469"></a><span class="lineno"> 9469</span>&#160;                        &amp;arc_length_cons_res2,</div>
<div class="line"><a name="l09470"></a><span class="lineno"> 9470</span>&#160;                        1,</div>
<div class="line"><a name="l09471"></a><span class="lineno"> 9471</span>&#160;                        MPI_DOUBLE,</div>
<div class="line"><a name="l09472"></a><span class="lineno"> 9472</span>&#160;                        MPI_SUM,</div>
<div class="line"><a name="l09473"></a><span class="lineno"> 9473</span>&#160;                        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a2e4736826a65253f574d4f6f152ab514">communicator_pt</a>()-&gt;mpi_comm());</div>
<div class="line"><a name="l09474"></a><span class="lineno"> 9474</span>&#160;        }</div>
<div class="line"><a name="l09475"></a><span class="lineno"> 9475</span>&#160;        arc_length_constraint_residual = arc_length_cons_res2;</div>
<div class="line"><a name="l09476"></a><span class="lineno"> 9476</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l09477"></a><span class="lineno"> 9477</span>&#160; </div>
<div class="line"><a name="l09478"></a><span class="lineno"> 9478</span>&#160;        arc_length_constraint_residual *= <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a123843ca2ed6384342939ef2b19477ef">Theta_squared</a>;</div>
<div class="line"><a name="l09479"></a><span class="lineno"> 9479</span>&#160;        arc_length_constraint_residual +=</div>
<div class="line"><a name="l09480"></a><span class="lineno"> 9480</span>&#160;          <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa5082325ca4cafe5a9ec03ef79c67a6f">Parameter_derivative</a> * (*parameter_pt - <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a8e29673eb80559888d1c6148c4f11e57">Parameter_current</a>) -</div>
<div class="line"><a name="l09481"></a><span class="lineno"> 9481</span>&#160;          <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad412d49617d0b0998e5eb440c7a20f3f">Ds_current</a>;</div>
<div class="line"><a name="l09482"></a><span class="lineno"> 9482</span>&#160; </div>
<div class="line"><a name="l09483"></a><span class="lineno"> 9483</span>&#160;        <span class="comment">// Is it the max</span></div>
<div class="line"><a name="l09484"></a><span class="lineno"> 9484</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">std::fabs</a>(arc_length_constraint_residual) &gt; maxres)</div>
<div class="line"><a name="l09485"></a><span class="lineno"> 9485</span>&#160;        {</div>
<div class="line"><a name="l09486"></a><span class="lineno"> 9486</span>&#160;          maxres = <a class="code" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">std::fabs</a>(arc_length_constraint_residual);</div>
<div class="line"><a name="l09487"></a><span class="lineno"> 9487</span>&#160;        }</div>
<div class="line"><a name="l09488"></a><span class="lineno"> 9488</span>&#160; </div>
<div class="line"><a name="l09489"></a><span class="lineno"> 9489</span>&#160;        <span class="comment">// Find the max</span></div>
<div class="line"><a name="l09490"></a><span class="lineno"> 9490</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab4a3743c23a2d1eed56981484636c958">Shut_up_in_newton_solve</a>)</div>
<div class="line"><a name="l09491"></a><span class="lineno"> 9491</span>&#160;        {</div>
<div class="line"><a name="l09492"></a><span class="lineno"> 9492</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Initial Maximum residuals &quot;</span> &lt;&lt; maxres &lt;&lt; std::endl;</div>
<div class="line"><a name="l09493"></a><span class="lineno"> 9493</span>&#160;        }</div>
<div class="line"><a name="l09494"></a><span class="lineno"> 9494</span>&#160; </div>
<div class="line"><a name="l09495"></a><span class="lineno"> 9495</span>&#160;        <span class="comment">// If we are below the Tolerance, then return immediately</span></div>
<div class="line"><a name="l09496"></a><span class="lineno"> 9496</span>&#160;        <span class="keywordflow">if</span> ((maxres &lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a94536b381e949edf5bb4d44434e08925">Newton_solver_tolerance</a>) &amp;&amp;</div>
<div class="line"><a name="l09497"></a><span class="lineno"> 9497</span>&#160;            (!<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a01d7376ab9cc06e4d5619b34fd39dee2">Always_take_one_newton_step</a>))</div>
<div class="line"><a name="l09498"></a><span class="lineno"> 9498</span>&#160;        {</div>
<div class="line"><a name="l09499"></a><span class="lineno"> 9499</span>&#160;          LOOP_FLAG = 0;</div>
<div class="line"><a name="l09500"></a><span class="lineno"> 9500</span>&#160;          count = 0;</div>
<div class="line"><a name="l09501"></a><span class="lineno"> 9501</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l09502"></a><span class="lineno"> 9502</span>&#160;        }</div>
<div class="line"><a name="l09503"></a><span class="lineno"> 9503</span>&#160;      }</div>
<div class="line"><a name="l09504"></a><span class="lineno"> 9504</span>&#160; </div>
<div class="line"><a name="l09505"></a><span class="lineno"> 9505</span>&#160;      <span class="comment">// If it&#39;s the block hopf solver we need to solve for both rhs&#39;s</span></div>
<div class="line"><a name="l09506"></a><span class="lineno"> 9506</span>&#160;      <span class="comment">// simultaneously. This is because the block decomposition involves</span></div>
<div class="line"><a name="l09507"></a><span class="lineno"> 9507</span>&#160;      <span class="comment">// solves with two different matrices and storing both at once to</span></div>
<div class="line"><a name="l09508"></a><span class="lineno"> 9508</span>&#160;      <span class="comment">// allow general resolves would be more expensive than necessary.</span></div>
<div class="line"><a name="l09509"></a><span class="lineno"> 9509</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a199677d64d3b2f908690d10a2398b737">BlockHopfLinearSolver</a>*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a>))</div>
<div class="line"><a name="l09510"></a><span class="lineno"> 9510</span>&#160;      {</div>
<div class="line"><a name="l09511"></a><span class="lineno"> 9511</span>&#160;        <span class="comment">// Get the vector dresiduals/dparameter</span></div>
<div class="line"><a name="l09512"></a><span class="lineno"> 9512</span>&#160;        z.clear();</div>
<div class="line"><a name="l09513"></a><span class="lineno"> 9513</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#adc456017cfc4fb4ae6f522973e50f496">get_derivative_wrt_global_parameter</a>(parameter_pt, z);</div>
<div class="line"><a name="l09514"></a><span class="lineno"> 9514</span>&#160; </div>
<div class="line"><a name="l09515"></a><span class="lineno"> 9515</span>&#160;        <span class="comment">// Copy rhs vector into local storage so it doesn&#39;t get overwritten</span></div>
<div class="line"><a name="l09516"></a><span class="lineno"> 9516</span>&#160;        <span class="comment">// if the linear solver decides to initialise the solution vector, say,</span></div>
<div class="line"><a name="l09517"></a><span class="lineno"> 9517</span>&#160;        <span class="comment">// which it&#39;s quite entitled to do!</span></div>
<div class="line"><a name="l09518"></a><span class="lineno"> 9518</span>&#160;        <a class="code" href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a> input_z(z);</div>
<div class="line"><a name="l09519"></a><span class="lineno"> 9519</span>&#160; </div>
<div class="line"><a name="l09520"></a><span class="lineno"> 9520</span>&#160;        <span class="comment">// Solve the system for the two right-hand sides.</span></div>
<div class="line"><a name="l09521"></a><span class="lineno"> 9521</span>&#160;        <span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a199677d64d3b2f908690d10a2398b737">BlockHopfLinearSolver</a>*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a>)</div>
<div class="line"><a name="l09522"></a><span class="lineno"> 9522</span>&#160;          -&gt;solve_for_two_rhs(<span class="keyword">this</span>, <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a068041cb6b3b60d76ee64be754bedcbe">y</a>, input_z, z);</div>
<div class="line"><a name="l09523"></a><span class="lineno"> 9523</span>&#160;      }</div>
<div class="line"><a name="l09524"></a><span class="lineno"> 9524</span>&#160;      <span class="comment">// Otherwise</span></div>
<div class="line"><a name="l09525"></a><span class="lineno"> 9525</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l09526"></a><span class="lineno"> 9526</span>&#160;      {</div>
<div class="line"><a name="l09527"></a><span class="lineno"> 9527</span>&#160;        <span class="comment">// Solve the standard problem</span></div>
<div class="line"><a name="l09528"></a><span class="lineno"> 9528</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a>-&gt;<a class="code" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a15ce22542b74ed1826ea485edacbeb6e">solve</a>(<span class="keyword">this</span>, <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a068041cb6b3b60d76ee64be754bedcbe">y</a>);</div>
<div class="line"><a name="l09529"></a><span class="lineno"> 9529</span>&#160; </div>
<div class="line"><a name="l09530"></a><span class="lineno"> 9530</span>&#160;        <span class="comment">// Get the vector dresiduals/dparameter</span></div>
<div class="line"><a name="l09531"></a><span class="lineno"> 9531</span>&#160;        z.clear();</div>
<div class="line"><a name="l09532"></a><span class="lineno"> 9532</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#adc456017cfc4fb4ae6f522973e50f496">get_derivative_wrt_global_parameter</a>(parameter_pt, z);</div>
<div class="line"><a name="l09533"></a><span class="lineno"> 9533</span>&#160; </div>
<div class="line"><a name="l09534"></a><span class="lineno"> 9534</span>&#160;        <span class="comment">// Copy rhs vector into local storage so it doesn&#39;t get overwritten</span></div>
<div class="line"><a name="l09535"></a><span class="lineno"> 9535</span>&#160;        <span class="comment">// if the linear solver decides to initialise the solution vector, say,</span></div>
<div class="line"><a name="l09536"></a><span class="lineno"> 9536</span>&#160;        <span class="comment">// which it&#39;s quite entitled to do!</span></div>
<div class="line"><a name="l09537"></a><span class="lineno"> 9537</span>&#160;        <a class="code" href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a> input_z(z);</div>
<div class="line"><a name="l09538"></a><span class="lineno"> 9538</span>&#160; </div>
<div class="line"><a name="l09539"></a><span class="lineno"> 9539</span>&#160;        <span class="comment">// Redistribute the RHS to match the linear solver</span></div>
<div class="line"><a name="l09540"></a><span class="lineno"> 9540</span>&#160;        <span class="comment">// input_z.redistribute(Linear_solver_pt-&gt;distribution_pt());</span></div>
<div class="line"><a name="l09541"></a><span class="lineno"> 9541</span>&#160;        <span class="comment">// Do not clear z because we assume that it has dR/dparam</span></div>
<div class="line"><a name="l09542"></a><span class="lineno"> 9542</span>&#160;        z.clear();</div>
<div class="line"><a name="l09543"></a><span class="lineno"> 9543</span>&#160;        <span class="comment">// Now resolve the system with the new RHS</span></div>
<div class="line"><a name="l09544"></a><span class="lineno"> 9544</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a>-&gt;<a class="code" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a3b310d08333033edc119b2a5bd7dcbfb">resolve</a>(input_z, z);</div>
<div class="line"><a name="l09545"></a><span class="lineno"> 9545</span>&#160;      }</div>
<div class="line"><a name="l09546"></a><span class="lineno"> 9546</span>&#160; </div>
<div class="line"><a name="l09547"></a><span class="lineno"> 9547</span>&#160;      <span class="comment">// Redistribute the results into the natural distribution</span></div>
<div class="line"><a name="l09548"></a><span class="lineno"> 9548</span>&#160;      <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a068041cb6b3b60d76ee64be754bedcbe">y</a>.redistribute(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>);</div>
<div class="line"><a name="l09549"></a><span class="lineno"> 9549</span>&#160;      z.redistribute(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>);</div>
<div class="line"><a name="l09550"></a><span class="lineno"> 9550</span>&#160; </div>
<div class="line"><a name="l09551"></a><span class="lineno"> 9551</span>&#160;      <span class="comment">// Now we need to calculate dparam, for which we must calculate the</span></div>
<div class="line"><a name="l09552"></a><span class="lineno"> 9552</span>&#160;      <span class="comment">// dot product of the derivatives and y and z</span></div>
<div class="line"><a name="l09553"></a><span class="lineno"> 9553</span>&#160;      <span class="comment">// Reset these values to zero</span></div>
<div class="line"><a name="l09554"></a><span class="lineno"> 9554</span>&#160;      uderiv_dot_y = 0.0;</div>
<div class="line"><a name="l09555"></a><span class="lineno"> 9555</span>&#160;      uderiv_dot_z = 0.0;</div>
<div class="line"><a name="l09556"></a><span class="lineno"> 9556</span>&#160;      <span class="comment">// Now calculate the dot products of the derivative and the solutions</span></div>
<div class="line"><a name="l09557"></a><span class="lineno"> 9557</span>&#160;      <span class="comment">// of the linear system</span></div>
<div class="line"><a name="l09558"></a><span class="lineno"> 9558</span>&#160;      <span class="comment">// Cache pointers to the data in the distributed vectors</span></div>
<div class="line"><a name="l09559"></a><span class="lineno"> 9559</span>&#160;      <span class="keywordtype">double</span>* <span class="keyword">const</span> y_pt = <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a068041cb6b3b60d76ee64be754bedcbe">y</a>.values_pt();</div>
<div class="line"><a name="l09560"></a><span class="lineno"> 9560</span>&#160;      <span class="keywordtype">double</span>* <span class="keyword">const</span> z_pt = z.values_pt();</div>
<div class="line"><a name="l09561"></a><span class="lineno"> 9561</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l = 0; l &lt; ndof_local; l++)</div>
<div class="line"><a name="l09562"></a><span class="lineno"> 9562</span>&#160;      {</div>
<div class="line"><a name="l09563"></a><span class="lineno"> 9563</span>&#160;        uderiv_dot_y += <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad6df5fb0d282f25df1e94a665dd838e5">dof_derivative</a>(l) * y_pt[l];</div>
<div class="line"><a name="l09564"></a><span class="lineno"> 9564</span>&#160;        uderiv_dot_z += <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad6df5fb0d282f25df1e94a665dd838e5">dof_derivative</a>(l) * z_pt[l];</div>
<div class="line"><a name="l09565"></a><span class="lineno"> 9565</span>&#160;      }</div>
<div class="line"><a name="l09566"></a><span class="lineno"> 9566</span>&#160; </div>
<div class="line"><a name="l09567"></a><span class="lineno"> 9567</span>&#160;      <span class="comment">// Now reduce if we have been distributed</span></div>
<div class="line"><a name="l09568"></a><span class="lineno"> 9568</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l09569"></a><span class="lineno"> 9569</span>&#160;      <span class="comment">// Create send and receive arrays of size two</span></div>
<div class="line"><a name="l09570"></a><span class="lineno"> 9570</span>&#160;      <span class="keywordtype">double</span> uderiv_dot[2];</div>
<div class="line"><a name="l09571"></a><span class="lineno"> 9571</span>&#160;      <span class="keywordtype">double</span> uderiv_dot2[2];</div>
<div class="line"><a name="l09572"></a><span class="lineno"> 9572</span>&#160;      uderiv_dot[0] = uderiv_dot_y;</div>
<div class="line"><a name="l09573"></a><span class="lineno"> 9573</span>&#160;      uderiv_dot[1] = uderiv_dot_z;</div>
<div class="line"><a name="l09574"></a><span class="lineno"> 9574</span>&#160;      uderiv_dot2[0] = uderiv_dot_y;</div>
<div class="line"><a name="l09575"></a><span class="lineno"> 9575</span>&#160;      uderiv_dot2[1] = uderiv_dot_z;</div>
<div class="line"><a name="l09576"></a><span class="lineno"> 9576</span>&#160;      <span class="comment">// Now reduce both together</span></div>
<div class="line"><a name="l09577"></a><span class="lineno"> 9577</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a05842d032d28880ae37951deae804ad8">distributed</a>()) &amp;&amp;</div>
<div class="line"><a name="l09578"></a><span class="lineno"> 9578</span>&#160;          (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a2e4736826a65253f574d4f6f152ab514">communicator_pt</a>()-&gt;<a class="code" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a6c78c72666f4b102c2bccf200f0853b7">nproc</a>() &gt; 1))</div>
<div class="line"><a name="l09579"></a><span class="lineno"> 9579</span>&#160;      {</div>
<div class="line"><a name="l09580"></a><span class="lineno"> 9580</span>&#160;        MPI_Allreduce(uderiv_dot,</div>
<div class="line"><a name="l09581"></a><span class="lineno"> 9581</span>&#160;                      uderiv_dot2,</div>
<div class="line"><a name="l09582"></a><span class="lineno"> 9582</span>&#160;                      2,</div>
<div class="line"><a name="l09583"></a><span class="lineno"> 9583</span>&#160;                      MPI_DOUBLE,</div>
<div class="line"><a name="l09584"></a><span class="lineno"> 9584</span>&#160;                      MPI_SUM,</div>
<div class="line"><a name="l09585"></a><span class="lineno"> 9585</span>&#160;                      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a2e4736826a65253f574d4f6f152ab514">communicator_pt</a>()-&gt;mpi_comm());</div>
<div class="line"><a name="l09586"></a><span class="lineno"> 9586</span>&#160;      }</div>
<div class="line"><a name="l09587"></a><span class="lineno"> 9587</span>&#160;      uderiv_dot_y = uderiv_dot2[0];</div>
<div class="line"><a name="l09588"></a><span class="lineno"> 9588</span>&#160;      uderiv_dot_z = uderiv_dot2[1];</div>
<div class="line"><a name="l09589"></a><span class="lineno"> 9589</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l09590"></a><span class="lineno"> 9590</span>&#160; </div>
<div class="line"><a name="l09591"></a><span class="lineno"> 9591</span>&#160;      <span class="comment">// Now scale the results</span></div>
<div class="line"><a name="l09592"></a><span class="lineno"> 9592</span>&#160;      uderiv_dot_y *= <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a123843ca2ed6384342939ef2b19477ef">Theta_squared</a>;</div>
<div class="line"><a name="l09593"></a><span class="lineno"> 9593</span>&#160;      uderiv_dot_z *= <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a123843ca2ed6384342939ef2b19477ef">Theta_squared</a>;</div>
<div class="line"><a name="l09594"></a><span class="lineno"> 9594</span>&#160; </div>
<div class="line"><a name="l09595"></a><span class="lineno"> 9595</span>&#160;      <span class="comment">// The set the change in the parameter, given by the pseudo-arclength</span></div>
<div class="line"><a name="l09596"></a><span class="lineno"> 9596</span>&#160;      <span class="comment">// equation. Note that here we are assuming that the arc-length</span></div>
<div class="line"><a name="l09597"></a><span class="lineno"> 9597</span>&#160;      <span class="comment">// equation is always exactly zero,</span></div>
<div class="line"><a name="l09598"></a><span class="lineno"> 9598</span>&#160;      <span class="comment">// which seems to work OK, and saves on some storage.</span></div>
<div class="line"><a name="l09599"></a><span class="lineno"> 9599</span>&#160;      <span class="comment">// In fact, it&#39;s more subtle than that. If we include this</span></div>
<div class="line"><a name="l09600"></a><span class="lineno"> 9600</span>&#160;      <span class="comment">// proper residual then we will have to solve the eigenproblem.</span></div>
<div class="line"><a name="l09601"></a><span class="lineno"> 9601</span>&#160;      <span class="comment">// This will make the solver more robust and *should* be done</span></div>
<div class="line"><a name="l09602"></a><span class="lineno"> 9602</span>&#160;      <span class="comment">// ... at some point.</span></div>
<div class="line"><a name="l09603"></a><span class="lineno"> 9603</span>&#160;      <span class="keywordtype">double</span> dparam = (arc_length_constraint_residual - uderiv_dot_y) /</div>
<div class="line"><a name="l09604"></a><span class="lineno"> 9604</span>&#160;                      (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa5082325ca4cafe5a9ec03ef79c67a6f">Parameter_derivative</a> - uderiv_dot_z);</div>
<div class="line"><a name="l09605"></a><span class="lineno"> 9605</span>&#160; </div>
<div class="line"><a name="l09606"></a><span class="lineno"> 9606</span>&#160;      <span class="comment">// Set the new value of the parameter</span></div>
<div class="line"><a name="l09607"></a><span class="lineno"> 9607</span>&#160;      *parameter_pt -= dparam;</div>
<div class="line"><a name="l09608"></a><span class="lineno"> 9608</span>&#160; </div>
<div class="line"><a name="l09609"></a><span class="lineno"> 9609</span>&#160;      <span class="comment">// Update the values of the other degrees of freedom</span></div>
<div class="line"><a name="l09610"></a><span class="lineno"> 9610</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l = 0; l &lt; ndof_local; l++)</div>
<div class="line"><a name="l09611"></a><span class="lineno"> 9611</span>&#160;      {</div>
<div class="line"><a name="l09612"></a><span class="lineno"> 9612</span>&#160;        *<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>[l] -= y_pt[l] - dparam * z_pt[l];</div>
<div class="line"><a name="l09613"></a><span class="lineno"> 9613</span>&#160;      }</div>
<div class="line"><a name="l09614"></a><span class="lineno"> 9614</span>&#160; </div>
<div class="line"><a name="l09615"></a><span class="lineno"> 9615</span>&#160;      <span class="comment">// Calculate the new residuals</span></div>
<div class="line"><a name="l09616"></a><span class="lineno"> 9616</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l09617"></a><span class="lineno"> 9617</span>&#160;      <span class="comment">// Synchronise the solution on different processors (on each submesh)</span></div>
<div class="line"><a name="l09618"></a><span class="lineno"> 9618</span>&#160;      this-&gt;synchronise_all_dofs();</div>
<div class="line"><a name="l09619"></a><span class="lineno"> 9619</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l09620"></a><span class="lineno"> 9620</span>&#160; </div>
<div class="line"><a name="l09621"></a><span class="lineno"> 9621</span>&#160;      <span class="comment">// Do any updates that are required</span></div>
<div class="line"><a name="l09622"></a><span class="lineno"> 9622</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aed8bc6e7b0bb45b86d5b44737b554d50">actions_after_newton_step</a>();</div>
<div class="line"><a name="l09623"></a><span class="lineno"> 9623</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae6ad96ddf5d48b517b89c9a9b879bc4b">actions_before_newton_convergence_check</a>();</div>
<div class="line"><a name="l09624"></a><span class="lineno"> 9624</span>&#160; </div>
<div class="line"><a name="l09625"></a><span class="lineno"> 9625</span>&#160;      <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a068041cb6b3b60d76ee64be754bedcbe">y</a>.clear();</div>
<div class="line"><a name="l09626"></a><span class="lineno"> 9626</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a0103fe1a09ecf7e23a9083b35ef07aac">get_residuals</a>(<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a068041cb6b3b60d76ee64be754bedcbe">y</a>);</div>
<div class="line"><a name="l09627"></a><span class="lineno"> 9627</span>&#160; </div>
<div class="line"><a name="l09628"></a><span class="lineno"> 9628</span>&#160;      <span class="comment">// Get the maximum residuals</span></div>
<div class="line"><a name="l09629"></a><span class="lineno"> 9629</span>&#160;      <span class="keywordtype">double</span> maxres = <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a068041cb6b3b60d76ee64be754bedcbe">y</a>.max();</div>
<div class="line"><a name="l09630"></a><span class="lineno"> 9630</span>&#160; </div>
<div class="line"><a name="l09631"></a><span class="lineno"> 9631</span>&#160;      <span class="comment">// Assemble the residuals for the arc-length step</span></div>
<div class="line"><a name="l09632"></a><span class="lineno"> 9632</span>&#160;      arc_length_constraint_residual = 0.0;</div>
<div class="line"><a name="l09633"></a><span class="lineno"> 9633</span>&#160;      <span class="comment">// Add the variables</span></div>
<div class="line"><a name="l09634"></a><span class="lineno"> 9634</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l = 0; l &lt; ndof_local; l++)</div>
<div class="line"><a name="l09635"></a><span class="lineno"> 9635</span>&#160;      {</div>
<div class="line"><a name="l09636"></a><span class="lineno"> 9636</span>&#160;        arc_length_constraint_residual +=</div>
<div class="line"><a name="l09637"></a><span class="lineno"> 9637</span>&#160;          <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad6df5fb0d282f25df1e94a665dd838e5">dof_derivative</a>(l) * (*<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>[l] - <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a10fd6457ceceb02a0e11d860ac0017c5">dof_current</a>(l));</div>
<div class="line"><a name="l09638"></a><span class="lineno"> 9638</span>&#160;      }</div>
<div class="line"><a name="l09639"></a><span class="lineno"> 9639</span>&#160; </div>
<div class="line"><a name="l09640"></a><span class="lineno"> 9640</span>&#160;      <span class="comment">// Now reduce if we have been distributed</span></div>
<div class="line"><a name="l09641"></a><span class="lineno"> 9641</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l09642"></a><span class="lineno"> 9642</span>&#160;      <span class="keywordtype">double</span> arc_length_cons_res2 = arc_length_constraint_residual;</div>
<div class="line"><a name="l09643"></a><span class="lineno"> 9643</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a05842d032d28880ae37951deae804ad8">distributed</a>()) &amp;&amp;</div>
<div class="line"><a name="l09644"></a><span class="lineno"> 9644</span>&#160;          (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a2e4736826a65253f574d4f6f152ab514">communicator_pt</a>()-&gt;<a class="code" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a6c78c72666f4b102c2bccf200f0853b7">nproc</a>() &gt; 1))</div>
<div class="line"><a name="l09645"></a><span class="lineno"> 9645</span>&#160;      {</div>
<div class="line"><a name="l09646"></a><span class="lineno"> 9646</span>&#160;        MPI_Allreduce(&amp;arc_length_constraint_residual,</div>
<div class="line"><a name="l09647"></a><span class="lineno"> 9647</span>&#160;                      &amp;arc_length_cons_res2,</div>
<div class="line"><a name="l09648"></a><span class="lineno"> 9648</span>&#160;                      1,</div>
<div class="line"><a name="l09649"></a><span class="lineno"> 9649</span>&#160;                      MPI_DOUBLE,</div>
<div class="line"><a name="l09650"></a><span class="lineno"> 9650</span>&#160;                      MPI_SUM,</div>
<div class="line"><a name="l09651"></a><span class="lineno"> 9651</span>&#160;                      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a2e4736826a65253f574d4f6f152ab514">communicator_pt</a>()-&gt;mpi_comm());</div>
<div class="line"><a name="l09652"></a><span class="lineno"> 9652</span>&#160;      }</div>
<div class="line"><a name="l09653"></a><span class="lineno"> 9653</span>&#160;      arc_length_constraint_residual = arc_length_cons_res2;</div>
<div class="line"><a name="l09654"></a><span class="lineno"> 9654</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l09655"></a><span class="lineno"> 9655</span>&#160; </div>
<div class="line"><a name="l09656"></a><span class="lineno"> 9656</span>&#160;      arc_length_constraint_residual *= <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a123843ca2ed6384342939ef2b19477ef">Theta_squared</a>;</div>
<div class="line"><a name="l09657"></a><span class="lineno"> 9657</span>&#160;      arc_length_constraint_residual +=</div>
<div class="line"><a name="l09658"></a><span class="lineno"> 9658</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa5082325ca4cafe5a9ec03ef79c67a6f">Parameter_derivative</a> * (*parameter_pt - <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a8e29673eb80559888d1c6148c4f11e57">Parameter_current</a>) - <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad412d49617d0b0998e5eb440c7a20f3f">Ds_current</a>;</div>
<div class="line"><a name="l09659"></a><span class="lineno"> 9659</span>&#160; </div>
<div class="line"><a name="l09660"></a><span class="lineno"> 9660</span>&#160;      <span class="comment">// Is it the max</span></div>
<div class="line"><a name="l09661"></a><span class="lineno"> 9661</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">std::fabs</a>(arc_length_constraint_residual) &gt; maxres)</div>
<div class="line"><a name="l09662"></a><span class="lineno"> 9662</span>&#160;      {</div>
<div class="line"><a name="l09663"></a><span class="lineno"> 9663</span>&#160;        maxres = <a class="code" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">std::fabs</a>(arc_length_constraint_residual);</div>
<div class="line"><a name="l09664"></a><span class="lineno"> 9664</span>&#160;      }</div>
<div class="line"><a name="l09665"></a><span class="lineno"> 9665</span>&#160; </div>
<div class="line"><a name="l09666"></a><span class="lineno"> 9666</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab4a3743c23a2d1eed56981484636c958">Shut_up_in_newton_solve</a>)</div>
<div class="line"><a name="l09667"></a><span class="lineno"> 9667</span>&#160;      {</div>
<div class="line"><a name="l09668"></a><span class="lineno"> 9668</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Continuation Step &quot;</span> &lt;&lt; count &lt;&lt; <span class="stringliteral">&quot;:  Maximum residuals &quot;</span></div>
<div class="line"><a name="l09669"></a><span class="lineno"> 9669</span>&#160;                   &lt;&lt; maxres &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09670"></a><span class="lineno"> 9670</span>&#160;      }</div>
<div class="line"><a name="l09671"></a><span class="lineno"> 9671</span>&#160; </div>
<div class="line"><a name="l09672"></a><span class="lineno"> 9672</span>&#160;      <span class="comment">// If we have converged jump straight to the test at the end of the loop</span></div>
<div class="line"><a name="l09673"></a><span class="lineno"> 9673</span>&#160;      <span class="keywordflow">if</span> (maxres &lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a94536b381e949edf5bb4d44434e08925">Newton_solver_tolerance</a>)</div>
<div class="line"><a name="l09674"></a><span class="lineno"> 9674</span>&#160;      {</div>
<div class="line"><a name="l09675"></a><span class="lineno"> 9675</span>&#160;        LOOP_FLAG = 0;</div>
<div class="line"><a name="l09676"></a><span class="lineno"> 9676</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l09677"></a><span class="lineno"> 9677</span>&#160;      }</div>
<div class="line"><a name="l09678"></a><span class="lineno"> 9678</span>&#160; </div>
<div class="line"><a name="l09679"></a><span class="lineno"> 9679</span>&#160;      <span class="comment">// This section will not be reached if we have converged already</span></div>
<div class="line"><a name="l09680"></a><span class="lineno"> 9680</span>&#160;      <span class="comment">// If the maximum number of residuals is too high or the maximum number</span></div>
<div class="line"><a name="l09681"></a><span class="lineno"> 9681</span>&#160;      <span class="comment">// of iterations has been reached</span></div>
<div class="line"><a name="l09682"></a><span class="lineno"> 9682</span>&#160;      <span class="keywordflow">if</span> ((maxres &gt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accb8811cdf32f14be497917e922c623e">Max_residuals</a>) || (count == <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a52a58a98c3e2e7dbaefcfb1ee7830c35">Max_newton_iterations</a>))</div>
<div class="line"><a name="l09683"></a><span class="lineno"> 9683</span>&#160;      {</div>
<div class="line"><a name="l09684"></a><span class="lineno"> 9684</span>&#160;        <span class="keywordflow">throw</span> NewtonSolverError(count, maxres);</div>
<div class="line"><a name="l09685"></a><span class="lineno"> 9685</span>&#160;      }</div>
<div class="line"><a name="l09686"></a><span class="lineno"> 9686</span>&#160; </div>
<div class="line"><a name="l09687"></a><span class="lineno"> 9687</span>&#160;    } <span class="keywordflow">while</span> (LOOP_FLAG);</div>
<div class="line"><a name="l09688"></a><span class="lineno"> 9688</span>&#160; </div>
<div class="line"><a name="l09689"></a><span class="lineno"> 9689</span>&#160;    <span class="comment">// Now update anything that needs updating</span></div>
<div class="line"><a name="l09690"></a><span class="lineno"> 9690</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a033ec7301123deeb7e56d04c38f9f1da">actions_after_newton_solve</a>();</div>
<div class="line"><a name="l09691"></a><span class="lineno"> 9691</span>&#160; </div>
<div class="line"><a name="l09692"></a><span class="lineno"> 9692</span>&#160;    <span class="comment">// Reset the storage of the matrix on the linear solver to what it was</span></div>
<div class="line"><a name="l09693"></a><span class="lineno"> 9693</span>&#160;    <span class="comment">// on entry to this routine</span></div>
<div class="line"><a name="l09694"></a><span class="lineno"> 9694</span>&#160;    <span class="keywordflow">if</span> (enable_resolve)</div>
<div class="line"><a name="l09695"></a><span class="lineno"> 9695</span>&#160;    {</div>
<div class="line"><a name="l09696"></a><span class="lineno"> 9696</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a>-&gt;<a class="code" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a3000ebd9becb3468d8a6a821a9cc0cd9">enable_resolve</a>();</div>
<div class="line"><a name="l09697"></a><span class="lineno"> 9697</span>&#160;    }</div>
<div class="line"><a name="l09698"></a><span class="lineno"> 9698</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l09699"></a><span class="lineno"> 9699</span>&#160;    {</div>
<div class="line"><a name="l09700"></a><span class="lineno"> 9700</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a>-&gt;<a class="code" href="../../d5/dd7/classoomph_1_1LinearSolver.html#ad61c63af94c5961830bd9807225a48d6">disable_resolve</a>();</div>
<div class="line"><a name="l09701"></a><span class="lineno"> 9701</span>&#160;    }</div>
<div class="line"><a name="l09702"></a><span class="lineno"> 9702</span>&#160; </div>
<div class="line"><a name="l09703"></a><span class="lineno"> 9703</span>&#160;    <span class="comment">// Return the number of Newton Steps taken</span></div>
<div class="line"><a name="l09704"></a><span class="lineno"> 9704</span>&#160;    <span class="keywordflow">return</span> count;</div>
<div class="line"><a name="l09705"></a><span class="lineno"> 9705</span>&#160;  }</div>
<div class="ttc" id="alevel1__cplx__impl_8h_html_a068041cb6b3b60d76ee64be754bedcbe"><div class="ttname"><a href="../../d2/d2e/level1__cplx__impl_8h.html#a068041cb6b3b60d76ee64be754bedcbe">y</a></div><div class="ttdeci">Scalar * y</div><div class="ttdef"><b>Definition:</b> level1_cplx_impl.h:128</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a033ec7301123deeb7e56d04c38f9f1da">actions_after_newton_solve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aed8bc6e7b0bb45b86d5b44737b554d50">actions_after_newton_step()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae6ad96ddf5d48b517b89c9a9b879bc4b">actions_before_newton_convergence_check()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a0c8d70891f7369bb4bf8412fa1a08ecb">actions_before_newton_solve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a07fc81781c74b25c8a426ec18295b0d0">actions_before_newton_step()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a01d7376ab9cc06e4d5619b34fd39dee2">Always_take_one_newton_step</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#af1677445056759263b1b076966e7bfae">oomph::DoubleVector::clear()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a2e4736826a65253f574d4f6f152ab514">oomph::LinearAlgebraDistribution::communicator_pt()</a>, <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#ad61c63af94c5961830bd9807225a48d6">oomph::LinearSolver::disable_resolve()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a05842d032d28880ae37951deae804ad8">oomph::LinearAlgebraDistribution::distributed()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a10fd6457ceceb02a0e11d860ac0017c5">dof_current()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad6df5fb0d282f25df1e94a665dd838e5">dof_derivative()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad412d49617d0b0998e5eb440c7a20f3f">Ds_current</a>, <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a3000ebd9becb3468d8a6a821a9cc0cd9">oomph::LinearSolver::enable_resolve()</a>, <a class="el" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">boost::multiprecision::fabs()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#adc456017cfc4fb4ae6f522973e50f496">get_derivative_wrt_global_parameter()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a0103fe1a09ecf7e23a9083b35ef07aac">get_residuals()</a>, <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#ae1e4d34a7e2b1537d36153f87e8a62a6">oomph::LinearSolver::is_resolve_enabled()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a519de6f6f70c8b0f6bacbde5e0a35cd7">Linear_solver_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a52a58a98c3e2e7dbaefcfb1ee7830c35">Max_newton_iterations</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accb8811cdf32f14be497917e922c623e">Max_residuals</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a94536b381e949edf5bb4d44434e08925">Newton_solver_tolerance</a>, <a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a6c78c72666f4b102c2bccf200f0853b7">oomph::OomphCommunicator::nproc()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">oomph::LinearAlgebraDistribution::nrow_local()</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a8e29673eb80559888d1c6148c4f11e57">Parameter_current</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa5082325ca4cafe5a9ec03ef79c67a6f">Parameter_derivative</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#a9396b861977c16606d8eca39056976c8">oomph::DoubleVector::redistribute()</a>, <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a3b310d08333033edc119b2a5bd7dcbfb">oomph::LinearSolver::resolve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab4a3743c23a2d1eed56981484636c958">Shut_up_in_newton_solve</a>, <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a15ce22542b74ed1826ea485edacbeb6e">oomph::LinearSolver::solve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a123843ca2ed6384342939ef2b19477ef">Theta_squared</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#a8c3dcdf8a602a1f266bbe72d98fde2e7">oomph::DoubleVector::values_pt()</a>, and <a class="el" href="../../d2/d2e/level1__cplx__impl_8h.html#a068041cb6b3b60d76ee64be754bedcbe">y</a>.</p>

</div>
</div>
<a id="aa43a98d2303f2bce10d0887dc0b2eac5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa43a98d2303f2bce10d0887dc0b2eac5">&#9670;&nbsp;</a></span>newton_solver_tolerance()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a>&amp; oomph::Problem::newton_solver_tolerance </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Access function to tolererance of the Newton solver, i.e. the maximum value of the residuals that will be accepted. </p>
<div class="fragment"><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;    {</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a94536b381e949edf5bb4d44434e08925">Newton_solver_tolerance</a>;</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a94536b381e949edf5bb4d44434e08925">Newton_solver_tolerance</a>.</p>

</div>
</div>
<a id="a60a9b6861928cf9115110b5bfc7d11a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60a9b6861928cf9115110b5bfc7d11a7">&#9670;&nbsp;</a></span>nglobal_data()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> oomph::Problem::nglobal_data </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the number of global data values. </p>
<div class="fragment"><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    {</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>.size();</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d9e/classoomph_1_1IMRByBDF.html#a1eb1b47643bf37e27c478c6987c7716d">oomph::IMRByBDF::actions_after_timestep()</a>, <a class="el" href="../../d2/da2/classoomph_1_1PeriodicOrbitAssemblyHandler.html#a358d1749faa8ac7dd0de87340d878088">oomph::PeriodicOrbitAssemblyHandler&lt; NNODE_1D &gt;::adapt_temporal_mesh()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab8b63040a3c6deff68fb2128c2f7fef2">copy()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a74a72dc989531d264ec1959f3015b98c">describe_dofs()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#adb5998dfed961de76c33ae3b6fa516b4">get_dofs()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac3ec67f2c633cc414905ade9fa148939">set_dofs()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6aab91bb814a85409648dc87807907e6">set_pinned_values_to_zero()</a>.</p>

</div>
</div>
<a id="accc4e5a46953800933f07ae6bd67860e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#accc4e5a46953800933f07ae6bd67860e">&#9670;&nbsp;</a></span>nsub_mesh()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> oomph::Problem::nsub_mesh </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return number of submeshes. </p>
<div class="fragment"><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    {</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab65f6fc9c49860e6324457a7e6e76346">Sub_mesh_pt</a>.size();</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab65f6fc9c49860e6324457a7e6e76346">Sub_mesh_pt</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5e60c7b47591bca6b20b0612e119983">adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a309487c952f108015b53a2d70539ac8b">adapt_based_on_error_estimates()</a>, <a class="el" href="../../d2/da2/classoomph_1_1PeriodicOrbitAssemblyHandler.html#a358d1749faa8ac7dd0de87340d878088">oomph::PeriodicOrbitAssemblyHandler&lt; NNODE_1D &gt;::adapt_temporal_mesh()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab8b63040a3c6deff68fb2128c2f7fef2">copy()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae796d578da9c7578742f7a6e1f5d0c0a">delete_all_external_storage()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a74a72dc989531d264ec1959f3015b98c">describe_dofs()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#adfa6431916fd73b661d8a62706d5137f">doc_errors()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a75fe4a89f7dccbd72a67333b3959539d">does_pointer_correspond_to_problem_data()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a1756534851a763f35fd5372b4d3723e0">dump()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a2bd35d5954b6a8d43189b84520adb4b3">get_all_error_estimates()</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ac3f40f62d33d33616cdb4bed48aaccde">oomph::NavierStokesSchurComplementPreconditioner::get_pressure_advection_diffusion_matrix()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a350e611af4847eabfa1d531b14b4439c">p_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad73bff32f14763e813cabdcd4c88c06">p_refine_selected_elements()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a093b78c1820cf3fe6bd9ec3deb605b49">p_refine_uniformly()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a80ff24a4fc923660f2aabfaa763822bf">p_refine_uniformly_and_prune()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7460f9339fd4850112284a86e039ee00">p_refine_uniformly_aux()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#afa0aab9ca7018bf875c1f3367c6c07e3">p_unrefine_uniformly()</a>, <a class="el" href="../../d7/db6/namespaceoomph_1_1METIS.html#aa3c7e4be46d6148cc60f43354127fc94">oomph::METIS::partition_mesh()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a4f6011ef141cc68598a9502052129a3f">read()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a3dcfc37fe1b6c21d694407981830c1e5">refine_selected_elements()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a1ce3a9162aaef9e0a4d86f8de57eb523">refine_uniformly()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac0495df29dde90577e4702fcac496684">refine_uniformly_and_prune()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#affb22db0c6f1e14ae120b153b85831a3">refine_uniformly_aux()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7b7f290d47c78868860cb3561f1c6443">self_test()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae78e313f1dc3bc956f42a5d0bd06c459">set_consistent_pinned_values_for_continuation()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a50d54d4b374ea6a8d76798f34b865944">set_timestepper_for_all_data()</a>, <a class="el" href="../../de/da7/classoomph_1_1SegregatableFSIProblem.html#a12e662227e5daf656244a531f40022f9">oomph::SegregatableFSIProblem::setup_segregated_solver()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a56429d79e517d59a54cd49949b04d3ae">unrefine_uniformly()</a>.</p>

</div>
</div>
<a id="ace3cdf55009c3bff21d2b7d3706d522a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace3cdf55009c3bff21d2b7d3706d522a">&#9670;&nbsp;</a></span>ntime_stepper()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> oomph::Problem::ntime_stepper </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the number of time steppers. </p>
<div class="fragment"><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;    {</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#af1e8f8a739453250eb3744fea2a3b983">Time_stepper_pt</a>.size();</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af1e8f8a739453250eb3744fea2a3b983">Time_stepper_pt</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d9e/classoomph_1_1IMRByBDF.html#abc155a68889d297f732a083d911b4627">oomph::IMRByBDF::actions_before_timestep()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a63805c549e71b7c73107abe6001fae25">adaptive_unsteady_newton_solve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aee0d9902fd26b600c9519bea2dfc0f54">arc_length_step_solve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acc35de219c1c1032a14840021fd8a6b9">arc_length_step_solve_helper()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab8b63040a3c6deff68fb2128c2f7fef2">copy()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a0daf749053a1afb0bdea7faa583dd7c7">get_dvaluesdt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5f7e9e91eab83d600c94afdad532a6fb">initialise_dt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a06cf96b1291774eb89517af10f80410a">solve_eigenproblem()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a64b890295532c3a7ff5ad4e4dd5d56e3">steady_newton_solve()</a>, <a class="el" href="../../de/da7/classoomph_1_1SegregatableFSIProblem.html#a8f8145df86358916df505e2b513caf6a">oomph::SegregatableFSIProblem::steady_segregated_solve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a4b015281f27d25ee0209cd9b467175b6">unsteady_newton_solve()</a>, and <a class="el" href="../../de/da7/classoomph_1_1SegregatableFSIProblem.html#a17f019ebaf83e170219bf605a8554111">oomph::SegregatableFSIProblem::unsteady_segregated_solve()</a>.</p>

</div>
</div>
<a id="ae015f3c07e2218748b347f42abe45da1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae015f3c07e2218748b347f42abe45da1">&#9670;&nbsp;</a></span>operator=()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Problem::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Broken assignment operator. </p>

</div>
</div>
<a id="aaad4443f87f3f3affe53fa9160802e7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaad4443f87f3f3affe53fa9160802e7c">&#9670;&nbsp;</a></span>p_adapt() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Problem::p_adapt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>p-adapt problem: Perform mesh adaptation for (all) refineable (sub)mesh(es), based on their own error estimates and the target errors specified in the mesh(es). Following mesh adaptation, update global mesh, and re-assign equation numbers. On return from this function, Problem can immediately be solved again. [Argument-free wrapper] </p>
<div class="fragment"><div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;    {</div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;      <span class="keywordtype">unsigned</span> n_refined, n_unrefined;</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aaad4443f87f3f3affe53fa9160802e7c">p_adapt</a>(n_refined, n_unrefined);</div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1Problem_html_aaad4443f87f3f3affe53fa9160802e7c"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#aaad4443f87f3f3affe53fa9160802e7c">oomph::Problem::p_adapt</a></div><div class="ttdeci">void p_adapt()</div><div class="ttdef"><b>Definition:</b> problem.h:2881</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a350e611af4847eabfa1d531b14b4439c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a350e611af4847eabfa1d531b14b4439c">&#9670;&nbsp;</a></span>p_adapt() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::p_adapt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>n_refined</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>n_unrefined</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>p-adapt problem: Perform mesh adaptation for (all) refineable (sub)mesh(es), based on their own error estimates and the target errors specified in the mesh(es). Following mesh adaptation, update global mesh, and re-assign equation numbers. Return # of refined/unrefined elements. On return from this function, Problem can immediately be solved again. </p>
<div class="fragment"><div class="line"><a name="l14244"></a><span class="lineno">14244</span>&#160;  {</div>
<div class="line"><a name="l14245"></a><span class="lineno">14245</span>&#160;    <span class="keywordtype">double</span> t_start_total = 0.0;</div>
<div class="line"><a name="l14246"></a><span class="lineno">14246</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l14247"></a><span class="lineno">14247</span>&#160;    {</div>
<div class="line"><a name="l14248"></a><span class="lineno">14248</span>&#160;      t_start_total = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l14249"></a><span class="lineno">14249</span>&#160;    }</div>
<div class="line"><a name="l14250"></a><span class="lineno">14250</span>&#160; </div>
<div class="line"><a name="l14251"></a><span class="lineno">14251</span>&#160;    <span class="comment">// Get the bifurcation type</span></div>
<div class="line"><a name="l14252"></a><span class="lineno">14252</span>&#160;    <span class="keywordtype">int</span> bifurcation_type = this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>-&gt;<a class="code" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a22c5f240674e4f6cee12006790c11dae">bifurcation_type</a>();</div>
<div class="line"><a name="l14253"></a><span class="lineno">14253</span>&#160; </div>
<div class="line"><a name="l14254"></a><span class="lineno">14254</span>&#160;    <span class="comment">// If we are tracking a bifurcation then call the bifurcation adapt function</span></div>
<div class="line"><a name="l14255"></a><span class="lineno">14255</span>&#160;    <span class="keywordflow">if</span> (bifurcation_type != 0)</div>
<div class="line"><a name="l14256"></a><span class="lineno">14256</span>&#160;    {</div>
<div class="line"><a name="l14257"></a><span class="lineno">14257</span>&#160;      this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa0b4e7868e02e2d12845c9b2dd60cab9">bifurcation_adapt_helper</a>(n_refined, n_unrefined, bifurcation_type);</div>
<div class="line"><a name="l14258"></a><span class="lineno">14258</span>&#160;      <span class="comment">// Return immediately</span></div>
<div class="line"><a name="l14259"></a><span class="lineno">14259</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l14260"></a><span class="lineno">14260</span>&#160;    }</div>
<div class="line"><a name="l14261"></a><span class="lineno">14261</span>&#160; </div>
<div class="line"><a name="l14262"></a><span class="lineno">14262</span>&#160;    <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; std::endl &lt;&lt; std::endl;</div>
<div class="line"><a name="l14263"></a><span class="lineno">14263</span>&#160;    <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;p-adapting problem:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l14264"></a><span class="lineno">14264</span>&#160;    <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;===================&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l14265"></a><span class="lineno">14265</span>&#160; </div>
<div class="line"><a name="l14266"></a><span class="lineno">14266</span>&#160;    <span class="keywordtype">double</span> t_start = 0.0;</div>
<div class="line"><a name="l14267"></a><span class="lineno">14267</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l14268"></a><span class="lineno">14268</span>&#160;    {</div>
<div class="line"><a name="l14269"></a><span class="lineno">14269</span>&#160;      t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l14270"></a><span class="lineno">14270</span>&#160;    }</div>
<div class="line"><a name="l14271"></a><span class="lineno">14271</span>&#160; </div>
<div class="line"><a name="l14272"></a><span class="lineno">14272</span>&#160;    <span class="comment">// Call the actions before adaptation</span></div>
<div class="line"><a name="l14273"></a><span class="lineno">14273</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">actions_before_adapt</a>();</div>
<div class="line"><a name="l14274"></a><span class="lineno">14274</span>&#160; </div>
<div class="line"><a name="l14275"></a><span class="lineno">14275</span>&#160;    <span class="keywordtype">double</span> t_end = 0.0;</div>
<div class="line"><a name="l14276"></a><span class="lineno">14276</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l14277"></a><span class="lineno">14277</span>&#160;    {</div>
<div class="line"><a name="l14278"></a><span class="lineno">14278</span>&#160;      t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l14279"></a><span class="lineno">14279</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for actions before adapt: &quot;</span> &lt;&lt; t_end - t_start</div>
<div class="line"><a name="l14280"></a><span class="lineno">14280</span>&#160;                 &lt;&lt; std::endl;</div>
<div class="line"><a name="l14281"></a><span class="lineno">14281</span>&#160;      t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l14282"></a><span class="lineno">14282</span>&#160;    }</div>
<div class="line"><a name="l14283"></a><span class="lineno">14283</span>&#160; </div>
<div class="line"><a name="l14284"></a><span class="lineno">14284</span>&#160;    <span class="comment">// Initialise counters</span></div>
<div class="line"><a name="l14285"></a><span class="lineno">14285</span>&#160;    n_refined = 0;</div>
<div class="line"><a name="l14286"></a><span class="lineno">14286</span>&#160;    n_unrefined = 0;</div>
<div class="line"><a name="l14287"></a><span class="lineno">14287</span>&#160; </div>
<div class="line"><a name="l14288"></a><span class="lineno">14288</span>&#160;    <span class="comment">// Number of submeshes?</span></div>
<div class="line"><a name="l14289"></a><span class="lineno">14289</span>&#160;    <span class="keywordtype">unsigned</span> Nmesh = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>();</div>
<div class="line"><a name="l14290"></a><span class="lineno">14290</span>&#160; </div>
<div class="line"><a name="l14291"></a><span class="lineno">14291</span>&#160;    <span class="comment">// Single mesh:</span></div>
<div class="line"><a name="l14292"></a><span class="lineno">14292</span>&#160;    <span class="comment">//------------</span></div>
<div class="line"><a name="l14293"></a><span class="lineno">14293</span>&#160;    <span class="keywordflow">if</span> (Nmesh == 0)</div>
<div class="line"><a name="l14294"></a><span class="lineno">14294</span>&#160;    {</div>
<div class="line"><a name="l14295"></a><span class="lineno">14295</span>&#160;      <span class="comment">// Refine single mesh if possible</span></div>
<div class="line"><a name="l14296"></a><span class="lineno">14296</span>&#160;      <span class="keywordflow">if</span> (RefineableMeshBase* mmesh_pt =</div>
<div class="line"><a name="l14297"></a><span class="lineno">14297</span>&#160;            <span class="keyword">dynamic_cast&lt;</span>RefineableMeshBase*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(0)))</div>
<div class="line"><a name="l14298"></a><span class="lineno">14298</span>&#160;      {</div>
<div class="line"><a name="l14299"></a><span class="lineno">14299</span>&#160;        <span class="keywordflow">if</span> (mmesh_pt-&gt;is_p_adaptation_enabled())</div>
<div class="line"><a name="l14300"></a><span class="lineno">14300</span>&#160;        {</div>
<div class="line"><a name="l14301"></a><span class="lineno">14301</span>&#160;          <span class="keywordtype">double</span> t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l14302"></a><span class="lineno">14302</span>&#160; </div>
<div class="line"><a name="l14303"></a><span class="lineno">14303</span>&#160;          <span class="comment">// Get pointer to error estimator</span></div>
<div class="line"><a name="l14304"></a><span class="lineno">14304</span>&#160;          ErrorEstimator* <a class="code" href="../../d8/d32/namespaceMeshRefinement.html#a9dade531077f055da144a85e19e67263">error_estimator_pt</a> =</div>
<div class="line"><a name="l14305"></a><span class="lineno">14305</span>&#160;            mmesh_pt-&gt;spatial_error_estimator_pt();</div>
<div class="line"><a name="l14306"></a><span class="lineno">14306</span>&#160; </div>
<div class="line"><a name="l14307"></a><span class="lineno">14307</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l14308"></a><span class="lineno">14308</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d8/d32/namespaceMeshRefinement.html#a9dade531077f055da144a85e19e67263">error_estimator_pt</a> == 0)</div>
<div class="line"><a name="l14309"></a><span class="lineno">14309</span>&#160;          {</div>
<div class="line"><a name="l14310"></a><span class="lineno">14310</span>&#160;            <span class="keywordflow">throw</span> OomphLibError(<span class="stringliteral">&quot;Error estimator hasn&#39;t been set yet&quot;</span>,</div>
<div class="line"><a name="l14311"></a><span class="lineno">14311</span>&#160;                                <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l14312"></a><span class="lineno">14312</span>&#160;                                <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l14313"></a><span class="lineno">14313</span>&#160;          }</div>
<div class="line"><a name="l14314"></a><span class="lineno">14314</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l14315"></a><span class="lineno">14315</span>&#160; </div>
<div class="line"><a name="l14316"></a><span class="lineno">14316</span>&#160;          <span class="comment">// Get error for all elements</span></div>
<div class="line"><a name="l14317"></a><span class="lineno">14317</span>&#160;          Vector&lt;double&gt; elemental_error(mmesh_pt-&gt;nelement());</div>
<div class="line"><a name="l14318"></a><span class="lineno">14318</span>&#160; </div>
<div class="line"><a name="l14319"></a><span class="lineno">14319</span>&#160;          <span class="keywordflow">if</span> (mmesh_pt-&gt;doc_info_pt() == 0)</div>
<div class="line"><a name="l14320"></a><span class="lineno">14320</span>&#160;          {</div>
<div class="line"><a name="l14321"></a><span class="lineno">14321</span>&#160;            <a class="code" href="../../d8/d32/namespaceMeshRefinement.html#a9dade531077f055da144a85e19e67263">error_estimator_pt</a>-&gt;get_element_errors(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(0), elemental_error);</div>
<div class="line"><a name="l14322"></a><span class="lineno">14322</span>&#160;          }</div>
<div class="line"><a name="l14323"></a><span class="lineno">14323</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l14324"></a><span class="lineno">14324</span>&#160;          {</div>
<div class="line"><a name="l14325"></a><span class="lineno">14325</span>&#160;            <a class="code" href="../../d8/d32/namespaceMeshRefinement.html#a9dade531077f055da144a85e19e67263">error_estimator_pt</a>-&gt;get_element_errors(</div>
<div class="line"><a name="l14326"></a><span class="lineno">14326</span>&#160;              <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(0), elemental_error, *mmesh_pt-&gt;doc_info_pt());</div>
<div class="line"><a name="l14327"></a><span class="lineno">14327</span>&#160;          }</div>
<div class="line"><a name="l14328"></a><span class="lineno">14328</span>&#160; </div>
<div class="line"><a name="l14329"></a><span class="lineno">14329</span>&#160;          <span class="comment">// Store max./min actual error</span></div>
<div class="line"><a name="l14330"></a><span class="lineno">14330</span>&#160;          mmesh_pt-&gt;max_error() = <a class="code" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">std::fabs</a>(*std::max_element(</div>
<div class="line"><a name="l14331"></a><span class="lineno">14331</span>&#160;            elemental_error.begin(), elemental_error.end(), AbsCmp&lt;double&gt;()));</div>
<div class="line"><a name="l14332"></a><span class="lineno">14332</span>&#160; </div>
<div class="line"><a name="l14333"></a><span class="lineno">14333</span>&#160;          mmesh_pt-&gt;min_error() = <a class="code" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">std::fabs</a>(*std::min_element(</div>
<div class="line"><a name="l14334"></a><span class="lineno">14334</span>&#160;            elemental_error.begin(), elemental_error.end(), AbsCmp&lt;double&gt;()));</div>
<div class="line"><a name="l14335"></a><span class="lineno">14335</span>&#160; </div>
<div class="line"><a name="l14336"></a><span class="lineno">14336</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;\n Max/min error: &quot;</span> &lt;&lt; mmesh_pt-&gt;max_error() &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l14337"></a><span class="lineno">14337</span>&#160;                     &lt;&lt; mmesh_pt-&gt;min_error() &lt;&lt; std::endl</div>
<div class="line"><a name="l14338"></a><span class="lineno">14338</span>&#160;                     &lt;&lt; std::endl;</div>
<div class="line"><a name="l14339"></a><span class="lineno">14339</span>&#160; </div>
<div class="line"><a name="l14340"></a><span class="lineno">14340</span>&#160; </div>
<div class="line"><a name="l14341"></a><span class="lineno">14341</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l14342"></a><span class="lineno">14342</span>&#160;          {</div>
<div class="line"><a name="l14343"></a><span class="lineno">14343</span>&#160;            t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l14344"></a><span class="lineno">14344</span>&#160;            <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for error estimation: &quot;</span> &lt;&lt; t_end - t_start</div>
<div class="line"><a name="l14345"></a><span class="lineno">14345</span>&#160;                       &lt;&lt; std::endl;</div>
<div class="line"><a name="l14346"></a><span class="lineno">14346</span>&#160;            t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l14347"></a><span class="lineno">14347</span>&#160;          }</div>
<div class="line"><a name="l14348"></a><span class="lineno">14348</span>&#160; </div>
<div class="line"><a name="l14349"></a><span class="lineno">14349</span>&#160;          <span class="comment">// Adapt mesh</span></div>
<div class="line"><a name="l14350"></a><span class="lineno">14350</span>&#160;          mmesh_pt-&gt;p_adapt(elemental_error);</div>
<div class="line"><a name="l14351"></a><span class="lineno">14351</span>&#160; </div>
<div class="line"><a name="l14352"></a><span class="lineno">14352</span>&#160;          <span class="comment">// Add to counters</span></div>
<div class="line"><a name="l14353"></a><span class="lineno">14353</span>&#160;          n_refined += mmesh_pt-&gt;nrefined();</div>
<div class="line"><a name="l14354"></a><span class="lineno">14354</span>&#160;          n_unrefined += mmesh_pt-&gt;nunrefined();</div>
<div class="line"><a name="l14355"></a><span class="lineno">14355</span>&#160; </div>
<div class="line"><a name="l14356"></a><span class="lineno">14356</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l14357"></a><span class="lineno">14357</span>&#160;          {</div>
<div class="line"><a name="l14358"></a><span class="lineno">14358</span>&#160;            t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l14359"></a><span class="lineno">14359</span>&#160;            <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for complete mesh adaptation &quot;</span></div>
<div class="line"><a name="l14360"></a><span class="lineno">14360</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot;(but excluding comp of error estimate): &quot;</span></div>
<div class="line"><a name="l14361"></a><span class="lineno">14361</span>&#160;                       &lt;&lt; t_end - t_start &lt;&lt; std::endl;</div>
<div class="line"><a name="l14362"></a><span class="lineno">14362</span>&#160;            t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l14363"></a><span class="lineno">14363</span>&#160;          }</div>
<div class="line"><a name="l14364"></a><span class="lineno">14364</span>&#160;        }</div>
<div class="line"><a name="l14365"></a><span class="lineno">14365</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l14366"></a><span class="lineno">14366</span>&#160;        {</div>
<div class="line"><a name="l14367"></a><span class="lineno">14367</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Mesh adaptation is disabled.&quot;</span></div>
<div class="line"><a name="l14368"></a><span class="lineno">14368</span>&#160;                     &lt;&lt; std::endl;</div>
<div class="line"><a name="l14369"></a><span class="lineno">14369</span>&#160;        }</div>
<div class="line"><a name="l14370"></a><span class="lineno">14370</span>&#160;      }</div>
<div class="line"><a name="l14371"></a><span class="lineno">14371</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l14372"></a><span class="lineno">14372</span>&#160;      {</div>
<div class="line"><a name="l14373"></a><span class="lineno">14373</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Mesh cannot be adapted&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l14374"></a><span class="lineno">14374</span>&#160;      }</div>
<div class="line"><a name="l14375"></a><span class="lineno">14375</span>&#160;    }</div>
<div class="line"><a name="l14376"></a><span class="lineno">14376</span>&#160;    <span class="comment">// Multiple submeshes</span></div>
<div class="line"><a name="l14377"></a><span class="lineno">14377</span>&#160;    <span class="comment">//------------------</span></div>
<div class="line"><a name="l14378"></a><span class="lineno">14378</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l14379"></a><span class="lineno">14379</span>&#160;    {</div>
<div class="line"><a name="l14380"></a><span class="lineno">14380</span>&#160;      <span class="comment">// Loop over submeshes</span></div>
<div class="line"><a name="l14381"></a><span class="lineno">14381</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> imesh = 0; imesh &lt; Nmesh; imesh++)</div>
<div class="line"><a name="l14382"></a><span class="lineno">14382</span>&#160;      {</div>
<div class="line"><a name="l14383"></a><span class="lineno">14383</span>&#160;        <span class="comment">// Refine single mesh uniformly if possible</span></div>
<div class="line"><a name="l14384"></a><span class="lineno">14384</span>&#160;        <span class="keywordflow">if</span> (RefineableMeshBase* mmesh_pt =</div>
<div class="line"><a name="l14385"></a><span class="lineno">14385</span>&#160;              <span class="keyword">dynamic_cast&lt;</span>RefineableMeshBase*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(imesh)))</div>
<div class="line"><a name="l14386"></a><span class="lineno">14386</span>&#160;        {</div>
<div class="line"><a name="l14387"></a><span class="lineno">14387</span>&#160;          <span class="keywordtype">double</span> t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l14388"></a><span class="lineno">14388</span>&#160; </div>
<div class="line"><a name="l14389"></a><span class="lineno">14389</span>&#160;          <span class="comment">// Get pointer to error estimator</span></div>
<div class="line"><a name="l14390"></a><span class="lineno">14390</span>&#160;          ErrorEstimator* <a class="code" href="../../d8/d32/namespaceMeshRefinement.html#a9dade531077f055da144a85e19e67263">error_estimator_pt</a> =</div>
<div class="line"><a name="l14391"></a><span class="lineno">14391</span>&#160;            mmesh_pt-&gt;spatial_error_estimator_pt();</div>
<div class="line"><a name="l14392"></a><span class="lineno">14392</span>&#160; </div>
<div class="line"><a name="l14393"></a><span class="lineno">14393</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l14394"></a><span class="lineno">14394</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d8/d32/namespaceMeshRefinement.html#a9dade531077f055da144a85e19e67263">error_estimator_pt</a> == 0)</div>
<div class="line"><a name="l14395"></a><span class="lineno">14395</span>&#160;          {</div>
<div class="line"><a name="l14396"></a><span class="lineno">14396</span>&#160;            <span class="keywordflow">throw</span> OomphLibError(<span class="stringliteral">&quot;Error estimator hasn&#39;t been set yet&quot;</span>,</div>
<div class="line"><a name="l14397"></a><span class="lineno">14397</span>&#160;                                <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l14398"></a><span class="lineno">14398</span>&#160;                                <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l14399"></a><span class="lineno">14399</span>&#160;          }</div>
<div class="line"><a name="l14400"></a><span class="lineno">14400</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l14401"></a><span class="lineno">14401</span>&#160; </div>
<div class="line"><a name="l14402"></a><span class="lineno">14402</span>&#160;          <span class="keywordflow">if</span> (mmesh_pt-&gt;is_p_adaptation_enabled())</div>
<div class="line"><a name="l14403"></a><span class="lineno">14403</span>&#160;          {</div>
<div class="line"><a name="l14404"></a><span class="lineno">14404</span>&#160;            <span class="comment">// Get error for all elements</span></div>
<div class="line"><a name="l14405"></a><span class="lineno">14405</span>&#160;            Vector&lt;double&gt; elemental_error(mmesh_pt-&gt;nelement());</div>
<div class="line"><a name="l14406"></a><span class="lineno">14406</span>&#160;            <span class="keywordflow">if</span> (mmesh_pt-&gt;doc_info_pt() == 0)</div>
<div class="line"><a name="l14407"></a><span class="lineno">14407</span>&#160;            {</div>
<div class="line"><a name="l14408"></a><span class="lineno">14408</span>&#160;              <a class="code" href="../../d8/d32/namespaceMeshRefinement.html#a9dade531077f055da144a85e19e67263">error_estimator_pt</a>-&gt;get_element_errors(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(imesh),</div>
<div class="line"><a name="l14409"></a><span class="lineno">14409</span>&#160;                                                     elemental_error);</div>
<div class="line"><a name="l14410"></a><span class="lineno">14410</span>&#160;            }</div>
<div class="line"><a name="l14411"></a><span class="lineno">14411</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l14412"></a><span class="lineno">14412</span>&#160;            {</div>
<div class="line"><a name="l14413"></a><span class="lineno">14413</span>&#160;              <a class="code" href="../../d8/d32/namespaceMeshRefinement.html#a9dade531077f055da144a85e19e67263">error_estimator_pt</a>-&gt;get_element_errors(</div>
<div class="line"><a name="l14414"></a><span class="lineno">14414</span>&#160;                <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(imesh), elemental_error, *mmesh_pt-&gt;doc_info_pt());</div>
<div class="line"><a name="l14415"></a><span class="lineno">14415</span>&#160;            }</div>
<div class="line"><a name="l14416"></a><span class="lineno">14416</span>&#160; </div>
<div class="line"><a name="l14417"></a><span class="lineno">14417</span>&#160;            <span class="comment">// Store max./min error if the mesh has any elements</span></div>
<div class="line"><a name="l14418"></a><span class="lineno">14418</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(imesh)-&gt;nelement() &gt; 0)</div>
<div class="line"><a name="l14419"></a><span class="lineno">14419</span>&#160;            {</div>
<div class="line"><a name="l14420"></a><span class="lineno">14420</span>&#160;              mmesh_pt-&gt;max_error() =</div>
<div class="line"><a name="l14421"></a><span class="lineno">14421</span>&#160;                <a class="code" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">std::fabs</a>(*std::max_element(elemental_error.begin(),</div>
<div class="line"><a name="l14422"></a><span class="lineno">14422</span>&#160;                                            elemental_error.end(),</div>
<div class="line"><a name="l14423"></a><span class="lineno">14423</span>&#160;                                            AbsCmp&lt;double&gt;()));</div>
<div class="line"><a name="l14424"></a><span class="lineno">14424</span>&#160; </div>
<div class="line"><a name="l14425"></a><span class="lineno">14425</span>&#160;              mmesh_pt-&gt;min_error() =</div>
<div class="line"><a name="l14426"></a><span class="lineno">14426</span>&#160;                <a class="code" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">std::fabs</a>(*std::min_element(elemental_error.begin(),</div>
<div class="line"><a name="l14427"></a><span class="lineno">14427</span>&#160;                                            elemental_error.end(),</div>
<div class="line"><a name="l14428"></a><span class="lineno">14428</span>&#160;                                            AbsCmp&lt;double&gt;()));</div>
<div class="line"><a name="l14429"></a><span class="lineno">14429</span>&#160;            }</div>
<div class="line"><a name="l14430"></a><span class="lineno">14430</span>&#160; </div>
<div class="line"><a name="l14431"></a><span class="lineno">14431</span>&#160;            <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;\n Max/min error: &quot;</span> &lt;&lt; mmesh_pt-&gt;max_error() &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l14432"></a><span class="lineno">14432</span>&#160;                       &lt;&lt; mmesh_pt-&gt;min_error() &lt;&lt; std::endl;</div>
<div class="line"><a name="l14433"></a><span class="lineno">14433</span>&#160; </div>
<div class="line"><a name="l14434"></a><span class="lineno">14434</span>&#160; </div>
<div class="line"><a name="l14435"></a><span class="lineno">14435</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l14436"></a><span class="lineno">14436</span>&#160;            {</div>
<div class="line"><a name="l14437"></a><span class="lineno">14437</span>&#160;              t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l14438"></a><span class="lineno">14438</span>&#160;              <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for error estimation: &quot;</span> &lt;&lt; t_end - t_start</div>
<div class="line"><a name="l14439"></a><span class="lineno">14439</span>&#160;                         &lt;&lt; std::endl;</div>
<div class="line"><a name="l14440"></a><span class="lineno">14440</span>&#160;              t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l14441"></a><span class="lineno">14441</span>&#160;            }</div>
<div class="line"><a name="l14442"></a><span class="lineno">14442</span>&#160; </div>
<div class="line"><a name="l14443"></a><span class="lineno">14443</span>&#160;            <span class="comment">// Adapt mesh</span></div>
<div class="line"><a name="l14444"></a><span class="lineno">14444</span>&#160;            mmesh_pt-&gt;p_adapt(elemental_error);</div>
<div class="line"><a name="l14445"></a><span class="lineno">14445</span>&#160; </div>
<div class="line"><a name="l14446"></a><span class="lineno">14446</span>&#160;            <span class="comment">// Add to counters</span></div>
<div class="line"><a name="l14447"></a><span class="lineno">14447</span>&#160;            n_refined += mmesh_pt-&gt;nrefined();</div>
<div class="line"><a name="l14448"></a><span class="lineno">14448</span>&#160;            n_unrefined += mmesh_pt-&gt;nunrefined();</div>
<div class="line"><a name="l14449"></a><span class="lineno">14449</span>&#160; </div>
<div class="line"><a name="l14450"></a><span class="lineno">14450</span>&#160; </div>
<div class="line"><a name="l14451"></a><span class="lineno">14451</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l14452"></a><span class="lineno">14452</span>&#160;            {</div>
<div class="line"><a name="l14453"></a><span class="lineno">14453</span>&#160;              t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l14454"></a><span class="lineno">14454</span>&#160;              <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for complete mesh adaptation &quot;</span></div>
<div class="line"><a name="l14455"></a><span class="lineno">14455</span>&#160;                         &lt;&lt; <span class="stringliteral">&quot;(but excluding comp of error estimate): &quot;</span></div>
<div class="line"><a name="l14456"></a><span class="lineno">14456</span>&#160;                         &lt;&lt; t_end - t_start &lt;&lt; std::endl;</div>
<div class="line"><a name="l14457"></a><span class="lineno">14457</span>&#160;              t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l14458"></a><span class="lineno">14458</span>&#160;            }</div>
<div class="line"><a name="l14459"></a><span class="lineno">14459</span>&#160;          }</div>
<div class="line"><a name="l14460"></a><span class="lineno">14460</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l14461"></a><span class="lineno">14461</span>&#160;          {</div>
<div class="line"><a name="l14462"></a><span class="lineno">14462</span>&#160;            <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Mesh adaptation is disabled.&quot;</span></div>
<div class="line"><a name="l14463"></a><span class="lineno">14463</span>&#160;                       &lt;&lt; std::endl;</div>
<div class="line"><a name="l14464"></a><span class="lineno">14464</span>&#160;          }</div>
<div class="line"><a name="l14465"></a><span class="lineno">14465</span>&#160;        }</div>
<div class="line"><a name="l14466"></a><span class="lineno">14466</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l14467"></a><span class="lineno">14467</span>&#160;        {</div>
<div class="line"><a name="l14468"></a><span class="lineno">14468</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Mesh cannot be adapted.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l14469"></a><span class="lineno">14469</span>&#160;        }</div>
<div class="line"><a name="l14470"></a><span class="lineno">14470</span>&#160; </div>
<div class="line"><a name="l14471"></a><span class="lineno">14471</span>&#160;      } <span class="comment">// End of loop over submeshes</span></div>
<div class="line"><a name="l14472"></a><span class="lineno">14472</span>&#160; </div>
<div class="line"><a name="l14473"></a><span class="lineno">14473</span>&#160;      <span class="comment">// Rebuild the global mesh</span></div>
<div class="line"><a name="l14474"></a><span class="lineno">14474</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a266d4d1b2bd4a5cbc028ff5aba79508f">rebuild_global_mesh</a>();</div>
<div class="line"><a name="l14475"></a><span class="lineno">14475</span>&#160;    }</div>
<div class="line"><a name="l14476"></a><span class="lineno">14476</span>&#160; </div>
<div class="line"><a name="l14477"></a><span class="lineno">14477</span>&#160; </div>
<div class="line"><a name="l14478"></a><span class="lineno">14478</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l14479"></a><span class="lineno">14479</span>&#160;    {</div>
<div class="line"><a name="l14480"></a><span class="lineno">14480</span>&#160;      t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l14481"></a><span class="lineno">14481</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Total time for actual adaptation &quot;</span></div>
<div class="line"><a name="l14482"></a><span class="lineno">14482</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;(all meshes; incl error estimates): &quot;</span> &lt;&lt; t_end - t_start</div>
<div class="line"><a name="l14483"></a><span class="lineno">14483</span>&#160;                 &lt;&lt; std::endl;</div>
<div class="line"><a name="l14484"></a><span class="lineno">14484</span>&#160;      t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l14485"></a><span class="lineno">14485</span>&#160;    }</div>
<div class="line"><a name="l14486"></a><span class="lineno">14486</span>&#160; </div>
<div class="line"><a name="l14487"></a><span class="lineno">14487</span>&#160;    <span class="comment">// Any actions after adapt</span></div>
<div class="line"><a name="l14488"></a><span class="lineno">14488</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">actions_after_adapt</a>();</div>
<div class="line"><a name="l14489"></a><span class="lineno">14489</span>&#160; </div>
<div class="line"><a name="l14490"></a><span class="lineno">14490</span>&#160; </div>
<div class="line"><a name="l14491"></a><span class="lineno">14491</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l14492"></a><span class="lineno">14492</span>&#160;    {</div>
<div class="line"><a name="l14493"></a><span class="lineno">14493</span>&#160;      t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l14494"></a><span class="lineno">14494</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for actions after adapt: &quot;</span> &lt;&lt; t_end - t_start</div>
<div class="line"><a name="l14495"></a><span class="lineno">14495</span>&#160;                 &lt;&lt; std::endl;</div>
<div class="line"><a name="l14496"></a><span class="lineno">14496</span>&#160;      t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l14497"></a><span class="lineno">14497</span>&#160; </div>
<div class="line"><a name="l14498"></a><span class="lineno">14498</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;About to start re-assigning eqn numbers &quot;</span></div>
<div class="line"><a name="l14499"></a><span class="lineno">14499</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;with Problem::assign_eqn_numbers() at end of &quot;</span></div>
<div class="line"><a name="l14500"></a><span class="lineno">14500</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;Problem::adapt().\n&quot;</span>;</div>
<div class="line"><a name="l14501"></a><span class="lineno">14501</span>&#160;    }</div>
<div class="line"><a name="l14502"></a><span class="lineno">14502</span>&#160; </div>
<div class="line"><a name="l14503"></a><span class="lineno">14503</span>&#160;    <span class="comment">// Attach the boundary conditions to the mesh</span></div>
<div class="line"><a name="l14504"></a><span class="lineno">14504</span>&#160;    <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;\nNumber of equations: &quot;</span> &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers</a>() &lt;&lt; std::endl</div>
<div class="line"><a name="l14505"></a><span class="lineno">14505</span>&#160;               &lt;&lt; std::endl;</div>
<div class="line"><a name="l14506"></a><span class="lineno">14506</span>&#160; </div>
<div class="line"><a name="l14507"></a><span class="lineno">14507</span>&#160; </div>
<div class="line"><a name="l14508"></a><span class="lineno">14508</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l14509"></a><span class="lineno">14509</span>&#160;    {</div>
<div class="line"><a name="l14510"></a><span class="lineno">14510</span>&#160;      t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l14511"></a><span class="lineno">14511</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for re-assigning eqn numbers with &quot;</span></div>
<div class="line"><a name="l14512"></a><span class="lineno">14512</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;Problem::assign_eqn_numbers() at end of Problem::adapt(): &quot;</span></div>
<div class="line"><a name="l14513"></a><span class="lineno">14513</span>&#160;                 &lt;&lt; t_end - t_start &lt;&lt; std::endl;</div>
<div class="line"><a name="l14514"></a><span class="lineno">14514</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Total time for adapt: &quot;</span> &lt;&lt; t_end - t_start_total</div>
<div class="line"><a name="l14515"></a><span class="lineno">14515</span>&#160;                 &lt;&lt; std::endl;</div>
<div class="line"><a name="l14516"></a><span class="lineno">14516</span>&#160;    }</div>
<div class="line"><a name="l14517"></a><span class="lineno">14517</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">actions_after_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">actions_before_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa0b4e7868e02e2d12845c9b2dd60cab9">bifurcation_adapt_helper()</a>, <a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a22c5f240674e4f6cee12006790c11dae">oomph::AssemblyHandler::bifurcation_type()</a>, <a class="el" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">oomph::Global_timings::Doc_comprehensive_timings</a>, <a class="el" href="../../d8/d32/namespaceMeshRefinement.html#a9dade531077f055da144a85e19e67263">MeshRefinement::error_estimator_pt</a>, <a class="el" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">boost::multiprecision::fabs()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a266d4d1b2bd4a5cbc028ff5aba79508f">rebuild_global_mesh()</a>, and <a class="el" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">oomph::TimingHelpers::timer()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/d1e/one__d__poisson__hp__adapt_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main()</a>.</p>

</div>
</div>
<a id="a021ca53709629bd20bcd9fe40fa83ddf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a021ca53709629bd20bcd9fe40fa83ddf">&#9670;&nbsp;</a></span>p_refine_selected_elements() <span class="overload">[1/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::p_refine_selected_elements </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>i_mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d3/d0c/classoomph_1_1PRefineableElement.html">PRefineableElement</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>elements_to_be_refined_pt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>p-refine specified submesh by refining the elements identified by their pointers, then rebuild the problem. </p>
<div class="fragment"><div class="line"><a name="l15308"></a><span class="lineno">15308</span>&#160;  {</div>
<div class="line"><a name="l15309"></a><span class="lineno">15309</span>&#160;    OomphLibWarning(</div>
<div class="line"><a name="l15310"></a><span class="lineno">15310</span>&#160;      <span class="stringliteral">&quot;p-refinement for multiple submeshes has not yet been tested.&quot;</span>,</div>
<div class="line"><a name="l15311"></a><span class="lineno">15311</span>&#160;      <span class="stringliteral">&quot;Problem::p_refine_selected_elements()&quot;</span>,</div>
<div class="line"><a name="l15312"></a><span class="lineno">15312</span>&#160;      <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l15313"></a><span class="lineno">15313</span>&#160; </div>
<div class="line"><a name="l15314"></a><span class="lineno">15314</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">actions_before_adapt</a>();</div>
<div class="line"><a name="l15315"></a><span class="lineno">15315</span>&#160; </div>
<div class="line"><a name="l15316"></a><span class="lineno">15316</span>&#160;    <span class="comment">// Number of submeshes?</span></div>
<div class="line"><a name="l15317"></a><span class="lineno">15317</span>&#160;    <span class="keywordtype">unsigned</span> n_mesh = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>();</div>
<div class="line"><a name="l15318"></a><span class="lineno">15318</span>&#160; </div>
<div class="line"><a name="l15319"></a><span class="lineno">15319</span>&#160;    <span class="keywordflow">if</span> (i_mesh &gt;= n_mesh)</div>
<div class="line"><a name="l15320"></a><span class="lineno">15320</span>&#160;    {</div>
<div class="line"><a name="l15321"></a><span class="lineno">15321</span>&#160;      std::ostringstream error_message;</div>
<div class="line"><a name="l15322"></a><span class="lineno">15322</span>&#160;      error_message &lt;&lt; <span class="stringliteral">&quot;Problem only has &quot;</span> &lt;&lt; n_mesh</div>
<div class="line"><a name="l15323"></a><span class="lineno">15323</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot; submeshes. Cannot p-refine submesh &quot;</span> &lt;&lt; i_mesh</div>
<div class="line"><a name="l15324"></a><span class="lineno">15324</span>&#160;                    &lt;&lt; std::endl;</div>
<div class="line"><a name="l15325"></a><span class="lineno">15325</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l15326"></a><span class="lineno">15326</span>&#160;        error_message.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l15327"></a><span class="lineno">15327</span>&#160;    }</div>
<div class="line"><a name="l15328"></a><span class="lineno">15328</span>&#160; </div>
<div class="line"><a name="l15329"></a><span class="lineno">15329</span>&#160;    <span class="comment">// Refine single mesh if possible</span></div>
<div class="line"><a name="l15330"></a><span class="lineno">15330</span>&#160;    <span class="keywordflow">if</span> (TreeBasedRefineableMeshBase* mmesh_pt =</div>
<div class="line"><a name="l15331"></a><span class="lineno">15331</span>&#160;          <span class="keyword">dynamic_cast&lt;</span>TreeBasedRefineableMeshBase*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(i_mesh)))</div>
<div class="line"><a name="l15332"></a><span class="lineno">15332</span>&#160;    {</div>
<div class="line"><a name="l15333"></a><span class="lineno">15333</span>&#160;      mmesh_pt-&gt;p_refine_selected_elements(elements_to_be_refined_pt);</div>
<div class="line"><a name="l15334"></a><span class="lineno">15334</span>&#160;    }</div>
<div class="line"><a name="l15335"></a><span class="lineno">15335</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l15336"></a><span class="lineno">15336</span>&#160;    {</div>
<div class="line"><a name="l15337"></a><span class="lineno">15337</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Mesh cannot be refined &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l15338"></a><span class="lineno">15338</span>&#160;    }</div>
<div class="line"><a name="l15339"></a><span class="lineno">15339</span>&#160; </div>
<div class="line"><a name="l15340"></a><span class="lineno">15340</span>&#160;    <span class="keywordflow">if</span> (n_mesh &gt; 1)</div>
<div class="line"><a name="l15341"></a><span class="lineno">15341</span>&#160;    {</div>
<div class="line"><a name="l15342"></a><span class="lineno">15342</span>&#160;      <span class="comment">// Rebuild the global mesh</span></div>
<div class="line"><a name="l15343"></a><span class="lineno">15343</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a266d4d1b2bd4a5cbc028ff5aba79508f">rebuild_global_mesh</a>();</div>
<div class="line"><a name="l15344"></a><span class="lineno">15344</span>&#160;    }</div>
<div class="line"><a name="l15345"></a><span class="lineno">15345</span>&#160; </div>
<div class="line"><a name="l15346"></a><span class="lineno">15346</span>&#160;    <span class="comment">// Any actions after the adapatation phase</span></div>
<div class="line"><a name="l15347"></a><span class="lineno">15347</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">actions_after_adapt</a>();</div>
<div class="line"><a name="l15348"></a><span class="lineno">15348</span>&#160; </div>
<div class="line"><a name="l15349"></a><span class="lineno">15349</span>&#160;    <span class="comment">// Do equation numbering</span></div>
<div class="line"><a name="l15350"></a><span class="lineno">15350</span>&#160;    <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Number of equations: &quot;</span> &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers</a>() &lt;&lt; std::endl;</div>
<div class="line"><a name="l15351"></a><span class="lineno">15351</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">actions_after_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">actions_before_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a266d4d1b2bd4a5cbc028ff5aba79508f">rebuild_global_mesh()</a>.</p>

</div>
</div>
<a id="ac69a6b98a561adcfef0ef369b32e5fbd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac69a6b98a561adcfef0ef369b32e5fbd">&#9670;&nbsp;</a></span>p_refine_selected_elements() <span class="overload">[2/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::p_refine_selected_elements </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>i_mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>elements_to_be_refined</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>p-refine specified submesh by refining the elements identified by their numbers relative to the submesh, then rebuild the problem.</p>
<p>p-refine specified submesh by refining the elements identified by their numbers relative to the specified mesh, then rebuild the problem. </p>
<div class="fragment"><div class="line"><a name="l15255"></a><span class="lineno">15255</span>&#160;  {</div>
<div class="line"><a name="l15256"></a><span class="lineno">15256</span>&#160;    OomphLibWarning(</div>
<div class="line"><a name="l15257"></a><span class="lineno">15257</span>&#160;      <span class="stringliteral">&quot;p-refinement for multiple submeshes has not yet been tested.&quot;</span>,</div>
<div class="line"><a name="l15258"></a><span class="lineno">15258</span>&#160;      <span class="stringliteral">&quot;Problem::p_refine_selected_elements()&quot;</span>,</div>
<div class="line"><a name="l15259"></a><span class="lineno">15259</span>&#160;      <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l15260"></a><span class="lineno">15260</span>&#160; </div>
<div class="line"><a name="l15261"></a><span class="lineno">15261</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">actions_before_adapt</a>();</div>
<div class="line"><a name="l15262"></a><span class="lineno">15262</span>&#160; </div>
<div class="line"><a name="l15263"></a><span class="lineno">15263</span>&#160;    <span class="comment">// Number of submeshes?</span></div>
<div class="line"><a name="l15264"></a><span class="lineno">15264</span>&#160;    <span class="keywordtype">unsigned</span> n_mesh = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>();</div>
<div class="line"><a name="l15265"></a><span class="lineno">15265</span>&#160; </div>
<div class="line"><a name="l15266"></a><span class="lineno">15266</span>&#160;    <span class="keywordflow">if</span> (i_mesh &gt;= n_mesh)</div>
<div class="line"><a name="l15267"></a><span class="lineno">15267</span>&#160;    {</div>
<div class="line"><a name="l15268"></a><span class="lineno">15268</span>&#160;      std::ostringstream error_message;</div>
<div class="line"><a name="l15269"></a><span class="lineno">15269</span>&#160;      error_message &lt;&lt; <span class="stringliteral">&quot;Problem only has &quot;</span> &lt;&lt; n_mesh</div>
<div class="line"><a name="l15270"></a><span class="lineno">15270</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot; submeshes. Cannot p-refine submesh &quot;</span> &lt;&lt; i_mesh</div>
<div class="line"><a name="l15271"></a><span class="lineno">15271</span>&#160;                    &lt;&lt; std::endl;</div>
<div class="line"><a name="l15272"></a><span class="lineno">15272</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l15273"></a><span class="lineno">15273</span>&#160;        error_message.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l15274"></a><span class="lineno">15274</span>&#160;    }</div>
<div class="line"><a name="l15275"></a><span class="lineno">15275</span>&#160; </div>
<div class="line"><a name="l15276"></a><span class="lineno">15276</span>&#160;    <span class="comment">// Refine single mesh if possible</span></div>
<div class="line"><a name="l15277"></a><span class="lineno">15277</span>&#160;    <span class="keywordflow">if</span> (TreeBasedRefineableMeshBase* mmesh_pt =</div>
<div class="line"><a name="l15278"></a><span class="lineno">15278</span>&#160;          <span class="keyword">dynamic_cast&lt;</span>TreeBasedRefineableMeshBase*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(i_mesh)))</div>
<div class="line"><a name="l15279"></a><span class="lineno">15279</span>&#160;    {</div>
<div class="line"><a name="l15280"></a><span class="lineno">15280</span>&#160;      mmesh_pt-&gt;p_refine_selected_elements(elements_to_be_refined);</div>
<div class="line"><a name="l15281"></a><span class="lineno">15281</span>&#160;    }</div>
<div class="line"><a name="l15282"></a><span class="lineno">15282</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l15283"></a><span class="lineno">15283</span>&#160;    {</div>
<div class="line"><a name="l15284"></a><span class="lineno">15284</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Mesh cannot be refined &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l15285"></a><span class="lineno">15285</span>&#160;    }</div>
<div class="line"><a name="l15286"></a><span class="lineno">15286</span>&#160; </div>
<div class="line"><a name="l15287"></a><span class="lineno">15287</span>&#160;    <span class="keywordflow">if</span> (n_mesh &gt; 1)</div>
<div class="line"><a name="l15288"></a><span class="lineno">15288</span>&#160;    {</div>
<div class="line"><a name="l15289"></a><span class="lineno">15289</span>&#160;      <span class="comment">// Rebuild the global mesh</span></div>
<div class="line"><a name="l15290"></a><span class="lineno">15290</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a266d4d1b2bd4a5cbc028ff5aba79508f">rebuild_global_mesh</a>();</div>
<div class="line"><a name="l15291"></a><span class="lineno">15291</span>&#160;    }</div>
<div class="line"><a name="l15292"></a><span class="lineno">15292</span>&#160; </div>
<div class="line"><a name="l15293"></a><span class="lineno">15293</span>&#160;    <span class="comment">// Any actions after the adapatation phase</span></div>
<div class="line"><a name="l15294"></a><span class="lineno">15294</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">actions_after_adapt</a>();</div>
<div class="line"><a name="l15295"></a><span class="lineno">15295</span>&#160; </div>
<div class="line"><a name="l15296"></a><span class="lineno">15296</span>&#160;    <span class="comment">// Do equation numbering</span></div>
<div class="line"><a name="l15297"></a><span class="lineno">15297</span>&#160;    <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Number of equations: &quot;</span> &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers</a>() &lt;&lt; std::endl;</div>
<div class="line"><a name="l15298"></a><span class="lineno">15298</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">actions_after_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">actions_before_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a266d4d1b2bd4a5cbc028ff5aba79508f">rebuild_global_mesh()</a>.</p>

</div>
</div>
<a id="a66aa88c63c39916dac92a66576624c08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66aa88c63c39916dac92a66576624c08">&#9670;&nbsp;</a></span>p_refine_selected_elements() <span class="overload">[3/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::p_refine_selected_elements </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d3/d0c/classoomph_1_1PRefineableElement.html">PRefineableElement</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>elements_to_be_refined_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>p-refine (one and only!) mesh by refining the elements identified by their pointers, then rebuild the problem. </p>
<div class="fragment"><div class="line"><a name="l15208"></a><span class="lineno">15208</span>&#160;  {</div>
<div class="line"><a name="l15209"></a><span class="lineno">15209</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">actions_before_adapt</a>();</div>
<div class="line"><a name="l15210"></a><span class="lineno">15210</span>&#160; </div>
<div class="line"><a name="l15211"></a><span class="lineno">15211</span>&#160;    <span class="comment">// Number of submeshes?</span></div>
<div class="line"><a name="l15212"></a><span class="lineno">15212</span>&#160;    <span class="keywordtype">unsigned</span> Nmesh = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>();</div>
<div class="line"><a name="l15213"></a><span class="lineno">15213</span>&#160; </div>
<div class="line"><a name="l15214"></a><span class="lineno">15214</span>&#160;    <span class="comment">// Single mesh:</span></div>
<div class="line"><a name="l15215"></a><span class="lineno">15215</span>&#160;    <span class="keywordflow">if</span> (Nmesh == 0)</div>
<div class="line"><a name="l15216"></a><span class="lineno">15216</span>&#160;    {</div>
<div class="line"><a name="l15217"></a><span class="lineno">15217</span>&#160;      <span class="comment">// Refine single mesh if possible</span></div>
<div class="line"><a name="l15218"></a><span class="lineno">15218</span>&#160;      <span class="keywordflow">if</span> (TreeBasedRefineableMeshBase* mmesh_pt =</div>
<div class="line"><a name="l15219"></a><span class="lineno">15219</span>&#160;            <span class="keyword">dynamic_cast&lt;</span>TreeBasedRefineableMeshBase*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(0)))</div>
<div class="line"><a name="l15220"></a><span class="lineno">15220</span>&#160;      {</div>
<div class="line"><a name="l15221"></a><span class="lineno">15221</span>&#160;        mmesh_pt-&gt;p_refine_selected_elements(elements_to_be_refined_pt);</div>
<div class="line"><a name="l15222"></a><span class="lineno">15222</span>&#160;      }</div>
<div class="line"><a name="l15223"></a><span class="lineno">15223</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l15224"></a><span class="lineno">15224</span>&#160;      {</div>
<div class="line"><a name="l15225"></a><span class="lineno">15225</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Mesh cannot be refined &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l15226"></a><span class="lineno">15226</span>&#160;      }</div>
<div class="line"><a name="l15227"></a><span class="lineno">15227</span>&#160;    }</div>
<div class="line"><a name="l15228"></a><span class="lineno">15228</span>&#160;    <span class="comment">// Multiple submeshes</span></div>
<div class="line"><a name="l15229"></a><span class="lineno">15229</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l15230"></a><span class="lineno">15230</span>&#160;    {</div>
<div class="line"><a name="l15231"></a><span class="lineno">15231</span>&#160;      std::ostringstream error_message;</div>
<div class="line"><a name="l15232"></a><span class="lineno">15232</span>&#160;      error_message</div>
<div class="line"><a name="l15233"></a><span class="lineno">15233</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;Problem::p_refine_selected_elements(...) only works for\n&quot;</span></div>
<div class="line"><a name="l15234"></a><span class="lineno">15234</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;multiple-mesh problems if you specify the mesh\n&quot;</span></div>
<div class="line"><a name="l15235"></a><span class="lineno">15235</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;number in the function argument before the Vector,\n&quot;</span></div>
<div class="line"><a name="l15236"></a><span class="lineno">15236</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;or a Vector of Vectors for each submesh.\n&quot;</span></div>
<div class="line"><a name="l15237"></a><span class="lineno">15237</span>&#160;        &lt;&lt; std::endl;</div>
<div class="line"><a name="l15238"></a><span class="lineno">15238</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l15239"></a><span class="lineno">15239</span>&#160;        error_message.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l15240"></a><span class="lineno">15240</span>&#160;    }</div>
<div class="line"><a name="l15241"></a><span class="lineno">15241</span>&#160; </div>
<div class="line"><a name="l15242"></a><span class="lineno">15242</span>&#160;    <span class="comment">// Any actions after the adapatation phase</span></div>
<div class="line"><a name="l15243"></a><span class="lineno">15243</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">actions_after_adapt</a>();</div>
<div class="line"><a name="l15244"></a><span class="lineno">15244</span>&#160; </div>
<div class="line"><a name="l15245"></a><span class="lineno">15245</span>&#160;    <span class="comment">// Do equation numbering</span></div>
<div class="line"><a name="l15246"></a><span class="lineno">15246</span>&#160;    <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Number of equations: &quot;</span> &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers</a>() &lt;&lt; std::endl;</div>
<div class="line"><a name="l15247"></a><span class="lineno">15247</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">actions_after_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">actions_before_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, and <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>.</p>

</div>
</div>
<a id="aad73bff32f14763e813cabdcd4c88c06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad73bff32f14763e813cabdcd4c88c06">&#9670;&nbsp;</a></span>p_refine_selected_elements() <span class="overload">[4/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::p_refine_selected_elements </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>elements_to_be_refined</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>p-refine (one and only!) mesh by refining the elements identified by their numbers relative to the problems' only mesh, then rebuild the problem. </p>
<div class="fragment"><div class="line"><a name="l15161"></a><span class="lineno">15161</span>&#160;  {</div>
<div class="line"><a name="l15162"></a><span class="lineno">15162</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">actions_before_adapt</a>();</div>
<div class="line"><a name="l15163"></a><span class="lineno">15163</span>&#160; </div>
<div class="line"><a name="l15164"></a><span class="lineno">15164</span>&#160;    <span class="comment">// Number of submeshes?</span></div>
<div class="line"><a name="l15165"></a><span class="lineno">15165</span>&#160;    <span class="keywordtype">unsigned</span> Nmesh = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>();</div>
<div class="line"><a name="l15166"></a><span class="lineno">15166</span>&#160; </div>
<div class="line"><a name="l15167"></a><span class="lineno">15167</span>&#160;    <span class="comment">// Single mesh:</span></div>
<div class="line"><a name="l15168"></a><span class="lineno">15168</span>&#160;    <span class="keywordflow">if</span> (Nmesh == 0)</div>
<div class="line"><a name="l15169"></a><span class="lineno">15169</span>&#160;    {</div>
<div class="line"><a name="l15170"></a><span class="lineno">15170</span>&#160;      <span class="comment">// Refine single mesh if possible</span></div>
<div class="line"><a name="l15171"></a><span class="lineno">15171</span>&#160;      <span class="keywordflow">if</span> (TreeBasedRefineableMeshBase* mmesh_pt =</div>
<div class="line"><a name="l15172"></a><span class="lineno">15172</span>&#160;            <span class="keyword">dynamic_cast&lt;</span>TreeBasedRefineableMeshBase*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(0)))</div>
<div class="line"><a name="l15173"></a><span class="lineno">15173</span>&#160;      {</div>
<div class="line"><a name="l15174"></a><span class="lineno">15174</span>&#160;        mmesh_pt-&gt;p_refine_selected_elements(elements_to_be_refined);</div>
<div class="line"><a name="l15175"></a><span class="lineno">15175</span>&#160;      }</div>
<div class="line"><a name="l15176"></a><span class="lineno">15176</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l15177"></a><span class="lineno">15177</span>&#160;      {</div>
<div class="line"><a name="l15178"></a><span class="lineno">15178</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Mesh cannot be refined &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l15179"></a><span class="lineno">15179</span>&#160;      }</div>
<div class="line"><a name="l15180"></a><span class="lineno">15180</span>&#160;    }</div>
<div class="line"><a name="l15181"></a><span class="lineno">15181</span>&#160;    <span class="comment">// Multiple submeshes</span></div>
<div class="line"><a name="l15182"></a><span class="lineno">15182</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l15183"></a><span class="lineno">15183</span>&#160;    {</div>
<div class="line"><a name="l15184"></a><span class="lineno">15184</span>&#160;      std::ostringstream error_message;</div>
<div class="line"><a name="l15185"></a><span class="lineno">15185</span>&#160;      error_message</div>
<div class="line"><a name="l15186"></a><span class="lineno">15186</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;Problem::p_refine_selected_elements(...) only works for\n&quot;</span></div>
<div class="line"><a name="l15187"></a><span class="lineno">15187</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;multiple-mesh problems if you specify the mesh\n&quot;</span></div>
<div class="line"><a name="l15188"></a><span class="lineno">15188</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;number in the function argument before the Vector,\n&quot;</span></div>
<div class="line"><a name="l15189"></a><span class="lineno">15189</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;or a Vector of Vectors for each submesh.\n&quot;</span></div>
<div class="line"><a name="l15190"></a><span class="lineno">15190</span>&#160;        &lt;&lt; std::endl;</div>
<div class="line"><a name="l15191"></a><span class="lineno">15191</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l15192"></a><span class="lineno">15192</span>&#160;        error_message.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l15193"></a><span class="lineno">15193</span>&#160;    }</div>
<div class="line"><a name="l15194"></a><span class="lineno">15194</span>&#160; </div>
<div class="line"><a name="l15195"></a><span class="lineno">15195</span>&#160;    <span class="comment">// Any actions after the adapatation phase</span></div>
<div class="line"><a name="l15196"></a><span class="lineno">15196</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">actions_after_adapt</a>();</div>
<div class="line"><a name="l15197"></a><span class="lineno">15197</span>&#160; </div>
<div class="line"><a name="l15198"></a><span class="lineno">15198</span>&#160;    <span class="comment">// Attach the boundary conditions to the mesh</span></div>
<div class="line"><a name="l15199"></a><span class="lineno">15199</span>&#160;    <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Number of equations: &quot;</span> &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers</a>() &lt;&lt; std::endl;</div>
<div class="line"><a name="l15200"></a><span class="lineno">15200</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">actions_after_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">actions_before_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, and <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>.</p>

</div>
</div>
<a id="a6047e095c774ef0d2850736a0ad03cd2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6047e095c774ef0d2850736a0ad03cd2">&#9670;&nbsp;</a></span>p_refine_selected_elements() <span class="overload">[5/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::p_refine_selected_elements </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d3/d0c/classoomph_1_1PRefineableElement.html">PRefineableElement</a> * &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>elements_to_be_refined_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>p-refine all submeshes by refining the elements identified by their pointers within each submesh in a Vector of Vectors, then rebuild the problem. </p>
<div class="fragment"><div class="line"><a name="l15402"></a><span class="lineno">15402</span>&#160;  {</div>
<div class="line"><a name="l15403"></a><span class="lineno">15403</span>&#160;    OomphLibWarning(</div>
<div class="line"><a name="l15404"></a><span class="lineno">15404</span>&#160;      <span class="stringliteral">&quot;p-refinement for multiple submeshes has not yet been tested.&quot;</span>,</div>
<div class="line"><a name="l15405"></a><span class="lineno">15405</span>&#160;      <span class="stringliteral">&quot;Problem::p_refine_selected_elements()&quot;</span>,</div>
<div class="line"><a name="l15406"></a><span class="lineno">15406</span>&#160;      <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l15407"></a><span class="lineno">15407</span>&#160; </div>
<div class="line"><a name="l15408"></a><span class="lineno">15408</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">actions_before_adapt</a>();</div>
<div class="line"><a name="l15409"></a><span class="lineno">15409</span>&#160; </div>
<div class="line"><a name="l15410"></a><span class="lineno">15410</span>&#160;    <span class="comment">// Number of submeshes?</span></div>
<div class="line"><a name="l15411"></a><span class="lineno">15411</span>&#160;    <span class="keywordtype">unsigned</span> n_mesh = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>();</div>
<div class="line"><a name="l15412"></a><span class="lineno">15412</span>&#160; </div>
<div class="line"><a name="l15413"></a><span class="lineno">15413</span>&#160;    <span class="comment">// Refine all submeshes if possible</span></div>
<div class="line"><a name="l15414"></a><span class="lineno">15414</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i_mesh = 0; i_mesh &lt; n_mesh; i_mesh++)</div>
<div class="line"><a name="l15415"></a><span class="lineno">15415</span>&#160;    {</div>
<div class="line"><a name="l15416"></a><span class="lineno">15416</span>&#160;      <span class="keywordflow">if</span> (TreeBasedRefineableMeshBase* mmesh_pt =</div>
<div class="line"><a name="l15417"></a><span class="lineno">15417</span>&#160;            <span class="keyword">dynamic_cast&lt;</span>TreeBasedRefineableMeshBase*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(i_mesh)))</div>
<div class="line"><a name="l15418"></a><span class="lineno">15418</span>&#160;      {</div>
<div class="line"><a name="l15419"></a><span class="lineno">15419</span>&#160;        mmesh_pt-&gt;p_refine_selected_elements(elements_to_be_refined_pt[i_mesh]);</div>
<div class="line"><a name="l15420"></a><span class="lineno">15420</span>&#160;      }</div>
<div class="line"><a name="l15421"></a><span class="lineno">15421</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l15422"></a><span class="lineno">15422</span>&#160;      {</div>
<div class="line"><a name="l15423"></a><span class="lineno">15423</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Mesh cannot be refined &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l15424"></a><span class="lineno">15424</span>&#160;      }</div>
<div class="line"><a name="l15425"></a><span class="lineno">15425</span>&#160;    }</div>
<div class="line"><a name="l15426"></a><span class="lineno">15426</span>&#160; </div>
<div class="line"><a name="l15427"></a><span class="lineno">15427</span>&#160;    <span class="comment">// Rebuild the global mesh</span></div>
<div class="line"><a name="l15428"></a><span class="lineno">15428</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a266d4d1b2bd4a5cbc028ff5aba79508f">rebuild_global_mesh</a>();</div>
<div class="line"><a name="l15429"></a><span class="lineno">15429</span>&#160; </div>
<div class="line"><a name="l15430"></a><span class="lineno">15430</span>&#160;    <span class="comment">// Any actions after the adapatation phase</span></div>
<div class="line"><a name="l15431"></a><span class="lineno">15431</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">actions_after_adapt</a>();</div>
<div class="line"><a name="l15432"></a><span class="lineno">15432</span>&#160; </div>
<div class="line"><a name="l15433"></a><span class="lineno">15433</span>&#160;    <span class="comment">// Do equation numbering</span></div>
<div class="line"><a name="l15434"></a><span class="lineno">15434</span>&#160;    <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Number of equations: &quot;</span> &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers</a>() &lt;&lt; std::endl;</div>
<div class="line"><a name="l15435"></a><span class="lineno">15435</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">actions_after_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">actions_before_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a266d4d1b2bd4a5cbc028ff5aba79508f">rebuild_global_mesh()</a>.</p>

</div>
</div>
<a id="ae2eaf36f52079a4d49d8aa871127c6a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2eaf36f52079a4d49d8aa871127c6a2">&#9670;&nbsp;</a></span>p_refine_selected_elements() <span class="overload">[6/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::p_refine_selected_elements </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>elements_to_be_refined</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>p-refine all submeshes by refining the elements identified by their numbers relative to each submesh in a Vector of Vectors, then rebuild the problem. </p>
<div class="fragment"><div class="line"><a name="l15360"></a><span class="lineno">15360</span>&#160;  {</div>
<div class="line"><a name="l15361"></a><span class="lineno">15361</span>&#160;    OomphLibWarning(</div>
<div class="line"><a name="l15362"></a><span class="lineno">15362</span>&#160;      <span class="stringliteral">&quot;p-refinement for multiple submeshes has not yet been tested.&quot;</span>,</div>
<div class="line"><a name="l15363"></a><span class="lineno">15363</span>&#160;      <span class="stringliteral">&quot;Problem::p_refine_selected_elements()&quot;</span>,</div>
<div class="line"><a name="l15364"></a><span class="lineno">15364</span>&#160;      <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l15365"></a><span class="lineno">15365</span>&#160; </div>
<div class="line"><a name="l15366"></a><span class="lineno">15366</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">actions_before_adapt</a>();</div>
<div class="line"><a name="l15367"></a><span class="lineno">15367</span>&#160; </div>
<div class="line"><a name="l15368"></a><span class="lineno">15368</span>&#160;    <span class="comment">// Number of submeshes?</span></div>
<div class="line"><a name="l15369"></a><span class="lineno">15369</span>&#160;    <span class="keywordtype">unsigned</span> n_mesh = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>();</div>
<div class="line"><a name="l15370"></a><span class="lineno">15370</span>&#160; </div>
<div class="line"><a name="l15371"></a><span class="lineno">15371</span>&#160;    <span class="comment">// Refine all submeshes if possible</span></div>
<div class="line"><a name="l15372"></a><span class="lineno">15372</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i_mesh = 0; i_mesh &lt; n_mesh; i_mesh++)</div>
<div class="line"><a name="l15373"></a><span class="lineno">15373</span>&#160;    {</div>
<div class="line"><a name="l15374"></a><span class="lineno">15374</span>&#160;      <span class="keywordflow">if</span> (TreeBasedRefineableMeshBase* mmesh_pt =</div>
<div class="line"><a name="l15375"></a><span class="lineno">15375</span>&#160;            <span class="keyword">dynamic_cast&lt;</span>TreeBasedRefineableMeshBase*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(i_mesh)))</div>
<div class="line"><a name="l15376"></a><span class="lineno">15376</span>&#160;      {</div>
<div class="line"><a name="l15377"></a><span class="lineno">15377</span>&#160;        mmesh_pt-&gt;p_refine_selected_elements(elements_to_be_refined[i_mesh]);</div>
<div class="line"><a name="l15378"></a><span class="lineno">15378</span>&#160;      }</div>
<div class="line"><a name="l15379"></a><span class="lineno">15379</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l15380"></a><span class="lineno">15380</span>&#160;      {</div>
<div class="line"><a name="l15381"></a><span class="lineno">15381</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Mesh cannot be refined &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l15382"></a><span class="lineno">15382</span>&#160;      }</div>
<div class="line"><a name="l15383"></a><span class="lineno">15383</span>&#160;    }</div>
<div class="line"><a name="l15384"></a><span class="lineno">15384</span>&#160; </div>
<div class="line"><a name="l15385"></a><span class="lineno">15385</span>&#160;    <span class="comment">// Rebuild the global mesh</span></div>
<div class="line"><a name="l15386"></a><span class="lineno">15386</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a266d4d1b2bd4a5cbc028ff5aba79508f">rebuild_global_mesh</a>();</div>
<div class="line"><a name="l15387"></a><span class="lineno">15387</span>&#160; </div>
<div class="line"><a name="l15388"></a><span class="lineno">15388</span>&#160;    <span class="comment">// Any actions after the adapatation phase</span></div>
<div class="line"><a name="l15389"></a><span class="lineno">15389</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">actions_after_adapt</a>();</div>
<div class="line"><a name="l15390"></a><span class="lineno">15390</span>&#160; </div>
<div class="line"><a name="l15391"></a><span class="lineno">15391</span>&#160;    <span class="comment">// Do equation numbering</span></div>
<div class="line"><a name="l15392"></a><span class="lineno">15392</span>&#160;    <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Number of equations: &quot;</span> &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers</a>() &lt;&lt; std::endl;</div>
<div class="line"><a name="l15393"></a><span class="lineno">15393</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">actions_after_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">actions_before_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a266d4d1b2bd4a5cbc028ff5aba79508f">rebuild_global_mesh()</a>.</p>

</div>
</div>
<a id="ada439afd4d195644e53d6bdbc4b00587"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada439afd4d195644e53d6bdbc4b00587">&#9670;&nbsp;</a></span>p_refine_uniformly() <span class="overload">[1/6]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Problem::p_refine_uniformly </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>p-refine (all) p-refineable (sub)mesh(es) uniformly and rebuild problem </p>
<div class="fragment"><div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;    {</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;      DocInfo doc_info;</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;      doc_info.disable_doc();</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ada439afd4d195644e53d6bdbc4b00587">p_refine_uniformly</a>(doc_info);</div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1Problem_html_ada439afd4d195644e53d6bdbc4b00587"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#ada439afd4d195644e53d6bdbc4b00587">oomph::Problem::p_refine_uniformly</a></div><div class="ttdeci">void p_refine_uniformly()</div><div class="ttdef"><b>Definition:</b> problem.h:2737</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html#a666a20817ab9c396b225d8652bc0a338">oomph::DocInfo::disable_doc()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a355caf4c06c3b8b5d399115048453921">p_refine_uniformly()</a>.</p>

</div>
</div>
<a id="a33dbab01dfa53e4d005818a2940085b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33dbab01dfa53e4d005818a2940085b0">&#9670;&nbsp;</a></span>p_refine_uniformly() <span class="overload">[2/6]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Problem::p_refine_uniformly </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>i_mesh</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Do uniform p-refinement for submesh i_mesh without documentation. </p>
<div class="fragment"><div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;    {</div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;      DocInfo doc_info;</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;      doc_info.disable_doc();</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ada439afd4d195644e53d6bdbc4b00587">p_refine_uniformly</a>(i_mesh, doc_info);</div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html#a666a20817ab9c396b225d8652bc0a338">oomph::DocInfo::disable_doc()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ada439afd4d195644e53d6bdbc4b00587">p_refine_uniformly()</a>.</p>

</div>
</div>
<a id="a093b78c1820cf3fe6bd9ec3deb605b49"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a093b78c1820cf3fe6bd9ec3deb605b49">&#9670;&nbsp;</a></span>p_refine_uniformly() <span class="overload">[3/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::p_refine_uniformly </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>i_mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>doc_info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Do uniform p-refinement for submesh i_mesh with documentation. </p>
<p>p-refine submesh i_mesh uniformly and rebuild problem; doc refinement process. </p>
<div class="fragment"><div class="line"><a name="l15785"></a><span class="lineno">15785</span>&#160;  {</div>
<div class="line"><a name="l15786"></a><span class="lineno">15786</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">actions_before_adapt</a>();</div>
<div class="line"><a name="l15787"></a><span class="lineno">15787</span>&#160; </div>
<div class="line"><a name="l15788"></a><span class="lineno">15788</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l15789"></a><span class="lineno">15789</span>&#160;    <span class="comment">// Number of submeshes?</span></div>
<div class="line"><a name="l15790"></a><span class="lineno">15790</span>&#160;    <span class="keywordflow">if</span> (i_mesh &gt;= <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>())</div>
<div class="line"><a name="l15791"></a><span class="lineno">15791</span>&#160;    {</div>
<div class="line"><a name="l15792"></a><span class="lineno">15792</span>&#160;      std::ostringstream error_message;</div>
<div class="line"><a name="l15793"></a><span class="lineno">15793</span>&#160;      error_message &lt;&lt; <span class="stringliteral">&quot;imesh &quot;</span> &lt;&lt; i_mesh</div>
<div class="line"><a name="l15794"></a><span class="lineno">15794</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot; is greater than the number of sub meshes &quot;</span></div>
<div class="line"><a name="l15795"></a><span class="lineno">15795</span>&#160;                    &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>() &lt;&lt; std::endl;</div>
<div class="line"><a name="l15796"></a><span class="lineno">15796</span>&#160; </div>
<div class="line"><a name="l15797"></a><span class="lineno">15797</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l15798"></a><span class="lineno">15798</span>&#160;        error_message.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l15799"></a><span class="lineno">15799</span>&#160;    }</div>
<div class="line"><a name="l15800"></a><span class="lineno">15800</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l15801"></a><span class="lineno">15801</span>&#160; </div>
<div class="line"><a name="l15802"></a><span class="lineno">15802</span>&#160;    <span class="comment">// Refine single mesh uniformly if possible</span></div>
<div class="line"><a name="l15803"></a><span class="lineno">15803</span>&#160;    <span class="keywordflow">if</span> (RefineableMeshBase* mmesh_pt =</div>
<div class="line"><a name="l15804"></a><span class="lineno">15804</span>&#160;          <span class="keyword">dynamic_cast&lt;</span>RefineableMeshBase*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(i_mesh)))</div>
<div class="line"><a name="l15805"></a><span class="lineno">15805</span>&#160;    {</div>
<div class="line"><a name="l15806"></a><span class="lineno">15806</span>&#160;      mmesh_pt-&gt;p_refine_uniformly(doc_info);</div>
<div class="line"><a name="l15807"></a><span class="lineno">15807</span>&#160;    }</div>
<div class="line"><a name="l15808"></a><span class="lineno">15808</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l15809"></a><span class="lineno">15809</span>&#160;    {</div>
<div class="line"><a name="l15810"></a><span class="lineno">15810</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Mesh cannot be refined uniformly &quot;</span></div>
<div class="line"><a name="l15811"></a><span class="lineno">15811</span>&#160;                 &lt;&lt; std::endl;</div>
<div class="line"><a name="l15812"></a><span class="lineno">15812</span>&#160;    }</div>
<div class="line"><a name="l15813"></a><span class="lineno">15813</span>&#160; </div>
<div class="line"><a name="l15814"></a><span class="lineno">15814</span>&#160;    <span class="comment">// Rebuild the global mesh</span></div>
<div class="line"><a name="l15815"></a><span class="lineno">15815</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a266d4d1b2bd4a5cbc028ff5aba79508f">rebuild_global_mesh</a>();</div>
<div class="line"><a name="l15816"></a><span class="lineno">15816</span>&#160; </div>
<div class="line"><a name="l15817"></a><span class="lineno">15817</span>&#160;    <span class="comment">// Any actions after the adaptation phase</span></div>
<div class="line"><a name="l15818"></a><span class="lineno">15818</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">actions_after_adapt</a>();</div>
<div class="line"><a name="l15819"></a><span class="lineno">15819</span>&#160; </div>
<div class="line"><a name="l15820"></a><span class="lineno">15820</span>&#160;    <span class="comment">// Do equation numbering</span></div>
<div class="line"><a name="l15821"></a><span class="lineno">15821</span>&#160;    <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Number of equations: &quot;</span> &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers</a>() &lt;&lt; std::endl;</div>
<div class="line"><a name="l15822"></a><span class="lineno">15822</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">actions_after_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">actions_before_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a266d4d1b2bd4a5cbc028ff5aba79508f">rebuild_global_mesh()</a>.</p>

</div>
</div>
<a id="a3aaea4b1be43f5d4bb187a8c6d3ca16f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3aaea4b1be43f5d4bb187a8c6d3ca16f">&#9670;&nbsp;</a></span>p_refine_uniformly() <span class="overload">[4/6]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Problem::p_refine_uniformly </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>nrefine_for_mesh</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>p-refine p-refineable sub-meshes, each as many times as specified in the vector and rebuild problem </p>
<div class="fragment"><div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;    {</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;      DocInfo doc_info;</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;      doc_info.disable_doc();</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;      <span class="keywordtype">bool</span> prune = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a7460f9339fd4850112284a86e039ee00">p_refine_uniformly_aux</a>(nrefine_for_mesh, doc_info, prune);</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a7460f9339fd4850112284a86e039ee00"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a7460f9339fd4850112284a86e039ee00">oomph::Problem::p_refine_uniformly_aux</a></div><div class="ttdeci">void p_refine_uniformly_aux(const Vector&lt; unsigned &gt; &amp;nrefine_for_mesh, DocInfo &amp;doc_info, const bool &amp;prune)</div><div class="ttdef"><b>Definition:</b> problem.cc:15592</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html#a666a20817ab9c396b225d8652bc0a338">oomph::DocInfo::disable_doc()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7460f9339fd4850112284a86e039ee00">p_refine_uniformly_aux()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/d1e/one__d__poisson__hp__adapt_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main()</a>.</p>

</div>
</div>
<a id="a0a980d9659db60b113b6d4e7431594b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a980d9659db60b113b6d4e7431594b7">&#9670;&nbsp;</a></span>p_refine_uniformly() <span class="overload">[5/6]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Problem::p_refine_uniformly </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>nrefine_for_mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>doc_info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>p-refine p-refineable sub-meshes, each as many times as specified in the vector and rebuild problem; doc refinement process </p>
<div class="fragment"><div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;    {</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;      <span class="keywordtype">bool</span> prune = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a7460f9339fd4850112284a86e039ee00">p_refine_uniformly_aux</a>(nrefine_for_mesh, doc_info, prune);</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7460f9339fd4850112284a86e039ee00">p_refine_uniformly_aux()</a>.</p>

</div>
</div>
<a id="a355caf4c06c3b8b5d399115048453921"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a355caf4c06c3b8b5d399115048453921">&#9670;&nbsp;</a></span>p_refine_uniformly() <span class="overload">[6/6]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Problem::p_refine_uniformly </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>doc_info</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>p-refine (all) p-refineable (sub)mesh(es) uniformly and rebuild problem; doc refinement process. </p>
<div class="fragment"><div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;    {</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;      <span class="comment">// Number of (sub)meshes</span></div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;      <span class="keywordtype">unsigned</span> nmesh = <a class="code" href="../../dc/d51/datatypes_8h.html#affe776513b24d84b39af8ab0930fef7f">std::max</a>(<span class="keywordtype">unsigned</span>(1), <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>());</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160; </div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;      <span class="comment">// Refine each mesh once</span></div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;      Vector&lt;unsigned&gt; nrefine_for_mesh(nmesh, 1);</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ada439afd4d195644e53d6bdbc4b00587">p_refine_uniformly</a>(nrefine_for_mesh);</div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d51/datatypes_8h.html#affe776513b24d84b39af8ab0930fef7f">max</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ada439afd4d195644e53d6bdbc4b00587">p_refine_uniformly()</a>.</p>

</div>
</div>
<a id="a5155b2d5436a95b1ee27f914b4eb8f08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5155b2d5436a95b1ee27f914b4eb8f08">&#9670;&nbsp;</a></span>p_refine_uniformly_and_prune() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Problem::p_refine_uniformly_and_prune </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>nrefine_for_mesh</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>p-refine p-refineable sub-meshes, each as many times as specified in the vector and rebuild problem. Prune after refinements </p>
<div class="fragment"><div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;    {</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;      <span class="comment">// Not tested:</span></div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;      <span class="keywordflow">throw</span> OomphLibWarning(<span class="stringliteral">&quot;This functionality has not yet been tested.&quot;</span>,</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;                            <span class="stringliteral">&quot;Problem::p_refine_uniformly_and_prune()&quot;</span>,</div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;      DocInfo doc_info;</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;      doc_info.disable_doc();</div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;      <span class="keywordtype">bool</span> prune = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a7460f9339fd4850112284a86e039ee00">p_refine_uniformly_aux</a>(nrefine_for_mesh, doc_info, prune);</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html#a666a20817ab9c396b225d8652bc0a338">oomph::DocInfo::disable_doc()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7460f9339fd4850112284a86e039ee00">p_refine_uniformly_aux()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a80ff24a4fc923660f2aabfaa763822bf">p_refine_uniformly_and_prune()</a>.</p>

</div>
</div>
<a id="aabfa653ef203edf44cf9b6cf558865e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aabfa653ef203edf44cf9b6cf558865e1">&#9670;&nbsp;</a></span>p_refine_uniformly_and_prune() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Problem::p_refine_uniformly_and_prune </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>nrefine_for_mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>doc_info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>p-refine p-refineable sub-meshes, each as many times as specified in the vector and rebuild problem; doc refinement process </p>
<div class="fragment"><div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;    {</div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;      <span class="comment">// Not tested:</span></div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;      <span class="keywordflow">throw</span> OomphLibWarning(<span class="stringliteral">&quot;This functionality has not yet been tested.&quot;</span>,</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;                            <span class="stringliteral">&quot;Problem::p_refine_uniformly_and_prune()&quot;</span>,</div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;      <span class="keywordtype">bool</span> prune = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a7460f9339fd4850112284a86e039ee00">p_refine_uniformly_aux</a>(nrefine_for_mesh, doc_info, prune);</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7460f9339fd4850112284a86e039ee00">p_refine_uniformly_aux()</a>.</p>

</div>
</div>
<a id="a80ff24a4fc923660f2aabfaa763822bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80ff24a4fc923660f2aabfaa763822bf">&#9670;&nbsp;</a></span>p_refine_uniformly_and_prune() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Problem::p_refine_uniformly_and_prune </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>doc_info</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>p-refine (all) p-refineable (sub)mesh(es) uniformly and rebuild problem; doc refinement process. </p>
<div class="fragment"><div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;    {</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;      <span class="comment">// Not tested:</span></div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;      <span class="keywordflow">throw</span> OomphLibWarning(<span class="stringliteral">&quot;This functionality has not yet been tested.&quot;</span>,</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;                            <span class="stringliteral">&quot;Problem::p_refine_uniformly_and_prune()&quot;</span>,</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;      <span class="comment">// Number of (sub)meshes</span></div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;      <span class="keywordtype">unsigned</span> nmesh = <a class="code" href="../../dc/d51/datatypes_8h.html#affe776513b24d84b39af8ab0930fef7f">std::max</a>(<span class="keywordtype">unsigned</span>(1), <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>());</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160; </div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;      <span class="comment">// Refine each mesh once</span></div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;      Vector&lt;unsigned&gt; nrefine_for_mesh(nmesh, 1);</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a5155b2d5436a95b1ee27f914b4eb8f08">p_refine_uniformly_and_prune</a>(nrefine_for_mesh);</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a5155b2d5436a95b1ee27f914b4eb8f08"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a5155b2d5436a95b1ee27f914b4eb8f08">oomph::Problem::p_refine_uniformly_and_prune</a></div><div class="ttdeci">void p_refine_uniformly_and_prune(const Vector&lt; unsigned &gt; &amp;nrefine_for_mesh)</div><div class="ttdef"><b>Definition:</b> problem.h:2680</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d51/datatypes_8h.html#affe776513b24d84b39af8ab0930fef7f">max</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5155b2d5436a95b1ee27f914b4eb8f08">p_refine_uniformly_and_prune()</a>.</p>

</div>
</div>
<a id="a7460f9339fd4850112284a86e039ee00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7460f9339fd4850112284a86e039ee00">&#9670;&nbsp;</a></span>p_refine_uniformly_aux()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::p_refine_uniformly_aux </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>nrefine_for_mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>doc_info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;&#160;</td>
          <td class="paramname"><em>prune</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Helper function to do compund p-refinement of (all) p-refineable (sub)mesh(es) uniformly as many times as specified in vector and rebuild problem; doc refinement process. Set boolean argument to true if you want to prune immediately after refining the meshes individually. </p>
<div class="fragment"><div class="line"><a name="l15595"></a><span class="lineno">15595</span>&#160;  {</div>
<div class="line"><a name="l15596"></a><span class="lineno">15596</span>&#160;    <span class="keywordtype">double</span> t_start = 0.0;</div>
<div class="line"><a name="l15597"></a><span class="lineno">15597</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l15598"></a><span class="lineno">15598</span>&#160;    {</div>
<div class="line"><a name="l15599"></a><span class="lineno">15599</span>&#160;      t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l15600"></a><span class="lineno">15600</span>&#160;    }</div>
<div class="line"><a name="l15601"></a><span class="lineno">15601</span>&#160; </div>
<div class="line"><a name="l15602"></a><span class="lineno">15602</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">actions_before_adapt</a>();</div>
<div class="line"><a name="l15603"></a><span class="lineno">15603</span>&#160; </div>
<div class="line"><a name="l15604"></a><span class="lineno">15604</span>&#160;    <span class="keywordtype">double</span> t_end = 0.0;</div>
<div class="line"><a name="l15605"></a><span class="lineno">15605</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l15606"></a><span class="lineno">15606</span>&#160;    {</div>
<div class="line"><a name="l15607"></a><span class="lineno">15607</span>&#160;      t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l15608"></a><span class="lineno">15608</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for actions before adapt in &quot;</span></div>
<div class="line"><a name="l15609"></a><span class="lineno">15609</span>&#160;                    <span class="stringliteral">&quot;Problem::p_refine_uniformly_aux(): &quot;</span></div>
<div class="line"><a name="l15610"></a><span class="lineno">15610</span>&#160;                 &lt;&lt; t_end - t_start &lt;&lt; std::endl;</div>
<div class="line"><a name="l15611"></a><span class="lineno">15611</span>&#160;      t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l15612"></a><span class="lineno">15612</span>&#160;    }</div>
<div class="line"><a name="l15613"></a><span class="lineno">15613</span>&#160; </div>
<div class="line"><a name="l15614"></a><span class="lineno">15614</span>&#160;    <span class="comment">// Number of submeshes?</span></div>
<div class="line"><a name="l15615"></a><span class="lineno">15615</span>&#160;    <span class="keywordtype">unsigned</span> n_mesh = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>();</div>
<div class="line"><a name="l15616"></a><span class="lineno">15616</span>&#160; </div>
<div class="line"><a name="l15617"></a><span class="lineno">15617</span>&#160;    <span class="comment">// Single mesh:</span></div>
<div class="line"><a name="l15618"></a><span class="lineno">15618</span>&#160;    <span class="keywordflow">if</span> (n_mesh == 0)</div>
<div class="line"><a name="l15619"></a><span class="lineno">15619</span>&#160;    {</div>
<div class="line"><a name="l15620"></a><span class="lineno">15620</span>&#160;      <span class="comment">// Refine single mesh uniformly if possible</span></div>
<div class="line"><a name="l15621"></a><span class="lineno">15621</span>&#160;      <span class="keywordflow">if</span> (RefineableMeshBase* mmesh_pt =</div>
<div class="line"><a name="l15622"></a><span class="lineno">15622</span>&#160;            <span class="keyword">dynamic_cast&lt;</span>RefineableMeshBase*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(0)))</div>
<div class="line"><a name="l15623"></a><span class="lineno">15623</span>&#160;      {</div>
<div class="line"><a name="l15624"></a><span class="lineno">15624</span>&#160;        <span class="keywordtype">unsigned</span> nref = nrefine_for_mesh[0];</div>
<div class="line"><a name="l15625"></a><span class="lineno">15625</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; nref; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l15626"></a><span class="lineno">15626</span>&#160;        {</div>
<div class="line"><a name="l15627"></a><span class="lineno">15627</span>&#160;          mmesh_pt-&gt;p_refine_uniformly(doc_info);</div>
<div class="line"><a name="l15628"></a><span class="lineno">15628</span>&#160;        }</div>
<div class="line"><a name="l15629"></a><span class="lineno">15629</span>&#160;      }</div>
<div class="line"><a name="l15630"></a><span class="lineno">15630</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l15631"></a><span class="lineno">15631</span>&#160;      {</div>
<div class="line"><a name="l15632"></a><span class="lineno">15632</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Mesh cannot be p-refined uniformly &quot;</span></div>
<div class="line"><a name="l15633"></a><span class="lineno">15633</span>&#160;                   &lt;&lt; std::endl;</div>
<div class="line"><a name="l15634"></a><span class="lineno">15634</span>&#160;      }</div>
<div class="line"><a name="l15635"></a><span class="lineno">15635</span>&#160;    }</div>
<div class="line"><a name="l15636"></a><span class="lineno">15636</span>&#160;    <span class="comment">// Multiple submeshes</span></div>
<div class="line"><a name="l15637"></a><span class="lineno">15637</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l15638"></a><span class="lineno">15638</span>&#160;    {</div>
<div class="line"><a name="l15639"></a><span class="lineno">15639</span>&#160;      OomphLibWarning(</div>
<div class="line"><a name="l15640"></a><span class="lineno">15640</span>&#160;        <span class="stringliteral">&quot;p-refinement for multiple submeshes has not yet been tested.&quot;</span>,</div>
<div class="line"><a name="l15641"></a><span class="lineno">15641</span>&#160;        <span class="stringliteral">&quot;Problem::p_refine_uniformly_aux()&quot;</span>,</div>
<div class="line"><a name="l15642"></a><span class="lineno">15642</span>&#160;        <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l15643"></a><span class="lineno">15643</span>&#160; </div>
<div class="line"><a name="l15644"></a><span class="lineno">15644</span>&#160;      <span class="comment">// Loop over submeshes</span></div>
<div class="line"><a name="l15645"></a><span class="lineno">15645</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> imesh = 0; imesh &lt; n_mesh; imesh++)</div>
<div class="line"><a name="l15646"></a><span class="lineno">15646</span>&#160;      {</div>
<div class="line"><a name="l15647"></a><span class="lineno">15647</span>&#160;        <span class="comment">// Refine i-th submesh uniformly if possible</span></div>
<div class="line"><a name="l15648"></a><span class="lineno">15648</span>&#160;        <span class="keywordflow">if</span> (RefineableMeshBase* mmesh_pt =</div>
<div class="line"><a name="l15649"></a><span class="lineno">15649</span>&#160;              <span class="keyword">dynamic_cast&lt;</span>RefineableMeshBase*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(imesh)))</div>
<div class="line"><a name="l15650"></a><span class="lineno">15650</span>&#160;        {</div>
<div class="line"><a name="l15651"></a><span class="lineno">15651</span>&#160;          <span class="keywordtype">unsigned</span> nref = nrefine_for_mesh[imesh];</div>
<div class="line"><a name="l15652"></a><span class="lineno">15652</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; nref; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l15653"></a><span class="lineno">15653</span>&#160;          {</div>
<div class="line"><a name="l15654"></a><span class="lineno">15654</span>&#160;            mmesh_pt-&gt;p_refine_uniformly(doc_info);</div>
<div class="line"><a name="l15655"></a><span class="lineno">15655</span>&#160;          }</div>
<div class="line"><a name="l15656"></a><span class="lineno">15656</span>&#160;        }</div>
<div class="line"><a name="l15657"></a><span class="lineno">15657</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l15658"></a><span class="lineno">15658</span>&#160;        {</div>
<div class="line"><a name="l15659"></a><span class="lineno">15659</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Cannot p-refine mesh &quot;</span> &lt;&lt; imesh</div>
<div class="line"><a name="l15660"></a><span class="lineno">15660</span>&#160;                     &lt;&lt; std::endl;</div>
<div class="line"><a name="l15661"></a><span class="lineno">15661</span>&#160;        }</div>
<div class="line"><a name="l15662"></a><span class="lineno">15662</span>&#160;      }</div>
<div class="line"><a name="l15663"></a><span class="lineno">15663</span>&#160;      <span class="comment">// Rebuild the global mesh</span></div>
<div class="line"><a name="l15664"></a><span class="lineno">15664</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a266d4d1b2bd4a5cbc028ff5aba79508f">rebuild_global_mesh</a>();</div>
<div class="line"><a name="l15665"></a><span class="lineno">15665</span>&#160;    }</div>
<div class="line"><a name="l15666"></a><span class="lineno">15666</span>&#160; </div>
<div class="line"><a name="l15667"></a><span class="lineno">15667</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l15668"></a><span class="lineno">15668</span>&#160;    {</div>
<div class="line"><a name="l15669"></a><span class="lineno">15669</span>&#160;      t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l15670"></a><span class="lineno">15670</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for mesh-level mesh refinement in &quot;</span></div>
<div class="line"><a name="l15671"></a><span class="lineno">15671</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;Problem::p_refine_uniformly_aux(): &quot;</span> &lt;&lt; t_end - t_start</div>
<div class="line"><a name="l15672"></a><span class="lineno">15672</span>&#160;                 &lt;&lt; std::endl;</div>
<div class="line"><a name="l15673"></a><span class="lineno">15673</span>&#160;      t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l15674"></a><span class="lineno">15674</span>&#160;    }</div>
<div class="line"><a name="l15675"></a><span class="lineno">15675</span>&#160; </div>
<div class="line"><a name="l15676"></a><span class="lineno">15676</span>&#160;    <span class="comment">// Any actions after the adaptation phase</span></div>
<div class="line"><a name="l15677"></a><span class="lineno">15677</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">actions_after_adapt</a>();</div>
<div class="line"><a name="l15678"></a><span class="lineno">15678</span>&#160; </div>
<div class="line"><a name="l15679"></a><span class="lineno">15679</span>&#160; </div>
<div class="line"><a name="l15680"></a><span class="lineno">15680</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l15681"></a><span class="lineno">15681</span>&#160;    {</div>
<div class="line"><a name="l15682"></a><span class="lineno">15682</span>&#160;      t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l15683"></a><span class="lineno">15683</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a></div>
<div class="line"><a name="l15684"></a><span class="lineno">15684</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;Time for actions after adapt  Problem::p_refine_uniformly_aux(): &quot;</span></div>
<div class="line"><a name="l15685"></a><span class="lineno">15685</span>&#160;        &lt;&lt; t_end - t_start &lt;&lt; std::endl;</div>
<div class="line"><a name="l15686"></a><span class="lineno">15686</span>&#160;      t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l15687"></a><span class="lineno">15687</span>&#160;    }</div>
<div class="line"><a name="l15688"></a><span class="lineno">15688</span>&#160; </div>
<div class="line"><a name="l15689"></a><span class="lineno">15689</span>&#160; </div>
<div class="line"><a name="l15690"></a><span class="lineno">15690</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l15691"></a><span class="lineno">15691</span>&#160; </div>
<div class="line"><a name="l15692"></a><span class="lineno">15692</span>&#160;    <span class="comment">// Prune it?</span></div>
<div class="line"><a name="l15693"></a><span class="lineno">15693</span>&#160;    <span class="keywordflow">if</span> (prune)</div>
<div class="line"><a name="l15694"></a><span class="lineno">15694</span>&#160;    {</div>
<div class="line"><a name="l15695"></a><span class="lineno">15695</span>&#160;      <span class="comment">// Note: This calls assign eqn numbers already...</span></div>
<div class="line"><a name="l15696"></a><span class="lineno">15696</span>&#160;      Bypass_increase_in_dof_check_during_pruning = <span class="keyword">true</span>;</div>
<div class="line"><a name="l15697"></a><span class="lineno">15697</span>&#160;      prune_halo_elements_and_nodes();</div>
<div class="line"><a name="l15698"></a><span class="lineno">15698</span>&#160;      Bypass_increase_in_dof_check_during_pruning = <span class="keyword">false</span>;</div>
<div class="line"><a name="l15699"></a><span class="lineno">15699</span>&#160; </div>
<div class="line"><a name="l15700"></a><span class="lineno">15700</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l15701"></a><span class="lineno">15701</span>&#160;      {</div>
<div class="line"><a name="l15702"></a><span class="lineno">15702</span>&#160;        t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l15703"></a><span class="lineno">15703</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for Problem::prune_halo_elements_and_nodes() in &quot;</span></div>
<div class="line"><a name="l15704"></a><span class="lineno">15704</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;Problem::p_refine_uniformly_aux(): &quot;</span> &lt;&lt; t_end - t_start</div>
<div class="line"><a name="l15705"></a><span class="lineno">15705</span>&#160;                   &lt;&lt; std::endl;</div>
<div class="line"><a name="l15706"></a><span class="lineno">15706</span>&#160;      }</div>
<div class="line"><a name="l15707"></a><span class="lineno">15707</span>&#160;    }</div>
<div class="line"><a name="l15708"></a><span class="lineno">15708</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l15709"></a><span class="lineno">15709</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l15710"></a><span class="lineno">15710</span>&#160;    <span class="keywordflow">if</span> (prune)</div>
<div class="line"><a name="l15711"></a><span class="lineno">15711</span>&#160;    {</div>
<div class="line"><a name="l15712"></a><span class="lineno">15712</span>&#160;      std::ostringstream error_message;</div>
<div class="line"><a name="l15713"></a><span class="lineno">15713</span>&#160;      error_message</div>
<div class="line"><a name="l15714"></a><span class="lineno">15714</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;Requested pruning in serial build. Ignoring the request.\n&quot;</span>;</div>
<div class="line"><a name="l15715"></a><span class="lineno">15715</span>&#160;      OomphLibWarning(error_message.str(),</div>
<div class="line"><a name="l15716"></a><span class="lineno">15716</span>&#160;                      <span class="stringliteral">&quot;Problem::p_refine_uniformly_aux()&quot;</span>,</div>
<div class="line"><a name="l15717"></a><span class="lineno">15717</span>&#160;                      <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l15718"></a><span class="lineno">15718</span>&#160;    }</div>
<div class="line"><a name="l15719"></a><span class="lineno">15719</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l15720"></a><span class="lineno">15720</span>&#160;    {</div>
<div class="line"><a name="l15721"></a><span class="lineno">15721</span>&#160;      <span class="comment">// Do equation numbering</span></div>
<div class="line"><a name="l15722"></a><span class="lineno">15722</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a></div>
<div class="line"><a name="l15723"></a><span class="lineno">15723</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;Number of equations after Problem::p_refine_uniformly_aux(): &quot;</span></div>
<div class="line"><a name="l15724"></a><span class="lineno">15724</span>&#160;        &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers</a>() &lt;&lt; std::endl;</div>
<div class="line"><a name="l15725"></a><span class="lineno">15725</span>&#160; </div>
<div class="line"><a name="l15726"></a><span class="lineno">15726</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l15727"></a><span class="lineno">15727</span>&#160;      {</div>
<div class="line"><a name="l15728"></a><span class="lineno">15728</span>&#160;        t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l15729"></a><span class="lineno">15729</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for Problem::assign_eqn_numbers() in &quot;</span></div>
<div class="line"><a name="l15730"></a><span class="lineno">15730</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;Problem::p_refine_uniformly_aux(): &quot;</span> &lt;&lt; t_end - t_start</div>
<div class="line"><a name="l15731"></a><span class="lineno">15731</span>&#160;                   &lt;&lt; std::endl;</div>
<div class="line"><a name="l15732"></a><span class="lineno">15732</span>&#160;      }</div>
<div class="line"><a name="l15733"></a><span class="lineno">15733</span>&#160;    }</div>
<div class="line"><a name="l15734"></a><span class="lineno">15734</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">actions_after_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">actions_before_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers()</a>, <a class="el" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">oomph::Global_timings::Doc_comprehensive_timings</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a266d4d1b2bd4a5cbc028ff5aba79508f">rebuild_global_mesh()</a>, and <a class="el" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">oomph::TimingHelpers::timer()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a3aaea4b1be43f5d4bb187a8c6d3ca16f">p_refine_uniformly()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5155b2d5436a95b1ee27f914b4eb8f08">p_refine_uniformly_and_prune()</a>.</p>

</div>
</div>
<a id="af1d230109bb9c45604042f5b76bae2dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1d230109bb9c45604042f5b76bae2dc">&#9670;&nbsp;</a></span>p_unrefine_uniformly() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::p_unrefine_uniformly </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>i_mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>doc_info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Do uniform p-unrefinement for submesh i_mesh without documentation. </p>
<p>p-unrefine submesh i_mesh uniformly and rebuild problem; doc refinement process. </p>
<div class="fragment"><div class="line"><a name="l16020"></a><span class="lineno">16020</span>&#160;  {</div>
<div class="line"><a name="l16021"></a><span class="lineno">16021</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">actions_before_adapt</a>();</div>
<div class="line"><a name="l16022"></a><span class="lineno">16022</span>&#160; </div>
<div class="line"><a name="l16023"></a><span class="lineno">16023</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l16024"></a><span class="lineno">16024</span>&#160;    <span class="comment">// Number of submeshes?</span></div>
<div class="line"><a name="l16025"></a><span class="lineno">16025</span>&#160;    <span class="keywordflow">if</span> (i_mesh &gt;= <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>())</div>
<div class="line"><a name="l16026"></a><span class="lineno">16026</span>&#160;    {</div>
<div class="line"><a name="l16027"></a><span class="lineno">16027</span>&#160;      std::ostringstream error_message;</div>
<div class="line"><a name="l16028"></a><span class="lineno">16028</span>&#160;      error_message &lt;&lt; <span class="stringliteral">&quot;imesh &quot;</span> &lt;&lt; i_mesh</div>
<div class="line"><a name="l16029"></a><span class="lineno">16029</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot; is greater than the number of sub meshes &quot;</span></div>
<div class="line"><a name="l16030"></a><span class="lineno">16030</span>&#160;                    &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>() &lt;&lt; std::endl;</div>
<div class="line"><a name="l16031"></a><span class="lineno">16031</span>&#160; </div>
<div class="line"><a name="l16032"></a><span class="lineno">16032</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l16033"></a><span class="lineno">16033</span>&#160;        error_message.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l16034"></a><span class="lineno">16034</span>&#160;    }</div>
<div class="line"><a name="l16035"></a><span class="lineno">16035</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l16036"></a><span class="lineno">16036</span>&#160; </div>
<div class="line"><a name="l16037"></a><span class="lineno">16037</span>&#160;    <span class="comment">// Refine single mesh uniformly if possible</span></div>
<div class="line"><a name="l16038"></a><span class="lineno">16038</span>&#160;    <span class="keywordflow">if</span> (RefineableMeshBase* mmesh_pt =</div>
<div class="line"><a name="l16039"></a><span class="lineno">16039</span>&#160;          <span class="keyword">dynamic_cast&lt;</span>RefineableMeshBase*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(i_mesh)))</div>
<div class="line"><a name="l16040"></a><span class="lineno">16040</span>&#160;    {</div>
<div class="line"><a name="l16041"></a><span class="lineno">16041</span>&#160;      mmesh_pt-&gt;p_unrefine_uniformly(doc_info);</div>
<div class="line"><a name="l16042"></a><span class="lineno">16042</span>&#160;    }</div>
<div class="line"><a name="l16043"></a><span class="lineno">16043</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l16044"></a><span class="lineno">16044</span>&#160;    {</div>
<div class="line"><a name="l16045"></a><span class="lineno">16045</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Mesh cannot be p-unrefined uniformly &quot;</span></div>
<div class="line"><a name="l16046"></a><span class="lineno">16046</span>&#160;                 &lt;&lt; std::endl;</div>
<div class="line"><a name="l16047"></a><span class="lineno">16047</span>&#160;    }</div>
<div class="line"><a name="l16048"></a><span class="lineno">16048</span>&#160; </div>
<div class="line"><a name="l16049"></a><span class="lineno">16049</span>&#160;    <span class="comment">// Rebuild the global mesh</span></div>
<div class="line"><a name="l16050"></a><span class="lineno">16050</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a266d4d1b2bd4a5cbc028ff5aba79508f">rebuild_global_mesh</a>();</div>
<div class="line"><a name="l16051"></a><span class="lineno">16051</span>&#160; </div>
<div class="line"><a name="l16052"></a><span class="lineno">16052</span>&#160;    <span class="comment">// Any actions after the adaptation phase</span></div>
<div class="line"><a name="l16053"></a><span class="lineno">16053</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">actions_after_adapt</a>();</div>
<div class="line"><a name="l16054"></a><span class="lineno">16054</span>&#160; </div>
<div class="line"><a name="l16055"></a><span class="lineno">16055</span>&#160;    <span class="comment">// Do equation numbering</span></div>
<div class="line"><a name="l16056"></a><span class="lineno">16056</span>&#160;    <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Number of equations: &quot;</span> &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers</a>() &lt;&lt; std::endl;</div>
<div class="line"><a name="l16057"></a><span class="lineno">16057</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">actions_after_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">actions_before_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a266d4d1b2bd4a5cbc028ff5aba79508f">rebuild_global_mesh()</a>.</p>

</div>
</div>
<a id="afa0aab9ca7018bf875c1f3367c6c07e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa0aab9ca7018bf875c1f3367c6c07e3">&#9670;&nbsp;</a></span>p_unrefine_uniformly() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::p_unrefine_uniformly </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>doc_info</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>p-unrefine (all) p-refineable (sub)mesh(es) uniformly and rebuild problem.</p>
<p>p-unrefine (all) p-refineable (sub)mesh(es) uniformly and rebuild problem; doc refinement process. </p>
<div class="fragment"><div class="line"><a name="l15961"></a><span class="lineno">15961</span>&#160;  {</div>
<div class="line"><a name="l15962"></a><span class="lineno">15962</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">actions_before_adapt</a>();</div>
<div class="line"><a name="l15963"></a><span class="lineno">15963</span>&#160; </div>
<div class="line"><a name="l15964"></a><span class="lineno">15964</span>&#160;    <span class="comment">// Number of submeshes?</span></div>
<div class="line"><a name="l15965"></a><span class="lineno">15965</span>&#160;    <span class="keywordtype">unsigned</span> n_mesh = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>();</div>
<div class="line"><a name="l15966"></a><span class="lineno">15966</span>&#160; </div>
<div class="line"><a name="l15967"></a><span class="lineno">15967</span>&#160;    <span class="comment">// Single mesh:</span></div>
<div class="line"><a name="l15968"></a><span class="lineno">15968</span>&#160;    <span class="keywordflow">if</span> (n_mesh == 0)</div>
<div class="line"><a name="l15969"></a><span class="lineno">15969</span>&#160;    {</div>
<div class="line"><a name="l15970"></a><span class="lineno">15970</span>&#160;      <span class="comment">// Unrefine single mesh uniformly if possible</span></div>
<div class="line"><a name="l15971"></a><span class="lineno">15971</span>&#160;      <span class="keywordflow">if</span> (RefineableMeshBase* mmesh_pt =</div>
<div class="line"><a name="l15972"></a><span class="lineno">15972</span>&#160;            <span class="keyword">dynamic_cast&lt;</span>RefineableMeshBase*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(0)))</div>
<div class="line"><a name="l15973"></a><span class="lineno">15973</span>&#160;      {</div>
<div class="line"><a name="l15974"></a><span class="lineno">15974</span>&#160;        mmesh_pt-&gt;p_unrefine_uniformly(doc_info);</div>
<div class="line"><a name="l15975"></a><span class="lineno">15975</span>&#160;      }</div>
<div class="line"><a name="l15976"></a><span class="lineno">15976</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l15977"></a><span class="lineno">15977</span>&#160;      {</div>
<div class="line"><a name="l15978"></a><span class="lineno">15978</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Mesh cannot be p-unrefined uniformly &quot;</span></div>
<div class="line"><a name="l15979"></a><span class="lineno">15979</span>&#160;                   &lt;&lt; std::endl;</div>
<div class="line"><a name="l15980"></a><span class="lineno">15980</span>&#160;      }</div>
<div class="line"><a name="l15981"></a><span class="lineno">15981</span>&#160;    }</div>
<div class="line"><a name="l15982"></a><span class="lineno">15982</span>&#160;    <span class="comment">// Multiple submeshes</span></div>
<div class="line"><a name="l15983"></a><span class="lineno">15983</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l15984"></a><span class="lineno">15984</span>&#160;    {</div>
<div class="line"><a name="l15985"></a><span class="lineno">15985</span>&#160;      <span class="comment">// Not tested:</span></div>
<div class="line"><a name="l15986"></a><span class="lineno">15986</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(<span class="stringliteral">&quot;This functionality has not yet been tested.&quot;</span>,</div>
<div class="line"><a name="l15987"></a><span class="lineno">15987</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l15988"></a><span class="lineno">15988</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l15989"></a><span class="lineno">15989</span>&#160;      <span class="comment">// Loop over submeshes</span></div>
<div class="line"><a name="l15990"></a><span class="lineno">15990</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> imesh = 0; imesh &lt; n_mesh; imesh++)</div>
<div class="line"><a name="l15991"></a><span class="lineno">15991</span>&#160;      {</div>
<div class="line"><a name="l15992"></a><span class="lineno">15992</span>&#160;        <span class="comment">// Unrefine i-th submesh uniformly if possible</span></div>
<div class="line"><a name="l15993"></a><span class="lineno">15993</span>&#160;        <span class="keywordflow">if</span> (RefineableMeshBase* mmesh_pt =</div>
<div class="line"><a name="l15994"></a><span class="lineno">15994</span>&#160;              <span class="keyword">dynamic_cast&lt;</span>RefineableMeshBase*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(imesh)))</div>
<div class="line"><a name="l15995"></a><span class="lineno">15995</span>&#160;        {</div>
<div class="line"><a name="l15996"></a><span class="lineno">15996</span>&#160;          mmesh_pt-&gt;p_unrefine_uniformly(doc_info);</div>
<div class="line"><a name="l15997"></a><span class="lineno">15997</span>&#160;        }</div>
<div class="line"><a name="l15998"></a><span class="lineno">15998</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l15999"></a><span class="lineno">15999</span>&#160;        {</div>
<div class="line"><a name="l16000"></a><span class="lineno">16000</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Cannot p-unrefine mesh &quot;</span> &lt;&lt; imesh</div>
<div class="line"><a name="l16001"></a><span class="lineno">16001</span>&#160;                     &lt;&lt; std::endl;</div>
<div class="line"><a name="l16002"></a><span class="lineno">16002</span>&#160;        }</div>
<div class="line"><a name="l16003"></a><span class="lineno">16003</span>&#160;      }</div>
<div class="line"><a name="l16004"></a><span class="lineno">16004</span>&#160;      <span class="comment">// Rebuild the global mesh</span></div>
<div class="line"><a name="l16005"></a><span class="lineno">16005</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a266d4d1b2bd4a5cbc028ff5aba79508f">rebuild_global_mesh</a>();</div>
<div class="line"><a name="l16006"></a><span class="lineno">16006</span>&#160;    }</div>
<div class="line"><a name="l16007"></a><span class="lineno">16007</span>&#160; </div>
<div class="line"><a name="l16008"></a><span class="lineno">16008</span>&#160;    <span class="comment">// Any actions after the adaptation phase</span></div>
<div class="line"><a name="l16009"></a><span class="lineno">16009</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">actions_after_adapt</a>();</div>
<div class="line"><a name="l16010"></a><span class="lineno">16010</span>&#160; </div>
<div class="line"><a name="l16011"></a><span class="lineno">16011</span>&#160;    <span class="comment">// Do equation numbering</span></div>
<div class="line"><a name="l16012"></a><span class="lineno">16012</span>&#160;    <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Number of equations: &quot;</span> &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers</a>() &lt;&lt; std::endl;</div>
<div class="line"><a name="l16013"></a><span class="lineno">16013</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">actions_after_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">actions_before_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a266d4d1b2bd4a5cbc028ff5aba79508f">rebuild_global_mesh()</a>.</p>

</div>
</div>
<a id="a92acc3c193a38f321fc318fafd142f7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92acc3c193a38f321fc318fafd142f7a">&#9670;&nbsp;</a></span>problem_is_nonlinear()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Problem::problem_is_nonlinear </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;&#160;</td>
          <td class="paramname"><em>prob_lin</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Access function to Problem_is_nonlinear. </p>
<div class="fragment"><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    {</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade2d3efba34f69aafaefc076ddb3b8d4">Problem_is_nonlinear</a> = prob_lin;</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ade2d3efba34f69aafaefc076ddb3b8d4">Problem_is_nonlinear</a>.</p>

</div>
</div>
<a id="a561320c1b8deb3540d260c6c2c5f4fb4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a561320c1b8deb3540d260c6c2c5f4fb4">&#9670;&nbsp;</a></span>read() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void oomph::Problem::read </td>
          <td>(</td>
          <td class="paramtype">std::ifstream &amp;&#160;</td>
          <td class="paramname"><em>restart_file</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Read refinement pattern of all refineable meshes and refine them accordingly, then read all Data and nodal position info from file for restart. </p>

<p>Reimplemented in <a class="el" href="../../d4/d94/classoomph_1_1MyProblem.html#a869f3a0c604470dea4fd446bae2a3d3a">oomph::MyProblem</a>, and <a class="el" href="../../dd/dfa/classAirwayReopeningProblem.html#a40d218929982ef86849d1bb25cdbe33a">AirwayReopeningProblem&lt; ELEMENT &gt;</a>.</p>
<div class="fragment"><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;    {</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;      <span class="keywordtype">bool</span> unsteady_restart;</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a4f6011ef141cc68598a9502052129a3f">read</a>(restart_file, unsteady_restart);</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a4f6011ef141cc68598a9502052129a3f"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a4f6011ef141cc68598a9502052129a3f">oomph::Problem::read</a></div><div class="ttdeci">virtual void read(std::ifstream &amp;restart_file, bool &amp;unsteady_restart)</div><div class="ttdef"><b>Definition:</b> problem.cc:12251</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a4f6011ef141cc68598a9502052129a3f">read()</a>.</p>

</div>
</div>
<a id="a4f6011ef141cc68598a9502052129a3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f6011ef141cc68598a9502052129a3f">&#9670;&nbsp;</a></span>read() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::read </td>
          <td>(</td>
          <td class="paramtype">std::ifstream &amp;&#160;</td>
          <td class="paramname"><em>restart_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;&#160;</td>
          <td class="paramname"><em>unsteady_restart</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Read refinement pattern of all refineable meshes and refine them accordingly, then read all Data and nodal position info from file for restart. Return flag to indicate if the restart was from steady or unsteady solution</p>
<p>Read refinement pattern of all refineable meshes and refine them accordingly, then read all Data and nodal position info from file for restart. Return flag to indicate if the restart was from steady or unsteady solution. </p>
<div class="fragment"><div class="line"><a name="l12252"></a><span class="lineno">12252</span>&#160;  {</div>
<div class="line"><a name="l12253"></a><span class="lineno">12253</span>&#160;    <span class="comment">// Check if the file is actually open as it won&#39;t be if it doesn&#39;t</span></div>
<div class="line"><a name="l12254"></a><span class="lineno">12254</span>&#160;    <span class="comment">// exist! In that case we&#39;re almost certainly restarting the run on</span></div>
<div class="line"><a name="l12255"></a><span class="lineno">12255</span>&#160;    <span class="comment">// a larger number of processors than the restart data was produced.</span></div>
<div class="line"><a name="l12256"></a><span class="lineno">12256</span>&#160;    <span class="comment">// Say so and return</span></div>
<div class="line"><a name="l12257"></a><span class="lineno">12257</span>&#160;    <span class="keywordtype">bool</span> restart_file_is_open = <span class="keyword">true</span>;</div>
<div class="line"><a name="l12258"></a><span class="lineno">12258</span>&#160;    <span class="keywordflow">if</span> (!restart_file.is_open())</div>
<div class="line"><a name="l12259"></a><span class="lineno">12259</span>&#160;    {</div>
<div class="line"><a name="l12260"></a><span class="lineno">12260</span>&#160;      std::ostringstream warn_message;</div>
<div class="line"><a name="l12261"></a><span class="lineno">12261</span>&#160;      warn_message &lt;&lt; <span class="stringliteral">&quot;Restart file isn&#39;t open -- I&#39;m assuming that this is\n&quot;</span>;</div>
<div class="line"><a name="l12262"></a><span class="lineno">12262</span>&#160;      warn_message &lt;&lt; <span class="stringliteral">&quot;because we&#39;re restarting on a larger number of\n&quot;</span>;</div>
<div class="line"><a name="l12263"></a><span class="lineno">12263</span>&#160;      warn_message &lt;&lt; <span class="stringliteral">&quot;processor than were in use when the restart data was \n&quot;</span>;</div>
<div class="line"><a name="l12264"></a><span class="lineno">12264</span>&#160;      warn_message &lt;&lt; <span class="stringliteral">&quot;dumped.\n&quot;</span>;</div>
<div class="line"><a name="l12265"></a><span class="lineno">12265</span>&#160;      OomphLibWarning(</div>
<div class="line"><a name="l12266"></a><span class="lineno">12266</span>&#160;        warn_message.str(), <span class="stringliteral">&quot;Problem::read()&quot;</span>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l12267"></a><span class="lineno">12267</span>&#160;      restart_file_is_open = <span class="keyword">false</span>;</div>
<div class="line"><a name="l12268"></a><span class="lineno">12268</span>&#160;    }</div>
<div class="line"><a name="l12269"></a><span class="lineno">12269</span>&#160; </div>
<div class="line"><a name="l12270"></a><span class="lineno">12270</span>&#160;    <span class="comment">// Number of (sub)meshes?</span></div>
<div class="line"><a name="l12271"></a><span class="lineno">12271</span>&#160;    <span class="keywordtype">unsigned</span> n_mesh = <a class="code" href="../../dc/d51/datatypes_8h.html#affe776513b24d84b39af8ab0930fef7f">std::max</a>(<span class="keywordtype">unsigned</span>(1), <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>());</div>
<div class="line"><a name="l12272"></a><span class="lineno">12272</span>&#160; </div>
<div class="line"><a name="l12273"></a><span class="lineno">12273</span>&#160;    <a class="code" href="../../d2/dc3/namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">std::string</a> input_string;</div>
<div class="line"><a name="l12274"></a><span class="lineno">12274</span>&#160; </div>
<div class="line"><a name="l12275"></a><span class="lineno">12275</span>&#160;    <span class="comment">// Read line up to termination sign</span></div>
<div class="line"><a name="l12276"></a><span class="lineno">12276</span>&#160;    getline(restart_file, input_string, <span class="charliteral">&#39;#&#39;</span>);</div>
<div class="line"><a name="l12277"></a><span class="lineno">12277</span>&#160; </div>
<div class="line"><a name="l12278"></a><span class="lineno">12278</span>&#160;    <span class="comment">// Ignore rest of line</span></div>
<div class="line"><a name="l12279"></a><span class="lineno">12279</span>&#160;    restart_file.ignore(80, <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l12280"></a><span class="lineno">12280</span>&#160; </div>
<div class="line"><a name="l12281"></a><span class="lineno">12281</span>&#160;    <span class="comment">// Read in number of sub-meshes</span></div>
<div class="line"><a name="l12282"></a><span class="lineno">12282</span>&#160;    <span class="keywordtype">unsigned</span> n_submesh_read;</div>
<div class="line"><a name="l12283"></a><span class="lineno">12283</span>&#160;    n_submesh_read = std::atoi(input_string.c_str());</div>
<div class="line"><a name="l12284"></a><span class="lineno">12284</span>&#160; </div>
<div class="line"><a name="l12285"></a><span class="lineno">12285</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l12286"></a><span class="lineno">12286</span>&#160;    <span class="keywordflow">if</span> (restart_file_is_open)</div>
<div class="line"><a name="l12287"></a><span class="lineno">12287</span>&#160;    {</div>
<div class="line"><a name="l12288"></a><span class="lineno">12288</span>&#160;      <span class="keywordflow">if</span> (n_submesh_read != n_mesh)</div>
<div class="line"><a name="l12289"></a><span class="lineno">12289</span>&#160;      {</div>
<div class="line"><a name="l12290"></a><span class="lineno">12290</span>&#160;        std::ostringstream error_message;</div>
<div class="line"><a name="l12291"></a><span class="lineno">12291</span>&#160;        error_message</div>
<div class="line"><a name="l12292"></a><span class="lineno">12292</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;Number of sub-meshes specified in restart file, &quot;</span></div>
<div class="line"><a name="l12293"></a><span class="lineno">12293</span>&#160;          &lt;&lt; n_submesh_read &lt;&lt; <span class="stringliteral">&quot; doesn&#39;t \n match the my number of sub-meshes,&quot;</span></div>
<div class="line"><a name="l12294"></a><span class="lineno">12294</span>&#160;          &lt;&lt; n_mesh &lt;&lt; std::endl</div>
<div class="line"><a name="l12295"></a><span class="lineno">12295</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;Make sure all sub-meshes have been added to the global mesh\n&quot;</span></div>
<div class="line"><a name="l12296"></a><span class="lineno">12296</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;when calling the Problem::dump() function.\n&quot;</span>;</div>
<div class="line"><a name="l12297"></a><span class="lineno">12297</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(error_message.str(),</div>
<div class="line"><a name="l12298"></a><span class="lineno">12298</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l12299"></a><span class="lineno">12299</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l12300"></a><span class="lineno">12300</span>&#160;      }</div>
<div class="line"><a name="l12301"></a><span class="lineno">12301</span>&#160;    }</div>
<div class="line"><a name="l12302"></a><span class="lineno">12302</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l12303"></a><span class="lineno">12303</span>&#160;    <span class="comment">// Suppress comiler warnings about non-used variable</span></div>
<div class="line"><a name="l12304"></a><span class="lineno">12304</span>&#160;    n_submesh_read++;</div>
<div class="line"><a name="l12305"></a><span class="lineno">12305</span>&#160;    n_submesh_read--;</div>
<div class="line"><a name="l12306"></a><span class="lineno">12306</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l12307"></a><span class="lineno">12307</span>&#160; </div>
<div class="line"><a name="l12308"></a><span class="lineno">12308</span>&#160; </div>
<div class="line"><a name="l12309"></a><span class="lineno">12309</span>&#160;    <span class="comment">// Read levels of refinement before pruning</span></div>
<div class="line"><a name="l12310"></a><span class="lineno">12310</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l12311"></a><span class="lineno">12311</span>&#160;    <span class="keywordtype">bool</span> refine_and_prune_required = <span class="keyword">false</span>;</div>
<div class="line"><a name="l12312"></a><span class="lineno">12312</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l12313"></a><span class="lineno">12313</span>&#160;    Vector&lt;unsigned&gt; nrefinement_for_mesh(n_mesh);</div>
<div class="line"><a name="l12314"></a><span class="lineno">12314</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_mesh; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l12315"></a><span class="lineno">12315</span>&#160;    {</div>
<div class="line"><a name="l12316"></a><span class="lineno">12316</span>&#160;      <span class="comment">// Read line up to termination sign</span></div>
<div class="line"><a name="l12317"></a><span class="lineno">12317</span>&#160;      getline(restart_file, input_string, <span class="charliteral">&#39;#&#39;</span>);</div>
<div class="line"><a name="l12318"></a><span class="lineno">12318</span>&#160; </div>
<div class="line"><a name="l12319"></a><span class="lineno">12319</span>&#160;      <span class="comment">// Ignore rest of line</span></div>
<div class="line"><a name="l12320"></a><span class="lineno">12320</span>&#160;      restart_file.ignore(80, <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l12321"></a><span class="lineno">12321</span>&#160; </div>
<div class="line"><a name="l12322"></a><span class="lineno">12322</span>&#160;      <span class="comment">// Convert</span></div>
<div class="line"><a name="l12323"></a><span class="lineno">12323</span>&#160;      nrefinement_for_mesh[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = std::atoi(input_string.c_str());</div>
<div class="line"><a name="l12324"></a><span class="lineno">12324</span>&#160; </div>
<div class="line"><a name="l12325"></a><span class="lineno">12325</span>&#160;      <span class="comment">// Get pointer to sub-mesh in incarnation as tree-based refineable mesh</span></div>
<div class="line"><a name="l12326"></a><span class="lineno">12326</span>&#160;      TreeBasedRefineableMeshBase* ref_mesh_pt =</div>
<div class="line"><a name="l12327"></a><span class="lineno">12327</span>&#160;        <span class="keyword">dynamic_cast&lt;</span>TreeBasedRefineableMeshBase*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div>
<div class="line"><a name="l12328"></a><span class="lineno">12328</span>&#160; </div>
<div class="line"><a name="l12329"></a><span class="lineno">12329</span>&#160;      <span class="comment">// If it&#39;s not a tree-based refineable mesh, ignore the following</span></div>
<div class="line"><a name="l12330"></a><span class="lineno">12330</span>&#160;      <span class="keywordflow">if</span> (ref_mesh_pt == 0)</div>
<div class="line"><a name="l12331"></a><span class="lineno">12331</span>&#160;      {</div>
<div class="line"><a name="l12332"></a><span class="lineno">12332</span>&#160;        <span class="keywordflow">if</span> (nrefinement_for_mesh[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] != 0)</div>
<div class="line"><a name="l12333"></a><span class="lineno">12333</span>&#160;        {</div>
<div class="line"><a name="l12334"></a><span class="lineno">12334</span>&#160;          std::ostringstream error_stream;</div>
<div class="line"><a name="l12335"></a><span class="lineno">12335</span>&#160;          error_stream &lt;&lt; <span class="stringliteral">&quot;Nonzero uniform-refinement-when-pruned specified\n&quot;</span></div>
<div class="line"><a name="l12336"></a><span class="lineno">12336</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot;even though mesh is not tree-based. Odd. May want\n&quot;</span></div>
<div class="line"><a name="l12337"></a><span class="lineno">12337</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot;to check this carefully before disabling this \n&quot;</span></div>
<div class="line"><a name="l12338"></a><span class="lineno">12338</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot;warning/error -- most likely if/when we start to\n&quot;</span></div>
<div class="line"><a name="l12339"></a><span class="lineno">12339</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot;prune unstructured meshes [though I can&#39;t see why\n&quot;</span></div>
<div class="line"><a name="l12340"></a><span class="lineno">12340</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot;we would want to do this, given that they are \n&quot;</span></div>
<div class="line"><a name="l12341"></a><span class="lineno">12341</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot;currently totally re-generated...]\n&quot;</span>;</div>
<div class="line"><a name="l12342"></a><span class="lineno">12342</span>&#160;          <span class="keywordflow">throw</span> OomphLibError(error_stream.str(),</div>
<div class="line"><a name="l12343"></a><span class="lineno">12343</span>&#160;                              <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l12344"></a><span class="lineno">12344</span>&#160;                              <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l12345"></a><span class="lineno">12345</span>&#160;        }</div>
<div class="line"><a name="l12346"></a><span class="lineno">12346</span>&#160;      }</div>
<div class="line"><a name="l12347"></a><span class="lineno">12347</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l12348"></a><span class="lineno">12348</span>&#160;      {</div>
<div class="line"><a name="l12349"></a><span class="lineno">12349</span>&#160;        <span class="comment">// Get min and max refinement level</span></div>
<div class="line"><a name="l12350"></a><span class="lineno">12350</span>&#160;        <span class="keywordtype">unsigned</span> local_min_ref = 0;</div>
<div class="line"><a name="l12351"></a><span class="lineno">12351</span>&#160;        <span class="keywordtype">unsigned</span> local_max_ref = 0;</div>
<div class="line"><a name="l12352"></a><span class="lineno">12352</span>&#160;        ref_mesh_pt-&gt;get_refinement_levels(local_min_ref, local_max_ref);</div>
<div class="line"><a name="l12353"></a><span class="lineno">12353</span>&#160; </div>
<div class="line"><a name="l12354"></a><span class="lineno">12354</span>&#160;        <span class="comment">// Overall min refinement level over all meshes</span></div>
<div class="line"><a name="l12355"></a><span class="lineno">12355</span>&#160;        <span class="keywordtype">unsigned</span> min_ref = local_min_ref;</div>
<div class="line"><a name="l12356"></a><span class="lineno">12356</span>&#160; </div>
<div class="line"><a name="l12357"></a><span class="lineno">12357</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l12358"></a><span class="lineno">12358</span>&#160;        <span class="keywordflow">if</span> (Problem_has_been_distributed)</div>
<div class="line"><a name="l12359"></a><span class="lineno">12359</span>&#160;        {</div>
<div class="line"><a name="l12360"></a><span class="lineno">12360</span>&#160;          <span class="comment">// Reconcile between processors: If (e.g. following</span></div>
<div class="line"><a name="l12361"></a><span class="lineno">12361</span>&#160;          <span class="comment">// distribution/pruning) the mesh has no elements on this</span></div>
<div class="line"><a name="l12362"></a><span class="lineno">12362</span>&#160;          <span class="comment">// processor) then ignore its contribution to the poll of</span></div>
<div class="line"><a name="l12363"></a><span class="lineno">12363</span>&#160;          <span class="comment">// max/min refinement levels</span></div>
<div class="line"><a name="l12364"></a><span class="lineno">12364</span>&#160;          <span class="keywordtype">int</span> int_local_min_ref = local_min_ref;</div>
<div class="line"><a name="l12365"></a><span class="lineno">12365</span>&#160;          <span class="keywordflow">if</span> (ref_mesh_pt-&gt;nelement() == 0)</div>
<div class="line"><a name="l12366"></a><span class="lineno">12366</span>&#160;          {</div>
<div class="line"><a name="l12367"></a><span class="lineno">12367</span>&#160;            int_local_min_ref = INT_MAX;</div>
<div class="line"><a name="l12368"></a><span class="lineno">12368</span>&#160;          }</div>
<div class="line"><a name="l12369"></a><span class="lineno">12369</span>&#160;          <span class="keywordtype">int</span> int_min_ref = 0;</div>
<div class="line"><a name="l12370"></a><span class="lineno">12370</span>&#160;          MPI_Allreduce(&amp;int_local_min_ref,</div>
<div class="line"><a name="l12371"></a><span class="lineno">12371</span>&#160;                        &amp;int_min_ref,</div>
<div class="line"><a name="l12372"></a><span class="lineno">12372</span>&#160;                        1,</div>
<div class="line"><a name="l12373"></a><span class="lineno">12373</span>&#160;                        MPI_INT,</div>
<div class="line"><a name="l12374"></a><span class="lineno">12374</span>&#160;                        MPI_MIN,</div>
<div class="line"><a name="l12375"></a><span class="lineno">12375</span>&#160;                        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>-&gt;mpi_comm());</div>
<div class="line"><a name="l12376"></a><span class="lineno">12376</span>&#160; </div>
<div class="line"><a name="l12377"></a><span class="lineno">12377</span>&#160;          <span class="comment">// Overall min refinement level over all meshes</span></div>
<div class="line"><a name="l12378"></a><span class="lineno">12378</span>&#160;          min_ref = <a class="code" href="../../d0/d1d/classunsigned.html">unsigned</a>(int_min_ref);</div>
<div class="line"><a name="l12379"></a><span class="lineno">12379</span>&#160;        }</div>
<div class="line"><a name="l12380"></a><span class="lineno">12380</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l12381"></a><span class="lineno">12381</span>&#160; </div>
<div class="line"><a name="l12382"></a><span class="lineno">12382</span>&#160;        <span class="comment">// Need to refine less</span></div>
<div class="line"><a name="l12383"></a><span class="lineno">12383</span>&#160;        <span class="keywordflow">if</span> (nrefinement_for_mesh[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] &gt;= min_ref)</div>
<div class="line"><a name="l12384"></a><span class="lineno">12384</span>&#160;        {</div>
<div class="line"><a name="l12385"></a><span class="lineno">12385</span>&#160;          nrefinement_for_mesh[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] -= min_ref;</div>
<div class="line"><a name="l12386"></a><span class="lineno">12386</span>&#160;        }</div>
<div class="line"><a name="l12387"></a><span class="lineno">12387</span>&#160;      }</div>
<div class="line"><a name="l12388"></a><span class="lineno">12388</span>&#160; </div>
<div class="line"><a name="l12389"></a><span class="lineno">12389</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l12390"></a><span class="lineno">12390</span>&#160;      <span class="keywordflow">if</span> (nrefinement_for_mesh[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] &gt; 0)</div>
<div class="line"><a name="l12391"></a><span class="lineno">12391</span>&#160;      {</div>
<div class="line"><a name="l12392"></a><span class="lineno">12392</span>&#160;        refine_and_prune_required = <span class="keyword">true</span>;</div>
<div class="line"><a name="l12393"></a><span class="lineno">12393</span>&#160;      }</div>
<div class="line"><a name="l12394"></a><span class="lineno">12394</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l12395"></a><span class="lineno">12395</span>&#160;    }</div>
<div class="line"><a name="l12396"></a><span class="lineno">12396</span>&#160; </div>
<div class="line"><a name="l12397"></a><span class="lineno">12397</span>&#160; </div>
<div class="line"><a name="l12398"></a><span class="lineno">12398</span>&#160;    <span class="comment">// Reconcile overall need to refine and prune (even empty</span></div>
<div class="line"><a name="l12399"></a><span class="lineno">12399</span>&#160;    <span class="comment">// processors have to participate in some communication!)</span></div>
<div class="line"><a name="l12400"></a><span class="lineno">12400</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l12401"></a><span class="lineno">12401</span>&#160;    <span class="keywordflow">if</span> (Problem_has_been_distributed)</div>
<div class="line"><a name="l12402"></a><span class="lineno">12402</span>&#160;    {</div>
<div class="line"><a name="l12403"></a><span class="lineno">12403</span>&#160;      <span class="keywordtype">unsigned</span> local_req_flag = 0;</div>
<div class="line"><a name="l12404"></a><span class="lineno">12404</span>&#160;      <span class="keywordtype">unsigned</span> req_flag = 0;</div>
<div class="line"><a name="l12405"></a><span class="lineno">12405</span>&#160;      <span class="keywordflow">if</span> (refine_and_prune_required)</div>
<div class="line"><a name="l12406"></a><span class="lineno">12406</span>&#160;      {</div>
<div class="line"><a name="l12407"></a><span class="lineno">12407</span>&#160;        local_req_flag = 1;</div>
<div class="line"><a name="l12408"></a><span class="lineno">12408</span>&#160;      }</div>
<div class="line"><a name="l12409"></a><span class="lineno">12409</span>&#160;      MPI_Allreduce(&amp;local_req_flag,</div>
<div class="line"><a name="l12410"></a><span class="lineno">12410</span>&#160;                    &amp;req_flag,</div>
<div class="line"><a name="l12411"></a><span class="lineno">12411</span>&#160;                    1,</div>
<div class="line"><a name="l12412"></a><span class="lineno">12412</span>&#160;                    MPI_UNSIGNED,</div>
<div class="line"><a name="l12413"></a><span class="lineno">12413</span>&#160;                    MPI_MAX,</div>
<div class="line"><a name="l12414"></a><span class="lineno">12414</span>&#160;                    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>-&gt;mpi_comm());</div>
<div class="line"><a name="l12415"></a><span class="lineno">12415</span>&#160;      refine_and_prune_required = <span class="keyword">false</span>;</div>
<div class="line"><a name="l12416"></a><span class="lineno">12416</span>&#160;      <span class="keywordflow">if</span> (req_flag == 1)</div>
<div class="line"><a name="l12417"></a><span class="lineno">12417</span>&#160;      {</div>
<div class="line"><a name="l12418"></a><span class="lineno">12418</span>&#160;        refine_and_prune_required = <span class="keyword">true</span>;</div>
<div class="line"><a name="l12419"></a><span class="lineno">12419</span>&#160;      }</div>
<div class="line"><a name="l12420"></a><span class="lineno">12420</span>&#160; </div>
<div class="line"><a name="l12421"></a><span class="lineno">12421</span>&#160;      <span class="comment">// If refine and prune is required make number of uniform</span></div>
<div class="line"><a name="l12422"></a><span class="lineno">12422</span>&#160;      <span class="comment">// refinements for each mesh consistent otherwise code</span></div>
<div class="line"><a name="l12423"></a><span class="lineno">12423</span>&#160;      <span class="comment">// hangs on &quot;empty&quot; processors for which no restart file exists</span></div>
<div class="line"><a name="l12424"></a><span class="lineno">12424</span>&#160;      <span class="keywordflow">if</span> (refine_and_prune_required)</div>
<div class="line"><a name="l12425"></a><span class="lineno">12425</span>&#160;      {</div>
<div class="line"><a name="l12426"></a><span class="lineno">12426</span>&#160;        <span class="comment">// This is what we have locally</span></div>
<div class="line"><a name="l12427"></a><span class="lineno">12427</span>&#160;        Vector&lt;unsigned&gt; local_nrefinement_for_mesh(nrefinement_for_mesh);</div>
<div class="line"><a name="l12428"></a><span class="lineno">12428</span>&#160;        <span class="comment">// Synchronise over all processors with max operation</span></div>
<div class="line"><a name="l12429"></a><span class="lineno">12429</span>&#160;        MPI_Allreduce(&amp;local_nrefinement_for_mesh[0],</div>
<div class="line"><a name="l12430"></a><span class="lineno">12430</span>&#160;                      &amp;nrefinement_for_mesh[0],</div>
<div class="line"><a name="l12431"></a><span class="lineno">12431</span>&#160;                      n_mesh,</div>
<div class="line"><a name="l12432"></a><span class="lineno">12432</span>&#160;                      MPI_UNSIGNED,</div>
<div class="line"><a name="l12433"></a><span class="lineno">12433</span>&#160;                      MPI_MAX,</div>
<div class="line"><a name="l12434"></a><span class="lineno">12434</span>&#160;                      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>-&gt;mpi_comm());</div>
<div class="line"><a name="l12435"></a><span class="lineno">12435</span>&#160; </div>
<div class="line"><a name="l12436"></a><span class="lineno">12436</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l12437"></a><span class="lineno">12437</span>&#160;        <span class="comment">// Check it: Reconciliation should only be required for</span></div>
<div class="line"><a name="l12438"></a><span class="lineno">12438</span>&#160;        <span class="comment">// for processors on which no restart file was opened and</span></div>
<div class="line"><a name="l12439"></a><span class="lineno">12439</span>&#160;        <span class="comment">// for which the meshes are therefore empty</span></div>
<div class="line"><a name="l12440"></a><span class="lineno">12440</span>&#160;        <span class="keywordtype">bool</span> fail = <span class="keyword">false</span>;</div>
<div class="line"><a name="l12441"></a><span class="lineno">12441</span>&#160;        std::ostringstream error_message;</div>
<div class="line"><a name="l12442"></a><span class="lineno">12442</span>&#160;        error_message &lt;&lt; <span class="stringliteral">&quot;Number of uniform refinements was not consistent \n&quot;</span></div>
<div class="line"><a name="l12443"></a><span class="lineno">12443</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;for following meshes during restart on processor \n&quot;</span></div>
<div class="line"><a name="l12444"></a><span class="lineno">12444</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;on which restart file could be opened:\n&quot;</span>;</div>
<div class="line"><a name="l12445"></a><span class="lineno">12445</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_mesh; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l12446"></a><span class="lineno">12446</span>&#160;        {</div>
<div class="line"><a name="l12447"></a><span class="lineno">12447</span>&#160;          <span class="keywordflow">if</span> ((local_nrefinement_for_mesh[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] != nrefinement_for_mesh[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]) &amp;&amp;</div>
<div class="line"><a name="l12448"></a><span class="lineno">12448</span>&#160;              restart_file_is_open)</div>
<div class="line"><a name="l12449"></a><span class="lineno">12449</span>&#160;          {</div>
<div class="line"><a name="l12450"></a><span class="lineno">12450</span>&#160;            fail = <span class="keyword">true</span>;</div>
<div class="line"><a name="l12451"></a><span class="lineno">12451</span>&#160;            error_message &lt;&lt; <span class="stringliteral">&quot;Sub-mesh: &quot;</span> &lt;&lt; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot;; local nrefinement: &quot;</span></div>
<div class="line"><a name="l12452"></a><span class="lineno">12452</span>&#160;                          &lt;&lt; local_nrefinement_for_mesh[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l12453"></a><span class="lineno">12453</span>&#160;                          &lt;&lt; <span class="stringliteral">&quot;; global/synced nrefinement: &quot;</span></div>
<div class="line"><a name="l12454"></a><span class="lineno">12454</span>&#160;                          &lt;&lt; nrefinement_for_mesh[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l12455"></a><span class="lineno">12455</span>&#160;          }</div>
<div class="line"><a name="l12456"></a><span class="lineno">12456</span>&#160;        }</div>
<div class="line"><a name="l12457"></a><span class="lineno">12457</span>&#160;        <span class="keywordflow">if</span> (fail)</div>
<div class="line"><a name="l12458"></a><span class="lineno">12458</span>&#160;        {</div>
<div class="line"><a name="l12459"></a><span class="lineno">12459</span>&#160;          OomphLibWarning(</div>
<div class="line"><a name="l12460"></a><span class="lineno">12460</span>&#160;            error_message.str(), <span class="stringliteral">&quot;Problem::read()&quot;</span>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l12461"></a><span class="lineno">12461</span>&#160;        }</div>
<div class="line"><a name="l12462"></a><span class="lineno">12462</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l12463"></a><span class="lineno">12463</span>&#160;      }</div>
<div class="line"><a name="l12464"></a><span class="lineno">12464</span>&#160;    }</div>
<div class="line"><a name="l12465"></a><span class="lineno">12465</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l12466"></a><span class="lineno">12466</span>&#160; </div>
<div class="line"><a name="l12467"></a><span class="lineno">12467</span>&#160;    <span class="comment">// Read line up to termination sign</span></div>
<div class="line"><a name="l12468"></a><span class="lineno">12468</span>&#160;    getline(restart_file, input_string, <span class="charliteral">&#39;#&#39;</span>);</div>
<div class="line"><a name="l12469"></a><span class="lineno">12469</span>&#160; </div>
<div class="line"><a name="l12470"></a><span class="lineno">12470</span>&#160;    <span class="comment">// Ignore rest of line</span></div>
<div class="line"><a name="l12471"></a><span class="lineno">12471</span>&#160;    restart_file.ignore(80, <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l12472"></a><span class="lineno">12472</span>&#160; </div>
<div class="line"><a name="l12473"></a><span class="lineno">12473</span>&#160;    <span class="comment">// Check flag that indicates that we&#39;ve read the final data</span></div>
<div class="line"><a name="l12474"></a><span class="lineno">12474</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="../../da/d67/level3__impl_8h.html#a0ab86207641c152874beced8f77894d0">tmp</a>;</div>
<div class="line"><a name="l12475"></a><span class="lineno">12475</span>&#160;    <a class="code" href="../../da/d67/level3__impl_8h.html#a0ab86207641c152874beced8f77894d0">tmp</a> = std::atoi(input_string.c_str());</div>
<div class="line"><a name="l12476"></a><span class="lineno">12476</span>&#160; </div>
<div class="line"><a name="l12477"></a><span class="lineno">12477</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l12478"></a><span class="lineno">12478</span>&#160;    <span class="keywordflow">if</span> (restart_file_is_open)</div>
<div class="line"><a name="l12479"></a><span class="lineno">12479</span>&#160;    {</div>
<div class="line"><a name="l12480"></a><span class="lineno">12480</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../da/d67/level3__impl_8h.html#a0ab86207641c152874beced8f77894d0">tmp</a> != 9999)</div>
<div class="line"><a name="l12481"></a><span class="lineno">12481</span>&#160;      {</div>
<div class="line"><a name="l12482"></a><span class="lineno">12482</span>&#160;        std::ostringstream error_message;</div>
<div class="line"><a name="l12483"></a><span class="lineno">12483</span>&#160;        error_message</div>
<div class="line"><a name="l12484"></a><span class="lineno">12484</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;Error in reading restart data: Uniform refinement when pruned \n&quot;</span></div>
<div class="line"><a name="l12485"></a><span class="lineno">12485</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;flags should be followed by 9999.\n&quot;</span>;</div>
<div class="line"><a name="l12486"></a><span class="lineno">12486</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(error_message.str(),</div>
<div class="line"><a name="l12487"></a><span class="lineno">12487</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l12488"></a><span class="lineno">12488</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l12489"></a><span class="lineno">12489</span>&#160;      }</div>
<div class="line"><a name="l12490"></a><span class="lineno">12490</span>&#160;    }</div>
<div class="line"><a name="l12491"></a><span class="lineno">12491</span>&#160; </div>
<div class="line"><a name="l12492"></a><span class="lineno">12492</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l12493"></a><span class="lineno">12493</span>&#160;    <span class="comment">// Suppress comiler warnings about non-used variable</span></div>
<div class="line"><a name="l12494"></a><span class="lineno">12494</span>&#160;    <a class="code" href="../../da/d67/level3__impl_8h.html#a0ab86207641c152874beced8f77894d0">tmp</a>++;</div>
<div class="line"><a name="l12495"></a><span class="lineno">12495</span>&#160;    <a class="code" href="../../da/d67/level3__impl_8h.html#a0ab86207641c152874beced8f77894d0">tmp</a>--;</div>
<div class="line"><a name="l12496"></a><span class="lineno">12496</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l12497"></a><span class="lineno">12497</span>&#160; </div>
<div class="line"><a name="l12498"></a><span class="lineno">12498</span>&#160; </div>
<div class="line"><a name="l12499"></a><span class="lineno">12499</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l12500"></a><span class="lineno">12500</span>&#160; </div>
<div class="line"><a name="l12501"></a><span class="lineno">12501</span>&#160;    <span class="comment">// Refine and prune if required</span></div>
<div class="line"><a name="l12502"></a><span class="lineno">12502</span>&#160;    <span class="keywordflow">if</span> (refine_and_prune_required)</div>
<div class="line"><a name="l12503"></a><span class="lineno">12503</span>&#160;    {</div>
<div class="line"><a name="l12504"></a><span class="lineno">12504</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade208b7d7d8e866d5ba896f03edb1f9a">refine_uniformly</a>(nrefinement_for_mesh);</div>
<div class="line"><a name="l12505"></a><span class="lineno">12505</span>&#160;      prune_halo_elements_and_nodes();</div>
<div class="line"><a name="l12506"></a><span class="lineno">12506</span>&#160;    }</div>
<div class="line"><a name="l12507"></a><span class="lineno">12507</span>&#160; </div>
<div class="line"><a name="l12508"></a><span class="lineno">12508</span>&#160;    <span class="comment">// target_domain_for_local_non_halo_element[e] contains the number</span></div>
<div class="line"><a name="l12509"></a><span class="lineno">12509</span>&#160;    <span class="comment">// of the domain [0,1,...,nproc-1] to which non-halo element e on THE</span></div>
<div class="line"><a name="l12510"></a><span class="lineno">12510</span>&#160;    <span class="comment">// CURRENT PROCESSOR ONLY has been assigned. The order of the non-halo</span></div>
<div class="line"><a name="l12511"></a><span class="lineno">12511</span>&#160;    <span class="comment">// elements is the same as in the Problem&#39;s mesh, with the halo</span></div>
<div class="line"><a name="l12512"></a><span class="lineno">12512</span>&#160;    <span class="comment">// elements being skipped.</span></div>
<div class="line"><a name="l12513"></a><span class="lineno">12513</span>&#160;    Vector&lt;unsigned&gt; target_domain_for_local_non_halo_element;</div>
<div class="line"><a name="l12514"></a><span class="lineno">12514</span>&#160; </div>
<div class="line"><a name="l12515"></a><span class="lineno">12515</span>&#160;    <span class="comment">// If a restart file has been generated using code compiled without MPI</span></div>
<div class="line"><a name="l12516"></a><span class="lineno">12516</span>&#160;    <span class="comment">// then it will not have any of the base element data.</span></div>
<div class="line"><a name="l12517"></a><span class="lineno">12517</span>&#160;    <span class="comment">// If we try to read in that file with code that has been compied using</span></div>
<div class="line"><a name="l12518"></a><span class="lineno">12518</span>&#160;    <span class="comment">// MPI, even if running only one processor, then it will fail here.</span></div>
<div class="line"><a name="l12519"></a><span class="lineno">12519</span>&#160;    <span class="comment">// The ideal fix is to edit the restart file so that it contains the two</span></div>
<div class="line"><a name="l12520"></a><span class="lineno">12520</span>&#160;    <span class="comment">// lines</span></div>
<div class="line"><a name="l12521"></a><span class="lineno">12521</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l12522"></a><span class="lineno">12522</span>&#160;    <span class="comment">// 0 # Number of base elements; partitioning follows.</span></div>
<div class="line"><a name="l12523"></a><span class="lineno">12523</span>&#160;    <span class="comment">// 8888 # Test flag for end of base element distribution</span></div>
<div class="line"><a name="l12524"></a><span class="lineno">12524</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l12525"></a><span class="lineno">12525</span>&#160;    <span class="comment">// after the end of the sub-meshes, but before the number of elements</span></div>
<div class="line"><a name="l12526"></a><span class="lineno">12526</span>&#160;    <span class="comment">// However, we can determine that this is the problem if n_base = 0,</span></div>
<div class="line"><a name="l12527"></a><span class="lineno">12527</span>&#160;    <span class="comment">// so there is a little bit of logic below to catch this case</span></div>
<div class="line"><a name="l12528"></a><span class="lineno">12528</span>&#160; </div>
<div class="line"><a name="l12529"></a><span class="lineno">12529</span>&#160;    <span class="comment">// Store current location in the file (before we are about to read</span></div>
<div class="line"><a name="l12530"></a><span class="lineno">12530</span>&#160;    <span class="comment">// in either the base mesh or number of elements of the first mesh)</span></div>
<div class="line"><a name="l12531"></a><span class="lineno">12531</span>&#160;    std::streampos position_before_base_element = restart_file.tellg();</div>
<div class="line"><a name="l12532"></a><span class="lineno">12532</span>&#160;    <span class="comment">// Boolean flag used to set whether to read in base element info</span></div>
<div class="line"><a name="l12533"></a><span class="lineno">12533</span>&#160;    <span class="keywordtype">bool</span> read_in_base_element_info = <span class="keyword">true</span>;</div>
<div class="line"><a name="l12534"></a><span class="lineno">12534</span>&#160; </div>
<div class="line"><a name="l12535"></a><span class="lineno">12535</span>&#160;    <span class="comment">// Read line up to termination sign</span></div>
<div class="line"><a name="l12536"></a><span class="lineno">12536</span>&#160;    getline(restart_file, input_string, <span class="charliteral">&#39;#&#39;</span>);</div>
<div class="line"><a name="l12537"></a><span class="lineno">12537</span>&#160; </div>
<div class="line"><a name="l12538"></a><span class="lineno">12538</span>&#160;    <span class="comment">// Ignore rest of line</span></div>
<div class="line"><a name="l12539"></a><span class="lineno">12539</span>&#160;    restart_file.ignore(80, <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l12540"></a><span class="lineno">12540</span>&#160; </div>
<div class="line"><a name="l12541"></a><span class="lineno">12541</span>&#160;    <span class="comment">// Get number of base elements as recorded</span></div>
<div class="line"><a name="l12542"></a><span class="lineno">12542</span>&#160;    <span class="keywordtype">unsigned</span> n_base_element_read_in = atoi(input_string.c_str());</div>
<div class="line"><a name="l12543"></a><span class="lineno">12543</span>&#160;    <span class="keywordtype">unsigned</span> nbase = Base_mesh_element_pt.size();</div>
<div class="line"><a name="l12544"></a><span class="lineno">12544</span>&#160;    <span class="keywordflow">if</span> (restart_file_is_open)</div>
<div class="line"><a name="l12545"></a><span class="lineno">12545</span>&#160;    {</div>
<div class="line"><a name="l12546"></a><span class="lineno">12546</span>&#160;      <span class="keywordflow">if</span> (n_base_element_read_in != nbase)</div>
<div class="line"><a name="l12547"></a><span class="lineno">12547</span>&#160;      {</div>
<div class="line"><a name="l12548"></a><span class="lineno">12548</span>&#160;        <span class="comment">// If we have zero base elements the problem could be that the</span></div>
<div class="line"><a name="l12549"></a><span class="lineno">12549</span>&#160;        <span class="comment">// restart file was generated without MPI. Issue a warning</span></div>
<div class="line"><a name="l12550"></a><span class="lineno">12550</span>&#160;        <span class="comment">// and continue anyway</span></div>
<div class="line"><a name="l12551"></a><span class="lineno">12551</span>&#160;        <span class="keywordflow">if</span> (nbase == 0)</div>
<div class="line"><a name="l12552"></a><span class="lineno">12552</span>&#160;        {</div>
<div class="line"><a name="l12553"></a><span class="lineno">12553</span>&#160;          std::ostringstream warn_message;</div>
<div class="line"><a name="l12554"></a><span class="lineno">12554</span>&#160;          warn_message</div>
<div class="line"><a name="l12555"></a><span class="lineno">12555</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;The number of base elements in the mesh is 0,\n&quot;</span></div>
<div class="line"><a name="l12556"></a><span class="lineno">12556</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; but the restart file indicates that there are &quot;</span></div>
<div class="line"><a name="l12557"></a><span class="lineno">12557</span>&#160;            &lt;&lt; n_base_element_read_in &lt;&lt; <span class="stringliteral">&quot;.\n&quot;</span></div>
<div class="line"><a name="l12558"></a><span class="lineno">12558</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;This could be because the restart file was \n&quot;</span></div>
<div class="line"><a name="l12559"></a><span class="lineno">12559</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;generated by using code without MPI.\n&quot;</span></div>
<div class="line"><a name="l12560"></a><span class="lineno">12560</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l12561"></a><span class="lineno">12561</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;The best fix is to include two additional lines\n&quot;</span></div>
<div class="line"><a name="l12562"></a><span class="lineno">12562</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;in the restart file: \n\n&quot;</span></div>
<div class="line"><a name="l12563"></a><span class="lineno">12563</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;0 # Number of base elements; partitioning follows.\n&quot;</span></div>
<div class="line"><a name="l12564"></a><span class="lineno">12564</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;8888 # Test flag for end of base element distribution\n&quot;</span></div>
<div class="line"><a name="l12565"></a><span class="lineno">12565</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l12566"></a><span class="lineno">12566</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;These lines go after the flag 9999 that indicates\n&quot;</span></div>
<div class="line"><a name="l12567"></a><span class="lineno">12567</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;the end of the submesh information.\n&quot;</span></div>
<div class="line"><a name="l12568"></a><span class="lineno">12568</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l12569"></a><span class="lineno">12569</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;The file will now continue to be read assuming that\n&quot;</span></div>
<div class="line"><a name="l12570"></a><span class="lineno">12570</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;the base element information is not present.\n&quot;</span></div>
<div class="line"><a name="l12571"></a><span class="lineno">12571</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;If you get strange results then please look carefully\n&quot;</span></div>
<div class="line"><a name="l12572"></a><span class="lineno">12572</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;at the restart file. The safest thing to do is to \n&quot;</span></div>
<div class="line"><a name="l12573"></a><span class="lineno">12573</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;ensure that the restart file was generated by code\n&quot;</span></div>
<div class="line"><a name="l12574"></a><span class="lineno">12574</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;compiled and run with the same parallel options.\n&quot;</span>;</div>
<div class="line"><a name="l12575"></a><span class="lineno">12575</span>&#160;          OomphLibWarning(warn_message.str(),</div>
<div class="line"><a name="l12576"></a><span class="lineno">12576</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l12577"></a><span class="lineno">12577</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l12578"></a><span class="lineno">12578</span>&#160;          <span class="comment">// Set the skip flag to true</span></div>
<div class="line"><a name="l12579"></a><span class="lineno">12579</span>&#160;          <span class="comment">// and rewind the file pointer</span></div>
<div class="line"><a name="l12580"></a><span class="lineno">12580</span>&#160;          read_in_base_element_info = <span class="keyword">false</span>;</div>
<div class="line"><a name="l12581"></a><span class="lineno">12581</span>&#160;          restart_file.seekg(position_before_base_element);</div>
<div class="line"><a name="l12582"></a><span class="lineno">12582</span>&#160;        }</div>
<div class="line"><a name="l12583"></a><span class="lineno">12583</span>&#160;        <span class="comment">// Otherwise throw a hard error</span></div>
<div class="line"><a name="l12584"></a><span class="lineno">12584</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l12585"></a><span class="lineno">12585</span>&#160;        {</div>
<div class="line"><a name="l12586"></a><span class="lineno">12586</span>&#160;          std::ostringstream error_message;</div>
<div class="line"><a name="l12587"></a><span class="lineno">12587</span>&#160;          error_message &lt;&lt; <span class="stringliteral">&quot;About to read &quot;</span> &lt;&lt; n_base_element_read_in</div>
<div class="line"><a name="l12588"></a><span class="lineno">12588</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot; base elements \n&quot;</span></div>
<div class="line"><a name="l12589"></a><span class="lineno">12589</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot;though we only have &quot;</span> &lt;&lt; nbase</div>
<div class="line"><a name="l12590"></a><span class="lineno">12590</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot; base elements in mesh.\n&quot;</span>;</div>
<div class="line"><a name="l12591"></a><span class="lineno">12591</span>&#160;          <span class="keywordflow">throw</span> OomphLibError(error_message.str(),</div>
<div class="line"><a name="l12592"></a><span class="lineno">12592</span>&#160;                              <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l12593"></a><span class="lineno">12593</span>&#160;                              <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l12594"></a><span class="lineno">12594</span>&#160;        }</div>
<div class="line"><a name="l12595"></a><span class="lineno">12595</span>&#160;      }</div>
<div class="line"><a name="l12596"></a><span class="lineno">12596</span>&#160;    }</div>
<div class="line"><a name="l12597"></a><span class="lineno">12597</span>&#160; </div>
<div class="line"><a name="l12598"></a><span class="lineno">12598</span>&#160;    <span class="comment">// Read in the remaning base element information, if necessary</span></div>
<div class="line"><a name="l12599"></a><span class="lineno">12599</span>&#160;    <span class="keywordflow">if</span> (read_in_base_element_info == <span class="keyword">true</span>)</div>
<div class="line"><a name="l12600"></a><span class="lineno">12600</span>&#160;    {</div>
<div class="line"><a name="l12601"></a><span class="lineno">12601</span>&#160;      <span class="comment">// Read in target_domain_for_base_element[e] for all base elements</span></div>
<div class="line"><a name="l12602"></a><span class="lineno">12602</span>&#160;      Vector&lt;unsigned&gt; target_domain_for_base_element(nbase);</div>
<div class="line"><a name="l12603"></a><span class="lineno">12603</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; nbase; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l12604"></a><span class="lineno">12604</span>&#160;      {</div>
<div class="line"><a name="l12605"></a><span class="lineno">12605</span>&#160;        <span class="comment">// Read line</span></div>
<div class="line"><a name="l12606"></a><span class="lineno">12606</span>&#160;        getline(restart_file, input_string);</div>
<div class="line"><a name="l12607"></a><span class="lineno">12607</span>&#160; </div>
<div class="line"><a name="l12608"></a><span class="lineno">12608</span>&#160;        <span class="comment">// Get target domain</span></div>
<div class="line"><a name="l12609"></a><span class="lineno">12609</span>&#160;        target_domain_for_base_element[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>] = atoi(input_string.c_str());</div>
<div class="line"><a name="l12610"></a><span class="lineno">12610</span>&#160;      }</div>
<div class="line"><a name="l12611"></a><span class="lineno">12611</span>&#160; </div>
<div class="line"><a name="l12612"></a><span class="lineno">12612</span>&#160;      <span class="comment">// Read line up to termination sign</span></div>
<div class="line"><a name="l12613"></a><span class="lineno">12613</span>&#160;      getline(restart_file, input_string, <span class="charliteral">&#39;#&#39;</span>);</div>
<div class="line"><a name="l12614"></a><span class="lineno">12614</span>&#160; </div>
<div class="line"><a name="l12615"></a><span class="lineno">12615</span>&#160;      <span class="comment">// Ignore rest of line</span></div>
<div class="line"><a name="l12616"></a><span class="lineno">12616</span>&#160;      restart_file.ignore(80, <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l12617"></a><span class="lineno">12617</span>&#160; </div>
<div class="line"><a name="l12618"></a><span class="lineno">12618</span>&#160;      <span class="comment">// Check flag that indicates that we&#39;ve read the final data</span></div>
<div class="line"><a name="l12619"></a><span class="lineno">12619</span>&#160;      <a class="code" href="../../da/d67/level3__impl_8h.html#a0ab86207641c152874beced8f77894d0">tmp</a> = std::atoi(input_string.c_str());</div>
<div class="line"><a name="l12620"></a><span class="lineno">12620</span>&#160; </div>
<div class="line"><a name="l12621"></a><span class="lineno">12621</span>&#160; </div>
<div class="line"><a name="l12622"></a><span class="lineno">12622</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l12623"></a><span class="lineno">12623</span>&#160;      <span class="keywordflow">if</span> (restart_file_is_open)</div>
<div class="line"><a name="l12624"></a><span class="lineno">12624</span>&#160;      {</div>
<div class="line"><a name="l12625"></a><span class="lineno">12625</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../da/d67/level3__impl_8h.html#a0ab86207641c152874beced8f77894d0">tmp</a> != 8888)</div>
<div class="line"><a name="l12626"></a><span class="lineno">12626</span>&#160;        {</div>
<div class="line"><a name="l12627"></a><span class="lineno">12627</span>&#160;          std::ostringstream error_message;</div>
<div class="line"><a name="l12628"></a><span class="lineno">12628</span>&#160;          error_message</div>
<div class="line"><a name="l12629"></a><span class="lineno">12629</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;Error in reading restart data: Target proc for base elements \n&quot;</span></div>
<div class="line"><a name="l12630"></a><span class="lineno">12630</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;should be followed by 8888.\n&quot;</span>;</div>
<div class="line"><a name="l12631"></a><span class="lineno">12631</span>&#160;          <span class="keywordflow">throw</span> OomphLibError(error_message.str(),</div>
<div class="line"><a name="l12632"></a><span class="lineno">12632</span>&#160;                              <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l12633"></a><span class="lineno">12633</span>&#160;                              <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l12634"></a><span class="lineno">12634</span>&#160;        }</div>
<div class="line"><a name="l12635"></a><span class="lineno">12635</span>&#160;      }</div>
<div class="line"><a name="l12636"></a><span class="lineno">12636</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l12637"></a><span class="lineno">12637</span>&#160; </div>
<div class="line"><a name="l12638"></a><span class="lineno">12638</span>&#160;      <span class="comment">// Loop over all elements (incl. any FaceElements) and assign</span></div>
<div class="line"><a name="l12639"></a><span class="lineno">12639</span>&#160;      <span class="comment">// target domain for all local non-halo elements and check if</span></div>
<div class="line"><a name="l12640"></a><span class="lineno">12640</span>&#160;      <span class="comment">// load balancing is required -- no need to do this if problem is</span></div>
<div class="line"><a name="l12641"></a><span class="lineno">12641</span>&#160;      <span class="comment">// not distributed.</span></div>
<div class="line"><a name="l12642"></a><span class="lineno">12642</span>&#160;      <span class="keywordtype">unsigned</span> load_balance_required_flag = 0;</div>
<div class="line"><a name="l12643"></a><span class="lineno">12643</span>&#160;      <span class="keywordflow">if</span> (Problem_has_been_distributed)</div>
<div class="line"><a name="l12644"></a><span class="lineno">12644</span>&#160;      {</div>
<div class="line"><a name="l12645"></a><span class="lineno">12645</span>&#160;        <span class="comment">// Working with TreeBasedRefineableMeshBase mesh</span></div>
<div class="line"><a name="l12646"></a><span class="lineno">12646</span>&#160;        <span class="keywordtype">unsigned</span> local_load_balance_required_flag = 0;</div>
<div class="line"><a name="l12647"></a><span class="lineno">12647</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">dynamic_cast&lt;</span>TreeBasedRefineableMeshBase*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(0)))</div>
<div class="line"><a name="l12648"></a><span class="lineno">12648</span>&#160;        {</div>
<div class="line"><a name="l12649"></a><span class="lineno">12649</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">int</span> my_rank = this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">communicator_pt</a>()-&gt;<a class="code" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a670b34aab05bfe0b96d0e0fabf583c7a">my_rank</a>();</div>
<div class="line"><a name="l12650"></a><span class="lineno">12650</span>&#160;          <span class="keywordtype">unsigned</span> nel = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>()-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">nelement</a>();</div>
<div class="line"><a name="l12651"></a><span class="lineno">12651</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; nel; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l12652"></a><span class="lineno">12652</span>&#160;          {</div>
<div class="line"><a name="l12653"></a><span class="lineno">12653</span>&#160;            GeneralisedElement* el_pt = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>()-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">element_pt</a>(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>);</div>
<div class="line"><a name="l12654"></a><span class="lineno">12654</span>&#160;            <span class="keywordflow">if</span> (!el_pt-&gt;is_halo())</div>
<div class="line"><a name="l12655"></a><span class="lineno">12655</span>&#160;            {</div>
<div class="line"><a name="l12656"></a><span class="lineno">12656</span>&#160;              <span class="comment">// Get element number (plus one) in base element enumeration</span></div>
<div class="line"><a name="l12657"></a><span class="lineno">12657</span>&#160;              <span class="keywordtype">unsigned</span> el_number_in_base_mesh_plus_one =</div>
<div class="line"><a name="l12658"></a><span class="lineno">12658</span>&#160;                Base_mesh_element_number_plus_one[el_pt];</div>
<div class="line"><a name="l12659"></a><span class="lineno">12659</span>&#160; </div>
<div class="line"><a name="l12660"></a><span class="lineno">12660</span>&#160;              <span class="comment">// If it&#39;s zero then we haven&#39;t found it, it may be a FaceElement</span></div>
<div class="line"><a name="l12661"></a><span class="lineno">12661</span>&#160;              <span class="comment">// (in which case we move it to the same processor as its bulk</span></div>
<div class="line"><a name="l12662"></a><span class="lineno">12662</span>&#160;              <span class="comment">// element</span></div>
<div class="line"><a name="l12663"></a><span class="lineno">12663</span>&#160;              <span class="keywordflow">if</span> (el_number_in_base_mesh_plus_one == 0)</div>
<div class="line"><a name="l12664"></a><span class="lineno">12664</span>&#160;              {</div>
<div class="line"><a name="l12665"></a><span class="lineno">12665</span>&#160;                FaceElement* face_el_pt = <span class="keyword">dynamic_cast&lt;</span>FaceElement*<span class="keyword">&gt;</span>(el_pt);</div>
<div class="line"><a name="l12666"></a><span class="lineno">12666</span>&#160;                <span class="keywordflow">if</span> (face_el_pt != 0)</div>
<div class="line"><a name="l12667"></a><span class="lineno">12667</span>&#160;                {</div>
<div class="line"><a name="l12668"></a><span class="lineno">12668</span>&#160;                  <span class="comment">// Get corresponding bulk element</span></div>
<div class="line"><a name="l12669"></a><span class="lineno">12669</span>&#160;                  FiniteElement* bulk_el_pt = face_el_pt-&gt;bulk_element_pt();</div>
<div class="line"><a name="l12670"></a><span class="lineno">12670</span>&#160; </div>
<div class="line"><a name="l12671"></a><span class="lineno">12671</span>&#160;                  <span class="comment">// Use its element number (plus one) in base element</span></div>
<div class="line"><a name="l12672"></a><span class="lineno">12672</span>&#160;                  <span class="comment">// enumeration</span></div>
<div class="line"><a name="l12673"></a><span class="lineno">12673</span>&#160;                  el_number_in_base_mesh_plus_one =</div>
<div class="line"><a name="l12674"></a><span class="lineno">12674</span>&#160;                    Base_mesh_element_number_plus_one[bulk_el_pt];</div>
<div class="line"><a name="l12675"></a><span class="lineno">12675</span>&#160; </div>
<div class="line"><a name="l12676"></a><span class="lineno">12676</span>&#160;                  <span class="comment">// If this is zero too we have a problem</span></div>
<div class="line"><a name="l12677"></a><span class="lineno">12677</span>&#160;                  <span class="keywordflow">if</span> (el_number_in_base_mesh_plus_one == 0)</div>
<div class="line"><a name="l12678"></a><span class="lineno">12678</span>&#160;                  {</div>
<div class="line"><a name="l12679"></a><span class="lineno">12679</span>&#160;                    <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l12680"></a><span class="lineno">12680</span>&#160;                      <span class="stringliteral">&quot;el_number_in_base_mesh_plus_one=0 for bulk&quot;</span>,</div>
<div class="line"><a name="l12681"></a><span class="lineno">12681</span>&#160;                      <span class="stringliteral">&quot;Problem::read()&quot;</span>,</div>
<div class="line"><a name="l12682"></a><span class="lineno">12682</span>&#160;                      <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l12683"></a><span class="lineno">12683</span>&#160;                  }</div>
<div class="line"><a name="l12684"></a><span class="lineno">12684</span>&#160;                }</div>
<div class="line"><a name="l12685"></a><span class="lineno">12685</span>&#160;              }</div>
<div class="line"><a name="l12686"></a><span class="lineno">12686</span>&#160; </div>
<div class="line"><a name="l12687"></a><span class="lineno">12687</span>&#160;              <span class="comment">// If we&#39;ve made it here then we&#39;re not dealing with a</span></div>
<div class="line"><a name="l12688"></a><span class="lineno">12688</span>&#160;              <span class="comment">// FaceElement but with an element that doesn&#39;t exist locally</span></div>
<div class="line"><a name="l12689"></a><span class="lineno">12689</span>&#160;              <span class="comment">// --&gt; WTF?</span></div>
<div class="line"><a name="l12690"></a><span class="lineno">12690</span>&#160;              <span class="keywordflow">if</span> (el_number_in_base_mesh_plus_one == 0)</div>
<div class="line"><a name="l12691"></a><span class="lineno">12691</span>&#160;              {</div>
<div class="line"><a name="l12692"></a><span class="lineno">12692</span>&#160;                <span class="keywordflow">throw</span> OomphLibError(<span class="stringliteral">&quot;el_number_in_base_mesh_plus_one=0&quot;</span>,</div>
<div class="line"><a name="l12693"></a><span class="lineno">12693</span>&#160;                                    <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l12694"></a><span class="lineno">12694</span>&#160;                                    <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l12695"></a><span class="lineno">12695</span>&#160;              }</div>
<div class="line"><a name="l12696"></a><span class="lineno">12696</span>&#160; </div>
<div class="line"><a name="l12697"></a><span class="lineno">12697</span>&#160;              <span class="comment">// Assign target domain for next local non-halo element in</span></div>
<div class="line"><a name="l12698"></a><span class="lineno">12698</span>&#160;              <span class="comment">// the order in which it&#39;s encountered in the global mesh</span></div>
<div class="line"><a name="l12699"></a><span class="lineno">12699</span>&#160;              target_domain_for_local_non_halo_element.push_back(</div>
<div class="line"><a name="l12700"></a><span class="lineno">12700</span>&#160;                target_domain_for_base_element[el_number_in_base_mesh_plus_one -</div>
<div class="line"><a name="l12701"></a><span class="lineno">12701</span>&#160;                                               1]);</div>
<div class="line"><a name="l12702"></a><span class="lineno">12702</span>&#160; </div>
<div class="line"><a name="l12703"></a><span class="lineno">12703</span>&#160;              <span class="comment">// Do elements on this processor to be moved elsewhere?</span></div>
<div class="line"><a name="l12704"></a><span class="lineno">12704</span>&#160;              <span class="keywordflow">if</span> (<span class="keywordtype">int</span>(target_domain_for_base_element</div>
<div class="line"><a name="l12705"></a><span class="lineno">12705</span>&#160;                        [el_number_in_base_mesh_plus_one - 1]) != my_rank)</div>
<div class="line"><a name="l12706"></a><span class="lineno">12706</span>&#160;              {</div>
<div class="line"><a name="l12707"></a><span class="lineno">12707</span>&#160;                local_load_balance_required_flag = 1;</div>
<div class="line"><a name="l12708"></a><span class="lineno">12708</span>&#160;              }</div>
<div class="line"><a name="l12709"></a><span class="lineno">12709</span>&#160;            }</div>
<div class="line"><a name="l12710"></a><span class="lineno">12710</span>&#160;          }</div>
<div class="line"><a name="l12711"></a><span class="lineno">12711</span>&#160; </div>
<div class="line"><a name="l12712"></a><span class="lineno">12712</span>&#160;        } <span class="comment">// if (working with TreeBasedRefineableMeshBase mesh)</span></div>
<div class="line"><a name="l12713"></a><span class="lineno">12713</span>&#160; </div>
<div class="line"><a name="l12714"></a><span class="lineno">12714</span>&#160;        <span class="comment">// Get overall need to load balance by max</span></div>
<div class="line"><a name="l12715"></a><span class="lineno">12715</span>&#160;        MPI_Allreduce(&amp;local_load_balance_required_flag,</div>
<div class="line"><a name="l12716"></a><span class="lineno">12716</span>&#160;                      &amp;load_balance_required_flag,</div>
<div class="line"><a name="l12717"></a><span class="lineno">12717</span>&#160;                      1,</div>
<div class="line"><a name="l12718"></a><span class="lineno">12718</span>&#160;                      MPI_UNSIGNED,</div>
<div class="line"><a name="l12719"></a><span class="lineno">12719</span>&#160;                      MPI_MAX,</div>
<div class="line"><a name="l12720"></a><span class="lineno">12720</span>&#160;                      this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">communicator_pt</a>()-&gt;mpi_comm());</div>
<div class="line"><a name="l12721"></a><span class="lineno">12721</span>&#160;      }</div>
<div class="line"><a name="l12722"></a><span class="lineno">12722</span>&#160; </div>
<div class="line"><a name="l12723"></a><span class="lineno">12723</span>&#160;      <span class="comment">// Do we need to load balance?</span></div>
<div class="line"><a name="l12724"></a><span class="lineno">12724</span>&#160;      <span class="keywordflow">if</span> (load_balance_required_flag == 1)</div>
<div class="line"><a name="l12725"></a><span class="lineno">12725</span>&#160;      {</div>
<div class="line"><a name="l12726"></a><span class="lineno">12726</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Doing load balancing after pruning\n&quot;</span>;</div>
<div class="line"><a name="l12727"></a><span class="lineno">12727</span>&#160;        DocInfo doc_info;</div>
<div class="line"><a name="l12728"></a><span class="lineno">12728</span>&#160;        doc_info.disable_doc();</div>
<div class="line"><a name="l12729"></a><span class="lineno">12729</span>&#160;        <span class="keywordtype">bool</span> report_stats = <span class="keyword">false</span>;</div>
<div class="line"><a name="l12730"></a><span class="lineno">12730</span>&#160;        load_balance(</div>
<div class="line"><a name="l12731"></a><span class="lineno">12731</span>&#160;          doc_info, report_stats, target_domain_for_local_non_halo_element);</div>
<div class="line"><a name="l12732"></a><span class="lineno">12732</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Done load balancing after pruning\n&quot;</span>;</div>
<div class="line"><a name="l12733"></a><span class="lineno">12733</span>&#160;      }</div>
<div class="line"><a name="l12734"></a><span class="lineno">12734</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l12735"></a><span class="lineno">12735</span>&#160;      {</div>
<div class="line"><a name="l12736"></a><span class="lineno">12736</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;No need for load balancing after pruning\n&quot;</span>;</div>
<div class="line"><a name="l12737"></a><span class="lineno">12737</span>&#160;      }</div>
<div class="line"><a name="l12738"></a><span class="lineno">12738</span>&#160;    } <span class="comment">// End of read in base element information</span></div>
<div class="line"><a name="l12739"></a><span class="lineno">12739</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l12740"></a><span class="lineno">12740</span>&#160; </div>
<div class="line"><a name="l12741"></a><span class="lineno">12741</span>&#160; </div>
<div class="line"><a name="l12742"></a><span class="lineno">12742</span>&#160;    <span class="comment">// Boolean to record if any unstructured bulk meshes have</span></div>
<div class="line"><a name="l12743"></a><span class="lineno">12743</span>&#160;    <span class="comment">// been read in (and therefore completely re-generated, with new</span></div>
<div class="line"><a name="l12744"></a><span class="lineno">12744</span>&#160;    <span class="comment">// elements and nodes) from disk</span></div>
<div class="line"><a name="l12745"></a><span class="lineno">12745</span>&#160;    <span class="keywordtype">bool</span> have_read_unstructured_mesh = <span class="keyword">false</span>;</div>
<div class="line"><a name="l12746"></a><span class="lineno">12746</span>&#160; </div>
<div class="line"><a name="l12747"></a><span class="lineno">12747</span>&#160;    <span class="comment">// Call the actions before adaptation</span></div>
<div class="line"><a name="l12748"></a><span class="lineno">12748</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">actions_before_adapt</a>();</div>
<div class="line"><a name="l12749"></a><span class="lineno">12749</span>&#160; </div>
<div class="line"><a name="l12750"></a><span class="lineno">12750</span>&#160;    <span class="comment">// If there are unstructured meshes in the problem we need</span></div>
<div class="line"><a name="l12751"></a><span class="lineno">12751</span>&#160;    <span class="comment">// to strip out any face elements that are attached to them</span></div>
<div class="line"><a name="l12752"></a><span class="lineno">12752</span>&#160;    <span class="comment">// because restart of unstructured meshes re-creates their elements</span></div>
<div class="line"><a name="l12753"></a><span class="lineno">12753</span>&#160;    <span class="comment">// and nodes from scratch, leading to dangling pointers from the</span></div>
<div class="line"><a name="l12754"></a><span class="lineno">12754</span>&#160;    <span class="comment">// face elements to the old elements and nodes. This function is</span></div>
<div class="line"><a name="l12755"></a><span class="lineno">12755</span>&#160;    <span class="comment">// virtual and (practically) empty in the Problem base class</span></div>
<div class="line"><a name="l12756"></a><span class="lineno">12756</span>&#160;    <span class="comment">// but toggles a flag to indicate that it has been called. We can then</span></div>
<div class="line"><a name="l12757"></a><span class="lineno">12757</span>&#160;    <span class="comment">// issue a warning below, prompting the user to consider overloading it</span></div>
<div class="line"><a name="l12758"></a><span class="lineno">12758</span>&#160;    <span class="comment">// if the problem is found to contain unstructured bulk meshes.</span></div>
<div class="line"><a name="l12759"></a><span class="lineno">12759</span>&#160;    <span class="comment">// Warning can be ignored if the bulk mesh is not associated with any</span></div>
<div class="line"><a name="l12760"></a><span class="lineno">12760</span>&#160;    <span class="comment">// face elements.</span></div>
<div class="line"><a name="l12761"></a><span class="lineno">12761</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a5f13ea67c29022392857b5c19bb3af71">Empty_actions_before_read_unstructured_meshes_has_been_called</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l12762"></a><span class="lineno">12762</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#af10662119a7a0c3a47879fa0d0644452">actions_before_read_unstructured_meshes</a>();</div>
<div class="line"><a name="l12763"></a><span class="lineno">12763</span>&#160; </div>
<div class="line"><a name="l12764"></a><span class="lineno">12764</span>&#160;    <span class="comment">// Update number of submeshes</span></div>
<div class="line"><a name="l12765"></a><span class="lineno">12765</span>&#160;    n_mesh = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>();</div>
<div class="line"><a name="l12766"></a><span class="lineno">12766</span>&#160; </div>
<div class="line"><a name="l12767"></a><span class="lineno">12767</span>&#160;    <span class="comment">// Single mesh:</span></div>
<div class="line"><a name="l12768"></a><span class="lineno">12768</span>&#160;    <span class="comment">//------------</span></div>
<div class="line"><a name="l12769"></a><span class="lineno">12769</span>&#160;    <span class="keywordflow">if</span> (n_mesh == 0)</div>
<div class="line"><a name="l12770"></a><span class="lineno">12770</span>&#160;    {</div>
<div class="line"><a name="l12771"></a><span class="lineno">12771</span>&#160;      <span class="comment">// Refine single mesh (if it&#39;s refineable)</span></div>
<div class="line"><a name="l12772"></a><span class="lineno">12772</span>&#160;      <span class="keywordflow">if</span> (TreeBasedRefineableMeshBase* mmesh_pt =</div>
<div class="line"><a name="l12773"></a><span class="lineno">12773</span>&#160;            <span class="keyword">dynamic_cast&lt;</span>TreeBasedRefineableMeshBase*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(0)))</div>
<div class="line"><a name="l12774"></a><span class="lineno">12774</span>&#160;      {</div>
<div class="line"><a name="l12775"></a><span class="lineno">12775</span>&#160;        <span class="comment">// When we get in here the problem has been constructed</span></div>
<div class="line"><a name="l12776"></a><span class="lineno">12776</span>&#160;        <span class="comment">// by the constructor and the mesh is its original unrefined</span></div>
<div class="line"><a name="l12777"></a><span class="lineno">12777</span>&#160;        <span class="comment">// form.</span></div>
<div class="line"><a name="l12778"></a><span class="lineno">12778</span>&#160;        <span class="comment">// RefineableMeshBase::refine(...) reads the refinement pattern from the</span></div>
<div class="line"><a name="l12779"></a><span class="lineno">12779</span>&#160;        <span class="comment">// specified file and performs refinements until the mesh has</span></div>
<div class="line"><a name="l12780"></a><span class="lineno">12780</span>&#160;        <span class="comment">// reached the same level of refinement as the mesh that existed</span></div>
<div class="line"><a name="l12781"></a><span class="lineno">12781</span>&#160;        <span class="comment">// when the problem was dumped to disk.</span></div>
<div class="line"><a name="l12782"></a><span class="lineno">12782</span>&#160;        mmesh_pt-&gt;refine(restart_file);</div>
<div class="line"><a name="l12783"></a><span class="lineno">12783</span>&#160;      }</div>
<div class="line"><a name="l12784"></a><span class="lineno">12784</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_TRIANGLE_LIB</span></div>
<div class="line"><a name="l12785"></a><span class="lineno">12785</span>&#160;      <span class="comment">// Regenerate mesh from triangulate IO if it&#39;s a triangular mesh</span></div>
<div class="line"><a name="l12786"></a><span class="lineno">12786</span>&#160;      TriangleMeshBase* mmesh_pt = <span class="keyword">dynamic_cast&lt;</span>TriangleMeshBase*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(0));</div>
<div class="line"><a name="l12787"></a><span class="lineno">12787</span>&#160;      <span class="keywordflow">if</span> (mmesh_pt != 0 &amp;&amp; mmesh_pt-&gt;use_triangulateio_restart())</div>
<div class="line"><a name="l12788"></a><span class="lineno">12788</span>&#160;      {</div>
<div class="line"><a name="l12789"></a><span class="lineno">12789</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l12790"></a><span class="lineno">12790</span>&#160;        <span class="comment">// Check if the mesh is distributed, if that is the case then</span></div>
<div class="line"><a name="l12791"></a><span class="lineno">12791</span>&#160;        <span class="comment">// additional info. needs to be read</span></div>
<div class="line"><a name="l12792"></a><span class="lineno">12792</span>&#160;        <span class="keywordflow">if</span> (mmesh_pt-&gt;is_mesh_distributed())</div>
<div class="line"><a name="l12793"></a><span class="lineno">12793</span>&#160;        {</div>
<div class="line"><a name="l12794"></a><span class="lineno">12794</span>&#160;          <span class="comment">// Dump the info. related with the distribution of the mesh</span></div>
<div class="line"><a name="l12795"></a><span class="lineno">12795</span>&#160;          mmesh_pt-&gt;read_distributed_info_for_restart(restart_file);</div>
<div class="line"><a name="l12796"></a><span class="lineno">12796</span>&#160;        }</div>
<div class="line"><a name="l12797"></a><span class="lineno">12797</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l12798"></a><span class="lineno">12798</span>&#160;        <span class="comment">// The function reads the TriangulateIO data structure from the dump</span></div>
<div class="line"><a name="l12799"></a><span class="lineno">12799</span>&#160;        <span class="comment">// file and then completely regenerates the mesh using the</span></div>
<div class="line"><a name="l12800"></a><span class="lineno">12800</span>&#160;        <span class="comment">// data structure</span></div>
<div class="line"><a name="l12801"></a><span class="lineno">12801</span>&#160;        mmesh_pt-&gt;remesh_from_triangulateio(restart_file);</div>
<div class="line"><a name="l12802"></a><span class="lineno">12802</span>&#160;        have_read_unstructured_mesh = <span class="keyword">true</span>;</div>
<div class="line"><a name="l12803"></a><span class="lineno">12803</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l12804"></a><span class="lineno">12804</span>&#160;        <span class="comment">// Check if the mesh is distributed, if that is the case then we</span></div>
<div class="line"><a name="l12805"></a><span class="lineno">12805</span>&#160;        <span class="comment">// need to re-establish the halo/haloed scheme (similar as in the</span></div>
<div class="line"><a name="l12806"></a><span class="lineno">12806</span>&#160;        <span class="comment">// RefineableTriangleMesh::adapt() method)</span></div>
<div class="line"><a name="l12807"></a><span class="lineno">12807</span>&#160;        <span class="keywordflow">if</span> (mmesh_pt-&gt;is_mesh_distributed())</div>
<div class="line"><a name="l12808"></a><span class="lineno">12808</span>&#160;        {</div>
<div class="line"><a name="l12809"></a><span class="lineno">12809</span>&#160;          mmesh_pt-&gt;reestablish_distribution_info_for_restart(</div>
<div class="line"><a name="l12810"></a><span class="lineno">12810</span>&#160;            this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">communicator_pt</a>(), restart_file);</div>
<div class="line"><a name="l12811"></a><span class="lineno">12811</span>&#160;        }</div>
<div class="line"><a name="l12812"></a><span class="lineno">12812</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l12813"></a><span class="lineno">12813</span>&#160;        <span class="comment">// Still left to update the polylines representation, that is performed</span></div>
<div class="line"><a name="l12814"></a><span class="lineno">12814</span>&#160;        <span class="comment">// later since the nodes positions may still change when reading info.</span></div>
<div class="line"><a name="l12815"></a><span class="lineno">12815</span>&#160;        <span class="comment">// for the mesh, see below</span></div>
<div class="line"><a name="l12816"></a><span class="lineno">12816</span>&#160;      }</div>
<div class="line"><a name="l12817"></a><span class="lineno">12817</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l12818"></a><span class="lineno">12818</span>&#160;    }</div>
<div class="line"><a name="l12819"></a><span class="lineno">12819</span>&#160; </div>
<div class="line"><a name="l12820"></a><span class="lineno">12820</span>&#160;    <span class="comment">// Multiple submeshes</span></div>
<div class="line"><a name="l12821"></a><span class="lineno">12821</span>&#160;    <span class="comment">//------------------</span></div>
<div class="line"><a name="l12822"></a><span class="lineno">12822</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l12823"></a><span class="lineno">12823</span>&#160;    {</div>
<div class="line"><a name="l12824"></a><span class="lineno">12824</span>&#160;      <span class="comment">// Loop over submeshes</span></div>
<div class="line"><a name="l12825"></a><span class="lineno">12825</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> imesh = 0; imesh &lt; n_mesh; imesh++)</div>
<div class="line"><a name="l12826"></a><span class="lineno">12826</span>&#160;      {</div>
<div class="line"><a name="l12827"></a><span class="lineno">12827</span>&#160;        <span class="comment">// Refine single mesh (if its refineable)</span></div>
<div class="line"><a name="l12828"></a><span class="lineno">12828</span>&#160;        <span class="keywordflow">if</span> (TreeBasedRefineableMeshBase* mmesh_pt =</div>
<div class="line"><a name="l12829"></a><span class="lineno">12829</span>&#160;              <span class="keyword">dynamic_cast&lt;</span>TreeBasedRefineableMeshBase*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(imesh)))</div>
<div class="line"><a name="l12830"></a><span class="lineno">12830</span>&#160;        {</div>
<div class="line"><a name="l12831"></a><span class="lineno">12831</span>&#160;          <span class="comment">// When we get in here the problem has been constructed</span></div>
<div class="line"><a name="l12832"></a><span class="lineno">12832</span>&#160;          <span class="comment">// by the constructor and the mesh is its original unrefined</span></div>
<div class="line"><a name="l12833"></a><span class="lineno">12833</span>&#160;          <span class="comment">// form.</span></div>
<div class="line"><a name="l12834"></a><span class="lineno">12834</span>&#160;          <span class="comment">// RefineableMeshBase::refine(...) reads the refinement pattern from</span></div>
<div class="line"><a name="l12835"></a><span class="lineno">12835</span>&#160;          <span class="comment">// the specified file and performs refinements until the mesh has</span></div>
<div class="line"><a name="l12836"></a><span class="lineno">12836</span>&#160;          <span class="comment">// reached the same level of refinement as the mesh that existed</span></div>
<div class="line"><a name="l12837"></a><span class="lineno">12837</span>&#160;          <span class="comment">// when the problem was dumped to disk.</span></div>
<div class="line"><a name="l12838"></a><span class="lineno">12838</span>&#160;          mmesh_pt-&gt;refine(restart_file);</div>
<div class="line"><a name="l12839"></a><span class="lineno">12839</span>&#160;        }</div>
<div class="line"><a name="l12840"></a><span class="lineno">12840</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_TRIANGLE_LIB</span></div>
<div class="line"><a name="l12841"></a><span class="lineno">12841</span>&#160;        <span class="comment">// Regenerate mesh from triangulate IO if it&#39;s a triangular mesh</span></div>
<div class="line"><a name="l12842"></a><span class="lineno">12842</span>&#160;        TriangleMeshBase* mmesh_pt =</div>
<div class="line"><a name="l12843"></a><span class="lineno">12843</span>&#160;          <span class="keyword">dynamic_cast&lt;</span>TriangleMeshBase*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(imesh));</div>
<div class="line"><a name="l12844"></a><span class="lineno">12844</span>&#160;        <span class="keywordflow">if</span> (mmesh_pt != 0 &amp;&amp; mmesh_pt-&gt;use_triangulateio_restart())</div>
<div class="line"><a name="l12845"></a><span class="lineno">12845</span>&#160;        {</div>
<div class="line"><a name="l12846"></a><span class="lineno">12846</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l12847"></a><span class="lineno">12847</span>&#160;          <span class="comment">// Check if the mesh is distributed, if that is the case then</span></div>
<div class="line"><a name="l12848"></a><span class="lineno">12848</span>&#160;          <span class="comment">// additional info. needs to be read</span></div>
<div class="line"><a name="l12849"></a><span class="lineno">12849</span>&#160;          <span class="keywordflow">if</span> (mmesh_pt-&gt;is_mesh_distributed())</div>
<div class="line"><a name="l12850"></a><span class="lineno">12850</span>&#160;          {</div>
<div class="line"><a name="l12851"></a><span class="lineno">12851</span>&#160;            <span class="comment">// Dump the info. related with the distribution of the mesh</span></div>
<div class="line"><a name="l12852"></a><span class="lineno">12852</span>&#160;            mmesh_pt-&gt;read_distributed_info_for_restart(restart_file);</div>
<div class="line"><a name="l12853"></a><span class="lineno">12853</span>&#160;          }</div>
<div class="line"><a name="l12854"></a><span class="lineno">12854</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l12855"></a><span class="lineno">12855</span>&#160;          <span class="comment">// The function reads the TriangulateIO data structure from the dump</span></div>
<div class="line"><a name="l12856"></a><span class="lineno">12856</span>&#160;          <span class="comment">// file and then completely regenerates the mesh using the</span></div>
<div class="line"><a name="l12857"></a><span class="lineno">12857</span>&#160;          <span class="comment">// data structure</span></div>
<div class="line"><a name="l12858"></a><span class="lineno">12858</span>&#160;          mmesh_pt-&gt;remesh_from_triangulateio(restart_file);</div>
<div class="line"><a name="l12859"></a><span class="lineno">12859</span>&#160;          have_read_unstructured_mesh = <span class="keyword">true</span>;</div>
<div class="line"><a name="l12860"></a><span class="lineno">12860</span>&#160; </div>
<div class="line"><a name="l12861"></a><span class="lineno">12861</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l12862"></a><span class="lineno">12862</span>&#160;          <span class="comment">// Check if the mesh is distributed, if that is the case then we</span></div>
<div class="line"><a name="l12863"></a><span class="lineno">12863</span>&#160;          <span class="comment">// need to re-establish the halo/haloed scheme (similar as in the</span></div>
<div class="line"><a name="l12864"></a><span class="lineno">12864</span>&#160;          <span class="comment">// RefineableTriangleMesh::adapt() method)</span></div>
<div class="line"><a name="l12865"></a><span class="lineno">12865</span>&#160;          <span class="keywordflow">if</span> (mmesh_pt-&gt;is_mesh_distributed())</div>
<div class="line"><a name="l12866"></a><span class="lineno">12866</span>&#160;          {</div>
<div class="line"><a name="l12867"></a><span class="lineno">12867</span>&#160;            mmesh_pt-&gt;reestablish_distribution_info_for_restart(</div>
<div class="line"><a name="l12868"></a><span class="lineno">12868</span>&#160;              this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">communicator_pt</a>(), restart_file);</div>
<div class="line"><a name="l12869"></a><span class="lineno">12869</span>&#160;          }</div>
<div class="line"><a name="l12870"></a><span class="lineno">12870</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l12871"></a><span class="lineno">12871</span>&#160;          <span class="comment">// Still left to update the polylines representation, that is</span></div>
<div class="line"><a name="l12872"></a><span class="lineno">12872</span>&#160;          <span class="comment">// performed later since the nodes positions may still change when</span></div>
<div class="line"><a name="l12873"></a><span class="lineno">12873</span>&#160;          <span class="comment">// reading info. for the mesh, see below</span></div>
<div class="line"><a name="l12874"></a><span class="lineno">12874</span>&#160;        }</div>
<div class="line"><a name="l12875"></a><span class="lineno">12875</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l12876"></a><span class="lineno">12876</span>&#160;      } <span class="comment">// End of loop over submeshes</span></div>
<div class="line"><a name="l12877"></a><span class="lineno">12877</span>&#160; </div>
<div class="line"><a name="l12878"></a><span class="lineno">12878</span>&#160; </div>
<div class="line"><a name="l12879"></a><span class="lineno">12879</span>&#160;      <span class="comment">// Rebuild the global mesh</span></div>
<div class="line"><a name="l12880"></a><span class="lineno">12880</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a266d4d1b2bd4a5cbc028ff5aba79508f">rebuild_global_mesh</a>();</div>
<div class="line"><a name="l12881"></a><span class="lineno">12881</span>&#160;    }</div>
<div class="line"><a name="l12882"></a><span class="lineno">12882</span>&#160; </div>
<div class="line"><a name="l12883"></a><span class="lineno">12883</span>&#160;    <span class="comment">// Any actions after adapt</span></div>
<div class="line"><a name="l12884"></a><span class="lineno">12884</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">actions_after_adapt</a>();</div>
<div class="line"><a name="l12885"></a><span class="lineno">12885</span>&#160; </div>
<div class="line"><a name="l12886"></a><span class="lineno">12886</span>&#160;    <span class="comment">// Re-attach face elements (or whatever else needs to be done</span></div>
<div class="line"><a name="l12887"></a><span class="lineno">12887</span>&#160;    <span class="comment">// following the total re-generation of the unstructured meshes</span></div>
<div class="line"><a name="l12888"></a><span class="lineno">12888</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a71f87e46a571a54abd27a26f6c701c36">Empty_actions_after_read_unstructured_meshes_has_been_called</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l12889"></a><span class="lineno">12889</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a498317b3e390eddf2169ab989ee8d6b4">actions_after_read_unstructured_meshes</a>();</div>
<div class="line"><a name="l12890"></a><span class="lineno">12890</span>&#160; </div>
<div class="line"><a name="l12891"></a><span class="lineno">12891</span>&#160; </div>
<div class="line"><a name="l12892"></a><span class="lineno">12892</span>&#160;    <span class="comment">// Issue warning:</span></div>
<div class="line"><a name="l12893"></a><span class="lineno">12893</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a36b11f7bc1b7b9413ee4a78eab536df8">Suppress_warning_about_actions_before_read_unstructured_meshes</a>)</div>
<div class="line"><a name="l12894"></a><span class="lineno">12894</span>&#160;    {</div>
<div class="line"><a name="l12895"></a><span class="lineno">12895</span>&#160;      <span class="keywordflow">if</span> (have_read_unstructured_mesh)</div>
<div class="line"><a name="l12896"></a><span class="lineno">12896</span>&#160;      {</div>
<div class="line"><a name="l12897"></a><span class="lineno">12897</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a5f13ea67c29022392857b5c19bb3af71">Empty_actions_before_read_unstructured_meshes_has_been_called</a> ||</div>
<div class="line"><a name="l12898"></a><span class="lineno">12898</span>&#160;            <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a71f87e46a571a54abd27a26f6c701c36">Empty_actions_after_read_unstructured_meshes_has_been_called</a>)</div>
<div class="line"><a name="l12899"></a><span class="lineno">12899</span>&#160;        {</div>
<div class="line"><a name="l12900"></a><span class="lineno">12900</span>&#160;          std::ostringstream warn_message;</div>
<div class="line"><a name="l12901"></a><span class="lineno">12901</span>&#160;          warn_message</div>
<div class="line"><a name="l12902"></a><span class="lineno">12902</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;I&#39;ve just read in some unstructured meshes and have, in\n&quot;</span></div>
<div class="line"><a name="l12903"></a><span class="lineno">12903</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;the process, totally re-generated their nodes and elements.\n&quot;</span></div>
<div class="line"><a name="l12904"></a><span class="lineno">12904</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;This may create dangling pointers that still point to the\n&quot;</span></div>
<div class="line"><a name="l12905"></a><span class="lineno">12905</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;old nodes and elements, e.g. because FaceElements were\n&quot;</span></div>
<div class="line"><a name="l12906"></a><span class="lineno">12906</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;attached to these meshes or pointers to nodes and elements\n&quot;</span></div>
<div class="line"><a name="l12907"></a><span class="lineno">12907</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;were stored somewhere. FaceElements should therefore be\n&quot;</span></div>
<div class="line"><a name="l12908"></a><span class="lineno">12908</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;removed before reading in these meshes, using an overloaded\n&quot;</span></div>
<div class="line"><a name="l12909"></a><span class="lineno">12909</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;version of the function\n\n&quot;</span></div>
<div class="line"><a name="l12910"></a><span class="lineno">12910</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;   Problem::actions_before_read_unstructured_meshes()\n\n&quot;</span></div>
<div class="line"><a name="l12911"></a><span class="lineno">12911</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;and then re-attached using an overloaded version of\n\n&quot;</span></div>
<div class="line"><a name="l12912"></a><span class="lineno">12912</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;   Problem::actions_after_read_unstructured_meshes().\n\n&quot;</span></div>
<div class="line"><a name="l12913"></a><span class="lineno">12913</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;The required content of these functions is likely to be &quot;</span></div>
<div class="line"><a name="l12914"></a><span class="lineno">12914</span>&#160;               <span class="stringliteral">&quot;similar\n&quot;</span></div>
<div class="line"><a name="l12915"></a><span class="lineno">12915</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;to the Problem::actions_before_adapt() and \n&quot;</span></div>
<div class="line"><a name="l12916"></a><span class="lineno">12916</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;Problem::actions_after_adapt() that would be required in\n&quot;</span></div>
<div class="line"><a name="l12917"></a><span class="lineno">12917</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;a spatially adaptive computation. If these functions already\n&quot;</span></div>
<div class="line"><a name="l12918"></a><span class="lineno">12918</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;exist and perform the required actions, the \n&quot;</span></div>
<div class="line"><a name="l12919"></a><span class="lineno">12919</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;actions_before/after_read_unstructured_meshes() functions\n&quot;</span></div>
<div class="line"><a name="l12920"></a><span class="lineno">12920</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;can remain empty because the former are called automatically.\n&quot;</span></div>
<div class="line"><a name="l12921"></a><span class="lineno">12921</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;In this case, this warning my be suppressed by setting the\n&quot;</span></div>
<div class="line"><a name="l12922"></a><span class="lineno">12922</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;public boolean\n\n&quot;</span></div>
<div class="line"><a name="l12923"></a><span class="lineno">12923</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;   &quot;</span></div>
<div class="line"><a name="l12924"></a><span class="lineno">12924</span>&#160;               <span class="stringliteral">&quot;Problem::Suppress_warning_about_actions_before_read_&quot;</span></div>
<div class="line"><a name="l12925"></a><span class="lineno">12925</span>&#160;               <span class="stringliteral">&quot;unstructured_meshes\n\n&quot;</span></div>
<div class="line"><a name="l12926"></a><span class="lineno">12926</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;to true.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l12927"></a><span class="lineno">12927</span>&#160;          OomphLibWarning(warn_message.str(),</div>
<div class="line"><a name="l12928"></a><span class="lineno">12928</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l12929"></a><span class="lineno">12929</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l12930"></a><span class="lineno">12930</span>&#160;        }</div>
<div class="line"><a name="l12931"></a><span class="lineno">12931</span>&#160;      }</div>
<div class="line"><a name="l12932"></a><span class="lineno">12932</span>&#160;    }</div>
<div class="line"><a name="l12933"></a><span class="lineno">12933</span>&#160; </div>
<div class="line"><a name="l12934"></a><span class="lineno">12934</span>&#160;    <span class="comment">// Setup equation numbering scheme</span></div>
<div class="line"><a name="l12935"></a><span class="lineno">12935</span>&#160;    <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;\nNumber of equations in Problem::read(): &quot;</span></div>
<div class="line"><a name="l12936"></a><span class="lineno">12936</span>&#160;               &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers</a>() &lt;&lt; std::endl</div>
<div class="line"><a name="l12937"></a><span class="lineno">12937</span>&#160;               &lt;&lt; std::endl;</div>
<div class="line"><a name="l12938"></a><span class="lineno">12938</span>&#160;    <span class="comment">// Read time info</span></div>
<div class="line"><a name="l12939"></a><span class="lineno">12939</span>&#160;    <span class="comment">//---------------</span></div>
<div class="line"><a name="l12940"></a><span class="lineno">12940</span>&#160;    <span class="keywordtype">unsigned</span> local_unsteady_restart_flag = 0;</div>
<div class="line"><a name="l12941"></a><span class="lineno">12941</span>&#160;    <span class="keywordtype">double</span> local_time = -DBL_MAX;</div>
<div class="line"><a name="l12942"></a><span class="lineno">12942</span>&#160;    <span class="keywordtype">unsigned</span> local_n_dt = 0;</div>
<div class="line"><a name="l12943"></a><span class="lineno">12943</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l12944"></a><span class="lineno">12944</span>&#160;    <span class="keywordtype">unsigned</span> local_sync_needed_flag = 0;</div>
<div class="line"><a name="l12945"></a><span class="lineno">12945</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l12946"></a><span class="lineno">12946</span>&#160;    Vector&lt;double&gt; local_dt;</div>
<div class="line"><a name="l12947"></a><span class="lineno">12947</span>&#160; </div>
<div class="line"><a name="l12948"></a><span class="lineno">12948</span>&#160;    <span class="keywordflow">if</span> (restart_file.is_open())</div>
<div class="line"><a name="l12949"></a><span class="lineno">12949</span>&#160;    {</div>
<div class="line"><a name="l12950"></a><span class="lineno">12950</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Restart file exists&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l12951"></a><span class="lineno">12951</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l12952"></a><span class="lineno">12952</span>&#160;      local_sync_needed_flag = 0;</div>
<div class="line"><a name="l12953"></a><span class="lineno">12953</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l12954"></a><span class="lineno">12954</span>&#160;      <span class="comment">// Read line up to termination sign</span></div>
<div class="line"><a name="l12955"></a><span class="lineno">12955</span>&#160;      getline(restart_file, input_string, <span class="charliteral">&#39;#&#39;</span>);</div>
<div class="line"><a name="l12956"></a><span class="lineno">12956</span>&#160; </div>
<div class="line"><a name="l12957"></a><span class="lineno">12957</span>&#160;      <span class="comment">// Ignore rest of line</span></div>
<div class="line"><a name="l12958"></a><span class="lineno">12958</span>&#160;      restart_file.ignore(80, <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l12959"></a><span class="lineno">12959</span>&#160; </div>
<div class="line"><a name="l12960"></a><span class="lineno">12960</span>&#160;      <span class="comment">// Is the restart data from an unsteady run?</span></div>
<div class="line"><a name="l12961"></a><span class="lineno">12961</span>&#160;      local_unsteady_restart_flag = atoi(input_string.c_str());</div>
<div class="line"><a name="l12962"></a><span class="lineno">12962</span>&#160; </div>
<div class="line"><a name="l12963"></a><span class="lineno">12963</span>&#160;      <span class="comment">// Read line up to termination sign</span></div>
<div class="line"><a name="l12964"></a><span class="lineno">12964</span>&#160;      getline(restart_file, input_string, <span class="charliteral">&#39;#&#39;</span>);</div>
<div class="line"><a name="l12965"></a><span class="lineno">12965</span>&#160; </div>
<div class="line"><a name="l12966"></a><span class="lineno">12966</span>&#160;      <span class="comment">// Ignore rest of line</span></div>
<div class="line"><a name="l12967"></a><span class="lineno">12967</span>&#160;      restart_file.ignore(80, <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l12968"></a><span class="lineno">12968</span>&#160; </div>
<div class="line"><a name="l12969"></a><span class="lineno">12969</span>&#160;      <span class="comment">// Read in initial time and set</span></div>
<div class="line"><a name="l12970"></a><span class="lineno">12970</span>&#160;      local_time = atof(input_string.c_str());</div>
<div class="line"><a name="l12971"></a><span class="lineno">12971</span>&#160; </div>
<div class="line"><a name="l12972"></a><span class="lineno">12972</span>&#160;      <span class="comment">// Read line up to termination sign</span></div>
<div class="line"><a name="l12973"></a><span class="lineno">12973</span>&#160;      getline(restart_file, input_string, <span class="charliteral">&#39;#&#39;</span>);</div>
<div class="line"><a name="l12974"></a><span class="lineno">12974</span>&#160; </div>
<div class="line"><a name="l12975"></a><span class="lineno">12975</span>&#160;      <span class="comment">// Ignore rest of line</span></div>
<div class="line"><a name="l12976"></a><span class="lineno">12976</span>&#160;      restart_file.ignore(80, <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l12977"></a><span class="lineno">12977</span>&#160; </div>
<div class="line"><a name="l12978"></a><span class="lineno">12978</span>&#160;      <span class="comment">// Read &amp; set number of timesteps</span></div>
<div class="line"><a name="l12979"></a><span class="lineno">12979</span>&#160;      local_n_dt = atoi(input_string.c_str());</div>
<div class="line"><a name="l12980"></a><span class="lineno">12980</span>&#160;      local_dt.resize(local_n_dt);</div>
<div class="line"><a name="l12981"></a><span class="lineno">12981</span>&#160; </div>
<div class="line"><a name="l12982"></a><span class="lineno">12982</span>&#160;      <span class="comment">// Read in timesteps:</span></div>
<div class="line"><a name="l12983"></a><span class="lineno">12983</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; local_n_dt; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l12984"></a><span class="lineno">12984</span>&#160;      {</div>
<div class="line"><a name="l12985"></a><span class="lineno">12985</span>&#160;        <span class="comment">// Read line up to termination sign</span></div>
<div class="line"><a name="l12986"></a><span class="lineno">12986</span>&#160;        getline(restart_file, input_string, <span class="charliteral">&#39;#&#39;</span>);</div>
<div class="line"><a name="l12987"></a><span class="lineno">12987</span>&#160; </div>
<div class="line"><a name="l12988"></a><span class="lineno">12988</span>&#160;        <span class="comment">// Ignore rest of line</span></div>
<div class="line"><a name="l12989"></a><span class="lineno">12989</span>&#160;        restart_file.ignore(80, <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l12990"></a><span class="lineno">12990</span>&#160; </div>
<div class="line"><a name="l12991"></a><span class="lineno">12991</span>&#160;        <span class="comment">// Read in initial time and set</span></div>
<div class="line"><a name="l12992"></a><span class="lineno">12992</span>&#160;        <span class="keywordtype">double</span> prev_dt = atof(input_string.c_str());</div>
<div class="line"><a name="l12993"></a><span class="lineno">12993</span>&#160;        local_dt[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = prev_dt;</div>
<div class="line"><a name="l12994"></a><span class="lineno">12994</span>&#160;      }</div>
<div class="line"><a name="l12995"></a><span class="lineno">12995</span>&#160;    }</div>
<div class="line"><a name="l12996"></a><span class="lineno">12996</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l12997"></a><span class="lineno">12997</span>&#160;    {</div>
<div class="line"><a name="l12998"></a><span class="lineno">12998</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Restart file does not exist&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l12999"></a><span class="lineno">12999</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l13000"></a><span class="lineno">13000</span>&#160;      local_sync_needed_flag = 1;</div>
<div class="line"><a name="l13001"></a><span class="lineno">13001</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l13002"></a><span class="lineno">13002</span>&#160;    }</div>
<div class="line"><a name="l13003"></a><span class="lineno">13003</span>&#160; </div>
<div class="line"><a name="l13004"></a><span class="lineno">13004</span>&#160; </div>
<div class="line"><a name="l13005"></a><span class="lineno">13005</span>&#160;    <span class="comment">// No prepare global values, possibly via sync</span></div>
<div class="line"><a name="l13006"></a><span class="lineno">13006</span>&#160;    Vector&lt;double&gt; dt;</div>
<div class="line"><a name="l13007"></a><span class="lineno">13007</span>&#160; </div>
<div class="line"><a name="l13008"></a><span class="lineno">13008</span>&#160;    <span class="comment">// Do we need to sync?</span></div>
<div class="line"><a name="l13009"></a><span class="lineno">13009</span>&#160;    <span class="keywordtype">unsigned</span> sync_needed_flag = 0;</div>
<div class="line"><a name="l13010"></a><span class="lineno">13010</span>&#160; </div>
<div class="line"><a name="l13011"></a><span class="lineno">13011</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l13012"></a><span class="lineno">13012</span>&#160;    <span class="keywordflow">if</span> (Problem_has_been_distributed)</div>
<div class="line"><a name="l13013"></a><span class="lineno">13013</span>&#160;    {</div>
<div class="line"><a name="l13014"></a><span class="lineno">13014</span>&#160;      <span class="comment">// Get need to sync by max</span></div>
<div class="line"><a name="l13015"></a><span class="lineno">13015</span>&#160;      MPI_Allreduce(&amp;local_sync_needed_flag,</div>
<div class="line"><a name="l13016"></a><span class="lineno">13016</span>&#160;                    &amp;sync_needed_flag,</div>
<div class="line"><a name="l13017"></a><span class="lineno">13017</span>&#160;                    1,</div>
<div class="line"><a name="l13018"></a><span class="lineno">13018</span>&#160;                    MPI_UNSIGNED,</div>
<div class="line"><a name="l13019"></a><span class="lineno">13019</span>&#160;                    MPI_MAX,</div>
<div class="line"><a name="l13020"></a><span class="lineno">13020</span>&#160;                    this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">communicator_pt</a>()-&gt;mpi_comm());</div>
<div class="line"><a name="l13021"></a><span class="lineno">13021</span>&#160;    }</div>
<div class="line"><a name="l13022"></a><span class="lineno">13022</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l13023"></a><span class="lineno">13023</span>&#160; </div>
<div class="line"><a name="l13024"></a><span class="lineno">13024</span>&#160;    <span class="comment">// Synchronise</span></div>
<div class="line"><a name="l13025"></a><span class="lineno">13025</span>&#160;    <span class="keywordflow">if</span> (sync_needed_flag == 1)</div>
<div class="line"><a name="l13026"></a><span class="lineno">13026</span>&#160;    {</div>
<div class="line"><a name="l13027"></a><span class="lineno">13027</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l13028"></a><span class="lineno">13028</span>&#160; </div>
<div class="line"><a name="l13029"></a><span class="lineno">13029</span>&#160; </div>
<div class="line"><a name="l13030"></a><span class="lineno">13030</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l13031"></a><span class="lineno">13031</span>&#160;      <span class="keywordflow">if</span> (!Problem_has_been_distributed)</div>
<div class="line"><a name="l13032"></a><span class="lineno">13032</span>&#160;      {</div>
<div class="line"><a name="l13033"></a><span class="lineno">13033</span>&#160;        std::ostringstream error_message;</div>
<div class="line"><a name="l13034"></a><span class="lineno">13034</span>&#160;        error_message &lt;&lt; <span class="stringliteral">&quot;Synchronisation of temporal restart data \n&quot;</span></div>
<div class="line"><a name="l13035"></a><span class="lineno">13035</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;required even though Problem hasn&#39;t been distributed &quot;</span></div>
<div class="line"><a name="l13036"></a><span class="lineno">13036</span>&#160;                         <span class="stringliteral">&quot;-- very odd!\n&quot;</span>;</div>
<div class="line"><a name="l13037"></a><span class="lineno">13037</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(error_message.str(),</div>
<div class="line"><a name="l13038"></a><span class="lineno">13038</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l13039"></a><span class="lineno">13039</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l13040"></a><span class="lineno">13040</span>&#160;      }</div>
<div class="line"><a name="l13041"></a><span class="lineno">13041</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l13042"></a><span class="lineno">13042</span>&#160; </div>
<div class="line"><a name="l13043"></a><span class="lineno">13043</span>&#160;      <span class="comment">// Get unsteady restart flag by max-based reduction</span></div>
<div class="line"><a name="l13044"></a><span class="lineno">13044</span>&#160;      <span class="keywordtype">unsigned</span> unsteady_restart_flag = 0;</div>
<div class="line"><a name="l13045"></a><span class="lineno">13045</span>&#160;      MPI_Allreduce(&amp;local_unsteady_restart_flag,</div>
<div class="line"><a name="l13046"></a><span class="lineno">13046</span>&#160;                    &amp;unsteady_restart_flag,</div>
<div class="line"><a name="l13047"></a><span class="lineno">13047</span>&#160;                    1,</div>
<div class="line"><a name="l13048"></a><span class="lineno">13048</span>&#160;                    MPI_UNSIGNED,</div>
<div class="line"><a name="l13049"></a><span class="lineno">13049</span>&#160;                    MPI_MAX,</div>
<div class="line"><a name="l13050"></a><span class="lineno">13050</span>&#160;                    this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">communicator_pt</a>()-&gt;mpi_comm());</div>
<div class="line"><a name="l13051"></a><span class="lineno">13051</span>&#160; </div>
<div class="line"><a name="l13052"></a><span class="lineno">13052</span>&#160;      <span class="comment">// So, is it an unsteady restart?</span></div>
<div class="line"><a name="l13053"></a><span class="lineno">13053</span>&#160;      unsteady_restart = <span class="keyword">false</span>;</div>
<div class="line"><a name="l13054"></a><span class="lineno">13054</span>&#160;      <span class="keywordflow">if</span> (unsteady_restart_flag == 1)</div>
<div class="line"><a name="l13055"></a><span class="lineno">13055</span>&#160;      {</div>
<div class="line"><a name="l13056"></a><span class="lineno">13056</span>&#160;        unsteady_restart = <span class="keyword">true</span>;</div>
<div class="line"><a name="l13057"></a><span class="lineno">13057</span>&#160; </div>
<div class="line"><a name="l13058"></a><span class="lineno">13058</span>&#160;        <span class="comment">// Get time by max</span></div>
<div class="line"><a name="l13059"></a><span class="lineno">13059</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#affda31840308a51d36324e6debe1bee7">time</a> = -DBL_MAX;</div>
<div class="line"><a name="l13060"></a><span class="lineno">13060</span>&#160;        MPI_Allreduce(&amp;local_time,</div>
<div class="line"><a name="l13061"></a><span class="lineno">13061</span>&#160;                      &amp;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#affda31840308a51d36324e6debe1bee7">time</a>,</div>
<div class="line"><a name="l13062"></a><span class="lineno">13062</span>&#160;                      1,</div>
<div class="line"><a name="l13063"></a><span class="lineno">13063</span>&#160;                      MPI_DOUBLE,</div>
<div class="line"><a name="l13064"></a><span class="lineno">13064</span>&#160;                      MPI_MAX,</div>
<div class="line"><a name="l13065"></a><span class="lineno">13065</span>&#160;                      this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">communicator_pt</a>()-&gt;mpi_comm());</div>
<div class="line"><a name="l13066"></a><span class="lineno">13066</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a46894b13c582f322082dc471a2485980">time_pt</a>()-&gt;<a class="code" href="../../d0/da1/classoomph_1_1Time.html#a6e28ea7a6664a2f5f5e1be871304a2c7">time</a>() = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#affda31840308a51d36324e6debe1bee7">time</a>;</div>
<div class="line"><a name="l13067"></a><span class="lineno">13067</span>&#160; </div>
<div class="line"><a name="l13068"></a><span class="lineno">13068</span>&#160;        <span class="comment">// Get number of timesteps by max-based reduction</span></div>
<div class="line"><a name="l13069"></a><span class="lineno">13069</span>&#160;        <span class="keywordtype">unsigned</span> n_dt = 0;</div>
<div class="line"><a name="l13070"></a><span class="lineno">13070</span>&#160;        MPI_Allreduce(&amp;local_n_dt,</div>
<div class="line"><a name="l13071"></a><span class="lineno">13071</span>&#160;                      &amp;n_dt,</div>
<div class="line"><a name="l13072"></a><span class="lineno">13072</span>&#160;                      1,</div>
<div class="line"><a name="l13073"></a><span class="lineno">13073</span>&#160;                      MPI_UNSIGNED,</div>
<div class="line"><a name="l13074"></a><span class="lineno">13074</span>&#160;                      MPI_MAX,</div>
<div class="line"><a name="l13075"></a><span class="lineno">13075</span>&#160;                      this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">communicator_pt</a>()-&gt;mpi_comm());</div>
<div class="line"><a name="l13076"></a><span class="lineno">13076</span>&#160; </div>
<div class="line"><a name="l13077"></a><span class="lineno">13077</span>&#160;        <span class="comment">// Resize whatever needs resizing</span></div>
<div class="line"><a name="l13078"></a><span class="lineno">13078</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a46894b13c582f322082dc471a2485980">time_pt</a>()-&gt;<a class="code" href="../../d0/da1/classoomph_1_1Time.html#aeab1acb1e182797c4194af84c0583c3f">resize</a>(n_dt);</div>
<div class="line"><a name="l13079"></a><span class="lineno">13079</span>&#160;        dt.resize(n_dt);</div>
<div class="line"><a name="l13080"></a><span class="lineno">13080</span>&#160;        <span class="keywordflow">if</span> (local_dt.size() == 0)</div>
<div class="line"><a name="l13081"></a><span class="lineno">13081</span>&#160;        {</div>
<div class="line"><a name="l13082"></a><span class="lineno">13082</span>&#160;          local_dt.resize(n_dt, -DBL_MAX);</div>
<div class="line"><a name="l13083"></a><span class="lineno">13083</span>&#160;        }</div>
<div class="line"><a name="l13084"></a><span class="lineno">13084</span>&#160; </div>
<div class="line"><a name="l13085"></a><span class="lineno">13085</span>&#160;        <span class="comment">// Get timesteps increments by max-based reduction</span></div>
<div class="line"><a name="l13086"></a><span class="lineno">13086</span>&#160;        MPI_Allreduce(&amp;local_dt[0],</div>
<div class="line"><a name="l13087"></a><span class="lineno">13087</span>&#160;                      &amp;dt[0],</div>
<div class="line"><a name="l13088"></a><span class="lineno">13088</span>&#160;                      n_dt,</div>
<div class="line"><a name="l13089"></a><span class="lineno">13089</span>&#160;                      MPI_DOUBLE,</div>
<div class="line"><a name="l13090"></a><span class="lineno">13090</span>&#160;                      MPI_MAX,</div>
<div class="line"><a name="l13091"></a><span class="lineno">13091</span>&#160;                      this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">communicator_pt</a>()-&gt;mpi_comm());</div>
<div class="line"><a name="l13092"></a><span class="lineno">13092</span>&#160;      }</div>
<div class="line"><a name="l13093"></a><span class="lineno">13093</span>&#160; </div>
<div class="line"><a name="l13094"></a><span class="lineno">13094</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l13095"></a><span class="lineno">13095</span>&#160; </div>
<div class="line"><a name="l13096"></a><span class="lineno">13096</span>&#160;      std::ostringstream error_message;</div>
<div class="line"><a name="l13097"></a><span class="lineno">13097</span>&#160;      error_message</div>
<div class="line"><a name="l13098"></a><span class="lineno">13098</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;Synchronisation of temporal restart data \n&quot;</span></div>
<div class="line"><a name="l13099"></a><span class="lineno">13099</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;required even though we don&#39;t have mpi support -- very odd!\n&quot;</span>;</div>
<div class="line"><a name="l13100"></a><span class="lineno">13100</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l13101"></a><span class="lineno">13101</span>&#160;        error_message.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l13102"></a><span class="lineno">13102</span>&#160; </div>
<div class="line"><a name="l13103"></a><span class="lineno">13103</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l13104"></a><span class="lineno">13104</span>&#160;    }</div>
<div class="line"><a name="l13105"></a><span class="lineno">13105</span>&#160;    <span class="comment">// No sync needed -- just copy across</span></div>
<div class="line"><a name="l13106"></a><span class="lineno">13106</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l13107"></a><span class="lineno">13107</span>&#160;    {</div>
<div class="line"><a name="l13108"></a><span class="lineno">13108</span>&#160;      unsteady_restart = <span class="keyword">false</span>;</div>
<div class="line"><a name="l13109"></a><span class="lineno">13109</span>&#160;      <span class="keywordflow">if</span> (local_unsteady_restart_flag == 1)</div>
<div class="line"><a name="l13110"></a><span class="lineno">13110</span>&#160;      {</div>
<div class="line"><a name="l13111"></a><span class="lineno">13111</span>&#160;        unsteady_restart = <span class="keyword">true</span>;</div>
<div class="line"><a name="l13112"></a><span class="lineno">13112</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a46894b13c582f322082dc471a2485980">time_pt</a>()-&gt;<a class="code" href="../../d0/da1/classoomph_1_1Time.html#a6e28ea7a6664a2f5f5e1be871304a2c7">time</a>() = local_time;</div>
<div class="line"><a name="l13113"></a><span class="lineno">13113</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a46894b13c582f322082dc471a2485980">time_pt</a>()-&gt;<a class="code" href="../../d0/da1/classoomph_1_1Time.html#aeab1acb1e182797c4194af84c0583c3f">resize</a>(local_n_dt);</div>
<div class="line"><a name="l13114"></a><span class="lineno">13114</span>&#160;        dt.resize(local_n_dt);</div>
<div class="line"><a name="l13115"></a><span class="lineno">13115</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; local_n_dt; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l13116"></a><span class="lineno">13116</span>&#160;        {</div>
<div class="line"><a name="l13117"></a><span class="lineno">13117</span>&#160;          dt[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = local_dt[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l13118"></a><span class="lineno">13118</span>&#160;        }</div>
<div class="line"><a name="l13119"></a><span class="lineno">13119</span>&#160;      }</div>
<div class="line"><a name="l13120"></a><span class="lineno">13120</span>&#160;    }</div>
<div class="line"><a name="l13121"></a><span class="lineno">13121</span>&#160; </div>
<div class="line"><a name="l13122"></a><span class="lineno">13122</span>&#160;    <span class="comment">// Initialise timestep -- also sets the weights for all timesteppers</span></div>
<div class="line"><a name="l13123"></a><span class="lineno">13123</span>&#160;    <span class="comment">// in the problem.</span></div>
<div class="line"><a name="l13124"></a><span class="lineno">13124</span>&#160;    <span class="keywordflow">if</span> (unsteady_restart) <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a5f7e9e91eab83d600c94afdad532a6fb">initialise_dt</a>(dt);</div>
<div class="line"><a name="l13125"></a><span class="lineno">13125</span>&#160; </div>
<div class="line"><a name="l13126"></a><span class="lineno">13126</span>&#160;    <span class="comment">// Loop over submeshes:</span></div>
<div class="line"><a name="l13127"></a><span class="lineno">13127</span>&#160;    <span class="keywordtype">unsigned</span> nmesh = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>();</div>
<div class="line"><a name="l13128"></a><span class="lineno">13128</span>&#160;    <span class="keywordflow">if</span> (nmesh == 0) nmesh = 1;</div>
<div class="line"><a name="l13129"></a><span class="lineno">13129</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> = 0; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> &lt; nmesh; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>++)</div>
<div class="line"><a name="l13130"></a><span class="lineno">13130</span>&#160;    {</div>
<div class="line"><a name="l13131"></a><span class="lineno">13131</span>&#160;      <span class="comment">//    //---------------------------------------------------------</span></div>
<div class="line"><a name="l13132"></a><span class="lineno">13132</span>&#160;      <span class="comment">//    // Keep this commented out code around to debug restarts</span></div>
<div class="line"><a name="l13133"></a><span class="lineno">13133</span>&#160;      <span class="comment">//    //---------------------------------------------------------</span></div>
<div class="line"><a name="l13134"></a><span class="lineno">13134</span>&#160;      <span class="comment">//    std::ofstream some_file;</span></div>
<div class="line"><a name="l13135"></a><span class="lineno">13135</span>&#160;      <span class="comment">//    char filename[100];</span></div>
<div class="line"><a name="l13136"></a><span class="lineno">13136</span>&#160;      <span class="comment">//    sprintf(filename,&quot;read_mesh%i_on_proc%i.dat&quot;,m,</span></div>
<div class="line"><a name="l13137"></a><span class="lineno">13137</span>&#160;      <span class="comment">//            this-&gt;communicator_pt()-&gt;my_rank());</span></div>
<div class="line"><a name="l13138"></a><span class="lineno">13138</span>&#160;      <span class="comment">//    some_file.open(filename);</span></div>
<div class="line"><a name="l13139"></a><span class="lineno">13139</span>&#160;      <span class="comment">//    mesh_pt(m)-&gt;output(some_file);</span></div>
<div class="line"><a name="l13140"></a><span class="lineno">13140</span>&#160;      <span class="comment">//    some_file.close();</span></div>
<div class="line"><a name="l13141"></a><span class="lineno">13141</span>&#160; </div>
<div class="line"><a name="l13142"></a><span class="lineno">13142</span>&#160;      <span class="comment">//    sprintf(filename,&quot;read_mesh%i_with_haloes_on_proc%i.dat&quot;,m,</span></div>
<div class="line"><a name="l13143"></a><span class="lineno">13143</span>&#160;      <span class="comment">//            this-&gt;communicator_pt()-&gt;my_rank());</span></div>
<div class="line"><a name="l13144"></a><span class="lineno">13144</span>&#160;      <span class="comment">//    mesh_pt(m)-&gt;enable_output_of_halo_elements();</span></div>
<div class="line"><a name="l13145"></a><span class="lineno">13145</span>&#160;      <span class="comment">//    some_file.open(filename);</span></div>
<div class="line"><a name="l13146"></a><span class="lineno">13146</span>&#160;      <span class="comment">//    mesh_pt(m)-&gt;output(some_file);</span></div>
<div class="line"><a name="l13147"></a><span class="lineno">13147</span>&#160;      <span class="comment">//    mesh_pt(m)-&gt;disable_output_of_halo_elements();</span></div>
<div class="line"><a name="l13148"></a><span class="lineno">13148</span>&#160;      <span class="comment">//    some_file.close();</span></div>
<div class="line"><a name="l13149"></a><span class="lineno">13149</span>&#160;      <span class="comment">//    oomph_info &lt;&lt; &quot;Doced mesh &quot; &lt;&lt; m &lt;&lt; &quot; before reading\n&quot;;</span></div>
<div class="line"><a name="l13150"></a><span class="lineno">13150</span>&#160; </div>
<div class="line"><a name="l13151"></a><span class="lineno">13151</span>&#160;      <span class="comment">//    sprintf(filename,&quot;read_nodes_mesh%i_on_proc%i.dat&quot;,m,</span></div>
<div class="line"><a name="l13152"></a><span class="lineno">13152</span>&#160;      <span class="comment">//            this-&gt;communicator_pt()-&gt;my_rank());</span></div>
<div class="line"><a name="l13153"></a><span class="lineno">13153</span>&#160;      <span class="comment">//    some_file.open(filename);</span></div>
<div class="line"><a name="l13154"></a><span class="lineno">13154</span>&#160;      <span class="comment">//    unsigned nnod=mesh_pt(m)-&gt;nnode();</span></div>
<div class="line"><a name="l13155"></a><span class="lineno">13155</span>&#160;      <span class="comment">//    for (unsigned j=0;j&lt;nnod;j++)</span></div>
<div class="line"><a name="l13156"></a><span class="lineno">13156</span>&#160;      <span class="comment">//     {</span></div>
<div class="line"><a name="l13157"></a><span class="lineno">13157</span>&#160;      <span class="comment">//      Node* nod_pt=mesh_pt(m)-&gt;node_pt(j);</span></div>
<div class="line"><a name="l13158"></a><span class="lineno">13158</span>&#160;      <span class="comment">//      unsigned n=nod_pt-&gt;ndim();</span></div>
<div class="line"><a name="l13159"></a><span class="lineno">13159</span>&#160;      <span class="comment">//      for (unsigned i=0;i&lt;n;i++)</span></div>
<div class="line"><a name="l13160"></a><span class="lineno">13160</span>&#160;      <span class="comment">//       {</span></div>
<div class="line"><a name="l13161"></a><span class="lineno">13161</span>&#160;      <span class="comment">//        some_file &lt;&lt; nod_pt-&gt;x(i) &lt;&lt; &quot; &quot;;</span></div>
<div class="line"><a name="l13162"></a><span class="lineno">13162</span>&#160;      <span class="comment">//       }</span></div>
<div class="line"><a name="l13163"></a><span class="lineno">13163</span>&#160;      <span class="comment">//      some_file &lt;&lt; nod_pt-&gt;is_halo() &lt;&lt; &quot; &quot;</span></div>
<div class="line"><a name="l13164"></a><span class="lineno">13164</span>&#160;      <span class="comment">//                &lt;&lt; nod_pt-&gt;nvalue() &lt;&lt; &quot; &quot;</span></div>
<div class="line"><a name="l13165"></a><span class="lineno">13165</span>&#160;      <span class="comment">//                &lt;&lt; nod_pt-&gt;hang_code() &lt;&lt; &quot;\n&quot;;</span></div>
<div class="line"><a name="l13166"></a><span class="lineno">13166</span>&#160;      <span class="comment">//     }</span></div>
<div class="line"><a name="l13167"></a><span class="lineno">13167</span>&#160;      <span class="comment">//    some_file.close();</span></div>
<div class="line"><a name="l13168"></a><span class="lineno">13168</span>&#160;      <span class="comment">//    oomph_info &lt;&lt; &quot;Doced mesh &quot; &lt;&lt; m &lt;&lt; &quot; before reading\n&quot;;</span></div>
<div class="line"><a name="l13169"></a><span class="lineno">13169</span>&#160;      <span class="comment">//    //---------------------------------------------------------</span></div>
<div class="line"><a name="l13170"></a><span class="lineno">13170</span>&#160;      <span class="comment">//    // End keep this commented out code around to debug restarts</span></div>
<div class="line"><a name="l13171"></a><span class="lineno">13171</span>&#160;      <span class="comment">//    //---------------------------------------------------------</span></div>
<div class="line"><a name="l13172"></a><span class="lineno">13172</span>&#160; </div>
<div class="line"><a name="l13173"></a><span class="lineno">13173</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>)-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ac192b41d1a24297ff38854548defd92b">read</a>(restart_file);</div>
<div class="line"><a name="l13174"></a><span class="lineno">13174</span>&#160; </div>
<div class="line"><a name="l13175"></a><span class="lineno">13175</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_TRIANGLE_LIB</span></div>
<div class="line"><a name="l13176"></a><span class="lineno">13176</span>&#160;      <span class="comment">// Here update the polyline representation if working with</span></div>
<div class="line"><a name="l13177"></a><span class="lineno">13177</span>&#160;      <span class="comment">// triangle base meshes</span></div>
<div class="line"><a name="l13178"></a><span class="lineno">13178</span>&#160;      <span class="keywordflow">if</span> (TriangleMeshBase* mmesh_pt =</div>
<div class="line"><a name="l13179"></a><span class="lineno">13179</span>&#160;            <span class="keyword">dynamic_cast&lt;</span>TriangleMeshBase*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>)))</div>
<div class="line"><a name="l13180"></a><span class="lineno">13180</span>&#160;      {</div>
<div class="line"><a name="l13181"></a><span class="lineno">13181</span>&#160;        <span class="comment">// In charge of updating the polylines representation to the</span></div>
<div class="line"><a name="l13182"></a><span class="lineno">13182</span>&#160;        <span class="comment">// current refinement/unrefinement level after restart, it</span></div>
<div class="line"><a name="l13183"></a><span class="lineno">13183</span>&#160;        <span class="comment">// also update the shared boundaries in case of working with a</span></div>
<div class="line"><a name="l13184"></a><span class="lineno">13184</span>&#160;        <span class="comment">// distributed mesh</span></div>
<div class="line"><a name="l13185"></a><span class="lineno">13185</span>&#160;        mmesh_pt-&gt;update_polyline_representation_from_restart();</div>
<div class="line"><a name="l13186"></a><span class="lineno">13186</span>&#160;      }</div>
<div class="line"><a name="l13187"></a><span class="lineno">13187</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// #ifdef OOMPH_HAS_TRIANGLE_LIB</span></div>
<div class="line"><a name="l13188"></a><span class="lineno">13188</span>&#160;    }</div>
<div class="line"><a name="l13189"></a><span class="lineno">13189</span>&#160; </div>
<div class="line"><a name="l13190"></a><span class="lineno">13190</span>&#160;    <span class="comment">// Read global data:</span></div>
<div class="line"><a name="l13191"></a><span class="lineno">13191</span>&#160;    <span class="comment">//------------------</span></div>
<div class="line"><a name="l13192"></a><span class="lineno">13192</span>&#160; </div>
<div class="line"><a name="l13193"></a><span class="lineno">13193</span>&#160;    <span class="comment">// Number of global data</span></div>
<div class="line"><a name="l13194"></a><span class="lineno">13194</span>&#160;    <span class="keywordtype">unsigned</span> Nglobal = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>.size();</div>
<div class="line"><a name="l13195"></a><span class="lineno">13195</span>&#160; </div>
<div class="line"><a name="l13196"></a><span class="lineno">13196</span>&#160;    <span class="comment">// Read line up to termination sign</span></div>
<div class="line"><a name="l13197"></a><span class="lineno">13197</span>&#160;    getline(restart_file, input_string, <span class="charliteral">&#39;#&#39;</span>);</div>
<div class="line"><a name="l13198"></a><span class="lineno">13198</span>&#160; </div>
<div class="line"><a name="l13199"></a><span class="lineno">13199</span>&#160;    <span class="comment">// Ignore rest of line</span></div>
<div class="line"><a name="l13200"></a><span class="lineno">13200</span>&#160;    restart_file.ignore(80, <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l13201"></a><span class="lineno">13201</span>&#160; </div>
<div class="line"><a name="l13202"></a><span class="lineno">13202</span>&#160;    <span class="comment">// Check # of nodes:</span></div>
<div class="line"><a name="l13203"></a><span class="lineno">13203</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> check_nglobal = atoi(input_string.c_str());</div>
<div class="line"><a name="l13204"></a><span class="lineno">13204</span>&#160; </div>
<div class="line"><a name="l13205"></a><span class="lineno">13205</span>&#160; </div>
<div class="line"><a name="l13206"></a><span class="lineno">13206</span>&#160;    <span class="keywordflow">if</span> (restart_file_is_open)</div>
<div class="line"><a name="l13207"></a><span class="lineno">13207</span>&#160;    {</div>
<div class="line"><a name="l13208"></a><span class="lineno">13208</span>&#160;      <span class="keywordflow">if</span> (check_nglobal != Nglobal)</div>
<div class="line"><a name="l13209"></a><span class="lineno">13209</span>&#160;      {</div>
<div class="line"><a name="l13210"></a><span class="lineno">13210</span>&#160;        std::ostringstream error_message;</div>
<div class="line"><a name="l13211"></a><span class="lineno">13211</span>&#160;        error_message &lt;&lt; <span class="stringliteral">&quot;The number of global data &quot;</span> &lt;&lt; Nglobal</div>
<div class="line"><a name="l13212"></a><span class="lineno">13212</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot; is not equal to that specified in the input file &quot;</span></div>
<div class="line"><a name="l13213"></a><span class="lineno">13213</span>&#160;                      &lt;&lt; check_nglobal &lt;&lt; std::endl;</div>
<div class="line"><a name="l13214"></a><span class="lineno">13214</span>&#160; </div>
<div class="line"><a name="l13215"></a><span class="lineno">13215</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(error_message.str(),</div>
<div class="line"><a name="l13216"></a><span class="lineno">13216</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l13217"></a><span class="lineno">13217</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l13218"></a><span class="lineno">13218</span>&#160;      }</div>
<div class="line"><a name="l13219"></a><span class="lineno">13219</span>&#160;    }</div>
<div class="line"><a name="l13220"></a><span class="lineno">13220</span>&#160; </div>
<div class="line"><a name="l13221"></a><span class="lineno">13221</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> iglobal = 0; iglobal &lt; Nglobal; iglobal++)</div>
<div class="line"><a name="l13222"></a><span class="lineno">13222</span>&#160;    {</div>
<div class="line"><a name="l13223"></a><span class="lineno">13223</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>[iglobal]-&gt;read(restart_file);</div>
<div class="line"><a name="l13224"></a><span class="lineno">13224</span>&#160;    }</div>
<div class="line"><a name="l13225"></a><span class="lineno">13225</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_ac192b41d1a24297ff38854548defd92b"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#ac192b41d1a24297ff38854548defd92b">oomph::Mesh::read</a></div><div class="ttdeci">virtual void read(std::ifstream &amp;restart_file)</div><div class="ttdoc">Read solution from restart file.</div><div class="ttdef"><b>Definition:</b> mesh.cc:1130</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a36b11f7bc1b7b9413ee4a78eab536df8"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a36b11f7bc1b7b9413ee4a78eab536df8">oomph::Problem::Suppress_warning_about_actions_before_read_unstructured_meshes</a></div><div class="ttdeci">static bool Suppress_warning_about_actions_before_read_unstructured_meshes</div><div class="ttdef"><b>Definition:</b> problem.h:317</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a498317b3e390eddf2169ab989ee8d6b4"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a498317b3e390eddf2169ab989ee8d6b4">oomph::Problem::actions_after_read_unstructured_meshes</a></div><div class="ttdeci">virtual void actions_after_read_unstructured_meshes()</div><div class="ttdef"><b>Definition:</b> problem.h:1109</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_ade208b7d7d8e866d5ba896f03edb1f9a"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#ade208b7d7d8e866d5ba896f03edb1f9a">oomph::Problem::refine_uniformly</a></div><div class="ttdeci">void refine_uniformly()</div><div class="ttdef"><b>Definition:</b> problem.h:2640</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_af10662119a7a0c3a47879fa0d0644452"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#af10662119a7a0c3a47879fa0d0644452">oomph::Problem::actions_before_read_unstructured_meshes</a></div><div class="ttdeci">virtual void actions_before_read_unstructured_meshes()</div><div class="ttdef"><b>Definition:</b> problem.h:1095</div></div>
<div class="ttc" id="aclassunsigned_html"><div class="ttname"><a href="../../d0/d1d/classunsigned.html">unsigned</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">actions_after_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a498317b3e390eddf2169ab989ee8d6b4">actions_after_read_unstructured_meshes()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">actions_before_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af10662119a7a0c3a47879fa0d0644452">actions_before_read_unstructured_meshes()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers()</a>, <a class="el" href="../../dd/d78/classoomph_1_1FaceElement.html#a7539054d858d73989d7c1166e333e0f8">oomph::FaceElement::bulk_element_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">communicator_pt()</a>, <a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html#a666a20817ab9c396b225d8652bc0a338">oomph::DocInfo::disable_doc()</a>, <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">oomph::Mesh::element_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a71f87e46a571a54abd27a26f6c701c36">Empty_actions_after_read_unstructured_meshes_has_been_called</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5f13ea67c29022392857b5c19bb3af71">Empty_actions_before_read_unstructured_meshes_has_been_called</a>, <a class="el" href="../../d0/dbe/classoomph_1_1TreeBasedRefineableMeshBase.html#a937e4321288b6642d5057498f7659d76">oomph::TreeBasedRefineableMeshBase::get_refinement_levels()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5f7e9e91eab83d600c94afdad532a6fb">initialise_dt()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a1ab35b022b95f2d28c53aa58859bd6b5">oomph::Mesh::is_mesh_distributed()</a>, <a class="el" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>, <a class="el" href="../../dc/d51/datatypes_8h.html#affe776513b24d84b39af8ab0930fef7f">max</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt()</a>, <a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a670b34aab05bfe0b96d0e0fabf583c7a">oomph::OomphCommunicator::my_rank()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">oomph::Mesh::nelement()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ac192b41d1a24297ff38854548defd92b">oomph::Mesh::read()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a266d4d1b2bd4a5cbc028ff5aba79508f">rebuild_global_mesh()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ade208b7d7d8e866d5ba896f03edb1f9a">refine_uniformly()</a>, <a class="el" href="../../d0/da1/classoomph_1_1Time.html#aeab1acb1e182797c4194af84c0583c3f">oomph::Time::resize()</a>, <a class="el" href="../../d2/dc3/namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">oomph::Global_string_for_annotation::string()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a36b11f7bc1b7b9413ee4a78eab536df8">Suppress_warning_about_actions_before_read_unstructured_meshes</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#affda31840308a51d36324e6debe1bee7">time()</a>, <a class="el" href="../../d0/da1/classoomph_1_1Time.html#a6e28ea7a6664a2f5f5e1be871304a2c7">oomph::Time::time()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a46894b13c582f322082dc471a2485980">time_pt()</a>, and <a class="el" href="../../da/d67/level3__impl_8h.html#a0ab86207641c152874beced8f77894d0">tmp</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d94/classoomph_1_1MyProblem.html#a869f3a0c604470dea4fd446bae2a3d3a">oomph::MyProblem::read()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a561320c1b8deb3540d260c6c2c5f4fb4">read()</a>.</p>

</div>
</div>
<a id="a266d4d1b2bd4a5cbc028ff5aba79508f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a266d4d1b2bd4a5cbc028ff5aba79508f">&#9670;&nbsp;</a></span>rebuild_global_mesh()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::rebuild_global_mesh </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>If one of the submeshes has changed (e.g. by mesh adaptation) we need to update the global mesh. <b>Note:</b> The nodes boundary information refers to the boundary numbers within the submesh!</p>
<p>If one of the submeshes has changed (e.g. by mesh adaptation) we need to update the global mesh. <b>Note:</b> The nodes boundary information refers to the boundary numbers within the submesh! N.B. This is essentially the same function as the Mesh constructor that assembles a single global mesh from submeshes </p>
<div class="fragment"><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;  {</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;    <span class="comment">// Use the function in mesh to merge the submeshes into this one</span></div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#af4e77a5529b2aabfed8289e313c1c8d9">merge_meshes</a>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab65f6fc9c49860e6324457a7e6e76346">Sub_mesh_pt</a>);</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_af4e77a5529b2aabfed8289e313c1c8d9"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#af4e77a5529b2aabfed8289e313c1c8d9">oomph::Mesh::merge_meshes</a></div><div class="ttdeci">void merge_meshes(const Vector&lt; Mesh * &gt; &amp;sub_mesh_pt)</div><div class="ttdef"><b>Definition:</b> mesh.cc:65</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af4e77a5529b2aabfed8289e313c1c8d9">oomph::Mesh::merge_meshes()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab65f6fc9c49860e6324457a7e6e76346">Sub_mesh_pt</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/dec/classContactProblem.html#ad5916aab223b6836f09397ca8430fee0">ContactProblem&lt; ELEMENT &gt;::actions_after_adapt()</a>, <a class="el" href="../../d0/dec/classContactProblem.html#a0710e91dbedb87196e16a438ae8c9ebe">ContactProblem&lt; ELEMENT &gt;::actions_before_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5e60c7b47591bca6b20b0612e119983">adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a309487c952f108015b53a2d70539ac8b">adapt_based_on_error_estimates()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa29176d84610e0273fc823cace91765a">build_global_mesh()</a>, <a class="el" href="../../d7/d5d/two__layer__interface__nonaxisym__perturbations_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a350e611af4847eabfa1d531b14b4439c">p_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac69a6b98a561adcfef0ef369b32e5fbd">p_refine_selected_elements()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a093b78c1820cf3fe6bd9ec3deb605b49">p_refine_uniformly()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7460f9339fd4850112284a86e039ee00">p_refine_uniformly_aux()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#afa0aab9ca7018bf875c1f3367c6c07e3">p_unrefine_uniformly()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a4f6011ef141cc68598a9502052129a3f">read()</a>, <a class="el" href="../../de/da7/classoomph_1_1SegregatableFSIProblem.html#a61cad9a0a75f2999c0529caa9cac2b73">oomph::SegregatableFSIProblem::rebuild_monolithic_mesh()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad063e4c93b80ce4d5b22d776bfac5503">refine_selected_elements()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a1ce3a9162aaef9e0a4d86f8de57eb523">refine_uniformly()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#affb22db0c6f1e14ae120b153b85831a3">refine_uniformly_aux()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a56429d79e517d59a54cd49949b04d3ae">unrefine_uniformly()</a>, <a class="el" href="../../de/da7/classoomph_1_1SegregatableFSIProblem.html#a13a9841e0aa05bf57ec228b49b311a26">oomph::SegregatableFSIProblem::use_only_fluid_elements()</a>, and <a class="el" href="../../de/da7/classoomph_1_1SegregatableFSIProblem.html#a330660bc7b69c9c128bfed62b54dcf62">oomph::SegregatableFSIProblem::use_only_solid_elements()</a>.</p>

</div>
</div>
<a id="ab9613642f5dca54e33c836e16507a0a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9613642f5dca54e33c836e16507a0a7">&#9670;&nbsp;</a></span>refine_selected_elements() <span class="overload">[1/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::refine_selected_elements </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>i_mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../dc/d08/classoomph_1_1RefineableElement.html">RefineableElement</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>elements_to_be_refined_pt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Refine specified submesh by splitting the elements identified by their pointers, then rebuild the problem. </p>
<div class="fragment"><div class="line"><a name="l15040"></a><span class="lineno">15040</span>&#160;  {</div>
<div class="line"><a name="l15041"></a><span class="lineno">15041</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">actions_before_adapt</a>();</div>
<div class="line"><a name="l15042"></a><span class="lineno">15042</span>&#160; </div>
<div class="line"><a name="l15043"></a><span class="lineno">15043</span>&#160;    <span class="comment">// Number of submeshes?</span></div>
<div class="line"><a name="l15044"></a><span class="lineno">15044</span>&#160;    <span class="keywordtype">unsigned</span> n_mesh = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>();</div>
<div class="line"><a name="l15045"></a><span class="lineno">15045</span>&#160; </div>
<div class="line"><a name="l15046"></a><span class="lineno">15046</span>&#160;    <span class="keywordflow">if</span> (i_mesh &gt;= n_mesh)</div>
<div class="line"><a name="l15047"></a><span class="lineno">15047</span>&#160;    {</div>
<div class="line"><a name="l15048"></a><span class="lineno">15048</span>&#160;      std::ostringstream error_message;</div>
<div class="line"><a name="l15049"></a><span class="lineno">15049</span>&#160;      error_message &lt;&lt; <span class="stringliteral">&quot;Problem only has &quot;</span> &lt;&lt; n_mesh</div>
<div class="line"><a name="l15050"></a><span class="lineno">15050</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot; submeshes. Cannot refine submesh &quot;</span> &lt;&lt; i_mesh</div>
<div class="line"><a name="l15051"></a><span class="lineno">15051</span>&#160;                    &lt;&lt; std::endl;</div>
<div class="line"><a name="l15052"></a><span class="lineno">15052</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l15053"></a><span class="lineno">15053</span>&#160;        error_message.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l15054"></a><span class="lineno">15054</span>&#160;    }</div>
<div class="line"><a name="l15055"></a><span class="lineno">15055</span>&#160; </div>
<div class="line"><a name="l15056"></a><span class="lineno">15056</span>&#160;    <span class="comment">// Refine single mesh if possible</span></div>
<div class="line"><a name="l15057"></a><span class="lineno">15057</span>&#160;    <span class="keywordflow">if</span> (TreeBasedRefineableMeshBase* mmesh_pt =</div>
<div class="line"><a name="l15058"></a><span class="lineno">15058</span>&#160;          <span class="keyword">dynamic_cast&lt;</span>TreeBasedRefineableMeshBase*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(i_mesh)))</div>
<div class="line"><a name="l15059"></a><span class="lineno">15059</span>&#160;    {</div>
<div class="line"><a name="l15060"></a><span class="lineno">15060</span>&#160;      mmesh_pt-&gt;refine_selected_elements(elements_to_be_refined_pt);</div>
<div class="line"><a name="l15061"></a><span class="lineno">15061</span>&#160;    }</div>
<div class="line"><a name="l15062"></a><span class="lineno">15062</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l15063"></a><span class="lineno">15063</span>&#160;    {</div>
<div class="line"><a name="l15064"></a><span class="lineno">15064</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Mesh cannot be refined &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l15065"></a><span class="lineno">15065</span>&#160;    }</div>
<div class="line"><a name="l15066"></a><span class="lineno">15066</span>&#160; </div>
<div class="line"><a name="l15067"></a><span class="lineno">15067</span>&#160;    <span class="keywordflow">if</span> (n_mesh &gt; 1)</div>
<div class="line"><a name="l15068"></a><span class="lineno">15068</span>&#160;    {</div>
<div class="line"><a name="l15069"></a><span class="lineno">15069</span>&#160;      <span class="comment">// Rebuild the global mesh</span></div>
<div class="line"><a name="l15070"></a><span class="lineno">15070</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a266d4d1b2bd4a5cbc028ff5aba79508f">rebuild_global_mesh</a>();</div>
<div class="line"><a name="l15071"></a><span class="lineno">15071</span>&#160;    }</div>
<div class="line"><a name="l15072"></a><span class="lineno">15072</span>&#160; </div>
<div class="line"><a name="l15073"></a><span class="lineno">15073</span>&#160;    <span class="comment">// Any actions after the adapatation phase</span></div>
<div class="line"><a name="l15074"></a><span class="lineno">15074</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">actions_after_adapt</a>();</div>
<div class="line"><a name="l15075"></a><span class="lineno">15075</span>&#160; </div>
<div class="line"><a name="l15076"></a><span class="lineno">15076</span>&#160;    <span class="comment">// Do equation numbering</span></div>
<div class="line"><a name="l15077"></a><span class="lineno">15077</span>&#160;    <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Number of equations: &quot;</span> &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers</a>() &lt;&lt; std::endl;</div>
<div class="line"><a name="l15078"></a><span class="lineno">15078</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">actions_after_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">actions_before_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a266d4d1b2bd4a5cbc028ff5aba79508f">rebuild_global_mesh()</a>.</p>

</div>
</div>
<a id="ad063e4c93b80ce4d5b22d776bfac5503"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad063e4c93b80ce4d5b22d776bfac5503">&#9670;&nbsp;</a></span>refine_selected_elements() <span class="overload">[2/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::refine_selected_elements </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>i_mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>elements_to_be_refined</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Refine specified submesh by splitting the elements identified by their numbers relative to the submesh, then rebuild the problem.</p>
<p>Refine specified submesh by splitting the elements identified by their numbers relative to the specified mesh, then rebuild the problem. </p>
<div class="fragment"><div class="line"><a name="l14992"></a><span class="lineno">14992</span>&#160;  {</div>
<div class="line"><a name="l14993"></a><span class="lineno">14993</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">actions_before_adapt</a>();</div>
<div class="line"><a name="l14994"></a><span class="lineno">14994</span>&#160; </div>
<div class="line"><a name="l14995"></a><span class="lineno">14995</span>&#160;    <span class="comment">// Number of submeshes?</span></div>
<div class="line"><a name="l14996"></a><span class="lineno">14996</span>&#160;    <span class="keywordtype">unsigned</span> n_mesh = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>();</div>
<div class="line"><a name="l14997"></a><span class="lineno">14997</span>&#160; </div>
<div class="line"><a name="l14998"></a><span class="lineno">14998</span>&#160;    <span class="keywordflow">if</span> (i_mesh &gt;= n_mesh)</div>
<div class="line"><a name="l14999"></a><span class="lineno">14999</span>&#160;    {</div>
<div class="line"><a name="l15000"></a><span class="lineno">15000</span>&#160;      std::ostringstream error_message;</div>
<div class="line"><a name="l15001"></a><span class="lineno">15001</span>&#160;      error_message &lt;&lt; <span class="stringliteral">&quot;Problem only has &quot;</span> &lt;&lt; n_mesh</div>
<div class="line"><a name="l15002"></a><span class="lineno">15002</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot; submeshes. Cannot refine submesh &quot;</span> &lt;&lt; i_mesh</div>
<div class="line"><a name="l15003"></a><span class="lineno">15003</span>&#160;                    &lt;&lt; std::endl;</div>
<div class="line"><a name="l15004"></a><span class="lineno">15004</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l15005"></a><span class="lineno">15005</span>&#160;        error_message.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l15006"></a><span class="lineno">15006</span>&#160;    }</div>
<div class="line"><a name="l15007"></a><span class="lineno">15007</span>&#160; </div>
<div class="line"><a name="l15008"></a><span class="lineno">15008</span>&#160;    <span class="comment">// Refine single mesh if possible</span></div>
<div class="line"><a name="l15009"></a><span class="lineno">15009</span>&#160;    <span class="keywordflow">if</span> (TreeBasedRefineableMeshBase* mmesh_pt =</div>
<div class="line"><a name="l15010"></a><span class="lineno">15010</span>&#160;          <span class="keyword">dynamic_cast&lt;</span>TreeBasedRefineableMeshBase*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(i_mesh)))</div>
<div class="line"><a name="l15011"></a><span class="lineno">15011</span>&#160;    {</div>
<div class="line"><a name="l15012"></a><span class="lineno">15012</span>&#160;      mmesh_pt-&gt;refine_selected_elements(elements_to_be_refined);</div>
<div class="line"><a name="l15013"></a><span class="lineno">15013</span>&#160;    }</div>
<div class="line"><a name="l15014"></a><span class="lineno">15014</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l15015"></a><span class="lineno">15015</span>&#160;    {</div>
<div class="line"><a name="l15016"></a><span class="lineno">15016</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Mesh cannot be refined &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l15017"></a><span class="lineno">15017</span>&#160;    }</div>
<div class="line"><a name="l15018"></a><span class="lineno">15018</span>&#160; </div>
<div class="line"><a name="l15019"></a><span class="lineno">15019</span>&#160;    <span class="keywordflow">if</span> (n_mesh &gt; 1)</div>
<div class="line"><a name="l15020"></a><span class="lineno">15020</span>&#160;    {</div>
<div class="line"><a name="l15021"></a><span class="lineno">15021</span>&#160;      <span class="comment">// Rebuild the global mesh</span></div>
<div class="line"><a name="l15022"></a><span class="lineno">15022</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a266d4d1b2bd4a5cbc028ff5aba79508f">rebuild_global_mesh</a>();</div>
<div class="line"><a name="l15023"></a><span class="lineno">15023</span>&#160;    }</div>
<div class="line"><a name="l15024"></a><span class="lineno">15024</span>&#160; </div>
<div class="line"><a name="l15025"></a><span class="lineno">15025</span>&#160;    <span class="comment">// Any actions after the adapatation phase</span></div>
<div class="line"><a name="l15026"></a><span class="lineno">15026</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">actions_after_adapt</a>();</div>
<div class="line"><a name="l15027"></a><span class="lineno">15027</span>&#160; </div>
<div class="line"><a name="l15028"></a><span class="lineno">15028</span>&#160;    <span class="comment">// Do equation numbering</span></div>
<div class="line"><a name="l15029"></a><span class="lineno">15029</span>&#160;    <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Number of equations: &quot;</span> &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers</a>() &lt;&lt; std::endl;</div>
<div class="line"><a name="l15030"></a><span class="lineno">15030</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">actions_after_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">actions_before_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a266d4d1b2bd4a5cbc028ff5aba79508f">rebuild_global_mesh()</a>.</p>

</div>
</div>
<a id="aa2c5924864cbe37b94429eb90d58801e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2c5924864cbe37b94429eb90d58801e">&#9670;&nbsp;</a></span>refine_selected_elements() <span class="overload">[3/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::refine_selected_elements </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../dc/d08/classoomph_1_1RefineableElement.html">RefineableElement</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>elements_to_be_refined_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Refine (one and only!) mesh by splitting the elements identified by their pointers, then rebuild the problem. </p>
<div class="fragment"><div class="line"><a name="l14946"></a><span class="lineno">14946</span>&#160;  {</div>
<div class="line"><a name="l14947"></a><span class="lineno">14947</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">actions_before_adapt</a>();</div>
<div class="line"><a name="l14948"></a><span class="lineno">14948</span>&#160; </div>
<div class="line"><a name="l14949"></a><span class="lineno">14949</span>&#160;    <span class="comment">// Number of submeshes?</span></div>
<div class="line"><a name="l14950"></a><span class="lineno">14950</span>&#160;    <span class="keywordtype">unsigned</span> Nmesh = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>();</div>
<div class="line"><a name="l14951"></a><span class="lineno">14951</span>&#160; </div>
<div class="line"><a name="l14952"></a><span class="lineno">14952</span>&#160;    <span class="comment">// Single mesh:</span></div>
<div class="line"><a name="l14953"></a><span class="lineno">14953</span>&#160;    <span class="keywordflow">if</span> (Nmesh == 0)</div>
<div class="line"><a name="l14954"></a><span class="lineno">14954</span>&#160;    {</div>
<div class="line"><a name="l14955"></a><span class="lineno">14955</span>&#160;      <span class="comment">// Refine single mesh if possible</span></div>
<div class="line"><a name="l14956"></a><span class="lineno">14956</span>&#160;      <span class="keywordflow">if</span> (TreeBasedRefineableMeshBase* mmesh_pt =</div>
<div class="line"><a name="l14957"></a><span class="lineno">14957</span>&#160;            <span class="keyword">dynamic_cast&lt;</span>TreeBasedRefineableMeshBase*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(0)))</div>
<div class="line"><a name="l14958"></a><span class="lineno">14958</span>&#160;      {</div>
<div class="line"><a name="l14959"></a><span class="lineno">14959</span>&#160;        mmesh_pt-&gt;refine_selected_elements(elements_to_be_refined_pt);</div>
<div class="line"><a name="l14960"></a><span class="lineno">14960</span>&#160;      }</div>
<div class="line"><a name="l14961"></a><span class="lineno">14961</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l14962"></a><span class="lineno">14962</span>&#160;      {</div>
<div class="line"><a name="l14963"></a><span class="lineno">14963</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Mesh cannot be refined &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l14964"></a><span class="lineno">14964</span>&#160;      }</div>
<div class="line"><a name="l14965"></a><span class="lineno">14965</span>&#160;    }</div>
<div class="line"><a name="l14966"></a><span class="lineno">14966</span>&#160;    <span class="comment">// Multiple submeshes</span></div>
<div class="line"><a name="l14967"></a><span class="lineno">14967</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l14968"></a><span class="lineno">14968</span>&#160;    {</div>
<div class="line"><a name="l14969"></a><span class="lineno">14969</span>&#160;      std::ostringstream error_message;</div>
<div class="line"><a name="l14970"></a><span class="lineno">14970</span>&#160;      error_message &lt;&lt; <span class="stringliteral">&quot;Problem::refine_selected_elements(...) only works for\n&quot;</span></div>
<div class="line"><a name="l14971"></a><span class="lineno">14971</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;multiple-mesh problems if you specify the mesh\n&quot;</span></div>
<div class="line"><a name="l14972"></a><span class="lineno">14972</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;number in the function argument before the Vector,\n&quot;</span></div>
<div class="line"><a name="l14973"></a><span class="lineno">14973</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;or a Vector of Vectors for each submesh.\n&quot;</span></div>
<div class="line"><a name="l14974"></a><span class="lineno">14974</span>&#160;                    &lt;&lt; std::endl;</div>
<div class="line"><a name="l14975"></a><span class="lineno">14975</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l14976"></a><span class="lineno">14976</span>&#160;        error_message.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l14977"></a><span class="lineno">14977</span>&#160;    }</div>
<div class="line"><a name="l14978"></a><span class="lineno">14978</span>&#160; </div>
<div class="line"><a name="l14979"></a><span class="lineno">14979</span>&#160;    <span class="comment">// Any actions after the adapatation phase</span></div>
<div class="line"><a name="l14980"></a><span class="lineno">14980</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">actions_after_adapt</a>();</div>
<div class="line"><a name="l14981"></a><span class="lineno">14981</span>&#160; </div>
<div class="line"><a name="l14982"></a><span class="lineno">14982</span>&#160;    <span class="comment">// Do equation numbering</span></div>
<div class="line"><a name="l14983"></a><span class="lineno">14983</span>&#160;    <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Number of equations: &quot;</span> &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers</a>() &lt;&lt; std::endl;</div>
<div class="line"><a name="l14984"></a><span class="lineno">14984</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">actions_after_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">actions_before_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, and <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>.</p>

</div>
</div>
<a id="a3dcfc37fe1b6c21d694407981830c1e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3dcfc37fe1b6c21d694407981830c1e5">&#9670;&nbsp;</a></span>refine_selected_elements() <span class="overload">[4/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::refine_selected_elements </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>elements_to_be_refined</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Refine (one and only!) mesh by splitting the elements identified by their numbers relative to the problems' only mesh, then rebuild the problem. </p>
<div class="fragment"><div class="line"><a name="l14900"></a><span class="lineno">14900</span>&#160;  {</div>
<div class="line"><a name="l14901"></a><span class="lineno">14901</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">actions_before_adapt</a>();</div>
<div class="line"><a name="l14902"></a><span class="lineno">14902</span>&#160; </div>
<div class="line"><a name="l14903"></a><span class="lineno">14903</span>&#160;    <span class="comment">// Number of submeshes?</span></div>
<div class="line"><a name="l14904"></a><span class="lineno">14904</span>&#160;    <span class="keywordtype">unsigned</span> Nmesh = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>();</div>
<div class="line"><a name="l14905"></a><span class="lineno">14905</span>&#160; </div>
<div class="line"><a name="l14906"></a><span class="lineno">14906</span>&#160;    <span class="comment">// Single mesh:</span></div>
<div class="line"><a name="l14907"></a><span class="lineno">14907</span>&#160;    <span class="keywordflow">if</span> (Nmesh == 0)</div>
<div class="line"><a name="l14908"></a><span class="lineno">14908</span>&#160;    {</div>
<div class="line"><a name="l14909"></a><span class="lineno">14909</span>&#160;      <span class="comment">// Refine single mesh if possible</span></div>
<div class="line"><a name="l14910"></a><span class="lineno">14910</span>&#160;      <span class="keywordflow">if</span> (TreeBasedRefineableMeshBase* mmesh_pt =</div>
<div class="line"><a name="l14911"></a><span class="lineno">14911</span>&#160;            <span class="keyword">dynamic_cast&lt;</span>TreeBasedRefineableMeshBase*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(0)))</div>
<div class="line"><a name="l14912"></a><span class="lineno">14912</span>&#160;      {</div>
<div class="line"><a name="l14913"></a><span class="lineno">14913</span>&#160;        mmesh_pt-&gt;refine_selected_elements(elements_to_be_refined);</div>
<div class="line"><a name="l14914"></a><span class="lineno">14914</span>&#160;      }</div>
<div class="line"><a name="l14915"></a><span class="lineno">14915</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l14916"></a><span class="lineno">14916</span>&#160;      {</div>
<div class="line"><a name="l14917"></a><span class="lineno">14917</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Mesh cannot be refined &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l14918"></a><span class="lineno">14918</span>&#160;      }</div>
<div class="line"><a name="l14919"></a><span class="lineno">14919</span>&#160;    }</div>
<div class="line"><a name="l14920"></a><span class="lineno">14920</span>&#160;    <span class="comment">// Multiple submeshes</span></div>
<div class="line"><a name="l14921"></a><span class="lineno">14921</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l14922"></a><span class="lineno">14922</span>&#160;    {</div>
<div class="line"><a name="l14923"></a><span class="lineno">14923</span>&#160;      std::ostringstream error_message;</div>
<div class="line"><a name="l14924"></a><span class="lineno">14924</span>&#160;      error_message &lt;&lt; <span class="stringliteral">&quot;Problem::refine_selected_elements(...) only works for\n&quot;</span></div>
<div class="line"><a name="l14925"></a><span class="lineno">14925</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;multiple-mesh problems if you specify the mesh\n&quot;</span></div>
<div class="line"><a name="l14926"></a><span class="lineno">14926</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;number in the function argument before the Vector,\n&quot;</span></div>
<div class="line"><a name="l14927"></a><span class="lineno">14927</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;or a Vector of Vectors for each submesh.\n&quot;</span></div>
<div class="line"><a name="l14928"></a><span class="lineno">14928</span>&#160;                    &lt;&lt; std::endl;</div>
<div class="line"><a name="l14929"></a><span class="lineno">14929</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l14930"></a><span class="lineno">14930</span>&#160;        error_message.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l14931"></a><span class="lineno">14931</span>&#160;    }</div>
<div class="line"><a name="l14932"></a><span class="lineno">14932</span>&#160; </div>
<div class="line"><a name="l14933"></a><span class="lineno">14933</span>&#160;    <span class="comment">// Any actions after the adapatation phase</span></div>
<div class="line"><a name="l14934"></a><span class="lineno">14934</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">actions_after_adapt</a>();</div>
<div class="line"><a name="l14935"></a><span class="lineno">14935</span>&#160; </div>
<div class="line"><a name="l14936"></a><span class="lineno">14936</span>&#160;    <span class="comment">// Attach the boundary conditions to the mesh</span></div>
<div class="line"><a name="l14937"></a><span class="lineno">14937</span>&#160;    <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Number of equations: &quot;</span> &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers</a>() &lt;&lt; std::endl;</div>
<div class="line"><a name="l14938"></a><span class="lineno">14938</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">actions_after_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">actions_before_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, and <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>.</p>

</div>
</div>
<a id="ac52c14f8d7f44565516e2eee16923e8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac52c14f8d7f44565516e2eee16923e8b">&#9670;&nbsp;</a></span>refine_selected_elements() <span class="overload">[5/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::refine_selected_elements </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../dc/d08/classoomph_1_1RefineableElement.html">RefineableElement</a> * &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>elements_to_be_refined_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Refine all submeshes by splitting the elements identified by their pointers within each submesh in a Vector of Vectors, then rebuild the problem. </p>
<div class="fragment"><div class="line"><a name="l15124"></a><span class="lineno">15124</span>&#160;  {</div>
<div class="line"><a name="l15125"></a><span class="lineno">15125</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">actions_before_adapt</a>();</div>
<div class="line"><a name="l15126"></a><span class="lineno">15126</span>&#160; </div>
<div class="line"><a name="l15127"></a><span class="lineno">15127</span>&#160;    <span class="comment">// Number of submeshes?</span></div>
<div class="line"><a name="l15128"></a><span class="lineno">15128</span>&#160;    <span class="keywordtype">unsigned</span> n_mesh = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>();</div>
<div class="line"><a name="l15129"></a><span class="lineno">15129</span>&#160; </div>
<div class="line"><a name="l15130"></a><span class="lineno">15130</span>&#160;    <span class="comment">// Refine all submeshes if possible</span></div>
<div class="line"><a name="l15131"></a><span class="lineno">15131</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i_mesh = 0; i_mesh &lt; n_mesh; i_mesh++)</div>
<div class="line"><a name="l15132"></a><span class="lineno">15132</span>&#160;    {</div>
<div class="line"><a name="l15133"></a><span class="lineno">15133</span>&#160;      <span class="keywordflow">if</span> (TreeBasedRefineableMeshBase* mmesh_pt =</div>
<div class="line"><a name="l15134"></a><span class="lineno">15134</span>&#160;            <span class="keyword">dynamic_cast&lt;</span>TreeBasedRefineableMeshBase*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(i_mesh)))</div>
<div class="line"><a name="l15135"></a><span class="lineno">15135</span>&#160;      {</div>
<div class="line"><a name="l15136"></a><span class="lineno">15136</span>&#160;        mmesh_pt-&gt;refine_selected_elements(elements_to_be_refined_pt[i_mesh]);</div>
<div class="line"><a name="l15137"></a><span class="lineno">15137</span>&#160;      }</div>
<div class="line"><a name="l15138"></a><span class="lineno">15138</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l15139"></a><span class="lineno">15139</span>&#160;      {</div>
<div class="line"><a name="l15140"></a><span class="lineno">15140</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Mesh cannot be refined &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l15141"></a><span class="lineno">15141</span>&#160;      }</div>
<div class="line"><a name="l15142"></a><span class="lineno">15142</span>&#160;    }</div>
<div class="line"><a name="l15143"></a><span class="lineno">15143</span>&#160; </div>
<div class="line"><a name="l15144"></a><span class="lineno">15144</span>&#160;    <span class="comment">// Rebuild the global mesh</span></div>
<div class="line"><a name="l15145"></a><span class="lineno">15145</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a266d4d1b2bd4a5cbc028ff5aba79508f">rebuild_global_mesh</a>();</div>
<div class="line"><a name="l15146"></a><span class="lineno">15146</span>&#160; </div>
<div class="line"><a name="l15147"></a><span class="lineno">15147</span>&#160;    <span class="comment">// Any actions after the adapatation phase</span></div>
<div class="line"><a name="l15148"></a><span class="lineno">15148</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">actions_after_adapt</a>();</div>
<div class="line"><a name="l15149"></a><span class="lineno">15149</span>&#160; </div>
<div class="line"><a name="l15150"></a><span class="lineno">15150</span>&#160;    <span class="comment">// Do equation numbering</span></div>
<div class="line"><a name="l15151"></a><span class="lineno">15151</span>&#160;    <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Number of equations: &quot;</span> &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers</a>() &lt;&lt; std::endl;</div>
<div class="line"><a name="l15152"></a><span class="lineno">15152</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">actions_after_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">actions_before_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh()</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a266d4d1b2bd4a5cbc028ff5aba79508f">rebuild_global_mesh()</a>.</p>

</div>
</div>
<a id="aa5e5ab43882bd549ccbd2d92bb74b2f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5e5ab43882bd549ccbd2d92bb74b2f8">&#9670;&nbsp;</a></span>refine_selected_elements() <span class="overload">[6/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::refine_selected_elements </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>elements_to_be_refined</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Refine all submeshes by splitting the elements identified by their numbers relative to each submesh in a Vector of Vectors, then rebuild the problem. </p>
<div class="fragment"><div class="line"><a name="l15087"></a><span class="lineno">15087</span>&#160;  {</div>
<div class="line"><a name="l15088"></a><span class="lineno">15088</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">actions_before_adapt</a>();</div>
<div class="line"><a name="l15089"></a><span class="lineno">15089</span>&#160; </div>
<div class="line"><a name="l15090"></a><span class="lineno">15090</span>&#160;    <span class="comment">// Number of submeshes?</span></div>
<div class="line"><a name="l15091"></a><span class="lineno">15091</span>&#160;    <span class="keywordtype">unsigned</span> n_mesh = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>();</div>
<div class="line"><a name="l15092"></a><span class="lineno">15092</span>&#160; </div>
<div class="line"><a name="l15093"></a><span class="lineno">15093</span>&#160;    <span class="comment">// Refine all submeshes if possible</span></div>
<div class="line"><a name="l15094"></a><span class="lineno">15094</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i_mesh = 0; i_mesh &lt; n_mesh; i_mesh++)</div>
<div class="line"><a name="l15095"></a><span class="lineno">15095</span>&#160;    {</div>
<div class="line"><a name="l15096"></a><span class="lineno">15096</span>&#160;      <span class="keywordflow">if</span> (TreeBasedRefineableMeshBase* mmesh_pt =</div>
<div class="line"><a name="l15097"></a><span class="lineno">15097</span>&#160;            <span class="keyword">dynamic_cast&lt;</span>TreeBasedRefineableMeshBase*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(i_mesh)))</div>
<div class="line"><a name="l15098"></a><span class="lineno">15098</span>&#160;      {</div>
<div class="line"><a name="l15099"></a><span class="lineno">15099</span>&#160;        mmesh_pt-&gt;refine_selected_elements(elements_to_be_refined[i_mesh]);</div>
<div class="line"><a name="l15100"></a><span class="lineno">15100</span>&#160;      }</div>
<div class="line"><a name="l15101"></a><span class="lineno">15101</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l15102"></a><span class="lineno">15102</span>&#160;      {</div>
<div class="line"><a name="l15103"></a><span class="lineno">15103</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Mesh cannot be refined &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l15104"></a><span class="lineno">15104</span>&#160;      }</div>
<div class="line"><a name="l15105"></a><span class="lineno">15105</span>&#160;    }</div>
<div class="line"><a name="l15106"></a><span class="lineno">15106</span>&#160; </div>
<div class="line"><a name="l15107"></a><span class="lineno">15107</span>&#160;    <span class="comment">// Rebuild the global mesh</span></div>
<div class="line"><a name="l15108"></a><span class="lineno">15108</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a266d4d1b2bd4a5cbc028ff5aba79508f">rebuild_global_mesh</a>();</div>
<div class="line"><a name="l15109"></a><span class="lineno">15109</span>&#160; </div>
<div class="line"><a name="l15110"></a><span class="lineno">15110</span>&#160;    <span class="comment">// Any actions after the adapatation phase</span></div>
<div class="line"><a name="l15111"></a><span class="lineno">15111</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">actions_after_adapt</a>();</div>
<div class="line"><a name="l15112"></a><span class="lineno">15112</span>&#160; </div>
<div class="line"><a name="l15113"></a><span class="lineno">15113</span>&#160;    <span class="comment">// Do equation numbering</span></div>
<div class="line"><a name="l15114"></a><span class="lineno">15114</span>&#160;    <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Number of equations: &quot;</span> &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers</a>() &lt;&lt; std::endl;</div>
<div class="line"><a name="l15115"></a><span class="lineno">15115</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">actions_after_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">actions_before_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh()</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a266d4d1b2bd4a5cbc028ff5aba79508f">rebuild_global_mesh()</a>.</p>

</div>
</div>
<a id="ade208b7d7d8e866d5ba896f03edb1f9a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade208b7d7d8e866d5ba896f03edb1f9a">&#9670;&nbsp;</a></span>refine_uniformly() <span class="overload">[1/6]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Problem::refine_uniformly </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Refine (all) refineable (sub)mesh(es) uniformly and rebuild problem </p>
<div class="fragment"><div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;    {</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;      DocInfo doc_info;</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;      doc_info.disable_doc();</div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade208b7d7d8e866d5ba896f03edb1f9a">refine_uniformly</a>(doc_info);</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html#a666a20817ab9c396b225d8652bc0a338">oomph::DocInfo::disable_doc()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/db6/classFSIRingProblem.html#acbb3bc5cd6d16cfee7a2f19a3b984ce7">FSIRingProblem::dynamic_run()</a>, <a class="el" href="../../d8/d66/classQuarterCircleDrivenCavityProblem.html#ae5fd69acf7d28a600cb6aa0bbb6a341c">QuarterCircleDrivenCavityProblem&lt; ELEMENT &gt;::QuarterCircleDrivenCavityProblem()</a>, <a class="el" href="../../d4/d6c/classQuarterCircleDrivenCavityProblem2.html#a301f6d2c50e2d266126a80956397d78d">QuarterCircleDrivenCavityProblem2&lt; ELEMENT &gt;::QuarterCircleDrivenCavityProblem2()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a4f6011ef141cc68598a9502052129a3f">read()</a>, <a class="el" href="../../d8/d28/classUnsteadyHeatProblem.html#ab42eb6fd35ca415d1187f0748a80418e">UnsteadyHeatProblem&lt; ELEMENT &gt;::refine_uniformly()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae4ccf79fde59556d93af947618b6c80b">refine_uniformly()</a>.</p>

</div>
</div>
<a id="afae401b74b58d6312da32f153b78047d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afae401b74b58d6312da32f153b78047d">&#9670;&nbsp;</a></span>refine_uniformly() <span class="overload">[2/6]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Problem::refine_uniformly </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>i_mesh</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Do uniform refinement for submesh i_mesh without documentation. </p>
<div class="fragment"><div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;    {</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;      DocInfo doc_info;</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;      doc_info.disable_doc();</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade208b7d7d8e866d5ba896f03edb1f9a">refine_uniformly</a>(i_mesh, doc_info);</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html#a666a20817ab9c396b225d8652bc0a338">oomph::DocInfo::disable_doc()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ade208b7d7d8e866d5ba896f03edb1f9a">refine_uniformly()</a>.</p>

</div>
</div>
<a id="a1ce3a9162aaef9e0a4d86f8de57eb523"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ce3a9162aaef9e0a4d86f8de57eb523">&#9670;&nbsp;</a></span>refine_uniformly() <span class="overload">[3/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::refine_uniformly </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>i_mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>doc_info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Do uniform refinement for submesh i_mesh with documentation. </p>
<p>Refine submesh i_mesh uniformly and rebuild problem; doc refinement process. </p>
<div class="fragment"><div class="line"><a name="l15741"></a><span class="lineno">15741</span>&#160;  {</div>
<div class="line"><a name="l15742"></a><span class="lineno">15742</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">actions_before_adapt</a>();</div>
<div class="line"><a name="l15743"></a><span class="lineno">15743</span>&#160; </div>
<div class="line"><a name="l15744"></a><span class="lineno">15744</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l15745"></a><span class="lineno">15745</span>&#160;    <span class="comment">// Number of submeshes?</span></div>
<div class="line"><a name="l15746"></a><span class="lineno">15746</span>&#160;    <span class="keywordflow">if</span> (i_mesh &gt;= <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>())</div>
<div class="line"><a name="l15747"></a><span class="lineno">15747</span>&#160;    {</div>
<div class="line"><a name="l15748"></a><span class="lineno">15748</span>&#160;      std::ostringstream error_message;</div>
<div class="line"><a name="l15749"></a><span class="lineno">15749</span>&#160;      error_message &lt;&lt; <span class="stringliteral">&quot;imesh &quot;</span> &lt;&lt; i_mesh</div>
<div class="line"><a name="l15750"></a><span class="lineno">15750</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot; is greater than the number of sub meshes &quot;</span></div>
<div class="line"><a name="l15751"></a><span class="lineno">15751</span>&#160;                    &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>() &lt;&lt; std::endl;</div>
<div class="line"><a name="l15752"></a><span class="lineno">15752</span>&#160; </div>
<div class="line"><a name="l15753"></a><span class="lineno">15753</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l15754"></a><span class="lineno">15754</span>&#160;        error_message.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l15755"></a><span class="lineno">15755</span>&#160;    }</div>
<div class="line"><a name="l15756"></a><span class="lineno">15756</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l15757"></a><span class="lineno">15757</span>&#160; </div>
<div class="line"><a name="l15758"></a><span class="lineno">15758</span>&#160;    <span class="comment">// Refine single mesh uniformly if possible</span></div>
<div class="line"><a name="l15759"></a><span class="lineno">15759</span>&#160;    <span class="keywordflow">if</span> (RefineableMeshBase* mmesh_pt =</div>
<div class="line"><a name="l15760"></a><span class="lineno">15760</span>&#160;          <span class="keyword">dynamic_cast&lt;</span>RefineableMeshBase*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(i_mesh)))</div>
<div class="line"><a name="l15761"></a><span class="lineno">15761</span>&#160;    {</div>
<div class="line"><a name="l15762"></a><span class="lineno">15762</span>&#160;      mmesh_pt-&gt;refine_uniformly(doc_info);</div>
<div class="line"><a name="l15763"></a><span class="lineno">15763</span>&#160;    }</div>
<div class="line"><a name="l15764"></a><span class="lineno">15764</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l15765"></a><span class="lineno">15765</span>&#160;    {</div>
<div class="line"><a name="l15766"></a><span class="lineno">15766</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Mesh cannot be refined uniformly &quot;</span></div>
<div class="line"><a name="l15767"></a><span class="lineno">15767</span>&#160;                 &lt;&lt; std::endl;</div>
<div class="line"><a name="l15768"></a><span class="lineno">15768</span>&#160;    }</div>
<div class="line"><a name="l15769"></a><span class="lineno">15769</span>&#160; </div>
<div class="line"><a name="l15770"></a><span class="lineno">15770</span>&#160;    <span class="comment">// Rebuild the global mesh</span></div>
<div class="line"><a name="l15771"></a><span class="lineno">15771</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a266d4d1b2bd4a5cbc028ff5aba79508f">rebuild_global_mesh</a>();</div>
<div class="line"><a name="l15772"></a><span class="lineno">15772</span>&#160; </div>
<div class="line"><a name="l15773"></a><span class="lineno">15773</span>&#160;    <span class="comment">// Any actions after the adaptation phase</span></div>
<div class="line"><a name="l15774"></a><span class="lineno">15774</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">actions_after_adapt</a>();</div>
<div class="line"><a name="l15775"></a><span class="lineno">15775</span>&#160; </div>
<div class="line"><a name="l15776"></a><span class="lineno">15776</span>&#160;    <span class="comment">// Do equation numbering</span></div>
<div class="line"><a name="l15777"></a><span class="lineno">15777</span>&#160;    <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Number of equations: &quot;</span> &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers</a>() &lt;&lt; std::endl;</div>
<div class="line"><a name="l15778"></a><span class="lineno">15778</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">actions_after_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">actions_before_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a266d4d1b2bd4a5cbc028ff5aba79508f">rebuild_global_mesh()</a>.</p>

</div>
</div>
<a id="a181fa92838f77bd6b12b531dca222c41"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a181fa92838f77bd6b12b531dca222c41">&#9670;&nbsp;</a></span>refine_uniformly() <span class="overload">[4/6]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Problem::refine_uniformly </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>nrefine_for_mesh</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Refine refineable sub-meshes, each as many times as specified in the vector and rebuild problem </p>
<div class="fragment"><div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;    {</div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;      DocInfo doc_info;</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;      doc_info.disable_doc();</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;      <span class="keywordtype">bool</span> prune = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#affb22db0c6f1e14ae120b153b85831a3">refine_uniformly_aux</a>(nrefine_for_mesh, doc_info, prune);</div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1Problem_html_affb22db0c6f1e14ae120b153b85831a3"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#affb22db0c6f1e14ae120b153b85831a3">oomph::Problem::refine_uniformly_aux</a></div><div class="ttdeci">void refine_uniformly_aux(const Vector&lt; unsigned &gt; &amp;nrefine_for_mesh, DocInfo &amp;doc_info, const bool &amp;prune)</div><div class="ttdef"><b>Definition:</b> problem.cc:15445</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html#a666a20817ab9c396b225d8652bc0a338">oomph::DocInfo::disable_doc()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#affb22db0c6f1e14ae120b153b85831a3">refine_uniformly_aux()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/d1e/one__d__poisson__hp__adapt_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main()</a>, and <a class="el" href="../../d4/d6b/three__d__mesh__dist_8cc.html#a3e9491dd4f7081f92d170df562503838">parallel_test()</a>.</p>

</div>
</div>
<a id="a14ca1d18e9aa569a6417c45eef70d3ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14ca1d18e9aa569a6417c45eef70d3ff">&#9670;&nbsp;</a></span>refine_uniformly() <span class="overload">[5/6]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Problem::refine_uniformly </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>nrefine_for_mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>doc_info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Refine refineable sub-meshes, each as many times as specified in the vector and rebuild problem; doc refinement process </p>
<div class="fragment"><div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;    {</div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;      <span class="keywordtype">bool</span> prune = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#affb22db0c6f1e14ae120b153b85831a3">refine_uniformly_aux</a>(nrefine_for_mesh, doc_info, prune);</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#affb22db0c6f1e14ae120b153b85831a3">refine_uniformly_aux()</a>.</p>

</div>
</div>
<a id="ae4ccf79fde59556d93af947618b6c80b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4ccf79fde59556d93af947618b6c80b">&#9670;&nbsp;</a></span>refine_uniformly() <span class="overload">[6/6]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Problem::refine_uniformly </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>doc_info</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Refine (all) refineable (sub)mesh(es) uniformly and rebuild problem; doc refinement process. </p>
<div class="fragment"><div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;    {</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;      <span class="comment">// Number of (sub)meshes</span></div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;      <span class="keywordtype">unsigned</span> nmesh = <a class="code" href="../../dc/d51/datatypes_8h.html#affe776513b24d84b39af8ab0930fef7f">std::max</a>(<span class="keywordtype">unsigned</span>(1), <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>());</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160; </div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;      <span class="comment">// Refine each mesh once</span></div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;      Vector&lt;unsigned&gt; nrefine_for_mesh(nmesh, 1);</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade208b7d7d8e866d5ba896f03edb1f9a">refine_uniformly</a>(nrefine_for_mesh);</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d51/datatypes_8h.html#affe776513b24d84b39af8ab0930fef7f">max</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ade208b7d7d8e866d5ba896f03edb1f9a">refine_uniformly()</a>.</p>

</div>
</div>
<a id="a3930fc0977bdc33f52100e53f5d878d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3930fc0977bdc33f52100e53f5d878d7">&#9670;&nbsp;</a></span>refine_uniformly_and_prune() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Problem::refine_uniformly_and_prune </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>nrefine_for_mesh</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Refine refineable sub-meshes, each as many times as specified in the vector and rebuild problem. Prune after refinements </p>
<div class="fragment"><div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;    {</div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;      DocInfo doc_info;</div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;      doc_info.disable_doc();</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;      <span class="keywordtype">bool</span> prune = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#affb22db0c6f1e14ae120b153b85831a3">refine_uniformly_aux</a>(nrefine_for_mesh, doc_info, prune);</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html#a666a20817ab9c396b225d8652bc0a338">oomph::DocInfo::disable_doc()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#affb22db0c6f1e14ae120b153b85831a3">refine_uniformly_aux()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac0495df29dde90577e4702fcac496684">refine_uniformly_and_prune()</a>.</p>

</div>
</div>
<a id="adea5168244acebb539fa29e36182ced3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adea5168244acebb539fa29e36182ced3">&#9670;&nbsp;</a></span>refine_uniformly_and_prune() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Problem::refine_uniformly_and_prune </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>nrefine_for_mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>doc_info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Refine refineable sub-meshes, each as many times as specified in the vector and rebuild problem; doc refinement process </p>
<div class="fragment"><div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;    {</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;      <span class="keywordtype">bool</span> prune = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#affb22db0c6f1e14ae120b153b85831a3">refine_uniformly_aux</a>(nrefine_for_mesh, doc_info, prune);</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#affb22db0c6f1e14ae120b153b85831a3">refine_uniformly_aux()</a>.</p>

</div>
</div>
<a id="ac0495df29dde90577e4702fcac496684"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0495df29dde90577e4702fcac496684">&#9670;&nbsp;</a></span>refine_uniformly_and_prune() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Problem::refine_uniformly_and_prune </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>doc_info</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Refine (all) refineable (sub)mesh(es) uniformly and rebuild problem; doc refinement process. </p>
<div class="fragment"><div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;    {</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;      <span class="comment">// Number of (sub)meshes</span></div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;      <span class="keywordtype">unsigned</span> nmesh = <a class="code" href="../../dc/d51/datatypes_8h.html#affe776513b24d84b39af8ab0930fef7f">std::max</a>(<span class="keywordtype">unsigned</span>(1), <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>());</div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160; </div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;      <span class="comment">// Refine each mesh once</span></div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;      Vector&lt;unsigned&gt; nrefine_for_mesh(nmesh, 1);</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a3930fc0977bdc33f52100e53f5d878d7">refine_uniformly_and_prune</a>(nrefine_for_mesh);</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a3930fc0977bdc33f52100e53f5d878d7"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a3930fc0977bdc33f52100e53f5d878d7">oomph::Problem::refine_uniformly_and_prune</a></div><div class="ttdeci">void refine_uniformly_and_prune(const Vector&lt; unsigned &gt; &amp;nrefine_for_mesh)</div><div class="ttdef"><b>Definition:</b> problem.h:2595</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d51/datatypes_8h.html#affe776513b24d84b39af8ab0930fef7f">max</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a3930fc0977bdc33f52100e53f5d878d7">refine_uniformly_and_prune()</a>.</p>

</div>
</div>
<a id="affb22db0c6f1e14ae120b153b85831a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#affb22db0c6f1e14ae120b153b85831a3">&#9670;&nbsp;</a></span>refine_uniformly_aux()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::refine_uniformly_aux </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>nrefine_for_mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>doc_info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;&#160;</td>
          <td class="paramname"><em>prune</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Helper function to do compund refinement of (all) refineable (sub)mesh(es) uniformly as many times as specified in vector and rebuild problem; doc refinement process. Set boolean argument to true if you want to prune immediately after refining the meshes individually. </p>
<div class="fragment"><div class="line"><a name="l15448"></a><span class="lineno">15448</span>&#160;  {</div>
<div class="line"><a name="l15449"></a><span class="lineno">15449</span>&#160;    <span class="keywordtype">double</span> t_start = 0.0;</div>
<div class="line"><a name="l15450"></a><span class="lineno">15450</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l15451"></a><span class="lineno">15451</span>&#160;    {</div>
<div class="line"><a name="l15452"></a><span class="lineno">15452</span>&#160;      t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l15453"></a><span class="lineno">15453</span>&#160;    }</div>
<div class="line"><a name="l15454"></a><span class="lineno">15454</span>&#160; </div>
<div class="line"><a name="l15455"></a><span class="lineno">15455</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">actions_before_adapt</a>();</div>
<div class="line"><a name="l15456"></a><span class="lineno">15456</span>&#160; </div>
<div class="line"><a name="l15457"></a><span class="lineno">15457</span>&#160;    <span class="keywordtype">double</span> t_end = 0.0;</div>
<div class="line"><a name="l15458"></a><span class="lineno">15458</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l15459"></a><span class="lineno">15459</span>&#160;    {</div>
<div class="line"><a name="l15460"></a><span class="lineno">15460</span>&#160;      t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l15461"></a><span class="lineno">15461</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a></div>
<div class="line"><a name="l15462"></a><span class="lineno">15462</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;Time for actions before adapt in Problem::refine_uniformly_aux(): &quot;</span></div>
<div class="line"><a name="l15463"></a><span class="lineno">15463</span>&#160;        &lt;&lt; t_end - t_start &lt;&lt; std::endl;</div>
<div class="line"><a name="l15464"></a><span class="lineno">15464</span>&#160;      t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l15465"></a><span class="lineno">15465</span>&#160;    }</div>
<div class="line"><a name="l15466"></a><span class="lineno">15466</span>&#160; </div>
<div class="line"><a name="l15467"></a><span class="lineno">15467</span>&#160;    <span class="comment">// Number of submeshes?</span></div>
<div class="line"><a name="l15468"></a><span class="lineno">15468</span>&#160;    <span class="keywordtype">unsigned</span> n_mesh = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>();</div>
<div class="line"><a name="l15469"></a><span class="lineno">15469</span>&#160; </div>
<div class="line"><a name="l15470"></a><span class="lineno">15470</span>&#160;    <span class="comment">// Single mesh:</span></div>
<div class="line"><a name="l15471"></a><span class="lineno">15471</span>&#160;    <span class="keywordflow">if</span> (n_mesh == 0)</div>
<div class="line"><a name="l15472"></a><span class="lineno">15472</span>&#160;    {</div>
<div class="line"><a name="l15473"></a><span class="lineno">15473</span>&#160;      <span class="comment">// Refine single mesh uniformly if possible</span></div>
<div class="line"><a name="l15474"></a><span class="lineno">15474</span>&#160;      <span class="keywordflow">if</span> (RefineableMeshBase* mmesh_pt =</div>
<div class="line"><a name="l15475"></a><span class="lineno">15475</span>&#160;            <span class="keyword">dynamic_cast&lt;</span>RefineableMeshBase*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(0)))</div>
<div class="line"><a name="l15476"></a><span class="lineno">15476</span>&#160;      {</div>
<div class="line"><a name="l15477"></a><span class="lineno">15477</span>&#160;        <span class="keywordtype">unsigned</span> nref = nrefine_for_mesh[0];</div>
<div class="line"><a name="l15478"></a><span class="lineno">15478</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; nref; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l15479"></a><span class="lineno">15479</span>&#160;        {</div>
<div class="line"><a name="l15480"></a><span class="lineno">15480</span>&#160;          mmesh_pt-&gt;refine_uniformly(doc_info);</div>
<div class="line"><a name="l15481"></a><span class="lineno">15481</span>&#160;        }</div>
<div class="line"><a name="l15482"></a><span class="lineno">15482</span>&#160;      }</div>
<div class="line"><a name="l15483"></a><span class="lineno">15483</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l15484"></a><span class="lineno">15484</span>&#160;      {</div>
<div class="line"><a name="l15485"></a><span class="lineno">15485</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Mesh cannot be refined uniformly &quot;</span></div>
<div class="line"><a name="l15486"></a><span class="lineno">15486</span>&#160;                   &lt;&lt; std::endl;</div>
<div class="line"><a name="l15487"></a><span class="lineno">15487</span>&#160;      }</div>
<div class="line"><a name="l15488"></a><span class="lineno">15488</span>&#160;    }</div>
<div class="line"><a name="l15489"></a><span class="lineno">15489</span>&#160;    <span class="comment">// Multiple submeshes</span></div>
<div class="line"><a name="l15490"></a><span class="lineno">15490</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l15491"></a><span class="lineno">15491</span>&#160;    {</div>
<div class="line"><a name="l15492"></a><span class="lineno">15492</span>&#160;      <span class="comment">// Loop over submeshes</span></div>
<div class="line"><a name="l15493"></a><span class="lineno">15493</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> imesh = 0; imesh &lt; n_mesh; imesh++)</div>
<div class="line"><a name="l15494"></a><span class="lineno">15494</span>&#160;      {</div>
<div class="line"><a name="l15495"></a><span class="lineno">15495</span>&#160;        <span class="comment">// Refine i-th submesh uniformly if possible</span></div>
<div class="line"><a name="l15496"></a><span class="lineno">15496</span>&#160;        <span class="keywordflow">if</span> (RefineableMeshBase* mmesh_pt =</div>
<div class="line"><a name="l15497"></a><span class="lineno">15497</span>&#160;              <span class="keyword">dynamic_cast&lt;</span>RefineableMeshBase*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(imesh)))</div>
<div class="line"><a name="l15498"></a><span class="lineno">15498</span>&#160;        {</div>
<div class="line"><a name="l15499"></a><span class="lineno">15499</span>&#160;          <span class="keywordtype">unsigned</span> nref = nrefine_for_mesh[imesh];</div>
<div class="line"><a name="l15500"></a><span class="lineno">15500</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; nref; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l15501"></a><span class="lineno">15501</span>&#160;          {</div>
<div class="line"><a name="l15502"></a><span class="lineno">15502</span>&#160;            mmesh_pt-&gt;refine_uniformly(doc_info);</div>
<div class="line"><a name="l15503"></a><span class="lineno">15503</span>&#160;          }</div>
<div class="line"><a name="l15504"></a><span class="lineno">15504</span>&#160;        }</div>
<div class="line"><a name="l15505"></a><span class="lineno">15505</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l15506"></a><span class="lineno">15506</span>&#160;        {</div>
<div class="line"><a name="l15507"></a><span class="lineno">15507</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Cannot refine mesh &quot;</span> &lt;&lt; imesh</div>
<div class="line"><a name="l15508"></a><span class="lineno">15508</span>&#160;                     &lt;&lt; std::endl;</div>
<div class="line"><a name="l15509"></a><span class="lineno">15509</span>&#160;        }</div>
<div class="line"><a name="l15510"></a><span class="lineno">15510</span>&#160;      }</div>
<div class="line"><a name="l15511"></a><span class="lineno">15511</span>&#160;      <span class="comment">// Rebuild the global mesh</span></div>
<div class="line"><a name="l15512"></a><span class="lineno">15512</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a266d4d1b2bd4a5cbc028ff5aba79508f">rebuild_global_mesh</a>();</div>
<div class="line"><a name="l15513"></a><span class="lineno">15513</span>&#160;    }</div>
<div class="line"><a name="l15514"></a><span class="lineno">15514</span>&#160; </div>
<div class="line"><a name="l15515"></a><span class="lineno">15515</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l15516"></a><span class="lineno">15516</span>&#160;    {</div>
<div class="line"><a name="l15517"></a><span class="lineno">15517</span>&#160;      t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l15518"></a><span class="lineno">15518</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for mesh-level mesh refinement in &quot;</span></div>
<div class="line"><a name="l15519"></a><span class="lineno">15519</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;Problem::refine_uniformly_aux(): &quot;</span> &lt;&lt; t_end - t_start</div>
<div class="line"><a name="l15520"></a><span class="lineno">15520</span>&#160;                 &lt;&lt; std::endl;</div>
<div class="line"><a name="l15521"></a><span class="lineno">15521</span>&#160;      t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l15522"></a><span class="lineno">15522</span>&#160;    }</div>
<div class="line"><a name="l15523"></a><span class="lineno">15523</span>&#160; </div>
<div class="line"><a name="l15524"></a><span class="lineno">15524</span>&#160;    <span class="comment">// Any actions after the adaptation phase</span></div>
<div class="line"><a name="l15525"></a><span class="lineno">15525</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">actions_after_adapt</a>();</div>
<div class="line"><a name="l15526"></a><span class="lineno">15526</span>&#160; </div>
<div class="line"><a name="l15527"></a><span class="lineno">15527</span>&#160; </div>
<div class="line"><a name="l15528"></a><span class="lineno">15528</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l15529"></a><span class="lineno">15529</span>&#160;    {</div>
<div class="line"><a name="l15530"></a><span class="lineno">15530</span>&#160;      t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l15531"></a><span class="lineno">15531</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a></div>
<div class="line"><a name="l15532"></a><span class="lineno">15532</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;Time for actions after adapt  Problem::refine_uniformly_aux(): &quot;</span></div>
<div class="line"><a name="l15533"></a><span class="lineno">15533</span>&#160;        &lt;&lt; t_end - t_start &lt;&lt; std::endl;</div>
<div class="line"><a name="l15534"></a><span class="lineno">15534</span>&#160;      t_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l15535"></a><span class="lineno">15535</span>&#160;    }</div>
<div class="line"><a name="l15536"></a><span class="lineno">15536</span>&#160; </div>
<div class="line"><a name="l15537"></a><span class="lineno">15537</span>&#160; </div>
<div class="line"><a name="l15538"></a><span class="lineno">15538</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l15539"></a><span class="lineno">15539</span>&#160; </div>
<div class="line"><a name="l15540"></a><span class="lineno">15540</span>&#160;    <span class="comment">// Prune it?</span></div>
<div class="line"><a name="l15541"></a><span class="lineno">15541</span>&#160;    <span class="keywordflow">if</span> (prune)</div>
<div class="line"><a name="l15542"></a><span class="lineno">15542</span>&#160;    {</div>
<div class="line"><a name="l15543"></a><span class="lineno">15543</span>&#160;      <span class="comment">// Note: This calls assign eqn numbers already...</span></div>
<div class="line"><a name="l15544"></a><span class="lineno">15544</span>&#160;      Bypass_increase_in_dof_check_during_pruning = <span class="keyword">true</span>;</div>
<div class="line"><a name="l15545"></a><span class="lineno">15545</span>&#160;      prune_halo_elements_and_nodes();</div>
<div class="line"><a name="l15546"></a><span class="lineno">15546</span>&#160;      Bypass_increase_in_dof_check_during_pruning = <span class="keyword">false</span>;</div>
<div class="line"><a name="l15547"></a><span class="lineno">15547</span>&#160; </div>
<div class="line"><a name="l15548"></a><span class="lineno">15548</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l15549"></a><span class="lineno">15549</span>&#160;      {</div>
<div class="line"><a name="l15550"></a><span class="lineno">15550</span>&#160;        t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l15551"></a><span class="lineno">15551</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for Problem::prune_halo_elements_and_nodes() in &quot;</span></div>
<div class="line"><a name="l15552"></a><span class="lineno">15552</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;Problem::refine_uniformly_aux(): &quot;</span> &lt;&lt; t_end - t_start</div>
<div class="line"><a name="l15553"></a><span class="lineno">15553</span>&#160;                   &lt;&lt; std::endl;</div>
<div class="line"><a name="l15554"></a><span class="lineno">15554</span>&#160;      }</div>
<div class="line"><a name="l15555"></a><span class="lineno">15555</span>&#160;    }</div>
<div class="line"><a name="l15556"></a><span class="lineno">15556</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l15557"></a><span class="lineno">15557</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l15558"></a><span class="lineno">15558</span>&#160;    <span class="keywordflow">if</span> (prune)</div>
<div class="line"><a name="l15559"></a><span class="lineno">15559</span>&#160;    {</div>
<div class="line"><a name="l15560"></a><span class="lineno">15560</span>&#160;      std::ostringstream error_message;</div>
<div class="line"><a name="l15561"></a><span class="lineno">15561</span>&#160;      error_message</div>
<div class="line"><a name="l15562"></a><span class="lineno">15562</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;Requested pruning in serial build. Ignoring the request.\n&quot;</span>;</div>
<div class="line"><a name="l15563"></a><span class="lineno">15563</span>&#160;      OomphLibWarning(error_message.str(),</div>
<div class="line"><a name="l15564"></a><span class="lineno">15564</span>&#160;                      <span class="stringliteral">&quot;Problem::refine_uniformly_aux()&quot;</span>,</div>
<div class="line"><a name="l15565"></a><span class="lineno">15565</span>&#160;                      <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l15566"></a><span class="lineno">15566</span>&#160;    }</div>
<div class="line"><a name="l15567"></a><span class="lineno">15567</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l15568"></a><span class="lineno">15568</span>&#160;    {</div>
<div class="line"><a name="l15569"></a><span class="lineno">15569</span>&#160;      <span class="comment">// Do equation numbering</span></div>
<div class="line"><a name="l15570"></a><span class="lineno">15570</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a></div>
<div class="line"><a name="l15571"></a><span class="lineno">15571</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;Number of equations after Problem::refine_uniformly_aux(): &quot;</span></div>
<div class="line"><a name="l15572"></a><span class="lineno">15572</span>&#160;        &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers</a>() &lt;&lt; std::endl;</div>
<div class="line"><a name="l15573"></a><span class="lineno">15573</span>&#160; </div>
<div class="line"><a name="l15574"></a><span class="lineno">15574</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">Global_timings::Doc_comprehensive_timings</a>)</div>
<div class="line"><a name="l15575"></a><span class="lineno">15575</span>&#160;      {</div>
<div class="line"><a name="l15576"></a><span class="lineno">15576</span>&#160;        t_end = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l15577"></a><span class="lineno">15577</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time for Problem::assign_eqn_numbers() in &quot;</span></div>
<div class="line"><a name="l15578"></a><span class="lineno">15578</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;Problem::refine_uniformly_aux(): &quot;</span> &lt;&lt; t_end - t_start</div>
<div class="line"><a name="l15579"></a><span class="lineno">15579</span>&#160;                   &lt;&lt; std::endl;</div>
<div class="line"><a name="l15580"></a><span class="lineno">15580</span>&#160;      }</div>
<div class="line"><a name="l15581"></a><span class="lineno">15581</span>&#160;    }</div>
<div class="line"><a name="l15582"></a><span class="lineno">15582</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">actions_after_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">actions_before_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers()</a>, <a class="el" href="../../da/dee/namespaceoomph_1_1Global__timings.html#af25dd181537f6e338daadd0a73d269a0">oomph::Global_timings::Doc_comprehensive_timings</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a266d4d1b2bd4a5cbc028ff5aba79508f">rebuild_global_mesh()</a>, and <a class="el" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">oomph::TimingHelpers::timer()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a181fa92838f77bd6b12b531dca222c41">refine_uniformly()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a3930fc0977bdc33f52100e53f5d878d7">refine_uniformly_and_prune()</a>.</p>

</div>
</div>
<a id="a6477df6e8184dc78e9d9ff82c7627cef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6477df6e8184dc78e9d9ff82c7627cef">&#9670;&nbsp;</a></span>reset_arc_length_parameters()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Problem::reset_arc_length_parameters </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Reset the "internal" arc-length continuation parameters, so as to allow continuation in another parameter. N.B. The parameters that are reset are the "minimum" that are required, others should perhaps be reset, depending upon the application. </p>
<div class="fragment"><div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;    {</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a123843ca2ed6384342939ef2b19477ef">Theta_squared</a> = 1.0;</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aca97d61840e46edc914e3cb4b98fd437">Sign_of_jacobian</a> = 0;</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a6904003416e9a9257db70c009bdc69ed">Continuation_direction</a> = 1.0;</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa5082325ca4cafe5a9ec03ef79c67a6f">Parameter_derivative</a> = 1.0;</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a643f61299463a3bbf7be3f6a112aa130">First_jacobian_sign_change</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a8109bf56e9203d248ae30a50bb9cfe90">Arc_length_step_taken</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a1861321b2d129707935bf1191238daca">Dof_derivative</a>.resize(0);</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a8109bf56e9203d248ae30a50bb9cfe90">Arc_length_step_taken</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6904003416e9a9257db70c009bdc69ed">Continuation_direction</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a1861321b2d129707935bf1191238daca">Dof_derivative</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a643f61299463a3bbf7be3f6a112aa130">First_jacobian_sign_change</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa5082325ca4cafe5a9ec03ef79c67a6f">Parameter_derivative</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aca97d61840e46edc914e3cb4b98fd437">Sign_of_jacobian</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a123843ca2ed6384342939ef2b19477ef">Theta_squared</a>.</p>

</div>
</div>
<a id="a0b6b29c5e2ae9d4a22dac5b4494b7bc4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b6b29c5e2ae9d4a22dac5b4494b7bc4">&#9670;&nbsp;</a></span>reset_assembly_handler_to_default()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::reset_assembly_handler_to_default </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset the system to the standard non-augemented state. </p>
<p>Reset the assembly handler to default. </p>
<div class="fragment"><div class="line"><a name="l10276"></a><span class="lineno">10276</span>&#160;  {</div>
<div class="line"><a name="l10277"></a><span class="lineno">10277</span>&#160;    <span class="comment">// If we have a non-default handler</span></div>
<div class="line"><a name="l10278"></a><span class="lineno">10278</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a> != <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae0cebe288c8daddd9663bd10d8f1caa0">Default_assembly_handler_pt</a>)</div>
<div class="line"><a name="l10279"></a><span class="lineno">10279</span>&#160;    {</div>
<div class="line"><a name="l10280"></a><span class="lineno">10280</span>&#160;      <span class="comment">// Delete the current assembly handler</span></div>
<div class="line"><a name="l10281"></a><span class="lineno">10281</span>&#160;      <span class="keyword">delete</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>;</div>
<div class="line"><a name="l10282"></a><span class="lineno">10282</span>&#160;      <span class="comment">// Reset the assembly handler</span></div>
<div class="line"><a name="l10283"></a><span class="lineno">10283</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a> = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae0cebe288c8daddd9663bd10d8f1caa0">Default_assembly_handler_pt</a>;</div>
<div class="line"><a name="l10284"></a><span class="lineno">10284</span>&#160;    }</div>
<div class="line"><a name="l10285"></a><span class="lineno">10285</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae0cebe288c8daddd9663bd10d8f1caa0">Default_assembly_handler_pt</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a9ed88021ec449655c64191154dd236af">activate_bifurcation_tracking()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa4f954e46b84b13a2bb16a83b3f0ff83">activate_fold_tracking()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5202944fe909268c20abcfb4576d147b">activate_hopf_tracking()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a66fd78008266a4023f450971af444508">activate_pitchfork_tracking()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac5b47ae12ed6445e52c65596dfa97c6d">deactivate_bifurcation_tracking()</a>.</p>

</div>
</div>
<a id="a3c927ed4f3e79527e0e23ac44779f0f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c927ed4f3e79527e0e23ac44779f0f8">&#9670;&nbsp;</a></span>restore_dof_values()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::restore_dof_values </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Restore the stored values of the degrees of freedom. </p>
<p>Restore the saved dofs. </p>
<div class="fragment"><div class="line"><a name="l08654"></a><span class="lineno"> 8654</span>&#160;  {</div>
<div class="line"><a name="l08655"></a><span class="lineno"> 8655</span>&#160;    <span class="comment">// Check that we can do this</span></div>
<div class="line"><a name="l08656"></a><span class="lineno"> 8656</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aeef791a0158657ca7c298ffcb63ed54e">Saved_dof_pt</a> == 0)</div>
<div class="line"><a name="l08657"></a><span class="lineno"> 8657</span>&#160;    {</div>
<div class="line"><a name="l08658"></a><span class="lineno"> 8658</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l08659"></a><span class="lineno"> 8659</span>&#160;        <span class="stringliteral">&quot;There are no stored values, use store_current_dof_values()\n&quot;</span>,</div>
<div class="line"><a name="l08660"></a><span class="lineno"> 8660</span>&#160;        <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l08661"></a><span class="lineno"> 8661</span>&#160;        <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l08662"></a><span class="lineno"> 8662</span>&#160;    }</div>
<div class="line"><a name="l08663"></a><span class="lineno"> 8663</span>&#160; </div>
<div class="line"><a name="l08664"></a><span class="lineno"> 8664</span>&#160; </div>
<div class="line"><a name="l08665"></a><span class="lineno"> 8665</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l08666"></a><span class="lineno"> 8666</span>&#160;    <span class="comment">// If the problem is distributed I have to do something different</span></div>
<div class="line"><a name="l08667"></a><span class="lineno"> 8667</span>&#160;    <span class="keywordflow">if</span> (Problem_has_been_distributed)</div>
<div class="line"><a name="l08668"></a><span class="lineno"> 8668</span>&#160;    {</div>
<div class="line"><a name="l08669"></a><span class="lineno"> 8669</span>&#160;      <span class="comment">// How many entries do we store locally?</span></div>
<div class="line"><a name="l08670"></a><span class="lineno"> 8670</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_row_local = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">nrow_local</a>();</div>
<div class="line"><a name="l08671"></a><span class="lineno"> 8671</span>&#160; </div>
<div class="line"><a name="l08672"></a><span class="lineno"> 8672</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aeef791a0158657ca7c298ffcb63ed54e">Saved_dof_pt</a>-&gt;size() != n_row_local)</div>
<div class="line"><a name="l08673"></a><span class="lineno"> 8673</span>&#160;      {</div>
<div class="line"><a name="l08674"></a><span class="lineno"> 8674</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(<span class="stringliteral">&quot;The number of stored values is not equal to the &quot;</span></div>
<div class="line"><a name="l08675"></a><span class="lineno"> 8675</span>&#160;                            <span class="stringliteral">&quot;current number of dofs\n&quot;</span>,</div>
<div class="line"><a name="l08676"></a><span class="lineno"> 8676</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l08677"></a><span class="lineno"> 8677</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l08678"></a><span class="lineno"> 8678</span>&#160;      }</div>
<div class="line"><a name="l08679"></a><span class="lineno"> 8679</span>&#160; </div>
<div class="line"><a name="l08680"></a><span class="lineno"> 8680</span>&#160;      <span class="comment">// Transfer the values over</span></div>
<div class="line"><a name="l08681"></a><span class="lineno"> 8681</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_row_local; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l08682"></a><span class="lineno"> 8682</span>&#160;      {</div>
<div class="line"><a name="l08683"></a><span class="lineno"> 8683</span>&#160;        *(this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>]) = (*<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aeef791a0158657ca7c298ffcb63ed54e">Saved_dof_pt</a>)[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>];</div>
<div class="line"><a name="l08684"></a><span class="lineno"> 8684</span>&#160;      }</div>
<div class="line"><a name="l08685"></a><span class="lineno"> 8685</span>&#160;    }</div>
<div class="line"><a name="l08686"></a><span class="lineno"> 8686</span>&#160;    <span class="comment">// Otherwise just restore all the dofs</span></div>
<div class="line"><a name="l08687"></a><span class="lineno"> 8687</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l08688"></a><span class="lineno"> 8688</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l08689"></a><span class="lineno"> 8689</span>&#160;    {</div>
<div class="line"><a name="l08690"></a><span class="lineno"> 8690</span>&#160;      <span class="comment">// Find the number of dofs</span></div>
<div class="line"><a name="l08691"></a><span class="lineno"> 8691</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n_dof = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>();</div>
<div class="line"><a name="l08692"></a><span class="lineno"> 8692</span>&#160; </div>
<div class="line"><a name="l08693"></a><span class="lineno"> 8693</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aeef791a0158657ca7c298ffcb63ed54e">Saved_dof_pt</a>-&gt;size() != n_dof)</div>
<div class="line"><a name="l08694"></a><span class="lineno"> 8694</span>&#160;      {</div>
<div class="line"><a name="l08695"></a><span class="lineno"> 8695</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(<span class="stringliteral">&quot;The number of stored values is not equal to the &quot;</span></div>
<div class="line"><a name="l08696"></a><span class="lineno"> 8696</span>&#160;                            <span class="stringliteral">&quot;current number of dofs\n&quot;</span>,</div>
<div class="line"><a name="l08697"></a><span class="lineno"> 8697</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l08698"></a><span class="lineno"> 8698</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l08699"></a><span class="lineno"> 8699</span>&#160;      }</div>
<div class="line"><a name="l08700"></a><span class="lineno"> 8700</span>&#160; </div>
<div class="line"><a name="l08701"></a><span class="lineno"> 8701</span>&#160;      <span class="comment">// Transfer the values over</span></div>
<div class="line"><a name="l08702"></a><span class="lineno"> 8702</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_dof; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l08703"></a><span class="lineno"> 8703</span>&#160;      {</div>
<div class="line"><a name="l08704"></a><span class="lineno"> 8704</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a74d71439b100fb5b66b94d1d69130f7c">dof</a>(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>) = (*Saved_dof_pt)[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>];</div>
<div class="line"><a name="l08705"></a><span class="lineno"> 8705</span>&#160;      }</div>
<div class="line"><a name="l08706"></a><span class="lineno"> 8706</span>&#160;    }</div>
<div class="line"><a name="l08707"></a><span class="lineno"> 8707</span>&#160; </div>
<div class="line"><a name="l08708"></a><span class="lineno"> 8708</span>&#160;    <span class="comment">// Delete the memory</span></div>
<div class="line"><a name="l08709"></a><span class="lineno"> 8709</span>&#160;    <span class="keyword">delete</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aeef791a0158657ca7c298ffcb63ed54e">Saved_dof_pt</a>;</div>
<div class="line"><a name="l08710"></a><span class="lineno"> 8710</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aeef791a0158657ca7c298ffcb63ed54e">Saved_dof_pt</a> = 0;</div>
<div class="line"><a name="l08711"></a><span class="lineno"> 8711</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a74d71439b100fb5b66b94d1d69130f7c">dof()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>, <a class="el" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">oomph::LinearAlgebraDistribution::nrow_local()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aeef791a0158657ca7c298ffcb63ed54e">Saved_dof_pt</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acbc0b0fc5d5cc76ce8384bc0bd815f26">calculate_predictions()</a>.</p>

</div>
</div>
<a id="a7b7f290d47c78868860cb3561f1c6443"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b7f290d47c78868860cb3561f1c6443">&#9670;&nbsp;</a></span>self_test()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> Problem::self_test </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Self-test: Check meshes and global data. Return 0 for OK. </p>
<div class="fragment"><div class="line"><a name="l13277"></a><span class="lineno">13277</span>&#160;  {</div>
<div class="line"><a name="l13278"></a><span class="lineno">13278</span>&#160;    <span class="comment">// Initialise</span></div>
<div class="line"><a name="l13279"></a><span class="lineno">13279</span>&#160;    <span class="keywordtype">bool</span> passed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l13280"></a><span class="lineno">13280</span>&#160; </div>
<div class="line"><a name="l13281"></a><span class="lineno">13281</span>&#160;    <span class="comment">// Are there any submeshes?</span></div>
<div class="line"><a name="l13282"></a><span class="lineno">13282</span>&#160;    <span class="keywordtype">unsigned</span> Nmesh = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>();</div>
<div class="line"><a name="l13283"></a><span class="lineno">13283</span>&#160; </div>
<div class="line"><a name="l13284"></a><span class="lineno">13284</span>&#160;    <span class="comment">// Just one mesh: Check it</span></div>
<div class="line"><a name="l13285"></a><span class="lineno">13285</span>&#160;    <span class="keywordflow">if</span> (Nmesh == 0)</div>
<div class="line"><a name="l13286"></a><span class="lineno">13286</span>&#160;    {</div>
<div class="line"><a name="l13287"></a><span class="lineno">13287</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>()-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a7b7f290d47c78868860cb3561f1c6443">self_test</a>() != 0)</div>
<div class="line"><a name="l13288"></a><span class="lineno">13288</span>&#160;      {</div>
<div class="line"><a name="l13289"></a><span class="lineno">13289</span>&#160;        passed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l13290"></a><span class="lineno">13290</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a></div>
<div class="line"><a name="l13291"></a><span class="lineno">13291</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;\n ERROR: Failed Mesh::self_test() for single mesh in problem&quot;</span></div>
<div class="line"><a name="l13292"></a><span class="lineno">13292</span>&#160;          &lt;&lt; std::endl;</div>
<div class="line"><a name="l13293"></a><span class="lineno">13293</span>&#160;      }</div>
<div class="line"><a name="l13294"></a><span class="lineno">13294</span>&#160;    }</div>
<div class="line"><a name="l13295"></a><span class="lineno">13295</span>&#160;    <span class="comment">// Loop over all submeshes and check them</span></div>
<div class="line"><a name="l13296"></a><span class="lineno">13296</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l13297"></a><span class="lineno">13297</span>&#160;    {</div>
<div class="line"><a name="l13298"></a><span class="lineno">13298</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> imesh = 0; imesh &lt; Nmesh; imesh++)</div>
<div class="line"><a name="l13299"></a><span class="lineno">13299</span>&#160;      {</div>
<div class="line"><a name="l13300"></a><span class="lineno">13300</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(imesh)-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a7b7f290d47c78868860cb3561f1c6443">self_test</a>() != 0)</div>
<div class="line"><a name="l13301"></a><span class="lineno">13301</span>&#160;        {</div>
<div class="line"><a name="l13302"></a><span class="lineno">13302</span>&#160;          passed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l13303"></a><span class="lineno">13303</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;\n ERROR: Failed Mesh::self_test() for mesh imesh&quot;</span></div>
<div class="line"><a name="l13304"></a><span class="lineno">13304</span>&#160;                     &lt;&lt; imesh &lt;&lt; std::endl;</div>
<div class="line"><a name="l13305"></a><span class="lineno">13305</span>&#160;        }</div>
<div class="line"><a name="l13306"></a><span class="lineno">13306</span>&#160;      }</div>
<div class="line"><a name="l13307"></a><span class="lineno">13307</span>&#160;    }</div>
<div class="line"><a name="l13308"></a><span class="lineno">13308</span>&#160; </div>
<div class="line"><a name="l13309"></a><span class="lineno">13309</span>&#160; </div>
<div class="line"><a name="l13310"></a><span class="lineno">13310</span>&#160;    <span class="comment">// Check global data</span></div>
<div class="line"><a name="l13311"></a><span class="lineno">13311</span>&#160;    <span class="keywordtype">unsigned</span> Nglobal = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>.size();</div>
<div class="line"><a name="l13312"></a><span class="lineno">13312</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> iglobal = 0; iglobal &lt; Nglobal; iglobal++)</div>
<div class="line"><a name="l13313"></a><span class="lineno">13313</span>&#160;    {</div>
<div class="line"><a name="l13314"></a><span class="lineno">13314</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>[iglobal]-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a7b7f290d47c78868860cb3561f1c6443">self_test</a>() != 0)</div>
<div class="line"><a name="l13315"></a><span class="lineno">13315</span>&#160;      {</div>
<div class="line"><a name="l13316"></a><span class="lineno">13316</span>&#160;        passed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l13317"></a><span class="lineno">13317</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a></div>
<div class="line"><a name="l13318"></a><span class="lineno">13318</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;\n ERROR: Failed Data::self_test() for global data iglobal&quot;</span></div>
<div class="line"><a name="l13319"></a><span class="lineno">13319</span>&#160;          &lt;&lt; iglobal &lt;&lt; std::endl;</div>
<div class="line"><a name="l13320"></a><span class="lineno">13320</span>&#160;      }</div>
<div class="line"><a name="l13321"></a><span class="lineno">13321</span>&#160;    }</div>
<div class="line"><a name="l13322"></a><span class="lineno">13322</span>&#160; </div>
<div class="line"><a name="l13323"></a><span class="lineno">13323</span>&#160; </div>
<div class="line"><a name="l13324"></a><span class="lineno">13324</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l13325"></a><span class="lineno">13325</span>&#160; </div>
<div class="line"><a name="l13326"></a><span class="lineno">13326</span>&#160;    <span class="keywordflow">if</span> (Problem_has_been_distributed)</div>
<div class="line"><a name="l13327"></a><span class="lineno">13327</span>&#160;    {</div>
<div class="line"><a name="l13328"></a><span class="lineno">13328</span>&#160;      <span class="comment">// Note: This throws an error if it fails so no return is required.</span></div>
<div class="line"><a name="l13329"></a><span class="lineno">13329</span>&#160;      DocInfo tmp_doc_info;</div>
<div class="line"><a name="l13330"></a><span class="lineno">13330</span>&#160;      tmp_doc_info.disable_doc();</div>
<div class="line"><a name="l13331"></a><span class="lineno">13331</span>&#160;      check_halo_schemes(tmp_doc_info);</div>
<div class="line"><a name="l13332"></a><span class="lineno">13332</span>&#160;    }</div>
<div class="line"><a name="l13333"></a><span class="lineno">13333</span>&#160; </div>
<div class="line"><a name="l13334"></a><span class="lineno">13334</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l13335"></a><span class="lineno">13335</span>&#160; </div>
<div class="line"><a name="l13336"></a><span class="lineno">13336</span>&#160;    <span class="comment">// Return verdict</span></div>
<div class="line"><a name="l13337"></a><span class="lineno">13337</span>&#160;    <span class="keywordflow">if</span> (passed)</div>
<div class="line"><a name="l13338"></a><span class="lineno">13338</span>&#160;    {</div>
<div class="line"><a name="l13339"></a><span class="lineno">13339</span>&#160;      <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l13340"></a><span class="lineno">13340</span>&#160;    }</div>
<div class="line"><a name="l13341"></a><span class="lineno">13341</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l13342"></a><span class="lineno">13342</span>&#160;    {</div>
<div class="line"><a name="l13343"></a><span class="lineno">13343</span>&#160;      <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l13344"></a><span class="lineno">13344</span>&#160;    }</div>
<div class="line"><a name="l13345"></a><span class="lineno">13345</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a7b7f290d47c78868860cb3561f1c6443"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a7b7f290d47c78868860cb3561f1c6443">oomph::Problem::self_test</a></div><div class="ttdeci">unsigned self_test()</div><div class="ttdoc">Self-test: Check meshes and global data. Return 0 for OK.</div><div class="ttdef"><b>Definition:</b> problem.cc:13276</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html#a666a20817ab9c396b225d8652bc0a338">oomph::DocInfo::disable_doc()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh()</a>, and <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d9/dc5/classoomph_1_1BiharmonicProblem.html#a161f8a00ca635684bfd54880925cd5bf">oomph::BiharmonicProblem&lt; DIM &gt;::actions_before_newton_solve()</a>, <a class="el" href="../../db/d78/classoomph_1_1BiharmonicFluidProblem.html#ad62b36f8b36faae1324fe29fcd8e0875">oomph::BiharmonicFluidProblem&lt; DIM &gt;::actions_before_newton_solve()</a>, and <a class="el" href="../../d1/d1e/one__d__poisson__hp__adapt_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main()</a>.</p>

</div>
</div>
<a id="aecef49e98bbcede9b8c3137592c2cc5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aecef49e98bbcede9b8c3137592c2cc5a">&#9670;&nbsp;</a></span>set_analytic_dparameter()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Problem::set_analytic_dparameter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;&#160;</td>
          <td class="paramname"><em>parameter_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Function to turn on analytic calculation of the parameter derivatives in continuation and bifurcation detection problems </p>
<div class="fragment"><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae22f10c348ef8afeb1bfd8609cd6a319">Calculate_dparameter_analytic</a>[parameter_pt] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae22f10c348ef8afeb1bfd8609cd6a319">Calculate_dparameter_analytic</a>.</p>

</div>
</div>
<a id="a45f64c33501e0f9c65927eefed253eef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45f64c33501e0f9c65927eefed253eef">&#9670;&nbsp;</a></span>set_analytic_hessian_products()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Problem::set_analytic_hessian_products </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Function to turn on analytic calculation of the parameter derivatives in continuation and bifurcation detection problems </p>
<div class="fragment"><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    {</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ac353f1325a3b411b30fbc19314cc18ce">Calculate_hessian_products_analytic</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac353f1325a3b411b30fbc19314cc18ce">Calculate_hessian_products_analytic</a>.</p>

</div>
</div>
<a id="ae78e313f1dc3bc956f42a5d0bd06c459"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae78e313f1dc3bc956f42a5d0bd06c459">&#9670;&nbsp;</a></span>set_consistent_pinned_values_for_continuation()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::set_consistent_pinned_values_for_continuation </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Private helper function that is used to set the appropriate pinned values for continuation.</p>
<p>Private helper function that is used to set the appropriate pinned values for continuation. If the data is pinned, the its current value is always the same as the original value and the derivative is always zero. If these are not set properly then interpolation and projection in spatial adaptivity will not give the best answers. </p>
<div class="fragment"><div class="line"><a name="l10467"></a><span class="lineno">10467</span>&#160;  {</div>
<div class="line"><a name="l10468"></a><span class="lineno">10468</span>&#160;    <span class="comment">// Set the consistent values for the global mesh</span></div>
<div class="line"><a name="l10469"></a><span class="lineno">10469</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ac8d6a5dcf3af2df66625079975d84c19">set_consistent_pinned_values_for_continuation</a>(</div>
<div class="line"><a name="l10470"></a><span class="lineno">10470</span>&#160;      &amp;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a4c24860f29d64935db86ce5778c7a794">Continuation_time_stepper</a>);</div>
<div class="line"><a name="l10471"></a><span class="lineno">10471</span>&#160; </div>
<div class="line"><a name="l10472"></a><span class="lineno">10472</span>&#160;    <span class="comment">// Deal with the spine meshes additional numbering separately</span></div>
<div class="line"><a name="l10473"></a><span class="lineno">10473</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_sub_mesh = this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>();</div>
<div class="line"><a name="l10474"></a><span class="lineno">10474</span>&#160;    <span class="comment">// If there is only one mesh</span></div>
<div class="line"><a name="l10475"></a><span class="lineno">10475</span>&#160;    <span class="keywordflow">if</span> (n_sub_mesh == 0)</div>
<div class="line"><a name="l10476"></a><span class="lineno">10476</span>&#160;    {</div>
<div class="line"><a name="l10477"></a><span class="lineno">10477</span>&#160;      <span class="keywordflow">if</span> (SpineMesh* <span class="keyword">const</span> spine_mesh_pt = <span class="keyword">dynamic_cast&lt;</span>SpineMesh*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>))</div>
<div class="line"><a name="l10478"></a><span class="lineno">10478</span>&#160;      {</div>
<div class="line"><a name="l10479"></a><span class="lineno">10479</span>&#160;        spine_mesh_pt-&gt;set_consistent_pinned_spine_values_for_continuation(</div>
<div class="line"><a name="l10480"></a><span class="lineno">10480</span>&#160;          &amp;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a4c24860f29d64935db86ce5778c7a794">Continuation_time_stepper</a>);</div>
<div class="line"><a name="l10481"></a><span class="lineno">10481</span>&#160;      }</div>
<div class="line"><a name="l10482"></a><span class="lineno">10482</span>&#160;      <span class="comment">// If it&#39;s a triangle mesh the we need to set the</span></div>
<div class="line"><a name="l10483"></a><span class="lineno">10483</span>&#160;    }</div>
<div class="line"><a name="l10484"></a><span class="lineno">10484</span>&#160;    <span class="comment">// Otherwise loop over the sub meshes</span></div>
<div class="line"><a name="l10485"></a><span class="lineno">10485</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l10486"></a><span class="lineno">10486</span>&#160;    {</div>
<div class="line"><a name="l10487"></a><span class="lineno">10487</span>&#160;      <span class="comment">// Assign global equation numbers first</span></div>
<div class="line"><a name="l10488"></a><span class="lineno">10488</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_sub_mesh; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l10489"></a><span class="lineno">10489</span>&#160;      {</div>
<div class="line"><a name="l10490"></a><span class="lineno">10490</span>&#160;        <span class="keywordflow">if</span> (SpineMesh* <span class="keyword">const</span> spine_mesh_pt =</div>
<div class="line"><a name="l10491"></a><span class="lineno">10491</span>&#160;              <span class="keyword">dynamic_cast&lt;</span>SpineMesh*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab65f6fc9c49860e6324457a7e6e76346">Sub_mesh_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]))</div>
<div class="line"><a name="l10492"></a><span class="lineno">10492</span>&#160;        {</div>
<div class="line"><a name="l10493"></a><span class="lineno">10493</span>&#160;          spine_mesh_pt-&gt;set_consistent_pinned_spine_values_for_continuation(</div>
<div class="line"><a name="l10494"></a><span class="lineno">10494</span>&#160;            &amp;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a4c24860f29d64935db86ce5778c7a794">Continuation_time_stepper</a>);</div>
<div class="line"><a name="l10495"></a><span class="lineno">10495</span>&#160;        }</div>
<div class="line"><a name="l10496"></a><span class="lineno">10496</span>&#160;      }</div>
<div class="line"><a name="l10497"></a><span class="lineno">10497</span>&#160;    }</div>
<div class="line"><a name="l10498"></a><span class="lineno">10498</span>&#160; </div>
<div class="line"><a name="l10499"></a><span class="lineno">10499</span>&#160;    <span class="comment">// Also set time stepper for global data</span></div>
<div class="line"><a name="l10500"></a><span class="lineno">10500</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_global = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>.size();</div>
<div class="line"><a name="l10501"></a><span class="lineno">10501</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_global; ++<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><a name="l10502"></a><span class="lineno">10502</span>&#160;    {</div>
<div class="line"><a name="l10503"></a><span class="lineno">10503</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a4c24860f29d64935db86ce5778c7a794">Continuation_time_stepper</a>.<a class="code" href="../../d1/daa/classoomph_1_1ContinuationStorageScheme.html#a279e4c16176c0374b9bba05519a17b0c">set_consistent_pinned_values</a>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l10504"></a><span class="lineno">10504</span>&#160;    }</div>
<div class="line"><a name="l10505"></a><span class="lineno">10505</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1ContinuationStorageScheme_html_a279e4c16176c0374b9bba05519a17b0c"><div class="ttname"><a href="../../d1/daa/classoomph_1_1ContinuationStorageScheme.html#a279e4c16176c0374b9bba05519a17b0c">oomph::ContinuationStorageScheme::set_consistent_pinned_values</a></div><div class="ttdeci">void set_consistent_pinned_values(Data *const &amp;data_pt)</div><div class="ttdef"><b>Definition:</b> generalised_timesteppers.h:221</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_ac8d6a5dcf3af2df66625079975d84c19"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#ac8d6a5dcf3af2df66625079975d84c19">oomph::Mesh::set_consistent_pinned_values_for_continuation</a></div><div class="ttdeci">void set_consistent_pinned_values_for_continuation(ContinuationStorageScheme *const &amp;continuation_stepper_pt)</div><div class="ttdoc">Set consistent values for pinned data in continuation.</div><div class="ttdef"><b>Definition:</b> mesh.cc:2436</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a4c24860f29d64935db86ce5778c7a794">Continuation_time_stepper</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh()</a>, <a class="el" href="../../d1/daa/classoomph_1_1ContinuationStorageScheme.html#a279e4c16176c0374b9bba05519a17b0c">oomph::ContinuationStorageScheme::set_consistent_pinned_values()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ac8d6a5dcf3af2df66625079975d84c19">oomph::Mesh::set_consistent_pinned_values_for_continuation()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab65f6fc9c49860e6324457a7e6e76346">Sub_mesh_pt</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acc35de219c1c1032a14840021fd8a6b9">arc_length_step_solve_helper()</a>.</p>

</div>
</div>
<a id="a07c3df43aef20537f8d192c2fc203836"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07c3df43aef20537f8d192c2fc203836">&#9670;&nbsp;</a></span>set_dofs() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::set_dofs </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;&#160;</td>
          <td class="paramname"><em>dofs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set the values of the dofs. </p>
<p>Function that sets the values of the dofs in the object. </p>

<p>Reimplemented from <a class="el" href="../../df/d86/classoomph_1_1ExplicitTimeSteppableObject.html#a76a8d64f2d6aa8de955b44c86e9b3ecb">oomph::ExplicitTimeSteppableObject</a>.</p>
<div class="fragment"><div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;  {</div>
<div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n_dof = this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>();</div>
<div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;    <span class="keywordflow">if</span> (n_dof != dofs.nrow())</div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;    {</div>
<div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;      std::ostringstream error_stream;</div>
<div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;      error_stream &lt;&lt; <span class="stringliteral">&quot;Number of degrees of freedom in vector argument &quot;</span></div>
<div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;                   &lt;&lt; dofs.nrow() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;does not equal number of degrees of freedom in problem &quot;</span></div>
<div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;                   &lt;&lt; n_dof;</div>
<div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;        error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;    }</div>
<div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l = 0; l &lt; n_dof; l++)</div>
<div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;    {</div>
<div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;      *<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>[l] = dofs[l];</div>
<div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;    }</div>
<div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a7569556f14fd68b28508920e89bd5eee">oomph::DistributableLinearAlgebraObject::nrow()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, and <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acbc0b0fc5d5cc76ce8384bc0bd815f26">calculate_predictions()</a>, and <a class="el" href="../../da/d0b/classoomph_1_1TR.html#abde5c3804dd51162f11c50dacb65b315">oomph::TR::setup_initial_derivative()</a>.</p>

</div>
</div>
<a id="ac3ec67f2c633cc414905ade9fa148939"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3ec67f2c633cc414905ade9fa148939">&#9670;&nbsp;</a></span>set_dofs() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::set_dofs </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;&#160;</td>
          <td class="paramname"><em>dofs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the history values of the dofs. </p>
<p>Set history values of dofs. </p>
<div class="fragment"><div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;  {</div>
<div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#af5e9f1623cad361048856a4c0463ea23">distributed</a>())</div>
<div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;    {</div>
<div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(<span class="stringliteral">&quot;Not designed for distributed problems&quot;</span>,</div>
<div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>,</div>
<div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>);</div>
<div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;      <span class="comment">// might work if the dofs vector is distributed in the right way...</span></div>
<div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;    }</div>
<div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160; </div>
<div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;    <span class="comment">// First deal with global data</span></div>
<div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;    <span class="keywordtype">unsigned</span> Nglobal_data = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a60a9b6861928cf9115110b5bfc7d11a7">nglobal_data</a>();</div>
<div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; Nglobal_data; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;    {</div>
<div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0, nj = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;nvalue(); <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; nj; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;      {</div>
<div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;        <span class="comment">// For each data get the equation number and copy out the value.</span></div>
<div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;        <span class="keywordtype">int</span> eqn_number = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;eqn_number(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;        <span class="keywordflow">if</span> (eqn_number &gt;= 0)</div>
<div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;        {</div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;          <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;set_value(<a class="code" href="../../dd/ddd/namespaceplotPSD.html#a112f38a9c28b7e27fed13fb3ebf10362">t</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, dofs[eqn_number]);</div>
<div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;        }</div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;      }</div>
<div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;    }</div>
<div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160; </div>
<div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;    <span class="comment">// Next element internal data</span></div>
<div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, ni = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>()-&gt;nelement(); <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; ni; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;    {</div>
<div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;      GeneralisedElement* ele_pt = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>()-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">element_pt</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0, nj = ele_pt-&gt;ninternal_data(); <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; nj; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;      {</div>
<div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;        Data* d_pt = ele_pt-&gt;<a class="code" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a45e32d895d4b3686e0f15fe455f4ed44">internal_data_pt</a>(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> = 0, nk = d_pt-&gt;nvalue(); <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> &lt; nk; <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>++)</div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;        {</div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;          <span class="keywordtype">int</span> eqn_number = d_pt-&gt;<a class="code" href="../../d8/dc5/classoomph_1_1Data.html#a13206dcb7a088db0ef845ab71af505d2">eqn_number</a>(<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>);</div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;          <span class="keywordflow">if</span> (eqn_number &gt;= 0)</div>
<div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;          {</div>
<div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;            d_pt-&gt;set_value(<a class="code" href="../../dd/ddd/namespaceplotPSD.html#a112f38a9c28b7e27fed13fb3ebf10362">t</a>, <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>, dofs[eqn_number]);</div>
<div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;          }</div>
<div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;        }</div>
<div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;      }</div>
<div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;    }</div>
<div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160; </div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;    <span class="comment">// Now the nodes</span></div>
<div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, ni = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>()-&gt;nnode(); <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; ni; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;    {</div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;      Node* node_pt = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>()-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">node_pt</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0, nj = node_pt-&gt;nvalue(); <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; nj; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;      {</div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;        <span class="comment">// For each node get the equation number and copy out the value.</span></div>
<div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;        <span class="keywordtype">int</span> eqn_number = node_pt-&gt;<a class="code" href="../../d8/dc5/classoomph_1_1Data.html#a13206dcb7a088db0ef845ab71af505d2">eqn_number</a>(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;        <span class="keywordflow">if</span> (eqn_number &gt;= 0)</div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;        {</div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;          node_pt-&gt;set_value(<a class="code" href="../../dd/ddd/namespaceplotPSD.html#a112f38a9c28b7e27fed13fb3ebf10362">t</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, dofs[eqn_number]);</div>
<div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;        }</div>
<div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;      }</div>
<div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;    }</div>
<div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af5e9f1623cad361048856a4c0463ea23">distributed()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">oomph::Mesh::element_pt()</a>, <a class="el" href="../../d8/dc5/classoomph_1_1Data.html#a13206dcb7a088db0ef845ab71af505d2">oomph::Data::eqn_number()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a45e32d895d4b3686e0f15fe455f4ed44">oomph::GeneralisedElement::internal_data_pt()</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a60a9b6861928cf9115110b5bfc7d11a7">nglobal_data()</a>, <a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a6b736de0af4c92831968636479b3480e">oomph::GeneralisedElement::ninternal_data()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">oomph::Mesh::node_pt()</a>, <a class="el" href="../../d8/dc5/classoomph_1_1Data.html#a7e67fc78a2e8a2fd6eb75bd292d42ff8">oomph::Data::nvalue()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../d8/dc5/classoomph_1_1Data.html#a7289ca322725c6fd493970a19474b382">oomph::Data::set_value()</a>, and <a class="el" href="../../dd/ddd/namespaceplotPSD.html#a112f38a9c28b7e27fed13fb3ebf10362">plotPSD::t</a>.</p>

</div>
</div>
<a id="a2119786e1204edeb90ed58f4faf0eae4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2119786e1204edeb90ed58f4faf0eae4">&#9670;&nbsp;</a></span>set_dofs() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::set_dofs </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>dof_pt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set history values of dofs from the type of vector stored in problem::Dof_pt. </p>
<div class="fragment"><div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;  {</div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#af5e9f1623cad361048856a4c0463ea23">distributed</a>())</div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;    {</div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(<span class="stringliteral">&quot;Not implemented for distributed problems!&quot;</span>,</div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>,</div>
<div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>);</div>
<div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;    }</div>
<div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160; </div>
<div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;    <span class="comment">// If we have any spine meshes I think there might be more degrees</span></div>
<div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;    <span class="comment">// of freedom there. I don&#39;t use them though so I&#39;ll let someone who</span></div>
<div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;    <span class="comment">// knows what they are doing handle it. --David Shepherd</span></div>
<div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160; </div>
<div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;    <span class="comment">// First deal with global data</span></div>
<div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;    <span class="keywordtype">unsigned</span> Nglobal_data = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a60a9b6861928cf9115110b5bfc7d11a7">nglobal_data</a>();</div>
<div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; Nglobal_data; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;    {</div>
<div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0, nj = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;nvalue(); <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; nj; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;      {</div>
<div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;        <span class="comment">// For each data get the equation number and copy in the value.</span></div>
<div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;        <span class="keywordtype">int</span> eqn_number = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;eqn_number(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;        <span class="keywordflow">if</span> (eqn_number &gt;= 0)</div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;        {</div>
<div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;          <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;set_value(<a class="code" href="../../dd/ddd/namespaceplotPSD.html#a112f38a9c28b7e27fed13fb3ebf10362">t</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, *(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a02f480ec17e0b9b03c892be5ed0c64d1">dof_pt</a>[eqn_number]));</div>
<div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;        }</div>
<div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;      }</div>
<div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;    }</div>
<div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160; </div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;    <span class="comment">// Now the mesh data</span></div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;    <span class="comment">// nodes</span></div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, ni = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>()-&gt;nnode(); <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; ni; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;    {</div>
<div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;      Node* node_pt = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>()-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">node_pt</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0, nj = node_pt-&gt;nvalue(); <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; nj; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;      {</div>
<div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;        <span class="comment">// For each node get the equation number and copy in the value.</span></div>
<div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;        <span class="keywordtype">int</span> eqn_number = node_pt-&gt;<a class="code" href="../../d8/dc5/classoomph_1_1Data.html#a13206dcb7a088db0ef845ab71af505d2">eqn_number</a>(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;        <span class="keywordflow">if</span> (eqn_number &gt;= 0)</div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;        {</div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;          node_pt-&gt;set_value(<a class="code" href="../../dd/ddd/namespaceplotPSD.html#a112f38a9c28b7e27fed13fb3ebf10362">t</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, *(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a02f480ec17e0b9b03c892be5ed0c64d1">dof_pt</a>[eqn_number]));</div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;        }</div>
<div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;      }</div>
<div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;    }</div>
<div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160; </div>
<div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;    <span class="comment">// and non-nodal data inside elements</span></div>
<div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, ni = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>()-&gt;nelement(); <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; ni; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;    {</div>
<div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;      GeneralisedElement* ele_pt = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>()-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">element_pt</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0, nj = ele_pt-&gt;ninternal_data(); <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; nj; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;      {</div>
<div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;        Data* data_pt = ele_pt-&gt;<a class="code" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a45e32d895d4b3686e0f15fe455f4ed44">internal_data_pt</a>(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;        <span class="comment">// For each node get the equation number and copy in the value.</span></div>
<div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;        <span class="keywordtype">int</span> eqn_number = data_pt-&gt;<a class="code" href="../../d8/dc5/classoomph_1_1Data.html#a13206dcb7a088db0ef845ab71af505d2">eqn_number</a>(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;        <span class="keywordflow">if</span> (eqn_number &gt;= 0)</div>
<div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;        {</div>
<div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;          data_pt-&gt;set_value(<a class="code" href="../../dd/ddd/namespaceplotPSD.html#a112f38a9c28b7e27fed13fb3ebf10362">t</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, *(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a02f480ec17e0b9b03c892be5ed0c64d1">dof_pt</a>[eqn_number]));</div>
<div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;        }</div>
<div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;      }</div>
<div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;    }</div>
<div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a02f480ec17e0b9b03c892be5ed0c64d1"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a02f480ec17e0b9b03c892be5ed0c64d1">oomph::Problem::dof_pt</a></div><div class="ttdeci">double *&amp; dof_pt(const unsigned &amp;i)</div><div class="ttdoc">Pointer to i-th dof in the problem.</div><div class="ttdef"><b>Definition:</b> problem.h:1825</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af5e9f1623cad361048856a4c0463ea23">distributed()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a02f480ec17e0b9b03c892be5ed0c64d1">dof_pt()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">oomph::Mesh::element_pt()</a>, <a class="el" href="../../d8/dc5/classoomph_1_1Data.html#a13206dcb7a088db0ef845ab71af505d2">oomph::Data::eqn_number()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a45e32d895d4b3686e0f15fe455f4ed44">oomph::GeneralisedElement::internal_data_pt()</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a60a9b6861928cf9115110b5bfc7d11a7">nglobal_data()</a>, <a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a6b736de0af4c92831968636479b3480e">oomph::GeneralisedElement::ninternal_data()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">oomph::Mesh::node_pt()</a>, <a class="el" href="../../d8/dc5/classoomph_1_1Data.html#a7e67fc78a2e8a2fd6eb75bd292d42ff8">oomph::Data::nvalue()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../d8/dc5/classoomph_1_1Data.html#a7289ca322725c6fd493970a19474b382">oomph::Data::set_value()</a>, and <a class="el" href="../../dd/ddd/namespaceplotPSD.html#a112f38a9c28b7e27fed13fb3ebf10362">plotPSD::t</a>.</p>

</div>
</div>
<a id="a7e79846a57705934352b55b6d675d77d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e79846a57705934352b55b6d675d77d">&#9670;&nbsp;</a></span>set_explicit_time_stepper_pt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::set_explicit_time_stepper_pt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d0b/classoomph_1_1ExplicitTimeStepper.html">ExplicitTimeStepper</a> *const &amp;&#160;</td>
          <td class="paramname"><em>explicit_time_stepper_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the explicit timestepper for the problem. The function will automatically create or resize the Time object so that it contains the appropriate number of levels of storage</p>
<p>Set the explicit time stepper for the problem and also ensure that a time object has been created. </p>
<div class="fragment"><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;  {</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;    <span class="comment">// Set the explicit time stepper</span></div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#af8466091ea4f5b57033bb3ad24831167">Explicit_time_stepper_pt</a> = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ac332634783a803c1c21bf5c520af280f">explicit_time_stepper_pt</a>;</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160; </div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;    <span class="comment">// If time has not been allocated, create time object with the</span></div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;    <span class="comment">// required number of time steps</span></div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae33fbf5f34a7d06d88ad2c98538bbbe8">Time_pt</a> == 0)</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;    {</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae33fbf5f34a7d06d88ad2c98538bbbe8">Time_pt</a> = <span class="keyword">new</span> <a class="code" href="../../da/d66/classTime.html">Time</a>(0);</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Created Time with storage for no previous timestep&quot;</span></div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;                 &lt;&lt; std::endl;</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;    }</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    {</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Time object already exists &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;    }</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af8466091ea4f5b57033bb3ad24831167">Explicit_time_stepper_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac332634783a803c1c21bf5c520af280f">explicit_time_stepper_pt()</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae33fbf5f34a7d06d88ad2c98538bbbe8">Time_pt</a>.</p>

</div>
</div>
<a id="ad48be6d67071f7da5f6feb7c4fc918f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad48be6d67071f7da5f6feb7c4fc918f0">&#9670;&nbsp;</a></span>set_initial_condition()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void oomph::Problem::set_initial_condition </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Set initial condition (incl previous timesteps). We need to establish this interface because I.C. needs to be reset when problem is adapted during the first timestep. </p>

<p>Reimplemented in <a class="el" href="../../d1/d8c/classCollapsibleChannelProblem.html#a646147fb75669cfcc5bb56ee79d9b8da">CollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d28/classUnsteadyHeatProblem.html#a98de3ed2d9cf5409323121bbb482bc1b">UnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d68/classRefineableUnsteadyHeatProblem.html#a30e2e1d62b059982f7014b74f4fe2be9">RefineableUnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d68/classRefineableUnsteadyHeatProblem.html#a30e2e1d62b059982f7014b74f4fe2be9">RefineableUnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d68/classRefineableUnsteadyHeatProblem.html#a30e2e1d62b059982f7014b74f4fe2be9">RefineableUnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d28/classUnsteadyHeatProblem.html#a98de3ed2d9cf5409323121bbb482bc1b">UnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d28/classUnsteadyHeatProblem.html#a98de3ed2d9cf5409323121bbb482bc1b">UnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d6/df1/classRefineableSphericalSpinUpProblem.html#a2c30294ebbd95eafe595f87a608f867b">RefineableSphericalSpinUpProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d6/df1/classRefineableSphericalSpinUpProblem.html#a2c30294ebbd95eafe595f87a608f867b">RefineableSphericalSpinUpProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d8c/classCollapsibleChannelProblem.html#a646147fb75669cfcc5bb56ee79d9b8da">CollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d5/d48/classRefineableActivatorInhibitorProblem.html#a981167b1ebcd381c30ac81ba84ff033f">RefineableActivatorInhibitorProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d5/d48/classRefineableActivatorInhibitorProblem.html#a981167b1ebcd381c30ac81ba84ff033f">RefineableActivatorInhibitorProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/dc8/classRefineableOneDAdvectionDiffusionReactionProblem.html#aeb6d39c6b1ad48a1a1353d27fddc32ff">RefineableOneDAdvectionDiffusionReactionProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/da6/classFSICollapsibleChannelProblem.html#afdd6752cb134fd09ee8830158ed557b2">FSICollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d68/classRefineableUnsteadyHeatProblem.html#a30e2e1d62b059982f7014b74f4fe2be9">RefineableUnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d28/classUnsteadyHeatProblem.html#a98de3ed2d9cf5409323121bbb482bc1b">UnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d6/da9/classRayleighProblem.html#a5c54c02c45c656cabbe8f8808e2cfd6b">RayleighProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d6/da9/classRayleighProblem.html#a5c54c02c45c656cabbe8f8808e2cfd6b">RayleighProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d9/d15/classInterfaceProblem.html#a0d3af8378c4f0a6e38636be958c300d5">InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d3/d70/classTwoLayerInterfaceProblem.html#ac2852a90a68b7cde5c6d04f79d029047">TwoLayerInterfaceProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d15/classInterfaceProblem.html#a0d3af8378c4f0a6e38636be958c300d5">InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d9/d15/classInterfaceProblem.html#a0d3af8378c4f0a6e38636be958c300d5">InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d9/d15/classInterfaceProblem.html#a0d3af8378c4f0a6e38636be958c300d5">InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../de/d2b/classRayleighTractionProblem.html#ad6394f146505e00aeba2fc37f2c75488">RayleighTractionProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d6/da9/classRayleighProblem.html#a5c54c02c45c656cabbe8f8808e2cfd6b">RayleighProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../dd/d71/classOscRingNStProblem.html#ab1f2083699d00da4b7f6116e10792e86">OscRingNStProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d71/classOscRingNStProblem.html#ab1f2083699d00da4b7f6116e10792e86">OscRingNStProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../db/d50/classOscEllipseProblem.html#ae638f238a7b0e0acb5d6087b7363fe01">OscEllipseProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d1/d8c/classCollapsibleChannelProblem.html#a646147fb75669cfcc5bb56ee79d9b8da">CollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d8c/classCollapsibleChannelProblem.html#a646147fb75669cfcc5bb56ee79d9b8da">CollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d1/d8c/classCollapsibleChannelProblem.html#a646147fb75669cfcc5bb56ee79d9b8da">CollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d15/classInterfaceProblem.html#a0d3af8378c4f0a6e38636be958c300d5">InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d9/d15/classInterfaceProblem.html#a0d3af8378c4f0a6e38636be958c300d5">InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d3/db4/classPseudoElasticCollapsibleChannelProblem.html#adc6d039a4510074bc0350b538114bc2d">PseudoElasticCollapsibleChannelProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;</a>, <a class="el" href="../../da/db6/classFSIRingProblem.html#a309ea4c79fbae58020d94bf2c2318169">FSIRingProblem</a>, <a class="el" href="../../dd/da6/classFSICollapsibleChannelProblem.html#afdd6752cb134fd09ee8830158ed557b2">FSICollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d4/d68/classRefineableUnsteadyHeatProblem.html#a30e2e1d62b059982f7014b74f4fe2be9">RefineableUnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d5/d62/classPerturbedStateProblem.html#ab1014fc5ee1103de6be69fd7f14e2b8a">PerturbedStateProblem&lt; BASE_ELEMENT, PERTURBED_ELEMENT &gt;</a>, <a class="el" href="../../d2/d3b/classBaseStateProblem.html#aba64b2befa3f015ee43ca7f4ddd14d4d">BaseStateProblem&lt; BASE_ELEMENT &gt;</a>, <a class="el" href="../../d5/d62/classPerturbedStateProblem.html#ab1014fc5ee1103de6be69fd7f14e2b8a">PerturbedStateProblem&lt; BASE_ELEMENT, PERTURBED_ELEMENT &gt;</a>, <a class="el" href="../../d2/d3b/classBaseStateProblem.html#aba64b2befa3f015ee43ca7f4ddd14d4d">BaseStateProblem&lt; BASE_ELEMENT &gt;</a>, <a class="el" href="../../d5/d62/classPerturbedStateProblem.html#ab1014fc5ee1103de6be69fd7f14e2b8a">PerturbedStateProblem&lt; BASE_ELEMENT, PERTURBED_ELEMENT &gt;</a>, <a class="el" href="../../d2/d3b/classBaseStateProblem.html#aba64b2befa3f015ee43ca7f4ddd14d4d">BaseStateProblem&lt; BASE_ELEMENT &gt;</a>, <a class="el" href="../../d5/d62/classPerturbedStateProblem.html#ab1014fc5ee1103de6be69fd7f14e2b8a">PerturbedStateProblem&lt; BASE_ELEMENT, PERTURBED_ELEMENT &gt;</a>, <a class="el" href="../../d2/d3b/classBaseStateProblem.html#aba64b2befa3f015ee43ca7f4ddd14d4d">BaseStateProblem&lt; BASE_ELEMENT &gt;</a>, <a class="el" href="../../d4/db2/classLinearWaveProblem.html#afb5d327791d8289a8a0a565afc8aee37">LinearWaveProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d4/db2/classLinearWaveProblem.html#afb5d327791d8289a8a0a565afc8aee37">LinearWaveProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d4/db2/classLinearWaveProblem.html#afb5d327791d8289a8a0a565afc8aee37">LinearWaveProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d3/db4/classPseudoElasticCollapsibleChannelProblem.html#adc6d039a4510074bc0350b538114bc2d">PseudoElasticCollapsibleChannelProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;</a>, <a class="el" href="../../d3/db4/classPseudoElasticCollapsibleChannelProblem.html#adc6d039a4510074bc0350b538114bc2d">PseudoElasticCollapsibleChannelProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;</a>, <a class="el" href="../../dd/d71/classOscRingNStProblem.html#ab1f2083699d00da4b7f6116e10792e86">OscRingNStProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/d71/classOscRingNStProblem.html#abb89ffe8ffb15585b4bac6861b6bbcaf">OscRingNStProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../da/db6/classFSIRingProblem.html#a309ea4c79fbae58020d94bf2c2318169">FSIRingProblem</a>, <a class="el" href="../../da/db6/classFSIRingProblem.html#a309ea4c79fbae58020d94bf2c2318169">FSIRingProblem</a>, <a class="el" href="../../d5/df4/classFSIDrivenCavityProblem.html#ad7ac64cf005c8d5b619cc81757f1b4a9">FSIDrivenCavityProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/da6/classFSICollapsibleChannelProblem.html#afdd6752cb134fd09ee8830158ed557b2">FSICollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/da6/classFSICollapsibleChannelProblem.html#afdd6752cb134fd09ee8830158ed557b2">FSICollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/da6/classFSICollapsibleChannelProblem.html#afdd6752cb134fd09ee8830158ed557b2">FSICollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/da6/classFSICollapsibleChannelProblem.html#afdd6752cb134fd09ee8830158ed557b2">FSICollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../dd/da6/classFSICollapsibleChannelProblem.html#afdd6752cb134fd09ee8830158ed557b2">FSICollapsibleChannelProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d8/d28/classUnsteadyHeatProblem.html#a98de3ed2d9cf5409323121bbb482bc1b">UnsteadyHeatProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d3/d7a/classAxiPoroProblem.html#adaaa5691f6c84606c2730a4d88c13f2a">AxiPoroProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d3/d84/classUnstructuredTorusProblem.html#abccb788d76d9a79ea6849c591eb5adb3">UnstructuredTorusProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d3/d84/classUnstructuredTorusProblem.html#abccb788d76d9a79ea6849c591eb5adb3">UnstructuredTorusProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d9/d15/classInterfaceProblem.html#a0d3af8378c4f0a6e38636be958c300d5">InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d9/d15/classInterfaceProblem.html#a0d3af8378c4f0a6e38636be958c300d5">InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d6/d07/classTorusProblem.html#a03c632febcd9fee98cc76e27fe87273c">TorusProblem&lt; ELEMENT &gt;</a>, <a class="el" href="../../d0/d94/classRotatingCylinderProblem.html#a5e4316cce2306c4aab4a20b88cdfe6e3">RotatingCylinderProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d9/d15/classInterfaceProblem.html#a0d3af8378c4f0a6e38636be958c300d5">InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d9/d15/classInterfaceProblem.html#a0d3af8378c4f0a6e38636be958c300d5">InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;</a>, <a class="el" href="../../d5/d62/classPerturbedStateProblem.html#ab1014fc5ee1103de6be69fd7f14e2b8a">PerturbedStateProblem&lt; BASE_ELEMENT, PERTURBED_ELEMENT &gt;</a>, <a class="el" href="../../d2/d3b/classBaseStateProblem.html#aba64b2befa3f015ee43ca7f4ddd14d4d">BaseStateProblem&lt; BASE_ELEMENT &gt;</a>, <a class="el" href="../../d5/d62/classPerturbedStateProblem.html#ad2fb5fa7c1d6473fee73f6f1fddd7cd4">PerturbedStateProblem&lt; BASE_ELEMENT, PERTURBED_ELEMENT &gt;</a>, <a class="el" href="../../d2/d3b/classBaseStateProblem.html#a1d22d04b24d689996763697d84e05f82">BaseStateProblem&lt; BASE_ELEMENT &gt;</a>, and <a class="el" href="../../d9/dd7/classRefineableAdvectionDiffusionPipeProblem.html#a6ba134be7ea9bb79d0d8714ab6eab881">RefineableAdvectionDiffusionPipeProblem&lt; ELEMENT &gt;</a>.</p>
<div class="fragment"><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    {</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;      std::ostringstream warn_message;</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;      warn_message</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;Warning: We&#39;re using the default (empty) set_initial_condition().\n&quot;</span></div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;If the initial conditions isn&#39;t re-assigned after a mesh adaption &quot;</span></div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;           <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;the initial conditions will represent the interpolation of the \n&quot;</span></div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;initial conditions that were assigned on the original coarse &quot;</span></div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;           <span class="stringliteral">&quot;mesh.\n&quot;</span>;</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;      OomphLibWarning(warn_message.str(),</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;                      <span class="stringliteral">&quot;Problem::set_initial_condition()&quot;</span>,</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;                      <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160; </div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;      <span class="comment">// Indicate that this function has been called. This flag is set so</span></div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;      <span class="comment">// that the unsteady_newton_solve routine can be instructed whether</span></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;      <span class="comment">// or not to shift the history values. If set_initial_condition() has</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;      <span class="comment">// been overloaded than this (default) function won&#39;t be called, and</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;      <span class="comment">// so this flag will remain false (its default value). If</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;      <span class="comment">// set_initial_condition() has not been overloaded then this function</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;      <span class="comment">// will be called and the flag set to true.</span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a83df3b5fcc3ebbae951021c8e7f03ef7">Default_set_initial_condition_called</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a83df3b5fcc3ebbae951021c8e7f03ef7">Default_set_initial_condition_called</a>, and <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7c23771b77d6da7cbee3c3e3c050be73">doubly_adaptive_unsteady_newton_solve_helper()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a31d279b8e62fc676f25b9b347f4ffd8b">unsteady_newton_solve()</a>.</p>

</div>
</div>
<a id="a6aab91bb814a85409648dc87807907e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6aab91bb814a85409648dc87807907e6">&#9670;&nbsp;</a></span>set_pinned_values_to_zero()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::set_pinned_values_to_zero </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set all pinned values to zero. Used to set boundary conditions to be homogeneous in the copy of the problem used in adaptive bifurcation tracking (ALH: TEMPORARY HACK, WILL BE FIXED) </p>
<div class="fragment"><div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;  {</div>
<div class="line"><a name="l04306"></a><span class="lineno"> 4306</span>&#160;    <span class="comment">// NOTE THIS DOES NOT ZERO ANY SPINE DATA, but otherwise everything else</span></div>
<div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;    <span class="comment">// should be zeroed</span></div>
<div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160; </div>
<div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160;    <span class="comment">// Zero any pinned global Data</span></div>
<div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_global_data = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a60a9b6861928cf9115110b5bfc7d11a7">nglobal_data</a>();</div>
<div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_global_data; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;    {</div>
<div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160;      Data* <span class="keyword">const</span> local_data_pt = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_value = local_data_pt-&gt;nvalue();</div>
<div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; n_value; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;      {</div>
<div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;        <span class="comment">// If the data value is pinned set the value to zero</span></div>
<div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;        <span class="keywordflow">if</span> (local_data_pt-&gt;is_pinned(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>))</div>
<div class="line"><a name="l04319"></a><span class="lineno"> 4319</span>&#160;        {</div>
<div class="line"><a name="l04320"></a><span class="lineno"> 4320</span>&#160;          local_data_pt-&gt;set_value(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, 0.0);</div>
<div class="line"><a name="l04321"></a><span class="lineno"> 4321</span>&#160;        }</div>
<div class="line"><a name="l04322"></a><span class="lineno"> 4322</span>&#160;      }</div>
<div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160;    }</div>
<div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160; </div>
<div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;    <span class="comment">// Loop over the submeshes:</span></div>
<div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_sub_mesh = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab65f6fc9c49860e6324457a7e6e76346">Sub_mesh_pt</a>.size();</div>
<div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160;    <span class="keywordflow">if</span> (n_sub_mesh == 0)</div>
<div class="line"><a name="l04328"></a><span class="lineno"> 4328</span>&#160;    {</div>
<div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;      <span class="comment">// Loop over the nodes in the element</span></div>
<div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_node = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a945e7823d1a2af243b5b7f7866aaff5e">nnode</a>();</div>
<div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_node; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;      {</div>
<div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160;        Node* <span class="keyword">const</span> local_node_pt = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">node_pt</a>(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>);</div>
<div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_value = local_node_pt-&gt;<a class="code" href="../../d8/dc5/classoomph_1_1Data.html#a7e67fc78a2e8a2fd6eb75bd292d42ff8">nvalue</a>();</div>
<div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; n_value; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160;        {</div>
<div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160;          <span class="comment">// If the data value is pinned set the value to zero</span></div>
<div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;          <span class="keywordflow">if</span> (local_node_pt-&gt;is_pinned(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>))</div>
<div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;          {</div>
<div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160;            local_node_pt-&gt;set_value(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, 0.0);</div>
<div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160;          }</div>
<div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;        }</div>
<div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160; </div>
<div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;        <span class="comment">// Try to cast to a solid node</span></div>
<div class="line"><a name="l04345"></a><span class="lineno"> 4345</span>&#160;        SolidNode* <span class="keyword">const</span> local_solid_node_pt =</div>
<div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160;          <span class="keyword">dynamic_cast&lt;</span>SolidNode*<span class="keyword">&gt;</span>(local_node_pt);</div>
<div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160;        <span class="comment">// If we are successful</span></div>
<div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;        <span class="keywordflow">if</span> (local_solid_node_pt)</div>
<div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;        {</div>
<div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;          <span class="comment">// Find the dimension of the node</span></div>
<div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_dim = local_solid_node_pt-&gt;ndim();</div>
<div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;          <span class="comment">// Find number of positions</span></div>
<div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_position_type =</div>
<div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160;            local_solid_node_pt-&gt;nposition_type();</div>
<div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160; </div>
<div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> = 0; <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> &lt; n_position_type; <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>++)</div>
<div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;          {</div>
<div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_dim; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160;            {</div>
<div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;              <span class="comment">// If the generalised position is pinned,</span></div>
<div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160;              <span class="comment">// set the value to zero</span></div>
<div class="line"><a name="l04362"></a><span class="lineno"> 4362</span>&#160;              <span class="keywordflow">if</span> (local_solid_node_pt-&gt;position_is_pinned(<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>, <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>))</div>
<div class="line"><a name="l04363"></a><span class="lineno"> 4363</span>&#160;              {</div>
<div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;                local_solid_node_pt-&gt;x_gen(<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>, <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = 0.0;</div>
<div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;              }</div>
<div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;            }</div>
<div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;          }</div>
<div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;        }</div>
<div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160;      }</div>
<div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160; </div>
<div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160;      <span class="comment">// Now loop over the element&#39;s and zero the internal data</span></div>
<div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_element = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">nelement</a>();</div>
<div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; n_element; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l04374"></a><span class="lineno"> 4374</span>&#160;      {</div>
<div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;        GeneralisedElement* <span class="keyword">const</span> local_element_pt = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">element_pt</a>(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>);</div>
<div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_internal = local_element_pt-&gt;<a class="code" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a6b736de0af4c92831968636479b3480e">ninternal_data</a>();</div>
<div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_internal; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l04378"></a><span class="lineno"> 4378</span>&#160;        {</div>
<div class="line"><a name="l04379"></a><span class="lineno"> 4379</span>&#160;          Data* <span class="keyword">const</span> local_data_pt = local_element_pt-&gt;internal_data_pt(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_value = local_data_pt-&gt;nvalue();</div>
<div class="line"><a name="l04381"></a><span class="lineno"> 4381</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; n_value; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l04382"></a><span class="lineno"> 4382</span>&#160;          {</div>
<div class="line"><a name="l04383"></a><span class="lineno"> 4383</span>&#160;            <span class="comment">// If the data value is pinned set the value to zero</span></div>
<div class="line"><a name="l04384"></a><span class="lineno"> 4384</span>&#160;            <span class="keywordflow">if</span> (local_data_pt-&gt;is_pinned(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>))</div>
<div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160;            {</div>
<div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160;              local_data_pt-&gt;set_value(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, 0.0);</div>
<div class="line"><a name="l04387"></a><span class="lineno"> 4387</span>&#160;            }</div>
<div class="line"><a name="l04388"></a><span class="lineno"> 4388</span>&#160;          }</div>
<div class="line"><a name="l04389"></a><span class="lineno"> 4389</span>&#160;        }</div>
<div class="line"><a name="l04390"></a><span class="lineno"> 4390</span>&#160;      } <span class="comment">// End of loop over elements</span></div>
<div class="line"><a name="l04391"></a><span class="lineno"> 4391</span>&#160;    }</div>
<div class="line"><a name="l04392"></a><span class="lineno"> 4392</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04393"></a><span class="lineno"> 4393</span>&#160;    {</div>
<div class="line"><a name="l04394"></a><span class="lineno"> 4394</span>&#160;      <span class="comment">// Alternatively loop over all sub meshes</span></div>
<div class="line"><a name="l04395"></a><span class="lineno"> 4395</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> = 0; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> &lt; n_sub_mesh; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>++)</div>
<div class="line"><a name="l04396"></a><span class="lineno"> 4396</span>&#160;      {</div>
<div class="line"><a name="l04397"></a><span class="lineno"> 4397</span>&#160;        <span class="comment">// Loop over the nodes in the element</span></div>
<div class="line"><a name="l04398"></a><span class="lineno"> 4398</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_node = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab65f6fc9c49860e6324457a7e6e76346">Sub_mesh_pt</a>[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>]-&gt;nnode();</div>
<div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_node; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l04400"></a><span class="lineno"> 4400</span>&#160;        {</div>
<div class="line"><a name="l04401"></a><span class="lineno"> 4401</span>&#160;          Node* <span class="keyword">const</span> local_node_pt = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab65f6fc9c49860e6324457a7e6e76346">Sub_mesh_pt</a>[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>]-&gt;node_pt(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>);</div>
<div class="line"><a name="l04402"></a><span class="lineno"> 4402</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_value = local_node_pt-&gt;nvalue();</div>
<div class="line"><a name="l04403"></a><span class="lineno"> 4403</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; n_value; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l04404"></a><span class="lineno"> 4404</span>&#160;          {</div>
<div class="line"><a name="l04405"></a><span class="lineno"> 4405</span>&#160;            <span class="comment">// If the data value is pinned set the value to zero</span></div>
<div class="line"><a name="l04406"></a><span class="lineno"> 4406</span>&#160;            <span class="keywordflow">if</span> (local_node_pt-&gt;is_pinned(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>))</div>
<div class="line"><a name="l04407"></a><span class="lineno"> 4407</span>&#160;            {</div>
<div class="line"><a name="l04408"></a><span class="lineno"> 4408</span>&#160;              local_node_pt-&gt;set_value(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, 0.0);</div>
<div class="line"><a name="l04409"></a><span class="lineno"> 4409</span>&#160;            }</div>
<div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160;          }</div>
<div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160; </div>
<div class="line"><a name="l04412"></a><span class="lineno"> 4412</span>&#160;          <span class="comment">// Try to cast to a solid node</span></div>
<div class="line"><a name="l04413"></a><span class="lineno"> 4413</span>&#160;          SolidNode* <span class="keyword">const</span> local_solid_node_pt =</div>
<div class="line"><a name="l04414"></a><span class="lineno"> 4414</span>&#160;            <span class="keyword">dynamic_cast&lt;</span>SolidNode*<span class="keyword">&gt;</span>(local_node_pt);</div>
<div class="line"><a name="l04415"></a><span class="lineno"> 4415</span>&#160;          <span class="comment">// If we are successful</span></div>
<div class="line"><a name="l04416"></a><span class="lineno"> 4416</span>&#160;          <span class="keywordflow">if</span> (local_solid_node_pt)</div>
<div class="line"><a name="l04417"></a><span class="lineno"> 4417</span>&#160;          {</div>
<div class="line"><a name="l04418"></a><span class="lineno"> 4418</span>&#160;            <span class="comment">// Find the dimension of the node</span></div>
<div class="line"><a name="l04419"></a><span class="lineno"> 4419</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_dim = local_solid_node_pt-&gt;ndim();</div>
<div class="line"><a name="l04420"></a><span class="lineno"> 4420</span>&#160;            <span class="comment">// Find number of positions</span></div>
<div class="line"><a name="l04421"></a><span class="lineno"> 4421</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_position_type =</div>
<div class="line"><a name="l04422"></a><span class="lineno"> 4422</span>&#160;              local_solid_node_pt-&gt;nposition_type();</div>
<div class="line"><a name="l04423"></a><span class="lineno"> 4423</span>&#160; </div>
<div class="line"><a name="l04424"></a><span class="lineno"> 4424</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> = 0; <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> &lt; n_position_type; <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>++)</div>
<div class="line"><a name="l04425"></a><span class="lineno"> 4425</span>&#160;            {</div>
<div class="line"><a name="l04426"></a><span class="lineno"> 4426</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_dim; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l04427"></a><span class="lineno"> 4427</span>&#160;              {</div>
<div class="line"><a name="l04428"></a><span class="lineno"> 4428</span>&#160;                <span class="comment">// If the generalised position is pinned,</span></div>
<div class="line"><a name="l04429"></a><span class="lineno"> 4429</span>&#160;                <span class="comment">// set the value to zero</span></div>
<div class="line"><a name="l04430"></a><span class="lineno"> 4430</span>&#160;                <span class="keywordflow">if</span> (local_solid_node_pt-&gt;position_is_pinned(<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>, <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>))</div>
<div class="line"><a name="l04431"></a><span class="lineno"> 4431</span>&#160;                {</div>
<div class="line"><a name="l04432"></a><span class="lineno"> 4432</span>&#160;                  local_solid_node_pt-&gt;x_gen(<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>, <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = 0.0;</div>
<div class="line"><a name="l04433"></a><span class="lineno"> 4433</span>&#160;                }</div>
<div class="line"><a name="l04434"></a><span class="lineno"> 4434</span>&#160;              }</div>
<div class="line"><a name="l04435"></a><span class="lineno"> 4435</span>&#160;            }</div>
<div class="line"><a name="l04436"></a><span class="lineno"> 4436</span>&#160;          }</div>
<div class="line"><a name="l04437"></a><span class="lineno"> 4437</span>&#160;        }</div>
<div class="line"><a name="l04438"></a><span class="lineno"> 4438</span>&#160; </div>
<div class="line"><a name="l04439"></a><span class="lineno"> 4439</span>&#160;        <span class="comment">// Now loop over the element&#39;s and zero the internal data</span></div>
<div class="line"><a name="l04440"></a><span class="lineno"> 4440</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_element = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab65f6fc9c49860e6324457a7e6e76346">Sub_mesh_pt</a>[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>]-&gt;nelement();</div>
<div class="line"><a name="l04441"></a><span class="lineno"> 4441</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; n_element; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l04442"></a><span class="lineno"> 4442</span>&#160;        {</div>
<div class="line"><a name="l04443"></a><span class="lineno"> 4443</span>&#160;          GeneralisedElement* <span class="keyword">const</span> local_element_pt =</div>
<div class="line"><a name="l04444"></a><span class="lineno"> 4444</span>&#160;            <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab65f6fc9c49860e6324457a7e6e76346">Sub_mesh_pt</a>[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>]-&gt;element_pt(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>);</div>
<div class="line"><a name="l04445"></a><span class="lineno"> 4445</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_internal = local_element_pt-&gt;ninternal_data();</div>
<div class="line"><a name="l04446"></a><span class="lineno"> 4446</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_internal; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l04447"></a><span class="lineno"> 4447</span>&#160;          {</div>
<div class="line"><a name="l04448"></a><span class="lineno"> 4448</span>&#160;            Data* <span class="keyword">const</span> local_data_pt = local_element_pt-&gt;internal_data_pt(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l04449"></a><span class="lineno"> 4449</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_value = local_data_pt-&gt;nvalue();</div>
<div class="line"><a name="l04450"></a><span class="lineno"> 4450</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; n_value; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l04451"></a><span class="lineno"> 4451</span>&#160;            {</div>
<div class="line"><a name="l04452"></a><span class="lineno"> 4452</span>&#160;              <span class="comment">// If the data value is pinned set the value to zero</span></div>
<div class="line"><a name="l04453"></a><span class="lineno"> 4453</span>&#160;              <span class="keywordflow">if</span> (local_data_pt-&gt;is_pinned(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>))</div>
<div class="line"><a name="l04454"></a><span class="lineno"> 4454</span>&#160;              {</div>
<div class="line"><a name="l04455"></a><span class="lineno"> 4455</span>&#160;                local_data_pt-&gt;set_value(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, 0.0);</div>
<div class="line"><a name="l04456"></a><span class="lineno"> 4456</span>&#160;              }</div>
<div class="line"><a name="l04457"></a><span class="lineno"> 4457</span>&#160;            }</div>
<div class="line"><a name="l04458"></a><span class="lineno"> 4458</span>&#160;          }</div>
<div class="line"><a name="l04459"></a><span class="lineno"> 4459</span>&#160;        } <span class="comment">// End of loop over elements</span></div>
<div class="line"><a name="l04460"></a><span class="lineno"> 4460</span>&#160;      }</div>
<div class="line"><a name="l04461"></a><span class="lineno"> 4461</span>&#160;    }</div>
<div class="line"><a name="l04462"></a><span class="lineno"> 4462</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1Data_html_a7e67fc78a2e8a2fd6eb75bd292d42ff8"><div class="ttname"><a href="../../d8/dc5/classoomph_1_1Data.html#a7e67fc78a2e8a2fd6eb75bd292d42ff8">oomph::Data::nvalue</a></div><div class="ttdeci">unsigned nvalue() const</div><div class="ttdoc">Return number of values stored in data object (incl pinned ones).</div><div class="ttdef"><b>Definition:</b> nodes.h:483</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">oomph::Mesh::element_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a45e32d895d4b3686e0f15fe455f4ed44">oomph::GeneralisedElement::internal_data_pt()</a>, <a class="el" href="../../d8/dc5/classoomph_1_1Data.html#aedd0c445396ddcd650c814d17fef77dc">oomph::Data::is_pinned()</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>, <a class="el" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>, <a class="el" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>, <a class="el" href="../../dc/db7/classoomph_1_1Node.html#a786c96a8e46eb27a03b2b31f629d41b3">oomph::Node::ndim()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">oomph::Mesh::nelement()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a60a9b6861928cf9115110b5bfc7d11a7">nglobal_data()</a>, <a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a6b736de0af4c92831968636479b3480e">oomph::GeneralisedElement::ninternal_data()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a945e7823d1a2af243b5b7f7866aaff5e">oomph::Mesh::nnode()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">oomph::Mesh::node_pt()</a>, <a class="el" href="../../dc/db7/classoomph_1_1Node.html#aee6f2b7a46fc9d875c6736895d7fc095">oomph::Node::nposition_type()</a>, <a class="el" href="../../d8/dc5/classoomph_1_1Data.html#a7e67fc78a2e8a2fd6eb75bd292d42ff8">oomph::Data::nvalue()</a>, <a class="el" href="../../dc/dfd/classoomph_1_1SolidNode.html#afd8204156be2ff0fa40834ca35daf243">oomph::SolidNode::position_is_pinned()</a>, <a class="el" href="../../d8/dc5/classoomph_1_1Data.html#a7289ca322725c6fd493970a19474b382">oomph::Data::set_value()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab65f6fc9c49860e6324457a7e6e76346">Sub_mesh_pt</a>, and <a class="el" href="../../dc/db7/classoomph_1_1Node.html#a072d2dc645e03ccd18061a5c616aa6af">oomph::Node::x_gen()</a>.</p>

</div>
</div>
<a id="a50d54d4b374ea6a8d76798f34b865944"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50d54d4b374ea6a8d76798f34b865944">&#9670;&nbsp;</a></span>set_timestepper_for_all_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> long Problem::set_timestepper_for_all_data </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html">TimeStepper</a> *const &amp;&#160;</td>
          <td class="paramname"><em>time_stepper_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;&#160;</td>
          <td class="paramname"><em>preserve_existing_data</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set all problem data to have the same timestepper (timestepper_pt) Return the new number of dofs in the problem</p>
<p>Set all problem data to have the same timestepper (timestepper_pt). This is mainly used in continuation and bifurcation detection problems in which case the total number of unknowns may change and the changes to the underlying memory layout means that the Dof_pt must be reallocated. Thus, the function calls assign_eqn_numbers() and returns the number of new equation numbers. </p>
<div class="fragment"><div class="line"><a name="l11574"></a><span class="lineno">11574</span>&#160;  {</div>
<div class="line"><a name="l11575"></a><span class="lineno">11575</span>&#160;    <span class="comment">// Set the timestepper for the master mesh&#39;s nodal and elemental data</span></div>
<div class="line"><a name="l11576"></a><span class="lineno">11576</span>&#160;    <span class="comment">// to be the</span></div>
<div class="line"><a name="l11577"></a><span class="lineno">11577</span>&#160;    <span class="comment">// continuation time stepper. This will wipe all storage other than</span></div>
<div class="line"><a name="l11578"></a><span class="lineno">11578</span>&#160;    <span class="comment">// the 0th (present time) value at all the data objects</span></div>
<div class="line"><a name="l11579"></a><span class="lineno">11579</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a6c9a84e7e912c2fef3f513bfcd50fc70">set_nodal_and_elemental_time_stepper</a>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>,</div>
<div class="line"><a name="l11580"></a><span class="lineno">11580</span>&#160;                                                  preserve_existing_data);</div>
<div class="line"><a name="l11581"></a><span class="lineno">11581</span>&#160; </div>
<div class="line"><a name="l11582"></a><span class="lineno">11582</span>&#160;    <span class="comment">// Deal with the any additional mesh level timestepper data separately</span></div>
<div class="line"><a name="l11583"></a><span class="lineno">11583</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_sub_mesh = this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>();</div>
<div class="line"><a name="l11584"></a><span class="lineno">11584</span>&#160;    <span class="comment">// If there is only one mesh</span></div>
<div class="line"><a name="l11585"></a><span class="lineno">11585</span>&#160;    <span class="keywordflow">if</span> (n_sub_mesh == 0)</div>
<div class="line"><a name="l11586"></a><span class="lineno">11586</span>&#160;    {</div>
<div class="line"><a name="l11587"></a><span class="lineno">11587</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a52c30b4ebc67038e137a5de1c5d422e5">set_mesh_level_time_stepper</a>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>,</div>
<div class="line"><a name="l11588"></a><span class="lineno">11588</span>&#160;                                           preserve_existing_data);</div>
<div class="line"><a name="l11589"></a><span class="lineno">11589</span>&#160;    }</div>
<div class="line"><a name="l11590"></a><span class="lineno">11590</span>&#160;    <span class="comment">// Otherwise loop over the sub meshes</span></div>
<div class="line"><a name="l11591"></a><span class="lineno">11591</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l11592"></a><span class="lineno">11592</span>&#160;    {</div>
<div class="line"><a name="l11593"></a><span class="lineno">11593</span>&#160;      <span class="comment">// Assign global equation numbers first</span></div>
<div class="line"><a name="l11594"></a><span class="lineno">11594</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_sub_mesh; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l11595"></a><span class="lineno">11595</span>&#160;      {</div>
<div class="line"><a name="l11596"></a><span class="lineno">11596</span>&#160;        this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab65f6fc9c49860e6324457a7e6e76346">Sub_mesh_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;set_mesh_level_time_stepper(</div>
<div class="line"><a name="l11597"></a><span class="lineno">11597</span>&#160;          <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>, preserve_existing_data);</div>
<div class="line"><a name="l11598"></a><span class="lineno">11598</span>&#160;      }</div>
<div class="line"><a name="l11599"></a><span class="lineno">11599</span>&#160;    }</div>
<div class="line"><a name="l11600"></a><span class="lineno">11600</span>&#160; </div>
<div class="line"><a name="l11601"></a><span class="lineno">11601</span>&#160;    <span class="comment">// Also set time stepper for global data</span></div>
<div class="line"><a name="l11602"></a><span class="lineno">11602</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_global = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>.size();</div>
<div class="line"><a name="l11603"></a><span class="lineno">11603</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_global; ++<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><a name="l11604"></a><span class="lineno">11604</span>&#160;    {</div>
<div class="line"><a name="l11605"></a><span class="lineno">11605</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;set_time_stepper(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>,</div>
<div class="line"><a name="l11606"></a><span class="lineno">11606</span>&#160;                                          preserve_existing_data);</div>
<div class="line"><a name="l11607"></a><span class="lineno">11607</span>&#160;    }</div>
<div class="line"><a name="l11608"></a><span class="lineno">11608</span>&#160; </div>
<div class="line"><a name="l11609"></a><span class="lineno">11609</span>&#160;    <span class="comment">// We now need to reassign equations numbers because the Dof pointer</span></div>
<div class="line"><a name="l11610"></a><span class="lineno">11610</span>&#160;    <span class="comment">// will be inappropriate  because memory has been reallocated</span></div>
<div class="line"><a name="l11611"></a><span class="lineno">11611</span>&#160; </div>
<div class="line"><a name="l11612"></a><span class="lineno">11612</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l11613"></a><span class="lineno">11613</span>&#160;    <span class="keywordflow">if</span> (Problem_has_been_distributed)</div>
<div class="line"><a name="l11614"></a><span class="lineno">11614</span>&#160;    {</div>
<div class="line"><a name="l11615"></a><span class="lineno">11615</span>&#160;      std::ostringstream warning_stream;</div>
<div class="line"><a name="l11616"></a><span class="lineno">11616</span>&#160;      warning_stream &lt;&lt; <span class="stringliteral">&quot;This has not been comprehensively tested for &quot;</span></div>
<div class="line"><a name="l11617"></a><span class="lineno">11617</span>&#160;                        <span class="stringliteral">&quot;distributed problems.\n&quot;</span></div>
<div class="line"><a name="l11618"></a><span class="lineno">11618</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;I&#39;m sure that I need to worry about external halo and &quot;</span></div>
<div class="line"><a name="l11619"></a><span class="lineno">11619</span>&#160;                        <span class="stringliteral">&quot;external elements.&quot;</span></div>
<div class="line"><a name="l11620"></a><span class="lineno">11620</span>&#160;                     &lt;&lt; std::endl;</div>
<div class="line"><a name="l11621"></a><span class="lineno">11621</span>&#160;      OomphLibWarning(</div>
<div class="line"><a name="l11622"></a><span class="lineno">11622</span>&#160;        warning_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l11623"></a><span class="lineno">11623</span>&#160;    }</div>
<div class="line"><a name="l11624"></a><span class="lineno">11624</span>&#160; </div>
<div class="line"><a name="l11625"></a><span class="lineno">11625</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l11626"></a><span class="lineno">11626</span>&#160; </div>
<div class="line"><a name="l11627"></a><span class="lineno">11627</span>&#160;    <span class="keywordflow">return</span> (this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers</a>());</div>
<div class="line"><a name="l11628"></a><span class="lineno">11628</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_a52c30b4ebc67038e137a5de1c5d422e5"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#a52c30b4ebc67038e137a5de1c5d422e5">oomph::Mesh::set_mesh_level_time_stepper</a></div><div class="ttdeci">virtual void set_mesh_level_time_stepper(TimeStepper *const &amp;time_stepper_pt, const bool &amp;preserve_existing_data)</div><div class="ttdef"><b>Definition:</b> mesh.cc:2402</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_a6c9a84e7e912c2fef3f513bfcd50fc70"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#a6c9a84e7e912c2fef3f513bfcd50fc70">oomph::Mesh::set_nodal_and_elemental_time_stepper</a></div><div class="ttdeci">void set_nodal_and_elemental_time_stepper(TimeStepper *const &amp;time_stepper_pt, const bool &amp;preserve_existing_data)</div><div class="ttdef"><b>Definition:</b> mesh.h:1032</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a52c30b4ebc67038e137a5de1c5d422e5">oomph::Mesh::set_mesh_level_time_stepper()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a6c9a84e7e912c2fef3f513bfcd50fc70">oomph::Mesh::set_nodal_and_elemental_time_stepper()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab65f6fc9c49860e6324457a7e6e76346">Sub_mesh_pt</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aee0d9902fd26b600c9519bea2dfc0f54">arc_length_step_solve()</a>.</p>

</div>
</div>
<a id="ab5f60ebc552c00ee681776bc7fa61203"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5f60ebc552c00ee681776bc7fa61203">&#9670;&nbsp;</a></span>setup_base_mesh_info_after_pruning()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Problem::setup_base_mesh_info_after_pruning </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Helper function to re-setup the Base_mesh enumeration (used during load balancing) after pruning </p>

</div>
</div>
<a id="aae085671047b62a98ef310d66cc3f412"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae085671047b62a98ef310d66cc3f412">&#9670;&nbsp;</a></span>setup_element_count_per_dof()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> Problem::setup_element_count_per_dof </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Function that populates the Element_counter_per_dof vector with the number of elements that contribute to each dof. For example, with linear elements in 1D each dof contains contributions from two elements apart from those on the boundary. Returns the total number of elements in the problem</p>
<p>Setup the count vector that records how many elements contribute to each degree of freedom. Returns the total number of elements in the problem </p>
<div class="fragment"><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="comment">// Now set the element counter to have the current Dof distribution</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae4177b73a790b80d541b416d1e83c6c3">Element_count_per_dof</a>.<a class="code" href="../../d6/d5b/classoomph_1_1DoubleVector.html#a7bcc94c157d6853a0f0502e8a76ed380">build</a>(this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="comment">// We need to use the halo scheme (assuming it has been setup)</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae4177b73a790b80d541b416d1e83c6c3">Element_count_per_dof</a>.<a class="code" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html#a1aab1a84c6a82a755fdc3c6b27ce49d7">build_halo_scheme</a>(this-&gt;Halo_scheme_pt);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="comment">// Loop over the elements and count the entries</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="comment">// and number of (non-halo) elements</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_element = this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>()-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">nelement</a>();</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordtype">unsigned</span> n_non_halo_element_local = 0;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; n_element; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    {</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      GeneralisedElement* elem_pt = this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>()-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">element_pt</a>(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      <span class="comment">// Ignore halo elements</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      <span class="keywordflow">if</span> (!elem_pt-&gt;is_halo())</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      {</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <span class="comment">// Increment the number of non halo elements</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        ++n_non_halo_element_local;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <span class="comment">// Now count the number of times the element contributes to a value</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="comment">// using the current assembly handler</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        <span class="keywordtype">unsigned</span> n_var = this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>-&gt;<a class="code" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a09213be8f4aa009e0366460a7ed78e68">ndof</a>(elem_pt);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_var; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;          ++<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae4177b73a790b80d541b416d1e83c6c3">Element_count_per_dof</a>.<a class="code" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html#a8891ed97a65045e43f906237b109dad2">global_value</a>(</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>-&gt;<a class="code" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a94d28e2de2559cde803d1ba2195b5290">eqn_number</a>(elem_pt, <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>));</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        }</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      }</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    }</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="comment">// Storage for the total number of elements</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keywordtype">unsigned</span> Nelement = 0;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="comment">// Add together all the counts if we are in parallel</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae4177b73a790b80d541b416d1e83c6c3">Element_count_per_dof</a>.<a class="code" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html#a7165745d3397b6ea9d87f123cc97e5c9">sum_all_halo_and_haloed_values</a>();</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="comment">// If distributed, find the total number of elements in the problem</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keywordflow">if</span> (this-&gt;Problem_has_been_distributed)</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    {</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      <span class="comment">// Need to gather the total number of non halo elements</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      MPI_Allreduce(&amp;n_non_halo_element_local,</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                    &amp;Nelement,</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                    1,</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                    MPI_UNSIGNED,</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                    MPI_SUM,</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                    this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">communicator_pt</a>()-&gt;mpi_comm());</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    }</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="comment">// Otherwise the total number is the same on each processor</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    {</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      Nelement = n_non_halo_element_local;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    }</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordflow">return</span> Nelement;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1DoubleVectorWithHaloEntries_html_a1aab1a84c6a82a755fdc3c6b27ce49d7"><div class="ttname"><a href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html#a1aab1a84c6a82a755fdc3c6b27ce49d7">oomph::DoubleVectorWithHaloEntries::build_halo_scheme</a></div><div class="ttdeci">void build_halo_scheme(DoubleVectorHaloScheme *const &amp;halo_scheme_pt)</div><div class="ttdoc">Construct the halo scheme and storage for the halo data.</div><div class="ttdef"><b>Definition:</b> double_vector_with_halo.cc:379</div></div>
<div class="ttc" id="aclassoomph_1_1DoubleVectorWithHaloEntries_html_a7165745d3397b6ea9d87f123cc97e5c9"><div class="ttname"><a href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html#a7165745d3397b6ea9d87f123cc97e5c9">oomph::DoubleVectorWithHaloEntries::sum_all_halo_and_haloed_values</a></div><div class="ttdeci">void sum_all_halo_and_haloed_values()</div><div class="ttdef"><b>Definition:</b> double_vector_with_halo.cc:323</div></div>
<div class="ttc" id="aclassoomph_1_1DoubleVectorWithHaloEntries_html_a8891ed97a65045e43f906237b109dad2"><div class="ttname"><a href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html#a8891ed97a65045e43f906237b109dad2">oomph::DoubleVectorWithHaloEntries::global_value</a></div><div class="ttdeci">double &amp; global_value(const unsigned &amp;i)</div><div class="ttdoc">Direct access to global entry.</div><div class="ttdef"><b>Definition:</b> double_vector_with_halo.h:221</div></div>
<div class="ttc" id="aclassoomph_1_1DoubleVector_html_a7bcc94c157d6853a0f0502e8a76ed380"><div class="ttname"><a href="../../d6/d5b/classoomph_1_1DoubleVector.html#a7bcc94c157d6853a0f0502e8a76ed380">oomph::DoubleVector::build</a></div><div class="ttdeci">void build(const DoubleVector &amp;old_vector)</div><div class="ttdoc">Just copys the argument DoubleVector.</div><div class="ttdef"><b>Definition:</b> double_vector.cc:35</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_ae4177b73a790b80d541b416d1e83c6c3"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#ae4177b73a790b80d541b416d1e83c6c3">oomph::Problem::Element_count_per_dof</a></div><div class="ttdeci">DoubleVectorWithHaloEntries Element_count_per_dof</div><div class="ttdef"><b>Definition:</b> problem.h:560</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#a7bcc94c157d6853a0f0502e8a76ed380">oomph::DoubleVector::build()</a>, <a class="el" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html#a1aab1a84c6a82a755fdc3c6b27ce49d7">oomph::DoubleVectorWithHaloEntries::build_halo_scheme()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">communicator_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>, <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae4177b73a790b80d541b416d1e83c6c3">Element_count_per_dof</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">oomph::Mesh::element_pt()</a>, <a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a94d28e2de2559cde803d1ba2195b5290">oomph::AssemblyHandler::eqn_number()</a>, <a class="el" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html#a8891ed97a65045e43f906237b109dad2">oomph::DoubleVectorWithHaloEntries::global_value()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt()</a>, <a class="el" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>, <a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a09213be8f4aa009e0366460a7ed78e68">oomph::AssemblyHandler::ndof()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">oomph::Mesh::nelement()</a>, and <a class="el" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html#a7165745d3397b6ea9d87f123cc97e5c9">oomph::DoubleVectorWithHaloEntries::sum_all_halo_and_haloed_values()</a>.</p>

</div>
</div>
<a id="a3d3108a38cfbed4087f5b8eb601f38a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d3108a38cfbed4087f5b8eb601f38a2">&#9670;&nbsp;</a></span>shift_time_values()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::shift_time_values </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Shift all values along to prepare for next timestep. </p>
<p>Shift all time-dependent data along for next timestep. </p>
<div class="fragment"><div class="line"><a name="l11635"></a><span class="lineno">11635</span>&#160;  {</div>
<div class="line"><a name="l11636"></a><span class="lineno">11636</span>&#160;    <span class="comment">// Move the values of dt in the Time object</span></div>
<div class="line"><a name="l11637"></a><span class="lineno">11637</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae33fbf5f34a7d06d88ad2c98538bbbe8">Time_pt</a>-&gt;<a class="code" href="../../d0/da1/classoomph_1_1Time.html#a92ca0ca34a1491744a3315d61d7cee5f">shift_dt</a>();</div>
<div class="line"><a name="l11638"></a><span class="lineno">11638</span>&#160; </div>
<div class="line"><a name="l11639"></a><span class="lineno">11639</span>&#160;    <span class="comment">// Only shift time values in the &quot;master&quot; mesh, otherwise things will</span></div>
<div class="line"><a name="l11640"></a><span class="lineno">11640</span>&#160;    <span class="comment">// get shifted twice in complex problems</span></div>
<div class="line"><a name="l11641"></a><span class="lineno">11641</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a7f097aaa854ac697f8016ba3b7e6c982">shift_time_values</a>();</div>
<div class="line"><a name="l11642"></a><span class="lineno">11642</span>&#160; </div>
<div class="line"><a name="l11643"></a><span class="lineno">11643</span>&#160;    <span class="comment">// Shift global data with their own timesteppers</span></div>
<div class="line"><a name="l11644"></a><span class="lineno">11644</span>&#160;    <span class="keywordtype">unsigned</span> Nglobal = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>.size();</div>
<div class="line"><a name="l11645"></a><span class="lineno">11645</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> iglobal = 0; iglobal &lt; Nglobal; iglobal++)</div>
<div class="line"><a name="l11646"></a><span class="lineno">11646</span>&#160;    {</div>
<div class="line"><a name="l11647"></a><span class="lineno">11647</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>[iglobal]-&gt;time_stepper_pt()-&gt;shift_time_values(</div>
<div class="line"><a name="l11648"></a><span class="lineno">11648</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>[iglobal]);</div>
<div class="line"><a name="l11649"></a><span class="lineno">11649</span>&#160;    }</div>
<div class="line"><a name="l11650"></a><span class="lineno">11650</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_a7f097aaa854ac697f8016ba3b7e6c982"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#a7f097aaa854ac697f8016ba3b7e6c982">oomph::Mesh::shift_time_values</a></div><div class="ttdeci">void shift_time_values()</div><div class="ttdef"><b>Definition:</b> mesh.cc:2326</div></div>
<div class="ttc" id="aclassoomph_1_1Time_html_a92ca0ca34a1491744a3315d61d7cee5f"><div class="ttname"><a href="../../d0/da1/classoomph_1_1Time.html#a92ca0ca34a1491744a3315d61d7cee5f">oomph::Time::shift_dt</a></div><div class="ttdeci">void shift_dt()</div><div class="ttdef"><b>Definition:</b> timesteppers.h:174</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa963c98e91d135d31cdcfbe1afa64603">Global_data_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa4a3bf9419e495aaaaea0dcb00ea53e5">Mesh_pt</a>, <a class="el" href="../../d0/da1/classoomph_1_1Time.html#a92ca0ca34a1491744a3315d61d7cee5f">oomph::Time::shift_dt()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a7f097aaa854ac697f8016ba3b7e6c982">oomph::Mesh::shift_time_values()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae33fbf5f34a7d06d88ad2c98538bbbe8">Time_pt</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a63805c549e71b7c73107abe6001fae25">adaptive_unsteady_newton_solve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a2eff0725bba4f2435bcc4797a9e59ab4">explicit_timestep()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a4b015281f27d25ee0209cd9b467175b6">unsteady_newton_solve()</a>, and <a class="el" href="../../de/da7/classoomph_1_1SegregatableFSIProblem.html#a17f019ebaf83e170219bf605a8554111">oomph::SegregatableFSIProblem::unsteady_segregated_solve()</a>.</p>

</div>
</div>
<a id="a797cb28b5fffe976fc7541421eb423a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a797cb28b5fffe976fc7541421eb423a1">&#9670;&nbsp;</a></span>sign_of_jacobian()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a>&amp; oomph::Problem::sign_of_jacobian </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Access function for the sign of the global jacobian matrix. This will be set by the linear solver, if possible (direct solver). If not alternative methods must be used to detect bifurcations (solving the associated eigenproblem). </p>
<div class="fragment"><div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;    {</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aca97d61840e46edc914e3cb4b98fd437">Sign_of_jacobian</a>;</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aca97d61840e46edc914e3cb4b98fd437">Sign_of_jacobian</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d4b/classoomph_1_1AugmentedBlockFoldLinearSolver.html#a11690b33089e999d0c894b4e4b0646d9">oomph::AugmentedBlockFoldLinearSolver::solve()</a>, <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#ad196867613954a8fabd318b50e2aadc6">oomph::BlockPitchForkLinearSolver::solve()</a>, <a class="el" href="../../de/d72/classoomph_1_1AugmentedBlockPitchForkLinearSolver.html#a0cbeb150ac83d5be1a1e30c0f728a70b">oomph::AugmentedBlockPitchForkLinearSolver::solve()</a>, <a class="el" href="../../df/dbd/classoomph_1_1BlockHopfLinearSolver.html#a5e9ff24466ec138cca8264e5befc31fe">oomph::BlockHopfLinearSolver::solve()</a>, <a class="el" href="../../de/d04/classoomph_1_1HSL__MA42.html#ae796a6b14c13d1cdb7bf49ca3c7c5aec">oomph::HSL_MA42::solve()</a>, <a class="el" href="../../d3/d06/classoomph_1_1DenseLU.html#ac354b224819146618ce8a1396f8f980e">oomph::DenseLU::solve()</a>, <a class="el" href="../../d0/d00/classoomph_1_1FD__LU.html#a6fd251bef9cdb7efbed4927f005eda2f">oomph::FD_LU::solve()</a>, <a class="el" href="../../d7/db1/classoomph_1_1SuperLUSolver.html#a5a121df89c72a8741d051aa176b12255">oomph::SuperLUSolver::solve()</a>, <a class="el" href="../../de/d04/classoomph_1_1HSL__MA42.html#a79fca4aba6935fc5376cd9fa33a05f6a">oomph::HSL_MA42::solve_for_one_dof()</a>, <a class="el" href="../../df/dbd/classoomph_1_1BlockHopfLinearSolver.html#a9a7cc6bda9ab1a8baf83d5d8e1fe5eea">oomph::BlockHopfLinearSolver::solve_for_two_rhs()</a>, and <a class="el" href="../../d7/db1/classoomph_1_1SuperLUSolver.html#a10bdce2b176a3ca514b82f66cd50e037">oomph::SuperLUSolver::solve_transpose()</a>.</p>

</div>
</div>
<a id="ad267407d3593871e4b8810ea5380f4ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad267407d3593871e4b8810ea5380f4ea">&#9670;&nbsp;</a></span>solve_eigenproblem() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Problem::solve_eigenproblem </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>n_eval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; std::complex&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>eigenvalue</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;&#160;</td>
          <td class="paramname"><em>steady</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Solve an eigenproblem as assembled by EigenElements, but only return the eigenvalues, not the eigenvectors. The boolean flag (default true) is used to specify whether the weighted mass-matrix terms from the timestepping scheme should be included in the jacobian. </p>
<div class="fragment"><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;    {</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;      <span class="comment">// Create temporary storage for the eigenvectors (potentially wasteful)</span></div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;      Vector&lt;DoubleVector&gt; eigenvector;</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a06cf96b1291774eb89517af10f80410a">solve_eigenproblem</a>(n_eval, eigenvalue, eigenvector, steady);</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a06cf96b1291774eb89517af10f80410a"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a06cf96b1291774eb89517af10f80410a">oomph::Problem::solve_eigenproblem</a></div><div class="ttdeci">void solve_eigenproblem(const unsigned &amp;n_eval, Vector&lt; std::complex&lt; double &gt;&gt; &amp;eigenvalue, Vector&lt; DoubleVector &gt; &amp;eigenvector, const bool &amp;steady=true)</div><div class="ttdoc">Solve the eigenproblem.</div><div class="ttdef"><b>Definition:</b> problem.cc:8313</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a06cf96b1291774eb89517af10f80410a">solve_eigenproblem()</a>.</p>

</div>
</div>
<a id="a06cf96b1291774eb89517af10f80410a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06cf96b1291774eb89517af10f80410a">&#9670;&nbsp;</a></span>solve_eigenproblem() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::solve_eigenproblem </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>n_eval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; std::complex&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>eigenvalue</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>eigenvector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;&#160;</td>
          <td class="paramname"><em>steady</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Solve the eigenproblem. </p>
<p>Get derivative of an element in the problem wrt a global parameter, used in continuation problems Solve an eigenproblem as assembled by EigenElements calculate n_eval eigenvalues and return the corresponding eigenvectors. The boolean flag (default true) specifies whether the steady jacobian should be assembled. If the flag is false then the weighted mass-matrix terms from the timestepper will be included in the jacobian &mdash; this is almost certainly never wanted.</p>
<p>Get derivative of an element in the problem wrt a global parameter, to be used in continuation problems </p>
<div class="fragment"><div class="line"><a name="l08317"></a><span class="lineno"> 8317</span>&#160;  {</div>
<div class="line"><a name="l08318"></a><span class="lineno"> 8318</span>&#160;    <span class="comment">// If the boolean flag is steady, then make all the timesteppers steady</span></div>
<div class="line"><a name="l08319"></a><span class="lineno"> 8319</span>&#160;    <span class="comment">// before solving the eigenproblem. This will &quot;switch off&quot; the</span></div>
<div class="line"><a name="l08320"></a><span class="lineno"> 8320</span>&#160;    <span class="comment">// time-derivative terms in the jacobian matrix</span></div>
<div class="line"><a name="l08321"></a><span class="lineno"> 8321</span>&#160;    <span class="keywordflow">if</span> (steady)</div>
<div class="line"><a name="l08322"></a><span class="lineno"> 8322</span>&#160;    {</div>
<div class="line"><a name="l08323"></a><span class="lineno"> 8323</span>&#160;      <span class="comment">// Find out how many timesteppers there are</span></div>
<div class="line"><a name="l08324"></a><span class="lineno"> 8324</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_time_steppers = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ace3cdf55009c3bff21d2b7d3706d522a">ntime_stepper</a>();</div>
<div class="line"><a name="l08325"></a><span class="lineno"> 8325</span>&#160; </div>
<div class="line"><a name="l08326"></a><span class="lineno"> 8326</span>&#160;      <span class="comment">// Vector of bools to store the is_steady status of the various</span></div>
<div class="line"><a name="l08327"></a><span class="lineno"> 8327</span>&#160;      <span class="comment">// timesteppers when we came in here</span></div>
<div class="line"><a name="l08328"></a><span class="lineno"> 8328</span>&#160;      std::vector&lt;bool&gt; was_steady(n_time_steppers);</div>
<div class="line"><a name="l08329"></a><span class="lineno"> 8329</span>&#160; </div>
<div class="line"><a name="l08330"></a><span class="lineno"> 8330</span>&#160;      <span class="comment">// Loop over them all and make them (temporarily) static</span></div>
<div class="line"><a name="l08331"></a><span class="lineno"> 8331</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_time_steppers; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l08332"></a><span class="lineno"> 8332</span>&#160;      {</div>
<div class="line"><a name="l08333"></a><span class="lineno"> 8333</span>&#160;        was_steady[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)-&gt;<a class="code" href="../../d5/d19/classoomph_1_1TimeStepper.html#ad341ba9e80265e1c26c1cda0f40c8292">is_steady</a>();</div>
<div class="line"><a name="l08334"></a><span class="lineno"> 8334</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)-&gt;<a class="code" href="../../d5/d19/classoomph_1_1TimeStepper.html#a81ea0ff2e66cef5e0184b616c608e418">make_steady</a>();</div>
<div class="line"><a name="l08335"></a><span class="lineno"> 8335</span>&#160;      }</div>
<div class="line"><a name="l08336"></a><span class="lineno"> 8336</span>&#160; </div>
<div class="line"><a name="l08337"></a><span class="lineno"> 8337</span>&#160;      <span class="comment">// Call the Eigenproblem for the eigensolver</span></div>
<div class="line"><a name="l08338"></a><span class="lineno"> 8338</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab7938313fa45df9be16515a6b0bfd324">Eigen_solver_pt</a>-&gt;<a class="code" href="../../de/dba/classoomph_1_1EigenSolver.html#a67b1178450cd4b229432d1b497299b73">solve_eigenproblem</a>(</div>
<div class="line"><a name="l08339"></a><span class="lineno"> 8339</span>&#160;        <span class="keyword">this</span>, n_eval, eigenvalue, eigenvector);</div>
<div class="line"><a name="l08340"></a><span class="lineno"> 8340</span>&#160; </div>
<div class="line"><a name="l08341"></a><span class="lineno"> 8341</span>&#160;      <span class="comment">// Reset the is_steady status of all timesteppers that</span></div>
<div class="line"><a name="l08342"></a><span class="lineno"> 8342</span>&#160;      <span class="comment">// weren&#39;t already steady when we came in here and reset their</span></div>
<div class="line"><a name="l08343"></a><span class="lineno"> 8343</span>&#160;      <span class="comment">// weights</span></div>
<div class="line"><a name="l08344"></a><span class="lineno"> 8344</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_time_steppers; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l08345"></a><span class="lineno"> 8345</span>&#160;      {</div>
<div class="line"><a name="l08346"></a><span class="lineno"> 8346</span>&#160;        <span class="keywordflow">if</span> (!was_steady[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><a name="l08347"></a><span class="lineno"> 8347</span>&#160;        {</div>
<div class="line"><a name="l08348"></a><span class="lineno"> 8348</span>&#160;          <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)-&gt;<a class="code" href="../../d5/d19/classoomph_1_1TimeStepper.html#aada05f89e86aae352bd5b32bfb173b18">undo_make_steady</a>();</div>
<div class="line"><a name="l08349"></a><span class="lineno"> 8349</span>&#160;        }</div>
<div class="line"><a name="l08350"></a><span class="lineno"> 8350</span>&#160;      }</div>
<div class="line"><a name="l08351"></a><span class="lineno"> 8351</span>&#160;    }</div>
<div class="line"><a name="l08352"></a><span class="lineno"> 8352</span>&#160;    <span class="comment">// Otherwise if we don&#39;t want to make the problem steady, just</span></div>
<div class="line"><a name="l08353"></a><span class="lineno"> 8353</span>&#160;    <span class="comment">// assemble and solve the eigensystem</span></div>
<div class="line"><a name="l08354"></a><span class="lineno"> 8354</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l08355"></a><span class="lineno"> 8355</span>&#160;    {</div>
<div class="line"><a name="l08356"></a><span class="lineno"> 8356</span>&#160;      <span class="comment">// Call the Eigenproblem for the eigensolver</span></div>
<div class="line"><a name="l08357"></a><span class="lineno"> 8357</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ab7938313fa45df9be16515a6b0bfd324">Eigen_solver_pt</a>-&gt;<a class="code" href="../../de/dba/classoomph_1_1EigenSolver.html#a67b1178450cd4b229432d1b497299b73">solve_eigenproblem</a>(</div>
<div class="line"><a name="l08358"></a><span class="lineno"> 8358</span>&#160;        <span class="keyword">this</span>, n_eval, eigenvalue, eigenvector);</div>
<div class="line"><a name="l08359"></a><span class="lineno"> 8359</span>&#160;    }</div>
<div class="line"><a name="l08360"></a><span class="lineno"> 8360</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1EigenSolver_html_a67b1178450cd4b229432d1b497299b73"><div class="ttname"><a href="../../de/dba/classoomph_1_1EigenSolver.html#a67b1178450cd4b229432d1b497299b73">oomph::EigenSolver::solve_eigenproblem</a></div><div class="ttdeci">virtual void solve_eigenproblem(Problem *const &amp;problem_pt, const int &amp;n_eval, Vector&lt; std::complex&lt; double &gt;&gt; &amp;eigenvalue, Vector&lt; DoubleVector &gt; &amp;eigenvector)=0</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab7938313fa45df9be16515a6b0bfd324">Eigen_solver_pt</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html#ad341ba9e80265e1c26c1cda0f40c8292">oomph::TimeStepper::is_steady()</a>, <a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html#a81ea0ff2e66cef5e0184b616c608e418">oomph::TimeStepper::make_steady()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ace3cdf55009c3bff21d2b7d3706d522a">ntime_stepper()</a>, <a class="el" href="../../de/dba/classoomph_1_1EigenSolver.html#a67b1178450cd4b229432d1b497299b73">oomph::EigenSolver::solve_eigenproblem()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt()</a>, and <a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html#aada05f89e86aae352bd5b32bfb173b18">oomph::TimeStepper::undo_make_steady()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad267407d3593871e4b8810ea5380f4ea">solve_eigenproblem()</a>.</p>

</div>
</div>
<a id="ab9cdd18180be05e4d46bfdbc1acbdbd3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9cdd18180be05e4d46bfdbc1acbdbd3">&#9670;&nbsp;</a></span>sparse_assemble_row_or_column_compressed()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::sparse_assemble_row_or_column_compressed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>column_or_row_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>row_or_column_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>nnz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>residuals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>compressed_row_flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Protected helper function that is used to assemble the Jacobian matrix in the case when the storage is row or column compressed. The boolean Flag indicates if we want compressed row format (true) or compressed column.</p>
<p>This is a (private) helper function that is used to assemble system matrices in compressed row or column format and compute residual vectors. The default action is to assemble the jacobian matrix and residuals for the Newton method. The action can be overloaded at an elemental level by changing the default behaviour of the function Element::get_all_vectors_and_matrices(). column_or_row_index: Column [or row] index of given entry row_or_column_start: Index of first entry for given row [or column] value : Vector of nonzero entries residuals : Residual vector compressed_row_flag: Bool flag to indicate if storage format is compressed row [if false interpretation of arguments is as stated in square brackets]. We provide four different assembly methods, each with different memory requirements/execution speeds. The method is set by the public flag Problem::Sparse_assembly_method. </p>
<div class="fragment"><div class="line"><a name="l04491"></a><span class="lineno"> 4491</span>&#160;  {</div>
<div class="line"><a name="l04492"></a><span class="lineno"> 4492</span>&#160;    <span class="comment">// Choose the actual method</span></div>
<div class="line"><a name="l04493"></a><span class="lineno"> 4493</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a447f9d42b248f6c394581ff1a0b02513">Sparse_assembly_method</a>)</div>
<div class="line"><a name="l04494"></a><span class="lineno"> 4494</span>&#160;    {</div>
<div class="line"><a name="l04495"></a><span class="lineno"> 4495</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ac793c004113930938730ec04dd2245b7aa00e1772bb5ccf1c837a2bad2f240241">Perform_assembly_using_vectors_of_pairs</a>:</div>
<div class="line"><a name="l04496"></a><span class="lineno"> 4496</span>&#160; </div>
<div class="line"><a name="l04497"></a><span class="lineno"> 4497</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a7eb5e0e3dc02fa26eec9d023b80b9603">sparse_assemble_row_or_column_compressed_with_vectors_of_pairs</a>(</div>
<div class="line"><a name="l04498"></a><span class="lineno"> 4498</span>&#160;          column_or_row_index,</div>
<div class="line"><a name="l04499"></a><span class="lineno"> 4499</span>&#160;          row_or_column_start,</div>
<div class="line"><a name="l04500"></a><span class="lineno"> 4500</span>&#160;          <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>,</div>
<div class="line"><a name="l04501"></a><span class="lineno"> 4501</span>&#160;          nnz,</div>
<div class="line"><a name="l04502"></a><span class="lineno"> 4502</span>&#160;          residuals,</div>
<div class="line"><a name="l04503"></a><span class="lineno"> 4503</span>&#160;          compressed_row_flag);</div>
<div class="line"><a name="l04504"></a><span class="lineno"> 4504</span>&#160; </div>
<div class="line"><a name="l04505"></a><span class="lineno"> 4505</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04506"></a><span class="lineno"> 4506</span>&#160; </div>
<div class="line"><a name="l04507"></a><span class="lineno"> 4507</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ac793c004113930938730ec04dd2245b7a6008d2b6aa449ee405313b49632d18ff">Perform_assembly_using_two_vectors</a>:</div>
<div class="line"><a name="l04508"></a><span class="lineno"> 4508</span>&#160; </div>
<div class="line"><a name="l04509"></a><span class="lineno"> 4509</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a5bc761a0dee39437b2ebeba75079856f">sparse_assemble_row_or_column_compressed_with_two_vectors</a>(</div>
<div class="line"><a name="l04510"></a><span class="lineno"> 4510</span>&#160;          column_or_row_index,</div>
<div class="line"><a name="l04511"></a><span class="lineno"> 4511</span>&#160;          row_or_column_start,</div>
<div class="line"><a name="l04512"></a><span class="lineno"> 4512</span>&#160;          <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>,</div>
<div class="line"><a name="l04513"></a><span class="lineno"> 4513</span>&#160;          nnz,</div>
<div class="line"><a name="l04514"></a><span class="lineno"> 4514</span>&#160;          residuals,</div>
<div class="line"><a name="l04515"></a><span class="lineno"> 4515</span>&#160;          compressed_row_flag);</div>
<div class="line"><a name="l04516"></a><span class="lineno"> 4516</span>&#160; </div>
<div class="line"><a name="l04517"></a><span class="lineno"> 4517</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04518"></a><span class="lineno"> 4518</span>&#160; </div>
<div class="line"><a name="l04519"></a><span class="lineno"> 4519</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ac793c004113930938730ec04dd2245b7a406ad24599e1a59450acdd09bac1d717">Perform_assembly_using_maps</a>:</div>
<div class="line"><a name="l04520"></a><span class="lineno"> 4520</span>&#160; </div>
<div class="line"><a name="l04521"></a><span class="lineno"> 4521</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a7ba1b95df63f6e7d746a6dae641daa33">sparse_assemble_row_or_column_compressed_with_maps</a>(column_or_row_index,</div>
<div class="line"><a name="l04522"></a><span class="lineno"> 4522</span>&#160;                                                           row_or_column_start,</div>
<div class="line"><a name="l04523"></a><span class="lineno"> 4523</span>&#160;                                                           <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>,</div>
<div class="line"><a name="l04524"></a><span class="lineno"> 4524</span>&#160;                                                           nnz,</div>
<div class="line"><a name="l04525"></a><span class="lineno"> 4525</span>&#160;                                                           residuals,</div>
<div class="line"><a name="l04526"></a><span class="lineno"> 4526</span>&#160;                                                           compressed_row_flag);</div>
<div class="line"><a name="l04527"></a><span class="lineno"> 4527</span>&#160; </div>
<div class="line"><a name="l04528"></a><span class="lineno"> 4528</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04529"></a><span class="lineno"> 4529</span>&#160; </div>
<div class="line"><a name="l04530"></a><span class="lineno"> 4530</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ac793c004113930938730ec04dd2245b7ad73bb55e4e1f000cfd6930cb8b2a52f8">Perform_assembly_using_lists</a>:</div>
<div class="line"><a name="l04531"></a><span class="lineno"> 4531</span>&#160; </div>
<div class="line"><a name="l04532"></a><span class="lineno"> 4532</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa90e41a626a91ee113989afa847c1117">sparse_assemble_row_or_column_compressed_with_lists</a>(</div>
<div class="line"><a name="l04533"></a><span class="lineno"> 4533</span>&#160;          column_or_row_index,</div>
<div class="line"><a name="l04534"></a><span class="lineno"> 4534</span>&#160;          row_or_column_start,</div>
<div class="line"><a name="l04535"></a><span class="lineno"> 4535</span>&#160;          <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>,</div>
<div class="line"><a name="l04536"></a><span class="lineno"> 4536</span>&#160;          nnz,</div>
<div class="line"><a name="l04537"></a><span class="lineno"> 4537</span>&#160;          residuals,</div>
<div class="line"><a name="l04538"></a><span class="lineno"> 4538</span>&#160;          compressed_row_flag);</div>
<div class="line"><a name="l04539"></a><span class="lineno"> 4539</span>&#160; </div>
<div class="line"><a name="l04540"></a><span class="lineno"> 4540</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04541"></a><span class="lineno"> 4541</span>&#160; </div>
<div class="line"><a name="l04542"></a><span class="lineno"> 4542</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ac793c004113930938730ec04dd2245b7a1383f03857ad8602ba7edef43bd947f5">Perform_assembly_using_two_arrays</a>:</div>
<div class="line"><a name="l04543"></a><span class="lineno"> 4543</span>&#160; </div>
<div class="line"><a name="l04544"></a><span class="lineno"> 4544</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a23465a0b1944a4bd31b9e0add9cc9875">sparse_assemble_row_or_column_compressed_with_two_arrays</a>(</div>
<div class="line"><a name="l04545"></a><span class="lineno"> 4545</span>&#160;          column_or_row_index,</div>
<div class="line"><a name="l04546"></a><span class="lineno"> 4546</span>&#160;          row_or_column_start,</div>
<div class="line"><a name="l04547"></a><span class="lineno"> 4547</span>&#160;          <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>,</div>
<div class="line"><a name="l04548"></a><span class="lineno"> 4548</span>&#160;          nnz,</div>
<div class="line"><a name="l04549"></a><span class="lineno"> 4549</span>&#160;          residuals,</div>
<div class="line"><a name="l04550"></a><span class="lineno"> 4550</span>&#160;          compressed_row_flag);</div>
<div class="line"><a name="l04551"></a><span class="lineno"> 4551</span>&#160; </div>
<div class="line"><a name="l04552"></a><span class="lineno"> 4552</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04553"></a><span class="lineno"> 4553</span>&#160; </div>
<div class="line"><a name="l04554"></a><span class="lineno"> 4554</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l04555"></a><span class="lineno"> 4555</span>&#160; </div>
<div class="line"><a name="l04556"></a><span class="lineno"> 4556</span>&#160;        std::ostringstream error_stream;</div>
<div class="line"><a name="l04557"></a><span class="lineno"> 4557</span>&#160;        error_stream</div>
<div class="line"><a name="l04558"></a><span class="lineno"> 4558</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;Error: Incorrect value for Problem::Sparse_assembly_method&quot;</span></div>
<div class="line"><a name="l04559"></a><span class="lineno"> 4559</span>&#160;          &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a447f9d42b248f6c394581ff1a0b02513">Sparse_assembly_method</a> &lt;&lt; std::endl</div>
<div class="line"><a name="l04560"></a><span class="lineno"> 4560</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;It should be one of the enumeration Problem::Assembly_method&quot;</span></div>
<div class="line"><a name="l04561"></a><span class="lineno"> 4561</span>&#160;          &lt;&lt; std::endl;</div>
<div class="line"><a name="l04562"></a><span class="lineno"> 4562</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l04563"></a><span class="lineno"> 4563</span>&#160;          error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l04564"></a><span class="lineno"> 4564</span>&#160;    }</div>
<div class="line"><a name="l04565"></a><span class="lineno"> 4565</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a23465a0b1944a4bd31b9e0add9cc9875"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a23465a0b1944a4bd31b9e0add9cc9875">oomph::Problem::sparse_assemble_row_or_column_compressed_with_two_arrays</a></div><div class="ttdeci">virtual void sparse_assemble_row_or_column_compressed_with_two_arrays(Vector&lt; int * &gt; &amp;column_or_row_index, Vector&lt; int * &gt; &amp;row_or_column_start, Vector&lt; double * &gt; &amp;value, Vector&lt; unsigned &gt; &amp;nnz, Vector&lt; double * &gt; &amp;residual, bool compressed_row_flag)</div><div class="ttdef"><b>Definition:</b> problem.cc:6061</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a5bc761a0dee39437b2ebeba75079856f"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a5bc761a0dee39437b2ebeba75079856f">oomph::Problem::sparse_assemble_row_or_column_compressed_with_two_vectors</a></div><div class="ttdeci">virtual void sparse_assemble_row_or_column_compressed_with_two_vectors(Vector&lt; int * &gt; &amp;column_or_row_index, Vector&lt; int * &gt; &amp;row_or_column_start, Vector&lt; double * &gt; &amp;value, Vector&lt; unsigned &gt; &amp;nnz, Vector&lt; double * &gt; &amp;residual, bool compressed_row_flag)</div><div class="ttdef"><b>Definition:</b> problem.cc:5698</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a7ba1b95df63f6e7d746a6dae641daa33"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a7ba1b95df63f6e7d746a6dae641daa33">oomph::Problem::sparse_assemble_row_or_column_compressed_with_maps</a></div><div class="ttdeci">virtual void sparse_assemble_row_or_column_compressed_with_maps(Vector&lt; int * &gt; &amp;column_or_row_index, Vector&lt; int * &gt; &amp;row_or_column_start, Vector&lt; double * &gt; &amp;value, Vector&lt; unsigned &gt; &amp;nnz, Vector&lt; double * &gt; &amp;residual, bool compressed_row_flag)</div><div class="ttdef"><b>Definition:</b> problem.cc:4584</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a7eb5e0e3dc02fa26eec9d023b80b9603"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a7eb5e0e3dc02fa26eec9d023b80b9603">oomph::Problem::sparse_assemble_row_or_column_compressed_with_vectors_of_pairs</a></div><div class="ttdeci">virtual void sparse_assemble_row_or_column_compressed_with_vectors_of_pairs(Vector&lt; int * &gt; &amp;column_or_row_index, Vector&lt; int * &gt; &amp;row_or_column_start, Vector&lt; double * &gt; &amp;value, Vector&lt; unsigned &gt; &amp;nnz, Vector&lt; double * &gt; &amp;residual, bool compressed_row_flag)</div><div class="ttdef"><b>Definition:</b> problem.cc:5345</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_aa90e41a626a91ee113989afa847c1117"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#aa90e41a626a91ee113989afa847c1117">oomph::Problem::sparse_assemble_row_or_column_compressed_with_lists</a></div><div class="ttdeci">virtual void sparse_assemble_row_or_column_compressed_with_lists(Vector&lt; int * &gt; &amp;column_or_row_index, Vector&lt; int * &gt; &amp;row_or_column_start, Vector&lt; double * &gt; &amp;value, Vector&lt; unsigned &gt; &amp;nnz, Vector&lt; double * &gt; &amp;residual, bool compressed_row_flag)</div><div class="ttdef"><b>Definition:</b> problem.cc:4930</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac793c004113930938730ec04dd2245b7ad73bb55e4e1f000cfd6930cb8b2a52f8">Perform_assembly_using_lists</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac793c004113930938730ec04dd2245b7a406ad24599e1a59450acdd09bac1d717">Perform_assembly_using_maps</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac793c004113930938730ec04dd2245b7a1383f03857ad8602ba7edef43bd947f5">Perform_assembly_using_two_arrays</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac793c004113930938730ec04dd2245b7a6008d2b6aa449ee405313b49632d18ff">Perform_assembly_using_two_vectors</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac793c004113930938730ec04dd2245b7aa00e1772bb5ccf1c837a2bad2f240241">Perform_assembly_using_vectors_of_pairs</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa90e41a626a91ee113989afa847c1117">sparse_assemble_row_or_column_compressed_with_lists()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7ba1b95df63f6e7d746a6dae641daa33">sparse_assemble_row_or_column_compressed_with_maps()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a23465a0b1944a4bd31b9e0add9cc9875">sparse_assemble_row_or_column_compressed_with_two_arrays()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5bc761a0dee39437b2ebeba75079856f">sparse_assemble_row_or_column_compressed_with_two_vectors()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7eb5e0e3dc02fa26eec9d023b80b9603">sparse_assemble_row_or_column_compressed_with_vectors_of_pairs()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a447f9d42b248f6c394581ff1a0b02513">Sparse_assembly_method</a>, and <a class="el" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">Eigen::value</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a4e59f1c854d1258aa2b4eca218405731">get_eigenproblem_matrices()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aab9533075d11b251636fa1c3a544dba7">get_jacobian()</a>.</p>

</div>
</div>
<a id="aa90e41a626a91ee113989afa847c1117"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa90e41a626a91ee113989afa847c1117">&#9670;&nbsp;</a></span>sparse_assemble_row_or_column_compressed_with_lists()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::sparse_assemble_row_or_column_compressed_with_lists </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>column_or_row_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>row_or_column_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>nnz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>residuals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>compressed_row_flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Private helper function that is used to assemble the Jacobian matrix in the case when the storage is row or column compressed. The boolean Flag indicates if we want compressed row format (true) or compressed column. This version uses lists</p>
<p>This is a (private) helper function that is used to assemble system matrices in compressed row or column format and compute residual vectors using lists The default action is to assemble the jacobian matrix and residuals for the Newton method. The action can be overloaded at an elemental level by chaging the default behaviour of the function Element::get_all_vectors_and_matrices(). column_or_row_index: Column [or row] index of given entry row_or_column_start: Index of first entry for given row [or column] value : Vector of nonzero entries residuals : Residual vector compressed_row_flag: Bool flag to indicate if storage format is compressed row [if false interpretation of arguments is as stated in square brackets]. </p>
<div class="fragment"><div class="line"><a name="l04937"></a><span class="lineno"> 4937</span>&#160;  {</div>
<div class="line"><a name="l04938"></a><span class="lineno"> 4938</span>&#160;    <span class="comment">// Total number of elements</span></div>
<div class="line"><a name="l04939"></a><span class="lineno"> 4939</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n_elements = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>()-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">nelement</a>();</div>
<div class="line"><a name="l04940"></a><span class="lineno"> 4940</span>&#160; </div>
<div class="line"><a name="l04941"></a><span class="lineno"> 4941</span>&#160;    <span class="comment">// Default range of elements for distributed problems</span></div>
<div class="line"><a name="l04942"></a><span class="lineno"> 4942</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> el_lo = 0;</div>
<div class="line"><a name="l04943"></a><span class="lineno"> 4943</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> el_hi = n_elements - 1;</div>
<div class="line"><a name="l04944"></a><span class="lineno"> 4944</span>&#160; </div>
<div class="line"><a name="l04945"></a><span class="lineno"> 4945</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l04946"></a><span class="lineno"> 4946</span>&#160;    <span class="comment">// Otherwise just loop over a fraction of the elements</span></div>
<div class="line"><a name="l04947"></a><span class="lineno"> 4947</span>&#160;    <span class="comment">// (This will either have been initialised in</span></div>
<div class="line"><a name="l04948"></a><span class="lineno"> 4948</span>&#160;    <span class="comment">// Problem::set_default_first_and_last_element_for_assembly() or</span></div>
<div class="line"><a name="l04949"></a><span class="lineno"> 4949</span>&#160;    <span class="comment">// will have been re-assigned during a previous assembly loop</span></div>
<div class="line"><a name="l04950"></a><span class="lineno"> 4950</span>&#160;    <span class="comment">// Note that following the re-assignment only the entries</span></div>
<div class="line"><a name="l04951"></a><span class="lineno"> 4951</span>&#160;    <span class="comment">// for the current processor are relevant.</span></div>
<div class="line"><a name="l04952"></a><span class="lineno"> 4952</span>&#160;    <span class="keywordflow">if</span> (!Problem_has_been_distributed)</div>
<div class="line"><a name="l04953"></a><span class="lineno"> 4953</span>&#160;    {</div>
<div class="line"><a name="l04954"></a><span class="lineno"> 4954</span>&#160;      el_lo = First_el_for_assembly[<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>-&gt;<a class="code" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a670b34aab05bfe0b96d0e0fabf583c7a">my_rank</a>()];</div>
<div class="line"><a name="l04955"></a><span class="lineno"> 4955</span>&#160;      el_hi = Last_el_plus_one_for_assembly[<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>-&gt;<a class="code" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a670b34aab05bfe0b96d0e0fabf583c7a">my_rank</a>()] - 1;</div>
<div class="line"><a name="l04956"></a><span class="lineno"> 4956</span>&#160;    }</div>
<div class="line"><a name="l04957"></a><span class="lineno"> 4957</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04958"></a><span class="lineno"> 4958</span>&#160; </div>
<div class="line"><a name="l04959"></a><span class="lineno"> 4959</span>&#160;    <span class="comment">// number of dofs</span></div>
<div class="line"><a name="l04960"></a><span class="lineno"> 4960</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a> = this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>();</div>
<div class="line"><a name="l04961"></a><span class="lineno"> 4961</span>&#160; </div>
<div class="line"><a name="l04962"></a><span class="lineno"> 4962</span>&#160;    <span class="comment">// Find the number of vectors to be assembled</span></div>
<div class="line"><a name="l04963"></a><span class="lineno"> 4963</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_vector = residuals.size();</div>
<div class="line"><a name="l04964"></a><span class="lineno"> 4964</span>&#160; </div>
<div class="line"><a name="l04965"></a><span class="lineno"> 4965</span>&#160;    <span class="comment">// Find the number of matrices to be assembled</span></div>
<div class="line"><a name="l04966"></a><span class="lineno"> 4966</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_matrix = column_or_row_index.size();</div>
<div class="line"><a name="l04967"></a><span class="lineno"> 4967</span>&#160; </div>
<div class="line"><a name="l04968"></a><span class="lineno"> 4968</span>&#160;    <span class="comment">// Locally cache pointer to assembly handler</span></div>
<div class="line"><a name="l04969"></a><span class="lineno"> 4969</span>&#160;    AssemblyHandler* <span class="keyword">const</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a> = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>;</div>
<div class="line"><a name="l04970"></a><span class="lineno"> 4970</span>&#160; </div>
<div class="line"><a name="l04971"></a><span class="lineno"> 4971</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l04972"></a><span class="lineno"> 4972</span>&#160;    <span class="keywordtype">bool</span> doing_residuals = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04973"></a><span class="lineno"> 4973</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">dynamic_cast&lt;</span>ParallelResidualsHandler*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>) != 0)</div>
<div class="line"><a name="l04974"></a><span class="lineno"> 4974</span>&#160;    {</div>
<div class="line"><a name="l04975"></a><span class="lineno"> 4975</span>&#160;      doing_residuals = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04976"></a><span class="lineno"> 4976</span>&#160;    }</div>
<div class="line"><a name="l04977"></a><span class="lineno"> 4977</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04978"></a><span class="lineno"> 4978</span>&#160; </div>
<div class="line"><a name="l04979"></a><span class="lineno"> 4979</span>&#160;<span class="comment">// Error check dimensions</span></div>
<div class="line"><a name="l04980"></a><span class="lineno"> 4980</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l04981"></a><span class="lineno"> 4981</span>&#160;    <span class="keywordflow">if</span> (row_or_column_start.size() != n_matrix)</div>
<div class="line"><a name="l04982"></a><span class="lineno"> 4982</span>&#160;    {</div>
<div class="line"><a name="l04983"></a><span class="lineno"> 4983</span>&#160;      std::ostringstream error_stream;</div>
<div class="line"><a name="l04984"></a><span class="lineno"> 4984</span>&#160;      error_stream &lt;&lt; <span class="stringliteral">&quot;Error: &quot;</span> &lt;&lt; std::endl</div>
<div class="line"><a name="l04985"></a><span class="lineno"> 4985</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;row_or_column_start.size() &quot;</span></div>
<div class="line"><a name="l04986"></a><span class="lineno"> 4986</span>&#160;                   &lt;&lt; row_or_column_start.size() &lt;&lt; <span class="stringliteral">&quot; does not equal &quot;</span></div>
<div class="line"><a name="l04987"></a><span class="lineno"> 4987</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;column_or_row_index.size() &quot;</span></div>
<div class="line"><a name="l04988"></a><span class="lineno"> 4988</span>&#160;                   &lt;&lt; column_or_row_index.size() &lt;&lt; std::endl;</div>
<div class="line"><a name="l04989"></a><span class="lineno"> 4989</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l04990"></a><span class="lineno"> 4990</span>&#160;        error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l04991"></a><span class="lineno"> 4991</span>&#160;    }</div>
<div class="line"><a name="l04992"></a><span class="lineno"> 4992</span>&#160; </div>
<div class="line"><a name="l04993"></a><span class="lineno"> 4993</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>.size() != n_matrix)</div>
<div class="line"><a name="l04994"></a><span class="lineno"> 4994</span>&#160;    {</div>
<div class="line"><a name="l04995"></a><span class="lineno"> 4995</span>&#160;      std::ostringstream error_stream;</div>
<div class="line"><a name="l04996"></a><span class="lineno"> 4996</span>&#160;      error_stream</div>
<div class="line"><a name="l04997"></a><span class="lineno"> 4997</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;Error in Problem::sparse_assemble_row_or_column_compressed &quot;</span></div>
<div class="line"><a name="l04998"></a><span class="lineno"> 4998</span>&#160;        &lt;&lt; std::endl</div>
<div class="line"><a name="l04999"></a><span class="lineno"> 4999</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;value.size() &quot;</span> &lt;&lt; <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>.size() &lt;&lt; <span class="stringliteral">&quot; does not equal &quot;</span></div>
<div class="line"><a name="l05000"></a><span class="lineno"> 5000</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;column_or_row_index.size() &quot;</span> &lt;&lt; column_or_row_index.size()</div>
<div class="line"><a name="l05001"></a><span class="lineno"> 5001</span>&#160;        &lt;&lt; std::endl</div>
<div class="line"><a name="l05002"></a><span class="lineno"> 5002</span>&#160;        &lt;&lt; std::endl</div>
<div class="line"><a name="l05003"></a><span class="lineno"> 5003</span>&#160;        &lt;&lt; std::endl;</div>
<div class="line"><a name="l05004"></a><span class="lineno"> 5004</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l05005"></a><span class="lineno"> 5005</span>&#160;        error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l05006"></a><span class="lineno"> 5006</span>&#160;    }</div>
<div class="line"><a name="l05007"></a><span class="lineno"> 5007</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l05008"></a><span class="lineno"> 5008</span>&#160; </div>
<div class="line"><a name="l05009"></a><span class="lineno"> 5009</span>&#160;    <span class="comment">// The idea behind this sparse assembly routine is to use a vector of</span></div>
<div class="line"><a name="l05010"></a><span class="lineno"> 5010</span>&#160;    <span class="comment">// lists for the entries in each row or column of the complete matrix.</span></div>
<div class="line"><a name="l05011"></a><span class="lineno"> 5011</span>&#160;    <span class="comment">// The lists contain pairs of entries (global row/column number, value).</span></div>
<div class="line"><a name="l05012"></a><span class="lineno"> 5012</span>&#160;    <span class="comment">// All non-zero contributions from each element are added to the lists.</span></div>
<div class="line"><a name="l05013"></a><span class="lineno"> 5013</span>&#160;    <span class="comment">// We then sort each list by global row/column number and then combine</span></div>
<div class="line"><a name="l05014"></a><span class="lineno"> 5014</span>&#160;    <span class="comment">// the entries corresponding to each row/column before adding to the</span></div>
<div class="line"><a name="l05015"></a><span class="lineno"> 5015</span>&#160;    <span class="comment">// vectors column_or_row_index and value.</span></div>
<div class="line"><a name="l05016"></a><span class="lineno"> 5016</span>&#160; </div>
<div class="line"><a name="l05017"></a><span class="lineno"> 5017</span>&#160;    <span class="comment">// Note the trade off for &quot;fast assembly&quot; is that we will require</span></div>
<div class="line"><a name="l05018"></a><span class="lineno"> 5018</span>&#160;    <span class="comment">// more memory during the assembly phase. Then again, if we can</span></div>
<div class="line"><a name="l05019"></a><span class="lineno"> 5019</span>&#160;    <span class="comment">// only just assemble the sparse matrix, we&#39;re in real trouble.</span></div>
<div class="line"><a name="l05020"></a><span class="lineno"> 5020</span>&#160; </div>
<div class="line"><a name="l05021"></a><span class="lineno"> 5021</span>&#160;    <span class="comment">// Set up a vector of lists of paired entries of</span></div>
<div class="line"><a name="l05022"></a><span class="lineno"> 5022</span>&#160;    <span class="comment">//(row/column index, jacobian matrix entry).</span></div>
<div class="line"><a name="l05023"></a><span class="lineno"> 5023</span>&#160;    <span class="comment">// The entries of the vector correspond to all the rows or columns.</span></div>
<div class="line"><a name="l05024"></a><span class="lineno"> 5024</span>&#160;    <span class="comment">// The use of the list storage scheme, should give fast insertion</span></div>
<div class="line"><a name="l05025"></a><span class="lineno"> 5025</span>&#160;    <span class="comment">// and fast sorts later.</span></div>
<div class="line"><a name="l05026"></a><span class="lineno"> 5026</span>&#160;    Vector&lt;Vector&lt;std::list&lt;std::pair&lt;unsigned, double&gt;&gt;&gt;&gt; matrix_data_list(</div>
<div class="line"><a name="l05027"></a><span class="lineno"> 5027</span>&#160;      n_matrix);</div>
<div class="line"><a name="l05028"></a><span class="lineno"> 5028</span>&#160;    <span class="comment">// Loop over the number of matrices and resize</span></div>
<div class="line"><a name="l05029"></a><span class="lineno"> 5029</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> = 0; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> &lt; n_matrix; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>++)</div>
<div class="line"><a name="l05030"></a><span class="lineno"> 5030</span>&#160;    {</div>
<div class="line"><a name="l05031"></a><span class="lineno"> 5031</span>&#160;      matrix_data_list[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>].resize(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>);</div>
<div class="line"><a name="l05032"></a><span class="lineno"> 5032</span>&#160;    }</div>
<div class="line"><a name="l05033"></a><span class="lineno"> 5033</span>&#160; </div>
<div class="line"><a name="l05034"></a><span class="lineno"> 5034</span>&#160;    <span class="comment">// Resize the residuals vectors</span></div>
<div class="line"><a name="l05035"></a><span class="lineno"> 5035</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a> = 0; <a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a> &lt; n_vector; <a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a>++)</div>
<div class="line"><a name="l05036"></a><span class="lineno"> 5036</span>&#160;    {</div>
<div class="line"><a name="l05037"></a><span class="lineno"> 5037</span>&#160;      residuals[<a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a>] = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>];</div>
<div class="line"><a name="l05038"></a><span class="lineno"> 5038</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l05039"></a><span class="lineno"> 5039</span>&#160;      {</div>
<div class="line"><a name="l05040"></a><span class="lineno"> 5040</span>&#160;        residuals[<a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a>][<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = 0;</div>
<div class="line"><a name="l05041"></a><span class="lineno"> 5041</span>&#160;      }</div>
<div class="line"><a name="l05042"></a><span class="lineno"> 5042</span>&#160;    }</div>
<div class="line"><a name="l05043"></a><span class="lineno"> 5043</span>&#160; </div>
<div class="line"><a name="l05044"></a><span class="lineno"> 5044</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l05045"></a><span class="lineno"> 5045</span>&#160; </div>
<div class="line"><a name="l05046"></a><span class="lineno"> 5046</span>&#160; </div>
<div class="line"><a name="l05047"></a><span class="lineno"> 5047</span>&#160;    <span class="comment">// Storage for assembly time for elements</span></div>
<div class="line"><a name="l05048"></a><span class="lineno"> 5048</span>&#160;    <span class="keywordtype">double</span> t_assemble_start = 0.0;</div>
<div class="line"><a name="l05049"></a><span class="lineno"> 5049</span>&#160; </div>
<div class="line"><a name="l05050"></a><span class="lineno"> 5050</span>&#160;    <span class="comment">// Storage for assembly times</span></div>
<div class="line"><a name="l05051"></a><span class="lineno"> 5051</span>&#160;    <span class="keywordflow">if</span> ((!doing_residuals) &amp;&amp; Must_recompute_load_balance_for_assembly)</div>
<div class="line"><a name="l05052"></a><span class="lineno"> 5052</span>&#160;    {</div>
<div class="line"><a name="l05053"></a><span class="lineno"> 5053</span>&#160;      Elemental_assembly_time.resize(n_elements);</div>
<div class="line"><a name="l05054"></a><span class="lineno"> 5054</span>&#160;    }</div>
<div class="line"><a name="l05055"></a><span class="lineno"> 5055</span>&#160; </div>
<div class="line"><a name="l05056"></a><span class="lineno"> 5056</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l05057"></a><span class="lineno"> 5057</span>&#160; </div>
<div class="line"><a name="l05058"></a><span class="lineno"> 5058</span>&#160;    <span class="comment">//------------Assemble and populate the lists-----------------------</span></div>
<div class="line"><a name="l05059"></a><span class="lineno"> 5059</span>&#160;    {</div>
<div class="line"><a name="l05060"></a><span class="lineno"> 5060</span>&#160;      <span class="comment">// Allocate local storage for the element&#39;s contribution to the</span></div>
<div class="line"><a name="l05061"></a><span class="lineno"> 5061</span>&#160;      <span class="comment">// residuals vectors and system matrices of the size of the maximum</span></div>
<div class="line"><a name="l05062"></a><span class="lineno"> 5062</span>&#160;      <span class="comment">// number of dofs in any element.</span></div>
<div class="line"><a name="l05063"></a><span class="lineno"> 5063</span>&#160;      <span class="comment">// This means that the stored is only allocated (and deleted) once</span></div>
<div class="line"><a name="l05064"></a><span class="lineno"> 5064</span>&#160;      Vector&lt;Vector&lt;double&gt;&gt; el_residuals(n_vector);</div>
<div class="line"><a name="l05065"></a><span class="lineno"> 5065</span>&#160;      Vector&lt;DenseMatrix&lt;double&gt;&gt; el_jacobian(n_matrix);</div>
<div class="line"><a name="l05066"></a><span class="lineno"> 5066</span>&#160; </div>
<div class="line"><a name="l05067"></a><span class="lineno"> 5067</span>&#160; </div>
<div class="line"><a name="l05068"></a><span class="lineno"> 5068</span>&#160;      <span class="comment">// Pointer to a single list to be used during the assembly</span></div>
<div class="line"><a name="l05069"></a><span class="lineno"> 5069</span>&#160;      std::list&lt;std::pair&lt;unsigned, double&gt;&gt;* list_pt;</div>
<div class="line"><a name="l05070"></a><span class="lineno"> 5070</span>&#160; </div>
<div class="line"><a name="l05071"></a><span class="lineno"> 5071</span>&#160;      <span class="comment">// Loop over the all elements</span></div>
<div class="line"><a name="l05072"></a><span class="lineno"> 5072</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = el_lo; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt;= el_hi; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l05073"></a><span class="lineno"> 5073</span>&#160;      {</div>
<div class="line"><a name="l05074"></a><span class="lineno"> 5074</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l05075"></a><span class="lineno"> 5075</span>&#160;        <span class="comment">// Time it?</span></div>
<div class="line"><a name="l05076"></a><span class="lineno"> 5076</span>&#160;        <span class="keywordflow">if</span> ((!doing_residuals) &amp;&amp; Must_recompute_load_balance_for_assembly)</div>
<div class="line"><a name="l05077"></a><span class="lineno"> 5077</span>&#160;        {</div>
<div class="line"><a name="l05078"></a><span class="lineno"> 5078</span>&#160;          t_assemble_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l05079"></a><span class="lineno"> 5079</span>&#160;        }</div>
<div class="line"><a name="l05080"></a><span class="lineno"> 5080</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l05081"></a><span class="lineno"> 5081</span>&#160; </div>
<div class="line"><a name="l05082"></a><span class="lineno"> 5082</span>&#160;        <span class="comment">// Get the pointer to the element</span></div>
<div class="line"><a name="l05083"></a><span class="lineno"> 5083</span>&#160;        GeneralisedElement* elem_pt = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>()-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">element_pt</a>(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>);</div>
<div class="line"><a name="l05084"></a><span class="lineno"> 5084</span>&#160; </div>
<div class="line"><a name="l05085"></a><span class="lineno"> 5085</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l05086"></a><span class="lineno"> 5086</span>&#160;        <span class="comment">// Ignore halo elements</span></div>
<div class="line"><a name="l05087"></a><span class="lineno"> 5087</span>&#160;        <span class="keywordflow">if</span> (!elem_pt-&gt;is_halo())</div>
<div class="line"><a name="l05088"></a><span class="lineno"> 5088</span>&#160;        {</div>
<div class="line"><a name="l05089"></a><span class="lineno"> 5089</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l05090"></a><span class="lineno"> 5090</span>&#160; </div>
<div class="line"><a name="l05091"></a><span class="lineno"> 5091</span>&#160;          <span class="comment">// Find number of degrees of freedom in the element</span></div>
<div class="line"><a name="l05092"></a><span class="lineno"> 5092</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> nvar = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>-&gt;<a class="code" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a09213be8f4aa009e0366460a7ed78e68">ndof</a>(elem_pt);</div>
<div class="line"><a name="l05093"></a><span class="lineno"> 5093</span>&#160; </div>
<div class="line"><a name="l05094"></a><span class="lineno"> 5094</span>&#160;          <span class="comment">// Resize the storage for the elemental jacobian and residuals</span></div>
<div class="line"><a name="l05095"></a><span class="lineno"> 5095</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a> = 0; <a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a> &lt; n_vector; <a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a>++)</div>
<div class="line"><a name="l05096"></a><span class="lineno"> 5096</span>&#160;          {</div>
<div class="line"><a name="l05097"></a><span class="lineno"> 5097</span>&#160;            el_residuals[<a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a>].resize(nvar);</div>
<div class="line"><a name="l05098"></a><span class="lineno"> 5098</span>&#160;          }</div>
<div class="line"><a name="l05099"></a><span class="lineno"> 5099</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> = 0; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> &lt; n_matrix; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>++)</div>
<div class="line"><a name="l05100"></a><span class="lineno"> 5100</span>&#160;          {</div>
<div class="line"><a name="l05101"></a><span class="lineno"> 5101</span>&#160;            el_jacobian[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>].resize(nvar);</div>
<div class="line"><a name="l05102"></a><span class="lineno"> 5102</span>&#160;          }</div>
<div class="line"><a name="l05103"></a><span class="lineno"> 5103</span>&#160; </div>
<div class="line"><a name="l05104"></a><span class="lineno"> 5104</span>&#160;          <span class="comment">// Now get the residuals and jacobian for the element</span></div>
<div class="line"><a name="l05105"></a><span class="lineno"> 5105</span>&#160;          <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>-&gt;<a class="code" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a67093ef481c51d384606486c41002baa">get_all_vectors_and_matrices</a>(</div>
<div class="line"><a name="l05106"></a><span class="lineno"> 5106</span>&#160;            elem_pt, el_residuals, el_jacobian);</div>
<div class="line"><a name="l05107"></a><span class="lineno"> 5107</span>&#160; </div>
<div class="line"><a name="l05108"></a><span class="lineno"> 5108</span>&#160;          <span class="comment">//---------------- Insert the values into the lists -----------</span></div>
<div class="line"><a name="l05109"></a><span class="lineno"> 5109</span>&#160; </div>
<div class="line"><a name="l05110"></a><span class="lineno"> 5110</span>&#160;          <span class="comment">// Loop over the first index of local variables</span></div>
<div class="line"><a name="l05111"></a><span class="lineno"> 5111</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; nvar; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l05112"></a><span class="lineno"> 5112</span>&#160;          {</div>
<div class="line"><a name="l05113"></a><span class="lineno"> 5113</span>&#160;            <span class="comment">// Get the local equation number</span></div>
<div class="line"><a name="l05114"></a><span class="lineno"> 5114</span>&#160;            <span class="keywordtype">unsigned</span> eqn_number = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>-&gt;<a class="code" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a94d28e2de2559cde803d1ba2195b5290">eqn_number</a>(elem_pt, <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l05115"></a><span class="lineno"> 5115</span>&#160; </div>
<div class="line"><a name="l05116"></a><span class="lineno"> 5116</span>&#160;            <span class="comment">// Add the contribution to the residuals</span></div>
<div class="line"><a name="l05117"></a><span class="lineno"> 5117</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a> = 0; <a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a> &lt; n_vector; <a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a>++)</div>
<div class="line"><a name="l05118"></a><span class="lineno"> 5118</span>&#160;            {</div>
<div class="line"><a name="l05119"></a><span class="lineno"> 5119</span>&#160;              <span class="comment">// Fill in the residuals vector</span></div>
<div class="line"><a name="l05120"></a><span class="lineno"> 5120</span>&#160;              residuals[<a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a>][eqn_number] += el_residuals[<a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a>][<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l05121"></a><span class="lineno"> 5121</span>&#160;            }</div>
<div class="line"><a name="l05122"></a><span class="lineno"> 5122</span>&#160; </div>
<div class="line"><a name="l05123"></a><span class="lineno"> 5123</span>&#160;            <span class="comment">// Now loop over the other index</span></div>
<div class="line"><a name="l05124"></a><span class="lineno"> 5124</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; nvar; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l05125"></a><span class="lineno"> 5125</span>&#160;            {</div>
<div class="line"><a name="l05126"></a><span class="lineno"> 5126</span>&#160;              <span class="comment">// Get the number of the unknown</span></div>
<div class="line"><a name="l05127"></a><span class="lineno"> 5127</span>&#160;              <span class="keywordtype">unsigned</span> unknown = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>-&gt;<a class="code" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a94d28e2de2559cde803d1ba2195b5290">eqn_number</a>(elem_pt, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l05128"></a><span class="lineno"> 5128</span>&#160; </div>
<div class="line"><a name="l05129"></a><span class="lineno"> 5129</span>&#160;              <span class="comment">// Loop over the matrices</span></div>
<div class="line"><a name="l05130"></a><span class="lineno"> 5130</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> = 0; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> &lt; n_matrix; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>++)</div>
<div class="line"><a name="l05131"></a><span class="lineno"> 5131</span>&#160;              {</div>
<div class="line"><a name="l05132"></a><span class="lineno"> 5132</span>&#160;                <span class="comment">// Get the value of the matrix at this point</span></div>
<div class="line"><a name="l05133"></a><span class="lineno"> 5133</span>&#160;                <span class="keywordtype">double</span> <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a> = el_jacobian[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>](<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l05134"></a><span class="lineno"> 5134</span>&#160;                <span class="comment">// Only add to theif it&#39;s non-zero</span></div>
<div class="line"><a name="l05135"></a><span class="lineno"> 5135</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">std::fabs</a>(<a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>) &gt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad1a1ffc2bd685377ce7213452876b127">Numerical_zero_for_sparse_assembly</a>)</div>
<div class="line"><a name="l05136"></a><span class="lineno"> 5136</span>&#160;                {</div>
<div class="line"><a name="l05137"></a><span class="lineno"> 5137</span>&#160;                  <span class="comment">// If it&#39;s compressed row storage, then our vector is indexed</span></div>
<div class="line"><a name="l05138"></a><span class="lineno"> 5138</span>&#160;                  <span class="comment">// by row (the equation number)</span></div>
<div class="line"><a name="l05139"></a><span class="lineno"> 5139</span>&#160;                  <span class="keywordflow">if</span> (compressed_row_flag)</div>
<div class="line"><a name="l05140"></a><span class="lineno"> 5140</span>&#160;                  {</div>
<div class="line"><a name="l05141"></a><span class="lineno"> 5141</span>&#160;                    <span class="comment">// Find the list that corresponds to the desired row</span></div>
<div class="line"><a name="l05142"></a><span class="lineno"> 5142</span>&#160;                    list_pt = &amp;matrix_data_list[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][eqn_number];</div>
<div class="line"><a name="l05143"></a><span class="lineno"> 5143</span>&#160;                    <span class="comment">// Insert the data into the list, the first entry</span></div>
<div class="line"><a name="l05144"></a><span class="lineno"> 5144</span>&#160;                    <span class="comment">// in the pair is the unknown (column index),</span></div>
<div class="line"><a name="l05145"></a><span class="lineno"> 5145</span>&#160;                    <span class="comment">// the second is the value itself.</span></div>
<div class="line"><a name="l05146"></a><span class="lineno"> 5146</span>&#160;                    list_pt-&gt;insert(list_pt-&gt;end(),</div>
<div class="line"><a name="l05147"></a><span class="lineno"> 5147</span>&#160;                                    std::make_pair(unknown, <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>));</div>
<div class="line"><a name="l05148"></a><span class="lineno"> 5148</span>&#160;                  }</div>
<div class="line"><a name="l05149"></a><span class="lineno"> 5149</span>&#160;                  <span class="comment">// Otherwise it&#39;s compressed column storage, and our</span></div>
<div class="line"><a name="l05150"></a><span class="lineno"> 5150</span>&#160;                  <span class="comment">// vector is indexed by column (the unknown)</span></div>
<div class="line"><a name="l05151"></a><span class="lineno"> 5151</span>&#160;                  <span class="keywordflow">else</span></div>
<div class="line"><a name="l05152"></a><span class="lineno"> 5152</span>&#160;                  {</div>
<div class="line"><a name="l05153"></a><span class="lineno"> 5153</span>&#160;                    <span class="comment">// Find the list that corresponds to the desired column</span></div>
<div class="line"><a name="l05154"></a><span class="lineno"> 5154</span>&#160;                    list_pt = &amp;matrix_data_list[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][unknown];</div>
<div class="line"><a name="l05155"></a><span class="lineno"> 5155</span>&#160;                    <span class="comment">// Insert the data into the list, the first entry</span></div>
<div class="line"><a name="l05156"></a><span class="lineno"> 5156</span>&#160;                    <span class="comment">// in the pair is the equation number (row index),</span></div>
<div class="line"><a name="l05157"></a><span class="lineno"> 5157</span>&#160;                    <span class="comment">// the second is the value itself.</span></div>
<div class="line"><a name="l05158"></a><span class="lineno"> 5158</span>&#160;                    list_pt-&gt;insert(list_pt-&gt;end(),</div>
<div class="line"><a name="l05159"></a><span class="lineno"> 5159</span>&#160;                                    std::make_pair(eqn_number, <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>));</div>
<div class="line"><a name="l05160"></a><span class="lineno"> 5160</span>&#160;                  }</div>
<div class="line"><a name="l05161"></a><span class="lineno"> 5161</span>&#160;                }</div>
<div class="line"><a name="l05162"></a><span class="lineno"> 5162</span>&#160;              }</div>
<div class="line"><a name="l05163"></a><span class="lineno"> 5163</span>&#160;            }</div>
<div class="line"><a name="l05164"></a><span class="lineno"> 5164</span>&#160;          }</div>
<div class="line"><a name="l05165"></a><span class="lineno"> 5165</span>&#160; </div>
<div class="line"><a name="l05166"></a><span class="lineno"> 5166</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l05167"></a><span class="lineno"> 5167</span>&#160;        } <span class="comment">// endif halo element</span></div>
<div class="line"><a name="l05168"></a><span class="lineno"> 5168</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l05169"></a><span class="lineno"> 5169</span>&#160; </div>
<div class="line"><a name="l05170"></a><span class="lineno"> 5170</span>&#160; </div>
<div class="line"><a name="l05171"></a><span class="lineno"> 5171</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l05172"></a><span class="lineno"> 5172</span>&#160;        <span class="comment">// Time it?</span></div>
<div class="line"><a name="l05173"></a><span class="lineno"> 5173</span>&#160;        <span class="keywordflow">if</span> ((!doing_residuals) &amp;&amp; Must_recompute_load_balance_for_assembly)</div>
<div class="line"><a name="l05174"></a><span class="lineno"> 5174</span>&#160;        {</div>
<div class="line"><a name="l05175"></a><span class="lineno"> 5175</span>&#160;          Elemental_assembly_time[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>] =</div>
<div class="line"><a name="l05176"></a><span class="lineno"> 5176</span>&#160;            <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>() - t_assemble_start;</div>
<div class="line"><a name="l05177"></a><span class="lineno"> 5177</span>&#160;        }</div>
<div class="line"><a name="l05178"></a><span class="lineno"> 5178</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l05179"></a><span class="lineno"> 5179</span>&#160; </div>
<div class="line"><a name="l05180"></a><span class="lineno"> 5180</span>&#160;      } <span class="comment">// End of loop over the elements</span></div>
<div class="line"><a name="l05181"></a><span class="lineno"> 5181</span>&#160; </div>
<div class="line"><a name="l05182"></a><span class="lineno"> 5182</span>&#160;    } <span class="comment">// list_pt goes out of scope</span></div>
<div class="line"><a name="l05183"></a><span class="lineno"> 5183</span>&#160; </div>
<div class="line"><a name="l05184"></a><span class="lineno"> 5184</span>&#160; </div>
<div class="line"><a name="l05185"></a><span class="lineno"> 5185</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l05186"></a><span class="lineno"> 5186</span>&#160; </div>
<div class="line"><a name="l05187"></a><span class="lineno"> 5187</span>&#160;    <span class="comment">// Postprocess timing information and re-allocate distribution of</span></div>
<div class="line"><a name="l05188"></a><span class="lineno"> 5188</span>&#160;    <span class="comment">// elements during subsequent assemblies.</span></div>
<div class="line"><a name="l05189"></a><span class="lineno"> 5189</span>&#160;    <span class="keywordflow">if</span> ((!doing_residuals) &amp;&amp; (!Problem_has_been_distributed) &amp;&amp;</div>
<div class="line"><a name="l05190"></a><span class="lineno"> 5190</span>&#160;        Must_recompute_load_balance_for_assembly)</div>
<div class="line"><a name="l05191"></a><span class="lineno"> 5191</span>&#160;    {</div>
<div class="line"><a name="l05192"></a><span class="lineno"> 5192</span>&#160;      recompute_load_balanced_assembly();</div>
<div class="line"><a name="l05193"></a><span class="lineno"> 5193</span>&#160;    }</div>
<div class="line"><a name="l05194"></a><span class="lineno"> 5194</span>&#160; </div>
<div class="line"><a name="l05195"></a><span class="lineno"> 5195</span>&#160;    <span class="comment">// We have determined load balancing for current setup.</span></div>
<div class="line"><a name="l05196"></a><span class="lineno"> 5196</span>&#160;    <span class="comment">// This can remain the same until assign_eqn_numbers() is called</span></div>
<div class="line"><a name="l05197"></a><span class="lineno"> 5197</span>&#160;    <span class="comment">// again -- the flag is re-set to true there.</span></div>
<div class="line"><a name="l05198"></a><span class="lineno"> 5198</span>&#160;    <span class="keywordflow">if</span> ((!doing_residuals) &amp;&amp; Must_recompute_load_balance_for_assembly)</div>
<div class="line"><a name="l05199"></a><span class="lineno"> 5199</span>&#160;    {</div>
<div class="line"><a name="l05200"></a><span class="lineno"> 5200</span>&#160;      Must_recompute_load_balance_for_assembly = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05201"></a><span class="lineno"> 5201</span>&#160;    }</div>
<div class="line"><a name="l05202"></a><span class="lineno"> 5202</span>&#160; </div>
<div class="line"><a name="l05203"></a><span class="lineno"> 5203</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l05204"></a><span class="lineno"> 5204</span>&#160; </div>
<div class="line"><a name="l05205"></a><span class="lineno"> 5205</span>&#160; </div>
<div class="line"><a name="l05206"></a><span class="lineno"> 5206</span>&#160;    <span class="comment">//----Finally we need to convert the beautiful list storage scheme---</span></div>
<div class="line"><a name="l05207"></a><span class="lineno"> 5207</span>&#160;    <span class="comment">//----------to the containers required by SuperLU--------------------</span></div>
<div class="line"><a name="l05208"></a><span class="lineno"> 5208</span>&#160; </div>
<div class="line"><a name="l05209"></a><span class="lineno"> 5209</span>&#160;    <span class="comment">// Loop over the number of matrices</span></div>
<div class="line"><a name="l05210"></a><span class="lineno"> 5210</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> = 0; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> &lt; n_matrix; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>++)</div>
<div class="line"><a name="l05211"></a><span class="lineno"> 5211</span>&#160;    {</div>
<div class="line"><a name="l05212"></a><span class="lineno"> 5212</span>&#160;      <span class="comment">// Set the number of rows or columns</span></div>
<div class="line"><a name="l05213"></a><span class="lineno"> 5213</span>&#160;      row_or_column_start[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>] = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a> + 1];</div>
<div class="line"><a name="l05214"></a><span class="lineno"> 5214</span>&#160;      <span class="comment">// Counter for the total number of entries in the storage scheme</span></div>
<div class="line"><a name="l05215"></a><span class="lineno"> 5215</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> entry_count = 0;</div>
<div class="line"><a name="l05216"></a><span class="lineno"> 5216</span>&#160;      <span class="comment">// The first entry is 0</span></div>
<div class="line"><a name="l05217"></a><span class="lineno"> 5217</span>&#160;      row_or_column_start[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][0] = entry_count;</div>
<div class="line"><a name="l05218"></a><span class="lineno"> 5218</span>&#160; </div>
<div class="line"><a name="l05219"></a><span class="lineno"> 5219</span>&#160;      <span class="comment">// first we compute the number of non-zeros</span></div>
<div class="line"><a name="l05220"></a><span class="lineno"> 5220</span>&#160;      nnz[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>] = 0;</div>
<div class="line"><a name="l05221"></a><span class="lineno"> 5221</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i_global = 0; i_global &lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>; i_global++)</div>
<div class="line"><a name="l05222"></a><span class="lineno"> 5222</span>&#160;      {</div>
<div class="line"><a name="l05223"></a><span class="lineno"> 5223</span>&#160;        nnz[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>] += matrix_data_list[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][i_global].size();</div>
<div class="line"><a name="l05224"></a><span class="lineno"> 5224</span>&#160;      }</div>
<div class="line"><a name="l05225"></a><span class="lineno"> 5225</span>&#160; </div>
<div class="line"><a name="l05226"></a><span class="lineno"> 5226</span>&#160;      <span class="comment">// and then resize the storage</span></div>
<div class="line"><a name="l05227"></a><span class="lineno"> 5227</span>&#160;      column_or_row_index[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>] = <span class="keyword">new</span> <span class="keywordtype">int</span>[nnz[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>]];</div>
<div class="line"><a name="l05228"></a><span class="lineno"> 5228</span>&#160;      <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>] = <span class="keyword">new</span> <span class="keywordtype">double</span>[nnz[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>]];</div>
<div class="line"><a name="l05229"></a><span class="lineno"> 5229</span>&#160; </div>
<div class="line"><a name="l05230"></a><span class="lineno"> 5230</span>&#160;      <span class="comment">// Now we merely loop over the number of rows or columns</span></div>
<div class="line"><a name="l05231"></a><span class="lineno"> 5231</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i_global = 0; i_global &lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>; i_global++)</div>
<div class="line"><a name="l05232"></a><span class="lineno"> 5232</span>&#160;      {</div>
<div class="line"><a name="l05233"></a><span class="lineno"> 5233</span>&#160;        <span class="comment">// Start index for the present row is the number of entries so far</span></div>
<div class="line"><a name="l05234"></a><span class="lineno"> 5234</span>&#160;        row_or_column_start[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][i_global] = entry_count;</div>
<div class="line"><a name="l05235"></a><span class="lineno"> 5235</span>&#160;        <span class="comment">// If there are no entries in the list then skip the loop</span></div>
<div class="line"><a name="l05236"></a><span class="lineno"> 5236</span>&#160;        <span class="keywordflow">if</span> (matrix_data_list[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][i_global].empty())</div>
<div class="line"><a name="l05237"></a><span class="lineno"> 5237</span>&#160;        {</div>
<div class="line"><a name="l05238"></a><span class="lineno"> 5238</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05239"></a><span class="lineno"> 5239</span>&#160;        }</div>
<div class="line"><a name="l05240"></a><span class="lineno"> 5240</span>&#160; </div>
<div class="line"><a name="l05241"></a><span class="lineno"> 5241</span>&#160;        <span class="comment">// Sort the list corresponding to this row or column by the</span></div>
<div class="line"><a name="l05242"></a><span class="lineno"> 5242</span>&#160;        <span class="comment">// column or row index (first entry in the pair).</span></div>
<div class="line"><a name="l05243"></a><span class="lineno"> 5243</span>&#160;        <span class="comment">// This might be inefficient, but we only have to do the sort ONCE</span></div>
<div class="line"><a name="l05244"></a><span class="lineno"> 5244</span>&#160;        <span class="comment">// for each list. This is faster than using a map storage scheme, where</span></div>
<div class="line"><a name="l05245"></a><span class="lineno"> 5245</span>&#160;        <span class="comment">// we are sorting for every insertion (although the map structure</span></div>
<div class="line"><a name="l05246"></a><span class="lineno"> 5246</span>&#160;        <span class="comment">// is cleaner and more memory efficient)</span></div>
<div class="line"><a name="l05247"></a><span class="lineno"> 5247</span>&#160;        matrix_data_list[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][i_global].sort();</div>
<div class="line"><a name="l05248"></a><span class="lineno"> 5248</span>&#160; </div>
<div class="line"><a name="l05249"></a><span class="lineno"> 5249</span>&#160;        <span class="comment">// Set up an iterator for start of the list</span></div>
<div class="line"><a name="l05250"></a><span class="lineno"> 5250</span>&#160;        std::list&lt;std::pair&lt;unsigned, double&gt;&gt;::iterator it =</div>
<div class="line"><a name="l05251"></a><span class="lineno"> 5251</span>&#160;          matrix_data_list[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][i_global].begin();</div>
<div class="line"><a name="l05252"></a><span class="lineno"> 5252</span>&#160; </div>
<div class="line"><a name="l05253"></a><span class="lineno"> 5253</span>&#160;        <span class="comment">// Get the first row or column index in the list...</span></div>
<div class="line"><a name="l05254"></a><span class="lineno"> 5254</span>&#160;        <span class="keywordtype">unsigned</span> current_index = it-&gt;first;</div>
<div class="line"><a name="l05255"></a><span class="lineno"> 5255</span>&#160;        <span class="comment">//...and the corresponding value</span></div>
<div class="line"><a name="l05256"></a><span class="lineno"> 5256</span>&#160;        <span class="keywordtype">double</span> current_value = it-&gt;second;</div>
<div class="line"><a name="l05257"></a><span class="lineno"> 5257</span>&#160; </div>
<div class="line"><a name="l05258"></a><span class="lineno"> 5258</span>&#160;        <span class="comment">// Loop over all the entries in the sorted list</span></div>
<div class="line"><a name="l05259"></a><span class="lineno"> 5259</span>&#160;        <span class="comment">// Increase the iterator so that we start at the second entry</span></div>
<div class="line"><a name="l05260"></a><span class="lineno"> 5260</span>&#160;        <span class="keywordflow">for</span> (++it; it != matrix_data_list[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][i_global].end(); ++it)</div>
<div class="line"><a name="l05261"></a><span class="lineno"> 5261</span>&#160;        {</div>
<div class="line"><a name="l05262"></a><span class="lineno"> 5262</span>&#160;          <span class="comment">// If the index has not changed, then we must add the contribution</span></div>
<div class="line"><a name="l05263"></a><span class="lineno"> 5263</span>&#160;          <span class="comment">// of the present entry to the value.</span></div>
<div class="line"><a name="l05264"></a><span class="lineno"> 5264</span>&#160;          <span class="comment">// Additionally check that the entry is non-zero</span></div>
<div class="line"><a name="l05265"></a><span class="lineno"> 5265</span>&#160;          <span class="keywordflow">if</span> ((it-&gt;first == current_index) &amp;&amp;</div>
<div class="line"><a name="l05266"></a><span class="lineno"> 5266</span>&#160;              (<a class="code" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">std::fabs</a>(it-&gt;second) &gt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad1a1ffc2bd685377ce7213452876b127">Numerical_zero_for_sparse_assembly</a>))</div>
<div class="line"><a name="l05267"></a><span class="lineno"> 5267</span>&#160;          {</div>
<div class="line"><a name="l05268"></a><span class="lineno"> 5268</span>&#160;            current_value += it-&gt;second;</div>
<div class="line"><a name="l05269"></a><span class="lineno"> 5269</span>&#160;          }</div>
<div class="line"><a name="l05270"></a><span class="lineno"> 5270</span>&#160;          <span class="comment">// Otherwise, we have added all the contributions to the index</span></div>
<div class="line"><a name="l05271"></a><span class="lineno"> 5271</span>&#160;          <span class="comment">// to current_value, so add it to the SuperLU data structure</span></div>
<div class="line"><a name="l05272"></a><span class="lineno"> 5272</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l05273"></a><span class="lineno"> 5273</span>&#160;          {</div>
<div class="line"><a name="l05274"></a><span class="lineno"> 5274</span>&#160;            <span class="comment">// Add the row or column index to the vector</span></div>
<div class="line"><a name="l05275"></a><span class="lineno"> 5275</span>&#160;            column_or_row_index[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][entry_count] = current_index;</div>
<div class="line"><a name="l05276"></a><span class="lineno"> 5276</span>&#160;            <span class="comment">// Add the actual value to the vector</span></div>
<div class="line"><a name="l05277"></a><span class="lineno"> 5277</span>&#160;            <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][entry_count] = current_value;</div>
<div class="line"><a name="l05278"></a><span class="lineno"> 5278</span>&#160;            <span class="comment">// Increase the counter for the number of entries in each vector</span></div>
<div class="line"><a name="l05279"></a><span class="lineno"> 5279</span>&#160;            entry_count++;</div>
<div class="line"><a name="l05280"></a><span class="lineno"> 5280</span>&#160; </div>
<div class="line"><a name="l05281"></a><span class="lineno"> 5281</span>&#160;            <span class="comment">// Set the index and value to be those of the current entry in the</span></div>
<div class="line"><a name="l05282"></a><span class="lineno"> 5282</span>&#160;            <span class="comment">// list</span></div>
<div class="line"><a name="l05283"></a><span class="lineno"> 5283</span>&#160;            current_index = it-&gt;first;</div>
<div class="line"><a name="l05284"></a><span class="lineno"> 5284</span>&#160;            current_value = it-&gt;second;</div>
<div class="line"><a name="l05285"></a><span class="lineno"> 5285</span>&#160;          }</div>
<div class="line"><a name="l05286"></a><span class="lineno"> 5286</span>&#160;        } <span class="comment">// End of loop over all list entries for this global row or column</span></div>
<div class="line"><a name="l05287"></a><span class="lineno"> 5287</span>&#160; </div>
<div class="line"><a name="l05288"></a><span class="lineno"> 5288</span>&#160;        <span class="comment">// There are TWO special cases to consider.</span></div>
<div class="line"><a name="l05289"></a><span class="lineno"> 5289</span>&#160;        <span class="comment">// If there is only one equation number in the list, then it</span></div>
<div class="line"><a name="l05290"></a><span class="lineno"> 5290</span>&#160;        <span class="comment">// will NOT have been added. We test this case by comparing the</span></div>
<div class="line"><a name="l05291"></a><span class="lineno"> 5291</span>&#160;        <span class="comment">// number of entries with those stored in row_or_column_start[i_global]</span></div>
<div class="line"><a name="l05292"></a><span class="lineno"> 5292</span>&#160;        <span class="comment">// Otherwise</span></div>
<div class="line"><a name="l05293"></a><span class="lineno"> 5293</span>&#160;        <span class="comment">// If the final entry in the list has the same index as the penultimate</span></div>
<div class="line"><a name="l05294"></a><span class="lineno"> 5294</span>&#160;        <span class="comment">// entry, then it will NOT have been added to the SuperLU storage scheme</span></div>
<div class="line"><a name="l05295"></a><span class="lineno"> 5295</span>&#160;        <span class="comment">// Check this by comparing the current_index with the final index</span></div>
<div class="line"><a name="l05296"></a><span class="lineno"> 5296</span>&#160;        <span class="comment">// stored in the SuperLU scheme. If they are not the same, then</span></div>
<div class="line"><a name="l05297"></a><span class="lineno"> 5297</span>&#160;        <span class="comment">// add the current_index and value.</span></div>
<div class="line"><a name="l05298"></a><span class="lineno"> 5298</span>&#160; </div>
<div class="line"><a name="l05299"></a><span class="lineno"> 5299</span>&#160;        <span class="comment">// If single equation number in list</span></div>
<div class="line"><a name="l05300"></a><span class="lineno"> 5300</span>&#160;        <span class="keywordflow">if</span> ((<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(entry_count) == row_or_column_start[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][i_global])</div>
<div class="line"><a name="l05301"></a><span class="lineno"> 5301</span>&#160;            <span class="comment">// If we have a single equation number, this will not be evaluated.</span></div>
<div class="line"><a name="l05302"></a><span class="lineno"> 5302</span>&#160;            <span class="comment">// If we don&#39;t then we do the test to check that the final</span></div>
<div class="line"><a name="l05303"></a><span class="lineno"> 5303</span>&#160;            <span class="comment">// entry is added</span></div>
<div class="line"><a name="l05304"></a><span class="lineno"> 5304</span>&#160;            || (<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(current_index) !=</div>
<div class="line"><a name="l05305"></a><span class="lineno"> 5305</span>&#160;                column_or_row_index[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][entry_count - 1]))</div>
<div class="line"><a name="l05306"></a><span class="lineno"> 5306</span>&#160;        {</div>
<div class="line"><a name="l05307"></a><span class="lineno"> 5307</span>&#160;          <span class="comment">// Add the row or column index to the vector</span></div>
<div class="line"><a name="l05308"></a><span class="lineno"> 5308</span>&#160;          column_or_row_index[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][entry_count] = current_index;</div>
<div class="line"><a name="l05309"></a><span class="lineno"> 5309</span>&#160;          <span class="comment">// Add the actual value to the vector</span></div>
<div class="line"><a name="l05310"></a><span class="lineno"> 5310</span>&#160;          <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][entry_count] = current_value;</div>
<div class="line"><a name="l05311"></a><span class="lineno"> 5311</span>&#160;          <span class="comment">// Increase the counter for the number of entries in each vector</span></div>
<div class="line"><a name="l05312"></a><span class="lineno"> 5312</span>&#160;          entry_count++;</div>
<div class="line"><a name="l05313"></a><span class="lineno"> 5313</span>&#160;        }</div>
<div class="line"><a name="l05314"></a><span class="lineno"> 5314</span>&#160; </div>
<div class="line"><a name="l05315"></a><span class="lineno"> 5315</span>&#160;      } <span class="comment">// End of loop over the rows or columns of the entire matrix</span></div>
<div class="line"><a name="l05316"></a><span class="lineno"> 5316</span>&#160; </div>
<div class="line"><a name="l05317"></a><span class="lineno"> 5317</span>&#160;      <span class="comment">// Final entry in the row/column start vector</span></div>
<div class="line"><a name="l05318"></a><span class="lineno"> 5318</span>&#160;      row_or_column_start[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>] = entry_count;</div>
<div class="line"><a name="l05319"></a><span class="lineno"> 5319</span>&#160;    } <span class="comment">// End of loop over matrices</span></div>
<div class="line"><a name="l05320"></a><span class="lineno"> 5320</span>&#160; </div>
<div class="line"><a name="l05321"></a><span class="lineno"> 5321</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aedefa8337ace6043c2fdfd5a2d19afd3">Pause_at_end_of_sparse_assembly</a>)</div>
<div class="line"><a name="l05322"></a><span class="lineno"> 5322</span>&#160;    {</div>
<div class="line"><a name="l05323"></a><span class="lineno"> 5323</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Pausing at end of sparse assembly.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l05324"></a><span class="lineno"> 5324</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#a4a82243b0ce4c28469a290fe2d7cd2c4">pause</a>(<span class="stringliteral">&quot;Check memory usage now.&quot;</span>);</div>
<div class="line"><a name="l05325"></a><span class="lineno"> 5325</span>&#160;    }</div>
<div class="line"><a name="l05326"></a><span class="lineno"> 5326</span>&#160;  }</div>
<div class="ttc" id="aArray__initializer__list__vector__cxx11_8cpp_html_a32398b762ddd48fa3a6d504de68009f9"><div class="ttname"><a href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a></div><div class="ttdeci">Array&lt; int, Dynamic, 1 &gt; v</div><div class="ttdef"><b>Definition:</b> Array_initializer_list_vector_cxx11.cpp:1</div></div>
<div class="ttc" id="aclassoomph_1_1AssemblyHandler_html_a67093ef481c51d384606486c41002baa"><div class="ttname"><a href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a67093ef481c51d384606486c41002baa">oomph::AssemblyHandler::get_all_vectors_and_matrices</a></div><div class="ttdeci">virtual void get_all_vectors_and_matrices(GeneralisedElement *const &amp;elem_pt, Vector&lt; Vector&lt; double &gt;&gt; &amp;vec, Vector&lt; DenseMatrix&lt; double &gt;&gt; &amp;matrix)</div><div class="ttdef"><b>Definition:</b> assembly_handler.cc:113</div></div>
<div class="ttc" id="anamespaceoomph_html_a4a82243b0ce4c28469a290fe2d7cd2c4"><div class="ttname"><a href="../../da/ddf/namespaceoomph.html#a4a82243b0ce4c28469a290fe2d7cd2c4">oomph::pause</a></div><div class="ttdeci">void pause(std::string message)</div><div class="ttdoc">Pause and display message.</div><div class="ttdef"><b>Definition:</b> oomph_utilities.cc:1265</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>, <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">oomph::Mesh::element_pt()</a>, <a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a94d28e2de2559cde803d1ba2195b5290">oomph::AssemblyHandler::eqn_number()</a>, <a class="el" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">boost::multiprecision::fabs()</a>, <a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a67093ef481c51d384606486c41002baa">oomph::AssemblyHandler::get_all_vectors_and_matrices()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt()</a>, <a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a670b34aab05bfe0b96d0e0fabf583c7a">oomph::OomphCommunicator::my_rank()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof()</a>, <a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a09213be8f4aa009e0366460a7ed78e68">oomph::AssemblyHandler::ndof()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">oomph::Mesh::nelement()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad1a1ffc2bd685377ce7213452876b127">Numerical_zero_for_sparse_assembly</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#a4a82243b0ce4c28469a290fe2d7cd2c4">oomph::pause()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aedefa8337ace6043c2fdfd5a2d19afd3">Pause_at_end_of_sparse_assembly</a>, <a class="el" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">oomph::TimingHelpers::timer()</a>, <a class="el" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a>, and <a class="el" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">Eigen::value</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab9cdd18180be05e4d46bfdbc1acbdbd3">sparse_assemble_row_or_column_compressed()</a>.</p>

</div>
</div>
<a id="a7ba1b95df63f6e7d746a6dae641daa33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ba1b95df63f6e7d746a6dae641daa33">&#9670;&nbsp;</a></span>sparse_assemble_row_or_column_compressed_with_maps()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::sparse_assemble_row_or_column_compressed_with_maps </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>column_or_row_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>row_or_column_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>nnz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>residuals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>compressed_row_flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Private helper function that is used to assemble the Jacobian matrix in the case when the storage is row or column compressed. The boolean Flag indicates if we want compressed row format (true) or compressed column. This version uses maps</p>
<p>This is a (private) helper function that is used to assemble system matrices in compressed row or column format and compute residual vectors, using maps The default action is to assemble the jacobian matrix and residuals for the Newton method. The action can be overloaded at an elemental level by chaging the default behaviour of the function Element::get_all_vectors_and_matrices(). column_or_row_index: Column [or row] index of given entry row_or_column_start: Index of first entry for given row [or column] value : Vector of nonzero entries residuals : Residual vector compressed_row_flag: Bool flag to indicate if storage format is compressed row [if false interpretation of arguments is as stated in square brackets]. </p>
<div class="fragment"><div class="line"><a name="l04591"></a><span class="lineno"> 4591</span>&#160;  {</div>
<div class="line"><a name="l04592"></a><span class="lineno"> 4592</span>&#160;    <span class="comment">// Total number of elements</span></div>
<div class="line"><a name="l04593"></a><span class="lineno"> 4593</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n_elements = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>()-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">nelement</a>();</div>
<div class="line"><a name="l04594"></a><span class="lineno"> 4594</span>&#160; </div>
<div class="line"><a name="l04595"></a><span class="lineno"> 4595</span>&#160;    <span class="comment">// Default range of elements for distributed problems</span></div>
<div class="line"><a name="l04596"></a><span class="lineno"> 4596</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> el_lo = 0;</div>
<div class="line"><a name="l04597"></a><span class="lineno"> 4597</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> el_hi = n_elements - 1;</div>
<div class="line"><a name="l04598"></a><span class="lineno"> 4598</span>&#160; </div>
<div class="line"><a name="l04599"></a><span class="lineno"> 4599</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l04600"></a><span class="lineno"> 4600</span>&#160;    <span class="comment">// Otherwise just loop over a fraction of the elements</span></div>
<div class="line"><a name="l04601"></a><span class="lineno"> 4601</span>&#160;    <span class="comment">// (This will either have been initialised in</span></div>
<div class="line"><a name="l04602"></a><span class="lineno"> 4602</span>&#160;    <span class="comment">// Problem::set_default_first_and_last_element_for_assembly() or</span></div>
<div class="line"><a name="l04603"></a><span class="lineno"> 4603</span>&#160;    <span class="comment">// will have been re-assigned during a previous assembly loop</span></div>
<div class="line"><a name="l04604"></a><span class="lineno"> 4604</span>&#160;    <span class="comment">// Note that following the re-assignment only the entries</span></div>
<div class="line"><a name="l04605"></a><span class="lineno"> 4605</span>&#160;    <span class="comment">// for the current processor are relevant.</span></div>
<div class="line"><a name="l04606"></a><span class="lineno"> 4606</span>&#160;    <span class="keywordflow">if</span> (!Problem_has_been_distributed)</div>
<div class="line"><a name="l04607"></a><span class="lineno"> 4607</span>&#160;    {</div>
<div class="line"><a name="l04608"></a><span class="lineno"> 4608</span>&#160;      el_lo = First_el_for_assembly[<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>-&gt;<a class="code" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a670b34aab05bfe0b96d0e0fabf583c7a">my_rank</a>()];</div>
<div class="line"><a name="l04609"></a><span class="lineno"> 4609</span>&#160;      el_hi = Last_el_plus_one_for_assembly[<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>-&gt;<a class="code" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a670b34aab05bfe0b96d0e0fabf583c7a">my_rank</a>()] - 1;</div>
<div class="line"><a name="l04610"></a><span class="lineno"> 4610</span>&#160;    }</div>
<div class="line"><a name="l04611"></a><span class="lineno"> 4611</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04612"></a><span class="lineno"> 4612</span>&#160; </div>
<div class="line"><a name="l04613"></a><span class="lineno"> 4613</span>&#160;    <span class="comment">// number of dofs</span></div>
<div class="line"><a name="l04614"></a><span class="lineno"> 4614</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a> = this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>();</div>
<div class="line"><a name="l04615"></a><span class="lineno"> 4615</span>&#160; </div>
<div class="line"><a name="l04616"></a><span class="lineno"> 4616</span>&#160;    <span class="comment">// Find the number of vectors to be assembled</span></div>
<div class="line"><a name="l04617"></a><span class="lineno"> 4617</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_vector = residuals.size();</div>
<div class="line"><a name="l04618"></a><span class="lineno"> 4618</span>&#160; </div>
<div class="line"><a name="l04619"></a><span class="lineno"> 4619</span>&#160;    <span class="comment">// Find the number of matrices to be assembled</span></div>
<div class="line"><a name="l04620"></a><span class="lineno"> 4620</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_matrix = column_or_row_index.size();</div>
<div class="line"><a name="l04621"></a><span class="lineno"> 4621</span>&#160; </div>
<div class="line"><a name="l04622"></a><span class="lineno"> 4622</span>&#160;    <span class="comment">// Locally cache pointer to assembly handler</span></div>
<div class="line"><a name="l04623"></a><span class="lineno"> 4623</span>&#160;    AssemblyHandler* <span class="keyword">const</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a> = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>;</div>
<div class="line"><a name="l04624"></a><span class="lineno"> 4624</span>&#160; </div>
<div class="line"><a name="l04625"></a><span class="lineno"> 4625</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l04626"></a><span class="lineno"> 4626</span>&#160;    <span class="keywordtype">bool</span> doing_residuals = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04627"></a><span class="lineno"> 4627</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">dynamic_cast&lt;</span>ParallelResidualsHandler*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>) != 0)</div>
<div class="line"><a name="l04628"></a><span class="lineno"> 4628</span>&#160;    {</div>
<div class="line"><a name="l04629"></a><span class="lineno"> 4629</span>&#160;      doing_residuals = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04630"></a><span class="lineno"> 4630</span>&#160;    }</div>
<div class="line"><a name="l04631"></a><span class="lineno"> 4631</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04632"></a><span class="lineno"> 4632</span>&#160; </div>
<div class="line"><a name="l04633"></a><span class="lineno"> 4633</span>&#160;<span class="comment">// Error check dimensions</span></div>
<div class="line"><a name="l04634"></a><span class="lineno"> 4634</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l04635"></a><span class="lineno"> 4635</span>&#160;    <span class="keywordflow">if</span> (row_or_column_start.size() != n_matrix)</div>
<div class="line"><a name="l04636"></a><span class="lineno"> 4636</span>&#160;    {</div>
<div class="line"><a name="l04637"></a><span class="lineno"> 4637</span>&#160;      std::ostringstream error_stream;</div>
<div class="line"><a name="l04638"></a><span class="lineno"> 4638</span>&#160;      error_stream &lt;&lt; <span class="stringliteral">&quot;Error: &quot;</span> &lt;&lt; std::endl</div>
<div class="line"><a name="l04639"></a><span class="lineno"> 4639</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;row_or_column_start.size() &quot;</span></div>
<div class="line"><a name="l04640"></a><span class="lineno"> 4640</span>&#160;                   &lt;&lt; row_or_column_start.size() &lt;&lt; <span class="stringliteral">&quot; does not equal &quot;</span></div>
<div class="line"><a name="l04641"></a><span class="lineno"> 4641</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;column_or_row_index.size() &quot;</span></div>
<div class="line"><a name="l04642"></a><span class="lineno"> 4642</span>&#160;                   &lt;&lt; column_or_row_index.size() &lt;&lt; std::endl;</div>
<div class="line"><a name="l04643"></a><span class="lineno"> 4643</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l04644"></a><span class="lineno"> 4644</span>&#160;        error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l04645"></a><span class="lineno"> 4645</span>&#160;    }</div>
<div class="line"><a name="l04646"></a><span class="lineno"> 4646</span>&#160; </div>
<div class="line"><a name="l04647"></a><span class="lineno"> 4647</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>.size() != n_matrix)</div>
<div class="line"><a name="l04648"></a><span class="lineno"> 4648</span>&#160;    {</div>
<div class="line"><a name="l04649"></a><span class="lineno"> 4649</span>&#160;      std::ostringstream error_stream;</div>
<div class="line"><a name="l04650"></a><span class="lineno"> 4650</span>&#160;      error_stream</div>
<div class="line"><a name="l04651"></a><span class="lineno"> 4651</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;Error in Problem::sparse_assemble_row_or_column_compressed &quot;</span></div>
<div class="line"><a name="l04652"></a><span class="lineno"> 4652</span>&#160;        &lt;&lt; std::endl</div>
<div class="line"><a name="l04653"></a><span class="lineno"> 4653</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;value.size() &quot;</span> &lt;&lt; <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>.size() &lt;&lt; <span class="stringliteral">&quot; does not equal &quot;</span></div>
<div class="line"><a name="l04654"></a><span class="lineno"> 4654</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;column_or_row_index.size() &quot;</span> &lt;&lt; column_or_row_index.size()</div>
<div class="line"><a name="l04655"></a><span class="lineno"> 4655</span>&#160;        &lt;&lt; std::endl</div>
<div class="line"><a name="l04656"></a><span class="lineno"> 4656</span>&#160;        &lt;&lt; std::endl</div>
<div class="line"><a name="l04657"></a><span class="lineno"> 4657</span>&#160;        &lt;&lt; std::endl;</div>
<div class="line"><a name="l04658"></a><span class="lineno"> 4658</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l04659"></a><span class="lineno"> 4659</span>&#160;        error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l04660"></a><span class="lineno"> 4660</span>&#160;    }</div>
<div class="line"><a name="l04661"></a><span class="lineno"> 4661</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04662"></a><span class="lineno"> 4662</span>&#160; </div>
<div class="line"><a name="l04663"></a><span class="lineno"> 4663</span>&#160; </div>
<div class="line"><a name="l04664"></a><span class="lineno"> 4664</span>&#160;    <span class="comment">// The idea behind this sparse assembly routine is to use a vector of</span></div>
<div class="line"><a name="l04665"></a><span class="lineno"> 4665</span>&#160;    <span class="comment">// maps for the entries in each row or column of the complete matrix.</span></div>
<div class="line"><a name="l04666"></a><span class="lineno"> 4666</span>&#160;    <span class="comment">// The key for each map is the global row or column number and</span></div>
<div class="line"><a name="l04667"></a><span class="lineno"> 4667</span>&#160;    <span class="comment">// the default comparison operator for integers means that each map</span></div>
<div class="line"><a name="l04668"></a><span class="lineno"> 4668</span>&#160;    <span class="comment">// is ordered by the global row or column number. Thus, we need not</span></div>
<div class="line"><a name="l04669"></a><span class="lineno"> 4669</span>&#160;    <span class="comment">// sort the maps, that happens at each insertion of a new entry. The</span></div>
<div class="line"><a name="l04670"></a><span class="lineno"> 4670</span>&#160;    <span class="comment">// price we pay  is that for large maps, inseration is not a</span></div>
<div class="line"><a name="l04671"></a><span class="lineno"> 4671</span>&#160;    <span class="comment">// cheap operation. Hash maps can be used to increase the speed, but then</span></div>
<div class="line"><a name="l04672"></a><span class="lineno"> 4672</span>&#160;    <span class="comment">// the ordering is lost and we would have to sort anyway. The solution if</span></div>
<div class="line"><a name="l04673"></a><span class="lineno"> 4673</span>&#160;    <span class="comment">// speed is required is to use lists, see below.</span></div>
<div class="line"><a name="l04674"></a><span class="lineno"> 4674</span>&#160; </div>
<div class="line"><a name="l04675"></a><span class="lineno"> 4675</span>&#160; </div>
<div class="line"><a name="l04676"></a><span class="lineno"> 4676</span>&#160;    <span class="comment">// Set up a vector of vectors of maps of entries of each  matrix,</span></div>
<div class="line"><a name="l04677"></a><span class="lineno"> 4677</span>&#160;    <span class="comment">// indexed by either the column or row. The entries of the vector for</span></div>
<div class="line"><a name="l04678"></a><span class="lineno"> 4678</span>&#160;    <span class="comment">// each matrix correspond to all the rows or columns of that matrix.</span></div>
<div class="line"><a name="l04679"></a><span class="lineno"> 4679</span>&#160;    <span class="comment">// The use of the map storage</span></div>
<div class="line"><a name="l04680"></a><span class="lineno"> 4680</span>&#160;    <span class="comment">// scheme, with its implicit ordering on the first index, gives</span></div>
<div class="line"><a name="l04681"></a><span class="lineno"> 4681</span>&#160;    <span class="comment">// a sparse ordered list of the entries in the given row or column.</span></div>
<div class="line"><a name="l04682"></a><span class="lineno"> 4682</span>&#160;    Vector&lt;Vector&lt;std::map&lt;unsigned, double&gt;&gt;&gt; matrix_data_map(n_matrix);</div>
<div class="line"><a name="l04683"></a><span class="lineno"> 4683</span>&#160;    <span class="comment">// Loop over the number of matrices being assembled and resize</span></div>
<div class="line"><a name="l04684"></a><span class="lineno"> 4684</span>&#160;    <span class="comment">// each vector of maps to the number of rows or columns of the matrix</span></div>
<div class="line"><a name="l04685"></a><span class="lineno"> 4685</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> = 0; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> &lt; n_matrix; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>++)</div>
<div class="line"><a name="l04686"></a><span class="lineno"> 4686</span>&#160;    {</div>
<div class="line"><a name="l04687"></a><span class="lineno"> 4687</span>&#160;      matrix_data_map[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>].resize(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>);</div>
<div class="line"><a name="l04688"></a><span class="lineno"> 4688</span>&#160;    }</div>
<div class="line"><a name="l04689"></a><span class="lineno"> 4689</span>&#160; </div>
<div class="line"><a name="l04690"></a><span class="lineno"> 4690</span>&#160;    <span class="comment">// Resize the residuals vectors</span></div>
<div class="line"><a name="l04691"></a><span class="lineno"> 4691</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a> = 0; <a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a> &lt; n_vector; <a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a>++)</div>
<div class="line"><a name="l04692"></a><span class="lineno"> 4692</span>&#160;    {</div>
<div class="line"><a name="l04693"></a><span class="lineno"> 4693</span>&#160;      residuals[<a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a>] = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>];</div>
<div class="line"><a name="l04694"></a><span class="lineno"> 4694</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l04695"></a><span class="lineno"> 4695</span>&#160;      {</div>
<div class="line"><a name="l04696"></a><span class="lineno"> 4696</span>&#160;        residuals[<a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a>][<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = 0;</div>
<div class="line"><a name="l04697"></a><span class="lineno"> 4697</span>&#160;      }</div>
<div class="line"><a name="l04698"></a><span class="lineno"> 4698</span>&#160;    }</div>
<div class="line"><a name="l04699"></a><span class="lineno"> 4699</span>&#160; </div>
<div class="line"><a name="l04700"></a><span class="lineno"> 4700</span>&#160; </div>
<div class="line"><a name="l04701"></a><span class="lineno"> 4701</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l04702"></a><span class="lineno"> 4702</span>&#160; </div>
<div class="line"><a name="l04703"></a><span class="lineno"> 4703</span>&#160; </div>
<div class="line"><a name="l04704"></a><span class="lineno"> 4704</span>&#160;    <span class="comment">// Storage for assembly time for elements</span></div>
<div class="line"><a name="l04705"></a><span class="lineno"> 4705</span>&#160;    <span class="keywordtype">double</span> t_assemble_start = 0.0;</div>
<div class="line"><a name="l04706"></a><span class="lineno"> 4706</span>&#160; </div>
<div class="line"><a name="l04707"></a><span class="lineno"> 4707</span>&#160;    <span class="comment">// Storage for assembly times</span></div>
<div class="line"><a name="l04708"></a><span class="lineno"> 4708</span>&#160;    <span class="keywordflow">if</span> ((!doing_residuals) &amp;&amp; Must_recompute_load_balance_for_assembly)</div>
<div class="line"><a name="l04709"></a><span class="lineno"> 4709</span>&#160;    {</div>
<div class="line"><a name="l04710"></a><span class="lineno"> 4710</span>&#160;      Elemental_assembly_time.resize(n_elements);</div>
<div class="line"><a name="l04711"></a><span class="lineno"> 4711</span>&#160;    }</div>
<div class="line"><a name="l04712"></a><span class="lineno"> 4712</span>&#160; </div>
<div class="line"><a name="l04713"></a><span class="lineno"> 4713</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04714"></a><span class="lineno"> 4714</span>&#160; </div>
<div class="line"><a name="l04715"></a><span class="lineno"> 4715</span>&#160;    <span class="comment">//----------------Assemble and populate the maps-------------------------</span></div>
<div class="line"><a name="l04716"></a><span class="lineno"> 4716</span>&#160;    {</div>
<div class="line"><a name="l04717"></a><span class="lineno"> 4717</span>&#160;      <span class="comment">// Allocate local storage for the element&#39;s contribution to the</span></div>
<div class="line"><a name="l04718"></a><span class="lineno"> 4718</span>&#160;      <span class="comment">// residuals vectors and system matrices of the size of the maximum</span></div>
<div class="line"><a name="l04719"></a><span class="lineno"> 4719</span>&#160;      <span class="comment">// number of dofs in any element.</span></div>
<div class="line"><a name="l04720"></a><span class="lineno"> 4720</span>&#160;      <span class="comment">// This means that the storage is only allocated (and deleted) once</span></div>
<div class="line"><a name="l04721"></a><span class="lineno"> 4721</span>&#160;      Vector&lt;Vector&lt;double&gt;&gt; el_residuals(n_vector);</div>
<div class="line"><a name="l04722"></a><span class="lineno"> 4722</span>&#160;      Vector&lt;DenseMatrix&lt;double&gt;&gt; el_jacobian(n_matrix);</div>
<div class="line"><a name="l04723"></a><span class="lineno"> 4723</span>&#160; </div>
<div class="line"><a name="l04724"></a><span class="lineno"> 4724</span>&#160;      <span class="comment">// Loop over the elements for this processor</span></div>
<div class="line"><a name="l04725"></a><span class="lineno"> 4725</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = el_lo; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt;= el_hi; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l04726"></a><span class="lineno"> 4726</span>&#160;      {</div>
<div class="line"><a name="l04727"></a><span class="lineno"> 4727</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l04728"></a><span class="lineno"> 4728</span>&#160;        <span class="comment">// Time it?</span></div>
<div class="line"><a name="l04729"></a><span class="lineno"> 4729</span>&#160;        <span class="keywordflow">if</span> ((!doing_residuals) &amp;&amp; Must_recompute_load_balance_for_assembly)</div>
<div class="line"><a name="l04730"></a><span class="lineno"> 4730</span>&#160;        {</div>
<div class="line"><a name="l04731"></a><span class="lineno"> 4731</span>&#160;          t_assemble_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l04732"></a><span class="lineno"> 4732</span>&#160;        }</div>
<div class="line"><a name="l04733"></a><span class="lineno"> 4733</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04734"></a><span class="lineno"> 4734</span>&#160; </div>
<div class="line"><a name="l04735"></a><span class="lineno"> 4735</span>&#160;        <span class="comment">// Get the pointer to the element</span></div>
<div class="line"><a name="l04736"></a><span class="lineno"> 4736</span>&#160;        GeneralisedElement* elem_pt = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>()-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">element_pt</a>(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>);</div>
<div class="line"><a name="l04737"></a><span class="lineno"> 4737</span>&#160; </div>
<div class="line"><a name="l04738"></a><span class="lineno"> 4738</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l04739"></a><span class="lineno"> 4739</span>&#160;        <span class="comment">// Ignore halo elements</span></div>
<div class="line"><a name="l04740"></a><span class="lineno"> 4740</span>&#160;        <span class="keywordflow">if</span> (!elem_pt-&gt;is_halo())</div>
<div class="line"><a name="l04741"></a><span class="lineno"> 4741</span>&#160;        {</div>
<div class="line"><a name="l04742"></a><span class="lineno"> 4742</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04743"></a><span class="lineno"> 4743</span>&#160; </div>
<div class="line"><a name="l04744"></a><span class="lineno"> 4744</span>&#160;          <span class="comment">// Find number of degrees of freedom in the element</span></div>
<div class="line"><a name="l04745"></a><span class="lineno"> 4745</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> nvar = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>-&gt;<a class="code" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a09213be8f4aa009e0366460a7ed78e68">ndof</a>(elem_pt);</div>
<div class="line"><a name="l04746"></a><span class="lineno"> 4746</span>&#160; </div>
<div class="line"><a name="l04747"></a><span class="lineno"> 4747</span>&#160;          <span class="comment">// Resize the storage for elemental jacobian and residuals</span></div>
<div class="line"><a name="l04748"></a><span class="lineno"> 4748</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a> = 0; <a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a> &lt; n_vector; <a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a>++)</div>
<div class="line"><a name="l04749"></a><span class="lineno"> 4749</span>&#160;          {</div>
<div class="line"><a name="l04750"></a><span class="lineno"> 4750</span>&#160;            el_residuals[<a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a>].resize(nvar);</div>
<div class="line"><a name="l04751"></a><span class="lineno"> 4751</span>&#160;          }</div>
<div class="line"><a name="l04752"></a><span class="lineno"> 4752</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> = 0; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> &lt; n_matrix; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>++)</div>
<div class="line"><a name="l04753"></a><span class="lineno"> 4753</span>&#160;          {</div>
<div class="line"><a name="l04754"></a><span class="lineno"> 4754</span>&#160;            el_jacobian[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>].resize(nvar);</div>
<div class="line"><a name="l04755"></a><span class="lineno"> 4755</span>&#160;          }</div>
<div class="line"><a name="l04756"></a><span class="lineno"> 4756</span>&#160; </div>
<div class="line"><a name="l04757"></a><span class="lineno"> 4757</span>&#160;          <span class="comment">// Now get the residuals and jacobian for the element</span></div>
<div class="line"><a name="l04758"></a><span class="lineno"> 4758</span>&#160;          <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>-&gt;<a class="code" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a67093ef481c51d384606486c41002baa">get_all_vectors_and_matrices</a>(</div>
<div class="line"><a name="l04759"></a><span class="lineno"> 4759</span>&#160;            elem_pt, el_residuals, el_jacobian);</div>
<div class="line"><a name="l04760"></a><span class="lineno"> 4760</span>&#160; </div>
<div class="line"><a name="l04761"></a><span class="lineno"> 4761</span>&#160;          <span class="comment">//---------------Insert the values into the maps--------------</span></div>
<div class="line"><a name="l04762"></a><span class="lineno"> 4762</span>&#160; </div>
<div class="line"><a name="l04763"></a><span class="lineno"> 4763</span>&#160;          <span class="comment">// Loop over the first index of local variables</span></div>
<div class="line"><a name="l04764"></a><span class="lineno"> 4764</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; nvar; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l04765"></a><span class="lineno"> 4765</span>&#160;          {</div>
<div class="line"><a name="l04766"></a><span class="lineno"> 4766</span>&#160;            <span class="comment">// Get the local equation number</span></div>
<div class="line"><a name="l04767"></a><span class="lineno"> 4767</span>&#160;            <span class="keywordtype">unsigned</span> eqn_number = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>-&gt;<a class="code" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a94d28e2de2559cde803d1ba2195b5290">eqn_number</a>(elem_pt, <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l04768"></a><span class="lineno"> 4768</span>&#160; </div>
<div class="line"><a name="l04769"></a><span class="lineno"> 4769</span>&#160;            <span class="comment">// Add the contribution to the residuals</span></div>
<div class="line"><a name="l04770"></a><span class="lineno"> 4770</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a> = 0; <a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a> &lt; n_vector; <a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a>++)</div>
<div class="line"><a name="l04771"></a><span class="lineno"> 4771</span>&#160;            {</div>
<div class="line"><a name="l04772"></a><span class="lineno"> 4772</span>&#160;              <span class="comment">// Fill in each residuals vector</span></div>
<div class="line"><a name="l04773"></a><span class="lineno"> 4773</span>&#160;              residuals[<a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a>][eqn_number] += el_residuals[<a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a>][<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l04774"></a><span class="lineno"> 4774</span>&#160;            }</div>
<div class="line"><a name="l04775"></a><span class="lineno"> 4775</span>&#160; </div>
<div class="line"><a name="l04776"></a><span class="lineno"> 4776</span>&#160;            <span class="comment">// Now loop over the other index</span></div>
<div class="line"><a name="l04777"></a><span class="lineno"> 4777</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; nvar; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l04778"></a><span class="lineno"> 4778</span>&#160;            {</div>
<div class="line"><a name="l04779"></a><span class="lineno"> 4779</span>&#160;              <span class="comment">// Get the number of the unknown</span></div>
<div class="line"><a name="l04780"></a><span class="lineno"> 4780</span>&#160;              <span class="keywordtype">unsigned</span> unknown = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>-&gt;<a class="code" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a94d28e2de2559cde803d1ba2195b5290">eqn_number</a>(elem_pt, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l04781"></a><span class="lineno"> 4781</span>&#160; </div>
<div class="line"><a name="l04782"></a><span class="lineno"> 4782</span>&#160;              <span class="comment">// Loop over the matrices</span></div>
<div class="line"><a name="l04783"></a><span class="lineno"> 4783</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> = 0; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> &lt; n_matrix; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>++)</div>
<div class="line"><a name="l04784"></a><span class="lineno"> 4784</span>&#160;              {</div>
<div class="line"><a name="l04785"></a><span class="lineno"> 4785</span>&#160;                <span class="comment">// Get the value of the matrix at this point</span></div>
<div class="line"><a name="l04786"></a><span class="lineno"> 4786</span>&#160;                <span class="keywordtype">double</span> <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a> = el_jacobian[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>](<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l04787"></a><span class="lineno"> 4787</span>&#160;                <span class="comment">// Only bother to add to the map if it&#39;s non-zero</span></div>
<div class="line"><a name="l04788"></a><span class="lineno"> 4788</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">std::fabs</a>(<a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>) &gt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad1a1ffc2bd685377ce7213452876b127">Numerical_zero_for_sparse_assembly</a>)</div>
<div class="line"><a name="l04789"></a><span class="lineno"> 4789</span>&#160;                {</div>
<div class="line"><a name="l04790"></a><span class="lineno"> 4790</span>&#160;                  <span class="comment">// If it&#39;s compressed row storage, then our vector of maps</span></div>
<div class="line"><a name="l04791"></a><span class="lineno"> 4791</span>&#160;                  <span class="comment">// is indexed by row (equation number)</span></div>
<div class="line"><a name="l04792"></a><span class="lineno"> 4792</span>&#160;                  <span class="keywordflow">if</span> (compressed_row_flag)</div>
<div class="line"><a name="l04793"></a><span class="lineno"> 4793</span>&#160;                  {</div>
<div class="line"><a name="l04794"></a><span class="lineno"> 4794</span>&#160;                    <span class="comment">// Add the data into the map using the unknown as the map</span></div>
<div class="line"><a name="l04795"></a><span class="lineno"> 4795</span>&#160;                    <span class="comment">// key</span></div>
<div class="line"><a name="l04796"></a><span class="lineno"> 4796</span>&#160;                    matrix_data_map[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][eqn_number][unknown] += <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>;</div>
<div class="line"><a name="l04797"></a><span class="lineno"> 4797</span>&#160;                  }</div>
<div class="line"><a name="l04798"></a><span class="lineno"> 4798</span>&#160;                  <span class="comment">// Otherwise it&#39;s compressed column storage and our vector is</span></div>
<div class="line"><a name="l04799"></a><span class="lineno"> 4799</span>&#160;                  <span class="comment">// indexed by column (the unknown)</span></div>
<div class="line"><a name="l04800"></a><span class="lineno"> 4800</span>&#160;                  <span class="keywordflow">else</span></div>
<div class="line"><a name="l04801"></a><span class="lineno"> 4801</span>&#160;                  {</div>
<div class="line"><a name="l04802"></a><span class="lineno"> 4802</span>&#160;                    <span class="comment">// Add the data into the map using the eqn_numbe as the map</span></div>
<div class="line"><a name="l04803"></a><span class="lineno"> 4803</span>&#160;                    <span class="comment">// key</span></div>
<div class="line"><a name="l04804"></a><span class="lineno"> 4804</span>&#160;                    matrix_data_map[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][unknown][eqn_number] += <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>;</div>
<div class="line"><a name="l04805"></a><span class="lineno"> 4805</span>&#160;                  }</div>
<div class="line"><a name="l04806"></a><span class="lineno"> 4806</span>&#160;                }</div>
<div class="line"><a name="l04807"></a><span class="lineno"> 4807</span>&#160;              } <span class="comment">// End of loop over matrices</span></div>
<div class="line"><a name="l04808"></a><span class="lineno"> 4808</span>&#160;            }</div>
<div class="line"><a name="l04809"></a><span class="lineno"> 4809</span>&#160;          }</div>
<div class="line"><a name="l04810"></a><span class="lineno"> 4810</span>&#160; </div>
<div class="line"><a name="l04811"></a><span class="lineno"> 4811</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l04812"></a><span class="lineno"> 4812</span>&#160;        } <span class="comment">// endif halo element</span></div>
<div class="line"><a name="l04813"></a><span class="lineno"> 4813</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04814"></a><span class="lineno"> 4814</span>&#160; </div>
<div class="line"><a name="l04815"></a><span class="lineno"> 4815</span>&#160; </div>
<div class="line"><a name="l04816"></a><span class="lineno"> 4816</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l04817"></a><span class="lineno"> 4817</span>&#160;        <span class="comment">// Time it?</span></div>
<div class="line"><a name="l04818"></a><span class="lineno"> 4818</span>&#160;        <span class="keywordflow">if</span> ((!doing_residuals) &amp;&amp; Must_recompute_load_balance_for_assembly)</div>
<div class="line"><a name="l04819"></a><span class="lineno"> 4819</span>&#160;        {</div>
<div class="line"><a name="l04820"></a><span class="lineno"> 4820</span>&#160;          Elemental_assembly_time[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>] =</div>
<div class="line"><a name="l04821"></a><span class="lineno"> 4821</span>&#160;            <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>() - t_assemble_start;</div>
<div class="line"><a name="l04822"></a><span class="lineno"> 4822</span>&#160;        }</div>
<div class="line"><a name="l04823"></a><span class="lineno"> 4823</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04824"></a><span class="lineno"> 4824</span>&#160; </div>
<div class="line"><a name="l04825"></a><span class="lineno"> 4825</span>&#160;      } <span class="comment">// End of loop over the elements</span></div>
<div class="line"><a name="l04826"></a><span class="lineno"> 4826</span>&#160; </div>
<div class="line"><a name="l04827"></a><span class="lineno"> 4827</span>&#160;    } <span class="comment">// End of map assembly</span></div>
<div class="line"><a name="l04828"></a><span class="lineno"> 4828</span>&#160; </div>
<div class="line"><a name="l04829"></a><span class="lineno"> 4829</span>&#160; </div>
<div class="line"><a name="l04830"></a><span class="lineno"> 4830</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l04831"></a><span class="lineno"> 4831</span>&#160; </div>
<div class="line"><a name="l04832"></a><span class="lineno"> 4832</span>&#160;    <span class="comment">// Postprocess timing information and re-allocate distribution of</span></div>
<div class="line"><a name="l04833"></a><span class="lineno"> 4833</span>&#160;    <span class="comment">// elements during subsequent assemblies.</span></div>
<div class="line"><a name="l04834"></a><span class="lineno"> 4834</span>&#160;    <span class="keywordflow">if</span> ((!doing_residuals) &amp;&amp; (!Problem_has_been_distributed) &amp;&amp;</div>
<div class="line"><a name="l04835"></a><span class="lineno"> 4835</span>&#160;        Must_recompute_load_balance_for_assembly)</div>
<div class="line"><a name="l04836"></a><span class="lineno"> 4836</span>&#160;    {</div>
<div class="line"><a name="l04837"></a><span class="lineno"> 4837</span>&#160;      recompute_load_balanced_assembly();</div>
<div class="line"><a name="l04838"></a><span class="lineno"> 4838</span>&#160;    }</div>
<div class="line"><a name="l04839"></a><span class="lineno"> 4839</span>&#160; </div>
<div class="line"><a name="l04840"></a><span class="lineno"> 4840</span>&#160;    <span class="comment">// We have determined load balancing for current setup.</span></div>
<div class="line"><a name="l04841"></a><span class="lineno"> 4841</span>&#160;    <span class="comment">// This can remain the same until assign_eqn_numbers() is called</span></div>
<div class="line"><a name="l04842"></a><span class="lineno"> 4842</span>&#160;    <span class="comment">// again -- the flag is re-set to true there.</span></div>
<div class="line"><a name="l04843"></a><span class="lineno"> 4843</span>&#160;    <span class="keywordflow">if</span> ((!doing_residuals) &amp;&amp; Must_recompute_load_balance_for_assembly)</div>
<div class="line"><a name="l04844"></a><span class="lineno"> 4844</span>&#160;    {</div>
<div class="line"><a name="l04845"></a><span class="lineno"> 4845</span>&#160;      Must_recompute_load_balance_for_assembly = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04846"></a><span class="lineno"> 4846</span>&#160;    }</div>
<div class="line"><a name="l04847"></a><span class="lineno"> 4847</span>&#160; </div>
<div class="line"><a name="l04848"></a><span class="lineno"> 4848</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04849"></a><span class="lineno"> 4849</span>&#160; </div>
<div class="line"><a name="l04850"></a><span class="lineno"> 4850</span>&#160; </div>
<div class="line"><a name="l04851"></a><span class="lineno"> 4851</span>&#160;    <span class="comment">//-----------Finally we need to convert the beautiful map storage scheme</span></div>
<div class="line"><a name="l04852"></a><span class="lineno"> 4852</span>&#160;    <span class="comment">//------------------------to the containers required by SuperLU</span></div>
<div class="line"><a name="l04853"></a><span class="lineno"> 4853</span>&#160; </div>
<div class="line"><a name="l04854"></a><span class="lineno"> 4854</span>&#160;    <span class="comment">// Loop over the number of matrices</span></div>
<div class="line"><a name="l04855"></a><span class="lineno"> 4855</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> = 0; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> &lt; n_matrix; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>++)</div>
<div class="line"><a name="l04856"></a><span class="lineno"> 4856</span>&#160;    {</div>
<div class="line"><a name="l04857"></a><span class="lineno"> 4857</span>&#160;      <span class="comment">// Set the number of rows or columns</span></div>
<div class="line"><a name="l04858"></a><span class="lineno"> 4858</span>&#160;      row_or_column_start[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>] = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a> + 1];</div>
<div class="line"><a name="l04859"></a><span class="lineno"> 4859</span>&#160;      <span class="comment">// Counter for the total number of entries in the storage scheme</span></div>
<div class="line"><a name="l04860"></a><span class="lineno"> 4860</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> entry_count = 0;</div>
<div class="line"><a name="l04861"></a><span class="lineno"> 4861</span>&#160;      row_or_column_start[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][0] = entry_count;</div>
<div class="line"><a name="l04862"></a><span class="lineno"> 4862</span>&#160; </div>
<div class="line"><a name="l04863"></a><span class="lineno"> 4863</span>&#160;      <span class="comment">// first we compute the number of non-zeros</span></div>
<div class="line"><a name="l04864"></a><span class="lineno"> 4864</span>&#160;      nnz[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>] = 0;</div>
<div class="line"><a name="l04865"></a><span class="lineno"> 4865</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i_global = 0; i_global &lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>; i_global++)</div>
<div class="line"><a name="l04866"></a><span class="lineno"> 4866</span>&#160;      {</div>
<div class="line"><a name="l04867"></a><span class="lineno"> 4867</span>&#160;        nnz[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>] += matrix_data_map[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][i_global].size();</div>
<div class="line"><a name="l04868"></a><span class="lineno"> 4868</span>&#160;      }</div>
<div class="line"><a name="l04869"></a><span class="lineno"> 4869</span>&#160; </div>
<div class="line"><a name="l04870"></a><span class="lineno"> 4870</span>&#160;      <span class="comment">// and then resize the storage</span></div>
<div class="line"><a name="l04871"></a><span class="lineno"> 4871</span>&#160;      column_or_row_index[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>] = <span class="keyword">new</span> <span class="keywordtype">int</span>[nnz[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>]];</div>
<div class="line"><a name="l04872"></a><span class="lineno"> 4872</span>&#160;      <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>] = <span class="keyword">new</span> <span class="keywordtype">double</span>[nnz[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>]];</div>
<div class="line"><a name="l04873"></a><span class="lineno"> 4873</span>&#160; </div>
<div class="line"><a name="l04874"></a><span class="lineno"> 4874</span>&#160;      <span class="comment">// Now we merely loop over the number of rows or columns</span></div>
<div class="line"><a name="l04875"></a><span class="lineno"> 4875</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i_global = 0; i_global &lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>; i_global++)</div>
<div class="line"><a name="l04876"></a><span class="lineno"> 4876</span>&#160;      {</div>
<div class="line"><a name="l04877"></a><span class="lineno"> 4877</span>&#160;        <span class="comment">// Start index for the present row</span></div>
<div class="line"><a name="l04878"></a><span class="lineno"> 4878</span>&#160;        row_or_column_start[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][i_global] = entry_count;</div>
<div class="line"><a name="l04879"></a><span class="lineno"> 4879</span>&#160;        <span class="comment">// If there are no entries in the map then skip the rest of the loop</span></div>
<div class="line"><a name="l04880"></a><span class="lineno"> 4880</span>&#160;        <span class="keywordflow">if</span> (matrix_data_map[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][i_global].empty())</div>
<div class="line"><a name="l04881"></a><span class="lineno"> 4881</span>&#160;        {</div>
<div class="line"><a name="l04882"></a><span class="lineno"> 4882</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04883"></a><span class="lineno"> 4883</span>&#160;        }</div>
<div class="line"><a name="l04884"></a><span class="lineno"> 4884</span>&#160; </div>
<div class="line"><a name="l04885"></a><span class="lineno"> 4885</span>&#160;        <span class="comment">// Loop over all the entries in the map corresponding to the given</span></div>
<div class="line"><a name="l04886"></a><span class="lineno"> 4886</span>&#160;        <span class="comment">// row or column. It will be ordered</span></div>
<div class="line"><a name="l04887"></a><span class="lineno"> 4887</span>&#160; </div>
<div class="line"><a name="l04888"></a><span class="lineno"> 4888</span>&#160;        <span class="keywordflow">for</span> (std::map&lt;unsigned, double&gt;::iterator it =</div>
<div class="line"><a name="l04889"></a><span class="lineno"> 4889</span>&#160;               matrix_data_map[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][i_global].begin();</div>
<div class="line"><a name="l04890"></a><span class="lineno"> 4890</span>&#160;             it != matrix_data_map[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][i_global].end();</div>
<div class="line"><a name="l04891"></a><span class="lineno"> 4891</span>&#160;             ++it)</div>
<div class="line"><a name="l04892"></a><span class="lineno"> 4892</span>&#160;        {</div>
<div class="line"><a name="l04893"></a><span class="lineno"> 4893</span>&#160;          <span class="comment">// The first value is the column or row index</span></div>
<div class="line"><a name="l04894"></a><span class="lineno"> 4894</span>&#160;          column_or_row_index[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][entry_count] = it-&gt;first;</div>
<div class="line"><a name="l04895"></a><span class="lineno"> 4895</span>&#160;          <span class="comment">// The second value is the actual data value</span></div>
<div class="line"><a name="l04896"></a><span class="lineno"> 4896</span>&#160;          <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][entry_count] = it-&gt;second;</div>
<div class="line"><a name="l04897"></a><span class="lineno"> 4897</span>&#160;          <span class="comment">// Increase the value of the counter</span></div>
<div class="line"><a name="l04898"></a><span class="lineno"> 4898</span>&#160;          entry_count++;</div>
<div class="line"><a name="l04899"></a><span class="lineno"> 4899</span>&#160;        }</div>
<div class="line"><a name="l04900"></a><span class="lineno"> 4900</span>&#160;      }</div>
<div class="line"><a name="l04901"></a><span class="lineno"> 4901</span>&#160; </div>
<div class="line"><a name="l04902"></a><span class="lineno"> 4902</span>&#160;      <span class="comment">// Final entry in the row/column start vector</span></div>
<div class="line"><a name="l04903"></a><span class="lineno"> 4903</span>&#160;      row_or_column_start[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>] = entry_count;</div>
<div class="line"><a name="l04904"></a><span class="lineno"> 4904</span>&#160;    } <span class="comment">// End of the loop over the matrices</span></div>
<div class="line"><a name="l04905"></a><span class="lineno"> 4905</span>&#160; </div>
<div class="line"><a name="l04906"></a><span class="lineno"> 4906</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aedefa8337ace6043c2fdfd5a2d19afd3">Pause_at_end_of_sparse_assembly</a>)</div>
<div class="line"><a name="l04907"></a><span class="lineno"> 4907</span>&#160;    {</div>
<div class="line"><a name="l04908"></a><span class="lineno"> 4908</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Pausing at end of sparse assembly.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l04909"></a><span class="lineno"> 4909</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#a4a82243b0ce4c28469a290fe2d7cd2c4">pause</a>(<span class="stringliteral">&quot;Check memory usage now.&quot;</span>);</div>
<div class="line"><a name="l04910"></a><span class="lineno"> 4910</span>&#160;    }</div>
<div class="line"><a name="l04911"></a><span class="lineno"> 4911</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>, <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">oomph::Mesh::element_pt()</a>, <a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a94d28e2de2559cde803d1ba2195b5290">oomph::AssemblyHandler::eqn_number()</a>, <a class="el" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">boost::multiprecision::fabs()</a>, <a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a67093ef481c51d384606486c41002baa">oomph::AssemblyHandler::get_all_vectors_and_matrices()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt()</a>, <a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a670b34aab05bfe0b96d0e0fabf583c7a">oomph::OomphCommunicator::my_rank()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof()</a>, <a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a09213be8f4aa009e0366460a7ed78e68">oomph::AssemblyHandler::ndof()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">oomph::Mesh::nelement()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad1a1ffc2bd685377ce7213452876b127">Numerical_zero_for_sparse_assembly</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#a4a82243b0ce4c28469a290fe2d7cd2c4">oomph::pause()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aedefa8337ace6043c2fdfd5a2d19afd3">Pause_at_end_of_sparse_assembly</a>, <a class="el" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">oomph::TimingHelpers::timer()</a>, <a class="el" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a>, and <a class="el" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">Eigen::value</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab9cdd18180be05e4d46bfdbc1acbdbd3">sparse_assemble_row_or_column_compressed()</a>.</p>

</div>
</div>
<a id="a23465a0b1944a4bd31b9e0add9cc9875"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23465a0b1944a4bd31b9e0add9cc9875">&#9670;&nbsp;</a></span>sparse_assemble_row_or_column_compressed_with_two_arrays()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::sparse_assemble_row_or_column_compressed_with_two_arrays </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>column_or_row_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>row_or_column_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>nnz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>residuals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>compressed_row_flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Private helper function that is used to assemble the Jacobian matrix in the case when the storage is row or column compressed. The boolean Flag indicates if we want compressed row format (true) or compressed column. This version uses lists</p>
<p>This is a (private) helper function that is used to assemble system matrices in compressed row or column format and compute residual vectors using two vectors. The default action is to assemble the jacobian matrix and residuals for the Newton method. The action can be overloaded at an elemental level by chaging the default behaviour of the function Element::get_all_vectors_and_matrices(). column_or_row_index: Column [or row] index of given entry row_or_column_start: Index of first entry for given row [or column] value : Vector of nonzero entries residuals : Residual vector compressed_row_flag: Bool flag to indicate if storage format is compressed row [if false interpretation of arguments is as stated in square brackets]. </p>
<div class="fragment"><div class="line"><a name="l06068"></a><span class="lineno"> 6068</span>&#160;  {</div>
<div class="line"><a name="l06069"></a><span class="lineno"> 6069</span>&#160;    <span class="comment">// Total number of elements</span></div>
<div class="line"><a name="l06070"></a><span class="lineno"> 6070</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n_elements = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>()-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">nelement</a>();</div>
<div class="line"><a name="l06071"></a><span class="lineno"> 6071</span>&#160; </div>
<div class="line"><a name="l06072"></a><span class="lineno"> 6072</span>&#160;    <span class="comment">// Default range of elements for distributed problems</span></div>
<div class="line"><a name="l06073"></a><span class="lineno"> 6073</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> el_lo = 0;</div>
<div class="line"><a name="l06074"></a><span class="lineno"> 6074</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> el_hi = n_elements - 1;</div>
<div class="line"><a name="l06075"></a><span class="lineno"> 6075</span>&#160; </div>
<div class="line"><a name="l06076"></a><span class="lineno"> 6076</span>&#160; </div>
<div class="line"><a name="l06077"></a><span class="lineno"> 6077</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l06078"></a><span class="lineno"> 6078</span>&#160;    <span class="comment">// Otherwise just loop over a fraction of the elements</span></div>
<div class="line"><a name="l06079"></a><span class="lineno"> 6079</span>&#160;    <span class="comment">// (This will either have been initialised in</span></div>
<div class="line"><a name="l06080"></a><span class="lineno"> 6080</span>&#160;    <span class="comment">// Problem::set_default_first_and_last_element_for_assembly() or</span></div>
<div class="line"><a name="l06081"></a><span class="lineno"> 6081</span>&#160;    <span class="comment">// will have been re-assigned during a previous assembly loop</span></div>
<div class="line"><a name="l06082"></a><span class="lineno"> 6082</span>&#160;    <span class="comment">// Note that following the re-assignment only the entries</span></div>
<div class="line"><a name="l06083"></a><span class="lineno"> 6083</span>&#160;    <span class="comment">// for the current processor are relevant.</span></div>
<div class="line"><a name="l06084"></a><span class="lineno"> 6084</span>&#160;    <span class="keywordflow">if</span> (!Problem_has_been_distributed)</div>
<div class="line"><a name="l06085"></a><span class="lineno"> 6085</span>&#160;    {</div>
<div class="line"><a name="l06086"></a><span class="lineno"> 6086</span>&#160;      el_lo = First_el_for_assembly[<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>-&gt;<a class="code" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a670b34aab05bfe0b96d0e0fabf583c7a">my_rank</a>()];</div>
<div class="line"><a name="l06087"></a><span class="lineno"> 6087</span>&#160;      el_hi = Last_el_plus_one_for_assembly[<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>-&gt;<a class="code" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a670b34aab05bfe0b96d0e0fabf583c7a">my_rank</a>()] - 1;</div>
<div class="line"><a name="l06088"></a><span class="lineno"> 6088</span>&#160;    }</div>
<div class="line"><a name="l06089"></a><span class="lineno"> 6089</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l06090"></a><span class="lineno"> 6090</span>&#160; </div>
<div class="line"><a name="l06091"></a><span class="lineno"> 6091</span>&#160;    <span class="comment">// number of local eqns</span></div>
<div class="line"><a name="l06092"></a><span class="lineno"> 6092</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a> = this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>();</div>
<div class="line"><a name="l06093"></a><span class="lineno"> 6093</span>&#160; </div>
<div class="line"><a name="l06094"></a><span class="lineno"> 6094</span>&#160;    <span class="comment">// Find the number of vectors to be assembled</span></div>
<div class="line"><a name="l06095"></a><span class="lineno"> 6095</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_vector = residuals.size();</div>
<div class="line"><a name="l06096"></a><span class="lineno"> 6096</span>&#160; </div>
<div class="line"><a name="l06097"></a><span class="lineno"> 6097</span>&#160;    <span class="comment">// Find the number of matrices to be assembled</span></div>
<div class="line"><a name="l06098"></a><span class="lineno"> 6098</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_matrix = column_or_row_index.size();</div>
<div class="line"><a name="l06099"></a><span class="lineno"> 6099</span>&#160; </div>
<div class="line"><a name="l06100"></a><span class="lineno"> 6100</span>&#160;    <span class="comment">// Locally cache pointer to assembly handler</span></div>
<div class="line"><a name="l06101"></a><span class="lineno"> 6101</span>&#160;    AssemblyHandler* <span class="keyword">const</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a> = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>;</div>
<div class="line"><a name="l06102"></a><span class="lineno"> 6102</span>&#160; </div>
<div class="line"><a name="l06103"></a><span class="lineno"> 6103</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l06104"></a><span class="lineno"> 6104</span>&#160;    <span class="keywordtype">bool</span> doing_residuals = <span class="keyword">false</span>;</div>
<div class="line"><a name="l06105"></a><span class="lineno"> 6105</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">dynamic_cast&lt;</span>ParallelResidualsHandler*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>) != 0)</div>
<div class="line"><a name="l06106"></a><span class="lineno"> 6106</span>&#160;    {</div>
<div class="line"><a name="l06107"></a><span class="lineno"> 6107</span>&#160;      doing_residuals = <span class="keyword">true</span>;</div>
<div class="line"><a name="l06108"></a><span class="lineno"> 6108</span>&#160;    }</div>
<div class="line"><a name="l06109"></a><span class="lineno"> 6109</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l06110"></a><span class="lineno"> 6110</span>&#160; </div>
<div class="line"><a name="l06111"></a><span class="lineno"> 6111</span>&#160;<span class="comment">// Error check dimensions</span></div>
<div class="line"><a name="l06112"></a><span class="lineno"> 6112</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l06113"></a><span class="lineno"> 6113</span>&#160;    <span class="keywordflow">if</span> (row_or_column_start.size() != n_matrix)</div>
<div class="line"><a name="l06114"></a><span class="lineno"> 6114</span>&#160;    {</div>
<div class="line"><a name="l06115"></a><span class="lineno"> 6115</span>&#160;      std::ostringstream error_stream;</div>
<div class="line"><a name="l06116"></a><span class="lineno"> 6116</span>&#160;      error_stream &lt;&lt; <span class="stringliteral">&quot;Error: &quot;</span> &lt;&lt; std::endl</div>
<div class="line"><a name="l06117"></a><span class="lineno"> 6117</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;row_or_column_start.size() &quot;</span></div>
<div class="line"><a name="l06118"></a><span class="lineno"> 6118</span>&#160;                   &lt;&lt; row_or_column_start.size() &lt;&lt; <span class="stringliteral">&quot; does not equal &quot;</span></div>
<div class="line"><a name="l06119"></a><span class="lineno"> 6119</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;column_or_row_index.size() &quot;</span></div>
<div class="line"><a name="l06120"></a><span class="lineno"> 6120</span>&#160;                   &lt;&lt; column_or_row_index.size() &lt;&lt; std::endl;</div>
<div class="line"><a name="l06121"></a><span class="lineno"> 6121</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l06122"></a><span class="lineno"> 6122</span>&#160;        error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l06123"></a><span class="lineno"> 6123</span>&#160;    }</div>
<div class="line"><a name="l06124"></a><span class="lineno"> 6124</span>&#160; </div>
<div class="line"><a name="l06125"></a><span class="lineno"> 6125</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>.size() != n_matrix)</div>
<div class="line"><a name="l06126"></a><span class="lineno"> 6126</span>&#160;    {</div>
<div class="line"><a name="l06127"></a><span class="lineno"> 6127</span>&#160;      std::ostringstream error_stream;</div>
<div class="line"><a name="l06128"></a><span class="lineno"> 6128</span>&#160;      error_stream &lt;&lt; <span class="stringliteral">&quot;Error: &quot;</span> &lt;&lt; std::endl</div>
<div class="line"><a name="l06129"></a><span class="lineno"> 6129</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;value.size() &quot;</span> &lt;&lt; <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>.size() &lt;&lt; <span class="stringliteral">&quot; does not equal &quot;</span></div>
<div class="line"><a name="l06130"></a><span class="lineno"> 6130</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;column_or_row_index.size() &quot;</span></div>
<div class="line"><a name="l06131"></a><span class="lineno"> 6131</span>&#160;                   &lt;&lt; column_or_row_index.size() &lt;&lt; std::endl</div>
<div class="line"><a name="l06132"></a><span class="lineno"> 6132</span>&#160;                   &lt;&lt; std::endl</div>
<div class="line"><a name="l06133"></a><span class="lineno"> 6133</span>&#160;                   &lt;&lt; std::endl;</div>
<div class="line"><a name="l06134"></a><span class="lineno"> 6134</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l06135"></a><span class="lineno"> 6135</span>&#160;        error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l06136"></a><span class="lineno"> 6136</span>&#160;    }</div>
<div class="line"><a name="l06137"></a><span class="lineno"> 6137</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l06138"></a><span class="lineno"> 6138</span>&#160; </div>
<div class="line"><a name="l06139"></a><span class="lineno"> 6139</span>&#160;    <span class="comment">// The idea behind this sparse assembly routine is to use Vectors of</span></div>
<div class="line"><a name="l06140"></a><span class="lineno"> 6140</span>&#160;    <span class="comment">// Vectors for the entries in each complete matrix. And a second</span></div>
<div class="line"><a name="l06141"></a><span class="lineno"> 6141</span>&#160;    <span class="comment">// Vector of Vectors stores the global row (or column) indeces. This</span></div>
<div class="line"><a name="l06142"></a><span class="lineno"> 6142</span>&#160;    <span class="comment">// will not have the memory overheads associated with the methods using</span></div>
<div class="line"><a name="l06143"></a><span class="lineno"> 6143</span>&#160;    <span class="comment">// lists or maps, but insertion will be more costly.</span></div>
<div class="line"><a name="l06144"></a><span class="lineno"> 6144</span>&#160; </div>
<div class="line"><a name="l06145"></a><span class="lineno"> 6145</span>&#160;    <span class="comment">// Set up two vector of vectors to store the entries of each  matrix,</span></div>
<div class="line"><a name="l06146"></a><span class="lineno"> 6146</span>&#160;    <span class="comment">// indexed by either the column or row. The entries of the vector for</span></div>
<div class="line"><a name="l06147"></a><span class="lineno"> 6147</span>&#160;    <span class="comment">// each matrix correspond to all the rows or columns of that matrix.</span></div>
<div class="line"><a name="l06148"></a><span class="lineno"> 6148</span>&#160;    Vector&lt;unsigned**&gt; matrix_row_or_col_indices(n_matrix);</div>
<div class="line"><a name="l06149"></a><span class="lineno"> 6149</span>&#160;    Vector&lt;double**&gt; matrix_values(n_matrix);</div>
<div class="line"><a name="l06150"></a><span class="lineno"> 6150</span>&#160; </div>
<div class="line"><a name="l06151"></a><span class="lineno"> 6151</span>&#160;    <span class="comment">// Loop over the number of matrices being assembled and resize</span></div>
<div class="line"><a name="l06152"></a><span class="lineno"> 6152</span>&#160;    <span class="comment">// each vector of vectors to the number of rows or columns of the matrix</span></div>
<div class="line"><a name="l06153"></a><span class="lineno"> 6153</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> = 0; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> &lt; n_matrix; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>++)</div>
<div class="line"><a name="l06154"></a><span class="lineno"> 6154</span>&#160;    {</div>
<div class="line"><a name="l06155"></a><span class="lineno"> 6155</span>&#160;      matrix_row_or_col_indices[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>] = <span class="keyword">new</span> <span class="keywordtype">unsigned</span>*[<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>];</div>
<div class="line"><a name="l06156"></a><span class="lineno"> 6156</span>&#160;      matrix_values[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>] = <span class="keyword">new</span> <span class="keywordtype">double</span>*[<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>];</div>
<div class="line"><a name="l06157"></a><span class="lineno"> 6157</span>&#160;    }</div>
<div class="line"><a name="l06158"></a><span class="lineno"> 6158</span>&#160; </div>
<div class="line"><a name="l06159"></a><span class="lineno"> 6159</span>&#160;    <span class="comment">// Resize the residuals vectors</span></div>
<div class="line"><a name="l06160"></a><span class="lineno"> 6160</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a> = 0; <a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a> &lt; n_vector; <a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a>++)</div>
<div class="line"><a name="l06161"></a><span class="lineno"> 6161</span>&#160;    {</div>
<div class="line"><a name="l06162"></a><span class="lineno"> 6162</span>&#160;      residuals[<a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a>] = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>];</div>
<div class="line"><a name="l06163"></a><span class="lineno"> 6163</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l06164"></a><span class="lineno"> 6164</span>&#160;      {</div>
<div class="line"><a name="l06165"></a><span class="lineno"> 6165</span>&#160;        residuals[<a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a>][<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = 0;</div>
<div class="line"><a name="l06166"></a><span class="lineno"> 6166</span>&#160;      }</div>
<div class="line"><a name="l06167"></a><span class="lineno"> 6167</span>&#160;    }</div>
<div class="line"><a name="l06168"></a><span class="lineno"> 6168</span>&#160; </div>
<div class="line"><a name="l06169"></a><span class="lineno"> 6169</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l06170"></a><span class="lineno"> 6170</span>&#160; </div>
<div class="line"><a name="l06171"></a><span class="lineno"> 6171</span>&#160;    <span class="comment">// Storage for assembly time for elements</span></div>
<div class="line"><a name="l06172"></a><span class="lineno"> 6172</span>&#160;    <span class="keywordtype">double</span> t_assemble_start = 0.0;</div>
<div class="line"><a name="l06173"></a><span class="lineno"> 6173</span>&#160; </div>
<div class="line"><a name="l06174"></a><span class="lineno"> 6174</span>&#160;    <span class="comment">// Storage for assembly times</span></div>
<div class="line"><a name="l06175"></a><span class="lineno"> 6175</span>&#160;    <span class="keywordflow">if</span> ((!doing_residuals) &amp;&amp; Must_recompute_load_balance_for_assembly)</div>
<div class="line"><a name="l06176"></a><span class="lineno"> 6176</span>&#160;    {</div>
<div class="line"><a name="l06177"></a><span class="lineno"> 6177</span>&#160;      Elemental_assembly_time.resize(n_elements);</div>
<div class="line"><a name="l06178"></a><span class="lineno"> 6178</span>&#160;    }</div>
<div class="line"><a name="l06179"></a><span class="lineno"> 6179</span>&#160; </div>
<div class="line"><a name="l06180"></a><span class="lineno"> 6180</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l06181"></a><span class="lineno"> 6181</span>&#160; </div>
<div class="line"><a name="l06182"></a><span class="lineno"> 6182</span>&#160;    <span class="comment">// number of coefficients in each row</span></div>
<div class="line"><a name="l06183"></a><span class="lineno"> 6183</span>&#160;    Vector&lt;Vector&lt;unsigned&gt;&gt; ncoef(n_matrix);</div>
<div class="line"><a name="l06184"></a><span class="lineno"> 6184</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> = 0; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> &lt; n_matrix; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>++)</div>
<div class="line"><a name="l06185"></a><span class="lineno"> 6185</span>&#160;    {</div>
<div class="line"><a name="l06186"></a><span class="lineno"> 6186</span>&#160;      ncoef[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>].resize(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>, 0);</div>
<div class="line"><a name="l06187"></a><span class="lineno"> 6187</span>&#160;    }</div>
<div class="line"><a name="l06188"></a><span class="lineno"> 6188</span>&#160; </div>
<div class="line"><a name="l06189"></a><span class="lineno"> 6189</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a547c85bfa6a2eb3effc4db1b46ebcdde">Sparse_assemble_with_arrays_previous_allocation</a>.size() == 0)</div>
<div class="line"><a name="l06190"></a><span class="lineno"> 6190</span>&#160;    {</div>
<div class="line"><a name="l06191"></a><span class="lineno"> 6191</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a547c85bfa6a2eb3effc4db1b46ebcdde">Sparse_assemble_with_arrays_previous_allocation</a>.resize(n_matrix);</div>
<div class="line"><a name="l06192"></a><span class="lineno"> 6192</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> = 0; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> &lt; n_matrix; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>++)</div>
<div class="line"><a name="l06193"></a><span class="lineno"> 6193</span>&#160;      {</div>
<div class="line"><a name="l06194"></a><span class="lineno"> 6194</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a547c85bfa6a2eb3effc4db1b46ebcdde">Sparse_assemble_with_arrays_previous_allocation</a>[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>].resize(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>, 0);</div>
<div class="line"><a name="l06195"></a><span class="lineno"> 6195</span>&#160;      }</div>
<div class="line"><a name="l06196"></a><span class="lineno"> 6196</span>&#160;    }</div>
<div class="line"><a name="l06197"></a><span class="lineno"> 6197</span>&#160; </div>
<div class="line"><a name="l06198"></a><span class="lineno"> 6198</span>&#160;    <span class="comment">//----------------Assemble and populate the vector storage scheme-------</span></div>
<div class="line"><a name="l06199"></a><span class="lineno"> 6199</span>&#160;    {</div>
<div class="line"><a name="l06200"></a><span class="lineno"> 6200</span>&#160;      <span class="comment">// Allocate local storage for the element&#39;s contribution to the</span></div>
<div class="line"><a name="l06201"></a><span class="lineno"> 6201</span>&#160;      <span class="comment">// residuals vectors and system matrices of the size of the maximum</span></div>
<div class="line"><a name="l06202"></a><span class="lineno"> 6202</span>&#160;      <span class="comment">// number of dofs in any element</span></div>
<div class="line"><a name="l06203"></a><span class="lineno"> 6203</span>&#160;      <span class="comment">// This means that the storage will only be allocated (and deleted) once</span></div>
<div class="line"><a name="l06204"></a><span class="lineno"> 6204</span>&#160;      Vector&lt;Vector&lt;double&gt;&gt; el_residuals(n_vector);</div>
<div class="line"><a name="l06205"></a><span class="lineno"> 6205</span>&#160;      Vector&lt;DenseMatrix&lt;double&gt;&gt; el_jacobian(n_matrix);</div>
<div class="line"><a name="l06206"></a><span class="lineno"> 6206</span>&#160; </div>
<div class="line"><a name="l06207"></a><span class="lineno"> 6207</span>&#160;      <span class="comment">// Loop over the elements</span></div>
<div class="line"><a name="l06208"></a><span class="lineno"> 6208</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = el_lo; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt;= el_hi; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l06209"></a><span class="lineno"> 6209</span>&#160;      {</div>
<div class="line"><a name="l06210"></a><span class="lineno"> 6210</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l06211"></a><span class="lineno"> 6211</span>&#160;        <span class="comment">// Time it?</span></div>
<div class="line"><a name="l06212"></a><span class="lineno"> 6212</span>&#160;        <span class="keywordflow">if</span> ((!doing_residuals) &amp;&amp; Must_recompute_load_balance_for_assembly)</div>
<div class="line"><a name="l06213"></a><span class="lineno"> 6213</span>&#160;        {</div>
<div class="line"><a name="l06214"></a><span class="lineno"> 6214</span>&#160;          t_assemble_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l06215"></a><span class="lineno"> 6215</span>&#160;        }</div>
<div class="line"><a name="l06216"></a><span class="lineno"> 6216</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l06217"></a><span class="lineno"> 6217</span>&#160; </div>
<div class="line"><a name="l06218"></a><span class="lineno"> 6218</span>&#160;        <span class="comment">// Get the pointer to the element</span></div>
<div class="line"><a name="l06219"></a><span class="lineno"> 6219</span>&#160;        GeneralisedElement* elem_pt = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>()-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">element_pt</a>(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>);</div>
<div class="line"><a name="l06220"></a><span class="lineno"> 6220</span>&#160; </div>
<div class="line"><a name="l06221"></a><span class="lineno"> 6221</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l06222"></a><span class="lineno"> 6222</span>&#160;        <span class="comment">// Ignore halo elements</span></div>
<div class="line"><a name="l06223"></a><span class="lineno"> 6223</span>&#160;        <span class="keywordflow">if</span> (!elem_pt-&gt;is_halo())</div>
<div class="line"><a name="l06224"></a><span class="lineno"> 6224</span>&#160;        {</div>
<div class="line"><a name="l06225"></a><span class="lineno"> 6225</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l06226"></a><span class="lineno"> 6226</span>&#160; </div>
<div class="line"><a name="l06227"></a><span class="lineno"> 6227</span>&#160;          <span class="comment">// Find number of degrees of freedom in the element</span></div>
<div class="line"><a name="l06228"></a><span class="lineno"> 6228</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> nvar = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>-&gt;<a class="code" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a09213be8f4aa009e0366460a7ed78e68">ndof</a>(elem_pt);</div>
<div class="line"><a name="l06229"></a><span class="lineno"> 6229</span>&#160; </div>
<div class="line"><a name="l06230"></a><span class="lineno"> 6230</span>&#160;          <span class="comment">// Resize the storage for elemental jacobian and residuals</span></div>
<div class="line"><a name="l06231"></a><span class="lineno"> 6231</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a> = 0; <a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a> &lt; n_vector; <a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a>++)</div>
<div class="line"><a name="l06232"></a><span class="lineno"> 6232</span>&#160;          {</div>
<div class="line"><a name="l06233"></a><span class="lineno"> 6233</span>&#160;            el_residuals[<a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a>].resize(nvar);</div>
<div class="line"><a name="l06234"></a><span class="lineno"> 6234</span>&#160;          }</div>
<div class="line"><a name="l06235"></a><span class="lineno"> 6235</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> = 0; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> &lt; n_matrix; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>++)</div>
<div class="line"><a name="l06236"></a><span class="lineno"> 6236</span>&#160;          {</div>
<div class="line"><a name="l06237"></a><span class="lineno"> 6237</span>&#160;            el_jacobian[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>].resize(nvar);</div>
<div class="line"><a name="l06238"></a><span class="lineno"> 6238</span>&#160;          }</div>
<div class="line"><a name="l06239"></a><span class="lineno"> 6239</span>&#160; </div>
<div class="line"><a name="l06240"></a><span class="lineno"> 6240</span>&#160;          <span class="comment">// Now get the residuals and jacobian for the element</span></div>
<div class="line"><a name="l06241"></a><span class="lineno"> 6241</span>&#160;          <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>-&gt;<a class="code" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a67093ef481c51d384606486c41002baa">get_all_vectors_and_matrices</a>(</div>
<div class="line"><a name="l06242"></a><span class="lineno"> 6242</span>&#160;            elem_pt, el_residuals, el_jacobian);</div>
<div class="line"><a name="l06243"></a><span class="lineno"> 6243</span>&#160; </div>
<div class="line"><a name="l06244"></a><span class="lineno"> 6244</span>&#160;          <span class="comment">//---------------Insert the values into the vectors--------------</span></div>
<div class="line"><a name="l06245"></a><span class="lineno"> 6245</span>&#160; </div>
<div class="line"><a name="l06246"></a><span class="lineno"> 6246</span>&#160;          <span class="comment">// Loop over the first index of local variables</span></div>
<div class="line"><a name="l06247"></a><span class="lineno"> 6247</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; nvar; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l06248"></a><span class="lineno"> 6248</span>&#160;          {</div>
<div class="line"><a name="l06249"></a><span class="lineno"> 6249</span>&#160;            <span class="comment">// Get the local equation number</span></div>
<div class="line"><a name="l06250"></a><span class="lineno"> 6250</span>&#160;            <span class="keywordtype">unsigned</span> eqn_number = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>-&gt;<a class="code" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a94d28e2de2559cde803d1ba2195b5290">eqn_number</a>(elem_pt, <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l06251"></a><span class="lineno"> 6251</span>&#160; </div>
<div class="line"><a name="l06252"></a><span class="lineno"> 6252</span>&#160;            <span class="comment">// Add the contribution to the residuals</span></div>
<div class="line"><a name="l06253"></a><span class="lineno"> 6253</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a> = 0; <a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a> &lt; n_vector; <a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a>++)</div>
<div class="line"><a name="l06254"></a><span class="lineno"> 6254</span>&#160;            {</div>
<div class="line"><a name="l06255"></a><span class="lineno"> 6255</span>&#160;              <span class="comment">// Fill in each residuals vector</span></div>
<div class="line"><a name="l06256"></a><span class="lineno"> 6256</span>&#160;              residuals[<a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a>][eqn_number] += el_residuals[<a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a>][<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l06257"></a><span class="lineno"> 6257</span>&#160;            }</div>
<div class="line"><a name="l06258"></a><span class="lineno"> 6258</span>&#160; </div>
<div class="line"><a name="l06259"></a><span class="lineno"> 6259</span>&#160;            <span class="comment">// Now loop over the other index</span></div>
<div class="line"><a name="l06260"></a><span class="lineno"> 6260</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; nvar; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l06261"></a><span class="lineno"> 6261</span>&#160;            {</div>
<div class="line"><a name="l06262"></a><span class="lineno"> 6262</span>&#160;              <span class="comment">// Get the number of the unknown</span></div>
<div class="line"><a name="l06263"></a><span class="lineno"> 6263</span>&#160;              <span class="keywordtype">unsigned</span> unknown = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>-&gt;<a class="code" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a94d28e2de2559cde803d1ba2195b5290">eqn_number</a>(elem_pt, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l06264"></a><span class="lineno"> 6264</span>&#160; </div>
<div class="line"><a name="l06265"></a><span class="lineno"> 6265</span>&#160;              <span class="comment">// Loop over the matrices</span></div>
<div class="line"><a name="l06266"></a><span class="lineno"> 6266</span>&#160;              <span class="comment">// If it&#39;s compressed row storage, then our vector of maps</span></div>
<div class="line"><a name="l06267"></a><span class="lineno"> 6267</span>&#160;              <span class="comment">// is indexed by row (equation number)</span></div>
<div class="line"><a name="l06268"></a><span class="lineno"> 6268</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> = 0; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> &lt; n_matrix; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>++)</div>
<div class="line"><a name="l06269"></a><span class="lineno"> 6269</span>&#160;              {</div>
<div class="line"><a name="l06270"></a><span class="lineno"> 6270</span>&#160;                <span class="comment">// Get the value of the matrix at this point</span></div>
<div class="line"><a name="l06271"></a><span class="lineno"> 6271</span>&#160;                <span class="keywordtype">double</span> <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a> = el_jacobian[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>](<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l06272"></a><span class="lineno"> 6272</span>&#160;                <span class="comment">// Only bother to add to the vector if it&#39;s non-zero</span></div>
<div class="line"><a name="l06273"></a><span class="lineno"> 6273</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">std::fabs</a>(<a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>) &gt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad1a1ffc2bd685377ce7213452876b127">Numerical_zero_for_sparse_assembly</a>)</div>
<div class="line"><a name="l06274"></a><span class="lineno"> 6274</span>&#160;                {</div>
<div class="line"><a name="l06275"></a><span class="lineno"> 6275</span>&#160;                  <span class="comment">// number of entrys in this row</span></div>
<div class="line"><a name="l06276"></a><span class="lineno"> 6276</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a> = ncoef[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][eqn_number];</div>
<div class="line"><a name="l06277"></a><span class="lineno"> 6277</span>&#160; </div>
<div class="line"><a name="l06278"></a><span class="lineno"> 6278</span>&#160;                  <span class="comment">// if no data has been allocated for this row then allocate</span></div>
<div class="line"><a name="l06279"></a><span class="lineno"> 6279</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a> == 0)</div>
<div class="line"><a name="l06280"></a><span class="lineno"> 6280</span>&#160;                  {</div>
<div class="line"><a name="l06281"></a><span class="lineno"> 6281</span>&#160;                    <span class="comment">// do we have previous allocation data</span></div>
<div class="line"><a name="l06282"></a><span class="lineno"> 6282</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a547c85bfa6a2eb3effc4db1b46ebcdde">Sparse_assemble_with_arrays_previous_allocation</a></div>
<div class="line"><a name="l06283"></a><span class="lineno"> 6283</span>&#160;                          [<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][eqn_number] != 0)</div>
<div class="line"><a name="l06284"></a><span class="lineno"> 6284</span>&#160;                    {</div>
<div class="line"><a name="l06285"></a><span class="lineno"> 6285</span>&#160;                      matrix_row_or_col_indices[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][eqn_number] = <span class="keyword">new</span> <span class="keywordtype">unsigned</span></div>
<div class="line"><a name="l06286"></a><span class="lineno"> 6286</span>&#160;                        [<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a547c85bfa6a2eb3effc4db1b46ebcdde">Sparse_assemble_with_arrays_previous_allocation</a></div>
<div class="line"><a name="l06287"></a><span class="lineno"> 6287</span>&#160;                           [<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][eqn_number]];</div>
<div class="line"><a name="l06288"></a><span class="lineno"> 6288</span>&#160;                      matrix_values[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][eqn_number] = <span class="keyword">new</span> <span class="keywordtype">double</span></div>
<div class="line"><a name="l06289"></a><span class="lineno"> 6289</span>&#160;                        [<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a547c85bfa6a2eb3effc4db1b46ebcdde">Sparse_assemble_with_arrays_previous_allocation</a></div>
<div class="line"><a name="l06290"></a><span class="lineno"> 6290</span>&#160;                           [<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][eqn_number]];</div>
<div class="line"><a name="l06291"></a><span class="lineno"> 6291</span>&#160;                    }</div>
<div class="line"><a name="l06292"></a><span class="lineno"> 6292</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l06293"></a><span class="lineno"> 6293</span>&#160;                    {</div>
<div class="line"><a name="l06294"></a><span class="lineno"> 6294</span>&#160;                      matrix_row_or_col_indices[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][eqn_number] = <span class="keyword">new</span> <span class="keywordtype">unsigned</span></div>
<div class="line"><a name="l06295"></a><span class="lineno"> 6295</span>&#160;                        [<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad2d5f8e18619fafcff11727b1c55b3eb">Sparse_assemble_with_arrays_initial_allocation</a>];</div>
<div class="line"><a name="l06296"></a><span class="lineno"> 6296</span>&#160;                      matrix_values[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][eqn_number] = <span class="keyword">new</span> <span class="keywordtype">double</span></div>
<div class="line"><a name="l06297"></a><span class="lineno"> 6297</span>&#160;                        [<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad2d5f8e18619fafcff11727b1c55b3eb">Sparse_assemble_with_arrays_initial_allocation</a>];</div>
<div class="line"><a name="l06298"></a><span class="lineno"> 6298</span>&#160;                      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a547c85bfa6a2eb3effc4db1b46ebcdde">Sparse_assemble_with_arrays_previous_allocation</a></div>
<div class="line"><a name="l06299"></a><span class="lineno"> 6299</span>&#160;                        [<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][eqn_number] =</div>
<div class="line"><a name="l06300"></a><span class="lineno"> 6300</span>&#160;                          <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad2d5f8e18619fafcff11727b1c55b3eb">Sparse_assemble_with_arrays_initial_allocation</a>;</div>
<div class="line"><a name="l06301"></a><span class="lineno"> 6301</span>&#160;                    }</div>
<div class="line"><a name="l06302"></a><span class="lineno"> 6302</span>&#160;                  }</div>
<div class="line"><a name="l06303"></a><span class="lineno"> 6303</span>&#160; </div>
<div class="line"><a name="l06304"></a><span class="lineno"> 6304</span>&#160;                  <span class="comment">// If it&#39;s compressed row storage, then our vector of maps</span></div>
<div class="line"><a name="l06305"></a><span class="lineno"> 6305</span>&#160;                  <span class="comment">// is indexed by row (equation number)</span></div>
<div class="line"><a name="l06306"></a><span class="lineno"> 6306</span>&#160;                  <span class="keywordflow">if</span> (compressed_row_flag)</div>
<div class="line"><a name="l06307"></a><span class="lineno"> 6307</span>&#160;                  {</div>
<div class="line"><a name="l06308"></a><span class="lineno"> 6308</span>&#160;                    <span class="comment">// next add the data</span></div>
<div class="line"><a name="l06309"></a><span class="lineno"> 6309</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> = 0; <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> &lt;= <a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>; <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>++)</div>
<div class="line"><a name="l06310"></a><span class="lineno"> 6310</span>&#160;                    {</div>
<div class="line"><a name="l06311"></a><span class="lineno"> 6311</span>&#160;                      <span class="keywordflow">if</span> (<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> == <a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>)</div>
<div class="line"><a name="l06312"></a><span class="lineno"> 6312</span>&#160;                      {</div>
<div class="line"><a name="l06313"></a><span class="lineno"> 6313</span>&#160;                        <span class="comment">// do we need to allocate more storage</span></div>
<div class="line"><a name="l06314"></a><span class="lineno"> 6314</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a547c85bfa6a2eb3effc4db1b46ebcdde">Sparse_assemble_with_arrays_previous_allocation</a></div>
<div class="line"><a name="l06315"></a><span class="lineno"> 6315</span>&#160;                              [<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][eqn_number] == ncoef[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][eqn_number])</div>
<div class="line"><a name="l06316"></a><span class="lineno"> 6316</span>&#160;                        {</div>
<div class="line"><a name="l06317"></a><span class="lineno"> 6317</span>&#160;                          <span class="keywordtype">unsigned</span> new_allocation =</div>
<div class="line"><a name="l06318"></a><span class="lineno"> 6318</span>&#160;                            ncoef[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][eqn_number] +</div>
<div class="line"><a name="l06319"></a><span class="lineno"> 6319</span>&#160;                            <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aeb58a3cead4d10697c4471523f705130">Sparse_assemble_with_arrays_allocation_increment</a>;</div>
<div class="line"><a name="l06320"></a><span class="lineno"> 6320</span>&#160;                          <span class="keywordtype">double</span>* new_values = <span class="keyword">new</span> <span class="keywordtype">double</span>[new_allocation];</div>
<div class="line"><a name="l06321"></a><span class="lineno"> 6321</span>&#160;                          <span class="keywordtype">unsigned</span>* new_indices = <span class="keyword">new</span> <span class="keywordtype">unsigned</span>[new_allocation];</div>
<div class="line"><a name="l06322"></a><span class="lineno"> 6322</span>&#160;                          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a> = 0; <a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a> &lt; ncoef[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][eqn_number]; <a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>++)</div>
<div class="line"><a name="l06323"></a><span class="lineno"> 6323</span>&#160;                          {</div>
<div class="line"><a name="l06324"></a><span class="lineno"> 6324</span>&#160;                            new_values[<a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>] = matrix_values[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][eqn_number][<a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>];</div>
<div class="line"><a name="l06325"></a><span class="lineno"> 6325</span>&#160;                            new_indices[<a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>] =</div>
<div class="line"><a name="l06326"></a><span class="lineno"> 6326</span>&#160;                              matrix_row_or_col_indices[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][eqn_number][<a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>];</div>
<div class="line"><a name="l06327"></a><span class="lineno"> 6327</span>&#160;                          }</div>
<div class="line"><a name="l06328"></a><span class="lineno"> 6328</span>&#160;                          <span class="keyword">delete</span>[] matrix_values[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][eqn_number];</div>
<div class="line"><a name="l06329"></a><span class="lineno"> 6329</span>&#160;                          <span class="keyword">delete</span>[] matrix_row_or_col_indices[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][eqn_number];</div>
<div class="line"><a name="l06330"></a><span class="lineno"> 6330</span>&#160;                          matrix_values[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][eqn_number] = new_values;</div>
<div class="line"><a name="l06331"></a><span class="lineno"> 6331</span>&#160;                          matrix_row_or_col_indices[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][eqn_number] =</div>
<div class="line"><a name="l06332"></a><span class="lineno"> 6332</span>&#160;                            new_indices;</div>
<div class="line"><a name="l06333"></a><span class="lineno"> 6333</span>&#160;                          <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a547c85bfa6a2eb3effc4db1b46ebcdde">Sparse_assemble_with_arrays_previous_allocation</a></div>
<div class="line"><a name="l06334"></a><span class="lineno"> 6334</span>&#160;                            [<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][eqn_number] = new_allocation;</div>
<div class="line"><a name="l06335"></a><span class="lineno"> 6335</span>&#160;                        }</div>
<div class="line"><a name="l06336"></a><span class="lineno"> 6336</span>&#160;                        <span class="comment">// and now add the data</span></div>
<div class="line"><a name="l06337"></a><span class="lineno"> 6337</span>&#160;                        <span class="keywordtype">unsigned</span> entry = ncoef[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][eqn_number];</div>
<div class="line"><a name="l06338"></a><span class="lineno"> 6338</span>&#160;                        ncoef[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][eqn_number]++;</div>
<div class="line"><a name="l06339"></a><span class="lineno"> 6339</span>&#160;                        matrix_row_or_col_indices[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][eqn_number][entry] =</div>
<div class="line"><a name="l06340"></a><span class="lineno"> 6340</span>&#160;                          unknown;</div>
<div class="line"><a name="l06341"></a><span class="lineno"> 6341</span>&#160;                        matrix_values[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][eqn_number][entry] = <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>;</div>
<div class="line"><a name="l06342"></a><span class="lineno"> 6342</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06343"></a><span class="lineno"> 6343</span>&#160;                      }</div>
<div class="line"><a name="l06344"></a><span class="lineno"> 6344</span>&#160;                      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (matrix_row_or_col_indices[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][eqn_number][<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>] ==</div>
<div class="line"><a name="l06345"></a><span class="lineno"> 6345</span>&#160;                               unknown)</div>
<div class="line"><a name="l06346"></a><span class="lineno"> 6346</span>&#160;                      {</div>
<div class="line"><a name="l06347"></a><span class="lineno"> 6347</span>&#160;                        matrix_values[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][eqn_number][<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>] += <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>;</div>
<div class="line"><a name="l06348"></a><span class="lineno"> 6348</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06349"></a><span class="lineno"> 6349</span>&#160;                      }</div>
<div class="line"><a name="l06350"></a><span class="lineno"> 6350</span>&#160;                    }</div>
<div class="line"><a name="l06351"></a><span class="lineno"> 6351</span>&#160;                  }</div>
<div class="line"><a name="l06352"></a><span class="lineno"> 6352</span>&#160;                  <span class="comment">// Otherwise it&#39;s compressed column storage and our vector is</span></div>
<div class="line"><a name="l06353"></a><span class="lineno"> 6353</span>&#160;                  <span class="comment">// indexed by column (the unknown)</span></div>
<div class="line"><a name="l06354"></a><span class="lineno"> 6354</span>&#160;                  <span class="keywordflow">else</span></div>
<div class="line"><a name="l06355"></a><span class="lineno"> 6355</span>&#160;                  {</div>
<div class="line"><a name="l06356"></a><span class="lineno"> 6356</span>&#160;                    <span class="comment">// Add the data into the vectors in the correct position</span></div>
<div class="line"><a name="l06357"></a><span class="lineno"> 6357</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> = 0; <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> &lt;= <a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>; <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>++)</div>
<div class="line"><a name="l06358"></a><span class="lineno"> 6358</span>&#160;                    {</div>
<div class="line"><a name="l06359"></a><span class="lineno"> 6359</span>&#160;                      <span class="keywordflow">if</span> (<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> == <a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>)</div>
<div class="line"><a name="l06360"></a><span class="lineno"> 6360</span>&#160;                      {</div>
<div class="line"><a name="l06361"></a><span class="lineno"> 6361</span>&#160;                        <span class="comment">// do we need to allocate more storage</span></div>
<div class="line"><a name="l06362"></a><span class="lineno"> 6362</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a547c85bfa6a2eb3effc4db1b46ebcdde">Sparse_assemble_with_arrays_previous_allocation</a></div>
<div class="line"><a name="l06363"></a><span class="lineno"> 6363</span>&#160;                              [<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][unknown] == ncoef[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][unknown])</div>
<div class="line"><a name="l06364"></a><span class="lineno"> 6364</span>&#160;                        {</div>
<div class="line"><a name="l06365"></a><span class="lineno"> 6365</span>&#160;                          <span class="keywordtype">unsigned</span> new_allocation =</div>
<div class="line"><a name="l06366"></a><span class="lineno"> 6366</span>&#160;                            ncoef[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][unknown] +</div>
<div class="line"><a name="l06367"></a><span class="lineno"> 6367</span>&#160;                            <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aeb58a3cead4d10697c4471523f705130">Sparse_assemble_with_arrays_allocation_increment</a>;</div>
<div class="line"><a name="l06368"></a><span class="lineno"> 6368</span>&#160;                          <span class="keywordtype">double</span>* new_values = <span class="keyword">new</span> <span class="keywordtype">double</span>[new_allocation];</div>
<div class="line"><a name="l06369"></a><span class="lineno"> 6369</span>&#160;                          <span class="keywordtype">unsigned</span>* new_indices = <span class="keyword">new</span> <span class="keywordtype">unsigned</span>[new_allocation];</div>
<div class="line"><a name="l06370"></a><span class="lineno"> 6370</span>&#160;                          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a> = 0; <a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a> &lt; ncoef[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][unknown]; <a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>++)</div>
<div class="line"><a name="l06371"></a><span class="lineno"> 6371</span>&#160;                          {</div>
<div class="line"><a name="l06372"></a><span class="lineno"> 6372</span>&#160;                            new_values[<a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>] = matrix_values[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][unknown][<a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>];</div>
<div class="line"><a name="l06373"></a><span class="lineno"> 6373</span>&#160;                            new_indices[<a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>] =</div>
<div class="line"><a name="l06374"></a><span class="lineno"> 6374</span>&#160;                              matrix_row_or_col_indices[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][unknown][<a class="code" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">c</a>];</div>
<div class="line"><a name="l06375"></a><span class="lineno"> 6375</span>&#160;                          }</div>
<div class="line"><a name="l06376"></a><span class="lineno"> 6376</span>&#160;                          <span class="keyword">delete</span>[] matrix_values[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][unknown];</div>
<div class="line"><a name="l06377"></a><span class="lineno"> 6377</span>&#160;                          <span class="keyword">delete</span>[] matrix_row_or_col_indices[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][unknown];</div>
<div class="line"><a name="l06378"></a><span class="lineno"> 6378</span>&#160;                          <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a547c85bfa6a2eb3effc4db1b46ebcdde">Sparse_assemble_with_arrays_previous_allocation</a></div>
<div class="line"><a name="l06379"></a><span class="lineno"> 6379</span>&#160;                            [<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][unknown] = new_allocation;</div>
<div class="line"><a name="l06380"></a><span class="lineno"> 6380</span>&#160;                        }</div>
<div class="line"><a name="l06381"></a><span class="lineno"> 6381</span>&#160;                        <span class="comment">// and now add the data</span></div>
<div class="line"><a name="l06382"></a><span class="lineno"> 6382</span>&#160;                        <span class="keywordtype">unsigned</span> entry = ncoef[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][unknown];</div>
<div class="line"><a name="l06383"></a><span class="lineno"> 6383</span>&#160;                        ncoef[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][unknown]++;</div>
<div class="line"><a name="l06384"></a><span class="lineno"> 6384</span>&#160;                        matrix_row_or_col_indices[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][unknown][entry] =</div>
<div class="line"><a name="l06385"></a><span class="lineno"> 6385</span>&#160;                          eqn_number;</div>
<div class="line"><a name="l06386"></a><span class="lineno"> 6386</span>&#160;                        matrix_values[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][unknown][entry] = <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>;</div>
<div class="line"><a name="l06387"></a><span class="lineno"> 6387</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06388"></a><span class="lineno"> 6388</span>&#160;                      }</div>
<div class="line"><a name="l06389"></a><span class="lineno"> 6389</span>&#160;                      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (matrix_row_or_col_indices[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][unknown][<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>] ==</div>
<div class="line"><a name="l06390"></a><span class="lineno"> 6390</span>&#160;                               eqn_number)</div>
<div class="line"><a name="l06391"></a><span class="lineno"> 6391</span>&#160;                      {</div>
<div class="line"><a name="l06392"></a><span class="lineno"> 6392</span>&#160;                        matrix_values[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][unknown][<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>] += <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>;</div>
<div class="line"><a name="l06393"></a><span class="lineno"> 6393</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06394"></a><span class="lineno"> 6394</span>&#160;                      }</div>
<div class="line"><a name="l06395"></a><span class="lineno"> 6395</span>&#160;                    }</div>
<div class="line"><a name="l06396"></a><span class="lineno"> 6396</span>&#160;                  }</div>
<div class="line"><a name="l06397"></a><span class="lineno"> 6397</span>&#160;                }</div>
<div class="line"><a name="l06398"></a><span class="lineno"> 6398</span>&#160;              } <span class="comment">// End of loop over matrices</span></div>
<div class="line"><a name="l06399"></a><span class="lineno"> 6399</span>&#160;            }</div>
<div class="line"><a name="l06400"></a><span class="lineno"> 6400</span>&#160;          }</div>
<div class="line"><a name="l06401"></a><span class="lineno"> 6401</span>&#160; </div>
<div class="line"><a name="l06402"></a><span class="lineno"> 6402</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l06403"></a><span class="lineno"> 6403</span>&#160;        } <span class="comment">// endif halo element</span></div>
<div class="line"><a name="l06404"></a><span class="lineno"> 6404</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l06405"></a><span class="lineno"> 6405</span>&#160; </div>
<div class="line"><a name="l06406"></a><span class="lineno"> 6406</span>&#160; </div>
<div class="line"><a name="l06407"></a><span class="lineno"> 6407</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l06408"></a><span class="lineno"> 6408</span>&#160;        <span class="comment">// Time it?</span></div>
<div class="line"><a name="l06409"></a><span class="lineno"> 6409</span>&#160;        <span class="keywordflow">if</span> ((!doing_residuals) &amp;&amp; Must_recompute_load_balance_for_assembly)</div>
<div class="line"><a name="l06410"></a><span class="lineno"> 6410</span>&#160;        {</div>
<div class="line"><a name="l06411"></a><span class="lineno"> 6411</span>&#160;          Elemental_assembly_time[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>] =</div>
<div class="line"><a name="l06412"></a><span class="lineno"> 6412</span>&#160;            <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>() - t_assemble_start;</div>
<div class="line"><a name="l06413"></a><span class="lineno"> 6413</span>&#160;        }</div>
<div class="line"><a name="l06414"></a><span class="lineno"> 6414</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l06415"></a><span class="lineno"> 6415</span>&#160; </div>
<div class="line"><a name="l06416"></a><span class="lineno"> 6416</span>&#160;      } <span class="comment">// End of loop over the elements</span></div>
<div class="line"><a name="l06417"></a><span class="lineno"> 6417</span>&#160; </div>
<div class="line"><a name="l06418"></a><span class="lineno"> 6418</span>&#160;    } <span class="comment">// End of vector assembly</span></div>
<div class="line"><a name="l06419"></a><span class="lineno"> 6419</span>&#160; </div>
<div class="line"><a name="l06420"></a><span class="lineno"> 6420</span>&#160; </div>
<div class="line"><a name="l06421"></a><span class="lineno"> 6421</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l06422"></a><span class="lineno"> 6422</span>&#160; </div>
<div class="line"><a name="l06423"></a><span class="lineno"> 6423</span>&#160;    <span class="comment">// Postprocess timing information and re-allocate distribution of</span></div>
<div class="line"><a name="l06424"></a><span class="lineno"> 6424</span>&#160;    <span class="comment">// elements during subsequent assemblies.</span></div>
<div class="line"><a name="l06425"></a><span class="lineno"> 6425</span>&#160;    <span class="keywordflow">if</span> ((!doing_residuals) &amp;&amp; (!Problem_has_been_distributed) &amp;&amp;</div>
<div class="line"><a name="l06426"></a><span class="lineno"> 6426</span>&#160;        Must_recompute_load_balance_for_assembly)</div>
<div class="line"><a name="l06427"></a><span class="lineno"> 6427</span>&#160;    {</div>
<div class="line"><a name="l06428"></a><span class="lineno"> 6428</span>&#160;      recompute_load_balanced_assembly();</div>
<div class="line"><a name="l06429"></a><span class="lineno"> 6429</span>&#160;    }</div>
<div class="line"><a name="l06430"></a><span class="lineno"> 6430</span>&#160; </div>
<div class="line"><a name="l06431"></a><span class="lineno"> 6431</span>&#160;    <span class="comment">// We have determined load balancing for current setup.</span></div>
<div class="line"><a name="l06432"></a><span class="lineno"> 6432</span>&#160;    <span class="comment">// This can remain the same until assign_eqn_numbers() is called</span></div>
<div class="line"><a name="l06433"></a><span class="lineno"> 6433</span>&#160;    <span class="comment">// again -- the flag is re-set to true there.</span></div>
<div class="line"><a name="l06434"></a><span class="lineno"> 6434</span>&#160;    <span class="keywordflow">if</span> ((!doing_residuals) &amp;&amp; Must_recompute_load_balance_for_assembly)</div>
<div class="line"><a name="l06435"></a><span class="lineno"> 6435</span>&#160;    {</div>
<div class="line"><a name="l06436"></a><span class="lineno"> 6436</span>&#160;      Must_recompute_load_balance_for_assembly = <span class="keyword">false</span>;</div>
<div class="line"><a name="l06437"></a><span class="lineno"> 6437</span>&#160;    }</div>
<div class="line"><a name="l06438"></a><span class="lineno"> 6438</span>&#160; </div>
<div class="line"><a name="l06439"></a><span class="lineno"> 6439</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l06440"></a><span class="lineno"> 6440</span>&#160; </div>
<div class="line"><a name="l06441"></a><span class="lineno"> 6441</span>&#160;    <span class="comment">//-----------Finally we need to convert this lousy vector storage scheme</span></div>
<div class="line"><a name="l06442"></a><span class="lineno"> 6442</span>&#160;    <span class="comment">//------------------------to the containers required by SuperLU</span></div>
<div class="line"><a name="l06443"></a><span class="lineno"> 6443</span>&#160; </div>
<div class="line"><a name="l06444"></a><span class="lineno"> 6444</span>&#160;    <span class="comment">// Loop over the number of matrices</span></div>
<div class="line"><a name="l06445"></a><span class="lineno"> 6445</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> = 0; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> &lt; n_matrix; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>++)</div>
<div class="line"><a name="l06446"></a><span class="lineno"> 6446</span>&#160;    {</div>
<div class="line"><a name="l06447"></a><span class="lineno"> 6447</span>&#160;      <span class="comment">// Set the number of rows or columns</span></div>
<div class="line"><a name="l06448"></a><span class="lineno"> 6448</span>&#160;      row_or_column_start[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>] = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a> + 1];</div>
<div class="line"><a name="l06449"></a><span class="lineno"> 6449</span>&#160; </div>
<div class="line"><a name="l06450"></a><span class="lineno"> 6450</span>&#160;      <span class="comment">// fill row_or_column_start and find the number of entries</span></div>
<div class="line"><a name="l06451"></a><span class="lineno"> 6451</span>&#160;      row_or_column_start[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][0] = 0;</div>
<div class="line"><a name="l06452"></a><span class="lineno"> 6452</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l06453"></a><span class="lineno"> 6453</span>&#160;      {</div>
<div class="line"><a name="l06454"></a><span class="lineno"> 6454</span>&#160;        row_or_column_start[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1] = row_or_column_start[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] + ncoef[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l06455"></a><span class="lineno"> 6455</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a547c85bfa6a2eb3effc4db1b46ebcdde">Sparse_assemble_with_arrays_previous_allocation</a>[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = ncoef[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l06456"></a><span class="lineno"> 6456</span>&#160;      }</div>
<div class="line"><a name="l06457"></a><span class="lineno"> 6457</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> entries = row_or_column_start[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>];</div>
<div class="line"><a name="l06458"></a><span class="lineno"> 6458</span>&#160; </div>
<div class="line"><a name="l06459"></a><span class="lineno"> 6459</span>&#160;      <span class="comment">// resize vectors</span></div>
<div class="line"><a name="l06460"></a><span class="lineno"> 6460</span>&#160;      column_or_row_index[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>] = <span class="keyword">new</span> <span class="keywordtype">int</span>[entries];</div>
<div class="line"><a name="l06461"></a><span class="lineno"> 6461</span>&#160;      <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>] = <span class="keyword">new</span> <span class="keywordtype">double</span>[entries];</div>
<div class="line"><a name="l06462"></a><span class="lineno"> 6462</span>&#160;      nnz[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>] = entries;</div>
<div class="line"><a name="l06463"></a><span class="lineno"> 6463</span>&#160; </div>
<div class="line"><a name="l06464"></a><span class="lineno"> 6464</span>&#160;      <span class="comment">// Now we merely loop over the number of rows or columns</span></div>
<div class="line"><a name="l06465"></a><span class="lineno"> 6465</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i_global = 0; i_global &lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>; i_global++)</div>
<div class="line"><a name="l06466"></a><span class="lineno"> 6466</span>&#160;      {</div>
<div class="line"><a name="l06467"></a><span class="lineno"> 6467</span>&#160;        <span class="comment">// If there are no entries in the vector then skip the rest of the loop</span></div>
<div class="line"><a name="l06468"></a><span class="lineno"> 6468</span>&#160;        <span class="keywordflow">if</span> (ncoef[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][i_global] == 0)</div>
<div class="line"><a name="l06469"></a><span class="lineno"> 6469</span>&#160;        {</div>
<div class="line"><a name="l06470"></a><span class="lineno"> 6470</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l06471"></a><span class="lineno"> 6471</span>&#160;        }</div>
<div class="line"><a name="l06472"></a><span class="lineno"> 6472</span>&#160; </div>
<div class="line"><a name="l06473"></a><span class="lineno"> 6473</span>&#160;        <span class="comment">// Loop over all the entries in the vectors corresponding to the given</span></div>
<div class="line"><a name="l06474"></a><span class="lineno"> 6474</span>&#160;        <span class="comment">// row or column. It will NOT be ordered</span></div>
<div class="line"><a name="l06475"></a><span class="lineno"> 6475</span>&#160;        <span class="keywordtype">unsigned</span> <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> = 0;</div>
<div class="line"><a name="l06476"></a><span class="lineno"> 6476</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = row_or_column_start[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][i_global];</div>
<div class="line"><a name="l06477"></a><span class="lineno"> 6477</span>&#160;             <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; row_or_column_start[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][i_global + 1];</div>
<div class="line"><a name="l06478"></a><span class="lineno"> 6478</span>&#160;             <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l06479"></a><span class="lineno"> 6479</span>&#160;        {</div>
<div class="line"><a name="l06480"></a><span class="lineno"> 6480</span>&#160;          column_or_row_index[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>] = matrix_row_or_col_indices[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][i_global][<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>];</div>
<div class="line"><a name="l06481"></a><span class="lineno"> 6481</span>&#160;          <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>] = matrix_values[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][i_global][<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>];</div>
<div class="line"><a name="l06482"></a><span class="lineno"> 6482</span>&#160;          ++<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>;</div>
<div class="line"><a name="l06483"></a><span class="lineno"> 6483</span>&#160;        }</div>
<div class="line"><a name="l06484"></a><span class="lineno"> 6484</span>&#160; </div>
<div class="line"><a name="l06485"></a><span class="lineno"> 6485</span>&#160;        <span class="comment">// and delete</span></div>
<div class="line"><a name="l06486"></a><span class="lineno"> 6486</span>&#160;        <span class="keyword">delete</span>[] matrix_row_or_col_indices[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][i_global];</div>
<div class="line"><a name="l06487"></a><span class="lineno"> 6487</span>&#160;        <span class="keyword">delete</span>[] matrix_values[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][i_global];</div>
<div class="line"><a name="l06488"></a><span class="lineno"> 6488</span>&#160;      }</div>
<div class="line"><a name="l06489"></a><span class="lineno"> 6489</span>&#160; </div>
<div class="line"><a name="l06490"></a><span class="lineno"> 6490</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l06491"></a><span class="lineno"> 6491</span>&#160;      <span class="keyword">delete</span>[] matrix_row_or_col_indices[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>];</div>
<div class="line"><a name="l06492"></a><span class="lineno"> 6492</span>&#160;      <span class="keyword">delete</span>[] matrix_values[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>];</div>
<div class="line"><a name="l06493"></a><span class="lineno"> 6493</span>&#160;    } <span class="comment">// End of the loop over the matrices</span></div>
<div class="line"><a name="l06494"></a><span class="lineno"> 6494</span>&#160; </div>
<div class="line"><a name="l06495"></a><span class="lineno"> 6495</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aedefa8337ace6043c2fdfd5a2d19afd3">Pause_at_end_of_sparse_assembly</a>)</div>
<div class="line"><a name="l06496"></a><span class="lineno"> 6496</span>&#160;    {</div>
<div class="line"><a name="l06497"></a><span class="lineno"> 6497</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Pausing at end of sparse assembly.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l06498"></a><span class="lineno"> 6498</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#a4a82243b0ce4c28469a290fe2d7cd2c4">pause</a>(<span class="stringliteral">&quot;Check memory usage now.&quot;</span>);</div>
<div class="line"><a name="l06499"></a><span class="lineno"> 6499</span>&#160;    }</div>
<div class="line"><a name="l06500"></a><span class="lineno"> 6500</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt()</a>, <a class="el" href="../../d9/d33/namespacecalibrate.html#a1919e193275bfcb62d1e5b79a3aea213">calibrate::c</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>, <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">oomph::Mesh::element_pt()</a>, <a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a94d28e2de2559cde803d1ba2195b5290">oomph::AssemblyHandler::eqn_number()</a>, <a class="el" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">boost::multiprecision::fabs()</a>, <a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a67093ef481c51d384606486c41002baa">oomph::AssemblyHandler::get_all_vectors_and_matrices()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>, <a class="el" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt()</a>, <a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a670b34aab05bfe0b96d0e0fabf583c7a">oomph::OomphCommunicator::my_rank()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof()</a>, <a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a09213be8f4aa009e0366460a7ed78e68">oomph::AssemblyHandler::ndof()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">oomph::Mesh::nelement()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad1a1ffc2bd685377ce7213452876b127">Numerical_zero_for_sparse_assembly</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, <a class="el" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#a4a82243b0ce4c28469a290fe2d7cd2c4">oomph::pause()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aedefa8337ace6043c2fdfd5a2d19afd3">Pause_at_end_of_sparse_assembly</a>, <a class="el" href="../../db/ddc/benchVecAdd_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aeb58a3cead4d10697c4471523f705130">Sparse_assemble_with_arrays_allocation_increment</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad2d5f8e18619fafcff11727b1c55b3eb">Sparse_assemble_with_arrays_initial_allocation</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a547c85bfa6a2eb3effc4db1b46ebcdde">Sparse_assemble_with_arrays_previous_allocation</a>, <a class="el" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">oomph::TimingHelpers::timer()</a>, <a class="el" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a>, and <a class="el" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">Eigen::value</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab9cdd18180be05e4d46bfdbc1acbdbd3">sparse_assemble_row_or_column_compressed()</a>.</p>

</div>
</div>
<a id="a5bc761a0dee39437b2ebeba75079856f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5bc761a0dee39437b2ebeba75079856f">&#9670;&nbsp;</a></span>sparse_assemble_row_or_column_compressed_with_two_vectors()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::sparse_assemble_row_or_column_compressed_with_two_vectors </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>column_or_row_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>row_or_column_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>nnz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>residuals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>compressed_row_flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Private helper function that is used to assemble the Jacobian matrix in the case when the storage is row or column compressed. The boolean Flag indicates if we want compressed row format (true) or compressed column. This version uses two vectors.</p>
<p>This is a (private) helper function that is used to assemble system matrices in compressed row or column format and compute residual vectors using two vectors. The default action is to assemble the jacobian matrix and residuals for the Newton method. The action can be overloaded at an elemental level by chaging the default behaviour of the function Element::get_all_vectors_and_matrices(). column_or_row_index: Column [or row] index of given entry row_or_column_start: Index of first entry for given row [or column] value : Vector of nonzero entries residuals : Residual vector compressed_row_flag: Bool flag to indicate if storage format is compressed row [if false interpretation of arguments is as stated in square brackets]. </p>
<div class="fragment"><div class="line"><a name="l05705"></a><span class="lineno"> 5705</span>&#160;  {</div>
<div class="line"><a name="l05706"></a><span class="lineno"> 5706</span>&#160;    <span class="comment">// Total number of elements</span></div>
<div class="line"><a name="l05707"></a><span class="lineno"> 5707</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n_elements = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>()-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">nelement</a>();</div>
<div class="line"><a name="l05708"></a><span class="lineno"> 5708</span>&#160; </div>
<div class="line"><a name="l05709"></a><span class="lineno"> 5709</span>&#160;    <span class="comment">// Default range of elements for distributed problems</span></div>
<div class="line"><a name="l05710"></a><span class="lineno"> 5710</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> el_lo = 0;</div>
<div class="line"><a name="l05711"></a><span class="lineno"> 5711</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> el_hi = n_elements - 1;</div>
<div class="line"><a name="l05712"></a><span class="lineno"> 5712</span>&#160; </div>
<div class="line"><a name="l05713"></a><span class="lineno"> 5713</span>&#160; </div>
<div class="line"><a name="l05714"></a><span class="lineno"> 5714</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l05715"></a><span class="lineno"> 5715</span>&#160;    <span class="comment">// Otherwise just loop over a fraction of the elements</span></div>
<div class="line"><a name="l05716"></a><span class="lineno"> 5716</span>&#160;    <span class="comment">// (This will either have been initialised in</span></div>
<div class="line"><a name="l05717"></a><span class="lineno"> 5717</span>&#160;    <span class="comment">// Problem::set_default_first_and_last_element_for_assembly() or</span></div>
<div class="line"><a name="l05718"></a><span class="lineno"> 5718</span>&#160;    <span class="comment">// will have been re-assigned during a previous assembly loop</span></div>
<div class="line"><a name="l05719"></a><span class="lineno"> 5719</span>&#160;    <span class="comment">// Note that following the re-assignment only the entries</span></div>
<div class="line"><a name="l05720"></a><span class="lineno"> 5720</span>&#160;    <span class="comment">// for the current processor are relevant.</span></div>
<div class="line"><a name="l05721"></a><span class="lineno"> 5721</span>&#160;    <span class="keywordflow">if</span> (!Problem_has_been_distributed)</div>
<div class="line"><a name="l05722"></a><span class="lineno"> 5722</span>&#160;    {</div>
<div class="line"><a name="l05723"></a><span class="lineno"> 5723</span>&#160;      el_lo = First_el_for_assembly[<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>-&gt;<a class="code" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a670b34aab05bfe0b96d0e0fabf583c7a">my_rank</a>()];</div>
<div class="line"><a name="l05724"></a><span class="lineno"> 5724</span>&#160;      el_hi = Last_el_plus_one_for_assembly[<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>-&gt;<a class="code" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a670b34aab05bfe0b96d0e0fabf583c7a">my_rank</a>()] - 1;</div>
<div class="line"><a name="l05725"></a><span class="lineno"> 5725</span>&#160;    }</div>
<div class="line"><a name="l05726"></a><span class="lineno"> 5726</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l05727"></a><span class="lineno"> 5727</span>&#160; </div>
<div class="line"><a name="l05728"></a><span class="lineno"> 5728</span>&#160;    <span class="comment">// number of local eqns</span></div>
<div class="line"><a name="l05729"></a><span class="lineno"> 5729</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a> = this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>();</div>
<div class="line"><a name="l05730"></a><span class="lineno"> 5730</span>&#160; </div>
<div class="line"><a name="l05731"></a><span class="lineno"> 5731</span>&#160;    <span class="comment">// Find the number of vectors to be assembled</span></div>
<div class="line"><a name="l05732"></a><span class="lineno"> 5732</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_vector = residuals.size();</div>
<div class="line"><a name="l05733"></a><span class="lineno"> 5733</span>&#160; </div>
<div class="line"><a name="l05734"></a><span class="lineno"> 5734</span>&#160;    <span class="comment">// Find the number of matrices to be assembled</span></div>
<div class="line"><a name="l05735"></a><span class="lineno"> 5735</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_matrix = column_or_row_index.size();</div>
<div class="line"><a name="l05736"></a><span class="lineno"> 5736</span>&#160; </div>
<div class="line"><a name="l05737"></a><span class="lineno"> 5737</span>&#160;    <span class="comment">// Locally cache pointer to assembly handler</span></div>
<div class="line"><a name="l05738"></a><span class="lineno"> 5738</span>&#160;    AssemblyHandler* <span class="keyword">const</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a> = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>;</div>
<div class="line"><a name="l05739"></a><span class="lineno"> 5739</span>&#160; </div>
<div class="line"><a name="l05740"></a><span class="lineno"> 5740</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l05741"></a><span class="lineno"> 5741</span>&#160;    <span class="keywordtype">bool</span> doing_residuals = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05742"></a><span class="lineno"> 5742</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">dynamic_cast&lt;</span>ParallelResidualsHandler*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>) != 0)</div>
<div class="line"><a name="l05743"></a><span class="lineno"> 5743</span>&#160;    {</div>
<div class="line"><a name="l05744"></a><span class="lineno"> 5744</span>&#160;      doing_residuals = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05745"></a><span class="lineno"> 5745</span>&#160;    }</div>
<div class="line"><a name="l05746"></a><span class="lineno"> 5746</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l05747"></a><span class="lineno"> 5747</span>&#160; </div>
<div class="line"><a name="l05748"></a><span class="lineno"> 5748</span>&#160;<span class="comment">// Error check dimensions</span></div>
<div class="line"><a name="l05749"></a><span class="lineno"> 5749</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l05750"></a><span class="lineno"> 5750</span>&#160;    <span class="keywordflow">if</span> (row_or_column_start.size() != n_matrix)</div>
<div class="line"><a name="l05751"></a><span class="lineno"> 5751</span>&#160;    {</div>
<div class="line"><a name="l05752"></a><span class="lineno"> 5752</span>&#160;      std::ostringstream error_stream;</div>
<div class="line"><a name="l05753"></a><span class="lineno"> 5753</span>&#160;      error_stream &lt;&lt; <span class="stringliteral">&quot;Error: &quot;</span> &lt;&lt; std::endl</div>
<div class="line"><a name="l05754"></a><span class="lineno"> 5754</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;row_or_column_start.size() &quot;</span></div>
<div class="line"><a name="l05755"></a><span class="lineno"> 5755</span>&#160;                   &lt;&lt; row_or_column_start.size() &lt;&lt; <span class="stringliteral">&quot; does not equal &quot;</span></div>
<div class="line"><a name="l05756"></a><span class="lineno"> 5756</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;column_or_row_index.size() &quot;</span></div>
<div class="line"><a name="l05757"></a><span class="lineno"> 5757</span>&#160;                   &lt;&lt; column_or_row_index.size() &lt;&lt; std::endl;</div>
<div class="line"><a name="l05758"></a><span class="lineno"> 5758</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l05759"></a><span class="lineno"> 5759</span>&#160;        error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l05760"></a><span class="lineno"> 5760</span>&#160;    }</div>
<div class="line"><a name="l05761"></a><span class="lineno"> 5761</span>&#160; </div>
<div class="line"><a name="l05762"></a><span class="lineno"> 5762</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>.size() != n_matrix)</div>
<div class="line"><a name="l05763"></a><span class="lineno"> 5763</span>&#160;    {</div>
<div class="line"><a name="l05764"></a><span class="lineno"> 5764</span>&#160;      std::ostringstream error_stream;</div>
<div class="line"><a name="l05765"></a><span class="lineno"> 5765</span>&#160;      error_stream &lt;&lt; <span class="stringliteral">&quot;Error: &quot;</span> &lt;&lt; std::endl</div>
<div class="line"><a name="l05766"></a><span class="lineno"> 5766</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;value.size() &quot;</span> &lt;&lt; <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>.size() &lt;&lt; <span class="stringliteral">&quot; does not equal &quot;</span></div>
<div class="line"><a name="l05767"></a><span class="lineno"> 5767</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;column_or_row_index.size() &quot;</span></div>
<div class="line"><a name="l05768"></a><span class="lineno"> 5768</span>&#160;                   &lt;&lt; column_or_row_index.size() &lt;&lt; std::endl</div>
<div class="line"><a name="l05769"></a><span class="lineno"> 5769</span>&#160;                   &lt;&lt; std::endl</div>
<div class="line"><a name="l05770"></a><span class="lineno"> 5770</span>&#160;                   &lt;&lt; std::endl;</div>
<div class="line"><a name="l05771"></a><span class="lineno"> 5771</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l05772"></a><span class="lineno"> 5772</span>&#160;        error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l05773"></a><span class="lineno"> 5773</span>&#160;    }</div>
<div class="line"><a name="l05774"></a><span class="lineno"> 5774</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l05775"></a><span class="lineno"> 5775</span>&#160; </div>
<div class="line"><a name="l05776"></a><span class="lineno"> 5776</span>&#160;    <span class="comment">// The idea behind this sparse assembly routine is to use Vectors of</span></div>
<div class="line"><a name="l05777"></a><span class="lineno"> 5777</span>&#160;    <span class="comment">// Vectors for the entries in each complete matrix. And a second</span></div>
<div class="line"><a name="l05778"></a><span class="lineno"> 5778</span>&#160;    <span class="comment">// Vector of Vectors stores the global row (or column) indeces. This</span></div>
<div class="line"><a name="l05779"></a><span class="lineno"> 5779</span>&#160;    <span class="comment">// will not have the memory overheads associated with the methods using</span></div>
<div class="line"><a name="l05780"></a><span class="lineno"> 5780</span>&#160;    <span class="comment">// lists or maps, but insertion will be more costly.</span></div>
<div class="line"><a name="l05781"></a><span class="lineno"> 5781</span>&#160; </div>
<div class="line"><a name="l05782"></a><span class="lineno"> 5782</span>&#160;    <span class="comment">// Set up two vector of vectors to store the entries of each  matrix,</span></div>
<div class="line"><a name="l05783"></a><span class="lineno"> 5783</span>&#160;    <span class="comment">// indexed by either the column or row. The entries of the vector for</span></div>
<div class="line"><a name="l05784"></a><span class="lineno"> 5784</span>&#160;    <span class="comment">// each matrix correspond to all the rows or columns of that matrix.</span></div>
<div class="line"><a name="l05785"></a><span class="lineno"> 5785</span>&#160;    Vector&lt;Vector&lt;Vector&lt;unsigned&gt;&gt;&gt; matrix_row_or_col_indices(n_matrix);</div>
<div class="line"><a name="l05786"></a><span class="lineno"> 5786</span>&#160;    Vector&lt;Vector&lt;Vector&lt;double&gt;&gt;&gt; matrix_values(n_matrix);</div>
<div class="line"><a name="l05787"></a><span class="lineno"> 5787</span>&#160; </div>
<div class="line"><a name="l05788"></a><span class="lineno"> 5788</span>&#160;    <span class="comment">// Loop over the number of matrices being assembled and resize</span></div>
<div class="line"><a name="l05789"></a><span class="lineno"> 5789</span>&#160;    <span class="comment">// each vector of vectors to the number of rows or columns of the matrix</span></div>
<div class="line"><a name="l05790"></a><span class="lineno"> 5790</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> = 0; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> &lt; n_matrix; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>++)</div>
<div class="line"><a name="l05791"></a><span class="lineno"> 5791</span>&#160;    {</div>
<div class="line"><a name="l05792"></a><span class="lineno"> 5792</span>&#160;      matrix_row_or_col_indices[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>].resize(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>);</div>
<div class="line"><a name="l05793"></a><span class="lineno"> 5793</span>&#160;      matrix_values[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>].resize(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>);</div>
<div class="line"><a name="l05794"></a><span class="lineno"> 5794</span>&#160;    }</div>
<div class="line"><a name="l05795"></a><span class="lineno"> 5795</span>&#160; </div>
<div class="line"><a name="l05796"></a><span class="lineno"> 5796</span>&#160;    <span class="comment">// Resize the residuals vectors</span></div>
<div class="line"><a name="l05797"></a><span class="lineno"> 5797</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a> = 0; <a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a> &lt; n_vector; <a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a>++)</div>
<div class="line"><a name="l05798"></a><span class="lineno"> 5798</span>&#160;    {</div>
<div class="line"><a name="l05799"></a><span class="lineno"> 5799</span>&#160;      residuals[<a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a>] = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>];</div>
<div class="line"><a name="l05800"></a><span class="lineno"> 5800</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l05801"></a><span class="lineno"> 5801</span>&#160;      {</div>
<div class="line"><a name="l05802"></a><span class="lineno"> 5802</span>&#160;        residuals[<a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a>][<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = 0;</div>
<div class="line"><a name="l05803"></a><span class="lineno"> 5803</span>&#160;      }</div>
<div class="line"><a name="l05804"></a><span class="lineno"> 5804</span>&#160;    }</div>
<div class="line"><a name="l05805"></a><span class="lineno"> 5805</span>&#160; </div>
<div class="line"><a name="l05806"></a><span class="lineno"> 5806</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l05807"></a><span class="lineno"> 5807</span>&#160; </div>
<div class="line"><a name="l05808"></a><span class="lineno"> 5808</span>&#160;    <span class="comment">// Storage for assembly time for elements</span></div>
<div class="line"><a name="l05809"></a><span class="lineno"> 5809</span>&#160;    <span class="keywordtype">double</span> t_assemble_start = 0.0;</div>
<div class="line"><a name="l05810"></a><span class="lineno"> 5810</span>&#160; </div>
<div class="line"><a name="l05811"></a><span class="lineno"> 5811</span>&#160;    <span class="comment">// Storage for assembly times</span></div>
<div class="line"><a name="l05812"></a><span class="lineno"> 5812</span>&#160;    <span class="keywordflow">if</span> ((!doing_residuals) &amp;&amp; Must_recompute_load_balance_for_assembly)</div>
<div class="line"><a name="l05813"></a><span class="lineno"> 5813</span>&#160;    {</div>
<div class="line"><a name="l05814"></a><span class="lineno"> 5814</span>&#160;      Elemental_assembly_time.resize(n_elements);</div>
<div class="line"><a name="l05815"></a><span class="lineno"> 5815</span>&#160;    }</div>
<div class="line"><a name="l05816"></a><span class="lineno"> 5816</span>&#160; </div>
<div class="line"><a name="l05817"></a><span class="lineno"> 5817</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l05818"></a><span class="lineno"> 5818</span>&#160; </div>
<div class="line"><a name="l05819"></a><span class="lineno"> 5819</span>&#160; </div>
<div class="line"><a name="l05820"></a><span class="lineno"> 5820</span>&#160;    <span class="comment">//----------------Assemble and populate the vector storage scheme-------</span></div>
<div class="line"><a name="l05821"></a><span class="lineno"> 5821</span>&#160;    {</div>
<div class="line"><a name="l05822"></a><span class="lineno"> 5822</span>&#160;      <span class="comment">// Allocate local storage for the element&#39;s contribution to the</span></div>
<div class="line"><a name="l05823"></a><span class="lineno"> 5823</span>&#160;      <span class="comment">// residuals vectors and system matrices of the size of the maximum</span></div>
<div class="line"><a name="l05824"></a><span class="lineno"> 5824</span>&#160;      <span class="comment">// number of dofs in any element</span></div>
<div class="line"><a name="l05825"></a><span class="lineno"> 5825</span>&#160;      <span class="comment">// This means that the storage will only be allocated (and deleted) once</span></div>
<div class="line"><a name="l05826"></a><span class="lineno"> 5826</span>&#160;      Vector&lt;Vector&lt;double&gt;&gt; el_residuals(n_vector);</div>
<div class="line"><a name="l05827"></a><span class="lineno"> 5827</span>&#160;      Vector&lt;DenseMatrix&lt;double&gt;&gt; el_jacobian(n_matrix);</div>
<div class="line"><a name="l05828"></a><span class="lineno"> 5828</span>&#160; </div>
<div class="line"><a name="l05829"></a><span class="lineno"> 5829</span>&#160;      <span class="comment">// Loop over the elements</span></div>
<div class="line"><a name="l05830"></a><span class="lineno"> 5830</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = el_lo; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt;= el_hi; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l05831"></a><span class="lineno"> 5831</span>&#160;      {</div>
<div class="line"><a name="l05832"></a><span class="lineno"> 5832</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l05833"></a><span class="lineno"> 5833</span>&#160;        <span class="comment">// Time it?</span></div>
<div class="line"><a name="l05834"></a><span class="lineno"> 5834</span>&#160;        <span class="keywordflow">if</span> ((!doing_residuals) &amp;&amp; Must_recompute_load_balance_for_assembly)</div>
<div class="line"><a name="l05835"></a><span class="lineno"> 5835</span>&#160;        {</div>
<div class="line"><a name="l05836"></a><span class="lineno"> 5836</span>&#160;          t_assemble_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l05837"></a><span class="lineno"> 5837</span>&#160;        }</div>
<div class="line"><a name="l05838"></a><span class="lineno"> 5838</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l05839"></a><span class="lineno"> 5839</span>&#160; </div>
<div class="line"><a name="l05840"></a><span class="lineno"> 5840</span>&#160;        <span class="comment">// Get the pointer to the element</span></div>
<div class="line"><a name="l05841"></a><span class="lineno"> 5841</span>&#160;        GeneralisedElement* elem_pt = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>()-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">element_pt</a>(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>);</div>
<div class="line"><a name="l05842"></a><span class="lineno"> 5842</span>&#160; </div>
<div class="line"><a name="l05843"></a><span class="lineno"> 5843</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l05844"></a><span class="lineno"> 5844</span>&#160;        <span class="comment">// Ignore halo elements</span></div>
<div class="line"><a name="l05845"></a><span class="lineno"> 5845</span>&#160;        <span class="keywordflow">if</span> (!elem_pt-&gt;is_halo())</div>
<div class="line"><a name="l05846"></a><span class="lineno"> 5846</span>&#160;        {</div>
<div class="line"><a name="l05847"></a><span class="lineno"> 5847</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l05848"></a><span class="lineno"> 5848</span>&#160; </div>
<div class="line"><a name="l05849"></a><span class="lineno"> 5849</span>&#160;          <span class="comment">// Find number of degrees of freedom in the element</span></div>
<div class="line"><a name="l05850"></a><span class="lineno"> 5850</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> nvar = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>-&gt;<a class="code" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a09213be8f4aa009e0366460a7ed78e68">ndof</a>(elem_pt);</div>
<div class="line"><a name="l05851"></a><span class="lineno"> 5851</span>&#160; </div>
<div class="line"><a name="l05852"></a><span class="lineno"> 5852</span>&#160;          <span class="comment">// Resize the storage for elemental jacobian and residuals</span></div>
<div class="line"><a name="l05853"></a><span class="lineno"> 5853</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a> = 0; <a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a> &lt; n_vector; <a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a>++)</div>
<div class="line"><a name="l05854"></a><span class="lineno"> 5854</span>&#160;          {</div>
<div class="line"><a name="l05855"></a><span class="lineno"> 5855</span>&#160;            el_residuals[<a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a>].resize(nvar);</div>
<div class="line"><a name="l05856"></a><span class="lineno"> 5856</span>&#160;          }</div>
<div class="line"><a name="l05857"></a><span class="lineno"> 5857</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> = 0; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> &lt; n_matrix; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>++)</div>
<div class="line"><a name="l05858"></a><span class="lineno"> 5858</span>&#160;          {</div>
<div class="line"><a name="l05859"></a><span class="lineno"> 5859</span>&#160;            el_jacobian[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>].resize(nvar);</div>
<div class="line"><a name="l05860"></a><span class="lineno"> 5860</span>&#160;          }</div>
<div class="line"><a name="l05861"></a><span class="lineno"> 5861</span>&#160; </div>
<div class="line"><a name="l05862"></a><span class="lineno"> 5862</span>&#160;          <span class="comment">// Now get the residuals and jacobian for the element</span></div>
<div class="line"><a name="l05863"></a><span class="lineno"> 5863</span>&#160;          <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>-&gt;<a class="code" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a67093ef481c51d384606486c41002baa">get_all_vectors_and_matrices</a>(</div>
<div class="line"><a name="l05864"></a><span class="lineno"> 5864</span>&#160;            elem_pt, el_residuals, el_jacobian);</div>
<div class="line"><a name="l05865"></a><span class="lineno"> 5865</span>&#160; </div>
<div class="line"><a name="l05866"></a><span class="lineno"> 5866</span>&#160;          <span class="comment">//---------------Insert the values into the vectors--------------</span></div>
<div class="line"><a name="l05867"></a><span class="lineno"> 5867</span>&#160; </div>
<div class="line"><a name="l05868"></a><span class="lineno"> 5868</span>&#160;          <span class="comment">// Loop over the first index of local variables</span></div>
<div class="line"><a name="l05869"></a><span class="lineno"> 5869</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; nvar; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l05870"></a><span class="lineno"> 5870</span>&#160;          {</div>
<div class="line"><a name="l05871"></a><span class="lineno"> 5871</span>&#160;            <span class="comment">// Get the local equation number</span></div>
<div class="line"><a name="l05872"></a><span class="lineno"> 5872</span>&#160;            <span class="keywordtype">unsigned</span> eqn_number = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>-&gt;<a class="code" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a94d28e2de2559cde803d1ba2195b5290">eqn_number</a>(elem_pt, <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l05873"></a><span class="lineno"> 5873</span>&#160; </div>
<div class="line"><a name="l05874"></a><span class="lineno"> 5874</span>&#160;            <span class="comment">// Add the contribution to the residuals</span></div>
<div class="line"><a name="l05875"></a><span class="lineno"> 5875</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a> = 0; <a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a> &lt; n_vector; <a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a>++)</div>
<div class="line"><a name="l05876"></a><span class="lineno"> 5876</span>&#160;            {</div>
<div class="line"><a name="l05877"></a><span class="lineno"> 5877</span>&#160;              <span class="comment">// Fill in each residuals vector</span></div>
<div class="line"><a name="l05878"></a><span class="lineno"> 5878</span>&#160;              residuals[<a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a>][eqn_number] += el_residuals[<a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a>][<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l05879"></a><span class="lineno"> 5879</span>&#160;            }</div>
<div class="line"><a name="l05880"></a><span class="lineno"> 5880</span>&#160; </div>
<div class="line"><a name="l05881"></a><span class="lineno"> 5881</span>&#160;            <span class="comment">// Now loop over the other index</span></div>
<div class="line"><a name="l05882"></a><span class="lineno"> 5882</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; nvar; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l05883"></a><span class="lineno"> 5883</span>&#160;            {</div>
<div class="line"><a name="l05884"></a><span class="lineno"> 5884</span>&#160;              <span class="comment">// Get the number of the unknown</span></div>
<div class="line"><a name="l05885"></a><span class="lineno"> 5885</span>&#160;              <span class="keywordtype">unsigned</span> unknown = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>-&gt;<a class="code" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a94d28e2de2559cde803d1ba2195b5290">eqn_number</a>(elem_pt, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l05886"></a><span class="lineno"> 5886</span>&#160; </div>
<div class="line"><a name="l05887"></a><span class="lineno"> 5887</span>&#160;              <span class="comment">// Loop over the matrices</span></div>
<div class="line"><a name="l05888"></a><span class="lineno"> 5888</span>&#160;              <span class="comment">// If it&#39;s compressed row storage, then our vector of maps</span></div>
<div class="line"><a name="l05889"></a><span class="lineno"> 5889</span>&#160;              <span class="comment">// is indexed by row (equation number)</span></div>
<div class="line"><a name="l05890"></a><span class="lineno"> 5890</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> = 0; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> &lt; n_matrix; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>++)</div>
<div class="line"><a name="l05891"></a><span class="lineno"> 5891</span>&#160;              {</div>
<div class="line"><a name="l05892"></a><span class="lineno"> 5892</span>&#160;                <span class="comment">// Get the value of the matrix at this point</span></div>
<div class="line"><a name="l05893"></a><span class="lineno"> 5893</span>&#160;                <span class="keywordtype">double</span> <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a> = el_jacobian[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>](<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l05894"></a><span class="lineno"> 5894</span>&#160;                <span class="comment">// Only bother to add to the vector if it&#39;s non-zero</span></div>
<div class="line"><a name="l05895"></a><span class="lineno"> 5895</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">std::fabs</a>(<a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>) &gt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad1a1ffc2bd685377ce7213452876b127">Numerical_zero_for_sparse_assembly</a>)</div>
<div class="line"><a name="l05896"></a><span class="lineno"> 5896</span>&#160;                {</div>
<div class="line"><a name="l05897"></a><span class="lineno"> 5897</span>&#160;                  <span class="comment">// If it&#39;s compressed row storage, then our vector of maps</span></div>
<div class="line"><a name="l05898"></a><span class="lineno"> 5898</span>&#160;                  <span class="comment">// is indexed by row (equation number)</span></div>
<div class="line"><a name="l05899"></a><span class="lineno"> 5899</span>&#160;                  <span class="keywordflow">if</span> (compressed_row_flag)</div>
<div class="line"><a name="l05900"></a><span class="lineno"> 5900</span>&#160;                  {</div>
<div class="line"><a name="l05901"></a><span class="lineno"> 5901</span>&#160;                    <span class="comment">// Find the correct position and add the data into the</span></div>
<div class="line"><a name="l05902"></a><span class="lineno"> 5902</span>&#160;                    <span class="comment">// vectors</span></div>
<div class="line"><a name="l05903"></a><span class="lineno"> 5903</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a> =</div>
<div class="line"><a name="l05904"></a><span class="lineno"> 5904</span>&#160;                      matrix_row_or_col_indices[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][eqn_number].size();</div>
<div class="line"><a name="l05905"></a><span class="lineno"> 5905</span>&#160; </div>
<div class="line"><a name="l05906"></a><span class="lineno"> 5906</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> = 0; <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> &lt;= <a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>; <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>++)</div>
<div class="line"><a name="l05907"></a><span class="lineno"> 5907</span>&#160;                    {</div>
<div class="line"><a name="l05908"></a><span class="lineno"> 5908</span>&#160;                      <span class="keywordflow">if</span> (<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> == <a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>)</div>
<div class="line"><a name="l05909"></a><span class="lineno"> 5909</span>&#160;                      {</div>
<div class="line"><a name="l05910"></a><span class="lineno"> 5910</span>&#160;                        matrix_row_or_col_indices[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][eqn_number].push_back(</div>
<div class="line"><a name="l05911"></a><span class="lineno"> 5911</span>&#160;                          unknown);</div>
<div class="line"><a name="l05912"></a><span class="lineno"> 5912</span>&#160;                        matrix_values[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][eqn_number].push_back(<a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>);</div>
<div class="line"><a name="l05913"></a><span class="lineno"> 5913</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05914"></a><span class="lineno"> 5914</span>&#160;                      }</div>
<div class="line"><a name="l05915"></a><span class="lineno"> 5915</span>&#160;                      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (matrix_row_or_col_indices[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][eqn_number][<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>] ==</div>
<div class="line"><a name="l05916"></a><span class="lineno"> 5916</span>&#160;                               unknown)</div>
<div class="line"><a name="l05917"></a><span class="lineno"> 5917</span>&#160;                      {</div>
<div class="line"><a name="l05918"></a><span class="lineno"> 5918</span>&#160;                        matrix_values[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][eqn_number][<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>] += <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>;</div>
<div class="line"><a name="l05919"></a><span class="lineno"> 5919</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05920"></a><span class="lineno"> 5920</span>&#160;                      }</div>
<div class="line"><a name="l05921"></a><span class="lineno"> 5921</span>&#160;                    }</div>
<div class="line"><a name="l05922"></a><span class="lineno"> 5922</span>&#160;                  }</div>
<div class="line"><a name="l05923"></a><span class="lineno"> 5923</span>&#160;                  <span class="comment">// Otherwise it&#39;s compressed column storage and our vector is</span></div>
<div class="line"><a name="l05924"></a><span class="lineno"> 5924</span>&#160;                  <span class="comment">// indexed by column (the unknown)</span></div>
<div class="line"><a name="l05925"></a><span class="lineno"> 5925</span>&#160;                  <span class="keywordflow">else</span></div>
<div class="line"><a name="l05926"></a><span class="lineno"> 5926</span>&#160;                  {</div>
<div class="line"><a name="l05927"></a><span class="lineno"> 5927</span>&#160;                    <span class="comment">// Add the data into the vectors in the correct position</span></div>
<div class="line"><a name="l05928"></a><span class="lineno"> 5928</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a> =</div>
<div class="line"><a name="l05929"></a><span class="lineno"> 5929</span>&#160;                      matrix_row_or_col_indices[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][unknown].size();</div>
<div class="line"><a name="l05930"></a><span class="lineno"> 5930</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> = 0; <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> &lt;= <a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>; <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>++)</div>
<div class="line"><a name="l05931"></a><span class="lineno"> 5931</span>&#160;                    {</div>
<div class="line"><a name="l05932"></a><span class="lineno"> 5932</span>&#160;                      <span class="keywordflow">if</span> (<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> == <a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>)</div>
<div class="line"><a name="l05933"></a><span class="lineno"> 5933</span>&#160;                      {</div>
<div class="line"><a name="l05934"></a><span class="lineno"> 5934</span>&#160;                        matrix_row_or_col_indices[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][unknown].push_back(</div>
<div class="line"><a name="l05935"></a><span class="lineno"> 5935</span>&#160;                          eqn_number);</div>
<div class="line"><a name="l05936"></a><span class="lineno"> 5936</span>&#160;                        matrix_values[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][unknown].push_back(<a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>);</div>
<div class="line"><a name="l05937"></a><span class="lineno"> 5937</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05938"></a><span class="lineno"> 5938</span>&#160;                      }</div>
<div class="line"><a name="l05939"></a><span class="lineno"> 5939</span>&#160;                      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (matrix_row_or_col_indices[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][unknown][<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>] ==</div>
<div class="line"><a name="l05940"></a><span class="lineno"> 5940</span>&#160;                               eqn_number)</div>
<div class="line"><a name="l05941"></a><span class="lineno"> 5941</span>&#160;                      {</div>
<div class="line"><a name="l05942"></a><span class="lineno"> 5942</span>&#160;                        matrix_values[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][unknown][<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>] += <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>;</div>
<div class="line"><a name="l05943"></a><span class="lineno"> 5943</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05944"></a><span class="lineno"> 5944</span>&#160;                      }</div>
<div class="line"><a name="l05945"></a><span class="lineno"> 5945</span>&#160;                    }</div>
<div class="line"><a name="l05946"></a><span class="lineno"> 5946</span>&#160;                  }</div>
<div class="line"><a name="l05947"></a><span class="lineno"> 5947</span>&#160;                }</div>
<div class="line"><a name="l05948"></a><span class="lineno"> 5948</span>&#160;              } <span class="comment">// End of loop over matrices</span></div>
<div class="line"><a name="l05949"></a><span class="lineno"> 5949</span>&#160;            }</div>
<div class="line"><a name="l05950"></a><span class="lineno"> 5950</span>&#160;          }</div>
<div class="line"><a name="l05951"></a><span class="lineno"> 5951</span>&#160; </div>
<div class="line"><a name="l05952"></a><span class="lineno"> 5952</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l05953"></a><span class="lineno"> 5953</span>&#160;        } <span class="comment">// endif halo element</span></div>
<div class="line"><a name="l05954"></a><span class="lineno"> 5954</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l05955"></a><span class="lineno"> 5955</span>&#160; </div>
<div class="line"><a name="l05956"></a><span class="lineno"> 5956</span>&#160; </div>
<div class="line"><a name="l05957"></a><span class="lineno"> 5957</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l05958"></a><span class="lineno"> 5958</span>&#160;        <span class="comment">// Time it?</span></div>
<div class="line"><a name="l05959"></a><span class="lineno"> 5959</span>&#160;        <span class="keywordflow">if</span> ((!doing_residuals) &amp;&amp; Must_recompute_load_balance_for_assembly)</div>
<div class="line"><a name="l05960"></a><span class="lineno"> 5960</span>&#160;        {</div>
<div class="line"><a name="l05961"></a><span class="lineno"> 5961</span>&#160;          Elemental_assembly_time[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>] =</div>
<div class="line"><a name="l05962"></a><span class="lineno"> 5962</span>&#160;            <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>() - t_assemble_start;</div>
<div class="line"><a name="l05963"></a><span class="lineno"> 5963</span>&#160;        }</div>
<div class="line"><a name="l05964"></a><span class="lineno"> 5964</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l05965"></a><span class="lineno"> 5965</span>&#160; </div>
<div class="line"><a name="l05966"></a><span class="lineno"> 5966</span>&#160;      } <span class="comment">// End of loop over the elements</span></div>
<div class="line"><a name="l05967"></a><span class="lineno"> 5967</span>&#160; </div>
<div class="line"><a name="l05968"></a><span class="lineno"> 5968</span>&#160;    } <span class="comment">// End of vector assembly</span></div>
<div class="line"><a name="l05969"></a><span class="lineno"> 5969</span>&#160; </div>
<div class="line"><a name="l05970"></a><span class="lineno"> 5970</span>&#160; </div>
<div class="line"><a name="l05971"></a><span class="lineno"> 5971</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l05972"></a><span class="lineno"> 5972</span>&#160; </div>
<div class="line"><a name="l05973"></a><span class="lineno"> 5973</span>&#160;    <span class="comment">// Postprocess timing information and re-allocate distribution of</span></div>
<div class="line"><a name="l05974"></a><span class="lineno"> 5974</span>&#160;    <span class="comment">// elements during subsequent assemblies.</span></div>
<div class="line"><a name="l05975"></a><span class="lineno"> 5975</span>&#160;    <span class="keywordflow">if</span> ((!doing_residuals) &amp;&amp; (!Problem_has_been_distributed) &amp;&amp;</div>
<div class="line"><a name="l05976"></a><span class="lineno"> 5976</span>&#160;        Must_recompute_load_balance_for_assembly)</div>
<div class="line"><a name="l05977"></a><span class="lineno"> 5977</span>&#160;    {</div>
<div class="line"><a name="l05978"></a><span class="lineno"> 5978</span>&#160;      recompute_load_balanced_assembly();</div>
<div class="line"><a name="l05979"></a><span class="lineno"> 5979</span>&#160;    }</div>
<div class="line"><a name="l05980"></a><span class="lineno"> 5980</span>&#160; </div>
<div class="line"><a name="l05981"></a><span class="lineno"> 5981</span>&#160;    <span class="comment">// We have determined load balancing for current setup.</span></div>
<div class="line"><a name="l05982"></a><span class="lineno"> 5982</span>&#160;    <span class="comment">// This can remain the same until assign_eqn_numbers() is called</span></div>
<div class="line"><a name="l05983"></a><span class="lineno"> 5983</span>&#160;    <span class="comment">// again -- the flag is re-set to true there.</span></div>
<div class="line"><a name="l05984"></a><span class="lineno"> 5984</span>&#160;    <span class="keywordflow">if</span> ((!doing_residuals) &amp;&amp; Must_recompute_load_balance_for_assembly)</div>
<div class="line"><a name="l05985"></a><span class="lineno"> 5985</span>&#160;    {</div>
<div class="line"><a name="l05986"></a><span class="lineno"> 5986</span>&#160;      Must_recompute_load_balance_for_assembly = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05987"></a><span class="lineno"> 5987</span>&#160;    }</div>
<div class="line"><a name="l05988"></a><span class="lineno"> 5988</span>&#160; </div>
<div class="line"><a name="l05989"></a><span class="lineno"> 5989</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l05990"></a><span class="lineno"> 5990</span>&#160; </div>
<div class="line"><a name="l05991"></a><span class="lineno"> 5991</span>&#160;    <span class="comment">//-----------Finally we need to convert this lousy vector storage scheme</span></div>
<div class="line"><a name="l05992"></a><span class="lineno"> 5992</span>&#160;    <span class="comment">//------------------------to the containers required by SuperLU</span></div>
<div class="line"><a name="l05993"></a><span class="lineno"> 5993</span>&#160; </div>
<div class="line"><a name="l05994"></a><span class="lineno"> 5994</span>&#160;    <span class="comment">// Loop over the number of matrices</span></div>
<div class="line"><a name="l05995"></a><span class="lineno"> 5995</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> = 0; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> &lt; n_matrix; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>++)</div>
<div class="line"><a name="l05996"></a><span class="lineno"> 5996</span>&#160;    {</div>
<div class="line"><a name="l05997"></a><span class="lineno"> 5997</span>&#160;      <span class="comment">// Set the number of rows or columns</span></div>
<div class="line"><a name="l05998"></a><span class="lineno"> 5998</span>&#160;      row_or_column_start[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>] = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a> + 1];</div>
<div class="line"><a name="l05999"></a><span class="lineno"> 5999</span>&#160; </div>
<div class="line"><a name="l06000"></a><span class="lineno"> 6000</span>&#160;      <span class="comment">// fill row_or_column_start and find the number of entries</span></div>
<div class="line"><a name="l06001"></a><span class="lineno"> 6001</span>&#160;      row_or_column_start[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][0] = 0;</div>
<div class="line"><a name="l06002"></a><span class="lineno"> 6002</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l06003"></a><span class="lineno"> 6003</span>&#160;      {</div>
<div class="line"><a name="l06004"></a><span class="lineno"> 6004</span>&#160;        row_or_column_start[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1] =</div>
<div class="line"><a name="l06005"></a><span class="lineno"> 6005</span>&#160;          row_or_column_start[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] + matrix_values[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].size();</div>
<div class="line"><a name="l06006"></a><span class="lineno"> 6006</span>&#160;      }</div>
<div class="line"><a name="l06007"></a><span class="lineno"> 6007</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> entries = row_or_column_start[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>];</div>
<div class="line"><a name="l06008"></a><span class="lineno"> 6008</span>&#160; </div>
<div class="line"><a name="l06009"></a><span class="lineno"> 6009</span>&#160;      <span class="comment">// resize vectors</span></div>
<div class="line"><a name="l06010"></a><span class="lineno"> 6010</span>&#160;      column_or_row_index[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>] = <span class="keyword">new</span> <span class="keywordtype">int</span>[entries];</div>
<div class="line"><a name="l06011"></a><span class="lineno"> 6011</span>&#160;      <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>] = <span class="keyword">new</span> <span class="keywordtype">double</span>[entries];</div>
<div class="line"><a name="l06012"></a><span class="lineno"> 6012</span>&#160;      nnz[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>] = entries;</div>
<div class="line"><a name="l06013"></a><span class="lineno"> 6013</span>&#160; </div>
<div class="line"><a name="l06014"></a><span class="lineno"> 6014</span>&#160;      <span class="comment">// Now we merely loop over the number of rows or columns</span></div>
<div class="line"><a name="l06015"></a><span class="lineno"> 6015</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i_global = 0; i_global &lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>; i_global++)</div>
<div class="line"><a name="l06016"></a><span class="lineno"> 6016</span>&#160;      {</div>
<div class="line"><a name="l06017"></a><span class="lineno"> 6017</span>&#160;        <span class="comment">// If there are no entries in the vector then skip the rest of the loop</span></div>
<div class="line"><a name="l06018"></a><span class="lineno"> 6018</span>&#160;        <span class="keywordflow">if</span> (matrix_values[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][i_global].empty())</div>
<div class="line"><a name="l06019"></a><span class="lineno"> 6019</span>&#160;        {</div>
<div class="line"><a name="l06020"></a><span class="lineno"> 6020</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l06021"></a><span class="lineno"> 6021</span>&#160;        }</div>
<div class="line"><a name="l06022"></a><span class="lineno"> 6022</span>&#160; </div>
<div class="line"><a name="l06023"></a><span class="lineno"> 6023</span>&#160;        <span class="comment">// Loop over all the entries in the vectors corresponding to the given</span></div>
<div class="line"><a name="l06024"></a><span class="lineno"> 6024</span>&#160;        <span class="comment">// row or column. It will NOT be ordered</span></div>
<div class="line"><a name="l06025"></a><span class="lineno"> 6025</span>&#160;        <span class="keywordtype">unsigned</span> <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> = 0;</div>
<div class="line"><a name="l06026"></a><span class="lineno"> 6026</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = row_or_column_start[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][i_global];</div>
<div class="line"><a name="l06027"></a><span class="lineno"> 6027</span>&#160;             <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; row_or_column_start[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][i_global + 1];</div>
<div class="line"><a name="l06028"></a><span class="lineno"> 6028</span>&#160;             <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l06029"></a><span class="lineno"> 6029</span>&#160;        {</div>
<div class="line"><a name="l06030"></a><span class="lineno"> 6030</span>&#160;          column_or_row_index[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>] = matrix_row_or_col_indices[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][i_global][<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>];</div>
<div class="line"><a name="l06031"></a><span class="lineno"> 6031</span>&#160;          <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>] = matrix_values[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][i_global][<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>];</div>
<div class="line"><a name="l06032"></a><span class="lineno"> 6032</span>&#160;          ++<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>;</div>
<div class="line"><a name="l06033"></a><span class="lineno"> 6033</span>&#160;        }</div>
<div class="line"><a name="l06034"></a><span class="lineno"> 6034</span>&#160;      }</div>
<div class="line"><a name="l06035"></a><span class="lineno"> 6035</span>&#160;    } <span class="comment">// End of the loop over the matrices</span></div>
<div class="line"><a name="l06036"></a><span class="lineno"> 6036</span>&#160; </div>
<div class="line"><a name="l06037"></a><span class="lineno"> 6037</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aedefa8337ace6043c2fdfd5a2d19afd3">Pause_at_end_of_sparse_assembly</a>)</div>
<div class="line"><a name="l06038"></a><span class="lineno"> 6038</span>&#160;    {</div>
<div class="line"><a name="l06039"></a><span class="lineno"> 6039</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Pausing at end of sparse assembly.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l06040"></a><span class="lineno"> 6040</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#a4a82243b0ce4c28469a290fe2d7cd2c4">pause</a>(<span class="stringliteral">&quot;Check memory usage now.&quot;</span>);</div>
<div class="line"><a name="l06041"></a><span class="lineno"> 6041</span>&#160;    }</div>
<div class="line"><a name="l06042"></a><span class="lineno"> 6042</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>, <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">oomph::Mesh::element_pt()</a>, <a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a94d28e2de2559cde803d1ba2195b5290">oomph::AssemblyHandler::eqn_number()</a>, <a class="el" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">boost::multiprecision::fabs()</a>, <a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a67093ef481c51d384606486c41002baa">oomph::AssemblyHandler::get_all_vectors_and_matrices()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>, <a class="el" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt()</a>, <a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a670b34aab05bfe0b96d0e0fabf583c7a">oomph::OomphCommunicator::my_rank()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof()</a>, <a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a09213be8f4aa009e0366460a7ed78e68">oomph::AssemblyHandler::ndof()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">oomph::Mesh::nelement()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad1a1ffc2bd685377ce7213452876b127">Numerical_zero_for_sparse_assembly</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, <a class="el" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#a4a82243b0ce4c28469a290fe2d7cd2c4">oomph::pause()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aedefa8337ace6043c2fdfd5a2d19afd3">Pause_at_end_of_sparse_assembly</a>, <a class="el" href="../../db/ddc/benchVecAdd_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>, <a class="el" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">oomph::TimingHelpers::timer()</a>, <a class="el" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a>, and <a class="el" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">Eigen::value</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab9cdd18180be05e4d46bfdbc1acbdbd3">sparse_assemble_row_or_column_compressed()</a>.</p>

</div>
</div>
<a id="a7eb5e0e3dc02fa26eec9d023b80b9603"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7eb5e0e3dc02fa26eec9d023b80b9603">&#9670;&nbsp;</a></span>sparse_assemble_row_or_column_compressed_with_vectors_of_pairs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::sparse_assemble_row_or_column_compressed_with_vectors_of_pairs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>column_or_row_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>row_or_column_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>nnz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>residuals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>compressed_row_flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Private helper function that is used to assemble the Jacobian matrix in the case when the storage is row or column compressed. The boolean Flag indicates if we want compressed row format (true) or compressed column. This version uses vectors of pairs.</p>
<p>This is a (private) helper function that is used to assemble system matrices in compressed row or column format and compute residual vectors using vectors of pairs The default action is to assemble the jacobian matrix and residuals for the Newton method. The action can be overloaded at an elemental level by chaging the default behaviour of the function Element::get_all_vectors_and_matrices(). column_or_row_index: Column [or row] index of given entry row_or_column_start: Index of first entry for given row [or column] value : Vector of nonzero entries residuals : Residual vector compressed_row_flag: Bool flag to indicate if storage format is compressed row [if false interpretation of arguments is as stated in square brackets]. </p>
<div class="fragment"><div class="line"><a name="l05352"></a><span class="lineno"> 5352</span>&#160;  {</div>
<div class="line"><a name="l05353"></a><span class="lineno"> 5353</span>&#160;    <span class="comment">// Total number of elements</span></div>
<div class="line"><a name="l05354"></a><span class="lineno"> 5354</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n_elements = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>()-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">nelement</a>();</div>
<div class="line"><a name="l05355"></a><span class="lineno"> 5355</span>&#160; </div>
<div class="line"><a name="l05356"></a><span class="lineno"> 5356</span>&#160;    <span class="comment">// Default range of elements for distributed problems</span></div>
<div class="line"><a name="l05357"></a><span class="lineno"> 5357</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> el_lo = 0;</div>
<div class="line"><a name="l05358"></a><span class="lineno"> 5358</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> el_hi = n_elements - 1;</div>
<div class="line"><a name="l05359"></a><span class="lineno"> 5359</span>&#160; </div>
<div class="line"><a name="l05360"></a><span class="lineno"> 5360</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l05361"></a><span class="lineno"> 5361</span>&#160;    <span class="comment">// Otherwise just loop over a fraction of the elements</span></div>
<div class="line"><a name="l05362"></a><span class="lineno"> 5362</span>&#160;    <span class="comment">// (This will either have been initialised in</span></div>
<div class="line"><a name="l05363"></a><span class="lineno"> 5363</span>&#160;    <span class="comment">// Problem::set_default_first_and_last_element_for_assembly() or</span></div>
<div class="line"><a name="l05364"></a><span class="lineno"> 5364</span>&#160;    <span class="comment">// will have been re-assigned during a previous assembly loop</span></div>
<div class="line"><a name="l05365"></a><span class="lineno"> 5365</span>&#160;    <span class="comment">// Note that following the re-assignment only the entries</span></div>
<div class="line"><a name="l05366"></a><span class="lineno"> 5366</span>&#160;    <span class="comment">// for the current processor are relevant.</span></div>
<div class="line"><a name="l05367"></a><span class="lineno"> 5367</span>&#160;    <span class="keywordflow">if</span> (!Problem_has_been_distributed)</div>
<div class="line"><a name="l05368"></a><span class="lineno"> 5368</span>&#160;    {</div>
<div class="line"><a name="l05369"></a><span class="lineno"> 5369</span>&#160;      el_lo = First_el_for_assembly[<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>-&gt;<a class="code" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a670b34aab05bfe0b96d0e0fabf583c7a">my_rank</a>()];</div>
<div class="line"><a name="l05370"></a><span class="lineno"> 5370</span>&#160;      el_hi = Last_el_plus_one_for_assembly[<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>-&gt;<a class="code" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a670b34aab05bfe0b96d0e0fabf583c7a">my_rank</a>()] - 1;</div>
<div class="line"><a name="l05371"></a><span class="lineno"> 5371</span>&#160;    }</div>
<div class="line"><a name="l05372"></a><span class="lineno"> 5372</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l05373"></a><span class="lineno"> 5373</span>&#160; </div>
<div class="line"><a name="l05374"></a><span class="lineno"> 5374</span>&#160;    <span class="comment">// number of local eqns</span></div>
<div class="line"><a name="l05375"></a><span class="lineno"> 5375</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a> = this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>();</div>
<div class="line"><a name="l05376"></a><span class="lineno"> 5376</span>&#160; </div>
<div class="line"><a name="l05377"></a><span class="lineno"> 5377</span>&#160;    <span class="comment">// Find the number of vectors to be assembled</span></div>
<div class="line"><a name="l05378"></a><span class="lineno"> 5378</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_vector = residuals.size();</div>
<div class="line"><a name="l05379"></a><span class="lineno"> 5379</span>&#160; </div>
<div class="line"><a name="l05380"></a><span class="lineno"> 5380</span>&#160;    <span class="comment">// Find the number of matrices to be assembled</span></div>
<div class="line"><a name="l05381"></a><span class="lineno"> 5381</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_matrix = column_or_row_index.size();</div>
<div class="line"><a name="l05382"></a><span class="lineno"> 5382</span>&#160; </div>
<div class="line"><a name="l05383"></a><span class="lineno"> 5383</span>&#160;    <span class="comment">// Locally cache pointer to assembly handler</span></div>
<div class="line"><a name="l05384"></a><span class="lineno"> 5384</span>&#160;    AssemblyHandler* <span class="keyword">const</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a> = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>;</div>
<div class="line"><a name="l05385"></a><span class="lineno"> 5385</span>&#160; </div>
<div class="line"><a name="l05386"></a><span class="lineno"> 5386</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l05387"></a><span class="lineno"> 5387</span>&#160;    <span class="keywordtype">bool</span> doing_residuals = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05388"></a><span class="lineno"> 5388</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">dynamic_cast&lt;</span>ParallelResidualsHandler*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>) != 0)</div>
<div class="line"><a name="l05389"></a><span class="lineno"> 5389</span>&#160;    {</div>
<div class="line"><a name="l05390"></a><span class="lineno"> 5390</span>&#160;      doing_residuals = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05391"></a><span class="lineno"> 5391</span>&#160;    }</div>
<div class="line"><a name="l05392"></a><span class="lineno"> 5392</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l05393"></a><span class="lineno"> 5393</span>&#160; </div>
<div class="line"><a name="l05394"></a><span class="lineno"> 5394</span>&#160;<span class="comment">// Error check dimensions</span></div>
<div class="line"><a name="l05395"></a><span class="lineno"> 5395</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l05396"></a><span class="lineno"> 5396</span>&#160;    <span class="keywordflow">if</span> (row_or_column_start.size() != n_matrix)</div>
<div class="line"><a name="l05397"></a><span class="lineno"> 5397</span>&#160;    {</div>
<div class="line"><a name="l05398"></a><span class="lineno"> 5398</span>&#160;      std::ostringstream error_stream;</div>
<div class="line"><a name="l05399"></a><span class="lineno"> 5399</span>&#160;      error_stream &lt;&lt; <span class="stringliteral">&quot;Error: &quot;</span> &lt;&lt; std::endl</div>
<div class="line"><a name="l05400"></a><span class="lineno"> 5400</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;row_or_column_start.size() &quot;</span></div>
<div class="line"><a name="l05401"></a><span class="lineno"> 5401</span>&#160;                   &lt;&lt; row_or_column_start.size() &lt;&lt; <span class="stringliteral">&quot; does not equal &quot;</span></div>
<div class="line"><a name="l05402"></a><span class="lineno"> 5402</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;column_or_row_index.size() &quot;</span></div>
<div class="line"><a name="l05403"></a><span class="lineno"> 5403</span>&#160;                   &lt;&lt; column_or_row_index.size() &lt;&lt; std::endl;</div>
<div class="line"><a name="l05404"></a><span class="lineno"> 5404</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l05405"></a><span class="lineno"> 5405</span>&#160;        error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l05406"></a><span class="lineno"> 5406</span>&#160;    }</div>
<div class="line"><a name="l05407"></a><span class="lineno"> 5407</span>&#160; </div>
<div class="line"><a name="l05408"></a><span class="lineno"> 5408</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>.size() != n_matrix)</div>
<div class="line"><a name="l05409"></a><span class="lineno"> 5409</span>&#160;    {</div>
<div class="line"><a name="l05410"></a><span class="lineno"> 5410</span>&#160;      std::ostringstream error_stream;</div>
<div class="line"><a name="l05411"></a><span class="lineno"> 5411</span>&#160;      error_stream &lt;&lt; <span class="stringliteral">&quot;Error: &quot;</span> &lt;&lt; std::endl</div>
<div class="line"><a name="l05412"></a><span class="lineno"> 5412</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;value.size() &quot;</span> &lt;&lt; <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>.size() &lt;&lt; <span class="stringliteral">&quot; does not equal &quot;</span></div>
<div class="line"><a name="l05413"></a><span class="lineno"> 5413</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;column_or_row_index.size() &quot;</span></div>
<div class="line"><a name="l05414"></a><span class="lineno"> 5414</span>&#160;                   &lt;&lt; column_or_row_index.size() &lt;&lt; std::endl</div>
<div class="line"><a name="l05415"></a><span class="lineno"> 5415</span>&#160;                   &lt;&lt; std::endl</div>
<div class="line"><a name="l05416"></a><span class="lineno"> 5416</span>&#160;                   &lt;&lt; std::endl;</div>
<div class="line"><a name="l05417"></a><span class="lineno"> 5417</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l05418"></a><span class="lineno"> 5418</span>&#160;        error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l05419"></a><span class="lineno"> 5419</span>&#160;    }</div>
<div class="line"><a name="l05420"></a><span class="lineno"> 5420</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l05421"></a><span class="lineno"> 5421</span>&#160; </div>
<div class="line"><a name="l05422"></a><span class="lineno"> 5422</span>&#160; </div>
<div class="line"><a name="l05423"></a><span class="lineno"> 5423</span>&#160;    <span class="comment">// The idea behind this sparse assembly routine is to use a Vector of</span></div>
<div class="line"><a name="l05424"></a><span class="lineno"> 5424</span>&#160;    <span class="comment">// Vectors of pairs for each complete matrix.</span></div>
<div class="line"><a name="l05425"></a><span class="lineno"> 5425</span>&#160;    <span class="comment">// Each inner Vector stores pairs and holds the row (or column) index</span></div>
<div class="line"><a name="l05426"></a><span class="lineno"> 5426</span>&#160;    <span class="comment">// and the value of the matrix entry.</span></div>
<div class="line"><a name="l05427"></a><span class="lineno"> 5427</span>&#160; </div>
<div class="line"><a name="l05428"></a><span class="lineno"> 5428</span>&#160;    <span class="comment">// Set up Vector of Vectors to store the entries of each matrix,</span></div>
<div class="line"><a name="l05429"></a><span class="lineno"> 5429</span>&#160;    <span class="comment">// indexed by either the column or row.</span></div>
<div class="line"><a name="l05430"></a><span class="lineno"> 5430</span>&#160;    Vector&lt;Vector&lt;Vector&lt;std::pair&lt;unsigned, double&gt;&gt;&gt;&gt; matrix_data(n_matrix);</div>
<div class="line"><a name="l05431"></a><span class="lineno"> 5431</span>&#160; </div>
<div class="line"><a name="l05432"></a><span class="lineno"> 5432</span>&#160;    <span class="comment">// Loop over the number of matrices being assembled and resize</span></div>
<div class="line"><a name="l05433"></a><span class="lineno"> 5433</span>&#160;    <span class="comment">// each Vector of Vectors to the number of rows or columns of the matrix</span></div>
<div class="line"><a name="l05434"></a><span class="lineno"> 5434</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> = 0; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> &lt; n_matrix; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>++)</div>
<div class="line"><a name="l05435"></a><span class="lineno"> 5435</span>&#160;    {</div>
<div class="line"><a name="l05436"></a><span class="lineno"> 5436</span>&#160;      matrix_data[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>].resize(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>);</div>
<div class="line"><a name="l05437"></a><span class="lineno"> 5437</span>&#160;    }</div>
<div class="line"><a name="l05438"></a><span class="lineno"> 5438</span>&#160; </div>
<div class="line"><a name="l05439"></a><span class="lineno"> 5439</span>&#160;    <span class="comment">// Resize the residuals vectors</span></div>
<div class="line"><a name="l05440"></a><span class="lineno"> 5440</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a> = 0; <a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a> &lt; n_vector; <a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a>++)</div>
<div class="line"><a name="l05441"></a><span class="lineno"> 5441</span>&#160;    {</div>
<div class="line"><a name="l05442"></a><span class="lineno"> 5442</span>&#160;      residuals[<a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a>] = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>];</div>
<div class="line"><a name="l05443"></a><span class="lineno"> 5443</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l05444"></a><span class="lineno"> 5444</span>&#160;      {</div>
<div class="line"><a name="l05445"></a><span class="lineno"> 5445</span>&#160;        residuals[<a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a>][<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = 0;</div>
<div class="line"><a name="l05446"></a><span class="lineno"> 5446</span>&#160;      }</div>
<div class="line"><a name="l05447"></a><span class="lineno"> 5447</span>&#160;    }</div>
<div class="line"><a name="l05448"></a><span class="lineno"> 5448</span>&#160; </div>
<div class="line"><a name="l05449"></a><span class="lineno"> 5449</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l05450"></a><span class="lineno"> 5450</span>&#160; </div>
<div class="line"><a name="l05451"></a><span class="lineno"> 5451</span>&#160;    <span class="comment">// Storage for assembly time for elements</span></div>
<div class="line"><a name="l05452"></a><span class="lineno"> 5452</span>&#160;    <span class="keywordtype">double</span> t_assemble_start = 0.0;</div>
<div class="line"><a name="l05453"></a><span class="lineno"> 5453</span>&#160; </div>
<div class="line"><a name="l05454"></a><span class="lineno"> 5454</span>&#160;    <span class="comment">// Storage for assembly times</span></div>
<div class="line"><a name="l05455"></a><span class="lineno"> 5455</span>&#160;    <span class="keywordflow">if</span> ((!doing_residuals) &amp;&amp; Must_recompute_load_balance_for_assembly)</div>
<div class="line"><a name="l05456"></a><span class="lineno"> 5456</span>&#160;    {</div>
<div class="line"><a name="l05457"></a><span class="lineno"> 5457</span>&#160;      Elemental_assembly_time.resize(n_elements);</div>
<div class="line"><a name="l05458"></a><span class="lineno"> 5458</span>&#160;    }</div>
<div class="line"><a name="l05459"></a><span class="lineno"> 5459</span>&#160; </div>
<div class="line"><a name="l05460"></a><span class="lineno"> 5460</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l05461"></a><span class="lineno"> 5461</span>&#160; </div>
<div class="line"><a name="l05462"></a><span class="lineno"> 5462</span>&#160;    <span class="comment">//----------------Assemble and populate the vector storage scheme--------</span></div>
<div class="line"><a name="l05463"></a><span class="lineno"> 5463</span>&#160;    {</div>
<div class="line"><a name="l05464"></a><span class="lineno"> 5464</span>&#160;      <span class="comment">// Allocate local storage for the element&#39;s contribution to the</span></div>
<div class="line"><a name="l05465"></a><span class="lineno"> 5465</span>&#160;      <span class="comment">// residuals vectors and system matrices of the size of the maximum</span></div>
<div class="line"><a name="l05466"></a><span class="lineno"> 5466</span>&#160;      <span class="comment">// number of dofs in any element</span></div>
<div class="line"><a name="l05467"></a><span class="lineno"> 5467</span>&#160;      <span class="comment">// This means that the storage is only allocated (and deleted) once</span></div>
<div class="line"><a name="l05468"></a><span class="lineno"> 5468</span>&#160;      Vector&lt;Vector&lt;double&gt;&gt; el_residuals(n_vector);</div>
<div class="line"><a name="l05469"></a><span class="lineno"> 5469</span>&#160;      Vector&lt;DenseMatrix&lt;double&gt;&gt; el_jacobian(n_matrix);</div>
<div class="line"><a name="l05470"></a><span class="lineno"> 5470</span>&#160; </div>
<div class="line"><a name="l05471"></a><span class="lineno"> 5471</span>&#160;      <span class="comment">// Loop over the elements</span></div>
<div class="line"><a name="l05472"></a><span class="lineno"> 5472</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = el_lo; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt;= el_hi; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l05473"></a><span class="lineno"> 5473</span>&#160;      {</div>
<div class="line"><a name="l05474"></a><span class="lineno"> 5474</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l05475"></a><span class="lineno"> 5475</span>&#160;        <span class="comment">// Time it?</span></div>
<div class="line"><a name="l05476"></a><span class="lineno"> 5476</span>&#160;        <span class="keywordflow">if</span> ((!doing_residuals) &amp;&amp; Must_recompute_load_balance_for_assembly)</div>
<div class="line"><a name="l05477"></a><span class="lineno"> 5477</span>&#160;        {</div>
<div class="line"><a name="l05478"></a><span class="lineno"> 5478</span>&#160;          t_assemble_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l05479"></a><span class="lineno"> 5479</span>&#160;        }</div>
<div class="line"><a name="l05480"></a><span class="lineno"> 5480</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l05481"></a><span class="lineno"> 5481</span>&#160; </div>
<div class="line"><a name="l05482"></a><span class="lineno"> 5482</span>&#160;        <span class="comment">// Get the pointer to the element</span></div>
<div class="line"><a name="l05483"></a><span class="lineno"> 5483</span>&#160;        GeneralisedElement* elem_pt = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>()-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">element_pt</a>(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>);</div>
<div class="line"><a name="l05484"></a><span class="lineno"> 5484</span>&#160; </div>
<div class="line"><a name="l05485"></a><span class="lineno"> 5485</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l05486"></a><span class="lineno"> 5486</span>&#160;        <span class="comment">// Ignore halo elements</span></div>
<div class="line"><a name="l05487"></a><span class="lineno"> 5487</span>&#160;        <span class="keywordflow">if</span> (!elem_pt-&gt;is_halo())</div>
<div class="line"><a name="l05488"></a><span class="lineno"> 5488</span>&#160;        {</div>
<div class="line"><a name="l05489"></a><span class="lineno"> 5489</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l05490"></a><span class="lineno"> 5490</span>&#160; </div>
<div class="line"><a name="l05491"></a><span class="lineno"> 5491</span>&#160;          <span class="comment">// Find number of degrees of freedom in the element</span></div>
<div class="line"><a name="l05492"></a><span class="lineno"> 5492</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> nvar = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>-&gt;<a class="code" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a09213be8f4aa009e0366460a7ed78e68">ndof</a>(elem_pt);</div>
<div class="line"><a name="l05493"></a><span class="lineno"> 5493</span>&#160; </div>
<div class="line"><a name="l05494"></a><span class="lineno"> 5494</span>&#160;          <span class="comment">// Resize the storage for elemental jacobian and residuals</span></div>
<div class="line"><a name="l05495"></a><span class="lineno"> 5495</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a> = 0; <a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a> &lt; n_vector; <a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a>++)</div>
<div class="line"><a name="l05496"></a><span class="lineno"> 5496</span>&#160;          {</div>
<div class="line"><a name="l05497"></a><span class="lineno"> 5497</span>&#160;            el_residuals[<a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a>].resize(nvar);</div>
<div class="line"><a name="l05498"></a><span class="lineno"> 5498</span>&#160;          }</div>
<div class="line"><a name="l05499"></a><span class="lineno"> 5499</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> = 0; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> &lt; n_matrix; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>++)</div>
<div class="line"><a name="l05500"></a><span class="lineno"> 5500</span>&#160;          {</div>
<div class="line"><a name="l05501"></a><span class="lineno"> 5501</span>&#160;            el_jacobian[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>].resize(nvar);</div>
<div class="line"><a name="l05502"></a><span class="lineno"> 5502</span>&#160;          }</div>
<div class="line"><a name="l05503"></a><span class="lineno"> 5503</span>&#160; </div>
<div class="line"><a name="l05504"></a><span class="lineno"> 5504</span>&#160;          <span class="comment">// Now get the residuals and jacobian for the element</span></div>
<div class="line"><a name="l05505"></a><span class="lineno"> 5505</span>&#160;          <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>-&gt;<a class="code" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a67093ef481c51d384606486c41002baa">get_all_vectors_and_matrices</a>(</div>
<div class="line"><a name="l05506"></a><span class="lineno"> 5506</span>&#160;            elem_pt, el_residuals, el_jacobian);</div>
<div class="line"><a name="l05507"></a><span class="lineno"> 5507</span>&#160; </div>
<div class="line"><a name="l05508"></a><span class="lineno"> 5508</span>&#160;          <span class="comment">//---------------Insert the values into the vectors--------------</span></div>
<div class="line"><a name="l05509"></a><span class="lineno"> 5509</span>&#160; </div>
<div class="line"><a name="l05510"></a><span class="lineno"> 5510</span>&#160;          <span class="comment">// Loop over the first index of local variables</span></div>
<div class="line"><a name="l05511"></a><span class="lineno"> 5511</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; nvar; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l05512"></a><span class="lineno"> 5512</span>&#160;          {</div>
<div class="line"><a name="l05513"></a><span class="lineno"> 5513</span>&#160;            <span class="comment">// Get the local equation number</span></div>
<div class="line"><a name="l05514"></a><span class="lineno"> 5514</span>&#160;            <span class="keywordtype">unsigned</span> eqn_number = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>-&gt;<a class="code" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a94d28e2de2559cde803d1ba2195b5290">eqn_number</a>(elem_pt, <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l05515"></a><span class="lineno"> 5515</span>&#160; </div>
<div class="line"><a name="l05516"></a><span class="lineno"> 5516</span>&#160;            <span class="comment">// Add the contribution to the residuals</span></div>
<div class="line"><a name="l05517"></a><span class="lineno"> 5517</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a> = 0; <a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a> &lt; n_vector; <a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a>++)</div>
<div class="line"><a name="l05518"></a><span class="lineno"> 5518</span>&#160;            {</div>
<div class="line"><a name="l05519"></a><span class="lineno"> 5519</span>&#160;              <span class="comment">// Fill in each residuals vector</span></div>
<div class="line"><a name="l05520"></a><span class="lineno"> 5520</span>&#160;              residuals[<a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a>][eqn_number] += el_residuals[<a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a>][<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l05521"></a><span class="lineno"> 5521</span>&#160;            }</div>
<div class="line"><a name="l05522"></a><span class="lineno"> 5522</span>&#160; </div>
<div class="line"><a name="l05523"></a><span class="lineno"> 5523</span>&#160;            <span class="comment">// Now loop over the other index</span></div>
<div class="line"><a name="l05524"></a><span class="lineno"> 5524</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; nvar; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l05525"></a><span class="lineno"> 5525</span>&#160;            {</div>
<div class="line"><a name="l05526"></a><span class="lineno"> 5526</span>&#160;              <span class="comment">// Get the number of the unknown</span></div>
<div class="line"><a name="l05527"></a><span class="lineno"> 5527</span>&#160;              <span class="keywordtype">unsigned</span> unknown = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>-&gt;<a class="code" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a94d28e2de2559cde803d1ba2195b5290">eqn_number</a>(elem_pt, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l05528"></a><span class="lineno"> 5528</span>&#160; </div>
<div class="line"><a name="l05529"></a><span class="lineno"> 5529</span>&#160;              <span class="comment">// Loop over the matrices</span></div>
<div class="line"><a name="l05530"></a><span class="lineno"> 5530</span>&#160;              <span class="comment">// If it&#39;s compressed row storage, then our vector of maps</span></div>
<div class="line"><a name="l05531"></a><span class="lineno"> 5531</span>&#160;              <span class="comment">// is indexed by row (equation number)</span></div>
<div class="line"><a name="l05532"></a><span class="lineno"> 5532</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> = 0; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> &lt; n_matrix; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>++)</div>
<div class="line"><a name="l05533"></a><span class="lineno"> 5533</span>&#160;              {</div>
<div class="line"><a name="l05534"></a><span class="lineno"> 5534</span>&#160;                <span class="comment">// Get the value of the matrix at this point</span></div>
<div class="line"><a name="l05535"></a><span class="lineno"> 5535</span>&#160;                <span class="keywordtype">double</span> <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a> = el_jacobian[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>](<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l05536"></a><span class="lineno"> 5536</span>&#160;                <span class="comment">// Only bother to add to the vector if it&#39;s non-zero</span></div>
<div class="line"><a name="l05537"></a><span class="lineno"> 5537</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">std::fabs</a>(<a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>) &gt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad1a1ffc2bd685377ce7213452876b127">Numerical_zero_for_sparse_assembly</a>)</div>
<div class="line"><a name="l05538"></a><span class="lineno"> 5538</span>&#160;                {</div>
<div class="line"><a name="l05539"></a><span class="lineno"> 5539</span>&#160;                  <span class="comment">// If it&#39;s compressed row storage, then our vector of maps</span></div>
<div class="line"><a name="l05540"></a><span class="lineno"> 5540</span>&#160;                  <span class="comment">// is indexed by row (equation number)</span></div>
<div class="line"><a name="l05541"></a><span class="lineno"> 5541</span>&#160;                  <span class="keywordflow">if</span> (compressed_row_flag)</div>
<div class="line"><a name="l05542"></a><span class="lineno"> 5542</span>&#160;                  {</div>
<div class="line"><a name="l05543"></a><span class="lineno"> 5543</span>&#160;                    <span class="comment">// Find the correct position and add the data into the</span></div>
<div class="line"><a name="l05544"></a><span class="lineno"> 5544</span>&#160;                    <span class="comment">// vectors</span></div>
<div class="line"><a name="l05545"></a><span class="lineno"> 5545</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a> = matrix_data[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][eqn_number].size();</div>
<div class="line"><a name="l05546"></a><span class="lineno"> 5546</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> = 0; <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> &lt;= <a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>; <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>++)</div>
<div class="line"><a name="l05547"></a><span class="lineno"> 5547</span>&#160;                    {</div>
<div class="line"><a name="l05548"></a><span class="lineno"> 5548</span>&#160;                      <span class="keywordflow">if</span> (<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> == <a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>)</div>
<div class="line"><a name="l05549"></a><span class="lineno"> 5549</span>&#160;                      {</div>
<div class="line"><a name="l05550"></a><span class="lineno"> 5550</span>&#160;                        matrix_data[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][eqn_number].push_back(</div>
<div class="line"><a name="l05551"></a><span class="lineno"> 5551</span>&#160;                          std::make_pair(unknown, <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>));</div>
<div class="line"><a name="l05552"></a><span class="lineno"> 5552</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05553"></a><span class="lineno"> 5553</span>&#160;                      }</div>
<div class="line"><a name="l05554"></a><span class="lineno"> 5554</span>&#160;                      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (matrix_data[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][eqn_number][<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>].first == unknown)</div>
<div class="line"><a name="l05555"></a><span class="lineno"> 5555</span>&#160;                      {</div>
<div class="line"><a name="l05556"></a><span class="lineno"> 5556</span>&#160;                        matrix_data[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][eqn_number][<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>].second += <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>;</div>
<div class="line"><a name="l05557"></a><span class="lineno"> 5557</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05558"></a><span class="lineno"> 5558</span>&#160;                      }</div>
<div class="line"><a name="l05559"></a><span class="lineno"> 5559</span>&#160;                    }</div>
<div class="line"><a name="l05560"></a><span class="lineno"> 5560</span>&#160;                  }</div>
<div class="line"><a name="l05561"></a><span class="lineno"> 5561</span>&#160;                  <span class="comment">// Otherwise it&#39;s compressed column storage and our vector is</span></div>
<div class="line"><a name="l05562"></a><span class="lineno"> 5562</span>&#160;                  <span class="comment">// indexed by column (the unknown)</span></div>
<div class="line"><a name="l05563"></a><span class="lineno"> 5563</span>&#160;                  <span class="keywordflow">else</span></div>
<div class="line"><a name="l05564"></a><span class="lineno"> 5564</span>&#160;                  {</div>
<div class="line"><a name="l05565"></a><span class="lineno"> 5565</span>&#160;                    <span class="comment">// Add the data into the vectors in the correct position</span></div>
<div class="line"><a name="l05566"></a><span class="lineno"> 5566</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a> = matrix_data[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][unknown].size();</div>
<div class="line"><a name="l05567"></a><span class="lineno"> 5567</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> = 0; <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> &lt;= <a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>; <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>++)</div>
<div class="line"><a name="l05568"></a><span class="lineno"> 5568</span>&#160;                    {</div>
<div class="line"><a name="l05569"></a><span class="lineno"> 5569</span>&#160;                      <span class="keywordflow">if</span> (<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> == <a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>)</div>
<div class="line"><a name="l05570"></a><span class="lineno"> 5570</span>&#160;                      {</div>
<div class="line"><a name="l05571"></a><span class="lineno"> 5571</span>&#160;                        matrix_data[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][unknown].push_back(</div>
<div class="line"><a name="l05572"></a><span class="lineno"> 5572</span>&#160;                          std::make_pair(eqn_number, <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>));</div>
<div class="line"><a name="l05573"></a><span class="lineno"> 5573</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05574"></a><span class="lineno"> 5574</span>&#160;                      }</div>
<div class="line"><a name="l05575"></a><span class="lineno"> 5575</span>&#160;                      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (matrix_data[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][unknown][<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>].first == eqn_number)</div>
<div class="line"><a name="l05576"></a><span class="lineno"> 5576</span>&#160;                      {</div>
<div class="line"><a name="l05577"></a><span class="lineno"> 5577</span>&#160;                        matrix_data[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][unknown][<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>].second += <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>;</div>
<div class="line"><a name="l05578"></a><span class="lineno"> 5578</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05579"></a><span class="lineno"> 5579</span>&#160;                      }</div>
<div class="line"><a name="l05580"></a><span class="lineno"> 5580</span>&#160;                    }</div>
<div class="line"><a name="l05581"></a><span class="lineno"> 5581</span>&#160;                  }</div>
<div class="line"><a name="l05582"></a><span class="lineno"> 5582</span>&#160;                }</div>
<div class="line"><a name="l05583"></a><span class="lineno"> 5583</span>&#160;              } <span class="comment">// End of loop over matrices</span></div>
<div class="line"><a name="l05584"></a><span class="lineno"> 5584</span>&#160;            }</div>
<div class="line"><a name="l05585"></a><span class="lineno"> 5585</span>&#160;          }</div>
<div class="line"><a name="l05586"></a><span class="lineno"> 5586</span>&#160; </div>
<div class="line"><a name="l05587"></a><span class="lineno"> 5587</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l05588"></a><span class="lineno"> 5588</span>&#160;        } <span class="comment">// endif halo element</span></div>
<div class="line"><a name="l05589"></a><span class="lineno"> 5589</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l05590"></a><span class="lineno"> 5590</span>&#160; </div>
<div class="line"><a name="l05591"></a><span class="lineno"> 5591</span>&#160; </div>
<div class="line"><a name="l05592"></a><span class="lineno"> 5592</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l05593"></a><span class="lineno"> 5593</span>&#160;        <span class="comment">// Time it?</span></div>
<div class="line"><a name="l05594"></a><span class="lineno"> 5594</span>&#160;        <span class="keywordflow">if</span> ((!doing_residuals) &amp;&amp; Must_recompute_load_balance_for_assembly)</div>
<div class="line"><a name="l05595"></a><span class="lineno"> 5595</span>&#160;        {</div>
<div class="line"><a name="l05596"></a><span class="lineno"> 5596</span>&#160;          Elemental_assembly_time[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>] =</div>
<div class="line"><a name="l05597"></a><span class="lineno"> 5597</span>&#160;            <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>() - t_assemble_start;</div>
<div class="line"><a name="l05598"></a><span class="lineno"> 5598</span>&#160;        }</div>
<div class="line"><a name="l05599"></a><span class="lineno"> 5599</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l05600"></a><span class="lineno"> 5600</span>&#160; </div>
<div class="line"><a name="l05601"></a><span class="lineno"> 5601</span>&#160;      } <span class="comment">// End of loop over the elements</span></div>
<div class="line"><a name="l05602"></a><span class="lineno"> 5602</span>&#160; </div>
<div class="line"><a name="l05603"></a><span class="lineno"> 5603</span>&#160; </div>
<div class="line"><a name="l05604"></a><span class="lineno"> 5604</span>&#160;    } <span class="comment">// End of vector assembly</span></div>
<div class="line"><a name="l05605"></a><span class="lineno"> 5605</span>&#160; </div>
<div class="line"><a name="l05606"></a><span class="lineno"> 5606</span>&#160; </div>
<div class="line"><a name="l05607"></a><span class="lineno"> 5607</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l05608"></a><span class="lineno"> 5608</span>&#160; </div>
<div class="line"><a name="l05609"></a><span class="lineno"> 5609</span>&#160;    <span class="comment">// Postprocess timing information and re-allocate distribution of</span></div>
<div class="line"><a name="l05610"></a><span class="lineno"> 5610</span>&#160;    <span class="comment">// elements during subsequent assemblies.</span></div>
<div class="line"><a name="l05611"></a><span class="lineno"> 5611</span>&#160;    <span class="keywordflow">if</span> ((!doing_residuals) &amp;&amp; (!Problem_has_been_distributed) &amp;&amp;</div>
<div class="line"><a name="l05612"></a><span class="lineno"> 5612</span>&#160;        Must_recompute_load_balance_for_assembly)</div>
<div class="line"><a name="l05613"></a><span class="lineno"> 5613</span>&#160;    {</div>
<div class="line"><a name="l05614"></a><span class="lineno"> 5614</span>&#160;      recompute_load_balanced_assembly();</div>
<div class="line"><a name="l05615"></a><span class="lineno"> 5615</span>&#160;    }</div>
<div class="line"><a name="l05616"></a><span class="lineno"> 5616</span>&#160; </div>
<div class="line"><a name="l05617"></a><span class="lineno"> 5617</span>&#160;    <span class="comment">// We have determined load balancing for current setup.</span></div>
<div class="line"><a name="l05618"></a><span class="lineno"> 5618</span>&#160;    <span class="comment">// This can remain the same until assign_eqn_numbers() is called</span></div>
<div class="line"><a name="l05619"></a><span class="lineno"> 5619</span>&#160;    <span class="comment">// again -- the flag is re-set to true there.</span></div>
<div class="line"><a name="l05620"></a><span class="lineno"> 5620</span>&#160;    <span class="keywordflow">if</span> ((!doing_residuals) &amp;&amp; Must_recompute_load_balance_for_assembly)</div>
<div class="line"><a name="l05621"></a><span class="lineno"> 5621</span>&#160;    {</div>
<div class="line"><a name="l05622"></a><span class="lineno"> 5622</span>&#160;      Must_recompute_load_balance_for_assembly = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05623"></a><span class="lineno"> 5623</span>&#160;    }</div>
<div class="line"><a name="l05624"></a><span class="lineno"> 5624</span>&#160; </div>
<div class="line"><a name="l05625"></a><span class="lineno"> 5625</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l05626"></a><span class="lineno"> 5626</span>&#160; </div>
<div class="line"><a name="l05627"></a><span class="lineno"> 5627</span>&#160; </div>
<div class="line"><a name="l05628"></a><span class="lineno"> 5628</span>&#160;    <span class="comment">//-----------Finally we need to convert this vector storage scheme</span></div>
<div class="line"><a name="l05629"></a><span class="lineno"> 5629</span>&#160;    <span class="comment">//------------------------to the containers required by SuperLU</span></div>
<div class="line"><a name="l05630"></a><span class="lineno"> 5630</span>&#160; </div>
<div class="line"><a name="l05631"></a><span class="lineno"> 5631</span>&#160;    <span class="comment">// Loop over the number of matrices</span></div>
<div class="line"><a name="l05632"></a><span class="lineno"> 5632</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> = 0; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a> &lt; n_matrix; <a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>++)</div>
<div class="line"><a name="l05633"></a><span class="lineno"> 5633</span>&#160;    {</div>
<div class="line"><a name="l05634"></a><span class="lineno"> 5634</span>&#160;      <span class="comment">// Set the number of rows or columns</span></div>
<div class="line"><a name="l05635"></a><span class="lineno"> 5635</span>&#160;      row_or_column_start[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>] = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a> + 1];</div>
<div class="line"><a name="l05636"></a><span class="lineno"> 5636</span>&#160; </div>
<div class="line"><a name="l05637"></a><span class="lineno"> 5637</span>&#160;      <span class="comment">// fill row_or_column_start and find the number of entries</span></div>
<div class="line"><a name="l05638"></a><span class="lineno"> 5638</span>&#160;      row_or_column_start[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][0] = 0;</div>
<div class="line"><a name="l05639"></a><span class="lineno"> 5639</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l05640"></a><span class="lineno"> 5640</span>&#160;      {</div>
<div class="line"><a name="l05641"></a><span class="lineno"> 5641</span>&#160;        row_or_column_start[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1] =</div>
<div class="line"><a name="l05642"></a><span class="lineno"> 5642</span>&#160;          row_or_column_start[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] + matrix_data[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].size();</div>
<div class="line"><a name="l05643"></a><span class="lineno"> 5643</span>&#160;      }</div>
<div class="line"><a name="l05644"></a><span class="lineno"> 5644</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> entries = row_or_column_start[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>];</div>
<div class="line"><a name="l05645"></a><span class="lineno"> 5645</span>&#160; </div>
<div class="line"><a name="l05646"></a><span class="lineno"> 5646</span>&#160;      <span class="comment">// resize vectors</span></div>
<div class="line"><a name="l05647"></a><span class="lineno"> 5647</span>&#160;      column_or_row_index[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>] = <span class="keyword">new</span> <span class="keywordtype">int</span>[entries];</div>
<div class="line"><a name="l05648"></a><span class="lineno"> 5648</span>&#160;      <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>] = <span class="keyword">new</span> <span class="keywordtype">double</span>[entries];</div>
<div class="line"><a name="l05649"></a><span class="lineno"> 5649</span>&#160;      nnz[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>] = entries;</div>
<div class="line"><a name="l05650"></a><span class="lineno"> 5650</span>&#160; </div>
<div class="line"><a name="l05651"></a><span class="lineno"> 5651</span>&#160;      <span class="comment">// Now we merely loop over the number of rows or columns</span></div>
<div class="line"><a name="l05652"></a><span class="lineno"> 5652</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i_global = 0; i_global &lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>; i_global++)</div>
<div class="line"><a name="l05653"></a><span class="lineno"> 5653</span>&#160;      {</div>
<div class="line"><a name="l05654"></a><span class="lineno"> 5654</span>&#160;        <span class="comment">// If there are no entries in the vector then skip the rest of the loop</span></div>
<div class="line"><a name="l05655"></a><span class="lineno"> 5655</span>&#160;        <span class="keywordflow">if</span> (matrix_data[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][i_global].empty())</div>
<div class="line"><a name="l05656"></a><span class="lineno"> 5656</span>&#160;        {</div>
<div class="line"><a name="l05657"></a><span class="lineno"> 5657</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05658"></a><span class="lineno"> 5658</span>&#160;        }</div>
<div class="line"><a name="l05659"></a><span class="lineno"> 5659</span>&#160; </div>
<div class="line"><a name="l05660"></a><span class="lineno"> 5660</span>&#160;        <span class="comment">// Loop over all the entries in the vectors corresponding to the given</span></div>
<div class="line"><a name="l05661"></a><span class="lineno"> 5661</span>&#160;        <span class="comment">// row or column. It will NOT be ordered</span></div>
<div class="line"><a name="l05662"></a><span class="lineno"> 5662</span>&#160;        <span class="keywordtype">unsigned</span> <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> = 0;</div>
<div class="line"><a name="l05663"></a><span class="lineno"> 5663</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = row_or_column_start[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][i_global];</div>
<div class="line"><a name="l05664"></a><span class="lineno"> 5664</span>&#160;             <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; row_or_column_start[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][i_global + 1];</div>
<div class="line"><a name="l05665"></a><span class="lineno"> 5665</span>&#160;             <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l05666"></a><span class="lineno"> 5666</span>&#160;        {</div>
<div class="line"><a name="l05667"></a><span class="lineno"> 5667</span>&#160;          column_or_row_index[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>] = matrix_data[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][i_global][<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>].first;</div>
<div class="line"><a name="l05668"></a><span class="lineno"> 5668</span>&#160;          <a class="code" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">value</a>[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>] = matrix_data[<a class="code" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>][i_global][<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>].second;</div>
<div class="line"><a name="l05669"></a><span class="lineno"> 5669</span>&#160;          ++<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>;</div>
<div class="line"><a name="l05670"></a><span class="lineno"> 5670</span>&#160;        }</div>
<div class="line"><a name="l05671"></a><span class="lineno"> 5671</span>&#160;      }</div>
<div class="line"><a name="l05672"></a><span class="lineno"> 5672</span>&#160;    } <span class="comment">// End of the loop over the matrices</span></div>
<div class="line"><a name="l05673"></a><span class="lineno"> 5673</span>&#160; </div>
<div class="line"><a name="l05674"></a><span class="lineno"> 5674</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aedefa8337ace6043c2fdfd5a2d19afd3">Pause_at_end_of_sparse_assembly</a>)</div>
<div class="line"><a name="l05675"></a><span class="lineno"> 5675</span>&#160;    {</div>
<div class="line"><a name="l05676"></a><span class="lineno"> 5676</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Pausing at end of sparse assembly.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l05677"></a><span class="lineno"> 5677</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#a4a82243b0ce4c28469a290fe2d7cd2c4">pause</a>(<span class="stringliteral">&quot;Check memory usage now.&quot;</span>);</div>
<div class="line"><a name="l05678"></a><span class="lineno"> 5678</span>&#160;    }</div>
<div class="line"><a name="l05679"></a><span class="lineno"> 5679</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aefc325e2e116c389a24c9871e41bdb55">Assembly_handler_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a937afdd0d5a039943482f8be9b24c82e">Communicator_pt</a>, <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">oomph::Mesh::element_pt()</a>, <a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a94d28e2de2559cde803d1ba2195b5290">oomph::AssemblyHandler::eqn_number()</a>, <a class="el" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">boost::multiprecision::fabs()</a>, <a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a67093ef481c51d384606486c41002baa">oomph::AssemblyHandler::get_all_vectors_and_matrices()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>, <a class="el" href="../../da/dc6/level2__cplx__impl_8h.html#a8d334fd8388055a029936c59d361ff00">m</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt()</a>, <a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a670b34aab05bfe0b96d0e0fabf583c7a">oomph::OomphCommunicator::my_rank()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof()</a>, <a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html#a09213be8f4aa009e0366460a7ed78e68">oomph::AssemblyHandler::ndof()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">oomph::Mesh::nelement()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad1a1ffc2bd685377ce7213452876b127">Numerical_zero_for_sparse_assembly</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, <a class="el" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#a4a82243b0ce4c28469a290fe2d7cd2c4">oomph::pause()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aedefa8337ace6043c2fdfd5a2d19afd3">Pause_at_end_of_sparse_assembly</a>, <a class="el" href="../../db/ddc/benchVecAdd_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>, <a class="el" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">oomph::TimingHelpers::timer()</a>, <a class="el" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a>, and <a class="el" href="../../d1/d62/namespaceEigen.html#a242ccf5e6e80154bbf36d63acf6e458a">Eigen::value</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab9cdd18180be05e4d46bfdbc1acbdbd3">sparse_assemble_row_or_column_compressed()</a>.</p>

</div>
</div>
<a id="a64b890295532c3a7ff5ad4e4dd5d56e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64b890295532c3a7ff5ad4e4dd5d56e3">&#9670;&nbsp;</a></span>steady_newton_solve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::steady_newton_solve </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> const &amp;&#160;</td>
          <td class="paramname"><em>max_adapt</em> = <code>0</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Solve a steady problem using adaptive Newton's method, but in the context of an overall unstady problem, perhaps to determine an initial condition. This is achieved by setting the weights in the timesteppers to be zero which has the effect of rendering them steady timesteppers. The optional argument max_adapt specifies the max. number of adaptations of all refineable submeshes are performed to achieve the the error targets specified in the refineable submeshes.</p>
<p>Solve a steady problem, in the context of an overall unsteady problem. This is achieved by setting the weights in the timesteppers to be zero which has the effect of rendering them steady timesteppers The optional argument max_adapt specifies the max. number of adaptations of all refineable submeshes are performed to achieve the the error targets specified in the refineable submeshes. </p>
<div class="fragment"><div class="line"><a name="l09293"></a><span class="lineno"> 9293</span>&#160;  {</div>
<div class="line"><a name="l09294"></a><span class="lineno"> 9294</span>&#160;    <span class="comment">// Find out how many timesteppers there are</span></div>
<div class="line"><a name="l09295"></a><span class="lineno"> 9295</span>&#160;    <span class="keywordtype">unsigned</span> n_time_steppers = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ace3cdf55009c3bff21d2b7d3706d522a">ntime_stepper</a>();</div>
<div class="line"><a name="l09296"></a><span class="lineno"> 9296</span>&#160; </div>
<div class="line"><a name="l09297"></a><span class="lineno"> 9297</span>&#160;    <span class="comment">// Vector of bools to store the is_steady status of the various</span></div>
<div class="line"><a name="l09298"></a><span class="lineno"> 9298</span>&#160;    <span class="comment">// timesteppers when we came in here</span></div>
<div class="line"><a name="l09299"></a><span class="lineno"> 9299</span>&#160;    std::vector&lt;bool&gt; was_steady(n_time_steppers);</div>
<div class="line"><a name="l09300"></a><span class="lineno"> 9300</span>&#160; </div>
<div class="line"><a name="l09301"></a><span class="lineno"> 9301</span>&#160;    <span class="comment">// Loop over them all and make them (temporarily) static</span></div>
<div class="line"><a name="l09302"></a><span class="lineno"> 9302</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_time_steppers; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l09303"></a><span class="lineno"> 9303</span>&#160;    {</div>
<div class="line"><a name="l09304"></a><span class="lineno"> 9304</span>&#160;      was_steady[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)-&gt;<a class="code" href="../../d5/d19/classoomph_1_1TimeStepper.html#ad341ba9e80265e1c26c1cda0f40c8292">is_steady</a>();</div>
<div class="line"><a name="l09305"></a><span class="lineno"> 9305</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)-&gt;<a class="code" href="../../d5/d19/classoomph_1_1TimeStepper.html#a81ea0ff2e66cef5e0184b616c608e418">make_steady</a>();</div>
<div class="line"><a name="l09306"></a><span class="lineno"> 9306</span>&#160;    }</div>
<div class="line"><a name="l09307"></a><span class="lineno"> 9307</span>&#160; </div>
<div class="line"><a name="l09308"></a><span class="lineno"> 9308</span>&#160;    <span class="keywordflow">try</span></div>
<div class="line"><a name="l09309"></a><span class="lineno"> 9309</span>&#160;    {</div>
<div class="line"><a name="l09310"></a><span class="lineno"> 9310</span>&#160;      <span class="comment">// Solve the non-linear problem with Newton&#39;s method</span></div>
<div class="line"><a name="l09311"></a><span class="lineno"> 9311</span>&#160;      <span class="keywordflow">if</span> (max_adapt == 0)</div>
<div class="line"><a name="l09312"></a><span class="lineno"> 9312</span>&#160;      {</div>
<div class="line"><a name="l09313"></a><span class="lineno"> 9313</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aae8cf62757e432b625ec81fad1559dc3">newton_solve</a>();</div>
<div class="line"><a name="l09314"></a><span class="lineno"> 9314</span>&#160;      }</div>
<div class="line"><a name="l09315"></a><span class="lineno"> 9315</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l09316"></a><span class="lineno"> 9316</span>&#160;      {</div>
<div class="line"><a name="l09317"></a><span class="lineno"> 9317</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aae8cf62757e432b625ec81fad1559dc3">newton_solve</a>(max_adapt);</div>
<div class="line"><a name="l09318"></a><span class="lineno"> 9318</span>&#160;      }</div>
<div class="line"><a name="l09319"></a><span class="lineno"> 9319</span>&#160;    }</div>
<div class="line"><a name="l09320"></a><span class="lineno"> 9320</span>&#160;    <span class="comment">// Catch any exceptions thrown in the Newton solver</span></div>
<div class="line"><a name="l09321"></a><span class="lineno"> 9321</span>&#160;    <span class="keywordflow">catch</span> (NewtonSolverError&amp; <a class="code" href="../../d9/d33/namespacecalibrate.html#a4dbebf21da853ac368a3a9af2fbab442">error</a>)</div>
<div class="line"><a name="l09322"></a><span class="lineno"> 9322</span>&#160;    {</div>
<div class="line"><a name="l09323"></a><span class="lineno"> 9323</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; std::endl</div>
<div class="line"><a name="l09324"></a><span class="lineno"> 9324</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;USER-DEFINED ERROR IN NEWTON SOLVER &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l09325"></a><span class="lineno"> 9325</span>&#160;      <span class="comment">// Check whether it&#39;s the linear solver</span></div>
<div class="line"><a name="l09326"></a><span class="lineno"> 9326</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d9/d33/namespacecalibrate.html#a4dbebf21da853ac368a3a9af2fbab442">error</a>.linear_solver_error)</div>
<div class="line"><a name="l09327"></a><span class="lineno"> 9327</span>&#160;      {</div>
<div class="line"><a name="l09328"></a><span class="lineno"> 9328</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;ERROR IN THE LINEAR SOLVER&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l09329"></a><span class="lineno"> 9329</span>&#160;      }</div>
<div class="line"><a name="l09330"></a><span class="lineno"> 9330</span>&#160;      <span class="comment">// Check to see whether we have reached Max_iterations</span></div>
<div class="line"><a name="l09331"></a><span class="lineno"> 9331</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d9/d33/namespacecalibrate.html#a4dbebf21da853ac368a3a9af2fbab442">error</a>.iterations == <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a52a58a98c3e2e7dbaefcfb1ee7830c35">Max_newton_iterations</a>)</div>
<div class="line"><a name="l09332"></a><span class="lineno"> 9332</span>&#160;      {</div>
<div class="line"><a name="l09333"></a><span class="lineno"> 9333</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;MAXIMUM NUMBER OF ITERATIONS (&quot;</span> &lt;&lt; <a class="code" href="../../d9/d33/namespacecalibrate.html#a4dbebf21da853ac368a3a9af2fbab442">error</a>.iterations</div>
<div class="line"><a name="l09334"></a><span class="lineno"> 9334</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;) REACHED WITHOUT CONVERGENCE &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l09335"></a><span class="lineno"> 9335</span>&#160;      }</div>
<div class="line"><a name="l09336"></a><span class="lineno"> 9336</span>&#160;      <span class="comment">// If not, it must be that we have exceeded the maximum residuals</span></div>
<div class="line"><a name="l09337"></a><span class="lineno"> 9337</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l09338"></a><span class="lineno"> 9338</span>&#160;      {</div>
<div class="line"><a name="l09339"></a><span class="lineno"> 9339</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;MAXIMUM RESIDUALS: &quot;</span> &lt;&lt; <a class="code" href="../../d9/d33/namespacecalibrate.html#a4dbebf21da853ac368a3a9af2fbab442">error</a>.maxres</div>
<div class="line"><a name="l09340"></a><span class="lineno"> 9340</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot; EXCEEDS PREDEFINED MAXIMUM &quot;</span> &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accb8811cdf32f14be497917e922c623e">Max_residuals</a></div>
<div class="line"><a name="l09341"></a><span class="lineno"> 9341</span>&#160;                   &lt;&lt; std::endl;</div>
<div class="line"><a name="l09342"></a><span class="lineno"> 9342</span>&#160;      }</div>
<div class="line"><a name="l09343"></a><span class="lineno"> 9343</span>&#160; </div>
<div class="line"><a name="l09344"></a><span class="lineno"> 9344</span>&#160;      <span class="comment">// Die horribly!!</span></div>
<div class="line"><a name="l09345"></a><span class="lineno"> 9345</span>&#160;      std::ostringstream error_stream;</div>
<div class="line"><a name="l09346"></a><span class="lineno"> 9346</span>&#160;      error_stream &lt;&lt; <span class="stringliteral">&quot;Error occured in Newton solver. &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l09347"></a><span class="lineno"> 9347</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l09348"></a><span class="lineno"> 9348</span>&#160;        error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l09349"></a><span class="lineno"> 9349</span>&#160;    }</div>
<div class="line"><a name="l09350"></a><span class="lineno"> 9350</span>&#160; </div>
<div class="line"><a name="l09351"></a><span class="lineno"> 9351</span>&#160; </div>
<div class="line"><a name="l09352"></a><span class="lineno"> 9352</span>&#160;    <span class="comment">// Reset the is_steady status of all timesteppers that</span></div>
<div class="line"><a name="l09353"></a><span class="lineno"> 9353</span>&#160;    <span class="comment">// weren&#39;t already steady when we came in here and reset their</span></div>
<div class="line"><a name="l09354"></a><span class="lineno"> 9354</span>&#160;    <span class="comment">// weights</span></div>
<div class="line"><a name="l09355"></a><span class="lineno"> 9355</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_time_steppers; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l09356"></a><span class="lineno"> 9356</span>&#160;    {</div>
<div class="line"><a name="l09357"></a><span class="lineno"> 9357</span>&#160;      <span class="keywordflow">if</span> (!was_steady[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><a name="l09358"></a><span class="lineno"> 9358</span>&#160;      {</div>
<div class="line"><a name="l09359"></a><span class="lineno"> 9359</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)-&gt;<a class="code" href="../../d5/d19/classoomph_1_1TimeStepper.html#aada05f89e86aae352bd5b32bfb173b18">undo_make_steady</a>();</div>
<div class="line"><a name="l09360"></a><span class="lineno"> 9360</span>&#160;      }</div>
<div class="line"><a name="l09361"></a><span class="lineno"> 9361</span>&#160;    }</div>
<div class="line"><a name="l09362"></a><span class="lineno"> 9362</span>&#160; </div>
<div class="line"><a name="l09363"></a><span class="lineno"> 9363</span>&#160;    <span class="comment">// Since we performed a steady solve, the history values</span></div>
<div class="line"><a name="l09364"></a><span class="lineno"> 9364</span>&#160;    <span class="comment">// now have to be set as if we had performed an impulsive start from</span></div>
<div class="line"><a name="l09365"></a><span class="lineno"> 9365</span>&#160;    <span class="comment">// the current solution. This ensures that the time-derivatives</span></div>
<div class="line"><a name="l09366"></a><span class="lineno"> 9366</span>&#160;    <span class="comment">// evaluate to zero even now that the timesteppers have been</span></div>
<div class="line"><a name="l09367"></a><span class="lineno"> 9367</span>&#160;    <span class="comment">// reactivated.</span></div>
<div class="line"><a name="l09368"></a><span class="lineno"> 9368</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a7d966c0bfd336699586057e476bd17d5">assign_initial_values_impulsive</a>();</div>
<div class="line"><a name="l09369"></a><span class="lineno"> 9369</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7d966c0bfd336699586057e476bd17d5">assign_initial_values_impulsive()</a>, <a class="el" href="../../d9/d33/namespacecalibrate.html#a4dbebf21da853ac368a3a9af2fbab442">calibrate::error</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html#ad341ba9e80265e1c26c1cda0f40c8292">oomph::TimeStepper::is_steady()</a>, <a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html#a81ea0ff2e66cef5e0184b616c608e418">oomph::TimeStepper::make_steady()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a52a58a98c3e2e7dbaefcfb1ee7830c35">Max_newton_iterations</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accb8811cdf32f14be497917e922c623e">Max_residuals</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aae8cf62757e432b625ec81fad1559dc3">newton_solve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ace3cdf55009c3bff21d2b7d3706d522a">ntime_stepper()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt()</a>, and <a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html#aada05f89e86aae352bd5b32bfb173b18">oomph::TimeStepper::undo_make_steady()</a>.</p>

</div>
</div>
<a id="ac3ed0463968bd0fef5d9b97bcb8ca163"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3ed0463968bd0fef5d9b97bcb8ca163">&#9670;&nbsp;</a></span>store_current_dof_values()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::store_current_dof_values </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Store the current values of the degrees of freedom. </p>
<p>Stored the current values of the dofs. </p>
<div class="fragment"><div class="line"><a name="l08608"></a><span class="lineno"> 8608</span>&#160;  {</div>
<div class="line"><a name="l08609"></a><span class="lineno"> 8609</span>&#160;    <span class="comment">// If memory has not been allocated, then allocated memory for the saved</span></div>
<div class="line"><a name="l08610"></a><span class="lineno"> 8610</span>&#160;    <span class="comment">// dofs</span></div>
<div class="line"><a name="l08611"></a><span class="lineno"> 8611</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aeef791a0158657ca7c298ffcb63ed54e">Saved_dof_pt</a> == 0)</div>
<div class="line"><a name="l08612"></a><span class="lineno"> 8612</span>&#160;    {</div>
<div class="line"><a name="l08613"></a><span class="lineno"> 8613</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aeef791a0158657ca7c298ffcb63ed54e">Saved_dof_pt</a> = <span class="keyword">new</span> Vector&lt;double&gt;;</div>
<div class="line"><a name="l08614"></a><span class="lineno"> 8614</span>&#160;    }</div>
<div class="line"><a name="l08615"></a><span class="lineno"> 8615</span>&#160; </div>
<div class="line"><a name="l08616"></a><span class="lineno"> 8616</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l08617"></a><span class="lineno"> 8617</span>&#160;    <span class="comment">// If the problem is distributed I have to do something different</span></div>
<div class="line"><a name="l08618"></a><span class="lineno"> 8618</span>&#160;    <span class="keywordflow">if</span> (Problem_has_been_distributed)</div>
<div class="line"><a name="l08619"></a><span class="lineno"> 8619</span>&#160;    {</div>
<div class="line"><a name="l08620"></a><span class="lineno"> 8620</span>&#160;      <span class="comment">// How many entries do we store locally?</span></div>
<div class="line"><a name="l08621"></a><span class="lineno"> 8621</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_row_local = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">nrow_local</a>();</div>
<div class="line"><a name="l08622"></a><span class="lineno"> 8622</span>&#160; </div>
<div class="line"><a name="l08623"></a><span class="lineno"> 8623</span>&#160;      <span class="comment">// Resize the vector</span></div>
<div class="line"><a name="l08624"></a><span class="lineno"> 8624</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aeef791a0158657ca7c298ffcb63ed54e">Saved_dof_pt</a>-&gt;resize(n_row_local);</div>
<div class="line"><a name="l08625"></a><span class="lineno"> 8625</span>&#160; </div>
<div class="line"><a name="l08626"></a><span class="lineno"> 8626</span>&#160;      <span class="comment">// Back &#39;em up</span></div>
<div class="line"><a name="l08627"></a><span class="lineno"> 8627</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_row_local; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l08628"></a><span class="lineno"> 8628</span>&#160;      {</div>
<div class="line"><a name="l08629"></a><span class="lineno"> 8629</span>&#160;        (*Saved_dof_pt)[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = *(this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l08630"></a><span class="lineno"> 8630</span>&#160;      }</div>
<div class="line"><a name="l08631"></a><span class="lineno"> 8631</span>&#160;    }</div>
<div class="line"><a name="l08632"></a><span class="lineno"> 8632</span>&#160;    <span class="comment">// Otherwise just store all the dofs</span></div>
<div class="line"><a name="l08633"></a><span class="lineno"> 8633</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l08634"></a><span class="lineno"> 8634</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l08635"></a><span class="lineno"> 8635</span>&#160;    {</div>
<div class="line"><a name="l08636"></a><span class="lineno"> 8636</span>&#160;      <span class="comment">// Find the number of dofs</span></div>
<div class="line"><a name="l08637"></a><span class="lineno"> 8637</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n_dof = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof</a>();</div>
<div class="line"><a name="l08638"></a><span class="lineno"> 8638</span>&#160; </div>
<div class="line"><a name="l08639"></a><span class="lineno"> 8639</span>&#160;      <span class="comment">// Resize the vector</span></div>
<div class="line"><a name="l08640"></a><span class="lineno"> 8640</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aeef791a0158657ca7c298ffcb63ed54e">Saved_dof_pt</a>-&gt;resize(n_dof);</div>
<div class="line"><a name="l08641"></a><span class="lineno"> 8641</span>&#160; </div>
<div class="line"><a name="l08642"></a><span class="lineno"> 8642</span>&#160;      <span class="comment">// Transfer the values over</span></div>
<div class="line"><a name="l08643"></a><span class="lineno"> 8643</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_dof; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l08644"></a><span class="lineno"> 8644</span>&#160;      {</div>
<div class="line"><a name="l08645"></a><span class="lineno"> 8645</span>&#160;        (*Saved_dof_pt)[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>] = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a74d71439b100fb5b66b94d1d69130f7c">dof</a>(<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>);</div>
<div class="line"><a name="l08646"></a><span class="lineno"> 8646</span>&#160;      }</div>
<div class="line"><a name="l08647"></a><span class="lineno"> 8647</span>&#160;    }</div>
<div class="line"><a name="l08648"></a><span class="lineno"> 8648</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a74d71439b100fb5b66b94d1d69130f7c">dof()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ade01b88db08dcec1706fe44eaa0090a3">Dof_distribution_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa9e4cfff7e1dc295036b0e58bc11ae75">Dof_pt</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">oomph::LinearAlgebraDistribution::nrow_local()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aeef791a0158657ca7c298ffcb63ed54e">Saved_dof_pt</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acbc0b0fc5d5cc76ce8384bc0bd815f26">calculate_predictions()</a>.</p>

</div>
</div>
<a id="a0f05445558a6128cb24fe441e156aaad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f05445558a6128cb24fe441e156aaad">&#9670;&nbsp;</a></span>symmetrise_eigenfunction_for_adaptive_pitchfork_tracking()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::symmetrise_eigenfunction_for_adaptive_pitchfork_tracking </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Virtual function that is used to symmetrise the problem so that the current solution exactly satisfies any symmetries within the system. Used when adpativly solving pitchfork detection problems when small asymmetries in the coarse solution can be magnified leading to very inaccurate answers on the fine mesh. This is always problem-specific and must be filled in by the user The default issues a warning </p>

<p>Reimplemented in <a class="el" href="../../d0/d33/classRefineablePorousChannelProblem.html#a6c7ab78338cfbe6f36f2be3d5e611d48">RefineablePorousChannelProblem&lt; ELEMENT &gt;</a>.</p>
<div class="fragment"><div class="line"><a name="l10060"></a><span class="lineno">10060</span>&#160;  {</div>
<div class="line"><a name="l10061"></a><span class="lineno">10061</span>&#160;    std::ostringstream warn_message;</div>
<div class="line"><a name="l10062"></a><span class="lineno">10062</span>&#160;    warn_message</div>
<div class="line"><a name="l10063"></a><span class="lineno">10063</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;Warning: This function is called after spatially adapting the\n&quot;</span></div>
<div class="line"><a name="l10064"></a><span class="lineno">10064</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;eigenfunction associated with a pitchfork bifurcation and should\n&quot;</span></div>
<div class="line"><a name="l10065"></a><span class="lineno">10065</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;ensure that the exact (anti-)symmetries of problem are enforced\n&quot;</span></div>
<div class="line"><a name="l10066"></a><span class="lineno">10066</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;within that eigenfunction. It is problem specific and must be\n&quot;</span></div>
<div class="line"><a name="l10067"></a><span class="lineno">10067</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;filled in by the user if required.\n&quot;</span></div>
<div class="line"><a name="l10068"></a><span class="lineno">10068</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;A sign of problems is if the slack paramter gets too large and\n&quot;</span></div>
<div class="line"><a name="l10069"></a><span class="lineno">10069</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;if the solution at the Pitchfork is not symmetric.\n&quot;</span>;</div>
<div class="line"><a name="l10070"></a><span class="lineno">10070</span>&#160;    OomphLibWarning(</div>
<div class="line"><a name="l10071"></a><span class="lineno">10071</span>&#160;      warn_message.str(),</div>
<div class="line"><a name="l10072"></a><span class="lineno">10072</span>&#160;      <span class="stringliteral">&quot;Problem::symmetrise_eigenfunction_for_adaptive_pitchfork_tracking()&quot;</span>,</div>
<div class="line"><a name="l10073"></a><span class="lineno">10073</span>&#160;      <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l10074"></a><span class="lineno">10074</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>.</p>

</div>
</div>
<a id="affda31840308a51d36324e6debe1bee7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#affda31840308a51d36324e6debe1bee7">&#9670;&nbsp;</a></span>time() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> &amp; Problem::time </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the current value of continuous time. </p>
<p>Return the current value of continuous time. If not Time object has been assigned, then throw an error </p>

<p>Reimplemented from <a class="el" href="../../df/d86/classoomph_1_1ExplicitTimeSteppableObject.html#a42fde674301963f01b8e41b3f333cc65">oomph::ExplicitTimeSteppableObject</a>.</p>
<div class="fragment"><div class="line"><a name="l11532"></a><span class="lineno">11532</span>&#160;  {</div>
<div class="line"><a name="l11533"></a><span class="lineno">11533</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae33fbf5f34a7d06d88ad2c98538bbbe8">Time_pt</a> == 0)</div>
<div class="line"><a name="l11534"></a><span class="lineno">11534</span>&#160;    {</div>
<div class="line"><a name="l11535"></a><span class="lineno">11535</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(<span class="stringliteral">&quot;Time object has not been set&quot;</span>,</div>
<div class="line"><a name="l11536"></a><span class="lineno">11536</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l11537"></a><span class="lineno">11537</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l11538"></a><span class="lineno">11538</span>&#160;    }</div>
<div class="line"><a name="l11539"></a><span class="lineno">11539</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l11540"></a><span class="lineno">11540</span>&#160;    {</div>
<div class="line"><a name="l11541"></a><span class="lineno">11541</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae33fbf5f34a7d06d88ad2c98538bbbe8">Time_pt</a>-&gt;<a class="code" href="../../d0/da1/classoomph_1_1Time.html#a6e28ea7a6664a2f5f5e1be871304a2c7">time</a>();</div>
<div class="line"><a name="l11542"></a><span class="lineno">11542</span>&#160;    }</div>
<div class="line"><a name="l11543"></a><span class="lineno">11543</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../d0/da1/classoomph_1_1Time.html#a6e28ea7a6664a2f5f5e1be871304a2c7">oomph::Time::time()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae33fbf5f34a7d06d88ad2c98538bbbe8">Time_pt</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/d73/classoomph_1_1WomersleyProblem.html#af87f80658aaadaee2d7c8d0c06ad159e">oomph::WomersleyProblem&lt; ELEMENT, DIM &gt;::actions_before_implicit_timestep()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acbc0b0fc5d5cc76ce8384bc0bd815f26">calculate_predictions()</a>, <a class="el" href="../../da/db6/classFSIRingProblem.html#acbb3bc5cd6d16cfee7a2f19a3b984ce7">FSIRingProblem::dynamic_run()</a>, <a class="el" href="../../dc/dcc/classoomph_1_1ODEProblem.html#a4f329a17f568a3a1a243ffee8a51886d">oomph::ODEProblem::exact_solution()</a>, <a class="el" href="../../dc/dcc/classoomph_1_1ODEProblem.html#a086e5fba680f4b583d5b959827a5218a">oomph::ODEProblem::get_error_norm()</a>, <a class="el" href="../../dc/dcc/classoomph_1_1ODEProblem.html#aa55d25af220a29969ad9b2ce91f8d56a">oomph::ODEProblem::my_set_initial_condition()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a4f6011ef141cc68598a9502052129a3f">read()</a>, <a class="el" href="../../d2/d5a/classoomph_1_1SolidICProblem.html#a60e1dccbc8627a07bfcb38a55b0669ca">oomph::SolidICProblem::set_static_initial_condition()</a>, <a class="el" href="../../de/da7/classoomph_1_1SegregatableFSIProblem.html#adaaaa08352182dc5e0a38c7003cb7a6b">oomph::SegregatableFSIProblem::t_spent_on_actual_solve()</a>, and <a class="el" href="../../dc/dcc/classoomph_1_1ODEProblem.html#a924cc82710d1cf2c63744fa6fc6b1bb0">oomph::ODEProblem::write_additional_trace_data()</a>.</p>

</div>
</div>
<a id="a951ba4d49d9a6788a7bd4e805caf3342"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a951ba4d49d9a6788a7bd4e805caf3342">&#9670;&nbsp;</a></span>time() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> Problem::time </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the current value of continuous time (const version) </p>
<p>Return the current value of continuous time. If not Time object has been assigned, then throw an error. Const version. </p>
<div class="fragment"><div class="line"><a name="l11550"></a><span class="lineno">11550</span>&#160;  {</div>
<div class="line"><a name="l11551"></a><span class="lineno">11551</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae33fbf5f34a7d06d88ad2c98538bbbe8">Time_pt</a> == 0)</div>
<div class="line"><a name="l11552"></a><span class="lineno">11552</span>&#160;    {</div>
<div class="line"><a name="l11553"></a><span class="lineno">11553</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(<span class="stringliteral">&quot;Time object has not been set&quot;</span>,</div>
<div class="line"><a name="l11554"></a><span class="lineno">11554</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l11555"></a><span class="lineno">11555</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l11556"></a><span class="lineno">11556</span>&#160;    }</div>
<div class="line"><a name="l11557"></a><span class="lineno">11557</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l11558"></a><span class="lineno">11558</span>&#160;    {</div>
<div class="line"><a name="l11559"></a><span class="lineno">11559</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae33fbf5f34a7d06d88ad2c98538bbbe8">Time_pt</a>-&gt;<a class="code" href="../../d0/da1/classoomph_1_1Time.html#a6e28ea7a6664a2f5f5e1be871304a2c7">time</a>();</div>
<div class="line"><a name="l11560"></a><span class="lineno">11560</span>&#160;    }</div>
<div class="line"><a name="l11561"></a><span class="lineno">11561</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../d0/da1/classoomph_1_1Time.html#a6e28ea7a6664a2f5f5e1be871304a2c7">oomph::Time::time()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae33fbf5f34a7d06d88ad2c98538bbbe8">Time_pt</a>.</p>

</div>
</div>
<a id="a7a42b89a67e0770c68493b9569bffe16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a42b89a67e0770c68493b9569bffe16">&#9670;&nbsp;</a></span>time_adaptive_newton_crash_on_solve_fail()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a>&amp; oomph::Problem::time_adaptive_newton_crash_on_solve_fail </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Access function for Time_adaptive_newton_crash_on_solve_fail. </p>
<div class="fragment"><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;    {</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a3e9aecf88bde320bc2d169b5f3c99fee">Time_adaptive_newton_crash_on_solve_fail</a>;</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a3e9aecf88bde320bc2d169b5f3c99fee">Time_adaptive_newton_crash_on_solve_fail</a>.</p>

</div>
</div>
<a id="a46894b13c582f322082dc471a2485980"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46894b13c582f322082dc471a2485980">&#9670;&nbsp;</a></span>time_pt() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/da1/classoomph_1_1Time.html">Time</a>*&amp; oomph::Problem::time_pt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return a pointer to the global time object. </p>
<div class="fragment"><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    {</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae33fbf5f34a7d06d88ad2c98538bbbe8">Time_pt</a>;</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae33fbf5f34a7d06d88ad2c98538bbbe8">Time_pt</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d9e/classoomph_1_1IMRByBDF.html#a1eb1b47643bf37e27c478c6987c7716d">oomph::IMRByBDF::actions_after_timestep()</a>, <a class="el" href="../../d3/d73/classoomph_1_1WomersleyProblem.html#af87f80658aaadaee2d7c8d0c06ad159e">oomph::WomersleyProblem&lt; ELEMENT, DIM &gt;::actions_before_implicit_timestep()</a>, <a class="el" href="../../d2/da2/classoomph_1_1PeriodicOrbitAssemblyHandler.html#a358d1749faa8ac7dd0de87340d878088">oomph::PeriodicOrbitAssemblyHandler&lt; NNODE_1D &gt;::adapt_temporal_mesh()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a63805c549e71b7c73107abe6001fae25">adaptive_unsteady_newton_solve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acbc0b0fc5d5cc76ce8384bc0bd815f26">calculate_predictions()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab8b63040a3c6deff68fb2128c2f7fef2">copy()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7c23771b77d6da7cbee3c3e3c050be73">doubly_adaptive_unsteady_newton_solve_helper()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a1756534851a763f35fd5372b4d3723e0">dump()</a>, <a class="el" href="../../da/db6/classFSIRingProblem.html#acbb3bc5cd6d16cfee7a2f19a3b984ce7">FSIRingProblem::dynamic_run()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a2eff0725bba4f2435bcc4797a9e59ab4">explicit_timestep()</a>, <a class="el" href="../../dc/d83/classFlowAroundCylinderProblem.html#af48274c0e0cf81f60b52c77be3b28601">FlowAroundCylinderProblem&lt; ELEMENT &gt;::FlowAroundCylinderProblem()</a>, <a class="el" href="../../dc/dcc/classoomph_1_1ODEProblem.html#a086e5fba680f4b583d5b959827a5218a">oomph::ODEProblem::get_error_norm()</a>, <a class="el" href="../../dc/dcc/classoomph_1_1ODEProblem.html#aa55d25af220a29969ad9b2ce91f8d56a">oomph::ODEProblem::my_set_initial_condition()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a4f6011ef141cc68598a9502052129a3f">read()</a>, <a class="el" href="../../d7/dcc/classTurekNonFSIProblem.html#aacb3214544ef81c2f8b49777457e8be6">TurekNonFSIProblem&lt; ELEMENT &gt;::TurekNonFSIProblem()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a4b015281f27d25ee0209cd9b467175b6">unsteady_newton_solve()</a>, <a class="el" href="../../de/da7/classoomph_1_1SegregatableFSIProblem.html#a17f019ebaf83e170219bf605a8554111">oomph::SegregatableFSIProblem::unsteady_segregated_solve()</a>, and <a class="el" href="../../dc/dcc/classoomph_1_1ODEProblem.html#a924cc82710d1cf2c63744fa6fc6b1bb0">oomph::ODEProblem::write_additional_trace_data()</a>.</p>

</div>
</div>
<a id="aa86b09eac493cfa9fcbe57734985ba19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa86b09eac493cfa9fcbe57734985ba19">&#9670;&nbsp;</a></span>time_pt() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/da1/classoomph_1_1Time.html">Time</a>* oomph::Problem::time_pt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return a pointer to the global time object (const version). </p>

<p>Reimplemented from <a class="el" href="../../df/d86/classoomph_1_1ExplicitTimeSteppableObject.html#a49ecd5e667dc16d4f2b991598d311b36">oomph::ExplicitTimeSteppableObject</a>.</p>
<div class="fragment"><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;    {</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae33fbf5f34a7d06d88ad2c98538bbbe8">Time_pt</a>;</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae33fbf5f34a7d06d88ad2c98538bbbe8">Time_pt</a>.</p>

</div>
</div>
<a id="ad77413dc70a25d271f582ad3c3d7bf65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad77413dc70a25d271f582ad3c3d7bf65">&#9670;&nbsp;</a></span>time_stepper_pt() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html">TimeStepper</a>*&amp; oomph::Problem::time_stepper_pt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Access function for the pointer to the first (presumably only) timestepper </p>
<div class="fragment"><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;    {</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#af1e8f8a739453250eb3744fea2a3b983">Time_stepper_pt</a>.size() == 0)</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;      {</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(<span class="stringliteral">&quot;No timestepper allocated yet\n&quot;</span>,</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;      }</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#af1e8f8a739453250eb3744fea2a3b983">Time_stepper_pt</a>[0];</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af1e8f8a739453250eb3744fea2a3b983">Time_stepper_pt</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a63805c549e71b7c73107abe6001fae25">adaptive_unsteady_newton_solve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a05df1c91c6ccffa24e42fda85af156a1">add_time_stepper_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aee0d9902fd26b600c9519bea2dfc0f54">arc_length_step_solve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acc35de219c1c1032a14840021fd8a6b9">arc_length_step_solve_helper()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acbc0b0fc5d5cc76ce8384bc0bd815f26">calculate_predictions()</a>, <a class="el" href="../../d3/d00/classConvectionProblem.html#ae2ffcac64ed8c4bfcdfdf4aeec0b6f7f">ConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;::ConvectionProblem()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab8b63040a3c6deff68fb2128c2f7fef2">copy()</a>, <a class="el" href="../../d4/d8b/classElasticInterfaceProblem.html#ad92614ce2754af8f1cd7080274e43489">ElasticInterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;::ElasticInterfaceProblem()</a>, <a class="el" href="../../dc/d83/classFlowAroundCylinderProblem.html#af48274c0e0cf81f60b52c77be3b28601">FlowAroundCylinderProblem&lt; ELEMENT &gt;::FlowAroundCylinderProblem()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a0daf749053a1afb0bdea7faa583dd7c7">get_dvaluesdt()</a>, <a class="el" href="../../dd/d61/classHomogenisationProblem.html#a1224c22c4b4a4b64277b60d31da3bc52">HomogenisationProblem&lt; ELEMENT &gt;::HomogenisationProblem()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5f7e9e91eab83d600c94afdad532a6fb">initialise_dt()</a>, <a class="el" href="../../d9/d15/classInterfaceProblem.html#a2ecc265740dba1626344fc090fad5fa6">InterfaceProblem&lt; ELEMENT, TIMESTEPPER &gt;::InterfaceProblem()</a>, <a class="el" href="../../d4/db2/classLinearWaveProblem.html#a459a58b7afd588cfa78a5e1e98c3c41e">LinearWaveProblem&lt; ELEMENT, TIMESTEPPER &gt;::LinearWaveProblem()</a>, <a class="el" href="../../dc/dcc/classoomph_1_1ODEProblem.html#aa55d25af220a29969ad9b2ce91f8d56a">oomph::ODEProblem::my_set_initial_condition()</a>, <a class="el" href="../../dd/d71/classOscRingNStProblem.html#a33023787bdd34ada9fae40f1b32ca339">OscRingNStProblem&lt; ELEMENT &gt;::OscRingNStProblem()</a>, <a class="el" href="../../d6/da9/classRayleighProblem.html#a870eafe497219141a67fa06246ad41ee">RayleighProblem&lt; ELEMENT, TIMESTEPPER &gt;::RayleighProblem()</a>, <a class="el" href="../../d4/d68/classRefineableUnsteadyHeatProblem.html#a981eb6e1c3ac8386b02eeef299099d86">RefineableUnsteadyHeatProblem&lt; ELEMENT &gt;::RefineableUnsteadyHeatProblem()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a50d54d4b374ea6a8d76798f34b865944">set_timestepper_for_all_data()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a06cf96b1291774eb89517af10f80410a">solve_eigenproblem()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a64b890295532c3a7ff5ad4e4dd5d56e3">steady_newton_solve()</a>, <a class="el" href="../../de/da7/classoomph_1_1SegregatableFSIProblem.html#a8f8145df86358916df505e2b513caf6a">oomph::SegregatableFSIProblem::steady_segregated_solve()</a>, <a class="el" href="../../d7/d86/classSurfactantProblem.html#a7728f025db0a13dd910db96d6fb66832">SurfactantProblem&lt; ELEMENT, INTERFACE_ELEMENT &gt;::SurfactantProblem()</a>, <a class="el" href="../../d7/dcc/classTurekNonFSIProblem.html#aacb3214544ef81c2f8b49777457e8be6">TurekNonFSIProblem&lt; ELEMENT &gt;::TurekNonFSIProblem()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a4b015281f27d25ee0209cd9b467175b6">unsteady_newton_solve()</a>, <a class="el" href="../../de/da7/classoomph_1_1SegregatableFSIProblem.html#a17f019ebaf83e170219bf605a8554111">oomph::SegregatableFSIProblem::unsteady_segregated_solve()</a>, <a class="el" href="../../d8/d28/classUnsteadyHeatProblem.html#abd3a46eea132b1e5872be6a6309a51b2">UnsteadyHeatProblem&lt; ELEMENT &gt;::UnsteadyHeatProblem()</a>, and <a class="el" href="../../d3/d73/classoomph_1_1WomersleyProblem.html#adc4074cd09df4505feb27e22abb6922a">oomph::WomersleyProblem&lt; ELEMENT, DIM &gt;::WomersleyProblem()</a>.</p>

</div>
</div>
<a id="a3f952a57b5238978250849c04e2fcbdb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f952a57b5238978250849c04e2fcbdb">&#9670;&nbsp;</a></span>time_stepper_pt() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html">TimeStepper</a>* oomph::Problem::time_stepper_pt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Access function for the pointer to the first (presumably only) timestepper </p>
<div class="fragment"><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;    {</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#af1e8f8a739453250eb3744fea2a3b983">Time_stepper_pt</a>.size() == 0)</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;      {</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(<span class="stringliteral">&quot;No timestepper allocated yet\n&quot;</span>,</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;      }</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#af1e8f8a739453250eb3744fea2a3b983">Time_stepper_pt</a>[0];</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af1e8f8a739453250eb3744fea2a3b983">Time_stepper_pt</a>.</p>

</div>
</div>
<a id="a76cda2a0a02815a3de446723a2334293"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76cda2a0a02815a3de446723a2334293">&#9670;&nbsp;</a></span>time_stepper_pt() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html">TimeStepper</a>*&amp; oomph::Problem::time_stepper_pt </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return a pointer to the i-th timestepper. </p>
<div class="fragment"><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;    {</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#af1e8f8a739453250eb3744fea2a3b983">Time_stepper_pt</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af1e8f8a739453250eb3744fea2a3b983">Time_stepper_pt</a>.</p>

</div>
</div>
<a id="a56429d79e517d59a54cd49949b04d3ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56429d79e517d59a54cd49949b04d3ae">&#9670;&nbsp;</a></span>unrefine_uniformly() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> Problem::unrefine_uniformly </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Refine (all) refineable (sub)mesh(es) uniformly and rebuild problem. Return 0 for success, 1 for failure (if unrefinement has reached the coarsest permitted level)</p>
<p>Unrefine (all) refineable (sub)mesh(es) uniformly and rebuild problem. Return 0 for success, 1 for failure (if unrefinement has reached the coarsest permitted level) </p>
<div class="fragment"><div class="line"><a name="l15832"></a><span class="lineno">15832</span>&#160;  {</div>
<div class="line"><a name="l15833"></a><span class="lineno">15833</span>&#160;    <span class="comment">// Call actions_before_adapt()</span></div>
<div class="line"><a name="l15834"></a><span class="lineno">15834</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">actions_before_adapt</a>();</div>
<div class="line"><a name="l15835"></a><span class="lineno">15835</span>&#160; </div>
<div class="line"><a name="l15836"></a><span class="lineno">15836</span>&#160;    <span class="comment">// Has unrefinement been successful?</span></div>
<div class="line"><a name="l15837"></a><span class="lineno">15837</span>&#160;    <span class="keywordtype">unsigned</span> success_flag = 0;</div>
<div class="line"><a name="l15838"></a><span class="lineno">15838</span>&#160; </div>
<div class="line"><a name="l15839"></a><span class="lineno">15839</span>&#160;    <span class="comment">// Number of submeshes?</span></div>
<div class="line"><a name="l15840"></a><span class="lineno">15840</span>&#160;    <span class="keywordtype">unsigned</span> n_mesh = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>();</div>
<div class="line"><a name="l15841"></a><span class="lineno">15841</span>&#160; </div>
<div class="line"><a name="l15842"></a><span class="lineno">15842</span>&#160;    <span class="comment">// Single mesh:</span></div>
<div class="line"><a name="l15843"></a><span class="lineno">15843</span>&#160;    <span class="keywordflow">if</span> (n_mesh == 0)</div>
<div class="line"><a name="l15844"></a><span class="lineno">15844</span>&#160;    {</div>
<div class="line"><a name="l15845"></a><span class="lineno">15845</span>&#160;      <span class="comment">// Unrefine single mesh uniformly if possible</span></div>
<div class="line"><a name="l15846"></a><span class="lineno">15846</span>&#160;      <span class="keywordflow">if</span> (RefineableMeshBase* mmesh_pt =</div>
<div class="line"><a name="l15847"></a><span class="lineno">15847</span>&#160;            <span class="keyword">dynamic_cast&lt;</span>RefineableMeshBase*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(0)))</div>
<div class="line"><a name="l15848"></a><span class="lineno">15848</span>&#160;      {</div>
<div class="line"><a name="l15849"></a><span class="lineno">15849</span>&#160;        success_flag += mmesh_pt-&gt;unrefine_uniformly();</div>
<div class="line"><a name="l15850"></a><span class="lineno">15850</span>&#160;      }</div>
<div class="line"><a name="l15851"></a><span class="lineno">15851</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l15852"></a><span class="lineno">15852</span>&#160;      {</div>
<div class="line"><a name="l15853"></a><span class="lineno">15853</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Mesh cannot be unrefined uniformly &quot;</span></div>
<div class="line"><a name="l15854"></a><span class="lineno">15854</span>&#160;                   &lt;&lt; std::endl;</div>
<div class="line"><a name="l15855"></a><span class="lineno">15855</span>&#160;      }</div>
<div class="line"><a name="l15856"></a><span class="lineno">15856</span>&#160;    }</div>
<div class="line"><a name="l15857"></a><span class="lineno">15857</span>&#160;    <span class="comment">// Multiple submeshes</span></div>
<div class="line"><a name="l15858"></a><span class="lineno">15858</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l15859"></a><span class="lineno">15859</span>&#160;    {</div>
<div class="line"><a name="l15860"></a><span class="lineno">15860</span>&#160;      <span class="comment">// Loop over submeshes</span></div>
<div class="line"><a name="l15861"></a><span class="lineno">15861</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> imesh = 0; imesh &lt; n_mesh; imesh++)</div>
<div class="line"><a name="l15862"></a><span class="lineno">15862</span>&#160;      {</div>
<div class="line"><a name="l15863"></a><span class="lineno">15863</span>&#160;        <span class="comment">// Unrefine i-th submesh uniformly if possible</span></div>
<div class="line"><a name="l15864"></a><span class="lineno">15864</span>&#160;        <span class="keywordflow">if</span> (RefineableMeshBase* mmesh_pt =</div>
<div class="line"><a name="l15865"></a><span class="lineno">15865</span>&#160;              <span class="keyword">dynamic_cast&lt;</span>RefineableMeshBase*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(imesh)))</div>
<div class="line"><a name="l15866"></a><span class="lineno">15866</span>&#160;        {</div>
<div class="line"><a name="l15867"></a><span class="lineno">15867</span>&#160;          success_flag += mmesh_pt-&gt;unrefine_uniformly();</div>
<div class="line"><a name="l15868"></a><span class="lineno">15868</span>&#160;        }</div>
<div class="line"><a name="l15869"></a><span class="lineno">15869</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l15870"></a><span class="lineno">15870</span>&#160;        {</div>
<div class="line"><a name="l15871"></a><span class="lineno">15871</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Cannot unrefine mesh &quot;</span> &lt;&lt; imesh</div>
<div class="line"><a name="l15872"></a><span class="lineno">15872</span>&#160;                     &lt;&lt; std::endl;</div>
<div class="line"><a name="l15873"></a><span class="lineno">15873</span>&#160;        }</div>
<div class="line"><a name="l15874"></a><span class="lineno">15874</span>&#160;      }</div>
<div class="line"><a name="l15875"></a><span class="lineno">15875</span>&#160;      <span class="comment">// Rebuild the global mesh</span></div>
<div class="line"><a name="l15876"></a><span class="lineno">15876</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a266d4d1b2bd4a5cbc028ff5aba79508f">rebuild_global_mesh</a>();</div>
<div class="line"><a name="l15877"></a><span class="lineno">15877</span>&#160;    }</div>
<div class="line"><a name="l15878"></a><span class="lineno">15878</span>&#160; </div>
<div class="line"><a name="l15879"></a><span class="lineno">15879</span>&#160;    <span class="comment">// Any actions after the adaptation phase</span></div>
<div class="line"><a name="l15880"></a><span class="lineno">15880</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">actions_after_adapt</a>();</div>
<div class="line"><a name="l15881"></a><span class="lineno">15881</span>&#160; </div>
<div class="line"><a name="l15882"></a><span class="lineno">15882</span>&#160;    <span class="comment">// Do equation numbering</span></div>
<div class="line"><a name="l15883"></a><span class="lineno">15883</span>&#160;    <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot; Number of equations: &quot;</span> &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers</a>() &lt;&lt; std::endl;</div>
<div class="line"><a name="l15884"></a><span class="lineno">15884</span>&#160; </div>
<div class="line"><a name="l15885"></a><span class="lineno">15885</span>&#160;    <span class="comment">// Judge success</span></div>
<div class="line"><a name="l15886"></a><span class="lineno">15886</span>&#160;    <span class="keywordflow">if</span> (success_flag &gt; 0)</div>
<div class="line"><a name="l15887"></a><span class="lineno">15887</span>&#160;    {</div>
<div class="line"><a name="l15888"></a><span class="lineno">15888</span>&#160;      <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l15889"></a><span class="lineno">15889</span>&#160;    }</div>
<div class="line"><a name="l15890"></a><span class="lineno">15890</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l15891"></a><span class="lineno">15891</span>&#160;    {</div>
<div class="line"><a name="l15892"></a><span class="lineno">15892</span>&#160;      <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l15893"></a><span class="lineno">15893</span>&#160;    }</div>
<div class="line"><a name="l15894"></a><span class="lineno">15894</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">actions_after_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">actions_before_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh()</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a266d4d1b2bd4a5cbc028ff5aba79508f">rebuild_global_mesh()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d6b/three__d__mesh__dist_8cc.html#a3e9491dd4f7081f92d170df562503838">parallel_test()</a>.</p>

</div>
</div>
<a id="ac552ccdf3b91079a3c8d223fc5ba3bda"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac552ccdf3b91079a3c8d223fc5ba3bda">&#9670;&nbsp;</a></span>unrefine_uniformly() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> Problem::unrefine_uniformly </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>i_mesh</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Do uniform refinement for submesh i_mesh without documentation. Return 0 for success, 1 for failure (if unrefinement has reached the coarsest permitted level)</p>
<p>Unrefine submesh i_mesh uniformly and rebuild problem. Return 0 for success, 1 for failure (if unrefinement has reached the coarsest permitted level) </p>
<div class="fragment"><div class="line"><a name="l15903"></a><span class="lineno">15903</span>&#160;  {</div>
<div class="line"><a name="l15904"></a><span class="lineno">15904</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">actions_before_adapt</a>();</div>
<div class="line"><a name="l15905"></a><span class="lineno">15905</span>&#160; </div>
<div class="line"><a name="l15906"></a><span class="lineno">15906</span>&#160;    <span class="comment">// Has unrefinement been successful?</span></div>
<div class="line"><a name="l15907"></a><span class="lineno">15907</span>&#160;    <span class="keywordtype">unsigned</span> success_flag = 0;</div>
<div class="line"><a name="l15908"></a><span class="lineno">15908</span>&#160; </div>
<div class="line"><a name="l15909"></a><span class="lineno">15909</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l15910"></a><span class="lineno">15910</span>&#160;    <span class="comment">// Number of submeshes?</span></div>
<div class="line"><a name="l15911"></a><span class="lineno">15911</span>&#160;    <span class="keywordflow">if</span> (i_mesh &gt;= <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>())</div>
<div class="line"><a name="l15912"></a><span class="lineno">15912</span>&#160;    {</div>
<div class="line"><a name="l15913"></a><span class="lineno">15913</span>&#160;      std::ostringstream error_message;</div>
<div class="line"><a name="l15914"></a><span class="lineno">15914</span>&#160;      error_message &lt;&lt; <span class="stringliteral">&quot;imesh &quot;</span> &lt;&lt; i_mesh</div>
<div class="line"><a name="l15915"></a><span class="lineno">15915</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot; is greater than the number of sub meshes &quot;</span></div>
<div class="line"><a name="l15916"></a><span class="lineno">15916</span>&#160;                    &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>() &lt;&lt; std::endl;</div>
<div class="line"><a name="l15917"></a><span class="lineno">15917</span>&#160; </div>
<div class="line"><a name="l15918"></a><span class="lineno">15918</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l15919"></a><span class="lineno">15919</span>&#160;        error_message.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l15920"></a><span class="lineno">15920</span>&#160;    }</div>
<div class="line"><a name="l15921"></a><span class="lineno">15921</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l15922"></a><span class="lineno">15922</span>&#160; </div>
<div class="line"><a name="l15923"></a><span class="lineno">15923</span>&#160;    <span class="comment">// Unrefine single mesh uniformly if possible</span></div>
<div class="line"><a name="l15924"></a><span class="lineno">15924</span>&#160;    <span class="keywordflow">if</span> (RefineableMeshBase* mmesh_pt =</div>
<div class="line"><a name="l15925"></a><span class="lineno">15925</span>&#160;          <span class="keyword">dynamic_cast&lt;</span>RefineableMeshBase*<span class="keyword">&gt;</span>(<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(i_mesh)))</div>
<div class="line"><a name="l15926"></a><span class="lineno">15926</span>&#160;    {</div>
<div class="line"><a name="l15927"></a><span class="lineno">15927</span>&#160;      success_flag += mmesh_pt-&gt;unrefine_uniformly();</div>
<div class="line"><a name="l15928"></a><span class="lineno">15928</span>&#160;    }</div>
<div class="line"><a name="l15929"></a><span class="lineno">15929</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l15930"></a><span class="lineno">15930</span>&#160;    {</div>
<div class="line"><a name="l15931"></a><span class="lineno">15931</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Info/Warning: Mesh cannot be unrefined uniformly &quot;</span></div>
<div class="line"><a name="l15932"></a><span class="lineno">15932</span>&#160;                 &lt;&lt; std::endl;</div>
<div class="line"><a name="l15933"></a><span class="lineno">15933</span>&#160;    }</div>
<div class="line"><a name="l15934"></a><span class="lineno">15934</span>&#160; </div>
<div class="line"><a name="l15935"></a><span class="lineno">15935</span>&#160;    <span class="comment">// Rebuild the global mesh</span></div>
<div class="line"><a name="l15936"></a><span class="lineno">15936</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a266d4d1b2bd4a5cbc028ff5aba79508f">rebuild_global_mesh</a>();</div>
<div class="line"><a name="l15937"></a><span class="lineno">15937</span>&#160; </div>
<div class="line"><a name="l15938"></a><span class="lineno">15938</span>&#160;    <span class="comment">// Any actions after the adaptation phase</span></div>
<div class="line"><a name="l15939"></a><span class="lineno">15939</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">actions_after_adapt</a>();</div>
<div class="line"><a name="l15940"></a><span class="lineno">15940</span>&#160; </div>
<div class="line"><a name="l15941"></a><span class="lineno">15941</span>&#160;    <span class="comment">// Do equation numbering</span></div>
<div class="line"><a name="l15942"></a><span class="lineno">15942</span>&#160;    <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Number of equations: &quot;</span> &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers</a>() &lt;&lt; std::endl;</div>
<div class="line"><a name="l15943"></a><span class="lineno">15943</span>&#160; </div>
<div class="line"><a name="l15944"></a><span class="lineno">15944</span>&#160;    <span class="comment">// Judge success</span></div>
<div class="line"><a name="l15945"></a><span class="lineno">15945</span>&#160;    <span class="keywordflow">if</span> (success_flag &gt; 0)</div>
<div class="line"><a name="l15946"></a><span class="lineno">15946</span>&#160;    {</div>
<div class="line"><a name="l15947"></a><span class="lineno">15947</span>&#160;      <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l15948"></a><span class="lineno">15948</span>&#160;    }</div>
<div class="line"><a name="l15949"></a><span class="lineno">15949</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l15950"></a><span class="lineno">15950</span>&#160;    {</div>
<div class="line"><a name="l15951"></a><span class="lineno">15951</span>&#160;      <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l15952"></a><span class="lineno">15952</span>&#160;    }</div>
<div class="line"><a name="l15953"></a><span class="lineno">15953</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ada40ec6730506c01109622c8383fe36e">actions_after_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6130d5c9a762cdd1569919a601620796">actions_before_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a266d4d1b2bd4a5cbc028ff5aba79508f">rebuild_global_mesh()</a>.</p>

</div>
</div>
<a id="aff7bcab5505ba482a8c9ba7bace68bc0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff7bcab5505ba482a8c9ba7bace68bc0">&#9670;&nbsp;</a></span>unset_analytic_dparameter()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Problem::unset_analytic_dparameter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a> *const &amp;&#160;</td>
          <td class="paramname"><em>parameter_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Function to turn off analytic calculation of the parameter derivatives in continuation and bifurcation detection problems </p>
<div class="fragment"><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      <span class="comment">// Find the iterator to the parameter</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      std::map&lt;double*, bool&gt;::iterator it =</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae22f10c348ef8afeb1bfd8609cd6a319">Calculate_dparameter_analytic</a>.find(parameter_pt);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      <span class="comment">// If the parameter has been found, erase it</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      <span class="keywordflow">if</span> (it != <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae22f10c348ef8afeb1bfd8609cd6a319">Calculate_dparameter_analytic</a>.end())</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      {</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ae22f10c348ef8afeb1bfd8609cd6a319">Calculate_dparameter_analytic</a>.erase(it);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      }</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae22f10c348ef8afeb1bfd8609cd6a319">Calculate_dparameter_analytic</a>.</p>

</div>
</div>
<a id="accd672b3da8c5bf28ad6bd856e28d1cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#accd672b3da8c5bf28ad6bd856e28d1cf">&#9670;&nbsp;</a></span>unset_analytic_hessian_products()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Problem::unset_analytic_hessian_products </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Function to turn off analytic calculation of the parameter derivatives in continuation and bifurcation detection problems </p>
<div class="fragment"><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    {</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ac353f1325a3b411b30fbc19314cc18ce">Calculate_hessian_products_analytic</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac353f1325a3b411b30fbc19314cc18ce">Calculate_hessian_products_analytic</a>.</p>

</div>
</div>
<a id="adb4d5d80b18ea103f71c8013e3384766"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb4d5d80b18ea103f71c8013e3384766">&#9670;&nbsp;</a></span>unsteady_newton_solve() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::unsteady_newton_solve </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>dt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Advance time by dt and solve by Newton's method. This version always shifts time values</p>
<p>Do one timestep of size dt using Newton's method with the specified tolerance and linear solver defined as member data of the Problem class. This will be the most commonly used version of unsteady_newton_solve, in which the time values are always shifted This does not include any kind of adaptativity. If the solution fails to converge the program will end. </p>
<div class="fragment"><div class="line"><a name="l10954"></a><span class="lineno">10954</span>&#160;  {</div>
<div class="line"><a name="l10955"></a><span class="lineno">10955</span>&#160;    <span class="comment">// We shift the values, so shift_values is true</span></div>
<div class="line"><a name="l10956"></a><span class="lineno">10956</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#adb4d5d80b18ea103f71c8013e3384766">unsteady_newton_solve</a>(dt, <span class="keyword">true</span>);</div>
<div class="line"><a name="l10957"></a><span class="lineno">10957</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7c23771b77d6da7cbee3c3e3c050be73">doubly_adaptive_unsteady_newton_solve_helper()</a>, <a class="el" href="../../da/db6/classFSIRingProblem.html#acbb3bc5cd6d16cfee7a2f19a3b984ce7">FSIRingProblem::dynamic_run()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a31d279b8e62fc676f25b9b347f4ffd8b">unsteady_newton_solve()</a>.</p>

</div>
</div>
<a id="a4b015281f27d25ee0209cd9b467175b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b015281f27d25ee0209cd9b467175b6">&#9670;&nbsp;</a></span>unsteady_newton_solve() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::unsteady_newton_solve </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;&#160;</td>
          <td class="paramname"><em>shift_values</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Advance time by dt and solve the system, using Newton's method. The boolean flag is used to control whether the time values should be shifted. If it is true the current data values will be shifted (copied to the locations where there are stored as previous timesteps) before solution.</p>
<p>Do one timestep forward of size dt using Newton's method with the specified tolerance and linear solver defined via member data of the Problem class. The boolean flag shift_values is used to control whether the time values should be shifted or not. </p>
<div class="fragment"><div class="line"><a name="l10968"></a><span class="lineno">10968</span>&#160;  {</div>
<div class="line"><a name="l10969"></a><span class="lineno">10969</span>&#160;    <span class="comment">// Shift the time values and the dts, according to the control flag</span></div>
<div class="line"><a name="l10970"></a><span class="lineno">10970</span>&#160;    <span class="keywordflow">if</span> (shift_values)</div>
<div class="line"><a name="l10971"></a><span class="lineno">10971</span>&#160;    {</div>
<div class="line"><a name="l10972"></a><span class="lineno">10972</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a3d3108a38cfbed4087f5b8eb601f38a2">shift_time_values</a>();</div>
<div class="line"><a name="l10973"></a><span class="lineno">10973</span>&#160;    }</div>
<div class="line"><a name="l10974"></a><span class="lineno">10974</span>&#160; </div>
<div class="line"><a name="l10975"></a><span class="lineno">10975</span>&#160;    <span class="comment">// Advance global time and set current value of dt</span></div>
<div class="line"><a name="l10976"></a><span class="lineno">10976</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a46894b13c582f322082dc471a2485980">time_pt</a>()-&gt;<a class="code" href="../../d0/da1/classoomph_1_1Time.html#a6e28ea7a6664a2f5f5e1be871304a2c7">time</a>() += dt;</div>
<div class="line"><a name="l10977"></a><span class="lineno">10977</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a46894b13c582f322082dc471a2485980">time_pt</a>()-&gt;<a class="code" href="../../d0/da1/classoomph_1_1Time.html#a2c684e0a69db7adde90f1f052e424a6b">dt</a>() = dt;</div>
<div class="line"><a name="l10978"></a><span class="lineno">10978</span>&#160; </div>
<div class="line"><a name="l10979"></a><span class="lineno">10979</span>&#160;    <span class="comment">// Find out how many timesteppers there are</span></div>
<div class="line"><a name="l10980"></a><span class="lineno">10980</span>&#160;    <span class="keywordtype">unsigned</span> n_time_steppers = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ace3cdf55009c3bff21d2b7d3706d522a">ntime_stepper</a>();</div>
<div class="line"><a name="l10981"></a><span class="lineno">10981</span>&#160; </div>
<div class="line"><a name="l10982"></a><span class="lineno">10982</span>&#160;    <span class="comment">// Loop over them all and set the weights</span></div>
<div class="line"><a name="l10983"></a><span class="lineno">10983</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_time_steppers; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l10984"></a><span class="lineno">10984</span>&#160;    {</div>
<div class="line"><a name="l10985"></a><span class="lineno">10985</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)-&gt;<a class="code" href="../../d5/d19/classoomph_1_1TimeStepper.html#a028fa3a8d3c6db6b0ddf580cb0468d55">set_weights</a>();</div>
<div class="line"><a name="l10986"></a><span class="lineno">10986</span>&#160;    }</div>
<div class="line"><a name="l10987"></a><span class="lineno">10987</span>&#160; </div>
<div class="line"><a name="l10988"></a><span class="lineno">10988</span>&#160;    <span class="comment">// Run the individual timesteppers actions before timestep. These need to</span></div>
<div class="line"><a name="l10989"></a><span class="lineno">10989</span>&#160;    <span class="comment">// be before the problem&#39;s actions_before_implicit_timestep so that the</span></div>
<div class="line"><a name="l10990"></a><span class="lineno">10990</span>&#160;    <span class="comment">// boundary conditions are set consistently.</span></div>
<div class="line"><a name="l10991"></a><span class="lineno">10991</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_time_steppers; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l10992"></a><span class="lineno">10992</span>&#160;    {</div>
<div class="line"><a name="l10993"></a><span class="lineno">10993</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)-&gt;<a class="code" href="../../d5/d19/classoomph_1_1TimeStepper.html#a36cbcee0c1127085ba3aa2331bfc0f74">actions_before_timestep</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l10994"></a><span class="lineno">10994</span>&#160;    }</div>
<div class="line"><a name="l10995"></a><span class="lineno">10995</span>&#160; </div>
<div class="line"><a name="l10996"></a><span class="lineno">10996</span>&#160;    <span class="comment">// Now update anything that needs updating before the timestep</span></div>
<div class="line"><a name="l10997"></a><span class="lineno">10997</span>&#160;    <span class="comment">// This could be time-dependent boundary conditions, for example.</span></div>
<div class="line"><a name="l10998"></a><span class="lineno">10998</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a4f19896906d2c0274ad6798cd3ac38dc">actions_before_implicit_timestep</a>();</div>
<div class="line"><a name="l10999"></a><span class="lineno">10999</span>&#160; </div>
<div class="line"><a name="l11000"></a><span class="lineno">11000</span>&#160;    <span class="keywordflow">try</span></div>
<div class="line"><a name="l11001"></a><span class="lineno">11001</span>&#160;    {</div>
<div class="line"><a name="l11002"></a><span class="lineno">11002</span>&#160;      <span class="comment">// Solve the non-linear problem for this timestep with Newton&#39;s method</span></div>
<div class="line"><a name="l11003"></a><span class="lineno">11003</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aae8cf62757e432b625ec81fad1559dc3">newton_solve</a>();</div>
<div class="line"><a name="l11004"></a><span class="lineno">11004</span>&#160;    }</div>
<div class="line"><a name="l11005"></a><span class="lineno">11005</span>&#160;    <span class="comment">// Catch any exceptions thrown in the Newton solver</span></div>
<div class="line"><a name="l11006"></a><span class="lineno">11006</span>&#160;    <span class="keywordflow">catch</span> (NewtonSolverError&amp; <a class="code" href="../../d9/d33/namespacecalibrate.html#a4dbebf21da853ac368a3a9af2fbab442">error</a>)</div>
<div class="line"><a name="l11007"></a><span class="lineno">11007</span>&#160;    {</div>
<div class="line"><a name="l11008"></a><span class="lineno">11008</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; std::endl</div>
<div class="line"><a name="l11009"></a><span class="lineno">11009</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;USER-DEFINED ERROR IN NEWTON SOLVER &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l11010"></a><span class="lineno">11010</span>&#160;      <span class="comment">// Check whether it&#39;s the linear solver</span></div>
<div class="line"><a name="l11011"></a><span class="lineno">11011</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d9/d33/namespacecalibrate.html#a4dbebf21da853ac368a3a9af2fbab442">error</a>.linear_solver_error)</div>
<div class="line"><a name="l11012"></a><span class="lineno">11012</span>&#160;      {</div>
<div class="line"><a name="l11013"></a><span class="lineno">11013</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;ERROR IN THE LINEAR SOLVER&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l11014"></a><span class="lineno">11014</span>&#160;      }</div>
<div class="line"><a name="l11015"></a><span class="lineno">11015</span>&#160;      <span class="comment">// Check to see whether we have reached Max_iterations</span></div>
<div class="line"><a name="l11016"></a><span class="lineno">11016</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d9/d33/namespacecalibrate.html#a4dbebf21da853ac368a3a9af2fbab442">error</a>.iterations == <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a52a58a98c3e2e7dbaefcfb1ee7830c35">Max_newton_iterations</a>)</div>
<div class="line"><a name="l11017"></a><span class="lineno">11017</span>&#160;      {</div>
<div class="line"><a name="l11018"></a><span class="lineno">11018</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;MAXIMUM NUMBER OF ITERATIONS (&quot;</span> &lt;&lt; <a class="code" href="../../d9/d33/namespacecalibrate.html#a4dbebf21da853ac368a3a9af2fbab442">error</a>.iterations</div>
<div class="line"><a name="l11019"></a><span class="lineno">11019</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;) REACHED WITHOUT CONVERGENCE &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l11020"></a><span class="lineno">11020</span>&#160;      }</div>
<div class="line"><a name="l11021"></a><span class="lineno">11021</span>&#160;      <span class="comment">// If not, it must be that we have exceeded the maximum residuals</span></div>
<div class="line"><a name="l11022"></a><span class="lineno">11022</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l11023"></a><span class="lineno">11023</span>&#160;      {</div>
<div class="line"><a name="l11024"></a><span class="lineno">11024</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;MAXIMUM RESIDUALS: &quot;</span> &lt;&lt; <a class="code" href="../../d9/d33/namespacecalibrate.html#a4dbebf21da853ac368a3a9af2fbab442">error</a>.maxres</div>
<div class="line"><a name="l11025"></a><span class="lineno">11025</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot; EXCEEDS PREDEFINED MAXIMUM &quot;</span> &lt;&lt; <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accb8811cdf32f14be497917e922c623e">Max_residuals</a></div>
<div class="line"><a name="l11026"></a><span class="lineno">11026</span>&#160;                   &lt;&lt; std::endl;</div>
<div class="line"><a name="l11027"></a><span class="lineno">11027</span>&#160;      }</div>
<div class="line"><a name="l11028"></a><span class="lineno">11028</span>&#160;      <span class="comment">// Die horribly!!</span></div>
<div class="line"><a name="l11029"></a><span class="lineno">11029</span>&#160;      std::ostringstream error_stream;</div>
<div class="line"><a name="l11030"></a><span class="lineno">11030</span>&#160;      error_stream &lt;&lt; <span class="stringliteral">&quot;Error occured in unsteady Newton solver. &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l11031"></a><span class="lineno">11031</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l11032"></a><span class="lineno">11032</span>&#160;        error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l11033"></a><span class="lineno">11033</span>&#160;    }</div>
<div class="line"><a name="l11034"></a><span class="lineno">11034</span>&#160; </div>
<div class="line"><a name="l11035"></a><span class="lineno">11035</span>&#160;    <span class="comment">// Run the individual timesteppers actions, these need to be before the</span></div>
<div class="line"><a name="l11036"></a><span class="lineno">11036</span>&#160;    <span class="comment">// problem&#39;s actions_after_implicit_timestep so that the time step is</span></div>
<div class="line"><a name="l11037"></a><span class="lineno">11037</span>&#160;    <span class="comment">// finished before the problem does any auxiliary calculations (e.g. in</span></div>
<div class="line"><a name="l11038"></a><span class="lineno">11038</span>&#160;    <span class="comment">// semi-implicit micromagnetics the calculation of magnetostatic field).</span></div>
<div class="line"><a name="l11039"></a><span class="lineno">11039</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_time_steppers; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l11040"></a><span class="lineno">11040</span>&#160;    {</div>
<div class="line"><a name="l11041"></a><span class="lineno">11041</span>&#160;      <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)-&gt;<a class="code" href="../../d5/d19/classoomph_1_1TimeStepper.html#a3a0fabf83f9bdc89800cd3501df2c586">actions_after_timestep</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l11042"></a><span class="lineno">11042</span>&#160;    }</div>
<div class="line"><a name="l11043"></a><span class="lineno">11043</span>&#160; </div>
<div class="line"><a name="l11044"></a><span class="lineno">11044</span>&#160; </div>
<div class="line"><a name="l11045"></a><span class="lineno">11045</span>&#160;    <span class="comment">// Now update anything that needs updating after the timestep</span></div>
<div class="line"><a name="l11046"></a><span class="lineno">11046</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a012692496c968960f4ea27db4e89cc7d">actions_after_implicit_timestep</a>();</div>
<div class="line"><a name="l11047"></a><span class="lineno">11047</span>&#160;    <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a38d914a74e7998ddc74c205884d36d57">actions_after_implicit_timestep_and_error_estimation</a>();</div>
<div class="line"><a name="l11048"></a><span class="lineno">11048</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a012692496c968960f4ea27db4e89cc7d">actions_after_implicit_timestep()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a38d914a74e7998ddc74c205884d36d57">actions_after_implicit_timestep_and_error_estimation()</a>, <a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html#a3a0fabf83f9bdc89800cd3501df2c586">oomph::TimeStepper::actions_after_timestep()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a4f19896906d2c0274ad6798cd3ac38dc">actions_before_implicit_timestep()</a>, <a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html#a36cbcee0c1127085ba3aa2331bfc0f74">oomph::TimeStepper::actions_before_timestep()</a>, <a class="el" href="../../d0/da1/classoomph_1_1Time.html#a2c684e0a69db7adde90f1f052e424a6b">oomph::Time::dt()</a>, <a class="el" href="../../d9/d33/namespacecalibrate.html#a4dbebf21da853ac368a3a9af2fbab442">calibrate::error</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a52a58a98c3e2e7dbaefcfb1ee7830c35">Max_newton_iterations</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accb8811cdf32f14be497917e922c623e">Max_residuals</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aae8cf62757e432b625ec81fad1559dc3">newton_solve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ace3cdf55009c3bff21d2b7d3706d522a">ntime_stepper()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, <a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html#a028fa3a8d3c6db6b0ddf580cb0468d55">oomph::TimeStepper::set_weights()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a3d3108a38cfbed4087f5b8eb601f38a2">shift_time_values()</a>, <a class="el" href="../../d0/da1/classoomph_1_1Time.html#a6e28ea7a6664a2f5f5e1be871304a2c7">oomph::Time::time()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a46894b13c582f322082dc471a2485980">time_pt()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt()</a>.</p>

</div>
</div>
<a id="a31d279b8e62fc676f25b9b347f4ffd8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31d279b8e62fc676f25b9b347f4ffd8b">&#9670;&nbsp;</a></span>unsteady_newton_solve() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Problem::unsteady_newton_solve </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>max_adapt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;&#160;</td>
          <td class="paramname"><em>first_timestep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;&#160;</td>
          <td class="paramname"><em>shift</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Unsteady adaptive Newton solve: up to max_adapt adaptations of all refineable submeshes are performed to achieve the the error targets specified in the refineable submeshes. If first==true, the initial conditions are re-assigned after the mesh adaptations. Shifting of time can be suppressed by overwriting the default value of shift (true). [Shifting must be done if first_timestep==true because we're constantly re-assigning the initial conditions; if first_timestep==true and shift==false shifting is performed anyway and a warning is issued.</p>
<p>Do one timestep, dt, forward using Newton's method with specified tolerance and linear solver specified via member data. Keep adapting on all meshes to criteria specified in these meshes (up to max_adapt adaptations are performed). If first_timestep==true, re-set initial conditions after mesh adaptation. Shifting of time can be suppressed by overwriting the default value of shift (true). [Shifting must be done if first_timestep==true because we're constantly re-assigning the initial conditions; if first_timestep==true and shift==false shifting is performed anyway and a warning is issued. </p>
<div class="fragment"><div class="line"><a name="l16076"></a><span class="lineno">16076</span>&#160;  {</div>
<div class="line"><a name="l16077"></a><span class="lineno">16077</span>&#160;    <span class="comment">// Do shifting or not?</span></div>
<div class="line"><a name="l16078"></a><span class="lineno">16078</span>&#160;    <span class="keywordtype">bool</span> shift_it = shift;</div>
<div class="line"><a name="l16079"></a><span class="lineno">16079</span>&#160; </div>
<div class="line"><a name="l16080"></a><span class="lineno">16080</span>&#160;    <span class="comment">// Warning:</span></div>
<div class="line"><a name="l16081"></a><span class="lineno">16081</span>&#160;    <span class="keywordflow">if</span> (first_timestep &amp;&amp; (!shift) &amp;&amp; (!<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a83df3b5fcc3ebbae951021c8e7f03ef7">Default_set_initial_condition_called</a>))</div>
<div class="line"><a name="l16082"></a><span class="lineno">16082</span>&#160;    {</div>
<div class="line"><a name="l16083"></a><span class="lineno">16083</span>&#160;      shift_it = <span class="keyword">true</span>;</div>
<div class="line"><a name="l16084"></a><span class="lineno">16084</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a></div>
<div class="line"><a name="l16085"></a><span class="lineno">16085</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;\n\n===========================================================\n&quot;</span>;</div>
<div class="line"><a name="l16086"></a><span class="lineno">16086</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;                  ********  WARNING *********** \n&quot;</span>;</div>
<div class="line"><a name="l16087"></a><span class="lineno">16087</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a></div>
<div class="line"><a name="l16088"></a><span class="lineno">16088</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;===========================================================\n&quot;</span>;</div>
<div class="line"><a name="l16089"></a><span class="lineno">16089</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Problem::unsteady_newton_solve() called with &quot;</span></div>
<div class="line"><a name="l16090"></a><span class="lineno">16090</span>&#160;                 &lt;&lt; std::endl;</div>
<div class="line"><a name="l16091"></a><span class="lineno">16091</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;first_timestep: &quot;</span> &lt;&lt; first_timestep &lt;&lt; std::endl;</div>
<div class="line"><a name="l16092"></a><span class="lineno">16092</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;shift: &quot;</span> &lt;&lt; shift &lt;&lt; std::endl;</div>
<div class="line"><a name="l16093"></a><span class="lineno">16093</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;This doesn&#39;t make sense (shifting does have to be done&quot;</span></div>
<div class="line"><a name="l16094"></a><span class="lineno">16094</span>&#160;                 &lt;&lt; std::endl;</div>
<div class="line"><a name="l16095"></a><span class="lineno">16095</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;since we&#39;re constantly re-assigning the initial conditions&quot;</span></div>
<div class="line"><a name="l16096"></a><span class="lineno">16096</span>&#160;                 &lt;&lt; std::endl;</div>
<div class="line"><a name="l16097"></a><span class="lineno">16097</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a></div>
<div class="line"><a name="l16098"></a><span class="lineno">16098</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;\n===========================================================\n\n&quot;</span>;</div>
<div class="line"><a name="l16099"></a><span class="lineno">16099</span>&#160;    }</div>
<div class="line"><a name="l16100"></a><span class="lineno">16100</span>&#160; </div>
<div class="line"><a name="l16101"></a><span class="lineno">16101</span>&#160; </div>
<div class="line"><a name="l16102"></a><span class="lineno">16102</span>&#160;    <span class="comment">// Find the initial time</span></div>
<div class="line"><a name="l16103"></a><span class="lineno">16103</span>&#160;    <span class="keywordtype">double</span> initial_time = <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a46894b13c582f322082dc471a2485980">time_pt</a>()-&gt;<a class="code" href="../../d0/da1/classoomph_1_1Time.html#a6e28ea7a6664a2f5f5e1be871304a2c7">time</a>();</div>
<div class="line"><a name="l16104"></a><span class="lineno">16104</span>&#160; </div>
<div class="line"><a name="l16105"></a><span class="lineno">16105</span>&#160;    <span class="comment">// Max number of solves</span></div>
<div class="line"><a name="l16106"></a><span class="lineno">16106</span>&#160;    <span class="keywordtype">unsigned</span> max_solve = max_adapt + 1;</div>
<div class="line"><a name="l16107"></a><span class="lineno">16107</span>&#160; </div>
<div class="line"><a name="l16108"></a><span class="lineno">16108</span>&#160;    <span class="comment">// Adaptation loop</span></div>
<div class="line"><a name="l16109"></a><span class="lineno">16109</span>&#160;    <span class="comment">//----------------</span></div>
<div class="line"><a name="l16110"></a><span class="lineno">16110</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> isolve = 0; isolve &lt; max_solve; isolve++)</div>
<div class="line"><a name="l16111"></a><span class="lineno">16111</span>&#160;    {</div>
<div class="line"><a name="l16112"></a><span class="lineno">16112</span>&#160;      <span class="comment">// Only adapt after the first solve has been done!</span></div>
<div class="line"><a name="l16113"></a><span class="lineno">16113</span>&#160;      <span class="keywordflow">if</span> (isolve &gt; 0)</div>
<div class="line"><a name="l16114"></a><span class="lineno">16114</span>&#160;      {</div>
<div class="line"><a name="l16115"></a><span class="lineno">16115</span>&#160;        <span class="keywordtype">unsigned</span> n_refined;</div>
<div class="line"><a name="l16116"></a><span class="lineno">16116</span>&#160;        <span class="keywordtype">unsigned</span> n_unrefined;</div>
<div class="line"><a name="l16117"></a><span class="lineno">16117</span>&#160; </div>
<div class="line"><a name="l16118"></a><span class="lineno">16118</span>&#160;        <span class="comment">// Adapt problem</span></div>
<div class="line"><a name="l16119"></a><span class="lineno">16119</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a0b9e09ddfa2411f14fc723c3207decd1">adapt</a>(n_refined, n_unrefined);</div>
<div class="line"><a name="l16120"></a><span class="lineno">16120</span>&#160; </div>
<div class="line"><a name="l16121"></a><span class="lineno">16121</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l16122"></a><span class="lineno">16122</span>&#160;        <span class="comment">// Adaptation only converges if ALL the processes have no</span></div>
<div class="line"><a name="l16123"></a><span class="lineno">16123</span>&#160;        <span class="comment">// refinement or unrefinement to perform</span></div>
<div class="line"><a name="l16124"></a><span class="lineno">16124</span>&#160;        <span class="keywordtype">unsigned</span> total_refined = 0;</div>
<div class="line"><a name="l16125"></a><span class="lineno">16125</span>&#160;        <span class="keywordtype">unsigned</span> total_unrefined = 0;</div>
<div class="line"><a name="l16126"></a><span class="lineno">16126</span>&#160;        <span class="keywordflow">if</span> (Problem_has_been_distributed)</div>
<div class="line"><a name="l16127"></a><span class="lineno">16127</span>&#160;        {</div>
<div class="line"><a name="l16128"></a><span class="lineno">16128</span>&#160;          MPI_Allreduce(&amp;n_refined,</div>
<div class="line"><a name="l16129"></a><span class="lineno">16129</span>&#160;                        &amp;total_refined,</div>
<div class="line"><a name="l16130"></a><span class="lineno">16130</span>&#160;                        1,</div>
<div class="line"><a name="l16131"></a><span class="lineno">16131</span>&#160;                        MPI_UNSIGNED,</div>
<div class="line"><a name="l16132"></a><span class="lineno">16132</span>&#160;                        MPI_SUM,</div>
<div class="line"><a name="l16133"></a><span class="lineno">16133</span>&#160;                        this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">communicator_pt</a>()-&gt;mpi_comm());</div>
<div class="line"><a name="l16134"></a><span class="lineno">16134</span>&#160;          n_refined = total_refined;</div>
<div class="line"><a name="l16135"></a><span class="lineno">16135</span>&#160;          MPI_Allreduce(&amp;n_unrefined,</div>
<div class="line"><a name="l16136"></a><span class="lineno">16136</span>&#160;                        &amp;total_unrefined,</div>
<div class="line"><a name="l16137"></a><span class="lineno">16137</span>&#160;                        1,</div>
<div class="line"><a name="l16138"></a><span class="lineno">16138</span>&#160;                        MPI_UNSIGNED,</div>
<div class="line"><a name="l16139"></a><span class="lineno">16139</span>&#160;                        MPI_SUM,</div>
<div class="line"><a name="l16140"></a><span class="lineno">16140</span>&#160;                        this-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">communicator_pt</a>()-&gt;mpi_comm());</div>
<div class="line"><a name="l16141"></a><span class="lineno">16141</span>&#160;          n_unrefined = total_unrefined;</div>
<div class="line"><a name="l16142"></a><span class="lineno">16142</span>&#160;        }</div>
<div class="line"><a name="l16143"></a><span class="lineno">16143</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l16144"></a><span class="lineno">16144</span>&#160; </div>
<div class="line"><a name="l16145"></a><span class="lineno">16145</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;---&gt; &quot;</span> &lt;&lt; n_refined &lt;&lt; <span class="stringliteral">&quot; elements were refined, and &quot;</span></div>
<div class="line"><a name="l16146"></a><span class="lineno">16146</span>&#160;                   &lt;&lt; n_unrefined &lt;&lt; <span class="stringliteral">&quot; were unrefined, in total.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l16147"></a><span class="lineno">16147</span>&#160; </div>
<div class="line"><a name="l16148"></a><span class="lineno">16148</span>&#160;        <span class="comment">// Check convergence of adaptation cycle</span></div>
<div class="line"><a name="l16149"></a><span class="lineno">16149</span>&#160;        <span class="keywordflow">if</span> ((n_refined == 0) &amp;&amp; (n_unrefined == 0))</div>
<div class="line"><a name="l16150"></a><span class="lineno">16150</span>&#160;        {</div>
<div class="line"><a name="l16151"></a><span class="lineno">16151</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;\n \n Solution is fully converged in &quot;</span></div>
<div class="line"><a name="l16152"></a><span class="lineno">16152</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;Problem::unsteady_newton_solver() \n \n &quot;</span>;</div>
<div class="line"><a name="l16153"></a><span class="lineno">16153</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l16154"></a><span class="lineno">16154</span>&#160;        }</div>
<div class="line"><a name="l16155"></a><span class="lineno">16155</span>&#160; </div>
<div class="line"><a name="l16156"></a><span class="lineno">16156</span>&#160;        <span class="comment">// Reset the time</span></div>
<div class="line"><a name="l16157"></a><span class="lineno">16157</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a46894b13c582f322082dc471a2485980">time_pt</a>()-&gt;<a class="code" href="../../d0/da1/classoomph_1_1Time.html#a6e28ea7a6664a2f5f5e1be871304a2c7">time</a>() = initial_time;</div>
<div class="line"><a name="l16158"></a><span class="lineno">16158</span>&#160; </div>
<div class="line"><a name="l16159"></a><span class="lineno">16159</span>&#160;        <span class="comment">// Reset the inital condition on refined meshes. Note that because we</span></div>
<div class="line"><a name="l16160"></a><span class="lineno">16160</span>&#160;        <span class="comment">// have reset the global time to the initial time, the initial</span></div>
<div class="line"><a name="l16161"></a><span class="lineno">16161</span>&#160;        <span class="comment">// conditions are reset at time t=0 rather than at time t=dt</span></div>
<div class="line"><a name="l16162"></a><span class="lineno">16162</span>&#160;        <span class="keywordflow">if</span> (first_timestep)</div>
<div class="line"><a name="l16163"></a><span class="lineno">16163</span>&#160;        {</div>
<div class="line"><a name="l16164"></a><span class="lineno">16164</span>&#160;          <span class="comment">// Reset default set_initial_condition has been called flag to false</span></div>
<div class="line"><a name="l16165"></a><span class="lineno">16165</span>&#160;          <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a83df3b5fcc3ebbae951021c8e7f03ef7">Default_set_initial_condition_called</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l16166"></a><span class="lineno">16166</span>&#160; </div>
<div class="line"><a name="l16167"></a><span class="lineno">16167</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Re-setting initial condition &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l16168"></a><span class="lineno">16168</span>&#160;          <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#ad48be6d67071f7da5f6feb7c4fc918f0">set_initial_condition</a>();</div>
<div class="line"><a name="l16169"></a><span class="lineno">16169</span>&#160; </div>
<div class="line"><a name="l16170"></a><span class="lineno">16170</span>&#160;          <span class="comment">// If the default set_initial_condition function has been called,</span></div>
<div class="line"><a name="l16171"></a><span class="lineno">16171</span>&#160;          <span class="comment">// we must not shift the timevalues on the first timestep, as we</span></div>
<div class="line"><a name="l16172"></a><span class="lineno">16172</span>&#160;          <span class="comment">// will NOT be constantly re-assigning the initial condition</span></div>
<div class="line"><a name="l16173"></a><span class="lineno">16173</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a83df3b5fcc3ebbae951021c8e7f03ef7">Default_set_initial_condition_called</a>)</div>
<div class="line"><a name="l16174"></a><span class="lineno">16174</span>&#160;          {</div>
<div class="line"><a name="l16175"></a><span class="lineno">16175</span>&#160;            shift_it = <span class="keyword">false</span>;</div>
<div class="line"><a name="l16176"></a><span class="lineno">16176</span>&#160;          }</div>
<div class="line"><a name="l16177"></a><span class="lineno">16177</span>&#160;        }</div>
<div class="line"><a name="l16178"></a><span class="lineno">16178</span>&#160;      }</div>
<div class="line"><a name="l16179"></a><span class="lineno">16179</span>&#160; </div>
<div class="line"><a name="l16180"></a><span class="lineno">16180</span>&#160;      <span class="comment">// Now do the actual unsteady timestep</span></div>
<div class="line"><a name="l16181"></a><span class="lineno">16181</span>&#160;      <span class="comment">// If it&#39;s the first time around the loop, or the first timestep</span></div>
<div class="line"><a name="l16182"></a><span class="lineno">16182</span>&#160;      <span class="comment">// shift the timevalues, otherwise don&#39;t</span></div>
<div class="line"><a name="l16183"></a><span class="lineno">16183</span>&#160;      <span class="comment">// Note: we need to shift if it&#39;s the first timestep because</span></div>
<div class="line"><a name="l16184"></a><span class="lineno">16184</span>&#160;      <span class="comment">// we&#39;re constantly re-assigning the initial condition above!</span></div>
<div class="line"><a name="l16185"></a><span class="lineno">16185</span>&#160;      <span class="comment">// The only exception to this is if the default set_initial_condition</span></div>
<div class="line"><a name="l16186"></a><span class="lineno">16186</span>&#160;      <span class="comment">// function has been called, in which case we must NOT shift!</span></div>
<div class="line"><a name="l16187"></a><span class="lineno">16187</span>&#160;      <span class="keywordflow">if</span> ((isolve == 0) || (first_timestep))</div>
<div class="line"><a name="l16188"></a><span class="lineno">16188</span>&#160;      {</div>
<div class="line"><a name="l16189"></a><span class="lineno">16189</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#adb4d5d80b18ea103f71c8013e3384766">Problem::unsteady_newton_solve</a>(dt, shift_it);</div>
<div class="line"><a name="l16190"></a><span class="lineno">16190</span>&#160;      }</div>
<div class="line"><a name="l16191"></a><span class="lineno">16191</span>&#160;      <span class="comment">// Subsequent solve: Have shifted already -- don&#39;t do it again.</span></div>
<div class="line"><a name="l16192"></a><span class="lineno">16192</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l16193"></a><span class="lineno">16193</span>&#160;      {</div>
<div class="line"><a name="l16194"></a><span class="lineno">16194</span>&#160;        shift_it = <span class="keyword">false</span>;</div>
<div class="line"><a name="l16195"></a><span class="lineno">16195</span>&#160;        <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#adb4d5d80b18ea103f71c8013e3384766">Problem::unsteady_newton_solve</a>(dt, shift_it);</div>
<div class="line"><a name="l16196"></a><span class="lineno">16196</span>&#160;      }</div>
<div class="line"><a name="l16197"></a><span class="lineno">16197</span>&#160; </div>
<div class="line"><a name="l16198"></a><span class="lineno">16198</span>&#160;      <span class="keywordflow">if</span> (isolve == max_solve - 1)</div>
<div class="line"><a name="l16199"></a><span class="lineno">16199</span>&#160;      {</div>
<div class="line"><a name="l16200"></a><span class="lineno">16200</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a></div>
<div class="line"><a name="l16201"></a><span class="lineno">16201</span>&#160;          &lt;&lt; std::endl</div>
<div class="line"><a name="l16202"></a><span class="lineno">16202</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------------&quot;</span></div>
<div class="line"><a name="l16203"></a><span class="lineno">16203</span>&#160;          &lt;&lt; std::endl</div>
<div class="line"><a name="l16204"></a><span class="lineno">16204</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;Reached max. number of adaptations in \n&quot;</span></div>
<div class="line"><a name="l16205"></a><span class="lineno">16205</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;Problem::unsteady_newton_solver().\n&quot;</span></div>
<div class="line"><a name="l16206"></a><span class="lineno">16206</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------------&quot;</span></div>
<div class="line"><a name="l16207"></a><span class="lineno">16207</span>&#160;          &lt;&lt; std::endl</div>
<div class="line"><a name="l16208"></a><span class="lineno">16208</span>&#160;          &lt;&lt; std::endl;</div>
<div class="line"><a name="l16209"></a><span class="lineno">16209</span>&#160;      }</div>
<div class="line"><a name="l16210"></a><span class="lineno">16210</span>&#160; </div>
<div class="line"><a name="l16211"></a><span class="lineno">16211</span>&#160;    } <span class="comment">// End of adaptation loop</span></div>
<div class="line"><a name="l16212"></a><span class="lineno">16212</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a0b9e09ddfa2411f14fc723c3207decd1">adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">communicator_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a83df3b5fcc3ebbae951021c8e7f03ef7">Default_set_initial_condition_called</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad48be6d67071f7da5f6feb7c4fc918f0">set_initial_condition()</a>, <a class="el" href="../../d0/da1/classoomph_1_1Time.html#a6e28ea7a6664a2f5f5e1be871304a2c7">oomph::Time::time()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a46894b13c582f322082dc471a2485980">time_pt()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#adb4d5d80b18ea103f71c8013e3384766">unsteady_newton_solve()</a>.</p>

</div>
</div>
<a id="a438bf1c7aafffda56f2acb34ba027fdb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a438bf1c7aafffda56f2acb34ba027fdb">&#9670;&nbsp;</a></span>use_predictor_values_as_initial_guess()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a>&amp; oomph::Problem::use_predictor_values_as_initial_guess </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;    {</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/de5/classoomph_1_1Problem.html#afe6f5bb841832b3c4d1f06c2d939f4a6">Use_predictor_values_as_initial_guess</a>;</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#afe6f5bb841832b3c4d1f06c2d939f4a6">Use_predictor_values_as_initial_guess</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d9e/classoomph_1_1IMRByBDF.html#abc155a68889d297f732a083d911b4627">oomph::IMRByBDF::actions_before_timestep()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acbc0b0fc5d5cc76ce8384bc0bd815f26">calculate_predictions()</a>.</p>

</div>
</div>
<h2 class="groupheader">Friends And Related Function Documentation</h2>
<a id="a29d9c39e6a14d2a4cc4e0d7c716579fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29d9c39e6a14d2a4cc4e0d7c716579fe">&#9670;&nbsp;</a></span>AugmentedBlockFoldLinearSolver</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="../../dd/d4b/classoomph_1_1AugmentedBlockFoldLinearSolver.html">AugmentedBlockFoldLinearSolver</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a9ed88021ec449655c64191154dd236af">activate_bifurcation_tracking()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa4f954e46b84b13a2bb16a83b3f0ff83">activate_fold_tracking()</a>.</p>

</div>
</div>
<a id="a223dd55e02e905ce0ce98e98f50b7e57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a223dd55e02e905ce0ce98e98f50b7e57">&#9670;&nbsp;</a></span>AugmentedBlockPitchForkLinearSolver</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="../../de/d72/classoomph_1_1AugmentedBlockPitchForkLinearSolver.html">AugmentedBlockPitchForkLinearSolver</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a32e190795c94d11d2e206e62eb63994b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a32e190795c94d11d2e206e62eb63994b">&#9670;&nbsp;</a></span>BlockFoldLinearSolver</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class BlockFoldLinearSolver</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a199677d64d3b2f908690d10a2398b737"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a199677d64d3b2f908690d10a2398b737">&#9670;&nbsp;</a></span>BlockHopfLinearSolver</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="../../df/dbd/classoomph_1_1BlockHopfLinearSolver.html">BlockHopfLinearSolver</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5202944fe909268c20abcfb4576d147b">activate_hopf_tracking()</a>.</p>

</div>
</div>
<a id="aba62ac8cc057be07657972adc4a78b45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba62ac8cc057be07657972adc4a78b45">&#9670;&nbsp;</a></span>BlockPitchForkLinearSolver</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html">BlockPitchForkLinearSolver</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a66fd78008266a4023f450971af444508">activate_pitchfork_tracking()</a>.</p>

</div>
</div>
<a id="a1d79584bd556f960d5b92474681e0159"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d79584bd556f960d5b92474681e0159">&#9670;&nbsp;</a></span>FoldHandler</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="../../d4/dcb/classoomph_1_1FoldHandler.html">FoldHandler</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a9ed88021ec449655c64191154dd236af">activate_bifurcation_tracking()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa4f954e46b84b13a2bb16a83b3f0ff83">activate_fold_tracking()</a>.</p>

</div>
</div>
<a id="a5653c9ce9d673e348e945594469ce0d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5653c9ce9d673e348e945594469ce0d3">&#9670;&nbsp;</a></span>HopfHandler</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="../../d4/da2/classoomph_1_1HopfHandler.html">HopfHandler</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5202944fe909268c20abcfb4576d147b">activate_hopf_tracking()</a>.</p>

</div>
</div>
<a id="a2cbe986bcd27c28d5de7ada068d3d94c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2cbe986bcd27c28d5de7ada068d3d94c">&#9670;&nbsp;</a></span>PeriodicOrbitAssemblyHandler</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;unsigned NNODE_1D&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="../../d2/da2/classoomph_1_1PeriodicOrbitAssemblyHandler.html">PeriodicOrbitAssemblyHandler</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a58bcd2e5d47842c64018e2c842bff302"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58bcd2e5d47842c64018e2c842bff302">&#9670;&nbsp;</a></span>PitchForkHandler</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html">PitchForkHandler</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a66fd78008266a4023f450971af444508">activate_pitchfork_tracking()</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a01d7376ab9cc06e4d5619b34fd39dee2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01d7376ab9cc06e4d5619b34fd39dee2">&#9670;&nbsp;</a></span>Always_take_one_newton_step</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::Problem::Always_take_one_newton_step</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Boolean to indicate whether a Newton step should be taken even if the initial residuals are below the required tolerance </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aae8cf62757e432b625ec81fad1559dc3">newton_solve()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7b86783463433cc9c4cc382b1b40f0e1">newton_solve_continuation()</a>.</p>

</div>
</div>
<a id="a8109bf56e9203d248ae30a50bb9cfe90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8109bf56e9203d248ae30a50bb9cfe90">&#9670;&nbsp;</a></span>Arc_length_step_taken</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::Problem::Arc_length_step_taken</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Boolean to indicate whether an arc-length step has been taken. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aee0d9902fd26b600c9519bea2dfc0f54">arc_length_step_solve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acc35de219c1c1032a14840021fd8a6b9">arc_length_step_solve_helper()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6477df6e8184dc78e9d9ff82c7627cef">reset_arc_length_parameters()</a>.</p>

</div>
</div>
<a id="aefc325e2e116c389a24c9871e41bdb55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aefc325e2e116c389a24c9871e41bdb55">&#9670;&nbsp;</a></span>Assembly_handler_pt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html">AssemblyHandler</a>* oomph::Problem::Assembly_handler_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a9ed88021ec449655c64191154dd236af">activate_bifurcation_tracking()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa4f954e46b84b13a2bb16a83b3f0ff83">activate_fold_tracking()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5202944fe909268c20abcfb4576d147b">activate_hopf_tracking()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a66fd78008266a4023f450971af444508">activate_pitchfork_tracking()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5e60c7b47591bca6b20b0612e119983">adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a937937da4763c3ed31a84f6b65df6f51">bifurcation_parameter_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#adfa6431916fd73b661d8a62706d5137f">doc_errors()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a82c795d158c119cfde04089b516d6711">get_bifurcation_eigenfunction()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#adc456017cfc4fb4ae6f522973e50f496">get_derivative_wrt_global_parameter()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a4e59f1c854d1258aa2b4eca218405731">get_eigenproblem_matrices()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a497518acb5d30a28a253890c3d2a5da2">get_hessian_vector_products()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af660c2c0d10eaea1972314ce80de000e">get_jacobian()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a0103fe1a09ecf7e23a9083b35ef07aac">get_residuals()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a350e611af4847eabfa1d531b14b4439c">p_adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad9d44f0ef936fb62f0ce41dd200494ac">Problem()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a0b6b29c5e2ae9d4a22dac5b4494b7bc4">reset_assembly_handler_to_default()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aae085671047b62a98ef310d66cc3f412">setup_element_count_per_dof()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa90e41a626a91ee113989afa847c1117">sparse_assemble_row_or_column_compressed_with_lists()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7ba1b95df63f6e7d746a6dae641daa33">sparse_assemble_row_or_column_compressed_with_maps()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a23465a0b1944a4bd31b9e0add9cc9875">sparse_assemble_row_or_column_compressed_with_two_arrays()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5bc761a0dee39437b2ebeba75079856f">sparse_assemble_row_or_column_compressed_with_two_vectors()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7eb5e0e3dc02fa26eec9d023b80b9603">sparse_assemble_row_or_column_compressed_with_vectors_of_pairs()</a>.</p>

</div>
</div>
<a id="a08dfc704030bb65cea3d9784c5271af0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08dfc704030bb65cea3d9784c5271af0">&#9670;&nbsp;</a></span>Bifurcation_detection</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::Problem::Bifurcation_detection</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Boolean to control bifurcation detection via determinant of Jacobian. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acc35de219c1c1032a14840021fd8a6b9">arc_length_step_solve_helper()</a>.</p>

</div>
</div>
<a id="ab805e5e5fb94f941cc7ff1b850d83269"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab805e5e5fb94f941cc7ff1b850d83269">&#9670;&nbsp;</a></span>Bisect_to_find_bifurcation</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::Problem::Bisect_to_find_bifurcation</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Boolean to control wheter bisection is used to located bifurcation. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acc35de219c1c1032a14840021fd8a6b9">arc_length_step_solve_helper()</a>.</p>

</div>
</div>
<a id="ae22f10c348ef8afeb1bfd8609cd6a319"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae22f10c348ef8afeb1bfd8609cd6a319">&#9670;&nbsp;</a></span>Calculate_dparameter_analytic</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;<a class="el" href="../../df/de6/classdouble.html">double</a>*, <a class="el" href="../../d9/db9/classbool.html">bool</a>&gt; oomph::Problem::Calculate_dparameter_analytic</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Map used to determine whether the derivatives with respect to a parameter should be finite differenced. The default is that finite differences should be used </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a41a7b9cf8e6fe1156fc92baa43c3fe4b">is_dparameter_calculated_analytically()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aecef49e98bbcede9b8c3137592c2cc5a">set_analytic_dparameter()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aff7bcab5505ba482a8c9ba7bace68bc0">unset_analytic_dparameter()</a>.</p>

</div>
</div>
<a id="ac353f1325a3b411b30fbc19314cc18ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac353f1325a3b411b30fbc19314cc18ce">&#9670;&nbsp;</a></span>Calculate_hessian_products_analytic</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::Problem::Calculate_hessian_products_analytic</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Map used to determine whether the hessian products should be computed using finite differences. The default is that finite differences will be used </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af6235ced9e7e85324f785f2681ab3872">are_hessian_products_calculated_analytically()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a45f64c33501e0f9c65927eefed253eef">set_analytic_hessian_products()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accd672b3da8c5bf28ad6bd856e28d1cf">unset_analytic_hessian_products()</a>.</p>

</div>
</div>
<a id="a937afdd0d5a039943482f8be9b24c82e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a937afdd0d5a039943482f8be9b24c82e">&#9670;&nbsp;</a></span>Communicator_pt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html">OomphCommunicator</a>* oomph::Problem::Communicator_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The communicator for this problem. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a83463b9e0d3ebf86085c48c0e98c8f10">calculate_continuation_derivatives()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">communicator_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a4e59f1c854d1258aa2b4eca218405731">get_eigenproblem_matrices()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af660c2c0d10eaea1972314ce80de000e">get_jacobian()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a0103fe1a09ecf7e23a9083b35ef07aac">get_residuals()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad9d44f0ef936fb62f0ce41dd200494ac">Problem()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a4f6011ef141cc68598a9502052129a3f">read()</a>, <a class="el" href="../../d2/d5a/classoomph_1_1SolidICProblem.html#a60e1dccbc8627a07bfcb38a55b0669ca">oomph::SolidICProblem::set_static_initial_condition()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa90e41a626a91ee113989afa847c1117">sparse_assemble_row_or_column_compressed_with_lists()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7ba1b95df63f6e7d746a6dae641daa33">sparse_assemble_row_or_column_compressed_with_maps()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a23465a0b1944a4bd31b9e0add9cc9875">sparse_assemble_row_or_column_compressed_with_two_arrays()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5bc761a0dee39437b2ebeba75079856f">sparse_assemble_row_or_column_compressed_with_two_vectors()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7eb5e0e3dc02fa26eec9d023b80b9603">sparse_assemble_row_or_column_compressed_with_vectors_of_pairs()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a839a525ed01c34d57fff42583003d3e7">~Problem()</a>.</p>

</div>
</div>
<a id="a6904003416e9a9257db70c009bdc69ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6904003416e9a9257db70c009bdc69ed">&#9670;&nbsp;</a></span>Continuation_direction</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> oomph::Problem::Continuation_direction</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The direction of the change in parameter that will ensure that a branch is followed in one direction only </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a420904bddcee85ee817dd9fcad0df216">calculate_continuation_derivatives_helper()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6477df6e8184dc78e9d9ff82c7627cef">reset_arc_length_parameters()</a>.</p>

</div>
</div>
<a id="a4c24860f29d64935db86ce5778c7a794"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c24860f29d64935db86ce5778c7a794">&#9670;&nbsp;</a></span>Continuation_time_stepper</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d1/daa/classoomph_1_1ContinuationStorageScheme.html">ContinuationStorageScheme</a> Problem::Continuation_time_stepper</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Storage for the single static continuation timestorage object. </p>
<p>The continuation timestepper object. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aee0d9902fd26b600c9519bea2dfc0f54">arc_length_step_solve()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae78e313f1dc3bc956f42a5d0bd06c459">set_consistent_pinned_values_for_continuation()</a>.</p>

</div>
</div>
<a id="aa2e04de221f29c13067e2fe4cf4c70f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2e04de221f29c13067e2fe4cf4c70f9">&#9670;&nbsp;</a></span>Copy_of_problem_pt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt;<a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a>*&gt; oomph::Problem::Copy_of_problem_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Vector of pointers to copies of the problem used in adaptive bifurcation tracking problems (ALH: TEMPORARY HACK, WILL BE FIXED) </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5e60c7b47591bca6b20b0612e119983">adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa0b4e7868e02e2d12845c9b2dd60cab9">bifurcation_adapt_helper()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a839a525ed01c34d57fff42583003d3e7">~Problem()</a>.</p>

</div>
</div>
<a id="ae0cebe288c8daddd9663bd10d8f1caa0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0cebe288c8daddd9663bd10d8f1caa0">&#9670;&nbsp;</a></span>Default_assembly_handler_pt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/db6/classoomph_1_1AssemblyHandler.html">AssemblyHandler</a>* oomph::Problem::Default_assembly_handler_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pointer to the default assembly handler. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5ee48c16fce89952a019a844ac386655">get_inverse_mass_matrix_times_residuals()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad9d44f0ef936fb62f0ce41dd200494ac">Problem()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a0b6b29c5e2ae9d4a22dac5b4494b7bc4">reset_assembly_handler_to_default()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a839a525ed01c34d57fff42583003d3e7">~Problem()</a>.</p>

</div>
</div>
<a id="a39fd6a7e05c02befe9f2a09938a7a7a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39fd6a7e05c02befe9f2a09938a7a7a4">&#9670;&nbsp;</a></span>Default_eigen_solver_pt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../de/dba/classoomph_1_1EigenSolver.html">EigenSolver</a>* oomph::Problem::Default_eigen_solver_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pointer to the default eigensolver. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad9d44f0ef936fb62f0ce41dd200494ac">Problem()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a839a525ed01c34d57fff42583003d3e7">~Problem()</a>.</p>

</div>
</div>
<a id="ad01b385b2b4cd2e0b867754bea7b798a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad01b385b2b4cd2e0b867754bea7b798a">&#9670;&nbsp;</a></span>Default_linear_solver_pt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html">LinearSolver</a>* oomph::Problem::Default_linear_solver_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pointer to the default linear solver. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad9d44f0ef936fb62f0ce41dd200494ac">Problem()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a839a525ed01c34d57fff42583003d3e7">~Problem()</a>.</p>

</div>
</div>
<a id="a83df3b5fcc3ebbae951021c8e7f03ef7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83df3b5fcc3ebbae951021c8e7f03ef7">&#9670;&nbsp;</a></span>Default_set_initial_condition_called</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::Problem::Default_set_initial_condition_called</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Has default set_initial_condition function been called? Default: false </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7c23771b77d6da7cbee3c3e3c050be73">doubly_adaptive_unsteady_newton_solve_helper()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad48be6d67071f7da5f6feb7c4fc918f0">set_initial_condition()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a31d279b8e62fc676f25b9b347f4ffd8b">unsteady_newton_solve()</a>.</p>

</div>
</div>
<a id="abfe8db162a0bda98add0062a45f41cbf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abfe8db162a0bda98add0062a45f41cbf">&#9670;&nbsp;</a></span>Desired_newton_iterations_ds</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> oomph::Problem::Desired_newton_iterations_ds</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The desired number of Newton Steps to reach convergence at each step along the arc </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acc35de219c1c1032a14840021fd8a6b9">arc_length_step_solve_helper()</a>.</p>

</div>
</div>
<a id="a37fb791188428c8186ffd5c52b6cf576"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37fb791188428c8186ffd5c52b6cf576">&#9670;&nbsp;</a></span>Desired_proportion_of_arc_length</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> oomph::Problem::Desired_proportion_of_arc_length</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Proportion of the arc-length to taken by the parameter. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a533e7f2876442a1660e675aa225cbbe6">calculate_continuation_derivatives()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a8978d65572c5ae81f7381fa6a6d56ba0">calculate_continuation_derivatives_fd()</a>.</p>

</div>
</div>
<a id="a97ca0078fff6adca318835c11503dc2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97ca0078fff6adca318835c11503dc2d">&#9670;&nbsp;</a></span>Discontinuous_element_formulation</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::Problem::Discontinuous_element_formulation</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Is the problem a discontinuous one, i.e. can the elemental contributions be treated independently. Default: false </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#afa64d728ceff0dd772bbbc8f2adcddfb">disable_discontinuous_formulation()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a368ac86b9807c29864de42a872fd534f">disable_mass_matrix_reuse()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af4fbd755b3ce6b86fa0f1b1f29bd08f0">enable_discontinuous_formulation()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#add951d12e349d0c220c3dd808962f4ae">enable_mass_matrix_reuse()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5ee48c16fce89952a019a844ac386655">get_inverse_mass_matrix_times_residuals()</a>.</p>

</div>
</div>
<a id="a524b68efcaae084ad7144f944cb39c69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a524b68efcaae084ad7144f944cb39c69">&#9670;&nbsp;</a></span>Doc_time_in_distribute</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::Problem::Doc_time_in_distribute</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Protected boolean flag to provide comprehensive timimings during problem distribution. Initialised to false. </p>

</div>
</div>
<a id="a366b50c490e9fd3ddafa05b2fbd0b883"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a366b50c490e9fd3ddafa05b2fbd0b883">&#9670;&nbsp;</a></span>Dof_current</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt;<a class="el" href="../../df/de6/classdouble.html">double</a>&gt; oomph::Problem::Dof_current</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Storage for the present values of the variables. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5e60c7b47591bca6b20b0612e119983">adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acc35de219c1c1032a14840021fd8a6b9">arc_length_step_solve_helper()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7a4dac8d3f4f06020b04a4af0a2d7b32">calculate_continuation_derivatives_fd_helper()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a10fd6457ceceb02a0e11d860ac0017c5">dof_current()</a>.</p>

</div>
</div>
<a id="a57825be8c76db9e23e6a9aa0d73973b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57825be8c76db9e23e6a9aa0d73973b2">&#9670;&nbsp;</a></span>Dof_current_offset</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> oomph::Problem::Dof_current_offset</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Storage for the offset for the current values of dofs from the original dofs (default is 2, but this will be differnet when continuing bifurcations and periodic orbits) </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a10fd6457ceceb02a0e11d860ac0017c5">dof_current()</a>.</p>

</div>
</div>
<a id="a1861321b2d129707935bf1191238daca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1861321b2d129707935bf1191238daca">&#9670;&nbsp;</a></span>Dof_derivative</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt;<a class="el" href="../../df/de6/classdouble.html">double</a>&gt; oomph::Problem::Dof_derivative</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Storage for the derivative of the problem variables wrt arc-length. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5e60c7b47591bca6b20b0612e119983">adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acc35de219c1c1032a14840021fd8a6b9">arc_length_step_solve_helper()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a420904bddcee85ee817dd9fcad0df216">calculate_continuation_derivatives_helper()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad6df5fb0d282f25df1e94a665dd838e5">dof_derivative()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6477df6e8184dc78e9d9ff82c7627cef">reset_arc_length_parameters()</a>.</p>

</div>
</div>
<a id="af0372f742b90bb402c6edc720ceeb421"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0372f742b90bb402c6edc720ceeb421">&#9670;&nbsp;</a></span>Dof_derivative_offset</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> oomph::Problem::Dof_derivative_offset</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Storage for the offset for the continuation derivatives from the original dofs (default is 1, but this will be differnet when continuing bifurcations and periodic orbits) </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad6df5fb0d282f25df1e94a665dd838e5">dof_derivative()</a>.</p>

</div>
</div>
<a id="ade01b88db08dcec1706fe44eaa0090a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade01b88db08dcec1706fe44eaa0090a3">&#9670;&nbsp;</a></span>Dof_distribution_pt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a>* oomph::Problem::Dof_distribution_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The distribution of the DOFs in this problem. This object is created in the Problem constructor and setup when assign_eqn_numbers(...) is called. If this problem is distributed then this distribution will match the distribution of the equation numbers. If this problem is not distributed then this distribution will be uniform over all processors. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5e60c7b47591bca6b20b0612e119983">adapt()</a>, <a class="el" href="../../d2/da2/classoomph_1_1PeriodicOrbitAssemblyHandler.html#a358d1749faa8ac7dd0de87340d878088">oomph::PeriodicOrbitAssemblyHandler&lt; NNODE_1D &gt;::adapt_temporal_mesh()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acc35de219c1c1032a14840021fd8a6b9">arc_length_step_solve_helper()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7a4dac8d3f4f06020b04a4af0a2d7b32">calculate_continuation_derivatives_fd_helper()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a420904bddcee85ee817dd9fcad0df216">calculate_continuation_derivatives_helper()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a17a5a4886c4213422179fe8346336a4e">dof_distribution_pt()</a>, <a class="el" href="../../d4/dcb/classoomph_1_1FoldHandler.html#add39896d007559f4fb801f1c95e4ab16">oomph::FoldHandler::FoldHandler()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a11c1432869386bb49f16da15545bfee7">get_dofs()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a4e59f1c854d1258aa2b4eca218405731">get_eigenproblem_matrices()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a497518acb5d30a28a253890c3d2a5da2">get_hessian_vector_products()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aab9533075d11b251636fa1c3a544dba7">get_jacobian()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a0103fe1a09ecf7e23a9083b35ef07aac">get_residuals()</a>, <a class="el" href="../../d4/da2/classoomph_1_1HopfHandler.html#ac219516b8263300eb5102d38baab05d7">oomph::HopfHandler::HopfHandler()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a218d4dfff74bc14f3f5dc8416236e01d">ndof()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aae8cf62757e432b625ec81fad1559dc3">newton_solve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7b86783463433cc9c4cc382b1b40f0e1">newton_solve_continuation()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a96e0343c261d087f5d67a49f68561d96">oomph::PitchForkHandler::PitchForkHandler()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad9d44f0ef936fb62f0ce41dd200494ac">Problem()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a3c927ed4f3e79527e0e23ac44779f0f8">restore_dof_values()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aae085671047b62a98ef310d66cc3f412">setup_element_count_per_dof()</a>, <a class="el" href="../../d4/dcb/classoomph_1_1FoldHandler.html#a7718a18444f6e328953dd5d5e73802f8">oomph::FoldHandler::solve_augmented_block_system()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ad0b0920383bcbdab5df1f43db5affa47">oomph::PitchForkHandler::solve_augmented_block_system()</a>, <a class="el" href="../../d4/dcb/classoomph_1_1FoldHandler.html#abf0c7293014112731f0482e464f4daa3">oomph::FoldHandler::solve_block_system()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ad193c3d67741edd60b023c94e42c8802">oomph::PitchForkHandler::solve_block_system()</a>, <a class="el" href="../../d4/da2/classoomph_1_1HopfHandler.html#ac7feecfa644ae33b4a4a9fa8d1d993af">oomph::HopfHandler::solve_complex_system()</a>, <a class="el" href="../../d4/dcb/classoomph_1_1FoldHandler.html#a506c9a7bb372c6d8799c6dabc9448f46">oomph::FoldHandler::solve_full_system()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a27325616f4342d159f6f5e7c82ccdf98">oomph::PitchForkHandler::solve_full_system()</a>, <a class="el" href="../../d4/da2/classoomph_1_1HopfHandler.html#a507681043126f6bea58cc90deed16d1d">oomph::HopfHandler::solve_full_system()</a>, <a class="el" href="../../d4/da2/classoomph_1_1HopfHandler.html#acd2149152659deef1d938739222dbcf2">oomph::HopfHandler::solve_standard_system()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac3ed0463968bd0fef5d9b97bcb8ca163">store_current_dof_values()</a>, <a class="el" href="../../d4/dcb/classoomph_1_1FoldHandler.html#ab582d9ac969e0f7779a285d21a6d8e45">oomph::FoldHandler::~FoldHandler()</a>, <a class="el" href="../../d4/da2/classoomph_1_1HopfHandler.html#a2b2822861fc417fea32cbba38f9dd650">oomph::HopfHandler::~HopfHandler()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a69c6b0b6aedd03d828d295531fd61820">oomph::PitchForkHandler::~PitchForkHandler()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a839a525ed01c34d57fff42583003d3e7">~Problem()</a>.</p>

</div>
</div>
<a id="aa9e4cfff7e1dc295036b0e58bc11ae75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9e4cfff7e1dc295036b0e58bc11ae75">&#9670;&nbsp;</a></span>Dof_pt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt;<a class="el" href="../../df/de6/classdouble.html">double</a>*&gt; oomph::Problem::Dof_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Vector of pointers to dofs. </p>

<p class="reference">Referenced by <a class="el" href="../../d2/da2/classoomph_1_1PeriodicOrbitAssemblyHandler.html#a358d1749faa8ac7dd0de87340d878088">oomph::PeriodicOrbitAssemblyHandler&lt; NNODE_1D &gt;::adapt_temporal_mesh()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#abb1221f3e6605bf134cc6be3ff297016">add_to_dofs()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acc35de219c1c1032a14840021fd8a6b9">arc_length_step_solve_helper()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7a4dac8d3f4f06020b04a4af0a2d7b32">calculate_continuation_derivatives_fd_helper()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acbc0b0fc5d5cc76ce8384bc0bd815f26">calculate_predictions()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a74d71439b100fb5b66b94d1d69130f7c">dof()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a10fd6457ceceb02a0e11d860ac0017c5">dof_current()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad6df5fb0d282f25df1e94a665dd838e5">dof_derivative()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a02f480ec17e0b9b03c892be5ed0c64d1">dof_pt()</a>, <a class="el" href="../../d4/dcb/classoomph_1_1FoldHandler.html#add39896d007559f4fb801f1c95e4ab16">oomph::FoldHandler::FoldHandler()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a11c1432869386bb49f16da15545bfee7">get_dofs()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a9f3d1c9378e385d7755184a97f5f6f91">get_fd_jacobian()</a>, <a class="el" href="../../d4/dcb/classoomph_1_1FoldHandler.html#ad1bec54a2e0c5bd483ff0bf633bd6542">oomph::FoldHandler::get_jacobian()</a>, <a class="el" href="../../d4/da2/classoomph_1_1HopfHandler.html#ab36c50421f53accced01dd9e04d904ef">oomph::HopfHandler::get_jacobian()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a466d6110fd791b17e04a4100312787cd">globally_convergent_line_search()</a>, <a class="el" href="../../d4/da2/classoomph_1_1HopfHandler.html#ac219516b8263300eb5102d38baab05d7">oomph::HopfHandler::HopfHandler()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aae8cf62757e432b625ec81fad1559dc3">newton_solve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7b86783463433cc9c4cc382b1b40f0e1">newton_solve_continuation()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a96e0343c261d087f5d67a49f68561d96">oomph::PitchForkHandler::PitchForkHandler()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a3c927ed4f3e79527e0e23ac44779f0f8">restore_dof_values()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a07c3df43aef20537f8d192c2fc203836">set_dofs()</a>, <a class="el" href="../../d4/dcb/classoomph_1_1FoldHandler.html#a7718a18444f6e328953dd5d5e73802f8">oomph::FoldHandler::solve_augmented_block_system()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ad0b0920383bcbdab5df1f43db5affa47">oomph::PitchForkHandler::solve_augmented_block_system()</a>, <a class="el" href="../../d4/dcb/classoomph_1_1FoldHandler.html#abf0c7293014112731f0482e464f4daa3">oomph::FoldHandler::solve_block_system()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ad193c3d67741edd60b023c94e42c8802">oomph::PitchForkHandler::solve_block_system()</a>, <a class="el" href="../../d4/da2/classoomph_1_1HopfHandler.html#ac7feecfa644ae33b4a4a9fa8d1d993af">oomph::HopfHandler::solve_complex_system()</a>, <a class="el" href="../../d4/dcb/classoomph_1_1FoldHandler.html#a506c9a7bb372c6d8799c6dabc9448f46">oomph::FoldHandler::solve_full_system()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a27325616f4342d159f6f5e7c82ccdf98">oomph::PitchForkHandler::solve_full_system()</a>, <a class="el" href="../../d4/da2/classoomph_1_1HopfHandler.html#a507681043126f6bea58cc90deed16d1d">oomph::HopfHandler::solve_full_system()</a>, <a class="el" href="../../d4/da2/classoomph_1_1HopfHandler.html#acd2149152659deef1d938739222dbcf2">oomph::HopfHandler::solve_standard_system()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac3ed0463968bd0fef5d9b97bcb8ca163">store_current_dof_values()</a>, <a class="el" href="../../d4/dcb/classoomph_1_1FoldHandler.html#ab582d9ac969e0f7779a285d21a6d8e45">oomph::FoldHandler::~FoldHandler()</a>, <a class="el" href="../../d4/da2/classoomph_1_1HopfHandler.html#a2b2822861fc417fea32cbba38f9dd650">oomph::HopfHandler::~HopfHandler()</a>, and <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a69c6b0b6aedd03d828d295531fd61820">oomph::PitchForkHandler::~PitchForkHandler()</a>.</p>

</div>
</div>
<a id="ad412d49617d0b0998e5eb440c7a20f3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad412d49617d0b0998e5eb440c7a20f3f">&#9670;&nbsp;</a></span>Ds_current</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> oomph::Problem::Ds_current</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Storage for the current step value. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acc35de219c1c1032a14840021fd8a6b9">arc_length_step_solve_helper()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7a4dac8d3f4f06020b04a4af0a2d7b32">calculate_continuation_derivatives_fd_helper()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7b86783463433cc9c4cc382b1b40f0e1">newton_solve_continuation()</a>.</p>

</div>
</div>
<a id="aaaeab9469b342a3b849ee5f2ef7051f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaaeab9469b342a3b849ee5f2ef7051f3">&#9670;&nbsp;</a></span>DTSF_max_increase</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> oomph::Problem::DTSF_max_increase</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Maximum possible increase of dt between time-steps in adaptive schemes </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a63805c549e71b7c73107abe6001fae25">adaptive_unsteady_newton_solve()</a>.</p>

</div>
</div>
<a id="abbb93979ed99d40eb845ba7296355965"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abbb93979ed99d40eb845ba7296355965">&#9670;&nbsp;</a></span>DTSF_min_decrease</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> oomph::Problem::DTSF_min_decrease</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Minimum allowed decrease of dt between time-steps in adaptive schemes. Lower scaling values will reject the time-step (and retry with a smaller dt). </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a63805c549e71b7c73107abe6001fae25">adaptive_unsteady_newton_solve()</a>.</p>

</div>
</div>
<a id="ab7938313fa45df9be16515a6b0bfd324"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7938313fa45df9be16515a6b0bfd324">&#9670;&nbsp;</a></span>Eigen_solver_pt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../de/dba/classoomph_1_1EigenSolver.html">EigenSolver</a>* oomph::Problem::Eigen_solver_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pointer to the eigen solver for the problem. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a00efa0059958df35858503e77111c362">eigen_solver_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad9d44f0ef936fb62f0ce41dd200494ac">Problem()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a06cf96b1291774eb89517af10f80410a">solve_eigenproblem()</a>.</p>

</div>
</div>
<a id="ae4177b73a790b80d541b416d1e83c6c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4177b73a790b80d541b416d1e83c6c3">&#9670;&nbsp;</a></span>Element_count_per_dof</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d5/d25/classoomph_1_1DoubleVectorWithHaloEntries.html">DoubleVectorWithHaloEntries</a> oomph::Problem::Element_count_per_dof</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Counter that records how many elements contribute to each dof. Used to determine the (discrete) arc-length automatically. It really should be an integer, but is a double so that the distribution information can be used for distributed problems </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aae085671047b62a98ef310d66cc3f412">setup_element_count_per_dof()</a>.</p>

</div>
</div>
<a id="a71f87e46a571a54abd27a26f6c701c36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71f87e46a571a54abd27a26f6c701c36">&#9670;&nbsp;</a></span>Empty_actions_after_read_unstructured_meshes_has_been_called</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::Problem::Empty_actions_after_read_unstructured_meshes_has_been_called</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Boolean to indicate that empty actions_after_read_unstructured_meshes() function has been called. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a498317b3e390eddf2169ab989ee8d6b4">actions_after_read_unstructured_meshes()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a4f6011ef141cc68598a9502052129a3f">read()</a>.</p>

</div>
</div>
<a id="a5f13ea67c29022392857b5c19bb3af71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f13ea67c29022392857b5c19bb3af71">&#9670;&nbsp;</a></span>Empty_actions_before_read_unstructured_meshes_has_been_called</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::Problem::Empty_actions_before_read_unstructured_meshes_has_been_called</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Boolean to indicate that empty actions_before_read_unstructured_meshes() function has been called. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af10662119a7a0c3a47879fa0d0644452">actions_before_read_unstructured_meshes()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a4f6011ef141cc68598a9502052129a3f">read()</a>.</p>

</div>
</div>
<a id="af8466091ea4f5b57033bb3ad24831167"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8466091ea4f5b57033bb3ad24831167">&#9670;&nbsp;</a></span>Explicit_time_stepper_pt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/d0b/classoomph_1_1ExplicitTimeStepper.html">ExplicitTimeStepper</a>* oomph::Problem::Explicit_time_stepper_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pointer to a single explicit timestepper. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac332634783a803c1c21bf5c520af280f">explicit_time_stepper_pt()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7e79846a57705934352b55b6d675d77d">set_explicit_time_stepper_pt()</a>.</p>

</div>
</div>
<a id="ad26c62f5aab816943144ac61fbf7725e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad26c62f5aab816943144ac61fbf7725e">&#9670;&nbsp;</a></span>FD_step_used_in_get_hessian_vector_products</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> oomph::Problem::FD_step_used_in_get_hessian_vector_products</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a497518acb5d30a28a253890c3d2a5da2">get_hessian_vector_products()</a>.</p>

</div>
</div>
<a id="a643f61299463a3bbf7be3f6a112aa130"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a643f61299463a3bbf7be3f6a112aa130">&#9670;&nbsp;</a></span>First_jacobian_sign_change</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::Problem::First_jacobian_sign_change</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Boolean to indicate whether a sign change has occured in the Jacobian. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acc35de219c1c1032a14840021fd8a6b9">arc_length_step_solve_helper()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6477df6e8184dc78e9d9ff82c7627cef">reset_arc_length_parameters()</a>.</p>

</div>
</div>
<a id="aa963c98e91d135d31cdcfbe1afa64603"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa963c98e91d135d31cdcfbe1afa64603">&#9670;&nbsp;</a></span>Global_data_pt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt;<a class="el" href="../../d8/dc5/classoomph_1_1Data.html">Data</a>*&gt; oomph::Problem::Global_data_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Vector of global data: "Nobody" (i.e. none of the elements etc.) is "in charge" of this Data so it would be overlooked when it comes to equation-numbering, timestepping etc. Including (pointers) to such Data in here, puts the Problem itself "in charge" of these tasks. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6f0c24728351d390d4f0a86d07bd8678">add_global_data()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7d966c0bfd336699586057e476bd17d5">assign_initial_values_impulsive()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acbc0b0fc5d5cc76ce8384bc0bd815f26">calculate_predictions()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab8b63040a3c6deff68fb2128c2f7fef2">copy()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a74a72dc989531d264ec1959f3015b98c">describe_dofs()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a75fe4a89f7dccbd72a67333b3959539d">does_pointer_correspond_to_problem_data()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a1756534851a763f35fd5372b4d3723e0">dump()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa8df5552c706bd949b29f5601f8c941e">flush_global_data()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#adb5998dfed961de76c33ae3b6fa516b4">get_dofs()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae508b2056d532cb8b6eb0dd5c16b9325">global_data_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a60a9b6861928cf9115110b5bfc7d11a7">nglobal_data()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a4f6011ef141cc68598a9502052129a3f">read()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7b7f290d47c78868860cb3561f1c6443">self_test()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae78e313f1dc3bc956f42a5d0bd06c459">set_consistent_pinned_values_for_continuation()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac3ec67f2c633cc414905ade9fa148939">set_dofs()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6aab91bb814a85409648dc87807907e6">set_pinned_values_to_zero()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a50d54d4b374ea6a8d76798f34b865944">set_timestepper_for_all_data()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a3d3108a38cfbed4087f5b8eb601f38a2">shift_time_values()</a>.</p>

</div>
</div>
<a id="a2c4702c75739c967ed582dbd0a7ba56f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c4702c75739c967ed582dbd0a7ba56f">&#9670;&nbsp;</a></span>Jacobian_has_been_computed</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::Problem::Jacobian_has_been_computed</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Has a Jacobian been computed (and can therefore be re-used if required)? Default: false </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a52489fed5942629199e4f720a7a86549">disable_jacobian_reuse()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a8eb2fedc3f64411cfbe1627a516447f9">enable_jacobian_reuse()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aae8cf62757e432b625ec81fad1559dc3">newton_solve()</a>.</p>

</div>
</div>
<a id="a022796f2c96f2dff6ed1db2338c93aaf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a022796f2c96f2dff6ed1db2338c93aaf">&#9670;&nbsp;</a></span>Jacobian_reuse_is_enabled</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::Problem::Jacobian_reuse_is_enabled</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Is re-use of Jacobian in Newton iteration enabled? Default: false. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a52489fed5942629199e4f720a7a86549">disable_jacobian_reuse()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a8eb2fedc3f64411cfbe1627a516447f9">enable_jacobian_reuse()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5c864f0dfc4f0ff33e07935944b7b435">jacobian_reuse_is_enabled()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aae8cf62757e432b625ec81fad1559dc3">newton_solve()</a>.</p>

</div>
</div>
<a id="ab27af4a444de9f59125ee50ac778d97a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab27af4a444de9f59125ee50ac778d97a">&#9670;&nbsp;</a></span>Keep_temporal_error_below_tolerance</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::Problem::Keep_temporal_error_below_tolerance</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Boolean to decide if a timestep is to be rejected if the error estimate post-solve (computed by global_temporal_error_norm()) exceeds the tolerance required in the call to adaptive_unsteady_newton_solve(...). Defaults to true. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a63805c549e71b7c73107abe6001fae25">adaptive_unsteady_newton_solve()</a>, and <a class="el" href="../../d7/d86/classSurfactantProblem.html#a7728f025db0a13dd910db96d6fb66832">SurfactantProblem&lt; ELEMENT, INTERFACE_ELEMENT &gt;::SurfactantProblem()</a>.</p>

</div>
</div>
<a id="a519de6f6f70c8b0f6bacbde5e0a35cd7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a519de6f6f70c8b0f6bacbde5e0a35cd7">&#9670;&nbsp;</a></span>Linear_solver_pt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html">LinearSolver</a>* oomph::Problem::Linear_solver_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pointer to the linear solver for the problem. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a9ed88021ec449655c64191154dd236af">activate_bifurcation_tracking()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa4f954e46b84b13a2bb16a83b3f0ff83">activate_fold_tracking()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5202944fe909268c20abcfb4576d147b">activate_hopf_tracking()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a66fd78008266a4023f450971af444508">activate_pitchfork_tracking()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a83463b9e0d3ebf86085c48c0e98c8f10">calculate_continuation_derivatives()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a689687cacc40dd351430545a7041f44c">linear_solver_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aae8cf62757e432b625ec81fad1559dc3">newton_solve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7b86783463433cc9c4cc382b1b40f0e1">newton_solve_continuation()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad9d44f0ef936fb62f0ce41dd200494ac">Problem()</a>.</p>

</div>
</div>
<a id="a6067c6d344363a073fb8d02a99fb7ed0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6067c6d344363a073fb8d02a99fb7ed0">&#9670;&nbsp;</a></span>Mass_matrix_has_been_computed</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::Problem::Mass_matrix_has_been_computed</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Has the mass matrix been computed (and can therefore be reused) Default: false </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a368ac86b9807c29864de42a872fd534f">disable_mass_matrix_reuse()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#add951d12e349d0c220c3dd808962f4ae">enable_mass_matrix_reuse()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5ee48c16fce89952a019a844ac386655">get_inverse_mass_matrix_times_residuals()</a>.</p>

</div>
</div>
<a id="af4d25809ac090102a4d4a398e4ad0e26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4d25809ac090102a4d4a398e4ad0e26">&#9670;&nbsp;</a></span>Mass_matrix_reuse_is_enabled</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::Problem::Mass_matrix_reuse_is_enabled</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Is re-use of the mass matrix in explicit timestepping enabled Default:false </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a368ac86b9807c29864de42a872fd534f">disable_mass_matrix_reuse()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#add951d12e349d0c220c3dd808962f4ae">enable_mass_matrix_reuse()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5ee48c16fce89952a019a844ac386655">get_inverse_mass_matrix_times_residuals()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#afa46c693258868c126503cce3a663a85">mass_matrix_reuse_is_enabled()</a>.</p>

</div>
</div>
<a id="ad4b9d15269f624044d1730957b0a8c19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4b9d15269f624044d1730957b0a8c19">&#9670;&nbsp;</a></span>Mass_matrix_solver_for_explicit_timestepper_pt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html">LinearSolver</a>* oomph::Problem::Mass_matrix_solver_for_explicit_timestepper_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Pointer to the linear solver used for explicit time steps (this is likely to be different to the linear solver for newton solves because explicit time steps only involve inverting a mass matrix. This can be done very efficiently by, e.g. CG with a diagonal predconditioner). </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a93304d0c6be1022b944f21c0f4c07eab">mass_matrix_solver_for_explicit_timestepper_pt()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad9d44f0ef936fb62f0ce41dd200494ac">Problem()</a>.</p>

</div>
</div>
<a id="a52a58a98c3e2e7dbaefcfb1ee7830c35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52a58a98c3e2e7dbaefcfb1ee7830c35">&#9670;&nbsp;</a></span>Max_newton_iterations</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> oomph::Problem::Max_newton_iterations</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Maximum number of Newton iterations. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa30b2e89f61a327ffb1be4ff30bb868f">max_newton_iterations()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aae8cf62757e432b625ec81fad1559dc3">newton_solve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7b86783463433cc9c4cc382b1b40f0e1">newton_solve_continuation()</a>, <a class="el" href="../../d1/d1f/classRefineableConvectionProblem.html#a97e661986093402bf55fb6c32b782ddc">RefineableConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;::RefineableConvectionProblem()</a>, <a class="el" href="../../db/d70/classRefineableDDConvectionProblem.html#a6cb1d123b525517c2cd4295cd4d2dde4">RefineableDDConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;::RefineableDDConvectionProblem()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a64b890295532c3a7ff5ad4e4dd5d56e3">steady_newton_solve()</a>, <a class="el" href="../../d1/d1f/classRefineableConvectionProblem.html#aaca1f267ca5247129cc2dd9815adda6e">RefineableConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;::switch_to_iterative_linear_solver()</a>, <a class="el" href="../../d7/dcc/classTurekNonFSIProblem.html#aacb3214544ef81c2f8b49777457e8be6">TurekNonFSIProblem&lt; ELEMENT &gt;::TurekNonFSIProblem()</a>, <a class="el" href="../../d1/dfc/classTurekProblem.html#a69f6624fd854393f0c0e5303603ec749">TurekProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;::TurekProblem()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a4b015281f27d25ee0209cd9b467175b6">unsteady_newton_solve()</a>.</p>

</div>
</div>
<a id="ab6f510bea9bdfcaf229415440a0a1c98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6f510bea9bdfcaf229415440a0a1c98">&#9670;&nbsp;</a></span>Max_res</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt;<a class="el" href="../../df/de6/classdouble.html">double</a>&gt; oomph::Problem::Max_res</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Maximum residuals at start and after each newton iteration. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aae8cf62757e432b625ec81fad1559dc3">newton_solve()</a>.</p>

</div>
</div>
<a id="accb8811cdf32f14be497917e922c623e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#accb8811cdf32f14be497917e922c623e">&#9670;&nbsp;</a></span>Max_residuals</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> oomph::Problem::Max_residuals</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Maximum desired residual: if the maximum residual exceeds this value, the program will exit </p>

<p class="reference">Referenced by <a class="el" href="../../dc/d83/classFlowAroundCylinderProblem.html#a03cfbffae1e834d5b95097f9ea408f40">FlowAroundCylinderProblem&lt; ELEMENT &gt;::FlowAroundCylinderProblem()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a2ad78241135f621df36bc1b9634845ac">max_residuals()</a>, <a class="el" href="../../da/d64/classMovingBlockProblem.html#ae8a2389d1da3e876c1aee8edeeae2297">MovingBlockProblem&lt; ELEMENT &gt;::MovingBlockProblem()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aae8cf62757e432b625ec81fad1559dc3">newton_solve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7b86783463433cc9c4cc382b1b40f0e1">newton_solve_continuation()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a64b890295532c3a7ff5ad4e4dd5d56e3">steady_newton_solve()</a>, <a class="el" href="../../dd/dec/classSteadyHelicalProblem.html#adbf13f3b2ffbcaaef6465d0d6583a1c9">SteadyHelicalProblem&lt; ELEMENT &gt;::SteadyHelicalProblem()</a>, <a class="el" href="../../d7/dcc/classTurekNonFSIProblem.html#aacb3214544ef81c2f8b49777457e8be6">TurekNonFSIProblem&lt; ELEMENT &gt;::TurekNonFSIProblem()</a>, <a class="el" href="../../d1/dfc/classTurekProblem.html#a69f6624fd854393f0c0e5303603ec749">TurekProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;::TurekProblem()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a4b015281f27d25ee0209cd9b467175b6">unsteady_newton_solve()</a>.</p>

</div>
</div>
<a id="a7b5fde48b00a7fdc5f1fbbee138d0414"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b5fde48b00a7fdc5f1fbbee138d0414">&#9670;&nbsp;</a></span>Maximum_dt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> oomph::Problem::Maximum_dt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Maximum desired dt. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a63805c549e71b7c73107abe6001fae25">adaptive_unsteady_newton_solve()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac5355154d4991ec634e74d4817176f5f">maximum_dt()</a>.</p>

</div>
</div>
<a id="aa4a3bf9419e495aaaaea0dcb00ea53e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4a3bf9419e495aaaaea0dcb00ea53e5">&#9670;&nbsp;</a></span>Mesh_pt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a>* oomph::Problem::Mesh_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The mesh pointer. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7d966c0bfd336699586057e476bd17d5">assign_initial_values_impulsive()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa29176d84610e0273fc823cace91765a">build_global_mesh()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acbc0b0fc5d5cc76ce8384bc0bd815f26">calculate_predictions()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a74a72dc989531d264ec1959f3015b98c">describe_dofs()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a75fe4a89f7dccbd72a67333b3959539d">does_pointer_correspond_to_problem_data()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a497518acb5d30a28a253890c3d2a5da2">get_hessian_vector_products()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af660c2c0d10eaea1972314ce80de000e">get_jacobian()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a0103fe1a09ecf7e23a9083b35ef07aac">get_residuals()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a266d4d1b2bd4a5cbc028ff5aba79508f">rebuild_global_mesh()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae78e313f1dc3bc956f42a5d0bd06c459">set_consistent_pinned_values_for_continuation()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6aab91bb814a85409648dc87807907e6">set_pinned_values_to_zero()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a50d54d4b374ea6a8d76798f34b865944">set_timestepper_for_all_data()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a3d3108a38cfbed4087f5b8eb601f38a2">shift_time_values()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a839a525ed01c34d57fff42583003d3e7">~Problem()</a>.</p>

</div>
</div>
<a id="ad0f8bb126a4f5ddeb559c23a8d451d8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0f8bb126a4f5ddeb559c23a8d451d8d">&#9670;&nbsp;</a></span>Minimum_ds</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> oomph::Problem::Minimum_ds</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Minimum desired value of arc-length. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acc35de219c1c1032a14840021fd8a6b9">arc_length_step_solve_helper()</a>, and <a class="el" href="../../dc/db9/classOrrSommerfeldProblem.html#aaa5b04805113cefc7a352483c53e149e">OrrSommerfeldProblem&lt; ELEMENT &gt;::OrrSommerfeldProblem()</a>.</p>

</div>
</div>
<a id="ad7456318933aa01114dc78498bfd6d79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7456318933aa01114dc78498bfd6d79">&#9670;&nbsp;</a></span>Minimum_dt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> oomph::Problem::Minimum_dt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Minimum desired dt: if dt falls below this value, exit. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a63805c549e71b7c73107abe6001fae25">adaptive_unsteady_newton_solve()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#adffc8921bf61edac68ed017bcdc1d792">minimum_dt()</a>.</p>

</div>
</div>
<a id="abdee700b2cec37540cf1e7e1462df6c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abdee700b2cec37540cf1e7e1462df6c3">&#9670;&nbsp;</a></span>Minimum_dt_but_still_proceed</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> oomph::Problem::Minimum_dt_but_still_proceed</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>If Minimum_dt_but_still_proceed positive, then dt will not be reduced below this value during adaptive timestepping and the computation will continue with this value, accepting the larger errors that this will incur). Note: This option is disabled by default as this value is initialised to -1.0. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a63805c549e71b7c73107abe6001fae25">adaptive_unsteady_newton_solve()</a>.</p>

</div>
</div>
<a id="a94536b381e949edf5bb4d44434e08925"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94536b381e949edf5bb4d44434e08925">&#9670;&nbsp;</a></span>Newton_solver_tolerance</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> oomph::Problem::Newton_solver_tolerance</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The Tolerance below which the Newton Method is deemed to have converged </p>

<p class="reference">Referenced by <a class="el" href="../../de/da7/classoomph_1_1SegregatableFSIProblem.html#ae10cc55b3dc502ba387695e8c010b0c1">oomph::SegregatableFSIProblem::assess_convergence_based_on_absolute_solid_change()</a>, <a class="el" href="../../de/da7/classoomph_1_1SegregatableFSIProblem.html#a2fba426552e48abb7ff8a554c20953da">oomph::SegregatableFSIProblem::assess_convergence_based_on_max_global_residual()</a>, <a class="el" href="../../de/da7/classoomph_1_1SegregatableFSIProblem.html#af95d2c3833b64d37635e2e07776cef54">oomph::SegregatableFSIProblem::assess_convergence_based_on_relative_solid_change()</a>, <a class="el" href="../../d9/d2f/classFreeSurfaceRotationProblem.html#adf9a6cb4fcd7e6ea2015e71f2b59fc9c">FreeSurfaceRotationProblem&lt; ELEMENT &gt;::FreeSurfaceRotationProblem()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aae8cf62757e432b625ec81fad1559dc3">newton_solve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7b86783463433cc9c4cc382b1b40f0e1">newton_solve_continuation()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa43a98d2303f2bce10d0887dc0b2eac5">newton_solver_tolerance()</a>, and <a class="el" href="../../de/da7/classoomph_1_1SegregatableFSIProblem.html#aabbe220c15e7a348a28d54be805ca8d8">oomph::SegregatableFSIProblem::SegregatableFSIProblem()</a>.</p>

</div>
</div>
<a id="a3c05eefd6891808a1ef01e51288e0108"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c05eefd6891808a1ef01e51288e0108">&#9670;&nbsp;</a></span>Nnewton_iter_taken</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> oomph::Problem::Nnewton_iter_taken</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Actual number of Newton iterations taken during the most recent iteration </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aae8cf62757e432b625ec81fad1559dc3">newton_solve()</a>.</p>

</div>
</div>
<a id="ad1a1ffc2bd685377ce7213452876b127"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1a1ffc2bd685377ce7213452876b127">&#9670;&nbsp;</a></span>Numerical_zero_for_sparse_assembly</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> oomph::Problem::Numerical_zero_for_sparse_assembly</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>A tolerance used to determine whether the entry in a sparse matrix is zero. If it is then storage need not be allocated. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa90e41a626a91ee113989afa847c1117">sparse_assemble_row_or_column_compressed_with_lists()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7ba1b95df63f6e7d746a6dae641daa33">sparse_assemble_row_or_column_compressed_with_maps()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a23465a0b1944a4bd31b9e0add9cc9875">sparse_assemble_row_or_column_compressed_with_two_arrays()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5bc761a0dee39437b2ebeba75079856f">sparse_assemble_row_or_column_compressed_with_two_vectors()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7eb5e0e3dc02fa26eec9d023b80b9603">sparse_assemble_row_or_column_compressed_with_vectors_of_pairs()</a>.</p>

</div>
</div>
<a id="a8e29673eb80559888d1c6148c4f11e57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e29673eb80559888d1c6148c4f11e57">&#9670;&nbsp;</a></span>Parameter_current</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> oomph::Problem::Parameter_current</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Storage for the present value of the global parameter. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acc35de219c1c1032a14840021fd8a6b9">arc_length_step_solve_helper()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7a4dac8d3f4f06020b04a4af0a2d7b32">calculate_continuation_derivatives_fd_helper()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7b86783463433cc9c4cc382b1b40f0e1">newton_solve_continuation()</a>.</p>

</div>
</div>
<a id="aa5082325ca4cafe5a9ec03ef79c67a6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5082325ca4cafe5a9ec03ef79c67a6f">&#9670;&nbsp;</a></span>Parameter_derivative</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> oomph::Problem::Parameter_derivative</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Storage for the derivative of the global parameter wrt arc-length. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acc35de219c1c1032a14840021fd8a6b9">arc_length_step_solve_helper()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a533e7f2876442a1660e675aa225cbbe6">calculate_continuation_derivatives()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a8978d65572c5ae81f7381fa6a6d56ba0">calculate_continuation_derivatives_fd()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7a4dac8d3f4f06020b04a4af0a2d7b32">calculate_continuation_derivatives_fd_helper()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a420904bddcee85ee817dd9fcad0df216">calculate_continuation_derivatives_helper()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7b86783463433cc9c4cc382b1b40f0e1">newton_solve_continuation()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6477df6e8184dc78e9d9ff82c7627cef">reset_arc_length_parameters()</a>.</p>

</div>
</div>
<a id="aedefa8337ace6043c2fdfd5a2d19afd3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aedefa8337ace6043c2fdfd5a2d19afd3">&#9670;&nbsp;</a></span>Pause_at_end_of_sparse_assembly</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::Problem::Pause_at_end_of_sparse_assembly</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Protected boolean flag to halt program execution during sparse assemble process to assess peak memory usage. Initialised to false (obviously!) </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa90e41a626a91ee113989afa847c1117">sparse_assemble_row_or_column_compressed_with_lists()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7ba1b95df63f6e7d746a6dae641daa33">sparse_assemble_row_or_column_compressed_with_maps()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a23465a0b1944a4bd31b9e0add9cc9875">sparse_assemble_row_or_column_compressed_with_two_arrays()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5bc761a0dee39437b2ebeba75079856f">sparse_assemble_row_or_column_compressed_with_two_vectors()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7eb5e0e3dc02fa26eec9d023b80b9603">sparse_assemble_row_or_column_compressed_with_vectors_of_pairs()</a>.</p>

</div>
</div>
<a id="ade2d3efba34f69aafaefc076ddb3b8d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade2d3efba34f69aafaefc076ddb3b8d4">&#9670;&nbsp;</a></span>Problem_is_nonlinear</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::Problem::Problem_is_nonlinear</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Boolean flag indicating if we're dealing with a linear or nonlinear Problem &ndash; if set to false the Newton solver will not check the residual before or after the linear solve. Set to true by default; can be over-written in specific Problem class. </p>

<p class="reference">Referenced by <a class="el" href="../../d3/d7a/classAxiPoroProblem.html#a4c4656486f01fcc592bbb82d4fa35b78">AxiPoroProblem&lt; ELEMENT, TIMESTEPPER &gt;::AxiPoroProblem()</a>, <a class="el" href="../../d8/d08/classBiharmonicTestProblem1.html#a2790b33f23628778e7b62bd1382e7e4a">BiharmonicTestProblem1::BiharmonicTestProblem1()</a>, <a class="el" href="../../d4/dde/classBiharmonicTestProblem2.html#a55d160f284ddff6dca64a780292df8dc">BiharmonicTestProblem2::BiharmonicTestProblem2()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aae8cf62757e432b625ec81fad1559dc3">newton_solve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a92acc3c193a38f321fc318fafd142f7a">problem_is_nonlinear()</a>, <a class="el" href="../../d5/dc5/classoomph_1_1ProjectionProblem.html#ad972f78212e515a03d1018996115265a">oomph::ProjectionProblem&lt; PROJECTABLE_ELEMENT &gt;::project()</a>, <a class="el" href="../../d5/dc5/classoomph_1_1ProjectionProblem.html#a4091e944bf95ae7b3cc86ac427d93257">oomph::ProjectionProblem&lt; PROJECTABLE_ELEMENT &gt;::ProjectionProblem()</a>, and <a class="el" href="../../d3/d73/classoomph_1_1WomersleyProblem.html#adc4074cd09df4505feb27e22abb6922a">oomph::WomersleyProblem&lt; ELEMENT, DIM &gt;::WomersleyProblem()</a>.</p>

</div>
</div>
<a id="a86c4feb98ec982a08dc84fb664f53abc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86c4feb98ec982a08dc84fb664f53abc">&#9670;&nbsp;</a></span>Relaxation_factor</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> oomph::Problem::Relaxation_factor</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Relaxation fator for Newton method (only a fractional Newton correction is applied if this is less than 1; default 1). </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aae8cf62757e432b625ec81fad1559dc3">newton_solve()</a>.</p>

</div>
</div>
<a id="aeef791a0158657ca7c298ffcb63ed54e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeef791a0158657ca7c298ffcb63ed54e">&#9670;&nbsp;</a></span>Saved_dof_pt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt;<a class="el" href="../../df/de6/classdouble.html">double</a>&gt;* oomph::Problem::Saved_dof_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pointer to vector for backup of dofs. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a3c927ed4f3e79527e0e23ac44779f0f8">restore_dof_values()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac3ed0463968bd0fef5d9b97bcb8ca163">store_current_dof_values()</a>.</p>

</div>
</div>
<a id="a708322baf423e373970384006c2ca4db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a708322baf423e373970384006c2ca4db">&#9670;&nbsp;</a></span>Scale_arc_length</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::Problem::Scale_arc_length</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Boolean to control whether arc-length should be scaled. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a533e7f2876442a1660e675aa225cbbe6">calculate_continuation_derivatives()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a8978d65572c5ae81f7381fa6a6d56ba0">calculate_continuation_derivatives_fd()</a>.</p>

</div>
</div>
<a id="ab4a3743c23a2d1eed56981484636c958"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4a3743c23a2d1eed56981484636c958">&#9670;&nbsp;</a></span>Shut_up_in_newton_solve</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::Problem::Shut_up_in_newton_solve</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Boolean to indicate if all output is suppressed in Problem::newton_solve(). Defaults to false. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af00e3623681347439fe3dac650423bbe">disable_info_in_newton_solve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a3226bf49118c8a4f02dbe01d22428f20">enable_info_in_newton_solve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5ee48c16fce89952a019a844ac386655">get_inverse_mass_matrix_times_residuals()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aae8cf62757e432b625ec81fad1559dc3">newton_solve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7b86783463433cc9c4cc382b1b40f0e1">newton_solve_continuation()</a>, and <a class="el" href="../../d5/dc5/classoomph_1_1ProjectionProblem.html#ad972f78212e515a03d1018996115265a">oomph::ProjectionProblem&lt; PROJECTABLE_ELEMENT &gt;::project()</a>.</p>

</div>
</div>
<a id="aca97d61840e46edc914e3cb4b98fd437"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca97d61840e46edc914e3cb4b98fd437">&#9670;&nbsp;</a></span>Sign_of_jacobian</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> oomph::Problem::Sign_of_jacobian</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Storage for the sign of the global Jacobian. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acc35de219c1c1032a14840021fd8a6b9">arc_length_step_solve_helper()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6477df6e8184dc78e9d9ff82c7627cef">reset_arc_length_parameters()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a797cb28b5fffe976fc7541421eb423a1">sign_of_jacobian()</a>.</p>

</div>
</div>
<a id="aeb58a3cead4d10697c4471523f705130"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb58a3cead4d10697c4471523f705130">&#9670;&nbsp;</a></span>Sparse_assemble_with_arrays_allocation_increment</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> oomph::Problem::Sparse_assemble_with_arrays_allocation_increment</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>the number of elements to add to a matrix row when the initial allocation is exceeded within the sparse_assemble_with_two_arrays(...) method. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a23465a0b1944a4bd31b9e0add9cc9875">sparse_assemble_row_or_column_compressed_with_two_arrays()</a>.</p>

</div>
</div>
<a id="ad2d5f8e18619fafcff11727b1c55b3eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2d5f8e18619fafcff11727b1c55b3eb">&#9670;&nbsp;</a></span>Sparse_assemble_with_arrays_initial_allocation</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> oomph::Problem::Sparse_assemble_with_arrays_initial_allocation</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>the number of elements to initially allocate for a matrix row within the sparse_assembly_with_two_arrays(...) method (if a matrix of this size has not been assembled already). If a matrix of this size has been assembled then the number of elements in each row in that matrix is used as the initial allocation </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a23465a0b1944a4bd31b9e0add9cc9875">sparse_assemble_row_or_column_compressed_with_two_arrays()</a>.</p>

</div>
</div>
<a id="a547c85bfa6a2eb3effc4db1b46ebcdde"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a547c85bfa6a2eb3effc4db1b46ebcdde">&#9670;&nbsp;</a></span>Sparse_assemble_with_arrays_previous_allocation</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt;<a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt;<a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&gt; &gt; oomph::Problem::Sparse_assemble_with_arrays_previous_allocation</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>the number of elements in each row of a compressed matrix in the previous matrix assembly. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers()</a>, <a class="el" href="../../d4/dcb/classoomph_1_1FoldHandler.html#add39896d007559f4fb801f1c95e4ab16">oomph::FoldHandler::FoldHandler()</a>, <a class="el" href="../../d4/da2/classoomph_1_1HopfHandler.html#ac219516b8263300eb5102d38baab05d7">oomph::HopfHandler::HopfHandler()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a96e0343c261d087f5d67a49f68561d96">oomph::PitchForkHandler::PitchForkHandler()</a>, <a class="el" href="../../d4/dcb/classoomph_1_1FoldHandler.html#a7718a18444f6e328953dd5d5e73802f8">oomph::FoldHandler::solve_augmented_block_system()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ad0b0920383bcbdab5df1f43db5affa47">oomph::PitchForkHandler::solve_augmented_block_system()</a>, <a class="el" href="../../d4/dcb/classoomph_1_1FoldHandler.html#abf0c7293014112731f0482e464f4daa3">oomph::FoldHandler::solve_block_system()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ad193c3d67741edd60b023c94e42c8802">oomph::PitchForkHandler::solve_block_system()</a>, <a class="el" href="../../d4/da2/classoomph_1_1HopfHandler.html#ac7feecfa644ae33b4a4a9fa8d1d993af">oomph::HopfHandler::solve_complex_system()</a>, <a class="el" href="../../d4/dcb/classoomph_1_1FoldHandler.html#a506c9a7bb372c6d8799c6dabc9448f46">oomph::FoldHandler::solve_full_system()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a27325616f4342d159f6f5e7c82ccdf98">oomph::PitchForkHandler::solve_full_system()</a>, <a class="el" href="../../d4/da2/classoomph_1_1HopfHandler.html#a507681043126f6bea58cc90deed16d1d">oomph::HopfHandler::solve_full_system()</a>, <a class="el" href="../../d4/da2/classoomph_1_1HopfHandler.html#acd2149152659deef1d938739222dbcf2">oomph::HopfHandler::solve_standard_system()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a23465a0b1944a4bd31b9e0add9cc9875">sparse_assemble_row_or_column_compressed_with_two_arrays()</a>, <a class="el" href="../../d4/dcb/classoomph_1_1FoldHandler.html#ab582d9ac969e0f7779a285d21a6d8e45">oomph::FoldHandler::~FoldHandler()</a>, <a class="el" href="../../d4/da2/classoomph_1_1HopfHandler.html#a2b2822861fc417fea32cbba38f9dd650">oomph::HopfHandler::~HopfHandler()</a>, and <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a69c6b0b6aedd03d828d295531fd61820">oomph::PitchForkHandler::~PitchForkHandler()</a>.</p>

</div>
</div>
<a id="a447f9d42b248f6c394581ff1a0b02513"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a447f9d42b248f6c394581ff1a0b02513">&#9670;&nbsp;</a></span>Sparse_assembly_method</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> oomph::Problem::Sparse_assembly_method</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Flag to determine which sparse assembly method to use By default we use assembly by vectors of pairs. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ab9cdd18180be05e4d46bfdbc1acbdbd3">sparse_assemble_row_or_column_compressed()</a>.</p>

</div>
</div>
<a id="a075696d6f4c4260ce860997c8c931de4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a075696d6f4c4260ce860997c8c931de4">&#9670;&nbsp;</a></span>Store_local_dof_pt_in_elements</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::Problem::Store_local_dof_pt_in_elements</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Boolean to indicate whether local dof pointers should be stored in the elements </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac23468bc4101d3038e6b537b6fc87aa6">disable_store_local_dof_pt_in_elements()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a31ba79405993ec52e3017d6ff3a42c8c">enable_store_local_dof_pt_in_elements()</a>.</p>

</div>
</div>
<a id="ab65f6fc9c49860e6324457a7e6e76346"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab65f6fc9c49860e6324457a7e6e76346">&#9670;&nbsp;</a></span>Sub_mesh_pt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt;<a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a>*&gt; oomph::Problem::Sub_mesh_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Vector of pointers to submeshes. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a0cd05109bc2c003c5c0686e6aa55d847">add_sub_mesh()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5340769f2b1051a77d443eb05c8f68c">assign_eqn_numbers()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aa29176d84610e0273fc823cace91765a">build_global_mesh()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a74a72dc989531d264ec1959f3015b98c">describe_dofs()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a75fe4a89f7dccbd72a67333b3959539d">does_pointer_correspond_to_problem_data()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a42b2b42a03f9de7d7a4d24edcfa20179">flush_sub_meshes()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac9d882b768345fd916079ec184764f72">mesh_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad9d44f0ef936fb62f0ce41dd200494ac">Problem()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a266d4d1b2bd4a5cbc028ff5aba79508f">rebuild_global_mesh()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ae78e313f1dc3bc956f42a5d0bd06c459">set_consistent_pinned_values_for_continuation()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6aab91bb814a85409648dc87807907e6">set_pinned_values_to_zero()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a50d54d4b374ea6a8d76798f34b865944">set_timestepper_for_all_data()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a839a525ed01c34d57fff42583003d3e7">~Problem()</a>.</p>

</div>
</div>
<a id="a36b11f7bc1b7b9413ee4a78eab536df8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36b11f7bc1b7b9413ee4a78eab536df8">&#9670;&nbsp;</a></span>Suppress_warning_about_actions_before_read_unstructured_meshes</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> Problem::Suppress_warning_about_actions_before_read_unstructured_meshes</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=</div>
<div class="line">    <span class="keyword">false</span></div>
</div><!-- fragment --><p>Flag to allow suppression of warning messages re reading in unstructured meshes during restart.</p>
<p>Instantiation of public flag to allow suppression of warning messages re reading in unstructured meshes during restart. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a4f6011ef141cc68598a9502052129a3f">read()</a>.</p>

</div>
</div>
<a id="a123843ca2ed6384342939ef2b19477ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a123843ca2ed6384342939ef2b19477ef">&#9670;&nbsp;</a></span>Theta_squared</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> oomph::Problem::Theta_squared</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Value of the scaling parameter required so that the parameter occupies the desired proportion of the arc length. NOTE: If you wish to change this then make sure to set the value of Scale_arc_length to false to ensure the value of this isn't overwritten during the arc-length process. Instead of changing this variable, it's better to actually update the Desired_proportion_of_arc_length value. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a533e7f2876442a1660e675aa225cbbe6">calculate_continuation_derivatives()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a8978d65572c5ae81f7381fa6a6d56ba0">calculate_continuation_derivatives_fd()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7a4dac8d3f4f06020b04a4af0a2d7b32">calculate_continuation_derivatives_fd_helper()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a420904bddcee85ee817dd9fcad0df216">calculate_continuation_derivatives_helper()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7b86783463433cc9c4cc382b1b40f0e1">newton_solve_continuation()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a6477df6e8184dc78e9d9ff82c7627cef">reset_arc_length_parameters()</a>.</p>

</div>
</div>
<a id="a3e9aecf88bde320bc2d169b5f3c99fee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e9aecf88bde320bc2d169b5f3c99fee">&#9670;&nbsp;</a></span>Time_adaptive_newton_crash_on_solve_fail</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::Problem::Time_adaptive_newton_crash_on_solve_fail</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Bool to specify what to do if a Newton solve fails within a time adaptive solve. Default (false) is to half the step and try again. If true then crash instead. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a63805c549e71b7c73107abe6001fae25">adaptive_unsteady_newton_solve()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7a42b89a67e0770c68493b9569bffe16">time_adaptive_newton_crash_on_solve_fail()</a>.</p>

</div>
</div>
<a id="ae33fbf5f34a7d06d88ad2c98538bbbe8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae33fbf5f34a7d06d88ad2c98538bbbe8">&#9670;&nbsp;</a></span>Time_pt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/da1/classoomph_1_1Time.html">Time</a>* oomph::Problem::Time_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pointer to global time for the problem. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a05df1c91c6ccffa24e42fda85af156a1">add_time_stepper_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a5f7e9e91eab83d600c94afdad532a6fb">initialise_dt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a7e79846a57705934352b55b6d675d77d">set_explicit_time_stepper_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a3d3108a38cfbed4087f5b8eb601f38a2">shift_time_values()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#affda31840308a51d36324e6debe1bee7">time()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a46894b13c582f322082dc471a2485980">time_pt()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a839a525ed01c34d57fff42583003d3e7">~Problem()</a>.</p>

</div>
</div>
<a id="af1e8f8a739453250eb3744fea2a3b983"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1e8f8a739453250eb3744fea2a3b983">&#9670;&nbsp;</a></span>Time_stepper_pt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt;<a class="el" href="../../d5/d19/classoomph_1_1TimeStepper.html">TimeStepper</a>*&gt; oomph::Problem::Time_stepper_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The Vector of time steppers (there could be many different ones in multiphysics problems) </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a05df1c91c6ccffa24e42fda85af156a1">add_time_stepper_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acbc0b0fc5d5cc76ce8384bc0bd815f26">calculate_predictions()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ace3cdf55009c3bff21d2b7d3706d522a">ntime_stepper()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad9d44f0ef936fb62f0ce41dd200494ac">Problem()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad77413dc70a25d271f582ad3c3d7bf65">time_stepper_pt()</a>.</p>

</div>
</div>
<a id="a359d1936bc2146e0a0ce697776efcf91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a359d1936bc2146e0a0ce697776efcf91">&#9670;&nbsp;</a></span>Timestep_reduction_factor_after_nonconvergence</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> oomph::Problem::Timestep_reduction_factor_after_nonconvergence</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>What it says: If temporally adaptive Newton solver fails to to converge, reduce timestep by this factor and try again; defaults to 1/2; can be over-written by user in derived problem. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a63805c549e71b7c73107abe6001fae25">adaptive_unsteady_newton_solve()</a>.</p>

</div>
</div>
<a id="adbecce0cb1bd7b6b21285568e41ee3eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adbecce0cb1bd7b6b21285568e41ee3eb">&#9670;&nbsp;</a></span>Use_continuation_timestepper</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::Problem::Use_continuation_timestepper</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Boolean to control original or new storage of dof stuff. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad5e60c7b47591bca6b20b0612e119983">adapt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aee0d9902fd26b600c9519bea2dfc0f54">arc_length_step_solve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acc35de219c1c1032a14840021fd8a6b9">arc_length_step_solve_helper()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a420904bddcee85ee817dd9fcad0df216">calculate_continuation_derivatives_helper()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a10fd6457ceceb02a0e11d860ac0017c5">dof_current()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad6df5fb0d282f25df1e94a665dd838e5">dof_derivative()</a>.</p>

</div>
</div>
<a id="a80dac9f70c77302805bb782cc6f1ad0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80dac9f70c77302805bb782cc6f1ad0f">&#9670;&nbsp;</a></span>Use_finite_differences_for_continuation_derivatives</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::Problem::Use_finite_differences_for_continuation_derivatives</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Boolean to specify which scheme to use to calculate the continuation derivatievs </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#acc35de219c1c1032a14840021fd8a6b9">arc_length_step_solve_helper()</a>.</p>

</div>
</div>
<a id="acf8b1ec937efdf2a0f892a41c18c0c53"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf8b1ec937efdf2a0f892a41c18c0c53">&#9670;&nbsp;</a></span>Use_globally_convergent_newton_method</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::Problem::Use_globally_convergent_newton_method</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Use the globally convergent newton method. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a927d35230db6fc5021b68eadaedac9a6">disable_globally_convergent_newton_method()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ac7c7711978f7c02becb4005414f945be">enable_globally_convergent_newton_method()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aae8cf62757e432b625ec81fad1559dc3">newton_solve()</a>.</p>

</div>
</div>
<a id="afe6f5bb841832b3c4d1f06c2d939f4a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe6f5bb841832b3c4d1f06c2d939f4a6">&#9670;&nbsp;</a></span>Use_predictor_values_as_initial_guess</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::Problem::Use_predictor_values_as_initial_guess</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Use values from the time stepper predictor as an initial guess. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#ad9d44f0ef936fb62f0ce41dd200494ac">Problem()</a>, and <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a438bf1c7aafffda56f2acb34ba027fdb">use_predictor_values_as_initial_guess()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="../../d0/d83/problem_8h_source.html">problem.h</a></li>
<li><a class="el" href="../../d5/d35/problem_8cc.html">problem.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../da/ddf/namespaceoomph.html">oomph</a></li><li class="navelem"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a></li>
    <li class="footer">Generated on Wed Aug 27 2025 17:09:10 for MercuryDPM by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
