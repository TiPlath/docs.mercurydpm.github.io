<!-- HTML header for doxygen 1.8.18-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MercuryDPM: oomph::ConstitutiveLaw Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../MDPM.css" rel="stylesheet" type="text/css"/>
<link href="../../codeLabels.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-fork-corner.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-dropdown-version.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../MDPM-fragment-copy-button.js"></script>
<script type="text/javascript">
DoxygenAwesomeFragmentCopyButton.init()
</script>
<script type="text/javascript" src="../../MDPM-paragraph-link.js"></script>
<script type="text/javascript">
DoxygenAwesomeParagraphLink.init()
</script>
<script type="text/javascript" src="../../MDPM-interactive-toc.js"></script>
<script type="text/javascript">
DoxygenAwesomeInteractiveToc.init()
</script>
<script type="text/javascript" src="../../MDPM-darkmode-toggle.js"></script>
<script type="text/javascript">
DoxygenAwesomeDarkModeToggle.init()
</script>
</head>
<body>
  <div id="bitbucket-corner">
   <a href="https://bitbucket.org/mercurydpm/mercurydpm/src/master/" target="_blank" id="fork-corner" class="fork-corner fc-pos-tr fc-animate fc-theme-bitbucket"></a>
  </div>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../mercury-logo-chosen-light-slogan.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"> <!--MercuryDPM--!>
   <!-- BEGIN version select -->
   <div class="dropdown" id="projectnumber">
    <button class="dropbtn">v1.0</button>
    <div class="dropdown-content">
    </div>
   </div>
   <script type="text/javascript" src="../../MDPM-dropdown-version.js"></script>
<!-- END version select -->
   <!--&#160;<span id="projectnumber">revision: v1.0</span>-->
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<script type="text/javascript" src="../../MDPM-fork-corner.js"></script>
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('dc/de2/classoomph_1_1ConstitutiveLaw.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="../../df/dc7/classoomph_1_1ConstitutiveLaw-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">oomph::ConstitutiveLaw Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="../../d4/d26/constitutive__laws_8h_source.html">constitutive_laws.h</a>&gt;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Inheritance diagram for oomph::ConstitutiveLaw:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
 <div class="center">
  <img src="../../dc/de2/classoomph_1_1ConstitutiveLaw.png" usemap="#oomph::ConstitutiveLaw_map" alt=""/>
  <map id="oomph::ConstitutiveLaw_map" name="oomph::ConstitutiveLaw_map">
<area href="../../d3/d66/classoomph_1_1GeneralisedHookean.html" alt="oomph::GeneralisedHookean" shape="rect" coords="0,56,314,80"/>
<area href="../../d8/d8c/classoomph_1_1IsotropicStrainEnergyFunctionConstitutiveLaw.html" alt="oomph::IsotropicStrainEnergyFunctionConstitutiveLaw" shape="rect" coords="324,56,638,80"/>
<area href="../../d4/d7c/classoomph_1_1AnisotropicHookean.html" alt="oomph::AnisotropicHookean" shape="rect" coords="0,112,314,136"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a864c36413e8ea31e63552f3db3b97a2f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a864c36413e8ea31e63552f3db3b97a2f">ConstitutiveLaw</a> ()</td></tr>
<tr class="memdesc:a864c36413e8ea31e63552f3db3b97a2f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Empty constructor.  <a href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a864c36413e8ea31e63552f3db3b97a2f">More...</a><br /></td></tr>
<tr class="separator:a864c36413e8ea31e63552f3db3b97a2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa75b88c826723ba090ace39c26da0ae6"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#aa75b88c826723ba090ace39c26da0ae6">~ConstitutiveLaw</a> ()</td></tr>
<tr class="memdesc:aa75b88c826723ba090ace39c26da0ae6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Empty virtual destructor.  <a href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#aa75b88c826723ba090ace39c26da0ae6">More...</a><br /></td></tr>
<tr class="separator:aa75b88c826723ba090ace39c26da0ae6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93527d910de908035feb8f41b0401065"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a93527d910de908035feb8f41b0401065">calculate_second_piola_kirchhoff_stress</a> (const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;g, const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>, <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;sigma)=0</td></tr>
<tr class="separator:a93527d910de908035feb8f41b0401065"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6076752384082cfa3de3e0cf17daa9aa"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a6076752384082cfa3de3e0cf17daa9aa">calculate_d_second_piola_kirchhoff_stress_dG</a> (const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;g, const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>, const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;sigma, <a class="el" href="../../d7/dbb/classoomph_1_1RankFourTensor.html">RankFourTensor</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;d_sigma_dG, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;symmetrize_tensor=true)</td></tr>
<tr class="separator:a6076752384082cfa3de3e0cf17daa9aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8178b1b7cd7e6a64942dba9e0997b30"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#ac8178b1b7cd7e6a64942dba9e0997b30">calculate_second_piola_kirchhoff_stress</a> (const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;g, const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>, <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;sigma_dev, <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;G_contra, <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;Gdet)</td></tr>
<tr class="separator:ac8178b1b7cd7e6a64942dba9e0997b30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af13f9d05db09870d1b90b7ef389bdb71"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#af13f9d05db09870d1b90b7ef389bdb71">calculate_d_second_piola_kirchhoff_stress_dG</a> (const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;g, const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>, const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;sigma, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;detG, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;interpolated_solid_p, <a class="el" href="../../d7/dbb/classoomph_1_1RankFourTensor.html">RankFourTensor</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;d_sigma_dG, <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;d_detG_dG, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;symmetrize_tensor=true)</td></tr>
<tr class="separator:af13f9d05db09870d1b90b7ef389bdb71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26f34355b626bebcad8f498fa5271d20"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a26f34355b626bebcad8f498fa5271d20">calculate_second_piola_kirchhoff_stress</a> (const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;g, const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>, <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;sigma_dev, <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;Gcontra, <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;gen_dil, <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;inv_kappa)</td></tr>
<tr class="separator:a26f34355b626bebcad8f498fa5271d20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a4f1bcac8d308d9ad0013ddf5def505"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a8a4f1bcac8d308d9ad0013ddf5def505">calculate_d_second_piola_kirchhoff_stress_dG</a> (const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;g, const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>, const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;sigma, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;gen_dil, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;inv_kappa, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;interpolated_solid_p, <a class="el" href="../../d7/dbb/classoomph_1_1RankFourTensor.html">RankFourTensor</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;d_sigma_dG, <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;d_gen_dil_dG, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;symmetrize_tensor=true)</td></tr>
<tr class="separator:a8a4f1bcac8d308d9ad0013ddf5def505"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a446452158a8ae9fbc3dde4277155f824"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a446452158a8ae9fbc3dde4277155f824">requires_incompressibility_constraint</a> ()=0</td></tr>
<tr class="separator:a446452158a8ae9fbc3dde4277155f824"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a73f01e1459e7ba998ef78f7ece6baa37"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a73f01e1459e7ba998ef78f7ece6baa37">is_matrix_square</a> (const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../d8/d3e/bench__gemm_8cpp.html#a989df10ff46666a2610162f3d1a90057">M</a>)</td></tr>
<tr class="memdesc:a73f01e1459e7ba998ef78f7ece6baa37"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test whether a matrix is square.  <a href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a73f01e1459e7ba998ef78f7ece6baa37">More...</a><br /></td></tr>
<tr class="separator:a73f01e1459e7ba998ef78f7ece6baa37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a89bb96a9b922294509923563a13063"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a8a89bb96a9b922294509923563a13063">are_matrices_of_equal_dimensions</a> (const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../d3/ddc/Tutorial__ReshapeMat2Vec_8cpp.html#a967134325b7c05c13dab4684a33b2da0">M1</a>, const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../dd/d24/Tutorial__SlicingCol_8cpp.html#a7aceba2743387d50fd551de7c39a95c5">M2</a>)</td></tr>
<tr class="memdesc:a8a89bb96a9b922294509923563a13063"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test whether two matrices are of equal dimensions.  <a href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a8a89bb96a9b922294509923563a13063">More...</a><br /></td></tr>
<tr class="separator:a8a89bb96a9b922294509923563a13063"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01763658a56a962460a80607653a33b4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a01763658a56a962460a80607653a33b4">error_checking_in_input</a> (const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;g, const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>, <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;sigma)</td></tr>
<tr class="separator:a01763658a56a962460a80607653a33b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c188df10b08b340b923c3a733c0d178"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a5c188df10b08b340b923c3a733c0d178">calculate_contravariant</a> (const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;Gcov, <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;Gcontra)</td></tr>
<tr class="memdesc:a5c188df10b08b340b923c3a733c0d178"><td class="mdescLeft">&#160;</td><td class="mdescRight">The function to calculate the contravariant tensor from a covariant one.  <a href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a5c188df10b08b340b923c3a733c0d178">More...</a><br /></td></tr>
<tr class="separator:a5c188df10b08b340b923c3a733c0d178"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6dda64e60ed8128cb4603041dc66036f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a6dda64e60ed8128cb4603041dc66036f">calculate_d_contravariant_dG</a> (const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;Gcov, <a class="el" href="../../d7/dbb/classoomph_1_1RankFourTensor.html">RankFourTensor</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;dGcontra_dG, <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;d_detG_dG)</td></tr>
<tr class="separator:a6dda64e60ed8128cb4603041dc66036f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>///////////////////////////////////////////////////////////////// ///////////////////////////////////////////////////////////////// ///////////////////////////////////////////////////////////////// A class for constitutive laws for elements that solve the equations of solid mechanics based upon the principle of virtual displacements. In that formulation, the information required from a constitutive law is the (2nd Piola-Kirchhoff) stress tensor \( \sigma^{ij} \) as a function of the (Green) strain \( \gamma^{ij} \): </p><p class="formulaDsp">
\[ \sigma^{ij} = \sigma^{ij}(\gamma_{ij}). \]
</p>
<p> The Green strain is defined as </p><p class="formulaDsp">
\[ \gamma_{ij} = \frac{1}{2} (G_{ij} - g_{ij}), \ \ \ \ \ \ \ \ \ \ \ (1) \]
</p>
<p> where \(G_{ij} \) and \( g_{ij}\) are the metric tensors in the deformed and undeformed (stress-free) configurations, respectively. A specific ConstitutiveLaw needs to be implement the pure virtual function </p><div class="fragment"><div class="line"><a class="code" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a93527d910de908035feb8f41b0401065">ConstitutiveLaw::calculate_second_piola_kirchhoff_stress</a>(...)</div>
<div class="ttc" id="aclassoomph_1_1ConstitutiveLaw_html_a93527d910de908035feb8f41b0401065"><div class="ttname"><a href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a93527d910de908035feb8f41b0401065">oomph::ConstitutiveLaw::calculate_second_piola_kirchhoff_stress</a></div><div class="ttdeci">virtual void calculate_second_piola_kirchhoff_stress(const DenseMatrix&lt; double &gt; &amp;g, const DenseMatrix&lt; double &gt; &amp;G, DenseMatrix&lt; double &gt; &amp;sigma)=0</div></div>
</div><!-- fragment --><p> Equation (1) shows that the strain may be calculated from the undeformed and deformed metric tensors. Frequently, these tensors are also required in the constitutive law itself. To avoid unnecessary re-computation of these quantities, we pass the deformed and undeformed metric tensor to <code>calculate_second_piola_kirchhoff_stress(...)</code> rather than the strain tensor itself.</p>
<p>The functional form of the constitutive equation is different for compressible/incompressible/near-incompressible behaviour and we provide interfaces that are appropriate for all of these cases.</p><ol type="1">
<li><p class="startli"><b>Compressible</b> <b>Behaviour:</b> <br  />
 If the material is compressible, the stress can be computed from the deformed and undeformed metric tensors,</p>
<p class="formulaDsp">
\[ \sigma^{ij} = \sigma^{ij}(\gamma_{ij}) = \sigma^{ij}\bigg( \frac{1}{2} (G_{ij} - g_{ij})\bigg), \]
</p>
<p> using the interface </p><div class="fragment"><div class="line"><span class="comment">// 2nd Piola Kirchhoff stress tensor</span></div>
<div class="line"><a class="code" href="../../dc/d34/classEigen_1_1Matrix.html">DenseMatrix&lt;double&gt;</a> <a class="code" href="../../d9/d33/namespacecalibrate.html#a6caaf28555dab8f7d970d42592f6bc44">sigma</a>(<a class="code" href="../../d5/d0e/linearised__navier__stokes__elements_8h.html#ac25189db92959bff3c6c2adf4c34b50a">DIM</a>,<a class="code" href="../../d5/d0e/linearised__navier__stokes__elements_8h.html#ac25189db92959bff3c6c2adf4c34b50a">DIM</a>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Metric tensor in the undeformed (stress-free) configuration</span></div>
<div class="line"><a class="code" href="../../dc/d34/classEigen_1_1Matrix.html">DenseMatrix&lt;double&gt;</a> g(<a class="code" href="../../d5/d0e/linearised__navier__stokes__elements_8h.html#ac25189db92959bff3c6c2adf4c34b50a">DIM</a>,<a class="code" href="../../d5/d0e/linearised__navier__stokes__elements_8h.html#ac25189db92959bff3c6c2adf4c34b50a">DIM</a>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Metric tensor in the deformed  configuration</span></div>
<div class="line"><a class="code" href="../../dc/d34/classEigen_1_1Matrix.html">DenseMatrix&lt;double&gt;</a> <a class="code" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>(<a class="code" href="../../d5/d0e/linearised__navier__stokes__elements_8h.html#ac25189db92959bff3c6c2adf4c34b50a">DIM</a>,<a class="code" href="../../d5/d0e/linearised__navier__stokes__elements_8h.html#ac25189db92959bff3c6c2adf4c34b50a">DIM</a>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Compute stress from the two metric tensors:</span></div>
<div class="line"><a class="code" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a93527d910de908035feb8f41b0401065">calculate_second_piola_kirchhoff_stress</a>(g,<a class="code" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>,<a class="code" href="../../d9/d33/namespacecalibrate.html#a6caaf28555dab8f7d970d42592f6bc44">sigma</a>);</div>
<div class="ttc" id="aJacobi__makeGivens_8cpp_html_ad2c49539791450cfceedabc09452d977"><div class="ttname"><a href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a></div><div class="ttdeci">JacobiRotation&lt; float &gt; G</div><div class="ttdef"><b>Definition:</b> Jacobi_makeGivens.cpp:2</div></div>
<div class="ttc" id="aclassEigen_1_1Matrix_html"><div class="ttname"><a href="../../dc/d34/classEigen_1_1Matrix.html">Eigen::Matrix&lt; Scalar, Dynamic, Dynamic &gt;</a></div></div>
<div class="ttc" id="alinearised__navier__stokes__elements_8h_html_ac25189db92959bff3c6c2adf4c34b50a"><div class="ttname"><a href="../../d5/d0e/linearised__navier__stokes__elements_8h.html#ac25189db92959bff3c6c2adf4c34b50a">DIM</a></div><div class="ttdeci">#define DIM</div><div class="ttdef"><b>Definition:</b> linearised_navier_stokes_elements.h:44</div></div>
<div class="ttc" id="anamespacecalibrate_html_a6caaf28555dab8f7d970d42592f6bc44"><div class="ttname"><a href="../../d9/d33/namespacecalibrate.html#a6caaf28555dab8f7d970d42592f6bc44">calibrate.sigma</a></div><div class="ttdeci">int sigma</div><div class="ttdef"><b>Definition:</b> calibrate.py:179</div></div>
</div><!-- fragment --><p> <br  />
 <br  />
 <br  />
</p>
</li>
<li><p class="startli"><b>Incompressible</b> <b>Behaviour:</b> <br  />
 If the material is incompressible, its deformation is constrained by the condition that</p>
<p class="formulaDsp">
\[ \det G_{ij} - \det g_{ij}= 0 \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (2) \]
</p>
<p> which ensures that the volume of infinitesimal material elements remains constant during the deformation. This condition is typically enforced by a Lagrange multiplier which plays the role of a pressure. In such cases, the stress tensor has form</p>
<p class="formulaDsp">
\[ \sigma^{ij} = -p G^{ij} + \overline{\sigma}^{ij}\big(\gamma_{kl}\big), \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (3) \]
</p>
<p> where only the deviatoric part of the stress tensor, \( \overline{\sigma}^{ij}, \) depends directly on the strain. The pressure \( p \) needs to be determined independently from (2). Given the deformed and undeformed metric tensors, the computation of the stress tensor \( \sigma^{ij} \) for an incompressible material therefore requires the computation of the following quantities:</p><ul>
<li>The deviatoric stress \( \overline{\sigma}^{ij} \)</li>
<li>The contravariant deformed metric tensor \( G^{ij} \)</li>
<li>The determinant of the deformed metric tensors, \( \det G_{ij}, \) which is required in equation (2) whose solution determines the pressure.</li>
</ul>
</li>
</ol>
<p><br  />
 These quantities can be obtained from the following interface <br  />
</p><div class="fragment"><div class="line"><span class="comment">// Deviatoric part of the 2nd Piola Kirchhoff stress tensor</span></div>
<div class="line"><a class="code" href="../../dc/d34/classEigen_1_1Matrix.html">DenseMatrix&lt;double&gt;</a> sigma_dev(<a class="code" href="../../d5/d0e/linearised__navier__stokes__elements_8h.html#ac25189db92959bff3c6c2adf4c34b50a">DIM</a>,<a class="code" href="../../d5/d0e/linearised__navier__stokes__elements_8h.html#ac25189db92959bff3c6c2adf4c34b50a">DIM</a>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Metric tensor in the undeformed (stress-free) configuration</span></div>
<div class="line"><a class="code" href="../../dc/d34/classEigen_1_1Matrix.html">DenseMatrix&lt;double&gt;</a> g(<a class="code" href="../../d5/d0e/linearised__navier__stokes__elements_8h.html#ac25189db92959bff3c6c2adf4c34b50a">DIM</a>,<a class="code" href="../../d5/d0e/linearised__navier__stokes__elements_8h.html#ac25189db92959bff3c6c2adf4c34b50a">DIM</a>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Metric tensor in the deformed  configuration</span></div>
<div class="line"><a class="code" href="../../dc/d34/classEigen_1_1Matrix.html">DenseMatrix&lt;double&gt;</a> <a class="code" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>(<a class="code" href="../../d5/d0e/linearised__navier__stokes__elements_8h.html#ac25189db92959bff3c6c2adf4c34b50a">DIM</a>,<a class="code" href="../../d5/d0e/linearised__navier__stokes__elements_8h.html#ac25189db92959bff3c6c2adf4c34b50a">DIM</a>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Determinant of the deformed metric tensor</span></div>
<div class="line"><span class="keywordtype">double</span> Gdet;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Contravariant deformed metric tensor</span></div>
<div class="line"><a class="code" href="../../dc/d34/classEigen_1_1Matrix.html">DenseMatrix&lt;double&gt;</a> G_contra(<a class="code" href="../../d5/d0e/linearised__navier__stokes__elements_8h.html#ac25189db92959bff3c6c2adf4c34b50a">DIM</a>,<a class="code" href="../../d5/d0e/linearised__navier__stokes__elements_8h.html#ac25189db92959bff3c6c2adf4c34b50a">DIM</a>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Compute stress from the two metric tensors:</span></div>
<div class="line"><a class="code" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a93527d910de908035feb8f41b0401065">calculate_second_piola_kirchhoff_stress</a>(g,<a class="code" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>,sigma_dev,G_contra,Gdet);</div>
</div><!-- fragment --><p> <br  />
 <br  />
 <br  />
</p><ol type="1">
<li><p class="startli"><b>Nearly</b> <b>Incompressible</b> <b>Behaviour:</b> <br  />
 If the material is nearly incompressible, it is advantageous to split the stress into its deviatoric and hydrostatic parts by writing the constitutive law in the form</p>
<p class="formulaDsp">
\[ \sigma^{ij} = -p G^{ij} + \overline{\sigma}^{ij}\big(\gamma_{kl}\big), \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (3) \]
</p>
<p> where the deviatoric part of the stress tensor, \( \overline{\sigma}^{ij}, \) depends on the strain. This form of the constitutive law is identical to that of the incompressible case and it involves a pressure \( p \) which needs to be determined from an additional equation. In the incompressible case, this equation was given by the incompressibility constraint (2). Here, we need to augment the constitutive law (3) by a separate equation for the pressure. Generally this takes the form</p>
<p class="formulaDsp">
\[ p = - \kappa \ d \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (4) \]
</p>
<p> where \( \kappa \) is the "bulk modulus", a material property that needs to be specified by the constitutive law. \( d \) is the (generalised) dilatation, i.e. the relative change in the volume of an infinitesimal material element (or some suitable generalised quantitiy that is related to it). As the material approaches incompressibility, \( \kappa \to \infty\), so that infinitely large pressures would be required to achieve any change in volume. To facilitate the implementation of (4) as the equation for the pressure, we re-write it in the form </p><p class="formulaDsp">
\[ p \ \frac{1}{\kappa} + d\big(g_{ij},G_{ij}\big) = 0 \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (5) \]
</p>
<p> which only involves quantities that remain finite as we approach true incompressibility. <br  />
 Given the deformed and undeformed metric tensors, the computation of the stress tensor \( \sigma^{ij} \) for a nearly incompressible material therefore requires the computation of the following quantities:</p><ul>
<li>The deviatoric stress \( \overline{\sigma}^{ij} \)</li>
<li>The contravariant deformed metric tensor \( G^{ij} \)</li>
<li>The generalised dilatation \( d \)</li>
<li>The inverse of the bulk modulus \( \kappa \)</li>
</ul>
</li>
</ol>
<p><br  />
 These quantities can be obtained from the following interface <br  />
</p><div class="fragment"><div class="line"><span class="comment">// Deviatoric part of the 2nd Piola Kirchhoff stress tensor</span></div>
<div class="line"><a class="code" href="../../dc/d34/classEigen_1_1Matrix.html">DenseMatrix&lt;double&gt;</a> sigma_dev(<a class="code" href="../../d5/d0e/linearised__navier__stokes__elements_8h.html#ac25189db92959bff3c6c2adf4c34b50a">DIM</a>,<a class="code" href="../../d5/d0e/linearised__navier__stokes__elements_8h.html#ac25189db92959bff3c6c2adf4c34b50a">DIM</a>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Metric tensor in the undeformed (stress-free) configuration</span></div>
<div class="line"><a class="code" href="../../dc/d34/classEigen_1_1Matrix.html">DenseMatrix&lt;double&gt;</a> g(<a class="code" href="../../d5/d0e/linearised__navier__stokes__elements_8h.html#ac25189db92959bff3c6c2adf4c34b50a">DIM</a>,<a class="code" href="../../d5/d0e/linearised__navier__stokes__elements_8h.html#ac25189db92959bff3c6c2adf4c34b50a">DIM</a>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Metric tensor in the deformed  configuration</span></div>
<div class="line"><a class="code" href="../../dc/d34/classEigen_1_1Matrix.html">DenseMatrix&lt;double&gt;</a> <a class="code" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>(<a class="code" href="../../d5/d0e/linearised__navier__stokes__elements_8h.html#ac25189db92959bff3c6c2adf4c34b50a">DIM</a>,<a class="code" href="../../d5/d0e/linearised__navier__stokes__elements_8h.html#ac25189db92959bff3c6c2adf4c34b50a">DIM</a>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Contravariant deformed metric tensor</span></div>
<div class="line"><a class="code" href="../../dc/d34/classEigen_1_1Matrix.html">DenseMatrix&lt;double&gt;</a> G_contra(<a class="code" href="../../d5/d0e/linearised__navier__stokes__elements_8h.html#ac25189db92959bff3c6c2adf4c34b50a">DIM</a>,<a class="code" href="../../d5/d0e/linearised__navier__stokes__elements_8h.html#ac25189db92959bff3c6c2adf4c34b50a">DIM</a>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Inverse of the bulk modulus</span></div>
<div class="line"><span class="keywordtype">double</span> inv_kappa;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Generalised dilatation</span></div>
<div class="line"><span class="keywordtype">double</span> gen_dil;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Compute stress from the two metric tensors:</span></div>
<div class="line"><a class="code" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a93527d910de908035feb8f41b0401065">calculate_second_piola_kirchhoff_stress</a>(g,<a class="code" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>,sigma_dev,G_contra,inv_kappa,gen_dil);</div>
</div><!-- fragment --> </div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a864c36413e8ea31e63552f3db3b97a2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a864c36413e8ea31e63552f3db3b97a2f">&#9670;&nbsp;</a></span>ConstitutiveLaw()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">oomph::ConstitutiveLaw::ConstitutiveLaw </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Empty constructor. </p>
<div class="fragment"><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;{}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa75b88c826723ba090ace39c26da0ae6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa75b88c826723ba090ace39c26da0ae6">&#9670;&nbsp;</a></span>~ConstitutiveLaw()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual oomph::ConstitutiveLaw::~ConstitutiveLaw </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Empty virtual destructor. </p>
<div class="fragment"><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;{}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a8a89bb96a9b922294509923563a13063"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a89bb96a9b922294509923563a13063">&#9670;&nbsp;</a></span>are_matrices_of_equal_dimensions()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::ConstitutiveLaw::are_matrices_of_equal_dimensions </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>M1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>M2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Test whether two matrices are of equal dimensions. </p>
<p>This function is used to check whether matrices are of equal dimension. </p>
<div class="fragment"><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="comment">// If the numbers of rows and columns are not the same, then the</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="comment">// matrices are not of equal dimension</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="../../dd/d24/Tutorial__SlicingCol_8cpp.html#ae3d6437398466d60bb35d7410dd01887">M1</a>.nrow() != <a class="code" href="../../dd/d76/Tutorial__ReshapeMat2Mat_8cpp.html#a428d096ff5bfc3df5c5489495c926984">M2</a>.nrow()) || (<a class="code" href="../../dd/d24/Tutorial__SlicingCol_8cpp.html#ae3d6437398466d60bb35d7410dd01887">M1</a>.ncol() != <a class="code" href="../../dd/d76/Tutorial__ReshapeMat2Mat_8cpp.html#a428d096ff5bfc3df5c5489495c926984">M2</a>.ncol()))</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    }</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    }</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  }</div>
<div class="ttc" id="aTutorial__ReshapeMat2Mat_8cpp_html_a428d096ff5bfc3df5c5489495c926984"><div class="ttname"><a href="../../dd/d76/Tutorial__ReshapeMat2Mat_8cpp.html#a428d096ff5bfc3df5c5489495c926984">M2</a></div><div class="ttdeci">M1&lt;&lt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12;Map&lt; MatrixXf &gt; M2(M1.data(), 6, 2)</div></div>
<div class="ttc" id="aTutorial__SlicingCol_8cpp_html_ae3d6437398466d60bb35d7410dd01887"><div class="ttname"><a href="../../dd/d24/Tutorial__SlicingCol_8cpp.html#ae3d6437398466d60bb35d7410dd01887">M1</a></div><div class="ttdeci">MatrixXf M1</div><div class="ttdef"><b>Definition:</b> Tutorial_SlicingCol.cpp:1</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d24/Tutorial__SlicingCol_8cpp.html#ae3d6437398466d60bb35d7410dd01887">M1</a>, and <a class="el" href="../../dd/d76/Tutorial__ReshapeMat2Mat_8cpp.html#a428d096ff5bfc3df5c5489495c926984">M2()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a5c188df10b08b340b923c3a733c0d178">calculate_contravariant()</a>, <a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a6076752384082cfa3de3e0cf17daa9aa">calculate_d_second_piola_kirchhoff_stress_dG()</a>, and <a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a01763658a56a962460a80607653a33b4">error_checking_in_input()</a>.</p>

</div>
</div>
<a id="a5c188df10b08b340b923c3a733c0d178"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c188df10b08b340b923c3a733c0d178">&#9670;&nbsp;</a></span>calculate_contravariant()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> oomph::ConstitutiveLaw::calculate_contravariant </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>Gcov</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>Gcontra</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The function to calculate the contravariant tensor from a covariant one. </p>
<p>Calculate a contravariant tensor from a covariant tensor, and return the determinant of the covariant tensor. </p>
<p>Three dimensions</p>
<div class="fragment"><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="comment">// Initial error checking</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="comment">// Test that the matrices are of the same dimension</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a8a89bb96a9b922294509923563a13063">are_matrices_of_equal_dimensions</a>(Gdown, Gup))</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(<span class="stringliteral">&quot;Matrices passed to calculate_contravariant() are &quot;</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                          <span class="stringliteral">&quot;not of equal dimension&quot;</span>,</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="comment">// Find the dimension of the matrix</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordtype">unsigned</span> dim = Gdown.ncol();</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="comment">// If it&#39;s not square, I don&#39;t know what to do (yet)</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a73f01e1459e7ba998ef78f7ece6baa37">is_matrix_square</a>(Gdown))</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      <a class="code" href="../../d2/dc3/namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">std::string</a> error_message =</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="stringliteral">&quot;Matrix passed to calculate_contravariant() is not square\n&quot;</span>;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      error_message += <span class="stringliteral">&quot;non-square matrix inversion not implemented yet!\n&quot;</span>;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        error_message, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="comment">// Define the determinant of the matrix</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordtype">double</span> det = 0.0;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="comment">// Now the inversion depends upon the dimension of the matrix</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordflow">switch</span> (dim)</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    {</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="comment">// Zero dimensions</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(<span class="stringliteral">&quot;Zero dimensional matrix&quot;</span>,</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="comment">// One dimension</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="comment">// The determinant is just the value of the only entry</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        det = Gdown(0, 0);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="comment">// The inverse is just the inverse of the value</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        Gup(0, 0) = 1.0 / Gdown(0, 0);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="comment">// Two dimensions</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="comment">// Calculate the determinant</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        det = Gdown(0, 0) * Gdown(1, 1) - Gdown(0, 1) * Gdown(1, 0);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <span class="comment">// Calculate entries of the contravariant tensor (inverse)</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        Gup(0, 0) = Gdown(1, 1) / det;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        Gup(0, 1) = -Gdown(0, 1) / det;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        Gup(1, 0) = -Gdown(1, 0) / det;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        Gup(1, 1) = Gdown(0, 0) / det;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="comment">// Calculate the determinant of the matrix</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        det = Gdown(0, 0) * Gdown(1, 1) * Gdown(2, 2) +</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;              Gdown(0, 1) * Gdown(1, 2) * Gdown(2, 0) +</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;              Gdown(0, 2) * Gdown(1, 0) * Gdown(2, 1) -</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;              Gdown(0, 0) * Gdown(1, 2) * Gdown(2, 1) -</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;              Gdown(0, 1) * Gdown(1, 0) * Gdown(2, 2) -</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;              Gdown(0, 2) * Gdown(1, 1) * Gdown(2, 0);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <span class="comment">// Calculate entries of the inverse matrix</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        Gup(0, 0) =</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;          (Gdown(1, 1) * Gdown(2, 2) - Gdown(1, 2) * Gdown(2, 1)) / det;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        Gup(0, 1) =</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;          -(Gdown(0, 1) * Gdown(2, 2) - Gdown(0, 2) * Gdown(2, 1)) / det;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        Gup(0, 2) =</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;          (Gdown(0, 1) * Gdown(1, 2) - Gdown(0, 2) * Gdown(1, 1)) / det;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        Gup(1, 0) =</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;          -(Gdown(1, 0) * Gdown(2, 2) - Gdown(1, 2) * Gdown(2, 0)) / det;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        Gup(1, 1) =</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;          (Gdown(0, 0) * Gdown(2, 2) - Gdown(0, 2) * Gdown(2, 0)) / det;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        Gup(1, 2) =</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;          -(Gdown(0, 0) * Gdown(1, 2) - Gdown(0, 2) * Gdown(1, 0)) / det;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        Gup(2, 0) =</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;          (Gdown(1, 0) * Gdown(2, 1) - Gdown(1, 1) * Gdown(2, 0)) / det;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        Gup(2, 1) =</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;          -(Gdown(0, 0) * Gdown(2, 1) - Gdown(0, 1) * Gdown(2, 0)) / det;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        Gup(2, 2) =</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;          (Gdown(0, 0) * Gdown(1, 1) - Gdown(0, 1) * Gdown(1, 0)) / det;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(<span class="stringliteral">&quot;Dimension of matrix must be 0, 1, 2 or 3\n&quot;</span>,</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    }</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="comment">// Return the determinant of the matrix</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordflow">return</span> (det);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1ConstitutiveLaw_html_a73f01e1459e7ba998ef78f7ece6baa37"><div class="ttname"><a href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a73f01e1459e7ba998ef78f7ece6baa37">oomph::ConstitutiveLaw::is_matrix_square</a></div><div class="ttdeci">bool is_matrix_square(const DenseMatrix&lt; double &gt; &amp;M)</div><div class="ttdoc">Test whether a matrix is square.</div><div class="ttdef"><b>Definition:</b> constitutive_laws.cc:36</div></div>
<div class="ttc" id="aclassoomph_1_1ConstitutiveLaw_html_a8a89bb96a9b922294509923563a13063"><div class="ttname"><a href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a8a89bb96a9b922294509923563a13063">oomph::ConstitutiveLaw::are_matrices_of_equal_dimensions</a></div><div class="ttdeci">bool are_matrices_of_equal_dimensions(const DenseMatrix&lt; double &gt; &amp;M1, const DenseMatrix&lt; double &gt; &amp;M2)</div><div class="ttdoc">Test whether two matrices are of equal dimensions.</div><div class="ttdef"><b>Definition:</b> constitutive_laws.cc:52</div></div>
<div class="ttc" id="anamespaceoomph_1_1Global__string__for__annotation_html_ac5379de2fa7fe44f2cb31785fc208135"><div class="ttname"><a href="../../d2/dc3/namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">oomph::Global_string_for_annotation::string</a></div><div class="ttdeci">std::string string(const unsigned &amp;i)</div><div class="ttdef"><b>Definition:</b> oomph_definitions.cc:286</div></div>
<div class="ttc" id="aoomph__definitions_8h_html_a25c6813cc7341d125e2502f8923fb6c4"><div class="ttname"><a href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a></div><div class="ttdeci">#define OOMPH_EXCEPTION_LOCATION</div><div class="ttdef"><b>Definition:</b> oomph_definitions.h:61</div></div>
<div class="ttc" id="aoomph__definitions_8h_html_aa260cc4af589e30cea7fde997ae16667"><div class="ttname"><a href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a></div><div class="ttdeci">#define OOMPH_CURRENT_FUNCTION</div><div class="ttdef"><b>Definition:</b> oomph_definitions.h:86</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a8a89bb96a9b922294509923563a13063">are_matrices_of_equal_dimensions()</a>, <a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a73f01e1459e7ba998ef78f7ece6baa37">is_matrix_square()</a>, <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html#a9937181f1cb4cfaed7aaf3b483c42456">oomph::DenseMatrix&lt; T &gt;::ncol()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, and <a class="el" href="../../d2/dc3/namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">oomph::Global_string_for_annotation::string()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/d66/classoomph_1_1GeneralisedHookean.html#a5beca3e59f04d109c394bf9fd24bb7c1">oomph::GeneralisedHookean::calculate_second_piola_kirchhoff_stress()</a>, and <a class="el" href="../../d8/d8c/classoomph_1_1IsotropicStrainEnergyFunctionConstitutiveLaw.html#af6c25617b8be6cc454d6b526ec6121fc">oomph::IsotropicStrainEnergyFunctionConstitutiveLaw::calculate_second_piola_kirchhoff_stress()</a>.</p>

</div>
</div>
<a id="a6dda64e60ed8128cb4603041dc66036f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6dda64e60ed8128cb4603041dc66036f">&#9670;&nbsp;</a></span>calculate_d_contravariant_dG()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::ConstitutiveLaw::calculate_d_contravariant_dG </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>Gdown</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/dbb/classoomph_1_1RankFourTensor.html">RankFourTensor</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>d_Gup_dG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>d_detG_dG</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Calculate the derivatives of the contravariant tensor and the derivatives of the determinant of the covariant tensor with respect to the components of the covariant tensor</p>
<p>The function to calculate the derivatives of the contravariant tensor and determinant of covariant tensor with respect to the components of the covariant tensor </p>
<p>Three dimensions</p>
<div class="fragment"><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="comment">// Find the dimension of the matrix</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> dim = Gdown.<a class="code" href="../../d6/d13/classoomph_1_1DenseMatrix.html#a9937181f1cb4cfaed7aaf3b483c42456">ncol</a>();</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="comment">// If it&#39;s not square, I don&#39;t know what to do (yet)</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a73f01e1459e7ba998ef78f7ece6baa37">is_matrix_square</a>(Gdown))</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    {</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      <a class="code" href="../../d2/dc3/namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">std::string</a> error_message =</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <span class="stringliteral">&quot;Matrix passed to calculate_contravariant() is not square\n&quot;</span>;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      error_message += <span class="stringliteral">&quot;non-square matrix inversion not implemented yet!\n&quot;</span>;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        error_message, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160; </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="comment">// Define the determinant of the matrix</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordtype">double</span> det = 0.0;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="comment">// Now the inversion depends upon the dimension of the matrix</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordflow">switch</span> (dim)</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    {</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <span class="comment">// Zero dimensions</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(<span class="stringliteral">&quot;Zero dimensional matrix&quot;</span>,</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <span class="comment">// One dimension</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <span class="comment">// There is only one entry, so derivatives are easy</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        d_detG_dG(0, 0) = 1.0;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        d_Gup_dG(0, 0, 0, 0) = -1.0 / (Gdown(0, 0) * Gdown(0, 0));</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <span class="comment">// Two dimensions</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="comment">// Calculate the determinant</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        det = Gdown(0, 0) * Gdown(1, 1) - Gdown(0, 1) * Gdown(1, 0);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="comment">// Calculate the derivatives of the determinant</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        d_detG_dG(0, 0) = Gdown(1, 1);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <span class="comment">// Need to use symmetry here</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        d_detG_dG(0, 1) = d_detG_dG(1, 0) = -2.0 * Gdown(0, 1);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        d_detG_dG(1, 1) = Gdown(0, 0);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <span class="comment">// Calculate the &quot;upper triangular&quot; derivatives of the contravariant</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <span class="comment">// tensor</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        {</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">double</span> det2 = det * det;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;          d_Gup_dG(0, 0, 0, 0) = -Gdown(1, 1) * d_detG_dG(0, 0) / det2;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;          d_Gup_dG(0, 0, 0, 1) = -Gdown(1, 1) * d_detG_dG(0, 1) / det2;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;          d_Gup_dG(0, 0, 1, 1) =</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            1.0 / det - Gdown(1, 1) * d_detG_dG(1, 1) / det2;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;          d_Gup_dG(0, 1, 0, 0) = Gdown(0, 1) * d_detG_dG(0, 0) / det2;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;          d_Gup_dG(0, 1, 0, 1) =</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            -1.0 / det + Gdown(0, 1) * d_detG_dG(0, 1) / det2;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;          d_Gup_dG(0, 1, 1, 1) = Gdown(0, 1) * d_detG_dG(1, 1) / det2;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;          d_Gup_dG(1, 1, 0, 0) =</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            1.0 / det - Gdown(0, 0) * d_detG_dG(0, 0) / det2;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;          d_Gup_dG(1, 1, 0, 1) = -Gdown(0, 0) * d_detG_dG(0, 1) / det2;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;          d_Gup_dG(1, 1, 1, 1) = -Gdown(0, 0) * d_detG_dG(1, 1) / det2;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        }</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        <span class="comment">// Calculate entries of the contravariant tensor (inverse)</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <span class="comment">// Gup(0,0) = Gdown(1,1)/det;</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="comment">// Gup(0,1) = -Gdown(0,1)/det;</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="comment">// Gup(1,0) = -Gdown(1,0)/det;</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        <span class="comment">// Gup(1,1) = Gdown(0,0)/det;</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <span class="comment">// This is not yet implemented</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;          <span class="stringliteral">&quot;Analytic derivatives of metric tensors not yet implemented in 3D\n&quot;</span>,</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <span class="comment">// Calculate the determinant of the matrix</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        det = Gdown(0, 0) * Gdown(1, 1) * Gdown(2, 2) +</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;              Gdown(0, 1) * Gdown(1, 2) * Gdown(2, 0) +</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;              Gdown(0, 2) * Gdown(1, 0) * Gdown(2, 1) -</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;              Gdown(0, 0) * Gdown(1, 2) * Gdown(2, 1) -</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;              Gdown(0, 1) * Gdown(1, 0) * Gdown(2, 2) -</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;              Gdown(0, 2) * Gdown(1, 1) * Gdown(2, 0);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <span class="comment">// Calculate entries of the inverse matrix</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <span class="comment">// Gup(0,0) =  (Gdown(1,1)*Gdown(2,2) - Gdown(1,2)*Gdown(2,1))/det;</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        <span class="comment">// Gup(0,1) = -(Gdown(0,1)*Gdown(2,2) - Gdown(0,2)*Gdown(2,1))/det;</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        <span class="comment">// Gup(0,2) =  (Gdown(0,1)*Gdown(1,2) - Gdown(0,2)*Gdown(1,1))/det;</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="comment">// Gup(1,0) = -(Gdown(1,0)*Gdown(2,2) - Gdown(1,2)*Gdown(2,0))/det;</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <span class="comment">// Gup(1,1) =  (Gdown(0,0)*Gdown(2,2) - Gdown(0,2)*Gdown(2,0))/det;</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="comment">// Gup(1,2) = -(Gdown(0,0)*Gdown(1,2) - Gdown(0,2)*Gdown(1,0))/det;</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <span class="comment">// Gup(2,0) =  (Gdown(1,0)*Gdown(2,1) - Gdown(1,1)*Gdown(2,0))/det;</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        <span class="comment">// Gup(2,1) = -(Gdown(0,0)*Gdown(2,1) - Gdown(0,1)*Gdown(2,0))/det;</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        <span class="comment">// Gup(2,2) =  (Gdown(0,0)*Gdown(1,1) - Gdown(0,1)*Gdown(1,0))/det;</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(<span class="stringliteral">&quot;Dimension of matrix must be 0, 1, 2 or 3\n&quot;</span>,</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    }</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1DenseMatrix_html_a9937181f1cb4cfaed7aaf3b483c42456"><div class="ttname"><a href="../../d6/d13/classoomph_1_1DenseMatrix.html#a9937181f1cb4cfaed7aaf3b483c42456">oomph::DenseMatrix::ncol</a></div><div class="ttdeci">unsigned long ncol() const</div><div class="ttdoc">Return the number of columns of the matrix.</div><div class="ttdef"><b>Definition:</b> matrices.h:491</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a73f01e1459e7ba998ef78f7ece6baa37">is_matrix_square()</a>, <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html#a9937181f1cb4cfaed7aaf3b483c42456">oomph::DenseMatrix&lt; T &gt;::ncol()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, and <a class="el" href="../../d2/dc3/namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">oomph::Global_string_for_annotation::string()</a>.</p>

</div>
</div>
<a id="af13f9d05db09870d1b90b7ef389bdb71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af13f9d05db09870d1b90b7ef389bdb71">&#9670;&nbsp;</a></span>calculate_d_second_piola_kirchhoff_stress_dG() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::ConstitutiveLaw::calculate_d_second_piola_kirchhoff_stress_dG </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>sigma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>detG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>interpolated_solid_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/dbb/classoomph_1_1RankFourTensor.html">RankFourTensor</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>d_sigma_dG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>d_detG_dG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;&#160;</td>
          <td class="paramname"><em>symmetrize_tensor</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Calculate the derivatives of the contravariant 2nd Piola Kirchhoff stress tensor \( \sigma^{ij}\). with respect to the deformed metric tensor. Also return the derivatives of the determinant of the deformed metric tensor with respect to the deformed metric tensor. This form is appropriate for truly-incompressible materials. The default implementation uses finite differences for the derivatives that depend on the constitutive law, but not for the derivatives of the determinant, which are generic. / If the boolean flag symmetrize_tensor is false, only the "upper  triangular" entries of the tensor will be filled in. This is a useful efficiency when using the derivatives in Jacobian calculations.</p>
<p>Calculate the derivatives of the contravariant 2nd Piola Kirchhoff stress tensor \( \sigma^{ij}\). with respect to the deformed metric tensor. Also return the derivatives of the determinant of the deformed metric tensor with respect to the deformed metric tensor. This form is appropriate for truly-incompressible materials. The default implementation uses finite differences for the derivatives that depend on the constitutive law, but not for the derivatives of the determinant, which are generic. </p>
<div class="fragment"><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  {</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="comment">// Initial error checking</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="comment">// Test that the matrices are of the same dimension</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a8a89bb96a9b922294509923563a13063">are_matrices_of_equal_dimensions</a>(g, <a class="code" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>))</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    {</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(<span class="stringliteral">&quot;Matrices passed are not of equal dimension&quot;</span>,</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    }</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160; </div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="comment">// Find the dimension of the matrix (assuming that it&#39;s square)</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> dim = <a class="code" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>.ncol();</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160; </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="comment">// FD step</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> eps_fd = <a class="code" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a1fce78955b6483f1f98e5561706aecb3">GeneralisedElement::Default_fd_jacobian_step</a>;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160; </div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="comment">// Advanced metric tensor etc.</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <a class="code" href="../../dc/d34/classEigen_1_1Matrix.html">DenseMatrix&lt;double&gt;</a> G_pls(dim, dim);</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <a class="code" href="../../dc/d34/classEigen_1_1Matrix.html">DenseMatrix&lt;double&gt;</a> sigma_dev_pls(dim, dim);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <a class="code" href="../../dc/d34/classEigen_1_1Matrix.html">DenseMatrix&lt;double&gt;</a> Gup_pls(dim, dim);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="keywordtype">double</span> detG_pls;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160; </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="comment">// Copy across</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; dim; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    {</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; dim; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;      {</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        G_pls(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) = <a class="code" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;      }</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    }</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160; </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="comment">// Do FD -- only w.r.t. to upper indices, exploiting symmetry.</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="comment">// NOTE: We exploit the symmetry of the stress and metric tensors</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="comment">//       by incrementing G(i,j) and G(j,i) simultaenously and</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="comment">//       only fill in the &quot;upper&quot; triangles without copying things</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="comment">//       across the lower triangle. This is taken into account</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="comment">//       in the remaining code further below.</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; dim; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    {</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; dim; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      {</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        G_pls(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) += eps_fd;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        G_pls(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = G_pls(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160; </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        <span class="comment">// Get advanced stress</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        this-&gt;<a class="code" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a93527d910de908035feb8f41b0401065">calculate_second_piola_kirchhoff_stress</a>(</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;          g, G_pls, sigma_dev_pls, Gup_pls, detG_pls);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160; </div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160; </div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        <span class="comment">// Derivative of determinant of deformed metric tensor</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        d_detG_dG(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) = (detG_pls - detG) / eps_fd;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160; </div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        <span class="comment">// Derivatives of deviatoric stress and &quot;upper&quot; deformed metric</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <span class="comment">// tensor</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ii = 0; ii &lt; dim; ii++)</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        {</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> jj = ii; jj &lt; dim; jj++)</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;          {</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;            d_sigma_dG(ii, jj, <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) =</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;              (sigma_dev_pls(ii, jj) - interpolated_solid_p * Gup_pls(ii, jj) -</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;               <a class="code" href="../../d9/d33/namespacecalibrate.html#a6caaf28555dab8f7d970d42592f6bc44">sigma</a>(ii, jj)) /</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;              eps_fd;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;          }</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        }</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160; </div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        <span class="comment">// Reset</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        G_pls(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) = <a class="code" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        G_pls(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = <a class="code" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;      }</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    }</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160; </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="comment">// If we are symmetrising the tensor, do so</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="keywordflow">if</span> (symmetrize_tensor)</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    {</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; dim; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;      {</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        {</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;          d_detG_dG(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) = d_detG_dG(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160; </div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ii = 0; ii &lt; dim; ii++)</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;          {</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> jj = 0; jj &lt; ii; jj++)</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;            {</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;              d_sigma_dG(ii, jj, <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) = d_sigma_dG(jj, ii, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;            }</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;          }</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        }</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;      }</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    }</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  }</div>
<div class="ttc" id="aBiCGSTAB__step__by__step_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> BiCGSTAB_step_by_step.cpp:9</div></div>
<div class="ttc" id="aclassoomph_1_1GeneralisedElement_html_a1fce78955b6483f1f98e5561706aecb3"><div class="ttname"><a href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a1fce78955b6483f1f98e5561706aecb3">oomph::GeneralisedElement::Default_fd_jacobian_step</a></div><div class="ttdeci">static double Default_fd_jacobian_step</div><div class="ttdef"><b>Definition:</b> elements.h:1198</div></div>
<div class="ttc" id="atut__arithmetic__redux__minmax_8cpp_html_a39513f0f8d942bf9ef17b2e87ac6d34e"><div class="ttname"><a href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a></div><div class="ttdeci">std::ptrdiff_t j</div><div class="ttdef"><b>Definition:</b> tut_arithmetic_redux_minmax.cpp:2</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a8a89bb96a9b922294509923563a13063">are_matrices_of_equal_dimensions()</a>, <a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a93527d910de908035feb8f41b0401065">calculate_second_piola_kirchhoff_stress()</a>, <a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a1fce78955b6483f1f98e5561706aecb3">oomph::GeneralisedElement::Default_fd_jacobian_step</a>, <a class="el" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, and <a class="el" href="../../d9/d33/namespacecalibrate.html#a6caaf28555dab8f7d970d42592f6bc44">calibrate::sigma</a>.</p>

</div>
</div>
<a id="a8a4f1bcac8d308d9ad0013ddf5def505"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a4f1bcac8d308d9ad0013ddf5def505">&#9670;&nbsp;</a></span>calculate_d_second_piola_kirchhoff_stress_dG() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::ConstitutiveLaw::calculate_d_second_piola_kirchhoff_stress_dG </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>sigma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>gen_dil</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>inv_kappa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>interpolated_solid_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/dbb/classoomph_1_1RankFourTensor.html">RankFourTensor</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>d_sigma_dG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>d_gen_dil_dG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;&#160;</td>
          <td class="paramname"><em>symmetrize_tensor</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Calculate the derivatives of the contravariant 2nd Piola Kirchoff stress tensor with respect to the deformed metric tensor. Also return the derivatives of the generalised dilatation, \( d, \) with respect to the deformed metric tensor. This form is appropriate for near-incompressible materials. The default implementation uses finite differences. If the boolean flag symmetrize_tensor is false, only the "upper  triangular" entries of the tensor will be filled in. This is a useful efficiency when using the derivatives in Jacobian calculations.</p>
<p>Calculate the derivatives of the contravariant 2nd Piola Kirchoff stress tensor with respect to the deformed metric tensor. Also return the derivatives of the generalised dilatation, \( d, \) with respect to the deformed metric tensor. This form is appropriate for near-incompressible materials. The default implementation uses finite differences. </p>
<div class="fragment"><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  {</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="comment">// Initial error checking</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="comment">// Test that the matrices are of the same dimension</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a8a89bb96a9b922294509923563a13063">are_matrices_of_equal_dimensions</a>(g, <a class="code" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>))</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    {</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(<span class="stringliteral">&quot;Matrices passed are not of equal dimension&quot;</span>,</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    }</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160; </div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="comment">// Find the dimension of the matrix (assuming that it&#39;s square)</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> dim = <a class="code" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>.ncol();</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160; </div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <span class="comment">// FD step</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> eps_fd = <a class="code" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a1fce78955b6483f1f98e5561706aecb3">GeneralisedElement::Default_fd_jacobian_step</a>;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160; </div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="comment">// Advanced metric tensor etc</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <a class="code" href="../../dc/d34/classEigen_1_1Matrix.html">DenseMatrix&lt;double&gt;</a> G_pls(dim, dim);</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <a class="code" href="../../dc/d34/classEigen_1_1Matrix.html">DenseMatrix&lt;double&gt;</a> sigma_dev_pls(dim, dim);</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <a class="code" href="../../dc/d34/classEigen_1_1Matrix.html">DenseMatrix&lt;double&gt;</a> Gup_pls(dim, dim);</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <span class="keywordtype">double</span> gen_dil_pls;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <span class="keywordtype">double</span> inv_kappa_pls;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160; </div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    <span class="comment">// Copy across</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; dim; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    {</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; dim; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;      {</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        G_pls(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) = <a class="code" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;      }</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    }</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160; </div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="comment">// Do FD -- only w.r.t. to upper indices, exploiting symmetry.</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <span class="comment">// NOTE: We exploit the symmetry of the stress and metric tensors</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    <span class="comment">//       by incrementing G(i,j) and G(j,i) simultaenously and</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="comment">//       only fill in the &quot;upper&quot; triangles without copying things</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    <span class="comment">//       across the lower triangle. This is taken into account</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <span class="comment">//       in the remaining code further below.</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; dim; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    {</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; dim; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;      {</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        G_pls(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) += eps_fd;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        G_pls(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = G_pls(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160; </div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        <span class="comment">// Get advanced stress</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        this-&gt;<a class="code" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a93527d910de908035feb8f41b0401065">calculate_second_piola_kirchhoff_stress</a>(</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;          g, G_pls, sigma_dev_pls, Gup_pls, gen_dil_pls, inv_kappa_pls);</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160; </div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        <span class="comment">// Derivative of generalised dilatation</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        d_gen_dil_dG(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) = (gen_dil_pls - gen_dil) / eps_fd;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160; </div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        <span class="comment">// Derivatives of deviatoric stress and &quot;upper&quot; deformed metric</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        <span class="comment">// tensor</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ii = 0; ii &lt; dim; ii++)</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        {</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> jj = ii; jj &lt; dim; jj++)</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;          {</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;            d_sigma_dG(ii, jj, <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) =</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;              (sigma_dev_pls(ii, jj) - interpolated_solid_p * Gup_pls(ii, jj) -</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;               <a class="code" href="../../d9/d33/namespacecalibrate.html#a6caaf28555dab8f7d970d42592f6bc44">sigma</a>(ii, jj)) /</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;              eps_fd;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;          }</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        }</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160; </div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        <span class="comment">// Reset</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        G_pls(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) = <a class="code" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        G_pls(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = <a class="code" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;      }</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    }</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160; </div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <span class="comment">// If we are symmetrising the tensor, do so</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    <span class="keywordflow">if</span> (symmetrize_tensor)</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    {</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; dim; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;      {</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        {</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;          d_gen_dil_dG(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) = d_gen_dil_dG(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160; </div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ii = 0; ii &lt; dim; ii++)</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;          {</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> jj = 0; jj &lt; ii; jj++)</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;            {</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;              d_sigma_dG(ii, jj, <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) = d_sigma_dG(jj, ii, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;            }</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;          }</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        }</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;      }</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    }</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a8a89bb96a9b922294509923563a13063">are_matrices_of_equal_dimensions()</a>, <a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a93527d910de908035feb8f41b0401065">calculate_second_piola_kirchhoff_stress()</a>, <a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a1fce78955b6483f1f98e5561706aecb3">oomph::GeneralisedElement::Default_fd_jacobian_step</a>, <a class="el" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, and <a class="el" href="../../d9/d33/namespacecalibrate.html#a6caaf28555dab8f7d970d42592f6bc44">calibrate::sigma</a>.</p>

</div>
</div>
<a id="a6076752384082cfa3de3e0cf17daa9aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6076752384082cfa3de3e0cf17daa9aa">&#9670;&nbsp;</a></span>calculate_d_second_piola_kirchhoff_stress_dG() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::ConstitutiveLaw::calculate_d_second_piola_kirchhoff_stress_dG </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>sigma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/dbb/classoomph_1_1RankFourTensor.html">RankFourTensor</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>d_sigma_dG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;&#160;</td>
          <td class="paramname"><em>symmetrize_tensor</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Calculate the derivatives of the contravariant 2nd Piola Kirchhoff stress tensor with respect to the deformed metric tensor. Arguments are the covariant undeformed and deformed metric tensor, the current value of the stress tensor and the rank four tensor in which to return the derivatives of the stress tensor The default implementation uses finite differences, but can be overloaded for constitutive laws in which an analytic formulation is possible. If the boolean flag symmetrize_tensor is false, only the "upper  triangular" entries of the tensor will be filled in. This is a useful efficiency when using the derivatives in Jacobian calculations.</p>
<p>Calculate the derivatives of the contravariant 2nd Piola Kirchhoff stress tensor with respect to the deformed metric tensor. Arguments are the covariant undeformed and deformed metric tensor and the matrix in which to return the derivatives of the stress tensor The default implementation uses finite differences, but can be overloaded for constitutive laws in which an analytic formulation is possible. </p>
<div class="fragment"><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="comment">// Initial error checking</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="comment">// Test that the matrices are of the same dimension</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a8a89bb96a9b922294509923563a13063">are_matrices_of_equal_dimensions</a>(g, <a class="code" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>))</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    {</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(<span class="stringliteral">&quot;Matrices passed are not of equal dimension&quot;</span>,</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    }</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160; </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="comment">// Find the dimension of the matrix (assuming that it&#39;s square)</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> dim = <a class="code" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>.ncol();</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160; </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="comment">// Find the dimension</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="comment">// FD step</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> eps_fd = <a class="code" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a1fce78955b6483f1f98e5561706aecb3">GeneralisedElement::Default_fd_jacobian_step</a>;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="comment">// Advanced metric tensor</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <a class="code" href="../../dc/d34/classEigen_1_1Matrix.html">DenseMatrix&lt;double&gt;</a> G_pls(dim, dim);</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <a class="code" href="../../dc/d34/classEigen_1_1Matrix.html">DenseMatrix&lt;double&gt;</a> sigma_pls(dim, dim);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160; </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="comment">// Copy across the original value</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; dim; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    {</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; dim; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      {</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        G_pls(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) = <a class="code" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      }</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    }</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="comment">// Do FD -- only w.r.t. to upper indices, exploiting symmetry.</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="comment">// NOTE: We exploit the symmetry of the stress and metric tensors</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="comment">//       by incrementing G(i,j) and G(j,i) simultaenously and</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="comment">//       only fill in the &quot;upper&quot; triangles without copying things</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="comment">//       across the lower triangle. This is taken into account</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="comment">//       in the solid mechanics codes.</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; dim; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    {</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; dim; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      {</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        G_pls(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) += eps_fd;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        G_pls(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = G_pls(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160; </div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        <span class="comment">// Get advanced stress</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        this-&gt;<a class="code" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a93527d910de908035feb8f41b0401065">calculate_second_piola_kirchhoff_stress</a>(g, G_pls, sigma_pls);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ii = 0; ii &lt; dim; ii++)</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        {</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> jj = ii; jj &lt; dim; jj++)</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;          {</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;            d_sigma_dG(ii, jj, <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) =</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;              (sigma_pls(ii, jj) - <a class="code" href="../../d9/d33/namespacecalibrate.html#a6caaf28555dab8f7d970d42592f6bc44">sigma</a>(ii, jj)) / eps_fd;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;          }</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        }</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160; </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        <span class="comment">// Reset</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        G_pls(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) = <a class="code" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        G_pls(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = <a class="code" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      }</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    }</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160; </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="comment">// If we are symmetrising the tensor, do so</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="keywordflow">if</span> (symmetrize_tensor)</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    {</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; dim; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      {</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        {</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ii = 0; ii &lt; dim; ii++)</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;          {</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> jj = 0; jj &lt; ii; jj++)</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;            {</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;              d_sigma_dG(ii, jj, <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) = d_sigma_dG(jj, ii, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;            }</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;          }</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        }</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      }</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    }</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a8a89bb96a9b922294509923563a13063">are_matrices_of_equal_dimensions()</a>, <a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a93527d910de908035feb8f41b0401065">calculate_second_piola_kirchhoff_stress()</a>, <a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a1fce78955b6483f1f98e5561706aecb3">oomph::GeneralisedElement::Default_fd_jacobian_step</a>, <a class="el" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, and <a class="el" href="../../d9/d33/namespacecalibrate.html#a6caaf28555dab8f7d970d42592f6bc44">calibrate::sigma</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/ddb/classoomph_1_1PVDEquationsWithPressure.html#a35b1c9e4ebd765bbb185421c2c02aa1a">oomph::PVDEquationsWithPressure&lt; DIM &gt;::get_d_stress_dG_upper()</a>, and <a class="el" href="../../da/ddf/classoomph_1_1PVDEquations.html#a522084ede6bf0e6b6154ec0ac61c3f5f">oomph::PVDEquations&lt; DIM &gt;::get_d_stress_dG_upper()</a>.</p>

</div>
</div>
<a id="a93527d910de908035feb8f41b0401065"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93527d910de908035feb8f41b0401065">&#9670;&nbsp;</a></span>calculate_second_piola_kirchhoff_stress() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void oomph::ConstitutiveLaw::calculate_second_piola_kirchhoff_stress </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>sigma</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Calculate the contravariant 2nd Piola Kirchhoff stress tensor. Arguments are the covariant undeformed and deformed metric tensor and the matrix in which to return the stress tensor </p>

<p>Implemented in <a class="el" href="../../d8/d8c/classoomph_1_1IsotropicStrainEnergyFunctionConstitutiveLaw.html#af6c25617b8be6cc454d6b526ec6121fc">oomph::IsotropicStrainEnergyFunctionConstitutiveLaw</a>, <a class="el" href="../../d3/d66/classoomph_1_1GeneralisedHookean.html#a5beca3e59f04d109c394bf9fd24bb7c1">oomph::GeneralisedHookean</a>, and <a class="el" href="../../d4/d7c/classoomph_1_1AnisotropicHookean.html#ab625b1690562e22063d8afdff7cddd89">oomph::AnisotropicHookean</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a6076752384082cfa3de3e0cf17daa9aa">calculate_d_second_piola_kirchhoff_stress_dG()</a>, <a class="el" href="../../da/dc6/classoomph_1_1AxisymmetricPVDEquations.html#ad7984168072632f9d4f7218d81ca50eb">oomph::AxisymmetricPVDEquations::get_stress()</a>, <a class="el" href="../../da/ddf/classoomph_1_1PVDEquations.html#ae870a58617c8a268a30779e93fb96f54">oomph::PVDEquations&lt; DIM &gt;::get_stress()</a>, <a class="el" href="../../d1/d02/classoomph_1_1AxisymmetricPVDEquationsWithPressure.html#af74b386309449d7022b9599674d58088">oomph::AxisymmetricPVDEquationsWithPressure::get_stress()</a>, and <a class="el" href="../../d6/ddb/classoomph_1_1PVDEquationsWithPressure.html#a4ae331361c8fd63725a55050e90e9e2d">oomph::PVDEquationsWithPressure&lt; DIM &gt;::get_stress()</a>.</p>

</div>
</div>
<a id="ac8178b1b7cd7e6a64942dba9e0997b30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8178b1b7cd7e6a64942dba9e0997b30">&#9670;&nbsp;</a></span>calculate_second_piola_kirchhoff_stress() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void oomph::ConstitutiveLaw::calculate_second_piola_kirchhoff_stress </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>sigma_dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>G_contra</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>Gdet</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Calculate the deviatoric part \( \overline{ \sigma^{ij}}\) of the contravariant 2nd Piola Kirchhoff stress tensor \( \sigma^{ij}\). Also return the contravariant deformed metric tensor and the determinant of the deformed metric tensor. This form is appropriate for truly-incompressible materials for which \( \sigma^{ij} = - p G^{ij} +\overline{ \sigma^{ij}} \) where the "pressure" \( p \) is determined by \( \det G_{ij} - \det g_{ij} = 0 \). </p>

<p>Reimplemented in <a class="el" href="../../d8/d8c/classoomph_1_1IsotropicStrainEnergyFunctionConstitutiveLaw.html#acf61673ecc4f960fee908378ac48544a">oomph::IsotropicStrainEnergyFunctionConstitutiveLaw</a>, and <a class="el" href="../../d3/d66/classoomph_1_1GeneralisedHookean.html#a641d0893e485df52b48b15e189a850ed">oomph::GeneralisedHookean</a>.</p>
<div class="fragment"><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    {</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        <span class="stringliteral">&quot;Incompressible formulation not implemented for this constitutive law&quot;</span>,</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, and <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>.</p>

</div>
</div>
<a id="a26f34355b626bebcad8f498fa5271d20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26f34355b626bebcad8f498fa5271d20">&#9670;&nbsp;</a></span>calculate_second_piola_kirchhoff_stress() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void oomph::ConstitutiveLaw::calculate_second_piola_kirchhoff_stress </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>sigma_dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>Gcontra</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>gen_dil</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>inv_kappa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Calculate the deviatoric part of the contravariant 2nd Piola Kirchoff stress tensor. Also return the contravariant deformed metric tensor, the generalised dilatation, \( d, \) and the inverse of the bulk modulus \( \kappa\). This form is appropriate for near-incompressible materials for which \( \sigma^{ij} = -p G^{ij} + \overline{ \sigma^{ij}} \) where the "pressure" \( p \) is determined from \( p / \kappa - d =0 \). </p>

<p>Reimplemented in <a class="el" href="../../d8/d8c/classoomph_1_1IsotropicStrainEnergyFunctionConstitutiveLaw.html#aa45d82d322fda480f88e78cddd557837">oomph::IsotropicStrainEnergyFunctionConstitutiveLaw</a>, and <a class="el" href="../../d3/d66/classoomph_1_1GeneralisedHookean.html#ad19b5e80755f5d8e5513c4199f62fe03">oomph::GeneralisedHookean</a>.</p>
<div class="fragment"><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    {</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        <span class="stringliteral">&quot;Near-incompressible formulation not implemented for constitutive law&quot;</span>,</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, and <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>.</p>

</div>
</div>
<a id="a01763658a56a962460a80607653a33b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01763658a56a962460a80607653a33b4">&#9670;&nbsp;</a></span>error_checking_in_input()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::ConstitutiveLaw::error_checking_in_input </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>sigma</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Check for errors in the input, i.e. check that the dimensions of the arrays are all consistent</p>
<p>This function is used to provide simple error (bounce) checks on the input to any calculate_second_piola_kirchhoff_stress </p>
<div class="fragment"><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="comment">// Test whether the undeformed metric tensor is square</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a73f01e1459e7ba998ef78f7ece6baa37">is_matrix_square</a>(g))</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(<span class="stringliteral">&quot;Undeformed metric tensor not square&quot;</span>,</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    }</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="comment">// If the deformed metric tensor does not have the same dimension as</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="comment">// the undeformed tensor, complain</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a8a89bb96a9b922294509923563a13063">are_matrices_of_equal_dimensions</a>(g, <a class="code" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>))</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    {</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      <a class="code" href="../../d2/dc3/namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">std::string</a> error_message = <span class="stringliteral">&quot;Deformed metric tensor does  \n&quot;</span>;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      error_message +=</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <span class="stringliteral">&quot;not have same dimensions as the undeformed metric tensor\n&quot;</span>;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        error_message, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="comment">// If the stress tensor does not have the same dimensions as the others</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="comment">// complain.</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a8a89bb96a9b922294509923563a13063">are_matrices_of_equal_dimensions</a>(g, <a class="code" href="../../d9/d33/namespacecalibrate.html#a6caaf28555dab8f7d970d42592f6bc44">sigma</a>))</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      <a class="code" href="../../d2/dc3/namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">std::string</a> error_message =</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <span class="stringliteral">&quot;Strain tensor passed to calculate_green_strain() does  \n&quot;</span>;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      error_message +=</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="stringliteral">&quot;not have same dimensions as the undeformed metric tensor\n&quot;</span>;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        error_message, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    }</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a8a89bb96a9b922294509923563a13063">are_matrices_of_equal_dimensions()</a>, <a class="el" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>, <a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a73f01e1459e7ba998ef78f7ece6baa37">is_matrix_square()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../d9/d33/namespacecalibrate.html#a6caaf28555dab8f7d970d42592f6bc44">calibrate::sigma</a>, and <a class="el" href="../../d2/dc3/namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">oomph::Global_string_for_annotation::string()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/d66/classoomph_1_1GeneralisedHookean.html#a5beca3e59f04d109c394bf9fd24bb7c1">oomph::GeneralisedHookean::calculate_second_piola_kirchhoff_stress()</a>, and <a class="el" href="../../d8/d8c/classoomph_1_1IsotropicStrainEnergyFunctionConstitutiveLaw.html#af6c25617b8be6cc454d6b526ec6121fc">oomph::IsotropicStrainEnergyFunctionConstitutiveLaw::calculate_second_piola_kirchhoff_stress()</a>.</p>

</div>
</div>
<a id="a73f01e1459e7ba998ef78f7ece6baa37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73f01e1459e7ba998ef78f7ece6baa37">&#9670;&nbsp;</a></span>is_matrix_square()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::ConstitutiveLaw::is_matrix_square </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>M</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Test whether a matrix is square. </p>
<p>This function is used to check whether a matrix is square. </p>
<div class="fragment"><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  {</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="comment">// If the number rows and columns is not equal, the matrix is not square</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dc/d34/classEigen_1_1Matrix.html">M</a>.nrow() != <a class="code" href="../../dc/d34/classEigen_1_1Matrix.html">M</a>.ncol())</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    }</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    {</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    }</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a5c188df10b08b340b923c3a733c0d178">calculate_contravariant()</a>, <a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a6dda64e60ed8128cb4603041dc66036f">calculate_d_contravariant_dG()</a>, and <a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a01763658a56a962460a80607653a33b4">error_checking_in_input()</a>.</p>

</div>
</div>
<a id="a446452158a8ae9fbc3dde4277155f824"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a446452158a8ae9fbc3dde4277155f824">&#9670;&nbsp;</a></span>requires_incompressibility_constraint()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::ConstitutiveLaw::requires_incompressibility_constraint </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Pure virtual function in which the user must declare if the constitutive equation requires an incompressible formulation in which the volume constraint is enforced explicitly. Used as a sanity check in PARANOID mode. </p>

<p>Implemented in <a class="el" href="../../d8/d8c/classoomph_1_1IsotropicStrainEnergyFunctionConstitutiveLaw.html#a6b9a454988b023a42782f78e4e3eebc4">oomph::IsotropicStrainEnergyFunctionConstitutiveLaw</a>, and <a class="el" href="../../d3/d66/classoomph_1_1GeneralisedHookean.html#a9ed467d8b7c838cb7fed8c861aa652e9">oomph::GeneralisedHookean</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../df/d27/classoomph_1_1RefineableQDPVDElement.html#aefa8a6890e1723ee287aaa79a877c42a">oomph::RefineableQDPVDElement&lt; DIM, NNODE_1D &gt;::fill_in_generic_contribution_to_residuals_pvd()</a>, <a class="el" href="../../dd/d4b/classoomph_1_1RefineablePVDEquations.html#ace1bda5ddd0cecac296f8b5c3a053a21">oomph::RefineablePVDEquations&lt; DIM &gt;::fill_in_generic_contribution_to_residuals_pvd()</a>, <a class="el" href="../../da/ddf/classoomph_1_1PVDEquations.html#a2e169e572d3715f08e571cb29779a754">oomph::PVDEquations&lt; DIM &gt;::fill_in_generic_contribution_to_residuals_pvd()</a>, <a class="el" href="../../de/d81/classoomph_1_1RefineablePVDEquationsWithPressure.html#a5772ce11dd9bc9e7bdf0a2463fc753d5">oomph::RefineablePVDEquationsWithPressure&lt; DIM &gt;::fill_in_generic_residual_contribution_pvd_with_pressure()</a>, and <a class="el" href="../../d6/ddb/classoomph_1_1PVDEquationsWithPressure.html#a59c8c6164edf79148deb8dbeab79376d">oomph::PVDEquationsWithPressure&lt; DIM &gt;::fill_in_generic_residual_contribution_pvd_with_pressure()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="../../d4/d26/constitutive__laws_8h_source.html">constitutive_laws.h</a></li>
<li><a class="el" href="../../d4/d8c/constitutive__laws_8cc.html">constitutive_laws.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../da/ddf/namespaceoomph.html">oomph</a></li><li class="navelem"><a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html">ConstitutiveLaw</a></li>
    <li class="footer">Generated on Wed Aug 27 2025 17:08:54 for MercuryDPM by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
