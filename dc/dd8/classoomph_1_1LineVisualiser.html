<!-- HTML header for doxygen 1.8.18-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MercuryDPM: oomph::LineVisualiser Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../MDPM.css" rel="stylesheet" type="text/css"/>
<link href="../../codeLabels.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-fork-corner.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-dropdown-version.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../MDPM-fragment-copy-button.js"></script>
<script type="text/javascript">
DoxygenAwesomeFragmentCopyButton.init()
</script>
<script type="text/javascript" src="../../MDPM-paragraph-link.js"></script>
<script type="text/javascript">
DoxygenAwesomeParagraphLink.init()
</script>
<script type="text/javascript" src="../../MDPM-interactive-toc.js"></script>
<script type="text/javascript">
DoxygenAwesomeInteractiveToc.init()
</script>
<script type="text/javascript" src="../../MDPM-darkmode-toggle.js"></script>
<script type="text/javascript">
DoxygenAwesomeDarkModeToggle.init()
</script>
</head>
<body>
  <div id="bitbucket-corner">
   <a href="https://bitbucket.org/mercurydpm/mercurydpm/src/master/" target="_blank" id="fork-corner" class="fork-corner fc-pos-tr fc-animate fc-theme-bitbucket"></a>
  </div>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../mercury-logo-chosen-light-slogan.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"> <!--MercuryDPM--!>
   <!-- BEGIN version select -->
   <div class="dropdown" id="projectnumber">
    <button class="dropbtn">v1.0</button>
    <div class="dropdown-content">
    </div>
   </div>
   <script type="text/javascript" src="../../MDPM-dropdown-version.js"></script>
<!-- END version select -->
   <!--&#160;<span id="projectnumber">revision: v1.0</span>-->
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<script type="text/javascript" src="../../MDPM-fork-corner.js"></script>
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('dc/dd8/classoomph_1_1LineVisualiser.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="../../da/de3/classoomph_1_1LineVisualiser-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">oomph::LineVisualiser Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="../../d5/da0/line__visualiser_8h_source.html">line_visualiser.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:acc4998289fb2e682ad7eb307702b6be3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#acc4998289fb2e682ad7eb307702b6be3">LineVisualiser</a> (<a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *mesh_pt, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt;&gt; &amp;coord_vec, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;max_search_radius=DBL_MAX)</td></tr>
<tr class="separator:acc4998289fb2e682ad7eb307702b6be3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3eb2567997926ed29a6c8731d1e677c0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a3eb2567997926ed29a6c8731d1e677c0">LineVisualiser</a> (<a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *mesh_pt, const std::string file_name, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;scale=1.0)</td></tr>
<tr class="separator:a3eb2567997926ed29a6c8731d1e677c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab299c77effef14974955204e43457812"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#ab299c77effef14974955204e43457812">LineVisualiser</a> (<a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *mesh_pt, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;max_search_radius, const std::string file_name, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;scale=1.0)</td></tr>
<tr class="separator:ab299c77effef14974955204e43457812"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adafda17eaa1c034ff7236e1f7dcbc771"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#adafda17eaa1c034ff7236e1f7dcbc771">output</a> (std::ostream &amp;outfile)</td></tr>
<tr class="separator:adafda17eaa1c034ff7236e1f7dcbc771"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae14488400c1428663d0c42951cad439"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#aae14488400c1428663d0c42951cad439">get_output_data</a> (<a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt;&gt; &amp;<a class="el" href="../../d5/d3b/Map__placement__new_8cpp.html#abe49a82806b5db2e012bc33839af03e6">data</a>)</td></tr>
<tr class="separator:aae14488400c1428663d0c42951cad439"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6538fb5c75bff293dc9482d4c2c102cd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a6538fb5c75bff293dc9482d4c2c102cd">update_plot_points_coordinates</a> (<a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt;&gt; &amp;coord_vec)</td></tr>
<tr class="separator:a6538fb5c75bff293dc9482d4c2c102cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:adfa22f79f20d300d045f2ef730f466ce"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#adfa22f79f20d300d045f2ef730f466ce">setup_from_file</a> (<a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *mesh_pt, const std::string file_name, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;scale)</td></tr>
<tr class="memdesc:adfa22f79f20d300d045f2ef730f466ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper function to setup from file.  <a href="../../dc/dd8/classoomph_1_1LineVisualiser.html#adfa22f79f20d300d045f2ef730f466ce">More...</a><br /></td></tr>
<tr class="separator:adfa22f79f20d300d045f2ef730f466ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9522013a2e84c25c0aa90496cab12a19"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a9522013a2e84c25c0aa90496cab12a19">setup</a> (<a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *mesh_pt, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt;&gt; &amp;coord_vec)</td></tr>
<tr class="memdesc:a9522013a2e84c25c0aa90496cab12a19"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper function to setup the output structures.  <a href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a9522013a2e84c25c0aa90496cab12a19">More...</a><br /></td></tr>
<tr class="separator:a9522013a2e84c25c0aa90496cab12a19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfe0c8f984f63707959ff4dc2713ee3a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#acfe0c8f984f63707959ff4dc2713ee3a">get_local_plot_points_coordinates</a> (<a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt;&gt; &amp;<a class="el" href="../../d5/d3b/Map__placement__new_8cpp.html#abe49a82806b5db2e012bc33839af03e6">data</a>)</td></tr>
<tr class="separator:acfe0c8f984f63707959ff4dc2713ee3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:abfcd8512571fba22e22b1952823c8744"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#abfcd8512571fba22e22b1952823c8744">Max_search_radius</a></td></tr>
<tr class="separator:abfcd8512571fba22e22b1952823c8744"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c950d1578a20b271a1a51f58e469128"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html">OomphCommunicator</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a0c950d1578a20b271a1a51f58e469128">Comm_pt</a></td></tr>
<tr class="separator:a0c950d1578a20b271a1a51f58e469128"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b43813947f4a58381ce6e940a17b21f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; std::pair&lt; <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html">FiniteElement</a> *, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a3b43813947f4a58381ce6e940a17b21f">Plot_point</a></td></tr>
<tr class="separator:a3b43813947f4a58381ce6e940a17b21f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6786384d0c0c0de6df02b2b9a34a298a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a6786384d0c0c0de6df02b2b9a34a298a">Nplot_points</a></td></tr>
<tr class="memdesc:a6786384d0c0c0de6df02b2b9a34a298a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of plot points.  <a href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a6786384d0c0c0de6df02b2b9a34a298a">More...</a><br /></td></tr>
<tr class="separator:a6786384d0c0c0de6df02b2b9a34a298a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Class to aid visualisation of the values on a set of points. NOTE: in a distributed problem, output is only done on processor 0. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="acc4998289fb2e682ad7eb307702b6be3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc4998289fb2e682ad7eb307702b6be3">&#9670;&nbsp;</a></span>LineVisualiser() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">oomph::LineVisualiser::LineVisualiser </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *&#160;</td>
          <td class="paramname"><em>mesh_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>coord_vec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>max_search_radius</em> = <code>DBL_MAX</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Constructor: Pass pointer to mesh and coordinates of desired plot points: coord_vec[j][i] is the i-th coordinate of the j-th plot point. Optional final parameter specifies the maximum search radius in bin when locating the plot points. Defaults to DBL_MAX and will therefore keep searching through the entire bin structure if a point cannot be found. It's worth limiting this to the order of the size of a typical element in the mesh in parallel computations with fine meshes, otherwise the setup can take forever. </p>
<div class="fragment"><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      : <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#abfcd8512571fba22e22b1952823c8744">Max_search_radius</a>(max_search_radius),</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a0c950d1578a20b271a1a51f58e469128">Comm_pt</a>(mesh_pt-&gt;communicator_pt())</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      <span class="comment">// Do the actual work</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a9522013a2e84c25c0aa90496cab12a19">setup</a>(mesh_pt, coord_vec);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1LineVisualiser_html_a0c950d1578a20b271a1a51f58e469128"><div class="ttname"><a href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a0c950d1578a20b271a1a51f58e469128">oomph::LineVisualiser::Comm_pt</a></div><div class="ttdeci">OomphCommunicator * Comm_pt</div><div class="ttdef"><b>Definition:</b> line_visualiser.h:600</div></div>
<div class="ttc" id="aclassoomph_1_1LineVisualiser_html_a9522013a2e84c25c0aa90496cab12a19"><div class="ttname"><a href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a9522013a2e84c25c0aa90496cab12a19">oomph::LineVisualiser::setup</a></div><div class="ttdeci">void setup(Mesh *mesh_pt, const Vector&lt; Vector&lt; double &gt;&gt; &amp;coord_vec)</div><div class="ttdoc">Helper function to setup the output structures.</div><div class="ttdef"><b>Definition:</b> line_visualiser.h:668</div></div>
<div class="ttc" id="aclassoomph_1_1LineVisualiser_html_abfcd8512571fba22e22b1952823c8744"><div class="ttname"><a href="../../dc/dd8/classoomph_1_1LineVisualiser.html#abfcd8512571fba22e22b1952823c8744">oomph::LineVisualiser::Max_search_radius</a></div><div class="ttdeci">double Max_search_radius</div><div class="ttdef"><b>Definition:</b> line_visualiser.h:596</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a9522013a2e84c25c0aa90496cab12a19">setup()</a>.</p>

</div>
</div>
<a id="a3eb2567997926ed29a6c8731d1e677c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3eb2567997926ed29a6c8731d1e677c0">&#9670;&nbsp;</a></span>LineVisualiser() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">oomph::LineVisualiser::LineVisualiser </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *&#160;</td>
          <td class="paramname"><em>mesh_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>file_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>scale</em> = <code>1.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Constructor reading centerline file</p><ul>
<li>Open "file_name" and extract 3 first doubles of each line</li>
<li>Skip lines which does not begin with a number. Scaling factor allows points defined in input file to be scaled. </li>
</ul>
<div class="fragment"><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      : <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#abfcd8512571fba22e22b1952823c8744">Max_search_radius</a>(DBL_MAX), <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a0c950d1578a20b271a1a51f58e469128">Comm_pt</a>(mesh_pt-&gt;communicator_pt())</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#adfa22f79f20d300d045f2ef730f466ce">setup_from_file</a>(mesh_pt, <a class="code" href="../../df/d76/namespaceParticles2023AnalysisHung.html#a90f1a91ea4768f0873b9510c0b5a2e26">file_name</a>, scale);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1LineVisualiser_html_adfa22f79f20d300d045f2ef730f466ce"><div class="ttname"><a href="../../dc/dd8/classoomph_1_1LineVisualiser.html#adfa22f79f20d300d045f2ef730f466ce">oomph::LineVisualiser::setup_from_file</a></div><div class="ttdeci">void setup_from_file(Mesh *mesh_pt, const std::string file_name, const double &amp;scale)</div><div class="ttdoc">Helper function to setup from file.</div><div class="ttdef"><b>Definition:</b> line_visualiser.h:603</div></div>
<div class="ttc" id="anamespaceParticles2023AnalysisHung_html_a90f1a91ea4768f0873b9510c0b5a2e26"><div class="ttname"><a href="../../df/d76/namespaceParticles2023AnalysisHung.html#a90f1a91ea4768f0873b9510c0b5a2e26">Particles2023AnalysisHung.file_name</a></div><div class="ttdeci">string file_name</div><div class="ttdef"><b>Definition:</b> Particles2023AnalysisHung.py:321</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../df/d76/namespaceParticles2023AnalysisHung.html#a90f1a91ea4768f0873b9510c0b5a2e26">Particles2023AnalysisHung::file_name</a>, and <a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#adfa22f79f20d300d045f2ef730f466ce">setup_from_file()</a>.</p>

</div>
</div>
<a id="ab299c77effef14974955204e43457812"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab299c77effef14974955204e43457812">&#9670;&nbsp;</a></span>LineVisualiser() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">oomph::LineVisualiser::LineVisualiser </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *&#160;</td>
          <td class="paramname"><em>mesh_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>max_search_radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>file_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>scale</em> = <code>1.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Constructor reading centerline file</p><ul>
<li>Open "file_name" and extract 3 first doubles of each line</li>
<li>Skip lines which does not begin with a number. Scaling factor allows points defined in input file to be scaled. Second parameter specifies the maximum search radius in bin when locating the plot points. It's worth setting this to the order of the size of a typical element in the mesh in parallel computations with fine meshes, otherwise the setup can take forever. </li>
</ul>
<div class="fragment"><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      : <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#abfcd8512571fba22e22b1952823c8744">Max_search_radius</a>(max_search_radius),</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a0c950d1578a20b271a1a51f58e469128">Comm_pt</a>(mesh_pt-&gt;communicator_pt())</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#adfa22f79f20d300d045f2ef730f466ce">setup_from_file</a>(mesh_pt, <a class="code" href="../../df/d76/namespaceParticles2023AnalysisHung.html#a90f1a91ea4768f0873b9510c0b5a2e26">file_name</a>, scale);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../df/d76/namespaceParticles2023AnalysisHung.html#a90f1a91ea4768f0873b9510c0b5a2e26">Particles2023AnalysisHung::file_name</a>, and <a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#adfa22f79f20d300d045f2ef730f466ce">setup_from_file()</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="acfe0c8f984f63707959ff4dc2713ee3a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acfe0c8f984f63707959ff4dc2713ee3a">&#9670;&nbsp;</a></span>get_local_plot_points_coordinates()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::LineVisualiser::get_local_plot_points_coordinates </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    {</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;      <a class="code" href="../../d5/d3b/Map__placement__new_8cpp.html#abe49a82806b5db2e012bc33839af03e6">data</a>.resize(<a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a6786384d0c0c0de6df02b2b9a34a298a">Nplot_points</a>);</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a6786384d0c0c0de6df02b2b9a34a298a">Nplot_points</a>; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;      {</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a3b43813947f4a58381ce6e940a17b21f">Plot_point</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].first != NULL)</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;        {</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;          <span class="keywordtype">unsigned</span> dim = <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a3b43813947f4a58381ce6e940a17b21f">Plot_point</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].second.size();</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160; </div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;          <a class="code" href="../../d5/d3b/Map__placement__new_8cpp.html#abe49a82806b5db2e012bc33839af03e6">data</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].resize(dim);</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160; </div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; dim; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;          {</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;            <a class="code" href="../../d5/d3b/Map__placement__new_8cpp.html#abe49a82806b5db2e012bc33839af03e6">data</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>] =</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;              <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a3b43813947f4a58381ce6e940a17b21f">Plot_point</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].first-&gt;interpolated_x(<a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a3b43813947f4a58381ce6e940a17b21f">Plot_point</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].second, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;          }</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        }</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;      }</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    }</div>
<div class="ttc" id="aBiCGSTAB__step__by__step_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> BiCGSTAB_step_by_step.cpp:9</div></div>
<div class="ttc" id="aMap__placement__new_8cpp_html_abe49a82806b5db2e012bc33839af03e6"><div class="ttname"><a href="../../d5/d3b/Map__placement__new_8cpp.html#abe49a82806b5db2e012bc33839af03e6">data</a></div><div class="ttdeci">int data[]</div><div class="ttdef"><b>Definition:</b> Map_placement_new.cpp:1</div></div>
<div class="ttc" id="aclassoomph_1_1LineVisualiser_html_a3b43813947f4a58381ce6e940a17b21f"><div class="ttname"><a href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a3b43813947f4a58381ce6e940a17b21f">oomph::LineVisualiser::Plot_point</a></div><div class="ttdeci">Vector&lt; std::pair&lt; FiniteElement *, Vector&lt; double &gt; &gt; &gt; Plot_point</div><div class="ttdef"><b>Definition:</b> line_visualiser.h:824</div></div>
<div class="ttc" id="aclassoomph_1_1LineVisualiser_html_a6786384d0c0c0de6df02b2b9a34a298a"><div class="ttname"><a href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a6786384d0c0c0de6df02b2b9a34a298a">oomph::LineVisualiser::Nplot_points</a></div><div class="ttdeci">unsigned Nplot_points</div><div class="ttdoc">Number of plot points.</div><div class="ttdef"><b>Definition:</b> line_visualiser.h:827</div></div>
<div class="ttc" id="atut__arithmetic__redux__minmax_8cpp_html_a39513f0f8d942bf9ef17b2e87ac6d34e"><div class="ttname"><a href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a></div><div class="ttdeci">std::ptrdiff_t j</div><div class="ttdef"><b>Definition:</b> tut_arithmetic_redux_minmax.cpp:2</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d5/d3b/Map__placement__new_8cpp.html#abe49a82806b5db2e012bc33839af03e6">data</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a6786384d0c0c0de6df02b2b9a34a298a">Nplot_points</a>, and <a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a3b43813947f4a58381ce6e940a17b21f">Plot_point</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a6538fb5c75bff293dc9482d4c2c102cd">update_plot_points_coordinates()</a>.</p>

</div>
</div>
<a id="aae14488400c1428663d0c42951cad439"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae14488400c1428663d0c42951cad439">&#9670;&nbsp;</a></span>get_output_data()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::LineVisualiser::get_output_data </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Output data function: store data associated with each plot point in data array </p>
<div class="fragment"><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      <span class="comment">// Resize output data array</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      <a class="code" href="../../d5/d3b/Map__placement__new_8cpp.html#abe49a82806b5db2e012bc33839af03e6">data</a>.resize(<a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a6786384d0c0c0de6df02b2b9a34a298a">Nplot_points</a>);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      <span class="comment">// Check if mesh is distributed and a communication pointer</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      <span class="comment">// exists.</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a0c950d1578a20b271a1a51f58e469128">Comm_pt</a> != 0)</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="keywordtype">int</span> nproc = <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a0c950d1578a20b271a1a51f58e469128">Comm_pt</a>-&gt;<a class="code" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a6c78c72666f4b102c2bccf200f0853b7">nproc</a>();</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <span class="keywordflow">if</span> (nproc &gt; 1)</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;          <span class="comment">// Declaration of MPI variables</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;          MPI_Status stat;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;          <span class="keywordtype">int</span> tag = 0;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;          <span class="keywordtype">int</span> my_rank = <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a0c950d1578a20b271a1a51f58e469128">Comm_pt</a>-&gt;<a class="code" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a670b34aab05bfe0b96d0e0fabf583c7a">my_rank</a>();</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;          <span class="comment">// Buffer</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;          <span class="keywordtype">unsigned</span> buff_size;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;          <span class="comment">// Create array which contains data found in every process</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;          Vector&lt;Vector&lt;double&gt;&gt; vec(<a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a6786384d0c0c0de6df02b2b9a34a298a">Nplot_points</a>);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;          <span class="comment">// Loop over the points to fill in vec</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a6786384d0c0c0de6df02b2b9a34a298a">Nplot_points</a>; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;          {</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            <span class="comment">// Check if the point was found in the mesh</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a3b43813947f4a58381ce6e940a17b21f">Plot_point</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].first != NULL) <span class="comment">// success</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;              <span class="comment">// Check if the point is halo</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;              <span class="keywordflow">if</span> (!((*<a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a3b43813947f4a58381ce6e940a17b21f">Plot_point</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].first).is_halo()))</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;              {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                <span class="comment">// Get the line of output data from the element</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                <span class="comment">// (specified by .first), at its local coordinate</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                <span class="comment">// (specified by .second)</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a3b43813947f4a58381ce6e940a17b21f">Plot_point</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].first-&gt;point_output_data(<a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a3b43813947f4a58381ce6e940a17b21f">Plot_point</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].second,</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                                                       vec[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;              }</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            }</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;          }</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;          <span class="comment">// Analyse which plot points have been found</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;          <span class="comment">// locally and concatenate the data:</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;          <span class="comment">// This contains the flat-packed doubles to be sent</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;          <span class="comment">// for all located plot points</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;          Vector&lt;double&gt; local_values;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;          <span class="comment">// Number of values to be sent for each plot point</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;          <span class="comment">// (almost certainly the same for all plot points, but...)</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;          <span class="comment">// size_values[i] gives the number of doubles to be</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;          <span class="comment">// sent for plot point i.</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;          Vector&lt;unsigned&gt; size_values;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;          <span class="comment">// Each processor indicates if it has found a given plot point.</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;          <span class="comment">// Once this is gathered on the root processor we know</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;          <span class="comment">// exactly which data we&#39;ll receive from where.</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;          Vector&lt;unsigned&gt; tmp_proc_point_found_plus_one(<a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a6786384d0c0c0de6df02b2b9a34a298a">Nplot_points</a>, 0);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;          <span class="comment">// Loop over the plot points</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a6786384d0c0c0de6df02b2b9a34a298a">Nplot_points</a>; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;          {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            <span class="keywordtype">unsigned</span> ndata = vec[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].size();</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            <span class="keywordflow">if</span> (ndata != 0)</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            {</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;              <span class="comment">// Store the number of fields</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;              size_values.push_back(ndata);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;              <span class="comment">// Update found vector</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;              tmp_proc_point_found_plus_one[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = my_rank + 1;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160; </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;              <span class="comment">// Store values</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; ndata; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;              {</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                local_values.push_back(vec[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>]);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;              }</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            }</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;          }</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;          <span class="comment">// Gather information on root</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;          <span class="comment">// Find out who&#39;s found the points</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;          Vector&lt;unsigned&gt; proc_point_found_plus_one(<a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a6786384d0c0c0de6df02b2b9a34a298a">Nplot_points</a>, 0);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;          MPI_Reduce(&amp;tmp_proc_point_found_plus_one[0],</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                     &amp;proc_point_found_plus_one[0],</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                     <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a6786384d0c0c0de6df02b2b9a34a298a">Nplot_points</a>,</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                     MPI_UNSIGNED,</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                     MPI_MAX,</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                     0,</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                     <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a0c950d1578a20b271a1a51f58e469128">Comm_pt</a>-&gt;mpi_comm());</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;          <span class="comment">// Main process write data</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;          <span class="keywordflow">if</span> (my_rank == 0)</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;          {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            <span class="comment">// Collect all the data</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            Vector&lt;Vector&lt;double&gt;&gt; received_data(nproc - 1);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            Vector&lt;Vector&lt;unsigned&gt;&gt; received_size(nproc - 1);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            Vector&lt;unsigned&gt; counter_d(nproc - 1, 0);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            Vector&lt;unsigned&gt; counter_s(nproc - 1, 0);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            <span class="comment">// Loop over processors that send their points</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 1; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; nproc; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            {</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;              <span class="comment">// Receive sizes of data</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;              MPI_Recv(&amp;buff_size,</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                       1,</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                       MPI_UNSIGNED,</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                       <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                       tag,</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                       <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a0c950d1578a20b271a1a51f58e469128">Comm_pt</a>-&gt;mpi_comm(),</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                       &amp;stat);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;              received_size[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - 1].resize(<a class="code" href="../../dc/d51/datatypes_8h.html#affe776513b24d84b39af8ab0930fef7f">std::max</a>(<span class="keywordtype">unsigned</span>(1), buff_size));</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;              MPI_Recv(&amp;received_size[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - 1][0],</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                       buff_size,</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                       MPI_UNSIGNED,</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                       <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                       tag,</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                       <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a0c950d1578a20b271a1a51f58e469128">Comm_pt</a>-&gt;mpi_comm(),</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                       &amp;stat);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;              <span class="comment">// Receive actual data</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;              MPI_Recv(&amp;buff_size,</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                       1,</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                       MPI_UNSIGNED,</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                       <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                       tag,</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                       <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a0c950d1578a20b271a1a51f58e469128">Comm_pt</a>-&gt;mpi_comm(),</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                       &amp;stat);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;              received_data[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - 1].resize(<a class="code" href="../../dc/d51/datatypes_8h.html#affe776513b24d84b39af8ab0930fef7f">std::max</a>(<span class="keywordtype">unsigned</span>(1), buff_size));</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;              MPI_Recv(&amp;received_data[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - 1][0],</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                       buff_size,</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                       MPI_DOUBLE,</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                       <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                       tag,</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                       <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a0c950d1578a20b271a1a51f58e469128">Comm_pt</a>-&gt;mpi_comm(),</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                       &amp;stat);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            }</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            <span class="comment">// Analyse data for each point</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a6786384d0c0c0de6df02b2b9a34a298a">Nplot_points</a>; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            {</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;              <span class="comment">// Somebody has found it</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;              <span class="keywordflow">if</span> (proc_point_found_plus_one[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] != 0)</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;              {</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                <span class="comment">// Root processor has found it</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                <span class="keywordflow">if</span> (proc_point_found_plus_one[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] == 1)</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                {</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                  <span class="comment">// Copy directly from vec vector</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                  <a class="code" href="../../d5/d3b/Map__placement__new_8cpp.html#abe49a82806b5db2e012bc33839af03e6">data</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = vec[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                }</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                <span class="comment">// Another (non-root) processor has found it</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                {</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                  <span class="keywordtype">unsigned</span> line_i = proc_point_found_plus_one[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] - 2;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                  <span class="comment">// Resize data line</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                  <a class="code" href="../../d5/d3b/Map__placement__new_8cpp.html#abe49a82806b5db2e012bc33839af03e6">data</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].resize(received_size[line_i][counter_s[line_i]]);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                  <span class="comment">// Copy values</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                       <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; received_size[line_i][counter_s[line_i]];</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                       <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                  {</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                    <a class="code" href="../../d5/d3b/Map__placement__new_8cpp.html#abe49a82806b5db2e012bc33839af03e6">data</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>] = received_data[line_i][counter_d[line_i] + <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>];</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                  }</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160; </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                  <span class="comment">// Increase counter</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                  counter_d[line_i] += received_size[line_i][counter_s[line_i]];</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                  counter_s[line_i]++;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                }</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;              } <span class="comment">// end somebody has found it -- no output at all if nobody</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;              <span class="comment">// has found the point (e.g. outside mesh)</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            }</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;          }</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;          <span class="comment">// Send data to root</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;          {</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;            <span class="comment">// Send the number of fields to the main process</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            buff_size = size_values.size();</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            MPI_Send(&amp;buff_size, 1, MPI_UNSIGNED, 0, tag, <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a0c950d1578a20b271a1a51f58e469128">Comm_pt</a>-&gt;mpi_comm());</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            <span class="comment">// Send the sizes of fields to the main process</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            <span class="keywordflow">if</span> (buff_size == 0) size_values.resize(1);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            MPI_Send(&amp;size_values[0],</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                     buff_size,</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                     MPI_UNSIGNED,</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                     0,</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                     tag,</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                     <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a0c950d1578a20b271a1a51f58e469128">Comm_pt</a>-&gt;mpi_comm());</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160; </div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            <span class="comment">// Send the number of data fields to the main process</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            buff_size = local_values.size();</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            MPI_Send(&amp;buff_size, 1, MPI_UNSIGNED, 0, tag, <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a0c950d1578a20b271a1a51f58e469128">Comm_pt</a>-&gt;mpi_comm());</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            <span class="comment">// Send the data to the main process</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            <span class="keywordflow">if</span> (buff_size == 0) local_values.resize(1);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            MPI_Send(&amp;local_values[0],</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                     buff_size,</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                     MPI_DOUBLE,</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                     0,</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                     tag,</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                     <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a0c950d1578a20b271a1a51f58e469128">Comm_pt</a>-&gt;mpi_comm());</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;          }</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160; </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// Serial version</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        }</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      }</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      {</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <span class="comment">// Loop over the points</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a6786384d0c0c0de6df02b2b9a34a298a">Nplot_points</a>; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        {</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;          <span class="comment">// Check if the point was found in the mesh</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a3b43813947f4a58381ce6e940a17b21f">Plot_point</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].first != NULL) <span class="comment">// success</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;          {</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            <span class="comment">// Copy line into data array</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a3b43813947f4a58381ce6e940a17b21f">Plot_point</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].first-&gt;point_output_data(<a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a3b43813947f4a58381ce6e940a17b21f">Plot_point</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].second,</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                                                   <a class="code" href="../../d5/d3b/Map__placement__new_8cpp.html#abe49a82806b5db2e012bc33839af03e6">data</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;          }</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;          <span class="keywordflow">else</span> <span class="comment">// not found -- keep empty block there for debugging</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;          {</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            <span class="comment">// oomph_info &lt;&lt; &quot;Point &quot; &lt;&lt; i &lt;&lt; &quot; not found\n&quot;;</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;          }</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        }</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      }</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1OomphCommunicator_html_a670b34aab05bfe0b96d0e0fabf583c7a"><div class="ttname"><a href="../../de/d83/classoomph_1_1OomphCommunicator.html#a670b34aab05bfe0b96d0e0fabf583c7a">oomph::OomphCommunicator::my_rank</a></div><div class="ttdeci">int my_rank() const</div><div class="ttdoc">my rank</div><div class="ttdef"><b>Definition:</b> communicator.h:176</div></div>
<div class="ttc" id="aclassoomph_1_1OomphCommunicator_html_a6c78c72666f4b102c2bccf200f0853b7"><div class="ttname"><a href="../../de/d83/classoomph_1_1OomphCommunicator.html#a6c78c72666f4b102c2bccf200f0853b7">oomph::OomphCommunicator::nproc</a></div><div class="ttdeci">int nproc() const</div><div class="ttdoc">number of processors</div><div class="ttdef"><b>Definition:</b> communicator.h:157</div></div>
<div class="ttc" id="adatatypes_8h_html_affe776513b24d84b39af8ab0930fef7f"><div class="ttname"><a href="../../dc/d51/datatypes_8h.html#affe776513b24d84b39af8ab0930fef7f">max</a></div><div class="ttdeci">#define max(a, b)</div><div class="ttdef"><b>Definition:</b> datatypes.h:23</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a0c950d1578a20b271a1a51f58e469128">Comm_pt</a>, <a class="el" href="../../d5/d3b/Map__placement__new_8cpp.html#abe49a82806b5db2e012bc33839af03e6">data</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../dc/d51/datatypes_8h.html#affe776513b24d84b39af8ab0930fef7f">max</a>, <a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a670b34aab05bfe0b96d0e0fabf583c7a">oomph::OomphCommunicator::my_rank()</a>, <a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a6786384d0c0c0de6df02b2b9a34a298a">Nplot_points</a>, <a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a6c78c72666f4b102c2bccf200f0853b7">oomph::OomphCommunicator::nproc()</a>, and <a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a3b43813947f4a58381ce6e940a17b21f">Plot_point</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#adafda17eaa1c034ff7236e1f7dcbc771">output()</a>.</p>

</div>
</div>
<a id="adafda17eaa1c034ff7236e1f7dcbc771"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adafda17eaa1c034ff7236e1f7dcbc771">&#9670;&nbsp;</a></span>output()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::LineVisualiser::output </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>outfile</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Output function: output each plot point. NOTE: in a distributed problem, output is only done on processor 0. </p>
<div class="fragment"><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      <span class="comment">// Get data in array</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      Vector&lt;Vector&lt;double&gt;&gt; <a class="code" href="../../d5/d3b/Map__placement__new_8cpp.html#abe49a82806b5db2e012bc33839af03e6">data</a>(<a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a6786384d0c0c0de6df02b2b9a34a298a">Nplot_points</a>);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#aae14488400c1428663d0c42951cad439">get_output_data</a>(<a class="code" href="../../d5/d3b/Map__placement__new_8cpp.html#abe49a82806b5db2e012bc33839af03e6">data</a>);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      <span class="comment">// Loop over the points</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a6786384d0c0c0de6df02b2b9a34a298a">Nplot_points</a>; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <span class="comment">// Get the size of the line</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = <a class="code" href="../../d5/d3b/Map__placement__new_8cpp.html#abe49a82806b5db2e012bc33839af03e6">data</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].size();</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="comment">// Loop over the values on the line</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;          outfile &lt;&lt; <a class="code" href="../../d5/d3b/Map__placement__new_8cpp.html#abe49a82806b5db2e012bc33839af03e6">data</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        }</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &gt; 0)</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;          outfile &lt;&lt; std::endl;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      }</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    }</div>
<div class="ttc" id="aCG3DPackingUnitTest_8cpp_html_a7026fd16370249ce97cb3d062326baf9"><div class="ttname"><a href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a></div><div class="ttdeci">const unsigned n</div><div class="ttdef"><b>Definition:</b> CG3DPackingUnitTest.cpp:11</div></div>
<div class="ttc" id="aclassoomph_1_1LineVisualiser_html_aae14488400c1428663d0c42951cad439"><div class="ttname"><a href="../../dc/dd8/classoomph_1_1LineVisualiser.html#aae14488400c1428663d0c42951cad439">oomph::LineVisualiser::get_output_data</a></div><div class="ttdeci">void get_output_data(Vector&lt; Vector&lt; double &gt;&gt; &amp;data)</div><div class="ttdef"><b>Definition:</b> line_visualiser.h:134</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d5/d3b/Map__placement__new_8cpp.html#abe49a82806b5db2e012bc33839af03e6">data</a>, <a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#aae14488400c1428663d0c42951cad439">get_output_data()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>, and <a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a6786384d0c0c0de6df02b2b9a34a298a">Nplot_points</a>.</p>

</div>
</div>
<a id="a9522013a2e84c25c0aa90496cab12a19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9522013a2e84c25c0aa90496cab12a19">&#9670;&nbsp;</a></span>setup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::LineVisualiser::setup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *&#160;</td>
          <td class="paramname"><em>mesh_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>coord_vec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Helper function to setup the output structures. </p>
<div class="fragment"><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    {</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;      <span class="comment">// Read out number of plot points</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;      <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a6786384d0c0c0de6df02b2b9a34a298a">Nplot_points</a> = coord_vec.size();</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160; </div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a6786384d0c0c0de6df02b2b9a34a298a">Nplot_points</a> == 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160; </div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;      <span class="comment">// Keep track of unlocated plot points</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;      <span class="keywordtype">unsigned</span> count_not_found_local = 0;</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160; </div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;      <span class="comment">// Dimension</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;      <span class="keywordtype">unsigned</span> dim = coord_vec[0].size();</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160; </div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;      <span class="comment">// Make space</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;      <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a3b43813947f4a58381ce6e940a17b21f">Plot_point</a>.resize(<a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a6786384d0c0c0de6df02b2b9a34a298a">Nplot_points</a>);</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160; </div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;      <span class="comment">// Transform mesh into a geometric object</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;      MeshAsGeomObject mesh_geom_tmp(mesh_pt);</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160; </div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;      <span class="comment">// Limit the search radius</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;      mesh_geom_tmp.sample_point_container_pt()-&gt;max_search_radius() =</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;        <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#abfcd8512571fba22e22b1952823c8744">Max_search_radius</a>;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160; </div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;      <span class="comment">// Loop over input points</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;      <span class="keywordtype">double</span> tt_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a6786384d0c0c0de6df02b2b9a34a298a">Nplot_points</a>; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;      {</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        <span class="comment">// Local coordinate of the plot point with its element</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        Vector&lt;double&gt; <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>(dim, 0.0);</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160; </div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        <span class="comment">// Pointer to GeomObject that contains the plot point</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        GeomObject* geom_pt = 0;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160; </div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        <span class="comment">// Locate zeta</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        mesh_geom_tmp.locate_zeta(coord_vec[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>], geom_pt, <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>);</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160; </div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        <span class="comment">// Upcast GeomElement as a FiniteElement</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        FiniteElement* fe_pt = <span class="keyword">dynamic_cast&lt;</span>FiniteElement*<span class="keyword">&gt;</span>(geom_pt);</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160; </div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        <span class="comment">// Another one not found locally...</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;        <span class="keywordflow">if</span> (fe_pt == 0)</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        {</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;          count_not_found_local++;</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;          <span class="comment">/* oomph_info &lt;&lt; &quot;NOT Found the one at &quot;  */</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;          <span class="comment">/*            &lt;&lt; coord_vec[i][0] &lt;&lt; &quot; &quot; */</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;          <span class="comment">/*            &lt;&lt; coord_vec[i][1] &lt;&lt; &quot;\n&quot;; */</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        }</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        {</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;          <span class="comment">/* oomph_info &lt;&lt; &quot;Found the one at &quot;  */</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;          <span class="comment">/*            &lt;&lt; coord_vec[i][0] &lt;&lt; &quot; &quot; */</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;          <span class="comment">/*            &lt;&lt; coord_vec[i][1] &lt;&lt; &quot;\n&quot;; */</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        }</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160; </div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        <span class="comment">// Save result in a pair</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a3b43813947f4a58381ce6e940a17b21f">Plot_point</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = std::pair&lt;FiniteElement*, Vector&lt;double&gt;&gt;(fe_pt, <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>);</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;      }</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160; </div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160; </div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Number of points not found locally: &quot;</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                 &lt;&lt; count_not_found_local &lt;&lt; std::endl;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160; </div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;      <span class="comment">// Global equivalent (is overwritten below if mpi)</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;      <span class="keywordtype">unsigned</span> count_not_found = count_not_found_local;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160; </div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;      <span class="comment">// Check communication pointer exists and problem is</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;      <span class="comment">// distributed.</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a0c950d1578a20b271a1a51f58e469128">Comm_pt</a> != 0)</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;      {</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;        <span class="keywordtype">int</span> nproc = <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a0c950d1578a20b271a1a51f58e469128">Comm_pt</a>-&gt;<a class="code" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a6c78c72666f4b102c2bccf200f0853b7">nproc</a>();</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        <span class="keywordflow">if</span> (nproc &gt; 1)</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;        {</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160; </div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;          <span class="comment">// Declaration of MPI variables</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;          <span class="keywordtype">int</span> my_rank = <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a0c950d1578a20b271a1a51f58e469128">Comm_pt</a>-&gt;<a class="code" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a670b34aab05bfe0b96d0e0fabf583c7a">my_rank</a>();</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160; </div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;          <span class="comment">// Each processor indicates if it has found a given plot point.</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;          <span class="comment">// Once this is gathered on the root processor we know</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;          <span class="comment">// exactly which data we&#39;ll receive from where.</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;          Vector&lt;unsigned&gt; tmp_proc_point_found_plus_one(<a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a6786384d0c0c0de6df02b2b9a34a298a">Nplot_points</a>, 0);</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160; </div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;          <span class="comment">// Loop over the plot points</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a6786384d0c0c0de6df02b2b9a34a298a">Nplot_points</a>; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;          {</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;            <span class="comment">// Found locally?</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a3b43813947f4a58381ce6e940a17b21f">Plot_point</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].first != 0)</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;            {</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;              tmp_proc_point_found_plus_one[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = my_rank + 1;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;            }</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;          }</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160; </div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;          <span class="comment">// Gather information on root</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160; </div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;          <span class="comment">// Find out who&#39;s found the points</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;          Vector&lt;unsigned&gt; proc_point_found_plus_one(<a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a6786384d0c0c0de6df02b2b9a34a298a">Nplot_points</a>, 0);</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;          MPI_Reduce(&amp;tmp_proc_point_found_plus_one[0],</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                     &amp;proc_point_found_plus_one[0],</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                     <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a6786384d0c0c0de6df02b2b9a34a298a">Nplot_points</a>,</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                     MPI_UNSIGNED,</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                     MPI_MAX,</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                     0,</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                     <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a0c950d1578a20b271a1a51f58e469128">Comm_pt</a>-&gt;mpi_comm());</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160; </div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160; </div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;          <span class="comment">// Main process analyses data</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;          <span class="keywordflow">if</span> (my_rank == 0)</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;          {</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;            <span class="comment">// Analyse data for each point</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;            count_not_found = 0;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a6786384d0c0c0de6df02b2b9a34a298a">Nplot_points</a>; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;            {</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;              <span class="comment">// Nobody has found it</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;              <span class="keywordflow">if</span> (proc_point_found_plus_one[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] == 0)</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;              {</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                count_not_found++;</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;              }</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;            }</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;          }</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160; </div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;          <span class="comment">// Now tell everybody about it</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;          MPI_Bcast(&amp;count_not_found, 1, MPI_UNSIGNED, 0, <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a0c950d1578a20b271a1a51f58e469128">Comm_pt</a>-&gt;mpi_comm());</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160; </div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;        }</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;      }</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Number of plot points not found (with max search radius=&quot;</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                 &lt;&lt; <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#abfcd8512571fba22e22b1952823c8744">Max_search_radius</a> &lt;&lt; <span class="stringliteral">&quot;)]: &quot;</span> &lt;&lt; count_not_found</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;\nTotal time for LineVisualiser setup [sec]: &quot;</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                 &lt;&lt; <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>() - tt_start &lt;&lt; std::endl;</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    }</div>
<div class="ttc" id="alevel1__cplx__impl_8h_html_a462761ca92ad97a9a705cb875828b0b8"><div class="ttname"><a href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a></div><div class="ttdeci">RealScalar s</div><div class="ttdef"><b>Definition:</b> level1_cplx_impl.h:130</div></div>
<div class="ttc" id="anamespaceoomph_1_1TimingHelpers_html_a9fb6ad7e2e01b0914e9f7072ef9ebfa6"><div class="ttname"><a href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">oomph::TimingHelpers::timer</a></div><div class="ttdeci">double timer()</div><div class="ttdoc">returns the time in seconds after some point in past</div><div class="ttdef"><b>Definition:</b> oomph_utilities.cc:1295</div></div>
<div class="ttc" id="anamespaceoomph_html_aec474227917784dc0a255faf289cfc16"><div class="ttname"><a href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a></div><div class="ttdeci">OomphInfo oomph_info</div><div class="ttdef"><b>Definition:</b> oomph_definitions.cc:319</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a0c950d1578a20b271a1a51f58e469128">Comm_pt</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../da/db4/classoomph_1_1MeshAsGeomObject.html#a8a9fecb98d4e0a151e3b9e58aa433be9">oomph::MeshAsGeomObject::locate_zeta()</a>, <a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#abfcd8512571fba22e22b1952823c8744">Max_search_radius</a>, <a class="el" href="../../de/da1/classSamplePointContainer.html#ad38b50923288cd35ff5e24ada05d0c59">SamplePointContainer::max_search_radius()</a>, <a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a670b34aab05bfe0b96d0e0fabf583c7a">oomph::OomphCommunicator::my_rank()</a>, <a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a6786384d0c0c0de6df02b2b9a34a298a">Nplot_points</a>, <a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a6c78c72666f4b102c2bccf200f0853b7">oomph::OomphCommunicator::nproc()</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, <a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a3b43813947f4a58381ce6e940a17b21f">Plot_point</a>, <a class="el" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>, <a class="el" href="../../da/db4/classoomph_1_1MeshAsGeomObject.html#adddb31b09b4420410c5f722a6e629791">oomph::MeshAsGeomObject::sample_point_container_pt()</a>, and <a class="el" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">oomph::TimingHelpers::timer()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#acc4998289fb2e682ad7eb307702b6be3">LineVisualiser()</a>, and <a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#adfa22f79f20d300d045f2ef730f466ce">setup_from_file()</a>.</p>

</div>
</div>
<a id="adfa22f79f20d300d045f2ef730f466ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adfa22f79f20d300d045f2ef730f466ce">&#9670;&nbsp;</a></span>setup_from_file()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::LineVisualiser::setup_from_file </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *&#160;</td>
          <td class="paramname"><em>mesh_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>file_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>scale</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Helper function to setup from file. </p>
<div class="fragment"><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    {</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;      <span class="comment">// Open file use ifstream</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;      std::ifstream file_input(<a class="code" href="../../df/d76/namespaceParticles2023AnalysisHung.html#a90f1a91ea4768f0873b9510c0b5a2e26">file_name</a>.c_str(), std::ios_base::in);</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;      <span class="keywordflow">if</span> (!file_input)</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;      {</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        std::ostringstream error_message;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        error_message &lt;&lt; <span class="stringliteral">&quot;Cannot open file &quot;</span> &lt;&lt; <a class="code" href="../../df/d76/namespaceParticles2023AnalysisHung.html#a90f1a91ea4768f0873b9510c0b5a2e26">file_name</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(error_message.str(),</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      }</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;      <span class="keywordflow">if</span> (!file_input.is_open())</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;      {</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        std::ostringstream error_message;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        error_message &lt;&lt; <span class="stringliteral">&quot;Cannot open file &quot;</span> &lt;&lt; <a class="code" href="../../df/d76/namespaceParticles2023AnalysisHung.html#a90f1a91ea4768f0873b9510c0b5a2e26">file_name</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(error_message.str(),</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;      }</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160; </div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;      <span class="comment">// Declaration of variables</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;      <a class="code" href="../../d2/dc3/namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">std::string</a> <a class="code" href="../../d9/d33/namespacecalibrate.html#a90e089d8e5da3aa728ad53a0c5e6abee">line</a>;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      Vector&lt;Vector&lt;double&gt;&gt; coord_vec_tmp; <span class="comment">// Coord array</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160; </div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      <span class="comment">// Loop over the lines of the input file</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;      <span class="keywordflow">while</span> (getline(file_input, <a class="code" href="../../d9/d33/namespacecalibrate.html#a90e089d8e5da3aa728ad53a0c5e6abee">line</a>) <span class="comment">/* != 0*/</span>)</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;      {</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        <span class="comment">// Test if the first char of the line is a number</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        <span class="comment">// using ascii enumeration of chars</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        <span class="keywordflow">if</span> (isdigit(<a class="code" href="../../d9/d33/namespacecalibrate.html#a90e089d8e5da3aa728ad53a0c5e6abee">line</a>[0]))</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        {</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;          Vector&lt;double&gt; <a class="code" href="../../da/d67/level3__impl_8h.html#a0ab86207641c152874beced8f77894d0">tmp</a>(3);</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160; </div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;          <span class="comment">// Read the 3 first doubles of the line</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;          <span class="comment">// Return 3 if success and less if error</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;          <span class="keywordtype">int</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> =</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            sscanf(<a class="code" href="../../d9/d33/namespacecalibrate.html#a90e089d8e5da3aa728ad53a0c5e6abee">line</a>.c_str(), <span class="stringliteral">&quot;%lf %lf %lf&quot;</span>, &amp;<a class="code" href="../../da/d67/level3__impl_8h.html#a0ab86207641c152874beced8f77894d0">tmp</a>[0], &amp;<a class="code" href="../../da/d67/level3__impl_8h.html#a0ab86207641c152874beced8f77894d0">tmp</a>[1], &amp;<a class="code" href="../../da/d67/level3__impl_8h.html#a0ab86207641c152874beced8f77894d0">tmp</a>[2]);</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160; </div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> == 3) <span class="comment">// success</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;          {</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;            <span class="comment">// Rescaling</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; 3; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;            {</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;              <a class="code" href="../../da/d67/level3__impl_8h.html#a0ab86207641c152874beced8f77894d0">tmp</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] *= scale;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;            }</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160; </div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;            <span class="comment">// Add the new point to the list</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;            coord_vec_tmp.push_back(<a class="code" href="../../da/d67/level3__impl_8h.html#a0ab86207641c152874beced8f77894d0">tmp</a>);</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;          }</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;          <span class="keywordflow">else</span> <span class="comment">// error</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;          {</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;            <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Line ignored \n&quot;</span>;</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;          }</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        }</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;      }</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160; </div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;      <span class="comment">// Call to the helper function</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;      <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a9522013a2e84c25c0aa90496cab12a19">setup</a>(mesh_pt, coord_vec_tmp);</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    }</div>
<div class="ttc" id="alevel3__impl_8h_html_a0ab86207641c152874beced8f77894d0"><div class="ttname"><a href="../../da/d67/level3__impl_8h.html#a0ab86207641c152874beced8f77894d0">tmp</a></div><div class="ttdeci">Eigen::Matrix&lt; Scalar, Dynamic, Dynamic, ColMajor &gt; tmp</div><div class="ttdef"><b>Definition:</b> level3_impl.h:365</div></div>
<div class="ttc" id="anamespacecalibrate_html_a90e089d8e5da3aa728ad53a0c5e6abee"><div class="ttname"><a href="../../d9/d33/namespacecalibrate.html#a90e089d8e5da3aa728ad53a0c5e6abee">calibrate.line</a></div><div class="ttdeci">line</div><div class="ttdef"><b>Definition:</b> calibrate.py:103</div></div>
<div class="ttc" id="anamespaceoomph_1_1Global__string__for__annotation_html_ac5379de2fa7fe44f2cb31785fc208135"><div class="ttname"><a href="../../d2/dc3/namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">oomph::Global_string_for_annotation::string</a></div><div class="ttdeci">std::string string(const unsigned &amp;i)</div><div class="ttdef"><b>Definition:</b> oomph_definitions.cc:286</div></div>
<div class="ttc" id="aoomph__definitions_8h_html_a25c6813cc7341d125e2502f8923fb6c4"><div class="ttname"><a href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a></div><div class="ttdeci">#define OOMPH_EXCEPTION_LOCATION</div><div class="ttdef"><b>Definition:</b> oomph_definitions.h:61</div></div>
<div class="ttc" id="aoomph__definitions_8h_html_aa260cc4af589e30cea7fde997ae16667"><div class="ttname"><a href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a></div><div class="ttdeci">#define OOMPH_CURRENT_FUNCTION</div><div class="ttdef"><b>Definition:</b> oomph_definitions.h:86</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../df/d76/namespaceParticles2023AnalysisHung.html#a90f1a91ea4768f0873b9510c0b5a2e26">Particles2023AnalysisHung::file_name</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../d9/d33/namespacecalibrate.html#a90e089d8e5da3aa728ad53a0c5e6abee">calibrate::line</a>, <a class="el" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, <a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a9522013a2e84c25c0aa90496cab12a19">setup()</a>, <a class="el" href="../../d2/dc3/namespaceoomph_1_1Global__string__for__annotation.html#ac5379de2fa7fe44f2cb31785fc208135">oomph::Global_string_for_annotation::string()</a>, and <a class="el" href="../../da/d67/level3__impl_8h.html#a0ab86207641c152874beced8f77894d0">tmp</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a3eb2567997926ed29a6c8731d1e677c0">LineVisualiser()</a>.</p>

</div>
</div>
<a id="a6538fb5c75bff293dc9482d4c2c102cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6538fb5c75bff293dc9482d4c2c102cd">&#9670;&nbsp;</a></span>update_plot_points_coordinates()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::LineVisualiser::update_plot_points_coordinates </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>coord_vec</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Update plot points coordinates (in preparation of remesh, say). </p>
<div class="fragment"><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    {</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;      <span class="comment">// Resize coord_vec</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      coord_vec.resize(<a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a6786384d0c0c0de6df02b2b9a34a298a">Nplot_points</a>);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160; </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      <span class="comment">// Check that the communication pointer is initialised and the</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      <span class="comment">// problem is distributed.</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a0c950d1578a20b271a1a51f58e469128">Comm_pt</a> != 0)</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      {</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <span class="keywordtype">int</span> nproc = <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a0c950d1578a20b271a1a51f58e469128">Comm_pt</a>-&gt;<a class="code" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a6c78c72666f4b102c2bccf200f0853b7">nproc</a>();</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <span class="keywordflow">if</span> (nproc &gt; 1)</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        {</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;          <span class="comment">// Declaration of MPI variables</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;          MPI_Status stat;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;          <span class="keywordtype">int</span> tag; <span class="comment">// cgj: tag should be initialised before use</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;          <span class="keywordtype">int</span> my_rank = <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a0c950d1578a20b271a1a51f58e469128">Comm_pt</a>-&gt;<a class="code" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a670b34aab05bfe0b96d0e0fabf583c7a">my_rank</a>();</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160; </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;          <span class="comment">// Buffer</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;          <span class="keywordtype">unsigned</span> buff_size;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160; </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;          <span class="comment">// Create array which contains data found in every process</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;          Vector&lt;Vector&lt;double&gt;&gt; vec(<a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a6786384d0c0c0de6df02b2b9a34a298a">Nplot_points</a>);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160; </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a6786384d0c0c0de6df02b2b9a34a298a">Nplot_points</a>; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;          {</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a3b43813947f4a58381ce6e940a17b21f">Plot_point</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].first != NULL)</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;            {</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;              <span class="keywordflow">if</span> (!((*<a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a3b43813947f4a58381ce6e940a17b21f">Plot_point</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].first).is_halo()))</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;              {</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                <span class="keywordtype">unsigned</span> dim = <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a3b43813947f4a58381ce6e940a17b21f">Plot_point</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].second.size();</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160; </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                vec[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].resize(dim);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; dim; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                {</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                  vec[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>] = <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a3b43813947f4a58381ce6e940a17b21f">Plot_point</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].first-&gt;interpolated_x(</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                    <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a3b43813947f4a58381ce6e940a17b21f">Plot_point</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].second, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                }</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;              }</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            }</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;          }</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160; </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160; </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;          <span class="comment">// Analyse which plot points have been found</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;          <span class="comment">// locally and concatenate the data:</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160; </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;          <span class="comment">// This contains the flat-packed doubles to be sent</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;          <span class="comment">// for all located plot points</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;          Vector&lt;double&gt; local_values;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160; </div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;          <span class="comment">// Number of values to be sent for each plot point</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;          <span class="comment">// (almost certainly the same for all plot points, but...)</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;          <span class="comment">// size_values[i] gives the number of doubles to be</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;          <span class="comment">// sent for plot point i.</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;          Vector&lt;unsigned&gt; size_values;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160; </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;          <span class="comment">// Each processor indicates if it has found a given plot point.</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;          <span class="comment">// Once this is gathered on the root processor we know</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;          <span class="comment">// exactly which data we&#39;ll receive from where.</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;          Vector&lt;unsigned&gt; tmp_proc_point_found_plus_one(<a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a6786384d0c0c0de6df02b2b9a34a298a">Nplot_points</a>, 0);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160; </div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;          <span class="comment">// Loop over the plot points</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a6786384d0c0c0de6df02b2b9a34a298a">Nplot_points</a>; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;          {</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            <span class="keywordtype">unsigned</span> ndata = vec[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].size();</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;            <span class="keywordflow">if</span> (ndata != 0)</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            {</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;              <span class="comment">// Store the number of fields</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;              size_values.push_back(ndata);</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160; </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;              <span class="comment">// Update found vector</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;              tmp_proc_point_found_plus_one[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = my_rank + 1;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160; </div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;              <span class="comment">// Store values</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; ndata; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;              {</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                local_values.push_back(vec[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>]);</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;              }</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            }</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;          }</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160; </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;          <span class="comment">// Gather information on root</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160; </div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;          <span class="comment">// Find out who&#39;s found the points</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;          Vector&lt;unsigned&gt; proc_point_found_plus_one(<a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a6786384d0c0c0de6df02b2b9a34a298a">Nplot_points</a>, 0);</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;          MPI_Reduce(&amp;tmp_proc_point_found_plus_one[0],</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                     &amp;proc_point_found_plus_one[0],</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                     <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a6786384d0c0c0de6df02b2b9a34a298a">Nplot_points</a>,</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                     MPI_UNSIGNED,</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                     MPI_MAX,</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                     0,</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                     <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a0c950d1578a20b271a1a51f58e469128">Comm_pt</a>-&gt;mpi_comm());</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160; </div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;          <span class="comment">// Main process write data</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;          <span class="keywordflow">if</span> (my_rank == 0)</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;          {</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;            <span class="comment">// Collect all the data</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;            Vector&lt;Vector&lt;double&gt;&gt; received_data(nproc - 1);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            Vector&lt;Vector&lt;unsigned&gt;&gt; received_size(nproc - 1);</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            Vector&lt;unsigned&gt; counter_d(nproc - 1, 0);</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            Vector&lt;unsigned&gt; counter_s(nproc - 1, 0);</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160; </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;            <span class="comment">// Loop over processors that send their points</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 1; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; nproc; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            {</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;              <span class="comment">// Receive sizes of data</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;              MPI_Recv(&amp;buff_size,</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                       1,</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                       MPI_UNSIGNED,</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                       <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                       tag,</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                       <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a0c950d1578a20b271a1a51f58e469128">Comm_pt</a>-&gt;mpi_comm(),</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                       &amp;stat);</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;              received_size[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - 1].resize(<a class="code" href="../../dc/d51/datatypes_8h.html#affe776513b24d84b39af8ab0930fef7f">std::max</a>(<span class="keywordtype">unsigned</span>(1), buff_size));</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;              MPI_Recv(&amp;received_size[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - 1][0],</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                       buff_size,</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                       MPI_UNSIGNED,</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                       <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                       tag,</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                       <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a0c950d1578a20b271a1a51f58e469128">Comm_pt</a>-&gt;mpi_comm(),</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                       &amp;stat);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160; </div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;              <span class="comment">// Receive actual data</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;              MPI_Recv(&amp;buff_size,</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                       1,</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                       MPI_UNSIGNED,</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                       <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                       tag,</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                       <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a0c950d1578a20b271a1a51f58e469128">Comm_pt</a>-&gt;mpi_comm(),</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                       &amp;stat);</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;              received_data[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - 1].resize(<a class="code" href="../../dc/d51/datatypes_8h.html#affe776513b24d84b39af8ab0930fef7f">std::max</a>(<span class="keywordtype">unsigned</span>(1), buff_size));</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;              MPI_Recv(&amp;received_data[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - 1][0],</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                       buff_size,</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                       MPI_DOUBLE,</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                       <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                       tag,</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                       <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a0c950d1578a20b271a1a51f58e469128">Comm_pt</a>-&gt;mpi_comm(),</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                       &amp;stat);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;            }</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160; </div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;            <span class="comment">// Analyse data for each point</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a6786384d0c0c0de6df02b2b9a34a298a">Nplot_points</a>; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;            {</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;              <span class="comment">// Somebody has found it</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;              <span class="keywordflow">if</span> (proc_point_found_plus_one[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] != 0)</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;              {</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                <span class="comment">// Root processor has found it</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                <span class="keywordflow">if</span> (proc_point_found_plus_one[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] == 1)</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                {</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                  <span class="comment">// Copy directly from vec vector</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                  coord_vec[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = vec[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                }</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                <span class="comment">// Another (non-root) processor has found it</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                {</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                  <span class="keywordtype">unsigned</span> line_i = proc_point_found_plus_one[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] - 2;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160; </div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                  <span class="comment">// Resize data line</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                  coord_vec[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].resize(received_size[line_i][counter_s[line_i]]);</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160; </div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                  <span class="comment">// Copy values</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                       <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; received_size[line_i][counter_s[line_i]];</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                       <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                  {</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                    coord_vec[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>] =</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                      received_data[line_i][counter_d[line_i] + <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>];</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                  }</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160; </div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                  <span class="comment">// Increase counter</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                  counter_d[line_i] += received_size[line_i][counter_s[line_i]];</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                  counter_s[line_i]++;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                }</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;              } <span class="comment">// end somebody has found it -- no output at all if nobody</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;              <span class="comment">// has found the point (e.g. outside mesh)</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;            }</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;          }</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;          <span class="comment">// Send data to root</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;          {</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;            <span class="comment">// Send the number of fields to the main process</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;            buff_size = size_values.size();</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;            MPI_Send(&amp;buff_size, 1, MPI_UNSIGNED, 0, tag, <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a0c950d1578a20b271a1a51f58e469128">Comm_pt</a>-&gt;mpi_comm());</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160; </div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;            <span class="comment">// Send the sizes of fields to the main process</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;            <span class="keywordflow">if</span> (buff_size == 0) size_values.resize(1);</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;            MPI_Send(&amp;size_values[0],</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                     buff_size,</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                     MPI_UNSIGNED,</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                     0,</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                     tag,</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                     <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a0c950d1578a20b271a1a51f58e469128">Comm_pt</a>-&gt;mpi_comm());</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160; </div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;            <span class="comment">// Send the number of data fields to the main process</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;            buff_size = local_values.size();</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;            MPI_Send(&amp;buff_size, 1, MPI_UNSIGNED, 0, tag, <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a0c950d1578a20b271a1a51f58e469128">Comm_pt</a>-&gt;mpi_comm());</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160; </div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;            <span class="comment">// Send the data to the main process</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;            <span class="keywordflow">if</span> (buff_size == 0) local_values.resize(1);</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;            MPI_Send(&amp;local_values[0],</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                     buff_size,</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                     MPI_DOUBLE,</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                     0,</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                     tag,</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                     <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a0c950d1578a20b271a1a51f58e469128">Comm_pt</a>-&gt;mpi_comm());</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;          }</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160; </div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// Serial version</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        }</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      }</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;      {</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        <a class="code" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#acfe0c8f984f63707959ff4dc2713ee3a">get_local_plot_points_coordinates</a>(coord_vec);</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;      }</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1LineVisualiser_html_acfe0c8f984f63707959ff4dc2713ee3a"><div class="ttname"><a href="../../dc/dd8/classoomph_1_1LineVisualiser.html#acfe0c8f984f63707959ff4dc2713ee3a">oomph::LineVisualiser::get_local_plot_points_coordinates</a></div><div class="ttdeci">void get_local_plot_points_coordinates(Vector&lt; Vector&lt; double &gt;&gt; &amp;data)</div><div class="ttdef"><b>Definition:</b> line_visualiser.h:801</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a0c950d1578a20b271a1a51f58e469128">Comm_pt</a>, <a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#acfe0c8f984f63707959ff4dc2713ee3a">get_local_plot_points_coordinates()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../dc/d51/datatypes_8h.html#affe776513b24d84b39af8ab0930fef7f">max</a>, <a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a670b34aab05bfe0b96d0e0fabf583c7a">oomph::OomphCommunicator::my_rank()</a>, <a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a6786384d0c0c0de6df02b2b9a34a298a">Nplot_points</a>, <a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a6c78c72666f4b102c2bccf200f0853b7">oomph::OomphCommunicator::nproc()</a>, and <a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a3b43813947f4a58381ce6e940a17b21f">Plot_point</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a0c950d1578a20b271a1a51f58e469128"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c950d1578a20b271a1a51f58e469128">&#9670;&nbsp;</a></span>Comm_pt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html">OomphCommunicator</a>* oomph::LineVisualiser::Comm_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Pointer to communicator &ndash; allows us to collect data on processor 0 if the mesh is distributed. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#aae14488400c1428663d0c42951cad439">get_output_data()</a>, <a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a9522013a2e84c25c0aa90496cab12a19">setup()</a>, and <a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a6538fb5c75bff293dc9482d4c2c102cd">update_plot_points_coordinates()</a>.</p>

</div>
</div>
<a id="abfcd8512571fba22e22b1952823c8744"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abfcd8512571fba22e22b1952823c8744">&#9670;&nbsp;</a></span>Max_search_radius</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> oomph::LineVisualiser::Max_search_radius</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Max radius beyond which we stop searching the bin. Initialised to DBL_MAX so keep going until the point is found or until we've searched every single bin. Overwriting this means we won't search in bins whose closest vertex is at a distance greater than Max_search_radius from the point to be located. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a9522013a2e84c25c0aa90496cab12a19">setup()</a>.</p>

</div>
</div>
<a id="a6786384d0c0c0de6df02b2b9a34a298a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6786384d0c0c0de6df02b2b9a34a298a">&#9670;&nbsp;</a></span>Nplot_points</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> oomph::LineVisualiser::Nplot_points</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of plot points. </p>

<p class="reference">Referenced by <a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#acfe0c8f984f63707959ff4dc2713ee3a">get_local_plot_points_coordinates()</a>, <a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#aae14488400c1428663d0c42951cad439">get_output_data()</a>, <a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#adafda17eaa1c034ff7236e1f7dcbc771">output()</a>, <a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a9522013a2e84c25c0aa90496cab12a19">setup()</a>, and <a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a6538fb5c75bff293dc9482d4c2c102cd">update_plot_points_coordinates()</a>.</p>

</div>
</div>
<a id="a3b43813947f4a58381ce6e940a17b21f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b43813947f4a58381ce6e940a17b21f">&#9670;&nbsp;</a></span>Plot_point</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt;std::pair&lt;<a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html">FiniteElement</a>*, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt;<a class="el" href="../../df/de6/classdouble.html">double</a>&gt; &gt; &gt; oomph::LineVisualiser::Plot_point</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Vector of pairs containing points to finite elements and local coordinates </p>

<p class="reference">Referenced by <a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#acfe0c8f984f63707959ff4dc2713ee3a">get_local_plot_points_coordinates()</a>, <a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#aae14488400c1428663d0c42951cad439">get_output_data()</a>, <a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a9522013a2e84c25c0aa90496cab12a19">setup()</a>, and <a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html#a6538fb5c75bff293dc9482d4c2c102cd">update_plot_points_coordinates()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="../../d5/da0/line__visualiser_8h_source.html">line_visualiser.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../da/ddf/namespaceoomph.html">oomph</a></li><li class="navelem"><a class="el" href="../../dc/dd8/classoomph_1_1LineVisualiser.html">LineVisualiser</a></li>
    <li class="footer">Generated on Wed Aug 27 2025 17:09:06 for MercuryDPM by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
