<!-- HTML header for doxygen 1.8.18-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MercuryDPM: Coarse graining: the definition of continuum fields</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../MDPM.css" rel="stylesheet" type="text/css"/>
<link href="../../codeLabels.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-fork-corner.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-dropdown-version.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../MDPM-fragment-copy-button.js"></script>
<script type="text/javascript">
DoxygenAwesomeFragmentCopyButton.init()
</script>
<script type="text/javascript" src="../../MDPM-paragraph-link.js"></script>
<script type="text/javascript">
DoxygenAwesomeParagraphLink.init()
</script>
<script type="text/javascript" src="../../MDPM-interactive-toc.js"></script>
<script type="text/javascript">
DoxygenAwesomeInteractiveToc.init()
</script>
<script type="text/javascript" src="../../MDPM-darkmode-toggle.js"></script>
<script type="text/javascript">
DoxygenAwesomeDarkModeToggle.init()
</script>
</head>
<body>
  <div id="bitbucket-corner">
   <a href="https://bitbucket.org/mercurydpm/mercurydpm/src/master/" target="_blank" id="fork-corner" class="fork-corner fc-pos-tr fc-animate fc-theme-bitbucket"></a>
  </div>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../mercury-logo-chosen-light-slogan.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"> <!--MercuryDPM--!>
   <!-- BEGIN version select -->
   <div class="dropdown" id="projectnumber">
    <button class="dropbtn">v1.0</button>
    <div class="dropdown-content">
    </div>
   </div>
   <script type="text/javascript" src="../../MDPM-dropdown-version.js"></script>
<!-- END version select -->
   <!--&#160;<span id="projectnumber">revision: v1.0</span>-->
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<script type="text/javascript" src="../../MDPM-fork-corner.js"></script>
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d2/d31/CG.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Coarse graining: the definition of continuum fields </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#cons">Defining the basic coarse-grained fields</a><ul><li class="level2"><a href="#dens">Density</a></li>
<li class="level2"><a href="#mom">Momentum</a></li>
<li class="level2"><a href="#stress">Kinetic and contact stress</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p>This page describes the mathematical formulas used to extract continuum fields from particle data.</p>
<p>Discrete particle simulations create a large amount of data, such as the position and velocities of each interactable (particle/wall), and the forces created by each interaction. This data completely describes the system you are simulating, but it is difficult to draw any physically relevant conclusions from it.</p>
<p>Therefore, granular assemblies are often described using continuum fields, like density \(\rho\), momentum \(\vec j=\rho \vec V\), stress \(\mathbf \sigma\) and temperature. Continuum descriptions have been very successful in describing the macroscopic physical behavior of granular systems, and describe many phenomena as diverse as plastic/inertial flow, soil mechanics, or segregation. Other phenomena such as fracturing, jamming/force chains, crystallization have so far resisted efforts to be described by continuum theories. However, we can still learn a lot from evaluation their continuum properties by developing special continuum fields such as fabric, displacement, or orientation.</p>
<h1><a class="anchor" id="cons"></a>
Defining the basic coarse-grained fields</h1>
<p>Density, momentum, and stress, in particular, are strongly related to each other, as they observe the equations describing conservation of mass and momentum, </p><p class="formulaDsp">
\[\partial_t\rho + \nabla\cdot(\rho \vec V) = 0,\]
</p>
 <p class="formulaDsp">
\[\partial_t(\rho \vec V) + \nabla\cdot(\rho \vec V \vec V) = \nabla \mathbf \sigma + \rho \vec g.\]
</p>
<p>While traditional micro-macro methods begin by defining density, momentum, and stress and then show that they satisfy ass and momentum balance in a statistical sense (ie. by ensemble averaging), coarse-graining takes a different approach:</p>
<h2><a class="anchor" id="dens"></a>
Density</h2>
<p>In coarse-graining, density is defined first, as the sum over all particle masses weighted by the distance to the evaluated position: </p><p class="formulaDsp">
\[\rho(\vec r)=\sum_i m_i \phi(\vec r,\vec r_i),\]
</p>
<p> with position \(r\), particle position \(r_i\). The coarse-graining function \(\phi\) (also called weighting or kernel function) is not uniquely defined, but often a Gauss function of width \(w\) is used, </p><p class="formulaDsp">
\[ \phi(\vec r,\vec r_i) = c \exp(-\frac{|\vec r-\vec r_i|^2}{2w^2}),\]
</p>
<p> where the prefactor \(c\) is chosen such that \(\int \phi(\vec r) d\vec r = 1\).</p>
<h2><a class="anchor" id="mom"></a>
Momentum</h2>
<p>Next, the momentum at a given position is defined as the sum over all particle moments weighted by the distance to the position: </p><p class="formulaDsp">
\[\vec j(\vec r)=\sum_i m_i v_i \phi(\vec r,\vec r_i),\]
</p>
<p> Thus, the velocity is defined as </p><p class="formulaDsp">
\[\vec V(\vec r) = \frac{\vec j(\vec r,t)}{\rho(\vec r)}.\]
</p>
<p>One can easily show that the density and momentum density fields satisfy the mass conservation equation <em>by definition</em>.</p>
<h2><a class="anchor" id="stress"></a>
Kinetic and contact stress</h2>
<p>Similarly, the stress tensor can be defined such that it identically satisfies the conservation of momentum. For that, we define the stress as the sum of the <em>contact stress</em> and the <em>kinetic stress</em>, </p><p class="formulaDsp">
\[ \mathbf \sigma=\mathbf \sigma^{c}+\mathbf \sigma^{c}. \]
</p>
<p>The kinetic stress can be calculated from momentum flux and density as </p><p class="formulaDsp">
\[\mathbf \sigma^{k} = - \mathbf k - \rho \vec V \otimes \vec V,\]
</p>
<p> where the momentum flux is defined as the sum over all particles i </p><p class="formulaDsp">
\[\mathbf k(\vec r,t)=\sum_i m_i \vec v_i \otimes \vec v_i\phi(\vec r,\vec r_i),\]
</p>
<p> with particle momentum flux \(m_i\vec v_i \otimes \vec v_i\) and kernel function \(\phi(\vec r,\vec r_i)\).</p>
<p>The contact stress is has a slightly more complex definition: </p><p class="formulaDsp">
\[\mathbf \sigma^{c}(\vec r,t)=\sum_{ij} \vec f_{ij} \otimes \vec l_{ij} \psi(\vec r,\vec r_i,\vec r_j),\]
</p>
<p> with contact force \(\vec f_{ij}\), branch vector \(\vec l_{ij}= \vec c_{ij}-\vec r_i\), particle position \(\vec r_i\), contact point \(\vec c_{ij}\), and a line integral over the kernel function, </p><p class="formulaDsp">
\[ \psi(\vec r,\vec r_i,\vec r_j) = \int_{0}^{1} \phi(\vec r - \vec r_I + s r_{IP}) ds.\]
</p>
<p>One can show that this stress definition satisfies the momentum conservation equation <em>by definition</em>. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../index.html">MercuryDPM Reference Manual</a></li><li class="navelem"><a class="el" href="../../d9/d5c/MercuryDPM_CG.html">Coarse graining: From discrete particles to continuum fields</a></li>
    <li class="footer">Generated on Wed Aug 27 2025 17:05:12 for MercuryDPM by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
