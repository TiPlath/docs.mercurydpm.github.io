<!-- HTML header for doxygen 1.8.18-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MercuryDPM: oomph::FSI_functions Namespace Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../MDPM.css" rel="stylesheet" type="text/css"/>
<link href="../../codeLabels.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-fork-corner.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-dropdown-version.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../MDPM-fragment-copy-button.js"></script>
<script type="text/javascript">
DoxygenAwesomeFragmentCopyButton.init()
</script>
<script type="text/javascript" src="../../MDPM-paragraph-link.js"></script>
<script type="text/javascript">
DoxygenAwesomeParagraphLink.init()
</script>
<script type="text/javascript" src="../../MDPM-interactive-toc.js"></script>
<script type="text/javascript">
DoxygenAwesomeInteractiveToc.init()
</script>
<script type="text/javascript" src="../../MDPM-darkmode-toggle.js"></script>
<script type="text/javascript">
DoxygenAwesomeDarkModeToggle.init()
</script>
</head>
<body>
  <div id="bitbucket-corner">
   <a href="https://bitbucket.org/mercurydpm/mercurydpm/src/master/" target="_blank" id="fork-corner" class="fork-corner fc-pos-tr fc-animate fc-theme-bitbucket"></a>
  </div>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../mercury-logo-chosen-light-slogan.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"> <!--MercuryDPM--!>
   <!-- BEGIN version select -->
   <div class="dropdown" id="projectnumber">
    <button class="dropbtn">v1.0</button>
    <div class="dropdown-content">
    </div>
   </div>
   <script type="text/javascript" src="../../MDPM-dropdown-version.js"></script>
<!-- END version select -->
   <!--&#160;<span id="projectnumber">revision: v1.0</span>-->
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<script type="text/javascript" src="../../MDPM-fork-corner.js"></script>
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d2/d39/namespaceoomph_1_1FSI__functions.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">oomph::FSI_functions Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Namespace for "global" FSI functions.  
<a href="../../d2/d39/namespaceoomph_1_1FSI__functions.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac1a95cf31d719f6aeceb72554ee75868"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d39/namespaceoomph_1_1FSI__functions.html#ac1a95cf31d719f6aeceb72554ee75868">apply_no_slip_on_moving_wall</a> (<a class="el" href="../../dc/db7/classoomph_1_1Node.html">Node</a> *node_pt)</td></tr>
<tr class="separator:ac1a95cf31d719f6aeceb72554ee75868"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac71732700aad0d671fa1285d173d5b27"><td class="memTemplParams" colspan="2">template&lt;class FLUID_ELEMENT , unsigned DIM_FLUID&gt; </td></tr>
<tr class="memitem:ac71732700aad0d671fa1285d173d5b27"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../d2/d39/namespaceoomph_1_1FSI__functions.html#ac71732700aad0d671fa1285d173d5b27">setup_fluid_load_info_for_solid_elements</a> (<a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *problem_pt, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;boundary_in_fluid_mesh, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;fluid_mesh_pt, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> * &gt; &amp;solid_mesh_pt, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;face=0)</td></tr>
<tr class="separator:ac71732700aad0d671fa1285d173d5b27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adccd22c19d99eabffd72f7671df49598"><td class="memTemplParams" colspan="2">template&lt;class FLUID_ELEMENT , unsigned DIM_FLUID&gt; </td></tr>
<tr class="memitem:adccd22c19d99eabffd72f7671df49598"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../d2/d39/namespaceoomph_1_1FSI__functions.html#adccd22c19d99eabffd72f7671df49598">setup_fluid_load_info_for_solid_elements</a> (<a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *problem_pt, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;boundary_in_fluid_mesh, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;fluid_mesh_pt, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;solid_mesh_pt, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;face=0)</td></tr>
<tr class="separator:adccd22c19d99eabffd72f7671df49598"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacfff5c6e8f9ee75e7d2ae490d28fb7b"><td class="memTemplParams" colspan="2">template&lt;class SOLID_ELEMENT , unsigned DIM_SOLID&gt; </td></tr>
<tr class="memitem:aacfff5c6e8f9ee75e7d2ae490d28fb7b"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../d2/d39/namespaceoomph_1_1FSI__functions.html#aacfff5c6e8f9ee75e7d2ae490d28fb7b">setup_solid_elements_for_displacement_bc</a> (<a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *problem_pt, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;b_solid_fsi, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;solid_mesh_pt, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> * &gt; &amp;lagrange_multiplier_mesh_pt)</td></tr>
<tr class="separator:aacfff5c6e8f9ee75e7d2ae490d28fb7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad638257ef97a089f5367edf5d2911e60"><td class="memTemplParams" colspan="2">template&lt;class SOLID_ELEMENT , unsigned DIM_SOLID&gt; </td></tr>
<tr class="memitem:ad638257ef97a089f5367edf5d2911e60"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../d2/d39/namespaceoomph_1_1FSI__functions.html#ad638257ef97a089f5367edf5d2911e60">setup_solid_elements_for_displacement_bc</a> (<a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *problem_pt, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;b_solid_fsi, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;solid_mesh_pt, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;lagrange_multiplier_mesh_pt)</td></tr>
<tr class="separator:ad638257ef97a089f5367edf5d2911e60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc4e716b0325ab47465bd6c312c829fe"><td class="memTemplParams" colspan="2">template&lt;class NODE &gt; </td></tr>
<tr class="memitem:afc4e716b0325ab47465bd6c312c829fe"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../d2/d39/namespaceoomph_1_1FSI__functions.html#afc4e716b0325ab47465bd6c312c829fe">doc_fsi</a> (<a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *fluid_mesh_pt, <a class="el" href="../../da/d73/classoomph_1_1SolidMesh.html">SolidMesh</a> *wall_mesh_pt, <a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> &amp;doc_info)</td></tr>
<tr class="separator:afc4e716b0325ab47465bd6c312c829fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:aa213854665524b0720b63a115ef57fd8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d39/namespaceoomph_1_1FSI__functions.html#aa213854665524b0720b63a115ef57fd8">Strouhal_for_no_slip</a> = 1.0</td></tr>
<tr class="separator:aa213854665524b0720b63a115ef57fd8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Namespace for "global" FSI functions. </p>
<p>///////////////////////////////////////////////////////////////////// ///////////////////////////////////////////////////////////////////// ///////////////////////////////////////////////////////////////////// </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ac1a95cf31d719f6aeceb72554ee75868"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1a95cf31d719f6aeceb72554ee75868">&#9670;&nbsp;</a></span>apply_no_slip_on_moving_wall()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::FSI_functions::apply_no_slip_on_moving_wall </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dc/db7/classoomph_1_1Node.html">Node</a> *&#160;</td>
          <td class="paramname"><em>node_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Apply no-slip condition for N.St. on a moving wall node u = St dR/dt, where the Strouhal number St = a/(UT) is defined by FSI_functions::Strouhal_for_no_slip and is initialised to 1.0. Note: This requires the x,y,[z] velocity components to be stored in nodal values 0,1,[2]. This is the default for all currently existing Navier-Stokes elements. If you use any others, use this function at your own risk.</p>
<p>Apply no-slip condition for N.St. on a moving wall node, u = St dR/dt, where the Strouhal number St = a/(UT) is defined by FSI_functions::Strouhal_for_no_slip and is initialised to 1.0. Note: This requires the x,y,[z] velocity components to be stored in nodal values 0,1,[2]. This is the default for all currently existing Navier-Stokes elements. If you use any others, use this function at your own risk. </p>
<div class="fragment"><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      <span class="comment">// Find out spatial dimension of node</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      <span class="keywordtype">unsigned</span> ndim = node_pt-&gt;ndim();</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      <span class="comment">// Assign velocity</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; ndim; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        node_pt-&gt;set_value(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                           <a class="code" href="../../d2/d39/namespaceoomph_1_1FSI__functions.html#aa213854665524b0720b63a115ef57fd8">Strouhal_for_no_slip</a> * (node_pt-&gt;dposition_dt(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)));</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      }</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    }</div>
<div class="ttc" id="aBiCGSTAB__step__by__step_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> BiCGSTAB_step_by_step.cpp:9</div></div>
<div class="ttc" id="anamespaceoomph_1_1FSI__functions_html_aa213854665524b0720b63a115ef57fd8"><div class="ttname"><a href="../../d2/d39/namespaceoomph_1_1FSI__functions.html#aa213854665524b0720b63a115ef57fd8">oomph::FSI_functions::Strouhal_for_no_slip</a></div><div class="ttdeci">double Strouhal_for_no_slip</div><div class="ttdef"><b>Definition:</b> fsi.cc:39</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/db7/classoomph_1_1Node.html#ad3d37ea1c80500645fa32cc43f1f29ce">oomph::Node::dposition_dt()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../dc/db7/classoomph_1_1Node.html#a786c96a8e46eb27a03b2b31f629d41b3">oomph::Node::ndim()</a>, <a class="el" href="../../d8/dc5/classoomph_1_1Data.html#a7289ca322725c6fd493970a19474b382">oomph::Data::set_value()</a>, and <a class="el" href="../../d2/d39/namespaceoomph_1_1FSI__functions.html#aa213854665524b0720b63a115ef57fd8">Strouhal_for_no_slip</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d4a/classFSIChannelWithLeafletProblem.html#acc3f4745ea9b4524aebbc4f2556d1286">FSIChannelWithLeafletProblem&lt; ELEMENT &gt;::actions_after_adapt()</a>, <a class="el" href="../../dd/da6/classFSICollapsibleChannelProblem.html#ae20eb7ed895e0063ade5a6d0c6f9af2f">FSICollapsibleChannelProblem&lt; ELEMENT &gt;::actions_after_adapt()</a>, <a class="el" href="../../da/db6/classFSIRingProblem.html#af4ffa3d628230ef064a84b7c6e6a5fb8">FSIRingProblem::actions_after_adapt()</a>, <a class="el" href="../../dd/d71/classOscRingNStProblem.html#a2dd1cb9b211f2cbd2ea9aea625685bcb">OscRingNStProblem&lt; ELEMENT &gt;::actions_after_adapt()</a>, <a class="el" href="../../d3/db4/classPseudoElasticCollapsibleChannelProblem.html#a32c96be4a8f9bd3600fbcacde079d0e6">PseudoElasticCollapsibleChannelProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;::actions_after_adapt()</a>, <a class="el" href="../../d1/dfc/classTurekProblem.html#a39df0332d7606a5befe89bb0e581184b">TurekProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;::actions_after_adapt()</a>, <a class="el" href="../../dd/d4a/classFSIChannelWithLeafletProblem.html#a538f243f052bd30777248c5b81a67ba2">FSIChannelWithLeafletProblem&lt; ELEMENT &gt;::actions_after_distribute()</a>, <a class="el" href="../../da/db6/classFSIRingProblem.html#a14ee3e84f76e4376f1e21c0d5a0f50ef">FSIRingProblem::actions_after_distribute()</a>, <a class="el" href="../../d3/db4/classPseudoElasticCollapsibleChannelProblem.html#aec22746026c4ea501304482ef52cc246">PseudoElasticCollapsibleChannelProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;::actions_after_distribute()</a>, <a class="el" href="../../d1/dfc/classTurekProblem.html#a47661b6805533696372c93abe73c9cf2">TurekProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;::actions_after_distribute()</a>, <a class="el" href="../../d2/d1f/classChannelWithLeafletProblem.html#acef6ec771775162f77295a8f92d695ac">ChannelWithLeafletProblem&lt; ELEMENT &gt;::actions_before_implicit_timestep()</a>, <a class="el" href="../../d1/d8c/classCollapsibleChannelProblem.html#a4c365050b11c184007b8e1cd6079147f">CollapsibleChannelProblem&lt; ELEMENT &gt;::actions_before_implicit_timestep()</a>, <a class="el" href="../../dc/d83/classFlowAroundCylinderProblem.html#aea8798539805a2dfe99eb47503ce0071">FlowAroundCylinderProblem&lt; ELEMENT &gt;::actions_before_implicit_timestep()</a>, <a class="el" href="../../db/d50/classOscEllipseProblem.html#a7b12b4fdfcb46c3f00885f0a1f9965b3">OscEllipseProblem&lt; ELEMENT, TIMESTEPPER &gt;::actions_before_implicit_timestep()</a>, <a class="el" href="../../dd/d71/classOscRingNStProblem.html#a8c5c9c3c87c4e48249090a3c554fcb85">OscRingNStProblem&lt; ELEMENT &gt;::actions_before_implicit_timestep()</a>, <a class="el" href="../../d7/dcc/classTurekNonFSIProblem.html#a29725cde9071c3a83792469787ea6c7d">TurekNonFSIProblem&lt; ELEMENT &gt;::actions_before_implicit_timestep()</a>, <a class="el" href="../../dd/da6/classFSICollapsibleChannelProblem.html#ace5343d2e6e6e0480d077d4f17365288">FSICollapsibleChannelProblem&lt; ELEMENT &gt;::actions_before_newton_convergence_check()</a>, <a class="el" href="../../dd/dee/classUnstructuredFSIProblem.html#a1e70ec736dc0f7b03c3c991ba8737212">UnstructuredFSIProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;::actions_before_newton_convergence_check()</a>, <a class="el" href="../../d1/d8c/classCollapsibleChannelProblem.html#ae98da2352f60b510d4edb914902542bb">CollapsibleChannelProblem&lt; ELEMENT &gt;::actions_before_newton_convergence_check()</a>, <a class="el" href="../../db/dda/classUnstructuredImmersedEllipseProblem.html#a42b13e3306ff2a94053907644ba17c8d">UnstructuredImmersedEllipseProblem&lt; ELEMENT &gt;::complete_problem_setup()</a>, <a class="el" href="../../d5/d3c/classUnstructuredFluidProblem.html#a896741da7d644d5bfc9a3cde6276a2fb">UnstructuredFluidProblem&lt; ELEMENT &gt;::complete_problem_setup()</a>, <a class="el" href="../../dd/d71/classOscRingNStProblem.html#ad3011baf498f80451bb31082afab2fec">OscRingNStProblem&lt; ELEMENT &gt;::finish_problem_setup()</a>, <a class="el" href="../../dd/d4a/classFSIChannelWithLeafletProblem.html#aaa0a455e91c4fb2dd9696607b802d01b">FSIChannelWithLeafletProblem&lt; ELEMENT &gt;::FSIChannelWithLeafletProblem()</a>, <a class="el" href="../../dd/da6/classFSICollapsibleChannelProblem.html#a74efdd9ed027ab0ca5cf59ec8da6b95c">FSICollapsibleChannelProblem&lt; ELEMENT &gt;::FSICollapsibleChannelProblem()</a>, <a class="el" href="../../d5/df4/classFSIDrivenCavityProblem.html#aded4b15057c6c38ac58b914d614b947a">FSIDrivenCavityProblem&lt; ELEMENT &gt;::FSIDrivenCavityProblem()</a>, <a class="el" href="../../da/db6/classFSIRingProblem.html#a8f4969c6397bebe8afa2b9285ec908e6">FSIRingProblem::FSIRingProblem()</a>, <a class="el" href="../../d1/dfc/classTurekProblem.html#a18a11df5959358cb5343fb9a8b0410e3">TurekProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;::generic_actions_after()</a>, <a class="el" href="../../dd/d71/classOscRingNStProblem.html#a33023787bdd34ada9fae40f1b32ca339">OscRingNStProblem&lt; ELEMENT &gt;::OscRingNStProblem()</a>, <a class="el" href="../../d3/db4/classPseudoElasticCollapsibleChannelProblem.html#abba847b01b2360d584baf71ecaca5381">PseudoElasticCollapsibleChannelProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;::PseudoElasticCollapsibleChannelProblem()</a>, <a class="el" href="../../d1/dfc/classTurekProblem.html#a69f6624fd854393f0c0e5303603ec749">TurekProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;::TurekProblem()</a>, and <a class="el" href="../../dd/dee/classUnstructuredFSIProblem.html#a6a31fd839e0215ef1312942cf7284bd2">UnstructuredFSIProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;::UnstructuredFSIProblem()</a>.</p>

</div>
</div>
<a id="afc4e716b0325ab47465bd6c312c829fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc4e716b0325ab47465bd6c312c829fe">&#9670;&nbsp;</a></span>doc_fsi()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class NODE &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void oomph::FSI_functions::doc_fsi </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *&#160;</td>
          <td class="paramname"><em>fluid_mesh_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d73/classoomph_1_1SolidMesh.html">SolidMesh</a> *&#160;</td>
          <td class="paramname"><em>wall_mesh_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>doc_info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Doc FSI:</p><ol type="1">
<li>Which Data values affect the traction onto the FSIWallElements and what type of Data is it stored in ([fluid-]nodes, internal Data [in fluid elements] or SolidNodes?</li>
<li>Which SolidNodes affect the node update of the fluid nodes?</li>
</ol>
<p>Output is in tecplot readable form: Use fs1.mcr and fsi2.mcr (or straightforward modifications thereof), stored in doc/interaction/fsi_collapsible_channel/nondist_figures to process.</p>
<p>Pass pointer to fluid and solid meshes and pointer to the DocInfo object that specifies the directory and the overall step number. Template parameter specifies the type of node that is used to implement the node update strategy. </p>
<div class="fragment"><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    {</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;      std::ofstream some_file;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;      std::ostringstream <a class="code" href="../../d5/db2/namespaceMergeRestartFiles.html#a210231ed06d822ca8be83bd7f75aa572">filename</a>;</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160; </div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;      <span class="comment">// Number of plot points</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;      <span class="keywordtype">unsigned</span> npts;</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;      npts = 5;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160; </div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;      <span class="comment">// Part 1: Doc which dofs affect the fluid traction on solid</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;      <span class="comment">//==========================================================</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160; </div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;      <span class="comment">// Tecplot helpers</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;      Vector&lt;std::string&gt; <a class="code" href="../../de/d6c/namespaceUniformPSDSelfTest.html#a8e741d2bbc81a8911d991b685bdecbde">label</a>(3);</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;      <a class="code" href="../../de/d6c/namespaceUniformPSDSelfTest.html#a8e741d2bbc81a8911d991b685bdecbde">label</a>[0] = <span class="stringliteral">&quot;X=&quot;</span>;</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;      <a class="code" href="../../de/d6c/namespaceUniformPSDSelfTest.html#a8e741d2bbc81a8911d991b685bdecbde">label</a>[1] = <span class="stringliteral">&quot;Y=&quot;</span>;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;      <a class="code" href="../../de/d6c/namespaceUniformPSDSelfTest.html#a8e741d2bbc81a8911d991b685bdecbde">label</a>[2] = <span class="stringliteral">&quot;Z=&quot;</span>;</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160; </div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;      <span class="comment">// Output fluid solution/mesh</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;      <span class="comment">//---------------------------</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;      <a class="code" href="../../d5/db2/namespaceMergeRestartFiles.html#a210231ed06d822ca8be83bd7f75aa572">filename</a> &lt;&lt; doc_info.directory() &lt;&lt; <span class="stringliteral">&quot;/fsi_doc_fluid_mesh&quot;</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;               &lt;&lt; doc_info.number() &lt;&lt; <span class="stringliteral">&quot;.dat&quot;</span>;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;      some_file.open(<a class="code" href="../../d5/db2/namespaceMergeRestartFiles.html#a210231ed06d822ca8be83bd7f75aa572">filename</a>.str().c_str());</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;      fluid_mesh_pt-&gt;output(some_file, npts);</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;      some_file.close();</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160; </div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160; </div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;      <span class="comment">// Setup map that links the positional Data of SolidNodes with</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;      <span class="comment">//------------------------------------------------------------</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;      <span class="comment">// the nodes</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;      <span class="comment">//----------</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;      std::map&lt;Data*, Node*&gt; solid_node_pt;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;      <span class="keywordtype">unsigned</span> nnod = wall_mesh_pt-&gt;nnode();</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; nnod; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;      {</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        solid_node_pt[wall_mesh_pt-&gt;node_pt(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>)-&gt;variable_position_pt()] =</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;          wall_mesh_pt-&gt;node_pt(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;      }</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160; </div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160; </div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;      <span class="comment">// Setup map that links the internal (pressure) Data of fluid elements</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;      <span class="comment">// with</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;      <span class="comment">//-------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;      <span class="comment">// those fluid elements</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;      <span class="comment">//---------------------</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;      std::map&lt;Data*, FiniteElement*&gt; internal_data_element_pt;</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;      <span class="keywordtype">unsigned</span> nelemf = fluid_mesh_pt-&gt;nelement();</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; nelemf; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;      {</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;        <span class="keywordtype">unsigned</span> ninternal = fluid_mesh_pt-&gt;element_pt(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>)-&gt;ninternal_data();</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> = 0; <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> &lt; ninternal; <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>++)</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;        {</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;          internal_data_element_pt[fluid_mesh_pt-&gt;element_pt(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>)</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                                     -&gt;internal_data_pt(<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>)] =</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;            fluid_mesh_pt-&gt;finite_element_pt(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>);</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        }</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;      }</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160; </div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160; </div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;      <span class="comment">// External halo elements must also be included in this check</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;      std::set&lt;int&gt; procs = fluid_mesh_pt-&gt;external_halo_proc();</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;      <span class="keywordflow">for</span> (std::set&lt;int&gt;::iterator it = procs.begin(); it != procs.end(); it++)</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;      {</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;        <span class="keywordtype">unsigned</span> d = <a class="code" href="../../d0/d1d/classunsigned.html">unsigned</a>((*it));</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;        <span class="keywordtype">unsigned</span> n_ext_halo_f = fluid_mesh_pt-&gt;nexternal_halo_element(d);</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; n_ext_halo_f; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        {</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;          <span class="keywordtype">unsigned</span> ninternal =</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;            fluid_mesh_pt-&gt;external_halo_element_pt(d, <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>)-&gt;ninternal_data();</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> = 0; <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> &lt; ninternal; <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>++)</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;          {</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;            internal_data_element_pt[fluid_mesh_pt</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                                       -&gt;external_halo_element_pt(d, <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>)</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                                       -&gt;internal_data_pt(<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>)] =</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;              <span class="keyword">dynamic_cast&lt;</span>FiniteElement*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                fluid_mesh_pt-&gt;external_halo_element_pt(d, <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>));</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;          }</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        }</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;      }</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160; </div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160; </div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;      <span class="comment">// Loop over all wall elements</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;      <span class="comment">//----------------------------</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;      <span class="keywordtype">unsigned</span> nelem = wall_mesh_pt-&gt;nelement();</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; nelem; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;      {</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        <span class="comment">// Reset the string contents to be empty</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        <a class="code" href="../../d5/db2/namespaceMergeRestartFiles.html#a210231ed06d822ca8be83bd7f75aa572">filename</a>.str(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;        <span class="comment">// Set the new filename</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        <a class="code" href="../../d5/db2/namespaceMergeRestartFiles.html#a210231ed06d822ca8be83bd7f75aa572">filename</a> &lt;&lt; doc_info.directory() &lt;&lt; <span class="stringliteral">&quot;/fsi_doc_wall_element&quot;</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                 &lt;&lt; doc_info.number() &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt;&lt; <span class="stringliteral">&quot;.dat&quot;</span>;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        some_file.open(<a class="code" href="../../d5/db2/namespaceMergeRestartFiles.html#a210231ed06d822ca8be83bd7f75aa572">filename</a>.str().c_str());</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160; </div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        <span class="comment">// Get pointer to wall element</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        FSIWallElement* el_pt =</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;          <span class="keyword">dynamic_cast&lt;</span>FSIWallElement*<span class="keyword">&gt;</span>(wall_mesh_pt-&gt;finite_element_pt(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>));</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160; </div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;        <span class="comment">// If it&#39;s a halo element then it will not have set an adjacent</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;        <span class="comment">// fluid element so there&#39;s no point trying to output it!</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;        <span class="keywordflow">if</span> (!el_pt-&gt;is_halo())</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;        {</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160; </div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;          <span class="comment">// Storage for local and global coords</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;          <span class="keywordtype">unsigned</span> ndim_local = el_pt-&gt;dim();</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;          Vector&lt;double&gt; <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>(ndim_local);</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;          <span class="keywordtype">unsigned</span> ndim_eulerian = el_pt-&gt;nodal_dimension();</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;          Vector&lt;double&gt; <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>(ndim_eulerian);</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160; </div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160; </div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;          <span class="comment">// Map to indicate if the internal Data for a given</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;          <span class="comment">// fluid element has been plotted already</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;          std::map&lt;FiniteElement*, bool&gt; element_internal_data_has_been_plotted;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160; </div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;          <span class="comment">// Loop over Gauss points and doc their position</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;          <span class="comment">//-----------------------------------------------</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;          <span class="keywordtype">unsigned</span> nint = el_pt-&gt;integral_pt()-&gt;nweight();</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;          some_file &lt;&lt; <span class="stringliteral">&quot;ZONE I=&quot;</span> &lt;&lt; nint &lt;&lt; std::endl;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; nint; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;          {</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; ndim_local; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;            {</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;              <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>] = el_pt-&gt;integral_pt()-&gt;knot(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;            }</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;            el_pt-&gt;interpolated_x(<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>, <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>);</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; ndim_eulerian; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;            {</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;              some_file &lt;&lt; <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;            }</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;            some_file &lt;&lt; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;          }</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160; </div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160; </div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;          <span class="comment">// Loop over Gauss points again to find corresponding points in fluid</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;          <span class="comment">//--------------------------------------------------------------------</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;          <span class="comment">// elements</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;          <span class="comment">//---------</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160; </div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;          <span class="comment">// Loop over front and back if required: Get number of fluid-loaded</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;          <span class="comment">// faces</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;          <span class="keywordtype">unsigned</span> n_loaded_face = 2;</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;          <span class="keywordflow">if</span> (el_pt-&gt;only_front_is_loaded_by_fluid()) n_loaded_face = 1;</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160; </div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> face = 0; face &lt; n_loaded_face; face++)</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;          {</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;            some_file &lt;&lt; <span class="stringliteral">&quot;ZONE I=&quot;</span> &lt;&lt; nint &lt;&lt; std::endl;</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; nint; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;            {</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;              <span class="comment">// Get corresponding fluid element</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;              FSIFluidElement* fluid_el_pt = <span class="keyword">dynamic_cast&lt;</span>FSIFluidElement*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                el_pt-&gt;external_element_pt(face, <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160; </div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;              <span class="comment">// Get local coordinates in fluid element by copy operation</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;              Vector&lt;double&gt; s_fluid(</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                el_pt-&gt;external_element_local_coord(face, <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160; </div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;              <span class="comment">// Get Eulerian position in fluid element</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;              fluid_el_pt-&gt;interpolated_x(s_fluid, <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>);</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; ndim_eulerian; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;              {</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                some_file &lt;&lt; <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;              }</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;              some_file &lt;&lt; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;            }</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;          }</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160; </div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160; </div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;          <span class="comment">// Get the multiplicity of data that affects the load on this wall</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;          <span class="comment">// element</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;          <span class="comment">//------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;          std::map&lt;Data*, unsigned&gt; data_count;</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;          std::map&lt;FiniteElement*, unsigned&gt; internal_data_count;</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;          {</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;            Vector&lt;Data*&gt; external_interaction_field_data_pt(</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;              el_pt-&gt;external_interaction_field_data_pt());</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;            <span class="keywordtype">unsigned</span> nexternal_interaction_field =</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;              external_interaction_field_data_pt.size();</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> l = 0; l &lt; nexternal_interaction_field; l++)</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;            {</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;              data_count[external_interaction_field_data_pt[l]]++;</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;              <span class="keywordflow">if</span> (internal_data_element_pt</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                    [external_interaction_field_data_pt[l]] != 0)</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;              {</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                internal_data_count</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                  [internal_data_element_pt</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                     [external_interaction_field_data_pt[l]]]++;</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;              }</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;            }</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;          }</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160; </div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;          {</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;            Vector&lt;Data*&gt; external_interaction_geometric_data_pt(</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;              el_pt-&gt;external_interaction_geometric_data_pt());</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;            <span class="keywordtype">unsigned</span> nexternal_interaction_geom =</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;              external_interaction_geometric_data_pt.size();</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> l = 0; l &lt; nexternal_interaction_geom; l++)</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;            {</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;              data_count[external_interaction_geometric_data_pt[l]]++;</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;              <span class="keywordflow">if</span> (internal_data_element_pt</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;                    [external_interaction_geometric_data_pt[l]] != 0)</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;              {</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                internal_data_count</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                  [internal_data_element_pt</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                     [external_interaction_geometric_data_pt[l]]]++;</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;              }</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;            }</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;          }</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160; </div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;          <span class="comment">// Loop over unique data entries</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;          <span class="comment">//------------------------------</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;          <span class="keywordflow">for</span> (std::map&lt;Data*, unsigned&gt;::iterator it = data_count.begin();</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;               it != data_count.end();</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;               it++)</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;          {</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;            Data* unique_data_pt = it-&gt;first;</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160; </div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;            <span class="comment">// Try to cast to a Node</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;            <span class="comment">//----------------------</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;            Node* node_pt = <span class="keyword">dynamic_cast&lt;</span>Node*<span class="keyword">&gt;</span>(unique_data_pt);</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;            <span class="keywordflow">if</span> (node_pt == 0)</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;            {</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;              <span class="comment">// Is it a solid node? NOTE: This query makes sense as we&#39;re</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;              <span class="comment">//----------------------------------------------------------</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;              <span class="comment">// checking for the SolidNode&#39;s *positional* Data, not for</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;              <span class="comment">//--------------------------------------------------------</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;              <span class="comment">// the SolidNode itself!</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;              <span class="comment">//----------------------</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;              <span class="keywordflow">if</span> (solid_node_pt[unique_data_pt] != 0)</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;              {</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                some_file &lt;&lt; <span class="stringliteral">&quot;TEXT &quot;</span>;</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; ndim_eulerian; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                {</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                  some_file &lt;&lt; <a class="code" href="../../de/d6c/namespaceUniformPSDSelfTest.html#a8e741d2bbc81a8911d991b685bdecbde">label</a>[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>] &lt;&lt; solid_node_pt[unique_data_pt]-&gt;x(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>)</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;                }</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160; </div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                some_file &lt;&lt; <span class="stringliteral">&quot;CS=GRID, HU=FRAME, H=2.5, AN=MIDCENTER, C=GREEN &quot;</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;                          &lt;&lt; <span class="stringliteral">&quot;T=\&quot;&quot;</span> &lt;&lt; it-&gt;second &lt;&lt; <span class="stringliteral">&quot;\&quot;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;              }</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160; </div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;              <span class="comment">// Is it internal (pressure) Data in a fluid element?</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;              <span class="comment">//---------------------------------------------------</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (internal_data_element_pt[unique_data_pt] != 0)</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;              {</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;                <span class="keywordflow">if</span> (!element_internal_data_has_been_plotted</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                      [internal_data_element_pt[unique_data_pt]])</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                {</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                  some_file &lt;&lt; <span class="stringliteral">&quot;TEXT &quot;</span>;</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                  <span class="comment">// Pointer to fluid element that contains this internal data</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                  FiniteElement* fluid_el_pt =</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;                    internal_data_element_pt[unique_data_pt];</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160; </div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                  <span class="comment">// Get the plot coordinates in this element: centre + a bit of</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                  <span class="comment">// offset</span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;                  <span class="keywordtype">double</span> s_max = fluid_el_pt-&gt;s_max();</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;                  <span class="keywordtype">double</span> s_min = fluid_el_pt-&gt;s_min();</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;                  Vector&lt;double&gt; s_fluid(ndim_eulerian);</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;                  Vector&lt;double&gt; x_fluid(ndim_eulerian);</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> = 0; <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> &lt; ndim_eulerian; <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>++)</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                  {</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;                    s_fluid[<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>] = 0.5 * (s_max + s_min) + 0.1 * (s_max - s_min);</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;                  }</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;                  fluid_el_pt-&gt;interpolated_x(s_fluid, x_fluid);</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; ndim_eulerian; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;                  {</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                    some_file &lt;&lt; <a class="code" href="../../de/d6c/namespaceUniformPSDSelfTest.html#a8e741d2bbc81a8911d991b685bdecbde">label</a>[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>] &lt;&lt; x_fluid[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;                  }</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160; </div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;                  some_file &lt;&lt; <span class="stringliteral">&quot;CS=GRID, HU=FRAME, H=2.5, AN=MIDCENTER, C=BLUE &quot;</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;T=\&quot;&quot;</span> &lt;&lt; it-&gt;second</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot;\&quot;&quot;</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;                            <span class="comment">// internal_data_count[fluid_el_pt]</span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;                            &lt;&lt; std::endl;</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160; </div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;                  <span class="comment">// Now we have plotted it....</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;                  element_internal_data_has_been_plotted</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;                    [internal_data_element_pt[unique_data_pt]] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                }</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;              }</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;              <span class="keywordflow">else</span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;              {</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;                std::ostringstream error_message;</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                error_message</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;Data that affects the load on an FSIWallElement\n&quot;</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;is neither a (fluid) Node, nor a SolidNode nor\n&quot;</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;internal Data in a (fluid) element\n&quot;</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;I don&#39;t think this should happen...&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;                <span class="keywordflow">throw</span> OomphLibError(error_message.str(),</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;                                    <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;                                    <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;              }</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;            }</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;            <span class="comment">// It must be a node then</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;            <span class="comment">//-----------------------</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;            {</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;              some_file &lt;&lt; <span class="stringliteral">&quot;TEXT &quot;</span>;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; ndim_eulerian; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;              {</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                some_file &lt;&lt; <a class="code" href="../../de/d6c/namespaceUniformPSDSelfTest.html#a8e741d2bbc81a8911d991b685bdecbde">label</a>[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>] &lt;&lt; node_pt-&gt;x(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;              }</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;              some_file &lt;&lt; <span class="stringliteral">&quot;CS=GRID, HU=FRAME, H=2.5, AN=MIDCENTER, C=RED &quot;</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot;T=\&quot;&quot;</span> &lt;&lt; it-&gt;second &lt;&lt; <span class="stringliteral">&quot;\&quot;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;            }</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;          }</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160; </div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;        } <span class="comment">// end is_halo()</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;        some_file.close();</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;      }</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160; </div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;      <span class="comment">// Part 2: Doc which dofs affect the node update functions</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;      <span class="comment">//========================================================</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160; </div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160; </div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;      <span class="comment">// Counter for the number of nodes that are actually</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;      <span class="comment">// affected by wall motion</span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;      <span class="keywordtype">unsigned</span> count = 0;</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160; </div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;      <span class="comment">// Loop over nodes in fluid mesh</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;      <span class="keywordtype">unsigned</span> nnode_fluid = fluid_mesh_pt-&gt;nnode();</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; nnode_fluid; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;      {</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;        <span class="comment">// Upcast node to appropriate type</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;        NODE* node_pt = <span class="keyword">dynamic_cast&lt;</span>NODE*<span class="keyword">&gt;</span>(fluid_mesh_pt-&gt;node_pt(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>));</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160; </div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        <span class="keywordtype">unsigned</span> ndim_eulerian = node_pt-&gt;ndim();</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160; </div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;        <span class="comment">// Cleart the filename</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;        <a class="code" href="../../d5/db2/namespaceMergeRestartFiles.html#a210231ed06d822ca8be83bd7f75aa572">filename</a>.str(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;        <a class="code" href="../../d5/db2/namespaceMergeRestartFiles.html#a210231ed06d822ca8be83bd7f75aa572">filename</a> &lt;&lt; doc_info.directory() &lt;&lt; <span class="stringliteral">&quot;/fsi_doc_fluid_element&quot;</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;                 &lt;&lt; doc_info.number() &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; count &lt;&lt; <span class="stringliteral">&quot;.dat&quot;</span>;</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;        some_file.open(<a class="code" href="../../d5/db2/namespaceMergeRestartFiles.html#a210231ed06d822ca8be83bd7f75aa572">filename</a>.str().c_str());</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;        some_file &lt;&lt; <span class="stringliteral">&quot;ZONE&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; ndim_eulerian; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;        {</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;          some_file &lt;&lt; node_pt-&gt;x(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;        }</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;        some_file &lt;&lt; std::endl;</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160; </div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;        <span class="comment">// Extract geom objects that affect the nodal position</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        Vector&lt;GeomObject*&gt; geom_obj_pt(node_pt-&gt;vector_geom_object_pt());</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160; </div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160; </div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;        <span class="comment">// Get the multiplicity of data that affects this node</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;        <span class="comment">//----------------------------------------------------</span></div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;        std::map&lt;Data*, unsigned&gt; data_count;</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;        <span class="keywordtype">unsigned</span> ngeom = geom_obj_pt.size();</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; ngeom; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;        {</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;          <span class="keywordtype">unsigned</span> ngeom_dat = geom_obj_pt[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;ngeom_data();</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> = 0; <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> &lt; ngeom_dat; <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>++)</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;          {</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;            data_count[geom_obj_pt[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;geom_data_pt(<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>)]++;</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;          }</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;        }</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160; </div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;        <span class="comment">// Haven&#39;t actually doced any dependcies for this node</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;        <span class="keywordtype">bool</span> written_something = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160; </div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;        <span class="comment">// Loop over unique data entries</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;        <span class="comment">//------------------------------</span></div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;        <span class="keywordflow">for</span> (std::map&lt;Data*, unsigned&gt;::iterator it = data_count.begin();</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;             it != data_count.end();</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;             it++)</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;        {</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;          Data* unique_data_pt = it-&gt;first;</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160; </div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;          <span class="comment">// Is it a solid node?</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;          <span class="keywordflow">if</span> (solid_node_pt[unique_data_pt] != 0)</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;          {</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;            some_file &lt;&lt; <span class="stringliteral">&quot;TEXT &quot;</span>;</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; ndim_eulerian; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;            {</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;              some_file &lt;&lt; <a class="code" href="../../de/d6c/namespaceUniformPSDSelfTest.html#a8e741d2bbc81a8911d991b685bdecbde">label</a>[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>] &lt;&lt; solid_node_pt[unique_data_pt]-&gt;x(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>)</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;            }</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160; </div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;            some_file &lt;&lt; <span class="stringliteral">&quot;CS=GRID, HU=FRAME, H=2.5, AN=MIDCENTER, C=GREEN &quot;</span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;T=\&quot;&quot;</span> &lt;&lt; unique_data_pt-&gt;nvalue() &lt;&lt; <span class="stringliteral">&quot;\&quot;&quot;</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;                      &lt;&lt; std::endl;</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160; </div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;            <span class="comment">// We&#39;ve actually produced some output</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;            written_something = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;          }</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;          <span class="comment">// It&#39;s not a solid node --&gt; ??</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;          {</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;            std::ostringstream warn_message;</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;            warn_message</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;Info: Position of a fluid node is affected by Data that&quot;</span></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;is not a SolidNode --&gt; Can&#39;t plot this Data. \n\n&quot;</span></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;(You may also want to check if this is exepcted or likely &quot;</span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;                 <span class="stringliteral">&quot;to\n&quot;</span></div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;indicate a bug in your code...)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;            <span class="keywordflow">throw</span> OomphLibWarning(warn_message.str(),</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;                                  <span class="stringliteral">&quot;FSI_functions::doc_fsi()&quot;</span>,</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;                                  <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;          }</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;        }</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160; </div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160; </div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;        some_file.close();</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160; </div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;        <span class="comment">// If we&#39;ve written something for the last node, bump up</span></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;        <span class="comment">// counter for file so we don&#39;t overwrite</span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;        <span class="keywordflow">if</span> (written_something) count++;</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;      }</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160; </div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    } <span class="comment">// end_of_doc_fsi</span></div>
<div class="ttc" id="aCwise__array__power__array_8cpp_html_a9eb5e92d9d691c1393e5e7c914731dbf"><div class="ttname"><a href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a></div><div class="ttdeci">Array&lt; double, 1, 3 &gt; e(1./3., 0.5, 2.)</div></div>
<div class="ttc" id="aclassunsigned_html"><div class="ttname"><a href="../../d0/d1d/classunsigned.html">unsigned</a></div></div>
<div class="ttc" id="alevel1__cplx__impl_8h_html_a462761ca92ad97a9a705cb875828b0b8"><div class="ttname"><a href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a></div><div class="ttdeci">RealScalar s</div><div class="ttdef"><b>Definition:</b> level1_cplx_impl.h:130</div></div>
<div class="ttc" id="alevel2__impl_8h_html_ad46ea6bf5745e72b985b11878e46a45d"><div class="ttname"><a href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a></div><div class="ttdeci">char char char int int * k</div><div class="ttdef"><b>Definition:</b> level2_impl.h:374</div></div>
<div class="ttc" id="anamespaceMergeRestartFiles_html_a210231ed06d822ca8be83bd7f75aa572"><div class="ttname"><a href="../../d5/db2/namespaceMergeRestartFiles.html#a210231ed06d822ca8be83bd7f75aa572">MergeRestartFiles.filename</a></div><div class="ttdeci">string filename</div><div class="ttdef"><b>Definition:</b> MergeRestartFiles.py:39</div></div>
<div class="ttc" id="anamespaceUniformPSDSelfTest_html_a8e741d2bbc81a8911d991b685bdecbde"><div class="ttname"><a href="../../de/d6c/namespaceUniformPSDSelfTest.html#a8e741d2bbc81a8911d991b685bdecbde">UniformPSDSelfTest.label</a></div><div class="ttdeci">label</div><div class="ttdef"><b>Definition:</b> UniformPSDSelfTest.py:24</div></div>
<div class="ttc" id="anamespaceplotDoE_html_a4758fc6194247f040938f29c863d21ee"><div class="ttname"><a href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">plotDoE.x</a></div><div class="ttdeci">list x</div><div class="ttdef"><b>Definition:</b> plotDoE.py:28</div></div>
<div class="ttc" id="aoomph__definitions_8h_html_a25c6813cc7341d125e2502f8923fb6c4"><div class="ttname"><a href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a></div><div class="ttdeci">#define OOMPH_EXCEPTION_LOCATION</div><div class="ttdef"><b>Definition:</b> oomph_definitions.h:61</div></div>
<div class="ttc" id="aoomph__definitions_8h_html_aa260cc4af589e30cea7fde997ae16667"><div class="ttname"><a href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a></div><div class="ttdeci">#define OOMPH_CURRENT_FUNCTION</div><div class="ttdef"><b>Definition:</b> oomph_definitions.h:86</div></div>
<div class="ttc" id="atut__arithmetic__redux__minmax_8cpp_html_a39513f0f8d942bf9ef17b2e87ac6d34e"><div class="ttname"><a href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a></div><div class="ttdeci">std::ptrdiff_t j</div><div class="ttdef"><b>Definition:</b> tut_arithmetic_redux_minmax.cpp:2</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">oomph::FiniteElement::dim()</a>, <a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html#a85d58bcfce0a7b7cae461624e6fcd08a">oomph::DocInfo::directory()</a>, <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">oomph::Mesh::element_pt()</a>, <a class="el" href="../../dd/d48/classoomph_1_1ElementWithExternalElement.html#a0f4b305e2da000ad7523ab02163c36cb">oomph::ElementWithExternalElement::external_element_local_coord()</a>, <a class="el" href="../../dd/d48/classoomph_1_1ElementWithExternalElement.html#a30c8347cfed1bb9d4ebc500f705bc739">oomph::ElementWithExternalElement::external_element_pt()</a>, <a class="el" href="../../dd/d48/classoomph_1_1ElementWithExternalElement.html#a7d6b40e7100178b1edbb94f179555a34">oomph::ElementWithExternalElement::external_interaction_field_data_pt()</a>, <a class="el" href="../../dd/d48/classoomph_1_1ElementWithExternalElement.html#ad9632a0a9391964020177d3507261545">oomph::ElementWithExternalElement::external_interaction_geometric_data_pt()</a>, <a class="el" href="../../d5/db2/namespaceMergeRestartFiles.html#a210231ed06d822ca8be83bd7f75aa572">MergeRestartFiles::filename</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a4f274774435e9454bf77bf70de69367a">oomph::Mesh::finite_element_pt()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a751dc02ff1325f799840d79ee415753a">oomph::FiniteElement::integral_pt()</a>, <a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a45e32d895d4b3686e0f15fe455f4ed44">oomph::GeneralisedElement::internal_data_pt()</a>, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a4a011bbbef38e7ed244f699577f46b4a">oomph::FiniteElement::interpolated_x()</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>, <a class="el" href="../../de/d70/classoomph_1_1Integral.html#a1a2122f99a87c18649bafdd9ed739758">oomph::Integral::knot()</a>, <a class="el" href="../../de/d6c/namespaceUniformPSDSelfTest.html#a8e741d2bbc81a8911d991b685bdecbde">UniformPSDSelfTest::label</a>, <a class="el" href="../../dc/db7/classoomph_1_1Node.html#a786c96a8e46eb27a03b2b31f629d41b3">oomph::Node::ndim()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">oomph::Mesh::nelement()</a>, <a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a6b736de0af4c92831968636479b3480e">oomph::GeneralisedElement::ninternal_data()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a945e7823d1a2af243b5b7f7866aaff5e">oomph::Mesh::nnode()</a>, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#ab6602b43c3a2f1a5e48729b0b23c0d91">oomph::FiniteElement::nodal_dimension()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">oomph::Mesh::node_pt()</a>, <a class="el" href="../../da/d73/classoomph_1_1SolidMesh.html#a8b096888d09593a6cdec9ede72eb5850">oomph::SolidMesh::node_pt()</a>, <a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html#af27224b25da5b758442753f0947e62d4">oomph::DocInfo::number()</a>, <a class="el" href="../../d8/dc5/classoomph_1_1Data.html#a7e67fc78a2e8a2fd6eb75bd292d42ff8">oomph::Data::nvalue()</a>, <a class="el" href="../../de/d70/classoomph_1_1Integral.html#a1a270de9d99a1fcf1d25a6c1017f65fa">oomph::Integral::nweight()</a>, <a class="el" href="../../d6/d5b/classoomph_1_1FSIWallElement.html#a5ba035695fb6a51b65280779ff65277b">oomph::FSIWallElement::only_front_is_loaded_by_fluid()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#aab74388e8e21325f3ca26f1bd99c26f7">oomph::Mesh::output()</a>, <a class="el" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a64adbe9356927133686ab53f00341ea8">oomph::FiniteElement::s_max()</a>, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a35f0803115b68bd162c07de04eeb6c5c">oomph::FiniteElement::s_min()</a>, <a class="el" href="../../dc/dfd/classoomph_1_1SolidNode.html#ae9a8abd197728f5555730131fa0f6971">oomph::SolidNode::variable_position_pt()</a>, <a class="el" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">plotDoE::x</a>, and <a class="el" href="../../dc/db7/classoomph_1_1Node.html#a056f8e82da938369cd38541c5cdc598a">oomph::Node::x()</a>.</p>

</div>
</div>
<a id="adccd22c19d99eabffd72f7671df49598"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adccd22c19d99eabffd72f7671df49598">&#9670;&nbsp;</a></span>setup_fluid_load_info_for_solid_elements() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class FLUID_ELEMENT , unsigned DIM_FLUID&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void oomph::FSI_functions::setup_fluid_load_info_for_solid_elements </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *&#160;</td>
          <td class="paramname"><em>problem_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>boundary_in_fluid_mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;&#160;</td>
          <td class="paramname"><em>fluid_mesh_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;&#160;</td>
          <td class="paramname"><em>solid_mesh_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>face</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set up the information that the FSIWallElements in the specified solid mesh require to obtain the fluid loading from the adjacent fluid elements in the specified fluid mesh. The parameter b specifies the boundary in the fluid mesh that is adjacent to the solid mesh. The template parameters specify the type of the fluid element and their spatial dimension. The optional final argument, face, identifies the face of the FSIWallElements that is exposed to the fluid. face defaults to 0, indicating that the front is loaded along the specified fluid mesh boundary. Set it to 1 to set up the FSI lookup schemes for fluid loading along the "back" of the FSIWallElements. This routine uses the procedures in the Multi_domain_functions namespace to set up the interaction by locating the adjacent (source) elements for each integration point of each solid element </p>
<div class="fragment"><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    {</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;      <span class="comment">// Thin wrapper to multi-domain function</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a35d48459a5261d565afbc106cb61fe60">Multi_domain_functions::setup_bulk_elements_adjacent_to_face_mesh</a>&lt;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        <a class="code" href="../../da/d1b/inclined__plane_8cc.html#a7dd75bf91164c5233c7d127da912bc43">FLUID_ELEMENT</a>,</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        DIM_FLUID&gt;(</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        problem_pt, boundary_in_fluid_mesh, fluid_mesh_pt, solid_mesh_pt, face);</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    }</div>
<div class="ttc" id="ainclined__plane_8cc_html_a7dd75bf91164c5233c7d127da912bc43"><div class="ttname"><a href="../../da/d1b/inclined__plane_8cc.html#a7dd75bf91164c5233c7d127da912bc43">FLUID_ELEMENT</a></div><div class="ttdeci">#define FLUID_ELEMENT</div></div>
<div class="ttc" id="anamespaceoomph_1_1Multi__domain__functions_html_a35d48459a5261d565afbc106cb61fe60"><div class="ttname"><a href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a35d48459a5261d565afbc106cb61fe60">oomph::Multi_domain_functions::setup_bulk_elements_adjacent_to_face_mesh</a></div><div class="ttdeci">void setup_bulk_elements_adjacent_to_face_mesh(Problem *problem_pt, Vector&lt; unsigned &gt; &amp;boundary_in_bulk_mesh, Mesh *const &amp;bulk_mesh_pt, Vector&lt; Mesh * &gt; &amp;face_mesh_pt, const unsigned &amp;interaction=0)</div><div class="ttdoc">/ Templated helper functions for multi-domain methods using locate_zeta</div><div class="ttdef"><b>Definition:</b> multi_domain.template.cc:72</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../da/d1b/inclined__plane_8cc.html#a7dd75bf91164c5233c7d127da912bc43">FLUID_ELEMENT</a>, and <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a35d48459a5261d565afbc106cb61fe60">oomph::Multi_domain_functions::setup_bulk_elements_adjacent_to_face_mesh()</a>.</p>

</div>
</div>
<a id="ac71732700aad0d671fa1285d173d5b27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac71732700aad0d671fa1285d173d5b27">&#9670;&nbsp;</a></span>setup_fluid_load_info_for_solid_elements() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class FLUID_ELEMENT , unsigned DIM_FLUID&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void oomph::FSI_functions::setup_fluid_load_info_for_solid_elements </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *&#160;</td>
          <td class="paramname"><em>problem_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>boundary_in_fluid_mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;&#160;</td>
          <td class="paramname"><em>fluid_mesh_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>solid_mesh_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>face</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set up the information that the FSIWallElements in the specified solid mesh require to obtain the fluid loading from the adjacent fluid elements in the specified fluid mesh. The parameter b specifies the boundary in the fluid mesh that is adjacent to the solid mesh. The template parameters specify the type of the fluid element and their spatial dimension. The optional final argument, face, identifies the face of the FSIWallElements that is exposed to the fluid. face defaults to 0, indicating that the front is loaded along the specified fluid mesh boundary. Set it to 1 to set up the FSI lookup schemes for fluid loading along the "back" of the FSIWallElements. This routine uses the procedures in the Multi_domain_functions namespace to set up the interaction by locating the adjacent (source) elements for each integration point of each solid element</p>
<p>This is the vector based version it works simultaneously on fluid fsi boundaries identified in the vector boundary_in_fluid_mesh and the corresponding solid meshes in solid_mesh_pt. </p>
<div class="fragment"><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    {</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;      <span class="comment">// Thin wrapper to multi-domain function</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;      <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a35d48459a5261d565afbc106cb61fe60">Multi_domain_functions::setup_bulk_elements_adjacent_to_face_mesh</a>&lt;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        <a class="code" href="../../da/d1b/inclined__plane_8cc.html#a7dd75bf91164c5233c7d127da912bc43">FLUID_ELEMENT</a>,</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        DIM_FLUID&gt;(</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        problem_pt, boundary_in_fluid_mesh, fluid_mesh_pt, solid_mesh_pt, face);</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../da/d1b/inclined__plane_8cc.html#a7dd75bf91164c5233c7d127da912bc43">FLUID_ELEMENT</a>, and <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a35d48459a5261d565afbc106cb61fe60">oomph::Multi_domain_functions::setup_bulk_elements_adjacent_to_face_mesh()</a>.</p>

</div>
</div>
<a id="ad638257ef97a089f5367edf5d2911e60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad638257ef97a089f5367edf5d2911e60">&#9670;&nbsp;</a></span>setup_solid_elements_for_displacement_bc() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class SOLID_ELEMENT , unsigned DIM_SOLID&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void oomph::FSI_functions::setup_solid_elements_for_displacement_bc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *&#160;</td>
          <td class="paramname"><em>problem_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>b_solid_fsi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;&#160;</td>
          <td class="paramname"><em>solid_mesh_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;&#160;</td>
          <td class="paramname"><em>lagrange_multiplier_mesh_pt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Setup multi-domain interaction required for imposition of solid displacements onto the pseudo-solid fluid mesh by Lagrange multipliers: This function locates the bulk solid elements next to boundary b_solid_fsi (the FSI boundary) in the solid mesh pointed to by Solid_mesh_pt. The deformation of these elements drives the deformation of the pseudo-solid fluid mesh via the Lagrange multiplier elements stored in l lagrange_multiplier_mesh_pt. The template parameters specify the type of the bulk solid elements and their spatial dimension. </p>
<div class="fragment"><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    {</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;      <span class="comment">// Thin wrapper to multi-domain function</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;      <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a35d48459a5261d565afbc106cb61fe60">Multi_domain_functions::setup_bulk_elements_adjacent_to_face_mesh</a>&lt;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        SOLID_ELEMENT,</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        DIM_SOLID&gt;(</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        problem_pt, b_solid_fsi, solid_mesh_pt, lagrange_multiplier_mesh_pt, 0);</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a35d48459a5261d565afbc106cb61fe60">oomph::Multi_domain_functions::setup_bulk_elements_adjacent_to_face_mesh()</a>.</p>

</div>
</div>
<a id="aacfff5c6e8f9ee75e7d2ae490d28fb7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacfff5c6e8f9ee75e7d2ae490d28fb7b">&#9670;&nbsp;</a></span>setup_solid_elements_for_displacement_bc() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class SOLID_ELEMENT , unsigned DIM_SOLID&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void oomph::FSI_functions::setup_solid_elements_for_displacement_bc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *&#160;</td>
          <td class="paramname"><em>problem_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>b_solid_fsi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;&#160;</td>
          <td class="paramname"><em>solid_mesh_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>lagrange_multiplier_mesh_pt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Setup multi-domain interaction required for imposition of solid displacements onto the pseudo-solid fluid mesh by Lagrange multipliers: This function locates the bulk solid elements next to boundary b_solid_fsi (the FSI boundary) in the solid mesh pointed to by Solid_mesh_pt. The deformation of these elements drives the deformation of the pseudo-solid fluid mesh via the Lagrange multiplier elements stored in lagrange_multiplier_mesh_pt. The template parameters specify the type of the bulk solid elements and their spatial dimension.</p>
<p>This is the vector based version it works simultaneously on solid fsi boundaries identified in the vector b_solid_fsi and the corresponding Lagrange multiplier meshes in lagrange_multiplier_mesh_pt. </p>
<div class="fragment"><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    {</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;      <span class="comment">// Thin wrapper to multi-domain function</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;      <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a35d48459a5261d565afbc106cb61fe60">Multi_domain_functions::setup_bulk_elements_adjacent_to_face_mesh</a>&lt;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        SOLID_ELEMENT,</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        DIM_SOLID&gt;(</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        problem_pt, b_solid_fsi, solid_mesh_pt, lagrange_multiplier_mesh_pt, 0);</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a35d48459a5261d565afbc106cb61fe60">oomph::Multi_domain_functions::setup_bulk_elements_adjacent_to_face_mesh()</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="aa213854665524b0720b63a115ef57fd8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa213854665524b0720b63a115ef57fd8">&#9670;&nbsp;</a></span>Strouhal_for_no_slip</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a> oomph::FSI_functions::Strouhal_for_no_slip = 1.0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Strouhal number St = a/(UT) for application of no slip condition. Initialised to 1.0. </p>

<p class="reference">Referenced by <a class="el" href="../../d2/d39/namespaceoomph_1_1FSI__functions.html#ac1a95cf31d719f6aeceb72554ee75868">apply_no_slip_on_moving_wall()</a>, <a class="el" href="../../d1/dfc/classTurekProblem.html#a69f6624fd854393f0c0e5303603ec749">TurekProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;::TurekProblem()</a>, and <a class="el" href="../../dc/d83/classFlowAroundCylinderProblem.html#a708d3f62ee5f97cc62f1e87da8eb26b2">FlowAroundCylinderProblem&lt; ELEMENT &gt;::unsteady_simulation()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../da/ddf/namespaceoomph.html">oomph</a></li><li class="navelem"><a class="el" href="../../d2/d39/namespaceoomph_1_1FSI__functions.html">FSI_functions</a></li>
    <li class="footer">Generated on Wed Aug 27 2025 17:09:39 for MercuryDPM by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
