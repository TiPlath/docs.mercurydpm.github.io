<!-- HTML header for doxygen 1.8.18-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MercuryDPM: Free cooling granular system (3D)</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../MDPM.css" rel="stylesheet" type="text/css"/>
<link href="../../codeLabels.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-fork-corner.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-dropdown-version.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../MDPM-fragment-copy-button.js"></script>
<script type="text/javascript">
DoxygenAwesomeFragmentCopyButton.init()
</script>
<script type="text/javascript" src="../../MDPM-paragraph-link.js"></script>
<script type="text/javascript">
DoxygenAwesomeParagraphLink.init()
</script>
<script type="text/javascript" src="../../MDPM-interactive-toc.js"></script>
<script type="text/javascript">
DoxygenAwesomeInteractiveToc.init()
</script>
<script type="text/javascript" src="../../MDPM-darkmode-toggle.js"></script>
<script type="text/javascript">
DoxygenAwesomeDarkModeToggle.init()
</script>
</head>
<body>
  <div id="bitbucket-corner">
   <a href="https://bitbucket.org/mercurydpm/mercurydpm/src/master/" target="_blank" id="fork-corner" class="fork-corner fc-pos-tr fc-animate fc-theme-bitbucket"></a>
  </div>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../mercury-logo-chosen-light-slogan.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"> <!--MercuryDPM--!>
   <!-- BEGIN version select -->
   <div class="dropdown" id="projectnumber">
    <button class="dropbtn">v1.0</button>
    <div class="dropdown-content">
    </div>
   </div>
   <script type="text/javascript" src="../../MDPM-dropdown-version.js"></script>
<!-- END version select -->
   <!--&#160;<span id="projectnumber">revision: v1.0</span>-->
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<script type="text/javascript" src="../../MDPM-fork-corner.js"></script>
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d2/dfa/FreeCooling3DDemo.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Free cooling granular system (3D) </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h4><a class="anchor" id="autotoc_md119"></a>
Model/Simulation:</h4>
<p>The homogeneous and inhomogeneous regimes of a free cooling granular system (3D) are simulated. Just like the <a class="el" href="../../d1/d52/FreeCoolingDemo.html">Free cooling granular system (2D)</a>, particles are initially randomized with a large kinetic energy and collisions occur dissipatively. This model is common in the study of the kinetic theory of granular gases [1-3].</p>
<p>Below, a short ParaView animation of the 3D free cooling demo is shown.</p>
<p> 
<br><iframe width="600" height="600" src="https://www.youtube.com/embed/sjpNRJ34iH4" frameborder="0" allowfullscreen></iframe>
</p>
<h4><a class="anchor" id="autotoc_md120"></a>
Simulation set up:</h4>
<p>In the animation, the simulation volume consists of a box with equal side length and periodic boundary conditions in three dimensions (3D). Just like the 2D demo case (<a class="el" href="../../d1/d52/FreeCoolingDemo.html">Free cooling granular system (2D)</a>), the initial state with random particle positions and velocities is prepared in the following way:</p>
<ol type="1">
<li>The particles first sit on a regular lattice and get a random velocity with a total momentum of zero.</li>
<li>Then the simulation is started without dissipation and runs for a reasonable number of collisions per particle so that the system becomes homogeneous, "and the velocity distribution approaches
a Maxwellian."</li>
<li>The above state is then used as the initial configuration for the dissipative regimes.</li>
</ol>
<p>The FreeCooling3DDemo class inherits from the Mercury3D class. </p><div class="fragment"><div class="line"><span class="keyword">class </span><a class="code" href="../../dd/da0/classFreeCooling3DDemoProblem.html">FreeCooling3DDemoProblem</a> : <span class="keyword">public</span> <a class="code" href="../../d3/db1/classMercury3D.html">Mercury3D</a> </div>
<div class="ttc" id="aclassFreeCooling3DDemoProblem_html"><div class="ttname"><a href="../../dd/da0/classFreeCooling3DDemoProblem.html">FreeCooling3DDemoProblem</a></div><div class="ttdoc">[FCD_3D:headers]</div><div class="ttdef"><b>Definition:</b> FreeCooling3DDemo.cpp:22</div></div>
<div class="ttc" id="aclassMercury3D_html"><div class="ttname"><a href="../../d3/db1/classMercury3D.html">Mercury3D</a></div><div class="ttdoc">This adds on the hierarchical grid code for 3D problems.</div><div class="ttdef"><b>Definition:</b> Mercury3D.h:16</div></div>
</div><!-- fragment --><p>Thus, the following headers are included: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../da/d68/LinearViscoelasticSpecies_8h.html">Species/LinearViscoelasticSpecies.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../d0/d17/PeriodicBoundary_8h.html">Boundaries/PeriodicBoundary.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../d8/d02/Mercury3D_8h.html">Mercury3D.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../df/dbd/MercuryTime_8h.html">MercuryTime.h</a>&quot;</span></div>
<div class="ttc" id="aLinearViscoelasticSpecies_8h_html"><div class="ttname"><a href="../../da/d68/LinearViscoelasticSpecies_8h.html">LinearViscoelasticSpecies.h</a></div></div>
<div class="ttc" id="aMercury3D_8h_html"><div class="ttname"><a href="../../d8/d02/Mercury3D_8h.html">Mercury3D.h</a></div></div>
<div class="ttc" id="aMercuryTime_8h_html"><div class="ttname"><a href="../../df/dbd/MercuryTime_8h.html">MercuryTime.h</a></div></div>
<div class="ttc" id="aPeriodicBoundary_8h_html"><div class="ttname"><a href="../../d0/d17/PeriodicBoundary_8h.html">PeriodicBoundary.h</a></div></div>
</div><!-- fragment --> <h4><a class="anchor" id="autotoc_md121"></a>
Data members of the class:\n</h4>
<p>The FreeCooling3DDemo class has, but not limited to two (public) data members, namely a pointer to the species and the number of particles: </p><div class="fragment"><div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>;</div>
<div class="line">    <a class="code" href="../../d9/d0c/classSpecies.html">LinearViscoelasticSpecies</a> FC3D_Species;</div>
<div class="ttc" id="aclassSpecies_html"><div class="ttname"><a href="../../d9/d0c/classSpecies.html">Species&lt; LinearViscoelasticNormalSpecies &gt;</a></div></div>
<div class="ttc" id="aconstructor_8cpp_html_a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702"><div class="ttname"><a href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a></div><div class="ttdeci">@ N</div><div class="ttdef"><b>Definition:</b> constructor.cpp:22</div></div>
</div><!-- fragment --><p> The key components of the class are explained in-turn, in the following:</p>
<p>step 1: Define Walls/Periodic Boundaries<br  />
For experimental purposes, particles can be contained by a three dimensional box made up of six infinite walls. If this is required, then please see the <a class="el" href="../../dc/ddf/FreeCooling3DinWallsDemo.html">Free cooling granular system (3D) in walls</a>. Otherwise, the simulation volume is replace by periodic boundaries. </p><div class="fragment"><div class="line">        <a class="code" href="../../d0/d82/classPeriodicBoundary.html">PeriodicBoundary</a> <a class="code" href="../../df/db8/level2__impl_8h.html#ab8be88f438a5824632525cd316e6429a">pb</a>;</div>
<div class="line">        <a class="code" href="../../df/db8/level2__impl_8h.html#ab8be88f438a5824632525cd316e6429a">pb</a>.set(<a class="code" href="../../d5/dc1/classVec3D.html">Vec3D</a>(1,0,0), getXMin(), getXMax());</div>
<div class="line">        boundaryHandler.copyAndAddObject(<a class="code" href="../../df/db8/level2__impl_8h.html#ab8be88f438a5824632525cd316e6429a">pb</a>);</div>
<div class="line">        <a class="code" href="../../df/db8/level2__impl_8h.html#ab8be88f438a5824632525cd316e6429a">pb</a>.set(<a class="code" href="../../d5/dc1/classVec3D.html">Vec3D</a>(0,1,0), getYMin(), getYMax());</div>
<div class="line">        boundaryHandler.copyAndAddObject(<a class="code" href="../../df/db8/level2__impl_8h.html#ab8be88f438a5824632525cd316e6429a">pb</a>);</div>
<div class="line">        <a class="code" href="../../df/db8/level2__impl_8h.html#ab8be88f438a5824632525cd316e6429a">pb</a>.set(<a class="code" href="../../d5/dc1/classVec3D.html">Vec3D</a>(0,0,1), getZMin(), getZMax());</div>
<div class="line">        boundaryHandler.copyAndAddObject(<a class="code" href="../../df/db8/level2__impl_8h.html#ab8be88f438a5824632525cd316e6429a">pb</a>);</div>
<div class="ttc" id="aclassPeriodicBoundary_html"><div class="ttname"><a href="../../d0/d82/classPeriodicBoundary.html">PeriodicBoundary</a></div><div class="ttdoc">Defines a pair of periodic walls. Inherits from BaseBoundary.</div><div class="ttdef"><b>Definition:</b> PeriodicBoundary.h:20</div></div>
<div class="ttc" id="aclassVec3D_html"><div class="ttname"><a href="../../d5/dc1/classVec3D.html">Vec3D</a></div><div class="ttdef"><b>Definition:</b> Kernel/Math/Vector.h:30</div></div>
<div class="ttc" id="alevel2__impl_8h_html_ab8be88f438a5824632525cd316e6429a"><div class="ttname"><a href="../../df/db8/level2__impl_8h.html#ab8be88f438a5824632525cd316e6429a">pb</a></div><div class="ttdeci">const char const int const int const RealScalar const RealScalar const int const RealScalar * pb</div><div class="ttdef"><b>Definition:</b> level2_impl.h:28</div></div>
</div><!-- fragment --><p> step 2: Create Particles<br  />
Next, the particle species is defined. The particles in this problem use a linear visco-elastic (normal) contact model. The dissipation and stiffness defining the contact model can be set in different ways. In this example these contact model parameters are defined. </p><div class="fragment"><div class="line">    <a class="code" href="../../d9/d0c/classSpecies.html">LinearViscoelasticSpecies</a> species;</div>
<div class="line">    species.<a class="code" href="../../dc/d02/classParticleSpecies.html#a274df9fa08ef5580e54f8e9301f1b348">setDensity</a>(2e3);</div>
<div class="line">    species.<a class="code" href="../../dd/de0/classLinearViscoelasticNormalSpecies.html#a73d0ff3e1ac4c6cb75dae0b623d7a13b">setDissipation</a>(0.0);</div>
<div class="line">    species.<a class="code" href="../../dd/de0/classLinearViscoelasticNormalSpecies.html#ad179cd0c4c13e4d54ae243956ce5a07d">setStiffness</a>(1e3);</div>
<div class="line">    <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.FC3D_Species = species;</div>
<div class="line">    <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.speciesHandler.copyAndAddObject(species);</div>
<div class="ttc" id="aclassLinearViscoelasticNormalSpecies_html_a73d0ff3e1ac4c6cb75dae0b623d7a13b"><div class="ttname"><a href="../../dd/de0/classLinearViscoelasticNormalSpecies.html#a73d0ff3e1ac4c6cb75dae0b623d7a13b">LinearViscoelasticNormalSpecies::setDissipation</a></div><div class="ttdeci">void setDissipation(Mdouble dissipation)</div><div class="ttdoc">Allows the normal dissipation to be changed.</div><div class="ttdef"><b>Definition:</b> LinearViscoelasticNormalSpecies.cc:96</div></div>
<div class="ttc" id="aclassLinearViscoelasticNormalSpecies_html_ad179cd0c4c13e4d54ae243956ce5a07d"><div class="ttname"><a href="../../dd/de0/classLinearViscoelasticNormalSpecies.html#ad179cd0c4c13e4d54ae243956ce5a07d">LinearViscoelasticNormalSpecies::setStiffness</a></div><div class="ttdeci">void setStiffness(Mdouble new_k)</div><div class="ttdoc">Allows the spring constant to be changed.</div><div class="ttdef"><b>Definition:</b> LinearViscoelasticNormalSpecies.cc:72</div></div>
<div class="ttc" id="aclassParticleSpecies_html_a274df9fa08ef5580e54f8e9301f1b348"><div class="ttname"><a href="../../dc/d02/classParticleSpecies.html#a274df9fa08ef5580e54f8e9301f1b348">ParticleSpecies::setDensity</a></div><div class="ttdeci">void setDensity(Mdouble density)</div><div class="ttdef"><b>Definition:</b> ParticleSpecies.cc:88</div></div>
<div class="ttc" id="asteady__axisym__advection__diffusion_8cc_html_a569d6908c13cebe207584b3d146c851e"><div class="ttname"><a href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a></div><div class="ttdeci">Constructor for SteadyAxisymAdvectionDiffusion problem</div><div class="ttdef"><b>Definition:</b> steady_axisym_advection_diffusion.cc:213</div></div>
</div><!-- fragment --><p>The particle properties are set subsequently. The particleHandler is cleared just to be sure it is empty, then the particle to be copied into the container is created and the set species is assigned to it. </p><div class="fragment"><div class="line">        particleHandler.clear();</div>
<div class="line">        <a class="code" href="../../d7/d41/classSphericalParticle.html">SphericalParticle</a> <a class="code" href="../../db/d01/MatrixBase__all_8cpp.html#a9b22b0b79984d73a58b20bc0c88a7c5f">p0</a>;</div>
<div class="line">        <a class="code" href="../../db/d01/MatrixBase__all_8cpp.html#a9b22b0b79984d73a58b20bc0c88a7c5f">p0</a>.setSpecies(speciesHandler.getObject(0));</div>
<div class="ttc" id="aMatrixBase__all_8cpp_html_a9b22b0b79984d73a58b20bc0c88a7c5f"><div class="ttname"><a href="../../db/d01/MatrixBase__all_8cpp.html#a9b22b0b79984d73a58b20bc0c88a7c5f">p0</a></div><div class="ttdeci">Vector3f p0</div><div class="ttdef"><b>Definition:</b> MatrixBase_all.cpp:2</div></div>
<div class="ttc" id="aclassSphericalParticle_html"><div class="ttname"><a href="../../d7/d41/classSphericalParticle.html">SphericalParticle</a></div><div class="ttdoc">A spherical particle is the most simple particle used in MercuryDPM.</div><div class="ttdef"><b>Definition:</b> SphericalParticle.h:16</div></div>
</div><!-- fragment --><p> step 3: Place Particles<br  />
After specifying the particle properties, the container is filled with copies of the particle. In this example, particles are placed in a lattice grid pattern, on evenly spaced positions. </p><div class="fragment"><div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>; ++<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line">        {</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ix = (<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> % N1);</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iz = <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span>( <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) / N1 / N1);</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iy = (<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> - ix - N1 * N1 * iz) / N1;</div>
<div class="line">            <span class="comment">// set particle position</span></div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a> = (getXMax() - getXMin()) * (ix + 1) / (N1 + 1);</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a068041cb6b3b60d76ee64be754bedcbe">y</a> = (getYMax() - getYMin()) * (iy + 1) / (N1 + 1);</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> z = (getZMax() - getZMin()) * (iz + 1) / (N1 + 1);</div>
<div class="line">            <a class="code" href="../../db/d01/MatrixBase__all_8cpp.html#a9b22b0b79984d73a58b20bc0c88a7c5f">p0</a>.setPosition(<a class="code" href="../../d5/dc1/classVec3D.html">Vec3D</a>(<a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>, <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a068041cb6b3b60d76ee64be754bedcbe">y</a>, z));</div>
<div class="line">            <span class="comment">// set random velocities for the particle</span></div>
<div class="line">            <a class="code" href="../../db/d01/MatrixBase__all_8cpp.html#a9b22b0b79984d73a58b20bc0c88a7c5f">p0</a>.setVelocity(<a class="code" href="../../d5/dc1/classVec3D.html">Vec3D</a>(random.getRandomNumber(-2.0,2.0),  random.getRandomNumber(-2.0,2.0), random.getRandomNumber(-2.0,2.0)));</div>
<div class="line">            <a class="code" href="../../db/d01/MatrixBase__all_8cpp.html#a9b22b0b79984d73a58b20bc0c88a7c5f">p0</a>.setRadius(0.0025);</div>
<div class="line">            particleHandler.copyAndAddObject(<a class="code" href="../../db/d01/MatrixBase__all_8cpp.html#a9b22b0b79984d73a58b20bc0c88a7c5f">p0</a>);</div>
<div class="line">        }</div>
<div class="ttc" id="aBiCGSTAB__step__by__step_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> BiCGSTAB_step_by_step.cpp:9</div></div>
<div class="ttc" id="alevel1__cplx__impl_8h_html_a068041cb6b3b60d76ee64be754bedcbe"><div class="ttname"><a href="../../d2/d2e/level1__cplx__impl_8h.html#a068041cb6b3b60d76ee64be754bedcbe">y</a></div><div class="ttdeci">Scalar * y</div><div class="ttdef"><b>Definition:</b> level1_cplx_impl.h:128</div></div>
<div class="ttc" id="anamespaceplotDoE_html_a4758fc6194247f040938f29c863d21ee"><div class="ttname"><a href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">plotDoE.x</a></div><div class="ttdeci">list x</div><div class="ttdef"><b>Definition:</b> plotDoE.py:28</div></div>
</div><!-- fragment --><p>step 4: Centre of mass velocity<br  />
Next, the center of mass velocity is subtracted to ensure a reduced random velocity. This results into a center of mass velocity nearly equal to zero. </p><div class="fragment"><div class="line">        <span class="comment">// Compute the center of mass velocity</span></div>
<div class="line">        <span class="keywordtype">double</span> particle_mass =  <a class="code" href="../../db/d01/MatrixBase__all_8cpp.html#a9b22b0b79984d73a58b20bc0c88a7c5f">p0</a>.getMass();</div>
<div class="line">        <span class="keywordtype">double</span> M_b = <a class="code" href="../../da/d21/constructor_8cpp.html#a4051a9225a2612a796f1506ecddafb00a2c63acbe79d9f41ba6bb7766e9c37702">N</a>*particle_mass; <span class="comment">// mass of the bulk system</span></div>
<div class="line">        <a class="code" href="../../d5/dc1/classVec3D.html">Vec3D</a> V_com = {0,0,0};</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> = 0; <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> &lt; particleHandler.getNumberOfObjects() ; <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>++){</div>
<div class="line">            <a class="code" href="../../db/d52/classBaseParticle.html">BaseParticle</a>* <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> = particleHandler.getObject(<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>);</div>
<div class="line">            V_com +=  (particle_mass*<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>-&gt;getVelocity())/M_b;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Compute the reduced velocity for each particle</span></div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> = 0; <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> &lt; particleHandler.getNumberOfObjects() ; <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>++){</div>
<div class="line">            <a class="code" href="../../db/d52/classBaseParticle.html">BaseParticle</a>* <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> = particleHandler.getObject(<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>);</div>
<div class="line">            <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>-&gt;setVelocity(<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>-&gt;getVelocity() - V_com);</div>
<div class="line">        }</div>
<div class="ttc" id="aTutorial__Map__using_8cpp_html_a7fe964f6b1afd4591f637999272ab9a2"><div class="ttname"><a href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a></div><div class="ttdeci">float * p</div><div class="ttdef"><b>Definition:</b> Tutorial_Map_using.cpp:9</div></div>
<div class="ttc" id="aclassBaseParticle_html"><div class="ttname"><a href="../../db/d52/classBaseParticle.html">BaseParticle</a></div><div class="ttdef"><b>Definition:</b> BaseParticle.h:33</div></div>
<div class="ttc" id="alevel2__impl_8h_html_ad46ea6bf5745e72b985b11878e46a45d"><div class="ttname"><a href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a></div><div class="ttdeci">char char char int int * k</div><div class="ttdef"><b>Definition:</b> level2_impl.h:374</div></div>
</div><!-- fragment --><p>Actions After TimeStep:<br  />
The <b>actionsAfterTimeStep()</b> method specifies all actions that need to be performed in between time steps, i.e. <em>Since</em>, the simulation started with zero dissipation, after a reasonable number of collisions per particle, the system will be homogeneous, and the <b>actionsAfterTimeStep()</b> is used to set the initial configuration for the "next" dissipative regime. </p><div class="fragment"><div class="line">    <span class="keywordtype">void</span> actionsAfterTimeStep()<span class="keyword"> override</span>{</div>
<div class="line">        <span class="keywordflow">if</span> (getTime() &gt; 4e5*getTimeStep()) {</div>
<div class="line">            FC3D_Species.<a class="code" href="../../dd/de0/classLinearViscoelasticNormalSpecies.html#a73d0ff3e1ac4c6cb75dae0b623d7a13b">setDissipation</a>(0.232);</div>
<div class="line">        }</div>
<div class="line">    }</div>
</div><!-- fragment --> <h3><a class="anchor" id="autotoc_md122"></a>
Main Function</h3>
<p>In the main program, the FreeCooling3DDemo object is created, after which some of its basic properties are set: like, the number of particles, box dimensions, time step and saving parameters. Lastly, the problem is actually solved by calling its <b>solve()</b> method. </p><div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code" href="../../d9/d18/T__protectiveWall_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>(<span class="keywordtype">int</span> argc <a class="code" href="../../d5/de4/GeneralDefine_8h.html#addf5ec070e9499d36b7f2009ce736076">UNUSED</a>, <span class="keywordtype">char</span>* argv[] <a class="code" href="../../d5/de4/GeneralDefine_8h.html#addf5ec070e9499d36b7f2009ce736076">UNUSED</a>)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Problem setup</span></div>
<div class="line">    <a class="code" href="../../dd/da0/classFreeCooling3DDemoProblem.html">FreeCooling3DDemoProblem</a> <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>;</div>
<div class="line">    <a class="code" href="../../d9/d0c/classSpecies.html">LinearViscoelasticSpecies</a> species;</div>
<div class="line">    species.<a class="code" href="../../dc/d02/classParticleSpecies.html#a274df9fa08ef5580e54f8e9301f1b348">setDensity</a>(2e3);</div>
<div class="line">    species.<a class="code" href="../../dd/de0/classLinearViscoelasticNormalSpecies.html#a73d0ff3e1ac4c6cb75dae0b623d7a13b">setDissipation</a>(0.0);</div>
<div class="line">    species.<a class="code" href="../../dd/de0/classLinearViscoelasticNormalSpecies.html#ad179cd0c4c13e4d54ae243956ce5a07d">setStiffness</a>(1e3);</div>
<div class="line">    <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.FC3D_Species = species;</div>
<div class="line">    <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.speciesHandler.copyAndAddObject(species);</div>
<div class="line">    <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.N = 1000;</div>
<div class="line">    <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.setName(<span class="stringliteral">&quot;FreeCooling3DDemo&quot;</span>);</div>
<div class="line">    <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.setGravity(<a class="code" href="../../d5/dc1/classVec3D.html">Vec3D</a>(0.0, 0.0, 0.0));</div>
<div class="line">    <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.setTimeStep(5<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>-5);</div>
<div class="line">    <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.setSaveCount(4000);</div>
<div class="line">    <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.setTimeMax(50.0);</div>
<div class="line">    <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.setMax(0.064,0.064,0.064);</div>
<div class="line">    <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.setHGridMaxLevels(1);</div>
<div class="line">    <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.setHGridCellOverSizeRatio(1.2);</div>
<div class="line">    <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.setHGridUpdateEachTimeStep(<span class="keyword">false</span>);</div>
<div class="line">    <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.setFileType(<a class="code" href="../../d6/db7/File_8h.html#abf84ea5561d58d9410862dc5b49f254fa9c68f021e7d47b8c42946a0f18ad3b69">FileType::ONE_FILE</a>);</div>
<div class="line">    <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.setParticlesWriteVTK(<span class="keyword">true</span>);</div>
<div class="line">    <a class="code" href="../../d0/d5b/steady__axisym__advection__diffusion_8cc.html#a569d6908c13cebe207584b3d146c851e">problem</a>.solve();</div>
<div class="line">}</div>
<div class="ttc" id="aCwise__array__power__array_8cpp_html_a9eb5e92d9d691c1393e5e7c914731dbf"><div class="ttname"><a href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a></div><div class="ttdeci">Array&lt; double, 1, 3 &gt; e(1./3., 0.5, 2.)</div></div>
<div class="ttc" id="aFile_8h_html_abf84ea5561d58d9410862dc5b49f254fa9c68f021e7d47b8c42946a0f18ad3b69"><div class="ttname"><a href="../../d6/db7/File_8h.html#abf84ea5561d58d9410862dc5b49f254fa9c68f021e7d47b8c42946a0f18ad3b69">FileType::ONE_FILE</a></div><div class="ttdeci">@ ONE_FILE</div><div class="ttdoc">all data will be written into/ read from a single file called name_</div></div>
<div class="ttc" id="aGeneralDefine_8h_html_addf5ec070e9499d36b7f2009ce736076"><div class="ttname"><a href="../../d5/de4/GeneralDefine_8h.html#addf5ec070e9499d36b7f2009ce736076">UNUSED</a></div><div class="ttdeci">#define UNUSED</div><div class="ttdef"><b>Definition:</b> GeneralDefine.h:18</div></div>
<div class="ttc" id="aT__protectiveWall_8cpp_html_a0ddf1224851353fc92bfbff6f499fa97"><div class="ttname"><a href="../../d9/d18/T__protectiveWall_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a></div><div class="ttdeci">int main(int argc, char *argv[])</div><div class="ttdef"><b>Definition:</b> T_protectiveWall.cpp:194</div></div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md123"></a>
References:</h3>
<ol type="1">
<li><a href="https://www2.msm.ctw.utwente.nl/sluding/PAPERS/luding_cluster.pdf">Luding, S. (2005). Structure and cluster formation in granular media. Pramana, 64(6), 893-902.</a></li>
<li>Brilliantov, N. V., &amp; Pöschel, T. (2010). Kinetic theory of granular gases. Oxford University Press.</li>
<li>Pöschel, T., &amp; Luding, S. (Eds.). (2001). Granular gases (Vol. 564). Springer Science &amp; Business Media</li>
</ol>
<p>(Return to <a class="el" href="../../d7/db9/AdvancedTutorials.html#AdvancedOverview">Overview of advanced tutorials</a>) </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../index.html">MercuryDPM Reference Manual</a></li><li class="navelem"><a class="el" href="../../d5/dac/Tutorials.html">Fun with MercuryDPM (Tutorials)</a></li><li class="navelem"><a class="el" href="../../d0/db0/BeginnerTutorials.html">Beginner tutorials</a></li><li class="navelem"><a class="el" href="../../d7/db9/AdvancedTutorials.html">Advanced tutorials</a></li>
    <li class="footer">Generated on Wed Aug 27 2025 17:05:13 for MercuryDPM by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
