<!-- HTML header for doxygen 1.8.18-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MercuryDPM: oomph::NavierStokesSchurComplementPreconditioner Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../MDPM.css" rel="stylesheet" type="text/css"/>
<link href="../../codeLabels.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-fork-corner.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-dropdown-version.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../MDPM-fragment-copy-button.js"></script>
<script type="text/javascript">
DoxygenAwesomeFragmentCopyButton.init()
</script>
<script type="text/javascript" src="../../MDPM-paragraph-link.js"></script>
<script type="text/javascript">
DoxygenAwesomeParagraphLink.init()
</script>
<script type="text/javascript" src="../../MDPM-interactive-toc.js"></script>
<script type="text/javascript">
DoxygenAwesomeInteractiveToc.init()
</script>
<script type="text/javascript" src="../../MDPM-darkmode-toggle.js"></script>
<script type="text/javascript">
DoxygenAwesomeDarkModeToggle.init()
</script>
</head>
<body>
  <div id="bitbucket-corner">
   <a href="https://bitbucket.org/mercurydpm/mercurydpm/src/master/" target="_blank" id="fork-corner" class="fork-corner fc-pos-tr fc-animate fc-theme-bitbucket"></a>
  </div>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../mercury-logo-chosen-light-slogan.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"> <!--MercuryDPM--!>
   <!-- BEGIN version select -->
   <div class="dropdown" id="projectnumber">
    <button class="dropbtn">v1.0</button>
    <div class="dropdown-content">
    </div>
   </div>
   <script type="text/javascript" src="../../MDPM-dropdown-version.js"></script>
<!-- END version select -->
   <!--&#160;<span id="projectnumber">revision: v1.0</span>-->
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<script type="text/javascript" src="../../MDPM-fork-corner.js"></script>
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="../../de/db1/classoomph_1_1NavierStokesSchurComplementPreconditioner-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">oomph::NavierStokesSchurComplementPreconditioner Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="../../d8/d75/navier__stokes__preconditioners_8h_source.html">navier_stokes_preconditioners.h</a>&gt;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Inheritance diagram for oomph::NavierStokesSchurComplementPreconditioner:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
 <div class="center">
  <img src="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.png" usemap="#oomph::NavierStokesSchurComplementPreconditioner_map" alt=""/>
  <map id="oomph::NavierStokesSchurComplementPreconditioner_map" name="oomph::NavierStokesSchurComplementPreconditioner_map">
<area href="../../dd/d57/classoomph_1_1BlockPreconditioner.html" alt="oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;" shape="rect" coords="0,112,315,136"/>
<area href="../../db/d9e/classoomph_1_1Preconditioner.html" alt="oomph::Preconditioner" shape="rect" coords="0,56,315,80"/>
<area href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html" alt="oomph::DistributableLinearAlgebraObject" shape="rect" coords="0,0,315,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ac5ca2d9d665f4bd0a9f2e2cc103486b0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ac5ca2d9d665f4bd0a9f2e2cc103486b0">NavierStokesSchurComplementPreconditioner</a> (<a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *<a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#afc57fedbcd960d99c5ab3f135eacb612">problem_pt</a>)</td></tr>
<tr class="memdesc:ac5ca2d9d665f4bd0a9f2e2cc103486b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor - sets defaults for control flags.  <a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ac5ca2d9d665f4bd0a9f2e2cc103486b0">More...</a><br /></td></tr>
<tr class="separator:ac5ca2d9d665f4bd0a9f2e2cc103486b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad954b4f67329c643d5219ed573805b81"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ad954b4f67329c643d5219ed573805b81">~NavierStokesSchurComplementPreconditioner</a> ()</td></tr>
<tr class="memdesc:ad954b4f67329c643d5219ed573805b81"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ad954b4f67329c643d5219ed573805b81">More...</a><br /></td></tr>
<tr class="separator:ad954b4f67329c643d5219ed573805b81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba0ebcbc6963a62ad492fd9271e349a5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#aba0ebcbc6963a62ad492fd9271e349a5">NavierStokesSchurComplementPreconditioner</a> (const <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html">NavierStokesSchurComplementPreconditioner</a> &amp;)=delete</td></tr>
<tr class="memdesc:aba0ebcbc6963a62ad492fd9271e349a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken copy constructor.  <a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#aba0ebcbc6963a62ad492fd9271e349a5">More...</a><br /></td></tr>
<tr class="separator:aba0ebcbc6963a62ad492fd9271e349a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41814f592afecb493310be513c595739"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a41814f592afecb493310be513c595739">set_problem_pt</a> (<a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *<a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#afc57fedbcd960d99c5ab3f135eacb612">problem_pt</a>)</td></tr>
<tr class="memdesc:a41814f592afecb493310be513c595739"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken assignment operator.  <a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a41814f592afecb493310be513c595739">More...</a><br /></td></tr>
<tr class="separator:a41814f592afecb493310be513c595739"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc57fedbcd960d99c5ab3f135eacb612"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#afc57fedbcd960d99c5ab3f135eacb612">problem_pt</a> () const</td></tr>
<tr class="separator:afc57fedbcd960d99c5ab3f135eacb612"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af406a2d6632c95f7d8b70baba1b912ee"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#af406a2d6632c95f7d8b70baba1b912ee">enable_accept_non_NavierStokesElementWithDiagonalMassMatrices_elements</a> ()</td></tr>
<tr class="separator:af406a2d6632c95f7d8b70baba1b912ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a483c96d41a5032f90b8027d6ef2c0c5a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a483c96d41a5032f90b8027d6ef2c0c5a">disable_accept_non_NavierStokesElementWithDiagonalMassMatrices_elements</a> ()</td></tr>
<tr class="separator:a483c96d41a5032f90b8027d6ef2c0c5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03cbfa527081ea03c910aadc281615d7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a03cbfa527081ea03c910aadc281615d7">setup</a> ()</td></tr>
<tr class="memdesc:a03cbfa527081ea03c910aadc281615d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Setup the preconditioner.  <a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a03cbfa527081ea03c910aadc281615d7">More...</a><br /></td></tr>
<tr class="separator:a03cbfa527081ea03c910aadc281615d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbc87003dd8e8c924ae802651b18f2ed"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#adbc87003dd8e8c924ae802651b18f2ed">preconditioner_solve</a> (const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;r, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;z)</td></tr>
<tr class="memdesc:adbc87003dd8e8c924ae802651b18f2ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply preconditioner to Vector r.  <a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#adbc87003dd8e8c924ae802651b18f2ed">More...</a><br /></td></tr>
<tr class="separator:adbc87003dd8e8c924ae802651b18f2ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe80b5bb32d24f49f427d04118de284a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#abe80b5bb32d24f49f427d04118de284a">set_navier_stokes_mesh</a> (<a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *<a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a3c0e92cb77c3e3179007fe9fd99b6428">mesh_pt</a>, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;allow_multiple_element_type_in_navier_stokes_mesh=false)</td></tr>
<tr class="separator:abe80b5bb32d24f49f427d04118de284a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48f0d5e878eccab6e7f080c92d4bc6f5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a48f0d5e878eccab6e7f080c92d4bc6f5">set_p_preconditioner</a> (<a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html">Preconditioner</a> *new_p_preconditioner_pt)</td></tr>
<tr class="memdesc:a48f0d5e878eccab6e7f080c92d4bc6f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to set a new pressure matrix preconditioner (inexact solver)  <a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a48f0d5e878eccab6e7f080c92d4bc6f5">More...</a><br /></td></tr>
<tr class="separator:a48f0d5e878eccab6e7f080c92d4bc6f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05bac2703d9570c15bf0676cbbe7ce03"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a05bac2703d9570c15bf0676cbbe7ce03">set_p_superlu_preconditioner</a> ()</td></tr>
<tr class="separator:a05bac2703d9570c15bf0676cbbe7ce03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2f387b87192dd2f7b6725cfe3aae44e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ab2f387b87192dd2f7b6725cfe3aae44e">set_f_preconditioner</a> (<a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html">Preconditioner</a> *new_f_preconditioner_pt)</td></tr>
<tr class="memdesc:ab2f387b87192dd2f7b6725cfe3aae44e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to set a new momentum matrix preconditioner (inexact solver)  <a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ab2f387b87192dd2f7b6725cfe3aae44e">More...</a><br /></td></tr>
<tr class="separator:ab2f387b87192dd2f7b6725cfe3aae44e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae687961a8422c3b61da2e225c5665110"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ae687961a8422c3b61da2e225c5665110">use_lsc</a> ()</td></tr>
<tr class="memdesc:ae687961a8422c3b61da2e225c5665110"><td class="mdescLeft">&#160;</td><td class="mdescRight">Use LSC version of the preconditioner.  <a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ae687961a8422c3b61da2e225c5665110">More...</a><br /></td></tr>
<tr class="separator:ae687961a8422c3b61da2e225c5665110"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f77731b78f270044f09f761719a88b0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a1f77731b78f270044f09f761719a88b0">use_fp</a> ()</td></tr>
<tr class="memdesc:a1f77731b78f270044f09f761719a88b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Use Fp version of the preconditioner.  <a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a1f77731b78f270044f09f761719a88b0">More...</a><br /></td></tr>
<tr class="separator:a1f77731b78f270044f09f761719a88b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af29abc6e2b9fd92ae3a31a4f9d56f6b8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#af29abc6e2b9fd92ae3a31a4f9d56f6b8">set_f_superlu_preconditioner</a> ()</td></tr>
<tr class="separator:af29abc6e2b9fd92ae3a31a4f9d56f6b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1a6030468c5795b3ace7a58bcb6b4f1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#af1a6030468c5795b3ace7a58bcb6b4f1">enable_doc_time</a> ()</td></tr>
<tr class="memdesc:af1a6030468c5795b3ace7a58bcb6b4f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enable documentation of time.  <a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#af1a6030468c5795b3ace7a58bcb6b4f1">More...</a><br /></td></tr>
<tr class="separator:af1a6030468c5795b3ace7a58bcb6b4f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0015b71a33a147650606840d98f5a9e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ae0015b71a33a147650606840d98f5a9e">disable_doc_time</a> ()</td></tr>
<tr class="memdesc:ae0015b71a33a147650606840d98f5a9e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Disable documentation of time.  <a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ae0015b71a33a147650606840d98f5a9e">More...</a><br /></td></tr>
<tr class="separator:ae0015b71a33a147650606840d98f5a9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cac2493de85690e3954949eb2a27d2c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a5cac2493de85690e3954949eb2a27d2c">clean_up_memory</a> ()</td></tr>
<tr class="memdesc:a5cac2493de85690e3954949eb2a27d2c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper function to delete preconditioner data.  <a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a5cac2493de85690e3954949eb2a27d2c">More...</a><br /></td></tr>
<tr class="separator:a5cac2493de85690e3954949eb2a27d2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6554fd9418b705b70a0a54c0f864db8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ac6554fd9418b705b70a0a54c0f864db8">enable_robin_for_fp</a> ()</td></tr>
<tr class="memdesc:ac6554fd9418b705b70a0a54c0f864db8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Use Robin BC elements for the Fp preconditioner.  <a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ac6554fd9418b705b70a0a54c0f864db8">More...</a><br /></td></tr>
<tr class="separator:ac6554fd9418b705b70a0a54c0f864db8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1db0cf426cd70ad4f1f30182d82c469"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ae1db0cf426cd70ad4f1f30182d82c469">disable_robin_for_fp</a> ()</td></tr>
<tr class="memdesc:ae1db0cf426cd70ad4f1f30182d82c469"><td class="mdescLeft">&#160;</td><td class="mdescRight">Don't use Robin BC elements for the Fp preconditioenr.  <a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ae1db0cf426cd70ad4f1f30182d82c469">More...</a><br /></td></tr>
<tr class="separator:ae1db0cf426cd70ad4f1f30182d82c469"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7d68718453adc8e7b9e19ad30cc9171"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#af7d68718453adc8e7b9e19ad30cc9171">pin_first_pressure_dof_in_press_adv_diff</a> ()</td></tr>
<tr class="separator:af7d68718453adc8e7b9e19ad30cc9171"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58c02e402f5c6103268da36097b4ad0e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a58c02e402f5c6103268da36097b4ad0e">unpin_first_pressure_dof_in_press_adv_diff</a> ()</td></tr>
<tr class="separator:a58c02e402f5c6103268da36097b4ad0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b42174c40c4fec1336c547aaa3d07f5"><td class="memTemplParams" colspan="2">template&lt;class ELEMENT &gt; </td></tr>
<tr class="memitem:a1b42174c40c4fec1336c547aaa3d07f5"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a1b42174c40c4fec1336c547aaa3d07f5">validate</a> (<a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> &amp;doc_info, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *orig_problem_pt)</td></tr>
<tr class="separator:a1b42174c40c4fec1336c547aaa3d07f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03941c01d70ece07797301c8ac6a0a8a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a03941c01d70ece07797301c8ac6a0a8a">pin_all_non_pressure_dofs</a> ()</td></tr>
<tr class="memdesc:a03941c01d70ece07797301c8ac6a0a8a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pin all non-pressure dofs.  <a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a03941c01d70ece07797301c8ac6a0a8a">More...</a><br /></td></tr>
<tr class="separator:a03941c01d70ece07797301c8ac6a0a8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3f40f62d33d33616cdb4bed48aaccde"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ac3f40f62d33d33616cdb4bed48aaccde">get_pressure_advection_diffusion_matrix</a> (<a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> &amp;fp_matrix)</td></tr>
<tr class="memdesc:ac3f40f62d33d33616cdb4bed48aaccde"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the pressure advection diffusion matrix.  <a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ac3f40f62d33d33616cdb4bed48aaccde">More...</a><br /></td></tr>
<tr class="separator:ac3f40f62d33d33616cdb4bed48aaccde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1c121b668b1961a68010f984166947c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#af1c121b668b1961a68010f984166947c">reset_pin_status</a> ()</td></tr>
<tr class="memdesc:af1c121b668b1961a68010f984166947c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset pin status of all values.  <a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#af1c121b668b1961a68010f984166947c">More...</a><br /></td></tr>
<tr class="separator:af1c121b668b1961a68010f984166947c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b95e7159585b5151f9e5dc1d1713655"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a0b95e7159585b5151f9e5dc1d1713655">setup</a> (<a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html">DoubleMatrixBase</a> *<a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a9aac48fd53e579e6db8eeed58933a14b">matrix_pt</a>)</td></tr>
<tr class="separator:a0b95e7159585b5151f9e5dc1d1713655"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a783fae97e4b898f8de72b504a4f4bec6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a783fae97e4b898f8de72b504a4f4bec6">setup</a> (const <a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *<a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#afc57fedbcd960d99c5ab3f135eacb612">problem_pt</a>, <a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html">DoubleMatrixBase</a> *<a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a9aac48fd53e579e6db8eeed58933a14b">matrix_pt</a>)</td></tr>
<tr class="separator:a783fae97e4b898f8de72b504a4f4bec6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4886f4efe510e5c9b0eb19422943588"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#af4886f4efe510e5c9b0eb19422943588">setup</a> ()=0</td></tr>
<tr class="separator:af4886f4efe510e5c9b0eb19422943588"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classoomph_1_1BlockPreconditioner"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classoomph_1_1BlockPreconditioner')"><img src="../../closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;</a></td></tr>
<tr class="memitem:a74c4b4bef4371b72816631445689a2e6 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a74c4b4bef4371b72816631445689a2e6">BlockPreconditioner</a> ()</td></tr>
<tr class="memdesc:a74c4b4bef4371b72816631445689a2e6 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a74c4b4bef4371b72816631445689a2e6">More...</a><br /></td></tr>
<tr class="separator:a74c4b4bef4371b72816631445689a2e6 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0634f494e1284446512560cb1dc73a32 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a0634f494e1284446512560cb1dc73a32">BlockPreconditioner</a> (const <a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html">BlockPreconditioner</a> &amp;)=delete</td></tr>
<tr class="memdesc:a0634f494e1284446512560cb1dc73a32 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken copy constructor.  <a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a0634f494e1284446512560cb1dc73a32">More...</a><br /></td></tr>
<tr class="separator:a0634f494e1284446512560cb1dc73a32 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78c33fc6f29101f027e22d64d158d567 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a78c33fc6f29101f027e22d64d158d567">~BlockPreconditioner</a> ()</td></tr>
<tr class="memdesc:a78c33fc6f29101f027e22d64d158d567 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a78c33fc6f29101f027e22d64d158d567">More...</a><br /></td></tr>
<tr class="separator:a78c33fc6f29101f027e22d64d158d567 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f07557542d4ebeba0e5a2307c7a7d48 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a8f07557542d4ebeba0e5a2307c7a7d48">operator=</a> (const <a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html">BlockPreconditioner</a> &amp;)=delete</td></tr>
<tr class="memdesc:a8f07557542d4ebeba0e5a2307c7a7d48 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken assignment operator.  <a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a8f07557542d4ebeba0e5a2307c7a7d48">More...</a><br /></td></tr>
<tr class="separator:a8f07557542d4ebeba0e5a2307c7a7d48 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9aac48fd53e579e6db8eeed58933a14b inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a9aac48fd53e579e6db8eeed58933a14b">matrix_pt</a> () const</td></tr>
<tr class="separator:a9aac48fd53e579e6db8eeed58933a14b inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d977a81515458e59b94438a215e93e1 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a0d977a81515458e59b94438a215e93e1">turn_on_recursive_debug_flag</a> ()</td></tr>
<tr class="separator:a0d977a81515458e59b94438a215e93e1 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ed741a5fbf514fc29f0a332a211255f inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a8ed741a5fbf514fc29f0a332a211255f">turn_off_recursive_debug_flag</a> ()</td></tr>
<tr class="separator:a8ed741a5fbf514fc29f0a332a211255f inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a271bf5ea70579e43797187498d98f9a9 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a271bf5ea70579e43797187498d98f9a9">turn_on_debug_flag</a> ()</td></tr>
<tr class="memdesc:a271bf5ea70579e43797187498d98f9a9 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Toggles on the debug flag.  <a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a271bf5ea70579e43797187498d98f9a9">More...</a><br /></td></tr>
<tr class="separator:a271bf5ea70579e43797187498d98f9a9 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46c57c6a2f4b54e27d2aaccc4ec90665 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a46c57c6a2f4b54e27d2aaccc4ec90665">turn_off_debug_flag</a> ()</td></tr>
<tr class="memdesc:a46c57c6a2f4b54e27d2aaccc4ec90665 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Toggles off the debug flag.  <a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a46c57c6a2f4b54e27d2aaccc4ec90665">More...</a><br /></td></tr>
<tr class="separator:a46c57c6a2f4b54e27d2aaccc4ec90665 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8e2478caa8370dd12462f17e1cc8082 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ab8e2478caa8370dd12462f17e1cc8082">turn_into_subsidiary_block_preconditioner</a> (<a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html">BlockPreconditioner</a>&lt; <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> &gt; *master_block_prec_pt, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;doftype_in_master_preconditioner_coarse)</td></tr>
<tr class="separator:ab8e2478caa8370dd12462f17e1cc8082 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0d2887082cf856b680b4ae61b510d29 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ac0d2887082cf856b680b4ae61b510d29">turn_into_subsidiary_block_preconditioner</a> (<a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html">BlockPreconditioner</a>&lt; <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> &gt; *master_block_prec_pt, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;doftype_in_master_preconditioner_coarse, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt;&gt; &amp;doftype_coarsen_map_coarse)</td></tr>
<tr class="separator:ac0d2887082cf856b680b4ae61b510d29 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af704c4816469cef4fed9d35a9ad651ec inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#af704c4816469cef4fed9d35a9ad651ec">block_setup</a> ()</td></tr>
<tr class="separator:af704c4816469cef4fed9d35a9ad651ec inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b70b51b533002ff33a09013aa084e54 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a6b70b51b533002ff33a09013aa084e54">block_setup</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;dof_to_block_map)</td></tr>
<tr class="separator:a6b70b51b533002ff33a09013aa084e54 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72b4dbe167da59d9ba12c7eff97d77e6 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a72b4dbe167da59d9ba12c7eff97d77e6">get_block</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> &amp;output_matrix, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;ignore_replacement_block=false) const</td></tr>
<tr class="separator:a72b4dbe167da59d9ba12c7eff97d77e6 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c37f469646c689b5f1e79d0953bd588 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a4c37f469646c689b5f1e79d0953bd588">get_block</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;ignore_replacement_block=false) const</td></tr>
<tr class="separator:a4c37f469646c689b5f1e79d0953bd588 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a748e2ad8836bc8edf5b9a42373a7ad61 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a748e2ad8836bc8edf5b9a42373a7ad61">set_master_matrix_pt</a> (<a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> *in_matrix_pt)</td></tr>
<tr class="memdesc:a748e2ad8836bc8edf5b9a42373a7ad61 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the matrix_pt in the upper-most master preconditioner.  <a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a748e2ad8836bc8edf5b9a42373a7ad61">More...</a><br /></td></tr>
<tr class="separator:a748e2ad8836bc8edf5b9a42373a7ad61 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9dae351352d344321ea82999d7003e17 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a9dae351352d344321ea82999d7003e17">get_block_other_matrix</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> *in_matrix_pt, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> &amp;output_matrix)</td></tr>
<tr class="separator:a9dae351352d344321ea82999d7003e17 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69fa79db7073f39a1ac5333c8bd9c1d5 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a69fa79db7073f39a1ac5333c8bd9c1d5">get_blocks</a> (<a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../d9/db9/classbool.html">bool</a> &gt; &amp;required_blocks, <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> * &gt; &amp;block_matrix_pt) const</td></tr>
<tr class="separator:a69fa79db7073f39a1ac5333c8bd9c1d5 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a314fc14d95f2833be66067cd5b45e093 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a314fc14d95f2833be66067cd5b45e093">get_dof_level_block</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> &amp;output_block, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;ignore_replacement_block=false) const</td></tr>
<tr class="separator:a314fc14d95f2833be66067cd5b45e093 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1df550d281ec99914115edfa1a40b982 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a1df550d281ec99914115edfa1a40b982">get_dof_level_block</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;block_i, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;block_j, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> &amp;output_block, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;ignore_replacement_block) const</td></tr>
<tr class="separator:a1df550d281ec99914115edfa1a40b982 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51636746e5921ee2845daf60b1c322dc inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a51636746e5921ee2845daf60b1c322dc">get_concatenated_block</a> (const <a class="el" href="../../d0/dea/classoomph_1_1VectorMatrix.html">VectorMatrix</a>&lt; <a class="el" href="../../dd/da7/classoomph_1_1BlockSelector.html">BlockSelector</a> &gt; &amp;selected_block)</td></tr>
<tr class="separator:a51636746e5921ee2845daf60b1c322dc inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9321cdab3f506ab95fe51cd9b93deab inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#af9321cdab3f506ab95fe51cd9b93deab">get_concatenated_block_vector</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;block_vec_number, const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../df/d7a/MatrixBase__isOrthogonal_8cpp.html#a6ee409cfdca8577a72873ce7105dfce7">v</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#a9d82f3af1459c1efc910b77f3ccd3180">b</a>)</td></tr>
<tr class="separator:af9321cdab3f506ab95fe51cd9b93deab inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d5106c0b9dca23aa1cc7f7fd8e696cb inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a6d5106c0b9dca23aa1cc7f7fd8e696cb">return_concatenated_block_vector</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;block_vec_number, const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#a9d82f3af1459c1efc910b77f3ccd3180">b</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../df/d7a/MatrixBase__isOrthogonal_8cpp.html#a6ee409cfdca8577a72873ce7105dfce7">v</a>) const</td></tr>
<tr class="memdesc:a6d5106c0b9dca23aa1cc7f7fd8e696cb inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Takes concatenated block ordered vector, b, and copies its.  <a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a6d5106c0b9dca23aa1cc7f7fd8e696cb">More...</a><br /></td></tr>
<tr class="separator:a6d5106c0b9dca23aa1cc7f7fd8e696cb inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad356946d5de4f0817cdf8793fa3cdc74 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ad356946d5de4f0817cdf8793fa3cdc74">get_block_vectors</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;block_vec_number, const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../df/d7a/MatrixBase__isOrthogonal_8cpp.html#a6ee409cfdca8577a72873ce7105dfce7">v</a>, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &gt; &amp;<a class="el" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>) const</td></tr>
<tr class="separator:ad356946d5de4f0817cdf8793fa3cdc74 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0517a3678def8b89ae69840345a8f838 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a0517a3678def8b89ae69840345a8f838">get_block_vectors</a> (const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../df/d7a/MatrixBase__isOrthogonal_8cpp.html#a6ee409cfdca8577a72873ce7105dfce7">v</a>, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &gt; &amp;<a class="el" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>) const</td></tr>
<tr class="separator:a0517a3678def8b89ae69840345a8f838 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71d48d8a70151ef0febd4537a2214c53 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a71d48d8a70151ef0febd4537a2214c53">return_block_vectors</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;block_vec_number, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &gt; &amp;<a class="el" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../df/d7a/MatrixBase__isOrthogonal_8cpp.html#a6ee409cfdca8577a72873ce7105dfce7">v</a>) const</td></tr>
<tr class="separator:a71d48d8a70151ef0febd4537a2214c53 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a628f3ab6c3c41ccb449da642fb7e1feb inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a628f3ab6c3c41ccb449da642fb7e1feb">return_block_vectors</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &gt; &amp;<a class="el" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../df/d7a/MatrixBase__isOrthogonal_8cpp.html#a6ee409cfdca8577a72873ce7105dfce7">v</a>) const</td></tr>
<tr class="separator:a628f3ab6c3c41ccb449da642fb7e1feb inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7efc9f2f0209764902e4e45fcb2556d1 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a7efc9f2f0209764902e4e45fcb2556d1">get_block_vector</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d5/d24/level2__real__impl_8h.html#a1224f27e9a621d957f8124bcade25bed">n</a>, const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../df/d7a/MatrixBase__isOrthogonal_8cpp.html#a6ee409cfdca8577a72873ce7105dfce7">v</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#a9d82f3af1459c1efc910b77f3ccd3180">b</a>) const</td></tr>
<tr class="separator:a7efc9f2f0209764902e4e45fcb2556d1 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1dd4d3cd6b64fa64e1ff6730b0deecc7 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a1dd4d3cd6b64fa64e1ff6730b0deecc7">return_block_vector</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d5/d24/level2__real__impl_8h.html#a1224f27e9a621d957f8124bcade25bed">n</a>, const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#a9d82f3af1459c1efc910b77f3ccd3180">b</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../df/d7a/MatrixBase__isOrthogonal_8cpp.html#a6ee409cfdca8577a72873ce7105dfce7">v</a>) const</td></tr>
<tr class="separator:a1dd4d3cd6b64fa64e1ff6730b0deecc7 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd37323d2b5ba31e2d14f3ce8e6e474d inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#afd37323d2b5ba31e2d14f3ce8e6e474d">get_block_ordered_preconditioner_vector</a> (const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../df/d7a/MatrixBase__isOrthogonal_8cpp.html#a6ee409cfdca8577a72873ce7105dfce7">v</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../df/d7a/MatrixBase__isOrthogonal_8cpp.html#a080d348cd3ec0d6b60a118c00929effe">w</a>)</td></tr>
<tr class="separator:afd37323d2b5ba31e2d14f3ce8e6e474d inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98e920e003f085b02dbb30510fb23a0f inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a98e920e003f085b02dbb30510fb23a0f">return_block_ordered_preconditioner_vector</a> (const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../df/d7a/MatrixBase__isOrthogonal_8cpp.html#a080d348cd3ec0d6b60a118c00929effe">w</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../df/d7a/MatrixBase__isOrthogonal_8cpp.html#a6ee409cfdca8577a72873ce7105dfce7">v</a>) const</td></tr>
<tr class="separator:a98e920e003f085b02dbb30510fb23a0f inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80808d42be8db74fd58af80b019bf317 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a80808d42be8db74fd58af80b019bf317">nblock_types</a> () const</td></tr>
<tr class="memdesc:a80808d42be8db74fd58af80b019bf317 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the number of block types.  <a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a80808d42be8db74fd58af80b019bf317">More...</a><br /></td></tr>
<tr class="separator:a80808d42be8db74fd58af80b019bf317 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6cca480686ea8e44244ac60a0db23ba inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ab6cca480686ea8e44244ac60a0db23ba">ndof_types</a> () const</td></tr>
<tr class="memdesc:ab6cca480686ea8e44244ac60a0db23ba inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the total number of DOF types.  <a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ab6cca480686ea8e44244ac60a0db23ba">More...</a><br /></td></tr>
<tr class="separator:ab6cca480686ea8e44244ac60a0db23ba inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c0e92cb77c3e3179007fe9fd99b6428 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a3c0e92cb77c3e3179007fe9fd99b6428">mesh_pt</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>) const</td></tr>
<tr class="separator:a3c0e92cb77c3e3179007fe9fd99b6428 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a193776a271f7c23d20d2102de0ff1cb9 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a193776a271f7c23d20d2102de0ff1cb9">nmesh</a> () const</td></tr>
<tr class="separator:a193776a271f7c23d20d2102de0ff1cb9 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a64cfc57ffd16b92ac78499de515138 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a8a64cfc57ffd16b92ac78499de515138">block_number</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;i_dof) const</td></tr>
<tr class="memdesc:a8a64cfc57ffd16b92ac78499de515138 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the block number corresponding to a global index i_dof.  <a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a8a64cfc57ffd16b92ac78499de515138">More...</a><br /></td></tr>
<tr class="separator:a8a64cfc57ffd16b92ac78499de515138 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75742d54177935fb22e59d045209b11e inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a75742d54177935fb22e59d045209b11e">index_in_block</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;i_dof) const</td></tr>
<tr class="separator:a75742d54177935fb22e59d045209b11e inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77ac0b71404620e7be8b15ac2d588495 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a77ac0b71404620e7be8b15ac2d588495">block_distribution_pt</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#a9d82f3af1459c1efc910b77f3ccd3180">b</a>) const</td></tr>
<tr class="memdesc:a77ac0b71404620e7be8b15ac2d588495 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access function to the block distributions (const version).  <a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a77ac0b71404620e7be8b15ac2d588495">More...</a><br /></td></tr>
<tr class="separator:a77ac0b71404620e7be8b15ac2d588495 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace28659098240524c431a41cf419d4ba inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ace28659098240524c431a41cf419d4ba">block_distribution_pt</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#a9d82f3af1459c1efc910b77f3ccd3180">b</a>)</td></tr>
<tr class="memdesc:ace28659098240524c431a41cf419d4ba inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access function to the block distributions (non-const version).  <a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ace28659098240524c431a41cf419d4ba">More...</a><br /></td></tr>
<tr class="separator:ace28659098240524c431a41cf419d4ba inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ee4a9fcf226e8c4438fb25747cb6e93 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a1ee4a9fcf226e8c4438fb25747cb6e93">dof_block_distribution_pt</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#a9d82f3af1459c1efc910b77f3ccd3180">b</a>)</td></tr>
<tr class="memdesc:a1ee4a9fcf226e8c4438fb25747cb6e93 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access function to the dof-level block distributions.  <a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a1ee4a9fcf226e8c4438fb25747cb6e93">More...</a><br /></td></tr>
<tr class="separator:a1ee4a9fcf226e8c4438fb25747cb6e93 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a005d978655022d1a04da7397cf5d0e83 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a005d978655022d1a04da7397cf5d0e83">master_distribution_pt</a> () const</td></tr>
<tr class="separator:a005d978655022d1a04da7397cf5d0e83 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45509677ccef78be13b5e4485312ddc1 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a45509677ccef78be13b5e4485312ddc1">ndof_types_in_mesh</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>) const</td></tr>
<tr class="separator:a45509677ccef78be13b5e4485312ddc1 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ac4335ec07fc13f7bf1093fd0489c52 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a9ac4335ec07fc13f7bf1093fd0489c52">is_subsidiary_block_preconditioner</a> () const</td></tr>
<tr class="separator:a9ac4335ec07fc13f7bf1093fd0489c52 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a804e1975f170d2ad941b3b7d2dd50407 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a804e1975f170d2ad941b3b7d2dd50407">is_master_block_preconditioner</a> () const</td></tr>
<tr class="separator:a804e1975f170d2ad941b3b7d2dd50407 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab36e905f7da268328709d62951d64ace inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ab36e905f7da268328709d62951d64ace">set_block_output_to_files</a> (const std::string &amp;basefilename)</td></tr>
<tr class="separator:ab36e905f7da268328709d62951d64ace inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45b37f1934144d882831bf354f35d035 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a45b37f1934144d882831bf354f35d035">disable_block_output_to_files</a> ()</td></tr>
<tr class="memdesc:a45b37f1934144d882831bf354f35d035 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Turn off output of blocks (by clearing the basefilename string).  <a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a45b37f1934144d882831bf354f35d035">More...</a><br /></td></tr>
<tr class="separator:a45b37f1934144d882831bf354f35d035 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bd0ab19a7501b79c16c1283766f0abb inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a0bd0ab19a7501b79c16c1283766f0abb">block_output_on</a> () const</td></tr>
<tr class="memdesc:a0bd0ab19a7501b79c16c1283766f0abb inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test if output of blocks is on or not.  <a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a0bd0ab19a7501b79c16c1283766f0abb">More...</a><br /></td></tr>
<tr class="separator:a0bd0ab19a7501b79c16c1283766f0abb inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adec848504d36ebcd8e27ec60f52f75a6 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#adec848504d36ebcd8e27ec60f52f75a6">output_blocks_to_files</a> (const std::string &amp;basefilename, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;precision=8) const</td></tr>
<tr class="separator:adec848504d36ebcd8e27ec60f52f75a6 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa760ae71a5aae488547ccf721d412b1e inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#aa760ae71a5aae488547ccf721d412b1e">post_block_matrix_assembly_partial_clear</a> ()</td></tr>
<tr class="separator:aa760ae71a5aae488547ccf721d412b1e inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab84701c65bdfd8d2c14611176e5e6209 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html">BlockPreconditioner</a>&lt; <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ab84701c65bdfd8d2c14611176e5e6209">master_block_preconditioner_pt</a> () const</td></tr>
<tr class="memdesc:ab84701c65bdfd8d2c14611176e5e6209 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access function to the master block preconditioner pt.  <a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ab84701c65bdfd8d2c14611176e5e6209">More...</a><br /></td></tr>
<tr class="separator:ab84701c65bdfd8d2c14611176e5e6209 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7845d9301918e3f5cbecd729ec1e309b inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a7845d9301918e3f5cbecd729ec1e309b">clear_block_preconditioner_base</a> ()</td></tr>
<tr class="separator:a7845d9301918e3f5cbecd729ec1e309b inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a289db176ccafcc3719367fa98340f94d inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a289db176ccafcc3719367fa98340f94d">document</a> ()</td></tr>
<tr class="separator:a289db176ccafcc3719367fa98340f94d inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a39411824a744d4569fe835dec13047 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a3a39411824a744d4569fe835dec13047">doftype_coarsen_map_fine</a> () const</td></tr>
<tr class="separator:a3a39411824a744d4569fe835dec13047 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a433adda4f658cc7880121bf9ca4293c4 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a433adda4f658cc7880121bf9ca4293c4">get_fine_grain_dof_types_in</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>) const</td></tr>
<tr class="separator:a433adda4f658cc7880121bf9ca4293c4 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50b76a374797805f64e2af34d581cdc2 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a50b76a374797805f64e2af34d581cdc2">nfine_grain_dof_types_in</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>) const</td></tr>
<tr class="separator:a50b76a374797805f64e2af34d581cdc2 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a571824cedc7e458a612111b51f20e5fb inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d2/d3a/classoomph_1_1MapMatrix.html">MapMatrix</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a571824cedc7e458a612111b51f20e5fb">replacement_dof_block_pt</a> () const</td></tr>
<tr class="memdesc:a571824cedc7e458a612111b51f20e5fb inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access function to the replaced dof-level blocks.  <a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a571824cedc7e458a612111b51f20e5fb">More...</a><br /></td></tr>
<tr class="separator:a571824cedc7e458a612111b51f20e5fb inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbe1ae854ee9831649249d50162bb6a9 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#adbe1ae854ee9831649249d50162bb6a9">setup_matrix_vector_product</a> (<a class="el" href="../../d1/dac/classoomph_1_1MatrixVectorProduct.html">MatrixVectorProduct</a> *matvec_prod_pt, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> *block_pt, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;block_col_indices)</td></tr>
<tr class="separator:adbe1ae854ee9831649249d50162bb6a9 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65059c036724814a0e490716fa6eaf0a inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a65059c036724814a0e490716fa6eaf0a">setup_matrix_vector_product</a> (<a class="el" href="../../d1/dac/classoomph_1_1MatrixVectorProduct.html">MatrixVectorProduct</a> *matvec_prod_pt, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> *block_pt, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;block_col_index)</td></tr>
<tr class="separator:a65059c036724814a0e490716fa6eaf0a inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afba1bef13cebdce65a0a49ff3381269a inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#afba1bef13cebdce65a0a49ff3381269a">internal_get_block_ordered_preconditioner_vector</a> (const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../df/d7a/MatrixBase__isOrthogonal_8cpp.html#a6ee409cfdca8577a72873ce7105dfce7">v</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../df/d7a/MatrixBase__isOrthogonal_8cpp.html#a080d348cd3ec0d6b60a118c00929effe">w</a>) const</td></tr>
<tr class="separator:afba1bef13cebdce65a0a49ff3381269a inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a679a82067056628cc4bbc8bb68d088f2 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a679a82067056628cc4bbc8bb68d088f2">internal_return_block_ordered_preconditioner_vector</a> (const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../df/d7a/MatrixBase__isOrthogonal_8cpp.html#a080d348cd3ec0d6b60a118c00929effe">w</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../df/d7a/MatrixBase__isOrthogonal_8cpp.html#a6ee409cfdca8577a72873ce7105dfce7">v</a>) const</td></tr>
<tr class="separator:a679a82067056628cc4bbc8bb68d088f2 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c2b9ed482db072b0cabe5a51eb76efa inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a7c2b9ed482db072b0cabe5a51eb76efa">internal_nblock_types</a> () const</td></tr>
<tr class="separator:a7c2b9ed482db072b0cabe5a51eb76efa inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f3efe468cd6e133d6840ede8c3687b5 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a4f3efe468cd6e133d6840ede8c3687b5">internal_ndof_types</a> () const</td></tr>
<tr class="separator:a4f3efe468cd6e133d6840ede8c3687b5 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04e260cc4160a952db2d410109fb2684 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a04e260cc4160a952db2d410109fb2684">internal_return_block_vector</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d5/d24/level2__real__impl_8h.html#a1224f27e9a621d957f8124bcade25bed">n</a>, const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#a9d82f3af1459c1efc910b77f3ccd3180">b</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../df/d7a/MatrixBase__isOrthogonal_8cpp.html#a6ee409cfdca8577a72873ce7105dfce7">v</a>) const</td></tr>
<tr class="separator:a04e260cc4160a952db2d410109fb2684 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3cf61f61e1aa50e2315e999827e7d59 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ae3cf61f61e1aa50e2315e999827e7d59">internal_get_block_vector</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d5/d24/level2__real__impl_8h.html#a1224f27e9a621d957f8124bcade25bed">n</a>, const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../df/d7a/MatrixBase__isOrthogonal_8cpp.html#a6ee409cfdca8577a72873ce7105dfce7">v</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#a9d82f3af1459c1efc910b77f3ccd3180">b</a>) const</td></tr>
<tr class="separator:ae3cf61f61e1aa50e2315e999827e7d59 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace6e9dbdfe9a1c3571452e2cd6ec9780 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ace6e9dbdfe9a1c3571452e2cd6ec9780">internal_get_block_vectors</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;block_vec_number, const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../df/d7a/MatrixBase__isOrthogonal_8cpp.html#a6ee409cfdca8577a72873ce7105dfce7">v</a>, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &gt; &amp;<a class="el" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>) const</td></tr>
<tr class="separator:ace6e9dbdfe9a1c3571452e2cd6ec9780 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cde8af922cd8054dbf352527dd682b1 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a0cde8af922cd8054dbf352527dd682b1">internal_get_block_vectors</a> (const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../df/d7a/MatrixBase__isOrthogonal_8cpp.html#a6ee409cfdca8577a72873ce7105dfce7">v</a>, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &gt; &amp;<a class="el" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>) const</td></tr>
<tr class="separator:a0cde8af922cd8054dbf352527dd682b1 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ca7f125e50493073d116ba8da271af5 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a2ca7f125e50493073d116ba8da271af5">internal_return_block_vectors</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;block_vec_number, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &gt; &amp;<a class="el" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../df/d7a/MatrixBase__isOrthogonal_8cpp.html#a6ee409cfdca8577a72873ce7105dfce7">v</a>) const</td></tr>
<tr class="separator:a2ca7f125e50493073d116ba8da271af5 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e2ce77e3efbcdd465f7ad7252936dfd inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a9e2ce77e3efbcdd465f7ad7252936dfd">internal_return_block_vectors</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &gt; &amp;<a class="el" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;<a class="el" href="../../df/d7a/MatrixBase__isOrthogonal_8cpp.html#a6ee409cfdca8577a72873ce7105dfce7">v</a>) const</td></tr>
<tr class="separator:a9e2ce77e3efbcdd465f7ad7252936dfd inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe001ffe270c96e761ec5205364976a7 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#abe001ffe270c96e761ec5205364976a7">internal_get_block</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> &amp;output_block) const</td></tr>
<tr class="separator:abe001ffe270c96e761ec5205364976a7 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f714d01cd2fdb791aa0795f34b9610a inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a4f714d01cd2fdb791aa0795f34b9610a">internal_get_block</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;block_i, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;block_j, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> &amp;output_block) const</td></tr>
<tr class="separator:a4f714d01cd2fdb791aa0795f34b9610a inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3eadb5d8d36200c4738537eac1647a6 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#af3eadb5d8d36200c4738537eac1647a6">internal_block_number</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;i_dof) const</td></tr>
<tr class="separator:af3eadb5d8d36200c4738537eac1647a6 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affcfd24c1ba15bf9cac712ffd46dc283 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#affcfd24c1ba15bf9cac712ffd46dc283">internal_index_in_block</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;i_dof) const</td></tr>
<tr class="separator:affcfd24c1ba15bf9cac712ffd46dc283 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19f8ca9f40ab804262cf95c1d5eb598c inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a19f8ca9f40ab804262cf95c1d5eb598c">internal_block_distribution_pt</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#a9d82f3af1459c1efc910b77f3ccd3180">b</a>) const</td></tr>
<tr class="memdesc:a19f8ca9f40ab804262cf95c1d5eb598c inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access function to the internal block distributions.  <a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a19f8ca9f40ab804262cf95c1d5eb598c">More...</a><br /></td></tr>
<tr class="separator:a19f8ca9f40ab804262cf95c1d5eb598c inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b3c4072be2bf4f0dfdd18f56a5d51bf inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a9b3c4072be2bf4f0dfdd18f56a5d51bf">insert_auxiliary_block_distribution</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;block_vec_number, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> *dist_pt)</td></tr>
<tr class="separator:a9b3c4072be2bf4f0dfdd18f56a5d51bf inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d8ff67e34e85a71c0f9bb68c0b10496 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a4d8ff67e34e85a71c0f9bb68c0b10496">block_matrix_test</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, const <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> *block_matrix_pt) const</td></tr>
<tr class="separator:a4d8ff67e34e85a71c0f9bb68c0b10496 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acac55e8dea1a0f63fcf32b7b058b0979 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#acac55e8dea1a0f63fcf32b7b058b0979">get_index_of_value</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; myType &gt; &amp;vec, const myType val, const <a class="el" href="../../d9/db9/classbool.html">bool</a> sorted=false) const</td></tr>
<tr class="separator:acac55e8dea1a0f63fcf32b7b058b0979 inherit pub_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classoomph_1_1Preconditioner"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classoomph_1_1Preconditioner')"><img src="../../closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html">oomph::Preconditioner</a></td></tr>
<tr class="memitem:a7bd8801e4395ccb88fe1f4296e77e9ab inherit pub_methods_classoomph_1_1Preconditioner"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#a7bd8801e4395ccb88fe1f4296e77e9ab">Preconditioner</a> ()</td></tr>
<tr class="memdesc:a7bd8801e4395ccb88fe1f4296e77e9ab inherit pub_methods_classoomph_1_1Preconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="../../db/d9e/classoomph_1_1Preconditioner.html#a7bd8801e4395ccb88fe1f4296e77e9ab">More...</a><br /></td></tr>
<tr class="separator:a7bd8801e4395ccb88fe1f4296e77e9ab inherit pub_methods_classoomph_1_1Preconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6e58c82c3cc4f4e44434a7d92d8e776 inherit pub_methods_classoomph_1_1Preconditioner"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#ab6e58c82c3cc4f4e44434a7d92d8e776">Preconditioner</a> (const <a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html">Preconditioner</a> &amp;)=delete</td></tr>
<tr class="memdesc:ab6e58c82c3cc4f4e44434a7d92d8e776 inherit pub_methods_classoomph_1_1Preconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken copy constructor.  <a href="../../db/d9e/classoomph_1_1Preconditioner.html#ab6e58c82c3cc4f4e44434a7d92d8e776">More...</a><br /></td></tr>
<tr class="separator:ab6e58c82c3cc4f4e44434a7d92d8e776 inherit pub_methods_classoomph_1_1Preconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63fefcfb21ae1c2a3b4232d2dfbb6340 inherit pub_methods_classoomph_1_1Preconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#a63fefcfb21ae1c2a3b4232d2dfbb6340">operator=</a> (const <a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html">Preconditioner</a> &amp;)=delete</td></tr>
<tr class="memdesc:a63fefcfb21ae1c2a3b4232d2dfbb6340 inherit pub_methods_classoomph_1_1Preconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken assignment operator.  <a href="../../db/d9e/classoomph_1_1Preconditioner.html#a63fefcfb21ae1c2a3b4232d2dfbb6340">More...</a><br /></td></tr>
<tr class="separator:a63fefcfb21ae1c2a3b4232d2dfbb6340 inherit pub_methods_classoomph_1_1Preconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab60952a82cc1b6b91fff5924eaa62c0e inherit pub_methods_classoomph_1_1Preconditioner"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#ab60952a82cc1b6b91fff5924eaa62c0e">~Preconditioner</a> ()</td></tr>
<tr class="memdesc:ab60952a82cc1b6b91fff5924eaa62c0e inherit pub_methods_classoomph_1_1Preconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor (empty)  <a href="../../db/d9e/classoomph_1_1Preconditioner.html#ab60952a82cc1b6b91fff5924eaa62c0e">More...</a><br /></td></tr>
<tr class="separator:ab60952a82cc1b6b91fff5924eaa62c0e inherit pub_methods_classoomph_1_1Preconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e469ffc87f31f6f2eebbe5ccf03d78b inherit pub_methods_classoomph_1_1Preconditioner"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#a1e469ffc87f31f6f2eebbe5ccf03d78b">preconditioner_solve_transpose</a> (const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;r, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;z)</td></tr>
<tr class="separator:a1e469ffc87f31f6f2eebbe5ccf03d78b inherit pub_methods_classoomph_1_1Preconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b95e7159585b5151f9e5dc1d1713655 inherit pub_methods_classoomph_1_1Preconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#a0b95e7159585b5151f9e5dc1d1713655">setup</a> (<a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html">DoubleMatrixBase</a> *<a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#a66726e9df31365df646cdf83a975aa26">matrix_pt</a>)</td></tr>
<tr class="separator:a0b95e7159585b5151f9e5dc1d1713655 inherit pub_methods_classoomph_1_1Preconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a783fae97e4b898f8de72b504a4f4bec6 inherit pub_methods_classoomph_1_1Preconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#a783fae97e4b898f8de72b504a4f4bec6">setup</a> (const <a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *problem_pt, <a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html">DoubleMatrixBase</a> *<a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#a66726e9df31365df646cdf83a975aa26">matrix_pt</a>)</td></tr>
<tr class="separator:a783fae97e4b898f8de72b504a4f4bec6 inherit pub_methods_classoomph_1_1Preconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad84467ec9243138945c4d5bbca8fa6c inherit pub_methods_classoomph_1_1Preconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#aad84467ec9243138945c4d5bbca8fa6c">enable_silent_preconditioner_setup</a> ()</td></tr>
<tr class="memdesc:aad84467ec9243138945c4d5bbca8fa6c inherit pub_methods_classoomph_1_1Preconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set up the block preconditioner quietly!  <a href="../../db/d9e/classoomph_1_1Preconditioner.html#aad84467ec9243138945c4d5bbca8fa6c">More...</a><br /></td></tr>
<tr class="separator:aad84467ec9243138945c4d5bbca8fa6c inherit pub_methods_classoomph_1_1Preconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a221f120f734fd3ca851db42b8defb53d inherit pub_methods_classoomph_1_1Preconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#a221f120f734fd3ca851db42b8defb53d">disable_silent_preconditioner_setup</a> ()</td></tr>
<tr class="memdesc:a221f120f734fd3ca851db42b8defb53d inherit pub_methods_classoomph_1_1Preconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Be verbose in the block preconditioner setup.  <a href="../../db/d9e/classoomph_1_1Preconditioner.html#a221f120f734fd3ca851db42b8defb53d">More...</a><br /></td></tr>
<tr class="separator:a221f120f734fd3ca851db42b8defb53d inherit pub_methods_classoomph_1_1Preconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af459b7333c4c64435fd8fa933535901f inherit pub_methods_classoomph_1_1Preconditioner"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#af459b7333c4c64435fd8fa933535901f">set_matrix_pt</a> (<a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html">DoubleMatrixBase</a> *<a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#a66726e9df31365df646cdf83a975aa26">matrix_pt</a>)</td></tr>
<tr class="memdesc:af459b7333c4c64435fd8fa933535901f inherit pub_methods_classoomph_1_1Preconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the matrix pointer.  <a href="../../db/d9e/classoomph_1_1Preconditioner.html#af459b7333c4c64435fd8fa933535901f">More...</a><br /></td></tr>
<tr class="separator:af459b7333c4c64435fd8fa933535901f inherit pub_methods_classoomph_1_1Preconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada7219933e05d94f39a46a8ddb4c749a inherit pub_methods_classoomph_1_1Preconditioner"><td class="memItemLeft" align="right" valign="top">virtual const <a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html">OomphCommunicator</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#ada7219933e05d94f39a46a8ddb4c749a">comm_pt</a> () const</td></tr>
<tr class="memdesc:ada7219933e05d94f39a46a8ddb4c749a inherit pub_methods_classoomph_1_1Preconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get function for comm pointer.  <a href="../../db/d9e/classoomph_1_1Preconditioner.html#ada7219933e05d94f39a46a8ddb4c749a">More...</a><br /></td></tr>
<tr class="separator:ada7219933e05d94f39a46a8ddb4c749a inherit pub_methods_classoomph_1_1Preconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a306f5a52f493816fcfda2dc9b2ee1dbf inherit pub_methods_classoomph_1_1Preconditioner"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#a306f5a52f493816fcfda2dc9b2ee1dbf">set_comm_pt</a> (const <a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html">OomphCommunicator</a> *const <a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#ada7219933e05d94f39a46a8ddb4c749a">comm_pt</a>)</td></tr>
<tr class="memdesc:a306f5a52f493816fcfda2dc9b2ee1dbf inherit pub_methods_classoomph_1_1Preconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the communicator pointer.  <a href="../../db/d9e/classoomph_1_1Preconditioner.html#a306f5a52f493816fcfda2dc9b2ee1dbf">More...</a><br /></td></tr>
<tr class="separator:a306f5a52f493816fcfda2dc9b2ee1dbf inherit pub_methods_classoomph_1_1Preconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9202e15534f063a8e21a8a60623eac9f inherit pub_methods_classoomph_1_1Preconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#a9202e15534f063a8e21a8a60623eac9f">setup_time</a> () const</td></tr>
<tr class="memdesc:a9202e15534f063a8e21a8a60623eac9f inherit pub_methods_classoomph_1_1Preconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the time to setup the preconditioner.  <a href="../../db/d9e/classoomph_1_1Preconditioner.html#a9202e15534f063a8e21a8a60623eac9f">More...</a><br /></td></tr>
<tr class="separator:a9202e15534f063a8e21a8a60623eac9f inherit pub_methods_classoomph_1_1Preconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1183f65956ef8a5b332a1246f418e907 inherit pub_methods_classoomph_1_1Preconditioner"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#a1183f65956ef8a5b332a1246f418e907">turn_into_subsidiary_block_preconditioner</a> (<a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html">BlockPreconditioner</a>&lt; <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> &gt; *master_block_prec_pt, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;doftype_in_master_preconditioner_coarse)</td></tr>
<tr class="separator:a1183f65956ef8a5b332a1246f418e907 inherit pub_methods_classoomph_1_1Preconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad565e8036a34a48259aed3ce91f821ef inherit pub_methods_classoomph_1_1Preconditioner"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#ad565e8036a34a48259aed3ce91f821ef">turn_into_subsidiary_block_preconditioner</a> (<a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html">BlockPreconditioner</a>&lt; <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> &gt; *master_block_prec_pt, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;doftype_in_master_preconditioner_coarse, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt;&gt; &amp;doftype_coarsen_map_coarse)</td></tr>
<tr class="separator:ad565e8036a34a48259aed3ce91f821ef inherit pub_methods_classoomph_1_1Preconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classoomph_1_1DistributableLinearAlgebraObject')"><img src="../../closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html">oomph::DistributableLinearAlgebraObject</a></td></tr>
<tr class="memitem:ac9492d59cff9d9b0098712ae72989cd3 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ac9492d59cff9d9b0098712ae72989cd3">DistributableLinearAlgebraObject</a> ()</td></tr>
<tr class="memdesc:ac9492d59cff9d9b0098712ae72989cd3 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default constructor - create a distribution.  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ac9492d59cff9d9b0098712ae72989cd3">More...</a><br /></td></tr>
<tr class="separator:ac9492d59cff9d9b0098712ae72989cd3 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7522391265c46e6c748fd660eae66f5e inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a7522391265c46e6c748fd660eae66f5e">DistributableLinearAlgebraObject</a> (const <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html">DistributableLinearAlgebraObject</a> &amp;<a class="el" href="../../da/d67/level3__impl_8h.html#a21849b14ce38b5bc40d43a5782d89138">matrix</a>)=delete</td></tr>
<tr class="memdesc:a7522391265c46e6c748fd660eae66f5e inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken copy constructor.  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a7522391265c46e6c748fd660eae66f5e">More...</a><br /></td></tr>
<tr class="separator:a7522391265c46e6c748fd660eae66f5e inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada5f539f36451c06e69de79bb129521b inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ada5f539f36451c06e69de79bb129521b">operator=</a> (const <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html">DistributableLinearAlgebraObject</a> &amp;)=delete</td></tr>
<tr class="memdesc:ada5f539f36451c06e69de79bb129521b inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken assignment operator.  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ada5f539f36451c06e69de79bb129521b">More...</a><br /></td></tr>
<tr class="separator:ada5f539f36451c06e69de79bb129521b inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4038de53b5737dc625411e7848d21dad inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a4038de53b5737dc625411e7848d21dad">~DistributableLinearAlgebraObject</a> ()</td></tr>
<tr class="memdesc:a4038de53b5737dc625411e7848d21dad inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a4038de53b5737dc625411e7848d21dad">More...</a><br /></td></tr>
<tr class="separator:a4038de53b5737dc625411e7848d21dad inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a603105384d60c9a3710378af39f538b9 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a> () const</td></tr>
<tr class="memdesc:a603105384d60c9a3710378af39f538b9 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">access to the LinearAlgebraDistribution  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">More...</a><br /></td></tr>
<tr class="separator:a603105384d60c9a3710378af39f538b9 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7569556f14fd68b28508920e89bd5eee inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a7569556f14fd68b28508920e89bd5eee">nrow</a> () const</td></tr>
<tr class="memdesc:a7569556f14fd68b28508920e89bd5eee inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">access function to the number of global rows.  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a7569556f14fd68b28508920e89bd5eee">More...</a><br /></td></tr>
<tr class="separator:a7569556f14fd68b28508920e89bd5eee inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bd7e1d242c69a28da85a804a7717fce inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">nrow_local</a> () const</td></tr>
<tr class="memdesc:a9bd7e1d242c69a28da85a804a7717fce inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">access function for the num of local rows on this processor.  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">More...</a><br /></td></tr>
<tr class="separator:a9bd7e1d242c69a28da85a804a7717fce inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21e966b025edec79067b41d7f1f25220 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a21e966b025edec79067b41d7f1f25220">nrow_local</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>) const</td></tr>
<tr class="memdesc:a21e966b025edec79067b41d7f1f25220 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">access function for the num of local rows on this processor.  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a21e966b025edec79067b41d7f1f25220">More...</a><br /></td></tr>
<tr class="separator:a21e966b025edec79067b41d7f1f25220 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab00a3919b8634c698749f14a4d92947d inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ab00a3919b8634c698749f14a4d92947d">first_row</a> () const</td></tr>
<tr class="memdesc:ab00a3919b8634c698749f14a4d92947d inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">access function for the first row on this processor  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ab00a3919b8634c698749f14a4d92947d">More...</a><br /></td></tr>
<tr class="separator:ab00a3919b8634c698749f14a4d92947d inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4266c1d18d8e102bad3f4aec26c9b7cf inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a4266c1d18d8e102bad3f4aec26c9b7cf">first_row</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>) const</td></tr>
<tr class="memdesc:a4266c1d18d8e102bad3f4aec26c9b7cf inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">access function for the first row on this processor  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a4266c1d18d8e102bad3f4aec26c9b7cf">More...</a><br /></td></tr>
<tr class="separator:a4266c1d18d8e102bad3f4aec26c9b7cf inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5505731e7e73d7e4251c67c7adec6bf5 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a5505731e7e73d7e4251c67c7adec6bf5">distributed</a> () const</td></tr>
<tr class="memdesc:a5505731e7e73d7e4251c67c7adec6bf5 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">distribution is serial or distributed  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a5505731e7e73d7e4251c67c7adec6bf5">More...</a><br /></td></tr>
<tr class="separator:a5505731e7e73d7e4251c67c7adec6bf5 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c35baa65e335043f62954c92c090a5a inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a8c35baa65e335043f62954c92c090a5a">distribution_built</a> () const</td></tr>
<tr class="separator:a8c35baa65e335043f62954c92c090a5a inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5340bac40b9559b0378037b57005203 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ac5340bac40b9559b0378037b57005203">build_distribution</a> (const <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> *const dist_pt)</td></tr>
<tr class="separator:ac5340bac40b9559b0378037b57005203 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adad20ac61a61d907f823da7694b50616 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#adad20ac61a61d907f823da7694b50616">build_distribution</a> (const <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> &amp;dist)</td></tr>
<tr class="separator:adad20ac61a61d907f823da7694b50616 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:ab45d7496790cc29a056b83c194aa2a1c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ab45d7496790cc29a056b83c194aa2a1c">assemble_inv_press_and_veloc_mass_matrix_diagonal</a> (<a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> *&amp;inv_p_mass_pt, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> *&amp;inv_v_mass_pt, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;do_both)</td></tr>
<tr class="separator:ab45d7496790cc29a056b83c194aa2a1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a94c09c485f93eb273f4217460da02811"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html">Preconditioner</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a94c09c485f93eb273f4217460da02811">P_preconditioner_pt</a></td></tr>
<tr class="memdesc:a94c09c485f93eb273f4217460da02811"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to the 'preconditioner' for the pressure matrix.  <a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a94c09c485f93eb273f4217460da02811">More...</a><br /></td></tr>
<tr class="separator:a94c09c485f93eb273f4217460da02811"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14a63179117e8cf5822c89ae2b5c9902"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html">Preconditioner</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a14a63179117e8cf5822c89ae2b5c9902">F_preconditioner_pt</a></td></tr>
<tr class="memdesc:a14a63179117e8cf5822c89ae2b5c9902"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to the 'preconditioner' for the F matrix.  <a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a14a63179117e8cf5822c89ae2b5c9902">More...</a><br /></td></tr>
<tr class="separator:a14a63179117e8cf5822c89ae2b5c9902"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a925aa01327e8a6af8c543d2983e92d2f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a925aa01327e8a6af8c543d2983e92d2f">Using_default_f_preconditioner</a></td></tr>
<tr class="memdesc:a925aa01327e8a6af8c543d2983e92d2f"><td class="mdescLeft">&#160;</td><td class="mdescRight">flag indicating whether the default F preconditioner is used  <a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a925aa01327e8a6af8c543d2983e92d2f">More...</a><br /></td></tr>
<tr class="separator:a925aa01327e8a6af8c543d2983e92d2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d9eb3bdee67fafd228e0923e61bd812"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6d9eb3bdee67fafd228e0923e61bd812">Using_default_p_preconditioner</a></td></tr>
<tr class="memdesc:a6d9eb3bdee67fafd228e0923e61bd812"><td class="mdescLeft">&#160;</td><td class="mdescRight">flag indicating whether the default P preconditioner is used  <a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6d9eb3bdee67fafd228e0923e61bd812">More...</a><br /></td></tr>
<tr class="separator:a6d9eb3bdee67fafd228e0923e61bd812"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3584d8bd088fad5ccce394899e167ca3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a3584d8bd088fad5ccce394899e167ca3">Preconditioner_has_been_setup</a></td></tr>
<tr class="separator:a3584d8bd088fad5ccce394899e167ca3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31a0119eae85695e267b2b0e6d58cfe6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a31a0119eae85695e267b2b0e6d58cfe6">Accept_non_NavierStokesElementWithDiagonalMassMatrices_elements</a></td></tr>
<tr class="separator:a31a0119eae85695e267b2b0e6d58cfe6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3e3b6635c1524d8413a75642e4bc4e1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ad3e3b6635c1524d8413a75642e4bc4e1">F_preconditioner_is_block_preconditioner</a></td></tr>
<tr class="separator:ad3e3b6635c1524d8413a75642e4bc4e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b551f53464a6331d3b0f3da61d712ff"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a0b551f53464a6331d3b0f3da61d712ff">Doc_time</a></td></tr>
<tr class="memdesc:a0b551f53464a6331d3b0f3da61d712ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set Doc_time to true for outputting results of timings.  <a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a0b551f53464a6331d3b0f3da61d712ff">More...</a><br /></td></tr>
<tr class="separator:a0b551f53464a6331d3b0f3da61d712ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d88aae7807a9a8d07491dda4c8c2465"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d1/dac/classoomph_1_1MatrixVectorProduct.html">MatrixVectorProduct</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a7d88aae7807a9a8d07491dda4c8c2465">QBt_mat_vec_pt</a></td></tr>
<tr class="memdesc:a7d88aae7807a9a8d07491dda4c8c2465"><td class="mdescLeft">&#160;</td><td class="mdescRight">MatrixVectorProduct operator for Qv^{-1} Bt.  <a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a7d88aae7807a9a8d07491dda4c8c2465">More...</a><br /></td></tr>
<tr class="separator:a7d88aae7807a9a8d07491dda4c8c2465"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7bc578498d001d81223b37badefb44b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d1/dac/classoomph_1_1MatrixVectorProduct.html">MatrixVectorProduct</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ad7bc578498d001d81223b37badefb44b">Bt_mat_vec_pt</a></td></tr>
<tr class="memdesc:ad7bc578498d001d81223b37badefb44b"><td class="mdescLeft">&#160;</td><td class="mdescRight">MatrixVectorProduct operator for Bt.  <a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ad7bc578498d001d81223b37badefb44b">More...</a><br /></td></tr>
<tr class="separator:ad7bc578498d001d81223b37badefb44b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66a5925f3bd0642de7bd3e61b8d740dc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d1/dac/classoomph_1_1MatrixVectorProduct.html">MatrixVectorProduct</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a66a5925f3bd0642de7bd3e61b8d740dc">F_mat_vec_pt</a></td></tr>
<tr class="memdesc:a66a5925f3bd0642de7bd3e61b8d740dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">MatrixVectorProduct operator for F.  <a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a66a5925f3bd0642de7bd3e61b8d740dc">More...</a><br /></td></tr>
<tr class="separator:a66a5925f3bd0642de7bd3e61b8d740dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a02950e86b2b8a092dda57587850d1c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d1/dac/classoomph_1_1MatrixVectorProduct.html">MatrixVectorProduct</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6a02950e86b2b8a092dda57587850d1c">E_mat_vec_pt</a></td></tr>
<tr class="memdesc:a6a02950e86b2b8a092dda57587850d1c"><td class="mdescLeft">&#160;</td><td class="mdescRight">MatrixVectorProduct operator for E = Fp Qp^{-1} (only for Fp variant)  <a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6a02950e86b2b8a092dda57587850d1c">More...</a><br /></td></tr>
<tr class="separator:a6a02950e86b2b8a092dda57587850d1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6153711f9561d3d617b78d3035147326"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6153711f9561d3d617b78d3035147326">Navier_stokes_mesh_pt</a></td></tr>
<tr class="separator:a6153711f9561d3d617b78d3035147326"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a932ce8737a185ca987a2c75d8af360d9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a932ce8737a185ca987a2c75d8af360d9">Allow_multiple_element_type_in_navier_stokes_mesh</a></td></tr>
<tr class="separator:a932ce8737a185ca987a2c75d8af360d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c6abbfacbceba68be65855cc32bccb1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6c6abbfacbceba68be65855cc32bccb1">Use_LSC</a></td></tr>
<tr class="memdesc:a6c6abbfacbceba68be65855cc32bccb1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Boolean to indicate use of LSC (true) or Fp (false) variant.  <a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6c6abbfacbceba68be65855cc32bccb1">More...</a><br /></td></tr>
<tr class="separator:a6c6abbfacbceba68be65855cc32bccb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3aa99e654544365b78d4dca057ed53e0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a3aa99e654544365b78d4dca057ed53e0">Use_robin_for_fp</a></td></tr>
<tr class="memdesc:a3aa99e654544365b78d4dca057ed53e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Use Robin BC elements for Fp preconditoner?  <a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a3aa99e654544365b78d4dca057ed53e0">More...</a><br /></td></tr>
<tr class="separator:a3aa99e654544365b78d4dca057ed53e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af34c14327511f1e7deb5726b85b05417"><td class="memItemLeft" align="right" valign="top">std::map&lt; <a class="el" href="../../d8/dc5/classoomph_1_1Data.html">Data</a> *, std::vector&lt; <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#af34c14327511f1e7deb5726b85b05417">Eqn_number_backup</a></td></tr>
<tr class="separator:af34c14327511f1e7deb5726b85b05417"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40ffaa90de4f861037cbd364789eb889"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a40ffaa90de4f861037cbd364789eb889">Pin_first_pressure_dof_in_press_adv_diff</a></td></tr>
<tr class="separator:a40ffaa90de4f861037cbd364789eb889"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32957b16d3827ea7e6f308e1f3b6f246"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a32957b16d3827ea7e6f308e1f3b6f246">Problem_pt</a></td></tr>
<tr class="separator:a32957b16d3827ea7e6f308e1f3b6f246"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_methods_classoomph_1_1BlockPreconditioner"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classoomph_1_1BlockPreconditioner')"><img src="../../closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;</a></td></tr>
<tr class="memitem:ae055f998f6145656352aacac22e545ad inherit pro_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ae055f998f6145656352aacac22e545ad">set_nmesh</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d5/d24/level2__real__impl_8h.html#a1224f27e9a621d957f8124bcade25bed">n</a>)</td></tr>
<tr class="separator:ae055f998f6145656352aacac22e545ad inherit pro_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af97821621b570d409e6662939e5f818d inherit pro_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#af97821621b570d409e6662939e5f818d">set_mesh</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>, const <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const <a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a3c0e92cb77c3e3179007fe9fd99b6428">mesh_pt</a>, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;allow_multiple_element_type_in_mesh=false)</td></tr>
<tr class="separator:af97821621b570d409e6662939e5f818d inherit pro_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a0ae880f098d5b1e9df78fc74c31dbf inherit pro_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a8a0ae880f098d5b1e9df78fc74c31dbf">set_replacement_dof_block</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;block_i, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;block_j, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> *<a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a571824cedc7e458a612111b51f20e5fb">replacement_dof_block_pt</a>)</td></tr>
<tr class="separator:a8a0ae880f098d5b1e9df78fc74c31dbf inherit pro_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6fb68db9e79048615984b005f8aa43b3 inherit pro_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a6fb68db9e79048615984b005f8aa43b3">any_mesh_distributed</a> () const</td></tr>
<tr class="separator:a6fb68db9e79048615984b005f8aa43b3 inherit pro_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb4dff3469cc6718103fddfdf3f3a7bb inherit pro_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#abb4dff3469cc6718103fddfdf3f3a7bb">internal_dof_number</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;i_dof) const</td></tr>
<tr class="separator:abb4dff3469cc6718103fddfdf3f3a7bb inherit pro_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e0a33327b5042dfba04baf46c045373 inherit pro_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a1e0a33327b5042dfba04baf46c045373">internal_index_in_dof</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;i_dof) const</td></tr>
<tr class="separator:a1e0a33327b5042dfba04baf46c045373 inherit pro_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac460225afc092cc5ed9d77acc6316536 inherit pro_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ac460225afc092cc5ed9d77acc6316536">internal_block_dimension</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#a9d82f3af1459c1efc910b77f3ccd3180">b</a>) const</td></tr>
<tr class="separator:ac460225afc092cc5ed9d77acc6316536 inherit pro_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe03c970690224b46a29e55e16992dd7 inherit pro_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#abe03c970690224b46a29e55e16992dd7">internal_dof_block_dimension</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a5a34e27e43935484f804192f7ca3dc24">i</a>) const</td></tr>
<tr class="separator:abe03c970690224b46a29e55e16992dd7 inherit pro_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e5b553f65e6c25354a5c908d507e8ee inherit pro_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a3e5b553f65e6c25354a5c908d507e8ee">master_nrow</a> () const</td></tr>
<tr class="separator:a3e5b553f65e6c25354a5c908d507e8ee inherit pro_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7297e4d24c2c7ae7af6a9ad009669928 inherit pro_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a7297e4d24c2c7ae7af6a9ad009669928">internal_master_dof_number</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#a9d82f3af1459c1efc910b77f3ccd3180">b</a>) const</td></tr>
<tr class="separator:a7297e4d24c2c7ae7af6a9ad009669928 inherit pro_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a16de88bd5369e729d761a6498fdd3f inherit pro_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a3a16de88bd5369e729d761a6498fdd3f">internal_preconditioner_matrix_distribution_pt</a> () const</td></tr>
<tr class="separator:a3a16de88bd5369e729d761a6498fdd3f inherit pro_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74eeff188f842dd8abdff1b7d9801d44 inherit pro_methods_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a74eeff188f842dd8abdff1b7d9801d44">preconditioner_matrix_distribution_pt</a> () const</td></tr>
<tr class="separator:a74eeff188f842dd8abdff1b7d9801d44 inherit pro_methods_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_classoomph_1_1DistributableLinearAlgebraObject"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classoomph_1_1DistributableLinearAlgebraObject')"><img src="../../closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html">oomph::DistributableLinearAlgebraObject</a></td></tr>
<tr class="memitem:a30742aa2ac9abcfa037179f2d28ff43a inherit pro_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a30742aa2ac9abcfa037179f2d28ff43a">clear_distribution</a> ()</td></tr>
<tr class="separator:a30742aa2ac9abcfa037179f2d28ff43a inherit pro_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classoomph_1_1BlockPreconditioner"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classoomph_1_1BlockPreconditioner')"><img src="../../closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;</a></td></tr>
<tr class="memitem:ad2cd49c5c823c4202046e97038f6e080 inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d2/d3a/classoomph_1_1MapMatrix.html">MapMatrix</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ad2cd49c5c823c4202046e97038f6e080">Replacement_dof_block_pt</a></td></tr>
<tr class="memdesc:ad2cd49c5c823c4202046e97038f6e080 inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">The replacement dof-level blocks.  <a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ad2cd49c5c823c4202046e97038f6e080">More...</a><br /></td></tr>
<tr class="separator:ad2cd49c5c823c4202046e97038f6e080 inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59e83eca59e3cdc41a93668539e138f1 inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a59e83eca59e3cdc41a93668539e138f1">Block_distribution_pt</a></td></tr>
<tr class="memdesc:a59e83eca59e3cdc41a93668539e138f1 inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">The distribution for the blocks.  <a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a59e83eca59e3cdc41a93668539e138f1">More...</a><br /></td></tr>
<tr class="separator:a59e83eca59e3cdc41a93668539e138f1 inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae047d81b8179dfd09b70cf35f40f62ca inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ae047d81b8179dfd09b70cf35f40f62ca">Block_to_dof_map_coarse</a></td></tr>
<tr class="separator:ae047d81b8179dfd09b70cf35f40f62ca inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a278946969944848b12bdc2ceaed91a07 inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a278946969944848b12bdc2ceaed91a07">Block_to_dof_map_fine</a></td></tr>
<tr class="memdesc:a278946969944848b12bdc2ceaed91a07 inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mapping for the block types to the most fine grain dof types.  <a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a278946969944848b12bdc2ceaed91a07">More...</a><br /></td></tr>
<tr class="separator:a278946969944848b12bdc2ceaed91a07 inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a015ba85d839a80512c6c4065e39a3d4a inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a015ba85d839a80512c6c4065e39a3d4a">Doftype_coarsen_map_coarse</a></td></tr>
<tr class="separator:a015ba85d839a80512c6c4065e39a3d4a inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4e2e47f537f9b6b4deae5792c493d65 inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#aa4e2e47f537f9b6b4deae5792c493d65">Doftype_coarsen_map_fine</a></td></tr>
<tr class="separator:aa4e2e47f537f9b6b4deae5792c493d65 inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38de6514d7065086335e0e6f60dc77a9 inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a38de6514d7065086335e0e6f60dc77a9">Internal_block_distribution_pt</a></td></tr>
<tr class="memdesc:a38de6514d7065086335e0e6f60dc77a9 inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Storage for the default distribution for each internal block.  <a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a38de6514d7065086335e0e6f60dc77a9">More...</a><br /></td></tr>
<tr class="separator:a38de6514d7065086335e0e6f60dc77a9 inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21867eb330dd1177c530a590ad1fa571 inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a21867eb330dd1177c530a590ad1fa571">Dof_block_distribution_pt</a></td></tr>
<tr class="separator:a21867eb330dd1177c530a590ad1fa571 inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f3a3ac8c192a83facd5b560f017413e inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a2f3a3ac8c192a83facd5b560f017413e">Allow_multiple_element_type_in_mesh</a></td></tr>
<tr class="separator:a2f3a3ac8c192a83facd5b560f017413e inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89adb506e8f9103c80b4b36cc309f536 inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; const <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a89adb506e8f9103c80b4b36cc309f536">Mesh_pt</a></td></tr>
<tr class="separator:a89adb506e8f9103c80b4b36cc309f536 inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43e9d73ff61daa00aea4e4deff0d6aff inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a43e9d73ff61daa00aea4e4deff0d6aff">Ndof_types_in_mesh</a></td></tr>
<tr class="separator:a43e9d73ff61daa00aea4e4deff0d6aff inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06c7426a2c8c096c8f4dc583444e0e0e inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a06c7426a2c8c096c8f4dc583444e0e0e">Internal_nblock_types</a></td></tr>
<tr class="separator:a06c7426a2c8c096c8f4dc583444e0e0e inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3985436e4645c202eadd47a4f4f466e2 inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a3985436e4645c202eadd47a4f4f466e2">Internal_ndof_types</a></td></tr>
<tr class="separator:a3985436e4645c202eadd47a4f4f466e2 inherit pro_attribs_classoomph_1_1BlockPreconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classoomph_1_1Preconditioner"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classoomph_1_1Preconditioner')"><img src="../../closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html">oomph::Preconditioner</a></td></tr>
<tr class="memitem:ad191d6be6caf8875700f54c939ec33e6 inherit pro_attribs_classoomph_1_1Preconditioner"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#ad191d6be6caf8875700f54c939ec33e6">Silent_preconditioner_setup</a></td></tr>
<tr class="memdesc:ad191d6be6caf8875700f54c939ec33e6 inherit pro_attribs_classoomph_1_1Preconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Boolean to indicate whether or not the build should be done silently.  <a href="../../db/d9e/classoomph_1_1Preconditioner.html#ad191d6be6caf8875700f54c939ec33e6">More...</a><br /></td></tr>
<tr class="separator:ad191d6be6caf8875700f54c939ec33e6 inherit pro_attribs_classoomph_1_1Preconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a6b2f6cd34495167ea766b47f055a7d inherit pro_attribs_classoomph_1_1Preconditioner"><td class="memItemLeft" align="right" valign="top">std::ostream *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#a2a6b2f6cd34495167ea766b47f055a7d">Stream_pt</a></td></tr>
<tr class="memdesc:a2a6b2f6cd34495167ea766b47f055a7d inherit pro_attribs_classoomph_1_1Preconditioner"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to the output stream &ndash; defaults to std::cout.  <a href="../../db/d9e/classoomph_1_1Preconditioner.html#a2a6b2f6cd34495167ea766b47f055a7d">More...</a><br /></td></tr>
<tr class="separator:a2a6b2f6cd34495167ea766b47f055a7d inherit pro_attribs_classoomph_1_1Preconditioner"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>///////////////////////////////////////////////////////////////////////// ///////////////////////////////////////////////////////////////////////// ///////////////////////////////////////////////////////////////////////// The least-squares commutator (LSC; formerly BFBT) Navier Stokes preconditioner. It uses blocks corresponding to the velocity and pressure unknowns, i.e. there are a total of 2x2 blocks, and all velocity components are treated as a single block of unknowns.</p>
<p>Here are the details: An "ideal" Navier-Stokes preconditioner would solve the system </p><p class="formulaDsp">
\[ \left( \begin{array}{cc} {\bf F} &amp; {\bf G} \\ {\bf D} &amp; {\bf 0} \end{array} \right) \left( \begin{array}{c} {\bf z}_u \\ {\bf z}_p \end{array} \right) = \left( \begin{array}{c} {\bf r}_u \\ {\bf r}_p \end{array} \right) \]
</p>
<p> where \( {\bf F}\) is the momentum block, \( {\bf G} \) the discrete gradient operator, and \( {\bf D}\) the discrete divergence operator. (For unstabilised elements, we have \( {\bf D} = {\bf G}^T \) and in much of the literature the divergence matrix is denoted by \( {\bf B} \) .) The use of this preconditioner would ensure the convergence of any iterative linear solver in a single iteration but its application is, of course, exactly as expensive as a direct solve. The LSC/BFBT preconditioner replaces the exact Jacobian by a block-triangular approximation </p><p class="formulaDsp">
\[ \left( \begin{array}{cc} {\bf F} &amp; {\bf G} \\ {\bf 0} &amp; -{\bf M}_s \end{array} \right) \left( \begin{array}{c} {\bf z}_u \\ {\bf z}_p \end{array} \right) = \left( \begin{array}{c} {\bf r}_u \\ {\bf r}_p \end{array} \right), \]
</p>
<p> where \({\bf M}_s\) is an approximation to the pressure Schur-complement \( {\bf S} = {\bf D} {\bf F}^{-1}{\bf G}. \) This system can be solved in two steps:</p><ol type="1">
<li><p class="startli">Solve the second row for \( {\bf z}_p\) via</p>
<p class="formulaDsp">
\[ {\bf z}_p = - {\bf M}_s^{-1} {\bf r}_p \]
</p>
</li>
<li><p class="startli">Given \( {\bf z}_p \) , solve the first row for \( {\bf z}_u\) via</p>
<p class="formulaDsp">
\[ {\bf z}_u = {\bf F}^{-1} \big( {\bf r}_u - {\bf G} {\bf z}_p \big) \]
</p>
</li>
</ol>
<p>In the LSC/BFBT preconditioner, the action of the inverse pressure Schur complement </p><p class="formulaDsp">
\[ {\bf z}_p = - {\bf M}_s^{-1} {\bf r}_p \]
</p>
<p> is approximated by </p><p class="formulaDsp">
\[ {\bf z}_p = - \big({\bf D} \widehat{\bf Q}^{-1}{\bf G} \big)^{-1} \big({\bf D} \widehat{\bf Q}^{-1}{\bf F} \widehat{\bf Q}^{-1}{\bf G}\big) \big({\bf D} \widehat{\bf Q}^{-1}{\bf G} \big)^{-1} {\bf r}_p, \]
</p>
<p> where \( \widehat{\bf Q} \) is the diagonal of the velocity mass matrix. The evaluation of this expression involves two linear solves involving the matrix </p><p class="formulaDsp">
\[ {\bf P} = \big({\bf D} \widehat{\bf Q}^{-1}{\bf G} \big) \]
</p>
<p> which has the character of a matrix arising from the discretisation of a Poisson problem on the pressure space. We also have to evaluate matrix-vector products with the matrix </p><p class="formulaDsp">
\[ {\bf E}={\bf D}\widehat{\bf Q}^{-1}{\bf F}\widehat{\bf Q}^{-1}{\bf G} \]
</p>
<p> Details of the theory can be found in "Finite Elements and Fast Iterative Solvers with Applications in Incompressible Fluid Dynamics" by Howard C. Elman, David J. Silvester, and Andrew J. Wathen, published by Oxford University Press, 2006.</p>
<p>In our implementation of the preconditioner, the linear systems can either be solved "exactly", using SuperLU (in its incarnation as an exact preconditioner; this is the default) or by any other Preconditioner (inexact solver) specified via the access functions </p><div class="fragment"><div class="line"><a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ab2f387b87192dd2f7b6725cfe3aae44e">NavierStokesSchurComplementPreconditioner::set_f_preconditioner</a>(...)</div>
<div class="ttc" id="aclassoomph_1_1NavierStokesSchurComplementPreconditioner_html_ab2f387b87192dd2f7b6725cfe3aae44e"><div class="ttname"><a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ab2f387b87192dd2f7b6725cfe3aae44e">oomph::NavierStokesSchurComplementPreconditioner::set_f_preconditioner</a></div><div class="ttdeci">void set_f_preconditioner(Preconditioner *new_f_preconditioner_pt)</div><div class="ttdoc">Function to set a new momentum matrix preconditioner (inexact solver)</div><div class="ttdef"><b>Definition:</b> navier_stokes_preconditioners.h:769</div></div>
</div><!-- fragment --><p> or </p><div class="fragment"><div class="line"><a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a48f0d5e878eccab6e7f080c92d4bc6f5">NavierStokesSchurComplementPreconditioner::set_p_preconditioner</a>(...)</div>
<div class="ttc" id="aclassoomph_1_1NavierStokesSchurComplementPreconditioner_html_a48f0d5e878eccab6e7f080c92d4bc6f5"><div class="ttname"><a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a48f0d5e878eccab6e7f080c92d4bc6f5">oomph::NavierStokesSchurComplementPreconditioner::set_p_preconditioner</a></div><div class="ttdeci">void set_p_preconditioner(Preconditioner *new_p_preconditioner_pt)</div><div class="ttdoc">Function to set a new pressure matrix preconditioner (inexact solver)</div><div class="ttdef"><b>Definition:</b> navier_stokes_preconditioners.h:745</div></div>
</div><!-- fragment --> </div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ac5ca2d9d665f4bd0a9f2e2cc103486b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5ca2d9d665f4bd0a9f2e2cc103486b0">&#9670;&nbsp;</a></span>NavierStokesSchurComplementPreconditioner() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">oomph::NavierStokesSchurComplementPreconditioner::NavierStokesSchurComplementPreconditioner </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *&#160;</td>
          <td class="paramname"><em>problem_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructor - sets defaults for control flags. </p>
<div class="fragment"><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;      : BlockPreconditioner&lt;CRDoubleMatrix&gt;(), <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a32957b16d3827ea7e6f308e1f3b6f246">Problem_pt</a>(<a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#afc57fedbcd960d99c5ab3f135eacb612">problem_pt</a>)</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    {</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;      <span class="comment">// Insist that all elements are of type</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;      <span class="comment">// NavierStokesElementWithDiagonalMassMatrices and issue a warning</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;      <span class="comment">// if one is not.</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a31a0119eae85695e267b2b0e6d58cfe6">Accept_non_NavierStokesElementWithDiagonalMassMatrices_elements</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160; </div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;      <span class="comment">// Use Robin BC elements for Fp preconditioner -- yes by default</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a3aa99e654544365b78d4dca057ed53e0">Use_robin_for_fp</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160; </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;      <span class="comment">// Flag to indicate that the preconditioner has been setup</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;      <span class="comment">// previously -- if setup() is called again, data can</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;      <span class="comment">// be wiped.</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a3584d8bd088fad5ccce394899e167ca3">Preconditioner_has_been_setup</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160; </div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;      <span class="comment">// By default we use the LSC version</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6c6abbfacbceba68be65855cc32bccb1">Use_LSC</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160; </div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      <span class="comment">// By default we use SuperLU for both p and f blocks</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6d9eb3bdee67fafd228e0923e61bd812">Using_default_p_preconditioner</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a925aa01327e8a6af8c543d2983e92d2f">Using_default_f_preconditioner</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160; </div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;      <span class="comment">// Pin pressure dof in press adv diff problem for Fp precond</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a40ffaa90de4f861037cbd364789eb889">Pin_first_pressure_dof_in_press_adv_diff</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160; </div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6153711f9561d3d617b78d3035147326">Navier_stokes_mesh_pt</a> = 0;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160; </div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;      <span class="comment">// Set default preconditioners (inexact solvers) -- they are</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;      <span class="comment">// members of this class!</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a94c09c485f93eb273f4217460da02811">P_preconditioner_pt</a> = 0;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a14a63179117e8cf5822c89ae2b5c9902">F_preconditioner_pt</a> = 0;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160; </div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;      <span class="comment">// set Doc_time to false</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a0b551f53464a6331d3b0f3da61d712ff">Doc_time</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160; </div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;      <span class="comment">// null the off diagonal Block matrix pt</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ad7bc578498d001d81223b37badefb44b">Bt_mat_vec_pt</a> = 0;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160; </div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;      <span class="comment">// null the F matrix vector product helper</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a66a5925f3bd0642de7bd3e61b8d740dc">F_mat_vec_pt</a> = 0;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160; </div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;      <span class="comment">// null the QBt matrix vector product pt</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a7d88aae7807a9a8d07491dda4c8c2465">QBt_mat_vec_pt</a> = 0;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160; </div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;      <span class="comment">// null the E matrix vector product helper in Fp</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6a02950e86b2b8a092dda57587850d1c">E_mat_vec_pt</a> = 0;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160; </div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;      <span class="comment">// Initially assume that there are no multiple element types in the</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;      <span class="comment">// Navier-Stokes mesh</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a932ce8737a185ca987a2c75d8af360d9">Allow_multiple_element_type_in_navier_stokes_mesh</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1NavierStokesSchurComplementPreconditioner_html_a0b551f53464a6331d3b0f3da61d712ff"><div class="ttname"><a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a0b551f53464a6331d3b0f3da61d712ff">oomph::NavierStokesSchurComplementPreconditioner::Doc_time</a></div><div class="ttdeci">bool Doc_time</div><div class="ttdoc">Set Doc_time to true for outputting results of timings.</div><div class="ttdef"><b>Definition:</b> navier_stokes_preconditioners.h:1155</div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesSchurComplementPreconditioner_html_a14a63179117e8cf5822c89ae2b5c9902"><div class="ttname"><a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a14a63179117e8cf5822c89ae2b5c9902">oomph::NavierStokesSchurComplementPreconditioner::F_preconditioner_pt</a></div><div class="ttdeci">Preconditioner * F_preconditioner_pt</div><div class="ttdoc">Pointer to the 'preconditioner' for the F matrix.</div><div class="ttdef"><b>Definition:</b> navier_stokes_preconditioners.h:1121</div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesSchurComplementPreconditioner_html_a31a0119eae85695e267b2b0e6d58cfe6"><div class="ttname"><a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a31a0119eae85695e267b2b0e6d58cfe6">oomph::NavierStokesSchurComplementPreconditioner::Accept_non_NavierStokesElementWithDiagonalMassMatrices_elements</a></div><div class="ttdeci">bool Accept_non_NavierStokesElementWithDiagonalMassMatrices_elements</div><div class="ttdef"><b>Definition:</b> navier_stokes_preconditioners.h:1137</div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesSchurComplementPreconditioner_html_a32957b16d3827ea7e6f308e1f3b6f246"><div class="ttname"><a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a32957b16d3827ea7e6f308e1f3b6f246">oomph::NavierStokesSchurComplementPreconditioner::Problem_pt</a></div><div class="ttdeci">Problem * Problem_pt</div><div class="ttdef"><b>Definition:</b> navier_stokes_preconditioners.h:1196</div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesSchurComplementPreconditioner_html_a3584d8bd088fad5ccce394899e167ca3"><div class="ttname"><a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a3584d8bd088fad5ccce394899e167ca3">oomph::NavierStokesSchurComplementPreconditioner::Preconditioner_has_been_setup</a></div><div class="ttdeci">bool Preconditioner_has_been_setup</div><div class="ttdef"><b>Definition:</b> navier_stokes_preconditioners.h:1132</div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesSchurComplementPreconditioner_html_a3aa99e654544365b78d4dca057ed53e0"><div class="ttname"><a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a3aa99e654544365b78d4dca057ed53e0">oomph::NavierStokesSchurComplementPreconditioner::Use_robin_for_fp</a></div><div class="ttdeci">bool Use_robin_for_fp</div><div class="ttdoc">Use Robin BC elements for Fp preconditoner?</div><div class="ttdef"><b>Definition:</b> navier_stokes_preconditioners.h:1181</div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesSchurComplementPreconditioner_html_a40ffaa90de4f861037cbd364789eb889"><div class="ttname"><a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a40ffaa90de4f861037cbd364789eb889">oomph::NavierStokesSchurComplementPreconditioner::Pin_first_pressure_dof_in_press_adv_diff</a></div><div class="ttdeci">bool Pin_first_pressure_dof_in_press_adv_diff</div><div class="ttdef"><b>Definition:</b> navier_stokes_preconditioners.h:1192</div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesSchurComplementPreconditioner_html_a6153711f9561d3d617b78d3035147326"><div class="ttname"><a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6153711f9561d3d617b78d3035147326">oomph::NavierStokesSchurComplementPreconditioner::Navier_stokes_mesh_pt</a></div><div class="ttdeci">Mesh * Navier_stokes_mesh_pt</div><div class="ttdef"><b>Definition:</b> navier_stokes_preconditioners.h:1171</div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesSchurComplementPreconditioner_html_a66a5925f3bd0642de7bd3e61b8d740dc"><div class="ttname"><a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a66a5925f3bd0642de7bd3e61b8d740dc">oomph::NavierStokesSchurComplementPreconditioner::F_mat_vec_pt</a></div><div class="ttdeci">MatrixVectorProduct * F_mat_vec_pt</div><div class="ttdoc">MatrixVectorProduct operator for F.</div><div class="ttdef"><b>Definition:</b> navier_stokes_preconditioners.h:1164</div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesSchurComplementPreconditioner_html_a6a02950e86b2b8a092dda57587850d1c"><div class="ttname"><a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6a02950e86b2b8a092dda57587850d1c">oomph::NavierStokesSchurComplementPreconditioner::E_mat_vec_pt</a></div><div class="ttdeci">MatrixVectorProduct * E_mat_vec_pt</div><div class="ttdoc">MatrixVectorProduct operator for E = Fp Qp^{-1} (only for Fp variant)</div><div class="ttdef"><b>Definition:</b> navier_stokes_preconditioners.h:1167</div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesSchurComplementPreconditioner_html_a6c6abbfacbceba68be65855cc32bccb1"><div class="ttname"><a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6c6abbfacbceba68be65855cc32bccb1">oomph::NavierStokesSchurComplementPreconditioner::Use_LSC</a></div><div class="ttdeci">bool Use_LSC</div><div class="ttdoc">Boolean to indicate use of LSC (true) or Fp (false) variant.</div><div class="ttdef"><b>Definition:</b> navier_stokes_preconditioners.h:1178</div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesSchurComplementPreconditioner_html_a6d9eb3bdee67fafd228e0923e61bd812"><div class="ttname"><a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6d9eb3bdee67fafd228e0923e61bd812">oomph::NavierStokesSchurComplementPreconditioner::Using_default_p_preconditioner</a></div><div class="ttdeci">bool Using_default_p_preconditioner</div><div class="ttdoc">flag indicating whether the default P preconditioner is used</div><div class="ttdef"><b>Definition:</b> navier_stokes_preconditioners.h:1127</div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesSchurComplementPreconditioner_html_a7d88aae7807a9a8d07491dda4c8c2465"><div class="ttname"><a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a7d88aae7807a9a8d07491dda4c8c2465">oomph::NavierStokesSchurComplementPreconditioner::QBt_mat_vec_pt</a></div><div class="ttdeci">MatrixVectorProduct * QBt_mat_vec_pt</div><div class="ttdoc">MatrixVectorProduct operator for Qv^{-1} Bt.</div><div class="ttdef"><b>Definition:</b> navier_stokes_preconditioners.h:1158</div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesSchurComplementPreconditioner_html_a925aa01327e8a6af8c543d2983e92d2f"><div class="ttname"><a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a925aa01327e8a6af8c543d2983e92d2f">oomph::NavierStokesSchurComplementPreconditioner::Using_default_f_preconditioner</a></div><div class="ttdeci">bool Using_default_f_preconditioner</div><div class="ttdoc">flag indicating whether the default F preconditioner is used</div><div class="ttdef"><b>Definition:</b> navier_stokes_preconditioners.h:1124</div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesSchurComplementPreconditioner_html_a932ce8737a185ca987a2c75d8af360d9"><div class="ttname"><a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a932ce8737a185ca987a2c75d8af360d9">oomph::NavierStokesSchurComplementPreconditioner::Allow_multiple_element_type_in_navier_stokes_mesh</a></div><div class="ttdeci">bool Allow_multiple_element_type_in_navier_stokes_mesh</div><div class="ttdef"><b>Definition:</b> navier_stokes_preconditioners.h:1175</div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesSchurComplementPreconditioner_html_a94c09c485f93eb273f4217460da02811"><div class="ttname"><a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a94c09c485f93eb273f4217460da02811">oomph::NavierStokesSchurComplementPreconditioner::P_preconditioner_pt</a></div><div class="ttdeci">Preconditioner * P_preconditioner_pt</div><div class="ttdoc">Pointer to the 'preconditioner' for the pressure matrix.</div><div class="ttdef"><b>Definition:</b> navier_stokes_preconditioners.h:1118</div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesSchurComplementPreconditioner_html_ad7bc578498d001d81223b37badefb44b"><div class="ttname"><a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ad7bc578498d001d81223b37badefb44b">oomph::NavierStokesSchurComplementPreconditioner::Bt_mat_vec_pt</a></div><div class="ttdeci">MatrixVectorProduct * Bt_mat_vec_pt</div><div class="ttdoc">MatrixVectorProduct operator for Bt.</div><div class="ttdef"><b>Definition:</b> navier_stokes_preconditioners.h:1161</div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesSchurComplementPreconditioner_html_afc57fedbcd960d99c5ab3f135eacb612"><div class="ttname"><a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#afc57fedbcd960d99c5ab3f135eacb612">oomph::NavierStokesSchurComplementPreconditioner::problem_pt</a></div><div class="ttdeci">Problem * problem_pt() const</div><div class="ttdef"><b>Definition:</b> navier_stokes_preconditioners.h:689</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a31a0119eae85695e267b2b0e6d58cfe6">Accept_non_NavierStokesElementWithDiagonalMassMatrices_elements</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a932ce8737a185ca987a2c75d8af360d9">Allow_multiple_element_type_in_navier_stokes_mesh</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ad7bc578498d001d81223b37badefb44b">Bt_mat_vec_pt</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a0b551f53464a6331d3b0f3da61d712ff">Doc_time</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6a02950e86b2b8a092dda57587850d1c">E_mat_vec_pt</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a66a5925f3bd0642de7bd3e61b8d740dc">F_mat_vec_pt</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a14a63179117e8cf5822c89ae2b5c9902">F_preconditioner_pt</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6153711f9561d3d617b78d3035147326">Navier_stokes_mesh_pt</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a94c09c485f93eb273f4217460da02811">P_preconditioner_pt</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a40ffaa90de4f861037cbd364789eb889">Pin_first_pressure_dof_in_press_adv_diff</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a3584d8bd088fad5ccce394899e167ca3">Preconditioner_has_been_setup</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a7d88aae7807a9a8d07491dda4c8c2465">QBt_mat_vec_pt</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6c6abbfacbceba68be65855cc32bccb1">Use_LSC</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a3aa99e654544365b78d4dca057ed53e0">Use_robin_for_fp</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a925aa01327e8a6af8c543d2983e92d2f">Using_default_f_preconditioner</a>, and <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6d9eb3bdee67fafd228e0923e61bd812">Using_default_p_preconditioner</a>.</p>

</div>
</div>
<a id="ad954b4f67329c643d5219ed573805b81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad954b4f67329c643d5219ed573805b81">&#9670;&nbsp;</a></span>~NavierStokesSchurComplementPreconditioner()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual oomph::NavierStokesSchurComplementPreconditioner::~NavierStokesSchurComplementPreconditioner </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destructor. </p>
<div class="fragment"><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    {</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a5cac2493de85690e3954949eb2a27d2c">clean_up_memory</a>();</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1NavierStokesSchurComplementPreconditioner_html_a5cac2493de85690e3954949eb2a27d2c"><div class="ttname"><a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a5cac2493de85690e3954949eb2a27d2c">oomph::NavierStokesSchurComplementPreconditioner::clean_up_memory</a></div><div class="ttdeci">void clean_up_memory()</div><div class="ttdoc">Helper function to delete preconditioner data.</div><div class="ttdef"><b>Definition:</b> navier_stokes_preconditioners.cc:1672</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a5cac2493de85690e3954949eb2a27d2c">clean_up_memory()</a>.</p>

</div>
</div>
<a id="aba0ebcbc6963a62ad492fd9271e349a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba0ebcbc6963a62ad492fd9271e349a5">&#9670;&nbsp;</a></span>NavierStokesSchurComplementPreconditioner() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">oomph::NavierStokesSchurComplementPreconditioner::NavierStokesSchurComplementPreconditioner </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html">NavierStokesSchurComplementPreconditioner</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Broken copy constructor. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ab45d7496790cc29a056b83c194aa2a1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab45d7496790cc29a056b83c194aa2a1c">&#9670;&nbsp;</a></span>assemble_inv_press_and_veloc_mass_matrix_diagonal()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::NavierStokesSchurComplementPreconditioner::assemble_inv_press_and_veloc_mass_matrix_diagonal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> *&amp;&#160;</td>
          <td class="paramname"><em>inv_p_mass_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> *&amp;&#160;</td>
          <td class="paramname"><em>inv_v_mass_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;&#160;</td>
          <td class="paramname"><em>do_both</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Helper function to assemble the inverse diagonals of the pressure and velocity mass matrices from the elemental contributions defined in NavierStokesEquations&lt;DIM&gt;. If do_both=true, both are computed, otherwise only the velocity mass matrix (the LSC version of the preconditioner only needs that one)</p>
<p>Helper function to assemble the inverse diagonals of the pressure and velocity mass matrix from the elemental contributions defined in NavierStokesElementWithDiagonalMassMatrices:: get_pressure_and_velocity_mass_matrix_diagonal(...) If do_both=true, both are computed, otherwise only the velocity mass matrix (the LSC version of the preconditioner only needs that one) </p>
<div class="fragment"><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;  {</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <span class="comment">// determine the velocity rows required by this processor</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    <span class="keywordtype">unsigned</span> v_first_row = this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a77ac0b71404620e7be8b15ac2d588495">block_distribution_pt</a>(0)-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a2634e540a78fe1ee3f5c907aff500b58">first_row</a>();</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <span class="keywordtype">unsigned</span> v_nrow_local = this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a77ac0b71404620e7be8b15ac2d588495">block_distribution_pt</a>(0)-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">nrow_local</a>();</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    <span class="keywordtype">unsigned</span> v_nrow = this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a77ac0b71404620e7be8b15ac2d588495">block_distribution_pt</a>(0)-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#aafad0b69de2284808366b65bd63e493b">nrow</a>();</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160; </div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <span class="comment">// create storage for the diagonals</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    <span class="keywordtype">double</span>* v_values = <span class="keyword">new</span> <span class="keywordtype">double</span>[v_nrow_local];</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; v_nrow_local; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    {</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;      v_values[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = 0.0;</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    }</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160; </div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <span class="comment">// Equivalent information for pressure mass matrix (only needed for</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    <span class="comment">// Fp version)</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    <span class="keywordtype">unsigned</span> p_first_row = 0;</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    <span class="keywordtype">unsigned</span> p_nrow_local = 0;</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <span class="keywordtype">unsigned</span> p_nrow = 0;</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    <span class="keywordtype">double</span>* p_values = 0;</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6c6abbfacbceba68be65855cc32bccb1">Use_LSC</a>)</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    {</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;      <span class="comment">// determine the pressure rows required by this processor</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;      p_first_row = this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a77ac0b71404620e7be8b15ac2d588495">block_distribution_pt</a>(1)-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a2634e540a78fe1ee3f5c907aff500b58">first_row</a>();</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;      p_nrow_local = this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a77ac0b71404620e7be8b15ac2d588495">block_distribution_pt</a>(1)-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">nrow_local</a>();</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;      p_nrow = this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a77ac0b71404620e7be8b15ac2d588495">block_distribution_pt</a>(1)-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#aafad0b69de2284808366b65bd63e493b">nrow</a>();</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160; </div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;      <span class="comment">// create storage for the diagonals</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;      p_values = <span class="keyword">new</span> <span class="keywordtype">double</span>[p_nrow_local];</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; p_nrow_local; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;      {</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;        p_values[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = 0.0;</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;      }</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    }</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160; </div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    <span class="comment">// if the problem is distributed</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a5505731e7e73d7e4251c67c7adec6bf5">distributed</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#afc57fedbcd960d99c5ab3f135eacb612">problem_pt</a>()-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a5505731e7e73d7e4251c67c7adec6bf5">distributed</a>() ||</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a005d978655022d1a04da7397cf5d0e83">master_distribution_pt</a>()-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a5505731e7e73d7e4251c67c7adec6bf5">distributed</a>())</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    {</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;      distributed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    }</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160; </div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    <span class="comment">// next we get the diagonal velocity mass matrix data</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a5505731e7e73d7e4251c67c7adec6bf5">distributed</a>)</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    {</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160; </div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;      <span class="comment">// the number of processors</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;      <span class="keywordtype">unsigned</span> nproc = <a class="code" href="../../db/d9e/classoomph_1_1Preconditioner.html#ada7219933e05d94f39a46a8ddb4c749a">comm_pt</a>()-&gt;<a class="code" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a6c78c72666f4b102c2bccf200f0853b7">nproc</a>();</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160; </div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;      <span class="comment">// and my rank</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;      <span class="keywordtype">unsigned</span> my_rank = <a class="code" href="../../db/d9e/classoomph_1_1Preconditioner.html#ada7219933e05d94f39a46a8ddb4c749a">comm_pt</a>()-&gt;<a class="code" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a670b34aab05bfe0b96d0e0fabf583c7a">my_rank</a>();</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160; </div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;      <span class="comment">// determine the rows for which we have lookup rows</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160; </div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;      <span class="comment">// if the problem is NOT distributed then we only classify global</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;      <span class="comment">// equations on this processor to avoid duplication (as every processor</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;      <span class="comment">// holds every element)</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;      <span class="keywordtype">unsigned</span> first_lookup_row = 0;</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;      <span class="keywordtype">unsigned</span> last_lookup_row = 0;</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;      first_lookup_row = this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a005d978655022d1a04da7397cf5d0e83">master_distribution_pt</a>()-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a2634e540a78fe1ee3f5c907aff500b58">first_row</a>();</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;      last_lookup_row =</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;        first_lookup_row + this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a005d978655022d1a04da7397cf5d0e83">master_distribution_pt</a>()-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">nrow_local</a>() - 1;</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160; </div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;      <span class="comment">// find number of local elements</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;      <span class="keywordtype">unsigned</span> n_el = <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6153711f9561d3d617b78d3035147326">Navier_stokes_mesh_pt</a>-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">nelement</a>();</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160; </div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;      <span class="comment">// get the master distribution pt</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;      <span class="keyword">const</span> LinearAlgebraDistribution* <a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a005d978655022d1a04da7397cf5d0e83">master_distribution_pt</a> =</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a005d978655022d1a04da7397cf5d0e83">master_distribution_pt</a>();</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160; </div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;      <span class="comment">// Do the two blocks (0: veloc; 1: press)</span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;      <span class="keywordtype">unsigned</span> max_block = 0;</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6c6abbfacbceba68be65855cc32bccb1">Use_LSC</a>) max_block = 1;</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> block_index = 0; block_index &lt;= max_block; block_index++)</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;      {</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        <span class="comment">// Local working variables: Default to velocity</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        <span class="keywordtype">unsigned</span> v_or_p_first_row = v_first_row;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;        <span class="keywordtype">double</span>* v_or_p_values = v_values;</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;        <span class="comment">// Switch to pressure</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        <span class="keywordflow">if</span> (block_index == 1)</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;        {</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;          v_or_p_first_row = p_first_row;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;          v_or_p_values = p_values;</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;        }</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160; </div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160; </div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;        <span class="comment">// the diagonal mass matrix contributions that have been</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;        <span class="comment">// classified and should be sent to another processor</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;        Vector&lt;double&gt;* classified_contributions_send =</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;          <span class="keyword">new</span> Vector&lt;double&gt;[nproc];</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160; </div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;        <span class="comment">// the corresponding block indices</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;        Vector&lt;unsigned&gt;* classified_indices_send = <span class="keyword">new</span> Vector&lt;unsigned&gt;[nproc];</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160; </div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;        <span class="comment">// the matrix contributions that cannot be classified by this processor</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;        <span class="comment">// and therefore must be sent to another for classification</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;        Vector&lt;double&gt;* unclassified_contributions_send =</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;          <span class="keyword">new</span> Vector&lt;double&gt;[nproc];</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160; </div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;        <span class="comment">// the corresponding global indices that require classification</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;        Vector&lt;unsigned&gt;* unclassified_indices_send =</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;          <span class="keyword">new</span> Vector&lt;unsigned&gt;[nproc];</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160; </div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;        <span class="comment">// get the velocity or pressure distribution pt</span></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;        <span class="keyword">const</span> LinearAlgebraDistribution* velocity_or_press_dist_pt =</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;          this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a77ac0b71404620e7be8b15ac2d588495">block_distribution_pt</a>(block_index);</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160; </div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;        <span class="comment">// get the contribution for each element</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; n_el; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;        {</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;          <span class="comment">// Get element</span></div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;          GeneralisedElement* el_pt = <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6153711f9561d3d617b78d3035147326">Navier_stokes_mesh_pt</a>-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">element_pt</a>(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>);</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160; </div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;          <span class="comment">// check that the element is not halo</span></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;          <span class="keywordflow">if</span> (!el_pt-&gt;is_halo())</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;          {</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;            <span class="comment">// find number of degrees of freedom in the element</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;            <span class="comment">// (this is slightly too big because it includes the</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;            <span class="comment">// pressure dofs but this doesn&#39;t matter)</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;            <span class="keywordtype">unsigned</span> el_dof = el_pt-&gt;<a class="code" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a37204f67b37d212fd170c68d48f6da57">ndof</a>();</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160; </div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;            <span class="comment">// Allocate local storage for the element&#39;s contribution to the</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;            <span class="comment">// mass matrix diagonal</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;            Vector&lt;double&gt; el_vmm_diagonal(el_dof, 0.0);</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;            Vector&lt;double&gt; el_pmm_diagonal(el_dof, 0.0);</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160; </div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;            <span class="keywordtype">unsigned</span> which_one = 2;</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;            <span class="keywordflow">if</span> (block_index == 1) which_one = 1;</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160; </div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;            NavierStokesElementWithDiagonalMassMatrices* cast_el_pt = 0;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;            cast_el_pt =</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;              <span class="keyword">dynamic_cast&lt;</span>NavierStokesElementWithDiagonalMassMatrices*<span class="keyword">&gt;</span>(el_pt);</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;            <span class="keywordflow">if</span> (cast_el_pt != 0)</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;            {</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;              cast_el_pt-&gt;get_pressure_and_velocity_mass_matrix_diagonal(</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                el_pmm_diagonal, el_vmm_diagonal, which_one);</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;            }</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160; </div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;            <span class="comment">// get the contribution for each dof</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; el_dof; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;            {</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;              <span class="comment">// Get the equation number</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;              <span class="keywordtype">unsigned</span> eqn_number = el_pt-&gt;eqn_number(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160; </div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;              <span class="comment">// if I have lookup information on this processor</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;              <span class="keywordflow">if</span> ((eqn_number &gt;= first_lookup_row) &amp;&amp;</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;                  (eqn_number &lt;= last_lookup_row))</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;              {</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;                <span class="comment">// Only use the dofs that we&#39;re dealing with here</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;                <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a8a64cfc57ffd16b92ac78499de515138">block_number</a>(eqn_number) == <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a>(block_index))</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;                {</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;                  <span class="comment">// get the index in the block</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;                  <span class="keywordtype">unsigned</span> index = this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a75742d54177935fb22e59d045209b11e">index_in_block</a>(eqn_number);</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160; </div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;                  <span class="comment">// determine which processor requires the block index</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> = 0; <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> &lt; nproc; <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>++)</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;                  {</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;                    <span class="keywordflow">if</span> ((index &gt;= velocity_or_press_dist_pt-&gt;first_row(<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>)) &amp;&amp;</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                        (index &lt; (velocity_or_press_dist_pt-&gt;first_row(<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>) +</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;                                  velocity_or_press_dist_pt-&gt;nrow_local(<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>))))</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;                    {</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;                      <span class="comment">// if it is required by this processor then add the</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;                      <span class="comment">// contribution</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;                      <span class="keywordflow">if</span> (<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> == my_rank)</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;                      {</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;                        <span class="keywordflow">if</span> (block_index == 0)</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;                        {</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;                          v_or_p_values[index - v_or_p_first_row] +=</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;                            el_vmm_diagonal[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;                        }</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (block_index == 1)</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;                        {</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;                          v_or_p_values[index - v_or_p_first_row] +=</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;                            el_pmm_diagonal[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;                        }</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                      }</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;                      <span class="comment">// otherwise store it for communication</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;                      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;                      {</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;                        <span class="keywordflow">if</span> (block_index == 0)</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;                        {</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                          classified_contributions_send[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>].push_back(</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                            el_vmm_diagonal[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                          classified_indices_send[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>].push_back(index);</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                        }</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (block_index == 1)</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;                        {</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                          classified_contributions_send[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>].push_back(</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;                            el_pmm_diagonal[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;                          classified_indices_send[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>].push_back(index);</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                        }</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                      }</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                    }</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;                  }</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;                }</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;              }</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;              <span class="comment">// if we do not have the lookup information on this processor</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;              <span class="comment">// then we send the mass matrix contribution to a processor</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;              <span class="comment">// which we know to have the lookup information</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;              <span class="comment">// the assumption: the processor for which the master block</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;              <span class="comment">// preconditioner distribution will definitely hold the lookup</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;              <span class="comment">// data for eqn_number (although others may)</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#afc57fedbcd960d99c5ab3f135eacb612">problem_pt</a>()-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a5505731e7e73d7e4251c67c7adec6bf5">distributed</a>())</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;              {</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;                <span class="comment">// determine which processor requires the block index</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;                <span class="keywordtype">unsigned</span> <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> = 0;</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;                <span class="keywordflow">while</span> (</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;                  !(eqn_number &gt;= <a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a005d978655022d1a04da7397cf5d0e83">master_distribution_pt</a>-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a2634e540a78fe1ee3f5c907aff500b58">first_row</a>(<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>) &amp;&amp;</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;                    (eqn_number &lt; (<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a005d978655022d1a04da7397cf5d0e83">master_distribution_pt</a>-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a2634e540a78fe1ee3f5c907aff500b58">first_row</a>(<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>) +</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;                                   <a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a005d978655022d1a04da7397cf5d0e83">master_distribution_pt</a>-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">nrow_local</a>(<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>)))))</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;                {</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;                  <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>++;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;                }</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160; </div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;                <span class="comment">// store the data</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;                <span class="keywordflow">if</span> (block_index == 0)</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;                {</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;                  unclassified_contributions_send[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>].push_back(</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;                    el_vmm_diagonal[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;                  unclassified_indices_send[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>].push_back(eqn_number);</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;                }</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (block_index == 1)</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;                {</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;                  unclassified_contributions_send[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>].push_back(</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;                    el_pmm_diagonal[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                  unclassified_indices_send[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>].push_back(eqn_number);</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                }</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;              }</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;            }</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;          }</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;        }</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160; </div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;        <span class="comment">// next the unclassified contributions are communicated to</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;        <span class="comment">// processors that can classify them</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160; </div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;        <span class="comment">// first determine how many unclassified rows are to be sent to</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;        <span class="comment">// each processor</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;        <span class="keywordtype">unsigned</span>* n_unclassified_send = <span class="keyword">new</span> <span class="keywordtype">unsigned</span>[nproc];</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> = 0; <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> &lt; nproc; <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>++)</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;        {</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> == my_rank)</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;          {</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;            n_unclassified_send[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] = 0;</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;          }</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;          {</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;            n_unclassified_send[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] = unclassified_contributions_send[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>].size();</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;          }</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;        }</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160; </div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;        <span class="comment">// then all-to-all com number of unclassified to be sent / recv</span></div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;        <span class="keywordtype">unsigned</span>* n_unclassified_recv = <span class="keyword">new</span> <span class="keywordtype">unsigned</span>[nproc];</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;        MPI_Alltoall(n_unclassified_send,</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;                     1,</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;                     MPI_UNSIGNED,</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;                     n_unclassified_recv,</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;                     1,</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;                     MPI_UNSIGNED,</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;                     <a class="code" href="../../db/d9e/classoomph_1_1Preconditioner.html#ada7219933e05d94f39a46a8ddb4c749a">comm_pt</a>()-&gt;mpi_comm());</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160; </div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;        <span class="comment">// the base displacement for the sends</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;        MPI_Aint base_displacement;</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;        MPI_Get_address(v_or_p_values, &amp;base_displacement);</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160; </div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;        <span class="comment">// allocate storage for the data to be received</span></div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;        <span class="comment">// and post the sends and recvs</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;        Vector&lt;double*&gt; unclassified_contributions_recv(nproc);</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;        Vector&lt;unsigned*&gt; unclassified_indices_recv(nproc);</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;        Vector&lt;MPI_Request&gt; unclassified_recv_requests;</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;        Vector&lt;MPI_Request&gt; unclassified_send_requests;</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;        Vector&lt;unsigned&gt; unclassified_recv_proc;</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> = 0; <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> &lt; nproc; <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>++)</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;        {</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> != my_rank)</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;          {</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;            <span class="comment">// recv</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;            <span class="keywordflow">if</span> (n_unclassified_recv[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] &gt; 0)</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;            {</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;              unclassified_contributions_recv[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] =</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;                <span class="keyword">new</span> <span class="keywordtype">double</span>[n_unclassified_recv[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>]];</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;              unclassified_indices_recv[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] =</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;                <span class="keyword">new</span> <span class="keywordtype">unsigned</span>[n_unclassified_recv[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>]];</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160; </div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;              <span class="comment">// data for the struct data type</span></div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;              MPI_Datatype recv_types[2];</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;              MPI_Aint recv_displacements[2];</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;              <span class="keywordtype">int</span> recv_sz[2];</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160; </div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;              <span class="comment">// contributions</span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;              MPI_Type_contiguous(</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;                n_unclassified_recv[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>], MPI_DOUBLE, &amp;recv_types[0]);</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;              MPI_Type_commit(&amp;recv_types[0]);</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;              MPI_Get_address(unclassified_contributions_recv[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>],</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;                              &amp;recv_displacements[0]);</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;              recv_displacements[0] -= base_displacement;</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;              recv_sz[0] = 1;</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160; </div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;              <span class="comment">// indices</span></div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;              MPI_Type_contiguous(</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;                n_unclassified_recv[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>], MPI_UNSIGNED, &amp;recv_types[1]);</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;              MPI_Type_commit(&amp;recv_types[1]);</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;              MPI_Get_address(unclassified_indices_recv[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>],</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;                              &amp;recv_displacements[1]);</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;              recv_displacements[1] -= base_displacement;</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;              recv_sz[1] = 1;</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160; </div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;              <span class="comment">// build the final recv type</span></div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;              MPI_Datatype final_recv_type;</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;              MPI_Type_create_struct(</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;                2, recv_sz, recv_displacements, recv_types, &amp;final_recv_type);</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;              MPI_Type_commit(&amp;final_recv_type);</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160; </div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;              <span class="comment">// and recv</span></div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;              MPI_Request req;</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;              MPI_Irecv(v_or_p_values,</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;                        1,</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;                        final_recv_type,</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;                        <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>,</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;                        0,</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;                        <a class="code" href="../../db/d9e/classoomph_1_1Preconditioner.html#ada7219933e05d94f39a46a8ddb4c749a">comm_pt</a>()-&gt;mpi_comm(),</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;                        &amp;req);</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;              unclassified_recv_requests.push_back(req);</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;              unclassified_recv_proc.push_back(<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>);</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;              MPI_Type_free(&amp;recv_types[0]);</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;              MPI_Type_free(&amp;recv_types[1]);</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;              MPI_Type_free(&amp;final_recv_type);</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;            }</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160; </div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;            <span class="comment">// send</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;            <span class="keywordflow">if</span> (n_unclassified_send[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] &gt; 0)</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;            {</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;              <span class="comment">// data for the struct data type</span></div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;              MPI_Datatype send_types[2];</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;              MPI_Aint send_displacements[2];</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;              <span class="keywordtype">int</span> send_sz[2];</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160; </div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;              <span class="comment">// contributions</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;              MPI_Type_contiguous(</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;                n_unclassified_send[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>], MPI_DOUBLE, &amp;send_types[0]);</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;              MPI_Type_commit(&amp;send_types[0]);</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;              MPI_Get_address(&amp;unclassified_contributions_send[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>][0],</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;                              &amp;send_displacements[0]);</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;              send_displacements[0] -= base_displacement;</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;              send_sz[0] = 1;</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160; </div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;              <span class="comment">// indices</span></div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;              MPI_Type_contiguous(</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;                n_unclassified_send[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>], MPI_UNSIGNED, &amp;send_types[1]);</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;              MPI_Type_commit(&amp;send_types[1]);</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;              MPI_Get_address(&amp;unclassified_indices_send[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>][0],</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;                              &amp;send_displacements[1]);</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;              send_displacements[1] -= base_displacement;</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;              send_sz[1] = 1;</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160; </div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;              <span class="comment">// build the final send type</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;              MPI_Datatype final_send_type;</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;              MPI_Type_create_struct(</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;                2, send_sz, send_displacements, send_types, &amp;final_send_type);</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;              MPI_Type_commit(&amp;final_send_type);</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160; </div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;              <span class="comment">// and send</span></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;              MPI_Request req;</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;              MPI_Isend(v_or_p_values,</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;                        1,</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;                        final_send_type,</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;                        <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>,</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;                        0,</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;                        <a class="code" href="../../db/d9e/classoomph_1_1Preconditioner.html#ada7219933e05d94f39a46a8ddb4c749a">comm_pt</a>()-&gt;mpi_comm(),</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;                        &amp;req);</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;              unclassified_send_requests.push_back(req);</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;              MPI_Type_free(&amp;send_types[0]);</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;              MPI_Type_free(&amp;send_types[1]);</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;              MPI_Type_free(&amp;final_send_type);</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;            }</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;          }</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;        }</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160; </div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;        <span class="comment">// next classify the data as it is received</span></div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;        <span class="keywordtype">unsigned</span> n_unclassified_recv_req = unclassified_recv_requests.size();</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;        <span class="keywordflow">while</span> (n_unclassified_recv_req &gt; 0)</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;        {</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;          <span class="comment">// get the processor number and remove the completed request</span></div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;          <span class="comment">// for the vector of requests</span></div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;          <span class="keywordtype">int</span> req_num;</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;          MPI_Waitany(n_unclassified_recv_req,</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;                      &amp;unclassified_recv_requests[0],</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;                      &amp;req_num,</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;                      MPI_STATUS_IGNORE);</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;          <span class="keywordtype">unsigned</span> <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> = unclassified_recv_proc[req_num];</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;          unclassified_recv_requests.erase(unclassified_recv_requests.begin() +</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;                                           req_num);</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;          unclassified_recv_proc.erase(unclassified_recv_proc.begin() +</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;                                       req_num);</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;          n_unclassified_recv_req--;</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160; </div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;          <span class="comment">// next classify the dofs</span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;          <span class="comment">// and store them for sending to other processors if required</span></div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;          <span class="keywordtype">unsigned</span> n_recv = n_unclassified_recv[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>];</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_recv; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;          {</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;            <span class="keywordtype">unsigned</span> eqn_number = unclassified_indices_recv[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>][<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;            <span class="comment">// Only deal with our block unknowns</span></div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;            <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a8a64cfc57ffd16b92ac78499de515138">block_number</a>(eqn_number) == <span class="keywordtype">int</span>(block_index))</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;            {</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;              <span class="comment">// get the index in the block</span></div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;              <span class="keywordtype">unsigned</span> index = this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a75742d54177935fb22e59d045209b11e">index_in_block</a>(eqn_number);</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160; </div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;              <span class="comment">// determine which processor requires the block index</span></div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> pp = 0; pp &lt; nproc; pp++)</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;              {</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;                <span class="keywordflow">if</span> ((index &gt;= velocity_or_press_dist_pt-&gt;first_row(pp)) &amp;&amp;</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;                    (index &lt; (velocity_or_press_dist_pt-&gt;first_row(pp) +</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;                              velocity_or_press_dist_pt-&gt;nrow_local(pp))))</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;                {</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;                  <span class="comment">// if it is required by this processor then add the</span></div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;                  <span class="comment">// contribution</span></div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;                  <span class="keywordflow">if</span> (pp == my_rank)</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;                  {</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;                    v_or_p_values[index - v_or_p_first_row] +=</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                      unclassified_contributions_recv[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>][<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;                  }</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;                  <span class="comment">// otherwise store it for communication</span></div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;                  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;                  {</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;                    <span class="keywordtype">double</span> <a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a> = unclassified_contributions_recv[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>][<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;                    classified_contributions_send[pp].push_back(<a class="code" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a>);</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;                    classified_indices_send[pp].push_back(index);</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;                  }</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;                }</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;              }</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;            }</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;          }</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160; </div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;          <span class="comment">// clean up</span></div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;          <span class="keyword">delete</span>[] unclassified_contributions_recv[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>];</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;          <span class="keyword">delete</span>[] unclassified_indices_recv[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>];</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;        }</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;        <span class="keyword">delete</span>[] n_unclassified_recv;</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160; </div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;        <span class="comment">// now all indices have been classified</span></div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160; </div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;        <span class="comment">// next the classified contributions are communicated to</span></div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;        <span class="comment">// processors that require them</span></div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160; </div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;        <span class="comment">// first determine how many classified rows are to be sent to</span></div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;        <span class="comment">// each processor</span></div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;        <span class="keywordtype">unsigned</span>* n_classified_send = <span class="keyword">new</span> <span class="keywordtype">unsigned</span>[nproc];</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> = 0; <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> &lt; nproc; <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>++)</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;        {</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> == my_rank)</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;          {</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;            n_classified_send[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] = 0;</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;          }</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;          {</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;            n_classified_send[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] = classified_contributions_send[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>].size();</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;          }</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;        }</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160; </div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;        <span class="comment">// then all-to-all number of classified to be sent / recv</span></div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;        <span class="keywordtype">unsigned</span>* n_classified_recv = <span class="keyword">new</span> <span class="keywordtype">unsigned</span>[nproc];</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;        MPI_Alltoall(n_classified_send,</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;                     1,</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;                     MPI_UNSIGNED,</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;                     n_classified_recv,</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;                     1,</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;                     MPI_UNSIGNED,</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;                     <a class="code" href="../../db/d9e/classoomph_1_1Preconditioner.html#ada7219933e05d94f39a46a8ddb4c749a">comm_pt</a>()-&gt;mpi_comm());</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160; </div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;        <span class="comment">// allocate storage for the data to be received</span></div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;        <span class="comment">// and post the sends and recvs</span></div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;        Vector&lt;double*&gt; classified_contributions_recv(nproc);</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;        Vector&lt;unsigned*&gt; classified_indices_recv(nproc);</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;        Vector&lt;MPI_Request&gt; classified_recv_requests;</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;        Vector&lt;MPI_Request&gt; classified_send_requests;</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;        Vector&lt;unsigned&gt; classified_recv_proc;</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> = 0; <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> &lt; nproc; <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>++)</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;        {</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> != my_rank)</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;          {</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;            <span class="comment">// recv</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;            <span class="keywordflow">if</span> (n_classified_recv[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] &gt; 0)</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;            {</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;              classified_contributions_recv[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] =</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;                <span class="keyword">new</span> <span class="keywordtype">double</span>[n_classified_recv[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>]];</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;              classified_indices_recv[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] = <span class="keyword">new</span> <span class="keywordtype">unsigned</span>[n_classified_recv[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>]];</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160; </div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;              <span class="comment">// data for the struct data type</span></div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;              MPI_Datatype recv_types[2];</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;              MPI_Aint recv_displacements[2];</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;              <span class="keywordtype">int</span> recv_sz[2];</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160; </div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;              <span class="comment">// contributions</span></div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;              MPI_Type_contiguous(</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;                n_classified_recv[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>], MPI_DOUBLE, &amp;recv_types[0]);</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;              MPI_Type_commit(&amp;recv_types[0]);</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;              MPI_Get_address(classified_contributions_recv[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>],</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;                              &amp;recv_displacements[0]);</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;              recv_displacements[0] -= base_displacement;</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;              recv_sz[0] = 1;</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160; </div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;              <span class="comment">// indices</span></div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;              MPI_Type_contiguous(</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;                n_classified_recv[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>], MPI_UNSIGNED, &amp;recv_types[1]);</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;              MPI_Type_commit(&amp;recv_types[1]);</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;              MPI_Get_address(classified_indices_recv[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>],</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;                              &amp;recv_displacements[1]);</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;              recv_displacements[1] -= base_displacement;</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;              recv_sz[1] = 1;</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160; </div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;              <span class="comment">// build the final recv type</span></div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;              MPI_Datatype final_recv_type;</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;              MPI_Type_create_struct(</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;                2, recv_sz, recv_displacements, recv_types, &amp;final_recv_type);</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;              MPI_Type_commit(&amp;final_recv_type);</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160; </div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;              <span class="comment">// and recv</span></div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;              MPI_Request req;</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;              MPI_Irecv(v_or_p_values,</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;                        1,</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;                        final_recv_type,</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;                        <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>,</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;                        0,</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;                        <a class="code" href="../../db/d9e/classoomph_1_1Preconditioner.html#ada7219933e05d94f39a46a8ddb4c749a">comm_pt</a>()-&gt;mpi_comm(),</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;                        &amp;req);</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;              classified_recv_requests.push_back(req);</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;              classified_recv_proc.push_back(<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>);</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;              MPI_Type_free(&amp;recv_types[0]);</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;              MPI_Type_free(&amp;recv_types[1]);</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;              MPI_Type_free(&amp;final_recv_type);</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;            }</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160; </div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;            <span class="comment">// send</span></div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;            <span class="keywordflow">if</span> (n_classified_send[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>] &gt; 0)</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;            {</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;              <span class="comment">// data for the struct data type</span></div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;              MPI_Datatype send_types[2];</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;              MPI_Aint send_displacements[2];</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;              <span class="keywordtype">int</span> send_sz[2];</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160; </div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;              <span class="comment">// contributions</span></div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;              MPI_Type_contiguous(</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;                n_classified_send[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>], MPI_DOUBLE, &amp;send_types[0]);</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;              MPI_Type_commit(&amp;send_types[0]);</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;              MPI_Get_address(&amp;classified_contributions_send[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>][0],</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;                              &amp;send_displacements[0]);</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;              send_displacements[0] -= base_displacement;</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;              send_sz[0] = 1;</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160; </div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;              <span class="comment">// indices</span></div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;              MPI_Type_contiguous(</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;                n_classified_send[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>], MPI_UNSIGNED, &amp;send_types[1]);</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;              MPI_Type_commit(&amp;send_types[1]);</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;              MPI_Get_address(&amp;classified_indices_send[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>][0],</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;                              &amp;send_displacements[1]);</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;              send_displacements[1] -= base_displacement;</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;              send_sz[1] = 1;</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160; </div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;              <span class="comment">// build the final send type</span></div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;              MPI_Datatype final_send_type;</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;              MPI_Type_create_struct(</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;                2, send_sz, send_displacements, send_types, &amp;final_send_type);</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;              MPI_Type_commit(&amp;final_send_type);</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160; </div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;              <span class="comment">// and send</span></div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;              MPI_Request req;</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;              MPI_Isend(v_or_p_values,</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;                        1,</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;                        final_send_type,</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;                        <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>,</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;                        0,</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;                        <a class="code" href="../../db/d9e/classoomph_1_1Preconditioner.html#ada7219933e05d94f39a46a8ddb4c749a">comm_pt</a>()-&gt;mpi_comm(),</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;                        &amp;req);</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;              classified_send_requests.push_back(req);</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;              MPI_Type_free(&amp;send_types[0]);</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;              MPI_Type_free(&amp;send_types[1]);</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;              MPI_Type_free(&amp;final_send_type);</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;            }</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;          }</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;        }</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160; </div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;        <span class="comment">// next classify the data as it is received</span></div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;        <span class="keywordtype">unsigned</span> n_classified_recv_req = classified_recv_requests.size();</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;        <span class="keywordflow">while</span> (n_classified_recv_req &gt; 0)</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;        {</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;          <span class="comment">// get the processor number and remove the completed request</span></div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;          <span class="comment">// for the vector of requests</span></div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;          <span class="keywordtype">int</span> req_num;</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;          MPI_Waitany(n_classified_recv_req,</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;                      &amp;classified_recv_requests[0],</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;                      &amp;req_num,</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;                      MPI_STATUS_IGNORE);</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;          <span class="keywordtype">unsigned</span> <a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a> = classified_recv_proc[req_num];</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;          classified_recv_requests.erase(classified_recv_requests.begin() +</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;                                         req_num);</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;          classified_recv_proc.erase(classified_recv_proc.begin() + req_num);</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;          n_classified_recv_req--;</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160; </div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;          <span class="comment">// next classify the dofs</span></div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;          <span class="comment">// and store them for sending to other processors if required</span></div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;          <span class="keywordtype">unsigned</span> n_recv = n_classified_recv[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>];</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_recv; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;          {</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;            v_or_p_values[classified_indices_recv[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>][<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] - v_or_p_first_row] +=</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;              classified_contributions_recv[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>][<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;          }</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160; </div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;          <span class="comment">// clean up</span></div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;          <span class="keyword">delete</span>[] classified_contributions_recv[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>];</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;          <span class="keyword">delete</span>[] classified_indices_recv[<a class="code" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>];</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;        }</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160; </div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;        <span class="comment">// wait for the unclassified sends to complete</span></div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;        <span class="keywordtype">unsigned</span> n_unclassified_send_req = unclassified_send_requests.size();</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;        <span class="keywordflow">if</span> (n_unclassified_send_req &gt; 0)</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;        {</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;          MPI_Waitall(n_unclassified_send_req,</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;                      &amp;unclassified_send_requests[0],</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;                      MPI_STATUS_IGNORE);</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;        }</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;        <span class="keyword">delete</span>[] unclassified_contributions_send;</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;        <span class="keyword">delete</span>[] unclassified_indices_send;</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;        <span class="keyword">delete</span>[] n_unclassified_send;</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160; </div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;        <span class="comment">// wait for the classified sends to complete</span></div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;        <span class="keywordtype">unsigned</span> n_classified_send_req = classified_send_requests.size();</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;        <span class="keywordflow">if</span> (n_classified_send_req &gt; 0)</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;        {</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;          MPI_Waitall(n_classified_send_req,</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;                      &amp;classified_send_requests[0],</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;                      MPI_STATUS_IGNORE);</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;        }</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;        <span class="keyword">delete</span>[] classified_indices_send;</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;        <span class="keyword">delete</span>[] classified_contributions_send;</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;        <span class="keyword">delete</span>[] n_classified_recv;</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;        <span class="keyword">delete</span>[] n_classified_send;</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160; </div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;        <span class="comment">// Copy the values back where they belong</span></div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;        <span class="keywordflow">if</span> (block_index == 0)</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;        {</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;          v_values = v_or_p_values;</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;        }</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (block_index == 1)</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;        {</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;          p_values = v_or_p_values;</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;        }</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;      }</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160; </div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;    }</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    <span class="comment">// or if the problem is not distributed</span></div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    {</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;      <span class="comment">// find number of elements</span></div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;      <span class="keywordtype">unsigned</span> n_el = <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6153711f9561d3d617b78d3035147326">Navier_stokes_mesh_pt</a>-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">nelement</a>();</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160; </div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;      <span class="comment">// Fp needs pressure and velocity mass matrices</span></div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;      <span class="keywordtype">unsigned</span> which_one = 0;</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6c6abbfacbceba68be65855cc32bccb1">Use_LSC</a>) which_one = 2;</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160; </div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;      <span class="comment">// get the contribution for each element</span></div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; n_el; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;      {</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;        <span class="comment">// Get element</span></div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;        GeneralisedElement* el_pt = <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6153711f9561d3d617b78d3035147326">Navier_stokes_mesh_pt</a>-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">element_pt</a>(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>);</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160; </div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;        <span class="comment">// find number of degrees of freedom in the element</span></div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;        <span class="comment">// (this is slightly too big because it includes the</span></div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;        <span class="comment">// pressure dofs but this doesn&#39;t matter)</span></div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;        <span class="keywordtype">unsigned</span> el_dof = el_pt-&gt;<a class="code" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a37204f67b37d212fd170c68d48f6da57">ndof</a>();</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160; </div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;        <span class="comment">// allocate local storage for the element&#39;s contribution to the</span></div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;        <span class="comment">// pressure and velocity mass matrix diagonal</span></div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;        Vector&lt;double&gt; el_vmm_diagonal(el_dof, 0.0);</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;        Vector&lt;double&gt; el_pmm_diagonal(el_dof, 0.0);</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160; </div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;        NavierStokesElementWithDiagonalMassMatrices* cast_el_pt = 0;</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;        cast_el_pt =</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;          <span class="keyword">dynamic_cast&lt;</span>NavierStokesElementWithDiagonalMassMatrices*<span class="keyword">&gt;</span>(el_pt);</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;        <span class="keywordflow">if</span> (cast_el_pt != 0)</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;        {</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;          cast_el_pt-&gt;get_pressure_and_velocity_mass_matrix_diagonal(</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;            el_pmm_diagonal, el_vmm_diagonal, which_one);</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;        }</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;        {</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;          std::ostringstream error_message;</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;          error_message</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;Navier-Stokes mesh contains element that is not of type \n&quot;</span></div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;NavierStokesElementWithDiagonalMassMatrices. \n&quot;</span></div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;The element is in fact of type &quot;</span> &lt;&lt; <span class="keyword">typeid</span>(*el_pt).name()</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;\nWe&#39;ll assume that it does not make a used contribution \n&quot;</span></div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;to the inverse diagonal mass matrix used in the &quot;</span></div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;               <span class="stringliteral">&quot;preconditioner\n&quot;</span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;and (to avoid divisions by zero) fill in dummy unit entries.\n&quot;</span></div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;[This case currently arises with flux control problems\n&quot;</span></div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;where for simplicity the NetFluxControlElement has been added &quot;</span></div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;               <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;to the Navier Stokes mesh -- this should probably be changed &quot;</span></div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;               <span class="stringliteral">&quot;at\n&quot;</span></div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;some point -- if you get this warning in any other context\n&quot;</span></div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;you should check your code very carefully]\n&quot;</span>;</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;          OomphLibWarning(error_message.str(),</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;                          <span class="stringliteral">&quot;NavierStokesSchurComplementPreconditioner::assemble_&quot;</span></div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;                          <span class="stringliteral">&quot;inv_press_and_veloc_mass_matrix_diagonal()&quot;</span>,</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160; </div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;          <span class="comment">// Fill in dummy entries to stop division by zero below</span></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; el_dof; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;          {</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;            el_vmm_diagonal[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>] = 1.0;</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;            el_pmm_diagonal[<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>] = 1.0;</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;          }</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;        }</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160; </div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;        <span class="comment">// Get the contribution for each dof</span></div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; el_dof; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;        {</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;          <span class="comment">// Get the equation number</span></div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;          <span class="keywordtype">unsigned</span> eqn_number = el_pt-&gt;eqn_number(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160; </div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;          <span class="comment">// Get the velocity dofs</span></div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;          <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a8a64cfc57ffd16b92ac78499de515138">block_number</a>(eqn_number) == 0)</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;          {</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;            <span class="comment">// get the index in the block</span></div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;            <span class="keywordtype">unsigned</span> index = this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a75742d54177935fb22e59d045209b11e">index_in_block</a>(eqn_number);</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160; </div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;            <span class="comment">// if it is required on this processor</span></div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;            <span class="keywordflow">if</span> ((index &gt;= v_first_row) &amp;&amp;</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;                (index &lt; (v_first_row + v_nrow_local)))</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;            {</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;              v_values[index - v_first_row] += el_vmm_diagonal[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;            }</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;          }</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;          <span class="comment">// Get the pressure dofs</span></div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a8a64cfc57ffd16b92ac78499de515138">block_number</a>(eqn_number) == 1)</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;          {</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6c6abbfacbceba68be65855cc32bccb1">Use_LSC</a>)</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;            {</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;              <span class="comment">// get the index in the block</span></div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;              <span class="keywordtype">unsigned</span> index = this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a75742d54177935fb22e59d045209b11e">index_in_block</a>(eqn_number);</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160; </div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;              <span class="comment">// if it is required on this processor</span></div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;              <span class="keywordflow">if</span> ((index &gt;= p_first_row) &amp;&amp;</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;                  (index &lt; (p_first_row + p_nrow_local)))</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;              {</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;                p_values[index - p_first_row] += el_pmm_diagonal[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;              }</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;            }</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;          }</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;        }</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;      }</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;    }</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160; </div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;    <span class="comment">// Create column index and row start for velocity mass matrix</span></div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;    <span class="keywordtype">int</span>* v_column_index = <span class="keyword">new</span> <span class="keywordtype">int</span>[v_nrow_local];</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;    <span class="keywordtype">int</span>* v_row_start = <span class="keyword">new</span> <span class="keywordtype">int</span>[v_nrow_local + 1];</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; v_nrow_local; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;    {</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;      <span class="keywordflow">if</span> (v_values[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] == 0.0)</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;      {</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;        std::ostringstream error_message;</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;        error_message &lt;&lt; <span class="stringliteral">&quot;Zero entry in diagonal of velocity mass matrix\n&quot;</span></div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;Index: &quot;</span> &lt;&lt; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(error_message.str(),</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;                            <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;      }</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;      v_values[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = 1.0 / v_values[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;      v_column_index[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = v_first_row + <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;      v_row_start[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;    }</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;    v_row_start[v_nrow_local] = v_nrow_local;</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160; </div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;    <span class="comment">// Build the velocity mass matrix</span></div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;    inv_v_mass_pt = <span class="keyword">new</span> CRDoubleMatrix(this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a77ac0b71404620e7be8b15ac2d588495">block_distribution_pt</a>(0));</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    inv_v_mass_pt-&gt;build_without_copy(</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;      v_nrow, v_nrow_local, v_values, v_column_index, v_row_start);</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160; </div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;    <span class="comment">// Create pressure mass matrix</span></div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6c6abbfacbceba68be65855cc32bccb1">Use_LSC</a>)</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;    {</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;      <span class="comment">// Create column index and row start for pressure mass matrix</span></div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;      <span class="keywordtype">int</span>* p_column_index = <span class="keyword">new</span> <span class="keywordtype">int</span>[p_nrow_local];</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;      <span class="keywordtype">int</span>* p_row_start = <span class="keyword">new</span> <span class="keywordtype">int</span>[p_nrow_local + 1];</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; p_nrow_local; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;      {</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;        <span class="keywordflow">if</span> (p_values[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] == 0.0)</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;        {</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;          std::ostringstream error_message;</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;          error_message &lt;&lt; <span class="stringliteral">&quot;Zero entry in diagonal of pressure mass matrix\n&quot;</span></div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot;Index: &quot;</span> &lt;&lt; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;          <span class="keywordflow">throw</span> OomphLibError(error_message.str(),</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;                              <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;                              <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;        }</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;        p_values[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = 1.0 / p_values[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160; </div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;        p_column_index[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = p_first_row + <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;        p_row_start[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;      }</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;      p_row_start[p_nrow_local] = p_nrow_local;</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160; </div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;      <span class="comment">// Build the pressure mass matrix</span></div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;      inv_p_mass_pt = <span class="keyword">new</span> CRDoubleMatrix(this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a77ac0b71404620e7be8b15ac2d588495">block_distribution_pt</a>(1));</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;      inv_p_mass_pt-&gt;build_without_copy(</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;        p_nrow, p_nrow_local, p_values, p_column_index, p_row_start);</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;    }</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;  }</div>
<div class="ttc" id="aArray__initializer__list__vector__cxx11_8cpp_html_a32398b762ddd48fa3a6d504de68009f9"><div class="ttname"><a href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a></div><div class="ttdeci">Array&lt; int, Dynamic, 1 &gt; v</div><div class="ttdef"><b>Definition:</b> Array_initializer_list_vector_cxx11.cpp:1</div></div>
<div class="ttc" id="aBiCGSTAB__step__by__step_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> BiCGSTAB_step_by_step.cpp:9</div></div>
<div class="ttc" id="aCwise__array__power__array_8cpp_html_a9eb5e92d9d691c1393e5e7c914731dbf"><div class="ttname"><a href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a></div><div class="ttdeci">Array&lt; double, 1, 3 &gt; e(1./3., 0.5, 2.)</div></div>
<div class="ttc" id="aTutorial__Map__using_8cpp_html_a7fe964f6b1afd4591f637999272ab9a2"><div class="ttname"><a href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a></div><div class="ttdeci">float * p</div><div class="ttdef"><b>Definition:</b> Tutorial_Map_using.cpp:9</div></div>
<div class="ttc" id="aclassoomph_1_1BlockPreconditioner_html_a005d978655022d1a04da7397cf5d0e83"><div class="ttname"><a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a005d978655022d1a04da7397cf5d0e83">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::master_distribution_pt</a></div><div class="ttdeci">const LinearAlgebraDistribution * master_distribution_pt() const</div><div class="ttdef"><b>Definition:</b> block_preconditioner.h:2017</div></div>
<div class="ttc" id="aclassoomph_1_1BlockPreconditioner_html_a75742d54177935fb22e59d045209b11e"><div class="ttname"><a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a75742d54177935fb22e59d045209b11e">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::index_in_block</a></div><div class="ttdeci">int index_in_block(const unsigned &amp;i_dof) const</div><div class="ttdef"><b>Definition:</b> block_preconditioner.h:1850</div></div>
<div class="ttc" id="aclassoomph_1_1BlockPreconditioner_html_a77ac0b71404620e7be8b15ac2d588495"><div class="ttname"><a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a77ac0b71404620e7be8b15ac2d588495">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::block_distribution_pt</a></div><div class="ttdeci">const LinearAlgebraDistribution * block_distribution_pt(const unsigned &amp;b) const</div><div class="ttdoc">Access function to the block distributions (const version).</div><div class="ttdef"><b>Definition:</b> block_preconditioner.h:1903</div></div>
<div class="ttc" id="aclassoomph_1_1BlockPreconditioner_html_a8a64cfc57ffd16b92ac78499de515138"><div class="ttname"><a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a8a64cfc57ffd16b92ac78499de515138">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::block_number</a></div><div class="ttdeci">int block_number(const unsigned &amp;i_dof) const</div><div class="ttdoc">Return the block number corresponding to a global index i_dof.</div><div class="ttdef"><b>Definition:</b> block_preconditioner.h:1822</div></div>
<div class="ttc" id="aclassoomph_1_1DistributableLinearAlgebraObject_html_a5505731e7e73d7e4251c67c7adec6bf5"><div class="ttname"><a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a5505731e7e73d7e4251c67c7adec6bf5">oomph::DistributableLinearAlgebraObject::distributed</a></div><div class="ttdeci">bool distributed() const</div><div class="ttdoc">distribution is serial or distributed</div><div class="ttdef"><b>Definition:</b> linear_algebra_distribution.h:493</div></div>
<div class="ttc" id="aclassoomph_1_1GeneralisedElement_html_a37204f67b37d212fd170c68d48f6da57"><div class="ttname"><a href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a37204f67b37d212fd170c68d48f6da57">oomph::GeneralisedElement::ndof</a></div><div class="ttdeci">unsigned ndof() const</div><div class="ttdoc">Return the number of equations/dofs in the element.</div><div class="ttdef"><b>Definition:</b> elements.h:835</div></div>
<div class="ttc" id="aclassoomph_1_1LinearAlgebraDistribution_html_a2634e540a78fe1ee3f5c907aff500b58"><div class="ttname"><a href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a2634e540a78fe1ee3f5c907aff500b58">oomph::LinearAlgebraDistribution::first_row</a></div><div class="ttdeci">unsigned first_row() const</div><div class="ttdef"><b>Definition:</b> linear_algebra_distribution.h:261</div></div>
<div class="ttc" id="aclassoomph_1_1LinearAlgebraDistribution_html_aafad0b69de2284808366b65bd63e493b"><div class="ttname"><a href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#aafad0b69de2284808366b65bd63e493b">oomph::LinearAlgebraDistribution::nrow</a></div><div class="ttdeci">unsigned nrow() const</div><div class="ttdoc">access function to the number of global rows.</div><div class="ttdef"><b>Definition:</b> linear_algebra_distribution.h:186</div></div>
<div class="ttc" id="aclassoomph_1_1LinearAlgebraDistribution_html_ac9310de740f9c3a61f8d5dab9bef88ca"><div class="ttname"><a href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">oomph::LinearAlgebraDistribution::nrow_local</a></div><div class="ttdeci">unsigned nrow_local() const</div><div class="ttdef"><b>Definition:</b> linear_algebra_distribution.h:193</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_a876faf1f87b24b220ea21a38d6adde5b"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">oomph::Mesh::element_pt</a></div><div class="ttdeci">GeneralisedElement *&amp; element_pt(const unsigned long &amp;e)</div><div class="ttdoc">Return pointer to element e.</div><div class="ttdef"><b>Definition:</b> mesh.h:448</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_af01dfefb66c15579b540be62999d93ee"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">oomph::Mesh::nelement</a></div><div class="ttdeci">unsigned long nelement() const</div><div class="ttdoc">Return number of elements in the mesh.</div><div class="ttdef"><b>Definition:</b> mesh.h:590</div></div>
<div class="ttc" id="aclassoomph_1_1OomphCommunicator_html_a670b34aab05bfe0b96d0e0fabf583c7a"><div class="ttname"><a href="../../de/d83/classoomph_1_1OomphCommunicator.html#a670b34aab05bfe0b96d0e0fabf583c7a">oomph::OomphCommunicator::my_rank</a></div><div class="ttdeci">int my_rank() const</div><div class="ttdoc">my rank</div><div class="ttdef"><b>Definition:</b> communicator.h:176</div></div>
<div class="ttc" id="aclassoomph_1_1OomphCommunicator_html_a6c78c72666f4b102c2bccf200f0853b7"><div class="ttname"><a href="../../de/d83/classoomph_1_1OomphCommunicator.html#a6c78c72666f4b102c2bccf200f0853b7">oomph::OomphCommunicator::nproc</a></div><div class="ttdeci">int nproc() const</div><div class="ttdoc">number of processors</div><div class="ttdef"><b>Definition:</b> communicator.h:157</div></div>
<div class="ttc" id="aclassoomph_1_1Preconditioner_html_ada7219933e05d94f39a46a8ddb4c749a"><div class="ttname"><a href="../../db/d9e/classoomph_1_1Preconditioner.html#ada7219933e05d94f39a46a8ddb4c749a">oomph::Preconditioner::comm_pt</a></div><div class="ttdeci">virtual const OomphCommunicator * comm_pt() const</div><div class="ttdoc">Get function for comm pointer.</div><div class="ttdef"><b>Definition:</b> preconditioner.h:171</div></div>
<div class="ttc" id="alevel1__cplx__impl_8h_html_a4e8e1c1bb9d4e05fc671fc133ec9dc9b"><div class="ttname"><a href="../../d2/d2e/level1__cplx__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a></div><div class="ttdeci">return int(ret)+1</div></div>
<div class="ttc" id="aoomph__definitions_8h_html_a25c6813cc7341d125e2502f8923fb6c4"><div class="ttname"><a href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a></div><div class="ttdeci">#define OOMPH_EXCEPTION_LOCATION</div><div class="ttdef"><b>Definition:</b> oomph_definitions.h:61</div></div>
<div class="ttc" id="aoomph__definitions_8h_html_aa260cc4af589e30cea7fde997ae16667"><div class="ttname"><a href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a></div><div class="ttdeci">#define OOMPH_CURRENT_FUNCTION</div><div class="ttdef"><b>Definition:</b> oomph_definitions.h:86</div></div>
<div class="ttc" id="atut__arithmetic__redux__minmax_8cpp_html_a39513f0f8d942bf9ef17b2e87ac6d34e"><div class="ttname"><a href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a></div><div class="ttdeci">std::ptrdiff_t j</div><div class="ttdef"><b>Definition:</b> tut_arithmetic_redux_minmax.cpp:2</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a77ac0b71404620e7be8b15ac2d588495">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::block_distribution_pt()</a>, <a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a8a64cfc57ffd16b92ac78499de515138">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::block_number()</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#aafb4d7de0a87b4bda560928e6a128060">oomph::CRDoubleMatrix::build_without_copy()</a>, <a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#ada7219933e05d94f39a46a8ddb4c749a">oomph::Preconditioner::comm_pt()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a5505731e7e73d7e4251c67c7adec6bf5">oomph::DistributableLinearAlgebraObject::distributed()</a>, <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">oomph::Mesh::element_pt()</a>, <a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a37ac5a1d5234fa931ab710c0c74d55d2">oomph::GeneralisedElement::eqn_number()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a2634e540a78fe1ee3f5c907aff500b58">oomph::LinearAlgebraDistribution::first_row()</a>, <a class="el" href="../../dc/d85/classoomph_1_1NavierStokesElementWithDiagonalMassMatrices.html#a4d491d10823eee10381a9b14bce6c244">oomph::NavierStokesElementWithDiagonalMassMatrices::get_pressure_and_velocity_mass_matrix_diagonal()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a75742d54177935fb22e59d045209b11e">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::index_in_block()</a>, <a class="el" href="../../d2/d2e/level1__cplx__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int()</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a005d978655022d1a04da7397cf5d0e83">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::master_distribution_pt()</a>, <a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a670b34aab05bfe0b96d0e0fabf583c7a">oomph::OomphCommunicator::my_rank()</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6153711f9561d3d617b78d3035147326">Navier_stokes_mesh_pt</a>, <a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a37204f67b37d212fd170c68d48f6da57">oomph::GeneralisedElement::ndof()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">oomph::Mesh::nelement()</a>, <a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a6c78c72666f4b102c2bccf200f0853b7">oomph::OomphCommunicator::nproc()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#aafad0b69de2284808366b65bd63e493b">oomph::LinearAlgebraDistribution::nrow()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">oomph::LinearAlgebraDistribution::nrow_local()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#afc57fedbcd960d99c5ab3f135eacb612">problem_pt()</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6c6abbfacbceba68be65855cc32bccb1">Use_LSC</a>, and <a class="el" href="../../dc/d69/Array__initializer__list__vector__cxx11_8cpp.html#a32398b762ddd48fa3a6d504de68009f9">v</a>.</p>

</div>
</div>
<a id="a5cac2493de85690e3954949eb2a27d2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5cac2493de85690e3954949eb2a27d2c">&#9670;&nbsp;</a></span>clean_up_memory()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::NavierStokesSchurComplementPreconditioner::clean_up_memory </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Helper function to delete preconditioner data. </p>

<p>Reimplemented from <a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#a46c31c416829bedcd9db238431262027">oomph::Preconditioner</a>.</p>
<div class="fragment"><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;  {</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a3584d8bd088fad5ccce394899e167ca3">Preconditioner_has_been_setup</a>)</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;    {</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;      <span class="comment">// delete matvecs</span></div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;      <span class="keyword">delete</span> <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ad7bc578498d001d81223b37badefb44b">Bt_mat_vec_pt</a>;</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ad7bc578498d001d81223b37badefb44b">Bt_mat_vec_pt</a> = 0;</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160; </div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;      <span class="keyword">delete</span> <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a66a5925f3bd0642de7bd3e61b8d740dc">F_mat_vec_pt</a>;</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a66a5925f3bd0642de7bd3e61b8d740dc">F_mat_vec_pt</a> = 0;</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160; </div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;      <span class="keyword">delete</span> <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a7d88aae7807a9a8d07491dda4c8c2465">QBt_mat_vec_pt</a>;</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a7d88aae7807a9a8d07491dda4c8c2465">QBt_mat_vec_pt</a> = 0;</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160; </div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;      <span class="keyword">delete</span> <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6a02950e86b2b8a092dda57587850d1c">E_mat_vec_pt</a>;</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6a02950e86b2b8a092dda57587850d1c">E_mat_vec_pt</a> = 0;</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160; </div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;      <span class="comment">// delete stuff from velocity solve</span></div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a925aa01327e8a6af8c543d2983e92d2f">Using_default_f_preconditioner</a>)</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;      {</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;        <span class="keyword">delete</span> <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a14a63179117e8cf5822c89ae2b5c9902">F_preconditioner_pt</a>;</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;        <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a14a63179117e8cf5822c89ae2b5c9902">F_preconditioner_pt</a> = 0;</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;      }</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160; </div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;      <span class="comment">// delete stuff from Schur complement approx</span></div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6d9eb3bdee67fafd228e0923e61bd812">Using_default_p_preconditioner</a>)</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;      {</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;        <span class="keyword">delete</span> <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a94c09c485f93eb273f4217460da02811">P_preconditioner_pt</a>;</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;        <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a94c09c485f93eb273f4217460da02811">P_preconditioner_pt</a> = 0;</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;      }</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;    }</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ad7bc578498d001d81223b37badefb44b">Bt_mat_vec_pt</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6a02950e86b2b8a092dda57587850d1c">E_mat_vec_pt</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a66a5925f3bd0642de7bd3e61b8d740dc">F_mat_vec_pt</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a14a63179117e8cf5822c89ae2b5c9902">F_preconditioner_pt</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a94c09c485f93eb273f4217460da02811">P_preconditioner_pt</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a3584d8bd088fad5ccce394899e167ca3">Preconditioner_has_been_setup</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a7d88aae7807a9a8d07491dda4c8c2465">QBt_mat_vec_pt</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a925aa01327e8a6af8c543d2983e92d2f">Using_default_f_preconditioner</a>, and <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6d9eb3bdee67fafd228e0923e61bd812">Using_default_p_preconditioner</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/dc5/classoomph_1_1PseudoElasticFSIPreconditioner.html#a15859381010faa40a47fdca28b281475">oomph::PseudoElasticFSIPreconditioner::clean_up_memory()</a>, and <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ad954b4f67329c643d5219ed573805b81">~NavierStokesSchurComplementPreconditioner()</a>.</p>

</div>
</div>
<a id="a483c96d41a5032f90b8027d6ef2c0c5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a483c96d41a5032f90b8027d6ef2c0c5a">&#9670;&nbsp;</a></span>disable_accept_non_NavierStokesElementWithDiagonalMassMatrices_elements()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::NavierStokesSchurComplementPreconditioner::disable_accept_non_NavierStokesElementWithDiagonalMassMatrices_elements </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Do not accept presence of elements that are not of type NavierStokesElementWithDiagonalMassMatrices without issuing a warning. </p>
<div class="fragment"><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    {</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a31a0119eae85695e267b2b0e6d58cfe6">Accept_non_NavierStokesElementWithDiagonalMassMatrices_elements</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a31a0119eae85695e267b2b0e6d58cfe6">Accept_non_NavierStokesElementWithDiagonalMassMatrices_elements</a>.</p>

</div>
</div>
<a id="ae0015b71a33a147650606840d98f5a9e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0015b71a33a147650606840d98f5a9e">&#9670;&nbsp;</a></span>disable_doc_time()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::NavierStokesSchurComplementPreconditioner::disable_doc_time </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Disable documentation of time. </p>
<div class="fragment"><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    {</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a0b551f53464a6331d3b0f3da61d712ff">Doc_time</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a0b551f53464a6331d3b0f3da61d712ff">Doc_time</a>.</p>

</div>
</div>
<a id="ae1db0cf426cd70ad4f1f30182d82c469"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1db0cf426cd70ad4f1f30182d82c469">&#9670;&nbsp;</a></span>disable_robin_for_fp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::NavierStokesSchurComplementPreconditioner::disable_robin_for_fp </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Don't use Robin BC elements for the Fp preconditioenr. </p>
<div class="fragment"><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    {</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a3aa99e654544365b78d4dca057ed53e0">Use_robin_for_fp</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a3aa99e654544365b78d4dca057ed53e0">Use_robin_for_fp</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../de/da5/classFpTestProblem.html#ab50efdf5937d41c7a4007d6140948e41">FpTestProblem::FpTestProblem()</a>.</p>

</div>
</div>
<a id="af406a2d6632c95f7d8b70baba1b912ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af406a2d6632c95f7d8b70baba1b912ee">&#9670;&nbsp;</a></span>enable_accept_non_NavierStokesElementWithDiagonalMassMatrices_elements()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::NavierStokesSchurComplementPreconditioner::enable_accept_non_NavierStokesElementWithDiagonalMassMatrices_elements </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Accept presence of elements that are not of type NavierStokesElementWithDiagonalMassMatrices without issuing a warning. </p>
<div class="fragment"><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    {</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a31a0119eae85695e267b2b0e6d58cfe6">Accept_non_NavierStokesElementWithDiagonalMassMatrices_elements</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a31a0119eae85695e267b2b0e6d58cfe6">Accept_non_NavierStokesElementWithDiagonalMassMatrices_elements</a>.</p>

</div>
</div>
<a id="af1a6030468c5795b3ace7a58bcb6b4f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1a6030468c5795b3ace7a58bcb6b4f1">&#9670;&nbsp;</a></span>enable_doc_time()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::NavierStokesSchurComplementPreconditioner::enable_doc_time </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Enable documentation of time. </p>
<div class="fragment"><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    {</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a0b551f53464a6331d3b0f3da61d712ff">Doc_time</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a0b551f53464a6331d3b0f3da61d712ff">Doc_time</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d2b/flux__control_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>

</div>
</div>
<a id="ac6554fd9418b705b70a0a54c0f864db8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6554fd9418b705b70a0a54c0f864db8">&#9670;&nbsp;</a></span>enable_robin_for_fp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::NavierStokesSchurComplementPreconditioner::enable_robin_for_fp </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Use Robin BC elements for the Fp preconditioner. </p>
<div class="fragment"><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    {</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a3aa99e654544365b78d4dca057ed53e0">Use_robin_for_fp</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a3aa99e654544365b78d4dca057ed53e0">Use_robin_for_fp</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../de/da5/classFpTestProblem.html#ab50efdf5937d41c7a4007d6140948e41">FpTestProblem::FpTestProblem()</a>.</p>

</div>
</div>
<a id="ac3f40f62d33d33616cdb4bed48aaccde"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3f40f62d33d33616cdb4bed48aaccde">&#9670;&nbsp;</a></span>get_pressure_advection_diffusion_matrix()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::NavierStokesSchurComplementPreconditioner::get_pressure_advection_diffusion_matrix </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>fp_matrix</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the pressure advection diffusion matrix. </p>
<div class="fragment"><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    {</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;      <span class="comment">// Pin all non-pressure dofs</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a03941c01d70ece07797301c8ac6a0a8a">pin_all_non_pressure_dofs</a>();</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160; </div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;      <span class="comment">// Get the spatial dimension</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;      <span class="keywordtype">unsigned</span> ndim = <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6153711f9561d3d617b78d3035147326">Navier_stokes_mesh_pt</a>-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a4f274774435e9454bf77bf70de69367a">finite_element_pt</a>(0)-&gt;<a class="code" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">dim</a>();</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160; </div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;      <span class="comment">// Backup assembly handler and set new one</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;      AssemblyHandler* backed_up_assembly_handler_pt =</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#afc57fedbcd960d99c5ab3f135eacb612">problem_pt</a>()-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>();</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#afc57fedbcd960d99c5ab3f135eacb612">problem_pt</a>()-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>() =</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;        <span class="keyword">new</span> FpPreconditionerAssemblyHandler(ndim);</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160; </div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;      <span class="comment">// Backup submeshes (if any)</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;      <span class="keywordtype">unsigned</span> n_sub_mesh = <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#afc57fedbcd960d99c5ab3f135eacb612">problem_pt</a>()-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">nsub_mesh</a>();</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;      Vector&lt;Mesh*&gt; backed_up_sub_mesh_pt(n_sub_mesh);</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_sub_mesh; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;      {</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;        backed_up_sub_mesh_pt[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#afc57fedbcd960d99c5ab3f135eacb612">problem_pt</a>()-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;      }</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;      <span class="comment">// Flush sub-meshes but don&#39;t call rebuild_global_mesh()</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;      <span class="comment">// so we can simply re-instate the sub-meshes below.</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#afc57fedbcd960d99c5ab3f135eacb612">problem_pt</a>()-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a42b2b42a03f9de7d7a4d24edcfa20179">flush_sub_meshes</a>();</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160; </div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;      <span class="comment">// Backup the problem&#39;s own mesh pointer</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;      Mesh* backed_up_mesh_pt = <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#afc57fedbcd960d99c5ab3f135eacb612">problem_pt</a>()-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>();</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#afc57fedbcd960d99c5ab3f135eacb612">problem_pt</a>()-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>() = <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6153711f9561d3d617b78d3035147326">Navier_stokes_mesh_pt</a>;</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160; </div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160; </div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;      <span class="comment">// Backup the start and end elements for the distributed</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;      <span class="comment">// assembly process</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;      Vector&lt;unsigned&gt; backed_up_first_el_for_assembly;</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;      Vector&lt;unsigned&gt; backed_up_last_el_for_assembly;</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#afc57fedbcd960d99c5ab3f135eacb612">problem_pt</a>()-&gt;get_first_and_last_element_for_assembly(</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;        backed_up_first_el_for_assembly, backed_up_last_el_for_assembly);</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160; </div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;      <span class="comment">// Now re-assign</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#afc57fedbcd960d99c5ab3f135eacb612">problem_pt</a>()-&gt;set_default_first_and_last_element_for_assembly();</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160; </div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160; </div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;      <span class="comment">// Identify pinned pressure dof</span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;      <span class="keywordtype">int</span> pinned_pressure_eqn = -2;</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a40ffaa90de4f861037cbd364789eb889">Pin_first_pressure_dof_in_press_adv_diff</a>)</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;      {</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;        <span class="comment">// Loop over all Navier Stokes elements to find first non-pinned</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        <span class="comment">// pressure dof</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        <span class="keywordtype">unsigned</span> nel = <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6153711f9561d3d617b78d3035147326">Navier_stokes_mesh_pt</a>-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">nelement</a>();</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; nel; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;        {</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;          TemplateFreeNavierStokesEquationsBase* bulk_elem_pt =</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;            <span class="keyword">dynamic_cast&lt;</span>TemplateFreeNavierStokesEquationsBase*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;              <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6153711f9561d3d617b78d3035147326">Navier_stokes_mesh_pt</a>-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">element_pt</a>(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>));</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;          <span class="keywordtype">int</span> local_eqn = bulk_elem_pt-&gt;p_local_eqn(0);</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;          <span class="keywordflow">if</span> (local_eqn &gt;= 0)</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;          {</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;            pinned_pressure_eqn = bulk_elem_pt-&gt;eqn_number(local_eqn);</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;          }</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;        }</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160; </div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160; </div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#afc57fedbcd960d99c5ab3f135eacb612">problem_pt</a>()-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#af5e9f1623cad361048856a4c0463ea23">distributed</a>())</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;        {</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;          <span class="keywordtype">int</span> pinned_pressure_eqn_local = pinned_pressure_eqn;</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;          <span class="keywordtype">int</span> pinned_pressure_eqn_global = pinned_pressure_eqn;</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;          MPI_Allreduce(&amp;pinned_pressure_eqn_local,</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                        &amp;pinned_pressure_eqn_global,</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                        1,</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;                        MPI_INT,</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;                        MPI_MIN,</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                        this-&gt;<a class="code" href="../../db/d9e/classoomph_1_1Preconditioner.html#ada7219933e05d94f39a46a8ddb4c749a">comm_pt</a>()-&gt;mpi_comm());</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;          pinned_pressure_eqn = pinned_pressure_eqn_global;</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;        }</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160; </div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;      }</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160; </div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160; </div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;      <span class="comment">// Loop over all Navier Stokes elements</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;      <span class="keywordtype">unsigned</span> nel = <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6153711f9561d3d617b78d3035147326">Navier_stokes_mesh_pt</a>-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">nelement</a>();</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; nel; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;      {</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;        TemplateFreeNavierStokesEquationsBase* bulk_elem_pt =</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;          <span class="keyword">dynamic_cast&lt;</span>TemplateFreeNavierStokesEquationsBase*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;            <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6153711f9561d3d617b78d3035147326">Navier_stokes_mesh_pt</a>-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">element_pt</a>(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>));</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160; </div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        <span class="comment">// Set pinned pressure equation</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        bulk_elem_pt-&gt;pinned_fp_pressure_eqn() = pinned_pressure_eqn;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;      }</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160; </div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160; </div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;      <span class="comment">// Attach Robin BC elements</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;      <span class="keywordtype">unsigned</span> nbound = <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6153711f9561d3d617b78d3035147326">Navier_stokes_mesh_pt</a>-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a84543564d6babe4faacbb9d87043fc19">nboundary</a>();</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a3aa99e654544365b78d4dca057ed53e0">Use_robin_for_fp</a>)</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;      {</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;        <span class="comment">// Loop over all boundaries of Navier Stokes mesh</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a> = 0; <a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a> &lt; nbound; <a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a>++)</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        {</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;          <span class="comment">// How many bulk elements are adjacent to boundary b?</span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;          <span class="keywordtype">unsigned</span> n_element = <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6153711f9561d3d617b78d3035147326">Navier_stokes_mesh_pt</a>-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a68e04b3b70cff70d53d75f66661555e8">nboundary_element</a>(<a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a>);</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160; </div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;          <span class="comment">// Loop over the bulk elements adjacent to boundary b?</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; n_element; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;          {</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;            TemplateFreeNavierStokesEquationsBase* bulk_elem_pt =</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;              <span class="keyword">dynamic_cast&lt;</span>TemplateFreeNavierStokesEquationsBase*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;                <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6153711f9561d3d617b78d3035147326">Navier_stokes_mesh_pt</a>-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a875271b6f162ddc5685a2511b35e75ec">boundary_element_pt</a>(<a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a>, <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>));</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160; </div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;            <span class="comment">// What is the index of the face of the bulk element e on bondary b</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;            <span class="keywordtype">int</span> face_index =</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;              <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6153711f9561d3d617b78d3035147326">Navier_stokes_mesh_pt</a>-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a6095e417593de6136d248ab08823f453">face_index_at_boundary</a>(<a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a>, <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>);</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160; </div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;            <span class="comment">// Build face element</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;            bulk_elem_pt-&gt;build_fp_press_adv_diff_robin_bc_element(face_index);</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160; </div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;          } <span class="comment">// end of loop over bulk elements adjacent to boundary b</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;        }</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;      }</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160; </div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;      <span class="comment">// Get &quot;Jacobian&quot; of the modified system</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;      <a class="code" href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a> dummy_residuals;</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#afc57fedbcd960d99c5ab3f135eacb612">problem_pt</a>()-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#af660c2c0d10eaea1972314ce80de000e">get_jacobian</a>(dummy_residuals, fp_matrix);</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160; </div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;      <span class="comment">// Kill Robin BC elements</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a3aa99e654544365b78d4dca057ed53e0">Use_robin_for_fp</a>)</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;      {</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;        <span class="comment">// Loop over all boundaries of Navier Stokes mesh</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a> = 0; <a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a> &lt; nbound; <a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a>++)</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;        {</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;          <span class="comment">// How many bulk elements are adjacent to boundary b?</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;          <span class="keywordtype">unsigned</span> n_element = <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6153711f9561d3d617b78d3035147326">Navier_stokes_mesh_pt</a>-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a68e04b3b70cff70d53d75f66661555e8">nboundary_element</a>(<a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a>);</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160; </div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;          <span class="comment">// Loop over the bulk elements adjacent to boundary b?</span></div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; n_element; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;          {</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;            TemplateFreeNavierStokesEquationsBase* bulk_elem_pt =</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;              <span class="keyword">dynamic_cast&lt;</span>TemplateFreeNavierStokesEquationsBase*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;                <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6153711f9561d3d617b78d3035147326">Navier_stokes_mesh_pt</a>-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a875271b6f162ddc5685a2511b35e75ec">boundary_element_pt</a>(<a class="code" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a>, <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>));</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160; </div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;            <span class="comment">// Kill associated Robin elements</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;            bulk_elem_pt-&gt;delete_pressure_advection_diffusion_robin_elements();</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160; </div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;          } <span class="comment">// end of loop over bulk elements adjacent to boundary b</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;        }</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;      }</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160; </div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;      <span class="comment">// Reset pin status</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#af1c121b668b1961a68010f984166947c">reset_pin_status</a>();</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160; </div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160; </div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;      <span class="comment">// Reset start and end elements for the distributed</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;      <span class="comment">// assembly process</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#afc57fedbcd960d99c5ab3f135eacb612">problem_pt</a>()-&gt;set_first_and_last_element_for_assembly(</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;        backed_up_first_el_for_assembly, backed_up_last_el_for_assembly);</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160; </div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160; </div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;      <span class="comment">// Cleanup and reset assembly handler</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;      <span class="keyword">delete</span> <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#afc57fedbcd960d99c5ab3f135eacb612">problem_pt</a>()-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>();</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#afc57fedbcd960d99c5ab3f135eacb612">problem_pt</a>()-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">assembly_handler_pt</a>() = backed_up_assembly_handler_pt;</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160; </div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;      <span class="comment">// Re-instate submeshes. (No need to call rebuild_global_mesh()</span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;      <span class="comment">// as it was never unbuilt).</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_sub_mesh; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;      {</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;        <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#afc57fedbcd960d99c5ab3f135eacb612">problem_pt</a>()-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#a0cd05109bc2c003c5c0686e6aa55d847">add_sub_mesh</a>(backed_up_sub_mesh_pt[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;      }</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160; </div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160; </div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;      <span class="comment">// Reset the problem&#39;s mesh pointer</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#afc57fedbcd960d99c5ab3f135eacb612">problem_pt</a>()-&gt;<a class="code" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">mesh_pt</a>() = backed_up_mesh_pt;</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    }</div>
<div class="ttc" id="aClumpInput_8h_html_a82f6bc76e1c7a0f51bf3e95ad5d3c590"><div class="ttname"><a href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a></div><div class="ttdeci">std::vector&lt; double &gt; DoubleVector</div><div class="ttdoc">loads clump configuration</div><div class="ttdef"><b>Definition:</b> ClumpInput.h:26</div></div>
<div class="ttc" id="abenchVecAdd_8cpp_html_af9816f50f32fc22762a8289c3cc44f22"><div class="ttname"><a href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a></div><div class="ttdeci">Scalar * b</div><div class="ttdef"><b>Definition:</b> benchVecAdd.cpp:17</div></div>
<div class="ttc" id="aclassoomph_1_1FiniteElement_html_a5f8fe59f06da1da9f6b7bbcbdb90ef93"><div class="ttname"><a href="../../d2/dc6/classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">oomph::FiniteElement::dim</a></div><div class="ttdeci">unsigned dim() const</div><div class="ttdef"><b>Definition:</b> elements.h:2611</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_a4f274774435e9454bf77bf70de69367a"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#a4f274774435e9454bf77bf70de69367a">oomph::Mesh::finite_element_pt</a></div><div class="ttdeci">FiniteElement * finite_element_pt(const unsigned &amp;e) const</div><div class="ttdef"><b>Definition:</b> mesh.h:473</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_a6095e417593de6136d248ab08823f453"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#a6095e417593de6136d248ab08823f453">oomph::Mesh::face_index_at_boundary</a></div><div class="ttdeci">int face_index_at_boundary(const unsigned &amp;b, const unsigned &amp;e) const</div><div class="ttdef"><b>Definition:</b> mesh.h:896</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_a68e04b3b70cff70d53d75f66661555e8"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#a68e04b3b70cff70d53d75f66661555e8">oomph::Mesh::nboundary_element</a></div><div class="ttdeci">unsigned nboundary_element(const unsigned &amp;b) const</div><div class="ttdoc">Return number of finite elements that are adjacent to boundary b.</div><div class="ttdef"><b>Definition:</b> mesh.h:878</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_a84543564d6babe4faacbb9d87043fc19"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#a84543564d6babe4faacbb9d87043fc19">oomph::Mesh::nboundary</a></div><div class="ttdeci">unsigned nboundary() const</div><div class="ttdoc">Return number of boundaries.</div><div class="ttdef"><b>Definition:</b> mesh.h:827</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_a875271b6f162ddc5685a2511b35e75ec"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#a875271b6f162ddc5685a2511b35e75ec">oomph::Mesh::boundary_element_pt</a></div><div class="ttdeci">FiniteElement * boundary_element_pt(const unsigned &amp;b, const unsigned &amp;e) const</div><div class="ttdoc">Return pointer to e-th finite element on boundary b.</div><div class="ttdef"><b>Definition:</b> mesh.h:840</div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesSchurComplementPreconditioner_html_a03941c01d70ece07797301c8ac6a0a8a"><div class="ttname"><a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a03941c01d70ece07797301c8ac6a0a8a">oomph::NavierStokesSchurComplementPreconditioner::pin_all_non_pressure_dofs</a></div><div class="ttdeci">void pin_all_non_pressure_dofs()</div><div class="ttdoc">Pin all non-pressure dofs.</div><div class="ttdef"><b>Definition:</b> navier_stokes_preconditioners.h:862</div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesSchurComplementPreconditioner_html_af1c121b668b1961a68010f984166947c"><div class="ttname"><a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#af1c121b668b1961a68010f984166947c">oomph::NavierStokesSchurComplementPreconditioner::reset_pin_status</a></div><div class="ttdeci">void reset_pin_status()</div><div class="ttdoc">Reset pin status of all values.</div><div class="ttdef"><b>Definition:</b> navier_stokes_preconditioners.h:1060</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a0cd05109bc2c003c5c0686e6aa55d847"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a0cd05109bc2c003c5c0686e6aa55d847">oomph::Problem::add_sub_mesh</a></div><div class="ttdeci">unsigned add_sub_mesh(Mesh *const &amp;mesh_pt)</div><div class="ttdef"><b>Definition:</b> problem.h:1330</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a381c30a8daede5c95bdda7e2efa24f19"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">oomph::Problem::assembly_handler_pt</a></div><div class="ttdeci">AssemblyHandler *&amp; assembly_handler_pt()</div><div class="ttdoc">Return a pointer to the assembly handler object.</div><div class="ttdef"><b>Definition:</b> problem.h:1570</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_a42b2b42a03f9de7d7a4d24edcfa20179"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#a42b2b42a03f9de7d7a4d24edcfa20179">oomph::Problem::flush_sub_meshes</a></div><div class="ttdeci">void flush_sub_meshes()</div><div class="ttdef"><b>Definition:</b> problem.h:1339</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_aad122d70a22dc5302cfd5853d3cf3057"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">oomph::Problem::mesh_pt</a></div><div class="ttdeci">Mesh *&amp; mesh_pt()</div><div class="ttdoc">Return a pointer to the global mesh.</div><div class="ttdef"><b>Definition:</b> problem.h:1280</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_accc4e5a46953800933f07ae6bd67860e"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">oomph::Problem::nsub_mesh</a></div><div class="ttdeci">unsigned nsub_mesh() const</div><div class="ttdoc">Return number of submeshes.</div><div class="ttdef"><b>Definition:</b> problem.h:1323</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_af5e9f1623cad361048856a4c0463ea23"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#af5e9f1623cad361048856a4c0463ea23">oomph::Problem::distributed</a></div><div class="ttdeci">bool distributed() const</div><div class="ttdef"><b>Definition:</b> problem.h:808</div></div>
<div class="ttc" id="aclassoomph_1_1Problem_html_af660c2c0d10eaea1972314ce80de000e"><div class="ttname"><a href="../../dc/de5/classoomph_1_1Problem.html#af660c2c0d10eaea1972314ce80de000e">oomph::Problem::get_jacobian</a></div><div class="ttdeci">virtual void get_jacobian(DoubleVector &amp;residuals, DenseDoubleMatrix &amp;jacobian)</div><div class="ttdef"><b>Definition:</b> problem.cc:3890</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a0cd05109bc2c003c5c0686e6aa55d847">oomph::Problem::add_sub_mesh()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">oomph::Problem::assembly_handler_pt()</a>, <a class="el" href="../../db/ddc/benchVecAdd_8cpp.html#af9816f50f32fc22762a8289c3cc44f22">b</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a875271b6f162ddc5685a2511b35e75ec">oomph::Mesh::boundary_element_pt()</a>, <a class="el" href="../../de/df0/classoomph_1_1TemplateFreeNavierStokesEquationsBase.html#a8e896ce593f2dad7d21fade4afabe2c4">oomph::TemplateFreeNavierStokesEquationsBase::build_fp_press_adv_diff_robin_bc_element()</a>, <a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#ada7219933e05d94f39a46a8ddb4c749a">oomph::Preconditioner::comm_pt()</a>, <a class="el" href="../../de/df0/classoomph_1_1TemplateFreeNavierStokesEquationsBase.html#ac0505918d7458688c9cf55d348c92120">oomph::TemplateFreeNavierStokesEquationsBase::delete_pressure_advection_diffusion_robin_elements()</a>, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">oomph::FiniteElement::dim()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af5e9f1623cad361048856a4c0463ea23">oomph::Problem::distributed()</a>, <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">oomph::Mesh::element_pt()</a>, <a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a37ac5a1d5234fa931ab710c0c74d55d2">oomph::GeneralisedElement::eqn_number()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a6095e417593de6136d248ab08823f453">oomph::Mesh::face_index_at_boundary()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a4f274774435e9454bf77bf70de69367a">oomph::Mesh::finite_element_pt()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a42b2b42a03f9de7d7a4d24edcfa20179">oomph::Problem::flush_sub_meshes()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af660c2c0d10eaea1972314ce80de000e">oomph::Problem::get_jacobian()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#aad122d70a22dc5302cfd5853d3cf3057">oomph::Problem::mesh_pt()</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6153711f9561d3d617b78d3035147326">Navier_stokes_mesh_pt</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a84543564d6babe4faacbb9d87043fc19">oomph::Mesh::nboundary()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a68e04b3b70cff70d53d75f66661555e8">oomph::Mesh::nboundary_element()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">oomph::Mesh::nelement()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#accc4e5a46953800933f07ae6bd67860e">oomph::Problem::nsub_mesh()</a>, <a class="el" href="../../de/df0/classoomph_1_1TemplateFreeNavierStokesEquationsBase.html#a4e84f2f4260a0e65201cbb19fd63b398">oomph::TemplateFreeNavierStokesEquationsBase::p_local_eqn()</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a03941c01d70ece07797301c8ac6a0a8a">pin_all_non_pressure_dofs()</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a40ffaa90de4f861037cbd364789eb889">Pin_first_pressure_dof_in_press_adv_diff</a>, <a class="el" href="../../de/df0/classoomph_1_1TemplateFreeNavierStokesEquationsBase.html#a7b4c21107580d63e358ae7469f04399c">oomph::TemplateFreeNavierStokesEquationsBase::pinned_fp_pressure_eqn()</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#afc57fedbcd960d99c5ab3f135eacb612">problem_pt()</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#af1c121b668b1961a68010f984166947c">reset_pin_status()</a>, and <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a3aa99e654544365b78d4dca057ed53e0">Use_robin_for_fp</a>.</p>

</div>
</div>
<a id="a03941c01d70ece07797301c8ac6a0a8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03941c01d70ece07797301c8ac6a0a8a">&#9670;&nbsp;</a></span>pin_all_non_pressure_dofs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::NavierStokesSchurComplementPreconditioner::pin_all_non_pressure_dofs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pin all non-pressure dofs. </p>
<div class="fragment"><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    {</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;      <span class="comment">// Backup pin status and then pin all non-pressure degrees of freedom</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;      <span class="keywordtype">unsigned</span> nelem = <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6153711f9561d3d617b78d3035147326">Navier_stokes_mesh_pt</a>-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">nelement</a>();</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; nelem; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;      {</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;        <span class="comment">// Get pointer to the bulk element that is adjacent to boundary b</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        TemplateFreeNavierStokesEquationsBase* el_pt =</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;          <span class="keyword">dynamic_cast&lt;</span>TemplateFreeNavierStokesEquationsBase*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;            <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6153711f9561d3d617b78d3035147326">Navier_stokes_mesh_pt</a>-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">element_pt</a>(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>));</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160; </div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;        <span class="comment">// Pin</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        el_pt-&gt;pin_all_non_pressure_dofs(<a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#af34c14327511f1e7deb5726b85b05417">Eqn_number_backup</a>);</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;      }</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1NavierStokesSchurComplementPreconditioner_html_af34c14327511f1e7deb5726b85b05417"><div class="ttname"><a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#af34c14327511f1e7deb5726b85b05417">oomph::NavierStokesSchurComplementPreconditioner::Eqn_number_backup</a></div><div class="ttdeci">std::map&lt; Data *, std::vector&lt; int &gt; &gt; Eqn_number_backup</div><div class="ttdef"><b>Definition:</b> navier_stokes_preconditioners.h:1185</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">oomph::Mesh::element_pt()</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#af34c14327511f1e7deb5726b85b05417">Eqn_number_backup</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6153711f9561d3d617b78d3035147326">Navier_stokes_mesh_pt</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">oomph::Mesh::nelement()</a>, and <a class="el" href="../../de/df0/classoomph_1_1TemplateFreeNavierStokesEquationsBase.html#a23454a4f135b844b187dbe13c0a3c36f">oomph::TemplateFreeNavierStokesEquationsBase::pin_all_non_pressure_dofs()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ac3f40f62d33d33616cdb4bed48aaccde">get_pressure_advection_diffusion_matrix()</a>.</p>

</div>
</div>
<a id="af7d68718453adc8e7b9e19ad30cc9171"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7d68718453adc8e7b9e19ad30cc9171">&#9670;&nbsp;</a></span>pin_first_pressure_dof_in_press_adv_diff()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::NavierStokesSchurComplementPreconditioner::pin_first_pressure_dof_in_press_adv_diff </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Set boolean indicating that we want to pin first pressure dof in Navier Stokes mesh when assembling the pressure advection diffusion system for Fp preconditoner &ndash; needed at zero Reynolds number for non-enclosed flows but seems harmless in any case </p>
<div class="fragment"><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    {</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a40ffaa90de4f861037cbd364789eb889">Pin_first_pressure_dof_in_press_adv_diff</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a40ffaa90de4f861037cbd364789eb889">Pin_first_pressure_dof_in_press_adv_diff</a>.</p>

</div>
</div>
<a id="adbc87003dd8e8c924ae802651b18f2ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adbc87003dd8e8c924ae802651b18f2ed">&#9670;&nbsp;</a></span>preconditioner_solve()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::NavierStokesSchurComplementPreconditioner::preconditioner_solve </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;&#160;</td>
          <td class="paramname"><em>z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Apply preconditioner to Vector r. </p>
<p>Apply preconditioner to r. </p>

<p>Implements <a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#ace1199369e4465cd2b9a34884bb64ec8">oomph::Preconditioner</a>.</p>
<div class="fragment"><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160; {</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a3584d8bd088fad5ccce394899e167ca3">Preconditioner_has_been_setup</a>==<span class="keyword">false</span>)</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;   {</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    std::ostringstream error_message;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    error_message &lt;&lt; <span class="stringliteral">&quot;setup must be called before using preconditioner_solve&quot;</span>;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="../../d6/d00/classoomph_1_1OomphLibError.html">OomphLibError</a>(</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;     error_message.str(),</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;     <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;     <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;   }</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <span class="keywordflow">if</span> (z.<a class="code" href="../../d6/d5b/classoomph_1_1DoubleVector.html#aae402d422ec4344a4a45cdb7659b7161">built</a>())</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;   {</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="keywordflow">if</span> (z.<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a7569556f14fd68b28508920e89bd5eee">nrow</a>() != <a class="code" href="../../de/d6c/namespaceUniformPSDSelfTest.html#a9ef26be0d5673c9bb0c2bb8bce5229d8">r</a>.nrow())</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;     {</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      std::ostringstream error_message;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      error_message &lt;&lt; <span class="stringliteral">&quot;The vectors z and r must have the same number of &quot;</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;of global rows&quot;</span>;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="../../d6/d00/classoomph_1_1OomphLibError.html">OomphLibError</a>(</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;       error_message.str(),</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;       <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;       <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);      </div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;     }</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;   }</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160; </div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  <span class="comment">// if z is not setup then give it the same distribution</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <span class="keywordflow">if</span> (!z.<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>()-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a92bfff97fd228b9c528922c39ab563b2">built</a>())</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;   {</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    z.<a class="code" href="../../d6/d5b/classoomph_1_1DoubleVector.html#a7bcc94c157d6853a0f0502e8a76ed380">build</a>(<a class="code" href="../../de/d6c/namespaceUniformPSDSelfTest.html#a9ef26be0d5673c9bb0c2bb8bce5229d8">r</a>.distribution_pt(),0.0);</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;   }</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <span class="comment">// Step 1 - apply approximate Schur inverse to pressure unknowns (block 1)</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  <span class="comment">// -----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160; </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  <span class="comment">// Working vectors</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  <a class="code" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> temp_vec;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  <a class="code" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> another_temp_vec;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <a class="code" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> yet_another_temp_vec;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160; </div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  <span class="comment">// Copy pressure values from residual vector to temp_vec:</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  <span class="comment">// Loop over all entries in the global vector (this one</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <span class="comment">// includes velocity and pressure dofs in some random fashion)</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a7efc9f2f0209764902e4e45fcb2556d1">get_block_vector</a>(1,r,temp_vec);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160; </div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  <span class="comment">// NOTE: The vector temp_vec now contains the vector r_p.</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160; </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160; </div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  <span class="comment">// LSC version</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6c6abbfacbceba68be65855cc32bccb1">Use_LSC</a>)</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;   {</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="comment">// Solve first pressure Poisson system</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="comment">// check a solver has been set</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a94c09c485f93eb273f4217460da02811">P_preconditioner_pt</a>==0)</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;     {</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;      std::ostringstream error_message;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      error_message &lt;&lt; <span class="stringliteral">&quot;P_preconditioner_pt has not been set.&quot;</span>;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="../../d6/d00/classoomph_1_1OomphLibError.html">OomphLibError</a>(</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;       error_message.str(),</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;       <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;       <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;     }</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="comment">// use some Preconditioner&#39;s preconditioner_solve function</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a94c09c485f93eb273f4217460da02811">P_preconditioner_pt</a>-&gt;<a class="code" href="../../db/d9e/classoomph_1_1Preconditioner.html#ace1199369e4465cd2b9a34884bb64ec8">preconditioner_solve</a>(temp_vec, another_temp_vec);</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="comment">// NOTE: The vector another_temp_vec now contains the vector P^{-1} r_p</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    </div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="comment">// Multiply another_temp_vec by matrix E and stick the result into temp_vec</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    temp_vec.<a class="code" href="../../d6/d5b/classoomph_1_1DoubleVector.html#af1677445056759263b1b076966e7bfae">clear</a>();  </div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a7d88aae7807a9a8d07491dda4c8c2465">QBt_mat_vec_pt</a>-&gt;<a class="code" href="../../d1/dac/classoomph_1_1MatrixVectorProduct.html#ac29ba50f1a77bf0e316c3417bcff71ee">multiply</a>(another_temp_vec, temp_vec);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    another_temp_vec.<a class="code" href="../../d6/d5b/classoomph_1_1DoubleVector.html#af1677445056759263b1b076966e7bfae">clear</a>();</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a66a5925f3bd0642de7bd3e61b8d740dc">F_mat_vec_pt</a>-&gt;<a class="code" href="../../d1/dac/classoomph_1_1MatrixVectorProduct.html#ac29ba50f1a77bf0e316c3417bcff71ee">multiply</a>(temp_vec,another_temp_vec);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    temp_vec.<a class="code" href="../../d6/d5b/classoomph_1_1DoubleVector.html#af1677445056759263b1b076966e7bfae">clear</a>();</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a7d88aae7807a9a8d07491dda4c8c2465">QBt_mat_vec_pt</a>-&gt;<a class="code" href="../../d1/dac/classoomph_1_1MatrixVectorProduct.html#a2b7670797fe289ea814968f2f9469fd5">multiply_transpose</a>(another_temp_vec, temp_vec);</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    </div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    </div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="comment">// NOTE: The vector temp_vec now contains E P^{-1} r_p</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="comment">// Solve second pressure Poisson system using preconditioner_solve</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    another_temp_vec.<a class="code" href="../../d6/d5b/classoomph_1_1DoubleVector.html#af1677445056759263b1b076966e7bfae">clear</a>();</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a94c09c485f93eb273f4217460da02811">P_preconditioner_pt</a>-&gt;<a class="code" href="../../db/d9e/classoomph_1_1Preconditioner.html#ace1199369e4465cd2b9a34884bb64ec8">preconditioner_solve</a>(temp_vec, another_temp_vec);</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    </div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="comment">// NOTE: The vector another_temp_vec now contains z_p = P^{-1} E P^{-1} r_p</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="comment">//       as required (apart from the sign which we&#39;ll fix in the</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="comment">//       next step.</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160; </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;   }</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <span class="comment">// Fp version</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;   {</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="comment">// Multiply temp_vec by matrix E and stick the result into </span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="comment">// yet_another_temp_vec</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6a02950e86b2b8a092dda57587850d1c">E_mat_vec_pt</a>-&gt;<a class="code" href="../../d1/dac/classoomph_1_1MatrixVectorProduct.html#ac29ba50f1a77bf0e316c3417bcff71ee">multiply</a>(temp_vec,yet_another_temp_vec);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="comment">// NOTE: The vector yet_another_temp_vec now contains Fp Qp^{-1} r_p</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160; </div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="comment">// Solve pressure Poisson system</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="comment">// check a solver has been set</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a94c09c485f93eb273f4217460da02811">P_preconditioner_pt</a>==0)</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;     {</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;      std::ostringstream error_message;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;      error_message &lt;&lt; <span class="stringliteral">&quot;P_preconditioner_pt has not been set.&quot;</span>;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="../../d6/d00/classoomph_1_1OomphLibError.html">OomphLibError</a>(</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;       error_message.str(),</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;       <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;       <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;     }</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    </div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="comment">// Solve second pressure Poisson system using preconditioner_solve</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    another_temp_vec.<a class="code" href="../../d6/d5b/classoomph_1_1DoubleVector.html#af1677445056759263b1b076966e7bfae">clear</a>();</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a94c09c485f93eb273f4217460da02811">P_preconditioner_pt</a>-&gt;<a class="code" href="../../db/d9e/classoomph_1_1Preconditioner.html#ace1199369e4465cd2b9a34884bb64ec8">preconditioner_solve</a>(yet_another_temp_vec, </div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                                              another_temp_vec);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="comment">// NOTE: The vector another_temp_vec now contains </span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="comment">//       z_p = P^{-1} Fp Qp^{-1} r_p</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="comment">//       as required (apart from the sign which we&#39;ll fix in the</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="comment">//       next step.</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160; </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;   }</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160; </div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  <span class="comment">// Now copy another_temp_vec (i.e. z_p) back into the global vector z.</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  <span class="comment">// Loop over all entries in the global results vector z:</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  temp_vec.<a class="code" href="../../d6/d5b/classoomph_1_1DoubleVector.html#a7bcc94c157d6853a0f0502e8a76ed380">build</a>(another_temp_vec.<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>(),0.0);</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  temp_vec -= another_temp_vec;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  <a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a1dd4d3cd6b64fa64e1ff6730b0deecc7">return_block_vector</a>(1,temp_vec,z);</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  </div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160; </div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  <span class="comment">// Step 2 - apply preconditioner to velocity unknowns (block 0)</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  <span class="comment">// ------------------------------------------------------------</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  </div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  <span class="comment">// Recall that another_temp_vec (computed above) contains the</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  <span class="comment">// negative of the solution of the Schur complement systen, -z_p.</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  <span class="comment">// Multiply by G (stored in Block_matrix_pt(0,1) and store</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  <span class="comment">// result in temp_vec (vector resizes itself).</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  temp_vec.<a class="code" href="../../d6/d5b/classoomph_1_1DoubleVector.html#af1677445056759263b1b076966e7bfae">clear</a>();</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ad7bc578498d001d81223b37badefb44b">Bt_mat_vec_pt</a>-&gt;<a class="code" href="../../d1/dac/classoomph_1_1MatrixVectorProduct.html#ac29ba50f1a77bf0e316c3417bcff71ee">multiply</a>(another_temp_vec, temp_vec);</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160; </div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  <span class="comment">// NOTE: temp_vec now contains -G z_p</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160; </div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  <span class="comment">// The vector another_temp_vec is no longer needed -- re-use it to store</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  <span class="comment">// velocity quantities:</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  another_temp_vec.<a class="code" href="../../d6/d5b/classoomph_1_1DoubleVector.html#af1677445056759263b1b076966e7bfae">clear</a>();</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160; </div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  <span class="comment">// Loop over all enries in the global vector and find the</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  <span class="comment">// entries associated with the velocities:</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  <a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a7efc9f2f0209764902e4e45fcb2556d1">get_block_vector</a>(0,<a class="code" href="../../de/d6c/namespaceUniformPSDSelfTest.html#a9ef26be0d5673c9bb0c2bb8bce5229d8">r</a>,another_temp_vec);</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  another_temp_vec += temp_vec;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160; </div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  <span class="comment">// NOTE:  The vector another_temp_vec now contains r_u - G z_p</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160; </div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  <span class="comment">// Solve momentum system</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  <span class="comment">// check a solver has been set</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a14a63179117e8cf5822c89ae2b5c9902">F_preconditioner_pt</a>==0)</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;   {</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    std::ostringstream error_message;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    error_message &lt;&lt; <span class="stringliteral">&quot;F_preconditioner_pt has not been set.&quot;</span>; </div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="../../d6/d00/classoomph_1_1OomphLibError.html">OomphLibError</a>(</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;     error_message.str(),</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;     <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;     <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;   }</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160; </div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  <span class="comment">// use some Preconditioner&#39;s preconditioner solve</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  <span class="comment">// and return</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ad3e3b6635c1524d8413a75642e4bc4e1">F_preconditioner_is_block_preconditioner</a>)</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;   {</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a1dd4d3cd6b64fa64e1ff6730b0deecc7">return_block_vector</a>(0,another_temp_vec,z);</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a14a63179117e8cf5822c89ae2b5c9902">F_preconditioner_pt</a>-&gt;<a class="code" href="../../db/d9e/classoomph_1_1Preconditioner.html#ace1199369e4465cd2b9a34884bb64ec8">preconditioner_solve</a>(z,z);</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;   }</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;   {</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a14a63179117e8cf5822c89ae2b5c9902">F_preconditioner_pt</a>-&gt;<a class="code" href="../../db/d9e/classoomph_1_1Preconditioner.html#ace1199369e4465cd2b9a34884bb64ec8">preconditioner_solve</a>(another_temp_vec, temp_vec);</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a1dd4d3cd6b64fa64e1ff6730b0deecc7">return_block_vector</a>(0,temp_vec,z);</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;   }</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160; }</div>
<div class="ttc" id="aclassoomph_1_1BlockPreconditioner_html_a1dd4d3cd6b64fa64e1ff6730b0deecc7"><div class="ttname"><a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a1dd4d3cd6b64fa64e1ff6730b0deecc7">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::return_block_vector</a></div><div class="ttdeci">void return_block_vector(const unsigned &amp;n, const DoubleVector &amp;b, DoubleVector &amp;v) const</div><div class="ttdef"><b>Definition:</b> block_preconditioner.cc:4489</div></div>
<div class="ttc" id="aclassoomph_1_1BlockPreconditioner_html_a7efc9f2f0209764902e4e45fcb2556d1"><div class="ttname"><a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a7efc9f2f0209764902e4e45fcb2556d1">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::get_block_vector</a></div><div class="ttdeci">void get_block_vector(const unsigned &amp;n, const DoubleVector &amp;v, DoubleVector &amp;b) const</div><div class="ttdef"><b>Definition:</b> block_preconditioner.cc:4186</div></div>
<div class="ttc" id="aclassoomph_1_1DistributableLinearAlgebraObject_html_a603105384d60c9a3710378af39f538b9"><div class="ttname"><a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">oomph::DistributableLinearAlgebraObject::distribution_pt</a></div><div class="ttdeci">LinearAlgebraDistribution * distribution_pt() const</div><div class="ttdoc">access to the LinearAlgebraDistribution</div><div class="ttdef"><b>Definition:</b> linear_algebra_distribution.h:457</div></div>
<div class="ttc" id="aclassoomph_1_1DistributableLinearAlgebraObject_html_a7569556f14fd68b28508920e89bd5eee"><div class="ttname"><a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a7569556f14fd68b28508920e89bd5eee">oomph::DistributableLinearAlgebraObject::nrow</a></div><div class="ttdeci">unsigned nrow() const</div><div class="ttdoc">access function to the number of global rows.</div><div class="ttdef"><b>Definition:</b> linear_algebra_distribution.h:463</div></div>
<div class="ttc" id="aclassoomph_1_1DoubleVector_html"><div class="ttname"><a href="../../d6/d5b/classoomph_1_1DoubleVector.html">oomph::DoubleVector</a></div><div class="ttdef"><b>Definition:</b> double_vector.h:58</div></div>
<div class="ttc" id="aclassoomph_1_1DoubleVector_html_a7bcc94c157d6853a0f0502e8a76ed380"><div class="ttname"><a href="../../d6/d5b/classoomph_1_1DoubleVector.html#a7bcc94c157d6853a0f0502e8a76ed380">oomph::DoubleVector::build</a></div><div class="ttdeci">void build(const DoubleVector &amp;old_vector)</div><div class="ttdoc">Just copys the argument DoubleVector.</div><div class="ttdef"><b>Definition:</b> double_vector.cc:35</div></div>
<div class="ttc" id="aclassoomph_1_1DoubleVector_html_aae402d422ec4344a4a45cdb7659b7161"><div class="ttname"><a href="../../d6/d5b/classoomph_1_1DoubleVector.html#aae402d422ec4344a4a45cdb7659b7161">oomph::DoubleVector::built</a></div><div class="ttdeci">bool built() const</div><div class="ttdef"><b>Definition:</b> double_vector.h:154</div></div>
<div class="ttc" id="aclassoomph_1_1DoubleVector_html_af1677445056759263b1b076966e7bfae"><div class="ttname"><a href="../../d6/d5b/classoomph_1_1DoubleVector.html#af1677445056759263b1b076966e7bfae">oomph::DoubleVector::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdoc">wipes the DoubleVector</div><div class="ttdef"><b>Definition:</b> double_vector.h:142</div></div>
<div class="ttc" id="aclassoomph_1_1LinearAlgebraDistribution_html_a92bfff97fd228b9c528922c39ab563b2"><div class="ttname"><a href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a92bfff97fd228b9c528922c39ab563b2">oomph::LinearAlgebraDistribution::built</a></div><div class="ttdeci">bool built() const</div><div class="ttdef"><b>Definition:</b> linear_algebra_distribution.h:342</div></div>
<div class="ttc" id="aclassoomph_1_1MatrixVectorProduct_html_a2b7670797fe289ea814968f2f9469fd5"><div class="ttname"><a href="../../d1/dac/classoomph_1_1MatrixVectorProduct.html#a2b7670797fe289ea814968f2f9469fd5">oomph::MatrixVectorProduct::multiply_transpose</a></div><div class="ttdeci">void multiply_transpose(const DoubleVector &amp;x, DoubleVector &amp;y) const</div><div class="ttdef"><b>Definition:</b> matrix_vector_product.cc:177</div></div>
<div class="ttc" id="aclassoomph_1_1MatrixVectorProduct_html_ac29ba50f1a77bf0e316c3417bcff71ee"><div class="ttname"><a href="../../d1/dac/classoomph_1_1MatrixVectorProduct.html#ac29ba50f1a77bf0e316c3417bcff71ee">oomph::MatrixVectorProduct::multiply</a></div><div class="ttdeci">void multiply(const DoubleVector &amp;x, DoubleVector &amp;y) const</div><div class="ttdef"><b>Definition:</b> matrix_vector_product.cc:108</div></div>
<div class="ttc" id="aclassoomph_1_1NavierStokesSchurComplementPreconditioner_html_ad3e3b6635c1524d8413a75642e4bc4e1"><div class="ttname"><a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ad3e3b6635c1524d8413a75642e4bc4e1">oomph::NavierStokesSchurComplementPreconditioner::F_preconditioner_is_block_preconditioner</a></div><div class="ttdeci">bool F_preconditioner_is_block_preconditioner</div><div class="ttdef"><b>Definition:</b> navier_stokes_preconditioners.h:1152</div></div>
<div class="ttc" id="aclassoomph_1_1OomphLibError_html"><div class="ttname"><a href="../../d6/d00/classoomph_1_1OomphLibError.html">oomph::OomphLibError</a></div><div class="ttdef"><b>Definition:</b> oomph_definitions.h:222</div></div>
<div class="ttc" id="aclassoomph_1_1Preconditioner_html_ace1199369e4465cd2b9a34884bb64ec8"><div class="ttname"><a href="../../db/d9e/classoomph_1_1Preconditioner.html#ace1199369e4465cd2b9a34884bb64ec8">oomph::Preconditioner::preconditioner_solve</a></div><div class="ttdeci">virtual void preconditioner_solve(const DoubleVector &amp;r, DoubleVector &amp;z)=0</div></div>
<div class="ttc" id="anamespaceUniformPSDSelfTest_html_a9ef26be0d5673c9bb0c2bb8bce5229d8"><div class="ttname"><a href="../../de/d6c/namespaceUniformPSDSelfTest.html#a9ef26be0d5673c9bb0c2bb8bce5229d8">UniformPSDSelfTest.r</a></div><div class="ttdeci">r</div><div class="ttdef"><b>Definition:</b> UniformPSDSelfTest.py:20</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#a7bcc94c157d6853a0f0502e8a76ed380">oomph::DoubleVector::build()</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#aae402d422ec4344a4a45cdb7659b7161">oomph::DoubleVector::built()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a92bfff97fd228b9c528922c39ab563b2">oomph::LinearAlgebraDistribution::built()</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#af1677445056759263b1b076966e7bfae">oomph::DoubleVector::clear()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">oomph::DistributableLinearAlgebraObject::distribution_pt()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a7569556f14fd68b28508920e89bd5eee">oomph::DistributableLinearAlgebraObject::nrow()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, and <a class="el" href="../../de/d6c/namespaceUniformPSDSelfTest.html#a9ef26be0d5673c9bb0c2bb8bce5229d8">UniformPSDSelfTest::r</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d59/classoomph_1_1FSIPreconditioner.html#a31c84c3ca19c31488acd0bf2fe333a6b">oomph::FSIPreconditioner::preconditioner_solve()</a>, and <a class="el" href="../../d1/dc5/classoomph_1_1PseudoElasticFSIPreconditioner.html#ad29c2852949caec2d20cbe7cf99f1b38">oomph::PseudoElasticFSIPreconditioner::preconditioner_solve()</a>.</p>

</div>
</div>
<a id="afc57fedbcd960d99c5ab3f135eacb612"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc57fedbcd960d99c5ab3f135eacb612">&#9670;&nbsp;</a></span>problem_pt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a>* oomph::NavierStokesSchurComplementPreconditioner::problem_pt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    {</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a32957b16d3827ea7e6f308e1f3b6f246">Problem_pt</a> == 0)</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;      {</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        std::ostringstream error_msg;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        error_msg &lt;&lt; <span class="stringliteral">&quot;Problem pointer is null, did you set it yet?&quot;</span>;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;          error_msg.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;      }</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a32957b16d3827ea7e6f308e1f3b6f246">Problem_pt</a>;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, and <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a32957b16d3827ea7e6f308e1f3b6f246">Problem_pt</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ab45d7496790cc29a056b83c194aa2a1c">assemble_inv_press_and_veloc_mass_matrix_diagonal()</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ac3f40f62d33d33616cdb4bed48aaccde">get_pressure_advection_diffusion_matrix()</a>, and <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a41814f592afecb493310be513c595739">set_problem_pt()</a>.</p>

</div>
</div>
<a id="af1c121b668b1961a68010f984166947c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1c121b668b1961a68010f984166947c">&#9670;&nbsp;</a></span>reset_pin_status()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::NavierStokesSchurComplementPreconditioner::reset_pin_status </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reset pin status of all values. </p>
<div class="fragment"><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    {</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;      <span class="comment">// Reset pin status for nodes</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;      <span class="keywordtype">unsigned</span> nnod = <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6153711f9561d3d617b78d3035147326">Navier_stokes_mesh_pt</a>-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a945e7823d1a2af243b5b7f7866aaff5e">nnode</a>();</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; nnod; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;      {</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;        Node* nod_pt = <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6153711f9561d3d617b78d3035147326">Navier_stokes_mesh_pt</a>-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">node_pt</a>(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;        <span class="keywordtype">unsigned</span> nval = nod_pt-&gt;<a class="code" href="../../d8/dc5/classoomph_1_1Data.html#a7e67fc78a2e8a2fd6eb75bd292d42ff8">nvalue</a>();</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; nval; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;        {</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;          nod_pt-&gt;eqn_number(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#af34c14327511f1e7deb5726b85b05417">Eqn_number_backup</a>[nod_pt][<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        }</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160; </div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;        <span class="comment">// If it&#39;s a solid node deal with its positional data too</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;        SolidNode* solid_nod_pt = <span class="keyword">dynamic_cast&lt;</span>SolidNode*<span class="keyword">&gt;</span>(nod_pt);</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;        <span class="keywordflow">if</span> (solid_nod_pt != 0)</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;        {</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;          Data* solid_posn_data_pt = solid_nod_pt-&gt;variable_position_pt();</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;          <span class="keywordtype">unsigned</span> nval = solid_posn_data_pt-&gt;nvalue();</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; nval; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;          {</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;            solid_posn_data_pt-&gt;eqn_number(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) =</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;              <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#af34c14327511f1e7deb5726b85b05417">Eqn_number_backup</a>[solid_posn_data_pt][<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;          }</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;        }</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;      }</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160; </div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;      <span class="comment">// ... and internal data</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;      <span class="keywordtype">unsigned</span> nelem = <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6153711f9561d3d617b78d3035147326">Navier_stokes_mesh_pt</a>-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">nelement</a>();</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; nelem; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;      {</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;        <span class="comment">// Pointer to element</span></div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;        GeneralisedElement* el_pt = <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6153711f9561d3d617b78d3035147326">Navier_stokes_mesh_pt</a>-&gt;<a class="code" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">element_pt</a>(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>);</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160; </div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;        <span class="comment">// Pin/unpin internal data</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;        <span class="keywordtype">unsigned</span> nint = el_pt-&gt;<a class="code" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a6b736de0af4c92831968636479b3480e">ninternal_data</a>();</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; nint; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;        {</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;          Data* data_pt = el_pt-&gt;internal_data_pt(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>);</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;          <span class="keywordtype">unsigned</span> nvalue = data_pt-&gt;nvalue();</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; nvalue; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;          {</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;            data_pt-&gt;eqn_number(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>) = <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#af34c14327511f1e7deb5726b85b05417">Eqn_number_backup</a>[data_pt][<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;          }</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;        }</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;      }</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160; </div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;      <span class="comment">// Free up storage</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#af34c14327511f1e7deb5726b85b05417">Eqn_number_backup</a>.clear();</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1Data_html_a7e67fc78a2e8a2fd6eb75bd292d42ff8"><div class="ttname"><a href="../../d8/dc5/classoomph_1_1Data.html#a7e67fc78a2e8a2fd6eb75bd292d42ff8">oomph::Data::nvalue</a></div><div class="ttdeci">unsigned nvalue() const</div><div class="ttdoc">Return number of values stored in data object (incl pinned ones).</div><div class="ttdef"><b>Definition:</b> nodes.h:483</div></div>
<div class="ttc" id="aclassoomph_1_1GeneralisedElement_html_a6b736de0af4c92831968636479b3480e"><div class="ttname"><a href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a6b736de0af4c92831968636479b3480e">oomph::GeneralisedElement::ninternal_data</a></div><div class="ttdeci">unsigned ninternal_data() const</div><div class="ttdoc">Return the number of internal data objects.</div><div class="ttdef"><b>Definition:</b> elements.h:823</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_a945e7823d1a2af243b5b7f7866aaff5e"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#a945e7823d1a2af243b5b7f7866aaff5e">oomph::Mesh::nnode</a></div><div class="ttdeci">unsigned long nnode() const</div><div class="ttdoc">Return number of nodes in the mesh.</div><div class="ttdef"><b>Definition:</b> mesh.h:596</div></div>
<div class="ttc" id="aclassoomph_1_1Mesh_html_ab3c2b72c8ef4e9fd35f5998a5e7dc93b"><div class="ttname"><a href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">oomph::Mesh::node_pt</a></div><div class="ttdeci">Node *&amp; node_pt(const unsigned long &amp;n)</div><div class="ttdoc">Return pointer to global node n.</div><div class="ttdef"><b>Definition:</b> mesh.h:436</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">oomph::Mesh::element_pt()</a>, <a class="el" href="../../d8/dc5/classoomph_1_1Data.html#a13206dcb7a088db0ef845ab71af505d2">oomph::Data::eqn_number()</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#af34c14327511f1e7deb5726b85b05417">Eqn_number_backup</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a45e32d895d4b3686e0f15fe455f4ed44">oomph::GeneralisedElement::internal_data_pt()</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6153711f9561d3d617b78d3035147326">Navier_stokes_mesh_pt</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">oomph::Mesh::nelement()</a>, <a class="el" href="../../dd/d46/classoomph_1_1GeneralisedElement.html#a6b736de0af4c92831968636479b3480e">oomph::GeneralisedElement::ninternal_data()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a945e7823d1a2af243b5b7f7866aaff5e">oomph::Mesh::nnode()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#ab3c2b72c8ef4e9fd35f5998a5e7dc93b">oomph::Mesh::node_pt()</a>, <a class="el" href="../../d8/dc5/classoomph_1_1Data.html#a7e67fc78a2e8a2fd6eb75bd292d42ff8">oomph::Data::nvalue()</a>, and <a class="el" href="../../dc/dfd/classoomph_1_1SolidNode.html#ae9a8abd197728f5555730131fa0f6971">oomph::SolidNode::variable_position_pt()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ac3f40f62d33d33616cdb4bed48aaccde">get_pressure_advection_diffusion_matrix()</a>.</p>

</div>
</div>
<a id="ab2f387b87192dd2f7b6725cfe3aae44e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2f387b87192dd2f7b6725cfe3aae44e">&#9670;&nbsp;</a></span>set_f_preconditioner()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::NavierStokesSchurComplementPreconditioner::set_f_preconditioner </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html">Preconditioner</a> *&#160;</td>
          <td class="paramname"><em>new_f_preconditioner_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to set a new momentum matrix preconditioner (inexact solver) </p>
<div class="fragment"><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    {</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;      <span class="comment">// If the default preconditioner has been used</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;      <span class="comment">// clean it up now...</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a925aa01327e8a6af8c543d2983e92d2f">Using_default_f_preconditioner</a>)</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;      {</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;        <span class="keyword">delete</span> <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a14a63179117e8cf5822c89ae2b5c9902">F_preconditioner_pt</a>;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;      }</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a14a63179117e8cf5822c89ae2b5c9902">F_preconditioner_pt</a> = new_f_preconditioner_pt;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a925aa01327e8a6af8c543d2983e92d2f">Using_default_f_preconditioner</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a14a63179117e8cf5822c89ae2b5c9902">F_preconditioner_pt</a>, and <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a925aa01327e8a6af8c543d2983e92d2f">Using_default_f_preconditioner</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../de/da5/classFpTestProblem.html#a8f9af5a447dedb8bd0697a401e196580">FpTestProblem::FpTestProblem()</a>, <a class="el" href="../../dd/d2b/flux__control_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, <a class="el" href="../../dd/d4a/classFSIChannelWithLeafletProblem.html#a8ca939c0edc4194e4e5cb7d1404f27de">FSIChannelWithLeafletProblem&lt; ELEMENT &gt;::set_iterative_solver()</a>, <a class="el" href="../../d3/db4/classPseudoElasticCollapsibleChannelProblem.html#ae7ad973630ae15ef128a389647c9f3d5">PseudoElasticCollapsibleChannelProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;::set_pseudo_elastic_fsi_solver()</a>, <a class="el" href="../../d0/d06/pseudo__solid__collapsible__tube__work_8cc.html#a70937d2ecaf424a21a2416ee61f61316">set_pseudo_elastic_fsi_solver()</a>, <a class="el" href="../../d1/d16/classTiltedCavityProblem.html#a77b22e4024cfaed06ebf6ec69d56e669">TiltedCavityProblem&lt; ELEMENT &gt;::TiltedCavityProblem()</a>, and <a class="el" href="../../d6/d07/classTorusProblem.html#af0485a4153afe04b635083527cacbb20">TorusProblem&lt; ELEMENT &gt;::TorusProblem()</a>.</p>

</div>
</div>
<a id="af29abc6e2b9fd92ae3a31a4f9d56f6b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af29abc6e2b9fd92ae3a31a4f9d56f6b8">&#9670;&nbsp;</a></span>set_f_superlu_preconditioner()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::NavierStokesSchurComplementPreconditioner::set_f_superlu_preconditioner </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Function to (re-)set momentum matrix preconditioner (inexact solver) to SuperLU </p>
<div class="fragment"><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    {</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a925aa01327e8a6af8c543d2983e92d2f">Using_default_f_preconditioner</a>)</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;      {</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a14a63179117e8cf5822c89ae2b5c9902">F_preconditioner_pt</a> = <span class="keyword">new</span> SuperLUPreconditioner;</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a925aa01327e8a6af8c543d2983e92d2f">Using_default_f_preconditioner</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;      }</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a14a63179117e8cf5822c89ae2b5c9902">F_preconditioner_pt</a>, and <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a925aa01327e8a6af8c543d2983e92d2f">Using_default_f_preconditioner</a>.</p>

</div>
</div>
<a id="abe80b5bb32d24f49f427d04118de284a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe80b5bb32d24f49f427d04118de284a">&#9670;&nbsp;</a></span>set_navier_stokes_mesh()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::NavierStokesSchurComplementPreconditioner::set_navier_stokes_mesh </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *&#160;</td>
          <td class="paramname"><em>mesh_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;&#160;</td>
          <td class="paramname"><em>allow_multiple_element_type_in_navier_stokes_mesh</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Specify the mesh containing the block-preconditionable Navier-Stokes elements. The optional argument indicates if there are multiple types of elements in the same mesh. </p>
<div class="fragment"><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    {</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;      <span class="comment">// Store the mesh pointer.</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6153711f9561d3d617b78d3035147326">Navier_stokes_mesh_pt</a> = <a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a3c0e92cb77c3e3179007fe9fd99b6428">mesh_pt</a>;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160; </div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;      <span class="comment">// Are there multiple element types in this mesh?</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a932ce8737a185ca987a2c75d8af360d9">Allow_multiple_element_type_in_navier_stokes_mesh</a> =</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        allow_multiple_element_type_in_navier_stokes_mesh;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1BlockPreconditioner_html_a3c0e92cb77c3e3179007fe9fd99b6428"><div class="ttname"><a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a3c0e92cb77c3e3179007fe9fd99b6428">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::mesh_pt</a></div><div class="ttdeci">const Mesh * mesh_pt(const unsigned &amp;i) const</div><div class="ttdef"><b>Definition:</b> block_preconditioner.h:1782</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a932ce8737a185ca987a2c75d8af360d9">Allow_multiple_element_type_in_navier_stokes_mesh</a>, <a class="el" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a3c0e92cb77c3e3179007fe9fd99b6428">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::mesh_pt()</a>, and <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6153711f9561d3d617b78d3035147326">Navier_stokes_mesh_pt</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../de/da5/classFpTestProblem.html#a8f9af5a447dedb8bd0697a401e196580">FpTestProblem::FpTestProblem()</a>, <a class="el" href="../../dd/d2b/flux__control_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, <a class="el" href="../../dd/d59/classoomph_1_1FSIPreconditioner.html#adadfe9f4332af610b00f1f45d1ad432e">oomph::FSIPreconditioner::setup()</a>, <a class="el" href="../../d1/dc5/classoomph_1_1PseudoElasticFSIPreconditioner.html#a460ad5eea59f4c07dfde8b11696fabb1">oomph::PseudoElasticFSIPreconditioner::setup()</a>, <a class="el" href="../../d1/d16/classTiltedCavityProblem.html#a77b22e4024cfaed06ebf6ec69d56e669">TiltedCavityProblem&lt; ELEMENT &gt;::TiltedCavityProblem()</a>, and <a class="el" href="../../d6/d07/classTorusProblem.html#af0485a4153afe04b635083527cacbb20">TorusProblem&lt; ELEMENT &gt;::TorusProblem()</a>.</p>

</div>
</div>
<a id="a48f0d5e878eccab6e7f080c92d4bc6f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48f0d5e878eccab6e7f080c92d4bc6f5">&#9670;&nbsp;</a></span>set_p_preconditioner()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::NavierStokesSchurComplementPreconditioner::set_p_preconditioner </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html">Preconditioner</a> *&#160;</td>
          <td class="paramname"><em>new_p_preconditioner_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to set a new pressure matrix preconditioner (inexact solver) </p>
<div class="fragment"><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    {</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;      <span class="comment">// If the default preconditioner has been used</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;      <span class="comment">// clean it up now...</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6d9eb3bdee67fafd228e0923e61bd812">Using_default_p_preconditioner</a>)</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;      {</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        <span class="keyword">delete</span> <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a94c09c485f93eb273f4217460da02811">P_preconditioner_pt</a>;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;      }</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a94c09c485f93eb273f4217460da02811">P_preconditioner_pt</a> = new_p_preconditioner_pt;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6d9eb3bdee67fafd228e0923e61bd812">Using_default_p_preconditioner</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a94c09c485f93eb273f4217460da02811">P_preconditioner_pt</a>, and <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6d9eb3bdee67fafd228e0923e61bd812">Using_default_p_preconditioner</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../de/da5/classFpTestProblem.html#a8f9af5a447dedb8bd0697a401e196580">FpTestProblem::FpTestProblem()</a>, <a class="el" href="../../dd/d2b/flux__control_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, <a class="el" href="../../dd/d4a/classFSIChannelWithLeafletProblem.html#a8ca939c0edc4194e4e5cb7d1404f27de">FSIChannelWithLeafletProblem&lt; ELEMENT &gt;::set_iterative_solver()</a>, <a class="el" href="../../d3/db4/classPseudoElasticCollapsibleChannelProblem.html#ae7ad973630ae15ef128a389647c9f3d5">PseudoElasticCollapsibleChannelProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;::set_pseudo_elastic_fsi_solver()</a>, <a class="el" href="../../d0/d06/pseudo__solid__collapsible__tube__work_8cc.html#a70937d2ecaf424a21a2416ee61f61316">set_pseudo_elastic_fsi_solver()</a>, <a class="el" href="../../d1/d16/classTiltedCavityProblem.html#a77b22e4024cfaed06ebf6ec69d56e669">TiltedCavityProblem&lt; ELEMENT &gt;::TiltedCavityProblem()</a>, and <a class="el" href="../../d6/d07/classTorusProblem.html#af0485a4153afe04b635083527cacbb20">TorusProblem&lt; ELEMENT &gt;::TorusProblem()</a>.</p>

</div>
</div>
<a id="a05bac2703d9570c15bf0676cbbe7ce03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05bac2703d9570c15bf0676cbbe7ce03">&#9670;&nbsp;</a></span>set_p_superlu_preconditioner()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::NavierStokesSchurComplementPreconditioner::set_p_superlu_preconditioner </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Function to (re-)set pressure matrix preconditioner (inexact solver) to SuperLU </p>
<div class="fragment"><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    {</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6d9eb3bdee67fafd228e0923e61bd812">Using_default_p_preconditioner</a>)</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;      {</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a94c09c485f93eb273f4217460da02811">P_preconditioner_pt</a> = <span class="keyword">new</span> SuperLUPreconditioner;</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6d9eb3bdee67fafd228e0923e61bd812">Using_default_p_preconditioner</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;      }</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a94c09c485f93eb273f4217460da02811">P_preconditioner_pt</a>, and <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6d9eb3bdee67fafd228e0923e61bd812">Using_default_p_preconditioner</a>.</p>

</div>
</div>
<a id="a41814f592afecb493310be513c595739"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41814f592afecb493310be513c595739">&#9670;&nbsp;</a></span>set_problem_pt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::NavierStokesSchurComplementPreconditioner::set_problem_pt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *&#160;</td>
          <td class="paramname"><em>problem_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Broken assignment operator. </p>
<p>Set the problem pointer (non-const pointer, the problem WILL be changed) for use in get_pressure_advection_diffusion_matrix(). </p>
<div class="fragment"><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    {</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a32957b16d3827ea7e6f308e1f3b6f246">Problem_pt</a> = <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#afc57fedbcd960d99c5ab3f135eacb612">problem_pt</a>;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#afc57fedbcd960d99c5ab3f135eacb612">problem_pt()</a>, and <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a32957b16d3827ea7e6f308e1f3b6f246">Problem_pt</a>.</p>

</div>
</div>
<a id="a03cbfa527081ea03c910aadc281615d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03cbfa527081ea03c910aadc281615d7">&#9670;&nbsp;</a></span>setup() <span class="overload">[1/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::NavierStokesSchurComplementPreconditioner::setup </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Setup the preconditioner. </p>
<p>Setup the least-squares commutator Navier Stokes preconditioner. This extracts blocks corresponding to the velocity and pressure unknowns, creates the matrices actually needed in the application of the preconditioner and deletes what can be deleted... Note that this preconditioner needs a CRDoubleMatrix.</p>
<p>///////////////////////////////////////////////////////////// ///////////////////////////////////////////////////////////// ///////////////////////////////////////////////////////////// Setup the least-squares commutator Navier Stokes preconditioner. This extracts blocks corresponding to the velocity and pressure unknowns, creates the matrices actually needed in the application of the preconditioner and deletes what can be deleted... Note that this preconditioner needs a CRDoubleMatrix. </p>

<p>Implements <a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#af4886f4efe510e5c9b0eb19422943588">oomph::Preconditioner</a>.</p>
<div class="fragment"><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; {</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="comment">//%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="comment">// NOTE: In the interest of minimising memory usage, several containers</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="comment">//       are recycled, therefore their content/meaning changes</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="comment">//       throughout this function. The code is carefully annotated</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="comment">//       but you&#39;ll have to read it line by line!</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="comment">//%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="comment">// make sure any old data is deleted</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a5cac2493de85690e3954949eb2a27d2c">clean_up_memory</a>(); <span class="comment">// hierher</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="comment">// paranoid check that the navier stokes mesh pt has been set</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6153711f9561d3d617b78d3035147326">Navier_stokes_mesh_pt</a> == 0)</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;   {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    std::ostringstream error_message;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    error_message &lt;&lt; <span class="stringliteral">&quot;The navier stokes elements mesh pointer must be set.\n&quot;</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;Use method set_navier_stokes_mesh(...)&quot;</span>;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="../../d6/d00/classoomph_1_1OomphLibError.html">OomphLibError</a>(error_message.str(),</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                        <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                        <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;   }</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="comment">// set the mesh</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ae055f998f6145656352aacac22e545ad">set_nmesh</a>(1);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#af97821621b570d409e6662939e5f818d">set_mesh</a>(0,<a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6153711f9561d3d617b78d3035147326">Navier_stokes_mesh_pt</a>);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="comment">// Get blocks</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="comment">// ----------</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <span class="comment">// In comes the current Jacobian. Recast it to a CR double matrix;</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="comment">// shout if that can&#39;t be done.</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a>* cr_matrix_pt = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a>*<span class="keyword">&gt;</span>(<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a9aac48fd53e579e6db8eeed58933a14b">matrix_pt</a>());</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="keywordflow">if</span> (cr_matrix_pt==0)</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;   {</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    std::ostringstream error_message;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    error_message </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;     &lt;&lt; <span class="stringliteral">&quot;NavierStokesSchurComplementPreconditioner only works with &quot;</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;     &lt;&lt; <span class="stringliteral">&quot;CRDoubleMatrix matrices&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="../../d6/d00/classoomph_1_1OomphLibError.html">OomphLibError</a>(error_message.str(),</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                        <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                        <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;   }</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <span class="comment">// Set up block look up schemes </span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <span class="comment">//-----------------------------</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="comment">// this preconditioner has two types of block:</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="comment">// type 0: velocity - corresponding to DOFs 0 to n-2</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <span class="comment">// type 1: pressure - corresponding to DOF n-1</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <span class="keywordtype">unsigned</span> <a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ab6cca480686ea8e44244ac60a0db23ba">ndof_types</a> = 0;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a9ac4335ec07fc13f7bf1093fd0489c52">is_subsidiary_block_preconditioner</a>())</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;   {</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    ndof_types = this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ab6cca480686ea8e44244ac60a0db23ba">ndof_types</a>();</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;   }</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;   {</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    ndof_types = this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a45509677ccef78be13b5e4485312ddc1">ndof_types_in_mesh</a>(0);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;   }</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="comment">// hierher</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <a class="code" href="../../d4/df6/classoomph_1_1Vector.html">Vector&lt;unsigned&gt;</a> dof_to_block_map(<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ab6cca480686ea8e44244ac60a0db23ba">ndof_types</a>);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  dof_to_block_map[<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ab6cca480686ea8e44244ac60a0db23ba">ndof_types</a>-1]=1;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#af704c4816469cef4fed9d35a9ad651ec">block_setup</a>(dof_to_block_map);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="comment">// Get B (the divergence block)</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a>* b_pt = 0;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a72b4dbe167da59d9ba12c7eff97d77e6">get_block</a>(1,0,b_pt);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <span class="comment">// // get the inverse velocity and pressure mass matrices</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <span class="comment">// CRDoubleMatrix* inv_v_mass_pt = 0;</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <span class="comment">// CRDoubleMatrix* inv_p_mass_pt = 0;</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="comment">// double ivmm_assembly_start_t = TimingHelpers::timer();</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="comment">// if (Use_LSC)</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <span class="comment">//  {</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <span class="comment">//   // We only need the velocity mass matrix</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="comment">//   bool do_both=false;</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="comment">//   assemble_inv_press_and_veloc_mass_matrix_diagonal(inv_p_mass_pt,</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="comment">//                                                     inv_v_mass_pt,</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="comment">//                                                     do_both);</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="comment">//  }</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <span class="comment">// else</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <span class="comment">//  {</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <span class="comment">//   // We only need both mass matrices</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="comment">//   bool do_both=true;</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <span class="comment">//   assemble_inv_press_and_veloc_mass_matrix_diagonal(inv_p_mass_pt,</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <span class="comment">//                                                     inv_v_mass_pt,</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <span class="comment">//                                                     do_both);</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <span class="comment">//  }</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="comment">// Get gradient matrix Bt</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a>* bt_pt = 0;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a72b4dbe167da59d9ba12c7eff97d77e6">get_block</a>(0,1,bt_pt);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <span class="comment">// Multiply inverse velocity mass matrix by gradient matrix B^T</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <span class="keywordtype">double</span> t_QBt_matrix_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a>* qbt_pt = <span class="keyword">new</span> <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a>;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  inv_v_mass_pt-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a54b75960df52e3aebd21aaab20e9869d">multiply</a>(*bt_pt, *qbt_pt);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="keyword">delete</span> bt_pt;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <span class="comment">// Store product in bt_pt </span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  bt_pt = qbt_pt;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="keyword">delete</span> inv_v_mass_pt;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="comment">// Multiply B from left by divergence matrix B and store result in </span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <span class="comment">// pressure Poisson matrix.</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  b_pt-&gt;<a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a54b75960df52e3aebd21aaab20e9869d">multiply</a>(*bt_pt, *p_matrix_pt);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <span class="comment">// Kill divergence matrix because we don&#39;t need it any more</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="keyword">delete</span> b_pt;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <span class="comment">// Build the matvec operator for QBt</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a7d88aae7807a9a8d07491dda4c8c2465">QBt_mat_vec_pt</a> = <span class="keyword">new</span> <a class="code" href="../../d1/dac/classoomph_1_1MatrixVectorProduct.html">MatrixVectorProduct</a>;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="comment">//QBt_mat_vec_pt-&gt;setup(bt_pt);</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#adbe1ae854ee9831649249d50162bb6a9">setup_matrix_vector_product</a>(<a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a7d88aae7807a9a8d07491dda4c8c2465">QBt_mat_vec_pt</a>,</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                                    bt_pt, 1);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <span class="comment">// Kill gradient matrix B^T (it&#39;s been overwritten anyway and</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="comment">// needs to be recomputed afresh below)</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  <span class="keyword">delete</span> bt_pt;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="comment">// Get momentum block F</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <a class="code" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">CRDoubleMatrix</a>* f_pt = 0;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a72b4dbe167da59d9ba12c7eff97d77e6">get_block</a>(0,0,f_pt);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="comment">// form the matrix vector product helper</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a66a5925f3bd0642de7bd3e61b8d740dc">F_mat_vec_pt</a> = <span class="keyword">new</span> <a class="code" href="../../d1/dac/classoomph_1_1MatrixVectorProduct.html">MatrixVectorProduct</a>;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  <span class="comment">//F_mat_vec_pt-&gt;setup(f_pt);</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#adbe1ae854ee9831649249d50162bb6a9">setup_matrix_vector_product</a>(<a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a66a5925f3bd0642de7bd3e61b8d740dc">F_mat_vec_pt</a>,f_pt,0);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <span class="comment">// if F is a block preconditioner then we can delete the F matrix</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ad3e3b6635c1524d8413a75642e4bc4e1">F_preconditioner_is_block_preconditioner</a>)</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;   {</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keyword">delete</span> f_pt;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;   }</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="comment">// Rebuild Bt (remember that we temporarily overwrote</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <span class="comment">// it by its product with the inverse velocity mass matrix)</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  bt_pt = 0;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a72b4dbe167da59d9ba12c7eff97d77e6">get_block</a>(0,1,bt_pt);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <span class="comment">// Form the matrix vector operator for Bt</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ad7bc578498d001d81223b37badefb44b">Bt_mat_vec_pt</a> = <span class="keyword">new</span> <a class="code" href="../../d1/dac/classoomph_1_1MatrixVectorProduct.html">MatrixVectorProduct</a>;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="comment">//Bt_mat_vec_pt-&gt;setup(bt_pt);</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#adbe1ae854ee9831649249d50162bb6a9">setup_matrix_vector_product</a>(<a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ad7bc578498d001d81223b37badefb44b">Bt_mat_vec_pt</a>,bt_pt,1);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="keyword">delete</span> bt_pt;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <span class="comment">// If the P preconditioner has not been setup</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a94c09c485f93eb273f4217460da02811">P_preconditioner_pt</a> = <span class="keyword">new</span> <a class="code" href="../../d1/d73/classoomph_1_1SuperLUPreconditioner.html">SuperLUPreconditioner</a>;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a94c09c485f93eb273f4217460da02811">P_preconditioner_pt</a>-&gt;<a class="code" href="../../db/d9e/classoomph_1_1Preconditioner.html#a0b95e7159585b5151f9e5dc1d1713655">setup</a>(p_matrix_pt,<a class="code" href="../../db/d9e/classoomph_1_1Preconditioner.html#ada7219933e05d94f39a46a8ddb4c749a">comm_pt</a>());</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="keyword">delete</span> p_matrix_pt;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  p_matrix_pt=0;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <span class="comment">// Set up solver for solution of system with momentum matrix</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <span class="comment">// ----------------------------------------------------------</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a14a63179117e8cf5822c89ae2b5c9902">F_preconditioner_pt</a> = <span class="keyword">new</span> <a class="code" href="../../d1/d73/classoomph_1_1SuperLUPreconditioner.html">SuperLUPreconditioner</a>;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a925aa01327e8a6af8c543d2983e92d2f">Using_default_f_preconditioner</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="comment">// if F is a block preconditioner</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  <span class="keywordtype">double</span> t_f_prec_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ad3e3b6635c1524d8413a75642e4bc4e1">F_preconditioner_is_block_preconditioner</a>)</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;   {</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ab6cca480686ea8e44244ac60a0db23ba">ndof_types</a> = this-&gt;<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ab6cca480686ea8e44244ac60a0db23ba">ndof_types</a>();</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    ndof_types--;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <a class="code" href="../../d4/df6/classoomph_1_1Vector.html">Vector&lt;unsigned&gt;</a> dof_map(<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ab6cca480686ea8e44244ac60a0db23ba">ndof_types</a>);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ab6cca480686ea8e44244ac60a0db23ba">ndof_types</a>; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;     {</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      dof_map[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;     }</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    F_block_preconditioner_pt-&gt;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;     <a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ab8e2478caa8370dd12462f17e1cc8082">turn_into_subsidiary_block_preconditioner</a>(<span class="keyword">this</span>,dof_map);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160; </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="comment">// Set the mesh in the subsidiary preconditioner. </span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="comment">// RAYRAY This is incorrect. We never set the mesh for a subsidiary </span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="comment">// block preconditioner. The self test still passes since this part of</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="comment">// the if-else condition is never executed.</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    F_block_preconditioner_pt-&gt;set_nmesh(1);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    F_block_preconditioner_pt-&gt;set_mesh(0, <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6153711f9561d3d617b78d3035147326">Navier_stokes_mesh_pt</a>);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160; </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    F_block_preconditioner_pt-&gt;setup(<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a9aac48fd53e579e6db8eeed58933a14b">matrix_pt</a>(),<a class="code" href="../../db/d9e/classoomph_1_1Preconditioner.html#ada7219933e05d94f39a46a8ddb4c749a">comm_pt</a>());</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;   }</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="comment">// otherwise F is not a block preconditioner</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;   {</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a14a63179117e8cf5822c89ae2b5c9902">F_preconditioner_pt</a>-&gt;<a class="code" href="../../db/d9e/classoomph_1_1Preconditioner.html#a0b95e7159585b5151f9e5dc1d1713655">setup</a>(f_pt,<a class="code" href="../../db/d9e/classoomph_1_1Preconditioner.html#ada7219933e05d94f39a46a8ddb4c749a">comm_pt</a>());</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="keyword">delete</span> f_pt;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;   }</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <span class="keywordtype">double</span> t_f_prec_finish = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a0b551f53464a6331d3b0f3da61d712ff">Doc_time</a>)</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;   {</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keywordtype">double</span> t_f_prec_time = t_f_prec_finish - t_f_prec_start;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;F sub-preconditioner setup time [sec]: &quot;</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;               &lt;&lt; t_f_prec_time &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;   }</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <span class="comment">// Remember that the preconditioner has been setup so</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  <span class="comment">// the stored information can be wiped when we</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <span class="comment">// come here next...</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a3584d8bd088fad5ccce394899e167ca3">Preconditioner_has_been_setup</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; }</div>
<div class="ttc" id="aclassoomph_1_1BlockPreconditioner_html_a45509677ccef78be13b5e4485312ddc1"><div class="ttname"><a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a45509677ccef78be13b5e4485312ddc1">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::ndof_types_in_mesh</a></div><div class="ttdeci">unsigned ndof_types_in_mesh(const unsigned &amp;i) const</div><div class="ttdef"><b>Definition:</b> block_preconditioner.h:2037</div></div>
<div class="ttc" id="aclassoomph_1_1BlockPreconditioner_html_a72b4dbe167da59d9ba12c7eff97d77e6"><div class="ttname"><a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a72b4dbe167da59d9ba12c7eff97d77e6">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::get_block</a></div><div class="ttdeci">void get_block(const unsigned &amp;i, const unsigned &amp;j, CRDoubleMatrix &amp;output_matrix, const bool &amp;ignore_replacement_block=false) const</div><div class="ttdef"><b>Definition:</b> block_preconditioner.h:673</div></div>
<div class="ttc" id="aclassoomph_1_1BlockPreconditioner_html_a9aac48fd53e579e6db8eeed58933a14b"><div class="ttname"><a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a9aac48fd53e579e6db8eeed58933a14b">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::matrix_pt</a></div><div class="ttdeci">CRDoubleMatrix * matrix_pt() const</div><div class="ttdef"><b>Definition:</b> block_preconditioner.h:520</div></div>
<div class="ttc" id="aclassoomph_1_1BlockPreconditioner_html_a9ac4335ec07fc13f7bf1093fd0489c52"><div class="ttname"><a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a9ac4335ec07fc13f7bf1093fd0489c52">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::is_subsidiary_block_preconditioner</a></div><div class="ttdeci">bool is_subsidiary_block_preconditioner() const</div><div class="ttdef"><b>Definition:</b> block_preconditioner.h:2061</div></div>
<div class="ttc" id="aclassoomph_1_1BlockPreconditioner_html_ab6cca480686ea8e44244ac60a0db23ba"><div class="ttname"><a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ab6cca480686ea8e44244ac60a0db23ba">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::ndof_types</a></div><div class="ttdeci">unsigned ndof_types() const</div><div class="ttdoc">Return the total number of DOF types.</div><div class="ttdef"><b>Definition:</b> block_preconditioner.h:1694</div></div>
<div class="ttc" id="aclassoomph_1_1BlockPreconditioner_html_ab8e2478caa8370dd12462f17e1cc8082"><div class="ttname"><a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ab8e2478caa8370dd12462f17e1cc8082">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::turn_into_subsidiary_block_preconditioner</a></div><div class="ttdeci">void turn_into_subsidiary_block_preconditioner(BlockPreconditioner&lt; CRDoubleMatrix &gt; *master_block_prec_pt, const Vector&lt; unsigned &gt; &amp;doftype_in_master_preconditioner_coarse)</div><div class="ttdef"><b>Definition:</b> block_preconditioner.cc:2376</div></div>
<div class="ttc" id="aclassoomph_1_1BlockPreconditioner_html_adbe1ae854ee9831649249d50162bb6a9"><div class="ttname"><a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#adbe1ae854ee9831649249d50162bb6a9">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::setup_matrix_vector_product</a></div><div class="ttdeci">void setup_matrix_vector_product(MatrixVectorProduct *matvec_prod_pt, CRDoubleMatrix *block_pt, const Vector&lt; unsigned &gt; &amp;block_col_indices)</div><div class="ttdef"><b>Definition:</b> block_preconditioner.h:2397</div></div>
<div class="ttc" id="aclassoomph_1_1BlockPreconditioner_html_ae055f998f6145656352aacac22e545ad"><div class="ttname"><a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#ae055f998f6145656352aacac22e545ad">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::set_nmesh</a></div><div class="ttdeci">void set_nmesh(const unsigned &amp;n)</div><div class="ttdef"><b>Definition:</b> block_preconditioner.h:2851</div></div>
<div class="ttc" id="aclassoomph_1_1BlockPreconditioner_html_af704c4816469cef4fed9d35a9ad651ec"><div class="ttname"><a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#af704c4816469cef4fed9d35a9ad651ec">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::block_setup</a></div><div class="ttdeci">virtual void block_setup()</div><div class="ttdef"><b>Definition:</b> block_preconditioner.cc:2483</div></div>
<div class="ttc" id="aclassoomph_1_1BlockPreconditioner_html_af97821621b570d409e6662939e5f818d"><div class="ttname"><a href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#af97821621b570d409e6662939e5f818d">oomph::BlockPreconditioner&lt; CRDoubleMatrix &gt;::set_mesh</a></div><div class="ttdeci">void set_mesh(const unsigned &amp;i, const Mesh *const mesh_pt, const bool &amp;allow_multiple_element_type_in_mesh=false)</div><div class="ttdef"><b>Definition:</b> block_preconditioner.h:2866</div></div>
<div class="ttc" id="aclassoomph_1_1CRDoubleMatrix_html"><div class="ttname"><a href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html">oomph::CRDoubleMatrix</a></div><div class="ttdef"><b>Definition:</b> matrices.h:888</div></div>
<div class="ttc" id="aclassoomph_1_1CRDoubleMatrix_html_a54b75960df52e3aebd21aaab20e9869d"><div class="ttname"><a href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a54b75960df52e3aebd21aaab20e9869d">oomph::CRDoubleMatrix::multiply</a></div><div class="ttdeci">void multiply(const DoubleVector &amp;x, DoubleVector &amp;soln) const</div><div class="ttdoc">Multiply the matrix by the vector x: soln=Ax.</div><div class="ttdef"><b>Definition:</b> matrices.cc:1782</div></div>
<div class="ttc" id="aclassoomph_1_1MatrixVectorProduct_html"><div class="ttname"><a href="../../d1/dac/classoomph_1_1MatrixVectorProduct.html">oomph::MatrixVectorProduct</a></div><div class="ttdef"><b>Definition:</b> matrix_vector_product.h:51</div></div>
<div class="ttc" id="aclassoomph_1_1Preconditioner_html_a0b95e7159585b5151f9e5dc1d1713655"><div class="ttname"><a href="../../db/d9e/classoomph_1_1Preconditioner.html#a0b95e7159585b5151f9e5dc1d1713655">oomph::Preconditioner::setup</a></div><div class="ttdeci">void setup(DoubleMatrixBase *matrix_pt)</div><div class="ttdef"><b>Definition:</b> preconditioner.h:94</div></div>
<div class="ttc" id="aclassoomph_1_1SuperLUPreconditioner_html"><div class="ttname"><a href="../../d1/d73/classoomph_1_1SuperLUPreconditioner.html">oomph::SuperLUPreconditioner</a></div><div class="ttdoc">An interface to allow SuperLU to be used as an (exact) Preconditioner.</div><div class="ttdef"><b>Definition:</b> SuperLU_preconditioner.h:40</div></div>
<div class="ttc" id="aclassoomph_1_1Vector_html"><div class="ttname"><a href="../../d4/df6/classoomph_1_1Vector.html">oomph::Vector&lt; unsigned &gt;</a></div></div>
<div class="ttc" id="anamespaceoomph_1_1TimingHelpers_html_a9fb6ad7e2e01b0914e9f7072ef9ebfa6"><div class="ttname"><a href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">oomph::TimingHelpers::timer</a></div><div class="ttdeci">double timer()</div><div class="ttdoc">returns the time in seconds after some point in past</div><div class="ttdef"><b>Definition:</b> oomph_utilities.cc:1295</div></div>
<div class="ttc" id="anamespaceoomph_html_aec474227917784dc0a255faf289cfc16"><div class="ttname"><a href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a></div><div class="ttdeci">OomphInfo oomph_info</div><div class="ttdef"><b>Definition:</b> oomph_definitions.cc:319</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d0/dd4/namespaceoomph_1_1TerminateHelper.html#a20615123e22554c3c485484f4c23bfb5">oomph::TerminateHelper::clean_up_memory()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../d6/dd4/classoomph_1_1CRDoubleMatrix.html#a54b75960df52e3aebd21aaab20e9869d">oomph::CRDoubleMatrix::multiply()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, and <a class="el" href="../../d1/d73/classoomph_1_1SuperLUPreconditioner.html#a7a53307202af7c06a2a6b336e943b1b4">oomph::SuperLUPreconditioner::setup()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/d59/classoomph_1_1FSIPreconditioner.html#adadfe9f4332af610b00f1f45d1ad432e">oomph::FSIPreconditioner::setup()</a>.</p>

</div>
</div>
<a id="af4886f4efe510e5c9b0eb19422943588"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4886f4efe510e5c9b0eb19422943588">&#9670;&nbsp;</a></span>setup() <span class="overload">[2/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void oomph::Preconditioner::setup</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>for some reason we have to remind the compiler that there is a setup() function in Preconditioner base class. </p>

<p>Implements <a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#af4886f4efe510e5c9b0eb19422943588">oomph::Preconditioner</a>.</p>

</div>
</div>
<a id="a783fae97e4b898f8de72b504a4f4bec6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a783fae97e4b898f8de72b504a4f4bec6">&#9670;&nbsp;</a></span>setup() <span class="overload">[3/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Preconditioner::setup</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>for some reason we have to remind the compiler that there is a setup() function in Preconditioner base class. </p>

<p>Implements <a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#af4886f4efe510e5c9b0eb19422943588">oomph::Preconditioner</a>.</p>
<div class="fragment"><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      <a class="code" href="../../d5/d2c/namespaceoomph_1_1ObsoleteCode.html#aad204f6339b477642ef2ef32c3437eb1">ObsoleteCode::obsolete</a>();</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a03cbfa527081ea03c910aadc281615d7">setup</a>(<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a9aac48fd53e579e6db8eeed58933a14b">matrix_pt</a>);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1NavierStokesSchurComplementPreconditioner_html_a03cbfa527081ea03c910aadc281615d7"><div class="ttname"><a href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a03cbfa527081ea03c910aadc281615d7">oomph::NavierStokesSchurComplementPreconditioner::setup</a></div><div class="ttdeci">void setup()</div><div class="ttdoc">Setup the preconditioner.</div><div class="ttdef"><b>Definition:</b> driven_cavity_with_simple_lsc_preconditioner.cc:167</div></div>
<div class="ttc" id="anamespaceoomph_1_1ObsoleteCode_html_aad204f6339b477642ef2ef32c3437eb1"><div class="ttname"><a href="../../d5/d2c/namespaceoomph_1_1ObsoleteCode.html#aad204f6339b477642ef2ef32c3437eb1">oomph::ObsoleteCode::obsolete</a></div><div class="ttdeci">void obsolete()</div><div class="ttdoc">Output warning message.</div><div class="ttdef"><b>Definition:</b> oomph_utilities.cc:1102</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0b95e7159585b5151f9e5dc1d1713655"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b95e7159585b5151f9e5dc1d1713655">&#9670;&nbsp;</a></span>setup() <span class="overload">[4/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Preconditioner::setup</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>for some reason we have to remind the compiler that there is a setup() function in Preconditioner base class. </p>

<p>Implements <a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html#af4886f4efe510e5c9b0eb19422943588">oomph::Preconditioner</a>.</p>
<div class="fragment"><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <span class="comment">// Store matrix pointer</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      <a class="code" href="../../db/d9e/classoomph_1_1Preconditioner.html#af459b7333c4c64435fd8fa933535901f">set_matrix_pt</a>(<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a9aac48fd53e579e6db8eeed58933a14b">matrix_pt</a>);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      <span class="comment">// Extract and store communicator pointer</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ac9492d59cff9d9b0098712ae72989cd3">DistributableLinearAlgebraObject</a>* dist_obj_pt =</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ac9492d59cff9d9b0098712ae72989cd3">DistributableLinearAlgebraObject</a>*<span class="keyword">&gt;</span>(<a class="code" href="../../dd/d57/classoomph_1_1BlockPreconditioner.html#a9aac48fd53e579e6db8eeed58933a14b">matrix_pt</a>);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      <span class="keywordflow">if</span> (dist_obj_pt != 0)</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <a class="code" href="../../db/d9e/classoomph_1_1Preconditioner.html#a306f5a52f493816fcfda2dc9b2ee1dbf">set_comm_pt</a>(dist_obj_pt-&gt;distribution_pt()-&gt;communicator_pt());</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      }</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <a class="code" href="../../db/d9e/classoomph_1_1Preconditioner.html#a306f5a52f493816fcfda2dc9b2ee1dbf">set_comm_pt</a>(0);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <span class="keywordtype">double</span> setup_time_start = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a03cbfa527081ea03c910aadc281615d7">setup</a>();</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      <span class="keywordtype">double</span> setup_time_finish = <a class="code" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      <a class="code" href="../../db/d9e/classoomph_1_1Preconditioner.html#a00f5ae98e81e7cb9aa6a70a39a9759c8">Setup_time</a> = setup_time_finish - setup_time_start;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1DistributableLinearAlgebraObject_html_ac9492d59cff9d9b0098712ae72989cd3"><div class="ttname"><a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ac9492d59cff9d9b0098712ae72989cd3">oomph::DistributableLinearAlgebraObject::DistributableLinearAlgebraObject</a></div><div class="ttdeci">DistributableLinearAlgebraObject()</div><div class="ttdoc">Default constructor - create a distribution.</div><div class="ttdef"><b>Definition:</b> linear_algebra_distribution.h:438</div></div>
<div class="ttc" id="aclassoomph_1_1Preconditioner_html_a00f5ae98e81e7cb9aa6a70a39a9759c8"><div class="ttname"><a href="../../db/d9e/classoomph_1_1Preconditioner.html#a00f5ae98e81e7cb9aa6a70a39a9759c8">oomph::Preconditioner::Setup_time</a></div><div class="ttdeci">double Setup_time</div><div class="ttdoc">The time it takes to set up this preconditioner.</div><div class="ttdef"><b>Definition:</b> preconditioner.h:243</div></div>
<div class="ttc" id="aclassoomph_1_1Preconditioner_html_a306f5a52f493816fcfda2dc9b2ee1dbf"><div class="ttname"><a href="../../db/d9e/classoomph_1_1Preconditioner.html#a306f5a52f493816fcfda2dc9b2ee1dbf">oomph::Preconditioner::set_comm_pt</a></div><div class="ttdeci">virtual void set_comm_pt(const OomphCommunicator *const comm_pt)</div><div class="ttdoc">Set the communicator pointer.</div><div class="ttdef"><b>Definition:</b> preconditioner.h:193</div></div>
<div class="ttc" id="aclassoomph_1_1Preconditioner_html_af459b7333c4c64435fd8fa933535901f"><div class="ttname"><a href="../../db/d9e/classoomph_1_1Preconditioner.html#af459b7333c4c64435fd8fa933535901f">oomph::Preconditioner::set_matrix_pt</a></div><div class="ttdeci">virtual void set_matrix_pt(DoubleMatrixBase *matrix_pt)</div><div class="ttdoc">Set the matrix pointer.</div><div class="ttdef"><b>Definition:</b> preconditioner.h:165</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a58c02e402f5c6103268da36097b4ad0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58c02e402f5c6103268da36097b4ad0e">&#9670;&nbsp;</a></span>unpin_first_pressure_dof_in_press_adv_diff()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::NavierStokesSchurComplementPreconditioner::unpin_first_pressure_dof_in_press_adv_diff </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Set boolean indicating that we do not want to pin first pressure dof in Navier Stokes mesh when assembling the pressure advection diffusion system for Fp preconditoner &ndash; needed at zero Reynolds number for non-enclosed flows but seems harmless in any case </p>
<div class="fragment"><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    {</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a40ffaa90de4f861037cbd364789eb889">Pin_first_pressure_dof_in_press_adv_diff</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a40ffaa90de4f861037cbd364789eb889">Pin_first_pressure_dof_in_press_adv_diff</a>.</p>

</div>
</div>
<a id="a1f77731b78f270044f09f761719a88b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f77731b78f270044f09f761719a88b0">&#9670;&nbsp;</a></span>use_fp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::NavierStokesSchurComplementPreconditioner::use_fp </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Use Fp version of the preconditioner. </p>
<div class="fragment"><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    {</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6c6abbfacbceba68be65855cc32bccb1">Use_LSC</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6c6abbfacbceba68be65855cc32bccb1">Use_LSC</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../de/da5/classFpTestProblem.html#a8f9af5a447dedb8bd0697a401e196580">FpTestProblem::FpTestProblem()</a>.</p>

</div>
</div>
<a id="ae687961a8422c3b61da2e225c5665110"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae687961a8422c3b61da2e225c5665110">&#9670;&nbsp;</a></span>use_lsc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::NavierStokesSchurComplementPreconditioner::use_lsc </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Use LSC version of the preconditioner. </p>
<div class="fragment"><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    {</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;      <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6c6abbfacbceba68be65855cc32bccb1">Use_LSC</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6c6abbfacbceba68be65855cc32bccb1">Use_LSC</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../de/da5/classFpTestProblem.html#a8f9af5a447dedb8bd0697a401e196580">FpTestProblem::FpTestProblem()</a>, and <a class="el" href="../../d1/d16/classTiltedCavityProblem.html#a77b22e4024cfaed06ebf6ec69d56e669">TiltedCavityProblem&lt; ELEMENT &gt;::TiltedCavityProblem()</a>.</p>

</div>
</div>
<a id="a1b42174c40c4fec1336c547aaa3d07f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b42174c40c4fec1336c547aaa3d07f5">&#9670;&nbsp;</a></span>validate()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::NavierStokesSchurComplementPreconditioner::validate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d2c/classoomph_1_1DocInfo.html">DocInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>doc_info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *&#160;</td>
          <td class="paramname"><em>orig_problem_pt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Validate auxiliary pressure advection diffusion problem in 2D </p>
<div class="fragment"><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    {</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;      FpPressureAdvectionDiffusionProblem&lt;ELEMENT&gt; aux_problem(</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        <a class="code" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6153711f9561d3d617b78d3035147326">Navier_stokes_mesh_pt</a>, orig_problem_pt);</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;      aux_problem.validate(doc_info);</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a6153711f9561d3d617b78d3035147326">Navier_stokes_mesh_pt</a>, and <a class="el" href="../../da/dcc/classoomph_1_1FpPressureAdvectionDiffusionProblem.html#ae24eef02cff52b57dca6c1daf274bab2">oomph::FpPressureAdvectionDiffusionProblem&lt; ELEMENT &gt;::validate()</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a31a0119eae85695e267b2b0e6d58cfe6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31a0119eae85695e267b2b0e6d58cfe6">&#9670;&nbsp;</a></span>Accept_non_NavierStokesElementWithDiagonalMassMatrices_elements</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::NavierStokesSchurComplementPreconditioner::Accept_non_NavierStokesElementWithDiagonalMassMatrices_elements</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Boolean to indicate that presence of elements that are not of type NavierStokesElementWithDiagonalMassMatrices is acceptable (suppresses warning that issued otherwise). </p>

<p class="reference">Referenced by <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a483c96d41a5032f90b8027d6ef2c0c5a">disable_accept_non_NavierStokesElementWithDiagonalMassMatrices_elements()</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#af406a2d6632c95f7d8b70baba1b912ee">enable_accept_non_NavierStokesElementWithDiagonalMassMatrices_elements()</a>, and <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ac5ca2d9d665f4bd0a9f2e2cc103486b0">NavierStokesSchurComplementPreconditioner()</a>.</p>

</div>
</div>
<a id="a932ce8737a185ca987a2c75d8af360d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a932ce8737a185ca987a2c75d8af360d9">&#9670;&nbsp;</a></span>Allow_multiple_element_type_in_navier_stokes_mesh</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::NavierStokesSchurComplementPreconditioner::Allow_multiple_element_type_in_navier_stokes_mesh</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Flag to indicate if there are multiple element types in the Navier-Stokes mesh. </p>

<p class="reference">Referenced by <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ac5ca2d9d665f4bd0a9f2e2cc103486b0">NavierStokesSchurComplementPreconditioner()</a>, and <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#abe80b5bb32d24f49f427d04118de284a">set_navier_stokes_mesh()</a>.</p>

</div>
</div>
<a id="ad7bc578498d001d81223b37badefb44b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7bc578498d001d81223b37badefb44b">&#9670;&nbsp;</a></span>Bt_mat_vec_pt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d1/dac/classoomph_1_1MatrixVectorProduct.html">MatrixVectorProduct</a>* oomph::NavierStokesSchurComplementPreconditioner::Bt_mat_vec_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>MatrixVectorProduct operator for Bt. </p>

<p class="reference">Referenced by <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a5cac2493de85690e3954949eb2a27d2c">clean_up_memory()</a>, and <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ac5ca2d9d665f4bd0a9f2e2cc103486b0">NavierStokesSchurComplementPreconditioner()</a>.</p>

</div>
</div>
<a id="a0b551f53464a6331d3b0f3da61d712ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b551f53464a6331d3b0f3da61d712ff">&#9670;&nbsp;</a></span>Doc_time</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::NavierStokesSchurComplementPreconditioner::Doc_time</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set Doc_time to true for outputting results of timings. </p>

<p class="reference">Referenced by <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ae0015b71a33a147650606840d98f5a9e">disable_doc_time()</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#af1a6030468c5795b3ace7a58bcb6b4f1">enable_doc_time()</a>, and <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ac5ca2d9d665f4bd0a9f2e2cc103486b0">NavierStokesSchurComplementPreconditioner()</a>.</p>

</div>
</div>
<a id="a6a02950e86b2b8a092dda57587850d1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a02950e86b2b8a092dda57587850d1c">&#9670;&nbsp;</a></span>E_mat_vec_pt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d1/dac/classoomph_1_1MatrixVectorProduct.html">MatrixVectorProduct</a>* oomph::NavierStokesSchurComplementPreconditioner::E_mat_vec_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>MatrixVectorProduct operator for E = Fp Qp^{-1} (only for Fp variant) </p>

<p class="reference">Referenced by <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a5cac2493de85690e3954949eb2a27d2c">clean_up_memory()</a>, and <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ac5ca2d9d665f4bd0a9f2e2cc103486b0">NavierStokesSchurComplementPreconditioner()</a>.</p>

</div>
</div>
<a id="af34c14327511f1e7deb5726b85b05417"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af34c14327511f1e7deb5726b85b05417">&#9670;&nbsp;</a></span>Eqn_number_backup</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;<a class="el" href="../../d8/dc5/classoomph_1_1Data.html">Data</a>*, std::vector&lt;<a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a>&gt; &gt; oomph::NavierStokesSchurComplementPreconditioner::Eqn_number_backup</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Map to store original eqn numbers of various Data values when assembling pressure advection diffusion matrix </p>

<p class="reference">Referenced by <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a03941c01d70ece07797301c8ac6a0a8a">pin_all_non_pressure_dofs()</a>, and <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#af1c121b668b1961a68010f984166947c">reset_pin_status()</a>.</p>

</div>
</div>
<a id="a66a5925f3bd0642de7bd3e61b8d740dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66a5925f3bd0642de7bd3e61b8d740dc">&#9670;&nbsp;</a></span>F_mat_vec_pt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d1/dac/classoomph_1_1MatrixVectorProduct.html">MatrixVectorProduct</a>* oomph::NavierStokesSchurComplementPreconditioner::F_mat_vec_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>MatrixVectorProduct operator for F. </p>

<p class="reference">Referenced by <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a5cac2493de85690e3954949eb2a27d2c">clean_up_memory()</a>, and <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ac5ca2d9d665f4bd0a9f2e2cc103486b0">NavierStokesSchurComplementPreconditioner()</a>.</p>

</div>
</div>
<a id="ad3e3b6635c1524d8413a75642e4bc4e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3e3b6635c1524d8413a75642e4bc4e1">&#9670;&nbsp;</a></span>F_preconditioner_is_block_preconditioner</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::NavierStokesSchurComplementPreconditioner::F_preconditioner_is_block_preconditioner</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Boolean indicating whether the momentum system preconditioner is a block preconditioner </p>

</div>
</div>
<a id="a14a63179117e8cf5822c89ae2b5c9902"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14a63179117e8cf5822c89ae2b5c9902">&#9670;&nbsp;</a></span>F_preconditioner_pt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html">Preconditioner</a>* oomph::NavierStokesSchurComplementPreconditioner::F_preconditioner_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pointer to the 'preconditioner' for the F matrix. </p>

<p class="reference">Referenced by <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a5cac2493de85690e3954949eb2a27d2c">clean_up_memory()</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ac5ca2d9d665f4bd0a9f2e2cc103486b0">NavierStokesSchurComplementPreconditioner()</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ab2f387b87192dd2f7b6725cfe3aae44e">set_f_preconditioner()</a>, and <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#af29abc6e2b9fd92ae3a31a4f9d56f6b8">set_f_superlu_preconditioner()</a>.</p>

</div>
</div>
<a id="a6153711f9561d3d617b78d3035147326"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6153711f9561d3d617b78d3035147326">&#9670;&nbsp;</a></span>Navier_stokes_mesh_pt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a>* oomph::NavierStokesSchurComplementPreconditioner::Navier_stokes_mesh_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>the pointer to the mesh of block preconditionable Navier Stokes elements. </p>

<p class="reference">Referenced by <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ab45d7496790cc29a056b83c194aa2a1c">assemble_inv_press_and_veloc_mass_matrix_diagonal()</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ac3f40f62d33d33616cdb4bed48aaccde">get_pressure_advection_diffusion_matrix()</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ac5ca2d9d665f4bd0a9f2e2cc103486b0">NavierStokesSchurComplementPreconditioner()</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a03941c01d70ece07797301c8ac6a0a8a">pin_all_non_pressure_dofs()</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#af1c121b668b1961a68010f984166947c">reset_pin_status()</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#abe80b5bb32d24f49f427d04118de284a">set_navier_stokes_mesh()</a>, and <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a1b42174c40c4fec1336c547aaa3d07f5">validate()</a>.</p>

</div>
</div>
<a id="a94c09c485f93eb273f4217460da02811"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94c09c485f93eb273f4217460da02811">&#9670;&nbsp;</a></span>P_preconditioner_pt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../db/d9e/classoomph_1_1Preconditioner.html">Preconditioner</a>* oomph::NavierStokesSchurComplementPreconditioner::P_preconditioner_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pointer to the 'preconditioner' for the pressure matrix. </p>

<p class="reference">Referenced by <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a5cac2493de85690e3954949eb2a27d2c">clean_up_memory()</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ac5ca2d9d665f4bd0a9f2e2cc103486b0">NavierStokesSchurComplementPreconditioner()</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a48f0d5e878eccab6e7f080c92d4bc6f5">set_p_preconditioner()</a>, and <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a05bac2703d9570c15bf0676cbbe7ce03">set_p_superlu_preconditioner()</a>.</p>

</div>
</div>
<a id="a40ffaa90de4f861037cbd364789eb889"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40ffaa90de4f861037cbd364789eb889">&#9670;&nbsp;</a></span>Pin_first_pressure_dof_in_press_adv_diff</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::NavierStokesSchurComplementPreconditioner::Pin_first_pressure_dof_in_press_adv_diff</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Boolean indicating if we want to pin first pressure dof in Navier Stokes mesh when assembling the pressure advection diffusion system for Fp preconditoner &ndash; needed at zero Reynolds number for non-enclosed flows but seems harmless in any case </p>

<p class="reference">Referenced by <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ac3f40f62d33d33616cdb4bed48aaccde">get_pressure_advection_diffusion_matrix()</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ac5ca2d9d665f4bd0a9f2e2cc103486b0">NavierStokesSchurComplementPreconditioner()</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#af7d68718453adc8e7b9e19ad30cc9171">pin_first_pressure_dof_in_press_adv_diff()</a>, and <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a58c02e402f5c6103268da36097b4ad0e">unpin_first_pressure_dof_in_press_adv_diff()</a>.</p>

</div>
</div>
<a id="a3584d8bd088fad5ccce394899e167ca3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3584d8bd088fad5ccce394899e167ca3">&#9670;&nbsp;</a></span>Preconditioner_has_been_setup</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::NavierStokesSchurComplementPreconditioner::Preconditioner_has_been_setup</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Control flag is true if the preconditioner has been setup (used so we can wipe the data when the preconditioner is called again) </p>

<p class="reference">Referenced by <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a5cac2493de85690e3954949eb2a27d2c">clean_up_memory()</a>, and <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ac5ca2d9d665f4bd0a9f2e2cc103486b0">NavierStokesSchurComplementPreconditioner()</a>.</p>

</div>
</div>
<a id="a32957b16d3827ea7e6f308e1f3b6f246"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a32957b16d3827ea7e6f308e1f3b6f246">&#9670;&nbsp;</a></span>Problem_pt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a>* oomph::NavierStokesSchurComplementPreconditioner::Problem_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Storage for the (non-const!) problem pointer for use in get_pressure_advection_diffusion_matrix(). </p>

<p class="reference">Referenced by <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#afc57fedbcd960d99c5ab3f135eacb612">problem_pt()</a>, and <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a41814f592afecb493310be513c595739">set_problem_pt()</a>.</p>

</div>
</div>
<a id="a7d88aae7807a9a8d07491dda4c8c2465"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d88aae7807a9a8d07491dda4c8c2465">&#9670;&nbsp;</a></span>QBt_mat_vec_pt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d1/dac/classoomph_1_1MatrixVectorProduct.html">MatrixVectorProduct</a>* oomph::NavierStokesSchurComplementPreconditioner::QBt_mat_vec_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>MatrixVectorProduct operator for Qv^{-1} Bt. </p>

<p class="reference">Referenced by <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a5cac2493de85690e3954949eb2a27d2c">clean_up_memory()</a>, and <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ac5ca2d9d665f4bd0a9f2e2cc103486b0">NavierStokesSchurComplementPreconditioner()</a>.</p>

</div>
</div>
<a id="a6c6abbfacbceba68be65855cc32bccb1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c6abbfacbceba68be65855cc32bccb1">&#9670;&nbsp;</a></span>Use_LSC</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::NavierStokesSchurComplementPreconditioner::Use_LSC</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Boolean to indicate use of LSC (true) or Fp (false) variant. </p>

<p class="reference">Referenced by <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ab45d7496790cc29a056b83c194aa2a1c">assemble_inv_press_and_veloc_mass_matrix_diagonal()</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ac5ca2d9d665f4bd0a9f2e2cc103486b0">NavierStokesSchurComplementPreconditioner()</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a1f77731b78f270044f09f761719a88b0">use_fp()</a>, and <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ae687961a8422c3b61da2e225c5665110">use_lsc()</a>.</p>

</div>
</div>
<a id="a3aa99e654544365b78d4dca057ed53e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3aa99e654544365b78d4dca057ed53e0">&#9670;&nbsp;</a></span>Use_robin_for_fp</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::NavierStokesSchurComplementPreconditioner::Use_robin_for_fp</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Use Robin BC elements for Fp preconditoner? </p>

<p class="reference">Referenced by <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ae1db0cf426cd70ad4f1f30182d82c469">disable_robin_for_fp()</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ac6554fd9418b705b70a0a54c0f864db8">enable_robin_for_fp()</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ac3f40f62d33d33616cdb4bed48aaccde">get_pressure_advection_diffusion_matrix()</a>, and <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ac5ca2d9d665f4bd0a9f2e2cc103486b0">NavierStokesSchurComplementPreconditioner()</a>.</p>

</div>
</div>
<a id="a925aa01327e8a6af8c543d2983e92d2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a925aa01327e8a6af8c543d2983e92d2f">&#9670;&nbsp;</a></span>Using_default_f_preconditioner</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::NavierStokesSchurComplementPreconditioner::Using_default_f_preconditioner</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>flag indicating whether the default F preconditioner is used </p>

<p class="reference">Referenced by <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a5cac2493de85690e3954949eb2a27d2c">clean_up_memory()</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ac5ca2d9d665f4bd0a9f2e2cc103486b0">NavierStokesSchurComplementPreconditioner()</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ab2f387b87192dd2f7b6725cfe3aae44e">set_f_preconditioner()</a>, and <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#af29abc6e2b9fd92ae3a31a4f9d56f6b8">set_f_superlu_preconditioner()</a>.</p>

</div>
</div>
<a id="a6d9eb3bdee67fafd228e0923e61bd812"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d9eb3bdee67fafd228e0923e61bd812">&#9670;&nbsp;</a></span>Using_default_p_preconditioner</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::NavierStokesSchurComplementPreconditioner::Using_default_p_preconditioner</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>flag indicating whether the default P preconditioner is used </p>

<p class="reference">Referenced by <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a5cac2493de85690e3954949eb2a27d2c">clean_up_memory()</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#ac5ca2d9d665f4bd0a9f2e2cc103486b0">NavierStokesSchurComplementPreconditioner()</a>, <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a48f0d5e878eccab6e7f080c92d4bc6f5">set_p_preconditioner()</a>, and <a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html#a05bac2703d9570c15bf0676cbbe7ce03">set_p_superlu_preconditioner()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="../../d8/d75/navier__stokes__preconditioners_8h_source.html">navier_stokes_preconditioners.h</a></li>
<li><a class="el" href="../../df/d66/driven__cavity__with__simple__lsc__preconditioner_8cc.html">driven_cavity_with_simple_lsc_preconditioner.cc</a></li>
<li><a class="el" href="../../de/dcc/navier__stokes__preconditioners_8cc.html">navier_stokes_preconditioners.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../da/ddf/namespaceoomph.html">oomph</a></li><li class="navelem"><a class="el" href="../../d2/dc9/classoomph_1_1NavierStokesSchurComplementPreconditioner.html">NavierStokesSchurComplementPreconditioner</a></li>
    <li class="footer">Generated on Wed Aug 27 2025 17:09:23 for MercuryDPM by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
