<!-- HTML header for doxygen 1.8.18-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MercuryDPM: oomph::BlockPitchForkLinearSolver Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../MDPM.css" rel="stylesheet" type="text/css"/>
<link href="../../codeLabels.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-fork-corner.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-dropdown-version.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../MDPM-fragment-copy-button.js"></script>
<script type="text/javascript">
DoxygenAwesomeFragmentCopyButton.init()
</script>
<script type="text/javascript" src="../../MDPM-paragraph-link.js"></script>
<script type="text/javascript">
DoxygenAwesomeParagraphLink.init()
</script>
<script type="text/javascript" src="../../MDPM-interactive-toc.js"></script>
<script type="text/javascript">
DoxygenAwesomeInteractiveToc.init()
</script>
<script type="text/javascript" src="../../MDPM-darkmode-toggle.js"></script>
<script type="text/javascript">
DoxygenAwesomeDarkModeToggle.init()
</script>
</head>
<body>
  <div id="bitbucket-corner">
   <a href="https://bitbucket.org/mercurydpm/mercurydpm/src/master/" target="_blank" id="fork-corner" class="fork-corner fc-pos-tr fc-animate fc-theme-bitbucket"></a>
  </div>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../mercury-logo-chosen-light-slogan.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"> <!--MercuryDPM--!>
   <!-- BEGIN version select -->
   <div class="dropdown" id="projectnumber">
    <button class="dropbtn">v1.0</button>
    <div class="dropdown-content">
    </div>
   </div>
   <script type="text/javascript" src="../../MDPM-dropdown-version.js"></script>
<!-- END version select -->
   <!--&#160;<span id="projectnumber">revision: v1.0</span>-->
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<script type="text/javascript" src="../../MDPM-fork-corner.js"></script>
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="../../d1/d0e/classoomph_1_1BlockPitchForkLinearSolver-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">oomph::BlockPitchForkLinearSolver Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="../../d3/d3a/assembly__handler_8h_source.html">assembly_handler.h</a>&gt;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Inheritance diagram for oomph::BlockPitchForkLinearSolver:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
 <div class="center">
  <img src="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.png" usemap="#oomph::BlockPitchForkLinearSolver_map" alt=""/>
  <map id="oomph::BlockPitchForkLinearSolver_map" name="oomph::BlockPitchForkLinearSolver_map">
<area href="../../d5/dd7/classoomph_1_1LinearSolver.html" alt="oomph::LinearSolver" shape="rect" coords="0,56,243,80"/>
<area href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html" alt="oomph::DistributableLinearAlgebraObject" shape="rect" coords="0,0,243,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a9820033e85fed1a01a48ac09f27e574f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a9820033e85fed1a01a48ac09f27e574f">BlockPitchForkLinearSolver</a> (<a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html">LinearSolver</a> *const <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a38efead8e84202a3232b4a3624a2986c">linear_solver_pt</a>)</td></tr>
<tr class="memdesc:a9820033e85fed1a01a48ac09f27e574f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor, inherits the original linear solver.  <a href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a9820033e85fed1a01a48ac09f27e574f">More...</a><br /></td></tr>
<tr class="separator:a9820033e85fed1a01a48ac09f27e574f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fa97815fefc83c678341222847797ea"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a3fa97815fefc83c678341222847797ea">~BlockPitchForkLinearSolver</a> ()</td></tr>
<tr class="memdesc:a3fa97815fefc83c678341222847797ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor: clean up the allocated memory.  <a href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a3fa97815fefc83c678341222847797ea">More...</a><br /></td></tr>
<tr class="separator:a3fa97815fefc83c678341222847797ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad196867613954a8fabd318b50e2aadc6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#ad196867613954a8fabd318b50e2aadc6">solve</a> (<a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *const &amp;problem_pt, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;result)</td></tr>
<tr class="memdesc:ad196867613954a8fabd318b50e2aadc6"><td class="mdescLeft">&#160;</td><td class="mdescRight">The solve function uses the block factorisation.  <a href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#ad196867613954a8fabd318b50e2aadc6">More...</a><br /></td></tr>
<tr class="separator:ad196867613954a8fabd318b50e2aadc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa6dbd59c0f6db8e5a19689888b17eac"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#aaa6dbd59c0f6db8e5a19689888b17eac">solve</a> (<a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html">DoubleMatrixBase</a> *const &amp;matrix_pt, const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;rhs, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;result)</td></tr>
<tr class="separator:aaa6dbd59c0f6db8e5a19689888b17eac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45c8a56bd1942374756feb9edcfb6151"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a45c8a56bd1942374756feb9edcfb6151">solve</a> (<a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html">DoubleMatrixBase</a> *const &amp;matrix_pt, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;rhs, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;result)</td></tr>
<tr class="separator:a45c8a56bd1942374756feb9edcfb6151"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a424fd2ae0b67ef8c3ff59f16030786"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a9a424fd2ae0b67ef8c3ff59f16030786">resolve</a> (const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;rhs, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;result)</td></tr>
<tr class="memdesc:a9a424fd2ae0b67ef8c3ff59f16030786"><td class="mdescLeft">&#160;</td><td class="mdescRight">The resolve function also uses the block factorisation.  <a href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a9a424fd2ae0b67ef8c3ff59f16030786">More...</a><br /></td></tr>
<tr class="separator:a9a424fd2ae0b67ef8c3ff59f16030786"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38efead8e84202a3232b4a3624a2986c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html">LinearSolver</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a38efead8e84202a3232b4a3624a2986c">linear_solver_pt</a> () const</td></tr>
<tr class="memdesc:a38efead8e84202a3232b4a3624a2986c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access function to the original linear solver.  <a href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a38efead8e84202a3232b4a3624a2986c">More...</a><br /></td></tr>
<tr class="separator:a38efead8e84202a3232b4a3624a2986c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classoomph_1_1LinearSolver"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classoomph_1_1LinearSolver')"><img src="../../closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html">oomph::LinearSolver</a></td></tr>
<tr class="memitem:a6e7e8728f36c888f052e49df8624b8ca inherit pub_methods_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a6e7e8728f36c888f052e49df8624b8ca">LinearSolver</a> ()</td></tr>
<tr class="memdesc:a6e7e8728f36c888f052e49df8624b8ca inherit pub_methods_classoomph_1_1LinearSolver"><td class="mdescLeft">&#160;</td><td class="mdescRight">Empty constructor, initialise the member data.  <a href="../../d5/dd7/classoomph_1_1LinearSolver.html#a6e7e8728f36c888f052e49df8624b8ca">More...</a><br /></td></tr>
<tr class="separator:a6e7e8728f36c888f052e49df8624b8ca inherit pub_methods_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c4dba96b243e3e9be1ef6bdb9440d23 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a6c4dba96b243e3e9be1ef6bdb9440d23">LinearSolver</a> (const <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html">LinearSolver</a> &amp;dummy)=delete</td></tr>
<tr class="memdesc:a6c4dba96b243e3e9be1ef6bdb9440d23 inherit pub_methods_classoomph_1_1LinearSolver"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken copy constructor.  <a href="../../d5/dd7/classoomph_1_1LinearSolver.html#a6c4dba96b243e3e9be1ef6bdb9440d23">More...</a><br /></td></tr>
<tr class="separator:a6c4dba96b243e3e9be1ef6bdb9440d23 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b342cfa595300cb8227665382929e8b inherit pub_methods_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a0b342cfa595300cb8227665382929e8b">operator=</a> (const <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html">LinearSolver</a> &amp;)=delete</td></tr>
<tr class="memdesc:a0b342cfa595300cb8227665382929e8b inherit pub_methods_classoomph_1_1LinearSolver"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken assignment operator.  <a href="../../d5/dd7/classoomph_1_1LinearSolver.html#a0b342cfa595300cb8227665382929e8b">More...</a><br /></td></tr>
<tr class="separator:a0b342cfa595300cb8227665382929e8b inherit pub_methods_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9cc9b2c9a239777c4f9b15f26bb324a0 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a9cc9b2c9a239777c4f9b15f26bb324a0">~LinearSolver</a> ()</td></tr>
<tr class="memdesc:a9cc9b2c9a239777c4f9b15f26bb324a0 inherit pub_methods_classoomph_1_1LinearSolver"><td class="mdescLeft">&#160;</td><td class="mdescRight">Empty virtual destructor.  <a href="../../d5/dd7/classoomph_1_1LinearSolver.html#a9cc9b2c9a239777c4f9b15f26bb324a0">More...</a><br /></td></tr>
<tr class="separator:a9cc9b2c9a239777c4f9b15f26bb324a0 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abeb9ef9127e927bf6df75d03645d6a81 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#abeb9ef9127e927bf6df75d03645d6a81">enable_doc_time</a> ()</td></tr>
<tr class="memdesc:abeb9ef9127e927bf6df75d03645d6a81 inherit pub_methods_classoomph_1_1LinearSolver"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enable documentation of solve times.  <a href="../../d5/dd7/classoomph_1_1LinearSolver.html#abeb9ef9127e927bf6df75d03645d6a81">More...</a><br /></td></tr>
<tr class="separator:abeb9ef9127e927bf6df75d03645d6a81 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91ffe51f3de82dad1a110c099f256d73 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a91ffe51f3de82dad1a110c099f256d73">disable_doc_time</a> ()</td></tr>
<tr class="memdesc:a91ffe51f3de82dad1a110c099f256d73 inherit pub_methods_classoomph_1_1LinearSolver"><td class="mdescLeft">&#160;</td><td class="mdescRight">Disable documentation of solve times.  <a href="../../d5/dd7/classoomph_1_1LinearSolver.html#a91ffe51f3de82dad1a110c099f256d73">More...</a><br /></td></tr>
<tr class="separator:a91ffe51f3de82dad1a110c099f256d73 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a451ce3af5db82f9edbddf8f417597248 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a451ce3af5db82f9edbddf8f417597248">is_doc_time_enabled</a> () const</td></tr>
<tr class="memdesc:a451ce3af5db82f9edbddf8f417597248 inherit pub_methods_classoomph_1_1LinearSolver"><td class="mdescLeft">&#160;</td><td class="mdescRight">Is documentation of solve times enabled?  <a href="../../d5/dd7/classoomph_1_1LinearSolver.html#a451ce3af5db82f9edbddf8f417597248">More...</a><br /></td></tr>
<tr class="separator:a451ce3af5db82f9edbddf8f417597248 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1e4d34a7e2b1537d36153f87e8a62a6 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#ae1e4d34a7e2b1537d36153f87e8a62a6">is_resolve_enabled</a> () const</td></tr>
<tr class="memdesc:ae1e4d34a7e2b1537d36153f87e8a62a6 inherit pub_methods_classoomph_1_1LinearSolver"><td class="mdescLeft">&#160;</td><td class="mdescRight">Boolean flag indicating if resolves are enabled.  <a href="../../d5/dd7/classoomph_1_1LinearSolver.html#ae1e4d34a7e2b1537d36153f87e8a62a6">More...</a><br /></td></tr>
<tr class="separator:ae1e4d34a7e2b1537d36153f87e8a62a6 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3000ebd9becb3468d8a6a821a9cc0cd9 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a3000ebd9becb3468d8a6a821a9cc0cd9">enable_resolve</a> ()</td></tr>
<tr class="separator:a3000ebd9becb3468d8a6a821a9cc0cd9 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad61c63af94c5961830bd9807225a48d6 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#ad61c63af94c5961830bd9807225a48d6">disable_resolve</a> ()</td></tr>
<tr class="separator:ad61c63af94c5961830bd9807225a48d6 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e970813a1583f6105ee2d677d3e45f3 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a8e970813a1583f6105ee2d677d3e45f3">solve_transpose</a> (<a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *const &amp;problem_pt, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;result)</td></tr>
<tr class="separator:a8e970813a1583f6105ee2d677d3e45f3 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a600b4d06d85c238bdd6bd33f05d69c44 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a600b4d06d85c238bdd6bd33f05d69c44">solve_transpose</a> (<a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html">DoubleMatrixBase</a> *const &amp;matrix_pt, const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;rhs, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;result)</td></tr>
<tr class="separator:a600b4d06d85c238bdd6bd33f05d69c44 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a499b738758451f94df398d8d2556ae76 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a499b738758451f94df398d8d2556ae76">solve_transpose</a> (<a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html">DoubleMatrixBase</a> *const &amp;matrix_pt, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;rhs, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;result)</td></tr>
<tr class="separator:a499b738758451f94df398d8d2556ae76 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf539c2dd415e22e597fade4c0ca4022 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#acf539c2dd415e22e597fade4c0ca4022">resolve_transpose</a> (const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;rhs, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;result)</td></tr>
<tr class="separator:acf539c2dd415e22e597fade4c0ca4022 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d66f3262e80ca06a365f98216afd85f inherit pub_methods_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a9d66f3262e80ca06a365f98216afd85f">clean_up_memory</a> ()</td></tr>
<tr class="separator:a9d66f3262e80ca06a365f98216afd85f inherit pub_methods_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fedfb9d9855d0e998c0e32140bc56d4 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a0fedfb9d9855d0e998c0e32140bc56d4">jacobian_setup_time</a> () const</td></tr>
<tr class="separator:a0fedfb9d9855d0e998c0e32140bc56d4 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c66f77db812a9c196478c7e2f77ef09 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a3c66f77db812a9c196478c7e2f77ef09">linear_solver_solution_time</a> () const</td></tr>
<tr class="separator:a3c66f77db812a9c196478c7e2f77ef09 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37f1f8b8c6d45115e649739abd5d2f5d inherit pub_methods_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a37f1f8b8c6d45115e649739abd5d2f5d">enable_computation_of_gradient</a> ()</td></tr>
<tr class="separator:a37f1f8b8c6d45115e649739abd5d2f5d inherit pub_methods_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bc045e20074cb9b45ab3f304d037fc6 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a8bc045e20074cb9b45ab3f304d037fc6">disable_computation_of_gradient</a> ()</td></tr>
<tr class="separator:a8bc045e20074cb9b45ab3f304d037fc6 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aceef502cbdf826cdf6aa31f5803982e0 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#aceef502cbdf826cdf6aa31f5803982e0">reset_gradient</a> ()</td></tr>
<tr class="separator:aceef502cbdf826cdf6aa31f5803982e0 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6733411e85f0a1d6d82200c802481681 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a6733411e85f0a1d6d82200c802481681">get_gradient</a> (<a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;gradient)</td></tr>
<tr class="memdesc:a6733411e85f0a1d6d82200c802481681 inherit pub_methods_classoomph_1_1LinearSolver"><td class="mdescLeft">&#160;</td><td class="mdescRight">function to access the gradient, provided it has been computed  <a href="../../d5/dd7/classoomph_1_1LinearSolver.html#a6733411e85f0a1d6d82200c802481681">More...</a><br /></td></tr>
<tr class="separator:a6733411e85f0a1d6d82200c802481681 inherit pub_methods_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classoomph_1_1DistributableLinearAlgebraObject')"><img src="../../closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html">oomph::DistributableLinearAlgebraObject</a></td></tr>
<tr class="memitem:ac9492d59cff9d9b0098712ae72989cd3 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ac9492d59cff9d9b0098712ae72989cd3">DistributableLinearAlgebraObject</a> ()</td></tr>
<tr class="memdesc:ac9492d59cff9d9b0098712ae72989cd3 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default constructor - create a distribution.  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ac9492d59cff9d9b0098712ae72989cd3">More...</a><br /></td></tr>
<tr class="separator:ac9492d59cff9d9b0098712ae72989cd3 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7522391265c46e6c748fd660eae66f5e inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a7522391265c46e6c748fd660eae66f5e">DistributableLinearAlgebraObject</a> (const <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html">DistributableLinearAlgebraObject</a> &amp;<a class="el" href="../../da/d67/level3__impl_8h.html#a21849b14ce38b5bc40d43a5782d89138">matrix</a>)=delete</td></tr>
<tr class="memdesc:a7522391265c46e6c748fd660eae66f5e inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken copy constructor.  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a7522391265c46e6c748fd660eae66f5e">More...</a><br /></td></tr>
<tr class="separator:a7522391265c46e6c748fd660eae66f5e inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada5f539f36451c06e69de79bb129521b inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ada5f539f36451c06e69de79bb129521b">operator=</a> (const <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html">DistributableLinearAlgebraObject</a> &amp;)=delete</td></tr>
<tr class="memdesc:ada5f539f36451c06e69de79bb129521b inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broken assignment operator.  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ada5f539f36451c06e69de79bb129521b">More...</a><br /></td></tr>
<tr class="separator:ada5f539f36451c06e69de79bb129521b inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4038de53b5737dc625411e7848d21dad inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a4038de53b5737dc625411e7848d21dad">~DistributableLinearAlgebraObject</a> ()</td></tr>
<tr class="memdesc:a4038de53b5737dc625411e7848d21dad inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a4038de53b5737dc625411e7848d21dad">More...</a><br /></td></tr>
<tr class="separator:a4038de53b5737dc625411e7848d21dad inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a603105384d60c9a3710378af39f538b9 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a> () const</td></tr>
<tr class="memdesc:a603105384d60c9a3710378af39f538b9 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">access to the LinearAlgebraDistribution  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">More...</a><br /></td></tr>
<tr class="separator:a603105384d60c9a3710378af39f538b9 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7569556f14fd68b28508920e89bd5eee inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a7569556f14fd68b28508920e89bd5eee">nrow</a> () const</td></tr>
<tr class="memdesc:a7569556f14fd68b28508920e89bd5eee inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">access function to the number of global rows.  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a7569556f14fd68b28508920e89bd5eee">More...</a><br /></td></tr>
<tr class="separator:a7569556f14fd68b28508920e89bd5eee inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bd7e1d242c69a28da85a804a7717fce inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">nrow_local</a> () const</td></tr>
<tr class="memdesc:a9bd7e1d242c69a28da85a804a7717fce inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">access function for the num of local rows on this processor.  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">More...</a><br /></td></tr>
<tr class="separator:a9bd7e1d242c69a28da85a804a7717fce inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21e966b025edec79067b41d7f1f25220 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a21e966b025edec79067b41d7f1f25220">nrow_local</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>) const</td></tr>
<tr class="memdesc:a21e966b025edec79067b41d7f1f25220 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">access function for the num of local rows on this processor.  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a21e966b025edec79067b41d7f1f25220">More...</a><br /></td></tr>
<tr class="separator:a21e966b025edec79067b41d7f1f25220 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab00a3919b8634c698749f14a4d92947d inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ab00a3919b8634c698749f14a4d92947d">first_row</a> () const</td></tr>
<tr class="memdesc:ab00a3919b8634c698749f14a4d92947d inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">access function for the first row on this processor  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ab00a3919b8634c698749f14a4d92947d">More...</a><br /></td></tr>
<tr class="separator:ab00a3919b8634c698749f14a4d92947d inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4266c1d18d8e102bad3f4aec26c9b7cf inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a4266c1d18d8e102bad3f4aec26c9b7cf">first_row</a> (const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;<a class="el" href="../../d0/db0/Tutorial__Map__using_8cpp.html#a7fe964f6b1afd4591f637999272ab9a2">p</a>) const</td></tr>
<tr class="memdesc:a4266c1d18d8e102bad3f4aec26c9b7cf inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">access function for the first row on this processor  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a4266c1d18d8e102bad3f4aec26c9b7cf">More...</a><br /></td></tr>
<tr class="separator:a4266c1d18d8e102bad3f4aec26c9b7cf inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5505731e7e73d7e4251c67c7adec6bf5 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a5505731e7e73d7e4251c67c7adec6bf5">distributed</a> () const</td></tr>
<tr class="memdesc:a5505731e7e73d7e4251c67c7adec6bf5 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="mdescLeft">&#160;</td><td class="mdescRight">distribution is serial or distributed  <a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a5505731e7e73d7e4251c67c7adec6bf5">More...</a><br /></td></tr>
<tr class="separator:a5505731e7e73d7e4251c67c7adec6bf5 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c35baa65e335043f62954c92c090a5a inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a8c35baa65e335043f62954c92c090a5a">distribution_built</a> () const</td></tr>
<tr class="separator:a8c35baa65e335043f62954c92c090a5a inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5340bac40b9559b0378037b57005203 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ac5340bac40b9559b0378037b57005203">build_distribution</a> (const <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> *const dist_pt)</td></tr>
<tr class="separator:ac5340bac40b9559b0378037b57005203 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adad20ac61a61d907f823da7694b50616 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#adad20ac61a61d907f823da7694b50616">build_distribution</a> (const <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html">LinearAlgebraDistribution</a> &amp;dist)</td></tr>
<tr class="separator:adad20ac61a61d907f823da7694b50616 inherit pub_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:afcf84124d724d6bd961870fbcdc7b9e4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html">LinearSolver</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#afcf84124d724d6bd961870fbcdc7b9e4">Linear_solver_pt</a></td></tr>
<tr class="memdesc:afcf84124d724d6bd961870fbcdc7b9e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to the original linear solver.  <a href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#afcf84124d724d6bd961870fbcdc7b9e4">More...</a><br /></td></tr>
<tr class="separator:afcf84124d724d6bd961870fbcdc7b9e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5819a48984aa1a9a68c28e106bc22f90"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a5819a48984aa1a9a68c28e106bc22f90">Problem_pt</a></td></tr>
<tr class="memdesc:a5819a48984aa1a9a68c28e106bc22f90"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to the problem, used in the resolve.  <a href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a5819a48984aa1a9a68c28e106bc22f90">More...</a><br /></td></tr>
<tr class="separator:a5819a48984aa1a9a68c28e106bc22f90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e88432fbf8e7cdefbfbd2c67860505e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a4e88432fbf8e7cdefbfbd2c67860505e">B_pt</a></td></tr>
<tr class="memdesc:a4e88432fbf8e7cdefbfbd2c67860505e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to the storage for the vector b.  <a href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a4e88432fbf8e7cdefbfbd2c67860505e">More...</a><br /></td></tr>
<tr class="separator:a4e88432fbf8e7cdefbfbd2c67860505e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9f8e9f84f79437b43e35ae2850ec335"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#ac9f8e9f84f79437b43e35ae2850ec335">C_pt</a></td></tr>
<tr class="memdesc:ac9f8e9f84f79437b43e35ae2850ec335"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to the storage for the vector c.  <a href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#ac9f8e9f84f79437b43e35ae2850ec335">More...</a><br /></td></tr>
<tr class="separator:ac9f8e9f84f79437b43e35ae2850ec335"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3178ff5ce055b76423b30357022f9e58"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a3178ff5ce055b76423b30357022f9e58">D_pt</a></td></tr>
<tr class="memdesc:a3178ff5ce055b76423b30357022f9e58"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to the storage for the vector d.  <a href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a3178ff5ce055b76423b30357022f9e58">More...</a><br /></td></tr>
<tr class="separator:a3178ff5ce055b76423b30357022f9e58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ceff96adc374fb588f106cc3cc9b435"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a3ceff96adc374fb588f106cc3cc9b435">dJy_dparam_pt</a></td></tr>
<tr class="separator:a3ceff96adc374fb588f106cc3cc9b435"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_methods_classoomph_1_1DistributableLinearAlgebraObject"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classoomph_1_1DistributableLinearAlgebraObject')"><img src="../../closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html">oomph::DistributableLinearAlgebraObject</a></td></tr>
<tr class="memitem:a30742aa2ac9abcfa037179f2d28ff43a inherit pro_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a30742aa2ac9abcfa037179f2d28ff43a">clear_distribution</a> ()</td></tr>
<tr class="separator:a30742aa2ac9abcfa037179f2d28ff43a inherit pro_methods_classoomph_1_1DistributableLinearAlgebraObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classoomph_1_1LinearSolver"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classoomph_1_1LinearSolver')"><img src="../../closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html">oomph::LinearSolver</a></td></tr>
<tr class="memitem:a5f5e7e7a44ff0897b0e4cd9524000edc inherit pro_attribs_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a5f5e7e7a44ff0897b0e4cd9524000edc">Enable_resolve</a></td></tr>
<tr class="separator:a5f5e7e7a44ff0897b0e4cd9524000edc inherit pro_attribs_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a536e41b50b3f3464ca9cb4a5776acc19 inherit pro_attribs_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a536e41b50b3f3464ca9cb4a5776acc19">Doc_time</a></td></tr>
<tr class="memdesc:a536e41b50b3f3464ca9cb4a5776acc19 inherit pro_attribs_classoomph_1_1LinearSolver"><td class="mdescLeft">&#160;</td><td class="mdescRight">Boolean flag that indicates whether the time taken.  <a href="../../d5/dd7/classoomph_1_1LinearSolver.html#a536e41b50b3f3464ca9cb4a5776acc19">More...</a><br /></td></tr>
<tr class="separator:a536e41b50b3f3464ca9cb4a5776acc19 inherit pro_attribs_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef857e4c0c16e8b342a14493e558bb15 inherit pro_attribs_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#aef857e4c0c16e8b342a14493e558bb15">Compute_gradient</a></td></tr>
<tr class="separator:aef857e4c0c16e8b342a14493e558bb15 inherit pro_attribs_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fd3bf9a5a94dcc23b7d903f99535e72 inherit pro_attribs_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a9fd3bf9a5a94dcc23b7d903f99535e72">Gradient_has_been_computed</a></td></tr>
<tr class="memdesc:a9fd3bf9a5a94dcc23b7d903f99535e72 inherit pro_attribs_classoomph_1_1LinearSolver"><td class="mdescLeft">&#160;</td><td class="mdescRight">flag that indicates whether the gradient was computed or not  <a href="../../d5/dd7/classoomph_1_1LinearSolver.html#a9fd3bf9a5a94dcc23b7d903f99535e72">More...</a><br /></td></tr>
<tr class="separator:a9fd3bf9a5a94dcc23b7d903f99535e72 inherit pro_attribs_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad38255ae12611787a857cc5c90ffa9f8 inherit pro_attribs_classoomph_1_1LinearSolver"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#ad38255ae12611787a857cc5c90ffa9f8">Gradient_for_glob_conv_newton_solve</a></td></tr>
<tr class="separator:ad38255ae12611787a857cc5c90ffa9f8 inherit pro_attribs_classoomph_1_1LinearSolver"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A custom linear solver class that is used to solve a block-factorised version of the PitchFork bifurcation detection problem. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a9820033e85fed1a01a48ac09f27e574f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9820033e85fed1a01a48ac09f27e574f">&#9670;&nbsp;</a></span>BlockPitchForkLinearSolver()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">oomph::BlockPitchForkLinearSolver::BlockPitchForkLinearSolver </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html">LinearSolver</a> *const&#160;</td>
          <td class="paramname"><em>linear_solver_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructor, inherits the original linear solver. </p>
<div class="fragment"><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;      : <a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#afcf84124d724d6bd961870fbcdc7b9e4">Linear_solver_pt</a>(<a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a38efead8e84202a3232b4a3624a2986c">linear_solver_pt</a>),</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        <a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a5819a48984aa1a9a68c28e106bc22f90">Problem_pt</a>(0),</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        <a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a4e88432fbf8e7cdefbfbd2c67860505e">B_pt</a>(0),</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        <a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#ac9f8e9f84f79437b43e35ae2850ec335">C_pt</a>(0),</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        <a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a3178ff5ce055b76423b30357022f9e58">D_pt</a>(0),</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;        <a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a3ceff96adc374fb588f106cc3cc9b435">dJy_dparam_pt</a>(0)</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    {</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1BlockPitchForkLinearSolver_html_a3178ff5ce055b76423b30357022f9e58"><div class="ttname"><a href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a3178ff5ce055b76423b30357022f9e58">oomph::BlockPitchForkLinearSolver::D_pt</a></div><div class="ttdeci">DoubleVector * D_pt</div><div class="ttdoc">Pointer to the storage for the vector d.</div><div class="ttdef"><b>Definition:</b> assembly_handler.h:623</div></div>
<div class="ttc" id="aclassoomph_1_1BlockPitchForkLinearSolver_html_a38efead8e84202a3232b4a3624a2986c"><div class="ttname"><a href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a38efead8e84202a3232b4a3624a2986c">oomph::BlockPitchForkLinearSolver::linear_solver_pt</a></div><div class="ttdeci">LinearSolver * linear_solver_pt() const</div><div class="ttdoc">Access function to the original linear solver.</div><div class="ttdef"><b>Definition:</b> assembly_handler.h:676</div></div>
<div class="ttc" id="aclassoomph_1_1BlockPitchForkLinearSolver_html_a3ceff96adc374fb588f106cc3cc9b435"><div class="ttname"><a href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a3ceff96adc374fb588f106cc3cc9b435">oomph::BlockPitchForkLinearSolver::dJy_dparam_pt</a></div><div class="ttdeci">DoubleVector * dJy_dparam_pt</div><div class="ttdef"><b>Definition:</b> assembly_handler.h:627</div></div>
<div class="ttc" id="aclassoomph_1_1BlockPitchForkLinearSolver_html_a4e88432fbf8e7cdefbfbd2c67860505e"><div class="ttname"><a href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a4e88432fbf8e7cdefbfbd2c67860505e">oomph::BlockPitchForkLinearSolver::B_pt</a></div><div class="ttdeci">DoubleVector * B_pt</div><div class="ttdoc">Pointer to the storage for the vector b.</div><div class="ttdef"><b>Definition:</b> assembly_handler.h:617</div></div>
<div class="ttc" id="aclassoomph_1_1BlockPitchForkLinearSolver_html_a5819a48984aa1a9a68c28e106bc22f90"><div class="ttname"><a href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a5819a48984aa1a9a68c28e106bc22f90">oomph::BlockPitchForkLinearSolver::Problem_pt</a></div><div class="ttdeci">Problem * Problem_pt</div><div class="ttdoc">Pointer to the problem, used in the resolve.</div><div class="ttdef"><b>Definition:</b> assembly_handler.h:614</div></div>
<div class="ttc" id="aclassoomph_1_1BlockPitchForkLinearSolver_html_ac9f8e9f84f79437b43e35ae2850ec335"><div class="ttname"><a href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#ac9f8e9f84f79437b43e35ae2850ec335">oomph::BlockPitchForkLinearSolver::C_pt</a></div><div class="ttdeci">DoubleVector * C_pt</div><div class="ttdoc">Pointer to the storage for the vector c.</div><div class="ttdef"><b>Definition:</b> assembly_handler.h:620</div></div>
<div class="ttc" id="aclassoomph_1_1BlockPitchForkLinearSolver_html_afcf84124d724d6bd961870fbcdc7b9e4"><div class="ttname"><a href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#afcf84124d724d6bd961870fbcdc7b9e4">oomph::BlockPitchForkLinearSolver::Linear_solver_pt</a></div><div class="ttdeci">LinearSolver * Linear_solver_pt</div><div class="ttdoc">Pointer to the original linear solver.</div><div class="ttdef"><b>Definition:</b> assembly_handler.h:611</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3fa97815fefc83c678341222847797ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3fa97815fefc83c678341222847797ea">&#9670;&nbsp;</a></span>~BlockPitchForkLinearSolver()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">oomph::BlockPitchForkLinearSolver::~BlockPitchForkLinearSolver </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destructor: clean up the allocated memory. </p>
<p>Clean up the memory that may have been allocated by the solver. </p>
<div class="fragment"><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;  {</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a4e88432fbf8e7cdefbfbd2c67860505e">B_pt</a> != 0)</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;    {</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;      <span class="keyword">delete</span> <a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a4e88432fbf8e7cdefbfbd2c67860505e">B_pt</a>;</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;    }</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#ac9f8e9f84f79437b43e35ae2850ec335">C_pt</a> != 0)</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    {</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;      <span class="keyword">delete</span> <a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#ac9f8e9f84f79437b43e35ae2850ec335">C_pt</a>;</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;    }</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a3178ff5ce055b76423b30357022f9e58">D_pt</a> != 0)</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;    {</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;      <span class="keyword">delete</span> <a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a3178ff5ce055b76423b30357022f9e58">D_pt</a>;</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;    }</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a3ceff96adc374fb588f106cc3cc9b435">dJy_dparam_pt</a> != 0)</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;    {</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;      <span class="keyword">delete</span> <a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a3ceff96adc374fb588f106cc3cc9b435">dJy_dparam_pt</a>;</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;    }</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a4e88432fbf8e7cdefbfbd2c67860505e">B_pt</a>, <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#ac9f8e9f84f79437b43e35ae2850ec335">C_pt</a>, <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a3178ff5ce055b76423b30357022f9e58">D_pt</a>, and <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a3ceff96adc374fb588f106cc3cc9b435">dJy_dparam_pt</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a38efead8e84202a3232b4a3624a2986c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38efead8e84202a3232b4a3624a2986c">&#9670;&nbsp;</a></span>linear_solver_pt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html">LinearSolver</a>* oomph::BlockPitchForkLinearSolver::linear_solver_pt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Access function to the original linear solver. </p>
<div class="fragment"><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    {</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#afcf84124d724d6bd961870fbcdc7b9e4">Linear_solver_pt</a>;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#afcf84124d724d6bd961870fbcdc7b9e4">Linear_solver_pt</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a69c6b0b6aedd03d828d295531fd61820">oomph::PitchForkHandler::~PitchForkHandler()</a>.</p>

</div>
</div>
<a id="a9a424fd2ae0b67ef8c3ff59f16030786"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a424fd2ae0b67ef8c3ff59f16030786">&#9670;&nbsp;</a></span>resolve()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::BlockPitchForkLinearSolver::resolve </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;&#160;</td>
          <td class="paramname"><em>rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The resolve function also uses the block factorisation. </p>

<p>Reimplemented from <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a3b310d08333033edc119b2a5bd7dcbfb">oomph::LinearSolver</a>.</p>
<div class="fragment"><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;  {</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Block pitchfork resolve&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;    <span class="comment">// Check that the factors have been stored</span></div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a4e88432fbf8e7cdefbfbd2c67860505e">B_pt</a> == 0)</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;    {</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(<span class="stringliteral">&quot;The required vectors have not been stored&quot;</span>,</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;    }</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160; </div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160; </div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;    <span class="comment">// Cache pointer to the problem</span></div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;    Problem* <span class="keyword">const</span> problem_pt = <a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a5819a48984aa1a9a68c28e106bc22f90">Problem_pt</a>;</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160; </div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;    <span class="comment">// Locally cache pointer to the handler</span></div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;    PitchForkHandler* handler_pt =</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;      <span class="keyword">static_cast&lt;</span>PitchForkHandler*<span class="keyword">&gt;</span>(problem_pt-&gt;assembly_handler_pt());</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160; </div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;    <span class="comment">// Get the augmented distribution from the handler</span></div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;    LinearAlgebraDistribution aug_dist =</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;      handler_pt-&gt;Augmented_dof_distribution_pt;</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;    <span class="comment">// this-&gt;build_distribution(aug_dist);</span></div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160; </div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;    <span class="comment">// Find the number of dofs of the augmented system</span></div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;    <span class="comment">// const unsigned n_aug_dof = problem_pt-&gt;ndof();</span></div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160; </div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;    <span class="comment">// Storage for the result distribution</span></div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;    LinearAlgebraDistribution result_dist;</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160; </div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;    <span class="comment">// if the result vector is not setup then rebuild with distribution</span></div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;    <span class="comment">// = natural distribution of augmented solver</span></div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;    <span class="keywordflow">if</span> (!result.built())</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;    {</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;      result.build(&amp;aug_dist, 0.0);</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;    }</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;    <span class="comment">// Otherwise store the incoming distribution and redistribute</span></div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;    {</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;      result_dist.build(result.distribution_pt());</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;      result.redistribute(&amp;aug_dist);</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;    }</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160; </div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160; </div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;    <span class="comment">// Locally cache a pointer to the parameter</span></div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;    <span class="comment">// double* const parameter_pt = handler_pt-&gt;Parameter_pt;</span></div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160; </div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;    <span class="comment">// Switch things to our block solver</span></div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;    handler_pt-&gt;solve_block_system();</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;    <span class="comment">// We need to find out the number of dofs</span></div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;    <span class="comment">// unsigned n_dof = problem_pt-&gt;ndof();</span></div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160; </div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;    <span class="comment">// create the linear algebra distribution for this solver</span></div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;    <span class="comment">// currently only global (non-distributed) distributions are allowed</span></div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;    <span class="comment">// LinearAlgebraDistribution</span></div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;    <span class="comment">// dist(problem_pt-&gt;communicator_pt(),n_dof,false);</span></div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;    <span class="comment">// this-&gt;build_distribution(dist);</span></div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160; </div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;    <span class="comment">// if the result vector is not setup then rebuild with distribution = global</span></div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;    <span class="comment">// if (!result.built())</span></div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;    <span class="comment">// {</span></div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;    <span class="comment">//  result.build(this-&gt;distribution_pt(),0.0);</span></div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;    <span class="comment">// }</span></div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160; </div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160; </div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;    <span class="comment">// Copy the rhs into local storage</span></div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;    <a class="code" href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a> rhs_local = rhs;</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;    <span class="comment">// and redistribute into the augmented distribution</span></div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;    rhs_local.redistribute(&amp;aug_dist);</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160; </div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;    <span class="comment">// Setup storage for output</span></div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;    <a class="code" href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a> <a class="code" href="../../df/df4/namespaceGlobal__parameters.html#a1017523474a983fa10bc226cfc9beaf9">x1</a>(<a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#afcf84124d724d6bd961870fbcdc7b9e4">Linear_solver_pt</a>-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>(), 0.0);</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;    <a class="code" href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a> x3(<a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#afcf84124d724d6bd961870fbcdc7b9e4">Linear_solver_pt</a>-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>(), 0.0);</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160; </div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;    <span class="comment">// Create input for RHS with the natural distribution</span></div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;    <a class="code" href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a> input_x1(handler_pt-&gt;Dof_distribution_pt);</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_dof_local = input_x1.nrow_local();</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160; </div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;    <span class="comment">// Set the values of the a vector</span></div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_dof_local; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;    {</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;      input_x1[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>] = rhs_local[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>];</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;    }</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;    <span class="comment">// Need to redistribute into the linear algebra distribution</span></div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;    input_x1.redistribute(<a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#afcf84124d724d6bd961870fbcdc7b9e4">Linear_solver_pt</a>-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>());</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160; </div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;    <span class="comment">// We want to resolve, of course</span></div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;    <a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#afcf84124d724d6bd961870fbcdc7b9e4">Linear_solver_pt</a>-&gt;<a class="code" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a3000ebd9becb3468d8a6a821a9cc0cd9">enable_resolve</a>();</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;    <span class="comment">// Now solve for the first vector</span></div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;    <a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#afcf84124d724d6bd961870fbcdc7b9e4">Linear_solver_pt</a>-&gt;<a class="code" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a3b310d08333033edc119b2a5bd7dcbfb">resolve</a>(input_x1, <a class="code" href="../../df/df4/namespaceGlobal__parameters.html#a1017523474a983fa10bc226cfc9beaf9">x1</a>);</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160; </div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;    <span class="comment">// Get the symmetry vector from the handler</span></div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;    <a class="code" href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a> psi = handler_pt-&gt;Psi;</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;    <span class="comment">// redistribute local copy</span></div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;    psi.redistribute(<a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#afcf84124d724d6bd961870fbcdc7b9e4">Linear_solver_pt</a>-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>());</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160; </div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;    <span class="comment">// We can now construct various dot products</span></div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;    <span class="keywordtype">double</span> psi_d = psi.dot(*<a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a3178ff5ce055b76423b30357022f9e58">D_pt</a>);</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;    <span class="keywordtype">double</span> psi_c = psi.dot(*<a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#ac9f8e9f84f79437b43e35ae2850ec335">C_pt</a>);</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;    <span class="keywordtype">double</span> psi_x1 = psi.dot(<a class="code" href="../../df/df4/namespaceGlobal__parameters.html#a1017523474a983fa10bc226cfc9beaf9">x1</a>);</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160; </div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;    <span class="comment">// Calculate another intermediate constant</span></div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> Psi = psi_d / psi_c;</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160; </div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;    <span class="comment">// Construct the second intermediate value,</span></div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;    <span class="comment">// assumption is that rhs has been set to the current value of the residuals</span></div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;    <span class="keywordtype">double</span> parameter_residual = rhs_local[n_dof_local];</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;    <span class="comment">// Broadcast to all others, if we have a distributed problem</span></div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;    <span class="keywordflow">if</span> (problem_pt-&gt;distributed())</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;    {</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;      MPI_Bcast(&amp;parameter_residual,</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;                1,</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;                MPI_DOUBLE,</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;                0,</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;                problem_pt-&gt;communicator_pt()-&gt;mpi_comm());</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;    }</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160; </div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../df/df4/namespaceGlobal__parameters.html#ab838699c8a7fd1a106a9db0d53595798">x2</a> = (psi_x1 - parameter_residual) / psi_c;</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160; </div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;    <span class="comment">// Now construct the vectors that multiply the jacobian terms</span></div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;    <span class="comment">// Vector&lt;double&gt; X1(n_dof/*+1*/);</span></div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;    Vector&lt;DoubleVectorWithHaloEntries&gt; X1(1);</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;    X1[0].build(<a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#afcf84124d724d6bd961870fbcdc7b9e4">Linear_solver_pt</a>-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>(), 0.0);</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160; </div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_dof_local_linear_solver =</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;      <a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#afcf84124d724d6bd961870fbcdc7b9e4">Linear_solver_pt</a>-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>()-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">nrow_local</a>();</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_dof_local_linear_solver; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;    {</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;      X1[0][<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>] = <a class="code" href="../../df/df4/namespaceGlobal__parameters.html#a1017523474a983fa10bc226cfc9beaf9">x1</a>[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>] - <a class="code" href="../../df/df4/namespaceGlobal__parameters.html#ab838699c8a7fd1a106a9db0d53595798">x2</a> * (*C_pt)[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>];</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;    }</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160; </div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;    <span class="comment">// Local storage for the product term</span></div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;    Vector&lt;DoubleVectorWithHaloEntries&gt; Jprod_X1(1);</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160; </div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;    <span class="comment">// Redistribute the inputs to have the Dof distribution pt</span></div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;    X1[0].redistribute(handler_pt-&gt;Dof_distribution_pt);</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160; </div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;    <span class="comment">// Set up the halo scheme</span></div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;    X1[0].build_halo_scheme(problem_pt-&gt;Halo_scheme_pt);</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160; </div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;    <span class="comment">// Get the product from the problem</span></div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;    problem_pt-&gt;get_hessian_vector_products(handler_pt-&gt;Y, X1, Jprod_X1);</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160; </div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;    <span class="comment">// In standard cases the offset here will be one</span></div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;    <span class="keywordtype">unsigned</span> offset = 1;</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;    <span class="comment">// If we are distributed and not on the first processor</span></div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;    <span class="comment">// then there is no offset and the eigenfunction is</span></div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;    <span class="comment">// directly after the standard dofs</span></div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;    <span class="keywordtype">int</span> my_rank = problem_pt-&gt;communicator_pt()-&gt;my_rank();</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;    <span class="keywordflow">if</span> ((problem_pt-&gt;distributed()) &amp;&amp; (my_rank != 0))</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;    {</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;      offset = 0;</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;    }</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160; </div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;    <span class="comment">// OK, now we can formulate the next vectors</span></div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;    <span class="comment">//(again assuming result contains residuals)</span></div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;    <span class="comment">// Local storage for the product terms</span></div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;    <a class="code" href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a> Mod_Jprod_X1(handler_pt-&gt;Dof_distribution_pt, 0.0);</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160; </div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_dof_local; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;    {</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;      Mod_Jprod_X1[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>] = rhs_local[n_dof_local + offset + <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>] - Jprod_X1[0][<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>] -</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;                        <a class="code" href="../../df/df4/namespaceGlobal__parameters.html#ab838699c8a7fd1a106a9db0d53595798">x2</a> * (*dJy_dparam_pt)[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>];</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;    }</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160; </div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;    <span class="comment">// Redistribute back to the linear solver distribution</span></div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;    Mod_Jprod_X1.redistribute(<a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#afcf84124d724d6bd961870fbcdc7b9e4">Linear_solver_pt</a>-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>());</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160; </div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;    <span class="comment">// Liner solve to get x3</span></div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;    <a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#afcf84124d724d6bd961870fbcdc7b9e4">Linear_solver_pt</a>-&gt;<a class="code" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a3b310d08333033edc119b2a5bd7dcbfb">resolve</a>(Mod_Jprod_X1, x3);</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160; </div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;    <span class="comment">// Construst a couple of additional products</span></div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;    <span class="keywordtype">double</span> l_x3 = psi.dot(x3);</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;    <span class="keywordtype">double</span> l_b = psi.dot(*<a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a4e88432fbf8e7cdefbfbd2c67860505e">B_pt</a>);</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160; </div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;    <span class="comment">// get the last intermediate variable</span></div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;    <span class="comment">// The required parameter is that corresponding to the dof, which</span></div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;    <span class="comment">// is only stored on the root processor</span></div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;    <span class="keywordtype">double</span> sigma_residual = rhs_local[2 * (n_dof_local + offset) - 1];</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;    <span class="comment">// Broadcast to all others, if we have a distributed problem</span></div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;    <span class="keywordflow">if</span> (problem_pt-&gt;distributed())</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;    {</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;      MPI_Bcast(&amp;sigma_residual,</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;                1,</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;                MPI_DOUBLE,</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;                0,</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;                problem_pt-&gt;communicator_pt()-&gt;mpi_comm());</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;    }</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160; </div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;    <span class="comment">// get the last intermediate variable</span></div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> delta_sigma = (l_x3 - sigma_residual) / l_b;</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> delta_lambda = <a class="code" href="../../df/df4/namespaceGlobal__parameters.html#ab838699c8a7fd1a106a9db0d53595798">x2</a> - delta_sigma * Psi;</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160; </div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;    <span class="comment">// Create temporary DoubleVectors to hold the results</span></div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;    <a class="code" href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a> res1(<a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#afcf84124d724d6bd961870fbcdc7b9e4">Linear_solver_pt</a>-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>());</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;    <a class="code" href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a> res2(<a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#afcf84124d724d6bd961870fbcdc7b9e4">Linear_solver_pt</a>-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>());</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160; </div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_dof_local_linear_solver; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;    {</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;      res1[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>] = <a class="code" href="../../df/df4/namespaceGlobal__parameters.html#a1017523474a983fa10bc226cfc9beaf9">x1</a>[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>] - delta_lambda * (*C_pt)[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>] - delta_sigma * (*D_pt)[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>];</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;      res2[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>] = x3[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>] - delta_sigma * (*B_pt)[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>];</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;    }</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160; </div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;    <span class="comment">// Now redistribute these into the Dof distribution pointer</span></div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;    res1.redistribute(handler_pt-&gt;Dof_distribution_pt);</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;    res2.redistribute(handler_pt-&gt;Dof_distribution_pt);</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160; </div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;    <span class="comment">// Now can copy over into results into the result vector</span></div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_dof_local; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;    {</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;      result[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>] = res1[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>];</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;      result[n_dof_local + offset + <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>] = res2[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>];</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;    }</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160; </div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;    <span class="comment">// Add the final contributions to the residuals</span></div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;    <span class="comment">// only on the root processor if we have a distributed problem</span></div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;    <span class="keywordflow">if</span> ((!problem_pt-&gt;distributed()) || (my_rank == 0))</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;    {</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;      result[n_dof_local] = delta_lambda;</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;      result[2 * n_dof_local + 1] = delta_sigma;</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;    }</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160; </div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;    <span class="comment">// Redistribute the result into its incoming distribution (if it had one)</span></div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;    <span class="keywordflow">if</span> (result_dist.built())</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;    {</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;      result.redistribute(&amp;result_dist);</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;    }</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160; </div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;    <a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#afcf84124d724d6bd961870fbcdc7b9e4">Linear_solver_pt</a>-&gt;<a class="code" href="../../d5/dd7/classoomph_1_1LinearSolver.html#ad61c63af94c5961830bd9807225a48d6">disable_resolve</a>();</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160; </div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;    <span class="comment">// Switch things to our block solver</span></div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;    handler_pt-&gt;solve_full_system();</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;  }</div>
<div class="ttc" id="aCG3DPackingUnitTest_8cpp_html_a7026fd16370249ce97cb3d062326baf9"><div class="ttname"><a href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a></div><div class="ttdeci">const unsigned n</div><div class="ttdef"><b>Definition:</b> CG3DPackingUnitTest.cpp:11</div></div>
<div class="ttc" id="aClumpInput_8h_html_a82f6bc76e1c7a0f51bf3e95ad5d3c590"><div class="ttname"><a href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a></div><div class="ttdeci">std::vector&lt; double &gt; DoubleVector</div><div class="ttdoc">loads clump configuration</div><div class="ttdef"><b>Definition:</b> ClumpInput.h:26</div></div>
<div class="ttc" id="aclassoomph_1_1DistributableLinearAlgebraObject_html_a603105384d60c9a3710378af39f538b9"><div class="ttname"><a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">oomph::DistributableLinearAlgebraObject::distribution_pt</a></div><div class="ttdeci">LinearAlgebraDistribution * distribution_pt() const</div><div class="ttdoc">access to the LinearAlgebraDistribution</div><div class="ttdef"><b>Definition:</b> linear_algebra_distribution.h:457</div></div>
<div class="ttc" id="aclassoomph_1_1LinearAlgebraDistribution_html_ac9310de740f9c3a61f8d5dab9bef88ca"><div class="ttname"><a href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">oomph::LinearAlgebraDistribution::nrow_local</a></div><div class="ttdeci">unsigned nrow_local() const</div><div class="ttdef"><b>Definition:</b> linear_algebra_distribution.h:193</div></div>
<div class="ttc" id="aclassoomph_1_1LinearSolver_html_a3000ebd9becb3468d8a6a821a9cc0cd9"><div class="ttname"><a href="../../d5/dd7/classoomph_1_1LinearSolver.html#a3000ebd9becb3468d8a6a821a9cc0cd9">oomph::LinearSolver::enable_resolve</a></div><div class="ttdeci">virtual void enable_resolve()</div><div class="ttdef"><b>Definition:</b> linear_solver.h:135</div></div>
<div class="ttc" id="aclassoomph_1_1LinearSolver_html_a3b310d08333033edc119b2a5bd7dcbfb"><div class="ttname"><a href="../../d5/dd7/classoomph_1_1LinearSolver.html#a3b310d08333033edc119b2a5bd7dcbfb">oomph::LinearSolver::resolve</a></div><div class="ttdeci">virtual void resolve(const DoubleVector &amp;rhs, DoubleVector &amp;result)</div><div class="ttdef"><b>Definition:</b> linear_solver.h:225</div></div>
<div class="ttc" id="aclassoomph_1_1LinearSolver_html_ad61c63af94c5961830bd9807225a48d6"><div class="ttname"><a href="../../d5/dd7/classoomph_1_1LinearSolver.html#ad61c63af94c5961830bd9807225a48d6">oomph::LinearSolver::disable_resolve</a></div><div class="ttdeci">virtual void disable_resolve()</div><div class="ttdef"><b>Definition:</b> linear_solver.h:144</div></div>
<div class="ttc" id="anamespaceGlobal__parameters_html_a1017523474a983fa10bc226cfc9beaf9"><div class="ttname"><a href="../../df/df4/namespaceGlobal__parameters.html#a1017523474a983fa10bc226cfc9beaf9">Global_parameters::x1</a></div><div class="ttdeci">Vector&lt; double &gt; x1(const Vector&lt; double &gt; &amp;coord)</div><div class="ttdoc">Cartesian coordinates centered at the point (0.5,1)</div><div class="ttdef"><b>Definition:</b> poisson/poisson_with_singularity/two_d_poisson.cc:86</div></div>
<div class="ttc" id="anamespaceGlobal__parameters_html_ab838699c8a7fd1a106a9db0d53595798"><div class="ttname"><a href="../../df/df4/namespaceGlobal__parameters.html#ab838699c8a7fd1a106a9db0d53595798">Global_parameters::x2</a></div><div class="ttdeci">Vector&lt; double &gt; x2(const Vector&lt; double &gt; &amp;coord)</div><div class="ttdoc">Cartesian coordinates centered at the point (1.5,1)</div><div class="ttdef"><b>Definition:</b> poisson/poisson_with_singularity/two_d_poisson.cc:102</div></div>
<div class="ttc" id="aoomph__definitions_8h_html_a25c6813cc7341d125e2502f8923fb6c4"><div class="ttname"><a href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a></div><div class="ttdeci">#define OOMPH_EXCEPTION_LOCATION</div><div class="ttdef"><b>Definition:</b> oomph_definitions.h:61</div></div>
<div class="ttc" id="aoomph__definitions_8h_html_aa260cc4af589e30cea7fde997ae16667"><div class="ttname"><a href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a></div><div class="ttdeci">#define OOMPH_CURRENT_FUNCTION</div><div class="ttdef"><b>Definition:</b> oomph_definitions.h:86</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">oomph::Problem::assembly_handler_pt()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#af6346c1dc77f3d4fb3dc8950afd91e0f">oomph::PitchForkHandler::Augmented_dof_distribution_pt</a>, <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a4e88432fbf8e7cdefbfbd2c67860505e">B_pt</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#a7bcc94c157d6853a0f0502e8a76ed380">oomph::DoubleVector::build()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a3cab441019e738e4c6db6ee22dd71515">oomph::LinearAlgebraDistribution::build()</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#aae402d422ec4344a4a45cdb7659b7161">oomph::DoubleVector::built()</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#a92bfff97fd228b9c528922c39ab563b2">oomph::LinearAlgebraDistribution::built()</a>, <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#ac9f8e9f84f79437b43e35ae2850ec335">C_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">oomph::Problem::communicator_pt()</a>, <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a3178ff5ce055b76423b30357022f9e58">D_pt</a>, <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#ad61c63af94c5961830bd9807225a48d6">oomph::LinearSolver::disable_resolve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af5e9f1623cad361048856a4c0463ea23">oomph::Problem::distributed()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">oomph::DistributableLinearAlgebraObject::distribution_pt()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a075f47b5f8941d25796f96d258a1752e">oomph::PitchForkHandler::Dof_distribution_pt</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#abd20e2e394c8e08749ed34c7228c8506">oomph::DoubleVector::dot()</a>, <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a3000ebd9becb3468d8a6a821a9cc0cd9">oomph::LinearSolver::enable_resolve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a497518acb5d30a28a253890c3d2a5da2">oomph::Problem::get_hessian_vector_products()</a>, <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#afcf84124d724d6bd961870fbcdc7b9e4">Linear_solver_pt</a>, <a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a670b34aab05bfe0b96d0e0fabf583c7a">oomph::OomphCommunicator::my_rank()</a>, <a class="el" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">oomph::LinearAlgebraDistribution::nrow_local()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a9bd7e1d242c69a28da85a804a7717fce">oomph::DistributableLinearAlgebraObject::nrow_local()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a5819a48984aa1a9a68c28e106bc22f90">Problem_pt</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aa04d0f340d919d4da3f9199eb76649b1">oomph::PitchForkHandler::Psi</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#a9396b861977c16606d8eca39056976c8">oomph::DoubleVector::redistribute()</a>, <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a3b310d08333033edc119b2a5bd7dcbfb">oomph::LinearSolver::resolve()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ad193c3d67741edd60b023c94e42c8802">oomph::PitchForkHandler::solve_block_system()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a27325616f4342d159f6f5e7c82ccdf98">oomph::PitchForkHandler::solve_full_system()</a>, <a class="el" href="../../df/df4/namespaceGlobal__parameters.html#a1017523474a983fa10bc226cfc9beaf9">Global_parameters::x1()</a>, <a class="el" href="../../df/df4/namespaceGlobal__parameters.html#ab838699c8a7fd1a106a9db0d53595798">Global_parameters::x2()</a>, and <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a289ce15584734b8ea50cd9a7f7f430ed">oomph::PitchForkHandler::Y</a>.</p>

</div>
</div>
<a id="aaa6dbd59c0f6db8e5a19689888b17eac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa6dbd59c0f6db8e5a19689888b17eac">&#9670;&nbsp;</a></span>solve() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::BlockPitchForkLinearSolver::solve </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html">DoubleMatrixBase</a> *const &amp;&#160;</td>
          <td class="paramname"><em>matrix_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;&#160;</td>
          <td class="paramname"><em>rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The linear-algebra-type solver does not make sense. The interface is deliberately broken </p>

<p>Reimplemented from <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a546c09822d18191df14caed864c04c09">oomph::LinearSolver</a>.</p>
<div class="fragment"><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    {</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        <span class="stringliteral">&quot;Linear-algebra interface does not make sense for this linear solver\n&quot;</span>,</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, and <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>.</p>

</div>
</div>
<a id="a45c8a56bd1942374756feb9edcfb6151"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45c8a56bd1942374756feb9edcfb6151">&#9670;&nbsp;</a></span>solve() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::BlockPitchForkLinearSolver::solve </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dc/df5/classoomph_1_1DoubleMatrixBase.html">DoubleMatrixBase</a> *const &amp;&#160;</td>
          <td class="paramname"><em>matrix_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The linear-algebra-type solver does not make sense. The interface is deliberately broken </p>

<p>Reimplemented from <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a1f7a2ee2cd18d3dafc20a61ca2f52dbb">oomph::LinearSolver</a>.</p>
<div class="fragment"><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    {</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        <span class="stringliteral">&quot;Linear-algebra interface does not make sense for this linear solver\n&quot;</span>,</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, and <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>.</p>

</div>
</div>
<a id="ad196867613954a8fabd318b50e2aadc6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad196867613954a8fabd318b50e2aadc6">&#9670;&nbsp;</a></span>solve() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::BlockPitchForkLinearSolver::solve </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *const &amp;&#160;</td>
          <td class="paramname"><em>problem_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a> &amp;&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The solve function uses the block factorisation. </p>
<p>Use a block factorisation to solve the augmented system associated with a PitchFork bifurcation. </p>

<p>Implements <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a15ce22542b74ed1826ea485edacbeb6e">oomph::LinearSolver</a>.</p>
<div class="fragment"><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;  {</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;Block pitchfork solve&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;    <span class="comment">// Locally cache the pointer to the handler.</span></div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;    PitchForkHandler* handler_pt =</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;      <span class="keyword">static_cast&lt;</span>PitchForkHandler*<span class="keyword">&gt;</span>(problem_pt-&gt;assembly_handler_pt());</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160; </div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;    <span class="comment">// Get the augmented distribution from the handler and use it as</span></div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;    <span class="comment">// the distribution of the linear solver</span></div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;    LinearAlgebraDistribution aug_dist =</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;      handler_pt-&gt;Augmented_dof_distribution_pt;</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;    this-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ac5340bac40b9559b0378037b57005203">build_distribution</a>(aug_dist);</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160; </div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;    <span class="comment">// If the result vector is not setup then die</span></div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;    <span class="keywordflow">if</span> (!result.built())</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;    {</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(<span class="stringliteral">&quot;Result vector must be built\n&quot;</span>,</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;                          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;    }</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160; </div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;    <span class="comment">// Store the distribution of the result, which is probably not in</span></div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;    <span class="comment">// the natural distribution of the augmented solver</span></div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;    LinearAlgebraDistribution result_dist(result.distribution_pt());</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160; </div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;    <span class="comment">// Locally cache a pointer to the parameter</span></div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;    <span class="keywordtype">double</span>* <span class="keyword">const</span> parameter_pt = handler_pt-&gt;Parameter_pt;</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160; </div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;    <span class="comment">// Firstly get the derivatives of the full augmented system with</span></div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;    <span class="comment">// respect to the parameter</span></div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160; </div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;    <span class="comment">// Allocate storage for the derivatives of the residuals with respect</span></div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;    <span class="comment">// to the global parameter using the augmented distribution</span></div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    <a class="code" href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a> dRdparam;</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;    <span class="comment">// Then get the appropriate derivatives which will come back in</span></div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;    <span class="comment">// some distribution</span></div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    problem_pt-&gt;get_derivative_wrt_global_parameter(parameter_pt, dRdparam);</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    <span class="comment">// Redistribute into the augmented distribution</span></div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;    dRdparam.redistribute(&amp;aug_dist);</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160; </div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;    <span class="comment">// Switch the handler to &quot;block solver&quot; mode (sort out distribution)</span></div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;    handler_pt-&gt;solve_block_system();</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160; </div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;    <span class="comment">// Temporary vector for the result (I shouldn&#39;t have to set this up)</span></div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;    <a class="code" href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a> <a class="code" href="../../df/df4/namespaceGlobal__parameters.html#a1017523474a983fa10bc226cfc9beaf9">x1</a>;</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160; </div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;    <span class="comment">// We are going to do resolves using the underlying linear solver</span></div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;    <a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#afcf84124d724d6bd961870fbcdc7b9e4">Linear_solver_pt</a>-&gt;<a class="code" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a3000ebd9becb3468d8a6a821a9cc0cd9">enable_resolve</a>();</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;    <span class="comment">// Solve the first (standard) system Jx1 = R</span></div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;    <a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#afcf84124d724d6bd961870fbcdc7b9e4">Linear_solver_pt</a>-&gt;<a class="code" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a15ce22542b74ed1826ea485edacbeb6e">solve</a>(problem_pt, <a class="code" href="../../df/df4/namespaceGlobal__parameters.html#a1017523474a983fa10bc226cfc9beaf9">x1</a>);</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160; </div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;    <span class="comment">// Allocate storage for B, C and D which can be used in the resolve</span></div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;    <span class="comment">// and the derivatives of the jacobian/eigenvector product with</span></div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;    <span class="comment">// respect to the parameter</span></div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a4e88432fbf8e7cdefbfbd2c67860505e">B_pt</a> != 0)</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;    {</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;      <span class="keyword">delete</span> <a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a4e88432fbf8e7cdefbfbd2c67860505e">B_pt</a>;</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;    }</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;    <a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a4e88432fbf8e7cdefbfbd2c67860505e">B_pt</a> = <span class="keyword">new</span> <a class="code" href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a>(<a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#afcf84124d724d6bd961870fbcdc7b9e4">Linear_solver_pt</a>-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>(), 0.0);</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#ac9f8e9f84f79437b43e35ae2850ec335">C_pt</a> != 0)</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;    {</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;      <span class="keyword">delete</span> <a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#ac9f8e9f84f79437b43e35ae2850ec335">C_pt</a>;</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;    }</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;    <a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#ac9f8e9f84f79437b43e35ae2850ec335">C_pt</a> = <span class="keyword">new</span> <a class="code" href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a>(<a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#afcf84124d724d6bd961870fbcdc7b9e4">Linear_solver_pt</a>-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>(), 0.0);</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a3178ff5ce055b76423b30357022f9e58">D_pt</a> != 0)</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;    {</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;      <span class="keyword">delete</span> <a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a3178ff5ce055b76423b30357022f9e58">D_pt</a>;</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;    }</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;    <a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a3178ff5ce055b76423b30357022f9e58">D_pt</a> = <span class="keyword">new</span> <a class="code" href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a>(<a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#afcf84124d724d6bd961870fbcdc7b9e4">Linear_solver_pt</a>-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>(), 0.0);</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;    <span class="comment">// Need this to be in the distribution of the dofs</span></div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a3ceff96adc374fb588f106cc3cc9b435">dJy_dparam_pt</a> != 0)</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;    {</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;      <span class="keyword">delete</span> <a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a3ceff96adc374fb588f106cc3cc9b435">dJy_dparam_pt</a>;</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;    }</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;    <a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a3ceff96adc374fb588f106cc3cc9b435">dJy_dparam_pt</a> = <span class="keyword">new</span> <a class="code" href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a>(handler_pt-&gt;Dof_distribution_pt, 0.0);</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160; </div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;    <span class="comment">// Get the symmetry vector from the handler should have the</span></div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;    <span class="comment">// Dof distribution</span></div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;    <a class="code" href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a> psi = handler_pt-&gt;Psi;</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160; </div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;    <span class="comment">// Temporary vector for the rhs that is dR/dparam (augmented distribution)</span></div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;    <span class="comment">// DoubleVector F(Linear_solver_pt-&gt;distribution_pt(),0.0);</span></div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;    <a class="code" href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a> <a class="code" href="../../da/dee/namespaceoomph_1_1OcTreeNames.html#a1240bbd25e0b8bffa1171375f1c7183da755807a4724a0f4d96f0817559c0a927">F</a>(handler_pt-&gt;Dof_distribution_pt);</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_dof_local = <a class="code" href="../../da/dee/namespaceoomph_1_1OcTreeNames.html#a1240bbd25e0b8bffa1171375f1c7183da755807a4724a0f4d96f0817559c0a927">F</a>.nrow_local();</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160; </div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;    <span class="comment">// f.nrow local copied from dRdparam</span></div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_dof_local; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;    {</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;      <a class="code" href="../../da/dee/namespaceoomph_1_1OcTreeNames.html#a1240bbd25e0b8bffa1171375f1c7183da755807a4724a0f4d96f0817559c0a927">F</a>[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>] = dRdparam[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>];</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;    }</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;    <span class="comment">// Fill in the rhs that is dJy/dparam  //dJy_dparam nrow local</span></div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160; </div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;    <span class="comment">// In standard cases the offset here will be one</span></div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;    <span class="keywordtype">unsigned</span> offset = 1;</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;    <span class="comment">// If we are distributed and not on the first processor</span></div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;    <span class="comment">// then there is no offset and the eigenfunction is</span></div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;    <span class="comment">// directly after the standard dofs</span></div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;    <span class="keywordtype">int</span> my_rank = problem_pt-&gt;communicator_pt()-&gt;my_rank();</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;    <span class="keywordflow">if</span> ((problem_pt-&gt;distributed()) &amp;&amp; (my_rank != 0))</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;    {</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;      offset = 0;</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;    }</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_dof_local; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;    {</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;      (*dJy_dparam_pt)[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>] = dRdparam[n_dof_local + offset + <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>];</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;    }</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160; </div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;    <span class="comment">// Now resolve to find c and d</span></div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;    <span class="comment">// First, redistribute F and psi into the linear algebra distribution</span></div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;    <a class="code" href="../../da/dee/namespaceoomph_1_1OcTreeNames.html#a1240bbd25e0b8bffa1171375f1c7183da755807a4724a0f4d96f0817559c0a927">F</a>.redistribute(<a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#afcf84124d724d6bd961870fbcdc7b9e4">Linear_solver_pt</a>-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>());</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;    psi.redistribute(<a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#afcf84124d724d6bd961870fbcdc7b9e4">Linear_solver_pt</a>-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>());</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160; </div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;    <a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#afcf84124d724d6bd961870fbcdc7b9e4">Linear_solver_pt</a>-&gt;<a class="code" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a3b310d08333033edc119b2a5bd7dcbfb">resolve</a>(<a class="code" href="../../da/dee/namespaceoomph_1_1OcTreeNames.html#a1240bbd25e0b8bffa1171375f1c7183da755807a4724a0f4d96f0817559c0a927">F</a>, *<a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#ac9f8e9f84f79437b43e35ae2850ec335">C_pt</a>);</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;    <a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#afcf84124d724d6bd961870fbcdc7b9e4">Linear_solver_pt</a>-&gt;<a class="code" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a3b310d08333033edc119b2a5bd7dcbfb">resolve</a>(psi, *<a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a3178ff5ce055b76423b30357022f9e58">D_pt</a>);</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160; </div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;    <span class="comment">// We can now construct various dot products</span></div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;    <span class="keywordtype">double</span> psi_d = psi.dot(*<a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a3178ff5ce055b76423b30357022f9e58">D_pt</a>);</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;    <span class="keywordtype">double</span> psi_c = psi.dot(*<a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#ac9f8e9f84f79437b43e35ae2850ec335">C_pt</a>);</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;    <span class="keywordtype">double</span> psi_x1 = psi.dot(<a class="code" href="../../df/df4/namespaceGlobal__parameters.html#a1017523474a983fa10bc226cfc9beaf9">x1</a>);</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160; </div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;    <span class="comment">// Calculate another intermediate constant</span></div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> Psi = psi_d / psi_c;</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160; </div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;    <span class="comment">// Construct the second intermediate value,</span></div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;    <span class="comment">// assumption is that result has been</span></div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;    <span class="comment">// set to the current value of the residuals</span></div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;    <span class="comment">// First, redistribute into the Natural distribution of the augmented system</span></div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;    result.redistribute(&amp;aug_dist);</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;    <span class="comment">// The required parameter is that corresponding to the dof, which</span></div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;    <span class="comment">// is only stored on the root processor</span></div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;    <span class="keywordtype">double</span> parameter_residual = result[n_dof_local];</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;    <span class="comment">// Broadcast to all others, if we have a distributed problem</span></div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;    <span class="keywordflow">if</span> (problem_pt-&gt;distributed())</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;    {</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;      MPI_Bcast(&amp;parameter_residual,</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;                1,</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;                MPI_DOUBLE,</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;                0,</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;                problem_pt-&gt;communicator_pt()-&gt;mpi_comm());</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;    }</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;    <span class="comment">// Now construct the value</span></div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../df/df4/namespaceGlobal__parameters.html#ab838699c8a7fd1a106a9db0d53595798">x2</a> = (psi_x1 - parameter_residual) / psi_c;</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160; </div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;    <span class="comment">// Now construct the vectors that multiply the jacobian terms</span></div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;    Vector&lt;DoubleVectorWithHaloEntries&gt; D_and_X1(2);</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;    D_and_X1[0].build(<a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#afcf84124d724d6bd961870fbcdc7b9e4">Linear_solver_pt</a>-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>(), 0.0);</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;    D_and_X1[1].build(<a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#afcf84124d724d6bd961870fbcdc7b9e4">Linear_solver_pt</a>-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>(), 0.0);</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;    <span class="comment">// Fill in the appropriate terms</span></div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;    <span class="comment">// Get the number of local dofs from the Linear_solver_pt distribution</span></div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_dof_local_linear_solver =</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;      <a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#afcf84124d724d6bd961870fbcdc7b9e4">Linear_solver_pt</a>-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>()-&gt;<a class="code" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">nrow_local</a>();</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_dof_local_linear_solver; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;    {</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> C_ = (*C_pt)[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>];</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;      D_and_X1[0][<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>] = (*D_pt)[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>] - Psi * C_;</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;      D_and_X1[1][<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>] = <a class="code" href="../../df/df4/namespaceGlobal__parameters.html#a1017523474a983fa10bc226cfc9beaf9">x1</a>[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>] - <a class="code" href="../../df/df4/namespaceGlobal__parameters.html#ab838699c8a7fd1a106a9db0d53595798">x2</a> * C_;</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;    }</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160; </div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;    <span class="comment">// Local storage for the result of the product terms</span></div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;    Vector&lt;DoubleVectorWithHaloEntries&gt; Jprod_D_and_X1(2);</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160; </div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;    <span class="comment">// Redistribute the inputs to have the Dof distribution pt</span></div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;    D_and_X1[0].redistribute(handler_pt-&gt;Dof_distribution_pt);</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;    D_and_X1[1].redistribute(handler_pt-&gt;Dof_distribution_pt);</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160; </div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;    <span class="comment">// Set up the halo scheme</span></div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;    D_and_X1[0].build_halo_scheme(problem_pt-&gt;Halo_scheme_pt);</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;    D_and_X1[1].build_halo_scheme(problem_pt-&gt;Halo_scheme_pt);</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160; </div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;    <span class="comment">// Get the products from the new problem function</span></div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;    problem_pt-&gt;get_hessian_vector_products(</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;      handler_pt-&gt;Y, D_and_X1, Jprod_D_and_X1);</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160; </div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;    <span class="comment">// OK, now we can formulate the next vectors</span></div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;    <span class="comment">//(again assuming result contains residuals)</span></div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;    <span class="comment">// Need to redistribute F to the dof distribution</span></div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;    <span class="comment">// F.redistribute(handler_pt-&gt;Dof_distribution_pt);</span></div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;    <a class="code" href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a> <a class="code" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>(handler_pt-&gt;Dof_distribution_pt);</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160; </div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_dof_local; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;    {</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;      <a class="code" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>] = result[n_dof_local + offset + <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>] - Jprod_D_and_X1[1][<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>] -</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;             <a class="code" href="../../df/df4/namespaceGlobal__parameters.html#ab838699c8a7fd1a106a9db0d53595798">x2</a> * dRdparam[n_dof_local + offset + <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>];</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;      Jprod_D_and_X1[0][<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>] *= -1.0;</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;      Jprod_D_and_X1[0][<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>] -= Psi * dRdparam[n_dof_local + offset + <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>];</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;    }</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160; </div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160; </div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;    <span class="comment">// Then redistribute back to the linear solver distribution</span></div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;    <a class="code" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>.redistribute(<a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#afcf84124d724d6bd961870fbcdc7b9e4">Linear_solver_pt</a>-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>());</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;    Jprod_D_and_X1[0].redistribute(<a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#afcf84124d724d6bd961870fbcdc7b9e4">Linear_solver_pt</a>-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>());</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;    Jprod_D_and_X1[1].redistribute(<a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#afcf84124d724d6bd961870fbcdc7b9e4">Linear_solver_pt</a>-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>());</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160; </div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;    <span class="comment">// Linear solve to get B</span></div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;    <a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#afcf84124d724d6bd961870fbcdc7b9e4">Linear_solver_pt</a>-&gt;<a class="code" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a3b310d08333033edc119b2a5bd7dcbfb">resolve</a>(Jprod_D_and_X1[0], *<a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a4e88432fbf8e7cdefbfbd2c67860505e">B_pt</a>);</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;    <span class="comment">// Liner solve to get x3</span></div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;    <a class="code" href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a> x3(<a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#afcf84124d724d6bd961870fbcdc7b9e4">Linear_solver_pt</a>-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>(), 0.0);</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;    <a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#afcf84124d724d6bd961870fbcdc7b9e4">Linear_solver_pt</a>-&gt;<a class="code" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a3b310d08333033edc119b2a5bd7dcbfb">resolve</a>(<a class="code" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>, x3);</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160; </div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;    <span class="comment">// Construst a couple of additional products</span></div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;    <span class="keywordtype">double</span> l_x3 = psi.dot(x3);</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;    <span class="keywordtype">double</span> l_b = psi.dot(*<a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a4e88432fbf8e7cdefbfbd2c67860505e">B_pt</a>);</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160; </div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;    <span class="comment">// get the last intermediate variable</span></div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;    <span class="comment">// The required parameter is that corresponding to the dof, which</span></div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;    <span class="comment">// is only stored on the root processor</span></div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;    <span class="keywordtype">double</span> sigma_residual = result[2 * (n_dof_local + offset) - 1];</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;    <span class="comment">// Broadcast to all others, if we have a distributed problem</span></div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;    <span class="keywordflow">if</span> (problem_pt-&gt;distributed())</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;    {</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;      MPI_Bcast(&amp;sigma_residual,</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;                1,</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;                MPI_DOUBLE,</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;                0,</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;                problem_pt-&gt;communicator_pt()-&gt;mpi_comm());</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;    }</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160; </div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160; </div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> delta_sigma = (l_x3 - sigma_residual) / l_b;</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> delta_lambda = <a class="code" href="../../df/df4/namespaceGlobal__parameters.html#ab838699c8a7fd1a106a9db0d53595798">x2</a> - delta_sigma * Psi;</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160; </div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;    <span class="comment">// Need to do some more rearrangements here because result is global</span></div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;    <span class="comment">// but the other vectors are not!</span></div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160; </div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;    <span class="comment">// Create temporary DoubleVectors to hold the results</span></div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;    <a class="code" href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a> res1(<a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#afcf84124d724d6bd961870fbcdc7b9e4">Linear_solver_pt</a>-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>());</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;    <a class="code" href="../../dd/d52/ClumpInput_8h.html#a82f6bc76e1c7a0f51bf3e95ad5d3c590">DoubleVector</a> res2(<a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#afcf84124d724d6bd961870fbcdc7b9e4">Linear_solver_pt</a>-&gt;<a class="code" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">distribution_pt</a>());</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160; </div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_dof_local_linear_solver; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;    {</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;      res1[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>] = <a class="code" href="../../df/df4/namespaceGlobal__parameters.html#a1017523474a983fa10bc226cfc9beaf9">x1</a>[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>] - delta_lambda * (*C_pt)[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>] - delta_sigma * (*D_pt)[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>];</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;      res2[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>] = x3[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>] - delta_sigma * (*B_pt)[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>];</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;    }</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160; </div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;    <span class="comment">// Now redistribute these into the Dof distribution pointer</span></div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;    res1.redistribute(handler_pt-&gt;Dof_distribution_pt);</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;    res2.redistribute(handler_pt-&gt;Dof_distribution_pt);</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160; </div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;    <span class="comment">// Now can copy over into results into the result vector</span></div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = 0; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt; n_dof_local; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>++)</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;    {</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;      result[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>] = res1[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>];</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;      result[n_dof_local + offset + <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>] = res2[<a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>];</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;    }</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160; </div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;    <span class="comment">// Add the final contributions to the residuals</span></div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;    <span class="comment">// only on the root processor if we have a distributed problem</span></div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;    <span class="keywordflow">if</span> ((!problem_pt-&gt;distributed()) || (my_rank == 0))</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;    {</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;      result[n_dof_local] = delta_lambda;</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;      result[2 * n_dof_local + 1] = delta_sigma;</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;    }</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160; </div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160; </div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;    <span class="comment">// The sign of the determinant is given by the sign of</span></div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;    <span class="comment">// the product psi_c and l_b</span></div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;    <span class="comment">// NOT CHECKED YET!</span></div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;    problem_pt-&gt;sign_of_jacobian() =</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;      <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">std::fabs</a>(psi_c * l_b) / (psi_c * l_b));</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160; </div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;    <span class="comment">// Redistribute the result into its incoming distribution</span></div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;    result.redistribute(&amp;result_dist);</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160; </div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;    <span class="comment">// Switch things to our block solver</span></div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;    handler_pt-&gt;solve_full_system();</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160; </div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;    <span class="comment">// If we are not storing things, clear the results</span></div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a5f5e7e7a44ff0897b0e4cd9524000edc">Enable_resolve</a>)</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;    {</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;      <span class="comment">// We no longer need to store the matrix</span></div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;      <a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#afcf84124d724d6bd961870fbcdc7b9e4">Linear_solver_pt</a>-&gt;<a class="code" href="../../d5/dd7/classoomph_1_1LinearSolver.html#ad61c63af94c5961830bd9807225a48d6">disable_resolve</a>();</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;      <span class="keyword">delete</span> <a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a4e88432fbf8e7cdefbfbd2c67860505e">B_pt</a>;</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;      <a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a4e88432fbf8e7cdefbfbd2c67860505e">B_pt</a> = 0;</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;      <span class="keyword">delete</span> <a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#ac9f8e9f84f79437b43e35ae2850ec335">C_pt</a>;</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;      <a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#ac9f8e9f84f79437b43e35ae2850ec335">C_pt</a> = 0;</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;      <span class="keyword">delete</span> <a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a3178ff5ce055b76423b30357022f9e58">D_pt</a>;</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;      <a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a3178ff5ce055b76423b30357022f9e58">D_pt</a> = 0;</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;      <span class="keyword">delete</span> <a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a3ceff96adc374fb588f106cc3cc9b435">dJy_dparam_pt</a>;</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;      <a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a3ceff96adc374fb588f106cc3cc9b435">dJy_dparam_pt</a> = 0;</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;    }</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;    <span class="comment">// Otherwise also store the pointer to the problem</span></div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;    {</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;      <a class="code" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a5819a48984aa1a9a68c28e106bc22f90">Problem_pt</a> = problem_pt;</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;    }</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;  }</div>
<div class="ttc" id="aJacobi__makeGivens_8cpp_html_ad2c49539791450cfceedabc09452d977"><div class="ttname"><a href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a></div><div class="ttdeci">JacobiRotation&lt; float &gt; G</div><div class="ttdef"><b>Definition:</b> Jacobi_makeGivens.cpp:2</div></div>
<div class="ttc" id="aclassoomph_1_1DistributableLinearAlgebraObject_html_ac5340bac40b9559b0378037b57005203"><div class="ttname"><a href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ac5340bac40b9559b0378037b57005203">oomph::DistributableLinearAlgebraObject::build_distribution</a></div><div class="ttdeci">void build_distribution(const LinearAlgebraDistribution *const dist_pt)</div><div class="ttdef"><b>Definition:</b> linear_algebra_distribution.h:507</div></div>
<div class="ttc" id="aclassoomph_1_1LinearSolver_html_a15ce22542b74ed1826ea485edacbeb6e"><div class="ttname"><a href="../../d5/dd7/classoomph_1_1LinearSolver.html#a15ce22542b74ed1826ea485edacbeb6e">oomph::LinearSolver::solve</a></div><div class="ttdeci">virtual void solve(Problem *const &amp;problem_pt, DoubleVector &amp;result)=0</div></div>
<div class="ttc" id="aclassoomph_1_1LinearSolver_html_a5f5e7e7a44ff0897b0e4cd9524000edc"><div class="ttname"><a href="../../d5/dd7/classoomph_1_1LinearSolver.html#a5f5e7e7a44ff0897b0e4cd9524000edc">oomph::LinearSolver::Enable_resolve</a></div><div class="ttdeci">bool Enable_resolve</div><div class="ttdef"><b>Definition:</b> linear_solver.h:73</div></div>
<div class="ttc" id="anamespaceboost_1_1multiprecision_html_ab6f80ccf8e1d88df8a8e3acd039d63eb"><div class="ttname"><a href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">boost::multiprecision::fabs</a></div><div class="ttdeci">Real fabs(const Real &amp;a)</div><div class="ttdef"><b>Definition:</b> boostmultiprec.cpp:117</div></div>
<div class="ttc" id="anamespaceoomph_1_1OcTreeNames_html_a1240bbd25e0b8bffa1171375f1c7183da755807a4724a0f4d96f0817559c0a927"><div class="ttname"><a href="../../da/dee/namespaceoomph_1_1OcTreeNames.html#a1240bbd25e0b8bffa1171375f1c7183da755807a4724a0f4d96f0817559c0a927">oomph::OcTreeNames::F</a></div><div class="ttdeci">@ F</div><div class="ttdef"><b>Definition:</b> octree.h:74</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a381c30a8daede5c95bdda7e2efa24f19">oomph::Problem::assembly_handler_pt()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#af6346c1dc77f3d4fb3dc8950afd91e0f">oomph::PitchForkHandler::Augmented_dof_distribution_pt</a>, <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a4e88432fbf8e7cdefbfbd2c67860505e">B_pt</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#ac5340bac40b9559b0378037b57005203">oomph::DistributableLinearAlgebraObject::build_distribution()</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#aae402d422ec4344a4a45cdb7659b7161">oomph::DoubleVector::built()</a>, <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#ac9f8e9f84f79437b43e35ae2850ec335">C_pt</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">oomph::Problem::communicator_pt()</a>, <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a3178ff5ce055b76423b30357022f9e58">D_pt</a>, <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#ad61c63af94c5961830bd9807225a48d6">oomph::LinearSolver::disable_resolve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#af5e9f1623cad361048856a4c0463ea23">oomph::Problem::distributed()</a>, <a class="el" href="../../df/d1e/classoomph_1_1DistributableLinearAlgebraObject.html#a603105384d60c9a3710378af39f538b9">oomph::DistributableLinearAlgebraObject::distribution_pt()</a>, <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a3ceff96adc374fb588f106cc3cc9b435">dJy_dparam_pt</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a075f47b5f8941d25796f96d258a1752e">oomph::PitchForkHandler::Dof_distribution_pt</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#abd20e2e394c8e08749ed34c7228c8506">oomph::DoubleVector::dot()</a>, <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a5f5e7e7a44ff0897b0e4cd9524000edc">oomph::LinearSolver::Enable_resolve</a>, <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a3000ebd9becb3468d8a6a821a9cc0cd9">oomph::LinearSolver::enable_resolve()</a>, <a class="el" href="../../da/dee/namespaceoomph_1_1OcTreeNames.html#a1240bbd25e0b8bffa1171375f1c7183da755807a4724a0f4d96f0817559c0a927">oomph::OcTreeNames::F</a>, <a class="el" href="../../d2/d0c/namespaceboost_1_1multiprecision.html#ab6f80ccf8e1d88df8a8e3acd039d63eb">boost::multiprecision::fabs()</a>, <a class="el" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#adc456017cfc4fb4ae6f522973e50f496">oomph::Problem::get_derivative_wrt_global_parameter()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a497518acb5d30a28a253890c3d2a5da2">oomph::Problem::get_hessian_vector_products()</a>, <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#afcf84124d724d6bd961870fbcdc7b9e4">Linear_solver_pt</a>, <a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a670b34aab05bfe0b96d0e0fabf583c7a">oomph::OomphCommunicator::my_rank()</a>, <a class="el" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>, <a class="el" href="../../de/dcb/classoomph_1_1LinearAlgebraDistribution.html#ac9310de740f9c3a61f8d5dab9bef88ca">oomph::LinearAlgebraDistribution::nrow_local()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aa0e8800d56e68fcb63ec2315f503cab2">oomph::PitchForkHandler::Parameter_pt</a>, <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a5819a48984aa1a9a68c28e106bc22f90">Problem_pt</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#aa04d0f340d919d4da3f9199eb76649b1">oomph::PitchForkHandler::Psi</a>, <a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html#a9396b861977c16606d8eca39056976c8">oomph::DoubleVector::redistribute()</a>, <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a3b310d08333033edc119b2a5bd7dcbfb">oomph::LinearSolver::resolve()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a797cb28b5fffe976fc7541421eb423a1">oomph::Problem::sign_of_jacobian()</a>, <a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html#a15ce22542b74ed1826ea485edacbeb6e">oomph::LinearSolver::solve()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#ad193c3d67741edd60b023c94e42c8802">oomph::PitchForkHandler::solve_block_system()</a>, <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a27325616f4342d159f6f5e7c82ccdf98">oomph::PitchForkHandler::solve_full_system()</a>, <a class="el" href="../../df/df4/namespaceGlobal__parameters.html#a1017523474a983fa10bc226cfc9beaf9">Global_parameters::x1()</a>, <a class="el" href="../../df/df4/namespaceGlobal__parameters.html#ab838699c8a7fd1a106a9db0d53595798">Global_parameters::x2()</a>, and <a class="el" href="../../d1/d08/classoomph_1_1PitchForkHandler.html#a289ce15584734b8ea50cd9a7f7f430ed">oomph::PitchForkHandler::Y</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a4e88432fbf8e7cdefbfbd2c67860505e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e88432fbf8e7cdefbfbd2c67860505e">&#9670;&nbsp;</a></span>B_pt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a>* oomph::BlockPitchForkLinearSolver::B_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pointer to the storage for the vector b. </p>

<p class="reference">Referenced by <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a9a424fd2ae0b67ef8c3ff59f16030786">resolve()</a>, <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#ad196867613954a8fabd318b50e2aadc6">solve()</a>, and <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a3fa97815fefc83c678341222847797ea">~BlockPitchForkLinearSolver()</a>.</p>

</div>
</div>
<a id="ac9f8e9f84f79437b43e35ae2850ec335"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9f8e9f84f79437b43e35ae2850ec335">&#9670;&nbsp;</a></span>C_pt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a>* oomph::BlockPitchForkLinearSolver::C_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pointer to the storage for the vector c. </p>

<p class="reference">Referenced by <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a9a424fd2ae0b67ef8c3ff59f16030786">resolve()</a>, <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#ad196867613954a8fabd318b50e2aadc6">solve()</a>, and <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a3fa97815fefc83c678341222847797ea">~BlockPitchForkLinearSolver()</a>.</p>

</div>
</div>
<a id="a3178ff5ce055b76423b30357022f9e58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3178ff5ce055b76423b30357022f9e58">&#9670;&nbsp;</a></span>D_pt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a>* oomph::BlockPitchForkLinearSolver::D_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pointer to the storage for the vector d. </p>

<p class="reference">Referenced by <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a9a424fd2ae0b67ef8c3ff59f16030786">resolve()</a>, <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#ad196867613954a8fabd318b50e2aadc6">solve()</a>, and <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a3fa97815fefc83c678341222847797ea">~BlockPitchForkLinearSolver()</a>.</p>

</div>
</div>
<a id="a3ceff96adc374fb588f106cc3cc9b435"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ceff96adc374fb588f106cc3cc9b435">&#9670;&nbsp;</a></span>dJy_dparam_pt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d6/d5b/classoomph_1_1DoubleVector.html">DoubleVector</a>* oomph::BlockPitchForkLinearSolver::dJy_dparam_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Pointer to the storage for the vector of derivatives with respect to the bifurcation parameter </p>

<p class="reference">Referenced by <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#ad196867613954a8fabd318b50e2aadc6">solve()</a>, and <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a3fa97815fefc83c678341222847797ea">~BlockPitchForkLinearSolver()</a>.</p>

</div>
</div>
<a id="afcf84124d724d6bd961870fbcdc7b9e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afcf84124d724d6bd961870fbcdc7b9e4">&#9670;&nbsp;</a></span>Linear_solver_pt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d5/dd7/classoomph_1_1LinearSolver.html">LinearSolver</a>* oomph::BlockPitchForkLinearSolver::Linear_solver_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pointer to the original linear solver. </p>

<p class="reference">Referenced by <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a38efead8e84202a3232b4a3624a2986c">linear_solver_pt()</a>, <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a9a424fd2ae0b67ef8c3ff59f16030786">resolve()</a>, and <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#ad196867613954a8fabd318b50e2aadc6">solve()</a>.</p>

</div>
</div>
<a id="a5819a48984aa1a9a68c28e106bc22f90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5819a48984aa1a9a68c28e106bc22f90">&#9670;&nbsp;</a></span>Problem_pt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a>* oomph::BlockPitchForkLinearSolver::Problem_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pointer to the problem, used in the resolve. </p>

<p class="reference">Referenced by <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#a9a424fd2ae0b67ef8c3ff59f16030786">resolve()</a>, and <a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html#ad196867613954a8fabd318b50e2aadc6">solve()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="../../d3/d3a/assembly__handler_8h_source.html">assembly_handler.h</a></li>
<li><a class="el" href="../../da/da3/assembly__handler_8cc.html">assembly_handler.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../da/ddf/namespaceoomph.html">oomph</a></li><li class="navelem"><a class="el" href="../../d2/d71/classoomph_1_1BlockPitchForkLinearSolver.html">BlockPitchForkLinearSolver</a></li>
    <li class="footer">Generated on Wed Aug 27 2025 17:09:00 for MercuryDPM by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
