<!-- HTML header for doxygen 1.8.18-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MercuryDPM: oomph::Multi_domain_functions Namespace Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../MDPM.css" rel="stylesheet" type="text/css"/>
<link href="../../codeLabels.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-fork-corner.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-dropdown-version.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../MDPM-fragment-copy-button.js"></script>
<script type="text/javascript">
DoxygenAwesomeFragmentCopyButton.init()
</script>
<script type="text/javascript" src="../../MDPM-paragraph-link.js"></script>
<script type="text/javascript">
DoxygenAwesomeParagraphLink.init()
</script>
<script type="text/javascript" src="../../MDPM-interactive-toc.js"></script>
<script type="text/javascript">
DoxygenAwesomeInteractiveToc.init()
</script>
<script type="text/javascript" src="../../MDPM-darkmode-toggle.js"></script>
<script type="text/javascript">
DoxygenAwesomeDarkModeToggle.init()
</script>
</head>
<body>
  <div id="bitbucket-corner">
   <a href="https://bitbucket.org/mercurydpm/mercurydpm/src/master/" target="_blank" id="fork-corner" class="fork-corner fc-pos-tr fc-animate fc-theme-bitbucket"></a>
  </div>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../mercury-logo-chosen-light-slogan.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"> <!--MercuryDPM--!>
   <!-- BEGIN version select -->
   <div class="dropdown" id="projectnumber">
    <button class="dropbtn">v1.0</button>
    <div class="dropdown-content">
    </div>
   </div>
   <script type="text/javascript" src="../../MDPM-dropdown-version.js"></script>
<!-- END version select -->
   <!--&#160;<span id="projectnumber">revision: v1.0</span>-->
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<script type="text/javascript" src="../../MDPM-fork-corner.js"></script>
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d3/d65/namespaceoomph_1_1Multi__domain__functions.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">oomph::Multi_domain_functions Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:aafe5662afb76aa08960480bfe712d7af"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#aafe5662afb76aa08960480bfe712d7afa4effe7dd231a015f6e120c3f2d4fdd55">New</a>
, <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#aafe5662afb76aa08960480bfe712d7afae79558bf4c6d5520127c346350aa1ecd">Exists</a>
, <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#aafe5662afb76aa08960480bfe712d7afabf3c04eff4fec3f0659fac92a035aed9">Not_found</a>
 }</td></tr>
<tr class="memdesc:aafe5662afb76aa08960480bfe712d7af"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enumerators for element status in location procedure.  <a href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#aafe5662afb76aa08960480bfe712d7af">More...</a><br /></td></tr>
<tr class="separator:aafe5662afb76aa08960480bfe712d7af"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a969b893c0f6f013c78076e4013c0f34c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a969b893c0f6f013c78076e4013c0f34c">locate_zeta_for_local_coordinates</a> (const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> * &gt; &amp;mesh_pt, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;external_mesh_pt, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../da/db4/classoomph_1_1MeshAsGeomObject.html">MeshAsGeomObject</a> * &gt; &amp;mesh_geom_obj_pt, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;interaction_index)</td></tr>
<tr class="separator:a969b893c0f6f013c78076e4013c0f34c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81f7a581bfb6abfcce009546b80b9898"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a81f7a581bfb6abfcce009546b80b9898">get_dim_helper</a> (<a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *problem_pt, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;mesh_pt, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;external_mesh_pt)</td></tr>
<tr class="separator:a81f7a581bfb6abfcce009546b80b9898"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45a7960bff85287284bea3939dcda5c2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a45a7960bff85287284bea3939dcda5c2">clean_up</a> ()</td></tr>
<tr class="separator:a45a7960bff85287284bea3939dcda5c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9baf8c647dbd10164c28f12cbb04f85"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#ad9baf8c647dbd10164c28f12cbb04f85">first_closer_than_second</a> (const std::pair&lt; <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html">FiniteElement</a> *, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt;&gt; &amp;<a class="el" href="../../db/d01/MatrixBase__all_8cpp.html#acdff45bcf8497bafe04b93e4e704c57b">p1</a>, const std::pair&lt; <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html">FiniteElement</a> *, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt;&gt; &amp;p2)</td></tr>
<tr class="separator:ad9baf8c647dbd10164c28f12cbb04f85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35d48459a5261d565afbc106cb61fe60"><td class="memTemplParams" colspan="2">template&lt;class BULK_ELEMENT , unsigned DIM&gt; </td></tr>
<tr class="memitem:a35d48459a5261d565afbc106cb61fe60"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a35d48459a5261d565afbc106cb61fe60">setup_bulk_elements_adjacent_to_face_mesh</a> (<a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *problem_pt, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;boundary_in_bulk_mesh, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;bulk_mesh_pt, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> * &gt; &amp;face_mesh_pt, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;interaction=0)</td></tr>
<tr class="memdesc:a35d48459a5261d565afbc106cb61fe60"><td class="mdescLeft">&#160;</td><td class="mdescRight">/ Templated helper functions for multi-domain methods using locate_zeta  <a href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a35d48459a5261d565afbc106cb61fe60">More...</a><br /></td></tr>
<tr class="separator:a35d48459a5261d565afbc106cb61fe60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcfac96ed755990c71f35b722bacbde7"><td class="memTemplParams" colspan="2">template&lt;class BULK_ELEMENT , unsigned DIM&gt; </td></tr>
<tr class="memitem:adcfac96ed755990c71f35b722bacbde7"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#adcfac96ed755990c71f35b722bacbde7">setup_bulk_elements_adjacent_to_face_mesh</a> (<a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *problem_pt, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;boundary_in_bulk_mesh, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;bulk_mesh_pt, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;face_mesh_pt, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;interaction=0)</td></tr>
<tr class="separator:adcfac96ed755990c71f35b722bacbde7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a7ac2c45985582b30ed3ecb5d2623d2"><td class="memTemplParams" colspan="2">template&lt;class ELEMENT_0 , class ELEMENT_1 &gt; </td></tr>
<tr class="memitem:a4a7ac2c45985582b30ed3ecb5d2623d2"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a4a7ac2c45985582b30ed3ecb5d2623d2">setup_multi_domain_interactions</a> (<a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *problem_pt, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;first_mesh_pt, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;second_mesh_pt, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;first_interaction=0, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;second_interaction=0)</td></tr>
<tr class="separator:a4a7ac2c45985582b30ed3ecb5d2623d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac64183e03f173c69ed6ed6f493a1a67e"><td class="memTemplParams" colspan="2">template&lt;class EXT_ELEMENT &gt; </td></tr>
<tr class="memitem:ac64183e03f173c69ed6ed6f493a1a67e"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#ac64183e03f173c69ed6ed6f493a1a67e">setup_multi_domain_interaction</a> (<a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *problem_pt, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;mesh_pt, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;external_mesh_pt, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;interaction_index=0)</td></tr>
<tr class="separator:ac64183e03f173c69ed6ed6f493a1a67e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fb45ad7165cc546b5e34e01a53478d8"><td class="memTemplParams" colspan="2">template&lt;class EXT_ELEMENT , class FACE_ELEMENT_GEOM_OBJECT &gt; </td></tr>
<tr class="memitem:a5fb45ad7165cc546b5e34e01a53478d8"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a5fb45ad7165cc546b5e34e01a53478d8">setup_multi_domain_interaction</a> (<a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *problem_pt, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;mesh_pt, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;external_mesh_pt, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;external_face_mesh_pt, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;interaction_index=0)</td></tr>
<tr class="separator:a5fb45ad7165cc546b5e34e01a53478d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7dbd6a7da9a8988ea4c58163da52883"><td class="memTemplParams" colspan="2">template&lt;class EXT_ELEMENT , class FACE_ELEMENT_GEOM_OBJECT &gt; </td></tr>
<tr class="memitem:ae7dbd6a7da9a8988ea4c58163da52883"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#ae7dbd6a7da9a8988ea4c58163da52883">setup_multi_domain_interaction</a> (<a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *problem_pt, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> * &gt; &amp;mesh_pt, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;external_mesh_pt, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> * &gt; &amp;external_face_mesh_pt, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;interaction_index=0)</td></tr>
<tr class="separator:ae7dbd6a7da9a8988ea4c58163da52883"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae63441bb68e6512082f1248c65f6208d"><td class="memTemplParams" colspan="2">template&lt;class EXT_ELEMENT , class GEOM_OBJECT &gt; </td></tr>
<tr class="memitem:ae63441bb68e6512082f1248c65f6208d"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#ae63441bb68e6512082f1248c65f6208d">aux_setup_multi_domain_interaction</a> (<a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *problem_pt, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;mesh_pt, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;external_mesh_pt, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;interaction_index, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;external_face_mesh_pt=0)</td></tr>
<tr class="memdesc:ae63441bb68e6512082f1248c65f6208d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Auxiliary helper function.  <a href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#ae63441bb68e6512082f1248c65f6208d">More...</a><br /></td></tr>
<tr class="separator:ae63441bb68e6512082f1248c65f6208d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af84f07f5b4632433203f4c4abf57da5f"><td class="memTemplParams" colspan="2">template&lt;class EXT_ELEMENT , class GEOM_OBJECT &gt; </td></tr>
<tr class="memitem:af84f07f5b4632433203f4c4abf57da5f"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#af84f07f5b4632433203f4c4abf57da5f">aux_setup_multi_domain_interaction</a> (<a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *problem_pt, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> * &gt; &amp;mesh_pt, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;external_mesh_pt, const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;interaction_index, const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> * &gt; &amp;external_face_mesh_pt)</td></tr>
<tr class="memdesc:af84f07f5b4632433203f4c4abf57da5f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Auxiliary helper function.  <a href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#af84f07f5b4632433203f4c4abf57da5f">More...</a><br /></td></tr>
<tr class="separator:af84f07f5b4632433203f4c4abf57da5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a87a54c04fcc68b716adf10ca29a1f449"><td class="memItemLeft" align="right" valign="top">std::ofstream&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a87a54c04fcc68b716adf10ca29a1f449">Doc_boundary_coordinate_file</a></td></tr>
<tr class="separator:a87a54c04fcc68b716adf10ca29a1f449"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4e0a3d3191c370209c6a7830a0dc368"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#af4e0a3d3191c370209c6a7830a0dc368">Accept_failed_locate_zeta_in_setup_multi_domain_interaction</a> = false</td></tr>
<tr class="separator:af4e0a3d3191c370209c6a7830a0dc368"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27cbb5ec7f6fea2f237c11659ffeef58"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a27cbb5ec7f6fea2f237c11659ffeef58">Dim</a></td></tr>
<tr class="separator:a27cbb5ec7f6fea2f237c11659ffeef58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2325d66c90ff388dfd6b2649a48e9827"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a2325d66c90ff388dfd6b2649a48e9827">External_element_located</a></td></tr>
<tr class="separator:a2325d66c90ff388dfd6b2649a48e9827"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a880374b0f685eeddca0c70b5a5d40a85"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a880374b0f685eeddca0c70b5a5d40a85">Flat_packed_zetas_not_found_locally</a></td></tr>
<tr class="separator:a880374b0f685eeddca0c70b5a5d40a85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5bb8d568feb34660caf8f88928f3be7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#aa5bb8d568feb34660caf8f88928f3be7">Received_flat_packed_zetas_to_be_found</a></td></tr>
<tr class="separator:aa5bb8d568feb34660caf8f88928f3be7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05cf6413be5c69ff7535ebf0b8a153e3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a05cf6413be5c69ff7535ebf0b8a153e3">Proc_id_plus_one_of_external_element</a></td></tr>
<tr class="separator:a05cf6413be5c69ff7535ebf0b8a153e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6f22430d0d0df252be95eeda5c03151"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#ae6f22430d0d0df252be95eeda5c03151">Located_element_status</a></td></tr>
<tr class="separator:ae6f22430d0d0df252be95eeda5c03151"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a095771257db01cdebaaf92facc3057a3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a095771257db01cdebaaf92facc3057a3">Flat_packed_located_coordinates</a></td></tr>
<tr class="separator:a095771257db01cdebaaf92facc3057a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fa0a4a4e31700e161441b19f88c4bf3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a2fa0a4a4e31700e161441b19f88c4bf3">Flat_packed_doubles</a></td></tr>
<tr class="separator:a2fa0a4a4e31700e161441b19f88c4bf3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb7431547acc61e750fcc456a25ffc13"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#aeb7431547acc61e750fcc456a25ffc13">Counter_for_flat_packed_doubles</a></td></tr>
<tr class="separator:aeb7431547acc61e750fcc456a25ffc13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5748b2389912d36f8f05cb175105c0a3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a5748b2389912d36f8f05cb175105c0a3">Flat_packed_unsigneds</a></td></tr>
<tr class="separator:a5748b2389912d36f8f05cb175105c0a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20f6de2e1bd15cb40c461d2ca3940bd7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a20f6de2e1bd15cb40c461d2ca3940bd7">Counter_for_flat_packed_unsigneds</a></td></tr>
<tr class="separator:a20f6de2e1bd15cb40c461d2ca3940bd7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc1119753cf68493ba6ea43c2a8bc378"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#abc1119753cf68493ba6ea43c2a8bc378">Use_bulk_element_as_external</a> = false</td></tr>
<tr class="separator:abc1119753cf68493ba6ea43c2a8bc378"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3b57b233a416885018e8993db0b291c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#aa3b57b233a416885018e8993db0b291c">Allow_use_of_halo_elements_as_external_elements</a> = true</td></tr>
<tr class="separator:aa3b57b233a416885018e8993db0b291c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa45f040b8ffc6448777fae76190d308c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#aa45f040b8ffc6448777fae76190d308c">Allow_use_of_halo_elements_as_external_elements_for_projection</a> = true</td></tr>
<tr class="separator:aa45f040b8ffc6448777fae76190d308c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64dc4667540a9a2591b00635dea88423"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a64dc4667540a9a2591b00635dea88423">Doc_timings</a> = false</td></tr>
<tr class="memdesc:a64dc4667540a9a2591b00635dea88423"><td class="mdescLeft">&#160;</td><td class="mdescRight">Boolean to indicate whether to doc timings or not.  <a href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a64dc4667540a9a2591b00635dea88423">More...</a><br /></td></tr>
<tr class="separator:a64dc4667540a9a2591b00635dea88423"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa490ae6349c68dc3c5b40f6a4a40e718"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#aa490ae6349c68dc3c5b40f6a4a40e718">Doc_stats</a> = false</td></tr>
<tr class="separator:aa490ae6349c68dc3c5b40f6a4a40e718"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5969c7c730e13e9d5a2c268f3045203"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#aa5969c7c730e13e9d5a2c268f3045203">Doc_full_stats</a> = false</td></tr>
<tr class="separator:aa5969c7c730e13e9d5a2c268f3045203"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f14db731fddbd057f4099fbdba95cc0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a5f14db731fddbd057f4099fbdba95cc0">Zeta_coords_for_further_away_comparison</a></td></tr>
<tr class="separator:a5f14db731fddbd057f4099fbdba95cc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="aafe5662afb76aa08960480bfe712d7af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aafe5662afb76aa08960480bfe712d7af">&#9670;&nbsp;</a></span>anonymous enum</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enumerators for element status in location procedure. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="aafe5662afb76aa08960480bfe712d7afa4effe7dd231a015f6e120c3f2d4fdd55"></a>New&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aafe5662afb76aa08960480bfe712d7afae79558bf4c6d5520127c346350aa1ecd"></a>Exists&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aafe5662afb76aa08960480bfe712d7afabf3c04eff4fec3f0659fac92a035aed9"></a>Not_found&#160;</td><td class="fielddoc"></td></tr>
</table>
<div class="fragment"><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#aafe5662afb76aa08960480bfe712d7afa4effe7dd231a015f6e120c3f2d4fdd55">New</a>,</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#aafe5662afb76aa08960480bfe712d7afae79558bf4c6d5520127c346350aa1ecd">Exists</a>,</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#aafe5662afb76aa08960480bfe712d7afabf3c04eff4fec3f0659fac92a035aed9">Not_found</a></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    };</div>
<div class="ttc" id="anamespaceoomph_1_1Multi__domain__functions_html_aafe5662afb76aa08960480bfe712d7afa4effe7dd231a015f6e120c3f2d4fdd55"><div class="ttname"><a href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#aafe5662afb76aa08960480bfe712d7afa4effe7dd231a015f6e120c3f2d4fdd55">oomph::Multi_domain_functions::New</a></div><div class="ttdeci">@ New</div><div class="ttdef"><b>Definition:</b> multi_domain.h:149</div></div>
<div class="ttc" id="anamespaceoomph_1_1Multi__domain__functions_html_aafe5662afb76aa08960480bfe712d7afabf3c04eff4fec3f0659fac92a035aed9"><div class="ttname"><a href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#aafe5662afb76aa08960480bfe712d7afabf3c04eff4fec3f0659fac92a035aed9">oomph::Multi_domain_functions::Not_found</a></div><div class="ttdeci">@ Not_found</div><div class="ttdef"><b>Definition:</b> multi_domain.h:151</div></div>
<div class="ttc" id="anamespaceoomph_1_1Multi__domain__functions_html_aafe5662afb76aa08960480bfe712d7afae79558bf4c6d5520127c346350aa1ecd"><div class="ttname"><a href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#aafe5662afb76aa08960480bfe712d7afae79558bf4c6d5520127c346350aa1ecd">oomph::Multi_domain_functions::Exists</a></div><div class="ttdeci">@ Exists</div><div class="ttdef"><b>Definition:</b> multi_domain.h:150</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="af84f07f5b4632433203f4c4abf57da5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af84f07f5b4632433203f4c4abf57da5f">&#9670;&nbsp;</a></span>aux_setup_multi_domain_interaction() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class EXT_ELEMENT , class GEOM_OBJECT &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Multi_domain_functions::aux_setup_multi_domain_interaction </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *&#160;</td>
          <td class="paramname"><em>problem_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>mesh_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;&#160;</td>
          <td class="paramname"><em>external_mesh_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>interaction_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>external_face_mesh_pt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Auxiliary helper function. </p>
<p>This routine calls the locate_zeta routine (simultaneously on each processor for each individual processor's element set if necessary) and sets up the external (halo) element and node storage as necessary. The locate_zeta procedure here works for all multi-domain problems where either two meshes occupy the same physical space but have differing element types (e.g. a Boussinesq convection problem where AdvectionDiffusion elements interact with Navier-Stokes type elements) or two meshes interact along some boundary of the external mesh, represented by a "face mesh", such as an FSI problem.</p>
<p>Vector-based version operates simultaneously on the meshes contained in the vectors. </p>
<p>If it's is now zero then break out of the spirals loop</p>
<div class="fragment"><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  {</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="comment">// How many meshes do we have?</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="keywordtype">unsigned</span> n_mesh = mesh_pt.size();</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160; </div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="keywordflow">if</span> (external_face_mesh_pt.size() != n_mesh)</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    {</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;      std::ostringstream error_stream;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;      error_stream &lt;&lt; <span class="stringliteral">&quot;Sizes of external_face_mesh_pt [ &quot;</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                   &lt;&lt; external_face_mesh_pt.size() &lt;&lt; <span class="stringliteral">&quot; ] and &quot;</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;mesh_pt [ &quot;</span> &lt;&lt; n_mesh &lt;&lt; <span class="stringliteral">&quot; ] don&#39;t match.\n&quot;</span>;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    }</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160; </div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="comment">// Bail out?</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="keywordflow">if</span> (n_mesh == 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160; </div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;      <span class="comment">// Multi-domain setup will not work for elements with</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;      <span class="comment">// nonuniformly spaced nodes</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;      <span class="comment">// Must check type of elements in the mesh and in the external mesh</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;      <span class="comment">//(assume element type is the same for all elements in each mesh)</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160; </div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160; </div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="comment">// Pointer to first element in external mesh</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    GeneralisedElement* ext_el_pt_0 = 0;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="keywordflow">if</span> (external_mesh_pt-&gt;nelement() != 0)</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    {</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      ext_el_pt_0 = external_mesh_pt-&gt;element_pt(0);</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    }</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160; </div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="comment">// Loop over all meshes</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i_mesh = 0; i_mesh &lt; n_mesh; i_mesh++)</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    {</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;      <span class="comment">// Get pointer to first element in each mesh</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;      GeneralisedElement* el_pt_0 = 0;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;      <span class="keywordflow">if</span> (mesh_pt[i_mesh]-&gt;nelement() != 0)</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;      {</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        el_pt_0 = mesh_pt[i_mesh]-&gt;element_pt(0);</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;      }</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160; </div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;      <span class="comment">// Check they are not spectral elements</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">dynamic_cast&lt;</span>SpectralElement*<span class="keyword">&gt;</span>(el_pt_0) != 0 ||</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;          <span class="keyword">dynamic_cast&lt;</span>SpectralElement*<span class="keyword">&gt;</span>(ext_el_pt_0) != 0)</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;      {</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;          <span class="stringliteral">&quot;Multi-domain setup does not work with spectral elements.&quot;</span>,</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;      }</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160; </div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      <span class="comment">// Check they are not hp-refineable elements</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">dynamic_cast&lt;</span>PRefineableElement*<span class="keyword">&gt;</span>(el_pt_0) != 0 ||</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;          <span class="keyword">dynamic_cast&lt;</span>PRefineableElement*<span class="keyword">&gt;</span>(ext_el_pt_0) != 0)</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;      {</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;          <span class="stringliteral">&quot;Multi-domain setup does not work with hp-refineable elements.&quot;</span>,</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;          <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;      }</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    } <span class="comment">// end over initial loop over meshes</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160; </div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160; </div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160; </div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <span class="comment">// Storage for number of processors and my rank</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <span class="keywordtype">int</span> n_proc = problem_pt-&gt;communicator_pt()-&gt;nproc();</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="keywordtype">int</span> my_rank = problem_pt-&gt;communicator_pt()-&gt;my_rank();</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160; </div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="comment">// Timing</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <span class="keywordtype">double</span> t_start = 0.0;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <span class="keywordtype">double</span> t_end = 0.0;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <span class="keywordtype">double</span> t_local = 0.0;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="keywordtype">double</span> t_set = 0.0;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <span class="keywordtype">double</span> t_locate = 0.0;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <span class="keywordtype">double</span> t_spiral_start = 0.0;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <span class="keywordtype">double</span> t_loop_start = 0.0;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    <span class="keywordtype">double</span> t_sendrecv = 0.0;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="keywordtype">double</span> t_missing = 0.0;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    <span class="keywordtype">double</span> t_send_info = 0.0;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <span class="keywordtype">double</span> t_create_halo = 0.0;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160; </div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d4/d29/namespaceoomph_1_1Missing__masters__functions.html#acd9cae489a6217b1566a1e40cbca86cf">Doc_timings</a>)</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    {</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;      t_start = <a class="code" href="../../d9/dd8/oomph__metis__from__parmetis__3_81_81_2struct_8h.html#aae821c36bb7e6918e1414484f939c3d4">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    }</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160; </div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <span class="comment">// Initialize number of zeta coordinates not found yet</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <span class="keywordtype">unsigned</span> n_zeta_not_found = 0;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160; </div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <span class="comment">// Geometric objects used to represent the external (face) meshes</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    Vector&lt;MeshAsGeomObject*&gt; mesh_geom_obj_pt(n_mesh, 0);</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160; </div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160; </div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <span class="comment">// Initialise lagrangian dimension of element (test only)</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <span class="keywordtype">unsigned</span> el_dim_lag = 0;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160; </div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160; </div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <span class="comment">// Create mesh as geom objects for all meshes</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i_mesh = 0; i_mesh &lt; n_mesh; i_mesh++)</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    {</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;      <span class="comment">// Are bulk elements used as external elements?</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#abc1119753cf68493ba6ea43c2a8bc378">Use_bulk_element_as_external</a>)</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;      {</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        <span class="comment">// Fix this when required</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        <span class="keywordflow">if</span> (n_mesh != 1)</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        {</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;          std::ostringstream error_stream;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;          error_stream</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;Sorry I currently can&#39;t deal with non-bulk external elements\n&quot;</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;in multi-domain setup for multiple meshes.\n&quot;</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;The functionality should be easy to implement now that you\n&quot;</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;have a test case. If you&#39;re not willinig to do this, call\n&quot;</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;the multi-domain setup mesh-by-mesh instead (though this can\n&quot;</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;be costly in parallel because of global comms. \n&quot;</span>;</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;          <span class="keywordflow">throw</span> OomphLibError(error_stream.str(),</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                              <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                              <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        }</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160; </div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        <span class="comment">// Set the geometric object from the external mesh</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        mesh_geom_obj_pt[0] = <span class="keyword">new</span> MeshAsGeomObject(external_mesh_pt);</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;      }</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;      {</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        <span class="comment">// Set the geometric object from the external face mesh argument</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        mesh_geom_obj_pt[i_mesh] =</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;          <span class="keyword">new</span> MeshAsGeomObject(external_face_mesh_pt[i_mesh]);</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;      }</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160; </div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;      <span class="keywordtype">unsigned</span> old_el_dim_lag = el_dim_lag;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160; </div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;      <span class="comment">// Set lagrangian dimension of element</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;      el_dim_lag = mesh_geom_obj_pt[i_mesh]-&gt;nlagrangian();</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160; </div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;      <span class="comment">// Check consistency</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;      <span class="keywordflow">if</span> (i_mesh &gt; 0)</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;      {</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        <span class="keywordflow">if</span> (el_dim_lag != old_el_dim_lag)</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        {</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;          std::ostringstream error_stream;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;          error_stream &lt;&lt; <span class="stringliteral">&quot;Lagrangian dimensions of elements don&#39;t match \n &quot;</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot;between meshes: &quot;</span> &lt;&lt; el_dim_lag &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                       &lt;&lt; old_el_dim_lag &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;          <span class="keywordflow">throw</span> OomphLibError(error_stream.str(),</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                              <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                              <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        }</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;      }</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160; </div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160; </div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    } <span class="comment">// end of loop over meshes</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160; </div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <span class="keywordtype">double</span> t_setup_lookups = 0.0;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d4/d29/namespaceoomph_1_1Missing__masters__functions.html#acd9cae489a6217b1566a1e40cbca86cf">Doc_timings</a>)</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    {</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;      t_set = <a class="code" href="../../d9/dd8/oomph__metis__from__parmetis__3_81_81_2struct_8h.html#aae821c36bb7e6918e1414484f939c3d4">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;CPU for creation of MeshAsGeomObjects and bin structure: &quot;</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                 &lt;&lt; t_set - t_start &lt;&lt; std::endl;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;      t_setup_lookups = <a class="code" href="../../d9/dd8/oomph__metis__from__parmetis__3_81_81_2struct_8h.html#aae821c36bb7e6918e1414484f939c3d4">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    }</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160; </div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="comment">// Total number of integration points</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <span class="keywordtype">unsigned</span> tot_int = 0;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160; </div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <span class="comment">// Counter for total number of elements (in flat packed order)</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <span class="keywordtype">unsigned</span> e_count = 0;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160; </div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <span class="comment">// Loop over all meshes to get total number of elements</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i_mesh = 0; i_mesh &lt; n_mesh; i_mesh++)</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    {</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;      e_count += mesh_pt[i_mesh]-&gt;nelement();</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    }</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a2325d66c90ff388dfd6b2649a48e9827">External_element_located</a>.resize(e_count);</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160; </div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="comment">// Reset counter for elements in flat packed storage</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    e_count = 0;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160; </div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <span class="comment">// Loop over all meshes</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i_mesh = 0; i_mesh &lt; n_mesh; i_mesh++)</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    {</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;      <span class="comment">// Loop over (this processor&#39;s) elements and set lookup array</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;      <span class="keywordtype">unsigned</span> n_element = mesh_pt[i_mesh]-&gt;nelement();</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; n_element; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;      {</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        <span class="comment">// Zero-sized vector means its a halo</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a2325d66c90ff388dfd6b2649a48e9827">External_element_located</a>[e_count].resize(0);</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        ElementWithExternalElement* el_pt =</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;          <span class="keyword">dynamic_cast&lt;</span>ElementWithExternalElement*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;            mesh_pt[i_mesh]-&gt;element_pt(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>));</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160; </div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        <span class="comment">// We&#39;re not setting up external elements for halo elements</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;        <span class="keywordflow">if</span> (!el_pt-&gt;is_halo())</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;#endif</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;        {</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;          <span class="comment">// We need to allocate storage for the external elements</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;          <span class="comment">// within the element. Memory will actually only be</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;          <span class="comment">// allocated the first time this function is called for</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;          <span class="comment">// each element, or if the number of interactions or integration</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;          <span class="comment">// points within the element has changed.</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;          el_pt-&gt;initialise_external_element_storage();</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160; </div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;          <span class="comment">// Clear any previous allocation</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;          <span class="keywordtype">unsigned</span> n_intpt = el_pt-&gt;integral_pt()-&gt;nweight();</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ipt = 0; ipt &lt; n_intpt; ipt++)</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;          {</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;            el_pt-&gt;external_element_pt(interaction_index, ipt) = 0;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;          }</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160; </div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;          <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a2325d66c90ff388dfd6b2649a48e9827">External_element_located</a>[e_count].resize(n_intpt);</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ipt = 0; ipt &lt; n_intpt; ipt++)</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;          {</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;            <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a2325d66c90ff388dfd6b2649a48e9827">External_element_located</a>[e_count][ipt] = 0;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;            tot_int++;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;          }</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        }</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        <span class="comment">// next element</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        e_count++;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;      }</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    } <span class="comment">// end of loop over meshes</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160; </div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d4/d29/namespaceoomph_1_1Missing__masters__functions.html#acd9cae489a6217b1566a1e40cbca86cf">Doc_timings</a>)</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    {</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="../../dd/ddd/namespaceplotPSD.html#a112f38a9c28b7e27fed13fb3ebf10362">t</a> = <a class="code" href="../../d9/dd8/oomph__metis__from__parmetis__3_81_81_2struct_8h.html#aae821c36bb7e6918e1414484f939c3d4">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;CPU for setup of lookup schemes for located elements/coords: &quot;</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;        &lt;&lt; <a class="code" href="../../dd/ddd/namespaceplotPSD.html#a112f38a9c28b7e27fed13fb3ebf10362">t</a> - t_setup_lookups &lt;&lt; std::endl;</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    }</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160; </div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    <span class="comment">// Initialise maximum spiral level within the cartesian bin structure</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    <span class="comment">// Used to terminate spiraling for non-refineable bin</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    <span class="keywordtype">unsigned</span> n_max_level = 0;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160; </div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    <span class="keywordtype">unsigned</span> max_level_reached = 1;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160; </div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    <span class="comment">// Max. number of sample points -- used to decide on termination of</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    <span class="comment">// &quot;spiraling&quot;</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    <span class="keywordtype">unsigned</span> max_n_sample_points_of_sample_point_containers = 0;</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160; </div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    <span class="comment">// Loop over all meshes</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i_mesh = 0; i_mesh &lt; n_mesh; i_mesh++)</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    {</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;      <span class="keywordflow">if</span> (mesh_geom_obj_pt[i_mesh]-&gt;sample_point_container_version() ==</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#a8c0fdc9bd9751811cd49fe6f06c55991a6bd4eede6af4e6e7881a96e4dc0e34cd">UseRefineableBinArray</a>)</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;      {</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        <a class="code" href="../../d6/d1a/classRefineableBinArray.html">RefineableBinArray</a>* bin_array_pt = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../d6/d1a/classRefineableBinArray.html">RefineableBinArray</a>*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;          mesh_geom_obj_pt[i_mesh]-&gt;sample_point_container_pt());</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160; </div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;        bin_array_pt</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;          -&gt;<a class="code" href="../../d6/d1a/classRefineableBinArray.html#ad8dd347e3f9cd98555ebc96f9c968807">last_sample_point_to_actually_lookup_during_locate_zeta</a>() =</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;          bin_array_pt</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;            -&gt;<a class="code" href="../../d6/d1a/classRefineableBinArray.html#a517b1704286e6ee44b771af5348a6854">initial_last_sample_point_to_actually_lookup_during_locate_zeta</a>();</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        bin_array_pt</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;          -&gt;<a class="code" href="../../d6/d1a/classRefineableBinArray.html#aade552fd473125fd624222672c90a3d5">first_sample_point_to_actually_lookup_during_locate_zeta</a>() = 0;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160; </div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;        <span class="keywordtype">unsigned</span> nsp =</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;          bin_array_pt-&gt;<a class="code" href="../../d6/d1a/classRefineableBinArray.html#a267d58bd06dafc53aff7b42927500a8b">total_number_of_sample_points_computed_recursively</a>();</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        <span class="keywordflow">if</span> (nsp &gt; max_n_sample_points_of_sample_point_containers)</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        {</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;          max_n_sample_points_of_sample_point_containers = nsp;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        }</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160; </div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160; </div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;        <span class="comment">// If the mesh has been distributed we want the max. number</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        <span class="comment">// of sample points across all processors</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        <span class="keywordflow">if</span> (problem_pt-&gt;communicator_pt()-&gt;nproc() &gt; 1)</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;        {</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;          <span class="keywordtype">unsigned</span> local_max_n_sample_points_of_sample_point_containers =</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;            max_n_sample_points_of_sample_point_containers;</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160; </div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;          <span class="comment">// Get  maximum over all processors</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;          MPI_Allreduce(&amp;local_max_n_sample_points_of_sample_point_containers,</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                        &amp;max_n_sample_points_of_sample_point_containers,</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                        1,</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                        MPI_UNSIGNED,</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                        MPI_MAX,</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                        problem_pt-&gt;communicator_pt()-&gt;mpi_comm());</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        }</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;      }</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mesh_geom_obj_pt[i_mesh]-&gt;sample_point_container_version() ==</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;               <a class="code" href="../../da/ddf/namespaceoomph.html#a8c0fdc9bd9751811cd49fe6f06c55991ae9f4b2ff7655b9f053dd855d15d929af">UseNonRefineableBinArray</a>)</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;      {</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;        <a class="code" href="../../d0/d82/classNonRefineableBinArray.html">NonRefineableBinArray</a>* bin_array_pt =</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;          <span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../d0/d82/classNonRefineableBinArray.html">NonRefineableBinArray</a>*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;            mesh_geom_obj_pt[i_mesh]-&gt;sample_point_container_pt());</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160; </div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;        <span class="comment">// Initialise spiral levels</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        bin_array_pt-&gt;<a class="code" href="../../d0/d82/classNonRefineableBinArray.html#ae014f4db4cfc34a36e913a91a44ea66a">current_min_spiral_level</a>() = 0;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        bin_array_pt-&gt;<a class="code" href="../../d0/d82/classNonRefineableBinArray.html#ac3f611d0535d74a65834b4ec9c81a8ca">current_max_spiral_level</a>() =</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;          bin_array_pt-&gt;<a class="code" href="../../d0/d82/classNonRefineableBinArray.html#a0ece8aca5700546a90d9a48cd932f3e6">n_spiral_chunk</a>() - 1;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160; </div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        <span class="comment">// Find maximum spiral level within the cartesian bin structure</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        n_max_level = bin_array_pt-&gt;<a class="code" href="../../dd/db0/classBinArray.html#a1bd867e26195feb7ae95a8e77acadca8">max_bin_dimension</a>();</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160; </div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        <span class="comment">// Limit it</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;        <span class="keywordflow">if</span> (bin_array_pt-&gt;<a class="code" href="../../d0/d82/classNonRefineableBinArray.html#ac3f611d0535d74a65834b4ec9c81a8ca">current_max_spiral_level</a>() &gt; n_max_level)</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;        {</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;          bin_array_pt-&gt;<a class="code" href="../../d0/d82/classNonRefineableBinArray.html#ac3f611d0535d74a65834b4ec9c81a8ca">current_max_spiral_level</a>() = n_max_level - 1;</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        }</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;      }</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_CGAL</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;      <span class="comment">// CGAL</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mesh_geom_obj_pt[i_mesh]-&gt;sample_point_container_version() ==</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;               UseCGALSamplePointContainer)</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;      {</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;        CGALSamplePointContainer* bin_array_pt =</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;          <span class="keyword">dynamic_cast&lt;</span>CGALSamplePointContainer*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;            mesh_geom_obj_pt[i_mesh]-&gt;sample_point_container_pt());</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;        bin_array_pt</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;          -&gt;last_sample_point_to_actually_lookup_during_locate_zeta() =</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;          bin_array_pt</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;            -&gt;initial_last_sample_point_to_actually_lookup_during_locate_zeta();</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        bin_array_pt</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;          -&gt;first_sample_point_to_actually_lookup_during_locate_zeta() = 0;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160; </div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;        <span class="keywordtype">unsigned</span> nsp =</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;          bin_array_pt-&gt;total_number_of_sample_points_computed_recursively();</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;        <span class="keywordflow">if</span> (nsp &gt; max_n_sample_points_of_sample_point_containers)</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;        {</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;          max_n_sample_points_of_sample_point_containers = nsp;</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        }</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160; </div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160; </div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        <span class="comment">// If the mesh has been distributed we want the max. number</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        <span class="comment">// of sample points across all processors</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;        <span class="keywordflow">if</span> (problem_pt-&gt;communicator_pt()-&gt;nproc() &gt; 1)</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        {</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;          <span class="keywordtype">unsigned</span> local_max_n_sample_points_of_sample_point_containers =</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;            max_n_sample_points_of_sample_point_containers;</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160; </div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;          <span class="comment">// Get  maximum over all processors</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;          MPI_Allreduce(&amp;local_max_n_sample_points_of_sample_point_containers,</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                        &amp;max_n_sample_points_of_sample_point_containers,</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                        1,</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                        MPI_UNSIGNED,</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                        MPI_MAX,</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;                        problem_pt-&gt;communicator_pt()-&gt;mpi_comm());</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        }</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;      }</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// cgal</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    }</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160; </div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160; </div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    <span class="comment">// Storage for info about coordinate location</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    Vector&lt;double&gt; percentage_coords_located_locally;</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    Vector&lt;double&gt; percentage_coords_located_elsewhere;</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160; </div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    <span class="comment">// Loop over &quot;spirals/levels&quot; away from the current position</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    <span class="comment">// Note: All meshes go through their spirals simultaneously;</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    <span class="comment">// read out spiral level from first one</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    <span class="keywordtype">unsigned</span> i_level = 0;</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    <span class="keywordtype">bool</span> has_not_reached_max_level_of_search = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    <span class="keywordflow">while</span> (has_not_reached_max_level_of_search)</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    {</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;      <span class="comment">// Record time at start of spiral loop</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d4/d29/namespaceoomph_1_1Missing__masters__functions.html#acd9cae489a6217b1566a1e40cbca86cf">Doc_timings</a>)</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;      {</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;        t_spiral_start = <a class="code" href="../../d9/dd8/oomph__metis__from__parmetis__3_81_81_2struct_8h.html#aae821c36bb7e6918e1414484f939c3d4">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;      }</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160; </div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;      <span class="comment">// Perform locate_zeta locally first! This looks locally for</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;      <span class="comment">// all not-yet-located zetas within the current spiral range.</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;      <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a969b893c0f6f013c78076e4013c0f34c">locate_zeta_for_local_coordinates</a>(</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        mesh_pt, external_mesh_pt, mesh_geom_obj_pt, interaction_index);</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160; </div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;      <span class="comment">// Store stats about successful locates for reporting later</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d4/d29/namespaceoomph_1_1Missing__masters__functions.html#a86ac04bf0028ba6e66c07466cc9774ce">Doc_stats</a>)</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;      {</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        <span class="keywordtype">unsigned</span> count_locates = 0;</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;        <span class="keywordtype">unsigned</span> n_ext_loc = <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a2325d66c90ff388dfd6b2649a48e9827">External_element_located</a>.size();</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; n_ext_loc; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;        {</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;          <span class="keywordtype">unsigned</span> n_intpt = <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a2325d66c90ff388dfd6b2649a48e9827">External_element_located</a>[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>].size();</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ipt = 0; ipt &lt; n_intpt; ipt++)</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;          {</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;            count_locates += <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a2325d66c90ff388dfd6b2649a48e9827">External_element_located</a>[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>][ipt];</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;          }</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;        }</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160; </div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;        <span class="comment">// Store percentage of integration points successfully located.</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;        <span class="comment">// Only assign if we had anything to allocte, otherwise 100%</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        <span class="comment">// (default assignment; see above) is correct</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        <span class="keywordflow">if</span> (tot_int != 0)</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;        {</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;          percentage_coords_located_locally.push_back(</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;            100.0 * <span class="keywordtype">double</span>(count_locates) / <span class="keywordtype">double</span>(tot_int));</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;        }</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;        {</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;          <span class="comment">// Had none to find so we found them all!</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;          percentage_coords_located_locally.push_back(100.0);</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;        }</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;      }</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160; </div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160; </div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;      <span class="comment">// Now test whether anything needs to be broadcast elsewhere</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;      <span class="comment">// (i.e. were there any failures in the locate method above?)</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;      <span class="comment">// If there are, then the zetas for these failures need to be</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;      <span class="comment">// broadcast...</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160; </div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;      <span class="comment">// How many zetas have we failed to find? [Note: Array is padded</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;      <span class="comment">// by Dim padded entries (DBL_MAX) for each mesh]</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;      n_zeta_not_found =</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;        <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a880374b0f685eeddca0c70b5a5d40a85">Flat_packed_zetas_not_found_locally</a>.size() - <a class="code" href="../../d7/d6f/namespaceGlobal__Variables.html#ac750eefd4d11ad9255000de7791c635a">Dim</a> * n_mesh;</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160; </div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d4/d29/namespaceoomph_1_1Missing__masters__functions.html#acd9cae489a6217b1566a1e40cbca86cf">Doc_timings</a>)</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;      {</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;        t_local = <a class="code" href="../../d9/dd8/oomph__metis__from__parmetis__3_81_81_2struct_8h.html#aae821c36bb7e6918e1414484f939c3d4">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;CPU for local location of zeta coordinate [spiral level &quot;</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;                   &lt;&lt; i_level &lt;&lt; <span class="stringliteral">&quot;]: &quot;</span> &lt;&lt; t_local - t_spiral_start &lt;&lt; std::endl</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;Number of missing zetas: &quot;</span> &lt;&lt; n_zeta_not_found</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                   &lt;&lt; std::endl;</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;      }</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160; </div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160; </div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;      <span class="comment">// Only perform the reduction operation if there&#39;s more than one process</span></div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;      <span class="keywordflow">if</span> (problem_pt-&gt;communicator_pt()-&gt;nproc() &gt; 1)</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;      {</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;        <span class="keywordtype">unsigned</span> count_local_zetas = n_zeta_not_found;</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        MPI_Allreduce(&amp;count_local_zetas,</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;                      &amp;n_zeta_not_found,</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;                      1,</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;                      MPI_UNSIGNED,</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;                      MPI_SUM,</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                      problem_pt-&gt;communicator_pt()-&gt;mpi_comm());</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;      }</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160; </div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;      <span class="comment">// If we have missing zetas on any process</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;      <span class="comment">// and the problem is distributed, we need to locate elsewhere</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;      <span class="keywordflow">if</span> ((n_zeta_not_found != 0) &amp;&amp;</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;          (problem_pt-&gt;problem_has_been_distributed()))</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;      {</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;        <span class="comment">// Timings</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        <span class="keywordtype">double</span> t_sendrecv_min = DBL_MAX;</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;        <span class="keywordtype">double</span> t_sendrecv_max = -DBL_MAX;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        <span class="keywordtype">double</span> t_sendrecv_tot = 0.0;</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160; </div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;        <span class="keywordtype">double</span> t_missing_min = DBL_MAX;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;        <span class="keywordtype">double</span> t_missing_max = -DBL_MAX;</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;        <span class="keywordtype">double</span> t_missing_tot = 0.0;</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160; </div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        <span class="keywordtype">double</span> t_send_info_min = DBL_MAX;</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        <span class="keywordtype">double</span> t_send_info_max = -DBL_MAX;</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        <span class="keywordtype">double</span> t_send_info_tot = 0.0;</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160; </div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;        <span class="keywordtype">double</span> t_create_halo_min = DBL_MAX;</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;        <span class="keywordtype">double</span> t_create_halo_max = -DBL_MAX;</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;        <span class="keywordtype">double</span> t_create_halo_tot = 0.0;</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160; </div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;        <span class="comment">// Start ring communication: Loop (number of processes - 1)</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;        <span class="comment">// starting from 1. The variable iproc represents the &quot;distance&quot; from</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;        <span class="comment">// the current process to the process for which it is attempting</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;        <span class="comment">// to locate an element for the current set of not-yet-located</span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;        <span class="comment">// zeta coordinates</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        <span class="keywordtype">unsigned</span> ring_count = 0;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iproc = 1; iproc &lt; n_proc; iproc++)</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;        {</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;          <span class="comment">// Record time at start of loop</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d4/d29/namespaceoomph_1_1Missing__masters__functions.html#acd9cae489a6217b1566a1e40cbca86cf">Doc_timings</a>)</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;          {</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;            t_loop_start = <a class="code" href="../../d9/dd8/oomph__metis__from__parmetis__3_81_81_2struct_8h.html#aae821c36bb7e6918e1414484f939c3d4">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;          }</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160; </div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;          <span class="comment">// Send the zeta values you haven&#39;t found to the</span></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;          <span class="comment">// next process, receive from the previous process:</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;          <span class="comment">// (Padded) Flat_packed_zetas_not_found_locally are sent</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;          <span class="comment">// to next processor where they are received as</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;          <span class="comment">// (padded) Received_flat_packed_zetas_to_be_found.</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;          send_and_receive_missing_zetas(problem_pt);</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160; </div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d4/d29/namespaceoomph_1_1Missing__masters__functions.html#acd9cae489a6217b1566a1e40cbca86cf">Doc_timings</a>)</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;          {</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;            ring_count++;</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;            t_sendrecv = <a class="code" href="../../d9/dd8/oomph__metis__from__parmetis__3_81_81_2struct_8h.html#aae821c36bb7e6918e1414484f939c3d4">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;            t_sendrecv_max =</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;              <a class="code" href="../../dc/d51/datatypes_8h.html#affe776513b24d84b39af8ab0930fef7f">std::max</a>(t_sendrecv_max, t_sendrecv - t_loop_start);</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;            t_sendrecv_min =</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;              <a class="code" href="../../dc/d51/datatypes_8h.html#ac6afabdc09a49a433ee19d8a9486056d">std::min</a>(t_sendrecv_min, t_sendrecv - t_loop_start);</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;            t_sendrecv_tot += (t_sendrecv - t_loop_start);</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;          }</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160; </div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;          <span class="comment">// Perform the locate_zeta for the new set of zetas on this process</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;          locate_zeta_for_missing_coordinates(</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;            iproc, external_mesh_pt, problem_pt, mesh_geom_obj_pt);</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160; </div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d4/d29/namespaceoomph_1_1Missing__masters__functions.html#acd9cae489a6217b1566a1e40cbca86cf">Doc_timings</a>)</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;          {</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;            t_missing = <a class="code" href="../../d9/dd8/oomph__metis__from__parmetis__3_81_81_2struct_8h.html#aae821c36bb7e6918e1414484f939c3d4">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;            t_missing_max = <a class="code" href="../../dc/d51/datatypes_8h.html#affe776513b24d84b39af8ab0930fef7f">std::max</a>(t_missing_max, t_missing - t_sendrecv);</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;            t_missing_min = <a class="code" href="../../dc/d51/datatypes_8h.html#ac6afabdc09a49a433ee19d8a9486056d">std::min</a>(t_missing_min, t_missing - t_sendrecv);</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;            t_missing_tot += (t_missing - t_sendrecv);</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;          }</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160; </div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;          <span class="comment">// Send any located coordinates back to the correct process, and</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;          <span class="comment">// prepare to send on to the next process if necessary</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;          send_and_receive_located_info(iproc, external_mesh_pt, problem_pt);</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160; </div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d4/d29/namespaceoomph_1_1Missing__masters__functions.html#acd9cae489a6217b1566a1e40cbca86cf">Doc_timings</a>)</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;          {</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;            t_send_info = <a class="code" href="../../d9/dd8/oomph__metis__from__parmetis__3_81_81_2struct_8h.html#aae821c36bb7e6918e1414484f939c3d4">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;            t_send_info_max =</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;              <a class="code" href="../../dc/d51/datatypes_8h.html#affe776513b24d84b39af8ab0930fef7f">std::max</a>(t_send_info_max, t_send_info - t_missing);</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;            t_send_info_min =</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;              <a class="code" href="../../dc/d51/datatypes_8h.html#ac6afabdc09a49a433ee19d8a9486056d">std::min</a>(t_send_info_min, t_send_info - t_missing);</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;            t_send_info_tot += (t_send_info - t_missing);</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;          }</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160; </div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;          <span class="comment">// Create any located external halo elements on the current process</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;          create_external_halo_elements&lt;EXT_ELEMENT&gt;(</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;            iproc, mesh_pt, external_mesh_pt, problem_pt, interaction_index);</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160; </div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d4/d29/namespaceoomph_1_1Missing__masters__functions.html#acd9cae489a6217b1566a1e40cbca86cf">Doc_timings</a>)</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;          {</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;            t_create_halo = <a class="code" href="../../d9/dd8/oomph__metis__from__parmetis__3_81_81_2struct_8h.html#aae821c36bb7e6918e1414484f939c3d4">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;            t_create_halo_max =</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;              <a class="code" href="../../dc/d51/datatypes_8h.html#affe776513b24d84b39af8ab0930fef7f">std::max</a>(t_create_halo_max, t_create_halo - t_send_info);</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;            t_create_halo_min =</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;              <a class="code" href="../../dc/d51/datatypes_8h.html#ac6afabdc09a49a433ee19d8a9486056d">std::min</a>(t_create_halo_min, t_create_halo - t_send_info);</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;            t_create_halo_tot += (t_create_halo - t_send_info);</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;          }</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160; </div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;          <span class="comment">// Do we have any further locating to do or have we found</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;          <span class="comment">// everything at this level of the ring communication?</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;          <span class="comment">// Only perform the reduction operation if there&#39;s more than</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;          <span class="comment">// one process [Note: Array is padded</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;          <span class="comment">// by DIM times DBL_MAX entries for each mesh]</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;          n_zeta_not_found =</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;            <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a880374b0f685eeddca0c70b5a5d40a85">Flat_packed_zetas_not_found_locally</a>.size() - <a class="code" href="../../d7/d6f/namespaceGlobal__Variables.html#ac750eefd4d11ad9255000de7791c635a">Dim</a> * n_mesh;</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160; </div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160; </div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;          <span class="keywordflow">if</span> (problem_pt-&gt;communicator_pt()-&gt;nproc() &gt; 1)</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;          {</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;            <span class="keywordtype">unsigned</span> count_local_zetas = n_zeta_not_found;</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;            MPI_Allreduce(&amp;count_local_zetas,</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;                          &amp;n_zeta_not_found,</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;                          1,</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;                          MPI_UNSIGNED,</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                          MPI_SUM,</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;                          problem_pt-&gt;communicator_pt()-&gt;mpi_comm());</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;          }</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160; </div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;          <span class="comment">// If  its is now zero then break out of the ring comms loop</span></div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;          <span class="keywordflow">if</span> (n_zeta_not_found == 0)</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;          {</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d4/d29/namespaceoomph_1_1Missing__masters__functions.html#acd9cae489a6217b1566a1e40cbca86cf">Doc_timings</a>)</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;            {</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;              t_local = <a class="code" href="../../d9/dd8/oomph__metis__from__parmetis__3_81_81_2struct_8h.html#aae821c36bb7e6918e1414484f939c3d4">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;              <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;BREAK N-1: CPU for entrire spiral [spiral level &quot;</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;                         &lt;&lt; i_level &lt;&lt; <span class="stringliteral">&quot;]: &quot;</span> &lt;&lt; t_local - t_spiral_start</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;                         &lt;&lt; std::endl;</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;            }</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;          }</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;        }</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160; </div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160; </div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;        <span class="comment">// Doc timings</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d4/d29/namespaceoomph_1_1Missing__masters__functions.html#acd9cae489a6217b1566a1e40cbca86cf">Doc_timings</a>)</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;        {</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Ring-based search continued until iteration &quot;</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;                     &lt;&lt; ring_count &lt;&lt; <span class="stringliteral">&quot; out of a maximum of &quot;</span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;                     &lt;&lt; problem_pt-&gt;communicator_pt()-&gt;nproc() - 1 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Total, av, max, min CPU for send/recv of remaining &quot;</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;                        <span class="stringliteral">&quot;zeta coordinates: &quot;</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;                     &lt;&lt; t_sendrecv_tot &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;                     &lt;&lt; t_sendrecv_tot / <a class="code" href="../../df/de6/classdouble.html">double</a>(ring_count) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;                     &lt;&lt; t_sendrecv_max &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; t_sendrecv_min &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Total, av, max, min CPU for location of missing zeta &quot;</span></div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;                        <span class="stringliteral">&quot;coordinates   : &quot;</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;                     &lt;&lt; t_missing_tot &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;                     &lt;&lt; t_missing_tot / <a class="code" href="../../df/de6/classdouble.html">double</a>(ring_count) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;                     &lt;&lt; t_missing_max &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; t_missing_min &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Total, av, max, min CPU for send/recv of new element &quot;</span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;                        <span class="stringliteral">&quot;info          : &quot;</span></div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;                     &lt;&lt; t_send_info_tot &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;                     &lt;&lt; t_send_info_tot / <a class="code" href="../../df/de6/classdouble.html">double</a>(ring_count) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;                     &lt;&lt; t_send_info_max &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; t_send_info_min &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;Total, av, max, min CPU for local creation of &quot;</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;                        <span class="stringliteral">&quot;external halo objects: &quot;</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;                     &lt;&lt; t_create_halo_tot &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;                     &lt;&lt; t_create_halo_tot / <a class="code" href="../../df/de6/classdouble.html">double</a>(ring_count) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;                     &lt;&lt; t_create_halo_max &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; t_create_halo_min &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;        }</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160; </div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;      } <span class="comment">// end if for missing zetas on any process</span></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160; </div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160; </div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;      <span class="comment">// Store information about location of elements for integration points</span></div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d4/d29/namespaceoomph_1_1Missing__masters__functions.html#a86ac04bf0028ba6e66c07466cc9774ce">Doc_stats</a>)</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;      {</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;        <span class="keywordtype">unsigned</span> count_locates = 0;</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;        <span class="keywordtype">unsigned</span> n_ext_loc = <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a2325d66c90ff388dfd6b2649a48e9827">External_element_located</a>.size();</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; n_ext_loc; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;        {</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;          <span class="keywordtype">unsigned</span> n_intpt = <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a2325d66c90ff388dfd6b2649a48e9827">External_element_located</a>[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>].size();</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ipt = 0; ipt &lt; n_intpt; ipt++)</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;          {</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;            count_locates += <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a2325d66c90ff388dfd6b2649a48e9827">External_element_located</a>[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>][ipt];</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;          }</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;        }</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160; </div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160; </div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;        <span class="comment">// Store total percentage of locates so far.</span></div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;        <span class="comment">// Only assign if we had anything to allocte, otherwise 100%</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;        <span class="comment">// (default assignment) is correct</span></div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;        <span class="keywordflow">if</span> (tot_int != 0)</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;        {</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;          percentage_coords_located_elsewhere.push_back(</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;            100.0 * <span class="keywordtype">double</span>(count_locates) / <span class="keywordtype">double</span>(tot_int));</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;        }</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;        {</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;          <span class="comment">// Had none to find so we found them all!</span></div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;          percentage_coords_located_locally.push_back(100.0);</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;        }</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;      }</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160; </div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;      <span class="comment">// Do we have any further locating to do? If so, the remaining</span></div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;      <span class="comment">// zetas will (hopefully) be found at the next spiral level.</span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;      <span class="comment">// Only perform the reduction operation if there&#39;s more than one process</span></div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;      <span class="comment">// [Note: Array is padded</span></div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;      <span class="comment">// by DIM times DBL_MAX entries for each mesh]</span></div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;      n_zeta_not_found =</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;        <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a880374b0f685eeddca0c70b5a5d40a85">Flat_packed_zetas_not_found_locally</a>.size() - <a class="code" href="../../d7/d6f/namespaceGlobal__Variables.html#ac750eefd4d11ad9255000de7791c635a">Dim</a> * n_mesh;</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160; </div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160; </div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;      <span class="keywordflow">if</span> (problem_pt-&gt;communicator_pt()-&gt;nproc() &gt; 1)</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;      {</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;        <span class="keywordtype">unsigned</span> count_local_zetas = n_zeta_not_found;</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;        MPI_Allreduce(&amp;count_local_zetas,</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;                      &amp;n_zeta_not_found,</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;                      1,</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;                      MPI_UNSIGNED,</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;                      MPI_SUM,</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;                      problem_pt-&gt;communicator_pt()-&gt;mpi_comm());</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;      }</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160; </div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;      <span class="comment">// Specify max level reached for later loop</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;      max_level_reached = i_level + 1;</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160; </div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;      <span class="keywordflow">if</span> (n_zeta_not_found == 0)</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;      {</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d4/d29/namespaceoomph_1_1Missing__masters__functions.html#acd9cae489a6217b1566a1e40cbca86cf">Doc_timings</a>)</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;        {</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;          t_local = <a class="code" href="../../d9/dd8/oomph__metis__from__parmetis__3_81_81_2struct_8h.html#aae821c36bb7e6918e1414484f939c3d4">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;BREAK N: CPU for entrire spiral [spiral level &quot;</span></div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;                     &lt;&lt; i_level &lt;&lt; <span class="stringliteral">&quot;]: &quot;</span> &lt;&lt; t_local - t_spiral_start</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;                     &lt;&lt; std::endl;</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;        }</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;      }</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160; </div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d4/d29/namespaceoomph_1_1Missing__masters__functions.html#acd9cae489a6217b1566a1e40cbca86cf">Doc_timings</a>)</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;      {</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;        t_local = <a class="code" href="../../d9/dd8/oomph__metis__from__parmetis__3_81_81_2struct_8h.html#aae821c36bb7e6918e1414484f939c3d4">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;CPU for entrire spiral [spiral level &quot;</span> &lt;&lt; i_level</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;]: &quot;</span> &lt;&lt; t_local - t_spiral_start &lt;&lt; std::endl;</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;      }</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160; </div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;      <span class="comment">// Bump up spiral levels for all meshes</span></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;      i_level++;</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i_mesh = 0; i_mesh &lt; n_mesh; i_mesh++)</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;      {</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;        <span class="keywordflow">if</span> (mesh_geom_obj_pt[i_mesh]-&gt;sample_point_container_version() ==</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;            <a class="code" href="../../da/ddf/namespaceoomph.html#a8c0fdc9bd9751811cd49fe6f06c55991a6bd4eede6af4e6e7881a96e4dc0e34cd">UseRefineableBinArray</a>)</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;        {</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;          <a class="code" href="../../d6/d1a/classRefineableBinArray.html">RefineableBinArray</a>* bin_array_pt = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../d6/d1a/classRefineableBinArray.html">RefineableBinArray</a>*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;            mesh_geom_obj_pt[i_mesh]-&gt;sample_point_container_pt());</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;          bin_array_pt</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;            -&gt;<a class="code" href="../../d6/d1a/classRefineableBinArray.html#aade552fd473125fd624222672c90a3d5">first_sample_point_to_actually_lookup_during_locate_zeta</a>() =</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;            bin_array_pt</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;              -&gt;<a class="code" href="../../d6/d1a/classRefineableBinArray.html#ad8dd347e3f9cd98555ebc96f9c968807">last_sample_point_to_actually_lookup_during_locate_zeta</a>();</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;          bin_array_pt</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;            -&gt;<a class="code" href="../../d6/d1a/classRefineableBinArray.html#ad8dd347e3f9cd98555ebc96f9c968807">last_sample_point_to_actually_lookup_during_locate_zeta</a>() *=</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;            bin_array_pt</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;              -&gt;<a class="code" href="../../d6/d1a/classRefineableBinArray.html#ae5dc08202a4716df1b2138f3dce84e85">multiplier_for_max_sample_point_to_actually_lookup_during_locate_zeta</a>();</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;        }</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mesh_geom_obj_pt[i_mesh]-&gt;sample_point_container_version() ==</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;                 <a class="code" href="../../da/ddf/namespaceoomph.html#a8c0fdc9bd9751811cd49fe6f06c55991ae9f4b2ff7655b9f053dd855d15d929af">UseNonRefineableBinArray</a>)</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;        {</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;          <a class="code" href="../../d0/d82/classNonRefineableBinArray.html">NonRefineableBinArray</a>* bin_array_pt =</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;            <span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../d0/d82/classNonRefineableBinArray.html">NonRefineableBinArray</a>*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;              mesh_geom_obj_pt[i_mesh]-&gt;sample_point_container_pt());</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160; </div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;          bin_array_pt-&gt;<a class="code" href="../../d0/d82/classNonRefineableBinArray.html#ae014f4db4cfc34a36e913a91a44ea66a">current_min_spiral_level</a>() +=</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;            bin_array_pt-&gt;<a class="code" href="../../d0/d82/classNonRefineableBinArray.html#a0ece8aca5700546a90d9a48cd932f3e6">n_spiral_chunk</a>();</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;          bin_array_pt-&gt;<a class="code" href="../../d0/d82/classNonRefineableBinArray.html#ac3f611d0535d74a65834b4ec9c81a8ca">current_max_spiral_level</a>() +=</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;            bin_array_pt-&gt;<a class="code" href="../../d0/d82/classNonRefineableBinArray.html#a0ece8aca5700546a90d9a48cd932f3e6">n_spiral_chunk</a>();</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;        }</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_CGAL</span></div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mesh_geom_obj_pt[i_mesh]-&gt;sample_point_container_version() ==</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;                 UseCGALSamplePointContainer)</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;        {</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;          CGALSamplePointContainer* bin_array_pt =</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;            <span class="keyword">dynamic_cast&lt;</span>CGALSamplePointContainer*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;              mesh_geom_obj_pt[i_mesh]-&gt;sample_point_container_pt());</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;          bin_array_pt</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;            -&gt;first_sample_point_to_actually_lookup_during_locate_zeta() =</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;            bin_array_pt</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;              -&gt;last_sample_point_to_actually_lookup_during_locate_zeta();</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;          bin_array_pt</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;            -&gt;last_sample_point_to_actually_lookup_during_locate_zeta() *=</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;            bin_array_pt</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;              -&gt;multiplier_for_max_sample_point_to_actually_lookup_during_locate_zeta();</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;        }</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// cgal</span></div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;      }</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160; </div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;      <span class="comment">// Check termination criterion for while loop</span></div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;      <span class="keywordflow">if</span> (mesh_geom_obj_pt[0]-&gt;sample_point_container_version() ==</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#a8c0fdc9bd9751811cd49fe6f06c55991a6bd4eede6af4e6e7881a96e4dc0e34cd">UseRefineableBinArray</a>)</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;      {</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;        <a class="code" href="../../d6/d1a/classRefineableBinArray.html">RefineableBinArray</a>* bin_array_pt = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../d6/d1a/classRefineableBinArray.html">RefineableBinArray</a>*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;          mesh_geom_obj_pt[0]-&gt;sample_point_container_pt());</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160; </div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;        <span class="keywordflow">if</span> (bin_array_pt</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;              -&gt;first_sample_point_to_actually_lookup_during_locate_zeta() &lt;=</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;            max_n_sample_points_of_sample_point_containers)</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;        {</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;          has_not_reached_max_level_of_search = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;        }</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;        {</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;          has_not_reached_max_level_of_search = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;        }</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;      }</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mesh_geom_obj_pt[0]-&gt;sample_point_container_version() ==</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;               <a class="code" href="../../da/ddf/namespaceoomph.html#a8c0fdc9bd9751811cd49fe6f06c55991ae9f4b2ff7655b9f053dd855d15d929af">UseNonRefineableBinArray</a>)</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;      {</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;        <a class="code" href="../../d0/d82/classNonRefineableBinArray.html">NonRefineableBinArray</a>* bin_array_pt =</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;          <span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../d0/d82/classNonRefineableBinArray.html">NonRefineableBinArray</a>*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;            mesh_geom_obj_pt[0]-&gt;sample_point_container_pt());</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160; </div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;        <span class="keywordflow">if</span> (bin_array_pt-&gt;<a class="code" href="../../d0/d82/classNonRefineableBinArray.html#ac3f611d0535d74a65834b4ec9c81a8ca">current_max_spiral_level</a>() &lt; n_max_level)</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;        {</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;          has_not_reached_max_level_of_search = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;        }</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;        {</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;          has_not_reached_max_level_of_search = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;        }</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;      }</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_CGAL</span></div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mesh_geom_obj_pt[0]-&gt;sample_point_container_version() ==</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;               UseCGALSamplePointContainer)</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;      {</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;        CGALSamplePointContainer* bin_array_pt =</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;          <span class="keyword">dynamic_cast&lt;</span>CGALSamplePointContainer*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;            mesh_geom_obj_pt[0]-&gt;sample_point_container_pt());</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160; </div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;        <span class="keywordflow">if</span> (bin_array_pt</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;              -&gt;first_sample_point_to_actually_lookup_during_locate_zeta() &lt;=</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;            max_n_sample_points_of_sample_point_containers)</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;        {</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;          has_not_reached_max_level_of_search = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;        }</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;        {</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;          has_not_reached_max_level_of_search = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;        }</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;      }</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// cgal</span></div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    } <span class="comment">// end of &quot;spirals&quot; loop</span></div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160; </div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160; </div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;    <span class="comment">// If we haven&#39;t found all zetas we&#39;re dead now...</span></div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    <span class="comment">//-------------------------------------------------</span></div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    <span class="keywordflow">if</span> (n_zeta_not_found != 0)</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    {</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;      <span class="comment">// Shout?</span></div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#af4e0a3d3191c370209c6a7830a0dc368">Accept_failed_locate_zeta_in_setup_multi_domain_interaction</a>)</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;      {</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;        std::ostringstream error_stream;</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;        error_stream</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;Multi_domain_functions::locate_zeta_for_local_coordinates()&quot;</span></div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;\nhas failed &quot;</span>;</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160; </div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;        <span class="keywordflow">if</span> (problem_pt-&gt;communicator_pt()-&gt;nproc() &gt; 1)</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;        {</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;          error_stream &lt;&lt; <span class="stringliteral">&quot; on proc: &quot;</span></div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;                       &lt;&lt; problem_pt-&gt;communicator_pt()-&gt;my_rank() &lt;&lt; std::endl;</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;        }</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;        error_stream</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;\n\n\nThis is most likely to arise because the two meshes\n&quot;</span></div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;that are to be matched don&#39;t overlap perfectly or\n&quot;</span></div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;because the elements are distorted and too small a \n&quot;</span></div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;number of sampling points has been used when setting\n&quot;</span></div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;up the bin structure.\n\n&quot;</span></div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;You should try to increase the value of \n&quot;</span></div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;the number of sample points defined in \n\n&quot;</span></div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;  &quot;</span></div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;             <span class="stringliteral">&quot;SamplePointContainerParameters::Default_nsample_points_generated_&quot;</span></div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;             <span class="stringliteral">&quot;per_element&quot;</span></div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;\n\n from its current value of &quot;</span></div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;          &lt;&lt; SamplePointContainerParameters::</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;               Default_nsample_points_generated_per_element</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span></div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;NOTE: You can suppress this error and \&quot;accept failure\&quot;&quot;</span></div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;      by setting the public boolean \n\n&quot;</span></div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;        &quot;</span></div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;             <span class="stringliteral">&quot;Multi_domain_functions::Accept_failed_locate_zeta_in_setup_multi_&quot;</span></div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;             <span class="stringliteral">&quot;domain_interaction\n\n&quot;</span></div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;      to true. In this case, the pointers to external elements\n&quot;</span></div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;      that couldn&#39;t be located will remain null\n&quot;</span>;</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160; </div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;        std::ostringstream modifier;</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;        <span class="keywordflow">if</span> (problem_pt-&gt;communicator_pt()-&gt;nproc() &gt; 1)</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;        {</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;          modifier &lt;&lt; <span class="stringliteral">&quot;_proc&quot;</span> &lt;&lt; problem_pt-&gt;communicator_pt()-&gt;my_rank();</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;        }</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160; </div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;        <span class="comment">// Loop over all meshes</span></div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i_mesh = 0; i_mesh &lt; n_mesh; i_mesh++)</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;        {</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;          <span class="comment">// Add yet another modifier to distinguish meshes if reqd</span></div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;          <span class="keywordflow">if</span> (n_mesh &gt; 1)</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;          {</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;            modifier &lt;&lt; <span class="stringliteral">&quot;_mesh&quot;</span> &lt;&lt; i_mesh;</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;          }</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160; </div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;          std::ofstream outfile;</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;          <span class="keywordtype">char</span> <a class="code" href="../../d5/db2/namespaceMergeRestartFiles.html#a210231ed06d822ca8be83bd7f75aa572">filename</a>[100];</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;          sprintf(</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;            <a class="code" href="../../d5/db2/namespaceMergeRestartFiles.html#a210231ed06d822ca8be83bd7f75aa572">filename</a>, <span class="stringliteral">&quot;missing_coords_mesh%s.dat&quot;</span>, modifier.str().c_str());</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;          outfile.open(<a class="code" href="../../d5/db2/namespaceMergeRestartFiles.html#a210231ed06d822ca8be83bd7f75aa572">filename</a>);</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;          <span class="keywordtype">unsigned</span> nel = mesh_pt[i_mesh]-&gt;nelement();</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; nel; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;          {</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;            mesh_pt[i_mesh]-&gt;finite_element_pt(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>)-&gt;output(outfile);</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;            <span class="comment">// FiniteElement::output(outfile);</span></div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;          }</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;          outfile.close();</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160; </div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;          sprintf(</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;            <a class="code" href="../../d5/db2/namespaceMergeRestartFiles.html#a210231ed06d822ca8be83bd7f75aa572">filename</a>, <span class="stringliteral">&quot;missing_coords_ext_mesh%s.dat&quot;</span>, modifier.str().c_str());</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;          outfile.open(<a class="code" href="../../d5/db2/namespaceMergeRestartFiles.html#a210231ed06d822ca8be83bd7f75aa572">filename</a>);</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;          nel = external_mesh_pt-&gt;nelement();</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; nel; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;          {</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;            external_mesh_pt-&gt;finite_element_pt(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>)-&gt;output(outfile);</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;            <span class="comment">// FiniteElement::output(outfile);</span></div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;          }</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;          outfile.close();</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160; </div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;          <a class="code" href="../../dd/db0/classBinArray.html">BinArray</a>* bin_array_pt = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../dd/db0/classBinArray.html">BinArray</a>*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;            mesh_geom_obj_pt[i_mesh]-&gt;sample_point_container_pt());</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;          <span class="keywordflow">if</span> (bin_array_pt != 0)</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;          {</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;            sprintf(</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;              <a class="code" href="../../d5/db2/namespaceMergeRestartFiles.html#a210231ed06d822ca8be83bd7f75aa572">filename</a>, <span class="stringliteral">&quot;missing_coords_bin%s.dat&quot;</span>, modifier.str().c_str());</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;            outfile.open(<a class="code" href="../../d5/db2/namespaceMergeRestartFiles.html#a210231ed06d822ca8be83bd7f75aa572">filename</a>);</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;            bin_array_pt-&gt;<a class="code" href="../../dd/db0/classBinArray.html#a66fe7e379a53e3fee81ead7ef4045b40">output_bins</a>(outfile);</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;            outfile.close();</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;          }</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160; </div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;          sprintf(<a class="code" href="../../d5/db2/namespaceMergeRestartFiles.html#a210231ed06d822ca8be83bd7f75aa572">filename</a>, <span class="stringliteral">&quot;missing_coords%s.dat&quot;</span>, modifier.str().c_str());</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;          outfile.open(<a class="code" href="../../d5/db2/namespaceMergeRestartFiles.html#a210231ed06d822ca8be83bd7f75aa572">filename</a>);</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;          <span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> = <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a2325d66c90ff388dfd6b2649a48e9827">External_element_located</a>.size();</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;          error_stream &lt;&lt; <span class="stringliteral">&quot;Number of unlocated elements &quot;</span> &lt;&lt; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; <a class="code" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;          {</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;            <span class="keywordtype">unsigned</span> n_intpt = <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a2325d66c90ff388dfd6b2649a48e9827">External_element_located</a>[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>].size();</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;            <span class="keywordflow">if</span> (n_intpt == 0)</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;            {</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;              error_stream &lt;&lt; <span class="stringliteral">&quot;Failure to locate in halo element! &quot;</span></div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;                           &lt;&lt; <span class="stringliteral">&quot;Why are we searching there?&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;            }</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ipt = 0; ipt &lt; n_intpt; ipt++)</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;            {</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a2325d66c90ff388dfd6b2649a48e9827">External_element_located</a>[<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>][ipt] == 0)</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;              {</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;                error_stream &lt;&lt; <span class="stringliteral">&quot;Failure at element/intpt: &quot;</span> &lt;&lt; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; ipt</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;                             &lt;&lt; std::endl;</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160; </div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;                <span class="comment">// Cast</span></div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;                ElementWithExternalElement* el_pt =</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;                  <span class="keyword">dynamic_cast&lt;</span>ElementWithExternalElement*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;                    mesh_pt[i_mesh]-&gt;element_pt(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>));</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160; </div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;                <span class="keywordtype">unsigned</span> n_dim_el = el_pt-&gt;dim();</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;                Vector&lt;double&gt; <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>(n_dim_el);</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_dim_el; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;                {</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;                  <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = el_pt-&gt;integral_pt()-&gt;knot(ipt, <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;                }</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;                <span class="keywordtype">unsigned</span> n_dim = el_pt-&gt;node_pt(0)-&gt;ndim();</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;                Vector&lt;double&gt; <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>(n_dim);</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;                el_pt-&gt;interpolated_x(<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>, <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>);</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_dim; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;                {</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;                  error_stream &lt;&lt; <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;                  outfile &lt;&lt; <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;                }</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;                error_stream &lt;&lt; std::endl;</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;                outfile &lt;&lt; std::endl;</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;              }</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;            }</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;          }</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;          outfile.close();</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;        }</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160; </div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;        error_stream</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;Mesh and external mesh documented in missing_coords_mesh*.dat\n&quot;</span></div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;and missing_coords_ext_mesh*.dat, respectively. Missing \n&quot;</span></div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;coordinates in missing_coords*.dat\n&quot;</span>;</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;          error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;      }</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;      <span class="comment">// Failure is deeemed to be acceptable</span></div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;      {</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a></div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;NOTE: Haven&#39;t found &quot;</span> &lt;&lt; n_zeta_not_found</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;          &lt;&lt; <span class="stringliteral">&quot; external elements in \n&quot;</span></div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;Multi_domain_functions::aux_setup_multi_domain_interaction(...)\n&quot;</span></div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;but this deemed to be acceptable because \n&quot;</span></div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;Multi_domain_functions::Accept_failed_locate_zeta_in_setup_multi_&quot;</span></div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;             <span class="stringliteral">&quot;domain_interaction\n&quot;</span></div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;is true.\n&quot;</span>;</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;      }</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;    }</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160; </div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160; </div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    <span class="comment">// Doc timings if required</span></div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d4/d29/namespaceoomph_1_1Missing__masters__functions.html#acd9cae489a6217b1566a1e40cbca86cf">Doc_timings</a>)</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    {</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;      t_locate = <a class="code" href="../../d9/dd8/oomph__metis__from__parmetis__3_81_81_2struct_8h.html#aae821c36bb7e6918e1414484f939c3d4">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a></div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;Total CPU for location and creation of all external elements: &quot;</span></div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;        &lt;&lt; t_locate - t_start &lt;&lt; std::endl;</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;    }</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160; </div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    <span class="comment">// Delete the geometric object representing the mesh</span></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i_mesh = 0; i_mesh &lt; n_mesh; i_mesh++)</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;    {</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;      <span class="keyword">delete</span> mesh_geom_obj_pt[i_mesh];</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;    }</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160; </div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    <span class="comment">// Clean up all the (extern) Vectors associated with creating the</span></div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    <span class="comment">// external storage information</span></div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;    <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a45a7960bff85287284bea3939dcda5c2">clean_up</a>();</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160; </div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160; </div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    <span class="comment">// Output information about external storage if required</span></div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d4/d29/namespaceoomph_1_1Missing__masters__functions.html#a86ac04bf0028ba6e66c07466cc9774ce">Doc_stats</a>)</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    {</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;      <span class="comment">// Report stats regarding location method</span></div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;      <span class="keywordtype">bool</span> comm_was_required = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;-------------------------------------------&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;- Cumulative percentage of locate success -&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;--- Spiral -- Found local -- Found else ---&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> level = 0; level &lt; max_level_reached; level++)</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;      {</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;---   &quot;</span> &lt;&lt; level &lt;&lt; <span class="stringliteral">&quot;   -- &quot;</span></div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;                   &lt;&lt; percentage_coords_located_locally[level] &lt;&lt; <span class="stringliteral">&quot; -- &quot;</span></div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;                   &lt;&lt; percentage_coords_located_elsewhere[level] &lt;&lt; <span class="stringliteral">&quot; ---&quot;</span></div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;                   &lt;&lt; std::endl;</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;        <span class="comment">// Has communication with other processors at this level actually</span></div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;        <span class="comment">// produced any results?</span></div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;        <span class="keywordflow">if</span> (percentage_coords_located_elsewhere[level] &gt;</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;            percentage_coords_located_locally[level])</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;        {</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;          comm_was_required = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;        }</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;      }</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;-------------------------------------------&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160; </div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160; </div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;      <span class="comment">// No need for any of this malaki if we&#39;re not running in parallel</span></div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;      <span class="keywordflow">if</span> (problem_pt-&gt;communicator_pt()-&gt;nproc() &gt; 1)</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;      {</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;        <span class="comment">// Initialise to indicate that none of the zetas required</span></div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;        <span class="comment">// on this processor were located through parallel ring search,</span></div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;        <span class="comment">// i.e. comm was not required and we could have done some</span></div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;        <span class="comment">// more local searching first</span></div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;ASSESSMENT OF NEED FOR PARALLEL SEARCH: \n&quot;</span>;</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;=======================================\n&quot;</span>;</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;        <span class="keywordtype">unsigned</span> status = 0;</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;        <span class="keywordflow">if</span> (comm_was_required)</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;        {</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;- Ring-based parallel search did successfully locate &quot;</span></div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;                        <span class="stringliteral">&quot;zetas on proc &quot;</span></div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;                     &lt;&lt; my_rank &lt;&lt; std::endl;</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;          status = 1;</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;        }</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;        {</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;          <span class="keywordflow">if</span> (max_level_reached &gt; 1)</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;          {</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;            <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a></div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;- Ring-based parallel search did NOT locate zetas on proc&quot;</span></div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;              &lt;&lt; my_rank &lt;&lt; std::endl;</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;          }</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;          {</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;            <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a></div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;- No ring-based parallel search was performed on proc&quot;</span></div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;              &lt;&lt; my_rank &lt;&lt; std::endl;</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;          }</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;        }</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160; </div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;        <span class="comment">// Allreduce to check if anyone has benefitted from parallel ring</span></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;        <span class="comment">// search</span></div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;        <span class="keywordtype">unsigned</span> overall_status = 0;</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;        MPI_Allreduce(&amp;status,</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;                      &amp;overall_status,</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;                      1,</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;                      MPI_UNSIGNED,</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;                      MPI_MAX,</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;                      problem_pt-&gt;communicator_pt()-&gt;mpi_comm());</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160; </div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;        <span class="comment">// Report of mpi was useful to anyone</span></div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;        <span class="keywordflow">if</span> (overall_status == 1)</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;        {</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;- Ring-based, parallel search did succesfully\n&quot;</span>;</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;  locate zetas on at least one other proc, so it\n&quot;</span>;</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;  was worthwhile.\n&quot;</span>;</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;          <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;        }</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;        {</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;          <span class="keywordflow">if</span> (max_level_reached &gt; 1)</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;          {</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;            <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a></div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;- Ring-based, parallel search did NOT locate zetas\n&quot;</span>;</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;            <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;  on ANY other procs, i.e it was useless.\n&quot;</span>;</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;            <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a></div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;  --&gt; We should really have done more local search\n&quot;</span>;</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;            <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a></div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;   by reducing number of bins, or doing more spirals\n&quot;</span>;</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;            <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;   in one go before initiating parallel search.\n&quot;</span>;</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;            <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;          }</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;          {</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;            <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;- No ring-based, parallel search was performed\n&quot;</span>;</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;            <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;  or necessary. Perfect!\n&quot;</span>;</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;            <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;          }</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;        }</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;      }</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160; </div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;      <span class="comment">// How many external elements does the external mesh have now?</span></div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;------------------------------------------&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;External mesh: I have &quot;</span> &lt;&lt; external_mesh_pt-&gt;nelement()</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot; elements, and &quot;</span> &lt;&lt; std::endl</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;                 &lt;&lt; external_mesh_pt-&gt;nexternal_halo_element()</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot; external halo elements, &quot;</span></div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;                 &lt;&lt; external_mesh_pt-&gt;nexternal_haloed_element()</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot; external haloed elements&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160; </div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;      <span class="comment">// How many external nodes does each submesh have now?</span></div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;------------------------------------------&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;External mesh: I have &quot;</span> &lt;&lt; external_mesh_pt-&gt;nnode()</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot; nodes, and &quot;</span> &lt;&lt; std::endl</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;                 &lt;&lt; external_mesh_pt-&gt;nexternal_halo_node()</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot; external halo nodes, &quot;</span></div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;                 &lt;&lt; external_mesh_pt-&gt;nexternal_haloed_node()</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot; external haloed nodes&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;------------------------------------------&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;    }</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160; </div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;    <span class="comment">// Output further information about (external) halo(ed)</span></div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;    <span class="comment">// elements and nodes if required</span></div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d4/d29/namespaceoomph_1_1Missing__masters__functions.html#a5059632b6254fcfc11f688e3e643d71c">Doc_full_stats</a>)</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;    {</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;      <span class="comment">// How many elements does this submesh have for each of the processors?</span></div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iproc = 0; iproc &lt; n_proc; iproc++)</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;      {</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;----------------------------------------&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;With process &quot;</span> &lt;&lt; iproc &lt;&lt; <span class="stringliteral">&quot; there are &quot;</span></div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;                   &lt;&lt; external_mesh_pt-&gt;nroot_halo_element(iproc)</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot; root halo elements, and &quot;</span></div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;                   &lt;&lt; external_mesh_pt-&gt;nroot_haloed_element(iproc)</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot; root haloed elements&quot;</span> &lt;&lt; std::endl</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;and there are &quot;</span></div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;                   &lt;&lt; external_mesh_pt-&gt;nexternal_halo_element(iproc)</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot; external halo elements, and &quot;</span></div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;                   &lt;&lt; external_mesh_pt-&gt;nexternal_haloed_element(iproc)</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot; external haloed elements.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160; </div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;----------------------------------------&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;        <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;With process &quot;</span> &lt;&lt; iproc &lt;&lt; <span class="stringliteral">&quot; there are &quot;</span></div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;                   &lt;&lt; external_mesh_pt-&gt;nhalo_node(iproc) &lt;&lt; <span class="stringliteral">&quot; halo nodes, and &quot;</span></div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;                   &lt;&lt; external_mesh_pt-&gt;nhaloed_node(iproc) &lt;&lt; <span class="stringliteral">&quot; haloed nodes&quot;</span></div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;                   &lt;&lt; std::endl</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;and there are &quot;</span></div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;                   &lt;&lt; external_mesh_pt-&gt;nexternal_halo_node(iproc)</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot; external halo nodes, and &quot;</span></div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;                   &lt;&lt; external_mesh_pt-&gt;nexternal_haloed_node(iproc)</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot; external haloed nodes.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;      }</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------&quot;</span> &lt;&lt; std::endl</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;                 &lt;&lt; std::endl;</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;    }</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160; </div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160; </div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    <span class="comment">// Doc timings if required</span></div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d4/d29/namespaceoomph_1_1Missing__masters__functions.html#acd9cae489a6217b1566a1e40cbca86cf">Doc_timings</a>)</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;    {</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;      t_end = <a class="code" href="../../d9/dd8/oomph__metis__from__parmetis__3_81_81_2struct_8h.html#aae821c36bb7e6918e1414484f939c3d4">TimingHelpers::timer</a>();</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;      <a class="code" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph_info</a> &lt;&lt; <span class="stringliteral">&quot;CPU for (one way) aux_setup_multi_domain_interaction: &quot;</span></div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;                 &lt;&lt; t_end - t_start &lt;&lt; std::endl;</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;    }</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160; </div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;  } <span class="comment">// end of aux_setup_multi_domain_interaction</span></div>
<div class="ttc" id="aBiCGSTAB__step__by__step_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> BiCGSTAB_step_by_step.cpp:9</div></div>
<div class="ttc" id="aCG3DPackingUnitTest_8cpp_html_a7026fd16370249ce97cb3d062326baf9"><div class="ttname"><a href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a></div><div class="ttdeci">const unsigned n</div><div class="ttdef"><b>Definition:</b> CG3DPackingUnitTest.cpp:11</div></div>
<div class="ttc" id="aCwise__array__power__array_8cpp_html_a9eb5e92d9d691c1393e5e7c914731dbf"><div class="ttname"><a href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a></div><div class="ttdeci">Array&lt; double, 1, 3 &gt; e(1./3., 0.5, 2.)</div></div>
<div class="ttc" id="aclassBinArray_html"><div class="ttname"><a href="../../dd/db0/classBinArray.html">BinArray</a></div><div class="ttdoc">Base class for all bin arrays.</div><div class="ttdef"><b>Definition:</b> sample_point_container.h:402</div></div>
<div class="ttc" id="aclassBinArray_html_a1bd867e26195feb7ae95a8e77acadca8"><div class="ttname"><a href="../../dd/db0/classBinArray.html#a1bd867e26195feb7ae95a8e77acadca8">BinArray::max_bin_dimension</a></div><div class="ttdeci">unsigned max_bin_dimension() const</div><div class="ttdoc">Max. bin dimension (number of bins in coordinate directions)</div><div class="ttdef"><b>Definition:</b> sample_point_container.cc:659</div></div>
<div class="ttc" id="aclassBinArray_html_a66fe7e379a53e3fee81ead7ef4045b40"><div class="ttname"><a href="../../dd/db0/classBinArray.html#a66fe7e379a53e3fee81ead7ef4045b40">BinArray::output_bins</a></div><div class="ttdeci">virtual void output_bins(std::ofstream &amp;outfile)=0</div><div class="ttdoc">Output bins (boundaries and number of sample points in them)</div></div>
<div class="ttc" id="aclassNonRefineableBinArray_html"><div class="ttname"><a href="../../d0/d82/classNonRefineableBinArray.html">NonRefineableBinArray</a></div><div class="ttdoc">NonRefineableBinArray class.</div><div class="ttdef"><b>Definition:</b> sample_point_container.h:819</div></div>
<div class="ttc" id="aclassNonRefineableBinArray_html_a0ece8aca5700546a90d9a48cd932f3e6"><div class="ttname"><a href="../../d0/d82/classNonRefineableBinArray.html#a0ece8aca5700546a90d9a48cd932f3e6">NonRefineableBinArray::n_spiral_chunk</a></div><div class="ttdeci">unsigned n_spiral_chunk() const</div><div class="ttdoc">Number of spirals to be searched in one go const version.</div><div class="ttdef"><b>Definition:</b> sample_point_container.h:866</div></div>
<div class="ttc" id="aclassNonRefineableBinArray_html_ac3f611d0535d74a65834b4ec9c81a8ca"><div class="ttname"><a href="../../d0/d82/classNonRefineableBinArray.html#ac3f611d0535d74a65834b4ec9c81a8ca">NonRefineableBinArray::current_max_spiral_level</a></div><div class="ttdeci">unsigned &amp; current_max_spiral_level()</div><div class="ttdoc">Access function to current max. spiral level.</div><div class="ttdef"><b>Definition:</b> sample_point_container.h:891</div></div>
<div class="ttc" id="aclassNonRefineableBinArray_html_ae014f4db4cfc34a36e913a91a44ea66a"><div class="ttname"><a href="../../d0/d82/classNonRefineableBinArray.html#ae014f4db4cfc34a36e913a91a44ea66a">NonRefineableBinArray::current_min_spiral_level</a></div><div class="ttdeci">unsigned &amp; current_min_spiral_level()</div><div class="ttdoc">Access function to current min. spiral level.</div><div class="ttdef"><b>Definition:</b> sample_point_container.h:885</div></div>
<div class="ttc" id="aclassRefineableBinArray_html"><div class="ttname"><a href="../../d6/d1a/classRefineableBinArray.html">RefineableBinArray</a></div><div class="ttdoc">RefineableBinArray class.</div><div class="ttdef"><b>Definition:</b> sample_point_container.h:521</div></div>
<div class="ttc" id="aclassRefineableBinArray_html_a267d58bd06dafc53aff7b42927500a8b"><div class="ttname"><a href="../../d6/d1a/classRefineableBinArray.html#a267d58bd06dafc53aff7b42927500a8b">RefineableBinArray::total_number_of_sample_points_computed_recursively</a></div><div class="ttdeci">unsigned total_number_of_sample_points_computed_recursively() const</div><div class="ttdoc">Compute total number of sample points recursively.</div><div class="ttdef"><b>Definition:</b> sample_point_container.cc:1820</div></div>
<div class="ttc" id="aclassRefineableBinArray_html_a517b1704286e6ee44b771af5348a6854"><div class="ttname"><a href="../../d6/d1a/classRefineableBinArray.html#a517b1704286e6ee44b771af5348a6854">RefineableBinArray::initial_last_sample_point_to_actually_lookup_during_locate_zeta</a></div><div class="ttdeci">unsigned &amp; initial_last_sample_point_to_actually_lookup_during_locate_zeta()</div><div class="ttdef"><b>Definition:</b> sample_point_container.h:741</div></div>
<div class="ttc" id="aclassRefineableBinArray_html_aade552fd473125fd624222672c90a3d5"><div class="ttname"><a href="../../d6/d1a/classRefineableBinArray.html#aade552fd473125fd624222672c90a3d5">RefineableBinArray::first_sample_point_to_actually_lookup_during_locate_zeta</a></div><div class="ttdeci">unsigned &amp; first_sample_point_to_actually_lookup_during_locate_zeta()</div><div class="ttdef"><b>Definition:</b> sample_point_container.h:712</div></div>
<div class="ttc" id="aclassRefineableBinArray_html_ad8dd347e3f9cd98555ebc96f9c968807"><div class="ttname"><a href="../../d6/d1a/classRefineableBinArray.html#ad8dd347e3f9cd98555ebc96f9c968807">RefineableBinArray::last_sample_point_to_actually_lookup_during_locate_zeta</a></div><div class="ttdeci">unsigned &amp; last_sample_point_to_actually_lookup_during_locate_zeta()</div><div class="ttdef"><b>Definition:</b> sample_point_container.h:720</div></div>
<div class="ttc" id="aclassRefineableBinArray_html_ae5dc08202a4716df1b2138f3dce84e85"><div class="ttname"><a href="../../d6/d1a/classRefineableBinArray.html#ae5dc08202a4716df1b2138f3dce84e85">RefineableBinArray::multiplier_for_max_sample_point_to_actually_lookup_during_locate_zeta</a></div><div class="ttdeci">unsigned &amp; multiplier_for_max_sample_point_to_actually_lookup_during_locate_zeta()</div><div class="ttdef"><b>Definition:</b> sample_point_container.h:732</div></div>
<div class="ttc" id="aclassdouble_html"><div class="ttname"><a href="../../df/de6/classdouble.html">double</a></div></div>
<div class="ttc" id="adatatypes_8h_html_ac6afabdc09a49a433ee19d8a9486056d"><div class="ttname"><a href="../../dc/d51/datatypes_8h.html#ac6afabdc09a49a433ee19d8a9486056d">min</a></div><div class="ttdeci">#define min(a, b)</div><div class="ttdef"><b>Definition:</b> datatypes.h:22</div></div>
<div class="ttc" id="adatatypes_8h_html_affe776513b24d84b39af8ab0930fef7f"><div class="ttname"><a href="../../dc/d51/datatypes_8h.html#affe776513b24d84b39af8ab0930fef7f">max</a></div><div class="ttdeci">#define max(a, b)</div><div class="ttdef"><b>Definition:</b> datatypes.h:23</div></div>
<div class="ttc" id="alevel1__cplx__impl_8h_html_a462761ca92ad97a9a705cb875828b0b8"><div class="ttname"><a href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a></div><div class="ttdeci">RealScalar s</div><div class="ttdef"><b>Definition:</b> level1_cplx_impl.h:130</div></div>
<div class="ttc" id="anamespaceGlobal__Variables_html_ac750eefd4d11ad9255000de7791c635a"><div class="ttname"><a href="../../d7/d6f/namespaceGlobal__Variables.html#ac750eefd4d11ad9255000de7791c635a">Global_Variables::Dim</a></div><div class="ttdeci">static const unsigned Dim</div><div class="ttdoc">Problem dimension.</div><div class="ttdef"><b>Definition:</b> two_d_tilted_square.cc:62</div></div>
<div class="ttc" id="anamespaceMergeRestartFiles_html_a210231ed06d822ca8be83bd7f75aa572"><div class="ttname"><a href="../../d5/db2/namespaceMergeRestartFiles.html#a210231ed06d822ca8be83bd7f75aa572">MergeRestartFiles.filename</a></div><div class="ttdeci">string filename</div><div class="ttdef"><b>Definition:</b> MergeRestartFiles.py:39</div></div>
<div class="ttc" id="anamespaceoomph_1_1Missing__masters__functions_html_a5059632b6254fcfc11f688e3e643d71c"><div class="ttname"><a href="../../d4/d29/namespaceoomph_1_1Missing__masters__functions.html#a5059632b6254fcfc11f688e3e643d71c">oomph::Missing_masters_functions::Doc_full_stats</a></div><div class="ttdeci">bool Doc_full_stats</div><div class="ttdef"><b>Definition:</b> missing_masters.cc:67</div></div>
<div class="ttc" id="anamespaceoomph_1_1Missing__masters__functions_html_a86ac04bf0028ba6e66c07466cc9774ce"><div class="ttname"><a href="../../d4/d29/namespaceoomph_1_1Missing__masters__functions.html#a86ac04bf0028ba6e66c07466cc9774ce">oomph::Missing_masters_functions::Doc_stats</a></div><div class="ttdeci">bool Doc_stats</div><div class="ttdef"><b>Definition:</b> missing_masters.cc:63</div></div>
<div class="ttc" id="anamespaceoomph_1_1Missing__masters__functions_html_acd9cae489a6217b1566a1e40cbca86cf"><div class="ttname"><a href="../../d4/d29/namespaceoomph_1_1Missing__masters__functions.html#acd9cae489a6217b1566a1e40cbca86cf">oomph::Missing_masters_functions::Doc_timings</a></div><div class="ttdeci">bool Doc_timings</div><div class="ttdoc">Boolean to indicate whether to doc timings or not.</div><div class="ttdef"><b>Definition:</b> missing_masters.cc:59</div></div>
<div class="ttc" id="anamespaceoomph_1_1Multi__domain__functions_html_a2325d66c90ff388dfd6b2649a48e9827"><div class="ttname"><a href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a2325d66c90ff388dfd6b2649a48e9827">oomph::Multi_domain_functions::External_element_located</a></div><div class="ttdeci">Vector&lt; Vector&lt; unsigned &gt; &gt; External_element_located</div><div class="ttdef"><b>Definition:</b> multi_domain.cc:68</div></div>
<div class="ttc" id="anamespaceoomph_1_1Multi__domain__functions_html_a45a7960bff85287284bea3939dcda5c2"><div class="ttname"><a href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a45a7960bff85287284bea3939dcda5c2">oomph::Multi_domain_functions::clean_up</a></div><div class="ttdeci">void clean_up()</div><div class="ttdef"><b>Definition:</b> multi_domain.cc:2413</div></div>
<div class="ttc" id="anamespaceoomph_1_1Multi__domain__functions_html_a880374b0f685eeddca0c70b5a5d40a85"><div class="ttname"><a href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a880374b0f685eeddca0c70b5a5d40a85">oomph::Multi_domain_functions::Flat_packed_zetas_not_found_locally</a></div><div class="ttdeci">Vector&lt; double &gt; Flat_packed_zetas_not_found_locally</div><div class="ttdef"><b>Definition:</b> multi_domain.cc:74</div></div>
<div class="ttc" id="anamespaceoomph_1_1Multi__domain__functions_html_a969b893c0f6f013c78076e4013c0f34c"><div class="ttname"><a href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a969b893c0f6f013c78076e4013c0f34c">oomph::Multi_domain_functions::locate_zeta_for_local_coordinates</a></div><div class="ttdeci">void locate_zeta_for_local_coordinates(const Vector&lt; Mesh * &gt; &amp;mesh_pt, Mesh *const &amp;external_mesh_pt, Vector&lt; MeshAsGeomObject * &gt; &amp;mesh_geom_obj_pt, const unsigned &amp;interaction_index)</div><div class="ttdef"><b>Definition:</b> multi_domain.cc:2153</div></div>
<div class="ttc" id="anamespaceoomph_1_1Multi__domain__functions_html_abc1119753cf68493ba6ea43c2a8bc378"><div class="ttname"><a href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#abc1119753cf68493ba6ea43c2a8bc378">oomph::Multi_domain_functions::Use_bulk_element_as_external</a></div><div class="ttdeci">bool Use_bulk_element_as_external</div><div class="ttdef"><b>Definition:</b> multi_domain.cc:142</div></div>
<div class="ttc" id="anamespaceoomph_1_1Multi__domain__functions_html_af4e0a3d3191c370209c6a7830a0dc368"><div class="ttname"><a href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#af4e0a3d3191c370209c6a7830a0dc368">oomph::Multi_domain_functions::Accept_failed_locate_zeta_in_setup_multi_domain_interaction</a></div><div class="ttdeci">bool Accept_failed_locate_zeta_in_setup_multi_domain_interaction</div><div class="ttdef"><b>Definition:</b> multi_domain.cc:56</div></div>
<div class="ttc" id="anamespaceoomph_html_a8c0fdc9bd9751811cd49fe6f06c55991a6bd4eede6af4e6e7881a96e4dc0e34cd"><div class="ttname"><a href="../../da/ddf/namespaceoomph.html#a8c0fdc9bd9751811cd49fe6f06c55991a6bd4eede6af4e6e7881a96e4dc0e34cd">oomph::UseRefineableBinArray</a></div><div class="ttdeci">@ UseRefineableBinArray</div><div class="ttdef"><b>Definition:</b> sample_point_parameters.h:41</div></div>
<div class="ttc" id="anamespaceoomph_html_a8c0fdc9bd9751811cd49fe6f06c55991ae9f4b2ff7655b9f053dd855d15d929af"><div class="ttname"><a href="../../da/ddf/namespaceoomph.html#a8c0fdc9bd9751811cd49fe6f06c55991ae9f4b2ff7655b9f053dd855d15d929af">oomph::UseNonRefineableBinArray</a></div><div class="ttdeci">@ UseNonRefineableBinArray</div><div class="ttdef"><b>Definition:</b> sample_point_parameters.h:42</div></div>
<div class="ttc" id="anamespaceoomph_html_aec474227917784dc0a255faf289cfc16"><div class="ttname"><a href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a></div><div class="ttdeci">OomphInfo oomph_info</div><div class="ttdef"><b>Definition:</b> oomph_definitions.cc:319</div></div>
<div class="ttc" id="anamespaceplotDoE_html_a4758fc6194247f040938f29c863d21ee"><div class="ttname"><a href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">plotDoE.x</a></div><div class="ttdeci">list x</div><div class="ttdef"><b>Definition:</b> plotDoE.py:28</div></div>
<div class="ttc" id="anamespaceplotPSD_html_a112f38a9c28b7e27fed13fb3ebf10362"><div class="ttname"><a href="../../dd/ddd/namespaceplotPSD.html#a112f38a9c28b7e27fed13fb3ebf10362">plotPSD.t</a></div><div class="ttdeci">t</div><div class="ttdef"><b>Definition:</b> plotPSD.py:36</div></div>
<div class="ttc" id="aoomph__definitions_8h_html_a25c6813cc7341d125e2502f8923fb6c4"><div class="ttname"><a href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a></div><div class="ttdeci">#define OOMPH_EXCEPTION_LOCATION</div><div class="ttdef"><b>Definition:</b> oomph_definitions.h:61</div></div>
<div class="ttc" id="aoomph__definitions_8h_html_aa260cc4af589e30cea7fde997ae16667"><div class="ttname"><a href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a></div><div class="ttdeci">#define OOMPH_CURRENT_FUNCTION</div><div class="ttdef"><b>Definition:</b> oomph_definitions.h:86</div></div>
<div class="ttc" id="aoomph__metis__from__parmetis__3_81_81_2struct_8h_html_aae821c36bb7e6918e1414484f939c3d4"><div class="ttname"><a href="../../d9/dd8/oomph__metis__from__parmetis__3_81_81_2struct_8h.html#aae821c36bb7e6918e1414484f939c3d4">timer</a></div><div class="ttdeci">double timer</div><div class="ttdef"><b>Definition:</b> oomph_metis_from_parmetis_3.1.1/struct.h:210</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#af4e0a3d3191c370209c6a7830a0dc368">Accept_failed_locate_zeta_in_setup_multi_domain_interaction</a>, <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a45a7960bff85287284bea3939dcda5c2">clean_up()</a>, <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">oomph::Problem::communicator_pt()</a>, <a class="el" href="../../d0/d82/classNonRefineableBinArray.html#ac3f611d0535d74a65834b4ec9c81a8ca">NonRefineableBinArray::current_max_spiral_level()</a>, <a class="el" href="../../d0/d82/classNonRefineableBinArray.html#ae014f4db4cfc34a36e913a91a44ea66a">NonRefineableBinArray::current_min_spiral_level()</a>, <a class="el" href="../../d7/d6f/namespaceGlobal__Variables.html#ac750eefd4d11ad9255000de7791c635a">Global_Variables::Dim</a>, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">oomph::FiniteElement::dim()</a>, <a class="el" href="../../d4/d29/namespaceoomph_1_1Missing__masters__functions.html#a5059632b6254fcfc11f688e3e643d71c">oomph::Missing_masters_functions::Doc_full_stats</a>, <a class="el" href="../../d4/d29/namespaceoomph_1_1Missing__masters__functions.html#a86ac04bf0028ba6e66c07466cc9774ce">oomph::Missing_masters_functions::Doc_stats</a>, <a class="el" href="../../d4/d29/namespaceoomph_1_1Missing__masters__functions.html#acd9cae489a6217b1566a1e40cbca86cf">oomph::Missing_masters_functions::Doc_timings</a>, <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">oomph::Mesh::element_pt()</a>, <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a2325d66c90ff388dfd6b2649a48e9827">External_element_located</a>, <a class="el" href="../../dd/d48/classoomph_1_1ElementWithExternalElement.html#a30c8347cfed1bb9d4ebc500f705bc739">oomph::ElementWithExternalElement::external_element_pt()</a>, <a class="el" href="../../d5/db2/namespaceMergeRestartFiles.html#a210231ed06d822ca8be83bd7f75aa572">MergeRestartFiles::filename</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a4f274774435e9454bf77bf70de69367a">oomph::Mesh::finite_element_pt()</a>, <a class="el" href="../../d6/d1a/classRefineableBinArray.html#aade552fd473125fd624222672c90a3d5">RefineableBinArray::first_sample_point_to_actually_lookup_during_locate_zeta()</a>, <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a880374b0f685eeddca0c70b5a5d40a85">Flat_packed_zetas_not_found_locally</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../d6/d1a/classRefineableBinArray.html#a517b1704286e6ee44b771af5348a6854">RefineableBinArray::initial_last_sample_point_to_actually_lookup_during_locate_zeta()</a>, <a class="el" href="../../dd/d48/classoomph_1_1ElementWithExternalElement.html#a1df25bb9135b84569486401f86c11b5a">oomph::ElementWithExternalElement::initialise_external_element_storage()</a>, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a751dc02ff1325f799840d79ee415753a">oomph::FiniteElement::integral_pt()</a>, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a4a011bbbef38e7ed244f699577f46b4a">oomph::FiniteElement::interpolated_x()</a>, <a class="el" href="../../de/d70/classoomph_1_1Integral.html#a1a2122f99a87c18649bafdd9ed739758">oomph::Integral::knot()</a>, <a class="el" href="../../d6/d1a/classRefineableBinArray.html#ad8dd347e3f9cd98555ebc96f9c968807">RefineableBinArray::last_sample_point_to_actually_lookup_during_locate_zeta()</a>, <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a969b893c0f6f013c78076e4013c0f34c">locate_zeta_for_local_coordinates()</a>, <a class="el" href="../../dc/d51/datatypes_8h.html#affe776513b24d84b39af8ab0930fef7f">max</a>, <a class="el" href="../../dd/db0/classBinArray.html#a1bd867e26195feb7ae95a8e77acadca8">BinArray::max_bin_dimension()</a>, <a class="el" href="../../dc/d51/datatypes_8h.html#ac6afabdc09a49a433ee19d8a9486056d">min</a>, <a class="el" href="../../d6/d1a/classRefineableBinArray.html#ae5dc08202a4716df1b2138f3dce84e85">RefineableBinArray::multiplier_for_max_sample_point_to_actually_lookup_during_locate_zeta()</a>, <a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a670b34aab05bfe0b96d0e0fabf583c7a">oomph::OomphCommunicator::my_rank()</a>, <a class="el" href="../../d8/d88/CG3DPackingUnitTest_8cpp.html#a7026fd16370249ce97cb3d062326baf9">n</a>, <a class="el" href="../../d0/d82/classNonRefineableBinArray.html#a0ece8aca5700546a90d9a48cd932f3e6">NonRefineableBinArray::n_spiral_chunk()</a>, <a class="el" href="../../dc/db7/classoomph_1_1Node.html#a786c96a8e46eb27a03b2b31f629d41b3">oomph::Node::ndim()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">oomph::Mesh::nelement()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a945e7823d1a2af243b5b7f7866aaff5e">oomph::Mesh::nnode()</a>, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a28ae3eb7760edc5c9d6427611d8e6fb6">oomph::FiniteElement::node_pt()</a>, <a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a6c78c72666f4b102c2bccf200f0853b7">oomph::OomphCommunicator::nproc()</a>, <a class="el" href="../../de/d70/classoomph_1_1Integral.html#a1a270de9d99a1fcf1d25a6c1017f65fa">oomph::Integral::nweight()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#aec474227917784dc0a255faf289cfc16">oomph::oomph_info</a>, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a2ad98a3d2ef4999f1bef62c0ff13f2a7">oomph::FiniteElement::output()</a>, <a class="el" href="../../dd/db0/classBinArray.html#a66fe7e379a53e3fee81ead7ef4045b40">BinArray::output_bins()</a>, <a class="el" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>, <a class="el" href="../../dd/ddd/namespaceplotPSD.html#a112f38a9c28b7e27fed13fb3ebf10362">plotPSD::t</a>, <a class="el" href="../../de/dfb/namespaceoomph_1_1TimingHelpers.html#a9fb6ad7e2e01b0914e9f7072ef9ebfa6">oomph::TimingHelpers::timer()</a>, <a class="el" href="../../d6/d1a/classRefineableBinArray.html#a267d58bd06dafc53aff7b42927500a8b">RefineableBinArray::total_number_of_sample_points_computed_recursively()</a>, <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#abc1119753cf68493ba6ea43c2a8bc378">Use_bulk_element_as_external</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#a8c0fdc9bd9751811cd49fe6f06c55991ae9f4b2ff7655b9f053dd855d15d929af">oomph::UseNonRefineableBinArray</a>, <a class="el" href="../../da/ddf/namespaceoomph.html#a8c0fdc9bd9751811cd49fe6f06c55991a6bd4eede6af4e6e7881a96e4dc0e34cd">oomph::UseRefineableBinArray</a>, and <a class="el" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">plotDoE::x</a>.</p>

</div>
</div>
<a id="ae63441bb68e6512082f1248c65f6208d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae63441bb68e6512082f1248c65f6208d">&#9670;&nbsp;</a></span>aux_setup_multi_domain_interaction() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class EXT_ELEMENT , class GEOM_OBJECT &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Multi_domain_functions::aux_setup_multi_domain_interaction </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *&#160;</td>
          <td class="paramname"><em>problem_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;&#160;</td>
          <td class="paramname"><em>mesh_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;&#160;</td>
          <td class="paramname"><em>external_mesh_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>interaction_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;&#160;</td>
          <td class="paramname"><em>external_face_mesh_pt</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Auxiliary helper function. </p>
<p>This routine calls the locate_zeta routine (simultaneously on each processor for each individual processor's element set if necessary) and sets up the external (halo) element and node storage as necessary. The locate_zeta procedure here works for all multi-domain problems where either two meshes occupy the same physical space but have differing element types (e.g. a Boussinesq convection problem where AdvectionDiffusion elements interact with Navier-Stokes type elements) or two meshes interact along some boundary of the external mesh, represented by a "face mesh", such as an FSI problem. </p>
<div class="fragment"><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  {</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="comment">// Convert to vector-based storage</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    Vector&lt;Mesh*&gt; mesh_pt_vector(1);</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    mesh_pt_vector[0] = mesh_pt;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    Vector&lt;Mesh*&gt; external_face_mesh_pt_vector(1);</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    external_face_mesh_pt_vector[0] = external_face_mesh_pt;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160; </div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="comment">// Call vector-based version</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    aux_setup_multi_domain_interaction&lt;EXT_ELEMENT, GEOM_OBJECT&gt;(</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;      problem_pt,</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;      mesh_pt_vector,</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;      external_mesh_pt,</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;      interaction_index,</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      external_face_mesh_pt_vector);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160; </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  } <span class="comment">// end of aux_setup_multi_domain_interaction</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a45a7960bff85287284bea3939dcda5c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45a7960bff85287284bea3939dcda5c2">&#9670;&nbsp;</a></span>clean_up()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Multi_domain_functions::clean_up </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Helper function that clears all the information used during the external storage creation</p>
<p>Helper function that clears all the intermediate information used during the external storage creation at the end of the procedure </p>
<div class="fragment"><div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;    {</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;      <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a880374b0f685eeddca0c70b5a5d40a85">Flat_packed_zetas_not_found_locally</a>.clear();</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;      <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#aa5bb8d568feb34660caf8f88928f3be7">Received_flat_packed_zetas_to_be_found</a>.clear();</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;      <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a05cf6413be5c69ff7535ebf0b8a153e3">Proc_id_plus_one_of_external_element</a>.clear();</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;      <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#ae6f22430d0d0df252be95eeda5c03151">Located_element_status</a>.clear();</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;      <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a095771257db01cdebaaf92facc3057a3">Flat_packed_located_coordinates</a>.clear();</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;      <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a2fa0a4a4e31700e161441b19f88c4bf3">Flat_packed_doubles</a>.clear();</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;      <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a5748b2389912d36f8f05cb175105c0a3">Flat_packed_unsigneds</a>.clear();</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;      <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a2325d66c90ff388dfd6b2649a48e9827">External_element_located</a>.clear();</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;    }</div>
<div class="ttc" id="anamespaceoomph_1_1Multi__domain__functions_html_a05cf6413be5c69ff7535ebf0b8a153e3"><div class="ttname"><a href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a05cf6413be5c69ff7535ebf0b8a153e3">oomph::Multi_domain_functions::Proc_id_plus_one_of_external_element</a></div><div class="ttdeci">Vector&lt; int &gt; Proc_id_plus_one_of_external_element</div><div class="ttdef"><b>Definition:</b> multi_domain.cc:91</div></div>
<div class="ttc" id="anamespaceoomph_1_1Multi__domain__functions_html_a095771257db01cdebaaf92facc3057a3"><div class="ttname"><a href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a095771257db01cdebaaf92facc3057a3">oomph::Multi_domain_functions::Flat_packed_located_coordinates</a></div><div class="ttdeci">Vector&lt; double &gt; Flat_packed_located_coordinates</div><div class="ttdef"><b>Definition:</b> multi_domain.cc:102</div></div>
<div class="ttc" id="anamespaceoomph_1_1Multi__domain__functions_html_a2fa0a4a4e31700e161441b19f88c4bf3"><div class="ttname"><a href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a2fa0a4a4e31700e161441b19f88c4bf3">oomph::Multi_domain_functions::Flat_packed_doubles</a></div><div class="ttdeci">Vector&lt; double &gt; Flat_packed_doubles</div><div class="ttdef"><b>Definition:</b> multi_domain.cc:106</div></div>
<div class="ttc" id="anamespaceoomph_1_1Multi__domain__functions_html_a5748b2389912d36f8f05cb175105c0a3"><div class="ttname"><a href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a5748b2389912d36f8f05cb175105c0a3">oomph::Multi_domain_functions::Flat_packed_unsigneds</a></div><div class="ttdeci">Vector&lt; unsigned &gt; Flat_packed_unsigneds</div><div class="ttdef"><b>Definition:</b> multi_domain.cc:118</div></div>
<div class="ttc" id="anamespaceoomph_1_1Multi__domain__functions_html_aa5bb8d568feb34660caf8f88928f3be7"><div class="ttname"><a href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#aa5bb8d568feb34660caf8f88928f3be7">oomph::Multi_domain_functions::Received_flat_packed_zetas_to_be_found</a></div><div class="ttdeci">Vector&lt; double &gt; Received_flat_packed_zetas_to_be_found</div><div class="ttdef"><b>Definition:</b> multi_domain.cc:82</div></div>
<div class="ttc" id="anamespaceoomph_1_1Multi__domain__functions_html_ae6f22430d0d0df252be95eeda5c03151"><div class="ttname"><a href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#ae6f22430d0d0df252be95eeda5c03151">oomph::Multi_domain_functions::Located_element_status</a></div><div class="ttdeci">Vector&lt; unsigned &gt; Located_element_status</div><div class="ttdef"><b>Definition:</b> multi_domain.cc:98</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a2325d66c90ff388dfd6b2649a48e9827">External_element_located</a>, <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a2fa0a4a4e31700e161441b19f88c4bf3">Flat_packed_doubles</a>, <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a095771257db01cdebaaf92facc3057a3">Flat_packed_located_coordinates</a>, <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a5748b2389912d36f8f05cb175105c0a3">Flat_packed_unsigneds</a>, <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a880374b0f685eeddca0c70b5a5d40a85">Flat_packed_zetas_not_found_locally</a>, <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#ae6f22430d0d0df252be95eeda5c03151">Located_element_status</a>, <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a05cf6413be5c69ff7535ebf0b8a153e3">Proc_id_plus_one_of_external_element</a>, and <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#aa5bb8d568feb34660caf8f88928f3be7">Received_flat_packed_zetas_to_be_found</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#af84f07f5b4632433203f4c4abf57da5f">aux_setup_multi_domain_interaction()</a>.</p>

</div>
</div>
<a id="ad9baf8c647dbd10164c28f12cbb04f85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9baf8c647dbd10164c28f12cbb04f85">&#9670;&nbsp;</a></span>first_closer_than_second()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::Multi_domain_functions::first_closer_than_second </td>
          <td>(</td>
          <td class="paramtype">const std::pair&lt; <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html">FiniteElement</a> *, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>p1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::pair&lt; <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html">FiniteElement</a> *, <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>p2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Comparison function for sorting entries in bin: Returns true if point identified by p1 (comprising pointer to finite element and vector of local coordinates within that element) is closer to Zeta_coords_for_further_away_comparison than p2 </p>
<div class="fragment"><div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;    {</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;      <span class="comment">// First point</span></div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;      FiniteElement* el_pt = <a class="code" href="../../db/d01/MatrixBase__all_8cpp.html#acdff45bcf8497bafe04b93e4e704c57b">p1</a>.first;</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;      Vector&lt;double&gt; <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>(<a class="code" href="../../db/d01/MatrixBase__all_8cpp.html#acdff45bcf8497bafe04b93e4e704c57b">p1</a>.second);</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;      Vector&lt;double&gt; <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>(<a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a27cbb5ec7f6fea2f237c11659ffeef58">Dim</a>);</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;      el_pt-&gt;interpolated_zeta(<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>, <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>);</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;      <span class="keywordtype">double</span> dist_squared1 = 0.0;</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a27cbb5ec7f6fea2f237c11659ffeef58">Dim</a>; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;      {</div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;        dist_squared1 +=</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;          (<a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] - <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a5f14db731fddbd057f4099fbdba95cc0">Zeta_coords_for_further_away_comparison</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]) *</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;          (<a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] - <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a5f14db731fddbd057f4099fbdba95cc0">Zeta_coords_for_further_away_comparison</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;      }</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160; </div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;      <span class="comment">// Second point</span></div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;      el_pt = p2.first;</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;      <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a> = p2.second;</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;      el_pt-&gt;interpolated_zeta(<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>, <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>);</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;      <span class="keywordtype">double</span> dist_squared2 = 0.0;</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a27cbb5ec7f6fea2f237c11659ffeef58">Dim</a>; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;      {</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;        dist_squared2 +=</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;          (<a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] - <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a5f14db731fddbd057f4099fbdba95cc0">Zeta_coords_for_further_away_comparison</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]) *</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;          (<a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] - <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a5f14db731fddbd057f4099fbdba95cc0">Zeta_coords_for_further_away_comparison</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;      }</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160; </div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;      <span class="comment">// Which one is further</span></div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;      <span class="keywordflow">if</span> (dist_squared1 &lt; dist_squared2)</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;      {</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;      }</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;      {</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;      }</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;    }</div>
<div class="ttc" id="aMatrixBase__all_8cpp_html_acdff45bcf8497bafe04b93e4e704c57b"><div class="ttname"><a href="../../db/d01/MatrixBase__all_8cpp.html#acdff45bcf8497bafe04b93e4e704c57b">p1</a></div><div class="ttdeci">Vector3f p1</div><div class="ttdef"><b>Definition:</b> MatrixBase_all.cpp:2</div></div>
<div class="ttc" id="anamespaceEigen_html_a119e06d0109a8812d63acbf9a15c6a88"><div class="ttname"><a href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">Eigen::zeta</a></div><div class="ttdeci">EIGEN_STRONG_INLINE const Eigen::CwiseBinaryOp&lt; Eigen::internal::scalar_zeta_op&lt; typename DerivedX::Scalar &gt;, const DerivedX, const DerivedQ &gt; zeta(const Eigen::ArrayBase&lt; DerivedX &gt; &amp;x, const Eigen::ArrayBase&lt; DerivedQ &gt; &amp;q)</div><div class="ttdef"><b>Definition:</b> SpecialFunctionsArrayAPI.h:152</div></div>
<div class="ttc" id="anamespaceoomph_1_1Multi__domain__functions_html_a27cbb5ec7f6fea2f237c11659ffeef58"><div class="ttname"><a href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a27cbb5ec7f6fea2f237c11659ffeef58">oomph::Multi_domain_functions::Dim</a></div><div class="ttdeci">unsigned Dim</div><div class="ttdef"><b>Definition:</b> multi_domain.cc:60</div></div>
<div class="ttc" id="anamespaceoomph_1_1Multi__domain__functions_html_a5f14db731fddbd057f4099fbdba95cc0"><div class="ttname"><a href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a5f14db731fddbd057f4099fbdba95cc0">oomph::Multi_domain_functions::Zeta_coords_for_further_away_comparison</a></div><div class="ttdeci">Vector&lt; double &gt; Zeta_coords_for_further_away_comparison</div><div class="ttdef"><b>Definition:</b> multi_domain.cc:2427</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a27cbb5ec7f6fea2f237c11659ffeef58">Dim</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a0c1c3291a3c01e768e1bf74c3ac04aa3">oomph::FiniteElement::interpolated_zeta()</a>, <a class="el" href="../../db/d01/MatrixBase__all_8cpp.html#acdff45bcf8497bafe04b93e4e704c57b">p1</a>, <a class="el" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>, <a class="el" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">Eigen::zeta()</a>, and <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a5f14db731fddbd057f4099fbdba95cc0">Zeta_coords_for_further_away_comparison</a>.</p>

</div>
</div>
<a id="a81f7a581bfb6abfcce009546b80b9898"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81f7a581bfb6abfcce009546b80b9898">&#9670;&nbsp;</a></span>get_dim_helper()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Multi_domain_functions::get_dim_helper </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *&#160;</td>
          <td class="paramname"><em>problem_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;&#160;</td>
          <td class="paramname"><em>mesh_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;&#160;</td>
          <td class="paramname"><em>external_mesh_pt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Helper function that computes the dimension of the elements within each of the specified meshes (and checks they are the same). Stores result in Dim.</p>
<p>Helper function that computes the dimension of the elements within each of the specified meshes (and checks they are the same) Stores result in Dim. </p>
<div class="fragment"><div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;    {</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;      <span class="comment">// Storage for number of processors, current process and communicator</span></div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;      OomphCommunicator* comm_pt = problem_pt-&gt;communicator_pt();</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160; </div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;      <span class="comment">// Extract the element dimensions from the first element of each mesh</span></div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;      <span class="keywordtype">unsigned</span> mesh_dim = 0;</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;      <span class="keywordflow">if</span> (mesh_pt-&gt;nelement() &gt; 0)</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;      {</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;        mesh_dim = <span class="keyword">dynamic_cast&lt;</span>FiniteElement*<span class="keyword">&gt;</span>(mesh_pt-&gt;element_pt(0))-&gt;dim();</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;      }</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;      <span class="keywordtype">unsigned</span> external_mesh_dim = 0;</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;      <span class="keywordflow">if</span> (external_mesh_pt-&gt;nelement() &gt; 0)</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;      {</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;        external_mesh_dim =</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;          <span class="keyword">dynamic_cast&lt;</span>FiniteElement*<span class="keyword">&gt;</span>(external_mesh_pt-&gt;element_pt(0))-&gt;dim();</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;      }</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160; </div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;      <span class="comment">// Need to do an Allreduce</span></div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;      <span class="keywordtype">int</span> n_proc = comm_pt-&gt;nproc();</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;      <span class="keywordflow">if</span> (n_proc &gt; 1)</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;      {</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;        <span class="keywordtype">unsigned</span> mesh_dim_reduce;</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;        MPI_Allreduce(&amp;mesh_dim,</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;                      &amp;mesh_dim_reduce,</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;                      1,</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;                      MPI_UNSIGNED,</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;                      MPI_MAX,</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;                      comm_pt-&gt;mpi_comm());</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;        mesh_dim = mesh_dim_reduce;</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160; </div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;        <span class="keywordtype">unsigned</span> external_mesh_dim_reduce;</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;        MPI_Allreduce(&amp;external_mesh_dim,</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;                      &amp;external_mesh_dim_reduce,</div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;                      1,</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;                      MPI_UNSIGNED,</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;                      MPI_MAX,</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;                      comm_pt-&gt;mpi_comm());</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;        external_mesh_dim = external_mesh_dim_reduce;</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;      }</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160; </div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;      <span class="comment">// Check the dimensions are the same!</span></div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;      <span class="keywordflow">if</span> (mesh_dim != external_mesh_dim)</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;      {</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;        std::ostringstream error_stream;</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;        error_stream &lt;&lt; <span class="stringliteral">&quot;The elements within the two meshes do not\n&quot;</span></div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;have the same dimension, so the multi-domain\n&quot;</span></div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;method will not work.\n&quot;</span></div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;For the mesh, dim=&quot;</span> &lt;&lt; mesh_dim</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;, and the external mesh, dim=&quot;</span> &lt;&lt; external_mesh_dim</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;          error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;      }</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160; </div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;      <span class="comment">// Set dimension</span></div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;      <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a27cbb5ec7f6fea2f237c11659ffeef58">Dim</a> = mesh_dim;</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/de5/classoomph_1_1Problem.html#a600bb1740edd0aa07c6d001033bf676a">oomph::Problem::communicator_pt()</a>, <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a27cbb5ec7f6fea2f237c11659ffeef58">Dim</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a876faf1f87b24b220ea21a38d6adde5b">oomph::Mesh::element_pt()</a>, <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#af01dfefb66c15579b540be62999d93ee">oomph::Mesh::nelement()</a>, <a class="el" href="../../de/d83/classoomph_1_1OomphCommunicator.html#a6c78c72666f4b102c2bccf200f0853b7">oomph::OomphCommunicator::nproc()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, and <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#ac64183e03f173c69ed6ed6f493a1a67e">setup_multi_domain_interaction()</a>.</p>

</div>
</div>
<a id="a969b893c0f6f013c78076e4013c0f34c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a969b893c0f6f013c78076e4013c0f34c">&#9670;&nbsp;</a></span>locate_zeta_for_local_coordinates()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Multi_domain_functions::locate_zeta_for_local_coordinates </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>mesh_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;&#160;</td>
          <td class="paramname"><em>external_mesh_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../da/db4/classoomph_1_1MeshAsGeomObject.html">MeshAsGeomObject</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>mesh_geom_obj_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>interaction_index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>locate zeta for current set of "local" coordinates vector-based version</p>
<p>Helper function to locate "local" zeta coordinates This is the vector-based version which operates simultaenously on the meshes contained in the Vectors. </p>
<div class="fragment"><div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;    {</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;      <span class="comment">// Flush storage for zetas not found locally</span></div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;      <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a880374b0f685eeddca0c70b5a5d40a85">Flat_packed_zetas_not_found_locally</a>.resize(0);</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160; </div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;      <span class="comment">// Number of meshes</span></div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;      <span class="keywordtype">unsigned</span> n_mesh = mesh_pt.size();</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160; </div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;      <span class="keywordflow">if</span> (mesh_geom_obj_pt.size() != n_mesh)</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;      {</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;        std::ostringstream error_stream;</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;        error_stream &lt;&lt; <span class="stringliteral">&quot;Sizes of mesh_geom_obj_pt [ &quot;</span></div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;                     &lt;&lt; mesh_geom_obj_pt.size() &lt;&lt; <span class="stringliteral">&quot; ] and &quot;</span></div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;mesh_pt [ &quot;</span> &lt;&lt; n_mesh &lt;&lt; <span class="stringliteral">&quot; ] don&#39;t match.\n&quot;</span>;</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;          error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;      }</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160; </div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;      <span class="comment">// Element counter</span></div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;      <span class="keywordtype">unsigned</span> e_count = 0;</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160; </div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;      <span class="comment">// Loop over meshes</span></div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i_mesh = 0; i_mesh &lt; n_mesh; i_mesh++)</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;      {</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;        <span class="comment">// Number of local elements</span></div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;        <span class="keywordtype">unsigned</span> n_element = mesh_pt[i_mesh]-&gt;nelement();</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160; </div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;        <span class="comment">// Loop over this processor&#39;s elements</span></div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; n_element; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;        {</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;          ElementWithExternalElement* el_pt =</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;            <span class="keyword">dynamic_cast&lt;</span>ElementWithExternalElement*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;              mesh_pt[i_mesh]-&gt;element_pt(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>));</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;          <span class="comment">// Only visit non-halo elements -- we&#39;re not setting up external</span></div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;          <span class="comment">// elements for on-halos!</span></div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;          <span class="keywordflow">if</span> (!el_pt-&gt;is_halo())</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;#endif</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;          {</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;            <span class="comment">// Find number of Gauss points and element dimension</span></div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;            <span class="keywordtype">unsigned</span> n_intpt = el_pt-&gt;integral_pt()-&gt;nweight();</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;            <span class="keywordtype">unsigned</span> <a class="code" href="../../d6/d4d/overloaded__cartesian__element__body_8h.html#a0d934b178247b03378eff1cd3ffe3442">el_dim</a> = el_pt-&gt;dim();</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160; </div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160; </div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d6/d4d/overloaded__cartesian__element__body_8h.html#a0d934b178247b03378eff1cd3ffe3442">el_dim</a> != <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a27cbb5ec7f6fea2f237c11659ffeef58">Dim</a>)</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;            {</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;              std::ostringstream error_stream;</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;              error_stream &lt;&lt; <span class="stringliteral">&quot;Dimension of element &quot;</span> &lt;&lt; <a class="code" href="../../d6/d4d/overloaded__cartesian__element__body_8h.html#a0d934b178247b03378eff1cd3ffe3442">el_dim</a></div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;                           &lt;&lt; <span class="stringliteral">&quot; is not consitent with dimension assumed \n&quot;</span></div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;                           &lt;&lt; <span class="stringliteral">&quot; in multidomain namespace, &quot;</span> &lt;&lt; <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a27cbb5ec7f6fea2f237c11659ffeef58">Dim</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;              <span class="keywordflow">throw</span> OomphLibError(error_stream.str(),</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;                                  <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>,</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;                                  <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;            }</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160; </div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;            <span class="comment">// Set storage for local and global coordinates</span></div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;            Vector&lt;double&gt; s_local(<a class="code" href="../../d6/d4d/overloaded__cartesian__element__body_8h.html#a0d934b178247b03378eff1cd3ffe3442">el_dim</a>);</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;            Vector&lt;double&gt; x_global(<a class="code" href="../../d6/d4d/overloaded__cartesian__element__body_8h.html#a0d934b178247b03378eff1cd3ffe3442">el_dim</a>);</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160; </div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;            <span class="comment">// Loop over integration points</span></div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ipt = 0; ipt &lt; n_intpt; ipt++)</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;            {</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;              <span class="comment">// Has this integration point been done yet?</span></div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a2325d66c90ff388dfd6b2649a48e9827">External_element_located</a>[e_count][ipt] == 0)</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;              {</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;                <span class="comment">// Get local coordinates</span></div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../d6/d4d/overloaded__cartesian__element__body_8h.html#a0d934b178247b03378eff1cd3ffe3442">el_dim</a>; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;                {</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;                  s_local[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = el_pt-&gt;integral_pt()-&gt;knot(ipt, <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;                }</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;                <span class="comment">// Interpolate to global coordinates</span></div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;                el_pt-&gt;interpolated_zeta(s_local, x_global);</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160; </div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;                <span class="comment">// Storage for geometric object and its local coordinates</span></div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;                GeomObject* sub_geom_obj_pt = 0;</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;                Vector&lt;double&gt; s_ext(<a class="code" href="../../d6/d4d/overloaded__cartesian__element__body_8h.html#a0d934b178247b03378eff1cd3ffe3442">el_dim</a>);</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;                mesh_geom_obj_pt[i_mesh]-&gt;locate_zeta(</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;                  x_global, sub_geom_obj_pt, s_ext);</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160; </div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;                <span class="comment">// Has the required element been located?</span></div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;                <span class="keywordflow">if</span> (sub_geom_obj_pt != 0)</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;                {</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;                  <span class="comment">// The required element has been located</span></div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;                  <span class="comment">// The located coordinates have the same dimension as the bulk</span></div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;                  GeneralisedElement* source_el_pt;</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;                  Vector&lt;double&gt; s_source(<a class="code" href="../../d6/d4d/overloaded__cartesian__element__body_8h.html#a0d934b178247b03378eff1cd3ffe3442">el_dim</a>);</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160; </div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;                  <span class="comment">// Is the bulk element the actual external element?</span></div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;                  <span class="keywordflow">if</span> (!<a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#abc1119753cf68493ba6ea43c2a8bc378">Use_bulk_element_as_external</a>)</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;                  {</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;                    <span class="comment">// Use the object directly (it must be a finite element)</span></div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;                    source_el_pt =</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;                      <span class="keyword">dynamic_cast&lt;</span>FiniteElement*<span class="keyword">&gt;</span>(sub_geom_obj_pt);</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;                    s_source = s_ext;</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;                  }</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;                  <span class="keywordflow">else</span></div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;                  {</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;                    <span class="comment">// Cast to a FaceElement and use the bulk element</span></div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;                    FaceElement* face_el_pt =</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;                      <span class="keyword">dynamic_cast&lt;</span>FaceElement*<span class="keyword">&gt;</span>(sub_geom_obj_pt);</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;                    source_el_pt = face_el_pt-&gt;bulk_element_pt();</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160; </div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;                    <span class="comment">// Need to resize the located coordinates to have the same</span></div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;                    <span class="comment">// dimension as the bulk element</span></div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;                    s_source.resize(</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;                      <span class="keyword">dynamic_cast&lt;</span>FiniteElement*<span class="keyword">&gt;</span>(source_el_pt)-&gt;dim());</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160; </div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;                    <span class="comment">// Translate the returned local coords into the bulk element</span></div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;                    face_el_pt-&gt;get_local_coordinate_in_bulk(s_ext, s_source);</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;                  }</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160; </div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;                  <span class="comment">// Check if it&#39;s a halo; if it is then the non-halo equivalent</span></div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;                  <span class="comment">// needs to be located from another processor (unless we</span></div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;                  <span class="comment">// accept halo elements as external elements)</span></div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#aa3b57b233a416885018e8993db0b291c">Allow_use_of_halo_elements_as_external_elements</a> ||</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;                      (!source_el_pt-&gt;is_halo()))</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;                  {</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;                    <span class="comment">// Need to cast to a FiniteElement</span></div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;                    FiniteElement* source_finite_el_pt =</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;                      <span class="keyword">dynamic_cast&lt;</span>FiniteElement*<span class="keyword">&gt;</span>(source_el_pt);</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160; </div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;                    <span class="comment">// Set the external element pointer and local coordinates</span></div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;                    el_pt-&gt;external_element_pt(interaction_index, ipt) =</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;                      source_finite_el_pt;</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;                    el_pt-&gt;external_element_local_coord(interaction_index,</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;                                                        ipt) = s_source;</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160; </div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;                    <span class="comment">// Set the lookup array to 1/true</span></div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;                    <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a2325d66c90ff388dfd6b2649a48e9827">External_element_located</a>[e_count][ipt] = 1;</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;                  }</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_MPI</span></div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;                  <span class="comment">// located element is halo and we&#39;re not accepting haloes</span></div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;                  <span class="comment">// obviously only makes sense in mpi mode...</span></div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;                  <span class="keywordflow">else</span></div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;                  {</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;                    <span class="comment">// Add required information to arrays</span></div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../d6/d4d/overloaded__cartesian__element__body_8h.html#a0d934b178247b03378eff1cd3ffe3442">el_dim</a>; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;                    {</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;                      <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a880374b0f685eeddca0c70b5a5d40a85">Flat_packed_zetas_not_found_locally</a>.push_back(</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;                        x_global[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;                    }</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;                  }</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;                }</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;                {</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;                  <span class="comment">// Search has failed then add the required information to the</span></div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;                  <span class="comment">// arrays which need to be sent to the other processors so</span></div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;                  <span class="comment">// that they can perform the locate_zeta</span></div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160; </div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;                  <span class="comment">// Add this global coordinate to the LOCAL zeta array</span></div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../d6/d4d/overloaded__cartesian__element__body_8h.html#a0d934b178247b03378eff1cd3ffe3442">el_dim</a>; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;                  {</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;                    <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a880374b0f685eeddca0c70b5a5d40a85">Flat_packed_zetas_not_found_locally</a>.push_back(x_global[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;                  }</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;                }</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;              }</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;            } <span class="comment">// end loop over integration points</span></div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;          } <span class="comment">// end for halo</span></div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160; </div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;          <span class="comment">// Bump up counter for all elements</span></div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;          e_count++;</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160; </div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;        } <span class="comment">// end loop over local elements</span></div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160; </div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;        <span class="comment">// Mark end of mesh data in flat packed array</span></div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a27cbb5ec7f6fea2f237c11659ffeef58">Dim</a>; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;        {</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;          <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a880374b0f685eeddca0c70b5a5d40a85">Flat_packed_zetas_not_found_locally</a>.push_back(DBL_MAX);</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;        }</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160; </div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;      } <span class="comment">// end of loop over meshes</span></div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;    }</div>
<div class="ttc" id="anamespaceoomph_1_1Multi__domain__functions_html_aa3b57b233a416885018e8993db0b291c"><div class="ttname"><a href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#aa3b57b233a416885018e8993db0b291c">oomph::Multi_domain_functions::Allow_use_of_halo_elements_as_external_elements</a></div><div class="ttdeci">bool Allow_use_of_halo_elements_as_external_elements</div><div class="ttdef"><b>Definition:</b> multi_domain.cc:149</div></div>
<div class="ttc" id="aoverloaded__cartesian__element__body_8h_html_a0d934b178247b03378eff1cd3ffe3442"><div class="ttname"><a href="../../d6/d4d/overloaded__cartesian__element__body_8h.html#a0d934b178247b03378eff1cd3ffe3442">el_dim</a></div><div class="ttdeci">unsigned el_dim</div><div class="ttdoc">dimension</div><div class="ttdef"><b>Definition:</b> overloaded_cartesian_element_body.h:30</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#aa3b57b233a416885018e8993db0b291c">Allow_use_of_halo_elements_as_external_elements</a>, <a class="el" href="../../dd/d78/classoomph_1_1FaceElement.html#a7539054d858d73989d7c1166e333e0f8">oomph::FaceElement::bulk_element_pt()</a>, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a5f8fe59f06da1da9f6b7bbcbdb90ef93">oomph::FiniteElement::dim()</a>, <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a27cbb5ec7f6fea2f237c11659ffeef58">Dim</a>, <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../d6/d4d/overloaded__cartesian__element__body_8h.html#a0d934b178247b03378eff1cd3ffe3442">el_dim</a>, <a class="el" href="../../dd/d48/classoomph_1_1ElementWithExternalElement.html#a0f4b305e2da000ad7523ab02163c36cb">oomph::ElementWithExternalElement::external_element_local_coord()</a>, <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a2325d66c90ff388dfd6b2649a48e9827">External_element_located</a>, <a class="el" href="../../dd/d48/classoomph_1_1ElementWithExternalElement.html#a30c8347cfed1bb9d4ebc500f705bc739">oomph::ElementWithExternalElement::external_element_pt()</a>, <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a880374b0f685eeddca0c70b5a5d40a85">Flat_packed_zetas_not_found_locally</a>, <a class="el" href="../../dd/d78/classoomph_1_1FaceElement.html#aced9ec5b182220c0f50b1714638ee8f3">oomph::FaceElement::get_local_coordinate_in_bulk()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a751dc02ff1325f799840d79ee415753a">oomph::FiniteElement::integral_pt()</a>, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a0c1c3291a3c01e768e1bf74c3ac04aa3">oomph::FiniteElement::interpolated_zeta()</a>, <a class="el" href="../../de/d70/classoomph_1_1Integral.html#a1a2122f99a87c18649bafdd9ed739758">oomph::Integral::knot()</a>, <a class="el" href="../../de/d70/classoomph_1_1Integral.html#a1a270de9d99a1fcf1d25a6c1017f65fa">oomph::Integral::nweight()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, and <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#abc1119753cf68493ba6ea43c2a8bc378">Use_bulk_element_as_external</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#af84f07f5b4632433203f4c4abf57da5f">aux_setup_multi_domain_interaction()</a>.</p>

</div>
</div>
<a id="adcfac96ed755990c71f35b722bacbde7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adcfac96ed755990c71f35b722bacbde7">&#9670;&nbsp;</a></span>setup_bulk_elements_adjacent_to_face_mesh() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BULK_ELEMENT , unsigned DIM&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Multi_domain_functions::setup_bulk_elements_adjacent_to_face_mesh </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *&#160;</td>
          <td class="paramname"><em>problem_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>boundary_in_bulk_mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;&#160;</td>
          <td class="paramname"><em>bulk_mesh_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;&#160;</td>
          <td class="paramname"><em>face_mesh_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>interaction</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Identify the <code>FaceElements</code> (stored in the mesh pointed to by <code>face_mesh_pt</code>) that are adjacent to the bulk elements next to the <code>boundary_in_bulk_mesh</code> -th boundary of the mesh pointed to by <code>bulk_mesh_pt</code>. The <code>FaceElements</code> must be derived from the <code>ElementWithExternalElement</code> base class and the adjacent bulk elements are stored as their external elements. </p>
<div class="fragment"><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  {</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="comment">// Convert to vector-based storage</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    Vector&lt;unsigned&gt; boundary_in_bulk_mesh_vect(1);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    boundary_in_bulk_mesh_vect[0] = boundary_in_bulk_mesh;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    Vector&lt;Mesh*&gt; face_mesh_pt_vect(1);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    face_mesh_pt_vect[0] = face_mesh_pt;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="comment">// Call vector-based version</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    setup_bulk_elements_adjacent_to_face_mesh&lt;BULK_ELEMENT, DIM&gt;(</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      problem_pt,</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      boundary_in_bulk_mesh_vect,</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      bulk_mesh_pt,</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      face_mesh_pt_vect,</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      interaction);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a35d48459a5261d565afbc106cb61fe60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35d48459a5261d565afbc106cb61fe60">&#9670;&nbsp;</a></span>setup_bulk_elements_adjacent_to_face_mesh() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class BULK_ELEMENT , unsigned DIM&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Multi_domain_functions::setup_bulk_elements_adjacent_to_face_mesh </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *&#160;</td>
          <td class="paramname"><em>problem_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>boundary_in_bulk_mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;&#160;</td>
          <td class="paramname"><em>bulk_mesh_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>face_mesh_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>interaction</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>/ Templated helper functions for multi-domain methods using locate_zeta </p>
<p>Identify the <code>FaceElements</code> (stored in the mesh pointed to by <code>face_mesh_pt</code>) that are adjacent to the bulk elements next to the <code>boundary_in_bulk_mesh</code> -th boundary of the mesh pointed to by <code>bulk_mesh_pt</code>. The <code>FaceElements</code> must be derived from the <code>ElementWithExternalElement</code> base class and the adjacent bulk elements are stored as their external elements.</p>
<p>This is the vector-based version which deals with multiple bulk mesh boundaries at the same time. </p>
<div class="fragment"><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keywordtype">unsigned</span> n_mesh = boundary_in_bulk_mesh.size();</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="comment">// Check sizes match</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keywordflow">if</span> (boundary_in_bulk_mesh.size() != face_mesh_pt.size())</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      std::ostringstream error_message;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      error_message &lt;&lt; <span class="stringliteral">&quot;Sizes of vector of boundary ids in bulk mesh (&quot;</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                    &lt;&lt; boundary_in_bulk_mesh.size()</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;) and vector of pointers\n&quot;</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;to FaceElements (&quot;</span> &lt;&lt; face_mesh_pt.size()</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot; doesn&#39;t match.\n&quot;</span>;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        error_message.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="comment">// Create face meshes adjacent to the bulk mesh&#39;s b-th boundary.</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="comment">// Each face mesh consists of FaceElements that may also be</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="comment">// interpreted as GeomObjects</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    Vector&lt;Mesh*&gt; bulk_face_mesh_pt(n_mesh);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="comment">// Loop over all meshes</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i_mesh = 0; i_mesh &lt; n_mesh; i_mesh++)</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      bulk_face_mesh_pt[i_mesh] = <span class="keyword">new</span> Mesh;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      bulk_mesh_pt</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        -&gt;template build_face_mesh&lt;BULK_ELEMENT, FaceElementAsGeomObject&gt;(</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;          boundary_in_bulk_mesh[i_mesh], bulk_face_mesh_pt[i_mesh]);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      <span class="comment">// Loop over these new face elements and tell them the boundary number</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <span class="comment">// from the bulk mesh -- this is required to they can</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <span class="comment">// get access to the boundary coordinates!</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      <span class="keywordtype">unsigned</span> n_face_element = bulk_face_mesh_pt[i_mesh]-&gt;nelement();</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &lt; n_face_element; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>++)</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="comment">// Cast the element pointer to the correct thing!</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        FaceElementAsGeomObject&lt;BULK_ELEMENT&gt;* el_pt =</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;          <span class="keyword">dynamic_cast&lt;</span>FaceElementAsGeomObject&lt;BULK_ELEMENT&gt;*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            bulk_face_mesh_pt[i_mesh]-&gt;element_pt(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>));</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="comment">// Set bulk boundary number</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        el_pt-&gt;set_boundary_number_in_bulk_mesh(boundary_in_bulk_mesh[i_mesh]);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <span class="comment">// Doc?</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a87a54c04fcc68b716adf10ca29a1f449">Doc_boundary_coordinate_file</a>.is_open())</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;          Vector&lt;double&gt; <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>(<a class="code" href="../../d5/d0e/linearised__navier__stokes__elements_8h.html#ac25189db92959bff3c6c2adf4c34b50a">DIM</a> - 1);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;          Vector&lt;double&gt; <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>(<a class="code" href="../../d5/d0e/linearised__navier__stokes__elements_8h.html#ac25189db92959bff3c6c2adf4c34b50a">DIM</a> - 1);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;          Vector&lt;double&gt; <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>(<a class="code" href="../../d5/d0e/linearised__navier__stokes__elements_8h.html#ac25189db92959bff3c6c2adf4c34b50a">DIM</a>);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;          <span class="keywordtype">unsigned</span> n_plot = 5;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;          <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a87a54c04fcc68b716adf10ca29a1f449">Doc_boundary_coordinate_file</a> &lt;&lt; el_pt-&gt;tecplot_zone_string(n_plot);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;          <span class="comment">// Loop over plot points</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;          <span class="keywordtype">unsigned</span> num_plot_points = el_pt-&gt;nplot_points(n_plot);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> iplot = 0; iplot &lt; num_plot_points; iplot++)</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;          {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            <span class="comment">// Get local coordinates of plot point</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            el_pt-&gt;get_s_plot(iplot, n_plot, <a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            el_pt-&gt;interpolated_zeta(<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>, <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            el_pt-&gt;interpolated_x(<a class="code" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>, <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../d5/d0e/linearised__navier__stokes__elements_8h.html#ac25189db92959bff3c6c2adf4c34b50a">DIM</a>; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;              <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a87a54c04fcc68b716adf10ca29a1f449">Doc_boundary_coordinate_file</a> &lt;&lt; <a class="code" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">x</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="../../d5/d0e/linearised__navier__stokes__elements_8h.html#ac25189db92959bff3c6c2adf4c34b50a">DIM</a> - 1; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;              <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a87a54c04fcc68b716adf10ca29a1f449">Doc_boundary_coordinate_file</a> &lt;&lt; <a class="code" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">zeta</a>[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            }</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a87a54c04fcc68b716adf10ca29a1f449">Doc_boundary_coordinate_file</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;          }</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;          el_pt-&gt;write_tecplot_zone_footer(<a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a87a54c04fcc68b716adf10ca29a1f449">Doc_boundary_coordinate_file</a>,</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                                           n_plot);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        }</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      }</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <span class="comment">// Now sort the elements based on the boundary coordinates.</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <span class="comment">// This may allow a faster implementation of the locate_zeta</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      <span class="comment">// function for the MeshAsGeomObject representation of this</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      <span class="comment">// mesh, but also creates a unique ordering of the elements</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      std::sort(bulk_face_mesh_pt[i_mesh]-&gt;element_pt().begin(),</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                bulk_face_mesh_pt[i_mesh]-&gt;element_pt().<a class="code" href="../../df/d04/group__Core__Module.html#ga0e45b6b2adead7c6a29815b99f9f14dd">end</a>(),</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                CompareBoundaryCoordinate&lt;BULK_ELEMENT&gt;());</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    } <span class="comment">// end of loop over meshes</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="comment">// Setup the interactions for this problem using the surface mesh</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="comment">// on the fluid mesh.  The interaction parameter in this instance is</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="comment">// given by the &quot;face&quot; parameter.</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#ac64183e03f173c69ed6ed6f493a1a67e">Multi_domain_functions::setup_multi_domain_interaction</a>&lt;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      BULK_ELEMENT,</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      FaceElementAsGeomObject&lt;BULK_ELEMENT&gt;&gt;(</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      problem_pt, face_mesh_pt, bulk_mesh_pt, bulk_face_mesh_pt, interaction);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="comment">// Loop over all meshes to clean up</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i_mesh = 0; i_mesh &lt; n_mesh; i_mesh++)</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      <span class="keywordtype">unsigned</span> n_face_element = bulk_face_mesh_pt[i_mesh]-&gt;nelement();</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      <span class="comment">// The MeshAsGeomObject has already been deleted (in set_external_storage)</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <span class="comment">// Must be careful with the FaceMesh, because we cannot delete the nodes</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <span class="comment">// Loop over the elements backwards (paranoid!) and delete them</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> = n_face_element; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> &gt; 0; <a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a>--)</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <span class="keyword">delete</span> bulk_face_mesh_pt[i_mesh]-&gt;element_pt(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> - 1);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        bulk_face_mesh_pt[i_mesh]-&gt;element_pt(<a class="code" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e</a> - 1) = 0;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="comment">// Now clear all element and node storage (should maybe fine-grain this)</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      bulk_face_mesh_pt[i_mesh]-&gt;flush_element_and_node_storage();</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <span class="comment">// Finally delete the mesh</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      <span class="keyword">delete</span> bulk_face_mesh_pt[i_mesh];</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    } <span class="comment">// end of loop over meshes</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  }</div>
<div class="ttc" id="agroup__Core__Module_html_ga0e45b6b2adead7c6a29815b99f9f14dd"><div class="ttname"><a href="../../df/d04/group__Core__Module.html#ga0e45b6b2adead7c6a29815b99f9f14dd">Eigen::placeholders::end</a></div><div class="ttdeci">static constexpr lastp1_t end</div><div class="ttdef"><b>Definition:</b> IndexedViewHelper.h:79</div></div>
<div class="ttc" id="alinearised__navier__stokes__elements_8h_html_ac25189db92959bff3c6c2adf4c34b50a"><div class="ttname"><a href="../../d5/d0e/linearised__navier__stokes__elements_8h.html#ac25189db92959bff3c6c2adf4c34b50a">DIM</a></div><div class="ttdeci">#define DIM</div><div class="ttdef"><b>Definition:</b> linearised_navier_stokes_elements.h:44</div></div>
<div class="ttc" id="anamespaceoomph_1_1Multi__domain__functions_html_a87a54c04fcc68b716adf10ca29a1f449"><div class="ttname"><a href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a87a54c04fcc68b716adf10ca29a1f449">oomph::Multi_domain_functions::Doc_boundary_coordinate_file</a></div><div class="ttdeci">std::ofstream Doc_boundary_coordinate_file</div><div class="ttdef"><b>Definition:</b> multi_domain.cc:47</div></div>
<div class="ttc" id="anamespaceoomph_1_1Multi__domain__functions_html_ac64183e03f173c69ed6ed6f493a1a67e"><div class="ttname"><a href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#ac64183e03f173c69ed6ed6f493a1a67e">oomph::Multi_domain_functions::setup_multi_domain_interaction</a></div><div class="ttdeci">void setup_multi_domain_interaction(Problem *problem_pt, Mesh *const &amp;mesh_pt, Mesh *const &amp;external_mesh_pt, const unsigned &amp;interaction_index=0)</div><div class="ttdef"><b>Definition:</b> multi_domain.template.cc:280</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d5/d0e/linearised__navier__stokes__elements_8h.html#ac25189db92959bff3c6c2adf4c34b50a">DIM</a>, <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a87a54c04fcc68b716adf10ca29a1f449">Doc_boundary_coordinate_file</a>, <a class="el" href="../../de/d2c/Cwise__array__power__array_8cpp.html#a9eb5e92d9d691c1393e5e7c914731dbf">e()</a>, <a class="el" href="../../df/d04/group__Core__Module.html#ga0e45b6b2adead7c6a29815b99f9f14dd">Eigen::placeholders::end</a>, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a82da844fd3ebb2005842464cdc148a03">oomph::FiniteElement::get_s_plot()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../dd/d78/classoomph_1_1FaceElement.html#a7aa612fec3604e08344503fbcdc357c8">oomph::FaceElement::interpolated_x()</a>, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a0c1c3291a3c01e768e1bf74c3ac04aa3">oomph::FiniteElement::interpolated_zeta()</a>, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a8ed563c7ff0cfd8bafdbb0132b388106">oomph::FiniteElement::nplot_points()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, <a class="el" href="../../d2/d2e/level1__cplx__impl_8h.html#a462761ca92ad97a9a705cb875828b0b8">s</a>, <a class="el" href="../../dd/d78/classoomph_1_1FaceElement.html#aaaa03a7db357facfbcfc480d8e0db404">oomph::FaceElement::set_boundary_number_in_bulk_mesh()</a>, <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#ac64183e03f173c69ed6ed6f493a1a67e">setup_multi_domain_interaction()</a>, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#a3193df31f9ce38e0609d17a8ffb386c6">oomph::FiniteElement::tecplot_zone_string()</a>, <a class="el" href="../../d2/dc6/classoomph_1_1FiniteElement.html#ac3987a5ead7dc20c63d86b333466e2b5">oomph::FiniteElement::write_tecplot_zone_footer()</a>, <a class="el" href="../../db/d46/namespaceplotDoE.html#a4758fc6194247f040938f29c863d21ee">plotDoE::x</a>, and <a class="el" href="../../d1/d62/namespaceEigen.html#a119e06d0109a8812d63acbf9a15c6a88">Eigen::zeta()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d39/namespaceoomph_1_1FSI__functions.html#ac71732700aad0d671fa1285d173d5b27">oomph::FSI_functions::setup_fluid_load_info_for_solid_elements()</a>, <a class="el" href="../../d6/d53/classPressureWaveFSIProblem.html#ad59e05f1708faa07de6d46ebf8f744a0">PressureWaveFSIProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;::setup_fsi()</a>, <a class="el" href="../../d3/d0f/classCoatedDiskProblem.html#ad24d43389155a6a9f2f66faf4b239c26">CoatedDiskProblem&lt; ELASTICITY_ELEMENT, HELMHOLTZ_ELEMENT &gt;::setup_interaction()</a>, <a class="el" href="../../d5/d09/classCoatedSphereProblem.html#aeea43c892871a6c65df992aedc3b3547">CoatedSphereProblem&lt; ELASTICITY_ELEMENT, HELMHOLTZ_ELEMENT &gt;::setup_interaction()</a>, and <a class="el" href="../../d2/d39/namespaceoomph_1_1FSI__functions.html#aacfff5c6e8f9ee75e7d2ae490d28fb7b">oomph::FSI_functions::setup_solid_elements_for_displacement_bc()</a>.</p>

</div>
</div>
<a id="ae7dbd6a7da9a8988ea4c58163da52883"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7dbd6a7da9a8988ea4c58163da52883">&#9670;&nbsp;</a></span>setup_multi_domain_interaction() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class EXT_ELEMENT , class FACE_ELEMENT_GEOM_OBJECT &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Multi_domain_functions::setup_multi_domain_interaction </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *&#160;</td>
          <td class="paramname"><em>problem_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>mesh_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;&#160;</td>
          <td class="paramname"><em>external_mesh_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>external_face_mesh_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>interaction_index</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function to set up the one-way multi-domain interaction for FSI-like problems.</p><ul>
<li><code>mesh_pt</code> points to the mesh of <code>ElemenWithExternalElements</code> for which the interaction is set up. In an FSI example, this mesh would contain the <code>FSIWallElements</code> (either beam/shell elements or the <code>FSISolidTractionElements</code> that apply the traction to a "bulk" solid mesh that is loaded by the fluid.)</li>
<li><code>external_mesh_pt</code> points to the mesh that contains the elements of type EXT_ELEMENT that provide the "source" for the <code>ElementWithExternalElements</code>. In an FSI example, this mesh would contain the "bulk" fluid elements.</li>
<li><code>external_face_mesh_pt</code> points to the mesh of <code>FaceElements</code> attached to the <code>external_mesh_pt</code>. The mesh pointed to by <code>external_face_mesh_pt</code> has the same dimension as <code>mesh_pt</code>. The elements contained in <code>external_face_mesh_pt</code> are of type FACE_ELEMENT_GEOM_OBJECT. In an FSI example, these elements are usually the <code>FaceElementAsGeomObjects</code> (templated by the type of the "bulk" fluid elements to which they are attached) that define the FSI boundary of the fluid domain.</li>
<li>The interaction_index parameter defaults to zero and must otherwise be set by the user if there is more than one mesh that provides "external
  elements" for the Mesh pointed to by mesh_pt (e.g. in the case when a beam or shell structure is loaded by fluid from both sides.)</li>
</ul>
<p>This is the vector-based version which operates simultaneously on the meshes contained in the Vector arguments.</p>
<p>Function to set up the one-way multi-domain interaction for FSI-like problems.</p><ul>
<li><code>mesh_pt</code> points to the mesh of <code>ElemenWithExternalElements</code> for which the interaction is set up. In an FSI example, this mesh would contain the <code>FSIWallElements</code> (either beam/shell elements or the <code>FSISolidTractionElements</code> that apply the traction to a "bulk" solid mesh that is loaded by the fluid.)</li>
<li><code>external_mesh_pt</code> points to the mesh that contains the elements of type EXT_ELEMENT that provide the "source" for the <code>ElementWithExternalElements</code>. In an FSI example, this mesh would contain the "bulk" fluid elements.</li>
<li><code>external_face_mesh_pt</code> points to the mesh of <code>FaceElements</code> attached to the <code>external_mesh_pt</code>. The mesh pointed to by <code>external_face_mesh_pt</code> has the same dimension as <code>mesh_pt</code>. The elements contained in <code>external_face_mesh_pt</code> are of type FACE_ELEMENT_GEOM_OBJECT. In an FSI example, these elements are usually the <code>FaceElementAsGeomObjects</code> (templated by the type of the "bulk" fluid elements to which they are attached) that define the FSI boundary of the fluid domain.</li>
<li>The interaction_index parameter defaults to zero and must otherwise be set by the user if there is more than one mesh that provides "external
  elements" for the Mesh pointed to by mesh_pt (e.g. in the case when a beam or shell structure is loaded by fluid from both sides.)</li>
</ul>
<p>Vector-based version operates simultaneously on the meshes contained in the vectors. </p>
<div class="fragment"><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  {</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="comment">// How many meshes do we have?</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keywordtype">unsigned</span> n_mesh = mesh_pt.size();</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="keywordflow">if</span> (external_face_mesh_pt.size() != n_mesh)</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    {</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      std::ostringstream error_stream;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      error_stream &lt;&lt; <span class="stringliteral">&quot;Sizes of external_face_mesh_pt [ &quot;</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                   &lt;&lt; external_face_mesh_pt.size() &lt;&lt; <span class="stringliteral">&quot; ] and &quot;</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;mesh_pt [ &quot;</span> &lt;&lt; n_mesh &lt;&lt; <span class="stringliteral">&quot; ] don&#39;t match.\n&quot;</span>;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    }</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160; </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="comment">// Bail out?</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="keywordflow">if</span> (n_mesh == 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160; </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="comment">// Bulk elements must be external elements in this case</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#abc1119753cf68493ba6ea43c2a8bc378">Use_bulk_element_as_external</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="comment">// Call the auxiliary routine with GEOM_OBJECT=FACE_ELEMENT_GEOM_OBJECT</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="comment">// and EL_DIM_LAG=Dim, EL_DIM_EUL=Dim+1. Use first mesh only.</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a81f7a581bfb6abfcce009546b80b9898">get_dim_helper</a>(problem_pt, mesh_pt[0], external_face_mesh_pt[0]);</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160; </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160; </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="comment">// Check consitency</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="keywordtype">unsigned</span> old_dim = <a class="code" href="../../d7/d6f/namespaceGlobal__Variables.html#ac750eefd4d11ad9255000de7791c635a">Dim</a>;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 1; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; n_mesh; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    {</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      <span class="comment">// Set up Dim again</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a81f7a581bfb6abfcce009546b80b9898">get_dim_helper</a>(problem_pt, mesh_pt[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>], external_face_mesh_pt[<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160; </div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d7/d6f/namespaceGlobal__Variables.html#ac750eefd4d11ad9255000de7791c635a">Dim</a> != old_dim)</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      {</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        std::ostringstream error_stream;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        error_stream &lt;&lt; <span class="stringliteral">&quot;Inconsistency: Mesh  &quot;</span> &lt;&lt; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot; has Dim=&quot;</span> &lt;&lt; <a class="code" href="../../d7/d6f/namespaceGlobal__Variables.html#ac750eefd4d11ad9255000de7791c635a">Dim</a></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;while mesh 0 has Dim=&quot;</span> &lt;&lt; old_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;          error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;      }</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    }</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160; </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d7/d6f/namespaceGlobal__Variables.html#ac750eefd4d11ad9255000de7791c635a">Dim</a> &gt; 2)</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    {</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      std::ostringstream error_stream;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      error_stream &lt;&lt; <span class="stringliteral">&quot;The elements within the two interacting meshes have a\n&quot;</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;dimension not equal to 1 or 2.\n&quot;</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;The multi-domain method will not work in this case.\n&quot;</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;The dimension is: &quot;</span> &lt;&lt; <a class="code" href="../../d7/d6f/namespaceGlobal__Variables.html#ac750eefd4d11ad9255000de7791c635a">Dim</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    }</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="comment">// Now do the actual work for all meshes simultaneously</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    aux_setup_multi_domain_interaction&lt;EXT_ELEMENT, FACE_ELEMENT_GEOM_OBJECT&gt;(</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      problem_pt,</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      mesh_pt,</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;      external_mesh_pt,</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;      interaction_index,</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;      external_face_mesh_pt);</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  }</div>
<div class="ttc" id="anamespaceoomph_1_1Multi__domain__functions_html_a81f7a581bfb6abfcce009546b80b9898"><div class="ttname"><a href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a81f7a581bfb6abfcce009546b80b9898">oomph::Multi_domain_functions::get_dim_helper</a></div><div class="ttdeci">void get_dim_helper(Problem *problem_pt, Mesh *const &amp;mesh_pt, Mesh *const &amp;external_mesh_pt)</div><div class="ttdef"><b>Definition:</b> multi_domain.cc:2343</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d7/d6f/namespaceGlobal__Variables.html#ac750eefd4d11ad9255000de7791c635a">Global_Variables::Dim</a>, <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a81f7a581bfb6abfcce009546b80b9898">get_dim_helper()</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, and <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#abc1119753cf68493ba6ea43c2a8bc378">Use_bulk_element_as_external</a>.</p>

</div>
</div>
<a id="ac64183e03f173c69ed6ed6f493a1a67e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac64183e03f173c69ed6ed6f493a1a67e">&#9670;&nbsp;</a></span>setup_multi_domain_interaction() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class EXT_ELEMENT &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Multi_domain_functions::setup_multi_domain_interaction </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *&#160;</td>
          <td class="paramname"><em>problem_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;&#160;</td>
          <td class="paramname"><em>mesh_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;&#160;</td>
          <td class="paramname"><em>external_mesh_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>interaction_index</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function to set up the one-way multi-domain interaction for problems where the meshes pointed to by <code>mesh_pt</code> and <code>external_mesh_pt</code> occupy the same physical space, and the elements in <code>external_mesh_pt</code> act as "external elements" for the <code>ElementWithExternalElements</code> in <code>mesh_pt</code> (but not vice versa):</p><ul>
<li><code>mesh_pt</code> points to the mesh of ElemenWithExternalElements for which the interaction is set up.</li>
<li><code>external_mesh_pt</code> points to the mesh that contains the elements of type EXT_ELEMENT that act as "external elements" for the <code>ElementWithExternalElements</code> in \ mesh_pt.</li>
<li>The interaction_index parameter defaults to zero and must be otherwise set by the user if there is more than one mesh that provides sources for the Mesh pointed to by mesh_pt.</li>
</ul>
<p>Function to set up the one-way multi-domain interaction for problems where the meshes pointed to by <code>mesh_pt</code> and <code>external_mesh_pt</code> occupy the same physical space, and the elements in <code>external_mesh_pt</code> act as "external elements" for the <code>ElementWithExternalElements</code> in <code>mesh_pt</code> (but not vice versa):</p><ul>
<li><code>mesh_pt</code> points to the mesh of ElemenWithExternalElements for which the interaction is set up.</li>
<li><code>external_mesh_pt</code> points to the mesh that contains the elements of type EXT_ELEMENT that act as "external elements" for the <code>ElementWithExternalElements</code> in <code>mesh_pt</code>.</li>
<li>The interaction_index parameter defaults to zero and must be otherwise set by the user if there is more than one mesh that provides sources for the Mesh pointed to by mesh_pt. </li>
</ul>
<div class="fragment"><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  {</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="comment">// Bulk elements must not be external elements in this case</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#abc1119753cf68493ba6ea43c2a8bc378">Use_bulk_element_as_external</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="comment">// Call the auxiliary function with GEOM_OBJECT=EXT_ELEMENT</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="comment">// and EL_DIM_EUL=EL_DIM_LAG=dimension returned from helper function</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a81f7a581bfb6abfcce009546b80b9898">get_dim_helper</a>(problem_pt, mesh_pt, external_mesh_pt);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d7/d6f/namespaceGlobal__Variables.html#ac750eefd4d11ad9255000de7791c635a">Dim</a> &gt; 3)</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    {</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      std::ostringstream error_stream;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      error_stream &lt;&lt; <span class="stringliteral">&quot;The elements within the two interacting meshes have a\n&quot;</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;dimension not equal to 1, 2 or 3.\n&quot;</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;The multi-domain method will not work in this case.\n&quot;</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;The dimension is: &quot;</span> &lt;&lt; <a class="code" href="../../d7/d6f/namespaceGlobal__Variables.html#ac750eefd4d11ad9255000de7791c635a">Dim</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    }</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="comment">// Wrapper for each dimension (template parameter)</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    aux_setup_multi_domain_interaction&lt;EXT_ELEMENT, EXT_ELEMENT&gt;(</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      problem_pt, mesh_pt, external_mesh_pt, interaction_index);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d7/d6f/namespaceGlobal__Variables.html#ac750eefd4d11ad9255000de7791c635a">Global_Variables::Dim</a>, <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a81f7a581bfb6abfcce009546b80b9898">get_dim_helper()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, and <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#abc1119753cf68493ba6ea43c2a8bc378">Use_bulk_element_as_external</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d9/d9c/classMortaringValidationProblem.html#a2667dc7f210603233e33a0a48c8fe174">MortaringValidationProblem&lt; ELEMENT, NON_MORTAR_ELEMENT &gt;::actions_after_adapt()</a>, <a class="el" href="../../df/d5e/classoomph_1_1RefineableTetgenMesh.html#ad75ff5f1e088e611311c3f6a30feea5b">oomph::RefineableTetgenMesh&lt; ELEMENT &gt;::adapt()</a>, <a class="el" href="../../d0/dec/classContactProblem.html#ad448b2647f7a1cbc006a193d1f82c9eb">ContactProblem&lt; ELEMENT &gt;::complete_problem_setup()</a>, <a class="el" href="../../d9/d9c/classMortaringValidationProblem.html#af3055039af3f520cd00118b82967db35">MortaringValidationProblem&lt; ELEMENT, NON_MORTAR_ELEMENT &gt;::MortaringValidationProblem()</a>, <a class="el" href="../../d5/dc5/classoomph_1_1ProjectionProblem.html#ad972f78212e515a03d1018996115265a">oomph::ProjectionProblem&lt; PROJECTABLE_ELEMENT &gt;::project()</a>, and <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a35d48459a5261d565afbc106cb61fe60">setup_bulk_elements_adjacent_to_face_mesh()</a>.</p>

</div>
</div>
<a id="a5fb45ad7165cc546b5e34e01a53478d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5fb45ad7165cc546b5e34e01a53478d8">&#9670;&nbsp;</a></span>setup_multi_domain_interaction() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class EXT_ELEMENT , class FACE_ELEMENT_GEOM_OBJECT &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Multi_domain_functions::setup_multi_domain_interaction </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *&#160;</td>
          <td class="paramname"><em>problem_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;&#160;</td>
          <td class="paramname"><em>mesh_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;&#160;</td>
          <td class="paramname"><em>external_mesh_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;&#160;</td>
          <td class="paramname"><em>external_face_mesh_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>interaction_index</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function to set up the one-way multi-domain interaction for FSI-like problems.</p><ul>
<li><code>mesh_pt</code> points to the mesh of <code>ElemenWithExternalElements</code> for which the interaction is set up. In an FSI example, this mesh would contain the <code>FSIWallElements</code> (either beam/shell elements or the <code>FSISolidTractionElements</code> that apply the traction to a "bulk" solid mesh that is loaded by the fluid.)</li>
<li><code>external_mesh_pt</code> points to the mesh that contains the elements of type EXT_ELEMENT that provide the "source" for the <code>ElementWithExternalElements</code>. In an FSI example, this mesh would contain the "bulk" fluid elements.</li>
<li><code>external_face_mesh_pt</code> points to the mesh of <code>FaceElements</code> attached to the <code>external_mesh_pt</code>. The mesh pointed to by <code>external_face_mesh_pt</code> has the same dimension as <code>mesh_pt</code>. The elements contained in <code>external_face_mesh_pt</code> are of type FACE_ELEMENT_GEOM_OBJECT. In an FSI example, these elements are usually the <code>FaceElementAsGeomObjects</code> (templated by the type of the "bulk" fluid elements to which they are attached) that define the FSI boundary of the fluid domain.</li>
<li>The interaction_index parameter defaults to zero and must otherwise be set by the user if there is more than one mesh that provides "external
  elements" for the Mesh pointed to by mesh_pt (e.g. in the case when a beam or shell structure is loaded by fluid from both sides.) </li>
</ul>
<div class="fragment"><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  {</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="comment">// Bulk elements must be external elements in this case</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#abc1119753cf68493ba6ea43c2a8bc378">Use_bulk_element_as_external</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="comment">// Call the auxiliary routine with GEOM_OBJECT=FACE_ELEMENT_GEOM_OBJECT</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="comment">// and EL_DIM_LAG=Dim, EL_DIM_EUL=Dim+1</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <a class="code" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a81f7a581bfb6abfcce009546b80b9898">get_dim_helper</a>(problem_pt, mesh_pt, external_face_mesh_pt);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d7/d6f/namespaceGlobal__Variables.html#ac750eefd4d11ad9255000de7791c635a">Dim</a> &gt; 2)</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    {</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      std::ostringstream error_stream;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      error_stream &lt;&lt; <span class="stringliteral">&quot;The elements within the two interacting meshes have a\n&quot;</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;dimension not equal to 1 or 2.\n&quot;</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;The multi-domain method will not work in this case.\n&quot;</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;The dimension is: &quot;</span> &lt;&lt; <a class="code" href="../../d7/d6f/namespaceGlobal__Variables.html#ac750eefd4d11ad9255000de7791c635a">Dim</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        error_stream.str(), <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="code" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>);</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    }</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="comment">// Call the function that actually does the work</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    aux_setup_multi_domain_interaction&lt;EXT_ELEMENT, FACE_ELEMENT_GEOM_OBJECT&gt;(</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      problem_pt,</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      mesh_pt,</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      external_mesh_pt,</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      interaction_index,</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      external_face_mesh_pt);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d7/d6f/namespaceGlobal__Variables.html#ac750eefd4d11ad9255000de7791c635a">Global_Variables::Dim</a>, <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a81f7a581bfb6abfcce009546b80b9898">get_dim_helper()</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#aa260cc4af589e30cea7fde997ae16667">OOMPH_CURRENT_FUNCTION</a>, <a class="el" href="../../dd/d6f/oomph__definitions_8h.html#a25c6813cc7341d125e2502f8923fb6c4">OOMPH_EXCEPTION_LOCATION</a>, and <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#abc1119753cf68493ba6ea43c2a8bc378">Use_bulk_element_as_external</a>.</p>

</div>
</div>
<a id="a4a7ac2c45985582b30ed3ecb5d2623d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a7ac2c45985582b30ed3ecb5d2623d2">&#9670;&nbsp;</a></span>setup_multi_domain_interactions()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ELEMENT_0 , class ELEMENT_1 &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void oomph::Multi_domain_functions::setup_multi_domain_interactions </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dc/de5/classoomph_1_1Problem.html">Problem</a> *&#160;</td>
          <td class="paramname"><em>problem_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;&#160;</td>
          <td class="paramname"><em>first_mesh_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/db8/classoomph_1_1Mesh.html">Mesh</a> *const &amp;&#160;</td>
          <td class="paramname"><em>second_mesh_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>first_interaction</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &amp;&#160;</td>
          <td class="paramname"><em>second_interaction</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set up the two-way multi-domain interactions for the problem pointed to by <code>problem_pt</code>. Use this for cases where first_mesh_pt and second_mesh_pt occupy the same physical space and are populated by ELEMENT_0 and ELEMENT_1 respectively, and are combined to solve a single problem. The elements in two meshes interact both ways the elements in each mesh act as "external elements" for the elements in the "other" mesh. The interaction indices allow the specification of which interaction we're setting up in the two meshes. They default to zero, which is appropriate if there's only a single interaction. </p>
<div class="fragment"><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  {</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="comment">// Delete all the current external halo(ed) element and node storage</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    first_mesh_pt-&gt;delete_all_external_storage();</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    second_mesh_pt-&gt;delete_all_external_storage();</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="comment">// Call setup_multi_domain_interaction in both directions</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    setup_multi_domain_interaction&lt;ELEMENT_1&gt;(</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      problem_pt, first_mesh_pt, second_mesh_pt, first_interaction);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    setup_multi_domain_interaction&lt;ELEMENT_0&gt;(</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      problem_pt, second_mesh_pt, first_mesh_pt, second_interaction);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/db8/classoomph_1_1Mesh.html#a9e3ecb07dc622cf37ce0085446ff9aa6">oomph::Mesh::delete_all_external_storage()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/d1f/classRefineableConvectionProblem.html#a9baa484155212df5ad2137dd5a348def">RefineableConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;::actions_after_adapt()</a>, <a class="el" href="../../db/d70/classRefineableDDConvectionProblem.html#add2623a8fcf64e4986832c6de1606ad2">RefineableDDConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;::actions_after_adapt()</a>, <a class="el" href="../../d3/d00/classConvectionProblem.html#a7ed8a5de81604ffed465668994524e1e">ConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;::actions_after_distribute()</a>, <a class="el" href="../../d1/d1f/classRefineableConvectionProblem.html#a438ac73bd0f9ab695ff02089462eadd0">RefineableConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;::actions_after_distribute()</a>, and <a class="el" href="../../d1/d6e/classDDConvectionProblem.html#a1de21a23465db98ddbf58a818a1338cb">DDConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;::DDConvectionProblem()</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="af4e0a3d3191c370209c6a7830a0dc368"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4e0a3d3191c370209c6a7830a0dc368">&#9670;&nbsp;</a></span>Accept_failed_locate_zeta_in_setup_multi_domain_interaction</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::Multi_domain_functions::Accept_failed_locate_zeta_in_setup_multi_domain_interaction = false</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Boolean to indicate that failure in setup multi domain functions is acceptable; defaults to false. If set to true external element pointers are set to null for those elements for which external elements couldn't be located. </p>

<p class="reference">Referenced by <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#af84f07f5b4632433203f4c4abf57da5f">aux_setup_multi_domain_interaction()</a>, <a class="el" href="../../d6/de0/namespaceMortaringHelpers.html#a86879c8029693d401d84da368c0307f5">MortaringHelpers::setup_constraint_elements_at_nodes()</a>, and <a class="el" href="../../d9/d9c/classMortaringValidationProblem.html#aa530d520b7f4b73ffbe6206a91e099aa">MortaringValidationProblem&lt; ELEMENT, NON_MORTAR_ELEMENT &gt;::setup_multi_domain_interaction()</a>.</p>

</div>
</div>
<a id="aa3b57b233a416885018e8993db0b291c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3b57b233a416885018e8993db0b291c">&#9670;&nbsp;</a></span>Allow_use_of_halo_elements_as_external_elements</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::Multi_domain_functions::Allow_use_of_halo_elements_as_external_elements = true</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Boolean to indicate if we're allowed to use halo elements as external elements. Can drastically reduce the number of external halo elements &ndash; currently not aware of any problems therefore set to true by default but retention of this flag allows easy return to previous implementation. </p>

<p class="reference">Referenced by <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a969b893c0f6f013c78076e4013c0f34c">locate_zeta_for_local_coordinates()</a>.</p>

</div>
</div>
<a id="aa45f040b8ffc6448777fae76190d308c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa45f040b8ffc6448777fae76190d308c">&#9670;&nbsp;</a></span>Allow_use_of_halo_elements_as_external_elements_for_projection</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::Multi_domain_functions::Allow_use_of_halo_elements_as_external_elements_for_projection = true</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Indicate whether we are allowed to use halo elements as external elements for projection, possibly only required in parallel unstructured mesh generation during the projection stage. Default set to true </p>

</div>
</div>
<a id="aeb7431547acc61e750fcc456a25ffc13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb7431547acc61e750fcc456a25ffc13">&#9670;&nbsp;</a></span>Counter_for_flat_packed_doubles</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> oomph::Multi_domain_functions::Counter_for_flat_packed_doubles</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Counter used when processing vector of flat-packed doubles &ndash; this is really "private" data, declared here to avoid having to pass it (and the associated array) between the various helper functions </p>

</div>
</div>
<a id="a20f6de2e1bd15cb40c461d2ca3940bd7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20f6de2e1bd15cb40c461d2ca3940bd7">&#9670;&nbsp;</a></span>Counter_for_flat_packed_unsigneds</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> oomph::Multi_domain_functions::Counter_for_flat_packed_unsigneds</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Counter used when processing vector of flat-packed unsigneds &ndash; this is really "private" data, declared here to avoid having to pass it (and the associated array) between the various helper functions </p>

</div>
</div>
<a id="a27cbb5ec7f6fea2f237c11659ffeef58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27cbb5ec7f6fea2f237c11659ffeef58">&#9670;&nbsp;</a></span>Dim</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> oomph::Multi_domain_functions::Dim</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Dimension of zeta tuples (set by get_dim_helper) &ndash; needed because we store the scalar coordinates in flat-packed form. </p>

<p class="reference">Referenced by <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#ad9baf8c647dbd10164c28f12cbb04f85">first_closer_than_second()</a>, <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a81f7a581bfb6abfcce009546b80b9898">get_dim_helper()</a>, and <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a969b893c0f6f013c78076e4013c0f34c">locate_zeta_for_local_coordinates()</a>.</p>

</div>
</div>
<a id="a87a54c04fcc68b716adf10ca29a1f449"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87a54c04fcc68b716adf10ca29a1f449">&#9670;&nbsp;</a></span>Doc_boundary_coordinate_file</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::ofstream oomph::Multi_domain_functions::Doc_boundary_coordinate_file</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Output file to document the boundary coordinate along the mesh boundary of the bulk mesh during call to setup_bulk_elements_adjacent_to_face_mesh(...) </p>

<p class="reference">Referenced by <a class="el" href="../../d3/db4/classPseudoElasticCollapsibleChannelProblem.html#abba847b01b2360d584baf71ecaca5381">PseudoElasticCollapsibleChannelProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;::PseudoElasticCollapsibleChannelProblem()</a>, <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a35d48459a5261d565afbc106cb61fe60">setup_bulk_elements_adjacent_to_face_mesh()</a>, and <a class="el" href="../../dd/dee/classUnstructuredFSIProblem.html#a6a31fd839e0215ef1312942cf7284bd2">UnstructuredFSIProblem&lt; FLUID_ELEMENT, SOLID_ELEMENT &gt;::UnstructuredFSIProblem()</a>.</p>

</div>
</div>
<a id="aa5969c7c730e13e9d5a2c268f3045203"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5969c7c730e13e9d5a2c268f3045203">&#9670;&nbsp;</a></span>Doc_full_stats</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::Multi_domain_functions::Doc_full_stats = false</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Boolean to indicate whether to output further info during setup_multi_domain_interaction() routines</p>
<p>Boolean to indicate whether to document further info (to screen) during setup_multi_domain_interaction() routines </p>

</div>
</div>
<a id="aa490ae6349c68dc3c5b40f6a4a40e718"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa490ae6349c68dc3c5b40f6a4a40e718">&#9670;&nbsp;</a></span>Doc_stats</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::Multi_domain_functions::Doc_stats = false</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Boolean to indicate whether to output basic info during setup_multi_domain_interaction() routines</p>
<p>Boolean to indicate whether to document basic info (to screen) during setup_multi_domain_interaction() routines </p>

<p class="reference">Referenced by <a class="el" href="../../d1/d1f/classRefineableConvectionProblem.html#a97e661986093402bf55fb6c32b782ddc">RefineableConvectionProblem&lt; NST_ELEMENT, AD_ELEMENT &gt;::RefineableConvectionProblem()</a>.</p>

</div>
</div>
<a id="a64dc4667540a9a2591b00635dea88423"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64dc4667540a9a2591b00635dea88423">&#9670;&nbsp;</a></span>Doc_timings</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::Multi_domain_functions::Doc_timings = false</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Boolean to indicate whether to doc timings or not. </p>

</div>
</div>
<a id="a2325d66c90ff388dfd6b2649a48e9827"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2325d66c90ff388dfd6b2649a48e9827">&#9670;&nbsp;</a></span>External_element_located</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; &gt; oomph::Multi_domain_functions::External_element_located</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Lookup scheme for whether a local element's integration point has had an external element assigned to it &ndash; essentially boolean. External_element_located[e][ipt] = {0,1} if external element for ipt-th integration in local element e {has not, has} been found. Used locally to ensure that we're not searching for the same elements over and over again when we go around the spirals. </p>

<p class="reference">Referenced by <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#af84f07f5b4632433203f4c4abf57da5f">aux_setup_multi_domain_interaction()</a>, <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a45a7960bff85287284bea3939dcda5c2">clean_up()</a>, and <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a969b893c0f6f013c78076e4013c0f34c">locate_zeta_for_local_coordinates()</a>.</p>

</div>
</div>
<a id="a2fa0a4a4e31700e161441b19f88c4bf3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2fa0a4a4e31700e161441b19f88c4bf3">&#9670;&nbsp;</a></span>Flat_packed_doubles</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; oomph::Multi_domain_functions::Flat_packed_doubles</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Vector of flat-packed doubles to be communicated with other processors </p>

<p class="reference">Referenced by <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a45a7960bff85287284bea3939dcda5c2">clean_up()</a>.</p>

</div>
</div>
<a id="a095771257db01cdebaaf92facc3057a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a095771257db01cdebaaf92facc3057a3">&#9670;&nbsp;</a></span>Flat_packed_located_coordinates</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; oomph::Multi_domain_functions::Flat_packed_located_coordinates</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Vector of flat-packed local coordinates for zeta tuples that have been located </p>

<p class="reference">Referenced by <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a45a7960bff85287284bea3939dcda5c2">clean_up()</a>.</p>

</div>
</div>
<a id="a5748b2389912d36f8f05cb175105c0a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5748b2389912d36f8f05cb175105c0a3">&#9670;&nbsp;</a></span>Flat_packed_unsigneds</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; oomph::Multi_domain_functions::Flat_packed_unsigneds</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Vector of flat-packed unsigneds to be communicated with other processors &ndash; this is really "private" data, declared here to avoid having to pass the array between the various helper functions </p>

<p class="reference">Referenced by <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a45a7960bff85287284bea3939dcda5c2">clean_up()</a>.</p>

</div>
</div>
<a id="a880374b0f685eeddca0c70b5a5d40a85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a880374b0f685eeddca0c70b5a5d40a85">&#9670;&nbsp;</a></span>Flat_packed_zetas_not_found_locally</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; oomph::Multi_domain_functions::Flat_packed_zetas_not_found_locally</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Vector of flat-packed zeta coordinates for which the external element could not be found during current local search. These will be sent to the next processor in the ring-like parallel search. The zeta coordinates come in groups of Dim (scalar) coordinates. </p>

<p class="reference">Referenced by <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#af84f07f5b4632433203f4c4abf57da5f">aux_setup_multi_domain_interaction()</a>, <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a45a7960bff85287284bea3939dcda5c2">clean_up()</a>, and <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a969b893c0f6f013c78076e4013c0f34c">locate_zeta_for_local_coordinates()</a>.</p>

</div>
</div>
<a id="ae6f22430d0d0df252be95eeda5c03151"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6f22430d0d0df252be95eeda5c03151">&#9670;&nbsp;</a></span>Located_element_status</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d0/d1d/classunsigned.html">unsigned</a> &gt; oomph::Multi_domain_functions::Located_element_status</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Vector to indicate (to another processor) whether a located element (that will have to represented as an external halo element on that processor) should be newly created on that processor (2), already exists on that processor (1), or is not on the current processor either (0). </p>

<p class="reference">Referenced by <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a45a7960bff85287284bea3939dcda5c2">clean_up()</a>.</p>

</div>
</div>
<a id="a05cf6413be5c69ff7535ebf0b8a153e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05cf6413be5c69ff7535ebf0b8a153e3">&#9670;&nbsp;</a></span>Proc_id_plus_one_of_external_element</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../d9/d2a/level1__real__impl_8h.html#a4e8e1c1bb9d4e05fc671fc133ec9dc9b">int</a> &gt; oomph::Multi_domain_functions::Proc_id_plus_one_of_external_element</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Proc_id_plus_one_of_external_element[i] contains the processor id (plus one) of the processor on which the i-th zeta coordinate tuple received from elsewhere (in the order in which these are stored in Received_flat_packed_zetas_to_be_found) was located; it's zero if it wasn't found during the current stage of the ring-like parallel search. </p>

<p class="reference">Referenced by <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a45a7960bff85287284bea3939dcda5c2">clean_up()</a>.</p>

</div>
</div>
<a id="aa5bb8d568feb34660caf8f88928f3be7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5bb8d568feb34660caf8f88928f3be7">&#9670;&nbsp;</a></span>Received_flat_packed_zetas_to_be_found</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; oomph::Multi_domain_functions::Received_flat_packed_zetas_to_be_found</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Vector of flat-packed zeta coordinates for which the external element could not be found on another processor and for which we're currently searching here. Whatever can't be found here, gets written into Flat_packed_zetas_not_found_locally and then passed on to the next processor during the ring-like parallel search. The zeta coordinates come in groups of Dim (scalar) coordinates. </p>

<p class="reference">Referenced by <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a45a7960bff85287284bea3939dcda5c2">clean_up()</a>.</p>

</div>
</div>
<a id="abc1119753cf68493ba6ea43c2a8bc378"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc1119753cf68493ba6ea43c2a8bc378">&#9670;&nbsp;</a></span>Use_bulk_element_as_external</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::Multi_domain_functions::Use_bulk_element_as_external = false</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Boolean to indicate when to use the bulk element as the external element. Defaults to false, you must have set up FaceElements properly first in order for it to work </p>

<p class="reference">Referenced by <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#af84f07f5b4632433203f4c4abf57da5f">aux_setup_multi_domain_interaction()</a>, <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#a969b893c0f6f013c78076e4013c0f34c">locate_zeta_for_local_coordinates()</a>, and <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#ac64183e03f173c69ed6ed6f493a1a67e">setup_multi_domain_interaction()</a>.</p>

</div>
</div>
<a id="a5f14db731fddbd057f4099fbdba95cc0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f14db731fddbd057f4099fbdba95cc0">&#9670;&nbsp;</a></span>Zeta_coords_for_further_away_comparison</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/df6/classoomph_1_1Vector.html">Vector</a>&lt;<a class="el" href="../../df/de6/classdouble.html">double</a>&gt; oomph::Multi_domain_functions::Zeta_coords_for_further_away_comparison</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Vector of zeta coordinates that we're currently trying to locate; used in sorting of bin entries in further_away() comparison function </p>

<p class="reference">Referenced by <a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html#ad9baf8c647dbd10164c28f12cbb04f85">first_closer_than_second()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../da/ddf/namespaceoomph.html">oomph</a></li><li class="navelem"><a class="el" href="../../d3/d65/namespaceoomph_1_1Multi__domain__functions.html">Multi_domain_functions</a></li>
    <li class="footer">Generated on Wed Aug 27 2025 17:09:39 for MercuryDPM by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
