<!-- HTML header for doxygen 1.8.18-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MercuryDPM: oomph::GeneralisedHookean Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../MDPM.css" rel="stylesheet" type="text/css"/>
<link href="../../codeLabels.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-fork-corner.css" rel="stylesheet" type="text/css"/>
<link href="../../MDPM-dropdown-version.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../MDPM-fragment-copy-button.js"></script>
<script type="text/javascript">
DoxygenAwesomeFragmentCopyButton.init()
</script>
<script type="text/javascript" src="../../MDPM-paragraph-link.js"></script>
<script type="text/javascript">
DoxygenAwesomeParagraphLink.init()
</script>
<script type="text/javascript" src="../../MDPM-interactive-toc.js"></script>
<script type="text/javascript">
DoxygenAwesomeInteractiveToc.init()
</script>
<script type="text/javascript" src="../../MDPM-darkmode-toggle.js"></script>
<script type="text/javascript">
DoxygenAwesomeDarkModeToggle.init()
</script>
</head>
<body>
  <div id="bitbucket-corner">
   <a href="https://bitbucket.org/mercurydpm/mercurydpm/src/master/" target="_blank" id="fork-corner" class="fork-corner fc-pos-tr fc-animate fc-theme-bitbucket"></a>
  </div>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../mercury-logo-chosen-light-slogan.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"> <!--MercuryDPM--!>
   <!-- BEGIN version select -->
   <div class="dropdown" id="projectnumber">
    <button class="dropbtn">v1.0</button>
    <div class="dropdown-content">
    </div>
   </div>
   <script type="text/javascript" src="../../MDPM-dropdown-version.js"></script>
<!-- END version select -->
   <!--&#160;<span id="projectnumber">revision: v1.0</span>-->
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<script type="text/javascript" src="../../MDPM-fork-corner.js"></script>
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d3/d66/classoomph_1_1GeneralisedHookean.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="../../dc/d18/classoomph_1_1GeneralisedHookean-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">oomph::GeneralisedHookean Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="../../d4/d26/constitutive__laws_8h_source.html">constitutive_laws.h</a>&gt;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Inheritance diagram for oomph::GeneralisedHookean:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
 <div class="center">
  <img src="../../d3/d66/classoomph_1_1GeneralisedHookean.png" usemap="#oomph::GeneralisedHookean_map" alt=""/>
  <map id="oomph::GeneralisedHookean_map" name="oomph::GeneralisedHookean_map">
<area href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html" alt="oomph::ConstitutiveLaw" shape="rect" coords="0,0,173,24"/>
<area href="../../d4/d7c/classoomph_1_1AnisotropicHookean.html" alt="oomph::AnisotropicHookean" shape="rect" coords="0,112,173,136"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ae345f3619a2826b4547f7cb42a052ca6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d66/classoomph_1_1GeneralisedHookean.html#ae345f3619a2826b4547f7cb42a052ca6">GeneralisedHookean</a> (<a class="el" href="../../df/de6/classdouble.html">double</a> *nu_pt, <a class="el" href="../../df/de6/classdouble.html">double</a> *e_pt)</td></tr>
<tr class="separator:ae345f3619a2826b4547f7cb42a052ca6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a470dde76fd6603da69bf4b6f12c50917"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d66/classoomph_1_1GeneralisedHookean.html#a470dde76fd6603da69bf4b6f12c50917">GeneralisedHookean</a> (<a class="el" href="../../df/de6/classdouble.html">double</a> *nu_pt)</td></tr>
<tr class="separator:a470dde76fd6603da69bf4b6f12c50917"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18794fa4b1750aafa2369b2a412a1228"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d66/classoomph_1_1GeneralisedHookean.html#a18794fa4b1750aafa2369b2a412a1228">~GeneralisedHookean</a> ()</td></tr>
<tr class="memdesc:a18794fa4b1750aafa2369b2a412a1228"><td class="mdescLeft">&#160;</td><td class="mdescRight">Virtual destructor.  <a href="../../d3/d66/classoomph_1_1GeneralisedHookean.html#a18794fa4b1750aafa2369b2a412a1228">More...</a><br /></td></tr>
<tr class="separator:a18794fa4b1750aafa2369b2a412a1228"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5beca3e59f04d109c394bf9fd24bb7c1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d66/classoomph_1_1GeneralisedHookean.html#a5beca3e59f04d109c394bf9fd24bb7c1">calculate_second_piola_kirchhoff_stress</a> (const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;g, const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>, <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;sigma)</td></tr>
<tr class="separator:a5beca3e59f04d109c394bf9fd24bb7c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a641d0893e485df52b48b15e189a850ed"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d66/classoomph_1_1GeneralisedHookean.html#a641d0893e485df52b48b15e189a850ed">calculate_second_piola_kirchhoff_stress</a> (const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;g, const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>, <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;sigma_dev, <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;G_contra, <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;Gdet)</td></tr>
<tr class="separator:a641d0893e485df52b48b15e189a850ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad19b5e80755f5d8e5513c4199f62fe03"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d66/classoomph_1_1GeneralisedHookean.html#ad19b5e80755f5d8e5513c4199f62fe03">calculate_second_piola_kirchhoff_stress</a> (const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;g, const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>, <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;sigma_dev, <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;Gcontra, <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;gen_dil, <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;inv_kappa)</td></tr>
<tr class="separator:ad19b5e80755f5d8e5513c4199f62fe03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ed467d8b7c838cb7fed8c861aa652e9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d66/classoomph_1_1GeneralisedHookean.html#a9ed467d8b7c838cb7fed8c861aa652e9">requires_incompressibility_constraint</a> ()</td></tr>
<tr class="separator:a9ed467d8b7c838cb7fed8c861aa652e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classoomph_1_1ConstitutiveLaw"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classoomph_1_1ConstitutiveLaw')"><img src="../../closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html">oomph::ConstitutiveLaw</a></td></tr>
<tr class="memitem:a864c36413e8ea31e63552f3db3b97a2f inherit pub_methods_classoomph_1_1ConstitutiveLaw"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a864c36413e8ea31e63552f3db3b97a2f">ConstitutiveLaw</a> ()</td></tr>
<tr class="memdesc:a864c36413e8ea31e63552f3db3b97a2f inherit pub_methods_classoomph_1_1ConstitutiveLaw"><td class="mdescLeft">&#160;</td><td class="mdescRight">Empty constructor.  <a href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a864c36413e8ea31e63552f3db3b97a2f">More...</a><br /></td></tr>
<tr class="separator:a864c36413e8ea31e63552f3db3b97a2f inherit pub_methods_classoomph_1_1ConstitutiveLaw"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa75b88c826723ba090ace39c26da0ae6 inherit pub_methods_classoomph_1_1ConstitutiveLaw"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#aa75b88c826723ba090ace39c26da0ae6">~ConstitutiveLaw</a> ()</td></tr>
<tr class="memdesc:aa75b88c826723ba090ace39c26da0ae6 inherit pub_methods_classoomph_1_1ConstitutiveLaw"><td class="mdescLeft">&#160;</td><td class="mdescRight">Empty virtual destructor.  <a href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#aa75b88c826723ba090ace39c26da0ae6">More...</a><br /></td></tr>
<tr class="separator:aa75b88c826723ba090ace39c26da0ae6 inherit pub_methods_classoomph_1_1ConstitutiveLaw"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6076752384082cfa3de3e0cf17daa9aa inherit pub_methods_classoomph_1_1ConstitutiveLaw"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a6076752384082cfa3de3e0cf17daa9aa">calculate_d_second_piola_kirchhoff_stress_dG</a> (const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;g, const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>, const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;sigma, <a class="el" href="../../d7/dbb/classoomph_1_1RankFourTensor.html">RankFourTensor</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;d_sigma_dG, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;symmetrize_tensor=true)</td></tr>
<tr class="separator:a6076752384082cfa3de3e0cf17daa9aa inherit pub_methods_classoomph_1_1ConstitutiveLaw"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af13f9d05db09870d1b90b7ef389bdb71 inherit pub_methods_classoomph_1_1ConstitutiveLaw"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#af13f9d05db09870d1b90b7ef389bdb71">calculate_d_second_piola_kirchhoff_stress_dG</a> (const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;g, const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>, const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;sigma, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;detG, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;interpolated_solid_p, <a class="el" href="../../d7/dbb/classoomph_1_1RankFourTensor.html">RankFourTensor</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;d_sigma_dG, <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;d_detG_dG, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;symmetrize_tensor=true)</td></tr>
<tr class="separator:af13f9d05db09870d1b90b7ef389bdb71 inherit pub_methods_classoomph_1_1ConstitutiveLaw"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a4f1bcac8d308d9ad0013ddf5def505 inherit pub_methods_classoomph_1_1ConstitutiveLaw"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a8a4f1bcac8d308d9ad0013ddf5def505">calculate_d_second_piola_kirchhoff_stress_dG</a> (const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;g, const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>, const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;sigma, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;gen_dil, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;inv_kappa, const <a class="el" href="../../df/de6/classdouble.html">double</a> &amp;interpolated_solid_p, <a class="el" href="../../d7/dbb/classoomph_1_1RankFourTensor.html">RankFourTensor</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;d_sigma_dG, <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;d_gen_dil_dG, const <a class="el" href="../../d9/db9/classbool.html">bool</a> &amp;symmetrize_tensor=true)</td></tr>
<tr class="separator:a8a4f1bcac8d308d9ad0013ddf5def505 inherit pub_methods_classoomph_1_1ConstitutiveLaw"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:ad719ee5ed6d1bcacb18fec3339ae98de"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d66/classoomph_1_1GeneralisedHookean.html#ad719ee5ed6d1bcacb18fec3339ae98de">Nu_pt</a></td></tr>
<tr class="memdesc:ad719ee5ed6d1bcacb18fec3339ae98de"><td class="mdescLeft">&#160;</td><td class="mdescRight">Poisson ratio.  <a href="../../d3/d66/classoomph_1_1GeneralisedHookean.html#ad719ee5ed6d1bcacb18fec3339ae98de">More...</a><br /></td></tr>
<tr class="separator:ad719ee5ed6d1bcacb18fec3339ae98de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a68b35f227848a065a7a844766b4eeb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d66/classoomph_1_1GeneralisedHookean.html#a7a68b35f227848a065a7a844766b4eeb">E_pt</a></td></tr>
<tr class="memdesc:a7a68b35f227848a065a7a844766b4eeb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Young's modulus.  <a href="../../d3/d66/classoomph_1_1GeneralisedHookean.html#a7a68b35f227848a065a7a844766b4eeb">More...</a><br /></td></tr>
<tr class="separator:a7a68b35f227848a065a7a844766b4eeb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21d4ef7498c2efd5bf30fa0ecd0d7dd5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d66/classoomph_1_1GeneralisedHookean.html#a21d4ef7498c2efd5bf30fa0ecd0d7dd5">Must_delete_e</a></td></tr>
<tr class="separator:a21d4ef7498c2efd5bf30fa0ecd0d7dd5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_methods_classoomph_1_1ConstitutiveLaw"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classoomph_1_1ConstitutiveLaw')"><img src="../../closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html">oomph::ConstitutiveLaw</a></td></tr>
<tr class="memitem:a73f01e1459e7ba998ef78f7ece6baa37 inherit pro_methods_classoomph_1_1ConstitutiveLaw"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a73f01e1459e7ba998ef78f7ece6baa37">is_matrix_square</a> (const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../d8/d3e/bench__gemm_8cpp.html#a989df10ff46666a2610162f3d1a90057">M</a>)</td></tr>
<tr class="memdesc:a73f01e1459e7ba998ef78f7ece6baa37 inherit pro_methods_classoomph_1_1ConstitutiveLaw"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test whether a matrix is square.  <a href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a73f01e1459e7ba998ef78f7ece6baa37">More...</a><br /></td></tr>
<tr class="separator:a73f01e1459e7ba998ef78f7ece6baa37 inherit pro_methods_classoomph_1_1ConstitutiveLaw"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a89bb96a9b922294509923563a13063 inherit pro_methods_classoomph_1_1ConstitutiveLaw"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/db9/classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a8a89bb96a9b922294509923563a13063">are_matrices_of_equal_dimensions</a> (const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../d3/ddc/Tutorial__ReshapeMat2Vec_8cpp.html#a967134325b7c05c13dab4684a33b2da0">M1</a>, const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../dd/d24/Tutorial__SlicingCol_8cpp.html#a7aceba2743387d50fd551de7c39a95c5">M2</a>)</td></tr>
<tr class="memdesc:a8a89bb96a9b922294509923563a13063 inherit pro_methods_classoomph_1_1ConstitutiveLaw"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test whether two matrices are of equal dimensions.  <a href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a8a89bb96a9b922294509923563a13063">More...</a><br /></td></tr>
<tr class="separator:a8a89bb96a9b922294509923563a13063 inherit pro_methods_classoomph_1_1ConstitutiveLaw"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01763658a56a962460a80607653a33b4 inherit pro_methods_classoomph_1_1ConstitutiveLaw"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a01763658a56a962460a80607653a33b4">error_checking_in_input</a> (const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;g, const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;<a class="el" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>, <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;sigma)</td></tr>
<tr class="separator:a01763658a56a962460a80607653a33b4 inherit pro_methods_classoomph_1_1ConstitutiveLaw"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c188df10b08b340b923c3a733c0d178 inherit pro_methods_classoomph_1_1ConstitutiveLaw"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/de6/classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a5c188df10b08b340b923c3a733c0d178">calculate_contravariant</a> (const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;Gcov, <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;Gcontra)</td></tr>
<tr class="memdesc:a5c188df10b08b340b923c3a733c0d178 inherit pro_methods_classoomph_1_1ConstitutiveLaw"><td class="mdescLeft">&#160;</td><td class="mdescRight">The function to calculate the contravariant tensor from a covariant one.  <a href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a5c188df10b08b340b923c3a733c0d178">More...</a><br /></td></tr>
<tr class="separator:a5c188df10b08b340b923c3a733c0d178 inherit pro_methods_classoomph_1_1ConstitutiveLaw"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6dda64e60ed8128cb4603041dc66036f inherit pro_methods_classoomph_1_1ConstitutiveLaw"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a6dda64e60ed8128cb4603041dc66036f">calculate_d_contravariant_dG</a> (const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;Gcov, <a class="el" href="../../d7/dbb/classoomph_1_1RankFourTensor.html">RankFourTensor</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;dGcontra_dG, <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;d_detG_dG)</td></tr>
<tr class="separator:a6dda64e60ed8128cb4603041dc66036f inherit pro_methods_classoomph_1_1ConstitutiveLaw"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>////////////////////////////////////////////////////////////////////// ////////////////////////////////////////////////////////////////////// ////////////////////////////////////////////////////////////////////// Class for a "non-rational" extension of classical linear elasticity to large displacements: </p><p class="formulaDsp">
\[ \sigma^{ij} = E^{ijkl} \gamma_{kl} \]
</p>
<p> where </p><p class="formulaDsp">
\[ E^{ijkl} = \frac{E}{(1+\nu)} \left( \frac{\nu}{(1-2\nu)} G^{ij} G^{kl} + \frac{1}{2} \left( G^{ik} G^{jl} + G^{il} G^{jk} \right) \right) \]
</p>
<p> For small strains \( (| G_{ij} - g_{ij} | \ll 1)\) this approaches the version appropriate for linear elasticity, obtained by replacing \( G^{ij}\) with \( g^{ij}\).</p>
<p>We provide three versions of <code>calculate_second_piola_kirchhoff_stress()</code>:</p><ol type="1">
<li>If \( \nu \ne 1/2 \) (and not close to \( 1/2 \)), the constitutive law can be used directly in the above form, using the deformed and undeformed metric tensors as input.</li>
<li><p class="startli">If the material is incompressible ( \( \nu = 1/2 \)), the first term in the above expression for \( E^{ijkl} \) is singular. We re-write the constitutive equation for this case as</p>
<p class="formulaDsp">
\[ \sigma^{ij} = -p G^{ij} + \frac{E}{3} \left( G^{ik} G^{jl} + G^{il} G^{jk} \right) \gamma_{kl} \]
</p>
<p> where the pressure \( p \) needs to be determined independently via the incompressibility constraint. In this case, the stress returned by <code>calculate_second_piola_kirchhoff_stress()</code> contains only the deviatoric part of the 2nd Piola Kirchhoff stress,</p>
<p class="formulaDsp">
\[ \overline{\sigma}^{ij} = \frac{E}{3} \left( G^{ik} G^{jl} + G^{il} G^{jk} \right) \gamma_{kl}. \]
</p>
<p> The function also returns the contravariant metric tensor \( G^{ij}\) (since it is needed to form the complete stress tensor), and the determinant of the deformed covariant metric tensor \( {\tt detG} = \det G_{ij} \) (since it is needed in the equation that enforces the incompressibility).</p>
</li>
<li><p class="startli">If \( \nu \approx 1/2 \), the original form of the constitutive equation could be used, but the resulting equations tend to be ill-conditioned since they contain the product of the large "bulk modulus"</p>
<p class="formulaDsp">
\[ \kappa = \frac{E\nu}{(1+\nu)(1-2\nu)} \]
</p>
<p> and the small "generalised dilatation"</p>
<p class="formulaDsp">
\[ d = \frac{1}{2} G^{ij} (G_{ij}-g_{ij}). \]
</p>
<p> [ \( d \) represents the actual dilatation in the small strain limit; for large deformations it doesn't have any sensible interpretation (or does it?). It is simply the term that needs to go to zero as \( \kappa \to \infty\).] In this case, the stress returned by <code>calculate_second_piola_kirchhoff_stress()</code> contains only the deviatoric part of the 2nd Piola Kirchhoff stress,</p>
<p class="formulaDsp">
\[ \overline{\sigma}^{ij} = \frac{E}{3} \left( G^{ik} G^{jl} + G^{il} G^{jk} \right) \gamma_{kl}. \]
</p>
<p> The function also returns the contravariant metric tensor \( G^{ij}\) (since it is needed to form the complete stress tensor), the inverse of the bulk modulus, and the generalised dilatation (since they are needed in the equation that determines the pressure). </p>
</li>
</ol>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ae345f3619a2826b4547f7cb42a052ca6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae345f3619a2826b4547f7cb42a052ca6">&#9670;&nbsp;</a></span>GeneralisedHookean() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">oomph::GeneralisedHookean::GeneralisedHookean </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a> *&#160;</td>
          <td class="paramname"><em>nu_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a> *&#160;</td>
          <td class="paramname"><em>e_pt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The constructor takes the pointers to values of material parameters: Poisson's ratio and Young's modulus. </p>
<div class="fragment"><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;      : <a class="code" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a864c36413e8ea31e63552f3db3b97a2f">ConstitutiveLaw</a>(), <a class="code" href="../../d3/d66/classoomph_1_1GeneralisedHookean.html#ad719ee5ed6d1bcacb18fec3339ae98de">Nu_pt</a>(nu_pt), <a class="code" href="../../d3/d66/classoomph_1_1GeneralisedHookean.html#a7a68b35f227848a065a7a844766b4eeb">E_pt</a>(e_pt), <a class="code" href="../../d3/d66/classoomph_1_1GeneralisedHookean.html#a21d4ef7498c2efd5bf30fa0ecd0d7dd5">Must_delete_e</a>(<span class="keyword">false</span>)</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    {</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    }</div>
<div class="ttc" id="aclassoomph_1_1ConstitutiveLaw_html_a864c36413e8ea31e63552f3db3b97a2f"><div class="ttname"><a href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a864c36413e8ea31e63552f3db3b97a2f">oomph::ConstitutiveLaw::ConstitutiveLaw</a></div><div class="ttdeci">ConstitutiveLaw()</div><div class="ttdoc">Empty constructor.</div><div class="ttdef"><b>Definition:</b> constitutive_laws.h:501</div></div>
<div class="ttc" id="aclassoomph_1_1GeneralisedHookean_html_a21d4ef7498c2efd5bf30fa0ecd0d7dd5"><div class="ttname"><a href="../../d3/d66/classoomph_1_1GeneralisedHookean.html#a21d4ef7498c2efd5bf30fa0ecd0d7dd5">oomph::GeneralisedHookean::Must_delete_e</a></div><div class="ttdeci">bool Must_delete_e</div><div class="ttdef"><b>Definition:</b> constitutive_laws.h:787</div></div>
<div class="ttc" id="aclassoomph_1_1GeneralisedHookean_html_a7a68b35f227848a065a7a844766b4eeb"><div class="ttname"><a href="../../d3/d66/classoomph_1_1GeneralisedHookean.html#a7a68b35f227848a065a7a844766b4eeb">oomph::GeneralisedHookean::E_pt</a></div><div class="ttdeci">double * E_pt</div><div class="ttdoc">Young's modulus.</div><div class="ttdef"><b>Definition:</b> constitutive_laws.h:783</div></div>
<div class="ttc" id="aclassoomph_1_1GeneralisedHookean_html_ad719ee5ed6d1bcacb18fec3339ae98de"><div class="ttname"><a href="../../d3/d66/classoomph_1_1GeneralisedHookean.html#ad719ee5ed6d1bcacb18fec3339ae98de">oomph::GeneralisedHookean::Nu_pt</a></div><div class="ttdeci">double * Nu_pt</div><div class="ttdoc">Poisson ratio.</div><div class="ttdef"><b>Definition:</b> constitutive_laws.h:780</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a470dde76fd6603da69bf4b6f12c50917"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a470dde76fd6603da69bf4b6f12c50917">&#9670;&nbsp;</a></span>GeneralisedHookean() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">oomph::GeneralisedHookean::GeneralisedHookean </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a> *&#160;</td>
          <td class="paramname"><em>nu_pt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The constructor takes the pointers to value of Poisson's ratio . Young's modulus is set to E=1.0, implying that all stresses have been non-dimensionalised on on it. </p>
<div class="fragment"><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;      : <a class="code" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a864c36413e8ea31e63552f3db3b97a2f">ConstitutiveLaw</a>(),</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        <a class="code" href="../../d3/d66/classoomph_1_1GeneralisedHookean.html#ad719ee5ed6d1bcacb18fec3339ae98de">Nu_pt</a>(nu_pt),</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        <a class="code" href="../../d3/d66/classoomph_1_1GeneralisedHookean.html#a7a68b35f227848a065a7a844766b4eeb">E_pt</a>(<span class="keyword">new</span> <span class="keywordtype">double</span>(1.0)),</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        <a class="code" href="../../d3/d66/classoomph_1_1GeneralisedHookean.html#a21d4ef7498c2efd5bf30fa0ecd0d7dd5">Must_delete_e</a>(<span class="keyword">true</span>)</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    {</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a18794fa4b1750aafa2369b2a412a1228"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18794fa4b1750aafa2369b2a412a1228">&#9670;&nbsp;</a></span>~GeneralisedHookean()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual oomph::GeneralisedHookean::~GeneralisedHookean </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Virtual destructor. </p>
<div class="fragment"><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    {</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d3/d66/classoomph_1_1GeneralisedHookean.html#a21d4ef7498c2efd5bf30fa0ecd0d7dd5">Must_delete_e</a>) <span class="keyword">delete</span> <a class="code" href="../../d3/d66/classoomph_1_1GeneralisedHookean.html#a7a68b35f227848a065a7a844766b4eeb">E_pt</a>;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d3/d66/classoomph_1_1GeneralisedHookean.html#a7a68b35f227848a065a7a844766b4eeb">E_pt</a>, and <a class="el" href="../../d3/d66/classoomph_1_1GeneralisedHookean.html#a21d4ef7498c2efd5bf30fa0ecd0d7dd5">Must_delete_e</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a5beca3e59f04d109c394bf9fd24bb7c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5beca3e59f04d109c394bf9fd24bb7c1">&#9670;&nbsp;</a></span>calculate_second_piola_kirchhoff_stress() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::GeneralisedHookean::calculate_second_piola_kirchhoff_stress </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>sigma</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Calculate the contravariant 2nd Piola Kirchhoff stress tensor. Arguments are the covariant undeformed and deformed metric tensor and the matrix in which to return the stress tensor</p>
<p>////////////////////////////////////////////////////////////////// ////////////////////////////////////////////////////////////////// ////////////////////////////////////////////////////////////////// Calculate the contravariant 2nd Piola Kirchhoff stress tensor. Arguments are the covariant undeformed (stress-free) and deformed metric tensors, g and G, and the matrix in which to return the stress tensor. </p>

<p>Implements <a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a93527d910de908035feb8f41b0401065">oomph::ConstitutiveLaw</a>.</p>
<div class="fragment"><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;  {</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="comment">// Error checking</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <a class="code" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a01763658a56a962460a80607653a33b4">error_checking_in_input</a>(g, <a class="code" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>, <a class="code" href="../../d9/d33/namespacecalibrate.html#a6caaf28555dab8f7d970d42592f6bc44">sigma</a>);</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160; </div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <span class="comment">// Find the dimension of the problem</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <span class="keywordtype">unsigned</span> dim = <a class="code" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>.nrow();</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160; </div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="comment">// Calculate the contravariant Deformed metric tensor</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <a class="code" href="../../dc/d34/classEigen_1_1Matrix.html">DenseMatrix&lt;double&gt;</a> Gup(dim);</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    <span class="comment">// We don&#39;t need the Jacobian so cast the function to void</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    (void)<a class="code" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a5c188df10b08b340b923c3a733c0d178">calculate_contravariant</a>(<a class="code" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>, Gup);</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160; </div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <span class="comment">// Premultiply some constants</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../de/dbd/namespaceGlobal__Physical__Variables.html#a849754fa7155c1a31481674ce4845658">C1</a> = (*E_pt) / (2.0 * (1.0 + (*Nu_pt)));</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../de/dbd/namespaceGlobal__Physical__Variables.html#af9defd1b5745cce50d2c386b3ac0e0ae">C2</a> = 2.0 * (*Nu_pt) / (1.0 - 2.0 * (*Nu_pt));</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160; </div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="comment">// Strain tensor</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <a class="code" href="../../dc/d34/classEigen_1_1Matrix.html">DenseMatrix&lt;double&gt;</a> strain(dim, dim);</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160; </div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <span class="comment">// Upper triangle</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; dim; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    {</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; dim; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;      {</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        strain(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) = 0.5 * (<a class="code" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) - g(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>));</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;      }</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    }</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160; </div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <span class="comment">// Copy across</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; dim; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    {</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;      {</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        strain(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) = strain(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;      }</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    }</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160; </div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    <span class="comment">// Compute upper triangle of stress</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; dim; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    {</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; dim; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;      {</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        <span class="comment">// Initialise this component of sigma</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        <a class="code" href="../../d9/d33/namespacecalibrate.html#a6caaf28555dab8f7d970d42592f6bc44">sigma</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) = 0.0;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> = 0; <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> &lt; dim; <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>++)</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;        {</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> l = 0; l &lt; dim; l++)</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;          {</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;            <a class="code" href="../../d9/d33/namespacecalibrate.html#a6caaf28555dab8f7d970d42592f6bc44">sigma</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) += <a class="code" href="../../de/dbd/namespaceGlobal__Physical__Variables.html#a849754fa7155c1a31481674ce4845658">C1</a> *</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                           (Gup(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>) * Gup(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, l) + Gup(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, l) * Gup(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>) +</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                            <a class="code" href="../../de/dbd/namespaceGlobal__Physical__Variables.html#af9defd1b5745cce50d2c386b3ac0e0ae">C2</a> * Gup(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) * Gup(<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>, l)) *</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                           strain(<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>, l);</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;          }</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        }</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;      }</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    }</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160; </div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    <span class="comment">// Copy across</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; dim; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    {</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;      {</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;        <a class="code" href="../../d9/d33/namespacecalibrate.html#a6caaf28555dab8f7d970d42592f6bc44">sigma</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) = <a class="code" href="../../d9/d33/namespacecalibrate.html#a6caaf28555dab8f7d970d42592f6bc44">sigma</a>(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;      }</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    }</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;  }</div>
<div class="ttc" id="aBiCGSTAB__step__by__step_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> BiCGSTAB_step_by_step.cpp:9</div></div>
<div class="ttc" id="aJacobi__makeGivens_8cpp_html_ad2c49539791450cfceedabc09452d977"><div class="ttname"><a href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a></div><div class="ttdeci">JacobiRotation&lt; float &gt; G</div><div class="ttdef"><b>Definition:</b> Jacobi_makeGivens.cpp:2</div></div>
<div class="ttc" id="aclassEigen_1_1Matrix_html"><div class="ttname"><a href="../../dc/d34/classEigen_1_1Matrix.html">Eigen::Matrix&lt; Scalar, Dynamic, Dynamic &gt;</a></div></div>
<div class="ttc" id="aclassoomph_1_1ConstitutiveLaw_html_a01763658a56a962460a80607653a33b4"><div class="ttname"><a href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a01763658a56a962460a80607653a33b4">oomph::ConstitutiveLaw::error_checking_in_input</a></div><div class="ttdeci">void error_checking_in_input(const DenseMatrix&lt; double &gt; &amp;g, const DenseMatrix&lt; double &gt; &amp;G, DenseMatrix&lt; double &gt; &amp;sigma)</div><div class="ttdef"><b>Definition:</b> constitutive_laws.cc:71</div></div>
<div class="ttc" id="aclassoomph_1_1ConstitutiveLaw_html_a5c188df10b08b340b923c3a733c0d178"><div class="ttname"><a href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a5c188df10b08b340b923c3a733c0d178">oomph::ConstitutiveLaw::calculate_contravariant</a></div><div class="ttdeci">double calculate_contravariant(const DenseMatrix&lt; double &gt; &amp;Gcov, DenseMatrix&lt; double &gt; &amp;Gcontra)</div><div class="ttdoc">The function to calculate the contravariant tensor from a covariant one.</div><div class="ttdef"><b>Definition:</b> constitutive_laws.cc:113</div></div>
<div class="ttc" id="alevel2__impl_8h_html_ad46ea6bf5745e72b985b11878e46a45d"><div class="ttname"><a href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a></div><div class="ttdeci">char char char int int * k</div><div class="ttdef"><b>Definition:</b> level2_impl.h:374</div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a849754fa7155c1a31481674ce4845658"><div class="ttname"><a href="../../de/dbd/namespaceGlobal__Physical__Variables.html#a849754fa7155c1a31481674ce4845658">Global_Physical_Variables::C1</a></div><div class="ttdeci">double C1</div><div class="ttdoc">&quot;Mooney Rivlin&quot; coefficient for generalised Mooney Rivlin law</div><div class="ttdef"><b>Definition:</b> TwenteMeshGluing.cpp:74</div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_af9defd1b5745cce50d2c386b3ac0e0ae"><div class="ttname"><a href="../../de/dbd/namespaceGlobal__Physical__Variables.html#af9defd1b5745cce50d2c386b3ac0e0ae">Global_Physical_Variables::C2</a></div><div class="ttdeci">double C2</div><div class="ttdoc">&quot;Mooney Rivlin&quot; coefficient for generalised Mooney Rivlin law</div><div class="ttdef"><b>Definition:</b> mpi/distribution/airy_cantilever/airy_cantilever2.cc:156</div></div>
<div class="ttc" id="anamespacecalibrate_html_a6caaf28555dab8f7d970d42592f6bc44"><div class="ttname"><a href="../../d9/d33/namespacecalibrate.html#a6caaf28555dab8f7d970d42592f6bc44">calibrate.sigma</a></div><div class="ttdeci">int sigma</div><div class="ttdef"><b>Definition:</b> calibrate.py:179</div></div>
<div class="ttc" id="atut__arithmetic__redux__minmax_8cpp_html_a39513f0f8d942bf9ef17b2e87ac6d34e"><div class="ttname"><a href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a></div><div class="ttdeci">std::ptrdiff_t j</div><div class="ttdef"><b>Definition:</b> tut_arithmetic_redux_minmax.cpp:2</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../de/dbd/namespaceGlobal__Physical__Variables.html#a849754fa7155c1a31481674ce4845658">Global_Physical_Variables::C1</a>, <a class="el" href="../../de/dbd/namespaceGlobal__Physical__Variables.html#af9defd1b5745cce50d2c386b3ac0e0ae">Global_Physical_Variables::C2</a>, <a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a5c188df10b08b340b923c3a733c0d178">oomph::ConstitutiveLaw::calculate_contravariant()</a>, <a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a01763658a56a962460a80607653a33b4">oomph::ConstitutiveLaw::error_checking_in_input()</a>, <a class="el" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="el" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>, and <a class="el" href="../../d9/d33/namespacecalibrate.html#a6caaf28555dab8f7d970d42592f6bc44">calibrate::sigma</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d7c/classoomph_1_1AnisotropicHookean.html#ab625b1690562e22063d8afdff7cddd89">oomph::AnisotropicHookean::calculate_second_piola_kirchhoff_stress()</a>, and <a class="el" href="../../d3/d66/classoomph_1_1GeneralisedHookean.html#ad19b5e80755f5d8e5513c4199f62fe03">calculate_second_piola_kirchhoff_stress()</a>.</p>

</div>
</div>
<a id="a641d0893e485df52b48b15e189a850ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a641d0893e485df52b48b15e189a850ed">&#9670;&nbsp;</a></span>calculate_second_piola_kirchhoff_stress() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::GeneralisedHookean::calculate_second_piola_kirchhoff_stress </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>sigma_dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>Gup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>detG</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Calculate the deviatoric part \( \overline{ \sigma^{ij}}\) of the contravariant 2nd Piola Kirchhoff stress tensor \( \sigma^{ij}\). Also return the contravariant deformed metric tensor and the determinant of the deformed metric tensor. This form is appropriate for truly-incompressible materials for which \( \sigma^{ij} = - p G^{ij} +\overline{ \sigma^{ij}} \) where the "pressure" \( p \) is determined by \( \det G_{ij} - \det g_{ij} = 0 \). </p>

<p>Reimplemented from <a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#ac8178b1b7cd7e6a64942dba9e0997b30">oomph::ConstitutiveLaw</a>.</p>
<div class="fragment"><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  {</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    <span class="comment">// Error checking</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    <a class="code" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a01763658a56a962460a80607653a33b4">error_checking_in_input</a>(g, <a class="code" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>, sigma_dev);</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160; </div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    <span class="comment">// Find the dimension of the problem</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    <span class="keywordtype">unsigned</span> dim = <a class="code" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>.nrow();</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160; </div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    <span class="comment">// Calculate the contravariant Deformed metric tensor</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    detG = <a class="code" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a5c188df10b08b340b923c3a733c0d178">calculate_contravariant</a>(<a class="code" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>, Gup);</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160; </div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    <span class="comment">// Premultiply the appropriate physical constant</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../de/dbd/namespaceGlobal__Physical__Variables.html#a849754fa7155c1a31481674ce4845658">C1</a> = (*E_pt) / (2.0 * (1.0 + (*Nu_pt)));</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160; </div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    <span class="comment">// Strain tensor</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    <a class="code" href="../../dc/d34/classEigen_1_1Matrix.html">DenseMatrix&lt;double&gt;</a> strain(dim, dim);</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160; </div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    <span class="comment">// Upper triangle</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; dim; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    {</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; dim; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;      {</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;        strain(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) = 0.5 * (<a class="code" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) - g(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>));</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;      }</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    }</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160; </div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <span class="comment">// Copy across</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; dim; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    {</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;      {</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        strain(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) = strain(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;      }</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    }</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160; </div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <span class="comment">// Compute upper triangle of stress</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; dim; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    {</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; dim; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;      {</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        <span class="comment">// Initialise this component of sigma</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;        sigma_dev(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) = 0.0;</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> = 0; <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a> &lt; dim; <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>++)</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;        {</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> l = 0; l &lt; dim; l++)</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;          {</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;            sigma_dev(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) += <a class="code" href="../../de/dbd/namespaceGlobal__Physical__Variables.html#a849754fa7155c1a31481674ce4845658">C1</a> *</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                               (Gup(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>) * Gup(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, l) + Gup(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, l) * Gup(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>)) *</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                               strain(<a class="code" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>, l);</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;          }</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;        }</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;      }</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    }</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160; </div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    <span class="comment">// Copy across</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; dim; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    {</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;      {</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;        sigma_dev(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) = sigma_dev(<a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;      }</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    }</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../de/dbd/namespaceGlobal__Physical__Variables.html#a849754fa7155c1a31481674ce4845658">Global_Physical_Variables::C1</a>, <a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a5c188df10b08b340b923c3a733c0d178">oomph::ConstitutiveLaw::calculate_contravariant()</a>, <a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a01763658a56a962460a80607653a33b4">oomph::ConstitutiveLaw::error_checking_in_input()</a>, <a class="el" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, and <a class="el" href="../../df/db8/level2__impl_8h.html#ad46ea6bf5745e72b985b11878e46a45d">k</a>.</p>

</div>
</div>
<a id="ad19b5e80755f5d8e5513c4199f62fe03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad19b5e80755f5d8e5513c4199f62fe03">&#9670;&nbsp;</a></span>calculate_second_piola_kirchhoff_stress() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void oomph::GeneralisedHookean::calculate_second_piola_kirchhoff_stress </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>sigma_dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d13/classoomph_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="../../df/de6/classdouble.html">double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>Gup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>gen_dil</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/de6/classdouble.html">double</a> &amp;&#160;</td>
          <td class="paramname"><em>inv_kappa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Calculate the deviatoric part of the contravariant 2nd Piola Kirchoff stress tensor. Also return the contravariant deformed metric tensor, the generalised dilatation, \( d, \) and the inverse of the bulk modulus \( \kappa\). This form is appropriate for near-incompressible materials for which \( \sigma^{ij} = -p G^{ij} + \overline{ \sigma^{ij}} \) where the "pressure" \( p \) is determined from \( p / \kappa - d =0 \). </p>

<p>Reimplemented from <a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a26f34355b626bebcad8f498fa5271d20">oomph::ConstitutiveLaw</a>.</p>
<div class="fragment"><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  {</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="comment">// Find the dimension of the problem</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    <span class="keywordtype">unsigned</span> dim = <a class="code" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>.nrow();</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160; </div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <span class="comment">// Assign memory for the determinant of the deformed metric tensor</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <span class="keywordtype">double</span> detG = 0.0;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160; </div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    <span class="comment">// Compute deviatoric stress by calling the incompressible</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    <span class="comment">// version of this function</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <a class="code" href="../../d3/d66/classoomph_1_1GeneralisedHookean.html#a5beca3e59f04d109c394bf9fd24bb7c1">calculate_second_piola_kirchhoff_stress</a>(g, <a class="code" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>, sigma_dev, Gup, detG);</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160; </div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    <span class="comment">// Calculate the inverse of the &quot;bulk&quot; modulus</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    inv_kappa =</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;      (1.0 - 2.0 * (*Nu_pt)) * (1.0 + (*<a class="code" href="../../d3/d66/classoomph_1_1GeneralisedHookean.html#ad719ee5ed6d1bcacb18fec3339ae98de">Nu_pt</a>)) / ((*<a class="code" href="../../d3/d66/classoomph_1_1GeneralisedHookean.html#a7a68b35f227848a065a7a844766b4eeb">E_pt</a>) * (*Nu_pt));</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160; </div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    <span class="comment">// Finally compute the generalised dilatation (i.e. the term that</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    <span class="comment">// must be zero if \kappa \to \infty</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    gen_dil = 0.0;</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; dim; <a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    {</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> = 0; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a> &lt; dim; <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>++)</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;      {</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        gen_dil += Gup(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) * 0.5 * (<a class="code" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>) - g(<a class="code" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>));</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;      }</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    }</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  }</div>
<div class="ttc" id="aclassoomph_1_1GeneralisedHookean_html_a5beca3e59f04d109c394bf9fd24bb7c1"><div class="ttname"><a href="../../d3/d66/classoomph_1_1GeneralisedHookean.html#a5beca3e59f04d109c394bf9fd24bb7c1">oomph::GeneralisedHookean::calculate_second_piola_kirchhoff_stress</a></div><div class="ttdeci">void calculate_second_piola_kirchhoff_stress(const DenseMatrix&lt; double &gt; &amp;g, const DenseMatrix&lt; double &gt; &amp;G, DenseMatrix&lt; double &gt; &amp;sigma)</div><div class="ttdef"><b>Definition:</b> constitutive_laws.cc:682</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d3/d66/classoomph_1_1GeneralisedHookean.html#a5beca3e59f04d109c394bf9fd24bb7c1">calculate_second_piola_kirchhoff_stress()</a>, <a class="el" href="../../d3/d66/classoomph_1_1GeneralisedHookean.html#a7a68b35f227848a065a7a844766b4eeb">E_pt</a>, <a class="el" href="../../d2/dc6/Jacobi__makeGivens_8cpp.html#ad2c49539791450cfceedabc09452d977">G</a>, <a class="el" href="../../d5/de3/BiCGSTAB__step__by__step_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="el" href="../../da/dd4/tut__arithmetic__redux__minmax_8cpp.html#a39513f0f8d942bf9ef17b2e87ac6d34e">j</a>, and <a class="el" href="../../d3/d66/classoomph_1_1GeneralisedHookean.html#ad719ee5ed6d1bcacb18fec3339ae98de">Nu_pt</a>.</p>

</div>
</div>
<a id="a9ed467d8b7c838cb7fed8c861aa652e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ed467d8b7c838cb7fed8c861aa652e9">&#9670;&nbsp;</a></span>requires_incompressibility_constraint()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::GeneralisedHookean::requires_incompressibility_constraint </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Pure virtual function in which the writer must declare if the constitutive equation requires an incompressible formulation in which the volume constraint is enforced explicitly. Used as a sanity check in PARANOID mode. False. </p>

<p>Implements <a class="el" href="../../dc/de2/classoomph_1_1ConstitutiveLaw.html#a446452158a8ae9fbc3dde4277155f824">oomph::ConstitutiveLaw</a>.</p>
<div class="fragment"><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    {</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a7a68b35f227848a065a7a844766b4eeb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a68b35f227848a065a7a844766b4eeb">&#9670;&nbsp;</a></span>E_pt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a>* oomph::GeneralisedHookean::E_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Young's modulus. </p>

<p class="reference">Referenced by <a class="el" href="../../d3/d66/classoomph_1_1GeneralisedHookean.html#ad19b5e80755f5d8e5513c4199f62fe03">calculate_second_piola_kirchhoff_stress()</a>, and <a class="el" href="../../d3/d66/classoomph_1_1GeneralisedHookean.html#a18794fa4b1750aafa2369b2a412a1228">~GeneralisedHookean()</a>.</p>

</div>
</div>
<a id="a21d4ef7498c2efd5bf30fa0ecd0d7dd5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21d4ef7498c2efd5bf30fa0ecd0d7dd5">&#9670;&nbsp;</a></span>Must_delete_e</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/db9/classbool.html">bool</a> oomph::GeneralisedHookean::Must_delete_e</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Boolean flag to indicate if storage for elastic modulus must be deleted in destructor </p>

<p class="reference">Referenced by <a class="el" href="../../d3/d66/classoomph_1_1GeneralisedHookean.html#a18794fa4b1750aafa2369b2a412a1228">~GeneralisedHookean()</a>.</p>

</div>
</div>
<a id="ad719ee5ed6d1bcacb18fec3339ae98de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad719ee5ed6d1bcacb18fec3339ae98de">&#9670;&nbsp;</a></span>Nu_pt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/de6/classdouble.html">double</a>* oomph::GeneralisedHookean::Nu_pt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Poisson ratio. </p>

<p class="reference">Referenced by <a class="el" href="../../d3/d66/classoomph_1_1GeneralisedHookean.html#ad19b5e80755f5d8e5513c4199f62fe03">calculate_second_piola_kirchhoff_stress()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="../../d4/d26/constitutive__laws_8h_source.html">constitutive_laws.h</a></li>
<li><a class="el" href="../../d4/d8c/constitutive__laws_8cc.html">constitutive_laws.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../da/ddf/namespaceoomph.html">oomph</a></li><li class="navelem"><a class="el" href="../../d3/d66/classoomph_1_1GeneralisedHookean.html">GeneralisedHookean</a></li>
    <li class="footer">Generated on Wed Aug 27 2025 17:08:54 for MercuryDPM by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
